'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1174:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1217:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(9),e=a(19),d=a(72),h=a(67),l=a(7),k=a(35);class n{}n.FJh="ewa-resizehdr-row-hidden";n.EJh="ewa-resizehdr-col-hidden";Object(u.a)(n,"CssClassNames",null,[]);var v=a(248),
x=a(14),w=a(168),r=a(651),t=a(31),A=a(231),y=a(6),z=a(234),E=a(15),G=a(79),F=a(136),O=a(47),M=a(25),P=a(54),B=a(13),D=a(76),I=a(1),S=a(101),J=a(12),L=a(16),R=a(263),Y=a(137),Q=a(383),W=a(49),Ga=a(37);class pa{constructor(Ma,xb,qb,Ra,Jb,yb,Gb){this.Hya=Ma;this.eJb=xb;this.SRa=qb;this.Wrd=Ra;this.mgb=Jb;this.ovf=yb;this.qni=Gb}}Object(u.a)(pa,"HeaderEventCachedInfo",null,[]);class aa{constructor(Ma){this.Bed=Ma}wNe(Ma){Ma=J.HelperMethods.JMd(Ma);return Math.max(0,Math.min(aa.JDf,Ma))}lNe(Ma){return this.Bij(Ma)}hgh(Ma){return Math.round(this.Bed*
Ma+2*this.Y9e()+1)}Bij(Ma){return Math.max(0,Math.min(aa.nDf,(Math.max(0,Math.min(f.a.gsc,Ma))-2*this.Y9e()-1)/this.Bed))}Y9e(){return Math.floor(Math.max((this.Bed+3)/4,2))}Zhc(Ma,xb){return xb?Ma?aa.JDf:f.a.dFd:Ma?aa.nDf:f.a.gsc}}aa.JDf=409;aa.nDf=255;Object(u.a)(aa,"ResizeHeadersConverter",null,[]);var Z=a(186);class fa extends S.a{constructor(Ma,xb){super(xb.domElement);this.rZ=this.I7f=!1;this.Qi=this.Pab=this.TDa=null;this.VTd=!0;this.Loc=!1;this.eQb=this.Ul=this.offset=0;this.dO=this.hT=this.N2=
null;this.woi="headerResizeTooltip";this.wH=this.qDd=null;this.h5c=this.O3=this.VCa=!1;this.YTf=this.ydb=f.a.fza;this.JVb=!1;this.$x=qb=>{if(this.grid.gk)return!1;qb=Ga.a(this.grid.$).Se(qb);if(3===qb.Wb&&!this.pvf(qb.Da)||!this.bXf(qb,!1))return!1;E.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Ra=this.lFc();this.Rkd(qb.clientPoint,Ra,!0);this.VCa||(v.a.instance.ta(x.a.Tk,this.domElement.ownerDocument.body,this.Mcb),w.a.instance.ta(x.a.Zg,this.domElement.ownerDocument.body,
this.Mcb),this.VCa=!0);this.erf()&&this.rZ&&this.zlf(qb);return!1};this.BKb=qb=>{qb=Ga.a(this.grid.$).Se(qb);this.erf()&&this.h5c&&this.zlf(qb);if(!qb.Da.type.includes("touch")&&qb.Da.button!==Sys.UI.MouseButton.leftButton||!this.eGb)return!1;D.g(qb.Da);this.iXe();qb=this.grid.gk?this.ydb:f.a.fza;var Ra=!1;if(this.grid.gk&&this.Qi){var Jb=qb!==this.Ul;!Jb&&this.JVb&&(this.Ie.removeRowColFromModel(this.Qi.Xqb,this.Qi.L2f),Ra=!0,I.EwaSettings.pn()&&(this.Ie.x$(this.grid.ga.pa.selectedRanges),this.Ie.Tm("HeaderResizeBehavior::onDocumentMouseUp")))}else this.Qi&&
(qb=this.O3?this.smd():this.Qi.C6()),Jb=qb!==this.Ul;this.TDa&&Jb&&qb!==f.a.fza?(qb=this.grid,Ra=this.Pod(qb),Jb={},Jb.SheetMultiRange=O.r(Ra,qb.$),fa.tYd(Jb,this.isRow,this.Ul),this.grid.gk&&(Ra=Jb.SheetMultiRange.Ranges[0],E.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.Qi?this.Qi.Xqb:-1}, isResizingHiddenHeader=${this.O3}, headerViewBlockHashCode=${this.Ie.hashCode},
          rangeFirstRow=${Ra.FirstRow}, rangeFirstColumn=${Ra.FirstColumn}, rangeLastRow=${Ra.LastRow}, rangeLastColumn=${Ra.LastColumn},`)),this.oDh(Jb),qb.l4j=!0):(!I.EwaSettings.pn()&&Ra&&(this.Ie.x$(this.grid.ga.pa.selectedRanges),this.Ie.Tm("HeaderResizeBehavior::onDocumentMouseUp")),this.Xe(null,null),this.lOb());return this.JVb=this.O3=!1};this.Wea=qb=>{if(this.grid.gk)return!1;qb=r.a.create(qb.eventName,qb.tc,qb.Da,qb.Wb);qb=Ga.a(this.grid.$).Se(qb);if(!this.bXf(qb,!0))return!1;qb=this.grid;
var Ra=this.Pod(qb);Ra=O.r(Ra,qb.$);qb.dc.Hk([this.isRow?13:14]);qb.dc.PVa();this.lOb();qb.$.xd(this.isRow?146338636:1391094586,G.a.Vb,30,{["autoFitRanges"]:Ra});return!1};this.PMf=qb=>{this.rZ?(this.O3&&!this.JVb&&(this.eTg(),I.EwaSettings.pn()&&this.Ie.Tm("HeaderResizeBehavior::onHeaderResizeChanged")),this.Loc||this.Jmf(),qb=new Sys.UI.DomEvent(qb),qb=r.a.create(x.a.Gja,this.domElement,qb,2),qb=Ga.a(this.grid.$).Se(qb),this.zJd(qb.clientPoint)):E.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Qi?
this.Qi.Xqb:-1}, isRow = ${this.isRow}`)};this.QMf=qb=>{qb=new Sys.UI.DomEvent(qb);qb=r.a.create(x.a.Gja,this.domElement,qb,2);this.BKb(qb)};this.k7i=qb=>{this.xBa(qb,this.Qi,!1)};this.Mcb=qb=>{qb=Ga.a(this.grid.$).Se(qb);D.g(qb.Da);return this.zJd(qb.clientPoint)};this.uJ=qb=>{if(this.grid.gk)return!1;qb=Ga.a(this.grid.$).Se(qb);let Ra;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ga.selectionType)return W.a(this.grid.$).Qq()&&(Ra=this.mnd(qb))&&(Ra.Hya.style.cursor=""),!1;if(this.rZ)return this.Jmf(),
!1;Ra=this.mnd(qb);if(!Ra)return!1;Ra.Hya.style.cursor=!this.grid.Eb&&this.uAd(Ra)?this.isRow?"row-resize":"col-resize":"";D.g(qb.Da);return!0};this.Ls=()=>{this.lOb()};this.Xe=()=>{if((3===G.a.Vb||t.a.iq)&&this.grid.ga.pa.Lh){var qb=this.grid.ga.pa.Hd;if(!(!qb.isRow&&!qb.gh||!this.domElement||qb.isRow&&this.isRow&&!this.Ie.Ju.includes(qb.top)||qb.gh&&!this.isRow&&!this.Ie.Ju.includes(qb.left))){var Ra=this.grid.Vg(qb,this.Ie.Yj.paneType);if(Ra){if(this.grid.gk){const Jb=this.isRow?qb.bottom:qb.right;
this.Qi=this.Ie.xt(M.Range.gd(qb.bottom,qb.right));if(!this.Qi){E.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Jb}, is row ${this.isRow}`);return}}this.wH||this.ksh();qb.isRow&&this.isRow?(B.DOMElementExtensions.setVisible(this.wH,!0),this.wH.style.top=Ra.bottomRight.y-this.wH.offsetHeight/2+"px"):qb.isRow||this.isRow||(B.DOMElementExtensions.setVisible(this.wH,!0),R.c(this.wH.style,this.grid.rtl,
Ra.bottomRight.x-this.wH.offsetWidth/2+"px"))}}}};this.WG=(qb,Ra)=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&E.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Ra.fN}`);Ra.fN&&this.Iub()};this.Ie=xb;this.isRow=xb.isRow;this.rtl=xb.Yj.rtl;this.grid=Ma;this.qDf=this.isRow?f.a.dFd:f.a.gsc;this.roi=L.a.instance.ha(436);this.Aoi=L.a.instance.ha(435);this.uoi=L.a.instance.ha(437);
Y.a(this.grid.$,qb=>{this.qDd=qb.tR(F.a.wDj,!1)});this.vtj();this.grid.ga.sx(this.Xe);this.grid.ga.eba(this.Ls);this.grid.jt(this.Xe);W.a(this.grid.$).yg.dba(this.WG)}get eGb(){return this.rZ}get yDj(){this.YDh();return fa.ngb}xBa(Ma,xb,qb){var Ra=new Sys.UI.DomEvent(Ma);Ra=r.a.create(x.a.Gja,this.domElement,Ra,2);Ra=Ga.a(this.grid.$).Se(Ra);this.aXf(xb,Ra.clientPoint.x,Ra.clientPoint.y,!1,qb,Ma);Ma=this.lFc();this.Rkd(this.TDa,Ma,!0);this.VCa||(Ma=this.domElement.ownerDocument.body,Ma.addEventListener(x.a.Gja,
this.PMf),Ma.addEventListener(x.a.VJa,this.QMf),this.VCa=!0)}i7i(Ma,xb,qb){this.aXf(xb,Ma.clientX,Ma.clientY,!0,qb,Ma);Ma=this.grid;xb=this.Pod(Ma);xb=O.r(xb,Ma.$);Ma.dc.Hk([this.isRow?13:14]);Ma.dc.PVa();this.lOb();Ma.$.xd(this.isRow?146338636:1391094586,G.a.Vb,30,{["autoFitRanges"]:xb})}dispose(){this.E8c();this.grid.ga&&(this.grid.ga.Ww(this.Xe),this.grid.ga.Ufa(this.Ls));this.grid.Rv(this.Xe);W.a(this.grid.$)&&W.a(this.grid.$).yg.Tfa(this.WG);A.a.instance.Aa(x.a.dl,this.domElement,this.Wea);v.a.instance.Aa(x.a.Pg,
this.domElement.ownerDocument.body,this.BKb);w.a.instance.Aa(x.a.$e,this.domElement.ownerDocument.body,this.BKb);t.a.iq||(v.a.instance.Aa(x.a.pointerDown,this.domElement,this.$x),v.a.instance.Aa(x.a.Tk,this.domElement,this.uJ));this.VCa&&(v.a.instance.Aa(x.a.Tk,this.domElement.ownerDocument.body,this.Mcb),w.a.instance.Aa(x.a.Zg,this.domElement.ownerDocument.body,this.Mcb),this.VCa=!1);this.wH&&(v.a.instance.Aa(x.a.pointerDown,this.wH,this.$x),A.a.instance.Aa(x.a.dl,this.wH,this.Wea),this.E8c(),this.wH=
null);this.I7f&&(B.DOMElementExtensions.gg(fa.ngb),fa.ngb=null);this.Ie=null;super.dispose()}vtj(){A.a.instance.ta(x.a.dl,this.domElement,this.Wea);v.a.instance.ta(x.a.Pg,this.domElement.ownerDocument.body,this.BKb);w.a.instance.ta(x.a.$e,this.domElement.ownerDocument.body,this.BKb);t.a.iq||(v.a.instance.ta(x.a.pointerDown,this.domElement,this.$x),v.a.instance.ta(x.a.Tk,this.domElement,this.uJ))}YDh(){if(!fa.ngb){document.getElementById(fa.H7f);this.I7f=!0;var Ma=fa.ngb=document.createElement("div");
this.grid.$.frame.jda().appendChild(Ma);Ma.id=fa.H7f;Ma.className=k.a.GJh;B.DOMElementExtensions.setVisible(Ma,!1)}}iXe(){if(this.VCa){const Ma=this.domElement.ownerDocument.body;this.grid.gk?(Ma.removeEventListener(x.a.Gja,this.PMf),Ma.removeEventListener(x.a.VJa,this.QMf)):(v.a.instance.Aa(x.a.Tk,Ma,this.Mcb),w.a.instance.Aa(x.a.Zg,Ma,this.Mcb));this.VCa=!1}this.rZ=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.G3f():(this.t8f(),this.RRd());Q.c(this.grid.$,
!0,"HeaderResizeBehavior:PrepareResizeOperation")}t8f(){this.grid.dc.Hk([this.isRow?13:14]);this.grid.dc.PVa()}eTg(){this.Ie.addRowColToModel(this.Qi.Xqb-1,this.Qi.L2f);this.JVb=!0}zJd(Ma){if(!this.rZ)return!1;const xb=this.isRow;if(!this.grid.gk&&!this.N2){this.N2=document.createElement("div");this.N2.style.cssText="position: relative; width: inherit; height: inherit;"+(xb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var qb=this.Qi.tL();qb.nextSibling;)this.N2.appendChild(qb.nextSibling);
qb.parentNode.appendChild(this.N2)}qb=xb?Ma.y-this.Pab.y:(this.rtl?-1:1)*(Ma.x-this.Pab.x);const Ra=xb?Ma.y-this.TDa.y:(this.rtl?-1:1)*(Ma.x-this.TDa.x),Jb=this.grid.gk?this.ydb:this.Qi.C6();if(Jb===f.a.fza)return!1;qb&&(0<this.Ul||0<Jb+Ra)&&Jb+Ra<=this.qDf&&(this.Ul=this.lFc(Ra),this.Rkd(Ma,this.Ul,!1),this.grid.gk?this.Ul>=fa.Bjf?(this.VTd=!0,this.Qi.setCellExtent(this.Ul)):this.VTd&&(this.VTd=!1,this.Qi.setCellExtent(fa.Bjf)):(B.DOMElementExtensions.Ara(this.Qi.tL(),!xb,Math.max(this.eQb+Ra,0)),
this.N2.style[xb?"top":this.rtl?"right":"left"]=Math.max(Ra,-this.eQb)+"px"),qb=(this.grid.gk?this.YTf:xb?this.Qi.Ie.FD:this.Qi.Ie.HD)+Math.max(Ra,this.grid.gk?-this.ydb+fa.ojc:-this.eQb),B.DOMElementExtensions.Ara(this.Qi.Ie.domElement,!xb,qb),this.grid.gk&&this.Qi.Ie.GLj(qb),this.Pab=new Sys.UI.Point(Ma.x,Ma.y),B.DOMElementExtensions.setVisible(this.wH,!1));return!0}C6(){return this.Qi?this.O3?fa.Hoi:this.Qi.C6():f.a.fza}Rkd(Ma,xb,qb){this.dO&&qb&&(E.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),
this.RRd());this.dO||qb||E.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.qDd&&this.qDd(()=>({["Location"]:"canvas"}));this.dO?this.Z6e(xb):(this.dO=document.createElement("div"),this.dO.id=this.woi,this.Z6e(xb),this.dO.className=k.a.iIh,xb=document.getElementById(this.grid.$.fc+l.a.eFf),xb.insertBefore(this.dO,xb.firstChild),Ma=Ga.a(this.grid.$).qma(Ma),this.dO.style.left=(this.rtl?Math.max(Ma.x-
this.dO.offsetWidth,0):Ma.x-Math.max(Ma.x+this.dO.offsetWidth-xb.offsetWidth,0)).toString()+"px",xb=document.getElementById(l.a.Zua),this.dO.style.top=(Ma.y-(y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Qa.Pf?0:xb.offsetHeight)-this.dO.offsetHeight).toString()+"px")}RRd(){B.DOMElementExtensions.gg(this.dO);this.dO=null}Z6e(Ma){var xb=new aa(this.grid.$.workbookContext.DxDigitNormal);xb=this.isRow?xb.wNe(Ma).toFixed(2):xb.lNe(Ma).toFixed(2);this.dO.innerText=`${this.isRow?this.roi:this.Aoi} ${xb} (${Ma.toString()} ${this.uoi})`}bXf(Ma,
xb){let qb;const Ra=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ga.selectionType||2===Ma.Wb&&Ma.Da.button!==Sys.UI.MouseButton.leftButton||!this.uAd(qb=this.mnd(Ma))||!Ra)return!1;D.g(Ma.Da);this.TDa=this.Pab=new Sys.UI.Point(Ma.clientPoint.x,Ma.clientPoint.y);this.e$g(qb,xb);if(!this.Qi)return!1;this.rZ=!0;this.sGi(this.Qi,qb)&&this.Gsi();this.eQb=this.smd();return this.cXf(Ma.Da.rawEvent,xb)}aXf(Ma,xb,qb,Ra,Jb,yb){this.rZ=!0;this.O3=Jb;this.Qi=Ma;this.Loc=!1;this.TDa=this.Pab=new Sys.UI.Point(xb,
qb);Ma=this.Qi.getRange();this.hT=Jb?this.Aze(Ma):Ma;this.ydb=this.C6();this.YTf=this.isRow?this.Qi.Ie.FD:this.Qi.Ie.HD;this.cXf(yb,Ra)}cXf(Ma,xb){const qb=this.grid.gk?{["IsResizingHiddenHeader"]:this.O3,["IsAutoFitting"]:xb,["NumberOfSelectedRanges"]:this.grid.ga.pa.HE,["Location"]:"canvas",["ResizeRange"]:this.hT,["ResizedCellAbsoluteIndex"]:this.Qi.Xqb,["HeaderViewBlockHashCode"]:this.Ie.hashCode}:{["IsResizingHiddenHeader"]:this.O3,["IsAutoFitting"]:xb,["NumberOfSelectedRanges"]:this.grid.ga.pa.HE,
["Location"]:"canvas"};Y.b(this.grid.$).Ld(F.a.nDj,qb);this.grid.kWj&&(xb=xb?"header_resize_autofit":"header_resize_start",Z.b(this.grid.$).AEa(Ma,xb,void 0));this.offset=this.Qi.qda();this.Ul=this.grid.gk?this.ydb:this.Qi.C6();if(this.Ul===f.a.fza)return!1;Q.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}sGi(Ma,xb){var qb=this.Qi.tL();if(!qb)return E.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;qb=qb.nextSibling;if(!qb)return!1;
Ma=Ma.getRange();qb=this.Ie.Mxa(qb).getRange();if(!Ma||!qb)return E.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ma=this.isRow?Ma.bottom:Ma.right;qb=this.isRow?qb.bottom:qb.right;return Ma+1!==qb&&Ma!==qb&&this.uAd(xb,!0)}Gsi(){var Ma=this.Qi.tL();const xb=this.Ie.Mxa(Ma.nextSibling);fa.tGi(xb,this.isRow)?(this.Qi=xb,this.hT=this.Qi.getRange()):(this.fTg(Ma),this.Qi=xb,Ma=this.Qi.getRange(),this.hT=this.Aze(Ma),this.O3=!0)}Aze(Ma){return this.isRow?new M.Range(Ma.top-1,Ma.left,
Ma.top-1,Ma.right,!1,!0):new M.Range(Ma.top,Ma.left-1,Ma.bottom,Ma.left-1,!1,!0)}fTg(Ma){const xb=this.Ie.Mxa(Ma.nextSibling),qb=fa.poh(xb,this.isRow,this.rtl);qb&&Ma.parentNode.insertBefore(qb,xb.tL())}Pod(Ma){const xb=this.hT,qb=Ma.ga.pa.selectedRanges;if(Ma.ga.pa.Nxb(xb))if(this.isRow){if(z.a.all(qb,Ra=>Ra.isRow))return qb}else if(z.a.all(qb,Ra=>Ra.gh))return qb;return[xb]}getCellExtent(){return this.Qi.getCellExtent()}smd(){const Ma=this.Qi.tL().style;return Math.max(0,Math.min(this.qDf,0|parseInt(this.isRow?
Ma.height:Ma.width,10)))}lFc(Ma=0){const xb=this.grid;var qb=this.Ie.Yj.paneType;let Ra;Ra=this.isRow?3===qb?[3,2]:[1,4]:4===qb?[2,4]:[1,3];var Jb=Math.max(this.grid.gk?this.ydb:this.Qi.C6(),0);Ma=this.O3&&!this.grid.gk?Math.max(this.smd(),0):Math.max(Jb+Ma,0);qb=xb.s9h(qb,this.isRow);qb=this.isRow?new h.a(0,this.offset,qb,Ma):new h.a(this.offset,0,Ma,qb);Jb=[this.isRow?13:14];xb.dc.il(new M.Range(1,1,f.a.Hg,f.a.Gg,!1,!0),Jb,!1);xb.dc.Ur(Jb,qb,Ra);return Ma}E8c(){this.hT=this.TDa=this.Pab=null;if(this.N2){const Ma=
this.N2.parentNode;if(Ma)for(Ma.removeChild(this.N2);this.N2.firstChild;)Ma.appendChild(this.N2.firstChild);this.N2=null}this.Qi=null;this.rZ=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.G3f()}G3f(){this.Loc=!1;this.RRd();B.DOMElementExtensions.setVisible(fa.ngb,!1);B.DOMElementExtensions.setVisible(this.wH,!1);I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.t8f()}mnd(Ma){if(B.DOMElementExtensions.EA(Ma.tc,"a"))return null;
const xb=this.pvf(Ma.Da);if(xb&&this.grid.ga.pa.Lh){var qb=this.grid.ga.pa.Hd;qb=this.Ie.xt(M.Range.gd(qb.bottom,qb.right))}else qb=this.Ie.Mxa(Ma.tc);if(!qb)return null;const Ra=qb.tL(),Jb=new Sys.UI.Bounds(Ra.offsetLeft,Ra.offsetTop,Ra.offsetWidth,Ra.offsetHeight);var yb=B.DOMElementExtensions.getBoundingClientRect(Ma.tc);yb=new Sys.UI.Point(Ma.clientPoint.x-yb.x,Ma.clientPoint.y-yb.y);this.isRow&&!xb&&(yb.y+=J.HelperMethods.oE(Ma.tc,Ra,this.rtl).y);return new pa(Ra,yb,Jb,qb.getRange(),Math.max(fa.SVi,
Math.min(fa.SUi,(this.isRow?Jb.height:Jb.width)*fa.xDj)),xb,!this.isRow&&0<Ra.getElementsByTagName("input").length)}uAd(Ma,xb=!1){if(!Ma||this.grid.Eb)return!1;if(Ma.ovf)return!0;var qb=Ma.SRa;const Ra=Ma.mgb;var Jb=this.Ie.Yj.paneType,yb=this.grid.og(Jb).hk,Gb=!!yb&&yb.top===Ma.Wrd.top,ub=!!yb&&yb.left===Ma.Wrd.left;Jb=!!yb&&yb.bottom===Ma.Wrd.bottom&&(3===Jb||2===Jb);this.isRow?(ub=Ma.eJb.y,Ma=ub<=Ra&&!Gb,qb=ub>=qb.height-Ra-(Jb?fa.rWh:0),xb=xb?Ma:qb||Ma):(Jb=Ma.qni,Gb=this.rtl,yb=Ma.eJb.x,Ma=yb<=
Ra&&(!ub||Gb)&&(!Jb||!Gb),qb=yb>=qb.width-Ra&&(!Gb||!ub)&&(!Jb||Gb),xb=xb?Gb?qb:Ma:Ma||qb);return xb}e$g(Ma,xb){const qb=this.isRow;if(Ma.ovf)this.Qi=this.Ie.Mxa(Ma.Hya);else if(qb&&Ma.eJb.y<=Ma.mgb&&Ma.SRa.height>Ma.mgb||!qb&&Ma.SRa.width>Ma.mgb&&(!this.rtl&&Ma.eJb.x<=Ma.mgb||this.rtl&&Ma.eJb.x>=Ma.SRa.width-Ma.mgb)){if(this.Qi=Ma.Hya.previousSibling?this.Ie.Mxa(Ma.Hya.previousSibling):this.G8h(),xb&&Ma.Hya.classList.contains(qb?k.a.C1e:k.a.B1e)&&(Ma=this.Ie.Mxa(Ma.Hya)))Ma=Ma.getRange(),this.hT=
qb?new M.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.right,!1,!0):new M.Range(Ma.top,Ma.left-1,Ma.bottom,Ma.left-1,!1,!0)}else this.Qi=this.Ie.Mxa(Ma.Hya);!this.hT&&this.Qi&&(this.hT=this.Qi.getRange())}G8h(){var Ma=this.isRow?1:0;return(Ma=this.Ie.Yj.iD(this.Ie.Yj.Ca.Jh(this.grid.$.na,d.a.WK(this.Ie.position.X+Ma-1,this.Ie.position.Y-Ma,this.Ie.position.PaneType))))?Ma.F8h():null}Jmf(){this.Loc=!0;const Ma=this.yDj;B.DOMElementExtensions.setVisible(Ma,!0);Ma.style.cursor=this.isRow?k.a.VZe:k.a.IYe;this.lFc()}oDh(Ma){this.grid.$.xd(this.isRow?
745189930:-445963340,G.a.Vb,30,{["resizeRowColumnParameters"]:Ma})}ksh(){const Ma=document.createElement("div");Ma.className=k.a.FKh;const xb=document.createElement("div");xb.className=e.a.VB;Ma.appendChild(xb);const qb=document.createElement("img");qb.src=P.a.dg(0);qb.className=this.isRow?e.a.DJh:e.a.yJh;xb.appendChild(qb);this.Ie.Ky.domElement.parentNode.insertBefore(Ma,this.Ie.Ky.domElement);this.grid.gk?Ma.addEventListener(x.a.Gba,this.k7i):(v.a.instance.ta(x.a.pointerDown,Ma,this.$x),A.a.instance.ta(x.a.dl,
Ma,this.Wea));B.DOMElementExtensions.setVisible(Ma,!1);this.wH=Ma}lOb(){this.E8c();this.wH&&(this.Ie.Ky.domElement.parentNode.removeChild(this.wH),this.wH=null)}pvf(Ma){return B.DOMElementExtensions.lg(this.wH,Ma.target)}Iub(){this.rZ&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.gk&&this.zJd(this.TDa),this.iXe(),this.grid.gk||B.DOMElementExtensions.Ara(this.Qi.tL(),!this.isRow,this.eQb),this.lOb(),this.JVb=this.O3=!1)}erf(){return I.EwaSettings.ya(587)}zlf(Ma){(Ma=
Ma.Da.rawEvent)&&Ma.detail===fa.mIj&&(Ma.type===x.a.nq?(this.rZ=!1,this.h5c=!0):Ma.type===x.a.pJ&&(this.rZ=!0,this.h5c=!1))}static moh(Ma,xb){return new fa(Ma,xb)}static tYd(Ma,xb,qb){if(xb){Ma.ColumnWidth=-1;Ma.RowHeight=qb;for(const Ra of Ma.SheetMultiRange.Ranges)Ra.FirstColumn=0,Ra.LastColumn=0}else{Ma.RowHeight=-1;Ma.ColumnWidth=qb;for(const Ra of Ma.SheetMultiRange.Ranges)Ra.FirstRow=0,Ra.LastRow=0}}static tGi(Ma,xb){if(!Ma||!Ma.tL())return E.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),
!1;const qb=Ma.getRange();Ma=Ma.tL().style;if(!qb||!Ma)return E.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ma=xb?Ma.height:Ma.width;return(xb?qb.top:qb.left)===(xb?f.a.Hg:f.a.Gg)&&Ma===fa.Lxg}static poh(Ma,xb,qb){if(!Ma)return E.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Ra=Ma.tL();if(!Ra||!Ra.style)return E.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;Ma=document.createElement("div");const Jb=Ra.style;
Ma.style.top=xb?Jb.top:fa.Lxg;xb||(qb?Ma.style.right=Jb.right:Ma.style.left=Jb.left);Ma.classList.add(xb?n.FJh:n.EJh);Ma.classList.add(xb?k.a.Oyb:k.a.Nyb);qb=document.createElement("div");qb.classList.add(xb?k.a.r1e:k.a.mhd);Ra=xb?Number.parseInvariant(Ra.innerText):M.Range.S3a(Ra.innerText);qb.innerText=xb?(Ra-1).toString():M.Range.nR(Ra-1);Ma.appendChild(qb);return Ma}}fa.SVi=0;fa.SUi=5;fa.ojc=1;fa.Bjf=1;fa.Hoi=0;fa.rWh=3;fa.xDj=.1;fa.H7f="ewa-rszrbg";fa.Lxg="0px";fa.mIj=2;fa.ngb=null;Object(u.a)(fa,
"HeaderResizeBehavior",S.a,[263]);class ya extends b.a{constructor(){super();this.kc()}create(){this.Pb(fa.moh)}static la(Ma){Ma.da.Ja(136,new ya)}}Object(u.a)(ya,"HeaderResizeBehaviorFactory",b.a,[]);var Aa=a(62),ja=a(722),za=a(52),ra=a(40),fb=a(185),Ua=a(430),Ca=a(382),Ia=a(200),oa=a(151),Da=a(230),bb=a(246),Za=a(66),Xa=a(20);class Ba{constructor(Ma,xb){this.isRow=!1;this.autoFitRange=null;this.isRow=Ma;this.autoFitRange=xb}}Object(u.a)(Ba,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[139]);
class Wa{constructor(Ma){this.resizeParameters=null;this.resizeParameters=Ma}}Object(u.a)(Wa,"MacroRecorderSheetRowsColumnsResizedPayload",null,[139]);var Na=a(126);b=a(294);var ta=a(23),V=a(60);class ia extends b.a{constructor(Ma,xb){super(Ma);this.LNa=qb=>{qb=this.Cnd(qb);return this.Jkd(qb)};this.oDj=(qb,Ra)=>{var Jb=this.jab=Ra[ia.EAi];1===qb?(qb=Ra[ia.QZj],Jb=this.Jff(qb,Jb),E.ULS.shipAssertTag(537153996,0,Jb!==ia.Pda,`ResizeHeadersDialogHandler - invalid size input, size = ${qb}`),qb=Jb!==this.aud,
E.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.jab,Jb,qb),qb&&this.Qlh(Jb)):E.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===xb.command;this.gridView=Xa.h(this.$);this.aBc=new aa(this.$.workbookContext.DxDigitNormal);this.aud=this.I$g();Ma=this.wkh(this.aud);xb=this.ykh(this.aud);this.tl=L.a.instance.ha(this.isRow?
478:479);Ma=this.JI(Ma,xb);this.initializeAndShow(this.tl,this.oDj,Ma);E.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Qc(){return"ResizeHeadersDialog"}get jab(){return ia.ije}set jab(Ma){ia.ije=Ma}JI(Ma,xb){return{[ia.fO]:this.Qc,[ia.IGi]:this.isRow,[ia.dti]:Ma,[ia.cti]:xb,[ia.kDi]:this.jab,[ia.Bnd]:this.LNa}}I$g(){const Ma=this.IZh();try{return this.o3h(Ma)}finally{Ma&&Ma.dispose()}}Qlh(Ma){const xb={};xb.SheetMultiRange=O.r(this.gridView.ga.pa.selectedRanges,
this.$);ia.tYd(xb,this.isRow,Ma);this.$.xd(this.isRow?745189930:-445963340,G.a.Vb,8,{["resizeRowColumnParameters"]:xb})}Jff(Ma,xb){return ta.a.z7(Ma)?xb?this.vkh(Ma):this.xkh(Ma):ia.Pda}xkh(Ma){return Math.floor(parseFloat(Ma))}vkh(Ma){Ma=parseFloat(Ma);return 0>Ma?ia.Pda:Ma?this.isRow?J.HelperMethods.Lij(Ma):this.aBc.hgh(Ma):0}ykh(Ma){return Ma===ia.Pda?"":this.isRow?this.aBc.wNe(Ma).toString():this.aBc.lNe(Ma).toFixed(2)}wkh(Ma){return Ma===ia.Pda?"":Ma.toString()}o3h(Ma){if(!Ma||!Ma.$$mn()||!Ma.Cm)return ia.Pda;
var xb=Object(Na.a)(325,Ma.Cm);if(!xb)return ia.Pda;for(xb=this.isRow?xb.JDb:xb.Ztd;Ma.$$mn();){const qb=Object(Na.a)(325,Ma.Cm);if(qb&&(this.isRow?qb.JDb:qb.Ztd)!==xb)return ia.Pda}return xb}IZh(){const Ma=[];for(const qb of this.gridView.ga.pa.selectedRanges){const Ra=qb.clone();var xb=this.gridView.og(this.gridView.Cb.ti(Ra));xb=Ra.Ue(xb.hk);if(!xb)return null;this.isRow?Ra.right=Ra.left=xb.left:Ra.top=Ra.bottom=xb.top;Ma.push(Ra)}return Ma.length?this.gridView.y5("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",
Ma):null}Cnd(Ma){if(!ta.a.z7(Ma))return 1;Ma=this.Jff(Ma,this.jab);if(0===Ma)if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){const xb=this.gridView.ga.pa.selectedRanges,qb=this.gridView.Nj("ResizeHeaderDialog");if(Object(V.c)(qb)){if(!qb.value.$Ge(xb,this.isRow))return 3}else if(this.Ltf())return 3}else if(this.Ltf())return 3;return this.DJi(Ma)?0:2}Ltf(){const Ma=this.gridView.ga.pa.selectedRanges;return this.isRow&&O.Q(Ma)||!this.isRow&&O.P(Ma)}Jkd(Ma){let xb="";switch(Ma){case 0:xb=
"";break;case 1:xb=L.a.instance.ha(767);break;case 2:xb=String.format(L.a.instance.Lb(99),0,this.Zhc(this.jab));break;case 3:xb=L.a.instance.ha(768)}return xb}DJi(Ma){return 0<=Ma&&Ma<=this.Zhc(!1)}Zhc(Ma){return this.aBc.Zhc(Ma,this.isRow)}static tYd(Ma,xb,qb){if(xb){Ma.ColumnWidth=ia.Pda;Ma.RowHeight=qb;for(const Ra of Ma.SheetMultiRange.Ranges)Ra.FirstColumn=0,Ra.LastColumn=0}else{Ma.RowHeight=ia.Pda;Ma.ColumnWidth=qb;for(const Ra of Ma.SheetMultiRange.Ranges)Ra.FirstRow=0,Ra.LastRow=0}}}ia.fO=
"id";ia.IGi="isRow";ia.dti="initialSizeInPx";ia.cti="initialSizeInDefaultUnits";ia.kDi="isInitialUnitsDefaultUnits";ia.Bnd="getInputErrorIfInvalid";ia.QZj="size";ia.EAi="isDefaultUnits";ia.Pda=-1;ia.ije=!0;Object(u.a)(ia,"ResizeHeadersDialog",b.a,[]);var X=a(58);const la=(Ma,xb,qb,Ra,Jb,yb,Gb=null)=>{Gb=Ma.Pa(41,Gb);Gb.resizeRowColumnParameters=xb;return X.g(Ma,"ResizeRowsColumns",Gb,qb,Ra,Jb,yb,0)};var sa=a(296),Va=a(152),nb=a(33),ha=a(356);class jb{constructor(Ma,xb,qb){this.naj=(Ra,Jb)=>{if(!Da.a(Ra)&&
Jb){const yb=!!Ra&&!!Ra.RequestTelemetryData;Xa.h(this.$).Bh.loa(Jb,Ra.StateId,yb?Ra.RequestTelemetryData.EcsOperationDuration:0,yb?Ra.RequestTelemetryData.EcsRequestDuration:0,yb?Ra.RequestTelemetryData.WfeRequestDuration:0)}};this.t2i=(Ra,Jb)=>{ra.TaskExtensions.za(za.GetServiceTaskFactory.Za(this.$.da,534,535,1),yb=>{yb.result.S9j(Jb)},this.$.ka,3)};this.$=Ma;this.ag=xb;this.gridInstantaneousAction=qb;this.grid=Xa.h(this.$)}hd(Ma,xb){Ma=!0;switch(xb){case -445963340:case 1391094586:Ma=this.xe(8);
break;case 745189930:case 146338636:Ma=this.xe(16)}return!Ma}executeCommand(Ma,xb,qb){var Ra=Xa.h(this.$);const Jb=xb.command;var yb=fb.a.create().toString();let Gb=ra.TaskExtensions.zk();switch(Jb){case 1391094586:case 146338636:Ma=1391094586===Jb;(yb=qb.autoFitRanges)&&yb.Ranges&&yb.Ranges.length||(yb=O.r(Ra.ga.pa.selectedRanges,this.$));Gb=this.izh(Ma?1:0,yb,xb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ma=-445963340===Jb||-706918724===
Jb||369708605===Jb;I.EwaSettings.LPa()&&-706918724===Jb&&Ra.Bh.I2(18,yb,Ua.a(Jb));if(-445963340===Jb||745189930===Jb){var ub=Ua.a(xb.command);Ra.Bh.I2(16,yb,ub);Ra=qb.resizeRowColumnParameters}else{qb=Ra.ga.pa.selectedRanges;let zb=0;for(var Ja of qb)if(-706918724===Jb||369708605===Jb){const na=Ja.right-Ja.left+1;zb+=0<na?na:-1*na}else if(1542466017===Jb||1051390410===Jb)zb+=Ja.bottom-Ja.top+1;369708605===Jb||1542466017===Jb?E.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${zb}`):
(-706918724===Jb||1051390410===Jb)&&E.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${zb}`);if(!I.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")||!Object(V.c)(Ra.Nj("ResizeCmdHandler"))){if(-706918724===Jb&&6===xb.yf&&O.P(qb)){E.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Jb&&6===xb.yf&&O.Q(qb)){E.ULS.sendTraceTag(537154006,
0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}Ja=369708605===Jb||1542466017===Jb?-2:0;Ra={};Ra.SheetMultiRange=O.r(qb,this.$);if(Ma)for(ub of Ra.SheetMultiRange.Ranges)ub.FirstRow=0,ub.LastRow=0;else for(const na of Ra.SheetMultiRange.Ranges)na.FirstColumn=0,na.LastColumn=0;Ra.RowHeight=Ma?-1:Ja;Ra.ColumnWidth=Ma?Ja:-1}Gb=this.Dzh(Ra,xb,yb,Ma);break;case 957527587:case 2040891415:new ia(this.$,xb)}return Gb}Tc(Ma,xb,qb,Ra){if(Ma=
!!qb&&!!Ra&&1===Ra.Qy)switch(xb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ma=!1}return Ma}ld(){return!1}gQi(Ma){E.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(sa.c)(Ma)}. Reason: ${Object(sa.c)(Ma)?void 0:Ma.reason}.`)}xe(Ma){return(new oa.a(this.$.ua)).xe(Ma)}izh(Ma,xb,qb){const Ra=this.$.qa.va.Bc(),
Jb=0===Ma,yb=()=>new Ba(Jb,xb);return Ca.a(this.$.userOperationManager,(Gb,ub,Ja)=>{var zb=this.$.qa.va;Gb=bb.b(Gb,this.t2i);var na={Ozi:!Jb,e5c:xb};const Ea=zb.Pa(41,Ra);Ea.isRow=Jb;Ea.autoFitRanges=xb;return X.g(zb,"AutoFit",Ea,Gb,ub,Ja,na,0)},Gb=>new Ia.a(135,0,Gb,void 0,yb),qb,I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}Dzh(Ma,xb,qb,Ra){const Jb=xb.command,yb=Xa.h(this.$),Gb=O.g(Ma.SheetMultiRange.Ranges);if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var ub=
1051390410===Jb||745189930===Jb&&0===Ma.RowHeight;const Ea=-706918724===Jb||-445963340===Jb&&0===Ma.ColumnWidth,ma=yb.Nj("ResizeCmdHandler");if((ub||Ea)&&Object(V.c)(ma)&&!ma.value.$Ge(Gb,!Ra))return this.syh(Ra),ra.TaskExtensions.zk()}let Ja;ub=I.EwaSettings.LPa()&&-706918724===Jb;if(745189930===Jb||-445963340===Jb||ub)E.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ma.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),ub?(this.gridInstantaneousAction.bsj(),
Object(Va.c)(()=>{yb.Bh.KIb();this.gridInstantaneousAction.J3g(Jb)},this.$.ka,0)):(Ja=this.ag.j0d(yb,Gb,Ra?Ma.ColumnWidth:Ma.RowHeight,!Ra),this.gQi(Ja),Object(sa.c)(Ja)&&yb.Bh.PP(qb,Za.BasicTelemetryCalculator.jO));const zb=this.$.qa.va.Bc({joa:!0,bna:3});Ra=(Ea,ma,Ka)=>{this.$.Kz();O.i(Gb,",",this.$,!1);return la(this.$.qa.va,Ma,bb.b(Ea,this.naj),ma,Ka,qb,zb)};const na=()=>new Wa(Ma);return Ja&&Object(sa.c)(Ja)?Ca.a(this.$.userOperationManager,Ra,Ea=>new Ia.a(136,0,Ea,64,na),xb):Ca.a(this.$.userOperationManager,
Ra,Ea=>new Ia.a(136,0,Ea,void 0,na),xb)}syh(Ma){Ma=nb.a.Od(1,0,Ma?769:771,Ma?770:772,0,Ma?-2037763134:503471870,Ma?"HideAllColumnsError":"HideAllRowsError");new ha.a(this.$,Ma)}}Object(u.a)(jb,"ResizeCommandHandler",null,[200]);var Fb=a(100),Rb=a(149),mb=a(36);class sb extends ja.a{constructor(Ma){super(Ma)}he(){let Ma;Ma=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Fb.d)(Rb.a.resolve(mb.H,{Wa:this.La})):za.GetServiceTaskFactory.create(this.$.da,
18,this.ka,this.La);let xb;xb=I.EwaSettings.LPa()?za.GetServiceTaskFactory.Za(this.$.da,528,529,this.La):Aa.Task.Ua(null);ra.TaskExtensions.za(Ma,()=>{this.Pd([new jb(this.$,Ma.result,xb.result)])},this.ka,3)}static la(Ma){ja.a.ye(113,new sb(Ma))}}Object(u.a)(sb,"ResizeCommandHandlerFactory",ja.a,[]);a.d(C,"a",function(){return Ya});const Ya=()=>{c.a.Fa(Ma=>{ya.la(Ma);sb.la(Ma)})}},1308:function(u,C,a){function c(M){const P=e(M);let B=[];if(0===P&&1===M.length)return B.push({destination:M[0],source:null,
uoc:!1}),B;for(let D=0;D<=P;D++){const I=M.filter(S=>S.Ula().topLeft.Y===D);for(let S=0;S+1<I.length;S+=1)B.push({destination:I[S],source:I[S+1],uoc:!1})}x.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${B.length}`);return B}function b(M,P){let B;const D=n.HelperMethods.LS(()=>{B=gridRenderer.CanvasRendererGlobals.hideRowCols(M,P,!1)});d("HideRowCols",D);return B}function f(M,P,B,D){M=gridRenderer.CanvasRendererGlobals.performModelCascade(M,
P,B,D);M.metric&&d("ModelCascade",M.metric.Mok);return M}function e(M){let P=-1;for(let B=0;B<M.length;B++){const D=M[B].Ula().topLeft.Y;D>P&&(P=D)}return P}function d(M,P){x.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${M} is time=${P}`)}var h=a(10);u=a(0);var l=a(229),k=a(20),n=a(12),v=a(185),x=a(15),w=a(1),r=a(60),t=a(49),A=a(16),y=a(92);let z=null;class E{constructor(M){this.Bj=()=>{z&&(y.a.Ka(z),z=null)};this.$=M;this.gridView=k.h(this.$);this.Ca=
this.gridView.Ca;this.VFb=!1;this.Ubd=this.$.ea.We;this.rPb={};this.c7={};this.Ca.rw(this.Bj)}dispose(){this.gridView=this.$=null;this.c7={};this.VFb=!1;this.rPb={};this.Ca.Vw(this.Bj)}J3g(M){if(this.VFb)x.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${M}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`),this.gridView.Bh.KIb(!1);else{var P=this.Ca.r0h(),B=c(P);this.c7={};this.rDi(M,P,
B)?(this.VFb=!0,this.xYf(M,!1,B,P)):this.gridView.Bh.KIb(!1)}}bsj(){this.Ubd=this.$.ea.We}rDi(M,P,B){var D=this.gridView;if(-706918724!==M||D.rtl)return!1;if(D.Cb.HW)return x.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = hasPanes, value=true, isRow=false`),!1;var I=D.Nj("GridInstantaneousAction");if(!Object(r.c)(I))return x.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),
!1;D=D.ga.pa.selectedRanges;var S=D[0];const J=D.length;if(1<J)return x.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = SelectedRanges, value=${J}, reason = Discontinuous selection, isRow=false`),!1;if(I.value.PFb(S))return x.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;I=S.right-S.left+1;if(I>w.EwaSettings.jUi())return x.ULS.sendTraceTag(509658005,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = ColumnCount, value=${I}, reason = Multiple columns selected, isRow=false`),!1;P=P.length;if(P>w.EwaSettings.iUi())return x.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = BlocksInViewport, value=${P}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(L of B){if(!L||!L.source||!L.destination){x.ULS.sendTraceTag(509649925,0,
50,"GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null");var L=!1;break a}P=L.source.De.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(P,P.ColumnNumbers[0],!1)){L=!1;break a}}L=!0}if(!L)return x.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;a:{L=S.left;S=this.Ca.qNa(S,
this.$.activeItemName);for(R of S)if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(R.De.GridBlockModel,L,!1)){var R=!1;break a}R=!0}if(!R)return x.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=false`),!1;D=D[0];R=0;for(let Y of B)if(Y.destination.af.Nd(D)||Y.destination.af.left>D.right)R+=1;B=R;if(B>w.EwaSettings.mUi())return x.ULS.sendTraceTag(509658002,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = TransitionCount, value=${B}, reason = Transition count limit exceeded, isRow=false`),!1;x.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);return!0}xYf(M,P,B,D){try{const I=n.HelperMethods.lc(),S=w.EwaSettings.lUi();let J=B.filter(L=>
!L.uoc);for(let L of J){if(this.nue("WebServiceResponseReceivedInProcessGridAction",D,M))return;const R=this.gridView.ga.pa.selectedRanges[0],Y=L.destination.af.right;if(Y<R.left){L.uoc=!0;x.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${M}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${R.left}, blockRangeRightMostValue=${Y}, hashCode=${L.destination.Md}, isRow=false`);continue}const Q=P?R.topLeft.top:R.topLeft.left,W=this.j8e("SourceModel",
L.source),Ga=this.j8e("DestinationModel",L.destination),pa=L.destination.Md;if(L.destination.af.Nd(R)){if(!b(Ga,Q)){this.tua();x.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${M}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${pa}, isRow=${P}, rowColNumber=${Q}`);return}x.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${M}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${pa}, isRow=${P}, rowColNumber=${Q}`)}const aa=
W.ColumnNumbers[0],Z=L.source.Md;if(f(W,Ga,aa,P).isSuccess)L.uoc=!0,x.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${M}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${Z}, isRow=${P}, rowColNumber=${aa}`);else{this.tua();x.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${M}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${Z}, isRow=${P}, rowColNumber=${aa}`);
return}this.M2j(Ga,W,L);if(n.HelperMethods.lc()-I>S){this.uHj(M,P,J,D);return}}this.fhh(P,M,D);d("ProcessGridAction",n.HelperMethods.lc()-I)}catch(I){this.Ski(I)}}fhh(M,P,B){if(!this.nue("CommitGridInstantaneousActionResults",B,P)){var D=n.HelperMethods.lc();if(this.c7&&0!==Object.keys(this.c7).length)if(this.bjj(B),this.hBg(P,B)){var I=v.a.create().toString(),S=this.gridView.Nj("GridInstantaneousAction");Object(r.c)(S)?(S.value.j7d(this.gridView.ga.pa.selectedRanges,0,M),P=Object.keys(this.c7),this.Ca.EZf(P,
I,M?"row":"column",!0),this.VFb=!1,z=t.a(this.$).yg.IIa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,A.a.instance.ha(2188)),d("CommitGridInstantaneousActionResults",n.HelperMethods.lc()-D)):(this.W7f(B),this.tua(),x.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${P}, parameter = ActiveSheetProcessedData, value=null, isRow=${M}`))}else this.W7f(B),this.tua();else this.tua(),x.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${P}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${M}`)}}j8e(M,
P){let B=this.c7[P.Md];if(!B){const D=n.HelperMethods.LS(()=>{B=P.a2h()});d(M,D)}return B}bjj(M){for(let P of M)M=P.Md,this.rPb[M]||(this.rPb[M]=P.ydf())}W7f(M){for(let P of M){M=P.Md;const B=this.rPb[M];if(B&&!P.U5f(B)){x.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${M}`);this.tua();break}}}hBg(M,P){for(let B of P)if(P=B.Md,this.c7[P]&&!B.U5f(this.c7[P]))return x.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${M}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${P}, isRow=false`),
!1;return!0}uHj(M,P,B,D){window.setTimeout(()=>{this.xYf(M,P,B,D)},0)}fJi(M){for(let P of M)if(P.De.Information.Revision>this.Ubd)return!0;return!1}nue(M,P,B){return this.fJi(P)?(this.Ubd=this.$.ea.We,this.tua(),x.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${B}, parameter = ${M}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}tua(){this.c7={};this.VFb=!1;this.rPb={};this.gridView.Bh.KIb(!1)}Ski(M){this.tua();
x.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${M}.`)}M2j(M,P,B){this.c7[B.destination.Md]=M;this.c7[B.source.Md]=P}}Object(u.a)(E,"GridInstantaneousAction",null,[358]);var G=a(725);class F extends l.a{constructor(M){super();this.$=M;this.kc()}create(){this.Pb(Object(G.a)(this.$.da,528,()=>new E(this.$)))}static la(M){M.da.Ja(529,new F(M))}}Object(u.a)(F,"GridInstantaneousActionFactory",l.a,[]);a.d(C,"a",function(){return O});const O=()=>{h.a.Fa(M=>
{F.la(M)})}},1490:function(u,C,a){a.r(C);u=a(1174);C=a(1217);a=a(1308);Object(u.a)();Object(C.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.rsz.js.map/f5d359dc578425f91cec027a0fcd8c3c/EwaDSOpt.rsz.js.map