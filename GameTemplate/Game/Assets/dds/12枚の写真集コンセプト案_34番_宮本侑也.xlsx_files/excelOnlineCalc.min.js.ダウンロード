var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=210)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return i})),r.d(t,"__assign",(function(){return o})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return l})),r.d(t,"__esDecorate",(function(){return u})),r.d(t,"__runInitializers",(function(){return c})),r.d(t,"__propKey",(function(){return d})),r.d(t,"__setFunctionName",(function(){return f})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return m})),r.d(t,"__generator",(function(){return h})),r.d(t,"__createBinding",(function(){return g})),r.d(t,"__exportStar",(function(){return v})),r.d(t,"__values",(function(){return S})),r.d(t,"__read",(function(){return y})),r.d(t,"__spread",(function(){return C})),r.d(t,"__spreadArrays",(function(){return R})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return N})),r.d(t,"__asyncGenerator",(function(){return T})),r.d(t,"__asyncDelegator",(function(){return P})),r.d(t,"__asyncValues",(function(){return E})),r.d(t,"__makeTemplateObject",(function(){return k})),r.d(t,"__importStar",(function(){return A})),r.d(t,"__importDefault",(function(){return I})),r.d(t,"__classPrivateFieldGet",(function(){return _})),r.d(t,"__classPrivateFieldSet",(function(){return F})),r.d(t,"__classPrivateFieldIn",(function(){return M}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,i,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),f=!1,p=r.length-1;p>=0;p--){var m={};for(var h in n)m[h]="access"===h?{}:n[h];for(var h in n.access)m.access[h]=n.access[h];m.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var g=(0,r[p])("accessor"===l?{get:d.get,set:d.set}:d[u],m);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=a(g.get))&&(d.get=s),(s=a(g.set))&&(d.set=s),(s=a(g.init))&&i.push(s)}else(s=a(g))&&("field"===l?i.push(s):d[u]=s)}c&&Object.defineProperty(c,n.name,d),f=!0}function c(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function R(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function N(e){return this instanceof N?(this.v=e,this):new N(e)}function T(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof N?Promise.resolve(r.value.v).then(l,u):c(o[0][2],r)}catch(e){c(o[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:N(e[n](t)),done:!1}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return O(t,e),t}function I(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function F(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.getCharCodeBits=t.location=t.value=t.types=t.PackageName=void 0,t.PackageName="excel-online-calc-lang",t.types=r(47),t.value=r(56),t.location=r(30);var n=r(142);Object.defineProperty(t,"getCharCodeBits",{enumerable:!0,get:function(){return n.getCharCodeBits}}),t.worksheetFuncTypesModule=r(96),t.adjust=r(262),t.annotations=r(265),t.cellFormat=r(77),t.cellParse=r(97),t.config=r(145),t.mathpackXL=r(149),t.datepack=r(146),t.formulaModule=r(24),t.numfmt=r(98),t.util=r(37),t.resolveService=r(99),t.resolveServiceTypes=r(79),t.literalParse=r(143),t.signature=r(65),t.mathpack=r(150),t.visitor=r(66),t.relabel=r(272),t.mathpackIEEE=r(273),t.printService=r(274),t.printServiceTypes=r(151),t.testUtil=r(277),t.styleServiceTypes=r(278)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0,t.PackageName="excel-online-calc-common";var n=r(213);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return n.fnv1a}});var i=r(130);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return i.JSF32}});var o=r(214);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return o.findIsomorphicSubtrees}});var a=r(215);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return a.combinations}});var s=r(90);t.anonymizer=s;var l=r(91);t.util=l;var u=r(46);t.assertions=u;var c=r(63);t.featureConfiguration=c;var d=r(29);t.core=d;var f=r(235);t.testUtil=f;var p=r(236);t.arrayMapTree=p;var m=r(133);t.binaryHeap=m;var h=r(134);t.bspSet=h;var g=r(237);t.deque=g;var v=r(238);t.dictionary=v;var S=r(239);t.hashSet=S;var y=r(240);t.hashTable=y;var C=r(241);t.histogram=C;var R=r(136);t.interval=R;var b=r(242);t.priorityQueue=b;var N=r(243);t.productSet=N;var T=r(244);t.rbMapTree=T;var P=r(137);t.rbTree=P;var E=r(245);t.ringBuffer=E;var k=r(246);t.rTree=k;var O=r(247);t.split=O;var A=r(64);t.table=A,t.arrayUtils=r(248),t.async=r(249),t.asyncLoopModule=r(250),t.setTimeoutInterfaceModule=r(138),t.codePoint=r(251),t.config=r(252),t.resolvablePromise=r(140),t.stopwatch=r(139),t.promise=r(94);var I=r(254);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return I.mixin}}),t.result=r(95),t.unicode=r(255),t.wrapIntoAsyncModule=r(256),t.arrayLogger=r(257),t.testConfig=r(258),t.machine=r(141),t.pledge=r(259),t.testUtils=r(260),t.revocableSingleton=r(261)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.tokenizeFormulaModule=t.token=t.parseStructRefModule=t.parserState=t.parserService=t.parseResultHelperModule=t.parseRefModule=t.parser=t.parseQualifierModule=t.parseOperators=t.parseLiteralModule=t.parseFormulaModule=t.parseFieldRefModule=t.parseCommon=t.parseServiceTypes=t.analyzeServiceTypes=t.diagnostics=t.checker=t.autocorrect=t.analyzeService=t.PackageName=void 0,t.PackageName="excel-online-calc-syntax",t.analyzeService=r(279),t.autocorrect=r(154),t.checker=r(152),t.diagnostics=r(101),t.analyzeServiceTypes=r(157),t.parseServiceTypes=r(158),t.parseCommon=r(33),t.parseFieldRefModule=r(104),t.parseFormulaModule=r(159),t.parseLiteralModule=r(162),t.parseOperators=r(61),t.parseQualifierModule=r(161),t.parser=r(40),t.parseRefModule=r(160),t.parseResultHelperModule=r(285),t.parserService=r(286),t.parserState=r(48),t.parseStructRefModule=r(163),t.token=r(31),t.tokenizeFormulaModule=r(164),t.util=r(165)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(216);t.utils=n;var i=r(55);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var o=r(217);t.browserSupport=o;var a=r(218);t.perfWatch=a;var s=r(219);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var l=r(223);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return l.initStopwatchFactory}});var u=r(224);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return u.TelemetryCollector}});var c=r(225);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return c.getNewGuid}});var d=r(226);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}});var f=r(227);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return f.replaceChildren}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.unicode=t.testData=t.serviceTypes=t.ribbonFormat=t.render=t.parsedate=t.parseconst=t.parse=t.localeData=t.knownFormat=t.impl=t.formulaBar=t.formatService=t.eval=t.edit=t.PackageName=void 0,t.PackageName="excel-online-calc-numfmt",t.edit=r(107),t.eval=r(168),t.formatService=r(294),t.formulaBar=r(172),t.impl=r(170),t.knownFormat=r(71),t.localeData=r(171),t.parse=r(174),t.parseconst=r(108),t.parsedate=r(111),t.render=r(113),t.ribbonFormat=r(297),t.serviceTypes=r(41),t.testData=r(298),t.unicode=r(82),t.util=r(173)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wildcard=t.webFuncs=t.volatileFuncs=t.funcsUtil=t.funcsTestUtils=t.stringFuncs=t.referenceFuncs=t.reduce=t.recordFuncs=t.rangeFuncs=t.predicateFuncs=t.numfmtFuncs=t.mathFuncs=t.lookupFuncs=t.logicalFuncs=t.lambdaFuncs=t.informationFuncs=t.getWorksheetFuncModule=t.engineeringFuncs=t.dateTimeFuncs=t.criteria=t.aggregationFuncs=t.visitedMap=t.value=t.util=t.testUtils=t.term=t.subexpressionEvaluation=t.serviceTypes=t.rtree=t.machine=t.extensionTypes=t.evaluatorService=t.evalTypes=t.evalFormula=t.evalCell=t.evalRuntime=t.evalFunction=t.dereferenceModule=t.compilerService=t.coerce=t.calcChain=t.PackageName=void 0,t.PackageName="excel-online-calc-runtime",t.calcChain=r(299),t.coerce=r(115),t.compilerService=r(116),t.dereferenceModule=r(117),t.evalFunction=r(178),t.evalRuntime=r(119),t.evalCell=r(120),t.evalFormula=r(121),t.evalTypes=r(12),t.evaluatorService=r(303),t.extensionTypes=r(76),t.machine=r(20),t.rtree=r(175),t.serviceTypes=r(27),t.subexpressionEvaluation=r(305),t.term=r(36),t.testUtils=r(306),t.util=r(17),t.value=r(53),t.visitedMap=r(44),t.aggregationFuncs=r(185),t.criteria=r(186),t.dateTimeFuncs=r(189),t.engineeringFuncs=r(191),t.getWorksheetFuncModule=r(184),t.informationFuncs=r(192),t.lambdaFuncs=r(193),t.logicalFuncs=r(194),t.lookupFuncs=r(195),t.mathFuncs=r(126),t.numfmtFuncs=r(196),t.predicateFuncs=r(197),t.rangeFuncs=r(198),t.recordFuncs=r(199),t.reduce=r(188),t.referenceFuncs=r(200),t.stringFuncs=r(201),t.funcsTestUtils=r(315),t.funcsUtil=r(54),t.volatileFuncs=r(202),t.webFuncs=r(203),t.wildcard=r(87)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gridinterface=t.helpers=t.mockGlobals=t.notificationKinds=t.schedulerVersion=t.testUtils=t.mockTimer=t.timelineQueueProcessor=t.repeatedTaskScheduler=t.types=t.smartCompletionEwaFacadeModule=t.formulaAssistanceModule=t.dynamicPluginLoaderEwaFacadeModule=t.definedNameInfoEwaFacadeModule=t.smartCompletionDefinitions=t.pluginSchedulerFactoryDefinitionModule=t.functionInfoDTO=t.formulaAssistanceDefinitionsModule=t.fieldInfoDataDTO=t.dynamicPluginLoaderDefinitionsModule=t.definedNameInfoDefinitionsModule=t.PackageName=void 0,t.PackageName="excel-online-x10-types",t.definedNameInfoDefinitionsModule=r(322),t.dynamicPluginLoaderDefinitionsModule=r(323),t.fieldInfoDataDTO=r(324),t.formulaAssistanceDefinitionsModule=r(325),t.functionInfoDTO=r(326),t.pluginSchedulerFactoryDefinitionModule=r(327),t.smartCompletionDefinitions=r(328),t.definedNameInfoEwaFacadeModule=r(329),t.dynamicPluginLoaderEwaFacadeModule=r(330),t.formulaAssistanceModule=r(331),t.smartCompletionEwaFacadeModule=r(23),t.types=r(332),t.repeatedTaskScheduler=r(205),t.timelineQueueProcessor=r(207),t.mockTimer=r(333),t.testUtils=r(335),t.schedulerVersion=r(337),t.notificationKinds=r(338),t.mockGlobals=r(339),t.helpers=r(342),t.gridinterface=r(343)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(92),t),n.__exportStar(r(231),t),n.__exportStar(r(93),t),n.__exportStar(r(232),t),n.__exportStar(r(233),t),n.__exportStar(r(234),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(1);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(2);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(1);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ES5IterableStackFrame=t.ES5IterableStackValue=t.stackFrameList=t.stackMapList=t.emptyStackEnv=t.LazyOper=t.evalLocalsSlice=t.evalLocalsFirstOrderFunc=t.evalLocalsLambda=t.evalLocalsName=t.evalLocalsGrid=t.evalUsage=t.bottomEvalPrecedents=t.handleEvaluationError=t.throwEvaluationError=t.EvaluationError=t.unevaluated=t.RuntimeInternalReasonKind=void 0;var n,i=r(0),o=r(27),a=r(9),s=r(14),l=r(10),u=r(11),c=r(20),d=r(13),f=r(16),p=r(84);function m(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(n=t.RuntimeInternalReasonKind||(t.RuntimeInternalReasonKind={})),t.unevaluated=function(e){return 0===e.length&&(0,l.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:n.Unevaluated,anchors:e}},t.EvaluationError=(0,a.createFailureErrorClass)("EvaluationError"),t.throwEvaluationError=m,t.handleEvaluationError=function(e,t,r){var i;switch(r.kind){case n.Unevaluated:if(t.map.getCount()+1>(null!==(i=e.globals.limits.maxCellChain)&&void 0!==i?i:1/0))return(0,f.failure)((0,o.limitExceeded)(o.LimitKind.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,void 0,t,r,!0)}));return(0,c.callMachineTransition)(new c.AllMachine(a),(0,c.nextOnSuccessReceiver)());default:return(0,f.failure)(r)}},t.bottomEvalPrecedents=function(){return(0,u.precedents)([],[],[],d.SpecialPrecs.None,u.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){var t=(0,a.sheetGridRangeAnchor)(e.range),r=(0,f.success)(t.range),n=(0,f.success)(t.sheet);return(0,o.evalLocals)(e,r,n,e.kind===s.LexicalKind.Range,r,n,e.kind===s.LexicalKind.Cell,!0,!1,(0,f.success)(!1),void 0)},t.evalLocalsName=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=(0,f.success)(n);else{var i=t.originSheet;if(!(0,f.isSuccess)(i))return m(i.reason);r=(0,a.isDocumentLocEqual)(i.value.document,n.document)?i:(0,f.success)(n)}var s=t.originGridCell;return(0,o.evalLocals)(e,s,r,t.calcingArray,s,r,!1,!1,!0,(0,f.success)(!1),void 0)},t.evalLocalsLambda=function(e,t){return(0,o.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,f.success)(!1),void 0)},t.evalLocalsFirstOrderFunc=function(e,t){var r=t.originGridCell,n=t.originSheet,i=t.calcingArray,a=t.reflectionGridCell,s=t.reflectionSheet,l=t.implicitIntersect,u=t.allowUnqualifiedCell,c=t.wrapCellReferences,d=t.followHyperlinks;return(0,o.evalLocals)(e,r,n,i,a,s,l,u,c,d,void 0)},t.evalLocalsSlice=function(e){var t=e.lexicalSource,r=e.originGridCell,n=e.originSheet,i=e.calcingArray,a=e.reflectionGridCell,s=e.reflectionSheet,l=e.implicitIntersect,u=e.allowUnqualifiedCell,c=e.wrapCellReferences,d=e.followHyperlinks,f=e.contextNames;return(0,o.evalLocals)(t,r,n,i,a,s,l,u,c,d,f)};var h=function(){function e(e){this.fallback=e}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?this.fallback():this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueOrUndefined",{get:function(){return this._value},enumerable:!1,configurable:!0}),e}();t.LazyOper=h,t.emptyStackEnv=p.RedBlackMapTree.create((function(e,t){return e-t})),t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,i){var o;return{stackDepth:1+(null!==(o=null==i?void 0:i.stackDepth)&&void 0!==o?o:0),lexicalSource:e,position:t,localValues:new g(r,n),caller:i}};var g=function(){function e(e,t){this.stackEnv=e,this.stackMap=t}return e.prototype.iterator=function(){var e,t,r,n,a,s;return i.__generator(this,(function(i){switch(i.label){case 0:e=this.stackEnv.getCount()-1,t=this.stackMap,i.label=1;case 1:if(void 0===t)return[3,6];r=t.numPushed-1,i.label=2;case 2:return r>=0?(n=t.labels[r],a=this.stackEnv.getValue(e--),void 0===n||void 0===a||void 0===(s=a instanceof h?a.valueOrUndefined:a)?[3,4]:[4,(0,o.stackValue)(n,s)]):[3,5];case 3:i.sent(),i.label=4;case 4:return r--,[3,2];case 5:return t=t.next,[3,1];case 6:return[2]}}))},e}();t.ES5IterableStackValue=g;var v=function(){function e(e){this.leafFrame=e}return e.prototype.iterator=function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:e=this.leafFrame,t.label=1;case 1:return void 0===e?[3,4]:[4,e];case 2:t.sent(),t.label=3;case 3:return e=e.caller,[3,1];case 4:return[2]}}))},e}();t.ES5IterableStackFrame=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(1);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(1);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";r.r(t);var n=r(0);function i(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return o(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function s(e){return{name:e.name,message:i(e)?e.baseMessage:e.message,stack:e.stack,info:i(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function l(e){return o(e)?{isError:!0,value:s(e)}:{isError:!1,value:e}}var u=function(e){function t(t,r){var i,o=this.constructor,a=this;(a=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify(Object(n.__assign)(Object(n.__assign)({},r),{error:null===(i=r.error)||void 0===i?void 0:i.message}))))||this).baseMessage=t,a.info=r,a.name="WorkerError";var s=o.prototype;return Object.getPrototypeOf(a)!==s&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,s):a.__proto__=s),a}return Object(n.__extends)(t,e),t.isWorkerError=i,t}(Error);var c={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){var t;if("WorkerError"===e.name)t=new u(e.message,function(e){return Object(n.__assign)(Object(n.__assign)({},e),{error:e.error?d(e.error):void 0})}(e.info));else{var r=c[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function f(e){return e.isError?d(e.value):e.value}var p;function m(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function h(e){if(p)throw new TypeError("setConfig has already been called");p=e}function g(){var e=null!=p?p:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function v(e){setTimeout((function(){throw e}))}function S(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function y(e){var t=S();if(void 0!==t){var r={kind:1,error:l(e)};t.postMessage(r)}else console.warn(e)}function C(e){var t;try{(null!==(t=null==p?void 0:p.onWorkerError)&&void 0!==t?t:y)(e)}catch(t){console.warn(e),v(t)}}function R(e){var t=S();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function b(e){var t;try{(null!==(t=null==p?void 0:p.onCreateWorker)&&void 0!==t?t:R)(e)}catch(e){v(e)}}var N=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return N.transfer.apply(N,Object(n.__spreadArray)([e,void 0],t,!1))};N.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var T=r(8),P=Object(T.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(T.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});function E(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}var k;function O(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function A(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function I(){return null!=k?k:k=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function _(e,t){var r=A(),n=P("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,r){var n;return"then"===r?void 0:null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)}:function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function F(e){throw e}var M=-1,D=function(){function e(e,t){var r,n,i=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=A();var o=function(){var e;return null===(e=i.onClose)||void 0===e?void 0:e.call(i)},a=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r=e.funcNames;null===(t=i.onImports)||void 0===t||t.call(i,_(i.createPostProxy.bind(i),r),_(i.createCallProxy.bind(i),r))},r[3]=o,r),s=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=o,n[3]=o,n);this.port.onmessage=function(e){var t=e.data;return a[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return s[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:I()?void 0:function(e){for(var t=A();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var i=n[r];try{"function"==typeof e[i]&&(t[i]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,i={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new u("Importing Endpoint closed while waiting for ".concat(n," result"),i))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,i=e.args,o=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,i);var o=r>=0?"call":"post",a={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new u("Exporting Endpoint received a ".concat(o," to unknown function ").concat(n),a)}));r>=0?o.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):o.catch((function(e){var i=a(e),o={cause:"UnhandledError",idInfo:t.idInfo,error:i,callId:r,funcName:n};C(new u("Exporting Endpoint's ".concat(n," implementation threw or rejected"),o))}))},e.prototype.sendResult=function(e,t,r,n){var i={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:l(n)};try{this.port.postMessage(i,void 0)}catch(e){this.onSendResultFailed(i,a(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,i=e.resultValue,o=t?"Exporting Endpoint failed to send ".concat(n," result"):"Importing Endpoint failed to deserialize ".concat(n," result"),a={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},s=new u(o,a);i.isError?C(s):this.sendResult(r,n,!1,s)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var i=this;if(r>1<<30)return n;return O(r,(function(){var n=i.takeCallbacks(e);if(n){var o={cause:"Timeout",idInfo:i.idInfo,timeout:r,callId:e,funcName:t};n.reject(new u("Importing Endpoint's call to ".concat(t," timed out"),o))}}),n)},e.prototype.sendCall=function(e,t,r,i){var o=this;return new Promise((function(s,l){var c=M+=1,d={kind:0,callId:c,funcName:e,args:t};o.unresolvedCalls[c]=Object(n.__assign)(Object(n.__assign)({},o.setCallTimeout(c,e,r,{resolve:s,reject:l})),{funcName:e});try{o.port.postMessage(d,i)}catch(t){var f=o.takeCallbacks(c);if(f){var p=a(t),m={cause:"MessageError",idInfo:o.idInfo,error:p,callId:c,funcName:e};f.reject(new u("Importing Endpoint failed to send call to ".concat(e),m))}}}))},e.prototype.sendPost=function(e,t,r,n){var i={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(i,n)}catch(t){var o=a(t),s={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new u("Importing Endpoint failed to post to ".concat(e),s))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,i=r>=0?"call":"post",o={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},a=new u("Exporting Endpoint failed to deserialize ".concat(i," to ").concat(n),o),s=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==s?void 0:s.reject)&&void 0!==t?t:C)(a)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,i=e.resultValue;if(t>=0){var o=this.takeCallbacks(t);if(o)(n?o.resolve:o.reject)(f(i))}else{var a={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};C(new u("Exporting Endpoint sent a result for a post to ".concat(r),a))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,o,a,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(!t.isClosed){var u=null!==(a=null!==(i=r.onPostMessageError)&&void 0!==i?i:null===(o=t.getOnPostMessageError)||void 0===o?void 0:o.call(t))&&void 0!==a?a:F;t.sendPost(e,s,u,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,o,a,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(t.isClosed){var c={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new u("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),c))}var d=null!==(a=null!==(i=r.callTimeout)&&void 0!==i?i:null===(o=t.getCallTimeout)||void 0===o?void 0:o.call(t))&&void 0!==a?a:1/0;return t.sendCall(e,s,d,n)},r.callTimeout=void 0,r},e}();var w=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=F,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new u("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(r," Endpoint started"),n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var i,o,a=r.port,s=r.options,l=r.createMode,c={type:"Endpoint",side:t,id:null==s?void 0:s.id};try{i=new D(c,a),o=new e(c,i,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;i.getCallTimeout=function(){return o.callTimeout},i.getOnPostMessageError=function(){return o.onPostMessageError},i.onImports=function(e,t){Object.defineProperties(o,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},i.onClose=function(){return o.close("Force")};var l,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==p?void 0:p.createTimeout)&&void 0!==r?r:3e5}(s),f=O(d,(function(){var e="Outside"===t?"inside":"outside",r={cause:"Timeout",idInfo:c,timeout:d},n=new u("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),r);f.reject(n)}),{resolve:e,reject:r});o._closedDuringCreate=function(){f.resolve()};try{l=n(o)}catch(e){return f.reject(e)}null===(a=o._state)||void 0===a||a.setExports(l)})).then((function(){return o._closedDuringCreate=void 0,o}),(function(e){return o._closedDuringCreate=void 0,o.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new u("".concat(this._idInfo.side," Endpoint's close called during creation"),n)}this._closedDuringCreate()}var i=this._state;this._state=void 0;try{i.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:a(e)};C(new u("".concat(this._idInfo.side," Endpoint's close threw an error"),n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}(),L='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return T})),r.d(t,"__asyncValues",(function(){return P})),r.d(t,"__makeTemplateObject",(function(){return S})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return void 0===n.globalThis.__get_feature_gate_dictionary_variable?o:n.globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return void 0===n.globalThis.__get_change_gate_dictionary_variable?{}:n.globalThis.__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function T(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return T(!0)}),(function(e){return T(!1,e)}))}catch(e){T(!1,e)}}}]);',x=-1;var B=function(){function e(e,t){var r,n;try{var i;r=function(e){var t="def"in e?e:N(e),r=t.def,n=t.args,i=t.transferables;if("function"!=typeof r)return[r,n,i,void 0];var o="__generatedInsideInit".concat(x+=1);return[{scriptUrl:void 0,insideInitName:o},n,i,"var ".concat(o," = ").concat(r.toString(),";")]}(t),this.script=r[0],this.args=r[1],this.transferables=r[2];var o=void 0===(i=r[3])?[L]:[i,"\n\n",L];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));var a={};null!=e.id&&(a.name=e.id),this.worker=new Worker(this.blobUrl,a)}catch(e){throw null===(n=this.worker)||void 0===n||n.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,a=e.port,s=e.options,l={type:"Thread",side:"Outside",id:s.id},c=this.worker;return E(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var p={config:g(),port:a,options:s,script:r.script,args:r.args,featureGateDictionary:Object(T.getFeatureGateDictionary)(),changeGateDictionary:Object(T.getChangeGateDictionary)()};c.postMessage(p,Object(n.__spreadArray)([a],r.transferables,!0)),c.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(o(r.error)){if(i(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new u("".concat(t," received an unhandled error"),n)}if(null==r.message){var a={cause:"UnhandledError",idInfo:e};return new u("".concat(t," received a non-error (worker script fetch probably failed)"),a)}var s={cause:"UnhandledError",idInfo:e},l="".concat(r.message," at ").concat(r.filename,":").concat(r.lineno,":").concat(r.colno);return new u("".concat(t," received an unhandled error: ").concat(l),s)}(l,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):C(t)},c.onmessage=function(e){var n,i,o=e.data;switch(o.kind){case 0:return t.insideInit=o.stopwatch,void 0===o.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(i=r.createCallbacks)||void 0===i?void 0:i.reject(f(o.error));case 1:return C(f(o.error));case 2:return b(o.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),U="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function G(){return{status:"Pending",start:U()}}function K(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:U()))}function V(e,t){function r(t){throw K(e,i(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=K(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function j(e){return Math.round(1e3*e)/1e3}function W(e,t,r){return e<t?t:e>r?r:e}function H(e,t,r){var n,i,o,a=W(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),s=W(null!==(i=null==e?void 0:e.end)&&void 0!==i?i:1/0,t,r);return{status:null!==(o=null==e?void 0:e.status)&&void 0!==o?o:"Pending",start:j(a-t),end:j(s-t),duration:j(s-a)}}function Q(e,t,r,n,i){var o,a=new MessageChannel,s=a.port1,l=a.port2;return Promise.all([n({port:s,options:e,createMode:t}),V(r.createOutside=G(),(function(){return w.createOutside({port:l,options:e,createMode:t},(function(e){return i(o=e)}))}))]).then((function(){return o}),(function(e){return o?o.close("Force"):l.close(),Promise.reject(e)}))}function q(e,t,i,o){return Q(e,"Local",t,(function(e){return function(e,t,i){var o="def"in i?i:N(i),a=o.def,s=o.args;if("function"!=typeof a){var l={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new u("Loading an InsideScript to create a local worker is unimplemented",l))}return Promise.resolve().then((function(){return V(t.insideInit=G(),(function(){return Promise.resolve().then(r.bind(null,15)).then((function(t){return a.apply(void 0,Object(n.__spreadArray)([{config:g(),importTypedWorkers:function(){return t},connection:e}],s,!1)).then((function(){}))}))}))}))}(e,t,i)}),o)}function z(e,t,r,n){var i;t.createThread=G();try{i=new B(e,r)}catch(e){return K(t.createThread,"Error"),Promise.reject(e)}return K(t.createThread,"Success"),Q(e,"Thread",t,(function(e){return i.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?i.terminate():e._onClose=i.terminate.bind(i),e}),(function(e){return i.terminate(),Promise.reject(e)}))}function Y(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==p?void 0:p.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?m()?"Thread":"Local":n}(e),i="local"in t?"Local"===n?t.local:t.thread:t,o="Local"===n?q:z,a={id:e.id,createMode:n,createWorker:G()};return E(V(a.createWorker,(function(){return o(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),a,i,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,i=e.insideInit,o=e.createOutside,a=e.createThread,s=n.status,l=n.start,u=n.end;if("Pending"!==s&&void 0!==u)return{id:t,createMode:r,createWorker:{status:s,absStart:l,duration:j(u-l)},createThread:"Thread"===r?H(a,l,u):void 0,createOutside:H(o,l,u),insideInit:H(i,l,u)}}(a);e&&b(e)}))}function J(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var i=e.slice(0,n+1),o=e.slice(n+1).split("&"),a=0;a<o.length&&("="!==o[a][t.length]||o[a].slice(0,t.length)!==t);a+=1);return o[a]="".concat(t,"=").concat(r),i+o.join("&")}function X(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?J(e,"retries",String(n)):e)}catch(e){r=e}throw r}function $(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){X(n[r],t)}else importScripts.apply(void 0,e)}function Z(){return"undefined"!=typeof WorkerGlobalScope}function ee(){return self.name}r.d(t,"WorkerError",(function(){return u})),r.d(t,"isThreadingSupported",(function(){return m})),r.d(t,"setConfig",(function(){return h})),r.d(t,"dispatchWorkerError",(function(){return C})),r.d(t,"paramInsideDef",(function(){return N})),r.d(t,"Endpoint",(function(){return w})),r.d(t,"createWorker",(function(){return Y})),r.d(t,"importScriptsWithRetry",(function(){return $})),r.d(t,"isWorkerThread",(function(){return Z})),r.d(t,"workerName",(function(){return ee}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(2);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayLift=t.makeStrict=t.gridRangeAnchorHash=t.broadcastWriteOper=t.isEmptyStringOper=t.emptyStringOper=t.traceErrorOper=t.writeOperType=t.singleWriteOperType=void 0;var n=r(35),i=r(11),o=r(9),a=r(14),s=r(21),l=r(20),u=r(13),c=r(10),d=r(74);t.singleWriteOperType=u.OperKind.Number|u.OperKind.String|u.OperKind.Boolean|u.OperKind.Error|u.OperKind.Rich,t.writeOperType=t.singleWriteOperType|u.OperKind.Array,t.traceErrorOper=function(e,t,r){var n="".concat(e,": generated Excel error, type ").concat(t,"; ").concat(r);c.ulsLogger.ULS.traceTag(596120270,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,n)},t.emptyStringOper=(0,i.stringOper)(""),t.isEmptyStringOper=function(e){return(0,o.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){var a=(0,o.isArrayOper)(r)?(0,n.broadcastArray)(r.rows,r.cols,e,t,r.opers,i.naErrorOper):(0,n.constantArray)(e,t,r);return(0,i.arrayOper)(e,t,a)},t.gridRangeAnchorHash=function(e){return a.sheetCols*e.row+e.col},t.makeStrict=function(e){var t=function(e){return e&~(u.OperKind.Array|u.OperKind.Range)};return(0,u.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,a){for(var c=0,d=0,f=0;f<a.length;f+=1){var p=a[f];(0,o.isArrayOper)(p)&&0==((0,o.getArgType)(t,f,a.length)&u.OperKind.Array)?(c=(0,s.fastMax)(c,p.rows),d=(0,s.fastMax)(d,p.cols)):(c=(0,s.fastMax)(c,1),d=(0,s.fastMax)(d,1))}var m=a.map((function(r,a,s){return function(e,t,r,o,a){switch(o.kind){case u.OperKind.Missing:case u.OperKind.Blank:return(0,n.constantArray2D)(t,r,e.zero);case u.OperKind.Array:return 0!=(a&u.OperKind.Array)?(0,n.constantArray2D)(t,r,o):(0,n.broadcastArray2D)(t,r,new n.StrictArray2D(o.rows,o.cols,o.opers),i.naErrorOper);case u.OperKind.Range:default:return(0,n.constantArray2D)(t,r,o)}}(e.mathpack,c,d,r,(0,o.getArgType)(t,a,s.length))}));return(0,l.machineCall)(new l.ArrayMachine(e,c,d,(function(e,t){return r(m.map((function(r){return r.get(e,t)})))})))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(2);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.contextNameNode=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=void 0;var n=r(1);t.SyntaxFeature=n.formulaModule.SyntaxFeature,t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.singleLineComment=n.formulaModule.singleLineComment,t.multiLineComment=n.formulaModule.multiLineComment,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.contextNameNode=n.formulaModule.contextNameNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refToVal=t.ArrayMachine=t.ThenMachine=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0;var n,i=r(0),o=r(11),a=r(10),s=r(176),l=r(9),u=r(16),c=r(13);function d(e){return e.kind===n.MachineCall}i.__exportStar(r(176),t),t.singleReadOperType=c.OperKind.Number|c.OperKind.String|c.OperKind.Boolean|c.OperKind.Error|c.OperKind.Blank|c.OperKind.Rich,t.readOperType=t.singleReadOperType|c.OperKind.Array,function(e){e.MachineCall="MachineCall"}(n=t.MachineCallKind||(t.MachineCallKind={})),t.machineCall=function(e){return{kind:n.MachineCall,machine:e}},t.isMachineCall=d;var f=function(){function e(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}return e.prototype.next=function(){var e;try{if(void 0===this.oper1){var t=this.f1();if(d(t))return(0,s.callMachineTransition)(t.machine,this);this.oper1=t}if(void 0===this.oper2){var r=this.f2(this.oper1);if(d(r))return(0,s.callMachineTransition)(r.machine,this);this.oper2=r}return(0,u.success)(this.oper2)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,u.failure)((0,u.javaScriptError)(t))}},e.prototype.receiveResult=function(e){return(0,u.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),this.next()):e},e}();t.ThenMachine=f;var p=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var r=this.context.coerceOper(m(this.context,this.toDeref,!0),t.readOperType);(0,a.assertTrue)("calc.runtime.ArrayMachine.next",!(0,l.isMissingOper)(r)&&!(0,l.isRangeOper)(r)),(0,l.isArrayOper)(r)&&(r=r.opers[0][0]),this.row.push(r),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,u.success)((0,o.arrayOper)(this.rows,this.cols,this.opers));var n=this.func(this.opers.length,this.row.length);return d(n)?(0,s.callMachineTransition)(n.machine,this):(this.toDeref=n,s.nextTransition)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,u.failure)((0,u.javaScriptError)(t))}},e.prototype.receiveResult=function(e){return(0,u.isSuccess)(e)?(this.toDeref=e.value,this.next()):e},e}();function m(e,t,r){if(!(0,l.isRangeOper)(t))return t;if(!(0,l.isSheetIndex)(t.sheets))return o.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,l.isGridCell)(t.ranges[0])?e.dereferenceOper(t,c.SignatureType.All&~c.OperKind.Range):e.dereferenceOper(t,c.OperKind.Array);var n=e.dereferenceOper(t,c.SignatureType.All&~(c.OperKind.Range|c.OperKind.Array));return(0,l.isArrayOper)(n)?o.naErrorOper:n}t.ArrayMachine=p,t.refToVal=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(2);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(2);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginSchedulerResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(t.EditorMessageType||(t.EditorMessageType={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(t.MessageType||(t.MessageType={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.AutocompletePrecisionMeasurements=1e3]="AutocompletePrecisionMeasurements",e[e.AutocompleteGroundTruthMeasurements=1002]="AutocompleteGroundTruthMeasurements",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.AutocompleteAuthoringPrecisionMeasurements=1006]="AutocompleteAuthoringPrecisionMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin"}(t.PluginFactoryName||(t.PluginFactoryName={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(t.PluginGroup||(t.PluginGroup={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(t.PluginAttachGroup||(t.PluginAttachGroup={})),function(e){e[e.Done=0]="Done",e[e.Superseded=1]="Superseded"}(t.PluginSchedulerResultKind||(t.PluginSchedulerResultKind={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(t.PerCharacterExperimentResultKind||(t.PerCharacterExperimentResultKind={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(t.HighlightKind||(t.HighlightKind={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(t.PositionKind||(t.PositionKind={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(t.ValuePreviewResultKind||(t.ValuePreviewResultKind={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=void 0;var n,i,o,a,s,l,u,c,d,f=r(0),p=r(25),m=r(18),h=r(18);function g(e){return Array.isArray(e)}function v(e){return void 0!==e.kind}function S(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],o=i.arg,a=i.index;(0,p.assertIndex)("calc.lang.flattenNumberedArgs: idx",a,e.length),(0,p.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[a]),t[a]=o}return t}function y(e,t,r){return S((0,h.safeConcat)(f.__spreadArray(f.__spreadArray([],void 0===t?[]:[t],!0),r,!0),e.map((function(e){return[e.name,e.binder]}))))}function C(e,t){return{arg:e,index:t}}function R(e,t){return{name:e,binder:t}}function b(e,t,r){return void 0===r&&(r=[]),S(f.__spreadArray(f.__spreadArray(f.__spreadArray([],e.map((function(e){return e.name})),!0),void 0===t?[]:[t],!0),r,!0))}function N(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:s.ParamName,label:n,name:e,isBracketed:t,isClosed:r}}function T(e,t,r){return void 0===r&&(r=0),{kind:s.Param,label:r,name:e,whole:e.name.kind===s.Name?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}}function P(e){return{name:e}}function E(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,i="string"==typeof e?k(e,!0):e;return{kind:s.Name,label:r,whole:n,parts:i,qualifier:t}}function k(e,t,r,n){return void 0===t&&(t=!0),void 0===r&&(r=0),void 0===n&&(n=0),{kind:l.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}}function O(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),(0,p.assertTrue)("calc.lang.fieldRef","string"==typeof e||e.kind!==s.Name||void 0===e.qualifier),{kind:s.FieldRefRHS,label:n,field:"string"==typeof e?E(e):e,isBracketed:t,isClosed:r}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(t.RefStyle||(t.RefStyle={})),function(e){e.Comments="Comments",e.Statements="Statements"}(t.SyntaxFeature||(t.SyntaxFeature={})),function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(n=t.QualifierKind||(t.QualifierKind={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(i=t.CellRefKind||(t.CellRefKind={})),function(e){e.Abs="Abs",e.Rel="Rel"}(t.PosKind||(t.PosKind={})),function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(o=t.CommentKind||(t.CommentKind={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(a=t.AnnotationKind||(t.AnnotationKind={})),t.appHeadNameAnnotation={kind:a.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF",e.Param="Param",e.ContextName="ContextName",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(s=t.NodeKind||(t.NodeKind={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(l=t.NamePartKind||(t.NamePartKind={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(u=t.SpecialRefId||(t.SpecialRefId={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(c=t.StructRefKind||(t.StructRefKind={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.Missing="Missing",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(d=t.BadType||(t.BadType={})),t.errorQualifier=function(e){return void 0===e&&(e=0),{kind:n.Error,isQuoted:!1,label:e}},t.relativeQualifier=function(e){return void 0===e&&(e=0),{kind:n.Relative,isQuoted:!1,label:e}},t.documentQualifier=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=0),{kind:n.Document,isQuoted:r,label:i,document:e,path:t}},t.sheetQualifier=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=0),{kind:n.Sheet,isQuoted:r,label:i,sheet:e,document:t}},t.identQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:n.Ident,isQuoted:t,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,i,o){return void 0===i&&(i=!1),void 0===o&&(o=0),{kind:n.SheetRange,isQuoted:i,label:o,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:n.Bad,isQuoted:t,label:r,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e){return void 0===e&&(e=0),{kind:i.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:i.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:i.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:A(e)}},t.singleLineComment=function(e,t){return void 0===t&&(t=0),{kind:o.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:o.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,n,i,o){return(0,p.assertNatural)("calc.lang.formulaSpan",e),(0,p.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,p.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(t)),{start:e,end:t,pre:r,post:n,preComments:i,postComments:o}},t.localNameUseAnnotation=function(e,t,r){return{kind:a.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r){return void 0===r&&(r=[]),{kind:a.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:a.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:s.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=y,t.indexedArg=C,t.letVar=R,t.letNode=function(e,t,r,n,i,o){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===o&&(o=0),(0,p.assertTrue)("calc.lang.letNode",t.every((function(e){return void 0===(g(e)?e[0]:e.name.arg).qualifier})));var a=t.map((function(e,t){return g(e)?R(C(e[0],2*t),C(e[1],2*t+1)):e})).sort((function(e,t){return e.name.index-t.name.index})),l=void 0!==r&&v(r)?C(r,2*t.length):r,u=y(a,l,n);return{kind:s.Let,label:o,head:e,args:u,isClosed:i,vars:a,body:l,badArgs:n}},t.flattenLambdaArgs=b,t.paramName=N,t.paramDefault=function(e,t){return void 0===t&&(t=0),{kind:s.ParamDef,label:t,rhs:e}},t.paramNode=T,t.lambdaParam=P,t.lambdaNode=function(e,t,r,n,i,o){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===o&&(o=0),(0,p.assertTrue)("calc.lang.lambdaNode",t.every((function(e){var t=v(e)?e:e.name.arg,r=t.kind===s.Name?t:t.name.name;return r.kind!==s.Name||void 0===r.qualifier})));var a=t.map((function(e,t){return v(e)?e.kind===s.Name?P(C(T(N(e,!1),void 0),t)):P(C(e,t)):e})).sort((function(e,t){return e.name.index-t.name.index})),l=void 0!==r&&v(r)?C(r,t.length):r,u=b(a,l,n);return{kind:s.Lambda,label:o,head:e,args:u,isClosed:i,params:a,body:l,badArgs:n}},t.operatorNode=function(e,t){return void 0===t&&(t=0),{kind:s.Operator,label:t,id:e}},t.wsfNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.Paren,label:r,node:e,isClosed:t}},t.nameNode=E,t.identNamePart=k,t.cellRefNamePart=function(e,t,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),{kind:l.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r,n,i){var o,a;void 0===r&&(r=!0),void 0===n&&(n=0),void 0===i&&(i=0);var u="string"==typeof t?O(t,!1,!0):t;return(0,p.assertTrue)("calc.lang.fieldRefNamePart",(null===(o=null==u?void 0:u.isClosed)||void 0===o||o)&&!(null!==(a=null==u?void 0:u.isBracketed)&&void 0!==a&&a)),{kind:l.FieldRefNamePart,label:n,qualifiedLabel:i,asWhole:e.asWhole+"."+(void 0===u?"":u.field.kind===s.Name?u.field.whole:u.field.contents),canDenoteNamedObject:r,lhs:e,rhs:u}},t.flattenNameParts=function(e){for(var t=[e],r=t[0];r.kind===l.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){for(var t=e;t.kind===l.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t){return void 0===t&&(t=0),{kind:s.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:s.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}},t.fieldRef=O,t.structRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r){return void 0===r&&(r=0),{kind:c.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t){var r;void 0===t&&(t=0);for(var n=((r={})[u.All]=!1,r[u.Data]=!1,r[u.Headers]=!1,r[u.Totals]=!1,r[u.ThisRow]=!1,r),i=[],o=0,a=e;o<a.length;o++){var s=a[o];switch(s.kind){case c.SpecialRef:n[s.id]=!0;break;case c.ColumnRef:case c.RangeOpRef:i.push(s)}}return{kind:c.CommaOpRef,label:t,refs:e,specialRefs:n,columnRefs:i}},t.thisRowOpRef=function(e,t){return void 0===t&&(t=0),{kind:c.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e){return void 0===e&&(e=0),{kind:c.MissingRef,label:e}},t.badRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.BadRef,contents:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.badNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.Bad,label:r,type:e,contents:t}};function A(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case s.Array:for(var n=0,i=0,o=t.nodes;i<o.length;i++)for(var a=0,l=o[i];a<l.length;a++){var u=l[a];n=(0,m.fastMax)(n,e(u,r+1))}return n+1;case s.Param:return void 0===t.def?1:e(t.def.rhs,r+1)+1;case s.Let:case s.Lambda:case s.App:n=e(t.head,r+1);for(var c=0,f=t.args;c<f.length;c++){var h=f[c];n=(0,m.fastMax)(n,e(h,r+1))}return n+1;case s.Paren:return e(t.node,r+1)+1;case s.FieldRef:return e(t.lhs,r+1)+1;case s.Name:case s.CellRef:case s.StructRef:case s.Literal:case s.Operator:case s.WSF:return 1;case s.Bad:switch(t.type){case d.Sequence:case d.StructRef:case d.FieldRef:n=0;for(var g=0,v=t.contents;g<v.length;g++){var S=v[g];n=(0,m.fastMax)(n,e(S,r+1))}return n+1;default:return"string"==typeof t.contents?1:(0,p.assertNever)("calc.lang.getDepthUpperBound",t.contents)}default:return(0,p.assertNever)("calc.lang.getDepthUpperBound",t)}}(e,0)}t.getDepthUpperBound=A},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(2);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(2);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEvalFailureReason=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.breaked=t.paused=t.limitExceeded=t.previousNameFailure=t.previousFailure=t.cellCycle=t.nameCycle=t.evalLocals=t.evalGlobals=t.userDefinedFunc=t.stopped=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.illFormedFormula=t.LimitKind=t.StepAction=t.RuntimePositionKind=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.compileLocalsName=t.compileLocalsGrid=t.createCompileGlobals=t.ReasonKind=void 0;var n,i,o,a,s=r(0),l=r(10),u=r(21),c=r(9),d=r(14),f=r(73),p=r(16),m=r(114);!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(n||(n={})),t.ReasonKind=s.__assign(s.__assign(s.__assign(s.__assign({},c.ReasonKind),n),f.FormatReasonKind),m.ResolveReasonKind),t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,p.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:null!=t?t:void 0,lexicalKind:d.LexicalKind.NameManager,originGridCell:(0,p.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.interval=(0,u.typedInstanceCreator)()((function(e,t){return(0,l.assertPositiveInteger)("calc.runtime.interval: end",t),(0,l.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}})),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(i=t.CellKind||(t.CellKind={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(o=t.Interrupt||(t.Interrupt={})),t.stackValue=(0,u.typedInstanceCreator)()((function(e,t){return{label:e,value:t}})),function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"}(a=t.RuntimePositionKind||(t.RuntimePositionKind={})),function(e){e.Continue="Continue",e.Break="Break"}(t.StepAction||(t.StepAction={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(t.LimitKind||(t.LimitKind={})),t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:i.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:i.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.stopped={kind:t.ReasonKind.Stopped},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,n,i,a,s,l,u,d,f,m,h,g,v,S,y,C,R,b,N,T,P,E,k,O,A,I,_,F){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:i,getNameLoc:a,getUserDefinedFuncLoc:s,getCellValue:l,getCellValues:u,getWorksheetFunc:d,getUserDefinedFunc:f,getNameFormula:m,getCellFormula:h,getUsedRange:g,interruptToken:[o.Continue],tryGetHiddenRows:v,tryGetHiddenCols:S,isInFilterMode:y,getKnownFormat:C,getIformat:R,getFormatString:b,getRandom:N,getTime:T,schedulerConfig:null!=_?_:{},limits:null!=F?F:{},setCellValue:P,setCellValues:E,setCellFailure:k,getContainingTable:O,getStructRefColumn:A,getStructRefSpecialRef:I,getIntersectingTables:function(){return(0,p.failure)((0,c.notImplemented)(["getIntersectingTables"]))}}},t.evalLocals=(0,u.typedInstanceCreator)()((function(e,t,r,n,i,o,a,s,l,u,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:a,allowUnqualifiedCell:s,wrapCellReferences:l,followHyperlinks:u,contextNames:c}})),t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:p.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:p.ResultKind.Breaked,resume:e}},t.runtimePositionLetVal=function(e,t){return{kind:a.LetVar,varNamePosition:e,varBinderPosition:t}},t.runtimePositionLambdaRoot=function(e,t,r){return{kind:a.LambdaRoot,lambdaNodePosition:e,head:t,args:r}},t.runtimePositionLambdaParam=function(e,t){return{kind:a.LambdaParam,paramNodePosition:e,paramNamePosition:t}},t.runtimePositionFormulaRoot={kind:a.FormulaRoot},t.runtimePositionFirstOrderFunc={kind:a.FirstOrderFunc},t.getEvalFailureReason=function(e){if(e.kind===p.ResultKind.Failure)return e.reason.kind}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(1);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(63);function i(){return function(e){return e}}function o(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function a(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function s(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];e.push(i)}return e}function l(e){return null!=e}t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=i,t.staticAssertIsOptional=function(e){return e},t.identity=function(e){return e},t.makeStringMap=o,t.cloneStringMap=function(e){var t=o();for(var r in e)t[r]=e[r];return t},t.numEnumArray=a,t.numEnumMap=function(e,t){for(var r={},n=0,i=a(e);n<i.length;n++){var o=i[n];r[o]=t(o)}return r},t.strEnumArray=function(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()},t.safePush=s,t.safeConcat=function(e,t){var r=[];s(r,e);for(var n=0,i=t;n<i.length;n++){s(r,i[n])}return r},t.isDefined=l,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(l)};t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(e){return e}};var u="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:"undefined"!=typeof process&&null!=process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:function(){return Date.now()},c="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};t.now=(0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS")?u:c,t.singleton=function(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()},t.mapFromArrayOfPairs=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;var n,i=r(2),o=i.assertions.assertIndex,a=i.assertions.assertPositiveLength,s=i.assertions.assertFalse;function l(e){return{kind:n.Cell,range:e}}function u(e){return{kind:n.Range,range:e}}function c(e,t,r){return{document:e,index:t,index2:r}}function d(e,t){return c(e,t,t)}function f(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function p(e,t){return{sheet:e,range:t}}function m(e){return{document:e,index:void 0}}function h(e){return e.index===e.index2}function g(e){return 1===e.rows&&1===e.cols}function v(e){return g(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(n=t.LexicalKind||(t.LexicalKind={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(t.NameSource||(t.NameSource={})),t.lexicalSourceCell=l,t.lexicalSourceRange=u,t.lexicalSourceGrid=function(e,t){switch(e){case n.Cell:return v(t)?l(t):s("calc.lang.lexicalSourceGrid: expected cell");case n.Range:return u(t)}},t.lexicalSourceName=function(e){return{kind:n.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:n.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:n.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=c,t.sheetIndex=d,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=f,t.gridRange=function(e,r,n,i){return o("calc.lang.gridRange",e,t.sheetRows),o("calc.lang.gridRange",r,t.sheetCols),a("calc.lang.gridRange",n,t.sheetRows-e),a("calc.lang.gridRange",i,t.sheetCols-r),f(e,r,n,i)},t.gridCell=function(e,r){return o("calc.lang.gridCell",e,t.sheetRows),o("calc.lang.gridCell",r,t.sheetCols),f(e,r,1,1)},t.sheetGridCube=p,t.sheetGridRange=p,t.sheetGridCell=p,t.originCell=p,t.documentScope=m,t.nameScope=function(e,t){return void 0===t?m(e):d(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=h,t.isGridCell=g,t.isSheetGridRange=function(e){return h(e.sheet)},t.isSheetGridCell=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;var n,i,o,a,s=r(52),l=r(19),u=r(39),c=r(51),d=r(60),f=r(68),p=r(81),m=f.codePointAsterisk,h=f.codePointMinusSign,g=f.codePointPlusSign,v=f.codePointSlash,S=f.codePointSpace;function y(e){return e.kind===a.BadNumber||e.kind===c.OperKind.Number}function C(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(n=t.TokenKind||(t.TokenKind={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(i=t.DelimId||(t.DelimId={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(o=t.SepId||(t.SepId={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(a=t.TokenOperKind||(t.TokenOperKind={})),t.isBadNumberOper=function(e){return e.kind===a.BadNumber},t.isNumberLikeOper=y,t.badNumberOper={kind:a.BadNumber},t.isBadErrorOper=function(e){return e.kind===a.BadError},t.badErrorOper={kind:a.BadError};t.endToken=function(e){return C(n.End,e,"",!1)};t.spacesToken=function(e,t){return C(n.Spaces,e,t,!1)};t.unexpectedToken=function(e,t){return C(n.Unexpected,e,t,!1)};t.escapeToken=function(e,t){return C(n.Escape,e,t,!1)};t.singleLineCommentToken=function(e,t){return C(n.SingleLineComment,e,t,!1)};t.multiLineCommentToken=function(e,t,r){return{kind:n.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}};function R(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}t.identToken=function(e,t){return C(n.Ident,e,t,!0)};t.leftParenToken=function(e){return R(n.Left,e,"(",i.Paren)};t.leftBracketToken=function(e,t){return R(n.Left,e,t,i.Bracket)};t.leftBraceToken=function(e,t){return R(n.Left,e,t,i.Brace)};t.leftSQuoteToken=function(e){return R(n.Left,e,"'",i.SQuote)};t.rightParenToken=function(e){return R(n.Right,e,")",i.Paren)};t.rightBracketToken=function(e,t){return R(n.Right,e,t,i.Bracket)};t.rightBraceToken=function(e,t){return R(n.Right,e,t,i.Brace)};t.rightSQuoteToken=function(e){return R(n.Right,e,"'",i.SQuote)};t.listSepToken=function(e,t){return R(n.Sep,e,t,o.List)};t.colSepToken=function(e,t){return R(n.Sep,e,t,o.Col)};t.rowSepToken=function(e,t){return R(n.Sep,e,t,o.Row)};t.qualSepToken=function(e){return R(n.Sep,e,"!",o.Qual)};t.dotSepToken=function(e){return R(n.Sep,e,".",o.Dot)};t.assignSepToken=function(e){return R(n.Sep,e,":=",o.Assign)};function b(e,t,r,i,o,a,s){return{kind:n.CellRef,start:e,chars:t,isIdentContinue:r,row:i,col:o,refStyle:a,isBadLocale:s}}function N(e,t,r,i){void 0===i&&(i=!0);var o=r.kind===c.OperKind.Boolean||y(r)&&function(e){for(var t=0,r=(0,d.codePointIterator)(e);t<r.length;t++){var n=r[t];if(n===g||n===h||n===m||n===S||n===v)return!1}return!0}(t);return{kind:n.Literal,start:e,chars:t,isIdentContinue:o,oper:r,hasRight:i}}function T(e,t,r){return{kind:n.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function P(e){var t=s.operatorStrings[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator ".concat(e));return function(r){return T(r,t,e)}}t.specialRefToken=function(e,t,r){return R(n.SpecialRef,e,t,r)},t.cellRefA1Token=function(e,t,r,n){return b(e,t,(null==r||"object"==typeof r&&r.kind===l.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===l.PosKind.Rel),r,n,l.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,i){return void 0===i&&(i=!1),b(e,t,!(r!==p.SpecialPos.RCNoNum&&null!=r&&r.kind!==l.PosKind.Abs||n!==p.SpecialPos.RCNoNum&&null!=n&&n.kind!==l.PosKind.Abs),r,n,l.RefStyle.R1C1,i)},t.literalToken=N,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?N(r,n,u.falseOper):0===e.stringCompareCI(e.trueName,n)?N(r,n,u.trueOper):(0,t.identToken)(r,n)},t.operatorToken=T,t.addOperatorToken=P(s.OperatorId.Add),t.subOperatorToken=P(s.OperatorId.Sub),t.mulOperatorToken=P(s.OperatorId.Mul),t.divOperatorToken=P(s.OperatorId.Div),t.powOperatorToken=P(s.OperatorId.Pow),t.percentOperatorToken=P(s.OperatorId.Percent),t.concatOperatorToken=P(s.OperatorId.Concat),t.eqOperatorToken=P(s.OperatorId.Eq),t.ltOperatorToken=P(s.OperatorId.Lt),t.gtOperatorToken=P(s.OperatorId.Gt),t.neOperatorToken=P(s.OperatorId.Ne),t.leOperatorToken=P(s.OperatorId.Le),t.geOperatorToken=P(s.OperatorId.Ge),t.rangeOperatorToken=P(s.OperatorId.Range),t.atOperatorToken=P(s.OperatorId.At),t.poundOperatorToken=P(s.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(2);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;var n=r(50),i=r(22),o=r(39),a=r(52),s=r(31),l=r(40),u=r(51);function c(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.Dot}function d(e){return e.kind===s.TokenKind.Operator&&e.value===a.OperatorId.Range}function f(e){return e.kind===s.TokenKind.Operator&&e.value===a.OperatorId.At}function p(e){return e.kind===s.TokenKind.Left&&e.value===s.DelimId.Bracket}function m(e){return(e.kind===s.TokenKind.Left||e.kind===s.TokenKind.Right)&&e.value===s.DelimId.Bracket}function h(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}t.isDotSepToken=c,t.isListSepToken=function(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.List},t.isRangeOpToken=d,t.isAtOpToken=f,t.isRefErrorToken=function(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===u.OperKind.Error&&e.oper.type===o.ErrorType.REF},t.isLeftBracketToken=p,t.isRightBracketToken=function(e){return e.kind===s.TokenKind.Right&&e.value===s.DelimId.Bracket},t.isBracketToken=m,t.isCommentToken=function(e){return e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment},t.isWhitespaceToken=h,t.parseWhitespace=(0,l.many)((0,l.take)((function(e,t){return h(t)?t:void 0}))),t.parseSpacesOnly=(0,l.opt)((0,l.take)((function(e,t){return t.kind===s.TokenKind.Spaces?t.chars:void 0})),"");function g(e){return(0,l.take)((function(t,r){return r.kind===s.TokenKind.Sep&&r.value===e?r:void 0}))}function v(e){return(0,l.take)((function(t,r){return r.kind===s.TokenKind.Left&&r.value===e?r:void 0}))}function S(e){return(0,l.take)((function(t,r){return r.kind===s.TokenKind.Right&&r.value===e?r:void 0}))}t.parseCharIndex=function(e,t,r,o,a){var s=e[t];if(null==s){var l="calc.parse.pStart: internal error: expected token at ".concat(t," in ").concat((0,n.anonymize)(e));return(0,i.assertFalse)(l)}return o(s.start,t)},t.parseListSep=g(s.SepId.List),t.parseRowSep=g(s.SepId.Row),t.parseColSep=g(s.SepId.Col),t.parseQualSep=g(s.SepId.Qual),t.parseDotSepToken=g(s.SepId.Dot),t.parseAssignToken=g(s.SepId.Assign),t.parseLeftParen=v(s.DelimId.Paren),t.parseRightParen=S(s.DelimId.Paren),t.parseLeftBrace=v(s.DelimId.Brace),t.parseRightBrace=S(s.DelimId.Brace),t.parseLeftSQuote=v(s.DelimId.SQuote),t.parseRightSQuote=S(s.DelimId.SQuote),t.parseLeftBracket=v(s.DelimId.Bracket),t.parseRightBracket=S(s.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,l.takePeek)((function(e,t,r){return c(t)&&!p(r)?t:void 0})),t.parseRangeOp=(0,l.take)((function(e,t){return d(t)?t:void 0})),t.parseAtOp=(0,l.take)((function(e,t){return f(t)?t:void 0})),t.parseEscape=(0,l.take)((function(e,t){return t.kind===s.TokenKind.Escape?t:void 0})),t.parseEnd=(0,l.take)((function(e,t){return t.kind===s.TokenKind.End?t:void 0})),t.parseIdentContinue=(0,l.apply)((0,l.many1)((0,l.take)((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:(0,s.identToken)(r.start,t.map((function(e){return e.chars})).join(""))}));var y=(0,l.take)((function(e,t){return m(t)||t.kind===s.TokenKind.End?void 0:t})),C=(0,l.lazy)((function(){return(0,l.flatten)((0,l.many)((0,l.any)((0,l.many1)(y),(0,l.concat)((0,l.tuple)(t.parseLeftBracket),C,(0,l.opt)((0,l.tuple)(t.parseRightBracket),[])))))}));t.parseBracketedTokens=(0,l.apply)((0,l.tuple)(t.parseLeftBracket,C,t.parseCharIndex,(0,l.opt)(t.parseRightBracket,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],i=t[3];return r.push((0,s.endToken)(n)),[r,void 0!==i]}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(1);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strictArray2D=t.singletonArray2D=t.rowArray2D=t.jaggedArray=t.constantArray2D=t.constantArray=t.colArray2D=t.broadcastArray2D=t.broadcastArray=t.array2DToJaggedArray=t.array2DForall2=t.array2DForall=t.StrictSparseArray2D=t.StrictArray2D=t.NonstrictSparseArray2D=t.NonstrictArray2D=void 0;var n=r(2);t.NonstrictArray2D=n.arrayUtils.NonstrictArray2D,t.NonstrictSparseArray2D=n.arrayUtils.NonstrictSparseArray2D,t.StrictArray2D=n.arrayUtils.StrictArray2D,t.StrictSparseArray2D=n.arrayUtils.StrictSparseArray2D,t.array2DForall=n.arrayUtils.array2DForall,t.array2DForall2=n.arrayUtils.array2DForall2,t.array2DToJaggedArray=n.arrayUtils.array2DToJaggedArray,t.broadcastArray=n.arrayUtils.broadcastArray,t.broadcastArray2D=n.arrayUtils.broadcastArray2D,t.colArray2D=n.arrayUtils.colArray2D,t.constantArray=n.arrayUtils.constantArray,t.constantArray2D=n.arrayUtils.constantArray2D,t.jaggedArray=n.arrayUtils.jaggedArray,t.rowArray2D=n.arrayUtils.rowArray2D,t.singletonArray2D=n.arrayUtils.singletonArray2D,t.strictArray2D=n.arrayUtils.strictArray2D},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.transformBottomUp=t.isOperTerm=t.postStepTerm=t.callMachineTerm=t.callFirstOrderFuncTerm=t.callLambdaTerm=t.callNameTerm=t.noopTerm=t.conditionalTerm=t.readStackTerm=t.structRefTerm=t.cellRefTerm=t.udfTerm=t.nameTerm=t.appTerm=t.letTerm=t.lambdaTerm=t.arrayTerm=t.isOperatorName=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0;var o,a=r(0),s=r(21),l=r(10),u=r(85);function c(e,t){return{kind:e,data:void 0,children:void 0,position:t}}function d(e,t,r,n){var i=c(o.Array,n);return i.children=r,i.data={rows:e,cols:t},i}function f(e,t,r,n,i,a,s){(0,l.assertTrue)("calc.runtime.lambdaTerm",a.length===i.length+1),(0,l.assertTrue)("calc.runtime.lambdaTerm",r.length===t),(0,l.assertTrue)("calc.runtime.lambdaTerm",n.length===t);var u=c(o.Lambda,s);return u.children=a,u.data={maxArity:t,minArity:e,paramNodeLabels:r,paramNameLabels:n,defIdxs:i},u}function p(e,t,r,n,i){(0,l.assertTrue)("calc.runtime.letTerm",e.length===r.length);var s=c(o.Let,i);return s.children=a.__spreadArray(a.__spreadArray([],e,!0),[n],!1),s.data={rec:t,varLabels:r},s}function m(e,t,r,n,i){var a=c(o.App,i);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function h(e,t,r,n,i){var a=c(o.Name,i);return a.data={name:e,qualifier:t,source:r},a.children=n,a}function g(e,t,r,n){var i=c(o.Udf,n);return i.data={name:e,qualifier:t},i.children=r,i}function v(e,t,r,n,i,s){var l=c(o.Conditional,s);return l.children=a.__spreadArray([n],i,!0),l.data={funName:e,funType:t,isFormulaRoot:r},l}function S(e,t){var r=c(o.Noop,t);return r.children=e,r}function y(e){return e.kind>0}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"}(o=t.TermKind||(t.TermKind={})),t.operatorIdToName=(n=(0,s.makeNewtypeIso)(s.identity,s.identity)).wrap,t.operatorNameToId=n.unwrap,t.worksheetFunctionIdToName=(i=(0,s.makeNewtypeIso)((function(e){return-e}),(function(e){return-e}))).wrap,t.worksheetFunctionNameToId=i.unwrap,t.isOperatorName=function(e){return e>0},t.arrayTerm=d,t.lambdaTerm=f,t.letTerm=p,t.appTerm=m,t.nameTerm=h,t.udfTerm=g,t.cellRefTerm=function(e,t,r){var n=c(o.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){var r=c(o.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){var r=c(o.ReadStack,t);return r.data=e,r},t.conditionalTerm=v,t.noopTerm=S,t.callNameTerm=function(e,t,r){var n=c(o.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,i){var a=c(o.CallLambda,void 0);return a.children=i,a.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},a},t.callFirstOrderFuncTerm=function(e,t,r){var n=c(o.CallFirstOrderFunc,void 0);return n.children=r,n.data={source:e,caller:t},n},t.callMachineTerm=function(e,t){var r=c(o.CallMachine,t);return r.data={machine:e},r},t.postStepTerm=c(o.PostStep,void 0),t.isOperTerm=y,t.transformBottomUp=function(e,t){function r(e){if(y(e))return u.Pledge.resolve(e);switch(e.kind){case o.Let:return u.Pledge.all(e.children.map(n)).bind((function(t){return p(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.position)}));case o.App:return u.Pledge.all(e.children.map(n)).bind((function(t){return m(e.data.funName,e.data.funType,e.data.isFormulaRoot,t,e.position)}));case o.Conditional:return u.Pledge.all(e.children.map(n)).bind((function(t){var r=t[0],n=t.slice(1);return v(e.data.funName,e.data.funType,e.data.isFormulaRoot,r,n,e.position)}));case o.Lambda:return u.Pledge.all(e.children.map(n)).bind((function(t){return f(e.data.minArity,e.data.maxArity,e.data.paramNodeLabels,e.data.paramNameLabels,e.data.defIdxs,t,e.position)}));case o.Array:return u.Pledge.all(e.children.map((function(e){return u.Pledge.all(e.map(n))}))).bind((function(t){return d(e.data.rows,e.data.cols,t,e.position)}));case o.Name:return(void 0===e.children?u.Pledge.resolve(void 0):n(e.children)).bind((function(t){return h(e.data.name,e.data.qualifier,e.data.source,t,e.position)}));case o.Udf:return(void 0===e.children?u.Pledge.resolve(void 0):n(e.children)).bind((function(t){return g(e.data.name,e.data.qualifier,t,e.position)}));case o.CellRef:case o.StructRef:case o.ReadStack:return u.Pledge.resolve(e);case o.Noop:return n(e.children).bind((function(t){return S(t,e.position)}));default:return(0,l.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return u.Pledge.resolve(e).bind(r).bind(t)}return u.Pledge.settleOrThrow(n(e))}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanNode=t.isNumberNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.getSubExpressionFromPosition=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;var i=r(0),o=r(25),a=r(30);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return a.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return a.isSheetGridCell}});var s=r(24),l=r(47),u=r(57),c=r(18),d=r(263),f=r(65),p=r(30);function m(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,s=t.row,l=t.col,u=t.rows,d=t.cols,f=(0,c.fastMin)(r,s),p=(0,c.fastMin)(n,l),m=(0,c.fastMax)(r+i,s+u)-f,h=(0,c.fastMax)(n+o,l+d)-p;return(0,a.unsafeGridRange)(f,p,m,h)}function h(e,t){return e===t||e.name===t.name&&e.path===t.path}function g(e,t){return h(e.document,t.document)&&e.index===t.index}function v(e,t){return e.row===t.row&&e.col===t.col}function S(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function y(e){return(0,a.isGridCell)(e)?e:(0,a.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return p.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return p.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,a.isGridCell)(e))return t(e,0,0);for(var r=e.row,n=e.rows,i=e.col,o=e.cols,s=0;s<n;s+=1)for(var l=0;l<o;l+=1)if(!t((0,a.gridCell)(r+s,i+l),s,l))return!1;return!0},t.forEachTileInRange=function(e,t,r){var n=e.row,i=e.rows,s=e.col,l=e.cols;(0,o.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,o.assertIndex)("calc.lang.forEachTileInRange",n,a.sheetRows),(0,o.assertIndex)("calc.lang.forEachTileInRange",s,a.sheetCols),(0,o.assertPositiveLength)("calc.lang.forEachTileInRange",i,a.sheetRows-n),(0,o.assertPositiveLength)("calc.lang.forEachTileInRange",l,a.sheetCols-s);for(var u=n;u<n+i;u+=t)for(var d=s;d<s+l;d+=t)if(!r((0,a.unsafeGridRange)(u,d,(0,c.fastMin)(t,i+n-u),(0,c.fastMin)(t,l+s-d))))return!1;return!0},t.gridRangeJoin=m,t.gridRangeJoinOpt=function(e,t){return e?t?m(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,o.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(m)},t.gridRangeIsect=function(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,s=t.row,l=t.col,u=t.rows,d=t.cols,f=(0,c.fastMax)(r,s),p=(0,c.fastMax)(n,l),m=(0,c.fastMin)(r+i,s+u)-f,h=(0,c.fastMin)(n+o,l+d)-p;if(!(m<=0||h<=0))return(0,a.unsafeGridRange)(f,p,m,h)},t.gridRangeIsects=function(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,a=t.row,s=t.col,l=t.rows,u=t.cols;return(0,c.fastMax)(r,a)<(0,c.fastMin)(r+i,a+l)&&(0,c.fastMax)(n,s)<(0,c.fastMin)(n+o,s+u)},t.gridCellImplicitIsect=function(e,t){var r=e.row,n=e.col,i=t.row,o=t.col,s=t.rows,l=t.cols,u=i<=r&&r<i+s,c=o<=n&&n<o+l;return u&&c?(0,a.gridCell)(r,n):u&&1===l?(0,a.gridCell)(r,o):c&&1===s?(0,a.gridCell)(i,n):1===l&&1===s?(0,a.gridCell)(i,o):void 0},t.gridRangeCompare=function(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,a=t.row,s=t.col,l=r+i,u=a+t.rows,c=n+o,d=s+t.cols;return r===a&&l===u&&n===s&&c===d?0:r<=a&&l>=u&&n<=s&&c>=d?1:r>=a&&l<=u&&n>=s&&c<=d?-1:void 0},t.gridRangeExcept=function(e,t){var r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],i=[t.row,t.row+t.rows],o=[t.col,t.col+t.cols],s=(0,d.ivlCompare)(r,i),l=(0,d.ivlCompare)(n,o);if(void 0!==s&&s<=0){var u=(0,d.ivlExcept)(n,o);if(void 0!==u)return(0,a.gridRange)(e.row,u[0],e.rows,u[1]-u[0])}if(void 0!==l&&l<=0){var c=(0,d.ivlExcept)(r,i);if(void 0!==c)return(0,a.gridRange)(c[0],e.col,c[1]-c[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=h,t.isSheetIndexEqual=g,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return i.__assign(i.__assign({},e),{__isRange:!1})},t.isNameScopeEqual=function(e,t){return h(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=v,t.isGridRangeEqual=S,t.isSheetGridCellEqual=function(e,t){return g(e.sheet,t.sheet)&&v(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return g(e.sheet,t.sheet)&&S(e.range,t.range)},t.gridRangeAnchor=y,t.sheetGridRangeAnchor=function(e){return(0,a.isSheetGridCell)(e)?e:(0,a.sheetGridCell)(e.sheet,y(e.range))},t.gridCellRange=function(e,t){var r=e.row,n=e.col,i=t.row,o=t.col;return(0,a.unsafeGridRange)((0,c.fastMin)(r,i),(0,c.fastMin)(n,o),Math.abs(i-r)+1,Math.abs(o-n)+1)},t.getSubExpressionFromPosition=function(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,i=!0;i;)switch(i=!1,n.kind){case s.NodeKind.Array:for(var a=n.nodes,l=a.length-1;!i&&l>=0;l-=1)for(var u=a[l],c=u.length-1;!i&&c>=0;c-=1){r(f=u[c])&&(n=f,i=!0)}break;case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:var d=n.args.map((function(e){return e.kind===s.NodeKind.Param?e.name.name:e}));for(c=d.length-1;!i&&c>=0;c-=1){r(f=d[c])&&(n=f,i=!0)}break;case s.NodeKind.Paren:var f;r(f=n.node)&&(n=f,i=!0);break;case s.NodeKind.Bad:case s.NodeKind.Name:case s.NodeKind.CellRef:case s.NodeKind.StructRef:case s.NodeKind.Literal:break;case s.NodeKind.FieldRef:r(n.lhs)&&(n=n.lhs,i=!0);break;default:(0,o.assertNever)("getSubExpressionFromPosition",n)}return n};var C=[];function R(e){return e.kind===s.NodeKind.Literal&&P(e.oper)}function b(e){return e.kind===s.NodeKind.Literal&&T(e.oper)}function N(e){return e.kind===l.OperKind.Number}function T(e){return e.kind===l.OperKind.Boolean}function P(e){return e.kind===l.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.args.length&&R(e.args[0])?0:e.args.length}(e)?C:e.args},t.isOperatorNode=function(e){return e.kind===s.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===s.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===s.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=R,t.isNumberNode=function(e){return e.kind===s.NodeKind.Literal&&N(e.oper)},t.isBooleanNode=b,t.getArgType=function(e,t,r){var n=e.maxArgs,i=e.headTypes,a=e.restTypes,s=e.tailTypes;if((0,o.assertPositiveInteger)("calc.runtime.getArgType: n",r),(0,o.assertIndex)("calc.runtime.getArgType: i",t,r),t>=n)return l.SignatureType.None;if(t<i.length)return i[t];if(0===a.length)return l.SignatureType.None;if(t<i.length+a.length)return a[t-i.length];var u=(r-i.length)%a.length;return u>s.length?l.SignatureType.None:t>=r-u?s[t-(r-u)]:a[(t-i.length)%a.length]},t.isValidArgsLength=function(e,t){var r=e.minArgs,n=e.maxArgs,i=e.headTypes,o=e.restTypes,a=e.tailTypes;return!(t<r||t>n)&&(t<=i.length+o.length||0!==o.length&&(t-i.length)%o.length<=a.length)},t.shouldFieldRefBeBracketed=function(e,t,r){return r.length>0&&t.field.kind===s.NodeKind.Name&&(b(e)||e.kind===s.NodeKind.Name||e.kind===s.NodeKind.CellRef)},t.isNumberOper=N,t.isStringOper=function(e){return e.kind===l.OperKind.String},t.isBooleanOper=T,t.isErrorOper=function(e){return e.kind===l.OperKind.Error},t.isRangeOper=function(e){return e.kind===l.OperKind.Range},t.isArrayOper=function(e){return e.kind===l.OperKind.Array},t.isMissingOper=P,t.isBlankOper=function(e){return e.kind===l.OperKind.Blank},t.isRichOper=function(e){return e.kind===l.OperKind.Rich};var E=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&E)};var k,O=E|l.OperKind.Error|l.OperKind.Array|l.OperKind.Rich;t.isWriteOper=function(e){return 0!=(e.kind&O)},t.isReadOperEqual=function e(t,r,n,i){if(n.kind!==r.kind)return!1;switch(n.kind){case l.OperKind.Boolean:case l.OperKind.String:return n.value===r.value;case l.OperKind.Number:return 0===t.cond2(n,r);case l.OperKind.Error:return n.type===r.type;case l.OperKind.Rich:return i;case l.OperKind.Array:var a=r;if(n.cols!==a.cols||n.rows!==a.rows)return!1;for(var s=0;s<n.rows;s+=1)for(var u=n.opers[s],c=a.opers[s],d=0;d<n.cols;d+=1)if(!e(t,c[d],u[d],i))return!1;return!0;case l.OperKind.Blank:return!0;default:return(0,o.assertNever)("calc.lang.readOperEq",n)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(k=t.LangReasonKind||(t.LangReasonKind={})),t.ReasonKind=i.__assign(i.__assign({},u.ReasonKind),k),t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return 0===e.length&&(0,o.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};var A="_xlfn.",I="_xlws.";t.getWorksheetFuncId=function(e,t){var r=t;return r.length>A.length&&0===e.stringCompareCI(r.substring(0,A.length),A)&&(r=r.substring(A.length)).length>I.length&&0===e.stringCompareCI(r.substring(0,I.length),I)&&(r=r.substring(I.length)),e.getWorksheetFuncId(r)};t.getUserDefinedFuncName=function(e,t){var r=t;return r.length>"_xludf.".length&&0===e.stringCompareCI(r.substring(0,"_xludf.".length),"_xludf.")&&(r=r.substring("_xludf.".length)),r};var _="_xlpm.";function F(e){return e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.BadRef||e.isBracketed}function M(e){return e.kind===s.StructRefKind.MissingRef||e.kind===s.StructRefKind.BadRef}function D(e){switch(e.kind){case s.StructRefKind.SpecialRef:case s.StructRefKind.ColumnRef:return e.isClosed;case s.StructRefKind.RangeOpRef:return D(e.lhs)&&D(e.rhs);case s.StructRefKind.MissingRef:return!0;case s.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){var r=t;return r.length>_.length&&0===e.stringCompareCI(r.substring(0,_.length),_)&&(r=r.substring(_.length)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(F)&&function(e){var t=e.specialRefs,r=Object.keys(t).reduce((function(e,r){return e+(t[Number(r)]?1:0)}),0);return 1===r||2===r&&t[s.SpecialRefId.Data]&&(t[s.SpecialRefId.Headers]||t[s.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(D)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(M)},t.isRangeOpClosed=function(e){return D(e.lhs)&&D(e.rhs)},t.isRangeOpNoMissing=function(e){return!M(e.lhs)&&!M(e.rhs)};var w=((n={})[s.SpecialRefId.All]=1,n[s.SpecialRefId.Headers]=2,n[s.SpecialRefId.Data]=3,n[s.SpecialRefId.Totals]=4,n[s.SpecialRefId.ThisRow]=5,n),L=function(e){return e.kind===s.StructRefKind.MissingRef?7:e.kind!==s.StructRefKind.SpecialRef?6:w[e.id]};function x(e,t){return L(e)-L(t)}t.normalizeCommaOpRef=function(e){for(var t={},r=[],n=0,i=e.refs;n<i.length;n++){var o=i[n];o.kind!==s.StructRefKind.SpecialRef?r.push(o):void 0===t[o.id]&&(t[o.id]=!0,r.push(o))}return r.sort(x),r},t.applyComparison=function(e,t){switch(e){case f.OperatorId.Eq:return 0===t;case f.OperatorId.Ne:return 0!==t;case f.OperatorId.Lt:return t<0;case f.OperatorId.Gt:return t>0;case f.OperatorId.Le:return t<=0;case f.OperatorId.Ge:return t>=0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(1);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(1);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;var n=r(22),i=r(50),o=r(26),a=r(67);t.runParser=function(e,t,r,a){var s;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,a,(function(e,t){s=(0,o.success)({output:e,index:t})}),(function(){s=(0,o.failure)(void 0)}))),null==s){var l=(0,i.anonymize)(t),u="calc.parse.runParser: internal error: parser did not call resolve or reject on ".concat(l);return(0,n.assertFalse)(u)}return s},t.lazy=function(e){var t;return function(r,n,i,o,a){var s=null!=t?t:t=e();return function(){return s(r,n,i,o,a)}}};var s=!1;function l(e){return function(t,r,n,i,o){return i(e,r)}}t.setDebugging=function(e){s=e},t.warnSucceedOrFail=function(e,t){return function(r,n,i,o,a){return e(r,n,i,(function(e,n){return s&&console.warn("".concat(t," succeeded, returning index ").concat(n," (of ").concat(r.length,") with"),e),o(e,n)}),(function(){return s&&console.warn("".concat(t," failed at index ").concat(n," (of ").concat(r.length,")")),a}))}},t.parseSucceed=l;var u=function(e,t,r,n,i){return i};function c(){return u}function d(e,t){return function(r,n,i,o,a){return e(r,n,i,(function(e,n){return t(i,e)(r,n,i,o,a)}),a)}}function f(e,t){return function(r,n,i,o,a){return e(r,n,i,(function(e,r){return o(t(i,e),r)}),a)}}function p(e,t){return function(r,n,i,o,a){return e(r,n,i,o,(function(){return t(r,n,i,o,a)}))}}function m(e,t){return function(r,n,i,o,a){var s=r[n];if(null==s)return a;var l=e(i,s);return null==l?a:o(l,n+t)}}function h(e,t,r){return function(o,a,s,l,u){var c=r,d=a;function f(){return e(o,d,s,p,m)}function p(e,r){if(r<=d){var a=(0,i.anonymize)(o),l="calc.parse.reduce: internal error: no progress made at index ".concat(d," on ").concat(a);return(0,n.assertFalse)(l)}return c=t(s,e,c),d=r,f}function m(){return l(c,d)}return f}}function g(e,t){return h(e,(function(e,t,r){return r.push(t),r}),t)}function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return l([]);if(1===e.length)return f(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,i,o,a){var s=n,l=[];function u(){return e[l.length](t,s,i,c,a)}function c(e,t){return s=t,l.push(e),l.length<r?u:o(l,s)}return u}}function S(e){return f(e,(function(e,t){return(0,a.safeConcat)([],t)}))}t.parseFail=c,t.bind=d,t.apply=f,t.withState=function(e){return function(t,r,n,i,o){return e(n)(t,r,n,i,o)}},t.any=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?c():e.reduce(p)},t.opt=function(e,t){return function(r,n,i,o,a){return e(r,n,i,o,(function(){return o(t,n)}))}},t.succeeds=function(e){return function(t,r,n,i,o){return e(t,r,n,(function(){return i(!0,r)}),o)}},t.fails=function(e){return function(t,r,n,i,o){return e(t,r,n,o,(function(){return i(!0,r)}))}},t.take=function(e){return m(e,1)},t.peek=function(e){return m(e,0)},t.takePeek=function(e){return function(t,r,n,i,o){var a=t[r],s=t[r+1];if(null==a||null==s)return o;var l=e(n,a,s);return null==l?o:i(l,r+1)}},t.applyTake=function(e,t){return function(r,n,i,o,a){return e(r,n,i,(function(e,r){var n=t(i,e);return null==n?a:o(n,r)}),a)}},t.reduce=h,t.many=function(e,t){return void 0===t?function(t,r,n,i,o){return g(e,[])(t,r,n,i,o)}:function(r,n,i,o,a){return e(r,n,i,(function(e,n){return g(t,[e])(r,n,i,o,a)}),(function(){return o([],n)}))}},t.many1=function(e,t){return void 0===t&&(t=e),d(e,(function(e,r){return g(t,[r])}))},t.tuple=v,t.left=function(e,t){return f(v(e,t),(function(e,t){return t[0]}))},t.right=function(e,t){return f(v(e,t),(function(e,t){return t[1]}))},t.middle=function(e,t,r){return f(v(e,t,r),(function(e,t){return t[1]}))},t.flatten=S,t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S(v.apply(void 0,e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.renderedValue=t.formattedValue=t.hashesValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.isFormatCultureEqual=t.isSystemCultureTag=t.CultureTag=t.BidiDate=t.FormatValueType=t.previousFormatFailure=t.aggregationError=t.fractionOverflow=t.dateOverflow=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0;var n,i,o,a,s,l,u=r(0),c=r(34),d=r(70),f=r(32);function p(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function m(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"}(n=t.FormatReasonKind||(t.FormatReasonKind={})),t.ReasonKind=u.__assign(u.__assign({},c.LangReasonKind),n),t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.aggregationError={kind:t.ReasonKind.AggregationError},t.previousFormatFailure=function(){return{kind:t.ReasonKind.PreviousFormatFailure}},function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(t.FormatValueType||(t.FormatValueType={})),function(e){e.English="English",e.Lunar="Lunar"}(t.BidiDate||(t.BidiDate={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(i=t.CultureTag||(t.CultureTag={})),t.isSystemCultureTag=function(e){return e===i.SysDate||e===i.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},function(e){e[e.LocaleInfo=0]="LocaleInfo"}(t.FormatCurrency||(t.FormatCurrency={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(t.NamedColor||(t.NamedColor={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(o=t.Alignment||(t.Alignment={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(t.GetTimeKind||(t.GetTimeKind={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(a=t.Clip||(t.Clip={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(s=t.FormattedUnitKind||(t.FormattedUnitKind={})),t.formattedUnitGeneral=function(e,t,r,n,i,o){return{kind:s.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:i,builtin:o}},t.formattedUnitString=function(e){return{kind:s.String,str:e}},t.formattedUnitBlank=function(e){return{kind:s.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:s.Flexible,str:e}},t.hashesValue=function(e,t){return p(e,t,o.Center,a.All)},t.formattedValue=p,t.renderedValue=p,t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=m,t.memoizedRenderCallback=function(e){var t=(0,d.makeStringMap)();return m(e.renderWidth,(function(r){if(null!=t[r])return t[r];var n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:function(e){return e.length}},t.renderedValueToString=function(e){for(var t="",r=0,n=e.units;r<n.length;r++){var i=n[r];switch(i.kind){case s.String:t+=i.str;break;case s.Blank:for(var o=0;o<i.str.length;o+=1)t+=" "}}return t},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(l=t.EditKind||(t.EditKind={})),t.formulaEdit=function(e){return{kind:l.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:l.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:l.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:l.Other,value:e}},function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(t.NumberFormatSource||(t.NumberFormatSource={})),t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){var r=(0,c.sheetGridRangeAnchor)(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:(0,f.success)(r.range),originSheet:(0,f.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(1);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(2);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordNameCycle=t.appendVisitedName=t.emptyVisitedNames=t.recordCellCycle=t.appendVisitedCell=t.emptyVisitedCells=void 0;var n=r(84),i=r(27),o=r(10);function a(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function s(e,t){return e<t?-1:e===t?0:1}function l(e,t){return"string"==typeof e?"string"!=typeof t?1:s(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function u(e,t){var r;return 0!==(r=s(e.name,t.name))?r:a(e.path,t.path,s)}function c(e,t){return{current:e,map:t}}function d(e,t){return{current:e,map:t}}t.emptyVisitedCells=c(void 0,n.RedBlackMapTree.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=l(e.sheet.index,t.sheet.index))?r:u(e.sheet.document,t.sheet.document)}))),t.appendVisitedCell=function(e,t){return(0,o.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),c(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){for(var r=[],n=(0,i.cellCycle)(r),o=t;r.push(o.cell),o.cycle=n,o!==e;o=o.previous);return r.reverse(),n},t.emptyVisitedNames=d(void 0,n.RedBlackMapTree.create((function(e,t){var r;return 0!==(r=s(e.name,t.name))||0!==(r=a(e.scope.index,t.scope.index,l))?r:u(e.scope.document,t.scope.document)}))),t.appendVisitedName=function(e,t){var r={name:t,previous:e.current};return d(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,i.nameCycle)(r)}},function(e,t){
/*! For license information please see excelHelper.js.LICENSE.txt */
(()=>{var e={1583:(e,t)=>{"use strict";var r,n;function i(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r=t.ResultKind||(t.ResultKind={})),t.success=i,t.successUndefined=i(void 0),t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},function(e){e.JavaScriptError="JavaScriptError"}(n=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(e){return{kind:n.JavaScriptError,error:e}}},8908:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var n=r(1071);function i(e){return e}function o(e,r){if("string"==typeof r&&null!=a[r])return e;var n=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),i=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===i&&(i=s[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==i?i(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(o(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: ".concat(String(JSON.stringify(e)),">");var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error ".concat(r,">"):"<error ".concat(t,": ").concat(r,">")}};var a={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:i,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol ".concat(String(e),">")},undefined:i,null:i,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function ".concat(t,">"):"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=o(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(o):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};var l=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),u=/[0-9]/g,c=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(u,"d").replace(l,"w")}},1826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.strictArray2D=t.StrictArray2D=void 0;var n=r(3319),i=r(995),o=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);var i=r.length;i<e&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(e,"; given ").concat(i));for(var o=0;o<i;o+=1){var a=r[o].length;a<t&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(o,"].length >= ").concat(e,"; given ").concat(a))}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new s(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();t.StrictArray2D=o,t.strictArray2D=function(e,t,r){return new o(e,t,r)};var a=function(){function e(e,t,r,i,o,a){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",i,t+1);var s=o.length;s<r&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(r,"; given ").concat(s));for(var l=0;l<s;l+=1){var u=o[l].length;u<i&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(l,"].length >= ").concat(i,"; given ").concat(u))}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseElements=o,this.sparseElement=a}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new l(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}();t.StrictSparseArray2D=a;var s=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=u(this.rows,this.cols,this.func);return new o(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}();t.NonstrictArray2D=s;var l=function(){function e(e,t,r,i,o,a){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",i,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseFunc=o,this.sparseFunc=a}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=u(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new a(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function u(e,t,r){for(var n=[],i=0;i<e;i+=1){for(var o=[],a=0;a<t;a+=1)o[a]=r(i,a);n[i]=o}return n}function c(e,t,r){for(var n=[],i=[],o=0;o<t;o+=1)i[o]=r;for(var a=0;a<e;a+=1)n[a]=i;return n}function d(e,t,r){return new s(e,t,(function(e,t){return r}))}t.NonstrictSparseArray2D=l,t.array2DForall=function(e,t){for(var r=0;r<t.rows;r+=1)for(var n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){for(var n=(0,i.fastMin)(t.rows,r.rows),o=(0,i.fastMin)(t.cols,r.cols),a=0;a<n;a+=1)for(var s=0;s<o;s+=1)if(!e(t.get(a,s),r.get(a,s)))return!1;return!0},t.jaggedArray=u,t.array2DToJaggedArray=function(e){return u(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,(function(t,r){return e[r]}))},t.colArray2D=function(e){return new s(e.length,1,(function(t,r){return e[t]}))},t.broadcastArray=function(e,t,r,n,i,o){if(e===r&&t===n)return i;if(1===e&&1===t)return c(r,n,void 0===i[0]?o:i[0][0]);var a,s=[];a=1===e?function(e,r){return r<t?i[0][r]:o}:1===t?function(t,r){return t<e?i[t][0]:o}:function(r,n){return r<e&&n<t?i[r][n]:o};for(var l=0;l<r;l+=1){s.push([]);for(var u=0;u<n;u+=1)s[l][u]=a(l,u)}return s},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new s(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new s(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}},3319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var n=r(1821),i=r(8515),o=r(8908);function a(e,t){return function(r,n,i,o){if(e(r,n,i,o),!i)throw new Error("".concat(t," ").concat(r," ").concat(n," ").concat(o))}}function s(e){return{shipAssertTag:a(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:a(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function l(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var u=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var r=this.callBuffer;this.callBuffer=[];var i="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(r.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i);for(var o=0,a=r;o<a.length;o++){var s=a[o];(e=t.ulsLogger.noThrowLogger)[s.method].apply(e,s.args)}}},e}(),c=function(){function e(){this.logger=new u,this.ULS=s(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:l(e.shipAssertTag.bind(e)),assertTag:l(e.assertTag.bind(e)),traceTag:l(e.traceTag.bind(e)),debugTraceTag:l(e.debugTraceTag.bind(e)),dnmTraceTag:l(e.dnmTraceTag.bind(e))}}(e),t instanceof u&&t.invokeBufferedCalls()},e}();function d(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new c,t.assertNever=function(e,r){var i=(0,o.anonymize)(r),a="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(i);return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,a)},t.assertFalse=d,t.assertTrue=function(e,t){t||d("".concat(e,": expected condition to be true"))},t.assertInteger=function(e,t){(0,i.isInteger)(t)||d("".concat(e,": expected integer; given ").concat((0,o.anonymize)(t)))},t.assertNatural=function(e,t){(!(0,i.isInteger)(t)||t<0)&&d("".concat(e,": expected natural number; given ").concat((0,o.anonymize)(t)))},t.assertPositiveInteger=function(e,t){(!(0,i.isInteger)(t)||t<=0)&&d("".concat(e,": expected positive integer; given ").concat((0,o.anonymize)(t)))},t.assertIndex=function(e,t,r){(!(0,i.isInteger)(t)||t<0||t>=r)&&d("".concat(e,": expected natural number less than ").concat((0,o.anonymize)(r),"; given ").concat((0,o.anonymize)(t)))},t.assertPositiveLength=function(e,t,r){(!(0,i.isInteger)(t)||t<=0||t>r)&&d("".concat(e,": expected positive integer at most ").concat((0,o.anonymize)(r),"; given ").concat((0,o.anonymize)(t)))}},8314:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6058:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;var n=r(995),i=r(6757),o=r(2122);function a(e){return function(t){return new Promise((function(r){return e.setTimeout(r,t,void 0)}))}}function s(e){return function(t,r){var o,a,s,l=null!==(o=null==r?void 0:r.timeThreshold)&&void 0!==o?o:10,u=null!==(a=null==r?void 0:r.costThreshold)&&void 0!==a?a:1,c=null!==(s=null==r?void 0:r.macrotaskDelay)&&void 0!==s?s:0,d={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},f=(0,i.newPromise)(),p=f[0],m=f[1],h=m[0],g=m[1],v=!0,S=e(c),y=(0,n.now)();return function r(){if(!v||!function(){try{for(var e=0;e<u;){d.iterations+=1;var r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return g(e),!1}}())return h();var i=(0,n.now)();i-y<l?(Promise.resolve().then(r),d.microtaskContinues+=1):(S.then((function(){S=e(c),y=(0,n.now)(),d.macrotaskTotalDelay+=y-i,r()})),d.macrotaskContinues+=1)}(),{promise:p,stop:function(){v=!1},stats:d}}}t.delayPromiseImpl=a,t.asyncLoopFactory=s,t.asyncLoop=s(a(o.defaultSetTimeoutInterface))},3387:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},9574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0;var n=r(655);t.combinations=function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)return[[]];for(var i=t[0],o=t.slice(1),a=e.apply(void 0,o),s=[],l=0,u=i;l<u.length;l++)for(var c=u[l],d=0,f=a;d<f.length;d++){var p=f[d];s.push(n.__spreadArray([c],p,!0))}return s}},8994:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;var n=r(655),i=r(1821),o=r(186),a=r(3319),s=r(4782),l=r(3854),u=r(8515),c=r(245),d=r(3971);t.initCalcCalled=new c.ResolvablePromise,t.maxRetriesForLoadingScript=9;var f=/^(https)|(http)|(file):\/\//,p=!1,m=void 0;function h(){if(null==m)throw new Error("initCalc was not passed calcAbsUrl");return m}function g(e,r,n,c){if(p)a.ulsLogger.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized");else{if(a.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,l.initFeatureConfiguration)(r),null!=n&&!f.test(n)){var h="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(n);a.ulsLogger.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,h)}o.setConfig(null!=c?c:{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError:function(e){var t={error:(0,u.messageFromError)(e),innerError:e.info.error?(0,u.messageFromError)(e.info.error):void 0},r="calc.onWorkerError: ".concat(JSON.stringify(t));a.ulsLogger.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: ".concat(JSON.stringify(e));a.ulsLogger.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}),m=n,p=!0;var g=" (".concat("production",")"),v="calc.config.initCalc: Calc version ".concat(d.excelOnlineCalcPackageVersion).concat(g," initialized");a.ulsLogger.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,v),t.initCalcCalled.resolve(void 0)}}t.isCalcInit=function(){return p},t.getCalcAbsUrl=function(){return m},t.getCalcAbsUrlOrThrow=h,t.initCalc=function(e,t,r){g(e,t,r,void 0)},t.initCalcInThread=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,(function(){var a;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,o.Endpoint.createOutside(e)];case 1:return a=n.sent(),g((s=a.post,l=function(e){return"[".concat((new Date).toISOString(),"] ").concat(e)},{shipAssertTag:function(e,t,r,n){s.shipAssertTag(e,t,r,l(n))},assertTag:function(e,t,r,n){s.assertTag(e,t,r,l(n))},traceTag:function(e,t,r,n){s.traceTag(e,t,r,l(n))},debugTraceTag:function(e,t,r,n){s.debugTraceTag(e,t,r,l(n))},dnmTraceTag:function(e,t,r,n){s.dnmTraceTag(e,t,r,l(n))}}),(function(e){return!0===t[e]}),r,i),[2]}var s,l}))}))},t.initCalcThread=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,i,s,u;return n.__generator(this,(function(n){switch(n.label){case 0:t=h(),r=new MessageChannel,i={port:r.port1,options:{id:"WorkerThreadLogger"}},s={port:r.port2,options:{id:"WorkerThreadLogger"}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all([o.Endpoint.createInside(i,(function(){return a.ulsLogger.noThrowLogger})),e.call.initCalcThreadInside.transfer([s.port],s,(0,l.getFeatures)(),t)])];case 2:return[2,n.sent()[0]];case 3:throw u=n.sent(),i.port.close(),u;case 4:return[2]}}))}))}},995:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(3854);function i(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function o(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function a(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];e.push(i)}return e}function s(e){return null!=e}t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=function(){return function(e){return e}},t.staticAssertIsOptional=function(e){return e},t.identity=function(e){return e},t.makeStringMap=i,t.cloneStringMap=function(e){var t=i();for(var r in e)t[r]=e[r];return t},t.numEnumArray=o,t.numEnumMap=function(e,t){for(var r={},n=0,i=o(e);n<i.length;n++){var a=i[n];r[a]=t(a)}return r},t.strEnumArray=function(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()},t.safePush=a,t.safeConcat=function(e,t){var r=[];a(r,e);for(var n=0,i=t;n<i.length;n++)a(r,i[n]);return r},t.isDefined=s,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(s)},t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(e){return e}};var l="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:"undefined"!=typeof process&&null!=process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:function(){return Date.now()},u="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};t.now=(0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS")?l:u,t.singleton=function(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()},t.mapFromArrayOfPairs=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}},1612:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(3897);function i(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}t.floorToPowerOf2=i;var o=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var i=e[0],o=e[1];return r.push([i,o,t+n])})),r.sort((function(e,r){var n=e[0],i=e[2],o=r[0],a=r[2],s=t.keyCompare(n,o);return 0!==s?s:i-a}));for(var i=[],o=void 0,a=0;a<r.length;a+=1){var s=r[a],l=s[0],u=s[1];void 0===o||0!==this.keyCompare(l,o)?(i.push([l,u]),o=l):i[i.length-1]=[l,u]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var r=t.RootPointer;r>=0&&r<this.keys.length;){var n=this.keyCompare(e,this.keys[r]);if(0===n)return r;n<0?r=l(r):n>0&&(r=u(r))}},e.prototype.ofSequence=function(r){var n=this,i=r.slice();i.sort((function(e,t){var r=e[0],i=t[0];return n.keyCompare(r,i)}));for(var o=new Array(i.length),a=new Array(i.length),l=function(e){var r=new Array(e);return s(t.RootPointer,r,0,e),r}(i.length),u=0;u<i.length;u+=1){var c=i[l[u]],d=c[0],f=c[1];o[u]=d,a[u]=f}return new e(this.keyCompare,o,a)},e}();function a(e,t){var r=[];return function e(t,r,n){r<0||r>=t.keys.length||(e(t,l(r),n),n.push([t.keys[r],t.values[r]]),e(t,u(r),n))}(e,t,r),r}function s(e,t,r,n){if(!(e>=t.length)){var o=(c=i(a=n))/2-1<=a-c?c-1:a-c/2;t[e]=r+o,s(l(e),t,r,o),s(u(e),t,r+o+1,n-o-1)}var a,c}function l(e){return 2*e+1}function u(e){return 2*e+2}t.ArrayMapTree=o,t.RootPointer=0,t.enumerateInOrder=a,t.enumerateKeysInOrder=function(e,t){return a(e,t).map((function(e){return e[0]}))}},3870:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var r=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var i=n,o=1+(n<<1),a=2+(n<<1);if(o<=r&&this.cmp(this.items[o],t)<0&&(i=o),a<=r&&this.cmp(this.items[a],i===o?this.items[i]:t)<0&&(i=a),n===i)break;this.items[n]=this.items[i],n=i}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++)if(!e(r[t]))return},e}();t.BinaryHeap=r},1937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var n,i=r(655),o=r(655).__assign;function a(e,t,r){return void 0===r&&(r=10),function(n){if(void 0!==n.split)return n.split;var i=e(n),o=n===t?0:n.depth;return void 0!==o&&o<r&&(n.split=i,i[0][0].depth=o+1,i[1][0].depth=o+1),i}}function s(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function l(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:s(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,r.root))}function u(e,r,n,i){if(i===t.empty)return n;if(i===t.dense)return i;if(n===t.empty)return i;if(n===t.dense)return n;if(n.isExact&&i.isExact){var o=function(e,r,n,i){var o=n.key,a=i.key,s=e.compare(o,a);if(void 0!==s)return s<0?i:n;var l=e.union(o,a);if(void 0!==l){var u=e.compare(l,r);return void 0!==u&&0===u?t.dense:y(e,r,l,!0)}}(e,r,n,i);if(void 0!==o)return o}var a=C(e,r,n),s=C(e,r,i),l=e.split(r),c=l[0][0],d=l[1][0];return g(e,c,d,u(e,c,a.left,s.left),u(e,d,a.right,s.right))}function c(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return i;if(n===t.dense)return i;if(i===t.dense)return n;if(n.isExact&&i.isExact){var o=function(e,r,n,i){var o=n.key,a=i.key;if(!e.meets(o,a))return t.empty;var s=e.compare(o,a);if(void 0!==s)return s<0?n:i;var l=e.intersect(o,a);return void 0!==l?y(e,r,l,!0):void 0}(e,r,n,i);if(void 0!==o)return o}var a=C(e,r,n),s=C(e,r,i),l=e.split(r),u=l[0][0],d=l[1][0];return g(e,u,d,c(e,u,a.left,s.left),c(e,d,a.right,s.right))}function d(e,r,n,i){if(n===t.empty||i===t.empty)return!1;if(n===t.dense||i===t.dense)return!0;if(n.isExact&&i.isExact)return e.meets(n.key,i.key);var o=C(e,r,n),a=C(e,r,i),s=e.split(r),l=s[0][0],u=s[1][0];return d(e,l,o.left,a.left)||d(e,u,o.right,a.right)}function f(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?s(r.setOperations,p(r.setOperations,r.setOperations.top,e,r.root)):s(e.setOperations,p(e.setOperations,e.setOperations.top,e.root,r.root))}function p(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return n;if(i===t.dense)return t.empty;if(n===t.dense){var o=C(e,r,i),a=e.split(r),s=a[0][0],l=a[1][0];return g(e,s,l,p(e,s,t.dense,o.left),p(e,l,t.dense,o.right))}if(n.isExact&&i.isExact){var u=function(e,t,r,n){var i=r.key,o=n.key;if(!e.meets(i,o))return r;var a=e.except(i,o);return void 0!==a?y(e,t,a,!0):void 0}(e,r,n,i);if(void 0!==u)return u}var c=C(e,r,n),d=C(e,r,i),f=e.split(r),m=f[0][0],h=f[1][0];return g(e,m,h,p(e,m,c.left,d.left),p(e,h,c.right,d.right))}function m(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function h(e,r,n,i){if(n===i)return 0;if(n===t.empty)return-1;if(i===t.empty)return 1;if(n===t.dense)return i===t.dense?0:1;if(i===t.dense)return-1;if(n.isExact&&i.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,i);var o=C(e,r,n),a=C(e,r,i),s=e.split(r),l=s[0][0],u=s[1][0],c=h(e,l,o.left,a.left);if(void 0!==c){var d=h(e,u,o.right,a.right);if(void 0!==d)return m(c,d)}}function g(e,r,n,i,o){return i===t.empty?o===t.empty?t.empty:o===t.dense?v(i,o,void 0,!1,e.infimum(n,n),e.supremum(n,n)):v(i,o,void 0,!1,o.infimum,o.supremum):o===t.empty?i===t.dense?v(i,o,void 0,!1,e.infimum(r,r),e.supremum(r,r)):v(i,o,void 0,!1,i.infimum,i.supremum):i===t.dense?o===t.dense?t.dense:v(i,o,void 0,!1,e.combineInfima(e.infimum(r,r),o.infimum),e.combineSuprema(e.supremum(r,r),o.supremum)):o===t.dense?v(i,o,void 0,!1,e.combineInfima(i.infimum,e.infimum(n,n)),e.combineSuprema(i.supremum,e.supremum(n,n))):v(i,o,void 0,!1,e.combineInfima(i.infimum,o.infimum),e.combineSuprema(i.supremum,o.supremum))}function v(e,t,r,n,i,o){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:o}}function S(e,r,n){if(!e.meets(r,n))return t.empty;var i=e.compare(r,n);if(void 0!==i)return i<=0?t.dense:y(e,r,n,!0);var o=e.intersect(r,n);return void 0!==o?y(e,r,o,!0):y(e,r,n,!1)}function y(e,t,r,n){return v(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function C(e,r,n){if(void 0!==n.left)return n;var i=e.split(r),a=i[0][0],s=i[1][0],l=g(e,a,s,S(e,a,n.key),S(e,s,n.key));if(l===t.empty||l===t.dense)throw new Error("incorrect set operations implementation");var u=l;return o(n,{left:u.left,right:u.right})}function R(e,r,n){return function r(i,o){if(o===t.empty)return!0;if(o===t.dense)return n(i);if(o.isExact)return n(o.key);var a=C(e,i,o),s=e.split(i),l=s[0][0],u=s[1][0];return r(l,a.left)&&r(u,a.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(n=t.SetKind||(t.SetKind={})),t.cacheKeySplitting=a,t.createFromKey=function(e){var t=i.__assign(i.__assign({},e),{split:a(e.split,e.top)});return function(e){return s(t,S(t,t.top,e))}},t.fromUntyped=s,t.union=l,t.unionUntyped=u,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:s(e.setOperations,c(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=c,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||d(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=d,t.except=f,t.exceptUntyped=p,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:h(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=m,t.compareUntyped=h,t.dense=n.Dense,t.empty=n.Empty,t.lazy=S,t.symmetricDiff=function(e,t){return l(f(e,t),f(t,e))},t.complement=function(e){return f(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:function e(r){return void 0===r||r===t.empty||r===t.dense?0:e(r.left)+e(r.right)+1}(e.root)},t.forEachKey=function(e,r){return e===t.empty||R(e.setOperations,e.root,r)},t.forEachKeyUntyped=R},2276:(e,t)=>{"use strict";function r(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var n=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var n=e>>4;if(n>=1&&this.count<n){for(t=0;t<this.count;t+=1)this.values[r(this.front+t,n)]=this.values[r(this.front+t,e)];this.values.length=n,this.front=r(this.front,n)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[r(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=r(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[r(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(e){if(!(e<0||e>=this.count))return this.values[r(this.front+e,this.values.length)]},e.prototype.popBack=function(){var e=r(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=r(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,n=0;n<this.count;n+=1)if(!e(this.values[r(this.front+n,t)]))return!1;return!0},e}();t.Deque=n},6348:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var n=r(3897),i=r(995);function o(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,i.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)?n.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue:function(e,r){var o=this.keyToString(e),a=t(this.entries,o)?this.entries[o]:void 0;(0,i.isDefined)(a)?a.value=r:this.entries[o]=(0,n.entry)(e,r)},contains:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)},remove:function(e){var r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var o=this.keyToString(e),a=t(this.entries,o)?this.entries[o]:void 0;if((0,i.isDefined)(a))return a.value;var s=r();return delete this.entries[o],this.entries[o]=(0,n.entry)(e,s),s},forEach:function(e){for(var r in this.entries){var n=t(this.entries,r)?this.entries[r]:void 0;if((0,i.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}t.makeDictionary=o,t.makeStringDict=function(){return o(i.identity)},t.makeNumberDict=function(){return o((function(e){return String(e)}))}},4642:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var n=r(995),i=r(1757);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add:function(e){var t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],o=0;o<r.length;o+=1)if(this.keyEquals(e,r[o]))return;(0,i.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(var o=0;o<r.length;o+=1)if(this.keyEquals(e,r[o]))return!0;return(0,i.logCollisionKey)(e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[Number(r)].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),o=this.map[r];if((0,n.isNone)(o))return!1;var a=[],s=!1;return o.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,s=!0):a.push(r)})),this.map[r]=a,s||(0,i.logCollisionKey)(e),s}}}},1569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var n=r(3897),i=r(1757),o=r(995);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount:function(){return this.nentries},getValue:function(e){var t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry:function(e){var t=this.keyToHash(e),r=this.map[t];if(!(0,o.isNone)(r)){for(var n=0;n<r.length;n+=1){var a=r[n];if(this.keyEquals(e,a.key))return a}(0,i.logCollisionKey)(e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,t){var r=this.keyToHash(e),o=this.map[r];if(null==o)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(var a=0;a<o.length;a+=1){var s=o[a];if(this.keyEquals(s.key,e))return void(s.value=t)}o.push((0,n.entry)(e,t)),this.nentries+=1,(0,i.logCollisionKey)(e)}},remove:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,o.isNone)(r))return!1;for(var n=[],a=!1,s=0;s<r.length;s+=1){var l=r[s];this.keyEquals(e,l.key)?(this.nentries-=1,a=!0):n.push(l)}return this.map[t]=n,a||(0,i.logCollisionKey)(e),a},getOrSetValue:function(e,t){var r=this.keyToHash(e),a=this.map[r];if((0,o.isNone)(a)){var s=t();return this.map[r]=[(0,n.entry)(e,s)],this.nentries+=1,s}for(var l=0;l<a.length;l+=1){var u=a[l];if(this.keyEquals(e,u.key))return u.value}var c=t();return a.push((0,n.entry)(e,c)),this.nentries+=1,(0,i.logCollisionKey)(e),c},forEach:function(e){var t=this;return Object.keys(this.map).every((function(r){return t.map[Number(r)].every((function(t){return e(t.key,t.value)}))}))},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}},8114:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var r=function(){function e(e){var t,r,i=this;this.buckets=e,this.createSampleCounts=function(){return new Array(i.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(t=function(e,t){return e-t},r=i.buckets.length,function(e){return n(i.buckets,0,r,e,t)})}return e.prototype.addSample=function(e){var t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e},e}();function n(e,t,r,n,i){for(var o=t,a=t+r-1;o<=a;){var s=o+(a-o>>>1),l=i(e[s],n);if(0===l)return s;l<0?o=s+1:a=s-1}return~o}t.Histogram=r,t.linearBuckets=function(e,t,r){for(var n=(t-e)/(r-1),i=[],o=e,a=0;a<r;o+=n,a+=1)i.push(o);return i},t.exponentialBuckets=function(e,t,r){for(var n=Math.log(e),i=(Math.log(t)-n)/(r-1),o=[],a=0,s=0;s<r;a+=i,s+=1)o.push(Math.exp(n+a));return o},t.binarySearch=n},8124:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(995);t.ivlJoin=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return[(0,n.fastMin)(r,o),(0,n.fastMax)(i,a)]},t.ivlMeet=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return[(0,n.fastMax)(r,o),(0,n.fastMin)(i,a)]},t.ivlDistance=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return.5*(0,n.fastAbs)(r+i-(o+a))},t.ivlMeets=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return(0,n.fastMax)(r,o)<(0,n.fastMin)(i,a)},t.ivlMeetsOrTouches=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return(0,n.fastMax)(r,o)<=(0,n.fastMin)(i,a)},t.ivlExcept=function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1];return r<i&&o>=n?[r,i]:r>=i&&o<n?[o,n]:void 0},t.ivlCompare=function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1];return r===i&&n===o?0:r>=i&&n<=o?-1:r<=i&&n>=o?1:void 0}},7213:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(3870),i=function(){function e(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((function(t,r){var n=t[0],i=t[1],o=r[0],a=r[1],s=e(n,o);return 0!==s?s:i-a}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();t.PriorityQueue=i},5100:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var n=r(655),i=r(1937),o=r(3854),a=function(e,t){var r,n,i=e[0],o=t[0];return(r=String(i))<(n=String(o))?-1:r>n?1:0},s={},l=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push([i,e[i].id])}var o=function(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r];t+=String(i[0]),t+="\0",t+=String(i[1]),t+="\0"}return t}(t.sort(a)),l=s[o];return void 0===l&&(l={box:{},probabilities:{},depth:1},s[o]=l),l};function u(e){return Object.getOwnPropertyNames(e).length>0}var c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?d.apply(void 0,e):f.apply(void 0,e)};function d(e){return u(e)?{isSubspace:!0,bounds:e}:i.dense}function f(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];if(Object.prototype.hasOwnProperty.call(e,o)){t=!1;break}}return t?i.dense:{isSubspace:!0,bounds:e}}function p(e){return e.isSubspace?1:e.subspaceCount}var m=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:p(e)+p(t)}};function h(e,t){if(t===i.dense)return t;if(t.isSubspace){for(var r=!1,n=0,o=Object.keys(t.bounds);n<o.length;n++){var a=o[n];if(Object.prototype.hasOwnProperty.call(e,a)){r=!0;break}}if(!r)return i.dense}return{productOperations:e,root:t}}function g(e){return void 0===e?i.dense:e}var v={unzip:function(e){for(var t={},r={},n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a];if(s===i.empty)return i.empty;if(s===i.dense)continue;t[a]=s.setOperations,r[a]=s.root}}return h(t,c(r))},combineProduct:function(e,t,r,n){for(var o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];if(Object.prototype.hasOwnProperty.call(e,l)){var u=n(e[l],e[l].top,g(t[l]),g(r[l]));if(u===i.empty)return i.empty;if(u===i.dense)continue;o[l]=u}}return o},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},i=0,o=t;i<o.length;i++){var a=o[i];if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a];n[a]=s}}return n},fromUntypedProduct:function(e,t,r){for(var n={},o=0,a=r;o<a.length;o++){var s=a[o],l=t[s];n[s]=(0,i.fromUntyped)(e[s],void 0!==l?l:i.dense)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++)t[n[r]]=i.dense;return t}};function S(e,t,r){var n=v.combineProduct(e,t,r,i.unionUntyped);if(n===i.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function y(e,t,r){for(var n=0,o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(Object.prototype.hasOwnProperty.call(e,s)){var l=g(t[s]),u=g(r[s]),c=e[s];if(void 0===(n=(0,i.combineCmp)(n,(0,i.compareUntyped)(c,c.top,l,u))))return}}return n}t.createFromProduct=v.unzip.bind(v);var C,R=(C={},function(e,t,r){var o;if(t===C.left&&r===C.right)return C.res;C.left=t,C.right=r;var a,s=y(e,t.bounds,r.bounds);if(void 0!==s)return C.res=s<=0?r:t;for(var l=0,u=Object.keys(e);l<u.length;l++){var d=u[l];if(Object.prototype.hasOwnProperty.call(e,d)&&0!==(0,i.compareUntyped)(e[d],e[d].top,g(t.bounds[d]),g(r.bounds[d]))){if(void 0!==a)return C.res=void 0;a=d}}if(void 0!==a){var f=(0,i.unionUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(f===i.empty)return C.res=i.empty;if(f===i.dense){var p=t.bounds,m=a,h=(p[m],n.__rest(p,["symbol"==typeof m?m:m+""]));return C.res=c(h)}var v=n.__assign(n.__assign({},t.bounds),((o={})[a]=f,o));return C.res=c(v)}return C.res=void 0});function b(e,t,r){if(r===i.empty)return t;if(r===i.dense)return r;if(t===i.empty)return r;if(t===i.dense)return t;if(!t.isSubspace||!r.isSubspace)return m(t,r,S(e,t.bounds,r.bounds));var n=R(e,t,r);return void 0!==n?n:m(t,r,S(e,t.bounds,r.bounds))}function N(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var a=v.restrict.apply(v,n.__spreadArray([t.bounds],r,!1));if(t.isSubspace)return c(a);var s=N.apply(void 0,n.__spreadArray([e,t.left],r,!1));if(s===i.dense)return i.dense;var l=N.apply(void 0,n.__spreadArray([e,t.right],r,!1));return b(e,s,l)}function T(e,t,r){for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];if(t===i.empty||t===i.dense)return t;if(t.isSubspace){var s=v.restrict.apply(v,n.__spreadArray([t.bounds],o,!1));return c(s)}var l=k(e,r),u=l[0],d=l[1],f=O(e,t,u,d),p=f[0],m=f[1],h=T.apply(void 0,n.__spreadArray([e,p,u],o,!1)),g=T.apply(void 0,n.__spreadArray([e,m,d],o,!1));return b(e,h,g)}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var o=v.restrict.apply(v,n.__spreadArray([e.productOperations],t,!1));if(!u(o))return i.dense;var a=T.apply(void 0,n.__spreadArray([o,e.root,l(o)],t,!1));return a===i.empty?a:h(o,a)}function E(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var o=v.restrict.apply(v,n.__spreadArray([e.productOperations],t,!1)),a=N.apply(void 0,n.__spreadArray([o,e.root],t,!1));return a===i.empty?a:h(o,a)}function k(e,t){var r,o,a,s;if(void 0!==t.children)return t.children;for(var l,u,c=t.box,d=t.probabilities,f=0,p=0,m=Object.keys(e);p<m.length;p++){var h=m[p];if(Object.prototype.hasOwnProperty.call(e,h)){var v=d[h],S=e[h];if(void 0===v){l=h,u=S.top;break}if(v>f){var y=g(c[h]);if(y===i.empty)throw new Error("the key split can never return empty");var C=S.top;if(y!==i.dense){if(!y.isExact)throw new Error("the key can always be represented exactly");C=y.key}if(!S.canSplit(C))continue;l=h,f=v,u=C}}}if(void 0===l||void 0===u)throw new Error("there has to be at least one dimension");var R=e[l],b=R.split(u),N=b[0],T=N[0],P=N[1],E=b[1],k=E[0],O=E[1],A=[{box:n.__assign(n.__assign({},c),(r={},r[l]=(0,i.lazy)(R,R.top,T),r)),probabilities:n.__assign(n.__assign({},d),(o={},o[l]=P,o)),depth:t.depth+1},{box:n.__assign(n.__assign({},c),(a={},a[l]=(0,i.lazy)(R,R.top,k),a)),probabilities:n.__assign(n.__assign({},d),(s={},s[l]=O,s)),depth:t.depth+1}];return t.depth<10&&(t.children=A),A}t.project=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?P.apply(void 0,e):E.apply(void 0,e)};var O=function(e,t,r,n){return function e(t,r,n,o){if(r===i.empty)return[i.empty,i.empty];if(r===i.dense)return[c(n),c(o)];var a=y(t,r.bounds,n);if(void 0!==a&&a<=0)return[r,i.empty];var s=v.combineProduct(t,r.bounds,n,i.intersectUntyped);if(s===i.empty)return[i.empty,r];var l=v.combineProduct(t,r.bounds,o,i.intersectUntyped);if(r.isSubspace)return[c(s),l===i.empty?i.empty:c(l)];var u=e(t,r.left,n,o),d=u[0],f=u[1],p=e(t,r.right,n,o),m=p[0],h=p[1];return[b(t,d,m),b(t,f,h)]}(e,t,r.box,n.box)};function A(e,t,r,n,o){var a=k(e,n),s=a[0],l=a[1],u=O(e,t,s,l),c=u[0],d=u[1],f=O(e,r,s,l),p=f[0],m=f[1],h=o(e,c,p,s);return h===i.dense?i.dense:b(e,h,o(e,d,m,l))}function I(e,t,r,n){if(r===i.empty)return t;if(t===i.empty)return r;if(t===i.dense)return t;if(r===i.dense)return r;if(t.isSubspace&&r.isSubspace){var o=R(e,t,r);if(void 0!==o)return o}return A(e,t,r,n,I)}function _(e,t){if(t===i.empty)return e;if(t===i.dense)return t;if(e===i.empty)return t;if(e===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=I(r,e.root,t.root,l(r));return o===i.empty?o:h(r,o)}function F(e,t,r,n){if(t===i.empty||r===i.empty)return i.empty;if(t===i.dense)return r;if(r===i.dense)return t;if(t.isSubspace&&r.isSubspace){var o=v.combineProduct(e,t.bounds,r.bounds,i.intersectUntyped);return o===i.empty?i.empty:c(o)}return A(e,t,r,n,F)}function M(e,t,r,o){if(t===i.empty)return t;if(r===i.dense)return i.empty;if(r===i.empty)return t;if(t===i.dense)return A(e,t,r,o,M);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var o,a,s=y(e,t.bounds,r.bounds);if(0===s||-1===s)return i.empty;for(var l=0,u=Object.keys(e);l<u.length;l++){var d=u[l];if(Object.prototype.hasOwnProperty.call(e,d)){var f=(0,i.compareUntyped)(e[d],e[d].top,g(t.bounds[d]),g(r.bounds[d]));if(void 0===f||f>0){if(void 0!==a)return;a=d}}}if(void 0!==a){var p=(0,i.exceptUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(p===i.empty)return i.empty;if(p===i.dense){var m=t.bounds,h=a,v=(m[h],n.__rest(m,["symbol"==typeof h?h:h+""]));return c(v)}var S=n.__assign(n.__assign({},t.bounds),((o={})[a]=p,o));return c(S)}}(e,t,r);if(void 0!==a)return a}return A(e,t,r,o,M)}function D(e,t){if(e===i.empty)return e;if(t===i.empty)return e;if(t===i.dense)return i.empty;if(e===i.dense){var r=M(t.productOperations,i.dense,t.root,l(t.productOperations));return r===i.empty?r:h(t.productOperations,r)}var o=n.__assign(n.__assign({},e.productOperations),t.productOperations),a=M(o,e.root,t.root,l(o));return a===i.empty?a:h(o,a)}t.unionProduct=_,t.intersectProduct=function(e,t){if(e===i.empty)return e;if(t===i.empty)return t;if(e===i.dense)return t;if(t===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=F(r,e.root,t.root,l(r));return o===i.empty?o:h(r,o)},t.exceptProduct=D,t.compareProduct=function(e,t){if(e===t)return 0;if(e===i.empty)return-1;if(t===i.empty)return 1;if(e===i.dense)return t===i.dense?0:1;if(t===i.dense)return-1;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return function e(t,r,n,o){if(r===n)return 0;if(r===i.empty)return-1;if(n===i.empty)return 1;if(r===i.dense)return n===i.dense?0:1;if(n===i.dense)return-1;if(r.isSubspace&&n.isSubspace)return y(t,r.bounds,n.bounds);var a=k(t,o),s=a[0],l=a[1],u=O(t,r,s,l),c=u[0],d=u[1],f=O(t,n,s,l),p=f[0],m=f[1],h=e(t,c,p,s);return void 0!==h?(0,i.combineCmp)(h,e(t,d,m,l)):void 0}(r,e.root,t.root,l(r))},t.meetsProduct=function(e,t){if(e===i.empty||t===i.empty)return!1;if(e===i.dense||t===i.dense)return!0;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return function e(t,r,n,o){if(r===i.empty||n===i.empty)return!1;if(r===i.dense||n===i.dense)return!0;if(!function(e,t,r){for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(Object.prototype.hasOwnProperty.call(e,a)){var s=g(t[a]),l=g(r[a]),u=e[a];if(!(0,i.meetsUntyped)(u,u.top,s,l))return!1}}return!0}(t,r.bounds,n.bounds))return!1;if(r.isSubspace&&n.isSubspace)return!0;var a=k(t,o),s=a[0],l=a[1],u=O(t,r,s,l),c=u[0],d=u[1],f=O(t,n,s,l),p=f[0],m=f[1];return e(t,c,p,s)||e(t,d,m,l)}(r,e.root,t.root,l(r))},t.complementProduct=function(e){return D(i.dense,e)},t.symmetricDiffProduct=function(e,t){return _(D(e,t),D(t,e))},t.getSubspaces=function(e){if(e===i.empty||e===i.dense)return[];var t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,r){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s=t.project.apply(void 0,n.__spreadArray([e],o,!1));if(s===i.empty)return!0;if(s===i.dense)return r(v.denseProduct(o));var l=s.productOperations,u=s.root;function c(e){return e.isSubspace?r(v.fromUntypedProduct(l,e.bounds,o)):c(e.left)&&c(e.right)}return c(u)},t.getSubspaceCount=function(e){return e===i.empty||e===i.dense?0:p(e.root)};var w=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),L=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function x(e,t){return function(r,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s=t.get(r);void 0===s?(e.apply(void 0,n.__spreadArray([r,i],o,!1)),t.set(r,t.size)):i.push("__cached__",s)}}function B(e,t){return function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if("__cached__"===r.pick()){r.pop();var a=r.pop();return t[a]}var s=e.apply(void 0,n.__spreadArray([r],i,!1));return t.push(s),s}}var U=function(){function e(t){var r,n,o,a,s=this;for(var l in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new L,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==i.empty&&e!==i.dense){var r=e,n=s.getDims(r.productOperations);t.push(n),s.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===i.empty||t===i.dense)return t;e.putBack(t);for(var r={},n=e.pop(),o=0,a=n;o<a.length;o++){var l=a[o],u=s.globalProductOperations[l];r[l]=u}return{productOperations:r,root:s.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(s.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(s.serializers[n].serializeBound(null==t?void 0:t.supremum));var o=e.normalizeKey(null==t?void 0:t.key);r.push(s.serializers[n].serializeKey(o));for(var a=0,l=[null==t?void 0:t.left,null==t?void 0:t.right];a<l.length;a++){var u=l[a];null==u||u===i.empty||u===i.dense?r.push(u):(r.push("us"),s.serializeUntypedSparseCached(u,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=s.serializers[t].deserializeBound(e.pop()),i=s.serializers[t].deserializeBound(e.pop()),o=s.serializers[t].deserializeKey(e.pop()),a=["left","right"].map((function(r){var n=e.pop();return"us"===n?s.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:i,isExact:r,key:o,left:a[0],right:a[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,i=r;n<i.length;n++){var o=i[n],a=e.bounds[o];s.serializeUntypedSparseCached(a,t,o)}e.isSubspace||(s.serializeUntypedSparseProductCached(e.left,t,r),s.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},i=0,o=t;i<o.length;i++){var a=o[i],l=s.deserializeUntypedSparseCached(e,a);n[a]=l}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:s.deserializeUntypedSparseProductCached(e,t),right:s.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=x(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=B(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=x(this.serializeProductSet,this.cached),this.deserializeProductSetCached=B(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=x(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=B(this.deserializeUntypedSparseProduct,this.cache),t){var u={serializeKey:null!==(r=t[l].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[l].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(o=t[l].serializeBound)&&void 0!==o?o:function(e){return JSON.stringify(e)},deserializeBound:null!==(a=t[l].deserializeBound)&&void 0!==a?a:function(e){return JSON.parse(e)}};this.serializers[l]=u}}return e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var i=n[r];this.serializeProductSetCached(i,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new w(JSON.parse(e)),r=t.pop(),n=[],i=0;i<r;i+=1){var o=this.deserializeProductSetCached(t);n.push(o)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=n.__assign({},e);return delete t.depth,delete t.split,t}return e},e}();t.ProductSetSerializer=U,t.productSetSerializer=function(e){return new U(e)}},5273:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n,i=r(655),o=r(995),a=r(3897);function s(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var i=e.slice(0,-1);return t<e.length-1&&(i[t]=e[e.length-1]),i}function l(e,t,r){return{kind:e,key:t,value:r}}function u(e,t){return l(n.Ptr,e,t)}function c(e,t){return l(n.Leaf,e,t)}function d(e,t){return l(n.Branch,e,t)}t.copyExcept=s,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(n=t.RTKind||(t.RTKind={}));var f=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,i,o){void 0===o&&(o=2);var a=o>1?Math.ceil(o):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:i,minChildren:a,maxChildren:2*a,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,i){var o=r.keyCompare(i.key,e);if(i.kind===n.Ptr)return 0===o?i.value:void 0;if(!(void 0===o||o<0))for(var a=0,s=i.value;a<s.length;a++){var l=t(r,s[a]);if(void 0!==l)return l}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:(0,a.entry)(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var i=v(this.lattice,this.root,t,n,r);return void 0!==i?i===this.root?this:new e(this.lattice,i,this.count):new e(this.lattice,g(this.lattice,this.root,u(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==v(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return p(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var i=[],a=this.lattice,l=function(e,r){var u=a.keyCompare(e.key,t);if(void 0===u||u<0)return(0,o.pair)(e,1);if(e.kind===n.Leaf){for(var f=e.value,p=0;p<f.length;p+=1)if(0===a.keyCompare(f[p].key,t)){if((g=s(f,p)).length<r){var h=c(e.key,g);return i.push(h),(0,o.pair)(h,3)}return(0,o.pair)(c(m(a,g),g),2)}}else for(f=e.value,p=0;p<f.length;p+=1){var g,v=l(f[p],a.minChildren),S=v[0],y=v[1];if(3===y)return(g=s(f,p)).length>=r?(0,o.pair)(d(m(a,g),g),2):(h=d(e.key,g),i.push(h),(0,o.pair)(h,3));if(2===y)return(0,o.pair)(d(e.key,s(f,p,S)),2)}return(0,o.pair)(e,1)},f=this.root.kind===n.Leaf?1:2,h=l(this.root,f),v=h[0],S=h[1];if(v===this.root)return this;for(var y=3===S?void 0:v,C=0;C<i.length;C+=1)p(i[C],(function(e,t){return y=g(r.lattice,y,u(e,t)),!0}));return new e(this.lattice,y,this.count-1)},e}();function p(e,t,r,i){var o=void 0!==r?r:function(){return!0},a=void 0!==i?i:function(){return!0};if(null==e)return!0;var s=function(e){if(!o(e.key))return!0;if(e.kind===n.Leaf)for(var r=e.value,i=0;i<r.length;i+=1){var l=r[i];if(a(l.key)&&!t(l.key,l.value))return!1}else for(r=e.value,i=0;i<r.length;i+=1)if(!s(r[i]))return!1;return!0};return s(e)}function m(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function h(e,t,r){var n=function(e,t){for(var r=function(e,t){for(var r=0,n=1,i=e.keyDistance(t[0].key,t[1].key),a=2;a<t.length;a+=1)for(var s=0;s<a;s+=1){var l=e.keyDistance(t[s].key,t[a].key);l>i&&(r=s,n=a,i=l)}return(0,o.pair)(r,n)}(e,t),n=r[0],i=r[1],a=t[n].key,s=t[i].key,l=[],u=0;u<t.length;u+=1){var c=t[u];l.push([c,e.keyDistance(a,c.key)-e.keyDistance(s,c.key)])}l.sort((function(e,t){return e[1]-t[1]}));for(var d=e.minChildren;d<t.length-e.minChildren&&l[d][1]<0;d+=1);var f=[],p=[];for(u=0;u<d;u+=1)f.push(l[u][0]);for(u=d;u<t.length;u+=1)p.push(l[u][0]);return(0,o.pair)(f,p)}(e,r),i=n[0],a=n[1];return(0,o.pair)(l(t,m(e,i),i),l(t,m(e,a),a))}function g(e,t,r){if(null==t)return c(r.key,[r]);var a=function t(a){if(a.kind===n.Leaf){var s=i.__spreadArray(i.__spreadArray([],a.value,!0),[r],!1);if(s.length>e.maxChildren){var l=h(e,a.kind,s),u=l[0],f=l[1];return(0,o.pair)(c(u.key,u.value),f)}return(0,o.pair)(c(e.keyJoin(a.key,r.key),s),void 0)}var p=a.value.slice(),m=function(e,t,r){for(var n=0,i=e.keyDistance(t[0].key,r),o=t[0].value.length,a=1;a<t.length;a+=1){var s=t[a],l=e.keyDistance(s.key,r);(l<i||l===i&&s.value.length<o)&&(n=a,i=l,o=s.value.length)}return n}(e,p,r.key),g=t(p[m]),v=g[0],S=g[1];if(p[m]=v,null!=S&&(p.push(S),p.length>e.maxChildren)){var y=h(e,a.kind,p),C=y[0];return f=y[1],(0,o.pair)(d(C.key,C.value),f)}return(0,o.pair)(d(e.keyJoin(a.key,r.key),p),void 0)}(t),s=a[0],l=a[1];return null!=l?d(e.keyJoin(s.key,l.key),[s,l]):s}function v(e,t,r,i,o){if(void 0!==t)return function t(i){if(i.kind!==n.Leaf){for(o=0;o<i.value.length;o+=1)if(l=i.value[o],e.keyMeets(l.key,r)&&void 0!==(u=t(l)))return d(i.key,s(i.value,o,u))}else for(var o=0;o<i.value.length;o+=1){var l,u;if(void 0!==(u=a(l=i.value[o])))return c(i.key,s(i.value,o,u))}}(t);function a(t){if(0===e.keyCompare(t.key,r))return void 0!==o&&t.value!==o&&i(t.value)?u(t.key,o):t}}t.RTree=f},6328:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(3553),i=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(n.emptyUntyped,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=(0,n.findUntyped)(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return(0,n.findUntyped)(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return(0,n.forEachUntyped)(e,this.root)},e.prototype.setValue=function(t,r){return new e((0,n.insertUntyped)(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e((0,n.removeUntyped)(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var i=this.getValue(t);if(void 0!==i)return[this,i];var o=r();return[new e((0,n.insertUntyped)(this,t,o,this.root),this.count+1,this.keyCompare),o]},e.prototype.filter=function(t){var r=this,i=n.emptyUntyped,o=0;return this.forEach((function(e,a){return t(e,a)&&(i=(0,n.insertUntyped)(r,e,a,i),o+=1),!1})),new e(i,o,this.keyCompare)},e}();t.RedBlackMapTree=i},3553:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var n,i,o=r(3319);!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(n=t.Color||(t.Color={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(i||(i={}));var a=n.Red,s=n.Black,l=i.DoubleBlack,u={c:s,l:void 0,r:void 0},c={c:l,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function f(e){return void 0===e.l}function p(e){return e.c===a}function m(e){return e.c===s&&void 0!==e.l}function h(e){return e.c===s&&void 0===e.l}function g(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function v(e,t){return g(e,t.l,t.key,t.value,t.r)}function S(e){return f(e)?u:v(s,e)}function y(e,t,r){if(!f(r)){var n=e.keyCompare(t,r.key);return n<0?y(e,t,r.l):n>0?y(e,t,r.r):r}}function C(e,t){return!!f(t)||!!C(e,t.l)&&!!e(t.key,t.value)&&C(e,t.r)}function R(e,t,r,n,i){if(e===s){if(p(t)&&p(t.l))return g(a,v(s,t.l),t.key,t.value,g(s,t.r,r,n,i));if(p(i)&&p(i.r))return g(a,g(s,t,r,n,i.l),i.key,i.value,v(s,i.r));if(p(t)&&p(t.r))return g(a,g(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,g(s,t.r.r,r,n,i));if(p(i)&&p(i.l))return g(a,g(s,t,r,n,i.l.l),i.l.key,i.l.value,g(s,i.l.r,i.key,i.value,i.r))}if(e===l){if(p(i)&&p(i.l))return g(s,g(s,t,r,n,i.l.l),i.l.key,i.l.value,g(s,i.l.r,i.key,i.value,i.r));if(p(t)&&p(t.r))return g(s,g(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,g(s,t.r.r,r,n,i))}return g(e,t,r,n,i)}function b(e,t,r,n,i){return e===a&&t.c===l&&m(i)?R(s,g(a,S(t),r,n,i.l),i.key,i.value,i.r):e===a&&m(t)&&i.c===l?R(s,t.l,t.key,t.value,g(a,t.r,r,n,S(i))):e===s&&t.c===l&&m(i)?R(l,g(a,S(t),r,n,i.l),i.key,i.value,i.r):e===s&&m(t)&&i.c===l?R(l,t.l,t.key,t.value,g(a,t.r,r,n,S(i))):e===s&&t.c===l&&p(i)&&m(i.l)?g(s,R(s,g(a,S(t),r,n,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===s&&p(t)&&m(t.r)&&i.c===l?g(s,t.l,t.key,t.value,R(s,t.r.l,t.r.key,t.r.value,g(a,t.r.r,r,n,S(i)))):((0,o.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==l&&i.c!==l),g(e,t,r,n,i))}function N(e,t,r,n){return function(e){return!p(e)||e.l.c!==a&&e.r.c!==a?e:v(s,e)}(function e(t,r,n,i){if(f(i))return g(a,u,r,n,u);var o=t.keyCompare(r,i.key);return o<0?R(i.c,e(t,r,n,i.l),i.key,i.value,i.r):o>0?R(i.c,i.l,i.key,i.value,e(t,r,n,i.r)):g(i.c,i.l,r,n,i.r)}(e,t,r,n))}function T(e){if(e.c===a&&h(e.l)&&h(e.r))return[e.key,e.value,u];if(e.c===s&&h(e.l)&&h(e.r))return[e.key,e.value,c];if(e.c===s&&h(e.l)&&p(e.r))return[e.key,e.value,v(s,e.r)];(0,o.assertTrue)("calc.common.rbTree.remMin: expected node",!f(e.l));var t=T(e.l),r=t[0],n=t[1],i=t[2];return[r,n,b(e.c,i,e.key,e.value,e.r)]}function P(e,t,r){var n=function e(t,r,n){if(f(n))return n;if(n.c===a&&h(n.l)&&h(n.r))return 0===t.keyCompare(r,n.key)?u:n;if(n.c===s&&h(n.l)&&h(n.r))return 0===t.keyCompare(r,n.key)?c:n;if(n.c===s&&p(n.l)&&h(n.l.l)&&h(n.l.r)&&h(n.r)){var i=t.keyCompare(r,n.key);return i<0?g(s,e(t,r,n.l),n.key,n.value,u):i>0?n:g(s,u,n.l.key,n.l.value,u)}var l=t.keyCompare(r,n.key);if(l<0)return b(n.c,e(t,r,n.l),n.key,n.value,n.r);if(l>0)return b(n.c,n.l,n.key,n.value,e(t,r,n.r));(0,o.assertTrue)("calc.common.rbTree.rem: expected node",!f(n.r));var d=T(n.r),m=d[0],v=d[1],S=d[2];return b(n.c,n.l,m,v,S)}(e,t,function(e){return m(e)&&e.l.c===s&&e.r.c===s?v(a,e):e}(r));return(0,o.assertTrue)("calc.common.rbTree.remove: expected R|B",n.c===a||n.c===s),n}t.fromUntyped=d,t.isLeaf=f,t.emptyUntyped=u,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=y,t.find=function(e,t){return y(t.ops,e,t.root)},t.forEachUntyped=C,t.forEach=function(e,t){return C(e,t.root)},t.insertUntyped=N,t.insert=function(e,t,r){return d(r.ops,N(r.ops,e,t,r.root))},t.removeUntyped=P,t.remove=function(e,t){return d(t.ops,P(t.ops,e,t.root))}},8627:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var r=function(){function e(e){void 0===e&&(e=1/0),this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return 0===this.counter},e.prototype.enqueue=function(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}},e.prototype.executeOnEveryElement=function(e){for(var t=0;t<this.counter;t++){var r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n&&!e(n))return!1}return!0},e}();t.RingBuffer=r},4150:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var n=r(995),i=r(8124);function o(e,t,r){var n=Math.pow(t,e),i=1-Math.pow(t/r,e),o=Math.pow(r,e),a=o*n,s=o-n,l=-1/e;return{cdf:1===e?function(e){return(1-n/e)/i}:function(t){return(1-n*Math.pow(t,-e))/i},invCdf:1===e?function(e){return 1/((o-e*s)/a)}:function(e){return Math.pow((o-e*s)/a,l)}}}function a(e,t,r){var i=o(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],o=i.cdf(r),a=i.cdf(t+1),s=i.invCdf((o+a)/2),l=(0,n.fastMin)((0,n.fastMax)(Math.round(s),t+1),r-1);return[[[t,l],i.cdf(l)-i.cdf(t+1)],[[l,r],i.cdf(r)-i.cdf(l)]]}}}t.boundedPareto=o,t.boundedParetoSplitter=a,t.boundedParetoSetOperations=function(e,t,r,o,s){var l=a(e,t,r);return{id:s,split:function(e){return l.split(e)},canSplit:function(e){return l.canSplit(e)},meets:i.ivlMeets,intersect:i.ivlMeet,union:function(e,t){return(0,i.ivlMeetsOrTouches)(e,t)?(0,i.ivlJoin)(e,t):void 0},except:i.ivlExcept,compare:i.ivlCompare,top:o,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return(0,n.fastMin)(e,t)},combineSuprema:function(e,t){return(0,n.fastMax)(e,t)}}}},3897:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var r={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return r},t.entry=function(e,t){return{key:e,value:t}}},1757:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;var n=r(1821),i=r(3319),o={},a=0;t.logCollisionKey=function(e){var t,r;t=function(e){return"object"==typeof e?null===e?"null":"Object {".concat(Object.keys(e),"}"):typeof e}(e),r=o[t],o[t]=(void 0===r?0:r)+1,(a+=1)%100==0&&(i.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(o),".")),o={})}},3854:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n,i=r(3319),o=r(1821),a=r(5550);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunction="CalcLambdaFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",e.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(n=t.FeatureName||(t.FeatureName={}));var s=function(e){var t="calc.common.isFeatureEnabledCallback: called with ".concat(e," before initCalc");return i.ulsLogger.ULS.traceTag(526989323,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t),!1},l={};function u(e){return void 0===l[e]&&(l[e]=s(e)),l[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=u,t.getFeatures=function(){var e={};for(var t in n){var r=n[t];null!=r&&(e[r]=u(r))}return e},t.getTypedFeatureGate=(0,a.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.ProductSetBugFixFromPR1043532":!0,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin":!1,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaAssistanceRedesign":!1,"Microsoft.Office.Excel.ParenthesesCoupling":!1,"Microsoft.Office.Excel.ColoredReferences":!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.FormulaAssistanceValuePreview":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!1,"Microsoft.Office.Excel.UseAggregatedLogging":!1,"Microsoft.Office.Excel.SyntaxErrors":!1,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1});var c=r(5550);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,a.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS","OfficeVSO:6409219_addPluginNameToPluginDataLog","OfficeVSO:6476056_OnlySendNestedDotNotationPath","Microsoft.Office.Excel.ChangeGate.ParseEditEqFix","Microsoft.Office.Excel.ChangeGate.RCBracketFix","Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix","Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix","OfficeVSO:7125313_handleUnavailableFormat","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins","OfficeVSO:7549315_ArgumentAssistance"])},2856:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r,n){void 0===r&&(r=function(){return""}),void 0===n&&(n=function(){return 1});for(var i=[e],o=new Set(i),a=0;a<i.length;a+=1)for(var s=0,l=t(i[a]);s<l.length;s++){var u=l[s];o.has(u)||(o.add(u),i.push(u))}o.clear(),i.reverse();var c=new Map,d=[],f=new Map,p=[];i.forEach((function(e,i){var o=t(e).map((function(e){return c.get(e)}));if(o.some((function(e){return void 0===e})))throw new Error("Circular references in the tree");var a,s,l=o.map((function(e){return d[e]})),u=(a=l.join("/")+"/"+r(e),void 0!==(s=f.get(a))||(s=f.size,f.set(a,s)),s);if(d.push(u),void 0===p[u]){var m=l.map((function(e){return p[e]})),h=m.map((function(e){return e.size})).reduce((function(e,t){return e+t}),n(e)),g=m.map((function(e){return e.depth})).reduce((function(e,t){return Math.max(e,t)}),0)+1;p[u]={subtrees:[e],size:h,depth:g}}else p[u].subtrees.push(e);c.set(e,i)}));for(var m=0,h=p;m<h.length;m++)(y=h[m]).subtrees.reverse();for(var g=new Array(i.length),v=0,S=p;v<S.length;v++){var y=S[v];g[g.length-c.get(y.subtrees[0])-1]=y}return g.filter((function(e){return void 0!==e}))}},3551:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0,t.fnv1a=function(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},3971:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelOnlineCalcPackageVersion=void 0,t.excelOnlineCalcPackageVersion="37.2.0"},637:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0,t.PackageName="excel-online-calc-common";var n=r(3551);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return n.fnv1a}});var i=r(1357);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return i.JSF32}});var o=r(2856);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return o.findIsomorphicSubtrees}});var a=r(9574);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return a.combinations}});var s=r(8908);t.anonymizer=s;var l=r(8515);t.util=l;var u=r(3319);t.assertions=u;var c=r(3854);t.featureConfiguration=c;var d=r(995);t.core=d;var f=r(6745);t.testUtil=f;var p=r(1612);t.arrayMapTree=p;var m=r(3870);t.binaryHeap=m;var h=r(1937);t.bspSet=h;var g=r(2276);t.deque=g;var v=r(6348);t.dictionary=v;var S=r(4642);t.hashSet=S;var y=r(1569);t.hashTable=y;var C=r(8114);t.histogram=C;var R=r(8124);t.interval=R;var b=r(7213);t.priorityQueue=b;var N=r(5100);t.productSet=N;var T=r(6328);t.rbMapTree=T;var P=r(3553);t.rbTree=P;var E=r(8627);t.ringBuffer=E;var k=r(5273);t.rTree=k;var O=r(4150);t.split=O;var A=r(3897);t.table=A,t.arrayUtils=r(1826),t.async=r(8314),t.asyncLoopModule=r(6058),t.setTimeoutInterfaceModule=r(2122),t.codePoint=r(3387),t.config=r(8994),t.resolvablePromise=r(245),t.stopwatch=r(4782),t.promise=r(6757);var I=r(4553);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return I.mixin}}),t.result=r(2443),t.unicode=r(3758),t.wrapIntoAsyncModule=r(6988),t.arrayLogger=r(2005),t.testConfig=r(1080),t.machine=r(5530),t.pledge=r(883),t.testUtils=r(1985),t.revocableSingleton=r(5534)},1357:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var r=function(e,t){return(e<<t|e>>>32-t)>>>0},n=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-r(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^r(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();t.JSF32=n},1071:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(r=Math.log2)&&void 0!==r?r:function(e){return Math.log(e)*Math.LOG2E}},4553:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(655),i=0;t.mixin=function(e,t,r){for(var o,a=(void 0===(o="___mixinField")&&(o=""),o+(i+=1).toString()),s={},l=function(e){s[e]=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=this[a];return(t=o[e]).call.apply(t,n.__spreadArray([o],r,!1))}},u=0,c=r;u<c.length;u++)l(c[u]);return function(e){function i(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var o=e.apply(this,n)||this,l=t(o),u=0,c=r;u<c.length;u++){var d=c[u];Object.defineProperty(o,d,{value:s[d],enumerable:!1,configurable:!1})}return o[a]=l,o}return n.__extends(i,e),i}(e)}},6757:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=void 0;var n=r(995);function i(e){return(0,n.isDefined)(e)&&"function"==typeof e.then}t.promiseFinally=function(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))},t.newPromise=function(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]},t.promiseLoop=function(e,t){var r;return new Promise((function(n,i){Promise.resolve(t).then((function t(o){if(void 0!==o){r=o;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))},t.isThenable=i,t.bindMaybeThenable=function(e,t,r){return i(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e}},245:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromise=void 0;var n=r(6757),i=function(){function e(){var e=this;this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),(0,n.isThenable)(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),(0,n.isThenable)(e)?this.promise.then():void 0},e}();t.ResolvablePromise=i},2443:(e,t)=>{"use strict";var r,n;function i(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r=t.ResultKind||(t.ResultKind={})),t.success=i,t.successUndefined=i(void 0),t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},function(e){e.JavaScriptError="JavaScriptError"}(n=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(e){return{kind:n.JavaScriptError,error:e}}},5530:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var n,i=r(655),o=r(2443);function a(e,t,r){return{kind:e,machine:t,receiver:r}}function s(e,t){return a(n.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(n=t.TransitionKind||(t.TransitionKind={})),t.nextTransition=a(n.Next,void 0,void 0),t.breakTransition=a(n.Break,void 0,void 0),t.callMachineTransition=s;var l={receiveResult:function(e){return(0,o.isSuccess)(e)?t.nextTransition:e}};t.nextOnSuccessReceiver=function(){return l};var u=function(e){function t(t,r){var n=this.constructor,i=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;i.machine=t,i.stackDepth=r;var o=n.prototype;return Object.getPrototypeOf(i)!==o&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(i,o):i.__proto__=o),i}return i.__extends(t,e),t}(Error);t.MachineCycle=u;var c=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(s(e,{receiveResult:function(e){return e}})),this.transition=t.nextTransition}catch(e){this.transition=(0,o.failure)((0,o.javaScriptError)(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new u(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case n.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case n.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case n.Break:return this.transition=t.nextTransition,e;default:var r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,o.failure)((0,o.javaScriptError)(e)),t.nextTransition}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r.kind===n.Break)return r;if(r.kind!==n.Next)return this.result=r;if(t())return e.numPauses+=1,r}}catch(e){return this.result=(0,o.failure)((0,o.javaScriptError)(e))}},e.prototype.runToResult=function(){for(;;){var e=this.run();if(e.kind!==n.Break)return e}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}();t.MachineRuntime=c;var d=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?s(this.machines[this.values.length],this):(0,o.success)(this.values)},e.prototype.receiveResult=function(e){return(0,o.isSuccess)(e)?(this.values.push(e.value),this.next()):e},e}();t.AllMachine=d},883:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(5530),i=r(2443),o=function(){function e(t,r,i){this.transition=t,this.onFulfilled=r,this.onRejected=i,this.runStatus=!(t instanceof e||t.kind===n.TransitionKind.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if((0,i.isSuccess)(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState((0,i.failure)((0,i.javaScriptError)(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState((0,i.success)(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new n.AllMachine(t.map(e.resolve)))},e.prototype.settle=function(){return new n.MachineRuntime(this).runToResult()},e.settleOrThrow=function(e){var t=e.settle();if((0,i.isSuccess)(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e((0,i.success)(t),void 0,void 0)},e.reject=function(t){return new e((0,i.failure)(t),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefinedPledge,void 0,void 0);return r.transition=(0,n.callMachineTransition)(t,r),r},e.try=function(t){return e.undefinedPledge.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?(0,n.callMachineTransition)(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return(0,i.isSuccess)(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?(0,i.success)(this.accum):(this.accum=e,n.nextTransition)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}();t.Pledge=o},1985:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){return(r+=1)>=t}},t.throwAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){if((r+=1)<t)return!1;throw t}}},2122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var n=r(655),i=r(3319);function o(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return{kind:"Immediate",timer:setImmediate.apply(void 0,n.__spreadArray([e],t,!1))}}function a(e){switch(e.kind){case"Immediate":clearImmediate(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,i.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=o,t.clearTimerUnified=a,t.defaultSetTimeoutInterface={setImmediate:o,setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return{kind:"Timeout",timer:setTimeout.apply(void 0,n.__spreadArray([e,t],r,!1))}},clearImmediate:a,clearTimeout:a}},4782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;var n=r(1821),i={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((function(e){return i.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),t.initStopwatch=function(e){i.ULS=e}},6745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n,i=r(3319),o=r(1357),a=(n=null!=Object({NODE_ENV:"production"}).BUILD_BUILDID?.4531024141007942:Math.random()*Date.now(),new o.JSF32(n));function s(e){return(0,i.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(a.next()*e))}t.randomFloat=function(){return a.next()},t.randomIndex=s,t.randomShuffled=function(e){return e.map((function(e){return[a.next(),e]})).sort((function(e,t){return e[0]<t[0]?-1:e[0]===t[0]?0:1})).map((function(e){return e[1]}))},t.randomElement=function(e){return e[s(e.length)]}},2005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(655);t.createArrayLogger=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=function(){return!0});var i=new Set,o=new Set;return{log:[],addTriggerListener:function(e){i.add(e)},waitForMessage:function(e,t){var r=this;return new Promise((function(n){var i=setTimeout((function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(t)),n(!1)}),t);r.addTriggerListener((function(t){var r=e(t);return r&&(clearTimeout(i),n(!0)),r}))}))},waitForReceivedButDelayedMessages:function(){var e=[];return o.forEach((function(t){return e.push(t)})),Promise.all(e).then((function(){}))},addLogMessage:function(a){var s=this;if(t(a)){var l=new Promise((function(t){var o;o=function(){s.log.push(a),e&&console.log.apply(console,n.__spreadArray([(new Date).toISOString()],a,!1)),i.forEach((function(e){e(a)&&i.delete(e)})),t()},void 0===r?o():setTimeout((function(){return o()}),r)})).then((function(){o.delete(l)}));o.add(l)}},shipAssertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["shipAssertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("shipAssertTag: ".concat(n))},assertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["assertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("assertTag: ".concat(n))},traceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["traceTag",e])},dnmTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["dnmTraceTag",e])},debugTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["debugTraceTag",e])}}}},1080:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;var n=r(3854),i=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(console.assert(r,"shipAssertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(console.assert(r,"assertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag2",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag2",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag2",e,n,t,r)},e}();t.ConsoleLogger=i;var o=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e}();t.AssertLogger=o,t.featureEnabledDummyCallback=function(e){switch(e){case n.FeatureName.FeatureCheckingEnabled:case n.FeatureName.CalcRecordFunctions:case n.FeatureName.CalcNestedRecordFunction:case n.FeatureName.CalcLetRecFunction:case n.FeatureName.CalcLambdaFunction:case n.FeatureName.CalcLambdaBasicFunctions:case n.FeatureName.CalcLambdaHelperFunctions:case n.FeatureName.CalcLambdaOptionalParameters:case n.FeatureName.CalcLambdaDefaultParameters:case n.FeatureName.CalcLambdaCellValues:case n.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},5534:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;var r=function(){function e(e,t){var r=this;this.target=e,this.isRevoked=!1;var n=function(e){if(r.isRevoked)throw new TypeError("".concat(String(e),": ").concat(t))};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:function(e,t,r){return n(t),Reflect.get(e,t,r)},set:function(e,t,r,i){return n(t),Reflect.set(e,t,r,i)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),n=function(){function e(e){this.message=e}return e.prototype.getInstance=function(){var e;return null===(e=this.instance)||void 0===e?void 0:e.proxy},e.prototype.setInstance=function(e){var t;return null===(t=this.instance)||void 0===t||t.revoke(),void 0===e?this.instance=void 0:(this.instance=new r(e,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new r(this.instance.target,this.message),this.instance.proxy},e}();t.RevocableSingleton=n},3758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetCharCodeBits=t.forEachClassInterval=t.CharCodeBits=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;var n,i=r(995);function o(e){return 55296==(64512&e)}function a(e){return 56320==(64512&e)}function s(e){return 55296==(63488&e)}function l(e,t){if(o(e)&&a(t))return 65536+((1023&e)<<10|1023&t)}function u(e,t){var r=e.charCodeAt(t);if(!s(r))return r;if(t+1>=e.length)return 65533;var n=l(r,e.charCodeAt(t+1));return null!=n?n:65533}function c(e){return e>=65536?2:1}function d(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],i=e[r+1],o=n;o<i;o+=1)t(o,n,i)}t.isHighSurrogate=o,t.isLowSurrogate=a,t.isAnySurrogate=s,t.surrogatePairToCodePoint=l,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)},t.scanCodePoints=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n>=e.length)return;o(e.charCodeAt(n))&&n+1<e.length&&a(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n-1<0)return;a(e.charCodeAt(n-1))&&n-2>=0&&o(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){for(var n=0,i=t;i<r;n+=1)o(e.charCodeAt(i))&&i+1<r&&a(e.charCodeAt(i+1))?i+=2:i+=1;return n},t.stringCodePointAt=u,t.numCodeUnits=c,t.codePointIterator=function(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var i=u(e,n);r.push(i),n+=c(i)}return r},function(e){e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(n=t.CharCodeBits||(t.CharCodeBits={})),t.forEachClassInterval=d,t.makeGetCharCodeBits=function(e,t){var r;function o(e){r[e]|=n.IdentStartClass}function a(e){r[e]|=n.IdentContinueClass}return function(n){if(void 0===r){var s=(0,i.fastMax)(e[e.length-1],t[t.length-1]);r=new Uint8Array(s),d(e,o),d(t,a)}var l=r[n];return void 0!==l?l:0}}},8515:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var n=r(8908),i=r(1071);Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return i.mathLog2}}),t.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.stringStartsWith=function(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t},t.stringEndsWith=function(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t},t.repeat=function(e,t){return Array(t+1).join(e)},t.arrayFill=function(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);var t=e,r=String(t.name),i=String(t.message);if(null!=t.stack){var o=String(t.stack);return o.indexOf(i)>=0&&o.indexOf(r)>=0?o:"".concat(r,": ").concat(i,"\n").concat(o)}return i.indexOf(r)>=0?i:"".concat(r,": ").concat(i)},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message="".concat(t," ").concat(String(r.message)),r},t.values=function(e){var t=[];for(var r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},6988:(e,t)=>{"use strict";function r(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=(t=this.obj)[e].apply(t,r);return Promise.resolve(i)}},n=0,i=e;n<i.length;n++)r(i[n]);return t}(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=r,t.wrapIntoAsync=function(e,t){return new(r()(t))(e)}},6743:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(2228);function i(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=i,t.isChangeGateEnabled=function(e){var t;return null===(t=i()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},8906:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(2228),i={};function o(){return"undefined"==typeof __get_feature_gate_dictionary_variable?i:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var i=parseFloat(n);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var i=parseInt(n,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},2228:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(7933);t.globalThis=n},5550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(655);n.__exportStar(r(8906),t),n.__exportStar(r(581),t),n.__exportStar(r(6743),t),n.__exportStar(r(978),t),n.__exportStar(r(7470),t),n.__exportStar(r(6807),t)},581:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(8906);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},978:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(6743);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},7470:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(655),i=r(6743);function o(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return(0,i.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},6807:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(655),i=r(8906);function o(e){for(var t,r,o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];o[l]=null===(t=e[l])||void 0===t?void 0:t.toString()}var u=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},u()),o)})),u}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},186:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Endpoint:()=>M,WorkerError:()=>c,createWorker:()=>z,dispatchWorkerError:()=>y,importScriptsWithRetry:()=>X,isThreadingSupported:()=>p,isWorkerThread:()=>$,paramInsideDef:()=>b,setConfig:()=>m,workerName:()=>Z});var n=r(655);function i(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return o(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function s(e){return{name:e.name,message:i(e)?e.baseMessage:e.message,stack:e.stack,info:i(e)?(t=e.info,(0,n.__assign)((0,n.__assign)({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function l(e){return o(e)?{isError:!0,value:s(e)}:{isError:!1,value:e}}var u,c=function(e){function t(t,r){var i,o=this.constructor,a=this;(a=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify((0,n.__assign)((0,n.__assign)({},r),{error:null===(i=r.error)||void 0===i?void 0:i.message}))))||this).baseMessage=t,a.info=r,a.name="WorkerError";var s=o.prototype;return Object.getPrototypeOf(a)!==s&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,s):a.__proto__=s),a}return(0,n.__extends)(t,e),t.isWorkerError=i,t}(Error),d={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function f(e){return e.isError?function e(t){var r;if("WorkerError"===t.name)r=new c(t.message,function(t){return(0,n.__assign)((0,n.__assign)({},t),{error:t.error?e(t.error):void 0})}(t.info));else{var i=d[t.name];i?r=new i(t.message):(r=new Error(t.message)).name=t.name}return null!=t.stack&&(r.stack=t.stack),r}(e.value):e.value}function p(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function m(e){if(u)throw new TypeError("setConfig has already been called");u=e}function h(){var e=null!=u?u:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?(0,n.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function g(e){setTimeout((function(){throw e}))}function v(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function S(e){var t=v();if(void 0!==t){var r={kind:1,error:l(e)};t.postMessage(r)}else console.warn(e)}function y(e){var t;try{(null!==(t=null==u?void 0:u.onWorkerError)&&void 0!==t?t:S)(e)}catch(t){console.warn(e),g(t)}}function C(e){var t=v();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function R(e){var t;try{(null!==(t=null==u?void 0:u.onCreateWorker)&&void 0!==t?t:C)(e)}catch(e){g(e)}}var b=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return b.transfer.apply(b,(0,n.__spreadArray)([e,void 0],t,!1))};b.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var N=r(5550),T=(0,N.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);function P(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}(0,N.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var E;function k(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function O(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function A(e,t){var r=O(),n=T("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,r){var n;return"then"===r?void 0:null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)}:function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function I(e){throw e}var _=-1,F=function(){function e(e,t){var r,n,i=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=O();var o=function(){var e;return null===(e=i.onClose)||void 0===e?void 0:e.call(i)},a=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r=e.funcNames;null===(t=i.onImports)||void 0===t||t.call(i,A(i.createPostProxy.bind(i),r),A(i.createCallProxy.bind(i),r))},r[3]=o,r),s=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=o,n[3]=o,n);this.port.onmessage=function(e){var t=e.data;return a[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return s[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:(null!=E?E:E=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}())?void 0:function(e){for(var t=O();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var i=n[r];try{"function"==typeof e[i]&&(t[i]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed)for(var e in this.isClosed=!0,this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,i={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new c("Importing Endpoint closed while waiting for ".concat(n," result"),i))}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,i=e.args,o=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,i);var o=r>=0?"call":"post",a={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new c("Exporting Endpoint received a ".concat(o," to unknown function ").concat(n),a)}));r>=0?o.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):o.catch((function(e){var i=a(e),o={cause:"UnhandledError",idInfo:t.idInfo,error:i,callId:r,funcName:n};y(new c("Exporting Endpoint's ".concat(n," implementation threw or rejected"),o))}))},e.prototype.sendResult=function(e,t,r,n){var i={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:l(n)};try{this.port.postMessage(i,void 0)}catch(e){this.onSendResultFailed(i,a(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,i=e.resultValue,o=t?"Exporting Endpoint failed to send ".concat(n," result"):"Importing Endpoint failed to deserialize ".concat(n," result"),a={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},s=new c(o,a);i.isError?y(s):this.sendResult(r,n,!1,s)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var i=this;return r>1<<30?n:k(r,(function(){var n=i.takeCallbacks(e);if(n){var o={cause:"Timeout",idInfo:i.idInfo,timeout:r,callId:e,funcName:t};n.reject(new c("Importing Endpoint's call to ".concat(t," timed out"),o))}}),n)},e.prototype.sendCall=function(e,t,r,i){var o=this;return new Promise((function(s,l){var u=_+=1,d={kind:0,callId:u,funcName:e,args:t};o.unresolvedCalls[u]=(0,n.__assign)((0,n.__assign)({},o.setCallTimeout(u,e,r,{resolve:s,reject:l})),{funcName:e});try{o.port.postMessage(d,i)}catch(t){var f=o.takeCallbacks(u);if(f){var p=a(t),m={cause:"MessageError",idInfo:o.idInfo,error:p,callId:u,funcName:e};f.reject(new c("Importing Endpoint failed to send call to ".concat(e),m))}}}))},e.prototype.sendPost=function(e,t,r,n){var i={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(i,n)}catch(t){var o=a(t),s={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new c("Importing Endpoint failed to post to ".concat(e),s))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,i=r>=0?"call":"post",o={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},a=new c("Exporting Endpoint failed to deserialize ".concat(i," to ").concat(n),o),s=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==s?void 0:s.reject)&&void 0!==t?t:y)(a)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,i=e.resultValue;if(t>=0){var o=this.takeCallbacks(t);o&&(n?o.resolve:o.reject)(f(i))}else{var a={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};y(new c("Exporting Endpoint sent a result for a post to ".concat(r),a))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,(0,n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,o,a,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(!t.isClosed){var u=null!==(a=null!==(i=r.onPostMessageError)&&void 0!==i?i:null===(o=t.getOnPostMessageError)||void 0===o?void 0:o.call(t))&&void 0!==a?a:I;t.sendPost(e,s,u,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,(0,n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,o,a,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(t.isClosed){var u={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new c("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),u))}var d=null!==(a=null!==(i=r.callTimeout)&&void 0!==i?i:null===(o=t.getCallTimeout)||void 0===o?void 0:o.call(t))&&void 0!==a?a:1/0;return t.sendCall(e,s,d,n)},r.callTimeout=void 0,r},e}(),M=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=I,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new c("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(r," Endpoint started"),n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var i,o,a=r.port,s=r.options,l=r.createMode,d={type:"Endpoint",side:t,id:null==s?void 0:s.id};try{i=new F(d,a),o=new e(d,i,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;i.getCallTimeout=function(){return o.callTimeout},i.getOnPostMessageError=function(){return o.onPostMessageError},i.onImports=function(e,t){Object.defineProperties(o,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),p.resolve()},i.onClose=function(){return o.close("Force")};var l,f=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==u?void 0:u.createTimeout)&&void 0!==r?r:3e5}(s),p=k(f,(function(){var e="Outside"===t?"inside":"outside",r={cause:"Timeout",idInfo:d,timeout:f},n=new c("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),r);p.reject(n)}),{resolve:e,reject:r});o._closedDuringCreate=function(){p.resolve()};try{l=n(o)}catch(e){return p.reject(e)}null===(a=o._state)||void 0===a||a.setExports(l)})).then((function(){return o._closedDuringCreate=void 0,o}),(function(e){return o._closedDuringCreate=void 0,o.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new c("".concat(this._idInfo.side," Endpoint's close called during creation"),n)}this._closedDuringCreate()}var i=this._state;this._state=void 0;try{i.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:a(e)},y(new c("".concat(this._idInfo.side," Endpoint's close threw an error"),n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}();const D='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);';var w=-1,L=function(){function e(e,t){var r,n;try{var i;r=function(e){var t="def"in e?e:b(e),r=t.def,n=t.args,i=t.transferables;if("function"!=typeof r)return[r,n,i,void 0];var o="__generatedInsideInit".concat(w+=1);return[{scriptUrl:void 0,insideInitName:o},n,i,"var ".concat(o," = ").concat(r.toString(),";")]}(t),this.script=r[0],this.args=r[1],this.transferables=r[2];var o=void 0===(i=r[3])?[D]:[i,"\n\n",D];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));var a={};null!=e.id&&(a.name=e.id),this.worker=new Worker(this.blobUrl,a)}catch(e){throw null===(n=this.worker)||void 0===n||n.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,a=e.port,s=e.options,l={type:"Thread",side:"Outside",id:s.id},u=this.worker;return P(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var p={config:h(),port:a,options:s,script:r.script,args:r.args,featureGateDictionary:(0,N.getFeatureGateDictionary)(),changeGateDictionary:(0,N.getChangeGateDictionary)()};u.postMessage(p,(0,n.__spreadArray)([a],r.transferables,!0)),u.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(o(r.error)){if(i(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new c("".concat(t," received an unhandled error"),n)}if(null==r.message){var a={cause:"UnhandledError",idInfo:e};return new c("".concat(t," received a non-error (worker script fetch probably failed)"),a)}var s={cause:"UnhandledError",idInfo:e},l="".concat(r.message," at ").concat(r.filename,":").concat(r.lineno,":").concat(r.colno);return new c("".concat(t," received an unhandled error: ").concat(l),s)}(l,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):y(t)},u.onmessage=function(e){var n,i,o=e.data;switch(o.kind){case 0:return t.insideInit=o.stopwatch,void 0===o.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(i=r.createCallbacks)||void 0===i?void 0:i.reject(f(o.error));case 1:return y(f(o.error));case 2:return R(o.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),x="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function B(){return{status:"Pending",start:x()}}function U(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:x()))}function G(e,t){function r(t){throw U(e,i(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=U(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function K(e){return Math.round(1e3*e)/1e3}function V(e,t,r){return e<t?t:e>r?r:e}function j(e,t,r){var n,i,o,a=V(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),s=V(null!==(i=null==e?void 0:e.end)&&void 0!==i?i:1/0,t,r);return{status:null!==(o=null==e?void 0:e.status)&&void 0!==o?o:"Pending",start:K(a-t),end:K(s-t),duration:K(s-a)}}var W=function(){return r(186)};function H(e,t,r,n,i){var o,a=new MessageChannel,s=a.port1,l=a.port2;return Promise.all([n({port:s,options:e,createMode:t}),G(r.createOutside=B(),(function(){return M.createOutside({port:l,options:e,createMode:t},(function(e){return i(o=e)}))}))]).then((function(){return o}),(function(e){return o?o.close("Force"):l.close(),Promise.reject(e)}))}function Q(e,t,r,i){return H(e,"Local",t,(function(e){return function(e,t,r){var i="def"in r?r:b(r),o=i.def,a=i.args;if("function"!=typeof o){var s={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c("Loading an InsideScript to create a local worker is unimplemented",s))}return Promise.resolve().then((function(){return G(t.insideInit=B(),(function(){return o.apply(void 0,(0,n.__spreadArray)([{config:h(),importTypedWorkers:W,connection:e}],a,!1)).then((function(){}))}))}))}(e,t,r)}),i)}function q(e,t,r,n){var i;t.createThread=B();try{i=new L(e,r)}catch(e){return U(t.createThread,"Error"),Promise.reject(e)}return U(t.createThread,"Success"),H(e,"Thread",t,(function(e){return i.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?i.terminate():e._onClose=i.terminate.bind(i),e}),(function(e){return i.terminate(),Promise.reject(e)}))}function z(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==u?void 0:u.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?p()?"Thread":"Local":n}(e),i="local"in t?"Local"===n?t.local:t.thread:t,o="Local"===n?Q:q,a={id:e.id,createMode:n,createWorker:B()};return P(G(a.createWorker,(function(){return o(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),a,i,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,i=e.insideInit,o=e.createOutside,a=e.createThread,s=n.status,l=n.start,u=n.end;if("Pending"!==s&&void 0!==u)return{id:t,createMode:r,createWorker:{status:s,absStart:l,duration:K(u-l)},createThread:"Thread"===r?j(a,l,u):void 0,createOutside:j(o,l,u),insideInit:j(i,l,u)}}(a);e&&R(e)}))}function Y(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var i=e.slice(0,n+1),o=e.slice(n+1).split("&"),a=0;a<o.length&&("="!==o[a][t.length]||o[a].slice(0,t.length)!==t);a+=1);return o[a]="".concat(t,"=").concat(r),i+o.join("&")}function J(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?Y(e,"retries",String(n)):e)}catch(e){r=e}throw r}function X(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++)J(n[r],t);else importScripts.apply(void 0,e)}function $(){return"undefined"!=typeof WorkerGlobalScope}function Z(){return self.name}},6547:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;const n=r(342),i=r(4333),o=r(6789),a=r(8660),s=r(7638),l=r(419),u=r(8678),c=(0,i.pos)(i.PosKind.Abs,0),d=(0,i.pos)(i.PosKind.Abs,n.sheetRows-1),{codePointCapitalA:f,codePointFullStop:p}=s;function m(e){let t=e+1,r="";for(;t>0;){const e=(t-1)%26;r=String.fromCharCode(f+e)+r,t=Math.floor((t-e)/26)}return r}function h(e,t,r,n){if(t.kind===i.PosKind.Abs)return t.index;if(n)return(0,o.wrapPosition)(e,t.index,r);const a=e+t.index;return 0<=a&&a<r?a:void 0}function g(e,t,r,n,o,a){const s=h(r,n,o,a);if(void 0===s)return;if(n.kind===i.PosKind.Abs)return t+(s+1).toFixed();const l=s-r;return 0===l?t:t+e.rcLeftBracket+l.toFixed()+e.rcRightBracket}function v(e,t,r,o,a){return t===i.RefStyle.A1?function(e,t,r){const o=h(e,t,n.sheetRows,r);if(void 0===o)return;const a=(o+1).toFixed();return t.kind===i.PosKind.Abs?"$"+a:a}(r,o,a):g(e,e.rowLetter,r,o,n.sheetRows,a)}function S(e,t,r,o,a){return t===i.RefStyle.A1?function(e,t,r){const o=h(e,t,n.sheetCols,r);if(void 0===o)return;const a=m(o);return t.kind===i.PosKind.Abs?"$"+a:a}(r,o,a):g(e,e.columnLetter,r,o,n.sheetCols,a)}function y(e,t,r,n){if(r.kind===i.PosKind.Abs)return r;const o=h(t,r,e,n);if(void 0===o)return;const a=o-t;return a===r.index?r:(0,i.pos)(i.PosKind.Rel,a)}function C(e,t,r,n,i){const o=h(e,t,n,i),a=h(e,r,n,i);if(void 0!==o&&void 0!==a)return o<=a?[t,r,o,a]:[r,t,a,o]}function R(e,t,r,n,o,a,s,l,u){const c=C(a,s,l,r,u);if(void 0===c)return;const[d,f,p,m]=c;if(void 0!==t&&0===p&&m===r-1&&s.kind===l.kind)return t(n,o,u);const h=e(n,o,a,d,u);if(void 0===h)return;if(o===i.RefStyle.R1C1&&d.kind===f.kind&&d.index===f.index)return h;const g=e(n,o,a,f,u);return void 0!==g?h+":"+g:void 0}function b(e,t,r,n,i,o){const a=C(r,n,i,t,o);if(void 0===a)return;const[s,l,u,c]=a;if(void 0!==e&&0===u&&c===t-1&&n.kind===i.kind)return e;const d=y(t,r,s,o),f=y(t,r,l,o);return void 0!==d&&void 0!==f?[!1,d,f]:void 0}function N(e,t,r,n,o,a){const s=v(e,t,r.row,n,a),l=S(e,t,r.col,o,a);if(void 0!==s&&void 0!==l)return t===i.RefStyle.A1?l+s:s+l}function T(e,r,i,o,a,s,l,u){const c=C(i.row,o,s,n.sheetRows,u),d=C(i.col,a,l,n.sheetCols,u);if(void 0===c||void 0===d)return;const[f,p,m,h]=c,[g,v,S,y]=d;if(0===S&&y===n.sheetCols-1&&a.kind===l.kind)return(0,t.formatRowRange)(e,r,i.row,f,p,u);if(0===m&&h===n.sheetRows-1&&o.kind===s.kind)return(0,t.formatColRange)(e,r,i.col,g,v,u);const R=N(e,r,i,f,g,u),b=N(e,r,i,p,v,u);return void 0!==R&&void 0!==b?R+":"+b:void 0}function P(e,t){return t===p||e.isIdentContinue(t)}t.columnName=m,t.canonicaliseBrackets=function(e,t){return e===i.RefStyle.R1C1&&t.kind===i.PosKind.Rel&&0!==t.index},t.resolvePosition=h,t.formatRow=v,t.formatCol=S,t.canonicaliseRow=y.bind(void 0,n.sheetRows),t.canonicaliseCol=y.bind(void 0,n.sheetCols),t.formatRowRange=R.bind(void 0,v,void 0,n.sheetRows),t.formatColRange=R.bind(void 0,S,(e,r,n)=>(0,t.formatRowRange)(e,r,0,c,d,n),n.sheetCols),t.canonicaliseRowRange=b.bind(void 0,void 0,n.sheetRows),t.canonicaliseColRange=b.bind(void 0,[!0,c,d],n.sheetCols),t.formatCellPos=N,t.canonicaliseCellPos=function(e,r,n,i){const o=(0,t.canonicaliseRow)(e.row,r,i),a=(0,t.canonicaliseCol)(e.col,n,i);if(void 0!==o&&void 0!==a)return{row:o,col:a}},t.formatRangePos=T,t.canonicaliseRangePos=function(e,r,i,o,a,s){const l=C(e.row,r,o,n.sheetRows,s),u=C(e.col,i,a,n.sheetCols,s);if(void 0===l||void 0===u)return;const[c,d,f,p]=l,[m,h,g,v]=u,S=(0,t.canonicaliseRow)(e.row,c,s),y=(0,t.canonicaliseCol)(e.col,m,s),R=(0,t.canonicaliseRow)(e.row,d,s),b=(0,t.canonicaliseCol)(e.col,h,s);return void 0!==S&&void 0!==y&&void 0!==R&&void 0!==b?0===g&&v===n.sheetCols-1&&i.kind===a.kind?{row1:S,row2:R,col1:void 0,col2:void 0}:0===f&&p===n.sheetRows-1&&r.kind===o.kind?{col1:y,col2:b,row1:void 0,row2:void 0}:{row1:S,col1:y,row2:R,col2:b}:void 0};const E=/'/g;function k(e,t){if(0===t.length)return!1;let r=0;const n=(0,l.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,l.numCodeUnits)(n);for(const n of(0,l.codePointIterator)(t,r))if(!P(e,n))return!1;return!0}const O=(0,n.gridCell)(0,0);function A(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;const n=(0,o.parseCellRef)(e,t,O,r,0);if(void 0!==n)if(n.refStyle===i.RefStyle.A1){const{i:t}=n;if(t>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,t)))return!0}else if(!(0,o.isR1C1IdentStart)(n.row,n.col))return!0;return!k(e,r)&&!function(e,t){let r=0;if(!(0,u.stringStartsWith)(t,e.leftBracket,r))return!1;if(r+=e.leftBracket.length,r===t.length)return!1;const n=(0,l.stringCodePointAt)(t,r);if(!P(e,n))return!1;for(r+=(0,l.numCodeUnits)(n);;){if((0,u.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;const n=(0,l.stringCodePointAt)(t,r);if(!P(e,n))return!1;r+=(0,l.numCodeUnits)(n)}const i=t.indexOf(":",r);return i<0?k(e,t.substring(r)):k(e,t.substring(r,i))&&k(e,t.substring(i+1))}(e,r)&&!function(e,t){const r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&t.substring(0,r)===e.leftBracket&&t.substring(t.length-n)===e.rightBracket&&k(e,t.substring(r,t.length-n))}(e,r)}function I(e,t,r){return A(e,t,r)?_(r):r}function _(e){return`'${e.replace(E,"''")}'`}t.shouldQuoteQualifier=A,t.formatQualifier=I,t.quoteQualifier=_,t.formatGridRange=function(e,t,r=i.RefStyle.A1,o,s){const l=1===t.cols&&1===t.rows?N(e,r,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),!1):T(e,r,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),(0,i.pos)(i.PosKind.Rel,t.row+t.rows-1),(0,i.pos)(i.PosKind.Rel,t.col+t.cols-1),!1);if((0,a.assertTrue)("calc.lang.formatGridRange",void 0!==l),void 0===o&&void 0===s)return l;if(void 0===o||void 0===s)return I(e,r,null!=o?o:s)+"!"+l;const u=o+":"+s;return(A(e,r,o)||A(e,r,s)?_(u):u)+"!"+l},t.formatName=function(e,t,r=i.RefStyle.A1,n){return void 0===n?t:I(e,r,n)+"!"+t}},6789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(342),i=r(5385),o=r(4333),a=r(190),s=r(7638),l=r(8678),u=r(419),c=n.sheetRows,d=c.toString(10).length,f=n.sheetCols,p=f.toString(26).length,m=f.toString(10).length,{codePointCapitalA:h,codePointCapitalZ:g,codePointSmallA:v,codePointSmallZ:S,codePointPlusSign:y,codePointMinusSign:C,codePointColon:R}=s;function b(e){return e>=v&&e<=S||e>=h&&e<=g}function N(e){return 1+(e>=v?e-v:e-h)}function T(e,t,r,n){return function(i,a,s,c,d){const[f,p]=function(e,t){return(0,l.stringStartsWith)(e,"$",t)?[o.PosKind.Abs,t+1]:[o.PosKind.Rel,t]}(s,c),[m,h]=e(i,r,s,p);if(h>p){if(m<1||m>t)return f===o.PosKind.Abs||(!0===n?"object"==typeof d&&d.kind===o.PosKind.Abs||d===D.A1BadDollar:(0,l.stringStartsWith)(s,"$",h))?[D.A1BadDollar,!0,h]:void 0;const e=f===o.PosKind.Rel?m-a:m;return[(0,o.pos)(f,e-1),f===o.PosKind.Abs,h]}return f!==o.PosKind.Abs||!0!==n&&h!==s.length&&i.isNumeral((0,u.stringCodePointAt)(s,h))?[void 0,!1,c]:[D.A1BadDollar,!0,h]}}function P(e,t,r){return L(e,t,r)-e}function E(e,t,r,n){return function(i,s,u,c){const d=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(c>=u.length||0!==i.stringCompareCI(d,u[c]))return[void 0,!1,c];let f=c+d.length;const[p,m]=(0,a.parseUint)(i,n,u,f);if(m>f&&p>=1&&p<=r)return[(0,o.pos)(o.PosKind.Abs,p-1),!1,m];if((0,l.stringStartsWith)(u,i.rcLeftBracket,f)){if(f+=i.rcLeftBracket.length,(0,l.stringStartsWith)(u,i.rcRightBracket,f))return[(0,o.pos)(o.PosKind.Rel,P(s,0,r)),!0,f+i.rcRightBracket.length];let e=1;const t=u.charCodeAt(f);t===y?f+=1:t===C&&(e=-1,f+=1);const[c,d]=(0,a.parseUint)(i,n,u,f);if(d>f&&c<r&&(0,l.stringStartsWith)(u,i.rcRightBracket,d))return[(0,o.pos)(o.PosKind.Rel,P(s,c*e,r)),!0,d+i.rcRightBracket.length]}return[D.RCNoNum,!1,c+d.length]}}function k(e,t,r,n,i,o,a){const s=n(e,t,o,a,void 0);if(null==s)return[void 0,void 0,a];const[l,u,c]=s;if(c>a){const t=i(e,r,o,c,l);if(null==t)return u?[l,void 0,c]:[void 0,void 0,a];const[n,,s]=t;return s>c?[l,n,s]:[l,void 0,c]}const d=i(e,r,o,a,l);if(null==d)return[void 0,void 0,a];const[f,,p]=d;return p>a?[void 0,f,p]:[void 0,void 0,a]}const O=T(a.parseUint,c,d,!0),A=T((e,t,r,n)=>function(e,t,r){let n=0,o=r;const a=(0,i.fastMin)(t.length,r+e);for(;o<a;o+=1){const e=t.charCodeAt(o);if(!b(e))break;n=26*n+N(e)}return o===a&&o<t.length&&b(t.charCodeAt(o))?[0,r]:[n,o]}(t,r,n),f,p,!1),I=E(!1,!0,c,d),_=E(!1,!1,f,m),F=E(!0,!0,c,d),M=E(!0,!1,f,m);var D;function w(e,t){return"object"!=typeof e&&"object"!=typeof t}function L(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(D=t.SpecialPos||(t.SpecialPos={})),t.isR1C1IdentStart=w,t.parseCellRef=function(e,t,r,n,i){const a=function(e,t,r,n,i){const{col:a,row:s}=r,[l,c,d]=k(e,a,s,A,O,n,i),f="object"==typeof c&&c.kind===o.PosKind.Abs||c===D.A1BadDollar||"object"==typeof l&&l.kind===o.PosKind.Abs||l===D.A1BadDollar;if(null!=c&&null!=l||f||(null!=c||null!=l)&&(i-1>=0&&n.charCodeAt(i-1)===R||d<n.length&&n.charCodeAt(d)===R)){if(d<n.length&&e.isIdentContinue((0,u.stringCodePointAt)(n,d)))return;if(t!==o.RefStyle.A1&&!f)return;return{refStyle:o.RefStyle.A1,row:c,col:l,i:d}}}(e,t,r,n,i);return void 0!==a?a:function(e,t,r,n,i){const{col:a,row:s}=r;let l=!1,[c,d,f]=k(e,s,a,I,_,n,i);if(null!=c||null!=d||"R"===e.rowLetter&&"C"===e.columnLetter||(l=!0,[c,d,f]=k(e,s,a,F,M,n,i)),(null!=c||null!=d)&&(f>=n.length||!w(c,d)||!e.isIdentContinue((0,u.stringCodePointAt)(n,f))))return{refStyle:o.RefStyle.R1C1,row:c,col:d,i:f,enLocale:l}}(e,0,r,n,i)},t.parseGridCellA1=function(e,t){const[r,i,o]=k(e,0,0,A,O,t,0);return"object"==typeof r&&"object"==typeof i&&o===t.length?(0,n.gridCell)(i.index,r.index):void 0},t.parseGridRangeA1=function(e,t){const[r,o,a]=k(e,0,0,A,O,t,0);if("object"!=typeof r||"object"!=typeof o)return;if(a===t.length)return(0,n.gridCell)(o.index,r.index);if(t.charCodeAt(a)!==R)return;const[s,l,u]=k(e,0,0,A,O,t,a+1);if("object"!=typeof s||"object"!=typeof l)return;if(u!==t.length)return;const c=(0,i.fastMin)(o.index,l.index),d=(0,i.fastMin)(r.index,s.index);return(0,n.gridRange)(c,d,(0,i.fastMax)(o.index,l.index)+1-c,(0,i.fastMax)(r.index,s.index)+1-d)},t.parseQualifier=function(e){const t=e.lastIndexOf("!");if(t<0||0===t||t===e.length-1)return;const r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if(!(0,l.stringStartsWith)(r,"'")||!(0,l.stringEndsWith)(r,"'"))return;const i=[];for(let e=1;e<r.length-1;++e){const t=r.charAt(e);if("'"===t){if(e+1>=r.length-1||"'"!==r.charAt(e+1))return;i.push(t),++e}else i.push(t)}return{qualifier:i.join(""),unqualified:n}},t.wrapPosition=L},1033:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(637);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},8660:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(637);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},7638:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;const n=r(637);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},5385:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(637);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},8391:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;const n=r(637);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},6553:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;const n=r(637);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;const n=r(637);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},9124:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(637);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(9992);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},6903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(637);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},5781:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(637);t.Pledge=n.pledge.Pledge},419:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;const n=r(637);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},8678:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(637);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},8556:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;const n=r(1821);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}});const i=r(5385),o=r(8660);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return o.ulsLogger}});const a=r(9431),s=r(8678),l=r(419),u=r(873),c=r(8391),d=r(2054),f=r(4333),p=r(378),m=r(9612),h=r(446);function g(e,t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,b,N,T,P,E,k,O,A,I,_,F,M,D,w,L,x,B,U,G,K,V,j,W,H,Q,q,z,Y,J,X,$,Z,ee,te,re,ne,ie,oe,ae,se,le,ue,ce,de,fe,pe){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:o,isIdentStart:a,isIdentContinue:s,stringCompareCI:l,errorNames:u,specialRefNames:c,trueName:d,falseName:f,rowLetter:p,columnLetter:m,leftBrace:h,rightBrace:g,leftBracket:v,rightBracket:S,rcLeftBracket:y,rcRightBracket:C,decimalSeparator:R,listSeparator:b,columnSeparator:N,rowSeparator:T,thousandsSeparator:P,statementSeparator:E,lcid:k,country:O,isThai:A,isEastAsia:I,isKorea:_,isJapan:F,isChinaT:M,isChinaS:D,isComplexScript:w,numberDecimals:L,isExpSepBySpace:x,fractionSeparator:B,isPercentSepBySpace:U,currencyFormat:G,isCurrencySymbolLead:K,isCurrencySepBySpace:V,currencySymbol:j,currencyDecimals:W,dateOrder:H,dateSeparator:Q,dateAltSeparator:q,year4Digits:z,month2Digits:Y,day2Digits:J,longDateFormat:X,timeSeparator:$,timeAltSeparator:Z,hour2Digits:ee,clock24Hour:te,isAMPMSepBySpace:re,ampmSymbols:ne,dayNameShort:ie,dayNameLong:oe,monthNameShort:ae,monthNameLong:se,pictureSpecial:le,pictureSingle:ue,pictureColor:ce,pictureDbnum:de,sysDateFormat:fe,sysTimeFormat:pe}}var v,S,y,C,R,b;function N(e){const t=0|e;if(t<128)return t>=48&&t<58;const r=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 4960:return r>=9;case 4976:return r<=1;default:return!1}}function T(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,o.assertFalse)("calc.config.getOrdinal"),15&t;const r=15&t;let n;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:n=r;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:n=r-6;break;case 4960:n=r-8;break;case 4976:n=r+8;break;default:return(0,o.assertFalse)("calc.config.getOrdinal")}return(n<0||n>9||4968===t)&&(0,o.assertFalse)("calc.config.getOrdinal"),n}function P(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,o.assertFalse)("calc.config.getNumberShape"),p.NumberShape.ASCII;switch(N(t)||(0,o.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return p.NumberShape.ArabicIndic;case 1776:return p.NumberShape.ExtendedArabicIndic;case 2400:return p.NumberShape.Devanagari;case 2528:return p.NumberShape.Bengali;case 2656:return p.NumberShape.Gurmukhi;case 2784:return p.NumberShape.Gujarati;case 2912:return p.NumberShape.Oriya;case 3040:return p.NumberShape.Tamil;case 3168:return p.NumberShape.Telugu;case 3296:return p.NumberShape.Kannada;case 3424:return p.NumberShape.Malayalam;case 3664:return p.NumberShape.Thai;case 3792:return p.NumberShape.Lao;case 3872:return p.NumberShape.Tibetan;case 4160:return p.NumberShape.Myanmar;case 4960:case 4976:return p.NumberShape.Ethiopic;case 6112:return p.NumberShape.Khmer;case 6160:return p.NumberShape.Mongolian;default:return(0,o.assertFalse)("calc.config.getNumberShape")}}function E(e){return 0!=((0,u.getCharCodeBits)(e)&l.CharCodeBits.IdentStartClass)}function k(e){return 0!=((0,u.getCharCodeBits)(e)&l.CharCodeBits.IdentContinueClass)}let O;t.calcConfig=function(e,t=f.RefStyle.A1,r=h.xlMathpack,n=!1,i=!0,o=m.tzUTC,a=m.xlDatepack){return{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:o,datepack:a}},t.localeInfo=g,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(v=t.Country||(t.Country={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(S=t.LCID||(t.LCID={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(y=t.PictureSpecial||(t.PictureSpecial={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(C=t.PictureSingle||(t.PictureSingle={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(R=t.PictureColor||(t.PictureColor={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(b=t.PictureDbnum||(t.PictureDbnum={})),t.isNumeral=N,t.getOrdinal=T,t.getNumberShape=P,t.isIdentStart=E,t.isIdentContinue=k,t.englishErrorNames=(0,s.partialArray)({[d.ErrorType.NULL]:"#NULL!",[d.ErrorType.DIV0]:"#DIV/0!",[d.ErrorType.VALUE]:"#VALUE!",[d.ErrorType.REF]:"#REF!",[d.ErrorType.NAME]:"#NAME?",[d.ErrorType.NUM]:"#NUM!",[d.ErrorType.NA]:"#N/A",[d.ErrorType.GETTING_DATA]:"#GETTING_DATA",[d.ErrorType.SPILL]:"#SPILL!",[d.ErrorType.CONNECT]:"#CONNECT!",[d.ErrorType.BLOCKED]:"#BLOCKED!",[d.ErrorType.UNKNOWN]:"#UNKNOWN!",[d.ErrorType.FIELD]:"#FIELD!",[d.ErrorType.CALC]:"#CALC!",[d.ErrorType.BUSY]:"#BUSY!",[d.ErrorType.EXTERNAL]:"#EXTERNAL!"}),t.englishSpecialRefNames=(0,s.partialArray)({[f.SpecialRefId.All]:"#All",[f.SpecialRefId.Data]:"#Data",[f.SpecialRefId.Headers]:"#Headers",[f.SpecialRefId.Totals]:"#Totals",[f.SpecialRefId.ThisRow]:"#This Row"}),t.englishPictureSpecial=(0,s.partialArray)({[y.AP1]:"AM/PM",[y.AP2]:"A/P",[y.AP3]:"/",[y.General]:"General",[y.Currency]:"$"}),t.englishPictureSingle=(0,s.partialArray)({[C.Sep]:";",[C.Hash]:"#",[C.Zero]:"0",[C.Decimal]:".",[C.Percent]:"%",[C.Comma]:",",[C.Colon]:":",[C.DateSep]:"/",[C.Slash]:"/",[C.Space]:" ",[C.Minus]:"-",[C.Plus]:"+",[C.OpenParen]:"(",[C.CloseParen]:")",[C.Backslash]:"\\",[C.Star]:"*",[C.Year]:"y",[C.Month]:"m",[C.Day]:"d",[C.Hour]:"h",[C.Minute]:"m",[C.Second]:"s",[C.E]:"E",[C.APDelim]:"/",[C.Quote]:'"',[C.ColorStart]:"[",[C.ColorEnd]:"]",[C.Text]:"@",[C.Question]:"?",[C.Underscore]:"_",[C.Reign]:"r",[C.LocDay]:"a",[C.Era]:"g",[C.EraYear]:"e",[C.BidiDate]:"B",[C.BidiNum]:"N",[C.DayTh]:"",[C.MonthTh]:"",[C.YearTh]:"",[C.EngYearTh]:"b",[C.ThYear]:"",[C.HourTh]:"",[C.MinuteTh]:"",[C.SecondTh]:"",[C.ZeroTh]:""}),t.englishPictureColor=(0,s.partialArray)({[R.Black]:"Black",[R.White]:"White",[R.Red]:"Red",[R.Green]:"Green",[R.Blue]:"Blue",[R.Yellow]:"Yellow",[R.Magenta]:"Magenta",[R.Cyan]:"Cyan",[R.Color]:"Color"}),t.englishPictureDbnum=(0,s.partialArray)({[b.DBNUM1]:"DBNum1",[b.DBNUM2]:"DBNum2",[b.DBNUM3]:"DBNum3",[b.DBNUM4]:"DBNum4"}),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM",t.englishWorksheetFuncIdToName=function(e){const t=I()[e];return void 0===t?"wsf:"+e:t},t.englishErrorTypeToName=function(e){const r=t.englishErrorNames[e];return void 0===r?"error.type:"+e:r},t.englishOperatorIdToName=function(e){if(e===a.OperatorId.Isect)return" ";if(e===a.OperatorId.Union)return",";const t=a.operatorStrings[e];return void 0===t?"op:"+e:t},t.operatorIdToName=function(e,t,r){return t===a.OperatorId.Isect?r:t===a.OperatorId.Union?e.listSeparator:a.operatorStrings[t]};const A=/_/g;function I(){if(null==O){O=[];for(const e of(0,i.numEnumArray)(a.WorksheetFuncId)){const t=(0,a.getWorksheetFuncEnglishName)(e),r=null!=t?t:a.WorksheetFuncId[e].replace(A,".");O[e]=r}}return O}function _(e,t){const r=function(e,t){const r=[];return t.forEach((e,t)=>{null!=e&&r.push([e,t])}),c.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:e=>r.getValue(e),getWorksheetFuncName(e){const r=t[e];return null==r?(0,o.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}let F;t.getEnglishWorksheetFuncIdToName=I,t.createWorksheetFuncNameCallbacks=_,t.getEnglishLocaleInfo=function(){return null==F&&(F=function(){const e=I(),r=(0,i.makeStringCompareCI)("en-US"),{getWorksheetFuncId:n,getWorksheetFuncName:o}=_(r,e);return g(n,o,N,T,P,e=>e>0&&e%3==0,E,k,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",S.USA,v.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,p.CurrencyFormat.Paren,!0,!1,"$",2,p.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),F}},9612:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;const n=r(9799),i=r(2054),o=r(5385);var a;t.tzData=(0,o.typedInstanceCreator)()((e,t,r,n,i)=>({bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i})),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=n.dtr.Rounding,t.dateTime=n.dtr.dtr,t.TimeDivision=n.dtr.TimeDivision,(a=t.TimeGranularity||(t.TimeGranularity={}))[a.Year=0]="Year",a[a.Day=1]="Day",a[a.Instant=2]="Instant",t.xlDatepack={fromNum:function(e,t,r){return n.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){const r=n.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):i.numErrorOper},toNumWithDuration:function(e,t,r,o){const a=n.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,o);return"number"==typeof a?e.mathpack.fromNumber(a):i.numErrorOper},daysPerMonth:n.dtr.daysPerMonth,toDays:function(e,t){return n.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,i){return n.dtr.toTime(e.mathpack.toNumber(t),r,i)},utcToLocal:function(e,t,r){return n.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},4333:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=void 0;const n=r(8660),i=r(5385),o=r(5385);var a,s,l,u,c,d,f,p,m,h,g,v;function S(e){return Array.isArray(e)}function y(e){return void 0!==e.kind}function C(e){const t=[];for(const{arg:r,index:i}of e)(0,n.assertIndex)("calc.lang.flattenNumberedArgs: idx",i,e.length),(0,n.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[i]),t[i]=r;return t}function R(e,t,r){return C((0,o.safeConcat)([...void 0===t?[]:[t],...r],e.map(({name:e,binder:t})=>[e,t])))}function b(e,t){return{arg:e,index:t}}function N(e,t){return{name:e,binder:t}}function T(e,t,r=[]){return C([...e.map(e=>e.name),...void 0===t?[]:[t],...r])}function P(e,t,r=!0,n=0){return{kind:c.ParamName,label:n,name:e,isBracketed:t,isClosed:r}}function E(e,t,r=0){return{kind:c.Param,label:r,name:e,whole:e.name.kind===c.Name?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}}function k(e){return{name:e}}function O(e,t,r=0){const n="string"==typeof e?e:e.asWhole,i="string"==typeof e?A(e,!0):e;return{kind:c.Name,label:r,whole:n,parts:i,qualifier:t}}function A(e,t=!0,r=0,n=0){return{kind:d.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}}function I(e,t=!1,r=!0,i=0){return(0,n.assertTrue)("calc.lang.fieldRef","string"==typeof e||e.kind!==c.Name||void 0===e.qualifier),{kind:c.FieldRefRHS,label:i,field:"string"==typeof e?O(e):e,isBracketed:t,isClosed:r}}function _(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case c.Array:{let n=0;for(const o of t.nodes)for(const t of o)n=(0,i.fastMax)(n,e(t,r+1));return n+1}case c.Param:return void 0===t.def?1:e(t.def.rhs,r+1)+1;case c.Let:case c.Lambda:case c.App:{let n=e(t.head,r+1);for(const o of t.args)n=(0,i.fastMax)(n,e(o,r+1));return n+1}case c.Paren:return e(t.node,r+1)+1;case c.FieldRef:return e(t.lhs,r+1)+1;case c.Name:case c.CellRef:case c.StructRef:case c.Literal:case c.Operator:case c.WSF:return 1;case c.Bad:switch(t.type){case m.Sequence:case m.StructRef:case m.FieldRef:{let n=0;for(const o of t.contents)n=(0,i.fastMax)(n,e(o,r+1));return n+1}default:return"string"==typeof t.contents?1:(0,n.assertNever)("calc.lang.getDepthUpperBound",t.contents)}default:return(0,n.assertNever)("calc.lang.getDepthUpperBound",t)}}(e,0)}(v=t.RefStyle||(t.RefStyle={}))[v.R1C1=1]="R1C1",v[v.A1=2]="A1",(g=t.SyntaxFeature||(t.SyntaxFeature={})).Comments="Comments",g.Statements="Statements",function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(a=t.QualifierKind||(t.QualifierKind={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(s=t.CellRefKind||(t.CellRefKind={})),(h=t.PosKind||(t.PosKind={})).Abs="Abs",h.Rel="Rel",function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(l=t.CommentKind||(t.CommentKind={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(u=t.AnnotationKind||(t.AnnotationKind={})),t.appHeadNameAnnotation={kind:u.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF",e.Param="Param",e.ContextName="ContextName",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(c=t.NodeKind||(t.NodeKind={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(d=t.NamePartKind||(t.NamePartKind={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(f=t.SpecialRefId||(t.SpecialRefId={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(p=t.StructRefKind||(t.StructRefKind={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.Missing="Missing",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(m=t.BadType||(t.BadType={})),t.errorQualifier=function(e=0){return{kind:a.Error,isQuoted:!1,label:e}},t.relativeQualifier=function(e=0){return{kind:a.Relative,isQuoted:!1,label:e}},t.documentQualifier=function(e,t,r=!1,n=0){return{kind:a.Document,isQuoted:r,label:n,document:e,path:t}},t.sheetQualifier=function(e,t,r=!1,n=0){return{kind:a.Sheet,isQuoted:r,label:n,sheet:e,document:t}},t.identQualifier=function(e,t=!1,r=0){return{kind:a.Ident,isQuoted:t,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,n=!1,i=0){return{kind:a.SheetRange,isQuoted:n,label:i,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t=!1,r=0){return{kind:a.Bad,isQuoted:t,label:r,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e=0){return{kind:s.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r=!1,n=0){return{kind:s.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r=0){const n=e.isBracketed||t.isBracketed;return{kind:s.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r=!1,n=0){return{kind:s.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r=!1,n=0){return{kind:s.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t=!1,r=0){return{kind:s.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:_(e)}},t.singleLineComment=function(e,t=0){return{kind:l.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t=!0,r=0){return{kind:l.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,i,o,a){return(0,n.assertNatural)("calc.lang.formulaSpan",e),(0,n.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,n.assertFalse)(`calc.lang.formulaSpan: expected end >= ${e}; given ${t}`),{start:e,end:t,pre:r,post:i,preComments:o,postComments:a}},t.localNameUseAnnotation=function(e,t,r){return{kind:u.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r=[]){return{kind:u.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:u.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t=!0,r=0){return{kind:c.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t=!0,r=0){return{kind:c.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r=!0,n=0){return{kind:c.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=R,t.indexedArg=b,t.letVar=N,t.letNode=function(e,t,r,i=[],o=!0,a=0){(0,n.assertTrue)("calc.lang.letNode",t.every(e=>void 0===(S(e)?e[0]:e.name.arg).qualifier));const s=t.map((e,t)=>S(e)?N(b(e[0],2*t),b(e[1],2*t+1)):e).sort((e,t)=>e.name.index-t.name.index),l=void 0!==r&&y(r)?b(r,2*t.length):r,u=R(s,l,i);return{kind:c.Let,label:a,head:e,args:u,isClosed:o,vars:s,body:l,badArgs:i}},t.flattenLambdaArgs=T,t.paramName=P,t.paramDefault=function(e,t=0){return{kind:c.ParamDef,label:t,rhs:e}},t.paramNode=E,t.lambdaParam=k,t.lambdaNode=function(e,t,r,i=[],o=!0,a=0){(0,n.assertTrue)("calc.lang.lambdaNode",t.every(e=>{const t=y(e)?e:e.name.arg,r=t.kind===c.Name?t:t.name.name;return r.kind!==c.Name||void 0===r.qualifier}));const s=t.map((e,t)=>y(e)?e.kind===c.Name?k(b(E(P(e,!1),void 0),t)):k(b(e,t)):e).sort((e,t)=>e.name.index-t.name.index),l=void 0!==r&&y(r)?b(r,t.length):r,u=T(s,l,i);return{kind:c.Lambda,label:a,head:e,args:u,isClosed:o,params:s,body:l,badArgs:i}},t.operatorNode=function(e,t=0){return{kind:c.Operator,label:t,id:e}},t.wsfNode=function(e,t,r=0){return{kind:c.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t=!0,r=0){return{kind:c.Paren,label:r,node:e,isClosed:t}},t.nameNode=O,t.identNamePart=A,t.cellRefNamePart=function(e,t,r=0,n=0){return{kind:d.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r=!0,i=0,o=0){var a,s;const l="string"==typeof t?I(t,!1,!0):t;return(0,n.assertTrue)("calc.lang.fieldRefNamePart",(null===(a=null==l?void 0:l.isClosed)||void 0===a||a)&&!(null!==(s=null==l?void 0:l.isBracketed)&&void 0!==s&&s)),{kind:d.FieldRefNamePart,label:i,qualifiedLabel:o,asWhole:e.asWhole+"."+(void 0===l?"":l.field.kind===c.Name?l.field.whole:l.field.contents),canDenoteNamedObject:r,lhs:e,rhs:l}},t.flattenNameParts=function(e){const t=[e];let r=t[0];for(;r.kind===d.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){let t=e;for(;t.kind===d.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t=0){return{kind:c.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r=0){return{kind:c.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r=!1,n=0){return{kind:c.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}},t.fieldRef=I,t.structRefNode=function(e,t,r=0){return{kind:c.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t=!1,r=!0,n=0){return{kind:p.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t=!1,r=!0,n=0){return{kind:p.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r=0){return{kind:p.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t=0){const r={[f.All]:!1,[f.Data]:!1,[f.Headers]:!1,[f.Totals]:!1,[f.ThisRow]:!1},n=[];for(const t of e)switch(t.kind){case p.SpecialRef:r[t.id]=!0;break;case p.ColumnRef:case p.RangeOpRef:n.push(t)}return{kind:p.CommaOpRef,label:t,refs:e,specialRefs:r,columnRefs:n}},t.thisRowOpRef=function(e,t=0){return{kind:p.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e=0){return{kind:p.MissingRef,label:e}},t.badRef=function(e,t=!1,r=!0,n=0){return{kind:p.BadRef,contents:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t=!0,r=0){return{kind:c.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.badNode=function(e,t,r=0){return{kind:c.Bad,label:r,type:e,contents:t}},t.getDepthUpperBound=_},873:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCharCodeBits=void 0;var n=r(637).unicode.makeGetCharCodeBits;t.getCharCodeBits=n([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},5511:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;const n=r(7161);var i;(i=t.WorksheetFuncId||(t.WorksheetFuncId={}))[i.COUNT=0]="COUNT",i[i.IF=1]="IF",i[i.ISNA=2]="ISNA",i[i.ISERROR=3]="ISERROR",i[i.SUM=4]="SUM",i[i.AVERAGE=5]="AVERAGE",i[i.MIN=6]="MIN",i[i.MAX=7]="MAX",i[i.ROW=8]="ROW",i[i.COLUMN=9]="COLUMN",i[i.NA=10]="NA",i[i.NPV=11]="NPV",i[i.STDEV=12]="STDEV",i[i.DOLLAR=13]="DOLLAR",i[i.FIXED=14]="FIXED",i[i.SIN=15]="SIN",i[i.COS=16]="COS",i[i.TAN=17]="TAN",i[i.ATAN=18]="ATAN",i[i.PI=19]="PI",i[i.SQRT=20]="SQRT",i[i.EXP=21]="EXP",i[i.LN=22]="LN",i[i.LOG10=23]="LOG10",i[i.ABS=24]="ABS",i[i.INT=25]="INT",i[i.SIGN=26]="SIGN",i[i.ROUND=27]="ROUND",i[i.LOOKUP=28]="LOOKUP",i[i.INDEX=29]="INDEX",i[i.REPT=30]="REPT",i[i.MID=31]="MID",i[i.LEN=32]="LEN",i[i.VALUE=33]="VALUE",i[i.TRUE=34]="TRUE",i[i.FALSE=35]="FALSE",i[i.AND=36]="AND",i[i.OR=37]="OR",i[i.NOT=38]="NOT",i[i.MOD=39]="MOD",i[i.DCOUNT=40]="DCOUNT",i[i.DSUM=41]="DSUM",i[i.DAVERAGE=42]="DAVERAGE",i[i.DMIN=43]="DMIN",i[i.DMAX=44]="DMAX",i[i.DSTDEV=45]="DSTDEV",i[i.VAR=46]="VAR",i[i.DVAR=47]="DVAR",i[i.TEXT=48]="TEXT",i[i.LINEST=49]="LINEST",i[i.TREND=50]="TREND",i[i.LOGEST=51]="LOGEST",i[i.GROWTH=52]="GROWTH",i[i.GOTO=53]="GOTO",i[i.HALT=54]="HALT",i[i.RETURN=55]="RETURN",i[i.PV=56]="PV",i[i.FV=57]="FV",i[i.NPER=58]="NPER",i[i.PMT=59]="PMT",i[i.RATE=60]="RATE",i[i.MIRR=61]="MIRR",i[i.IRR=62]="IRR",i[i.RAND=63]="RAND",i[i.MATCH=64]="MATCH",i[i.DATE=65]="DATE",i[i.TIME=66]="TIME",i[i.DAY=67]="DAY",i[i.MONTH=68]="MONTH",i[i.YEAR=69]="YEAR",i[i.WEEKDAY=70]="WEEKDAY",i[i.HOUR=71]="HOUR",i[i.MINUTE=72]="MINUTE",i[i.SECOND=73]="SECOND",i[i.NOW=74]="NOW",i[i.AREAS=75]="AREAS",i[i.ROWS=76]="ROWS",i[i.COLUMNS=77]="COLUMNS",i[i.OFFSET=78]="OFFSET",i[i.ABSREF=79]="ABSREF",i[i.RELREF=80]="RELREF",i[i.ARGUMENT=81]="ARGUMENT",i[i.SEARCH=82]="SEARCH",i[i.TRANSPOSE=83]="TRANSPOSE",i[i.ERROR=84]="ERROR",i[i.STEP=85]="STEP",i[i.TYPE=86]="TYPE",i[i.ECHO=87]="ECHO",i[i.SET_NAME=88]="SET_NAME",i[i.CALLER=89]="CALLER",i[i.DEREF=90]="DEREF",i[i.WINDOWS=91]="WINDOWS",i[i.SERIES=92]="SERIES",i[i.DOCUMENTS=93]="DOCUMENTS",i[i.ACTIVE_CELL=94]="ACTIVE_CELL",i[i.SELECTION=95]="SELECTION",i[i.RESULT=96]="RESULT",i[i.ATAN2=97]="ATAN2",i[i.ASIN=98]="ASIN",i[i.ACOS=99]="ACOS",i[i.CHOOSE=100]="CHOOSE",i[i.HLOOKUP=101]="HLOOKUP",i[i.VLOOKUP=102]="VLOOKUP",i[i.LINKS=103]="LINKS",i[i.INPUT=104]="INPUT",i[i.ISREF=105]="ISREF",i[i.GET_FORMULA=106]="GET_FORMULA",i[i.GET_NAME=107]="GET_NAME",i[i.SET_VALUE=108]="SET_VALUE",i[i.LOG=109]="LOG",i[i.EXEC=110]="EXEC",i[i.CHAR=111]="CHAR",i[i.LOWER=112]="LOWER",i[i.UPPER=113]="UPPER",i[i.PROPER=114]="PROPER",i[i.LEFT=115]="LEFT",i[i.RIGHT=116]="RIGHT",i[i.EXACT=117]="EXACT",i[i.TRIM=118]="TRIM",i[i.REPLACE=119]="REPLACE",i[i.SUBSTITUTE=120]="SUBSTITUTE",i[i.CODE=121]="CODE",i[i.NAMES=122]="NAMES",i[i.DIRECTORY=123]="DIRECTORY",i[i.FIND=124]="FIND",i[i.CELL=125]="CELL",i[i.ISERR=126]="ISERR",i[i.ISTEXT=127]="ISTEXT",i[i.ISNUMBER=128]="ISNUMBER",i[i.ISBLANK=129]="ISBLANK",i[i.T=130]="T",i[i.N=131]="N",i[i.FOPEN=132]="FOPEN",i[i.FCLOSE=133]="FCLOSE",i[i.FSIZE=134]="FSIZE",i[i.FREADLN=135]="FREADLN",i[i.FREAD=136]="FREAD",i[i.FWRITELN=137]="FWRITELN",i[i.FWRITE=138]="FWRITE",i[i.FPOS=139]="FPOS",i[i.DATEVALUE=140]="DATEVALUE",i[i.TIMEVALUE=141]="TIMEVALUE",i[i.SLN=142]="SLN",i[i.SYD=143]="SYD",i[i.DDB=144]="DDB",i[i.GET_DEF=145]="GET_DEF",i[i.REFTEXT=146]="REFTEXT",i[i.TEXTREF=147]="TEXTREF",i[i.INDIRECT=148]="INDIRECT",i[i.REGISTER=149]="REGISTER",i[i.CALL=150]="CALL",i[i.ADD_BAR=151]="ADD_BAR",i[i.ADD_MENU=152]="ADD_MENU",i[i.ADD_COMMAND=153]="ADD_COMMAND",i[i.ENABLE_COMMAND=154]="ENABLE_COMMAND",i[i.CHECK_COMMAND=155]="CHECK_COMMAND",i[i.RENAME_COMMAND=156]="RENAME_COMMAND",i[i.SHOW_BAR=157]="SHOW_BAR",i[i.DELETE_MENU=158]="DELETE_MENU",i[i.DELETE_COMMAND=159]="DELETE_COMMAND",i[i.GET_CHART_ITEM=160]="GET_CHART_ITEM",i[i.DIALOG_BOX=161]="DIALOG_BOX",i[i.CLEAN=162]="CLEAN",i[i.MDETERM=163]="MDETERM",i[i.MINVERSE=164]="MINVERSE",i[i.MMULT=165]="MMULT",i[i.FILES=166]="FILES",i[i.IPMT=167]="IPMT",i[i.PPMT=168]="PPMT",i[i.COUNTA=169]="COUNTA",i[i.CANCEL_KEY=170]="CANCEL_KEY",i[i.FOR=171]="FOR",i[i.WHILE=172]="WHILE",i[i.BREAK=173]="BREAK",i[i.NEXT=174]="NEXT",i[i.INITIATE=175]="INITIATE",i[i.REQUEST=176]="REQUEST",i[i.POKE=177]="POKE",i[i.EXECUTE=178]="EXECUTE",i[i.TERMINATE=179]="TERMINATE",i[i.RESTART=180]="RESTART",i[i.HELP=181]="HELP",i[i.GET_BAR=182]="GET_BAR",i[i.PRODUCT=183]="PRODUCT",i[i.FACT=184]="FACT",i[i.GET_CELL=185]="GET_CELL",i[i.GET_WORKSPACE=186]="GET_WORKSPACE",i[i.GET_WINDOW=187]="GET_WINDOW",i[i.GET_DOCUMENT=188]="GET_DOCUMENT",i[i.DPRODUCT=189]="DPRODUCT",i[i.ISNONTEXT=190]="ISNONTEXT",i[i.GET_NOTE=191]="GET_NOTE",i[i.NOTE=192]="NOTE",i[i.STDEVP=193]="STDEVP",i[i.VARP=194]="VARP",i[i.DSTDEVP=195]="DSTDEVP",i[i.DVARP=196]="DVARP",i[i.TRUNC=197]="TRUNC",i[i.ISLOGICAL=198]="ISLOGICAL",i[i.DCOUNTA=199]="DCOUNTA",i[i.DELETE_BAR=200]="DELETE_BAR",i[i.UNREGISTER=201]="UNREGISTER",i[i.USDOLLAR=204]="USDOLLAR",i[i.FINDB=205]="FINDB",i[i.SEARCHB=206]="SEARCHB",i[i.REPLACEB=207]="REPLACEB",i[i.LEFTB=208]="LEFTB",i[i.RIGHTB=209]="RIGHTB",i[i.MIDB=210]="MIDB",i[i.LENB=211]="LENB",i[i.ROUNDUP=212]="ROUNDUP",i[i.ROUNDDOWN=213]="ROUNDDOWN",i[i.ASC=214]="ASC",i[i.DBCS=215]="DBCS",i[i.RANK=216]="RANK",i[i.ADDRESS=219]="ADDRESS",i[i.DAYS360=220]="DAYS360",i[i.TODAY=221]="TODAY",i[i.VDB=222]="VDB",i[i.ELSE=223]="ELSE",i[i.ELSE_IF=224]="ELSE_IF",i[i.END_IF=225]="END_IF",i[i.FOR_CELL=226]="FOR_CELL",i[i.MEDIAN=227]="MEDIAN",i[i.SUMPRODUCT=228]="SUMPRODUCT",i[i.SINH=229]="SINH",i[i.COSH=230]="COSH",i[i.TANH=231]="TANH",i[i.ASINH=232]="ASINH",i[i.ACOSH=233]="ACOSH",i[i.ATANH=234]="ATANH",i[i.DGET=235]="DGET",i[i.CREATE_OBJECT=236]="CREATE_OBJECT",i[i.VOLATILE=237]="VOLATILE",i[i.LAST_ERROR=238]="LAST_ERROR",i[i.CUSTOM_UNDO=239]="CUSTOM_UNDO",i[i.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",i[i.FORMULA_CONVERT=241]="FORMULA_CONVERT",i[i.GET_LINK_INFO=242]="GET_LINK_INFO",i[i.TEXT_BOX=243]="TEXT_BOX",i[i.INFO=244]="INFO",i[i.GROUP=245]="GROUP",i[i.GET_OBJECT=246]="GET_OBJECT",i[i.DB=247]="DB",i[i.PAUSE=248]="PAUSE",i[i.RESUME=251]="RESUME",i[i.FREQUENCY=252]="FREQUENCY",i[i.ADD_TOOLBAR=253]="ADD_TOOLBAR",i[i.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",i[i._UDF=255]="_UDF",i[i.RESET_TOOLBAR=256]="RESET_TOOLBAR",i[i.EVALUATE=257]="EVALUATE",i[i.GET_TOOLBAR=258]="GET_TOOLBAR",i[i.GET_TOOL=259]="GET_TOOL",i[i.SPELLING_CHECK=260]="SPELLING_CHECK",i[i.ERROR_TYPE=261]="ERROR_TYPE",i[i.APP_TITLE=262]="APP_TITLE",i[i.WINDOW_TITLE=263]="WINDOW_TITLE",i[i.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",i[i.ENABLE_TOOL=265]="ENABLE_TOOL",i[i.PRESS_TOOL=266]="PRESS_TOOL",i[i.REGISTER_ID=267]="REGISTER_ID",i[i.GET_PROJECT=268]="GET_PROJECT",i[i.AVEDEV=269]="AVEDEV",i[i.BETADIST=270]="BETADIST",i[i.GAMMALN=271]="GAMMALN",i[i.BETAINV=272]="BETAINV",i[i.BINOMDIST=273]="BINOMDIST",i[i.CHIDIST=274]="CHIDIST",i[i.CHIINV=275]="CHIINV",i[i.COMBIN=276]="COMBIN",i[i.CONFIDENCE=277]="CONFIDENCE",i[i.CRITBINOM=278]="CRITBINOM",i[i.EVEN=279]="EVEN",i[i.EXPONDIST=280]="EXPONDIST",i[i.FDIST=281]="FDIST",i[i.FINV=282]="FINV",i[i.FISHER=283]="FISHER",i[i.FISHERINV=284]="FISHERINV",i[i.FLOOR=285]="FLOOR",i[i.GAMMADIST=286]="GAMMADIST",i[i.GAMMAINV=287]="GAMMAINV",i[i.CEILING=288]="CEILING",i[i.HYPGEOMDIST=289]="HYPGEOMDIST",i[i.LOGNORMDIST=290]="LOGNORMDIST",i[i.LOGINV=291]="LOGINV",i[i.NEGBINOMDIST=292]="NEGBINOMDIST",i[i.NORMDIST=293]="NORMDIST",i[i.NORMSDIST=294]="NORMSDIST",i[i.NORMINV=295]="NORMINV",i[i.NORMSINV=296]="NORMSINV",i[i.STANDARDIZE=297]="STANDARDIZE",i[i.ODD=298]="ODD",i[i.PERMUT=299]="PERMUT",i[i.POISSON=300]="POISSON",i[i.TDIST=301]="TDIST",i[i.WEIBULL=302]="WEIBULL",i[i.SUMXMY2=303]="SUMXMY2",i[i.SUMX2MY2=304]="SUMX2MY2",i[i.SUMX2PY2=305]="SUMX2PY2",i[i.CHITEST=306]="CHITEST",i[i.CORREL=307]="CORREL",i[i.COVAR=308]="COVAR",i[i.FORECAST=309]="FORECAST",i[i.FTEST=310]="FTEST",i[i.INTERCEPT=311]="INTERCEPT",i[i.PEARSON=312]="PEARSON",i[i.RSQ=313]="RSQ",i[i.STEYX=314]="STEYX",i[i.SLOPE=315]="SLOPE",i[i.TTEST=316]="TTEST",i[i.PROB=317]="PROB",i[i.DEVSQ=318]="DEVSQ",i[i.GEOMEAN=319]="GEOMEAN",i[i.HARMEAN=320]="HARMEAN",i[i.SUMSQ=321]="SUMSQ",i[i.KURT=322]="KURT",i[i.SKEW=323]="SKEW",i[i.ZTEST=324]="ZTEST",i[i.LARGE=325]="LARGE",i[i.SMALL=326]="SMALL",i[i.QUARTILE=327]="QUARTILE",i[i.PERCENTILE=328]="PERCENTILE",i[i.PERCENTRANK=329]="PERCENTRANK",i[i.MODE=330]="MODE",i[i.TRIMMEAN=331]="TRIMMEAN",i[i.TINV=332]="TINV",i[i.MOVIE_COMMAND=334]="MOVIE_COMMAND",i[i.GET_MOVIE=335]="GET_MOVIE",i[i.CONCATENATE=336]="CONCATENATE",i[i.POWER=337]="POWER",i[i.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",i[i.GET_VIEW=339]="GET_VIEW",i[i.GET_FIELD=340]="GET_FIELD",i[i.GET_ITEM=341]="GET_ITEM",i[i.RADIANS=342]="RADIANS",i[i.DEGREES=343]="DEGREES",i[i.SUBTOTAL=344]="SUBTOTAL",i[i.SUMIF=345]="SUMIF",i[i.COUNTIF=346]="COUNTIF",i[i.COUNTBLANK=347]="COUNTBLANK",i[i.SCENARIO_GET=348]="SCENARIO_GET",i[i.OPTIONS_LISTS=349]="OPTIONS_LISTS",i[i.ISPMT=350]="ISPMT",i[i.DATEDIF=351]="DATEDIF",i[i.DATESTRING=352]="DATESTRING",i[i.NUMBERSTRING=353]="NUMBERSTRING",i[i.ROMAN=354]="ROMAN",i[i.OPENDIALOG=355]="OPENDIALOG",i[i.SAVEDIALOG=356]="SAVEDIALOG",i[i.VIEW_GET=357]="VIEW_GET",i[i.GETPIVOTDATA=358]="GETPIVOTDATA",i[i.HYPERLINK=359]="HYPERLINK",i[i.FURIGANA=360]="FURIGANA",i[i.AVERAGEA=361]="AVERAGEA",i[i.MAXA=362]="MAXA",i[i.MINA=363]="MINA",i[i.STDEVPA=364]="STDEVPA",i[i.VARPA=365]="VARPA",i[i.STDEVA=366]="STDEVA",i[i.VARA=367]="VARA",i[i.BAHTTEXT=368]="BAHTTEXT",i[i.THAIDOW=369]="THAIDOW",i[i.THAIDIGIT=370]="THAIDIGIT",i[i.THAIMOY=371]="THAIMOY",i[i.THAINUMSOUND=372]="THAINUMSOUND",i[i.THAINUMSTRING=373]="THAINUMSTRING",i[i.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",i[i.ISTHAIDIGIT=375]="ISTHAIDIGIT",i[i.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",i[i.ROUNDBAHTUP=377]="ROUNDBAHTUP",i[i.THAIYEAR=378]="THAIYEAR",i[i.RTD=379]="RTD",i[i.CUBEVALUE=380]="CUBEVALUE",i[i.CUBEMEMBER=381]="CUBEMEMBER",i[i.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",i[i.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",i[i.HEX2BIN=384]="HEX2BIN",i[i.HEX2DEC=385]="HEX2DEC",i[i.HEX2OCT=386]="HEX2OCT",i[i.DEC2BIN=387]="DEC2BIN",i[i.DEC2HEX=388]="DEC2HEX",i[i.DEC2OCT=389]="DEC2OCT",i[i.OCT2BIN=390]="OCT2BIN",i[i.OCT2HEX=391]="OCT2HEX",i[i.OCT2DEC=392]="OCT2DEC",i[i.BIN2DEC=393]="BIN2DEC",i[i.BIN2OCT=394]="BIN2OCT",i[i.BIN2HEX=395]="BIN2HEX",i[i.IMSUB=396]="IMSUB",i[i.IMDIV=397]="IMDIV",i[i.IMPOWER=398]="IMPOWER",i[i.IMABS=399]="IMABS",i[i.IMSQRT=400]="IMSQRT",i[i.IMLN=401]="IMLN",i[i.IMLOG2=402]="IMLOG2",i[i.IMLOG10=403]="IMLOG10",i[i.IMSIN=404]="IMSIN",i[i.IMCOS=405]="IMCOS",i[i.IMEXP=406]="IMEXP",i[i.IMARGUMENT=407]="IMARGUMENT",i[i.IMCONJUGATE=408]="IMCONJUGATE",i[i.IMAGINARY=409]="IMAGINARY",i[i.IMREAL=410]="IMREAL",i[i.COMPLEX=411]="COMPLEX",i[i.IMSUM=412]="IMSUM",i[i.IMPRODUCT=413]="IMPRODUCT",i[i.SERIESSUM=414]="SERIESSUM",i[i.FACTDOUBLE=415]="FACTDOUBLE",i[i.SQRTPI=416]="SQRTPI",i[i.QUOTIENT=417]="QUOTIENT",i[i.DELTA=418]="DELTA",i[i.GESTEP=419]="GESTEP",i[i.ISEVEN=420]="ISEVEN",i[i.ISODD=421]="ISODD",i[i.MROUND=422]="MROUND",i[i.ERF=423]="ERF",i[i.ERFC=424]="ERFC",i[i.BESSELJ=425]="BESSELJ",i[i.BESSELK=426]="BESSELK",i[i.BESSELY=427]="BESSELY",i[i.BESSELI=428]="BESSELI",i[i.XIRR=429]="XIRR",i[i.XNPV=430]="XNPV",i[i.PRICEMAT=431]="PRICEMAT",i[i.YIELDMAT=432]="YIELDMAT",i[i.INTRATE=433]="INTRATE",i[i.RECEIVED=434]="RECEIVED",i[i.DISC=435]="DISC",i[i.PRICEDISC=436]="PRICEDISC",i[i.YIELDDISC=437]="YIELDDISC",i[i.TBILLEQ=438]="TBILLEQ",i[i.TBILLPRICE=439]="TBILLPRICE",i[i.TBILLYIELD=440]="TBILLYIELD",i[i.PRICE=441]="PRICE",i[i.YIELD=442]="YIELD",i[i.DOLLARDE=443]="DOLLARDE",i[i.DOLLARFR=444]="DOLLARFR",i[i.NOMINAL=445]="NOMINAL",i[i.EFFECT=446]="EFFECT",i[i.CUMPRINC=447]="CUMPRINC",i[i.CUMIPMT=448]="CUMIPMT",i[i.EDATE=449]="EDATE",i[i.EOMONTH=450]="EOMONTH",i[i.YEARFRAC=451]="YEARFRAC",i[i.COUPDAYBS=452]="COUPDAYBS",i[i.COUPDAYS=453]="COUPDAYS",i[i.COUPDAYSNC=454]="COUPDAYSNC",i[i.COUPNCD=455]="COUPNCD",i[i.COUPNUM=456]="COUPNUM",i[i.COUPPCD=457]="COUPPCD",i[i.DURATION=458]="DURATION",i[i.MDURATION=459]="MDURATION",i[i.ODDLPRICE=460]="ODDLPRICE",i[i.ODDLYIELD=461]="ODDLYIELD",i[i.ODDFPRICE=462]="ODDFPRICE",i[i.ODDFYIELD=463]="ODDFYIELD",i[i.RANDBETWEEN=464]="RANDBETWEEN",i[i.WEEKNUM=465]="WEEKNUM",i[i.AMORDEGRC=466]="AMORDEGRC",i[i.AMORLINC=467]="AMORLINC",i[i.CONVERT=468]="CONVERT",i[i.ACCRINT=469]="ACCRINT",i[i.ACCRINTM=470]="ACCRINTM",i[i.WORKDAY=471]="WORKDAY",i[i.NETWORKDAYS=472]="NETWORKDAYS",i[i.GCD=473]="GCD",i[i.MULTINOMIAL=474]="MULTINOMIAL",i[i.LCM=475]="LCM",i[i.FVSCHEDULE=476]="FVSCHEDULE",i[i.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",i[i.CUBESET=478]="CUBESET",i[i.CUBESETCOUNT=479]="CUBESETCOUNT",i[i.IFERROR=480]="IFERROR",i[i.COUNTIFS=481]="COUNTIFS",i[i.SUMIFS=482]="SUMIFS",i[i.AVERAGEIF=483]="AVERAGEIF",i[i.AVERAGEIFS=484]="AVERAGEIFS",i[i.AGGREGATE=485]="AGGREGATE",i[i.BINOM_DIST=486]="BINOM_DIST",i[i.BINOM_INV=487]="BINOM_INV",i[i.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",i[i.CONFIDENCE_T=489]="CONFIDENCE_T",i[i.CHISQ_TEST=490]="CHISQ_TEST",i[i.F_TEST=491]="F_TEST",i[i.COVARIANCE_P=492]="COVARIANCE_P",i[i.COVARIANCE_S=493]="COVARIANCE_S",i[i.EXPON_DIST=494]="EXPON_DIST",i[i.GAMMA_DIST=495]="GAMMA_DIST",i[i.GAMMA_INV=496]="GAMMA_INV",i[i.MODE_MULT=497]="MODE_MULT",i[i.MODE_SNGL=498]="MODE_SNGL",i[i.NORM_DIST=499]="NORM_DIST",i[i.NORM_INV=500]="NORM_INV",i[i.PERCENTILE_EXC=501]="PERCENTILE_EXC",i[i.PERCENTILE_INC=502]="PERCENTILE_INC",i[i.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",i[i.PERCENTRANK_INC=504]="PERCENTRANK_INC",i[i.POISSON_DIST=505]="POISSON_DIST",i[i.QUARTILE_EXC=506]="QUARTILE_EXC",i[i.QUARTILE_INC=507]="QUARTILE_INC",i[i.RANK_AVG=508]="RANK_AVG",i[i.RANK_EQ=509]="RANK_EQ",i[i.STDEV_S=510]="STDEV_S",i[i.STDEV_P=511]="STDEV_P",i[i.T_DIST=512]="T_DIST",i[i.T_DIST_2T=513]="T_DIST_2T",i[i.T_DIST_RT=514]="T_DIST_RT",i[i.T_INV=515]="T_INV",i[i.T_INV_2T=516]="T_INV_2T",i[i.VAR_S=517]="VAR_S",i[i.VAR_P=518]="VAR_P",i[i.WEIBULL_DIST=519]="WEIBULL_DIST",i[i.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",i[i.WORKDAY_INTL=521]="WORKDAY_INTL",i[i.ECMA_CEILING=522]="ECMA_CEILING",i[i.ISO_CEILING=523]="ISO_CEILING",i[i.BETA_DIST=525]="BETA_DIST",i[i.BETA_INV=526]="BETA_INV",i[i.CHISQ_DIST=527]="CHISQ_DIST",i[i.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",i[i.CHISQ_INV=529]="CHISQ_INV",i[i.CHISQ_INV_RT=530]="CHISQ_INV_RT",i[i.F_DIST=531]="F_DIST",i[i.F_DIST_RT=532]="F_DIST_RT",i[i.F_INV=533]="F_INV",i[i.F_INV_RT=534]="F_INV_RT",i[i.HYPGEOM_DIST=535]="HYPGEOM_DIST",i[i.LOGNORM_DIST=536]="LOGNORM_DIST",i[i.LOGNORM_INV=537]="LOGNORM_INV",i[i.NEGBINOM_DIST=538]="NEGBINOM_DIST",i[i.NORM_S_DIST=539]="NORM_S_DIST",i[i.NORM_S_INV=540]="NORM_S_INV",i[i.T_TEST=541]="T_TEST",i[i.Z_TEST=542]="Z_TEST",i[i.ERF_PRECISE=543]="ERF_PRECISE",i[i.ERFC_PRECISE=544]="ERFC_PRECISE",i[i.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",i[i.CEILING_PRECISE=546]="CEILING_PRECISE",i[i.FLOOR_PRECISE=547]="FLOOR_PRECISE",i[i.ACOT=548]="ACOT",i[i.ACOTH=549]="ACOTH",i[i.COT=550]="COT",i[i.COTH=551]="COTH",i[i.CSC=552]="CSC",i[i.CSCH=553]="CSCH",i[i.SEC=554]="SEC",i[i.SECH=555]="SECH",i[i.IMTAN=556]="IMTAN",i[i.IMCOT=557]="IMCOT",i[i.IMCSC=558]="IMCSC",i[i.IMCSCH=559]="IMCSCH",i[i.IMSEC=560]="IMSEC",i[i.IMSECH=561]="IMSECH",i[i.BITAND=562]="BITAND",i[i.BITOR=563]="BITOR",i[i.BITXOR=564]="BITXOR",i[i.BITLSHIFT=565]="BITLSHIFT",i[i.BITRSHIFT=566]="BITRSHIFT",i[i.PERMUTATIONA=567]="PERMUTATIONA",i[i.COMBINA=568]="COMBINA",i[i.XOR=569]="XOR",i[i.PDURATION=570]="PDURATION",i[i.BASE=571]="BASE",i[i.DECIMAL=572]="DECIMAL",i[i.DAYS=573]="DAYS",i[i.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",i[i.GAMMA=575]="GAMMA",i[i.SKEW_P=576]="SKEW_P",i[i.GAUSS=577]="GAUSS",i[i.PHI=578]="PHI",i[i.RRI=579]="RRI",i[i.UNICHAR=580]="UNICHAR",i[i.UNICODE=581]="UNICODE",i[i.MUNIT=582]="MUNIT",i[i.ARABIC=583]="ARABIC",i[i.ISOWEEKNUM=584]="ISOWEEKNUM",i[i.NUMBERVALUE=585]="NUMBERVALUE",i[i.SHEET=586]="SHEET",i[i.SHEETS=587]="SHEETS",i[i.FORMULATEXT=588]="FORMULATEXT",i[i.ISFORMULA=589]="ISFORMULA",i[i.IFNA=590]="IFNA",i[i.CEILING_MATH=591]="CEILING_MATH",i[i.FLOOR_MATH=592]="FLOOR_MATH",i[i.IMSINH=593]="IMSINH",i[i.IMCOSH=594]="IMCOSH",i[i.FILTERXML=595]="FILTERXML",i[i.WEBSERVICE=596]="WEBSERVICE",i[i.ENCODEURL=597]="ENCODEURL",i[i.FORECAST_ETS=598]="FORECAST_ETS",i[i.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",i[i.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",i[i.FORECAST_LINEAR=601]="FORECAST_LINEAR",i[i.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",i[i.MAXIFS=603]="MAXIFS",i[i.MINIFS=604]="MINIFS",i[i.TEXTJOIN=605]="TEXTJOIN",i[i.CONCAT=606]="CONCAT",i[i.IFS=607]="IFS",i[i.SWITCH=608]="SWITCH",i[i.SINGLE=609]="SINGLE",i[i.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",i[i.ANCHORARRAY=611]="ANCHORARRAY",i[i._FV=612]="_FV",i[i.FIELDVALUE=613]="FIELDVALUE",i[i.FILTER=614]="FILTER",i[i.SORT=615]="SORT",i[i.UNIQUE=616]="UNIQUE",i[i.RICHSEARCH=617]="RICHSEARCH",i[i.LARGEPROPERTY=618]="LARGEPROPERTY",i[i.SMALLPROPERTY=619]="SMALLPROPERTY",i[i.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",i[i.FINDN=621]="FINDN",i[i.TEXTSLICE=622]="TEXTSLICE",i[i.TEXTBEFORE=623]="TEXTBEFORE",i[i.TEXTAFTER=624]="TEXTAFTER",i[i.TEXTSPLIT=625]="TEXTSPLIT",i[i._SORT=626]="_SORT",i[i._ONEDARRAY=627]="_ONEDARRAY",i[i.XMATCH=628]="XMATCH",i[i.XLOOKUP=629]="XLOOKUP",i[i.SORTBY=630]="SORTBY",i[i.RANDARRAY=631]="RANDARRAY",i[i.SEQUENCE=632]="SEQUENCE",i[i.STOCKHISTORY=633]="STOCKHISTORY",i[i.WRAPROWS=634]="WRAPROWS",i[i.VSTACK=635]="VSTACK",i[i.HSTACK=636]="HSTACK",i[i.CHOOSEROWS=637]="CHOOSEROWS",i[i.CHOOSECOLS=638]="CHOOSECOLS",i[i.LET=639]="LET",i[i.LAMBDA=640]="LAMBDA",i[i.MAKEARRAY=641]="MAKEARRAY",i[i.APPLY=642]="APPLY",i[i.ISLAMBDA=643]="ISLAMBDA",i[i.ARITY=644]="ARITY",i[i.RECURSE=645]="RECURSE",i[i.VALUETOTEXT=647]="VALUETOTEXT",i[i.ARRAYTOTEXT=648]="ARRAYTOTEXT",i[i.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",i[i.TOCOL=650]="TOCOL",i[i.TOROW=651]="TOROW",i[i.WRAPCOLS=652]="WRAPCOLS",i[i.MAP=653]="MAP",i[i.REDUCE=654]="REDUCE",i[i.SCAN=655]="SCAN",i[i.BYROW=656]="BYROW",i[i.BYCOL=657]="BYCOL",i[i.ISOMITTED=658]="ISOMITTED",i[i.EXPAND=659]="EXPAND",i[i.TAKE=660]="TAKE",i[i.DROP=661]="DROP",i[i.PY=662]="PY",i[i.IMAGE=664]="IMAGE",i[i.UNIT=665]="UNIT",i[i.GROUPBY=666]="GROUPBY",i[i.PIVOTBY=667]="PIVOTBY",i[i.PYO=668]="PYO",i[i.TESTFUNCTIONBEGIN=669]="TESTFUNCTIONBEGIN",i[i.GRF=670]="GRF",i[i.RICHERROR=671]="RICHERROR",i[i.COUNTER=672]="COUNTER",i[i.BROKENRECORD=673]="BROKENRECORD",i[i.STREAM=674]="STREAM",i[i.GETRICHERRORS=675]="GETRICHERRORS",i[i.DBGSTAT=676]="DBGSTAT",i[i.RICHNUMBER=677]="RICHNUMBER",i[i.RICHERNUMBER=678]="RICHERNUMBER",i[i.DBGWRITE=679]="DBGWRITE",i[i.TEST=680]="TEST",i[i.AAC=681]="AAC",i[i.AWC=682]="AWC",i[i.WEBADDRESS_IMAGETEST=683]="WEBADDRESS_IMAGETEST",i[i.PARSEDEXPRESSION=684]="PARSEDEXPRESSION",i[i.AGE_CONTACTTEST=685]="AGE_CONTACTTEST",i[i.FIRSTNAME_CONTACTTEST=686]="FIRSTNAME_CONTACTTEST",i[i.FULLNAME_CONTACTTEST=687]="FULLNAME_CONTACTTEST",i[i.LASTNAME_CONTACTTEST=688]="LASTNAME_CONTACTTEST",i[i.TRANSLATENAME_CONTACTTEST=689]="TRANSLATENAME_CONTACTTEST",i[i.ARRAYVALUE=690]="ARRAYVALUE",i[i.RECORD=691]="RECORD",i[i.STR_PYTHON=692]="STR_PYTHON",i[i.TYPE_PYTHON=693]="TYPE_PYTHON",i[i.LOCALIMAGE=694]="LOCALIMAGE",i[i.DISPLAYSTRING_GENERALTEST=695]="DISPLAYSTRING_GENERALTEST",i[i.LETREC=750]="LETREC",i[i.NESTEDRECORD=751]="NESTEDRECORD",t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[683,"WEBADDRESS_IMAGETEST"],[685,"AGE_CONTACTTEST"],[686,"FIRSTNAME_CONTACTTEST"],[687,"FULLNAME_CONTACTTEST"],[688,"LASTNAME_CONTACTTEST"],[689,"TRANSLATENAME_CONTACTTEST"],[692,"STR_PYTHON"],[693,"TYPE_PYTHON"],[695,"DISPLAYSTRING_GENERALTEST"]].reduce((e,t)=>(e[t[0]]=t[1],e),[]);const o=[];t.worksheetFuncTypes=[[1,255,o,[57],o,1,0,16],[1,3,[36,831,831],o,o,823,0,0],[1,1,[15],o,o,4,0,0],[1,1,[15],o,o,4,0,0],[1,255,o,[305],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[0,1,[16],o,o,33,0,0],[0,1,[16],o,o,33,0,0],[0,0,o,o,o,3,0,16],[2,255,[1],[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,2,[1,1],o,o,2,0,0],[1,3,[1,65,4],o,o,2,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,3,[263,48,48],o,o,263,0,0],[2,4,[48,1,1,1],o,o,311,0,0],[2,2,[2,1],o,o,2,0,0],[3,3,[2,1,1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[7],o,o,1,0,0],[0,0,o,o,o,4,0,16],[0,0,o,o,o,4,0,16],[1,255,o,[52],o,4,0,16],[1,255,o,[52],o,4,0,16],[1,1,[4],o,o,4,0,16],[2,2,[1,1],o,o,1,0,0],[3,3,[16,83,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,255,o,[49],o,1,0,16],[3,3,[16,19,18],o,o,1,0,0],[2,2,[263,2],o,o,2,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,1,[16],o,o,512,0,2],[0,1,[4],o,o,512,0,2],[0,1,[575],o,o,512,0,2],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,6,[1,1,1,1,1,1],o,o,1,0,0],[3,3,[48,1,1],o,o,1,0,16],[1,2,[48,1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[2,3,[263,305,17],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[1,1,[16],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[3,5,[16,65,65,65,65],o,o,16,16383,0],[2,2,[2,16],o,o,16,0,2],[2,2,[16,16],o,o,2,0,2],[0,3,[66,81,16],o,o,4,0,2],[2,3,[2,2,1],o,o,1,0,0],[1,1,[39],o,o,32,0,0],[0,2,[1,24],o,o,4,0,2],[0,0,o,o,o,4,0,2],[1,1,[303],o,o,1,0,0],[0,1,[4],o,o,4,0,2],[1,2,[2,63],o,o,4,0,2],[0,0,o,o,o,50,0,2],[1,1,[16],o,o,47,0,2],[0,2,[65,66],o,o,32,0,2],[4,5,[87,117,117,1,117],o,o,4,0,0],[0,2,[1,66],o,o,32,0,2],[0,0,o,o,o,16,0,2],[0,0,o,o,o,16,0,2],[0,1,[1],o,o,4,0,2],[2,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[33],[831],o,823,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[0,2,[66,65],o,o,32,0,2],[1,7,[2,65,66,67,65,65,2],o,o,575,0,2],[1,1,[63],o,o,4,0,0],[1,1,[18],o,o,2,0,2],[1,2,[2,4],o,o,6,0,2],[2,2,[16,47],o,o,4,0,2],[1,2,[1,1],o,o,1,0,0],[1,4,[2,1,4,4],o,o,7,0,2],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[2,2,[258,258],o,o,4,0,0],[1,1,[2],o,o,2,0,0],[4,4,[2,1,1,2],o,o,2,0,0],[3,4,[2,2,2,2],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[0,3,[66,65,66],o,o,32,0,2],[0,1,[2],o,o,2,0,2],[2,3,[2,2,1],o,o,1,0,0],[1,2,[2,16],o,o,303,16383,0],[1,1,[15],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[23],o,o,2,0,0],[1,1,[23],o,o,1,0,0],[1,2,[2,1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,2,0,2],[2,2,[1,1],o,o,2,0,2],[2,2,[1,2],o,o,1,0,2],[2,2,[1,2],o,o,1,0,2],[1,2,[1,1],o,o,1,0,2],[1,1,[3],o,o,1,0,0],[1,1,[3],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[4,5,[1,1,1,1,1],o,o,1,0,0],[1,3,[2,66,65],o,o,2,0,2],[1,2,[16,4],o,o,2,0,2],[1,2,[2,4],o,o,16,0,2],[1,2,[2,4],o,o,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],o,3,0,2],[1,255,[3],[127],o,575,0,2],[0,1,[3],o,o,1,0,2],[2,4,[3,115,83,3],o,o,1,0,2],[3,5,[3,83,115,83,3],o,o,1,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,3,3],o,o,4,0,2],[0,1,[3],o,o,4,0,2],[2,3,[3,3,3],o,o,4,0,2],[3,4,[3,3,3,3],o,o,4,0,2],[1,3,[1,67,66],o,o,1,0,2],[1,1,[52],o,o,36,0,2],[1,1,[2],o,o,2,0,0],[1,1,[32],o,o,1,0,0],[1,1,[32],o,o,32,0,0],[2,2,[32,32],o,o,32,0,0],[0,2,[2,2],o,o,32,0,2],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[1,255,o,[121],o,1,0,16],[0,2,[1,16],o,o,4,0,2],[3,4,[2,1,1,1],o,o,512,0,2],[1,1,[4],o,o,512,0,2],[0,0,o,o,o,512,0,2],[0,0,o,o,o,512,0,2],[2,2,[2,2],o,o,1,0,2],[2,2,[1,2],o,o,32,0,2],[3,3,[1,18,18],o,o,4,0,2],[2,2,[1,2],o,o,4,0,2],[1,1,[1],o,o,4,0,2],[0,1,[1],o,o,512,0,2],[0,1,[2],o,o,4,0,2],[0,4,[3,3,3,3],o,o,3,0,2],[1,255,o,[113],o,1,0,16],[1,1,[1],o,o,1,0,0],[1,2,[1,16],o,o,47,0,2],[1,1,[1],o,o,47,0,2],[1,2,[1,2],o,o,47,0,2],[1,2,[1,2],o,o,63,0,2],[3,3,[16,19,18],o,o,1,0,0],[1,1,[143],o,o,4,0,0],[0,3,[82,65,65],o,o,2,0,2],[0,4,[66,82,17,17],o,o,1,0,2],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[143],o,o,4,0,0],[3,3,[16,83,18],o,o,1,0,0],[1,1,[3],o,o,4,0,2],[1,1,[3],o,o,4,0,2],void 0,void 0,[1,2,[1,1],o,o,2,0,32],[2,3,[2,2,1],o,o,1,0,32],[2,3,[2,2,1],o,o,1,0,32],[4,4,[2,1,1,2],o,o,2,0,32],[1,2,[2,9],o,o,2,0,32],[1,2,[2,9],o,o,2,0,32],[3,3,[2,1,1],o,o,2,0,32],[1,1,[2],o,o,1,0,32],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,1,[2],o,o,2,0,32],[1,1,[2],o,o,2,0,32],[2,3,[1,16,4],o,o,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],o,o,2,0,0],[2,3,[1,1,4],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[5,7,[1,1,1,1,1,1,4],o,o,1,0,0],[0,0,o,o,o,512,0,2],[1,1,[12],o,o,512,0,2],[0,0,o,o,o,512,0,2],[1,3,[2,82,84],o,o,512,0,2],[1,255,o,[49],o,1,0,16],[1,255,o,[32],o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[16,19,18],o,o,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],o,o,2,0,2],[0,1,[4],o,o,4,0,2],[0,0,o,o,o,16,0,2],[0,2,[2,2],o,o,4,0,2],[0,3,[2,2,2],o,o,4,0,2],[2,5,[2,23,23,23,23],o,o,2,0,2],[2,4,[2,1,1,2],o,o,1,0,2],[1,4,[2,66,65,65],o,o,1,0,2],[1,1,[2],o,o,3,16383,0],[0,0,o,o,o,2,0,2],[1,5,[1,2,1,1,1],o,o,47,0,2],[4,5,[1,1,1,1,1],o,o,1,0,0],[0,1,[4],o,o,512,0,2],void 0,void 0,[0,1,[1],o,o,512,0,2],[2,2,[48,48],o,o,32,0,16],[0,2,[66,96],o,o,2,0,2],[1,1,[2],o,o,4,0,2],[1,255,[17],[127],o,575,0,32],[1,1,[3],o,o,4,0,2],[1,1,[2],o,o,63,0,2],[1,2,[1,3],o,o,47,0,2],[1,3,[1,3,1],o,o,47,0,2],[1,3,[2,66,4],o,o,4,0,2],[1,1,[15],o,o,1,0,0],[0,1,[2],o,o,4,0,2],[0,1,[2],o,o,4,0,2],[0,2,[99,66],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[2,3,[2,3,66],o,o,1,0,2],[1,2,[1,2],o,o,35,0,2],[1,255,o,[49],o,1,0,16],[3,5,[1,1,1,65,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[3,4,[32,32,1,65],o,o,1,0,0],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[2,3,[49,1,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[1,255,o,[32],o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[1,1],o,o,1,0,0],void 0,[3,4,[2,1,1,1],o,o,1,0,34],[2,3,[2,1,1],o,o,1,0,34],[1,255,o,[2],o,2,0,0],[2,2,[1,1],o,o,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],o,o,2,0,2],[1,2,[1,2],o,o,35,0,2],[1,3,[1,66,2],o,o,35,0,2],[1,4,[1,66,66,2],o,o,7,0,2],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[1],[16],o,1,0,0],[2,3,[16,15,16],o,o,1,0,0],[2,2,[16,15],o,o,1,0,0],[1,1,[16],o,o,1,0,0],[1,2,[1,2],o,o,19,0,2],[1,1,[33],o,o,33,0,2],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,2],o,o,1,0,32],[1,1,[1],o,o,2,0,32],[2,2,[1,1],o,o,2,0,32],[1,2,[1,5],o,o,2,0,0],[0,4,[66,66,66,65],o,o,6,0,2],[0,5,[66,66,66,66,65],o,o,6,0,2],[1,2,[1,2],o,o,19,0,2],[2,255,[18,18],[2,79],o,15,0,0],[1,2,[2,39],o,o,39,0,0],[1,1,[16],o,o,2,0,32],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,1,[1],o,o,2,0,0],[1,1,[1],o,o,2,0,32],[1,1,[3],o,o,2,0,32],[1,1,[1],o,o,2,0,32],[1,1,[1],o,o,2,0,32],[1,1,[1],o,o,2,0,32],[1,1,[2],o,o,1,0,32],[1,1,[2],o,o,4,0,32],[1,1,[1],o,o,1,0,32],[1,1,[1],o,o,1,0,32],[1,1,[1],o,o,1,0,32],[3,255,o,[2],o,2,0,0],[1,255,[2],[50],o,15,0,0],[2,3,[2,50,2],o,o,10,0,0],[3,3,[2,2,2],o,o,15,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[4,4,[95,95,95,127],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[127,127,95],o,o,9,0,0],[3,3,[95,127,127],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,16383,0],[1,2,[95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,32],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[2,2,[95,127],o,o,9,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[2,5,[2,50,2,1,2],o,o,10,0,0],[1,1,[2],o,o,9,0,0],[2,2,[47,575],o,o,303,0,0],[2,255,o,[16,15],o,1,0,0],[3,255,[16],[16,15],o,1,0,0],[2,3,[16,15,16],o,o,1,0,0],[3,255,[16],[16,15],o,1,0,0],[3,254,[1,1,48,17],[16],o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,254,o,[32],o,32,0,16],[1,254,o,[32],o,1,0,16],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[3,3,[1,1,4],o,o,1,0,0],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[1,16,4],o,o,1,0,16],[2,3,[1,16,4],o,o,1,0,16],[1,254,o,[49],o,1,0,16],[1,254,o,[49],o,1,0,16],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[49],o,1,0,16],[1,254,o,[49],o,1,0,16],[4,4,[1,1,1,4],o,o,1,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,2,[1,1],o,o,1,0,32],[1,2,[1,65],o,o,1,0,32],void 0,[4,6,[1,1,1,4,65,65],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[5,5,[1,1,1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[2,3,[49,1,1],o,o,1,0,16],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,65],o,o,1,0,32],[1,2,[1,65],o,o,1,0,32],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[52],o,4,0,16],[3,3,[1,1,1],o,o,1,0,0],[2,3,[1,1,65],o,o,2,0,0],[2,2,[2,1],o,o,1,0,0],[2,2,[3,3],o,o,1,0,0],[3,4,[1,1,1,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,254,o,[49],o,1,0,16],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,32,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,3,[2,66,66],o,o,1,0,0],[0,1,[50],o,o,1,16383,16],[0,1,[48],o,o,1,16383,16],[1,1,[16],o,o,2,16383,0],[1,1,[16],o,o,4,0,0],[2,2,[47,575],o,o,303,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[2,2],o,o,47,0,0],[1,1,[2],o,o,10,0,0],[1,1,[2],o,o,10,0,0],[3,6,[1,48,48,65,65,65],o,o,1,0,0],[3,7,[1,48,48,65,65,65,65],o,o,1,0,0],[2,4,[48,48,65,65],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[3,6,[48,48,1,65,65,65],o,o,1,0,0],[3,254,[16],[16,15],o,1,0,0],[3,254,[16],[16,15],o,1,0,0],[3,254,[114,68],[114],o,2,0,16],[1,254,o,[114],o,2,0,16],[2,254,o,[44,575],o,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],o,o,1503,0,53],[2,254,o,[113,113],o,1,0,17],[1,1,[16],o,o,48,0,21],[2,3,[271,2,4],o,o,303,0,21],[2,2,[271,2],o,o,303,0,17],[2,3,[48,48,111],o,o,303,0,1],[1,4,[160,96,96,4],o,o,32,0,1],[1,3,[160,4,4],o,o,32,0,1],[2,2,[2,256],o,o,1,0,8],[3,3,[2,49,1],o,o,1,0,25],[3,3,[2,49,1],o,o,1,0,25],[2,254,[2],[49],o,1,0,25],[2,7,[34,2,65,65,65,74,68],o,o,1,0,1],[1,3,[2,65,65],o,o,2,0,1],[2,6,[2,34,65,65,65,74],o,o,2,0,1],[2,6,[2,34,65,65,65,74],o,o,2,0,1],[2,6,[2,98,98,68,65,495],o,o,32,0,1],[1,4,[32,96,96,4],o,o,32,0,9],[2,2,[4,16],o,o,32,0,25],[2,4,[391,48,65,65],o,o,1,0,1],[3,6,[391,48,48,511,65,65],o,o,319,0,1],[2,254,[160],[160,65],o,32,0,1],[0,5,[65,65,65,65,68],o,o,32,16383,1],[1,4,[65,65,65,65],o,o,32,0,1],[2,254,[258,1,65,65,65],[65],o,32,0,17],[2,3,[32,1,463],o,o,32,0,1],[1,254,o,[48],o,32,0,17],[1,254,o,[48],o,32,0,17],[2,254,[48],[33],o,32,0,1],[2,254,[48],[33],o,32,0,1],[3,254,o,[319,319],[319],319,0,1],[1,254,o,[319],o,319,0,1],[3,3,[65,65,319],o,o,32,0,1],[1,254,o,[319],o,319,0,1],[1,1,[319],o,o,4,0,1],[1,1,[319],o,o,9,0,1],[0,0,o,o,o,319,0,1],void 0,[1,2,[399,1],o,o,2,0,1],[1,2,[32,1],o,o,2,0,1],[2,2,[15,2],o,o,256,0,17],[1,3,[48,65,68],o,o,32,0,17],[1,3,[48,65,68],o,o,32,0,17],[2,3,[32,1,463],o,o,32,0,1],[2,254,[48],[319],o,32,0,1],[3,3,[511,48,271],o,o,319,0,1],[3,3,[511,48,271],o,o,32,0,1],[1,2,[48,271],o,o,32,0,1],[1,2,[48,271],o,o,32,0,1],[1,1,[1535],o,o,4,0,1],[2,4,[32,65,65,495],o,o,32,0,1],[2,3,[48,65,65],o,o,48,0,1],[2,3,[48,65,65],o,o,48,0,1],[1,254,[1],[48],o,303,0,17],void 0,[1,5,[2,66,65,65,65],o,o,264,0,1],[2,2,[15,2],o,o,271,0,17],[3,6,[48,32,96,68,97,65],o,o,32,0,1],[3,9,[48,48,32,96,68,97,65,97,65],o,o,32,0,1],[1,254,[1],[48],o,1087,0,17],[0,0,o,o,o,1,0,1],[1,2,[287,2],o,o,288,0,17],[1,2,[1,1],o,o,10,0,17],[0,0,o,o,o,1,0,1],[3,254,[47],[2,47],o,47,0,17],[0,1,[1],o,o,1,0,1],[0,1,[1],o,o,32,0,1],[1,2,[2,1],o,o,47,0,1],[1,1,[1],o,o,264,0,17],[1,1,[1],o,o,264,0,17],[2,2,[2,47],o,o,47,0,1],[1,254,[2],[1151],o,1087,0,16],[1,254,[1],[1151],o,1087,0,0],[1,254,[1],[1151],o,1087,0,0],[1,1,[256],o,o,258,0,17],[1,1,[16],o,o,32,0,1],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[2,2,[256,2],o,o,2,0,17],[1,1,[32],o,o,256,0,17],[3,254,[15],[2,47],o,303,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,2,[2,66],o,o,264,0,1],[1,1,[256],o,o,2,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,o,[319,319],[319],319,0,1],[3,254,[15],[2,303],o,303,0,17]].map(e=>void 0===e?void 0:(0,n.functionType)(...e))},190:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;const n=r(5385),i=r(8660),o=r(8678),a=r(419),s=r(378),l=r(7638),u=r(8479),{codePointSpace:c,codePointLF:d,codePointMinusSign:f,codePointPlusSign:p,codePointSlash:m}=l;function h(e){return e===c||e===d}function g(e,t,r,o){(0,i.assertIndex)("calc.parse.parseUint",t,16);let s=0,l=o,u=r.length;for(;l<u;){const i=(0,a.stringCodePointAt)(r,l);if(!e.isNumeral(i))break;const o=e.getOrdinal(i);0===s&&0!==o&&(u=(0,n.fastMin)(u,l+t)),s=10*s+o,l+=(0,a.numCodeUnits)(i)}return l===u&&l<r.length&&e.isNumeral((0,a.stringCodePointAt)(r,l))?[0,o]:[s,l]}function v(e,t,r,n){let o=n;const[a,s]=g(e,5,r,o);if(s===o)return!1;if(a>32767)return!1;if(o=s,!(o<r.length&&r.charCodeAt(o)===m))return!1;o+=1;const[l,c]=g(e,5,r,o);if(c===o)return!1;if(l>32767)return!1;if(o=c,0===l)return[!1,0,o];const d=t.div(t.fromNumber(a),t.fromNumber(l));return(0,i.assertTrue)("calc.lang.tryTokenizeFrac",(0,u.isNumberOper)(d)),[d,l,o]}function S(e,t,r,l,c,d,m){let S,y,C,R=l,b=0,N="",T=!1,P=!1,E=s.NumberShape.ASCII;if(!((0,o.stringStartsWith)(r,e.decimalSeparator,l)||l<r.length&&e.isNumeral((0,a.stringCodePointAt)(r,l))))return;const k=()=>{if((d||c&&r.indexOf("%",R)>=0)&&(b-=2,void 0!==S)){const e=t.div(S,t.fromNumber(100));(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,u.isNumberOper)(e)),S=e,C=s.KnownFormat.Pct}if((0,n.fastAbs)(b)>=309)return{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C};let o=t.parse(e,!0,b,N);if(void 0!==S){const e=t.add(o,S);(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,u.isNumberOper)(e)),o=e}return{value:o,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}};for(;R<r.length;){const t=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;(y=e.getNumberShape(t))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(t)}if(m){const n=v(e,t,r,R);if(!1!==n){const[e,t,r]=n;return R=r,!1===e?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:(C=t>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,S=e,k())}}let O=R;for(;R<r.length;){const t=(0,a.stringCodePointAt)(r,R);if(e.isNumeral(t))b+=1,(y=e.getNumberShape(t))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(t);else{if(!(c&&b>0&&(0,o.stringStartsWith)(r,e.thousandsSeparator,R)))break;T=!0,R+=e.thousandsSeparator.length}}if(N+=r.substring(O,R),T){const t=function(e,t,r){let n=r,i="";for(let r=0;r<t.length;){const o=(0,a.stringCodePointAt)(t,r);if(e.isNumeral(o)){const e=(0,a.numCodeUnits)(o);i+=t.substring(r,r+e),r+=e,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;r+=e.thousandsSeparator.length}}return i}(e,N,b);if(void 0===t)return;N=t}if(l<R&&R<r.length&&h(r.charCodeAt(R))){const n=v(e,t,r,R+1);if(!1!==n){const[e,t,r]=n;return R=r,!1===e?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:(C=t>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,S=e,k())}}let A=!1;if((0,o.stringStartsWith)(r,e.decimalSeparator,R)&&(A=R===l,P=!0,R+=e.decimalSeparator.length),0===b)for(;R<r.length;){const t=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;b-=1,(y=e.getNumberShape(t))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(t)}for(O=R;R<r.length;){const t=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(t))break;(y=e.getNumberShape(t))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(t)}if(N+=r.substring(O,R),A&&R<=l+e.decimalSeparator.length)return;const I=function(e,t,r){let n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,o.stringStartsWith)(t,"**",n))return[0,r];n+=2}let i=!1;if(n<t.length){const e=(0,a.stringCodePointAt)(t,n);((i=e===f)||e===p)&&(n+=(0,a.numCodeUnits)(e))}if(n>=t.length||!e.isNumeral((0,a.stringCodePointAt)(t,n)))return!1;const[s,l]=g(e,10,t,n);return l!==n&&!(s>2147483647)&&[i?-s:s,l]}(e,r,R);if(!1!==I){const[e,t]=I;b+=e,t!==R&&(C=s.KnownFormat.Exp),R=t}return!1===I?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:k()}t.isSpace=h,t.isLineBreak=function(e){return e===d},t.parseUint=g,t.parseNumberLiteral=S,t.parseSignedLiteral=function(e,t,r,n,i){let o=n,a=!1;if(o<r.length){const e=r.charCodeAt(o);if((e===p||e===f)&&(a=e===f,o+=1,i))for(;o<r.length&&h(r.charCodeAt(o));)o+=1}const s=S(e,t,r,o,!1,!1,!1);return void 0===(null==s?void 0:s.value)?[t.zero,n]:(o=s.i,[a?t.neg(s.value):s.value,o])}},342:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;const n=r(637);var i,o,a=n.assertions.assertIndex,s=n.assertions.assertPositiveLength,l=n.assertions.assertFalse;function u(e){return{kind:i.Cell,range:e}}function c(e){return{kind:i.Range,range:e}}function d(e,t,r){return{document:e,index:t,index2:r}}function f(e,t){return d(e,t,t)}function p(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function m(e,t){return{sheet:e,range:t}}function h(e){return{document:e,index:void 0}}function g(e){return e.index===e.index2}function v(e){return 1===e.rows&&1===e.cols}function S(e){return v(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(i=t.LexicalKind||(t.LexicalKind={})),(o=t.NameSource||(t.NameSource={})).AppHead="AppHead",o.Plain="Plain",o.StructRef="StructRef",o.Indirect="Indirect",t.lexicalSourceCell=u,t.lexicalSourceRange=c,t.lexicalSourceGrid=function(e,t){switch(e){case i.Cell:return S(t)?u(t):l("calc.lang.lexicalSourceGrid: expected cell");case i.Range:return c(t)}},t.lexicalSourceName=function(e){return{kind:i.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:i.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:i.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=d,t.sheetIndex=f,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=p,t.gridRange=function(e,r,n,i){return a("calc.lang.gridRange",e,t.sheetRows),a("calc.lang.gridRange",r,t.sheetCols),s("calc.lang.gridRange",n,t.sheetRows-e),s("calc.lang.gridRange",i,t.sheetCols-r),p(e,r,n,i)},t.gridCell=function(e,r){return a("calc.lang.gridCell",e,t.sheetRows),a("calc.lang.gridCell",r,t.sheetCols),p(e,r,1,1)},t.sheetGridCube=m,t.sheetGridRange=m,t.sheetGridCell=m,t.originCell=m,t.documentScope=h,t.nameScope=function(e,t){return void 0===t?h(e):f(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=g,t.isGridCell=v,t.isSheetGridRange=function(e){return g(e.sheet)},t.isSheetGridCell=S},446:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;const n=r(9799),i=r(2054),o=r(8660),a=r(7161),s=r(5385);function l(e){return{kind:a.OperKind.Number,_valueXL:e}}const u=l(n.mathpack.zero()),c=l(n.mathpack.one()),d=l(n.mathpack.pi());function f(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?i.div0ErrorOper:i.numErrorOper}function p(e){return t=>(0,o.assertFalse)(`calc.lang.${e}: error ${JSON.stringify(t)}`)}function m(e,t,r){return n=>{const i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function h(e,t,r){return(n,i)=>{const o=e(n._valueXL,i._valueXL);return"number"==typeof o?t(o):r(o)}}const g=h((e,t)=>n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t),l,f),v=m(e=>n.mathpack.div(e,100),l,p("xlPercent")),S=m(n.mathpack.ceil,l,p("xlCeil")),y=m(n.mathpack.floor,l,p("xlFloor")),C=m(n.mathpack.cond,s.identity,p("xlCond, isSupported = "+(0,n.isSupported)())),R=h(n.mathpack.cond2,s.identity,p("xlCond2")),b=m(n.mathpack.sfix,s.identity,p("xlSfix")),N=m(n.mathpack.viewRound,l,p("xlViewRound"));t.xlMathpack={zero:u,one:c,pi:d,add:h(n.mathpack.add,l,f),sub:h(n.mathpack.sub,l,f),mul:h(n.mathpack.mul,l,f),div:h(n.mathpack.div,l,f),power:g,percent:v,neg:function(e){return 0!==C(e)?l(n.mathpack.neg(e._valueXL)):e},compare:(e,t)=>n.mathpack.compare(e._valueXL,t._valueXL),formatGeneral:function(e,t,r){const{_valueXL:i}=t,a=n.mathpack.formatGeneral(e,i,r);return"string"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatGeneral: error "+JSON.stringify(a)):a},formatFixed:function(e,t,r){const{_valueXL:i}=e,a=n.mathpack.formatFixed(i,t,r);return"object"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatFixed: error "+JSON.stringify(a)):a},formatScientific:function(e,t,r){const{_valueXL:i}=e,a=n.mathpack.formatScientific(i,t,r);return"object"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatScientific: error "+JSON.stringify(a)):a},parse:function(e,t,r,i){const a=n.mathpack.pack(e,t,r,i);return"number"!=typeof a?(0,o.assertFalse)("calc.lang.xlParse: error "+JSON.stringify(a)):l(a)},trunc:e=>l(n.mathpack.trunc(e._valueXL)),ceil:S,floor:y,abs:e=>l(n.mathpack.abs(e._valueXL)),cond:C,cond2:R,fromNumber:function(e){return(0,o.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),l(e)},toNumber:function(e){const{_valueXL:t}=e;return(0,o.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:m(n.mathpack.sqrt,l,f),exp:m(n.mathpack.exp,l,f),ln:m(n.mathpack.ln,l,f),log:m(n.mathpack.log,l,f),sin:m(n.mathpack.sin,l,f),cos:m(n.mathpack.cos,l,f),tan:m(n.mathpack.tan,l,f),asin:m(n.mathpack.asin,l,f),acos:m(n.mathpack.acos,l,f),atan:m(n.mathpack.atan,l,f),atan2:h(n.mathpack.atan2,l,f),round:h(n.mathpack.round,l,f),roundUp:h(n.mathpack.roundUp,l,f),roundDown:h(n.mathpack.roundDown,l,f),tenTo:function(e){(0,o.assertInteger)("calc.lang.xlTenTo",e);const t=n.mathpack.tenTo(e);return"number"==typeof t?l(t):f(t)},checkAlmostCancellation:function(e,t){const{_valueXL:r}=e,{_valueXL:i}=t;return n.mathpack.exp32(r)-n.mathpack.exp32(i)>=52428800?u:t},fix:e=>n.mathpack.fix(e._valueXL),lfix:e=>n.mathpack.lfix(e._valueXL),sfix:b,viewRound:N}},378:(e,t)=>{"use strict";var r,n,i,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,(a=t.CurrencyFormat||(t.CurrencyFormat={})).Paren="Paren",a.Lead="Lead",a.Intern="Intern",a.Trail="Trail",(o=t.DateOrder||(t.DateOrder={})).MDY="MDY",o.DMY="DMY",o.YMD="YMD",o.MYD="MYD",o.DYM="DYM",o.YDM="YDM",(i=t.NumberShape||(t.NumberShape={})).ASCII="ASCII",i.ArabicIndic="ArabicIndic",i.ExtendedArabicIndic="ExtendedArabicIndic",i.Devanagari="Devanagari",i.Bengali="Bengali",i.Gurmukhi="Gurmukhi",i.Gujarati="Gujarati",i.Oriya="Oriya",i.Tamil="Tamil",i.Telugu="Telugu",i.Kannada="Kannada",i.Malayalam="Malayalam",i.Thai="Thai",i.Lao="Lao",i.Tibetan="Tibetan",i.Myanmar="Myanmar",i.Ethiopic="Ethiopic",i.Khmer="Khmer",i.Mongolian="Mongolian",i.ChineseTrad1="ChineseTrad1",i.ChineseTrad2="ChineseTrad2",i.ChineseTrad3="ChineseTrad3",i.ChineseSimp1="ChineseSimp1",i.ChineseSimp2="ChineseSimp2",i.ChineseSimp3="ChineseSimp3",i.Japanese1="Japanese1",i.Japanese2="Japanese2",i.Japanese3="Japanese3",i.Korean1="Korean1",i.Korean2="Korean2",i.Korean3="Korean3",i.Korean4="Korean4",(n=t.Calendar||(t.Calendar={})).Gregorian="Gregorian",n.GregorianUS="GregorianUS",n.Japan="Japan",n.Taiwan="Taiwan",n.Korea="Korea",n.Hijri="Hijri",n.Thai="Thai",n.Hebrew="Hebrew",n.GregorianMEFrench="GregorianMEFrench",n.GregorianArabic="GregorianArabic",n.GregorianXlitEnglish="GregorianXlitEnglish",n.GregorianXlitFrench="GregorianXlitFrench",n.Persian="Persian",n.UmAlQura="UmAlQura",(r=t.KnownFormat||(t.KnownFormat={}))[r.General=0]="General",r[r.NoComFixed0=-1]="NoComFixed0",r[r.NoComFixed=-2]="NoComFixed",r[r.Fixed0=-3]="Fixed0",r[r.Fixed=-4]="Fixed",r[r.Currency=-9]="Currency",r[r.CoCurrency=-10]="CoCurrency",r[r.CurrencyDec=-11]="CurrencyDec",r[r.CoCurrencyDec=-12]="CoCurrencyDec",r[r.Pct0=-13]="Pct0",r[r.Pct=-14]="Pct",r[r.Exp=-15]="Exp",r[r.Fract=-17]="Fract",r[r.FractBond=-18]="FractBond",r[r.MMDDYY=-19]="MMDDYY",r[r.DDMMMYY=-20]="DDMMMYY",r[r.DDMMM=-21]="DDMMM",r[r.MMMYY=-22]="MMMYY",r[r.HHMMAP=-23]="HHMMAP",r[r.HHMMSSAP=-24]="HHMMSSAP",r[r.HHMM=-25]="HHMM",r[r.HHMMSS=-26]="HHMMSS",r[r.MDYHMS=-27]="MDYHMS",r[r.USCoCurrency=-37]="USCoCurrency",r[r.USCoCurrencyDec=-39]="USCoCurrencyDec",r[r.Currency2=-5]="Currency2",r[r.CoCurrency2=-6]="CoCurrency2",r[r.CurrencyDec2=-7]="CurrencyDec2",r[r.CoCurrencyDec2=-8]="CoCurrencyDec2",r[r.Acct=-33]="Acct",r[r.AcctCur=-32]="AcctCur",r[r.AcctDec=-35]="AcctDec",r[r.AcctDecCur=-34]="AcctDecCur",r[r.MMSS=-28]="MMSS",r[r.AbsHMMSS=-31]="AbsHMMSS",r[r.SS0=-29]="SS0",r[r.Eng=-16]="Eng",r[r.Text=-30]="Text"},1109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;const n=r(4333),i=r(2054),o=r(9431),a=r(8660),s=r(8479),l=r(342),u=r(8556),c=r(1033),d=r(6547),f=r(8678),p=r(4388),m=r(4152),h=r(6903),g=r(158),v=r(7161),S=r(292),y=r(3935),C=r(419),R=/"/g,b=(0,l.sheetGridCell)((0,l.sheetIndex)((0,l.documentLoc)(void 0,"Book1"),0),(0,l.gridCell)(0,0));function N(e){if(!(0,h.isSuccess)(e)&&e.reason.kind!==p.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==p.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==p.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==p.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==p.ResolveReasonKind.EmptyIntersection)throw new I(e.reason)}var T;function P(e){const t=[],r=[];for(const n of e)n.length>0&&(0,C.numCodeUnits)((0,C.stringCodePointAt)(n,0))===n.length?t[(0,C.stringCodePointAt)(n,0)]=!0:r.push(n);return(e,n)=>{const i=(0,C.stringCodePointAt)(e,n);if(!0===t[i])return!0;for(const t of r)if((0,f.stringStartsWith)(e,t,n))return!0;return!1}}function E(e,t){let r="";for(let n=0;n<e.length;){t(e,n)&&(r+="'");const i=(0,C.stringCodePointAt)(e,n);r+=(0,C.stringFromCodePoint)(i),n+=(0,C.numCodeUnits)(i)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(T||(T={}));const k={literalNode:(e,t,r)=>r,arrayNode:(e,t,r)=>r,appNode:(e,t,r,n)=>n,letNode:(e,t,r,n,i,o)=>o,lambdaNode:(e,t,r,n,i,o)=>o,parenNode:(e,t,r)=>r,nameNode:(e,t,r)=>r,cellRefNode:(e,t,r)=>r,fieldRefNode:(e,t,r,n)=>n,structRefNode:(e,t,r)=>r,badSequenceNode:(e,t,r)=>r,badStringNode:(e,t,r)=>r,operatorNode:(e,t)=>t,wsfNode:(e,t,r)=>r},O=Object.assign(Object.assign({},(0,g.constVisitor)(void 0)),{operatorNode:e=>e});class A{constructor(e,t,r,n){var i,o,a,s;this.root=r,this.anonymize=n,this.anon=e=>this.anonymize?(0,c.anonymizeFormulaString)(e):e,this.locals=t,this.localeInfo=null!==(o=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(s=null===(a=t.config)||void 0===a?void 0:a.refStyle)&&void 0!==s?s:e.config.refStyle,this.resolver=(0,m.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;const l=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],u=[...l,"\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"];this.isStructRefEscapable=P(l),this.isStructRefBracketedThisRef=P(u),this.isFieldRefEscapable=P(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}print(){const e=new g.ZipVisitor({str:this,label:k,op:O});return"="+this.pre(this.root.node.label,"")+(0,g.reduceBottomUp)(e,this.root).str+this.postIfComments(this.root.node.label)}pre(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t}post(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t}preIfComments(e){if(this.anonymize)return"";const t=this.spans[e];return null!=(null==t?void 0:t.preComments)&&t.preComments.length>0?t.pre:""}postIfComments(e){if(this.anonymize)return"";const t=this.spans[e];return null!=(null==t?void 0:t.postComments)&&t.postComments.length>0?t.post:""}printRef(e,t){let r="";switch(e.kind){case n.StructRefKind.SpecialRef:{(t===T.Original&&e.isBracketed||t===T.Bracketed)&&(r+=this.localeInfo.leftBracket);const n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new I((0,s.internal)("No locale data for specialRefName"));r+=n,(t===T.Original&&e.isBracketed&&e.isClosed||t===T.Bracketed)&&(r+=this.localeInfo.rightBracket);break}case n.StructRefKind.ColumnRef:{const n=0===e.name.length||(0,f.stringStartsWith)(e.name," ")||(0,f.stringEndsWith)(e.name," ");(t===T.Original&&e.isBracketed||t===T.Bracketed||t===T.Unbracketed&&n)&&(r+=this.localeInfo.leftBracket);const i=E(e.name,this.isStructRefEscapable);r+=this.anon(i),(t===T.Original&&e.isBracketed&&e.isClosed||t===T.Bracketed||t===T.Unbracketed&&n)&&(r+=this.localeInfo.rightBracket);break}case n.StructRefKind.RangeOpRef:r+=this.printRef(e.lhs,t===T.Original?t:T.Bracketed)+":"+this.printRef(e.rhs,t===T.Original?t:T.Bracketed);break;case n.StructRefKind.MissingRef:break;case n.StructRefKind.BadRef:e.isBracketed&&(r+=this.localeInfo.leftBracket),r+=e.contents,e.isBracketed&&e.isClosed&&(r+=this.localeInfo.rightBracket)}return r}printThisRowOpRef(e){let t="@";return e&&(e.kind===n.StructRefKind.ColumnRef?t+=this.printRef(e,e.isClosed?function(e,t){for(let r=0;r<e.length;){if(t(e,r))return!0;r+=(0,C.numCodeUnits)((0,C.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?T.Bracketed:T.Unbracketed:T.Original):t+=this.printRef(e,(0,s.isRangeOpClosed)(e)&&(0,s.isRangeOpNoMissing)(e)?T.Bracketed:T.Original)),t}printApplication(e,t,r){const n=t.map((e,t,r)=>this.pre(e.label,0===t||""===e.str?"":" ")+e.str+(t===r.length-1?this.post(e.label,""):this.postIfComments(e.label)));return e.str+"("+n.join(this.localeInfo.listSeparator)+(r?")":"")}printCellRef({ref:e,qualifier:t}){return(void 0!==t?(0,g.visitQualifier)(this,t)+this.postIfComments(t.label):"")+(0,g.visitCellRef)(this,e)}printName({whole:e,qualifier:t}){return(void 0!==t?(0,g.visitQualifier)(this,t)+this.postIfComments(t.label):"")+this.anon(e)}printUnanonymisedDocQual(e){if(void 0===e)return"";const{path:t,document:r}=e;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket}printOptionalParamName(e){return e.kind===n.NodeKind.Name?this.anon((0,s.getBoundName)(this.localeInfo,e.whole)):this.pre(e.label,"")+this.anon(e.contents)+this.post(e.label,"")}literalNode(e,t,r){switch(e.kind){case v.OperKind.String:return'"'+this.anon(e.value).replace(R,'""')+'"';case v.OperKind.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case v.OperKind.Number:const t=21;return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,t));case v.OperKind.Missing:return"";case v.OperKind.Error:const r=this.localeInfo.errorNames[e.type];if(null==r)throw new I((0,s.internal)("No locale data for error type "+e.type));return r;default:return(0,a.assertNever)("calc.lang.printFormula",e)}}arrayNode(e,t,r){return this.localeInfo.leftBrace+e.map(e=>e.map(e=>this.preIfComments(e.label)+e.str+this.postIfComments(e.label)).join(this.localeInfo.columnSeparator)).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")}appNode(e,t,r,n){if(void 0!==e.op){if(1===t.length){const r=t[0];switch(e.op){case o.OperatorId.Percent:return r.str+this.pre(e.label,"")+e.str;case o.OperatorId.Pound:return r.str+this.preIfComments(e.label)+e.str;default:return e.str+this.post(e.label,"")+r.str}}if(2===t.length){const[r,n]=t;let i=" ",a=" ";switch(e.op){case o.OperatorId.Range:i=a="";break;case o.OperatorId.Isect:a="";break;case o.OperatorId.Union:i=""}return r.str+this.pre(e.label,i)+e.str+this.post(e.label,a)+n.str}return(0,a.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)}letNode(e,t,r,i,o,a){const l=t.map(({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)({str:this.anon((0,s.getBoundName)(this.localeInfo,e.arg.whole)),label:e.arg.label,op:void 0},e.index),t));return this.printApplication(e,(0,n.flattenLetArgs)(l,r,i),o)}lambdaNode(e,t,r,i,o,a){const s=t.map(({name:e})=>{let t=(e.arg.name.isBracketed?this.localeInfo.leftBracket:"")+this.printOptionalParamName(e.arg.name.name)+(e.arg.name.isBracketed&&e.arg.name.isClosed?this.localeInfo.rightBracket:"");return void 0!==e.arg.def&&(t+=this.pre(e.arg.def.label," ")+":="+this.pre(e.arg.def.rhs.label,""===e.arg.def.rhs.str?"":" ")+e.arg.def.rhs.str),(0,n.lambdaParam)((0,n.indexedArg)({str:t,label:e.arg.label,op:void 0},e.index))});return this.printApplication(e,(0,n.flattenLambdaArgs)(s,r,i),o)}parenNode(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")}nameNode(e,t,r){const{resolved:i,fields:o}=this.resolver.resolveDottedName(this.locals,(0,n.nameNode)(e,t,r),this.annotations);return N(i.resolution),i.kind===p.ResolvedKind.ResolvedCellRef?[this.printCellRef(i.node),...o.map(this.anon)].join("."):i.kind===p.ResolvedKind.ResolvedLocalName&&void 0!==i.resolution.value?[this.anon(i.resolution.value.name),...o.map(this.anon)].join("."):i.kind===p.ResolvedKind.ResolvedUserDefinedFunc?[this.anon(i.name),...o.map(this.anon)].join("."):[this.printName(i.node),...o.map(this.anon)].join(".")}cellRefNode(e,t,r){const{node:i,resolution:o}=this.resolver.resolveCellRef(this.locals,(0,n.cellRefNode)(e,t,r));return N(o),this.printCellRef(i)}fieldRefNode(e,t,r,i){let o=e.str;const a=r,s=t.isBracketed||a?this.localeInfo.leftBracket:"",l=t.isBracketed&&t.isClosed||a?this.localeInfo.rightBracket:"",u=t.field.kind===n.NodeKind.Name?E(t.field.whole,this.isFieldRefEscapable):t.field.contents;return t.field.kind!==n.NodeKind.Name?o+=this.pre(t.label,""):o+=this.preIfComments(t.label),o+="."+s+this.anon(u)+l+this.post(t.label,""),o}structRefNode(e,t,r){var i;const{node:o,table:a,resolution:l}=this.resolver.resolveStructRef(this.locals,(0,n.structRefNode)(e,t,r));N(l);const u=o.rhs.innerRef;let c=o.lhs;void 0!==c||void 0===a||!o.rhs.isClosed||(null==u?void 0:u.kind)===n.StructRefKind.ColumnRef||(null==u?void 0:u.kind)===n.StructRefKind.ThisRowOpRef&&(null===(i=u.ref)||void 0===i?void 0:i.kind)===n.StructRefKind.ColumnRef||(c=(0,n.nameNode)((0,n.identNamePart)(a.name)));let d=void 0!==c?this.printName(c):"";if(void 0===u&&o.rhs.isClosed&&void 0!==c)return d;switch(d+=this.localeInfo.leftBracket,null==u?void 0:u.kind){case n.StructRefKind.ColumnRef:case n.StructRefKind.SpecialRef:if(u.kind===n.StructRefKind.SpecialRef&&u.id===n.SpecialRefId.ThisRow&&u.isClosed){d+=this.printThisRowOpRef(void 0);break}d+=this.printRef(u,u.isClosed?T.Unbracketed:T.Original);break;case n.StructRefKind.RangeOpRef:{const e=(0,s.isRangeOpClosed)(u)&&(0,s.isRangeOpNoMissing)(u)?T.Bracketed:T.Original;d+=this.printRef(u,e);break}case n.StructRefKind.CommaOpRef:{const e=(0,s.isCommaOpRefWellFormed)(u)&&(0,s.isCommaOpClosed)(u)&&(0,s.isCommaOpNoBadOrMissing)(u);if(e&&u.specialRefs[n.SpecialRefId.ThisRow]){d+=this.printThisRowOpRef(0===u.columnRefs.length?void 0:u.columnRefs[0]);break}const t=e?(0,s.normalizeCommaOpRef)(u):u.refs,r=e?1===t.length?T.Unbracketed:T.Bracketed:T.Original;d+=t.map(e=>this.printRef(e,r)).join(this.localeInfo.listSeparator);break}case n.StructRefKind.ThisRowOpRef:d+=this.printThisRowOpRef(u.ref);break;case n.StructRefKind.BadRef:d+=this.printRef(u,T.Original)}return o.rhs.isClosed&&(d+=this.localeInfo.rightBracket),d}badSequenceNode(e,t,r){return t.map(e=>this.pre(e.label,"")+e.str+this.post(e.label,"")).join("")}badStringNode(e,t,r){return this.anon(t)}operatorNode(e,t){const r=(0,u.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new I((0,s.internal)("Invalid operator"));return r}wsfNode(e,t,r){return this.localeInfo.getWorksheetFuncName(e)}cellRefError(){const e=this.localeInfo.errorNames[i.ErrorType.REF];if(null==e)throw new I((0,s.internal)("No locale data for #REF"));return e}cellRefSingle(e,t,r){const n=(0,d.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()}cellRefRange(e,t){const r=(0,d.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()}cellRefRow(e,t,r){const n=(0,d.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()}cellRefCol(e,t,r){const n=(0,d.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()}cellRefBad(e,t){return this.anon(e)}errorQualifier(){const e=this.localeInfo.errorNames[i.ErrorType.REF];if(null==e)throw new I((0,s.internal)("No locale data for #REF"));return e}relativeQualifier(){return"!"}documentQualifier(e,t,r){return(0,d.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,n.documentQualifier)(e,t))))+"!"}sheetQualifier(e,t,r){return(0,d.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(t)+e))+"!"}identQualifier(e,t){return(0,d.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"}sheetRangeQualifier(e,t,r,n){const i=this.anon(this.printUnanonymisedDocQual(r)+e),o=this.anon(t),a=i+":"+o;return((0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,i)||(0,d.shouldQuoteQualifier)(this.localeInfo,this.refStyle,o)?(0,d.quoteQualifier)(a):a)+"!"}badQualifier(e,t){return this.anon(e)}}const I=(0,s.createFailureErrorClass)("PrintFormulaError"),_=(0,s.createFailureErrorClass)("PrintRangeError");function F(e,t,r,n=!1){try{return(0,h.success)(new A(e,t,r,n).print())}catch(e){return e instanceof I?(0,h.failure)(e.reason):(0,h.failure)((0,h.javaScriptError)(e))}}function M(e,t){return(0,n.cellRefSingle)((0,n.pos)(n.PosKind.Rel,t.row-e.row),(0,n.pos)(n.PosKind.Rel,t.col-e.col))}function D(e){return(0,h.isSuccess)(e)?((0,a.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,h.success)(e.value)):e.reason.kind===p.ResolveReasonKind.InvalidStructRef?(0,a.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,h.failure)(e.reason)}function w(e,t,r,i=(0,S.makeEmptyTable)()){var o,a;try{const u=t.originSheet.value;if(!(0,s.isDocumentLocEqual)(u.document,r.sheet.document))throw new _((0,s.notImplemented)(["printRange cross-document"]));return(0,h.success)(null!==(a=null!==(o=function(e,t,r,i){const o=t.originSheet.value,a=e.getNamedRanges(r);if(!(0,h.isSuccess)(a))throw new _(a.reason);if(0===a.value.length)return;const u=e=>void 0!==e.index&&(void 0===o.index||!(0,s.isSheetIndexEqual)(e,o)),c=a.value.filter(({scope:e})=>void 0===e.index?(0,s.isDocumentLocEqual)(e.document,r.sheet.document):(0,s.isSheetIndexEqual)(e,r.sheet)).filter(({scope:t,name:r})=>{if(void 0!==t.index||void 0===o.index)return!0;const n=o,i=e.getNameLoc(n,r,l.NameSource.Plain);if(!(0,h.isSuccess)(i))throw new _(i.reason);return null==i.value}).filter(({scope:e,name:t})=>u(e)||!i.contains(t));if(0===c.length)return;const d=1===c.length?c[0]:[...c].sort((t,r)=>e.config.localeInfo.stringCompareCI(t.name,r.name))[0];let f;if(u(d.scope)){const t=e.getSheetName(d.scope.document,d.scope.index);if(!(0,h.isSuccess)(t))throw new _(t.reason);f=(0,n.sheetQualifier)(t.value)}return(0,n.nameNode)((0,n.identNamePart)(d.name),f)}(e,t,r,i))&&void 0!==o?o:function(e,t,{sheet:r,range:i}){const o=e.getContainingTable((0,l.sheetGridCell)(r,(0,s.gridRangeAnchor)(i)));if(!(0,h.isSuccess)(o))throw new _(o.reason);if(null==o.value)return;const a=o.value,u=D(e.getStructRefSpecialRef(a,n.SpecialRefId.All));if(!(0,h.isSuccess)(u))throw new _(u.reason);const c=u.value.range,d=u.value.sheet,f=(0,s.gridRangeCompare)(c,i);if(void 0===f||f<0)return;const p=D(e.getStructRefSpecialRef(a,n.SpecialRefId.Data));if(!(0,h.isSuccess)(p))throw new _(p.reason);const m=p.value.range,g=t.originGridCell.value,v=t.originSheet.value,S=void 0!==v.index&&(0,s.isSheetIndexEqual)(v,d)&&(0,s.gridRangeIsects)(c,g)?void 0:(0,n.nameNode)((0,n.identNamePart)(a.name)),y=null!=S?S:(0,n.nameNode)((0,n.identNamePart)(a.name)),C=m.cols>1&&i.col===m.col&&i.cols===m.cols,R=()=>{const t=D(e.getStructRefColumn(a,i.col));if(!(0,h.isSuccess)(t))throw new _(t.reason);if(1===i.cols)return(0,n.columnRef)(t.value.name);const r=D(e.getStructRefColumn(a,i.col+i.cols-1));if(!(0,h.isSuccess)(r))throw new _(r.reason);return(0,n.rangeOpRef)((0,n.columnRef)(t.value.name),(0,n.columnRef)(r.value.name))};if(i.row===c.row&&i.rows===c.rows)return(0,n.structRefNode)(y,(0,n.structRef)(C?(0,n.specialRef)(n.SpecialRefId.All):(0,n.commaOpRef)([(0,n.specialRef)(n.SpecialRefId.All,!0),R()])));if(1===i.rows&&i.row===g.row&&i.row>=m.row&&i.row<m.row+m.rows)return(0,n.structRefNode)(1===i.cols?S:y,(0,n.structRef)((0,n.thisRowOpRef)(C?void 0:R())));if(i.row===m.row&&i.rows===m.rows)return C?(0,n.structRefNode)(y,(0,n.structRef)(void 0)):(0,n.structRefNode)(1===i.cols?S:y,(0,n.structRef)(R()));const b=i.row===c.row&&i.row+i.rows===m.row,N=i.row===m.row+m.rows&&i.row+i.rows===c.row+c.rows;if(b||N){const e=(0,n.specialRef)(b?n.SpecialRefId.Headers:n.SpecialRefId.Totals,!C);return(0,n.structRefNode)(y,(0,n.structRef)(C?e:(0,n.commaOpRef)([e,R()])))}const T=i.row===c.row&&c.row<m.row&&i.row+i.rows===m.row+m.rows,P=i.row===m.row&&c.row+c.rows>m.row+m.rows&&i.row+i.rows===c.row+c.rows;if(T||P){const e=(0,n.specialRef)(T?n.SpecialRefId.Headers:n.SpecialRefId.Data,!0),t=(0,n.specialRef)(T?n.SpecialRefId.Data:n.SpecialRefId.Totals,!0);return(0,n.structRefNode)(y,(0,n.structRef)(C?(0,n.commaOpRef)([e,t]):(0,n.commaOpRef)([e,t,R()])))}}(e,t,r))&&void 0!==a?a:function(e,t,r){const i=t.originSheet.value,o=function(e,t){if(0===t.col&&t.cols===l.sheetCols)return function(e,t,r){return(0,n.cellRefRow)((0,n.pos)(n.PosKind.Rel,t-e.row),(0,n.pos)(n.PosKind.Rel,t+r-1-e.row))}(e,t.row,t.rows);if(0===t.row&&t.rows===l.sheetRows)return function(e,t,r){return(0,n.cellRefCol)((0,n.pos)(n.PosKind.Rel,t-e.col),(0,n.pos)(n.PosKind.Rel,t+r-1-e.col))}(e,t.col,t.cols);const r=M(e,(0,s.gridRangeAnchor)(t));if((0,s.isGridCell)(t))return r;const i=M(e,(0,l.gridCell)(t.row+t.rows-1,t.col+t.cols-1));return(0,n.cellRefRange)(r,i)}(t.originGridCell.value,r.range);let a;if(void 0===i.index||!(0,s.isSheetIndexEqual)(i,r.sheet)){const t=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,h.isSuccess)(t))throw new _(t.reason);a=(0,n.sheetQualifier)(t.value)}return(0,n.cellRefNode)(o,a)}(e,t,r))}catch(e){return e instanceof _?(0,h.failure)(e.reason):(0,h.failure)((0,h.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{const i=r.kind===l.LexicalKind.Cell||r.kind===l.LexicalKind.Range?(0,y.printLocalsGrid)(r,(0,s.sheetGridRangeAnchor)(r.range)):r.kind===l.LexicalKind.NameManager?(0,y.printLocalsName)(r,b):(0,a.assertNever)("calc.lang.anonymizeFormula",r),o=F((0,y.createSimplePrintGlobals)((0,u.calcConfig)((0,u.getEnglishLocaleInfo)(),n.RefStyle.A1,e.mathpack)),i,t,!0);if(o.kind===h.ResultKind.Success)return o.value;if(o.reason.kind===h.ReasonKind.JavaScriptError)throw o.reason.error}catch(e){const t="calc.lang.anonymizeFormula: Format failed: "+(0,f.messageFromError)(e);a.ulsLogger.ULS.traceTag(556863706,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Warning,t)}return(0,c.anonymize)(t)};const L={getNamedRanges:()=>(0,a.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")};t.createPrinter=function(e){const t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:L.getNamedRanges}}(e);return{printFormula:(t,r)=>F(e,t,r),printRange:(e,r,n)=>w(t,e,r,n)}}},3935:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;const n=r(342),i=r(6903),o=r(8479);class a{constructor(e){this.config=e}getDocumentLoc(e,t){return(0,i.success)((0,n.documentLoc)(e,t))}getSheetIndex(e,t){return(0,i.success)(t)}getSheetName(e,t){return(0,i.success)(t)}getNameLoc(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))}getUserDefinedFuncLoc(e,t){return(0,i.success)([(0,n.userDefinedFuncLoc)(e,t)])}getSheetRangeIndexes(e){if(void 0===e.index)return(0,i.failure)((0,o.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));const t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))}getContainingTable(e){return i.successUndefined}getStructRefColumn(e,t){return i.successUndefined}getStructRefSpecialRef(e,t){return i.successUndefined}getNamedRanges(e){return(0,i.success)([])}}t.createSimplePrintGlobals=function(e){return new a(e)},t.printLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.printLocalsName=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},4152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=void 0;const n=r(5385),i=r(5385),o=r(8660),a=r(6547),s=r(4333),l=r(8479),u=r(8479),c=r(342),d=r(342),f=r(6903),p=r(4388);function m(e){return(0,f.isSuccess)(e)&&(0,i.isNone)(e.value)?f.successUndefined:e}function h(e){return!(0,f.isSuccess)(e)||void 0===e.value}function g(e,t,r){const n=(0,a.resolvePosition)(e.row,t.row,d.sheetRows,r),i=(0,a.resolvePosition)(e.col,t.col,d.sheetCols,r);return void 0!==n&&void 0!==i?(0,d.gridCell)(n,i):void 0}function v(e,t){if(t.kind===s.CellRefKind.Error)return f.successUndefined;const r=e.originGridCell;if(!(0,f.isSuccess)(r))return r;const n=r.value,i=e.wrapCellReferences;switch(t.kind){case s.CellRefKind.Single:return(0,f.success)(g(n,t,i));case s.CellRefKind.Range:const e=g(n,t.ref1,i),r=g(n,t.ref2,i);return void 0!==e&&void 0!==r?(0,f.success)((0,u.gridCellRange)(e,r)):f.successUndefined;case s.CellRefKind.Row:const l=(0,a.resolvePosition)(n.row,t.row1,d.sheetRows,i),c=(0,a.resolvePosition)(n.row,t.row2,d.sheetRows,i);return void 0!==l&&void 0!==c?(0,f.success)((0,u.gridCellRange)((0,d.gridCell)(l,0),(0,d.gridCell)(c,d.sheetCols-1))):f.successUndefined;case s.CellRefKind.Col:const m=(0,a.resolvePosition)(n.col,t.col1,d.sheetCols,i),h=(0,a.resolvePosition)(n.col,t.col2,d.sheetCols,i);return void 0!==m&&void 0!==h?(0,f.success)((0,u.gridCellRange)((0,d.gridCell)(0,m),(0,d.gridCell)(d.sheetRows-1,h))):f.successUndefined;case s.CellRefKind.Bad:return(0,f.failure)((0,p.invalidCellRef)(p.InvalidCellRefReason.BadCellRef));default:return(0,o.assertNever)("calc.runtime.resolverService.resolveGridRef",t)}}t.resolveGridRef=v,t.createResolver=function(e){function t(t,r){if(void 0===r){const e=t.originSheet;return(0,f.isSuccess)(e)?[r,(0,f.success)(e.value.document)]:[r,e]}const n=e.getDocumentLoc(r.path,r.document);if(!(0,f.isSuccess)(n))return[r,n];if((0,i.isNone)(n.value))return[r,(0,f.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.UndefinedDocument))];const o=null==r.path?void 0:n.value.path,a=n.value.name;return[(0,s.documentQualifier)(a,o,r.isQuoted,r.label),(0,f.success)(n.value)]}function r(t,r){if(h(r))return[t,r];const n=m(e.getSheetIndex(r.value,t));if(!(0,f.isSuccess)(n))return[t,n];if((0,i.isNone)(n.value))return[t,(0,f.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.UndefinedSheetName))];const o=e.getSheetName(r.value,n.value);return(0,f.isSuccess)(o)?[o.value,(0,f.success)((0,d.sheetIndex)(r.value,n.value))]:[t,o]}function a(e,n){const[i,o]=t(e,n.document),[a,l]=r(n.sheet,o);return[(0,s.sheetQualifier)(a,i,n.isQuoted,n.label),l]}function g(n,i){const{qualifier:l,ref:c}=i,m=v(n,c);let g,S,y;if(void 0===l||l.kind===s.QualifierKind.Relative){g=l;const e=n.originSheet;if((0,f.isSuccess)(e)){const t=e.value;S=void 0===t.index?(0,f.failure)((0,p.noOriginSheet)(t)):(0,f.success)(t)}else S=e}else[g,S]=function(n,i){switch(i.kind){case s.QualifierKind.Error:return[i,f.successUndefined];case s.QualifierKind.Sheet:return a(n,i);case s.QualifierKind.SheetRange:return function(n,i){const[o,a]=t(n,i.document),[l,c]=r(i.sheet1,a),[p,m]=r(i.sheet2,a);let g,v=l,S=p;if(h(a))g=a;else if(h(c))g=c;else if(h(m))g=m;else{if((0,u.isSheetIndexEqual)(c.value,m.value))return[(0,s.sheetQualifier)(v,o,i.isQuoted,i.label),(0,f.success)((0,d.sheetIndex)(a.value,c.value.index))];{const t=e.getSheetRangeIndexes(c.value),r=e.getSheetRangeIndexes(m.value);(0,f.isSuccess)(t)?(0,f.isSuccess)(r)?r.value.position<t.value.position&&(v=p,S=l):g=r:g=t,g=(0,f.success)((0,d.sheetRange)(a.value,c.value.index,m.value.index))}}return[(0,s.sheetRangeQualifier)(v,S,o,i.isQuoted,i.label),g]}(n,i);case s.QualifierKind.Document:return[i,(0,f.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Bad:return[i,(0,f.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.BadQualifier))];default:return(0,o.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",i)}}(n,l);return y=h(m)?m:h(S)?S:(0,f.success)((0,d.sheetGridCube)(S.value,m.value)),(0,p.resolvedCellRef)((0,s.cellRefNode)(c,g,i.label),y)}function S(r,n,i){const{qualifier:l,parts:u}=n;let g,v;const S=[];if(void 0===l||l.kind===s.QualifierKind.Relative){const t=r.originSheet;if(!(0,f.isSuccess)(t))return(0,p.resolvedName)(n,t,S);const o=t.value;if(i!==d.NameSource.StructRef){if(void 0===o.index)return(0,p.resolvedName)(n,(0,f.failure)((0,p.noOriginSheet)(o)),S);S.push((0,c.nameLoc)(o,u.asWhole));const t=m(e.getNameLoc(o,u.asWhole,i));if(!(0,f.isSuccess)(t))return(0,p.resolvedName)(n,t,S);if(t.value)return(0,p.resolvedName)((0,s.nameNode)((0,s.identNamePart)(t.value.name,u.canDenoteNamedObject,u.label,u.qualifiedLabel),l,n.label),t,S)}g=l,v=(0,f.success)((0,d.documentScope)(o.document))}else[g,v]=function(e,r){switch(r.kind){case s.QualifierKind.Document:{const[n,i]=t(e,r);return[n,h(i)?i:(0,f.success)((0,d.documentScope)(i.value))]}case s.QualifierKind.Sheet:return a(e,r);case s.QualifierKind.SheetRange:return[r,(0,f.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Ident:{const n=(0,s.sheetQualifier)(r.name,void 0),[i,o]=a(e,n);if(!(0,f.isSuccess)(o)&&o.reason.kind!==p.ResolveReasonKind.InvalidQualifier)return[r,o];if((0,f.isSuccess)(o)&&void 0!==o.value)return[(0,s.identQualifier)(i.sheet,r.isQuoted,r.label),o];const l=(0,s.documentQualifier)(r.name),[u,c]=t(e,l);return[(0,s.identQualifier)(u.document,r.isQuoted,r.label),h(c)?c:(0,f.success)((0,d.documentScope)(c.value))]}case s.QualifierKind.Bad:return[r,(0,f.failure)((0,p.invalidQualifier)(p.InvalidQualifierReason.BadQualifier))];default:return(0,o.assertNever)("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,l);let y,C=u;return h(v)?y=v:(S.push((0,c.nameLoc)(v.value,u.asWhole)),y=m(e.getNameLoc(v.value,u.asWhole,i)),h(y)||(C=(0,s.identNamePart)(y.value.name,u.canDenoteNamedObject,u.label,u.qualifiedLabel))),(0,p.resolvedName)((0,s.nameNode)(C,g,n.label),y,S)}function y(t,r,n=!1){const o=e.getStructRefColumn(t,r.name);if(!(0,f.isSuccess)(o))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:o};const a=o.value;if((0,i.isNone)(a))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.UndefinedColumnName))};let l=a.range.range;return n&&(l=(0,d.gridRange)(l.row-(a.hasHeadersRow?1:0),l.col,l.rows+(a.hasHeadersRow?1:0)+(a.hasTotalsRow?1:0),l.cols)),{kind:s.StructRefKind.ColumnRef,innerRef:(0,s.columnRef)(a.name,r.isBracketed,r.isClosed,r.label),resolution:(0,f.success)((0,d.sheetGridRange)(a.range.sheet,l))}}function C(t,r,n){if(n===s.SpecialRefId.ThisRow){if(!(0,f.isSuccess)(t.originGridCell))return t.originGridCell;const e=C(t,r,s.SpecialRefId.Data);if(h(e))return e;const n=e.value.range,i=t.originGridCell.value.row;return i<n.row||i>=n.row+n.rows?(0,f.failure)(p.emptyIntersection):(0,f.success)((0,d.sheetGridRange)(e.value.sheet,(0,d.gridRange)(i,n.col,1,n.cols)))}return m(e.getStructRefSpecialRef(r,n))}function R(e,t,r){switch(t.kind){case s.StructRefKind.ColumnRef:return y(e,t,r);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:t,resolution:f.successUndefined}}}function b(e,t,r=!1){var n;const{innerRef:i,resolution:o}=R(e,t.lhs,r),{innerRef:a,resolution:l}=R(e,t.rhs,r),c=(0,s.rangeOpRef)(i,a,t.label);if(!(0,f.isSuccess)(o)&&o.reason.kind!==p.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:o};if(!(0,f.isSuccess)(l)&&l.reason.kind!==p.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:l};if(!(0,f.isSuccess)(o))return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:o};if(!(0,f.isSuccess)(l))return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:l};let m,h;if(void 0!==o.value)m=o.value.sheet,h=(0,u.gridRangeJoinOpt)(o.value.range,null===(n=l.value)||void 0===n?void 0:n.range);else{if(void 0===l.value)return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))};m=l.value.sheet,h=l.value.range}return{kind:s.StructRefKind.RangeOpRef,innerRef:c,resolution:(0,f.success)((0,d.sheetGridRange)(m,h))}}function N(r,n){var i,a;const{qualifier:u,parts:d}=n,m=null!==(a=null===(i=r.config)||void 0===i?void 0:i.localeInfo)&&void 0!==a?a:e.config.localeInfo;let g,v,S,y;if(void 0===u){const e=r.originSheet;if(!(0,f.isSuccess)(e))return(0,p.resolvedUserDefinedFunc)(n,e,[],d.asWhole);g=u,v=(0,f.success)(e.value.document)}else[g,v]=function(e,r){switch(r.kind){case s.QualifierKind.Document:return t(e,r);case s.QualifierKind.Ident:{const n=(0,s.documentQualifier)(r.name),[i,o]=t(e,n);return[(0,s.identQualifier)(i.document,r.isQuoted,r.label),o]}default:return(0,o.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,u);let C=d.asWhole;if(h(v))y=v,S=[];else{C=(0,l.getUserDefinedFuncName)(m,d.asWhole);const t=e.getUserDefinedFuncLoc(v.value,C);S=[(0,c.userDefinedFuncLoc)(v.value,C)],y=(0,f.isSuccess)(t)?0!==t.value.length?t:f.successUndefined:t}return(0,p.resolvedUserDefinedFunc)((0,s.nameNode)((0,s.identNamePart)(d.asWhole,d.canDenoteNamedObject,d.label,d.qualifiedLabel),g,n.label),y,S,C)}return{resolveGridRef:v,resolveCellRef:g,resolveName:S,resolveStructRef:function(t,r){const{lhs:n,rhs:o}=r;let a,l,c=n;if(void 0!==n){const{node:e,resolution:o,precedents:s}=S(t,n,d.NameSource.StructRef),u=o;if(!(0,f.isSuccess)(u))return(0,p.resolvedStructRef)(r,void 0,u,s);if((0,i.isNone)(u.value))return(0,p.resolvedStructRef)(r,void 0,(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.UndefinedTableName)),s);c=e,a=u.value,l=s}else{const{originGridCell:n,originSheet:o}=t;if(!(0,f.isSuccess)(n))return(0,p.resolvedStructRef)(r,void 0,n,[]);if(!(0,f.isSuccess)(o))return(0,p.resolvedStructRef)(r,void 0,o,[]);if(void 0===o.value.index)return(0,p.resolvedStructRef)(r,void 0,(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOriginSheet)),[]);const s=e.getContainingTable((0,d.sheetGridCell)(o.value,n.value));if(!(0,f.isSuccess)(s))return(0,p.resolvedStructRef)(r,void 0,s,[]);if((0,i.isNone)(s.value))return(0,p.resolvedStructRef)(r,void 0,(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.MissingTableName)),[]);a=s.value,l=[a]}const{structRef:m,resolution:g}=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case s.StructRefKind.ColumnRef:{const{innerRef:e,resolution:n}=y(t,r.innerRef);return{structRef:(0,s.structRef)(e,r.isClosed,r.label),resolution:n}}case s.StructRefKind.RangeOpRef:{const{innerRef:e,resolution:n}=b(t,r.innerRef);return{structRef:(0,s.structRef)(e,r.isClosed,r.label),resolution:n}}case void 0:return{structRef:r,resolution:C(e,t,s.SpecialRefId.Data)};case s.StructRefKind.SpecialRef:return{structRef:r,resolution:C(e,t,r.innerRef.id)};case s.StructRefKind.CommaOpRef:{const{commaOpRef:n,resolution:i}=function(e,t,r){var n,i;const o=r.refs.map(r=>function(e,t,r){switch(r.kind){case s.StructRefKind.ColumnRef:return y(t,r,!0);case s.StructRefKind.SpecialRef:return{kind:s.StructRefKind.SpecialRef,innerRef:r,resolution:C(e,t,r.id)};case s.StructRefKind.RangeOpRef:return b(t,r,!0);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:r,resolution:f.successUndefined};case s.StructRefKind.BadRef:return{kind:s.StructRefKind.BadRef,innerRef:r,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))}}}(e,t,r)),a=(0,s.commaOpRef)(o.map(e=>e.innerRef),r.label);for(const{resolution:e}of o)if(!(0,f.isSuccess)(e)&&e.reason.kind!==p.ResolveReasonKind.InvalidStructRef)return{commaOpRef:a,resolution:e};const l=[];for(const e of o){if(!(0,f.isSuccess)(e.resolution)||e.kind===s.StructRefKind.BadRef)return{commaOpRef:a,resolution:e.resolution};l.push((e.kind===s.StructRefKind.SpecialRef||(e.kind,s.StructRefKind.MissingRef),{kind:e.kind,resolution:e.resolution}))}if(!(0,u.isCommaOpRefWellFormed)(r))return{commaOpRef:a,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))};let c,m;for(const e of l)e.kind===s.StructRefKind.SpecialRef&&(c=(0,u.gridRangeJoinOpt)(c,null===(n=e.resolution.value)||void 0===n?void 0:n.range),void 0===m&&(m=null===(i=e.resolution.value)||void 0===i?void 0:i.sheet));if(void 0===c||void 0===m)return{commaOpRef:a,resolution:f.successUndefined};for(const e of l)if(e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.MissingRef&&(c=(0,u.gridRangeIsect)(c,e.resolution.value.range),void 0===c))return{commaOpRef:a,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))};return{commaOpRef:a,resolution:(0,f.success)((0,d.sheetGridRange)(m,c))}}(e,t,r.innerRef);return{structRef:(0,s.structRef)(n,r.isClosed,r.label),resolution:i}}case s.StructRefKind.ThisRowOpRef:{const n=C(e,t,s.SpecialRefId.ThisRow);if(h(n)||void 0===r.innerRef.ref)return{structRef:r,resolution:n};const{innerRef:i,resolution:o}=r.innerRef.ref.kind===s.StructRefKind.ColumnRef?y(t,r.innerRef.ref):b(t,r.innerRef.ref),a=(0,s.thisRowOpRef)(i,i.label);if(h(o))return{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:o};const l=(0,u.gridRangeIsect)(n.value.range,o.value.range);return l?{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:(0,f.success)((0,d.sheetGridRange)(n.value.sheet,l))}:{structRef:r,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))}}case s.StructRefKind.BadRef:return{structRef:r,resolution:(0,f.failure)((0,p.invalidStructRef)(p.InvalidStructRefReason.InvalidOp))}}}(t,a,o);return(0,p.resolvedStructRef)(g.kind===f.ResultKind.Failure&&g.reason.kind!==p.ResolveReasonKind.EmptyIntersection?r:(0,s.structRefNode)(c,m,r.label),a,g,l)},resolveUserDefinedFunc:N,resolveDottedName:function(e,t,r){var i;const o=t.qualifier;let a=t.parts;const l=[],u={names:new Array,udfs:new Array},c=r[t.label];let m,h=(null==c?void 0:c.kind)===s.AnnotationKind.AppHeadName;if(!o){const e=(0,s.headNamePart)(a);if(e.kind===s.NamePartKind.IdentNamePart){const t=function(e,t){const r=t[e.label];return(null==r?void 0:r.kind)===s.AnnotationKind.LocalNameUse?(0,p.resolvedLocalName)((0,s.nameNode)((0,s.identNamePart)(r.whole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,f.success)(r)):(0,p.resolvedLocalName)((0,s.nameNode)((0,s.identNamePart)(e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),f.successUndefined)}(e,r);if(void 0!==t.resolution.value){const[,...e]=(0,s.flattenNameParts)(a).parts,r=e.map(({rhs:e})=>(null==e?void 0:e.field.kind)===s.NodeKind.Name?e.field.whole:void 0).filter(e=>void 0!==e);if(r.length===e.length)return(0,p.resolvedDottedName)(t,r,u)}}}for(;;){if(a.canDenoteNamedObject){const t=(0,s.nameNode)((0,s.identNamePart)(a.asWhole,a.canDenoteNamedObject,a.label,a.qualifiedLabel),o,a.qualifiedLabel),r=S(e,t,h?d.NameSource.AppHead:d.NameSource.Plain);if(m=(0,p.resolvedDottedName)(r,[...l].reverse(),u),(0,n.safePush)(u.names,r.precedents),!(0,f.isSuccess)(r.resolution)&&r.resolution.reason.kind!==p.ResolveReasonKind.InvalidQualifier||(0,f.isSuccess)(r.resolution)&&void 0!==r.resolution.value)return m;if(h&&(void 0===o||o.kind===s.QualifierKind.Document||o.kind===s.QualifierKind.Ident)){const r=N(e,t);if(m=(0,p.resolvedDottedName)(r,[...l].reverse(),u),(0,n.safePush)(u.udfs,r.precedents),!(0,f.isSuccess)(r.resolution)&&r.resolution.reason.kind!==p.ResolveReasonKind.InvalidQualifier||(0,f.isSuccess)(r.resolution)&&void 0!==r.resolution.value)return m}}if(a.kind===s.NamePartKind.CellRefNamePart&&(null==o&&e.allowUnqualifiedCell||null!=o&&o.kind!==s.QualifierKind.Document)){const t=g(e,(0,s.cellRefNode)(a.ref,null!=o&&o.kind===s.QualifierKind.Ident?(0,s.sheetQualifier)(o.name):o,a.qualifiedLabel));return(0,p.resolvedDottedName)(t,[...l].reverse(),u)}if(a.kind!==s.NamePartKind.FieldRefNamePart||(null===(i=a.rhs)||void 0===i?void 0:i.field.kind)!==s.NodeKind.Name)return void 0!==m?m:(0,p.resolvedDottedName)((0,p.resolvedNever)((0,s.nameNode)((0,s.identNamePart)(a.asWhole,a.canDenoteNamedObject,a.label,a.qualifiedLabel),o,a.qualifiedLabel)),[...l].reverse(),u);l.push(a.rhs.field.whole),a=a.lhs,h=!1}}}}},4388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;const n=r(6903),i=r(5385);var o,a,s,l;t.resolveLocalsGrid=function(e){return{originGridCell:(0,n.success)(e.range),originSheet:(0,n.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(o=t.ResolveReasonKind||(t.ResolveReasonKind={})),t.noOriginSheet=function(e){return{kind:o.NoOriginSheet,origin:e}},(l=t.InvalidQualifierReason||(t.InvalidQualifierReason={})).UndefinedDocument="UndefinedDocument",l.UndefinedSheetName="UndefinedSheetName",l.SheetRangeName="SheetRangeName",l.DocumentCellRef="DocumentCellRef",l.BadQualifier="BadQualifier",t.invalidQualifier=function(e){return{kind:o.InvalidQualifier,reason:e}},(t.InvalidCellRefReason||(t.InvalidCellRefReason={})).BadCellRef="BadCellRef",t.invalidCellRef=function(e){return{kind:o.InvalidCellRef,reason:e}},(s=t.InvalidStructRefReason||(t.InvalidStructRefReason={})).UndefinedColumnName="UndefinedColumnName",s.UndefinedTableName="UndefinedTableName",s.InvalidOriginSheet="InvalidOriginSheet",s.InvalidOp="InvalidOp",s.MissingTableName="MissingTableName",s.NamedObjectNotTable="NamedObjectNotTable",t.invalidStructRef=function(e){return{kind:o.InvalidStructRef,reason:e}},t.emptyIntersection={kind:o.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(a=t.ResolvedKind||(t.ResolvedKind={})),t.resolvedName=(0,i.typedInstanceCreator)()((e,t,r)=>({kind:a.ResolvedName,node:e,resolution:t,precedents:r})),t.resolvedCellRef=(0,i.typedInstanceCreator)()((e,t)=>({kind:a.ResolvedCellRef,node:e,resolution:t})),t.resolvedUserDefinedFunc=(0,i.typedInstanceCreator)()((e,t,r,n)=>({kind:a.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n})),t.resolvedLocalName=(0,i.typedInstanceCreator)()((e,t)=>({kind:a.ResolvedLocalName,node:e,resolution:t})),t.resolvedStructRef=(0,i.typedInstanceCreator)()((e,t,r,n)=>({kind:a.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n})),t.resolvedNever=(0,i.typedInstanceCreator)()(e=>({kind:a.ResolvedNever,node:e,resolution:n.successUndefined})),t.resolvedDottedName=(0,i.typedInstanceCreator)()((e,t,r)=>({kind:a.ResolvedDottedName,resolved:e,fields:t,precedents:r}))},9431:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;const n=r(7161),i=r(5511);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});const o=r(9124);var a;t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.None),t.higherOrderFunctionType=function(){const e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(a=t.OperatorId||(t.OperatorId={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];const s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),c=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.None),p=(0,n.functionType)(2,2,[l,l],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),m=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),h=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),g=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),v=[];function S(e,t){const r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}v[a.Add]=u,v[a.Sub]=u,v[a.Mul]=u,v[a.Div]=u,v[a.Pow]=u,v[a.Percent]=c,v[a.Neg]=c,v[a.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],v[a.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],v[a.Pos]=d,v[a.Concat]=f,v[a.Eq]=p,v[a.Ne]=p,v[a.Lt]=p,v[a.Le]=p,v[a.Gt]=p,v[a.Ge]=p,v[a.Range]=m,v[a.Isect]=h,v[a.Union]=h,v[a.And]=g,v[a.Or]=g,v[a.Xor]=g,v[a.Min]=u,v[a.Max]=u,t.getOperatorType=function(e){const r=v[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=function(e){const r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},S(i.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),S(i.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),S(i.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),S(i.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),S(i.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),S(i.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),S(i.WorksheetFuncId.NOW,n.SpecialPrecs.Time),S(i.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),S(i.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),S(i.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.INFO,n.SpecialPrecs.None)},9585:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badMissingNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpNode=t.badFieldRefNode=t.badStructRefNode=t.badSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;const n=r(342),i=r(8479),o=r(4333),a=r(9431);function s(e,t=0){return(0,o.badNode)(o.BadType.Sequence,e,t)}function l(e,t=0){return(0,o.badNode)(o.BadType.Unexpected,e,t)}function u(e){return function(t=0){return(0,o.operatorNode)(e,t)}}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){const i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)},t.isNameLocEqual=function(e,t,r){return(0,i.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.expectTrue=function(e){expect(e).toBeTruthy()},t.relPos=function(e){return(0,o.pos)(o.PosKind.Rel,e)},t.absPos=function(e){return(0,o.pos)(o.PosKind.Abs,e)},t.badSeqNode=s,t.badStructRefNode=function(e,t=0){return(0,o.badNode)(o.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t=0){return(0,o.badNode)(o.BadType.FieldRef,e,t)},t.badUnexpNode=l,t.badNumberLiteralNode=function(e,t=0){return(0,o.badNode)(o.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t=0){return(0,o.badNode)(o.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t=0){return(0,o.badNode)(o.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t=0){return(0,o.badNode)(o.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t=0){return(0,o.badNode)(o.BadType.ParamName,e,t)},t.badMissingNode=function(e,t=0){return(0,o.badNode)(o.BadType.Missing,e,t)},t.badCellRefNode=function(e,t=e.indexOf("[")>=0,r=0,n=0){return(0,o.cellRefNode)((0,o.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t=0){return(0,o.badNode)(o.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t=!0){const r=[l("["),e];return t&&r.push(l("]")),s(r)},t.addNode=u(a.OperatorId.Add),t.subNode=u(a.OperatorId.Sub),t.mulNode=u(a.OperatorId.Mul),t.divNode=u(a.OperatorId.Div),t.powNode=u(a.OperatorId.Pow),t.percentNode=u(a.OperatorId.Percent),t.negNode=u(a.OperatorId.Neg),t.posNode=u(a.OperatorId.Pos),t.concatNode=u(a.OperatorId.Concat),t.eqNode=u(a.OperatorId.Eq),t.neNode=u(a.OperatorId.Ne),t.ltNode=u(a.OperatorId.Lt),t.leNode=u(a.OperatorId.Le),t.gtNode=u(a.OperatorId.Gt),t.geNode=u(a.OperatorId.Ge),t.rangeNode=u(a.OperatorId.Range),t.isectNode=u(a.OperatorId.Isect),t.unionNode=u(a.OperatorId.Union),t.andNode=u(a.OperatorId.And),t.orNode=u(a.OperatorId.Or),t.xorNode=u(a.OperatorId.Xor),t.minNode=u(a.OperatorId.Min),t.maxNode=u(a.OperatorId.Max),t.atNode=u(a.OperatorId.At),t.poundNode=u(a.OperatorId.Pound)},7161:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;const n=r(637);var i,o,a,s,l=n.assertions.assertNatural,u=n.assertions.assertFalse,c=n.assertions.assertIndex;(s=t.OperKind||(t.OperKind={}))[s.Number=1]="Number",s[s.String=2]="String",s[s.Boolean=4]="Boolean",s[s.Error=8]="Error",s[s.Range=16]="Range",s[s.Array=32]="Array",s[s.Missing=64]="Missing",s[s.Blank=128]="Blank",s[s.Rich=256]="Rich",(a=t.SignatureType||(t.SignatureType={}))[a.None=0]="None",a[a.Goto=512]="Goto",a[a.Ref3D=1024]="Ref3D",a[a.All=2047]="All",(o=t.SpecialPrecs||(t.SpecialPrecs={}))[o.None=0]="None",o[o.OwnDoc=1]="OwnDoc",o[o.OwnSheet=2]="OwnSheet",o[o.OwnRow=4]="OwnRow",o[o.OwnCol=8]="OwnCol",o[o.OwnRowCopy=16]="OwnRowCopy",o[o.OwnColCopy=32]="OwnColCopy",o[o.OwnDocSheets=64]="OwnDocSheets",o[o.CellProps=128]="CellProps",o[o.AllCells=256]="AllCells",o[o.AllNames=512]="AllNames",o[o.Time=1024]="Time",o[o.Calc=2048]="Calc",o[o.InFilterMode=4096]="InFilterMode",o[o.RefStyle=8192]="RefStyle",o[o.All=16383]="All",(i=t.FunctionFlags||(t.FunctionFlags={}))[i.None=0]="None",i[i.Dark=1]="Dark",i[i.Macro=2]="Macro",i[i.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",i[i.Internal=8]="Internal",i[i.Allow3dRef=16]="Allow3dRef",i[i.HiddenFromUI=32]="HiddenFromUI",t.functionType=function(e,t,r,n,i,o,a,s){if(l("calc.lang.functionType",t),c("calc.lang.functionType",e,t+1),0===n.length?0!==i.length:i.length>=n.length){const e=JSON.stringify(i);u("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+e)}if(0===n.length&&r.length+i.length<t){const e=JSON.stringify(r);u(`calc.lang.functionType: expected headTypes.length + tailTypes.length >= ${t}; given ${e}`)}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i,returnType:o,staticPrecs:a,flags:s}}},8479:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanNode=t.isNumberNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.getSubExpressionFromPosition=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;const n=r(8660),i=r(342);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return i.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return i.isSheetGridCell}});const o=r(4333),a=r(7161),s=r(6903),l=r(5385),u=r(6553),c=r(9431);var d=r(342);function f(e,t){const{row:r,col:n,rows:o,cols:a}=e,{row:s,col:u,rows:c,cols:d}=t,f=(0,l.fastMin)(r,s),p=(0,l.fastMin)(n,u),m=(0,l.fastMax)(r+o,s+c)-f,h=(0,l.fastMax)(n+a,u+d)-p;return(0,i.unsafeGridRange)(f,p,m,h)}function p(e,t){return e===t||e.name===t.name&&e.path===t.path}function m(e,t){return p(e.document,t.document)&&e.index===t.index}function h(e,t){return e.row===t.row&&e.col===t.col}function g(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function v(e){return(0,i.isGridCell)(e)?e:(0,i.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return d.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return d.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,i.isGridCell)(e))return t(e,0,0);const{row:r,rows:n,col:o,cols:a}=e;for(let e=0;e<n;e+=1)for(let n=0;n<a;n+=1)if(!t((0,i.gridCell)(r+e,o+n),e,n))return!1;return!0},t.forEachTileInRange=function(e,t,r){const{row:o,rows:a,col:s,cols:u}=e;(0,n.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,n.assertIndex)("calc.lang.forEachTileInRange",o,i.sheetRows),(0,n.assertIndex)("calc.lang.forEachTileInRange",s,i.sheetCols),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",a,i.sheetRows-o),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",u,i.sheetCols-s);for(let e=o;e<o+a;e+=t)for(let n=s;n<s+u;n+=t)if(!r((0,i.unsafeGridRange)(e,n,(0,l.fastMin)(t,a+o-e),(0,l.fastMin)(t,u+s-n))))return!1;return!0},t.gridRangeJoin=f,t.gridRangeJoinOpt=function(e,t){return e?t?f(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,n.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(f)},t.gridRangeIsect=function(e,t){const{row:r,col:n,rows:o,cols:a}=e,{row:s,col:u,rows:c,cols:d}=t,f=(0,l.fastMax)(r,s),p=(0,l.fastMax)(n,u),m=(0,l.fastMin)(r+o,s+c)-f,h=(0,l.fastMin)(n+a,u+d)-p;if(!(m<=0||h<=0))return(0,i.unsafeGridRange)(f,p,m,h)},t.gridRangeIsects=function(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:a,col:s,rows:u,cols:c}=t;return(0,l.fastMax)(r,a)<(0,l.fastMin)(r+i,a+u)&&(0,l.fastMax)(n,s)<(0,l.fastMin)(n+o,s+c)},t.gridCellImplicitIsect=function(e,t){const{row:r,col:n}=e,{row:o,col:a,rows:s,cols:l}=t,u=o<=r&&r<o+s,c=a<=n&&n<a+l;return u&&c?(0,i.gridCell)(r,n):u&&1===l?(0,i.gridCell)(r,a):c&&1===s?(0,i.gridCell)(o,n):1===l&&1===s?(0,i.gridCell)(o,a):void 0},t.gridRangeCompare=function(e,t){const{row:r,col:n,rows:i,cols:o}=e,{row:a,col:s,rows:l,cols:u}=t,c=r+i,d=a+l,f=n+o,p=s+u;return r===a&&c===d&&n===s&&f===p?0:r<=a&&c>=d&&n<=s&&f>=p?1:r>=a&&c<=d&&n>=s&&f<=p?-1:void 0},t.gridRangeExcept=function(e,t){const r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],o=[t.row,t.row+t.rows],a=[t.col,t.col+t.cols],s=(0,u.ivlCompare)(r,o),l=(0,u.ivlCompare)(n,a);if(void 0!==s&&s<=0){const t=(0,u.ivlExcept)(n,a);if(void 0!==t)return(0,i.gridRange)(e.row,t[0],e.rows,t[1]-t[0])}if(void 0!==l&&l<=0){const t=(0,u.ivlExcept)(r,o);if(void 0!==t)return(0,i.gridRange)(t[0],e.col,t[1]-t[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=p,t.isSheetIndexEqual=m,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return Object.assign(Object.assign({},e),{__isRange:!1})},t.isNameScopeEqual=function(e,t){return p(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=h,t.isGridRangeEqual=g,t.isSheetGridCellEqual=function(e,t){return m(e.sheet,t.sheet)&&h(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return m(e.sheet,t.sheet)&&g(e.range,t.range)},t.gridRangeAnchor=v,t.sheetGridRangeAnchor=function(e){return(0,i.isSheetGridCell)(e)?e:(0,i.sheetGridCell)(e.sheet,v(e.range))},t.gridCellRange=function(e,t){const{row:r,col:n}=e,{row:o,col:a}=t;return(0,i.unsafeGridRange)((0,l.fastMin)(r,o),(0,l.fastMin)(n,a),Math.abs(o-r)+1,Math.abs(a-n)+1)},t.getSubExpressionFromPosition=function(e,t){function r(r){const n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}let i=e.node,a=!0;for(;a;)switch(a=!1,i.kind){case o.NodeKind.Array:{const e=i.nodes;for(let t=e.length-1;!a&&t>=0;t-=1){const n=e[t];for(let e=n.length-1;!a&&e>=0;e-=1){const t=n[e];r(t)&&(i=t,a=!0)}}}break;case o.NodeKind.App:case o.NodeKind.Let:case o.NodeKind.Lambda:{const e=i.args.map(e=>e.kind===o.NodeKind.Param?e.name.name:e);for(let t=e.length-1;!a&&t>=0;t-=1){const n=e[t];r(n)&&(i=n,a=!0)}}break;case o.NodeKind.Paren:{const e=i.node;r(e)&&(i=e,a=!0)}break;case o.NodeKind.Bad:case o.NodeKind.Name:case o.NodeKind.CellRef:case o.NodeKind.StructRef:case o.NodeKind.Literal:break;case o.NodeKind.FieldRef:r(i.lhs)&&(i=i.lhs,a=!0);break;default:(0,n.assertNever)("getSubExpressionFromPosition",i)}return i};const S=[];function y(e){return e.kind===o.NodeKind.Literal&&N(e.oper)}function C(e){return e.kind===o.NodeKind.Literal&&b(e.oper)}function R(e){return e.kind===a.OperKind.Number}function b(e){return e.kind===a.OperKind.Boolean}function N(e){return e.kind===a.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.args.length&&y(e.args[0])?0:e.args.length}(e)?S:e.args},t.isOperatorNode=function(e){return e.kind===o.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===o.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===o.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=y,t.isNumberNode=function(e){return e.kind===o.NodeKind.Literal&&R(e.oper)},t.isBooleanNode=C,t.getArgType=function({maxArgs:e,headTypes:t,restTypes:r,tailTypes:i},o,s){if((0,n.assertPositiveInteger)("calc.runtime.getArgType: n",s),(0,n.assertIndex)("calc.runtime.getArgType: i",o,s),o>=e)return a.SignatureType.None;if(o<t.length)return t[o];if(0===r.length)return a.SignatureType.None;if(o<t.length+r.length)return r[o-t.length];const l=(s-t.length)%r.length;return l>i.length?a.SignatureType.None:o>=s-l?i[o-(s-l)]:r[(o-t.length)%r.length]},t.isValidArgsLength=function({minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i},o){return!(o<e||o>t)&&(o<=r.length+n.length||0!==n.length&&(o-r.length)%n.length<=i.length)},t.shouldFieldRefBeBracketed=function(e,t,r){return r.length>0&&t.field.kind===o.NodeKind.Name&&(C(e)||e.kind===o.NodeKind.Name||e.kind===o.NodeKind.CellRef)},t.isNumberOper=R,t.isStringOper=function(e){return e.kind===a.OperKind.String},t.isBooleanOper=b,t.isErrorOper=function(e){return e.kind===a.OperKind.Error},t.isRangeOper=function(e){return e.kind===a.OperKind.Range},t.isArrayOper=function(e){return e.kind===a.OperKind.Array},t.isMissingOper=N,t.isBlankOper=function(e){return e.kind===a.OperKind.Blank},t.isRichOper=function(e){return e.kind===a.OperKind.Rich};const T=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&T)};const P=T|a.OperKind.Error|a.OperKind.Array|a.OperKind.Rich;var E;t.isWriteOper=function(e){return 0!=(e.kind&P)},t.isReadOperEqual=function e(t,r,i,o){if(i.kind!==r.kind)return!1;switch(i.kind){case a.OperKind.Boolean:case a.OperKind.String:return i.value===r.value;case a.OperKind.Number:return 0===t.cond2(i,r);case a.OperKind.Error:return i.type===r.type;case a.OperKind.Rich:return o;case a.OperKind.Array:const s=r;if(i.cols!==s.cols||i.rows!==s.rows)return!1;for(let r=0;r<i.rows;r+=1){const n=i.opers[r],a=s.opers[r];for(let r=0;r<i.cols;r+=1)if(!e(t,a[r],n[r],o))return!1}return!0;case a.OperKind.Blank:return!0;default:return(0,n.assertNever)("calc.lang.readOperEq",i)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(E=t.LangReasonKind||(t.LangReasonKind={})),t.ReasonKind=Object.assign(Object.assign({},s.ReasonKind),E),t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e,...r){return 0===e.length&&(0,n.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){const t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};const k="_xlfn.",O="_xlws.";t.getWorksheetFuncId=function(e,t){let r=t;return r.length>k.length&&0===e.stringCompareCI(r.substring(0,k.length),k)&&(r=r.substring(k.length),r.length>O.length&&0===e.stringCompareCI(r.substring(0,O.length),O)&&(r=r.substring(O.length))),e.getWorksheetFuncId(r)};const A="_xludf.";t.getUserDefinedFuncName=function(e,t){let r=t;return r.length>A.length&&0===e.stringCompareCI(r.substring(0,A.length),A)&&(r=r.substring(A.length)),r};const I="_xlpm.";function _(e){return e.kind!==o.StructRefKind.SpecialRef&&e.kind!==o.StructRefKind.BadRef||e.isBracketed}function F(e){return e.kind===o.StructRefKind.MissingRef||e.kind===o.StructRefKind.BadRef}function M(e){switch(e.kind){case o.StructRefKind.SpecialRef:case o.StructRefKind.ColumnRef:return e.isClosed;case o.StructRefKind.RangeOpRef:return M(e.lhs)&&M(e.rhs);case o.StructRefKind.MissingRef:return!0;case o.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){let r=t;return r.length>I.length&&0===e.stringCompareCI(r.substring(0,I.length),I)&&(r=r.substring(I.length)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(_)&&function({specialRefs:e}){const t=Object.keys(e).reduce((t,r)=>t+(e[Number(r)]?1:0),0);return 1===t||2===t&&e[o.SpecialRefId.Data]&&(e[o.SpecialRefId.Headers]||e[o.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(M)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(F)},t.isRangeOpClosed=function(e){return M(e.lhs)&&M(e.rhs)},t.isRangeOpNoMissing=function(e){return!F(e.lhs)&&!F(e.rhs)};const D={[o.SpecialRefId.All]:1,[o.SpecialRefId.Headers]:2,[o.SpecialRefId.Data]:3,[o.SpecialRefId.Totals]:4,[o.SpecialRefId.ThisRow]:5},w=e=>e.kind===o.StructRefKind.MissingRef?7:e.kind!==o.StructRefKind.SpecialRef?6:D[e.id];function L(e,t){return w(e)-w(t)}t.normalizeCommaOpRef=function(e){const t={},r=[];for(const n of e.refs)n.kind!==o.StructRefKind.SpecialRef?r.push(n):void 0===t[n.id]&&(t[n.id]=!0,r.push(n));return r.sort(L),r},t.applyComparison=function(e,t){switch(e){case c.OperatorId.Eq:return 0===t;case c.OperatorId.Ne:return 0!==t;case c.OperatorId.Lt:return t<0;case c.OperatorId.Gt:return t>0;case c.OperatorId.Le:return t<=0;case c.OperatorId.Ge:return t>=0}}},2054:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;const n=r(637);var i=n.assertions.assertNatural,o=n.assertions.assertPositiveInteger,a=n.assertions.assertFalse,s=n.util.partialArray;const l=r(7161);var u,c;function d(e){return{kind:l.OperKind.Error,type:e}}(c=t.PrecsBound||(t.PrecsBound={}))[c.Lower=-1]="Lower",c[c.Exact=0]="Exact",c[c.Upper=1]="Upper",t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL"}(u=t.ErrorType||(t.ErrorType={})),t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:l.OperKind.String,value:e}},t.errorOper=function(e){const t=f[e];return void 0!==t?t:d(e)},t.nullErrorOper=d(u.NULL),t.div0ErrorOper=d(u.DIV0),t.valueErrorOper=d(u.VALUE),t.refErrorOper=d(u.REF),t.nameErrorOper=d(u.NAME),t.numErrorOper=d(u.NUM),t.naErrorOper=d(u.NA),t.gettingDataErrorOper=d(u.GETTING_DATA),t.spillErrorOper=d(u.SPILL),t.connectErrorOper=d(u.CONNECT),t.blockedErrorOper=d(u.BLOCKED),t.unknownErrorOper=d(u.UNKNOWN),t.fieldErrorOper=d(u.FIELD),t.calcErrorOper=d(u.CALC),t.busyErrorOper=d(u.BUSY),t.externalErrorOper=d(u.EXTERNAL);const f=s({[u.NULL]:t.nullErrorOper,[u.DIV0]:t.div0ErrorOper,[u.VALUE]:t.valueErrorOper,[u.REF]:t.refErrorOper,[u.NAME]:t.nameErrorOper,[u.NUM]:t.numErrorOper,[u.NA]:t.naErrorOper,[u.GETTING_DATA]:t.gettingDataErrorOper,[u.SPILL]:t.spillErrorOper,[u.CONNECT]:t.connectErrorOper,[u.BLOCKED]:t.blockedErrorOper,[u.UNKNOWN]:t.unknownErrorOper,[u.FIELD]:t.fieldErrorOper,[u.CALC]:t.calcErrorOper,[u.BUSY]:t.busyErrorOper,[u.EXTERNAL]:t.externalErrorOper});t.arrayOper=function(e,t,r){return i("calc.lang.arrayOper",e),i("calc.lang.arrayOper",t),r.length!==e?a("calc.lang.arrayOper: Inconsistent row number"):{kind:l.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return o("calc.lang.rangeSeqOper",t.length),{kind:l.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:l.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:l.OperKind.Missing},t.blankOper={kind:l.OperKind.Blank},t.trueOper={kind:l.OperKind.Boolean,value:!0},t.falseOper={kind:l.OperKind.Boolean,value:!1}},158:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;const n=r(8660),i=r(5385),o=r(5781),a=r(4333);function s(e,t){switch(t.kind){case a.NodeKind.Literal:{const{oper:r,isClosed:n,label:i}=t;return e.literalNode(r,n,i)}case a.NodeKind.Array:{const{nodes:r,isClosed:n,label:i}=t;return e.arrayNode(r,n,i)}case a.NodeKind.App:{const{head:r,args:n,isClosed:i,label:o}=t;return e.appNode(r,n,i,o)}case a.NodeKind.Let:{const{head:r,vars:n,body:i,badArgs:o,isClosed:a,label:s}=t;return e.letNode(r,n,i,o,a,s)}case a.NodeKind.Lambda:{const{head:r,params:n,body:i,badArgs:o,isClosed:a,label:s}=t;return e.lambdaNode(r,n,i,o,a,s)}case a.NodeKind.Paren:{const{node:r,isClosed:n,label:i}=t;return e.parenNode(r,n,i)}case a.NodeKind.Name:{const{parts:r,qualifier:n,label:i}=t;return e.nameNode(r,n,i)}case a.NodeKind.CellRef:{const{ref:r,qualifier:n,label:i}=t;return e.cellRefNode(r,n,i)}case a.NodeKind.FieldRef:{const{lhs:r,rhs:n,shouldBeBracketed:i,label:o}=t;return e.fieldRefNode(r,n,i,o)}case a.NodeKind.StructRef:{const{lhs:r,rhs:n,label:i}=t;return e.structRefNode(r,n,i)}case a.NodeKind.Bad:{const{label:r}=t;switch(t.type){case a.BadType.Sequence:case a.BadType.StructRef:case a.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents,r);default:return e.badStringNode(t.type,t.contents,r)}}default:return(0,n.assertNever)("calc.lang.visitFormulaNode",t)}}function l(e,t){const{id:r,label:n}=t;return e.operatorNode(r,n)}function u(e,t){const{id:r,whole:n,label:i}=t;return e.wsfNode(r,n,i)}function c(e,t){switch(t.kind){case a.NodeKind.Operator:return l(e,t);case a.NodeKind.WSF:return u(e,t);default:return s(e,t)}}function d(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=s,t.visitOperatorNode=l,t.visitWSFNode=u,t.visitAppHeadNode=c,t.visitQualifier=function(e,t){switch(t.kind){case a.QualifierKind.Error:{const{label:r}=t;return e.errorQualifier(r)}case a.QualifierKind.Relative:{const{label:r}=t;return e.relativeQualifier(r)}case a.QualifierKind.Document:{const{document:r,path:n,isQuoted:i,label:o}=t;return e.documentQualifier(r,n,i,o)}case a.QualifierKind.Sheet:{const{sheet:r,document:n,isQuoted:i,label:o}=t;return e.sheetQualifier(r,n,i,o)}case a.QualifierKind.Ident:{const{name:r,isQuoted:n,label:i}=t;return e.identQualifier(r,n,i)}case a.QualifierKind.SheetRange:{const{sheet1:r,sheet2:n,document:i,isQuoted:o,label:a}=t;return e.sheetRangeQualifier(r,n,i,o,a)}case a.QualifierKind.Bad:{const{chars:r,isQuoted:n,label:i}=t;return e.badQualifier(r,n,i)}default:return(0,n.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case a.CellRefKind.Error:{const{label:r}=t;return e.cellRefError(r)}case a.CellRefKind.Single:{const{row:r,col:n,isBracketed:i,label:o}=t;return e.cellRefSingle(r,n,i,o)}case a.CellRefKind.Range:{const{ref1:r,ref2:n,label:i}=t;return e.cellRefRange(r,n,i)}case a.CellRefKind.Row:{const{row1:r,row2:n,isBracketed:i,label:o}=t;return e.cellRefRow(r,n,i,o)}case a.CellRefKind.Col:{const{col1:r,col2:n,isBracketed:i,label:o}=t;return e.cellRefCol(r,n,i,o)}case a.CellRefKind.Bad:{const{chars:r,isBracketed:n,label:i}=t;return e.cellRefBad(r,n,i)}default:return(0,n.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=d;class f{literalNode(e,t,r){return(0,a.literalNode)(e,t,r)}arrayNode(e,t,r){return(0,a.arrayNode)(e,t,r)}appNode(e,t,r,n){return(0,a.appNode)(e,t,r,n)}letNode(e,t,r,n,i,o){return(0,a.letNode)(e,t,r,n,i,o)}lambdaNode(e,t,r,n,i,o){return(0,a.lambdaNode)(e,t,r,n,i,o)}parenNode(e,t,r){return(0,a.parenNode)(e,t,r)}nameNode(e,t,r){return(0,a.nameNode)(e,t,r)}cellRefNode(e,t,r){return(0,a.cellRefNode)(e,t,r)}fieldRefNode(e,t,r,n){return(0,a.fieldRefNode)(e,t,r,n)}structRefNode(e,t,r){return(0,a.structRefNode)(e,t,r)}badSequenceNode(e,t,r){return(0,a.badNode)(e,t,r)}badStringNode(e,t,r){return(0,a.badNode)(e,t,r)}operatorNode(e,t){return(0,a.operatorNode)(e,t)}wsfNode(e,t,r){return(0,a.wsfNode)(e,t,r)}}t.IdentityVisitor=f,t.identityVisitor=d(new f);class p{constructor(e){this.value=e}literalNode(e,t,r){return this.value}arrayNode(e,t,r){return this.value}appNode(e,t,r,n){return this.value}letNode(e,t,r,n,i,o){return this.value}lambdaNode(e,t,r,n,i,o){return this.value}parenNode(e,t,r){return this.value}nameNode(e,t,r){return this.value}cellRefNode(e,t,r){return this.value}fieldRefNode(e,t,r,n){return this.value}structRefNode(e,t,r){return this.value}badSequenceNode(e,t,r){return this.value}badStringNode(e,t,r){return this.value}operatorNode(e,t){return this.value}wsfNode(e,t,r){return this.value}}function m(e){return d(new p(e))}t.ConstVisitor=p,t.constVisitor=m,t.voidVisitor=m(void 0);class h{constructor(e){this.visitor=e}literalNode(e,t,r){return this.visitor.literalNode(e,t,r)}arrayNode(e,t,r){return this.visitor.arrayNode(e,t,r)}appNode(e,t,r,n){return this.visitor.appNode(e,t,r,n)}letNode(e,t,r,n,i,o){return this.visitor.letNode(e,t,r,n,i,o)}lambdaNode(e,t,r,n,i,o){return this.visitor.lambdaNode(e,t,r,n,i,o)}parenNode(e,t,r){return this.visitor.parenNode(e,t,r)}nameNode(e,t,r){return this.visitor.nameNode(e,t,r)}cellRefNode(e,t,r){return this.visitor.cellRefNode(e,t,r)}fieldRefNode(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)}structRefNode(e,t,r){return this.visitor.structRefNode(e,t,r)}badSequenceNode(e,t,r){return this.visitor.badSequenceNode(e,t,r)}badStringNode(e,t,r){return this.visitor.badStringNode(e,t,r)}operatorNode(e,t){return this.visitor.operatorNode(e,t)}wsfNode(e,t,r){return this.visitor.wsfNode(e,t,r)}}t.DelegatingVisitor=h;class g extends h{constructor(e,t){super(e),this.reducer=(e,r)=>t(e,r)}arrayNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map(e=>e.reduce(this.reducer)).reduce(this.reducer)}appNode(e,t,r,n){return t.reduce(this.reducer,e)}letNode(e,t,r,n,i,o){return[...t.map(({binder:e})=>e.arg),...void 0===r?[]:[r.arg],...n.map(e=>e.arg)].reduce(this.reducer,e)}lambdaNode(e,t,r,n,o,a){return[...t.map(({name:e})=>{var t;return null===(t=e.arg.def)||void 0===t?void 0:t.rhs}).filter(i.isDefined),...void 0===r?[]:[r.arg],...n.map(e=>e.arg)].reduce(this.reducer,e)}parenNode(e,t,r){return e}fieldRefNode(e,t,r,n){return e}badSequenceNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)}}function v(e,t){return d(new g(e,t))}t.BinaryVisitor=g,t.binaryVisitor=v;class S{constructor(e,t){this.a=e,this.b=t}literalNode(e,t,r){return this.b(this.a.literalNode(e,t,r))}arrayNode(e,t,r){return this.b(this.a.arrayNode(e,t,r))}appNode(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))}letNode(e,t,r,n,i,o){return this.b(this.a.letNode(e,t,r,n,i,o))}lambdaNode(e,t,r,n,i,o){return this.b(this.a.lambdaNode(e,t,r,n,i,o))}parenNode(e,t,r){return this.b(this.a.parenNode(e,t,r))}nameNode(e,t,r){return this.b(this.a.nameNode(e,t,r))}cellRefNode(e,t,r){return this.b(this.a.cellRefNode(e,t,r))}fieldRefNode(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))}structRefNode(e,t,r){return this.b(this.a.structRefNode(e,t,r))}badSequenceNode(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))}badStringNode(e,t,r){return this.b(this.a.badStringNode(e,t,r))}operatorNode(e,t){return this.b(this.a.operatorNode(e,t))}wsfNode(e,t,r){return this.b(this.a.wsfNode(e,t,r))}}function y(e,t){return d(new S(e,t))}t.ComposeVisitor=S,t.composeVisitor=y,t.depthVisitor=y(v(m(0),i.fastMax),e=>e+1);class C{constructor(e){this.visitors=e,this.keys=Object.keys(e)}literalNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].literalNode(e,t,r);return n}arrayNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].arrayNode(e,t,r);return n}appNode(e,t,r,n){const i={};for(const o of this.keys)i[o]=this.visitors[o].appNode(e,t,r,n);return i}letNode(e,t,r,n,i,o){const a={};for(const s of this.keys)a[s]=this.visitors[s].letNode(e,t,r,n,i,o);return a}lambdaNode(e,t,r,n,i,o){const a={};for(const s of this.keys)a[s]=this.visitors[s].lambdaNode(e,t,r,n,i,o);return a}parenNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].parenNode(e,t,r);return n}nameNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].nameNode(e,t,r);return n}cellRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].cellRefNode(e,t,r);return n}fieldRefNode(e,t,r,n){const i={};for(const o of this.keys)i[o]=this.visitors[o].fieldRefNode(e,t,r,n);return i}structRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].structRefNode(e,t,r);return n}badSequenceNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].badSequenceNode(e,t,r);return n}badStringNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].badStringNode(e,t,r);return n}operatorNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].operatorNode(e,t);return r}wsfNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].wsfNode(e,t,r);return n}}function R(e,t){const r=t=>{switch(t.kind){case a.NodeKind.Literal:{const{oper:r,isClosed:n,label:i}=t;return e.literalNode(r,n,i)}case a.NodeKind.Array:{const{nodes:n,isClosed:i,label:o}=t;return e.arrayNode(n.map(e=>e.map(r)),i,o)}case a.NodeKind.App:{const{head:n,args:i,isClosed:o,label:s}=t;return e.appNode((t=>{switch(t.kind){case a.NodeKind.Operator:return l(e,t);case a.NodeKind.WSF:return u(e,t);default:return r(t)}})(n),i.map(r),o,s)}case a.NodeKind.Let:{const{head:n,vars:i,body:o,badArgs:s,isClosed:l,label:c}=t;return e.letNode(u(e,n),i.map(({name:e,binder:t})=>(0,a.letVar)(e,(0,a.indexedArg)(r(t.arg),t.index))),void 0===o?void 0:(0,a.indexedArg)(r(o.arg),o.index),s.map(e=>(0,a.indexedArg)(r(e.arg),e.index)),l,c)}case a.NodeKind.Lambda:{const{head:n,params:i,body:o,badArgs:s,isClosed:l,label:c}=t;return e.lambdaNode(u(e,n),i.map(({name:e})=>void 0===e.arg.def?(0,a.lambdaParam)(e):(0,a.lambdaParam)((0,a.indexedArg)((0,a.paramNode)(e.arg.name,(0,a.paramDefault)(r(e.arg.def.rhs),e.arg.def.label),e.arg.label),e.index))),void 0===o?void 0:(0,a.indexedArg)(r(o.arg),o.index),s.map(e=>(0,a.indexedArg)(r(e.arg),e.index)),l,c)}case a.NodeKind.Paren:{const{node:n,isClosed:i,label:o}=t;return e.parenNode(r(n),i,o)}case a.NodeKind.Name:{const{parts:r,qualifier:n,label:i}=t;return e.nameNode(r,n,i)}case a.NodeKind.CellRef:{const{ref:r,qualifier:n,label:i}=t;return e.cellRefNode(r,n,i)}case a.NodeKind.FieldRef:{const{lhs:n,rhs:i,shouldBeBracketed:o,label:a}=t;return e.fieldRefNode(r(n),i,o,a)}case a.NodeKind.StructRef:{const{lhs:r,rhs:n,label:i}=t;return e.structRefNode(r,n,i)}case a.NodeKind.Bad:{const{label:n}=t;switch(t.type){case a.BadType.Sequence:case a.BadType.StructRef:case a.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),n);default:return e.badStringNode(t.type,t.contents,n)}}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function b(e,t,r,n){const i=[],o=e=>(i.push(e),a),a=()=>i.length<t.length?r(e,t[i.length],o):n(i);return a}function N(e,t,r){return b(e,t,A,r)}function T(e,t,r,n){return()=>void 0!==t?r(e,t,n):n(void 0)}function P(e,t,r){const{id:n,whole:i,label:o}=t;return()=>r(e.wsfNode(n,i,o))}function E(e,{name:t,binder:r},n){return A(e,r.arg,e=>n((0,a.letVar)(t,(0,a.indexedArg)(e,r.index))))}function k(e,{name:t},r){const n=t.arg;return void 0===n.def?()=>r((0,a.lambdaParam)(t)):A(e,n.def.rhs,e=>r((0,a.lambdaParam)((0,a.indexedArg)((0,a.paramNode)(n.name,(0,a.paramDefault)(e,n.def.label),n.label),t.index))))}function O(e,{arg:t,index:r},n){return A(e,t,e=>n((0,a.indexedArg)(e,r)))}function A(e,t,r){switch(t.kind){case a.NodeKind.Literal:{const{oper:n,isClosed:i,label:o}=t;return()=>r(e.literalNode(n,i,o))}case a.NodeKind.Array:{const{nodes:n,isClosed:i,label:o}=t;return b(e,n,N,t=>r(e.arrayNode(t,i,o)))}case a.NodeKind.App:{const{head:n,args:i,isClosed:o,label:s}=t;return()=>function(e,t,r){switch(t.kind){case a.NodeKind.Operator:{const{id:n,label:i}=t;return()=>r(e.operatorNode(n,i))}case a.NodeKind.WSF:return P(e,t,r);default:return A(e,t,r)}}(e,n,t=>N(e,i,n=>r(e.appNode(t,n,o,s))))}case a.NodeKind.Let:{const{head:n,vars:i,body:o,badArgs:a,isClosed:s,label:l}=t;return()=>P(e,n,t=>b(e,i,E,n=>T(e,o,O,i=>b(e,a,O,o=>r(e.letNode(t,n,i,o,s,l))))))}case a.NodeKind.Lambda:{const{head:n,params:i,body:o,badArgs:a,isClosed:s,label:l}=t;return()=>P(e,n,t=>()=>b(e,i,k,n=>T(e,o,O,i=>b(e,a,O,o=>r(e.lambdaNode(t,n,i,o,s,l))))))}case a.NodeKind.Paren:{const{node:n,isClosed:i,label:o}=t;return()=>A(e,n,t=>()=>r(e.parenNode(t,i,o)))}case a.NodeKind.Name:{const{parts:n,qualifier:i,label:o}=t;return()=>r(e.nameNode(n,i,o))}case a.NodeKind.CellRef:{const{ref:n,qualifier:i,label:o}=t;return()=>r(e.cellRefNode(n,i,o))}case a.NodeKind.FieldRef:{const{lhs:n,rhs:i,shouldBeBracketed:o,label:a}=t;return()=>A(e,n,t=>()=>r(e.fieldRefNode(t,i,o,a)))}case a.NodeKind.StructRef:{const{lhs:n,rhs:i,label:o}=t;return()=>r(e.structRefNode(n,i,o))}case a.NodeKind.Bad:{const{label:n}=t;switch(t.type){case a.BadType.Sequence:case a.BadType.StructRef:case a.BadType.FieldRef:{const{type:i,contents:o}=t;return N(e,o,t=>r(e.badSequenceNode(i,t,n)))}default:{const{type:i,contents:o}=t;return()=>r(e.badStringNode(i,o,n))}}}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function I(e,t){let r;return function(e){let t=e;for(;null!=t;)t=t()}(A(e,t,e=>{r=e})),r}t.ZipVisitor=C,t.zipVisitor=function(e){return d(new C(e))},t.reduceBottomUp_Recursive=R,t.reduceBottomUp_CPS=I;class _{constructor(e){this.visitor=e,this.visitFormulaNode=e=>s(this,e),this.lazyVisitFormulaNode=e=>o.Pledge.resolve(e).bind(this.visitFormulaNode),this.visitAppHeadNode=e=>c(this,e),this.lazyVisitAppHeadNode=e=>o.Pledge.resolve(e).bind(this.visitAppHeadNode),this.visitWSFNode=e=>u(this,e),this.lazyVisitWSFNode=e=>o.Pledge.resolve(e).bind(this.visitWSFNode),this.lazyVisitVar=({name:e,binder:t})=>this.lazyVisitFormulaNode(t.arg).bind(r=>(0,a.letVar)(e,(0,a.indexedArg)(r,t.index))),this.lazyVisitParam=({name:e})=>{const t=e.arg;return void 0===t.def?o.Pledge.resolve((0,a.lambdaParam)(e)):this.lazyVisitFormulaNode(t.def.rhs).bind(r=>(0,a.lambdaParam)((0,a.indexedArg)((0,a.paramNode)(t.name,(0,a.paramDefault)(r,t.def.label),t.label),e.index)))},this.lazyVisitIndexedArg=({arg:e,index:t})=>this.lazyVisitFormulaNode(e).bind(e=>(0,a.indexedArg)(e,t))}literalNode(e,t,r){return o.Pledge.try(()=>this.visitor.literalNode(e,t,r))}arrayNode(e,t,r){return o.Pledge.all(e.map(e=>o.Pledge.all(e.map(this.lazyVisitFormulaNode)))).bind(e=>this.visitor.arrayNode(e,t,r))}appNode(e,t,r,n){return this.lazyVisitAppHeadNode(e).bind(e=>o.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind(t=>this.visitor.appNode(e,t,r,n)))}letNode(e,t,r,n,i,a){return this.lazyVisitWSFNode(e).bind(e=>o.Pledge.all(t.map(this.lazyVisitVar)).bind(t=>(void 0===r?o.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind(r=>o.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind(n=>this.visitor.letNode(e,t,r,n,i,a)))))}lambdaNode(e,t,r,n,i,a){return this.lazyVisitWSFNode(e).bind(e=>o.Pledge.all(t.map(this.lazyVisitParam)).bind(t=>(void 0===r?o.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind(r=>o.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind(n=>this.visitor.lambdaNode(e,t,r,n,i,a)))))}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind(e=>this.visitor.parenNode(e,t,r))}nameNode(e,t,r){return o.Pledge.try(()=>this.visitor.nameNode(e,t,r))}cellRefNode(e,t,r){return o.Pledge.try(()=>this.visitor.cellRefNode(e,t,r))}fieldRefNode(e,t,r,n){return this.lazyVisitFormulaNode(e).bind(e=>this.visitor.fieldRefNode(e,t,r,n))}structRefNode(e,t,r){return o.Pledge.try(()=>this.visitor.structRefNode(e,t,r))}badSequenceNode(e,t,r){return o.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind(t=>this.visitor.badSequenceNode(e,t,r))}badStringNode(e,t,r){return o.Pledge.try(()=>this.visitor.badStringNode(e,t,r))}operatorNode(e,t){return o.Pledge.try(()=>this.visitor.operatorNode(e,t))}wsfNode(e,t,r){return o.Pledge.try(()=>this.visitor.wsfNode(e,t,r))}}function F(e,t,r){return r<=50?R(e,t):I(e,t)}function M(e,t){return o.Pledge.settleOrThrow(o.Pledge.resolve(s(e,t)))}t.PledgeReducer=_,t.reduceBottomUp_Pledge=function(e,t){return M(new _(e),t)},t.reduceBottomUp_MaxDepth=F,t.reduceBottomUp=function(e,t){return F(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=M,t.reducePledge=function(e,t){return M(e,t.node)}},330:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(655),i=r(9937),o=r(3546),a=r(927),s=r(5499),l=r(1646),u=r(7815),c=r(9745),d=r(2195),f=r(7458),p=r(9017);function m(e,t,r,n){if(r.kind===o.PosKind.Abs)return r;var i=(0,l.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,o.pos)(o.PosKind.Rel,i)}function h(e,t,r,n){var a=m(t.row,r.row,n.row,i.sheetRows),l=m(t.col,r.col,n.col,i.sheetCols),u=(0,s.canonicaliseBrackets)(e,a)||(0,s.canonicaliseBrackets)(e,l);return(0,o.cellRefSingle)(a,l,u,n.label)}function g(e,t,r,n){switch(n.kind){case o.CellRefKind.Error:case o.CellRefKind.Bad:return n;case o.CellRefKind.Single:return h(e,t,r,n);case o.CellRefKind.Range:var a=h(e,t,r,n.ref1),l=h(e,t,r,n.ref2);return a===n.ref1&&l===n.ref2?n:(0,o.cellRefRange)(a,l,n.label);case o.CellRefKind.Row:var u=m(t.row,r.row,n.row1,i.sheetRows),c=m(t.row,r.row,n.row2,i.sheetRows),d=(0,s.canonicaliseBrackets)(e,u)||(0,s.canonicaliseBrackets)(e,c);return(0,o.cellRefRow)(u,c,d,n.label);case o.CellRefKind.Col:var f=m(t.col,r.col,n.col1,i.sheetCols),p=m(t.col,r.col,n.col2,i.sheetCols);return d=(0,s.canonicaliseBrackets)(e,f)||(0,s.canonicaliseBrackets)(e,p),(0,o.cellRefCol)(f,p,d,n.label)}}var v=(0,a.createFailureErrorClass)("TransformRefsError"),S=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.fn=t,o.locals=n,o.annotations=i,o.resolver=(0,f.createResolver)(r),o}return n.__extends(t,e),t.prototype.nameNode=function(e,t,r){var n=(0,o.nameNode)(e,t,r),i=this.resolver.resolveDottedName(this.locals,n,this.annotations).resolved;if(i.kind===d.ResolvedKind.ResolvedCellRef){var a=(0,o.flattenNameParts)(e);(0,c.assertTrue)("calc.lang.adjustFormulaOrigin",a.kind===o.NamePartKind.CellRefNamePart);var s=a.parts,l=s[0],f=s[1],p=s.slice(2),m=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,i=t.label,a=t.qualifiedLabel;return(0,o.fieldRefNamePart)(e,r,n,i,a)};return(0,o.nameNode)(p.reduce(m,m((0,o.cellRefNamePart)(this.fn(l.ref),l.asWhole,l.label,l.qualifiedLabel),f)),t,r)}if(i.resolution.kind!==u.ResultKind.Success&&i.resolution.reason.kind!==d.ResolveReasonKind.NoOriginSheet&&i.resolution.reason.kind!==d.ResolveReasonKind.InvalidQualifier)throw new v(i.resolution.reason);return n},t.prototype.cellRefNode=function(e,t,r){return(0,o.cellRefNode)(this.fn(e),t,r)},t}(p.IdentityVisitor);t.adjustFormulaOrigin=function(e,t,r,i){var o=t.originGridCell.value;if((0,a.isGridCellEqual)(o,r))return(0,u.success)(i);try{var s=(0,p.reduceBottomUp)(new S(g.bind(void 0,e.config.refStyle,o,r),e,t,i.annotations),i);return(0,u.success)(n.__assign(n.__assign({},i),{node:s}))}catch(e){if(e instanceof v)return(0,u.failure)(e.reason);throw e}}},2840:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(655),i=r(9745),o=r(2903),a=r(8308),s=r(3494),l=r(3546),u=r(927),c=r(9017),d=function(e){function t(t,r,n){var i=e.call(this,c.voidVisitor)||this;return i.localeInfo=t,i.annotations=r,i.names=n,i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var o=this;return a.Pledge.try((function(){return t.kind===l.NodeKind.Name&&(o.annotations[t.label]=l.appHeadNameAnnotation),e.prototype.appNode.call(o,t,r,n,i)}))},t.prototype.letNode=function(e,t,r,n){var o=this,l=e.id===s.WorksheetFuncId.LETREC||e.id!==s.WorksheetFuncId.LET&&(0,i.assertFalse)("calc.lang.buildAnnotations"),u=this.bindNames(t),d=u[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return l?a.Pledge.all(t.map((function(e){var t=e.binder;return a.Pledge.try((function(){return(0,c.visitFormulaNode)(d,t.arg)}))}))):a.Pledge.all(t.map((function(e,t){var r=e.binder,n=u[t];return a.Pledge.try((function(){return(0,c.visitFormulaNode)(n,r.arg)}))})))})).bind((function(e){return void 0===r?void 0:(0,c.visitFormulaNode)(d,r.arg)})).bind((function(e){return a.Pledge.all(n.map((function(e){return a.Pledge.try((function(){return(0,c.visitFormulaNode)(o,e.arg)}))})))})).bind((function(e){}))},t.prototype.lambdaNode=function(e,t,r,n){var i=this,o=this.bindNames(t),s=o[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return a.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return a.Pledge.resolve(void 0);var n=o[t],i=r.arg.def;return a.Pledge.try((function(){return(0,c.visitFormulaNode)(n,i.rhs)}))})))})).bind((function(e){return void 0===r?void 0:(0,c.visitFormulaNode)(s,r.arg)})).bind((function(e){return a.Pledge.all(n.map((function(e){return a.Pledge.try((function(){return(0,c.visitFormulaNode)(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.bindNames=function(e){var r=this,n=[this];return e.reduce((function(e,i){var o=i.name;if(void 0===o.arg.whole)return n.push(new t(r.localeInfo,r.annotations,e)),e;var a=(0,u.getBoundName)(r.localeInfo,o.arg.whole),s=e.setValue(a,o.arg);return n.push(new t(r.localeInfo,r.annotations,s)),r.annotations[o.arg.label]=(0,l.localNameDeclAnnotation)(a,o.arg.whole),s}),this.names),n},t.prototype.nameNode=function(t,r,n){var i=this;return a.Pledge.try((function(){if(void 0===r){var o=(0,l.headNamePart)(t),a=i.names.getEntry((0,u.getBoundName)(i.localeInfo,o.asWhole));void 0===a||(a.value.kind===l.NodeKind.ContextName?i.annotations[o.label]=(0,l.localNameUseAnnotation)(a.key,a.value.whole,a.value.label):(i.annotations[o.label]=(0,l.localNameUseAnnotation)(a.key,a.value.whole,a.value.label),i.annotations[a.value.label].uses.push({label:o.label})))}return e.prototype.nameNode.call(i,t,r,n)}))},t}(c.PledgeReducer);t.buildAnnotations=function(e,t,r,n){var i=[];return(0,c.reduceTopDown_Pledge)(new d(e,i,(null!=r?r:[]).reduce((function(t,r){var n=(0,u.getBoundName)(e,r.whole);return t.setValue(n,r)}),o.RedBlackMapTree.create(e.stringCompareCI))),t),i[t.label]=(0,l.formulaRootAnnotation)(r,n),i}},5499:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;var n=r(9937),i=r(3546),o=r(1646),a=r(9745),s=r(1345),l=r(9119),u=r(3883),c=(0,i.pos)(i.PosKind.Abs,0),d=(0,i.pos)(i.PosKind.Abs,n.sheetRows-1),f=s.codePointCapitalA,p=s.codePointFullStop;function m(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(f+n)+r,t=Math.floor((t-n)/26)}return r}function h(e,t,r,n){if(t.kind===i.PosKind.Abs)return t.index;if(n)return(0,o.wrapPosition)(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function g(e,t,r,n,o,a){var s=h(r,n,o,a);if(void 0!==s){if(n.kind===i.PosKind.Abs)return t+(s+1).toFixed();var l=s-r;return 0===l?t:t+e.rcLeftBracket+l.toFixed()+e.rcRightBracket}}function v(e,t,r,o,a){return t===i.RefStyle.A1?function(e,t,r){var o=h(e,t,n.sheetRows,r);if(void 0!==o){var a=(o+1).toFixed();return t.kind===i.PosKind.Abs?"$"+a:a}}(r,o,a):g(e,e.rowLetter,r,o,n.sheetRows,a)}function S(e,t,r,o,a){return t===i.RefStyle.A1?function(e,t,r){var o=h(e,t,n.sheetCols,r);if(void 0!==o){var a=m(o);return t.kind===i.PosKind.Abs?"$"+a:a}}(r,o,a):g(e,e.columnLetter,r,o,n.sheetCols,a)}function y(e,t,r,n){if(r.kind===i.PosKind.Abs)return r;var o=h(t,r,e,n);if(void 0!==o){var a=o-t;return a===r.index?r:(0,i.pos)(i.PosKind.Rel,a)}}function C(e,t,r,n,i){var o=h(e,t,n,i),a=h(e,r,n,i);if(void 0!==o&&void 0!==a)return o<=a?[t,r,o,a]:[r,t,a,o]}function R(e,t,r,n,o,a,s,l,u){var c=C(a,s,l,r,u);if(void 0!==c){var d=c[0],f=c[1],p=c[2],m=c[3];if(void 0!==t&&0===p&&m===r-1&&s.kind===l.kind)return t(n,o,u);var h=e(n,o,a,d,u);if(void 0!==h){if(o===i.RefStyle.R1C1&&d.kind===f.kind&&d.index===f.index)return h;var g=e(n,o,a,f,u);if(void 0!==g)return h+":"+g}}}function b(e,t,r,n,i,o){var a=C(r,n,i,t,o);if(void 0!==a){var s=a[0],l=a[1],u=a[2],c=a[3];if(void 0!==e&&0===u&&c===t-1&&n.kind===i.kind)return e;var d=y(t,r,s,o),f=y(t,r,l,o);if(void 0!==d&&void 0!==f)return[!1,d,f]}}function N(e,t,r,n,o,a){var s=v(e,t,r.row,n,a),l=S(e,t,r.col,o,a);if(void 0!==s&&void 0!==l)return t===i.RefStyle.A1?l+s:s+l}function T(e,r,i,o,a,s,l,u){var c=C(i.row,o,s,n.sheetRows,u),d=C(i.col,a,l,n.sheetCols,u);if(void 0!==c&&void 0!==d){var f=c[0],p=c[1],m=c[2],h=c[3],g=d[0],v=d[1],S=d[2],y=d[3];if(0===S&&y===n.sheetCols-1&&a.kind===l.kind)return(0,t.formatRowRange)(e,r,i.row,f,p,u);if(0===m&&h===n.sheetRows-1&&o.kind===s.kind)return(0,t.formatColRange)(e,r,i.col,g,v,u);var R=N(e,r,i,f,g,u),b=N(e,r,i,p,v,u);if(void 0!==R&&void 0!==b)return R+":"+b}}function P(e,t){return t===p||e.isIdentContinue(t)}t.columnName=m,t.canonicaliseBrackets=function(e,t){return e===i.RefStyle.R1C1&&t.kind===i.PosKind.Rel&&0!==t.index},t.resolvePosition=h,t.formatRow=v,t.formatCol=S,t.canonicaliseRow=y.bind(void 0,n.sheetRows),t.canonicaliseCol=y.bind(void 0,n.sheetCols),t.formatRowRange=R.bind(void 0,v,void 0,n.sheetRows),t.formatColRange=R.bind(void 0,S,(function(e,r,n){return(0,t.formatRowRange)(e,r,0,c,d,n)}),n.sheetCols),t.canonicaliseRowRange=b.bind(void 0,void 0,n.sheetRows),t.canonicaliseColRange=b.bind(void 0,[!0,c,d],n.sheetCols),t.formatCellPos=N,t.canonicaliseCellPos=function(e,r,n,i){var o=(0,t.canonicaliseRow)(e.row,r,i),a=(0,t.canonicaliseCol)(e.col,n,i);if(void 0!==o&&void 0!==a)return{row:o,col:a}},t.formatRangePos=T,t.canonicaliseRangePos=function(e,r,i,o,a,s){var l=C(e.row,r,o,n.sheetRows,s),u=C(e.col,i,a,n.sheetCols,s);if(void 0!==l&&void 0!==u){var c=l[0],d=l[1],f=l[2],p=l[3],m=u[0],h=u[1],g=u[2],v=u[3],S=(0,t.canonicaliseRow)(e.row,c,s),y=(0,t.canonicaliseCol)(e.col,m,s),R=(0,t.canonicaliseRow)(e.row,d,s),b=(0,t.canonicaliseCol)(e.col,h,s);if(void 0!==S&&void 0!==y&&void 0!==R&&void 0!==b)return 0===g&&v===n.sheetCols-1&&i.kind===a.kind?{row1:S,row2:R,col1:void 0,col2:void 0}:0===f&&p===n.sheetRows-1&&r.kind===o.kind?{col1:y,col2:b,row1:void 0,row2:void 0}:{row1:S,col1:y,row2:R,col2:b}}};var E=/'/g;function k(e,t){if(0===t.length)return!1;var r=0,n=(0,l.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,l.numCodeUnits)(n);for(var i=0,o=(0,l.codePointIterator)(t,r);i<o.length;i++)if(!P(e,o[i]))return!1;return!0}var O=(0,n.gridCell)(0,0);function A(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=(0,o.parseCellRef)(e,t,O,r,0);if(void 0!==n)if(n.refStyle===i.RefStyle.A1){var a=n.i;if(a>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,a)))return!0}else if(!(0,o.isR1C1IdentStart)(n.row,n.col))return!0;return!k(e,r)&&!function(e,t){var r=0;if(!(0,u.stringStartsWith)(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=(0,l.stringCodePointAt)(t,r);if(!P(e,n))return!1;for(r+=(0,l.numCodeUnits)(n);;){if((0,u.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var i=(0,l.stringCodePointAt)(t,r);if(!P(e,i))return!1;r+=(0,l.numCodeUnits)(i)}var o=t.indexOf(":",r);return o<0?k(e,t.substring(r)):k(e,t.substring(r,o))&&k(e,t.substring(o+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&t.substring(0,r)===e.leftBracket&&t.substring(t.length-n)===e.rightBracket&&k(e,t.substring(r,t.length-n))}(e,r)}function I(e,t,r){return A(e,t,r)?_(r):r}function _(e){return"'".concat(e.replace(E,"''"),"'")}t.shouldQuoteQualifier=A,t.formatQualifier=I,t.quoteQualifier=_,t.formatGridRange=function(e,t,r,o,s){void 0===r&&(r=i.RefStyle.A1);var l=1===t.cols&&1===t.rows?N(e,r,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),!1):T(e,r,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),(0,i.pos)(i.PosKind.Rel,t.row+t.rows-1),(0,i.pos)(i.PosKind.Rel,t.col+t.cols-1),!1);if((0,a.assertTrue)("calc.lang.formatGridRange",void 0!==l),void 0===o&&void 0===s)return l;if(void 0===o||void 0===s)return I(e,r,null!=o?o:s)+"!"+l;var u=o+":"+s;return(A(e,r,o)||A(e,r,s)?_(u):u)+"!"+l},t.formatName=function(e,t,r,n){return void 0===r&&(r=i.RefStyle.A1),void 0===n?t:I(e,r,n)+"!"+t}},1646:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(9937),i=r(8350),o=r(3546),a=r(4931),s=r(1345),l=r(3883),u=r(9119),c=n.sheetRows,d=c.toString(10).length,f=n.sheetCols,p=f.toString(26).length,m=f.toString(10).length,h=s.codePointCapitalA,g=s.codePointCapitalZ,v=s.codePointSmallA,S=s.codePointSmallZ,y=s.codePointPlusSign,C=s.codePointMinusSign,R=s.codePointColon;function b(e){return e>=v&&e<=S||e>=h&&e<=g}function N(e){return 1+(e>=v?e-v:e-h)}function T(e,t,r,n){return function(i,a,s,c,d){var f=function(e,t){return(0,l.stringStartsWith)(e,"$",t)?[o.PosKind.Abs,t+1]:[o.PosKind.Rel,t]}(s,c),p=f[0],m=f[1],h=e(i,r,s,m),g=h[0],v=h[1];if(v>m){if(g<1||g>t)return p===o.PosKind.Abs||(!0===n?"object"==typeof d&&d.kind===o.PosKind.Abs||d===O.A1BadDollar:(0,l.stringStartsWith)(s,"$",v))?[O.A1BadDollar,!0,v]:void 0;var S=p===o.PosKind.Rel?g-a:g;return[(0,o.pos)(p,S-1),p===o.PosKind.Abs,v]}return p!==o.PosKind.Abs||!0!==n&&v!==s.length&&i.isNumeral((0,u.stringCodePointAt)(s,v))?[void 0,!1,c]:[O.A1BadDollar,!0,v]}}function P(e,t,r){return L(e,t,r)-e}function E(e,t,r,n){return function(i,s,u,c){var d=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(c>=u.length||0!==i.stringCompareCI(d,u[c]))return[void 0,!1,c];var f=c+d.length,p=(0,a.parseUint)(i,n,u,f),m=p[0],h=p[1];if(h>f&&m>=1&&m<=r)return[(0,o.pos)(o.PosKind.Abs,m-1),!1,h];if((0,l.stringStartsWith)(u,i.rcLeftBracket,f)){if(f+=i.rcLeftBracket.length,(0,l.stringStartsWith)(u,i.rcRightBracket,f))return[(0,o.pos)(o.PosKind.Rel,P(s,0,r)),!0,f+i.rcRightBracket.length];var g=1,v=u.charCodeAt(f);v===y?f+=1:v===C&&(g=-1,f+=1);var S=(0,a.parseUint)(i,n,u,f),R=S[0],b=S[1];if(b>f&&R<r&&(0,l.stringStartsWith)(u,i.rcRightBracket,b))return[(0,o.pos)(o.PosKind.Rel,P(s,R*g,r)),!0,b+i.rcRightBracket.length]}return[O.RCNoNum,!1,c+d.length]}}function k(e,t,r,n,i,o,a){var s=n(e,t,o,a,void 0);if(null==s)return[void 0,void 0,a];var l=s[0],u=s[1],c=s[2];if(c>a){var d=i(e,r,o,c,l);if(null==d)return u?[l,void 0,c]:[void 0,void 0,a];var f=d[0],p=d[2];return p>c?[l,f,p]:[l,void 0,c]}var m=i(e,r,o,a,l);if(null==m)return[void 0,void 0,a];var h=m[0],g=m[2];return g>a?[void 0,h,g]:[void 0,void 0,a]}var O,A=T(a.parseUint,c,d,!0),I=T((function(e,t,r,n){return function(e,t,r){for(var n=0,o=r,a=(0,i.fastMin)(t.length,r+e);o<a;o+=1){var s=t.charCodeAt(o);if(!b(s))break;n=26*n+N(s)}return o===a&&o<t.length&&b(t.charCodeAt(o))?[0,r]:[n,o]}(t,r,n)}),f,p,!1),_=E(!1,!0,c,d),F=E(!1,!1,f,m),M=E(!0,!0,c,d),D=E(!0,!1,f,m);function w(e,t){return"object"!=typeof e&&"object"!=typeof t}function L(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(O=t.SpecialPos||(t.SpecialPos={})),t.isR1C1IdentStart=w,t.parseCellRef=function(e,t,r,n,i){var a=function(e,t,r,n,i){var a=k(e,r.col,r.row,I,A,n,i),s=a[0],l=a[1],c=a[2],d="object"==typeof l&&l.kind===o.PosKind.Abs||l===O.A1BadDollar||"object"==typeof s&&s.kind===o.PosKind.Abs||s===O.A1BadDollar;if(null!=l&&null!=s||d||(null!=l||null!=s)&&(i-1>=0&&n.charCodeAt(i-1)===R||c<n.length&&n.charCodeAt(c)===R)){if(c<n.length&&e.isIdentContinue((0,u.stringCodePointAt)(n,c)))return;if(t!==o.RefStyle.A1&&!d)return;return{refStyle:o.RefStyle.A1,row:l,col:s,i:c}}}(e,t,r,n,i);return void 0!==a?a:function(e,t,r,n,i){var a,s=r.col,l=r.row,c=!1,d=k(e,l,s,_,F,n,i),f=d[0],p=d[1],m=d[2];if(null!=f||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(c=!0,f=(a=k(e,l,s,M,D,n,i))[0],p=a[1],m=a[2]),(null!=f||null!=p)&&(m>=n.length||!w(f,p)||!e.isIdentContinue((0,u.stringCodePointAt)(n,m))))return{refStyle:o.RefStyle.R1C1,row:f,col:p,i:m,enLocale:c}}(e,0,r,n,i)},t.parseGridCellA1=function(e,t){var r=k(e,0,0,I,A,t,0),i=r[0],o=r[1],a=r[2];return"object"==typeof i&&"object"==typeof o&&a===t.length?(0,n.gridCell)(o.index,i.index):void 0},t.parseGridRangeA1=function(e,t){var r=k(e,0,0,I,A,t,0),o=r[0],a=r[1],s=r[2];if("object"==typeof o&&"object"==typeof a){if(s===t.length)return(0,n.gridCell)(a.index,o.index);if(t.charCodeAt(s)===R){var l=k(e,0,0,I,A,t,s+1),u=l[0],c=l[1],d=l[2];if("object"==typeof u&&"object"==typeof c&&d===t.length){var f=(0,i.fastMin)(a.index,c.index),p=(0,i.fastMin)(o.index,u.index);return(0,n.gridRange)(f,p,(0,i.fastMax)(a.index,c.index)+1-f,(0,i.fastMax)(o.index,u.index)+1-p)}}}},t.parseQualifier=function(e){var t=e.lastIndexOf("!");if(!(t<0||0===t||t===e.length-1)){var r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if((0,l.stringStartsWith)(r,"'")&&(0,l.stringEndsWith)(r,"'")){for(var i=[],o=1;o<r.length-1;++o){var a=r.charAt(o);if("'"===a){if(o+1>=r.length-1||"'"!==r.charAt(o+1))return;i.push(a),++o}else i.push(a)}return{qualifier:i.join(""),unqualified:n}}}},t.wrapPosition=L},4038:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(637);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},9745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(637);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},1345:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(637);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},8350:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(637);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},3116:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(637);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},8832:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(637);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},2903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(637);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},625:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n=r(637);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},4611:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(637);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(9992);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},7815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(637);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},8308:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(637);t.Pledge=n.pledge.Pledge},9119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(637);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},3883:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(637);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},3378:(e,t,r)=>{"use strict";var n,i,o,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var u=r(1821);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return u.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return u.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return u.NulLogger}});var c=r(8350),d=r(9745);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return d.ulsLogger}});var f,p,m,h,g,v,S=r(5947),y=r(3883),C=r(9119),R=r(624),b=r(3116),N=r(2294),T=r(3546),P=r(9421),E=r(3181),k=r(3962);function O(e,t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,b,N,T,P,E,k,O,A,I,_,F,M,D,w,L,x,B,U,G,K,V,j,W,H,Q,q,z,Y,J,X,$,Z,ee,te,re,ne,ie,oe,ae,se,le,ue,ce,de,fe,pe){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:o,isIdentStart:a,isIdentContinue:s,stringCompareCI:l,errorNames:u,specialRefNames:c,trueName:d,falseName:f,rowLetter:p,columnLetter:m,leftBrace:h,rightBrace:g,leftBracket:v,rightBracket:S,rcLeftBracket:y,rcRightBracket:C,decimalSeparator:R,listSeparator:b,columnSeparator:N,rowSeparator:T,thousandsSeparator:P,statementSeparator:E,lcid:k,country:O,isThai:A,isEastAsia:I,isKorea:_,isJapan:F,isChinaT:M,isChinaS:D,isComplexScript:w,numberDecimals:L,isExpSepBySpace:x,fractionSeparator:B,isPercentSepBySpace:U,currencyFormat:G,isCurrencySymbolLead:K,isCurrencySepBySpace:V,currencySymbol:j,currencyDecimals:W,dateOrder:H,dateSeparator:Q,dateAltSeparator:q,year4Digits:z,month2Digits:Y,day2Digits:J,longDateFormat:X,timeSeparator:$,timeAltSeparator:Z,hour2Digits:ee,clock24Hour:te,isAMPMSepBySpace:re,ampmSymbols:ne,dayNameShort:ie,dayNameLong:oe,monthNameShort:ae,monthNameLong:se,pictureSpecial:le,pictureSingle:ue,pictureColor:ce,pictureDbnum:de,sysDateFormat:fe,sysTimeFormat:pe}}function A(e){var t=0|e;if(t<128)return t>=48&&t<58;var r=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 4960:return r>=9;case 4976:return r<=1;default:return!1}}function I(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getOrdinal"),15&t;var r,n=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:r=n;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:r=n-6;break;case 4960:r=n-8;break;case 4976:r=n+8;break;default:return(0,d.assertFalse)("calc.config.getOrdinal")}return(r<0||r>9||4968===t)&&(0,d.assertFalse)("calc.config.getOrdinal"),r}function _(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getNumberShape"),P.NumberShape.ASCII;switch(A(t)||(0,d.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return P.NumberShape.ArabicIndic;case 1776:return P.NumberShape.ExtendedArabicIndic;case 2400:return P.NumberShape.Devanagari;case 2528:return P.NumberShape.Bengali;case 2656:return P.NumberShape.Gurmukhi;case 2784:return P.NumberShape.Gujarati;case 2912:return P.NumberShape.Oriya;case 3040:return P.NumberShape.Tamil;case 3168:return P.NumberShape.Telugu;case 3296:return P.NumberShape.Kannada;case 3424:return P.NumberShape.Malayalam;case 3664:return P.NumberShape.Thai;case 3792:return P.NumberShape.Lao;case 3872:return P.NumberShape.Tibetan;case 4160:return P.NumberShape.Myanmar;case 4960:case 4976:return P.NumberShape.Ethiopic;case 6112:return P.NumberShape.Khmer;case 6160:return P.NumberShape.Mongolian;default:return(0,d.assertFalse)("calc.config.getNumberShape")}}function F(e){return 0!=((0,R.getCharCodeBits)(e)&C.CharCodeBits.IdentStartClass)}function M(e){return 0!=((0,R.getCharCodeBits)(e)&C.CharCodeBits.IdentContinueClass)}t.calcConfig=function(e,t,r,n,i,o,a){return void 0===t&&(t=T.RefStyle.A1),void 0===r&&(r=k.xlMathpack),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===o&&(o=E.tzUTC),void 0===a&&(a=E.xlDatepack),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:o,datepack:a}},t.localeInfo=O,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(f=t.Country||(t.Country={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(p=t.LCID||(t.LCID={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(m=t.PictureSpecial||(t.PictureSpecial={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(h=t.PictureSingle||(t.PictureSingle={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(g=t.PictureColor||(t.PictureColor={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(v=t.PictureDbnum||(t.PictureDbnum={})),t.isNumeral=A,t.getOrdinal=I,t.getNumberShape=_,t.isIdentStart=F,t.isIdentContinue=M,t.englishErrorNames=(0,y.partialArray)(((n={})[N.ErrorType.NULL]="#NULL!",n[N.ErrorType.DIV0]="#DIV/0!",n[N.ErrorType.VALUE]="#VALUE!",n[N.ErrorType.REF]="#REF!",n[N.ErrorType.NAME]="#NAME?",n[N.ErrorType.NUM]="#NUM!",n[N.ErrorType.NA]="#N/A",n[N.ErrorType.GETTING_DATA]="#GETTING_DATA",n[N.ErrorType.SPILL]="#SPILL!",n[N.ErrorType.CONNECT]="#CONNECT!",n[N.ErrorType.BLOCKED]="#BLOCKED!",n[N.ErrorType.UNKNOWN]="#UNKNOWN!",n[N.ErrorType.FIELD]="#FIELD!",n[N.ErrorType.CALC]="#CALC!",n[N.ErrorType.BUSY]="#BUSY!",n[N.ErrorType.EXTERNAL]="#EXTERNAL!",n)),t.englishSpecialRefNames=(0,y.partialArray)(((i={})[T.SpecialRefId.All]="#All",i[T.SpecialRefId.Data]="#Data",i[T.SpecialRefId.Headers]="#Headers",i[T.SpecialRefId.Totals]="#Totals",i[T.SpecialRefId.ThisRow]="#This Row",i)),t.englishPictureSpecial=(0,y.partialArray)(((o={})[m.AP1]="AM/PM",o[m.AP2]="A/P",o[m.AP3]="/",o[m.General]="General",o[m.Currency]="$",o)),t.englishPictureSingle=(0,y.partialArray)(((a={})[h.Sep]=";",a[h.Hash]="#",a[h.Zero]="0",a[h.Decimal]=".",a[h.Percent]="%",a[h.Comma]=",",a[h.Colon]=":",a[h.DateSep]="/",a[h.Slash]="/",a[h.Space]=" ",a[h.Minus]="-",a[h.Plus]="+",a[h.OpenParen]="(",a[h.CloseParen]=")",a[h.Backslash]="\\",a[h.Star]="*",a[h.Year]="y",a[h.Month]="m",a[h.Day]="d",a[h.Hour]="h",a[h.Minute]="m",a[h.Second]="s",a[h.E]="E",a[h.APDelim]="/",a[h.Quote]='"',a[h.ColorStart]="[",a[h.ColorEnd]="]",a[h.Text]="@",a[h.Question]="?",a[h.Underscore]="_",a[h.Reign]="r",a[h.LocDay]="a",a[h.Era]="g",a[h.EraYear]="e",a[h.BidiDate]="B",a[h.BidiNum]="N",a[h.DayTh]="",a[h.MonthTh]="",a[h.YearTh]="",a[h.EngYearTh]="b",a[h.ThYear]="",a[h.HourTh]="",a[h.MinuteTh]="",a[h.SecondTh]="",a[h.ZeroTh]="",a)),t.englishPictureColor=(0,y.partialArray)(((s={})[g.Black]="Black",s[g.White]="White",s[g.Red]="Red",s[g.Green]="Green",s[g.Blue]="Blue",s[g.Yellow]="Yellow",s[g.Magenta]="Magenta",s[g.Cyan]="Cyan",s[g.Color]="Color",s)),t.englishPictureDbnum=(0,y.partialArray)(((l={})[v.DBNUM1]="DBNum1",l[v.DBNUM2]="DBNum2",l[v.DBNUM3]="DBNum3",l[v.DBNUM4]="DBNum4",l)),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM";var D=void 0;t.englishWorksheetFuncIdToName=function(e){var t=L()[e];return void 0===t?"wsf:".concat(e):t},t.englishErrorTypeToName=function(e){var r=t.englishErrorNames[e];return void 0===r?"error.type:".concat(e):r},t.englishOperatorIdToName=function(e){if(e===S.OperatorId.Isect)return" ";if(e===S.OperatorId.Union)return",";var t=S.operatorStrings[e];return void 0===t?"op:".concat(e):t},t.operatorIdToName=function(e,t,r){return t===S.OperatorId.Isect?r:t===S.OperatorId.Union?e.listSeparator:S.operatorStrings[t]};var w=/_/g;function L(){if(null==D){D=[];for(var e=0,t=(0,c.numEnumArray)(S.WorksheetFuncId);e<t.length;e++){var r=t[e],n=(0,S.getWorksheetFuncEnglishName)(r),i=null!=n?n:S.WorksheetFuncId[r].replace(w,".");D[r]=i}}return D}function x(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),b.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?(0,d.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(e)):r}}}t.getEnglishWorksheetFuncIdToName=L,t.createWorksheetFuncNameCallbacks=x;var B=void 0;t.getEnglishLocaleInfo=function(){return null==B&&(B=function(){var e=L(),r=(0,c.makeStringCompareCI)("en-US"),n=x(r,e);return O(n.getWorksheetFuncId,n.getWorksheetFuncName,A,I,_,(function(e){return e>0&&e%3==0}),F,M,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",p.USA,f.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,P.CurrencyFormat.Paren,!0,!1,"$",2,P.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),B}},3181:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;var n,i=r(9799),o=r(2294),a=r(8350);t.tzData=(0,a.typedInstanceCreator)()((function(e,t,r,n,i){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i}})),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=i.dtr.Rounding,t.dateTime=i.dtr.dtr,t.TimeDivision=i.dtr.TimeDivision,(n=t.TimeGranularity||(t.TimeGranularity={}))[n.Year=0]="Year",n[n.Day=1]="Day",n[n.Instant=2]="Instant",t.xlDatepack={fromNum:function(e,t,r){return i.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=i.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):o.numErrorOper},toNumWithDuration:function(e,t,r,n){var a=i.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof a?e.mathpack.fromNumber(a):o.numErrorOper},daysPerMonth:i.dtr.daysPerMonth,toDays:function(e,t){return i.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return i.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return i.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},3546:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=void 0;var n,i,o,a,s,l,u,c,d,f,p,m,h=r(655),g=r(9745),v=r(8350),S=r(8350);function y(e){return Array.isArray(e)}function C(e){return void 0!==e.kind}function R(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],o=i.arg,a=i.index;(0,g.assertIndex)("calc.lang.flattenNumberedArgs: idx",a,e.length),(0,g.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[a]),t[a]=o}return t}function b(e,t,r){return R((0,S.safeConcat)(h.__spreadArray(h.__spreadArray([],void 0===t?[]:[t],!0),r,!0),e.map((function(e){return[e.name,e.binder]}))))}function N(e,t){return{arg:e,index:t}}function T(e,t){return{name:e,binder:t}}function P(e,t,r){return void 0===r&&(r=[]),R(h.__spreadArray(h.__spreadArray(h.__spreadArray([],e.map((function(e){return e.name})),!0),void 0===t?[]:[t],!0),r,!0))}function E(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:s.ParamName,label:n,name:e,isBracketed:t,isClosed:r}}function k(e,t,r){return void 0===r&&(r=0),{kind:s.Param,label:r,name:e,whole:e.name.kind===s.Name?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}}function O(e){return{name:e}}function A(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,i="string"==typeof e?I(e,!0):e;return{kind:s.Name,label:r,whole:n,parts:i,qualifier:t}}function I(e,t,r,n){return void 0===t&&(t=!0),void 0===r&&(r=0),void 0===n&&(n=0),{kind:l.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}}function _(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),(0,g.assertTrue)("calc.lang.fieldRef","string"==typeof e||e.kind!==s.Name||void 0===e.qualifier),{kind:s.FieldRefRHS,label:n,field:"string"==typeof e?A(e):e,isBracketed:t,isClosed:r}}function F(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case s.Array:for(var n=0,i=0,o=t.nodes;i<o.length;i++)for(var a=0,l=o[i];a<l.length;a++){var u=l[a];n=(0,v.fastMax)(n,e(u,r+1))}return n+1;case s.Param:return void 0===t.def?1:e(t.def.rhs,r+1)+1;case s.Let:case s.Lambda:case s.App:n=e(t.head,r+1);for(var c=0,f=t.args;c<f.length;c++){var p=f[c];n=(0,v.fastMax)(n,e(p,r+1))}return n+1;case s.Paren:return e(t.node,r+1)+1;case s.FieldRef:return e(t.lhs,r+1)+1;case s.Name:case s.CellRef:case s.StructRef:case s.Literal:case s.Operator:case s.WSF:return 1;case s.Bad:switch(t.type){case d.Sequence:case d.StructRef:case d.FieldRef:n=0;for(var m=0,h=t.contents;m<h.length;m++){var S=h[m];n=(0,v.fastMax)(n,e(S,r+1))}return n+1;default:return"string"==typeof t.contents?1:(0,g.assertNever)("calc.lang.getDepthUpperBound",t.contents)}default:return(0,g.assertNever)("calc.lang.getDepthUpperBound",t)}}(e,0)}(m=t.RefStyle||(t.RefStyle={}))[m.R1C1=1]="R1C1",m[m.A1=2]="A1",(p=t.SyntaxFeature||(t.SyntaxFeature={})).Comments="Comments",p.Statements="Statements",function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(n=t.QualifierKind||(t.QualifierKind={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(i=t.CellRefKind||(t.CellRefKind={})),(f=t.PosKind||(t.PosKind={})).Abs="Abs",f.Rel="Rel",function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(o=t.CommentKind||(t.CommentKind={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(a=t.AnnotationKind||(t.AnnotationKind={})),t.appHeadNameAnnotation={kind:a.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF",e.Param="Param",e.ContextName="ContextName",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(s=t.NodeKind||(t.NodeKind={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(l=t.NamePartKind||(t.NamePartKind={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(u=t.SpecialRefId||(t.SpecialRefId={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(c=t.StructRefKind||(t.StructRefKind={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.Missing="Missing",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(d=t.BadType||(t.BadType={})),t.errorQualifier=function(e){return void 0===e&&(e=0),{kind:n.Error,isQuoted:!1,label:e}},t.relativeQualifier=function(e){return void 0===e&&(e=0),{kind:n.Relative,isQuoted:!1,label:e}},t.documentQualifier=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=0),{kind:n.Document,isQuoted:r,label:i,document:e,path:t}},t.sheetQualifier=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=0),{kind:n.Sheet,isQuoted:r,label:i,sheet:e,document:t}},t.identQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:n.Ident,isQuoted:t,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,i,o){return void 0===i&&(i=!1),void 0===o&&(o=0),{kind:n.SheetRange,isQuoted:i,label:o,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:n.Bad,isQuoted:t,label:r,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e){return void 0===e&&(e=0),{kind:i.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:i.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:i.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:F(e)}},t.singleLineComment=function(e,t){return void 0===t&&(t=0),{kind:o.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:o.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,n,i,o){return(0,g.assertNatural)("calc.lang.formulaSpan",e),(0,g.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,g.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(t)),{start:e,end:t,pre:r,post:n,preComments:i,postComments:o}},t.localNameUseAnnotation=function(e,t,r){return{kind:a.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r){return void 0===r&&(r=[]),{kind:a.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:a.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:s.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=b,t.indexedArg=N,t.letVar=T,t.letNode=function(e,t,r,n,i,o){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===o&&(o=0),(0,g.assertTrue)("calc.lang.letNode",t.every((function(e){return void 0===(y(e)?e[0]:e.name.arg).qualifier})));var a=t.map((function(e,t){return y(e)?T(N(e[0],2*t),N(e[1],2*t+1)):e})).sort((function(e,t){return e.name.index-t.name.index})),l=void 0!==r&&C(r)?N(r,2*t.length):r,u=b(a,l,n);return{kind:s.Let,label:o,head:e,args:u,isClosed:i,vars:a,body:l,badArgs:n}},t.flattenLambdaArgs=P,t.paramName=E,t.paramDefault=function(e,t){return void 0===t&&(t=0),{kind:s.ParamDef,label:t,rhs:e}},t.paramNode=k,t.lambdaParam=O,t.lambdaNode=function(e,t,r,n,i,o){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===o&&(o=0),(0,g.assertTrue)("calc.lang.lambdaNode",t.every((function(e){var t=C(e)?e:e.name.arg,r=t.kind===s.Name?t:t.name.name;return r.kind!==s.Name||void 0===r.qualifier})));var a=t.map((function(e,t){return C(e)?e.kind===s.Name?O(N(k(E(e,!1),void 0),t)):O(N(e,t)):e})).sort((function(e,t){return e.name.index-t.name.index})),l=void 0!==r&&C(r)?N(r,t.length):r,u=P(a,l,n);return{kind:s.Lambda,label:o,head:e,args:u,isClosed:i,params:a,body:l,badArgs:n}},t.operatorNode=function(e,t){return void 0===t&&(t=0),{kind:s.Operator,label:t,id:e}},t.wsfNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.Paren,label:r,node:e,isClosed:t}},t.nameNode=A,t.identNamePart=I,t.cellRefNamePart=function(e,t,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),{kind:l.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r,n,i){var o,a;void 0===r&&(r=!0),void 0===n&&(n=0),void 0===i&&(i=0);var u="string"==typeof t?_(t,!1,!0):t;return(0,g.assertTrue)("calc.lang.fieldRefNamePart",(null===(o=null==u?void 0:u.isClosed)||void 0===o||o)&&!(null!==(a=null==u?void 0:u.isBracketed)&&void 0!==a&&a)),{kind:l.FieldRefNamePart,label:n,qualifiedLabel:i,asWhole:e.asWhole+"."+(void 0===u?"":u.field.kind===s.Name?u.field.whole:u.field.contents),canDenoteNamedObject:r,lhs:e,rhs:u}},t.flattenNameParts=function(e){for(var t=[e],r=t[0];r.kind===l.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){for(var t=e;t.kind===l.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t){return void 0===t&&(t=0),{kind:s.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:s.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}},t.fieldRef=_,t.structRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r){return void 0===r&&(r=0),{kind:c.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t){var r;void 0===t&&(t=0);for(var n=((r={})[u.All]=!1,r[u.Data]=!1,r[u.Headers]=!1,r[u.Totals]=!1,r[u.ThisRow]=!1,r),i=[],o=0,a=e;o<a.length;o++){var s=a[o];switch(s.kind){case c.SpecialRef:n[s.id]=!0;break;case c.ColumnRef:case c.RangeOpRef:i.push(s)}}return{kind:c.CommaOpRef,label:t,refs:e,specialRefs:n,columnRefs:i}},t.thisRowOpRef=function(e,t){return void 0===t&&(t=0),{kind:c.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e){return void 0===e&&(e=0),{kind:c.MissingRef,label:e}},t.badRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.BadRef,contents:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:s.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.badNode=function(e,t,r){return void 0===r&&(r=0),{kind:s.Bad,label:r,type:e,contents:t}},t.getDepthUpperBound=F},624:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCharCodeBits=void 0;var n=r(637).unicode.makeGetCharCodeBits;t.getCharCodeBits=n([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},3494:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;var n,i=r(3424);(n=t.WorksheetFuncId||(t.WorksheetFuncId={}))[n.COUNT=0]="COUNT",n[n.IF=1]="IF",n[n.ISNA=2]="ISNA",n[n.ISERROR=3]="ISERROR",n[n.SUM=4]="SUM",n[n.AVERAGE=5]="AVERAGE",n[n.MIN=6]="MIN",n[n.MAX=7]="MAX",n[n.ROW=8]="ROW",n[n.COLUMN=9]="COLUMN",n[n.NA=10]="NA",n[n.NPV=11]="NPV",n[n.STDEV=12]="STDEV",n[n.DOLLAR=13]="DOLLAR",n[n.FIXED=14]="FIXED",n[n.SIN=15]="SIN",n[n.COS=16]="COS",n[n.TAN=17]="TAN",n[n.ATAN=18]="ATAN",n[n.PI=19]="PI",n[n.SQRT=20]="SQRT",n[n.EXP=21]="EXP",n[n.LN=22]="LN",n[n.LOG10=23]="LOG10",n[n.ABS=24]="ABS",n[n.INT=25]="INT",n[n.SIGN=26]="SIGN",n[n.ROUND=27]="ROUND",n[n.LOOKUP=28]="LOOKUP",n[n.INDEX=29]="INDEX",n[n.REPT=30]="REPT",n[n.MID=31]="MID",n[n.LEN=32]="LEN",n[n.VALUE=33]="VALUE",n[n.TRUE=34]="TRUE",n[n.FALSE=35]="FALSE",n[n.AND=36]="AND",n[n.OR=37]="OR",n[n.NOT=38]="NOT",n[n.MOD=39]="MOD",n[n.DCOUNT=40]="DCOUNT",n[n.DSUM=41]="DSUM",n[n.DAVERAGE=42]="DAVERAGE",n[n.DMIN=43]="DMIN",n[n.DMAX=44]="DMAX",n[n.DSTDEV=45]="DSTDEV",n[n.VAR=46]="VAR",n[n.DVAR=47]="DVAR",n[n.TEXT=48]="TEXT",n[n.LINEST=49]="LINEST",n[n.TREND=50]="TREND",n[n.LOGEST=51]="LOGEST",n[n.GROWTH=52]="GROWTH",n[n.GOTO=53]="GOTO",n[n.HALT=54]="HALT",n[n.RETURN=55]="RETURN",n[n.PV=56]="PV",n[n.FV=57]="FV",n[n.NPER=58]="NPER",n[n.PMT=59]="PMT",n[n.RATE=60]="RATE",n[n.MIRR=61]="MIRR",n[n.IRR=62]="IRR",n[n.RAND=63]="RAND",n[n.MATCH=64]="MATCH",n[n.DATE=65]="DATE",n[n.TIME=66]="TIME",n[n.DAY=67]="DAY",n[n.MONTH=68]="MONTH",n[n.YEAR=69]="YEAR",n[n.WEEKDAY=70]="WEEKDAY",n[n.HOUR=71]="HOUR",n[n.MINUTE=72]="MINUTE",n[n.SECOND=73]="SECOND",n[n.NOW=74]="NOW",n[n.AREAS=75]="AREAS",n[n.ROWS=76]="ROWS",n[n.COLUMNS=77]="COLUMNS",n[n.OFFSET=78]="OFFSET",n[n.ABSREF=79]="ABSREF",n[n.RELREF=80]="RELREF",n[n.ARGUMENT=81]="ARGUMENT",n[n.SEARCH=82]="SEARCH",n[n.TRANSPOSE=83]="TRANSPOSE",n[n.ERROR=84]="ERROR",n[n.STEP=85]="STEP",n[n.TYPE=86]="TYPE",n[n.ECHO=87]="ECHO",n[n.SET_NAME=88]="SET_NAME",n[n.CALLER=89]="CALLER",n[n.DEREF=90]="DEREF",n[n.WINDOWS=91]="WINDOWS",n[n.SERIES=92]="SERIES",n[n.DOCUMENTS=93]="DOCUMENTS",n[n.ACTIVE_CELL=94]="ACTIVE_CELL",n[n.SELECTION=95]="SELECTION",n[n.RESULT=96]="RESULT",n[n.ATAN2=97]="ATAN2",n[n.ASIN=98]="ASIN",n[n.ACOS=99]="ACOS",n[n.CHOOSE=100]="CHOOSE",n[n.HLOOKUP=101]="HLOOKUP",n[n.VLOOKUP=102]="VLOOKUP",n[n.LINKS=103]="LINKS",n[n.INPUT=104]="INPUT",n[n.ISREF=105]="ISREF",n[n.GET_FORMULA=106]="GET_FORMULA",n[n.GET_NAME=107]="GET_NAME",n[n.SET_VALUE=108]="SET_VALUE",n[n.LOG=109]="LOG",n[n.EXEC=110]="EXEC",n[n.CHAR=111]="CHAR",n[n.LOWER=112]="LOWER",n[n.UPPER=113]="UPPER",n[n.PROPER=114]="PROPER",n[n.LEFT=115]="LEFT",n[n.RIGHT=116]="RIGHT",n[n.EXACT=117]="EXACT",n[n.TRIM=118]="TRIM",n[n.REPLACE=119]="REPLACE",n[n.SUBSTITUTE=120]="SUBSTITUTE",n[n.CODE=121]="CODE",n[n.NAMES=122]="NAMES",n[n.DIRECTORY=123]="DIRECTORY",n[n.FIND=124]="FIND",n[n.CELL=125]="CELL",n[n.ISERR=126]="ISERR",n[n.ISTEXT=127]="ISTEXT",n[n.ISNUMBER=128]="ISNUMBER",n[n.ISBLANK=129]="ISBLANK",n[n.T=130]="T",n[n.N=131]="N",n[n.FOPEN=132]="FOPEN",n[n.FCLOSE=133]="FCLOSE",n[n.FSIZE=134]="FSIZE",n[n.FREADLN=135]="FREADLN",n[n.FREAD=136]="FREAD",n[n.FWRITELN=137]="FWRITELN",n[n.FWRITE=138]="FWRITE",n[n.FPOS=139]="FPOS",n[n.DATEVALUE=140]="DATEVALUE",n[n.TIMEVALUE=141]="TIMEVALUE",n[n.SLN=142]="SLN",n[n.SYD=143]="SYD",n[n.DDB=144]="DDB",n[n.GET_DEF=145]="GET_DEF",n[n.REFTEXT=146]="REFTEXT",n[n.TEXTREF=147]="TEXTREF",n[n.INDIRECT=148]="INDIRECT",n[n.REGISTER=149]="REGISTER",n[n.CALL=150]="CALL",n[n.ADD_BAR=151]="ADD_BAR",n[n.ADD_MENU=152]="ADD_MENU",n[n.ADD_COMMAND=153]="ADD_COMMAND",n[n.ENABLE_COMMAND=154]="ENABLE_COMMAND",n[n.CHECK_COMMAND=155]="CHECK_COMMAND",n[n.RENAME_COMMAND=156]="RENAME_COMMAND",n[n.SHOW_BAR=157]="SHOW_BAR",n[n.DELETE_MENU=158]="DELETE_MENU",n[n.DELETE_COMMAND=159]="DELETE_COMMAND",n[n.GET_CHART_ITEM=160]="GET_CHART_ITEM",n[n.DIALOG_BOX=161]="DIALOG_BOX",n[n.CLEAN=162]="CLEAN",n[n.MDETERM=163]="MDETERM",n[n.MINVERSE=164]="MINVERSE",n[n.MMULT=165]="MMULT",n[n.FILES=166]="FILES",n[n.IPMT=167]="IPMT",n[n.PPMT=168]="PPMT",n[n.COUNTA=169]="COUNTA",n[n.CANCEL_KEY=170]="CANCEL_KEY",n[n.FOR=171]="FOR",n[n.WHILE=172]="WHILE",n[n.BREAK=173]="BREAK",n[n.NEXT=174]="NEXT",n[n.INITIATE=175]="INITIATE",n[n.REQUEST=176]="REQUEST",n[n.POKE=177]="POKE",n[n.EXECUTE=178]="EXECUTE",n[n.TERMINATE=179]="TERMINATE",n[n.RESTART=180]="RESTART",n[n.HELP=181]="HELP",n[n.GET_BAR=182]="GET_BAR",n[n.PRODUCT=183]="PRODUCT",n[n.FACT=184]="FACT",n[n.GET_CELL=185]="GET_CELL",n[n.GET_WORKSPACE=186]="GET_WORKSPACE",n[n.GET_WINDOW=187]="GET_WINDOW",n[n.GET_DOCUMENT=188]="GET_DOCUMENT",n[n.DPRODUCT=189]="DPRODUCT",n[n.ISNONTEXT=190]="ISNONTEXT",n[n.GET_NOTE=191]="GET_NOTE",n[n.NOTE=192]="NOTE",n[n.STDEVP=193]="STDEVP",n[n.VARP=194]="VARP",n[n.DSTDEVP=195]="DSTDEVP",n[n.DVARP=196]="DVARP",n[n.TRUNC=197]="TRUNC",n[n.ISLOGICAL=198]="ISLOGICAL",n[n.DCOUNTA=199]="DCOUNTA",n[n.DELETE_BAR=200]="DELETE_BAR",n[n.UNREGISTER=201]="UNREGISTER",n[n.USDOLLAR=204]="USDOLLAR",n[n.FINDB=205]="FINDB",n[n.SEARCHB=206]="SEARCHB",n[n.REPLACEB=207]="REPLACEB",n[n.LEFTB=208]="LEFTB",n[n.RIGHTB=209]="RIGHTB",n[n.MIDB=210]="MIDB",n[n.LENB=211]="LENB",n[n.ROUNDUP=212]="ROUNDUP",n[n.ROUNDDOWN=213]="ROUNDDOWN",n[n.ASC=214]="ASC",n[n.DBCS=215]="DBCS",n[n.RANK=216]="RANK",n[n.ADDRESS=219]="ADDRESS",n[n.DAYS360=220]="DAYS360",n[n.TODAY=221]="TODAY",n[n.VDB=222]="VDB",n[n.ELSE=223]="ELSE",n[n.ELSE_IF=224]="ELSE_IF",n[n.END_IF=225]="END_IF",n[n.FOR_CELL=226]="FOR_CELL",n[n.MEDIAN=227]="MEDIAN",n[n.SUMPRODUCT=228]="SUMPRODUCT",n[n.SINH=229]="SINH",n[n.COSH=230]="COSH",n[n.TANH=231]="TANH",n[n.ASINH=232]="ASINH",n[n.ACOSH=233]="ACOSH",n[n.ATANH=234]="ATANH",n[n.DGET=235]="DGET",n[n.CREATE_OBJECT=236]="CREATE_OBJECT",n[n.VOLATILE=237]="VOLATILE",n[n.LAST_ERROR=238]="LAST_ERROR",n[n.CUSTOM_UNDO=239]="CUSTOM_UNDO",n[n.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",n[n.FORMULA_CONVERT=241]="FORMULA_CONVERT",n[n.GET_LINK_INFO=242]="GET_LINK_INFO",n[n.TEXT_BOX=243]="TEXT_BOX",n[n.INFO=244]="INFO",n[n.GROUP=245]="GROUP",n[n.GET_OBJECT=246]="GET_OBJECT",n[n.DB=247]="DB",n[n.PAUSE=248]="PAUSE",n[n.RESUME=251]="RESUME",n[n.FREQUENCY=252]="FREQUENCY",n[n.ADD_TOOLBAR=253]="ADD_TOOLBAR",n[n.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",n[n._UDF=255]="_UDF",n[n.RESET_TOOLBAR=256]="RESET_TOOLBAR",n[n.EVALUATE=257]="EVALUATE",n[n.GET_TOOLBAR=258]="GET_TOOLBAR",n[n.GET_TOOL=259]="GET_TOOL",n[n.SPELLING_CHECK=260]="SPELLING_CHECK",n[n.ERROR_TYPE=261]="ERROR_TYPE",n[n.APP_TITLE=262]="APP_TITLE",n[n.WINDOW_TITLE=263]="WINDOW_TITLE",n[n.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",n[n.ENABLE_TOOL=265]="ENABLE_TOOL",n[n.PRESS_TOOL=266]="PRESS_TOOL",n[n.REGISTER_ID=267]="REGISTER_ID",n[n.GET_PROJECT=268]="GET_PROJECT",n[n.AVEDEV=269]="AVEDEV",n[n.BETADIST=270]="BETADIST",n[n.GAMMALN=271]="GAMMALN",n[n.BETAINV=272]="BETAINV",n[n.BINOMDIST=273]="BINOMDIST",n[n.CHIDIST=274]="CHIDIST",n[n.CHIINV=275]="CHIINV",n[n.COMBIN=276]="COMBIN",n[n.CONFIDENCE=277]="CONFIDENCE",n[n.CRITBINOM=278]="CRITBINOM",n[n.EVEN=279]="EVEN",n[n.EXPONDIST=280]="EXPONDIST",n[n.FDIST=281]="FDIST",n[n.FINV=282]="FINV",n[n.FISHER=283]="FISHER",n[n.FISHERINV=284]="FISHERINV",n[n.FLOOR=285]="FLOOR",n[n.GAMMADIST=286]="GAMMADIST",n[n.GAMMAINV=287]="GAMMAINV",n[n.CEILING=288]="CEILING",n[n.HYPGEOMDIST=289]="HYPGEOMDIST",n[n.LOGNORMDIST=290]="LOGNORMDIST",n[n.LOGINV=291]="LOGINV",n[n.NEGBINOMDIST=292]="NEGBINOMDIST",n[n.NORMDIST=293]="NORMDIST",n[n.NORMSDIST=294]="NORMSDIST",n[n.NORMINV=295]="NORMINV",n[n.NORMSINV=296]="NORMSINV",n[n.STANDARDIZE=297]="STANDARDIZE",n[n.ODD=298]="ODD",n[n.PERMUT=299]="PERMUT",n[n.POISSON=300]="POISSON",n[n.TDIST=301]="TDIST",n[n.WEIBULL=302]="WEIBULL",n[n.SUMXMY2=303]="SUMXMY2",n[n.SUMX2MY2=304]="SUMX2MY2",n[n.SUMX2PY2=305]="SUMX2PY2",n[n.CHITEST=306]="CHITEST",n[n.CORREL=307]="CORREL",n[n.COVAR=308]="COVAR",n[n.FORECAST=309]="FORECAST",n[n.FTEST=310]="FTEST",n[n.INTERCEPT=311]="INTERCEPT",n[n.PEARSON=312]="PEARSON",n[n.RSQ=313]="RSQ",n[n.STEYX=314]="STEYX",n[n.SLOPE=315]="SLOPE",n[n.TTEST=316]="TTEST",n[n.PROB=317]="PROB",n[n.DEVSQ=318]="DEVSQ",n[n.GEOMEAN=319]="GEOMEAN",n[n.HARMEAN=320]="HARMEAN",n[n.SUMSQ=321]="SUMSQ",n[n.KURT=322]="KURT",n[n.SKEW=323]="SKEW",n[n.ZTEST=324]="ZTEST",n[n.LARGE=325]="LARGE",n[n.SMALL=326]="SMALL",n[n.QUARTILE=327]="QUARTILE",n[n.PERCENTILE=328]="PERCENTILE",n[n.PERCENTRANK=329]="PERCENTRANK",n[n.MODE=330]="MODE",n[n.TRIMMEAN=331]="TRIMMEAN",n[n.TINV=332]="TINV",n[n.MOVIE_COMMAND=334]="MOVIE_COMMAND",n[n.GET_MOVIE=335]="GET_MOVIE",n[n.CONCATENATE=336]="CONCATENATE",n[n.POWER=337]="POWER",n[n.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",n[n.GET_VIEW=339]="GET_VIEW",n[n.GET_FIELD=340]="GET_FIELD",n[n.GET_ITEM=341]="GET_ITEM",n[n.RADIANS=342]="RADIANS",n[n.DEGREES=343]="DEGREES",n[n.SUBTOTAL=344]="SUBTOTAL",n[n.SUMIF=345]="SUMIF",n[n.COUNTIF=346]="COUNTIF",n[n.COUNTBLANK=347]="COUNTBLANK",n[n.SCENARIO_GET=348]="SCENARIO_GET",n[n.OPTIONS_LISTS=349]="OPTIONS_LISTS",n[n.ISPMT=350]="ISPMT",n[n.DATEDIF=351]="DATEDIF",n[n.DATESTRING=352]="DATESTRING",n[n.NUMBERSTRING=353]="NUMBERSTRING",n[n.ROMAN=354]="ROMAN",n[n.OPENDIALOG=355]="OPENDIALOG",n[n.SAVEDIALOG=356]="SAVEDIALOG",n[n.VIEW_GET=357]="VIEW_GET",n[n.GETPIVOTDATA=358]="GETPIVOTDATA",n[n.HYPERLINK=359]="HYPERLINK",n[n.FURIGANA=360]="FURIGANA",n[n.AVERAGEA=361]="AVERAGEA",n[n.MAXA=362]="MAXA",n[n.MINA=363]="MINA",n[n.STDEVPA=364]="STDEVPA",n[n.VARPA=365]="VARPA",n[n.STDEVA=366]="STDEVA",n[n.VARA=367]="VARA",n[n.BAHTTEXT=368]="BAHTTEXT",n[n.THAIDOW=369]="THAIDOW",n[n.THAIDIGIT=370]="THAIDIGIT",n[n.THAIMOY=371]="THAIMOY",n[n.THAINUMSOUND=372]="THAINUMSOUND",n[n.THAINUMSTRING=373]="THAINUMSTRING",n[n.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",n[n.ISTHAIDIGIT=375]="ISTHAIDIGIT",n[n.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",n[n.ROUNDBAHTUP=377]="ROUNDBAHTUP",n[n.THAIYEAR=378]="THAIYEAR",n[n.RTD=379]="RTD",n[n.CUBEVALUE=380]="CUBEVALUE",n[n.CUBEMEMBER=381]="CUBEMEMBER",n[n.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",n[n.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",n[n.HEX2BIN=384]="HEX2BIN",n[n.HEX2DEC=385]="HEX2DEC",n[n.HEX2OCT=386]="HEX2OCT",n[n.DEC2BIN=387]="DEC2BIN",n[n.DEC2HEX=388]="DEC2HEX",n[n.DEC2OCT=389]="DEC2OCT",n[n.OCT2BIN=390]="OCT2BIN",n[n.OCT2HEX=391]="OCT2HEX",n[n.OCT2DEC=392]="OCT2DEC",n[n.BIN2DEC=393]="BIN2DEC",n[n.BIN2OCT=394]="BIN2OCT",n[n.BIN2HEX=395]="BIN2HEX",n[n.IMSUB=396]="IMSUB",n[n.IMDIV=397]="IMDIV",n[n.IMPOWER=398]="IMPOWER",n[n.IMABS=399]="IMABS",n[n.IMSQRT=400]="IMSQRT",n[n.IMLN=401]="IMLN",n[n.IMLOG2=402]="IMLOG2",n[n.IMLOG10=403]="IMLOG10",n[n.IMSIN=404]="IMSIN",n[n.IMCOS=405]="IMCOS",n[n.IMEXP=406]="IMEXP",n[n.IMARGUMENT=407]="IMARGUMENT",n[n.IMCONJUGATE=408]="IMCONJUGATE",n[n.IMAGINARY=409]="IMAGINARY",n[n.IMREAL=410]="IMREAL",n[n.COMPLEX=411]="COMPLEX",n[n.IMSUM=412]="IMSUM",n[n.IMPRODUCT=413]="IMPRODUCT",n[n.SERIESSUM=414]="SERIESSUM",n[n.FACTDOUBLE=415]="FACTDOUBLE",n[n.SQRTPI=416]="SQRTPI",n[n.QUOTIENT=417]="QUOTIENT",n[n.DELTA=418]="DELTA",n[n.GESTEP=419]="GESTEP",n[n.ISEVEN=420]="ISEVEN",n[n.ISODD=421]="ISODD",n[n.MROUND=422]="MROUND",n[n.ERF=423]="ERF",n[n.ERFC=424]="ERFC",n[n.BESSELJ=425]="BESSELJ",n[n.BESSELK=426]="BESSELK",n[n.BESSELY=427]="BESSELY",n[n.BESSELI=428]="BESSELI",n[n.XIRR=429]="XIRR",n[n.XNPV=430]="XNPV",n[n.PRICEMAT=431]="PRICEMAT",n[n.YIELDMAT=432]="YIELDMAT",n[n.INTRATE=433]="INTRATE",n[n.RECEIVED=434]="RECEIVED",n[n.DISC=435]="DISC",n[n.PRICEDISC=436]="PRICEDISC",n[n.YIELDDISC=437]="YIELDDISC",n[n.TBILLEQ=438]="TBILLEQ",n[n.TBILLPRICE=439]="TBILLPRICE",n[n.TBILLYIELD=440]="TBILLYIELD",n[n.PRICE=441]="PRICE",n[n.YIELD=442]="YIELD",n[n.DOLLARDE=443]="DOLLARDE",n[n.DOLLARFR=444]="DOLLARFR",n[n.NOMINAL=445]="NOMINAL",n[n.EFFECT=446]="EFFECT",n[n.CUMPRINC=447]="CUMPRINC",n[n.CUMIPMT=448]="CUMIPMT",n[n.EDATE=449]="EDATE",n[n.EOMONTH=450]="EOMONTH",n[n.YEARFRAC=451]="YEARFRAC",n[n.COUPDAYBS=452]="COUPDAYBS",n[n.COUPDAYS=453]="COUPDAYS",n[n.COUPDAYSNC=454]="COUPDAYSNC",n[n.COUPNCD=455]="COUPNCD",n[n.COUPNUM=456]="COUPNUM",n[n.COUPPCD=457]="COUPPCD",n[n.DURATION=458]="DURATION",n[n.MDURATION=459]="MDURATION",n[n.ODDLPRICE=460]="ODDLPRICE",n[n.ODDLYIELD=461]="ODDLYIELD",n[n.ODDFPRICE=462]="ODDFPRICE",n[n.ODDFYIELD=463]="ODDFYIELD",n[n.RANDBETWEEN=464]="RANDBETWEEN",n[n.WEEKNUM=465]="WEEKNUM",n[n.AMORDEGRC=466]="AMORDEGRC",n[n.AMORLINC=467]="AMORLINC",n[n.CONVERT=468]="CONVERT",n[n.ACCRINT=469]="ACCRINT",n[n.ACCRINTM=470]="ACCRINTM",n[n.WORKDAY=471]="WORKDAY",n[n.NETWORKDAYS=472]="NETWORKDAYS",n[n.GCD=473]="GCD",n[n.MULTINOMIAL=474]="MULTINOMIAL",n[n.LCM=475]="LCM",n[n.FVSCHEDULE=476]="FVSCHEDULE",n[n.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",n[n.CUBESET=478]="CUBESET",n[n.CUBESETCOUNT=479]="CUBESETCOUNT",n[n.IFERROR=480]="IFERROR",n[n.COUNTIFS=481]="COUNTIFS",n[n.SUMIFS=482]="SUMIFS",n[n.AVERAGEIF=483]="AVERAGEIF",n[n.AVERAGEIFS=484]="AVERAGEIFS",n[n.AGGREGATE=485]="AGGREGATE",n[n.BINOM_DIST=486]="BINOM_DIST",n[n.BINOM_INV=487]="BINOM_INV",n[n.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",n[n.CONFIDENCE_T=489]="CONFIDENCE_T",n[n.CHISQ_TEST=490]="CHISQ_TEST",n[n.F_TEST=491]="F_TEST",n[n.COVARIANCE_P=492]="COVARIANCE_P",n[n.COVARIANCE_S=493]="COVARIANCE_S",n[n.EXPON_DIST=494]="EXPON_DIST",n[n.GAMMA_DIST=495]="GAMMA_DIST",n[n.GAMMA_INV=496]="GAMMA_INV",n[n.MODE_MULT=497]="MODE_MULT",n[n.MODE_SNGL=498]="MODE_SNGL",n[n.NORM_DIST=499]="NORM_DIST",n[n.NORM_INV=500]="NORM_INV",n[n.PERCENTILE_EXC=501]="PERCENTILE_EXC",n[n.PERCENTILE_INC=502]="PERCENTILE_INC",n[n.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",n[n.PERCENTRANK_INC=504]="PERCENTRANK_INC",n[n.POISSON_DIST=505]="POISSON_DIST",n[n.QUARTILE_EXC=506]="QUARTILE_EXC",n[n.QUARTILE_INC=507]="QUARTILE_INC",n[n.RANK_AVG=508]="RANK_AVG",n[n.RANK_EQ=509]="RANK_EQ",n[n.STDEV_S=510]="STDEV_S",n[n.STDEV_P=511]="STDEV_P",n[n.T_DIST=512]="T_DIST",n[n.T_DIST_2T=513]="T_DIST_2T",n[n.T_DIST_RT=514]="T_DIST_RT",n[n.T_INV=515]="T_INV",n[n.T_INV_2T=516]="T_INV_2T",n[n.VAR_S=517]="VAR_S",n[n.VAR_P=518]="VAR_P",n[n.WEIBULL_DIST=519]="WEIBULL_DIST",n[n.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",n[n.WORKDAY_INTL=521]="WORKDAY_INTL",n[n.ECMA_CEILING=522]="ECMA_CEILING",n[n.ISO_CEILING=523]="ISO_CEILING",n[n.BETA_DIST=525]="BETA_DIST",n[n.BETA_INV=526]="BETA_INV",n[n.CHISQ_DIST=527]="CHISQ_DIST",n[n.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",n[n.CHISQ_INV=529]="CHISQ_INV",n[n.CHISQ_INV_RT=530]="CHISQ_INV_RT",n[n.F_DIST=531]="F_DIST",n[n.F_DIST_RT=532]="F_DIST_RT",n[n.F_INV=533]="F_INV",n[n.F_INV_RT=534]="F_INV_RT",n[n.HYPGEOM_DIST=535]="HYPGEOM_DIST",n[n.LOGNORM_DIST=536]="LOGNORM_DIST",n[n.LOGNORM_INV=537]="LOGNORM_INV",n[n.NEGBINOM_DIST=538]="NEGBINOM_DIST",n[n.NORM_S_DIST=539]="NORM_S_DIST",n[n.NORM_S_INV=540]="NORM_S_INV",n[n.T_TEST=541]="T_TEST",n[n.Z_TEST=542]="Z_TEST",n[n.ERF_PRECISE=543]="ERF_PRECISE",n[n.ERFC_PRECISE=544]="ERFC_PRECISE",n[n.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",n[n.CEILING_PRECISE=546]="CEILING_PRECISE",n[n.FLOOR_PRECISE=547]="FLOOR_PRECISE",n[n.ACOT=548]="ACOT",n[n.ACOTH=549]="ACOTH",n[n.COT=550]="COT",n[n.COTH=551]="COTH",n[n.CSC=552]="CSC",n[n.CSCH=553]="CSCH",n[n.SEC=554]="SEC",n[n.SECH=555]="SECH",n[n.IMTAN=556]="IMTAN",n[n.IMCOT=557]="IMCOT",n[n.IMCSC=558]="IMCSC",n[n.IMCSCH=559]="IMCSCH",n[n.IMSEC=560]="IMSEC",n[n.IMSECH=561]="IMSECH",n[n.BITAND=562]="BITAND",n[n.BITOR=563]="BITOR",n[n.BITXOR=564]="BITXOR",n[n.BITLSHIFT=565]="BITLSHIFT",n[n.BITRSHIFT=566]="BITRSHIFT",n[n.PERMUTATIONA=567]="PERMUTATIONA",n[n.COMBINA=568]="COMBINA",n[n.XOR=569]="XOR",n[n.PDURATION=570]="PDURATION",n[n.BASE=571]="BASE",n[n.DECIMAL=572]="DECIMAL",n[n.DAYS=573]="DAYS",n[n.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",n[n.GAMMA=575]="GAMMA",n[n.SKEW_P=576]="SKEW_P",n[n.GAUSS=577]="GAUSS",n[n.PHI=578]="PHI",n[n.RRI=579]="RRI",n[n.UNICHAR=580]="UNICHAR",n[n.UNICODE=581]="UNICODE",n[n.MUNIT=582]="MUNIT",n[n.ARABIC=583]="ARABIC",n[n.ISOWEEKNUM=584]="ISOWEEKNUM",n[n.NUMBERVALUE=585]="NUMBERVALUE",n[n.SHEET=586]="SHEET",n[n.SHEETS=587]="SHEETS",n[n.FORMULATEXT=588]="FORMULATEXT",n[n.ISFORMULA=589]="ISFORMULA",n[n.IFNA=590]="IFNA",n[n.CEILING_MATH=591]="CEILING_MATH",n[n.FLOOR_MATH=592]="FLOOR_MATH",n[n.IMSINH=593]="IMSINH",n[n.IMCOSH=594]="IMCOSH",n[n.FILTERXML=595]="FILTERXML",n[n.WEBSERVICE=596]="WEBSERVICE",n[n.ENCODEURL=597]="ENCODEURL",n[n.FORECAST_ETS=598]="FORECAST_ETS",n[n.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",n[n.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",n[n.FORECAST_LINEAR=601]="FORECAST_LINEAR",n[n.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",n[n.MAXIFS=603]="MAXIFS",n[n.MINIFS=604]="MINIFS",n[n.TEXTJOIN=605]="TEXTJOIN",n[n.CONCAT=606]="CONCAT",n[n.IFS=607]="IFS",n[n.SWITCH=608]="SWITCH",n[n.SINGLE=609]="SINGLE",n[n.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",n[n.ANCHORARRAY=611]="ANCHORARRAY",n[n._FV=612]="_FV",n[n.FIELDVALUE=613]="FIELDVALUE",n[n.FILTER=614]="FILTER",n[n.SORT=615]="SORT",n[n.UNIQUE=616]="UNIQUE",n[n.RICHSEARCH=617]="RICHSEARCH",n[n.LARGEPROPERTY=618]="LARGEPROPERTY",n[n.SMALLPROPERTY=619]="SMALLPROPERTY",n[n.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",n[n.FINDN=621]="FINDN",n[n.TEXTSLICE=622]="TEXTSLICE",n[n.TEXTBEFORE=623]="TEXTBEFORE",n[n.TEXTAFTER=624]="TEXTAFTER",n[n.TEXTSPLIT=625]="TEXTSPLIT",n[n._SORT=626]="_SORT",n[n._ONEDARRAY=627]="_ONEDARRAY",n[n.XMATCH=628]="XMATCH",n[n.XLOOKUP=629]="XLOOKUP",n[n.SORTBY=630]="SORTBY",n[n.RANDARRAY=631]="RANDARRAY",n[n.SEQUENCE=632]="SEQUENCE",n[n.STOCKHISTORY=633]="STOCKHISTORY",n[n.WRAPROWS=634]="WRAPROWS",n[n.VSTACK=635]="VSTACK",n[n.HSTACK=636]="HSTACK",n[n.CHOOSEROWS=637]="CHOOSEROWS",n[n.CHOOSECOLS=638]="CHOOSECOLS",n[n.LET=639]="LET",n[n.LAMBDA=640]="LAMBDA",n[n.MAKEARRAY=641]="MAKEARRAY",n[n.APPLY=642]="APPLY",n[n.ISLAMBDA=643]="ISLAMBDA",n[n.ARITY=644]="ARITY",n[n.RECURSE=645]="RECURSE",n[n.VALUETOTEXT=647]="VALUETOTEXT",n[n.ARRAYTOTEXT=648]="ARRAYTOTEXT",n[n.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",n[n.TOCOL=650]="TOCOL",n[n.TOROW=651]="TOROW",n[n.WRAPCOLS=652]="WRAPCOLS",n[n.MAP=653]="MAP",n[n.REDUCE=654]="REDUCE",n[n.SCAN=655]="SCAN",n[n.BYROW=656]="BYROW",n[n.BYCOL=657]="BYCOL",n[n.ISOMITTED=658]="ISOMITTED",n[n.EXPAND=659]="EXPAND",n[n.TAKE=660]="TAKE",n[n.DROP=661]="DROP",n[n.PY=662]="PY",n[n.IMAGE=664]="IMAGE",n[n.UNIT=665]="UNIT",n[n.GROUPBY=666]="GROUPBY",n[n.PIVOTBY=667]="PIVOTBY",n[n.PYO=668]="PYO",n[n.TESTFUNCTIONBEGIN=669]="TESTFUNCTIONBEGIN",n[n.GRF=670]="GRF",n[n.RICHERROR=671]="RICHERROR",n[n.COUNTER=672]="COUNTER",n[n.BROKENRECORD=673]="BROKENRECORD",n[n.STREAM=674]="STREAM",n[n.GETRICHERRORS=675]="GETRICHERRORS",n[n.DBGSTAT=676]="DBGSTAT",n[n.RICHNUMBER=677]="RICHNUMBER",n[n.RICHERNUMBER=678]="RICHERNUMBER",n[n.DBGWRITE=679]="DBGWRITE",n[n.TEST=680]="TEST",n[n.AAC=681]="AAC",n[n.AWC=682]="AWC",n[n.WEBADDRESS_IMAGETEST=683]="WEBADDRESS_IMAGETEST",n[n.PARSEDEXPRESSION=684]="PARSEDEXPRESSION",n[n.AGE_CONTACTTEST=685]="AGE_CONTACTTEST",n[n.FIRSTNAME_CONTACTTEST=686]="FIRSTNAME_CONTACTTEST",n[n.FULLNAME_CONTACTTEST=687]="FULLNAME_CONTACTTEST",n[n.LASTNAME_CONTACTTEST=688]="LASTNAME_CONTACTTEST",n[n.TRANSLATENAME_CONTACTTEST=689]="TRANSLATENAME_CONTACTTEST",n[n.ARRAYVALUE=690]="ARRAYVALUE",n[n.RECORD=691]="RECORD",n[n.STR_PYTHON=692]="STR_PYTHON",n[n.TYPE_PYTHON=693]="TYPE_PYTHON",n[n.LOCALIMAGE=694]="LOCALIMAGE",n[n.DISPLAYSTRING_GENERALTEST=695]="DISPLAYSTRING_GENERALTEST",n[n.LETREC=750]="LETREC",n[n.NESTEDRECORD=751]="NESTEDRECORD",t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[683,"WEBADDRESS_IMAGETEST"],[685,"AGE_CONTACTTEST"],[686,"FIRSTNAME_CONTACTTEST"],[687,"FULLNAME_CONTACTTEST"],[688,"LASTNAME_CONTACTTEST"],[689,"TRANSLATENAME_CONTACTTEST"],[692,"STR_PYTHON"],[693,"TYPE_PYTHON"],[695,"DISPLAYSTRING_GENERALTEST"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]);var o=[];t.worksheetFuncTypes=[[1,255,o,[57],o,1,0,16],[1,3,[36,831,831],o,o,823,0,0],[1,1,[15],o,o,4,0,0],[1,1,[15],o,o,4,0,0],[1,255,o,[305],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[0,1,[16],o,o,33,0,0],[0,1,[16],o,o,33,0,0],[0,0,o,o,o,3,0,16],[2,255,[1],[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,2,[1,1],o,o,2,0,0],[1,3,[1,65,4],o,o,2,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,3,[263,48,48],o,o,263,0,0],[2,4,[48,1,1,1],o,o,311,0,0],[2,2,[2,1],o,o,2,0,0],[3,3,[2,1,1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[7],o,o,1,0,0],[0,0,o,o,o,4,0,16],[0,0,o,o,o,4,0,16],[1,255,o,[52],o,4,0,16],[1,255,o,[52],o,4,0,16],[1,1,[4],o,o,4,0,16],[2,2,[1,1],o,o,1,0,0],[3,3,[16,83,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,255,o,[49],o,1,0,16],[3,3,[16,19,18],o,o,1,0,0],[2,2,[263,2],o,o,2,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,1,[16],o,o,512,0,2],[0,1,[4],o,o,512,0,2],[0,1,[575],o,o,512,0,2],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,6,[1,1,1,1,1,1],o,o,1,0,0],[3,3,[48,1,1],o,o,1,0,16],[1,2,[48,1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[2,3,[263,305,17],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[1,1,[16],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[3,5,[16,65,65,65,65],o,o,16,16383,0],[2,2,[2,16],o,o,16,0,2],[2,2,[16,16],o,o,2,0,2],[0,3,[66,81,16],o,o,4,0,2],[2,3,[2,2,1],o,o,1,0,0],[1,1,[39],o,o,32,0,0],[0,2,[1,24],o,o,4,0,2],[0,0,o,o,o,4,0,2],[1,1,[303],o,o,1,0,0],[0,1,[4],o,o,4,0,2],[1,2,[2,63],o,o,4,0,2],[0,0,o,o,o,50,0,2],[1,1,[16],o,o,47,0,2],[0,2,[65,66],o,o,32,0,2],[4,5,[87,117,117,1,117],o,o,4,0,0],[0,2,[1,66],o,o,32,0,2],[0,0,o,o,o,16,0,2],[0,0,o,o,o,16,0,2],[0,1,[1],o,o,4,0,2],[2,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[33],[831],o,823,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[0,2,[66,65],o,o,32,0,2],[1,7,[2,65,66,67,65,65,2],o,o,575,0,2],[1,1,[63],o,o,4,0,0],[1,1,[18],o,o,2,0,2],[1,2,[2,4],o,o,6,0,2],[2,2,[16,47],o,o,4,0,2],[1,2,[1,1],o,o,1,0,0],[1,4,[2,1,4,4],o,o,7,0,2],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[2,2,[258,258],o,o,4,0,0],[1,1,[2],o,o,2,0,0],[4,4,[2,1,1,2],o,o,2,0,0],[3,4,[2,2,2,2],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[0,3,[66,65,66],o,o,32,0,2],[0,1,[2],o,o,2,0,2],[2,3,[2,2,1],o,o,1,0,0],[1,2,[2,16],o,o,303,16383,0],[1,1,[15],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[23],o,o,2,0,0],[1,1,[23],o,o,1,0,0],[1,2,[2,1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,2,0,2],[2,2,[1,1],o,o,2,0,2],[2,2,[1,2],o,o,1,0,2],[2,2,[1,2],o,o,1,0,2],[1,2,[1,1],o,o,1,0,2],[1,1,[3],o,o,1,0,0],[1,1,[3],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[4,5,[1,1,1,1,1],o,o,1,0,0],[1,3,[2,66,65],o,o,2,0,2],[1,2,[16,4],o,o,2,0,2],[1,2,[2,4],o,o,16,0,2],[1,2,[2,4],o,o,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],o,3,0,2],[1,255,[3],[127],o,575,0,2],[0,1,[3],o,o,1,0,2],[2,4,[3,115,83,3],o,o,1,0,2],[3,5,[3,83,115,83,3],o,o,1,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,3,3],o,o,4,0,2],[0,1,[3],o,o,4,0,2],[2,3,[3,3,3],o,o,4,0,2],[3,4,[3,3,3,3],o,o,4,0,2],[1,3,[1,67,66],o,o,1,0,2],[1,1,[52],o,o,36,0,2],[1,1,[2],o,o,2,0,0],[1,1,[32],o,o,1,0,0],[1,1,[32],o,o,32,0,0],[2,2,[32,32],o,o,32,0,0],[0,2,[2,2],o,o,32,0,2],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[1,255,o,[121],o,1,0,16],[0,2,[1,16],o,o,4,0,2],[3,4,[2,1,1,1],o,o,512,0,2],[1,1,[4],o,o,512,0,2],[0,0,o,o,o,512,0,2],[0,0,o,o,o,512,0,2],[2,2,[2,2],o,o,1,0,2],[2,2,[1,2],o,o,32,0,2],[3,3,[1,18,18],o,o,4,0,2],[2,2,[1,2],o,o,4,0,2],[1,1,[1],o,o,4,0,2],[0,1,[1],o,o,512,0,2],[0,1,[2],o,o,4,0,2],[0,4,[3,3,3,3],o,o,3,0,2],[1,255,o,[113],o,1,0,16],[1,1,[1],o,o,1,0,0],[1,2,[1,16],o,o,47,0,2],[1,1,[1],o,o,47,0,2],[1,2,[1,2],o,o,47,0,2],[1,2,[1,2],o,o,63,0,2],[3,3,[16,19,18],o,o,1,0,0],[1,1,[143],o,o,4,0,0],[0,3,[82,65,65],o,o,2,0,2],[0,4,[66,82,17,17],o,o,1,0,2],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[143],o,o,4,0,0],[3,3,[16,83,18],o,o,1,0,0],[1,1,[3],o,o,4,0,2],[1,1,[3],o,o,4,0,2],void 0,void 0,[1,2,[1,1],o,o,2,0,32],[2,3,[2,2,1],o,o,1,0,32],[2,3,[2,2,1],o,o,1,0,32],[4,4,[2,1,1,2],o,o,2,0,32],[1,2,[2,9],o,o,2,0,32],[1,2,[2,9],o,o,2,0,32],[3,3,[2,1,1],o,o,2,0,32],[1,1,[2],o,o,1,0,32],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,1,[2],o,o,2,0,32],[1,1,[2],o,o,2,0,32],[2,3,[1,16,4],o,o,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],o,o,2,0,0],[2,3,[1,1,4],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[5,7,[1,1,1,1,1,1,4],o,o,1,0,0],[0,0,o,o,o,512,0,2],[1,1,[12],o,o,512,0,2],[0,0,o,o,o,512,0,2],[1,3,[2,82,84],o,o,512,0,2],[1,255,o,[49],o,1,0,16],[1,255,o,[32],o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[16,19,18],o,o,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],o,o,2,0,2],[0,1,[4],o,o,4,0,2],[0,0,o,o,o,16,0,2],[0,2,[2,2],o,o,4,0,2],[0,3,[2,2,2],o,o,4,0,2],[2,5,[2,23,23,23,23],o,o,2,0,2],[2,4,[2,1,1,2],o,o,1,0,2],[1,4,[2,66,65,65],o,o,1,0,2],[1,1,[2],o,o,3,16383,0],[0,0,o,o,o,2,0,2],[1,5,[1,2,1,1,1],o,o,47,0,2],[4,5,[1,1,1,1,1],o,o,1,0,0],[0,1,[4],o,o,512,0,2],void 0,void 0,[0,1,[1],o,o,512,0,2],[2,2,[48,48],o,o,32,0,16],[0,2,[66,96],o,o,2,0,2],[1,1,[2],o,o,4,0,2],[1,255,[17],[127],o,575,0,32],[1,1,[3],o,o,4,0,2],[1,1,[2],o,o,63,0,2],[1,2,[1,3],o,o,47,0,2],[1,3,[1,3,1],o,o,47,0,2],[1,3,[2,66,4],o,o,4,0,2],[1,1,[15],o,o,1,0,0],[0,1,[2],o,o,4,0,2],[0,1,[2],o,o,4,0,2],[0,2,[99,66],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[2,3,[2,3,66],o,o,1,0,2],[1,2,[1,2],o,o,35,0,2],[1,255,o,[49],o,1,0,16],[3,5,[1,1,1,65,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[3,4,[32,32,1,65],o,o,1,0,0],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[2,3,[49,1,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[1,255,o,[32],o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[1,1],o,o,1,0,0],void 0,[3,4,[2,1,1,1],o,o,1,0,34],[2,3,[2,1,1],o,o,1,0,34],[1,255,o,[2],o,2,0,0],[2,2,[1,1],o,o,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],o,o,2,0,2],[1,2,[1,2],o,o,35,0,2],[1,3,[1,66,2],o,o,35,0,2],[1,4,[1,66,66,2],o,o,7,0,2],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[1],[16],o,1,0,0],[2,3,[16,15,16],o,o,1,0,0],[2,2,[16,15],o,o,1,0,0],[1,1,[16],o,o,1,0,0],[1,2,[1,2],o,o,19,0,2],[1,1,[33],o,o,33,0,2],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,2],o,o,1,0,32],[1,1,[1],o,o,2,0,32],[2,2,[1,1],o,o,2,0,32],[1,2,[1,5],o,o,2,0,0],[0,4,[66,66,66,65],o,o,6,0,2],[0,5,[66,66,66,66,65],o,o,6,0,2],[1,2,[1,2],o,o,19,0,2],[2,255,[18,18],[2,79],o,15,0,0],[1,2,[2,39],o,o,39,0,0],[1,1,[16],o,o,2,0,32],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,1,[1],o,o,2,0,0],[1,1,[1],o,o,2,0,32],[1,1,[3],o,o,2,0,32],[1,1,[1],o,o,2,0,32],[1,1,[1],o,o,2,0,32],[1,1,[1],o,o,2,0,32],[1,1,[2],o,o,1,0,32],[1,1,[2],o,o,4,0,32],[1,1,[1],o,o,1,0,32],[1,1,[1],o,o,1,0,32],[1,1,[1],o,o,1,0,32],[3,255,o,[2],o,2,0,0],[1,255,[2],[50],o,15,0,0],[2,3,[2,50,2],o,o,10,0,0],[3,3,[2,2,2],o,o,15,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[4,4,[95,95,95,127],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[127,127,95],o,o,9,0,0],[3,3,[95,127,127],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,16383,0],[1,2,[95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,32],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[2,2,[95,127],o,o,9,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[2,5,[2,50,2,1,2],o,o,10,0,0],[1,1,[2],o,o,9,0,0],[2,2,[47,575],o,o,303,0,0],[2,255,o,[16,15],o,1,0,0],[3,255,[16],[16,15],o,1,0,0],[2,3,[16,15,16],o,o,1,0,0],[3,255,[16],[16,15],o,1,0,0],[3,254,[1,1,48,17],[16],o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,254,o,[32],o,32,0,16],[1,254,o,[32],o,1,0,16],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[3,3,[1,1,4],o,o,1,0,0],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[1,16,4],o,o,1,0,16],[2,3,[1,16,4],o,o,1,0,16],[1,254,o,[49],o,1,0,16],[1,254,o,[49],o,1,0,16],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[49],o,1,0,16],[1,254,o,[49],o,1,0,16],[4,4,[1,1,1,4],o,o,1,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,2,[1,1],o,o,1,0,32],[1,2,[1,65],o,o,1,0,32],void 0,[4,6,[1,1,1,4,65,65],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[5,5,[1,1,1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[2,3,[49,1,1],o,o,1,0,16],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,65],o,o,1,0,32],[1,2,[1,65],o,o,1,0,32],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[52],o,4,0,16],[3,3,[1,1,1],o,o,1,0,0],[2,3,[1,1,65],o,o,2,0,0],[2,2,[2,1],o,o,1,0,0],[2,2,[3,3],o,o,1,0,0],[3,4,[1,1,1,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,254,o,[49],o,1,0,16],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,32,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,3,[2,66,66],o,o,1,0,0],[0,1,[50],o,o,1,16383,16],[0,1,[48],o,o,1,16383,16],[1,1,[16],o,o,2,16383,0],[1,1,[16],o,o,4,0,0],[2,2,[47,575],o,o,303,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[2,2],o,o,47,0,0],[1,1,[2],o,o,10,0,0],[1,1,[2],o,o,10,0,0],[3,6,[1,48,48,65,65,65],o,o,1,0,0],[3,7,[1,48,48,65,65,65,65],o,o,1,0,0],[2,4,[48,48,65,65],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[3,6,[48,48,1,65,65,65],o,o,1,0,0],[3,254,[16],[16,15],o,1,0,0],[3,254,[16],[16,15],o,1,0,0],[3,254,[114,68],[114],o,2,0,16],[1,254,o,[114],o,2,0,16],[2,254,o,[44,575],o,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],o,o,1503,0,53],[2,254,o,[113,113],o,1,0,17],[1,1,[16],o,o,48,0,21],[2,3,[271,2,4],o,o,303,0,21],[2,2,[271,2],o,o,303,0,17],[2,3,[48,48,111],o,o,303,0,1],[1,4,[160,96,96,4],o,o,32,0,1],[1,3,[160,4,4],o,o,32,0,1],[2,2,[2,256],o,o,1,0,8],[3,3,[2,49,1],o,o,1,0,25],[3,3,[2,49,1],o,o,1,0,25],[2,254,[2],[49],o,1,0,25],[2,7,[34,2,65,65,65,74,68],o,o,1,0,1],[1,3,[2,65,65],o,o,2,0,1],[2,6,[2,34,65,65,65,74],o,o,2,0,1],[2,6,[2,34,65,65,65,74],o,o,2,0,1],[2,6,[2,98,98,68,65,495],o,o,32,0,1],[1,4,[32,96,96,4],o,o,32,0,9],[2,2,[4,16],o,o,32,0,25],[2,4,[391,48,65,65],o,o,1,0,1],[3,6,[391,48,48,511,65,65],o,o,319,0,1],[2,254,[160],[160,65],o,32,0,1],[0,5,[65,65,65,65,68],o,o,32,16383,1],[1,4,[65,65,65,65],o,o,32,0,1],[2,254,[258,1,65,65,65],[65],o,32,0,17],[2,3,[32,1,463],o,o,32,0,1],[1,254,o,[48],o,32,0,17],[1,254,o,[48],o,32,0,17],[2,254,[48],[33],o,32,0,1],[2,254,[48],[33],o,32,0,1],[3,254,o,[319,319],[319],319,0,1],[1,254,o,[319],o,319,0,1],[3,3,[65,65,319],o,o,32,0,1],[1,254,o,[319],o,319,0,1],[1,1,[319],o,o,4,0,1],[1,1,[319],o,o,9,0,1],[0,0,o,o,o,319,0,1],void 0,[1,2,[399,1],o,o,2,0,1],[1,2,[32,1],o,o,2,0,1],[2,2,[15,2],o,o,256,0,17],[1,3,[48,65,68],o,o,32,0,17],[1,3,[48,65,68],o,o,32,0,17],[2,3,[32,1,463],o,o,32,0,1],[2,254,[48],[319],o,32,0,1],[3,3,[511,48,271],o,o,319,0,1],[3,3,[511,48,271],o,o,32,0,1],[1,2,[48,271],o,o,32,0,1],[1,2,[48,271],o,o,32,0,1],[1,1,[1535],o,o,4,0,1],[2,4,[32,65,65,495],o,o,32,0,1],[2,3,[48,65,65],o,o,48,0,1],[2,3,[48,65,65],o,o,48,0,1],[1,254,[1],[48],o,303,0,17],void 0,[1,5,[2,66,65,65,65],o,o,264,0,1],[2,2,[15,2],o,o,271,0,17],[3,6,[48,32,96,68,97,65],o,o,32,0,1],[3,9,[48,48,32,96,68,97,65,97,65],o,o,32,0,1],[1,254,[1],[48],o,1087,0,17],[0,0,o,o,o,1,0,1],[1,2,[287,2],o,o,288,0,17],[1,2,[1,1],o,o,10,0,17],[0,0,o,o,o,1,0,1],[3,254,[47],[2,47],o,47,0,17],[0,1,[1],o,o,1,0,1],[0,1,[1],o,o,32,0,1],[1,2,[2,1],o,o,47,0,1],[1,1,[1],o,o,264,0,17],[1,1,[1],o,o,264,0,17],[2,2,[2,47],o,o,47,0,1],[1,254,[2],[1151],o,1087,0,16],[1,254,[1],[1151],o,1087,0,0],[1,254,[1],[1151],o,1087,0,0],[1,1,[256],o,o,258,0,17],[1,1,[16],o,o,32,0,1],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[2,2,[256,2],o,o,2,0,17],[1,1,[32],o,o,256,0,17],[3,254,[15],[2,47],o,303,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,2,[2,66],o,o,264,0,1],[1,1,[256],o,o,2,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,o,[319,319],[319],319,0,1],[3,254,[15],[2,303],o,303,0,17]].map((function(e){return void 0===e?void 0:i.functionType.apply(void 0,e)}))},9860:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.getCharCodeBits=t.location=t.value=t.types=t.PackageName=void 0,t.PackageName="excel-online-calc-lang",t.types=r(3424),t.value=r(2294),t.location=r(9937);var n=r(624);Object.defineProperty(t,"getCharCodeBits",{enumerable:!0,get:function(){return n.getCharCodeBits}}),t.worksheetFuncTypesModule=r(3494),t.adjust=r(330),t.annotations=r(2840),t.cellFormat=r(5499),t.cellParse=r(1646),t.config=r(3378),t.mathpackXL=r(3962),t.datepack=r(3181),t.formulaModule=r(3546),t.numfmt=r(9421),t.util=r(927),t.resolveService=r(7458),t.resolveServiceTypes=r(2195),t.literalParse=r(4931),t.signature=r(5947),t.mathpack=r(7389),t.visitor=r(9017),t.relabel=r(6892),t.mathpackIEEE=r(9173),t.printService=r(1214),t.printServiceTypes=r(4114),t.testUtil=r(6524),t.styleServiceTypes=r(6791)},4931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;var n=r(8350),i=r(9745),o=r(3883),a=r(9119),s=r(9421),l=r(1345),u=r(927),c=l.codePointSpace,d=l.codePointLF,f=l.codePointMinusSign,p=l.codePointPlusSign,m=l.codePointSlash;function h(e){return e===c||e===d}function g(e,t,r,o){(0,i.assertIndex)("calc.parse.parseUint",t,16);for(var s=0,l=o,u=r.length;l<u;){var c=(0,a.stringCodePointAt)(r,l);if(!e.isNumeral(c))break;var d=e.getOrdinal(c);0===s&&0!==d&&(u=(0,n.fastMin)(u,l+t)),s=10*s+d,l+=(0,a.numCodeUnits)(c)}return l===u&&l<r.length&&e.isNumeral((0,a.stringCodePointAt)(r,l))?[0,o]:[s,l]}function v(e,t,r,n){var o=n,a=g(e,5,r,o),s=a[0],l=a[1];if(l===o)return!1;if(s>32767)return!1;if(!((o=l)<r.length&&r.charCodeAt(o)===m))return!1;var c=g(e,5,r,o+=1),d=c[0],f=c[1];if(f===o)return!1;if(d>32767)return!1;if(o=f,0===d)return[!1,0,o];var p=t.div(t.fromNumber(s),t.fromNumber(d));return(0,i.assertTrue)("calc.lang.tryTokenizeFrac",(0,u.isNumberOper)(p)),[p,d,o]}function S(e,t,r,l,c,d,m){var S,y,C,R=l,b=0,N="",T=!1,P=!1,E=s.NumberShape.ASCII;if((0,o.stringStartsWith)(r,e.decimalSeparator,l)||l<r.length&&e.isNumeral((0,a.stringCodePointAt)(r,l))){for(var k=function(){if((d||c&&r.indexOf("%",R)>=0)&&(b-=2,void 0!==S)){var o=t.div(S,t.fromNumber(100));(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,u.isNumberOper)(o)),S=o,C=s.KnownFormat.Pct}if((0,n.fastAbs)(b)>=309)return{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C};var a=t.parse(e,!0,b,N);if(void 0!==S){var l=t.add(a,S);(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,u.isNumberOper)(l)),a=l}return{value:a,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}};R<r.length;){var O=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(O))break;if(0!==e.getOrdinal(O))break;(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O)}if(m&&!1!==(F=v(e,t,r,R))){var A=F[0],I=F[1],_=F[2];return R=_,!1===A?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:(C=I>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,S=A,k())}for(var F,M=R;R<r.length;)if(O=(0,a.stringCodePointAt)(r,R),e.isNumeral(O))b+=1,(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O);else{if(!(c&&b>0&&(0,o.stringStartsWith)(r,e.thousandsSeparator,R)))break;T=!0,R+=e.thousandsSeparator.length}if(N+=r.substring(M,R),T){var D=function(e,t,r){for(var n=r,i="",o=0;o<t.length;){var s=(0,a.stringCodePointAt)(t,o);if(e.isNumeral(s)){var l=(0,a.numCodeUnits)(s);i+=t.substring(o,o+l),o+=l,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;o+=e.thousandsSeparator.length}}return i}(e,N,b);if(void 0===D)return;N=D}if(l<R&&R<r.length&&h(r.charCodeAt(R))&&!1!==(F=v(e,t,r,R+1)))return A=F[0],I=F[1],_=F[2],R=_,!1===A?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:(C=I>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,S=A,k());var w=!1;if((0,o.stringStartsWith)(r,e.decimalSeparator,R)&&(w=R===l,P=!0,R+=e.decimalSeparator.length),0===b)for(;R<r.length&&(O=(0,a.stringCodePointAt)(r,R),e.isNumeral(O))&&0===e.getOrdinal(O);)b-=1,(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O);for(M=R;R<r.length&&(O=(0,a.stringCodePointAt)(r,R),e.isNumeral(O));)(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O);if(N+=r.substring(M,R),!(w&&R<=l+e.decimalSeparator.length)){var L=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,o.stringStartsWith)(t,"**",n))return[0,r];n+=2}var i=!1;if(n<t.length){var s=(0,a.stringCodePointAt)(t,n);((i=s===f)||s===p)&&(n+=(0,a.numCodeUnits)(s))}if(n>=t.length||!e.isNumeral((0,a.stringCodePointAt)(t,n)))return!1;var l=g(e,10,t,n),u=l[0],c=l[1];return c!==n&&!(u>2147483647)&&[i?-u:u,c]}(e,r,R);if(!1!==L){var x=L[0];_=L[1],b+=x,_!==R&&(C=s.KnownFormat.Exp),R=_}return!1===L?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:k()}}}t.isSpace=h,t.isLineBreak=function(e){return e===d},t.parseUint=g,t.parseNumberLiteral=S,t.parseSignedLiteral=function(e,t,r,n,i){var o=n,a=!1;if(o<r.length){var s=r.charCodeAt(o);if((s===p||s===f)&&(a=s===f,o+=1,i))for(;o<r.length&&h(r.charCodeAt(o));)o+=1}var l=S(e,t,r,o,!1,!1,!1);return void 0===(null==l?void 0:l.value)?[t.zero,n]:(o=l.i,[a?t.neg(l.value):l.value,o])}},9937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;var n,i,o=r(637),a=o.assertions.assertIndex,s=o.assertions.assertPositiveLength,l=o.assertions.assertFalse;function u(e){return{kind:n.Cell,range:e}}function c(e){return{kind:n.Range,range:e}}function d(e,t,r){return{document:e,index:t,index2:r}}function f(e,t){return d(e,t,t)}function p(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function m(e,t){return{sheet:e,range:t}}function h(e){return{document:e,index:void 0}}function g(e){return e.index===e.index2}function v(e){return 1===e.rows&&1===e.cols}function S(e){return v(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(n=t.LexicalKind||(t.LexicalKind={})),(i=t.NameSource||(t.NameSource={})).AppHead="AppHead",i.Plain="Plain",i.StructRef="StructRef",i.Indirect="Indirect",t.lexicalSourceCell=u,t.lexicalSourceRange=c,t.lexicalSourceGrid=function(e,t){switch(e){case n.Cell:return S(t)?u(t):l("calc.lang.lexicalSourceGrid: expected cell");case n.Range:return c(t)}},t.lexicalSourceName=function(e){return{kind:n.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:n.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:n.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=d,t.sheetIndex=f,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=p,t.gridRange=function(e,r,n,i){return a("calc.lang.gridRange",e,t.sheetRows),a("calc.lang.gridRange",r,t.sheetCols),s("calc.lang.gridRange",n,t.sheetRows-e),s("calc.lang.gridRange",i,t.sheetCols-r),p(e,r,n,i)},t.gridCell=function(e,r){return a("calc.lang.gridCell",e,t.sheetRows),a("calc.lang.gridCell",r,t.sheetCols),p(e,r,1,1)},t.sheetGridCube=m,t.sheetGridRange=m,t.sheetGridCell=m,t.originCell=m,t.documentScope=h,t.nameScope=function(e,t){return void 0===t?h(e):f(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=g,t.isGridCell=v,t.isSheetGridRange=function(e){return g(e.sheet)},t.isSheetGridCell=S},7389:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;var n=r(8350);t.numberComponents=(0,n.typedInstanceCreator)()((function(e,t,r){return{sign:e,mantissa:t,exponent:r}})),t.formatScientificLeft=function(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}},9173:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;var n=r(2294),i=r(8350),o=r(7389),a=r(1345),s=r(3883),l=r(9745),u=r(3424),c=r(9119),d=a.codePointDigitZero;function f(e){return{kind:u.OperKind.Number,_valueIEEE:e}}var p=f(0),m=f(1),h=f(Math.PI);function g(e){return isFinite(e)?f(e):n.numErrorOper}function v(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function S(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),i=!(0,s.stringStartsWith)(r,"-"),o=r.substring(i?0:1,n).replace(".",""),a=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==d)return!1;return!0}(o)?{sign:i,mantissa:"",exponent:0}:{sign:i,mantissa:o,exponent:a}}var y=["0","1","2","3","4","5","6","7","8","9"];function C(e){var t=e._valueIEEE;return f(t<0?Math.ceil(t):Math.floor(t))}function R(e){var t=e._valueIEEE;return f(Math.floor(t))}function b(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:p,one:m,pi:h,add:function(e,t){return g(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return g(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return g(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,i=t._valueIEEE;return 0===i?n.div0ErrorOper:g(r/i)},power:function(e,t){var r=e._valueIEEE,i=t._valueIEEE,o=Math.pow(r,i);return isFinite(o)?f(o):isNaN(o)?n.div0ErrorOper:n.numErrorOper},percent:function(e){return f(e._valueIEEE/100)},neg:function(e){return f(-e._valueIEEE)},compare:v,formatGeneral:function(e,t,r){var n=e.decimalSeparator,i=t._valueIEEE,o=String(i).replace("e","E");return"."!==n&&(o=o.replace(".",n)),o},formatFixed:function(e,t,r){var n,i=e._valueIEEE,a=S(i),s=a.sign,l=a.mantissa,u=a.exponent,c=r+(u+t);if(0===c){var d=parseFloat("5e"+String(u-1));if(Math.abs(i)>=d)return(0,o.numberComponents)(s,"1",u+t+1)}if(c<1)return(0,o.numberComponents)(!0,"",0);c<=21&&(s=(n=S(i,c-1)).sign,l=n.mantissa,c=r+((u=n.exponent)+t));var f=l.substring(0,c);return(0,o.numberComponents)(s,f,0===f.length?0:u+t)},formatScientific:function(e,t,r){var n,i=e._valueIEEE,a=S(i),s=a.sign,u=a.mantissa,c=a.exponent,d=(0,o.formatScientificLeft)(c,t),f=d+r;if((0,l.assertTrue)("calc.lang.ieeeFormatScientific",f>0),0===f){var p=parseFloat("5e"+String(c-1));if(Math.abs(i)>=p)return(0,o.numberComponents)(s,"",c+1)}if(f<1)return(0,o.numberComponents)(!0,"",0);f<=21&&(s=(n=S(i,f-1)).sign,u=n.mantissa,c=n.exponent,f=(d=(0,o.formatScientificLeft)(c,t))+r);var m=u.substring(0,f);return(0,o.numberComponents)(s,m,0===m.length?0:c)},parse:function(e,t,r,n){return f(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",i=0,o=(0,c.codePointIterator)(t);i<o.length;i++){var a=o[i];n+=y[r(a)]}return n}(e,n)+"E"+String(r)))},trunc:C,ceil:function(e){var t=e._valueIEEE;return f(Math.ceil(t))},floor:R,abs:function(e){return f(Math.abs(e._valueIEEE))},cond:function(e){return v(e,p)},cond2:v,fromNumber:f,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return g(Math.sqrt(e._valueIEEE))},exp:function(e){return g(Math.exp(e._valueIEEE))},ln:function(e){return g(Math.log(e._valueIEEE))},log:function(e){return g(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return f(Math.sin(e._valueIEEE))},cos:function(e){return f(Math.cos(e._valueIEEE))},tan:function(e){return f(Math.tan(e._valueIEEE))},asin:function(e){return g(Math.asin(e._valueIEEE))},acos:function(e){return g(Math.acos(e._valueIEEE))},atan:function(e){return g(Math.atan(e._valueIEEE))},atan2:function(e,t){return f(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=S(r).exponent,i=C(t)._valueIEEE+n;if(0===i){var o=parseFloat("5e"+String(n-1));if(Math.abs(r)>=o)return g((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return i<1?p:i>21?e:g(parseFloat(r.toExponential(i-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=S(r),i=n.sign,o=n.mantissa,a=n.exponent,s=C(t)._valueIEEE+a;return s<1?g(parseFloat((i?"":"-")+"10e"+String(a-1-s))):s>21?e:g(parseFloat((i?"":"-")+function(e,t){if(e.length<=t)return b(e);for(var r=e.substring(0,t),n=0,i=r.length-1;i>=0&&r.charCodeAt(i)-d==9;i-=1)n+=1;return n===r.length?"10":b(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(o,s)+"e"+String(a-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=S(r),i=n.sign,o=n.mantissa,a=n.exponent,s=C(t)._valueIEEE+a;if(s<1)return p;if(s>21)return e;var l=o.substring(0,s);return g(parseFloat((i?"":"-")+b(l)+"e"+String(a-1)))},tenTo:function(e){return(0,l.assertInteger)("calc.lang.ieeeTenTo",e),g(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=C(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=R(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:i.identity}},3962:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var n=r(9799),i=r(2294),o=r(9745),a=r(3424),s=r(8350);function l(e){return{kind:a.OperKind.Number,_valueXL:e}}var u=l(n.mathpack.zero()),c=l(n.mathpack.one()),d=l(n.mathpack.pi());function f(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?i.div0ErrorOper:i.numErrorOper}function p(e){return function(t){return(0,o.assertFalse)("calc.lang.".concat(e,": error ").concat(JSON.stringify(t)))}}function m(e,t,r){return function(n){var i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function h(e,t,r){return function(n,i){var o=e(n._valueXL,i._valueXL);return"number"==typeof o?t(o):r(o)}}var g=h((function(e,t){return n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)}),l,f),v=m((function(e){return n.mathpack.div(e,100)}),l,p("xlPercent")),S=m(n.mathpack.ceil,l,p("xlCeil")),y=m(n.mathpack.floor,l,p("xlFloor")),C=m(n.mathpack.cond,s.identity,p("xlCond, isSupported = ".concat((0,n.isSupported)()))),R=h(n.mathpack.cond2,s.identity,p("xlCond2")),b=m(n.mathpack.sfix,s.identity,p("xlSfix")),N=m(n.mathpack.viewRound,l,p("xlViewRound"));t.xlMathpack={zero:u,one:c,pi:d,add:h(n.mathpack.add,l,f),sub:h(n.mathpack.sub,l,f),mul:h(n.mathpack.mul,l,f),div:h(n.mathpack.div,l,f),power:g,percent:v,neg:function(e){return 0!==C(e)?l(n.mathpack.neg(e._valueXL)):e},compare:function(e,t){return n.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var i=t._valueXL,a=n.mathpack.formatGeneral(e,i,r);return"string"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(a))):a},formatFixed:function(e,t,r){var i=e._valueXL,a=n.mathpack.formatFixed(i,t,r);return"object"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(a))):a},formatScientific:function(e,t,r){var i=e._valueXL,a=n.mathpack.formatScientific(i,t,r);return"object"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(a))):a},parse:function(e,t,r,i){var a=n.mathpack.pack(e,t,r,i);return"number"!=typeof a?(0,o.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify(a))):l(a)},trunc:function(e){return l(n.mathpack.trunc(e._valueXL))},ceil:S,floor:y,abs:function(e){return l(n.mathpack.abs(e._valueXL))},cond:C,cond2:R,fromNumber:function(e){return(0,o.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),l(e)},toNumber:function(e){var t=e._valueXL;return(0,o.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:m(n.mathpack.sqrt,l,f),exp:m(n.mathpack.exp,l,f),ln:m(n.mathpack.ln,l,f),log:m(n.mathpack.log,l,f),sin:m(n.mathpack.sin,l,f),cos:m(n.mathpack.cos,l,f),tan:m(n.mathpack.tan,l,f),asin:m(n.mathpack.asin,l,f),acos:m(n.mathpack.acos,l,f),atan:m(n.mathpack.atan,l,f),atan2:h(n.mathpack.atan2,l,f),round:h(n.mathpack.round,l,f),roundUp:h(n.mathpack.roundUp,l,f),roundDown:h(n.mathpack.roundDown,l,f),tenTo:function(e){(0,o.assertInteger)("calc.lang.xlTenTo",e);var t=n.mathpack.tenTo(e);return"number"==typeof t?l(t):f(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,i=t._valueXL;return n.mathpack.exp32(r)-n.mathpack.exp32(i)>=52428800?u:t},fix:function(e){return n.mathpack.fix(e._valueXL)},lfix:function(e){return n.mathpack.lfix(e._valueXL)},sfix:b,viewRound:N}},9421:(e,t)=>{"use strict";var r,n,i,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,(a=t.CurrencyFormat||(t.CurrencyFormat={})).Paren="Paren",a.Lead="Lead",a.Intern="Intern",a.Trail="Trail",(o=t.DateOrder||(t.DateOrder={})).MDY="MDY",o.DMY="DMY",o.YMD="YMD",o.MYD="MYD",o.DYM="DYM",o.YDM="YDM",(i=t.NumberShape||(t.NumberShape={})).ASCII="ASCII",i.ArabicIndic="ArabicIndic",i.ExtendedArabicIndic="ExtendedArabicIndic",i.Devanagari="Devanagari",i.Bengali="Bengali",i.Gurmukhi="Gurmukhi",i.Gujarati="Gujarati",i.Oriya="Oriya",i.Tamil="Tamil",i.Telugu="Telugu",i.Kannada="Kannada",i.Malayalam="Malayalam",i.Thai="Thai",i.Lao="Lao",i.Tibetan="Tibetan",i.Myanmar="Myanmar",i.Ethiopic="Ethiopic",i.Khmer="Khmer",i.Mongolian="Mongolian",i.ChineseTrad1="ChineseTrad1",i.ChineseTrad2="ChineseTrad2",i.ChineseTrad3="ChineseTrad3",i.ChineseSimp1="ChineseSimp1",i.ChineseSimp2="ChineseSimp2",i.ChineseSimp3="ChineseSimp3",i.Japanese1="Japanese1",i.Japanese2="Japanese2",i.Japanese3="Japanese3",i.Korean1="Korean1",i.Korean2="Korean2",i.Korean3="Korean3",i.Korean4="Korean4",(n=t.Calendar||(t.Calendar={})).Gregorian="Gregorian",n.GregorianUS="GregorianUS",n.Japan="Japan",n.Taiwan="Taiwan",n.Korea="Korea",n.Hijri="Hijri",n.Thai="Thai",n.Hebrew="Hebrew",n.GregorianMEFrench="GregorianMEFrench",n.GregorianArabic="GregorianArabic",n.GregorianXlitEnglish="GregorianXlitEnglish",n.GregorianXlitFrench="GregorianXlitFrench",n.Persian="Persian",n.UmAlQura="UmAlQura",(r=t.KnownFormat||(t.KnownFormat={}))[r.General=0]="General",r[r.NoComFixed0=-1]="NoComFixed0",r[r.NoComFixed=-2]="NoComFixed",r[r.Fixed0=-3]="Fixed0",r[r.Fixed=-4]="Fixed",r[r.Currency=-9]="Currency",r[r.CoCurrency=-10]="CoCurrency",r[r.CurrencyDec=-11]="CurrencyDec",r[r.CoCurrencyDec=-12]="CoCurrencyDec",r[r.Pct0=-13]="Pct0",r[r.Pct=-14]="Pct",r[r.Exp=-15]="Exp",r[r.Fract=-17]="Fract",r[r.FractBond=-18]="FractBond",r[r.MMDDYY=-19]="MMDDYY",r[r.DDMMMYY=-20]="DDMMMYY",r[r.DDMMM=-21]="DDMMM",r[r.MMMYY=-22]="MMMYY",r[r.HHMMAP=-23]="HHMMAP",r[r.HHMMSSAP=-24]="HHMMSSAP",r[r.HHMM=-25]="HHMM",r[r.HHMMSS=-26]="HHMMSS",r[r.MDYHMS=-27]="MDYHMS",r[r.USCoCurrency=-37]="USCoCurrency",r[r.USCoCurrencyDec=-39]="USCoCurrencyDec",r[r.Currency2=-5]="Currency2",r[r.CoCurrency2=-6]="CoCurrency2",r[r.CurrencyDec2=-7]="CurrencyDec2",r[r.CoCurrencyDec2=-8]="CoCurrencyDec2",r[r.Acct=-33]="Acct",r[r.AcctCur=-32]="AcctCur",r[r.AcctDec=-35]="AcctDec",r[r.AcctDecCur=-34]="AcctDecCur",r[r.MMSS=-28]="MMSS",r[r.AbsHMMSS=-31]="AbsHMMSS",r[r.SS0=-29]="SS0",r[r.Eng=-16]="Eng",r[r.Text=-30]="Text"},1214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n,i=r(655),o=r(3546),a=r(2294),s=r(5947),l=r(9745),u=r(927),c=r(9937),d=r(3378),f=r(4038),p=r(5499),m=r(3883),h=r(2195),g=r(7458),v=r(7815),S=r(9017),y=r(3424),C=r(625),R=r(4114),b=r(9119),N=/"/g,T=(0,c.sheetGridCell)((0,c.sheetIndex)((0,c.documentLoc)(void 0,"Book1"),0),(0,c.gridCell)(0,0));function P(e){if(!(0,v.isSuccess)(e)&&e.reason.kind!==h.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==h.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==h.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==h.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==h.ResolveReasonKind.EmptyIntersection)throw new _(e.reason)}function E(e){for(var t=[],r=[],n=0,i=e;n<i.length;n++){var o=i[n];o.length>0&&(0,b.numCodeUnits)((0,b.stringCodePointAt)(o,0))===o.length?t[(0,b.stringCodePointAt)(o,0)]=!0:r.push(o)}return function(e,n){var i=(0,b.stringCodePointAt)(e,n);if(!0===t[i])return!0;for(var o=0,a=r;o<a.length;o++){var s=a[o];if((0,m.stringStartsWith)(e,s,n))return!0}return!1}}function k(e,t){for(var r="",n=0;n<e.length;){t(e,n)&&(r+="'");var i=(0,b.stringCodePointAt)(e,n);r+=(0,b.stringFromCodePoint)(i),n+=(0,b.numCodeUnits)(i)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(n||(n={}));var O={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,i,o){return o},lambdaNode:function(e,t,r,n,i,o){return o},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r,n){return n},structRefNode:function(e,t,r){return r},badSequenceNode:function(e,t,r){return r},badStringNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},A=i.__assign(i.__assign({},(0,S.constVisitor)(void 0)),{operatorNode:function(e){return e}}),I=function(){function e(e,t,r,n){var o,a,s,l,u=this;this.root=r,this.anonymize=n,this.anon=function(e){return u.anonymize?(0,f.anonymizeFormulaString)(e):e},this.locals=t,this.localeInfo=null!==(a=null===(o=t.config)||void 0===o?void 0:o.localeInfo)&&void 0!==a?a:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(l=null===(s=t.config)||void 0===s?void 0:s.refStyle)&&void 0!==l?l:e.config.refStyle,this.resolver=(0,g.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;var c=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],d=i.__spreadArray(i.__spreadArray([],c,!0),["\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=E(c),this.isStructRefBracketedThisRef=E(d),this.isFieldRefEscapable=E(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var e=new S.ZipVisitor({str:this,label:O,op:A});return"="+this.pre(this.root.node.label,"")+(0,S.reduceBottomUp)(e,this.root).str+this.postIfComments(this.root.node.label)},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t},e.prototype.preIfComments=function(e){if(this.anonymize)return"";var t=this.spans[e];return null!=(null==t?void 0:t.preComments)&&t.preComments.length>0?t.pre:""},e.prototype.postIfComments=function(e){if(this.anonymize)return"";var t=this.spans[e];return null!=(null==t?void 0:t.postComments)&&t.postComments.length>0?t.post:""},e.prototype.printRef=function(e,t){var r="";switch(e.kind){case o.StructRefKind.SpecialRef:(t===n.Original&&e.isBracketed||t===n.Bracketed)&&(r+=this.localeInfo.leftBracket);var i=this.localeInfo.specialRefNames[e.id];if(null==i)throw new _((0,u.internal)("No locale data for specialRefName"));r+=i,(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case o.StructRefKind.ColumnRef:var a=0===e.name.length||(0,m.stringStartsWith)(e.name," ")||(0,m.stringEndsWith)(e.name," ");(t===n.Original&&e.isBracketed||t===n.Bracketed||t===n.Unbracketed&&a)&&(r+=this.localeInfo.leftBracket);var s=k(e.name,this.isStructRefEscapable);r+=this.anon(s),(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed||t===n.Unbracketed&&a)&&(r+=this.localeInfo.rightBracket);break;case o.StructRefKind.RangeOpRef:r+=this.printRef(e.lhs,t===n.Original?t:n.Bracketed)+":"+this.printRef(e.rhs,t===n.Original?t:n.Bracketed);break;case o.StructRefKind.MissingRef:break;case o.StructRefKind.BadRef:e.isBracketed&&(r+=this.localeInfo.leftBracket),r+=e.contents,e.isBracketed&&e.isClosed&&(r+=this.localeInfo.rightBracket)}return r},e.prototype.printThisRowOpRef=function(e){var t="@";return e&&(e.kind===o.StructRefKind.ColumnRef?t+=this.printRef(e,e.isClosed?function(e,t){for(var r=0;r<e.length;){if(t(e,r))return!0;r+=(0,b.numCodeUnits)((0,b.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?n.Bracketed:n.Unbracketed:n.Original):t+=this.printRef(e,(0,u.isRangeOpClosed)(e)&&(0,u.isRangeOpNoMissing)(e)?n.Bracketed:n.Original)),t},e.prototype.printApplication=function(e,t,r){var n=this,i=t.map((function(e,t,r){return n.pre(e.label,0===t||""===e.str?"":" ")+e.str+(t===r.length-1?n.post(e.label,""):n.postIfComments(e.label))}));return e.str+"("+i.join(this.localeInfo.listSeparator)+(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?(0,S.visitQualifier)(this,r)+this.postIfComments(r.label):"")+(0,S.visitCellRef)(this,t)},e.prototype.printName=function(e){var t=e.whole,r=e.qualifier;return(void 0!==r?(0,S.visitQualifier)(this,r)+this.postIfComments(r.label):"")+this.anon(t)},e.prototype.printUnanonymisedDocQual=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e.prototype.printOptionalParamName=function(e){return e.kind===o.NodeKind.Name?this.anon((0,u.getBoundName)(this.localeInfo,e.whole)):this.pre(e.label,"")+this.anon(e.contents)+this.post(e.label,"")},e.prototype.literalNode=function(e,t,r){switch(e.kind){case y.OperKind.String:return'"'+this.anon(e.value).replace(N,'""')+'"';case y.OperKind.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case y.OperKind.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21));case y.OperKind.Missing:return"";case y.OperKind.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new _((0,u.internal)("No locale data for error type ".concat(e.type)));return n;default:return(0,l.assertNever)("calc.lang.printFormula",e)}},e.prototype.arrayNode=function(e,t,r){var n=this;return this.localeInfo.leftBrace+e.map((function(e){return e.map((function(e){return n.preIfComments(e.label)+e.str+n.postIfComments(e.label)})).join(n.localeInfo.columnSeparator)})).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var i=t[0];switch(e.op){case s.OperatorId.Percent:return i.str+this.pre(e.label,"")+e.str;case s.OperatorId.Pound:return i.str+this.preIfComments(e.label)+e.str;default:return e.str+this.post(e.label,"")+i.str}}if(2===t.length){var o=t[0],a=t[1],u=" ",c=" ";switch(e.op){case s.OperatorId.Range:u=c="";break;case s.OperatorId.Isect:c="";break;case s.OperatorId.Union:u=""}return o.str+this.pre(e.label,u)+e.str+this.post(e.label,c)+a.str}return(0,l.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)},e.prototype.letNode=function(e,t,r,n,i,a){var s=this,l=t.map((function(e){var t=e.name,r=e.binder;return(0,o.letVar)((0,o.indexedArg)({str:s.anon((0,u.getBoundName)(s.localeInfo,t.arg.whole)),label:t.arg.label,op:void 0},t.index),r)}));return this.printApplication(e,(0,o.flattenLetArgs)(l,r,n),i)},e.prototype.lambdaNode=function(e,t,r,n,i,a){var s=this,l=t.map((function(e){var t=e.name,r=(t.arg.name.isBracketed?s.localeInfo.leftBracket:"")+s.printOptionalParamName(t.arg.name.name)+(t.arg.name.isBracketed&&t.arg.name.isClosed?s.localeInfo.rightBracket:"");return void 0!==t.arg.def&&(r+=s.pre(t.arg.def.label," ")+":="+s.pre(t.arg.def.rhs.label,""===t.arg.def.rhs.str?"":" ")+t.arg.def.rhs.str),(0,o.lambdaParam)((0,o.indexedArg)({str:r,label:t.arg.label,op:void 0},t.index))}));return this.printApplication(e,(0,o.flattenLambdaArgs)(l,r,n),i)},e.prototype.parenNode=function(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,(0,o.nameNode)(e,t,r),this.annotations),a=n.resolved,s=n.fields;return P(a.resolution),a.kind===h.ResolvedKind.ResolvedCellRef?i.__spreadArray([this.printCellRef(a.node)],s.map(this.anon),!0).join("."):a.kind===h.ResolvedKind.ResolvedLocalName&&void 0!==a.resolution.value?i.__spreadArray([this.anon(a.resolution.value.name)],s.map(this.anon),!0).join("."):a.kind===h.ResolvedKind.ResolvedUserDefinedFunc?i.__spreadArray([this.anon(a.name)],s.map(this.anon),!0).join("."):i.__spreadArray([this.printName(a.node)],s.map(this.anon),!0).join(".")},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,(0,o.cellRefNode)(e,t,r)),i=n.node;return P(n.resolution),this.printCellRef(i)},e.prototype.fieldRefNode=function(e,t,r,n){var i=e.str,a=r,s=t.isBracketed||a?this.localeInfo.leftBracket:"",l=t.isBracketed&&t.isClosed||a?this.localeInfo.rightBracket:"",u=t.field.kind===o.NodeKind.Name?k(t.field.whole,this.isFieldRefEscapable):t.field.contents;return t.field.kind!==o.NodeKind.Name?i+=this.pre(t.label,""):i+=this.preIfComments(t.label),i+"."+s+this.anon(u)+l+this.post(t.label,"")},e.prototype.structRefNode=function(e,t,r){var i,a=this,s=this.resolver.resolveStructRef(this.locals,(0,o.structRefNode)(e,t,r)),l=s.node,c=s.table;P(s.resolution);var d=l.rhs.innerRef,f=l.lhs;void 0!==f||void 0===c||!l.rhs.isClosed||(null==d?void 0:d.kind)===o.StructRefKind.ColumnRef||(null==d?void 0:d.kind)===o.StructRefKind.ThisRowOpRef&&(null===(i=d.ref)||void 0===i?void 0:i.kind)===o.StructRefKind.ColumnRef||(f=(0,o.nameNode)((0,o.identNamePart)(c.name)));var p=void 0!==f?this.printName(f):"";if(void 0===d&&l.rhs.isClosed&&void 0!==f)return p;switch(p+=this.localeInfo.leftBracket,null==d?void 0:d.kind){case o.StructRefKind.ColumnRef:case o.StructRefKind.SpecialRef:if(d.kind===o.StructRefKind.SpecialRef&&d.id===o.SpecialRefId.ThisRow&&d.isClosed){p+=this.printThisRowOpRef(void 0);break}p+=this.printRef(d,d.isClosed?n.Unbracketed:n.Original);break;case o.StructRefKind.RangeOpRef:var m=(h=(0,u.isRangeOpClosed)(d)&&(0,u.isRangeOpNoMissing)(d))?n.Bracketed:n.Original;p+=this.printRef(d,m);break;case o.StructRefKind.CommaOpRef:var h;if((h=(0,u.isCommaOpRefWellFormed)(d)&&(0,u.isCommaOpClosed)(d)&&(0,u.isCommaOpNoBadOrMissing)(d))&&d.specialRefs[o.SpecialRefId.ThisRow]){p+=this.printThisRowOpRef(0===d.columnRefs.length?void 0:d.columnRefs[0]);break}var g=h?(0,u.normalizeCommaOpRef)(d):d.refs,v=h?1===g.length?n.Unbracketed:n.Bracketed:n.Original;p+=g.map((function(e){return a.printRef(e,v)})).join(this.localeInfo.listSeparator);break;case o.StructRefKind.ThisRowOpRef:p+=this.printThisRowOpRef(d.ref);break;case o.StructRefKind.BadRef:p+=this.printRef(d,n.Original)}return l.rhs.isClosed&&(p+=this.localeInfo.rightBracket),p},e.prototype.badSequenceNode=function(e,t,r){var n=this;return t.map((function(e){return n.pre(e.label,"")+e.str+n.post(e.label,"")})).join("")},e.prototype.badStringNode=function(e,t,r){return this.anon(t)},e.prototype.operatorNode=function(e,t){var r=(0,d.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new _((0,u.internal)("Invalid operator"));return r},e.prototype.wsfNode=function(e,t,r){return this.localeInfo.getWorksheetFuncName(e)},e.prototype.cellRefError=function(){var e=this.localeInfo.errorNames[a.ErrorType.REF];if(null==e)throw new _((0,u.internal)("No locale data for #REF"));return e},e.prototype.cellRefSingle=function(e,t,r){var n=(0,p.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefRange=function(e,t){var r=(0,p.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()},e.prototype.cellRefRow=function(e,t,r){var n=(0,p.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefCol=function(e,t,r){var n=(0,p.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefBad=function(e,t){return this.anon(e)},e.prototype.errorQualifier=function(){var e=this.localeInfo.errorNames[a.ErrorType.REF];if(null==e)throw new _((0,u.internal)("No locale data for #REF"));return e},e.prototype.relativeQualifier=function(){return"!"},e.prototype.documentQualifier=function(e,t,r){return(0,p.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,o.documentQualifier)(e,t))))+"!"},e.prototype.sheetQualifier=function(e,t,r){return(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(t)+e))+"!"},e.prototype.identQualifier=function(e,t){return(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"},e.prototype.sheetRangeQualifier=function(e,t,r,n){var i=this.anon(this.printUnanonymisedDocQual(r)+e),o=this.anon(t),a=i+":"+o;return((0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,i)||(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,o)?(0,p.quoteQualifier)(a):a)+"!"},e.prototype.badQualifier=function(e,t){return this.anon(e)},e}(),_=(0,u.createFailureErrorClass)("PrintFormulaError"),F=(0,u.createFailureErrorClass)("PrintRangeError");function M(e,t,r,n){void 0===n&&(n=!1);try{return(0,v.success)(new I(e,t,r,n).print())}catch(e){return e instanceof _?(0,v.failure)(e.reason):(0,v.failure)((0,v.javaScriptError)(e))}}function D(e,t){return(0,o.cellRefSingle)((0,o.pos)(o.PosKind.Rel,t.row-e.row),(0,o.pos)(o.PosKind.Rel,t.col-e.col))}function w(e){return(0,v.isSuccess)(e)?((0,l.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,v.success)(e.value)):e.reason.kind===h.ResolveReasonKind.InvalidStructRef?(0,l.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,v.failure)(e.reason)}t.anonymizeFormula=function(e,t,r){try{var n=r.kind===c.LexicalKind.Cell||r.kind===c.LexicalKind.Range?(0,R.printLocalsGrid)(r,(0,u.sheetGridRangeAnchor)(r.range)):r.kind===c.LexicalKind.NameManager?(0,R.printLocalsName)(r,T):(0,l.assertNever)("calc.lang.anonymizeFormula",r),i=M((0,R.createSimplePrintGlobals)((0,d.calcConfig)((0,d.getEnglishLocaleInfo)(),o.RefStyle.A1,e.mathpack)),n,t,!0);if(i.kind===v.ResultKind.Success)return i.value;if(i.reason.kind===v.ReasonKind.JavaScriptError)throw i.reason.error}catch(e){var a="calc.lang.anonymizeFormula: Format failed: "+(0,m.messageFromError)(e);l.ulsLogger.ULS.traceTag(556863706,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,a)}return(0,f.anonymize)(t)};var L={getNamedRanges:function(){return(0,l.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};t.createPrinter=function(e){var t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:L.getNamedRanges}}(e);return{printFormula:function(t,r){return M(e,t,r)},printRange:function(e,r,n){return function(e,t,r,n){var a,s;void 0===n&&(n=(0,C.makeEmptyTable)());try{var l=t.originSheet.value;if(!(0,u.isDocumentLocEqual)(l.document,r.sheet.document))throw new F((0,u.notImplemented)(["printRange cross-document"]));return(0,v.success)(null!==(s=null!==(a=function(e,t,r,n){var a=t.originSheet.value,s=e.getNamedRanges(r);if(!(0,v.isSuccess)(s))throw new F(s.reason);if(0!==s.value.length){var l=function(e){return void 0!==e.index&&(void 0===a.index||!(0,u.isSheetIndexEqual)(e,a))},d=s.value.filter((function(e){var t=e.scope;return void 0===t.index?(0,u.isDocumentLocEqual)(t.document,r.sheet.document):(0,u.isSheetIndexEqual)(t,r.sheet)})).filter((function(t){var r=t.scope,n=t.name;if(void 0!==r.index||void 0===a.index)return!0;var i=a,o=e.getNameLoc(i,n,c.NameSource.Plain);if(!(0,v.isSuccess)(o))throw new F(o.reason);return null==o.value})).filter((function(e){var t=e.scope,r=e.name;return l(t)||!n.contains(r)}));if(0!==d.length){var f,p=1===d.length?d[0]:i.__spreadArray([],d,!0).sort((function(t,r){return e.config.localeInfo.stringCompareCI(t.name,r.name)}))[0];if(l(p.scope)){var m=e.getSheetName(p.scope.document,p.scope.index);if(!(0,v.isSuccess)(m))throw new F(m.reason);f=(0,o.sheetQualifier)(m.value)}return(0,o.nameNode)((0,o.identNamePart)(p.name),f)}}}(e,t,r,n))&&void 0!==a?a:function(e,t,r){var n=r.sheet,i=r.range,a=e.getContainingTable((0,c.sheetGridCell)(n,(0,u.gridRangeAnchor)(i)));if(!(0,v.isSuccess)(a))throw new F(a.reason);if(null!=a.value){var s=a.value,l=w(e.getStructRefSpecialRef(s,o.SpecialRefId.All));if(!(0,v.isSuccess)(l))throw new F(l.reason);var d=l.value.range,f=l.value.sheet,p=(0,u.gridRangeCompare)(d,i);if(!(void 0===p||p<0)){var m=w(e.getStructRefSpecialRef(s,o.SpecialRefId.Data));if(!(0,v.isSuccess)(m))throw new F(m.reason);var h=m.value.range,g=t.originGridCell.value,S=t.originSheet.value,y=void 0!==S.index&&(0,u.isSheetIndexEqual)(S,f)&&(0,u.gridRangeIsects)(d,g)?void 0:(0,o.nameNode)((0,o.identNamePart)(s.name)),C=null!=y?y:(0,o.nameNode)((0,o.identNamePart)(s.name)),R=h.cols>1&&i.col===h.col&&i.cols===h.cols,b=function(){var t=w(e.getStructRefColumn(s,i.col));if(!(0,v.isSuccess)(t))throw new F(t.reason);if(1===i.cols)return(0,o.columnRef)(t.value.name);var r=w(e.getStructRefColumn(s,i.col+i.cols-1));if(!(0,v.isSuccess)(r))throw new F(r.reason);return(0,o.rangeOpRef)((0,o.columnRef)(t.value.name),(0,o.columnRef)(r.value.name))};if(i.row===d.row&&i.rows===d.rows)return(0,o.structRefNode)(C,(0,o.structRef)(R?(0,o.specialRef)(o.SpecialRefId.All):(0,o.commaOpRef)([(0,o.specialRef)(o.SpecialRefId.All,!0),b()])));if(1===i.rows&&i.row===g.row&&i.row>=h.row&&i.row<h.row+h.rows)return(0,o.structRefNode)(1===i.cols?y:C,(0,o.structRef)((0,o.thisRowOpRef)(R?void 0:b())));if(i.row===h.row&&i.rows===h.rows)return R?(0,o.structRefNode)(C,(0,o.structRef)(void 0)):(0,o.structRefNode)(1===i.cols?y:C,(0,o.structRef)(b()));var N=i.row===d.row&&i.row+i.rows===h.row,T=i.row===h.row+h.rows&&i.row+i.rows===d.row+d.rows;if(N||T){var P=(0,o.specialRef)(N?o.SpecialRefId.Headers:o.SpecialRefId.Totals,!R);return(0,o.structRefNode)(C,(0,o.structRef)(R?P:(0,o.commaOpRef)([P,b()])))}var E=i.row===d.row&&d.row<h.row&&i.row+i.rows===h.row+h.rows,k=i.row===h.row&&d.row+d.rows>h.row+h.rows&&i.row+i.rows===d.row+d.rows;if(E||k){var O=(0,o.specialRef)(E?o.SpecialRefId.Headers:o.SpecialRefId.Data,!0),A=(0,o.specialRef)(E?o.SpecialRefId.Data:o.SpecialRefId.Totals,!0);return(0,o.structRefNode)(C,(0,o.structRef)(R?(0,o.commaOpRef)([O,A]):(0,o.commaOpRef)([O,A,b()])))}}}}(e,t,r))&&void 0!==s?s:function(e,t,r){var n,i=t.originSheet.value,a=function(e,t){if(0===t.col&&t.cols===c.sheetCols)return function(e,t,r){return(0,o.cellRefRow)((0,o.pos)(o.PosKind.Rel,t-e.row),(0,o.pos)(o.PosKind.Rel,t+r-1-e.row))}(e,t.row,t.rows);if(0===t.row&&t.rows===c.sheetRows)return function(e,t,r){return(0,o.cellRefCol)((0,o.pos)(o.PosKind.Rel,t-e.col),(0,o.pos)(o.PosKind.Rel,t+r-1-e.col))}(e,t.col,t.cols);var r=D(e,(0,u.gridRangeAnchor)(t));if((0,u.isGridCell)(t))return r;var n=D(e,(0,c.gridCell)(t.row+t.rows-1,t.col+t.cols-1));return(0,o.cellRefRange)(r,n)}(t.originGridCell.value,r.range);if(void 0===i.index||!(0,u.isSheetIndexEqual)(i,r.sheet)){var s=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,v.isSuccess)(s))throw new F(s.reason);n=(0,o.sheetQualifier)(s.value)}return(0,o.cellRefNode)(a,n)}(e,t,r))}catch(e){return e instanceof F?(0,v.failure)(e.reason):(0,v.failure)((0,v.javaScriptError)(e))}}(t,e,r,n)}}}},4114:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(9937),i=r(7815),o=r(927),a=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return(0,i.success)((0,n.documentLoc)(e,t))},e.prototype.getSheetIndex=function(e,t){return(0,i.success)(t)},e.prototype.getSheetName=function(e,t){return(0,i.success)(t)},e.prototype.getNameLoc=function(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return(0,i.success)([(0,n.userDefinedFuncLoc)(e,t)])},e.prototype.getSheetRangeIndexes=function(e){if(void 0===e.index)return(0,i.failure)((0,o.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))},e.prototype.getContainingTable=function(e){return i.successUndefined},e.prototype.getStructRefColumn=function(e,t){return i.successUndefined},e.prototype.getStructRefSpecialRef=function(e,t){return i.successUndefined},e.prototype.getNamedRanges=function(e){return(0,i.success)([])},e}();t.createSimplePrintGlobals=function(e){return new a(e)},t.printLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.printLocalsName=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},6892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;var n=r(655),i=r(3546),o=r(9017);t.relabelFormula=function(e,t){var r;void 0===t&&(r=1,t=function(){return r++});var a=e.spans,s=e.annotations,l=e.depthUpperBound,u=[],c=[],d=[],f=[];function p(e){var r=t(),n=a[e];null!=n&&(u[r]=n);var i=s[e];return null!=i&&(c[r]=i),d[e]=r,f[r]=e,r}function m(e){return n.__assign(n.__assign({},e),{label:p(e.label)})}function h(e){if(e.kind===i.CellRefKind.Range){var t=e;return(0,i.cellRefRange)(h(t.ref1),h(t.ref2),p(e.label))}return n.__assign(n.__assign({},e),{label:p(e.label)})}function g(e){return null!=e?(0,i.documentQualifier)(e.document,e.path,e.isQuoted,p(e.label)):void 0}function v(e){return(0,i.fieldRef)((t=e.field).kind===i.NodeKind.Name?y(t.parts,t.qualifier,t.label):(0,i.badNode)(t.type,t.contents,p(t.label)),e.isBracketed,e.isClosed,p(e.label));var t}function S(e){switch(null==e?void 0:e.kind){case void 0:return;case i.StructRefKind.SpecialRef:return(0,i.specialRef)(e.id,e.isBracketed,e.isClosed,p(e.label));case i.StructRefKind.ColumnRef:return(0,i.columnRef)(e.name,e.isBracketed,e.isClosed,p(e.label));case i.StructRefKind.RangeOpRef:return(0,i.rangeOpRef)(S(e.lhs),S(e.rhs),p(e.label));case i.StructRefKind.CommaOpRef:return(0,i.commaOpRef)(e.refs.map(S),p(e.label));case i.StructRefKind.ThisRowOpRef:return(0,i.thisRowOpRef)(void 0!==e.ref?S(e.ref):void 0,p(e.label));case i.StructRefKind.MissingRef:return(0,i.missingRef)(p(e.label));case i.StructRefKind.BadRef:return(0,i.badRef)(e.contents,e.isBracketed,e.isClosed,p(e.label))}}function y(e,t,r){return(0,i.nameNode)(function(e){var t=(0,i.flattenNameParts)(e),r=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,o=t.label,a=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,void 0===r?r:v(r),n,p(o),p(a))};if(t.kind===i.NamePartKind.IdentNamePart){var n=t.parts,o=n[0],a=n.slice(1),s=(0,i.identNamePart)(o.asWhole,o.canDenoteNamedObject,p(o.label),p(o.qualifiedLabel));return a.reduce(r,s)}var l=t.parts,u=l[0],c=l[1],d=l.slice(2),f=(0,i.cellRefNamePart)(h(u.ref),u.asWhole,p(u.label),p(u.qualifiedLabel));return d.reduce(r,r(f,c))}(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:g(e.document),label:p(e.label)}):n.__assign(n.__assign({},e),{label:p(e.label)})}(t),p(r))}function C(e){return y(e.parts,e.qualifier,e.label)}for(var R={literalNode:function(e,t,r){return(0,i.literalNode)(e,t,p(r))},arrayNode:function(e,t,r){return(0,i.arrayNode)(e,t,p(r))},appNode:function(e,t,r,n){return(0,i.appNode)(e,t,r,p(n))},letNode:function(e,t,r,n,o,a){return(0,i.letNode)(e,t.map((function(e){var t=e.name,r=e.binder;return(0,i.letVar)((0,i.indexedArg)(C(t.arg),t.index),r)})),r,n,o,p(a))},lambdaNode:function(e,t,r,n,o,a){return(0,i.lambdaNode)(e,t.map((function(e){var t,r,n,o=e.name;return(0,i.lambdaParam)((0,i.indexedArg)((t=o.arg,r=(0,i.paramName)(function(e){switch(e.kind){case i.NodeKind.Name:return C(e);case i.NodeKind.Bad:return(0,i.badNode)(e.type,e.contents,p(e.label))}}(t.name.name),t.name.isBracketed,t.name.isClosed,p(t.name.label)),n=void 0===t.def?void 0:(0,i.paramDefault)(t.def.rhs,p(t.def.label)),(0,i.paramNode)(r,n,p(t.label))),o.index))})),r,n,o,p(a))},parenNode:function(e,t,r){return(0,i.parenNode)(e,t,p(r))},nameNode:function(e,t,r){return y(e,t,r)},cellRefNode:function(e,t,r){return(0,i.cellRefNode)(h(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:g(e.document),label:p(e.label)}):n.__assign(n.__assign({},e),{label:p(e.label)})}(t),p(r))},fieldRefNode:function(e,t,r,n){return(0,i.fieldRefNode)(e,v(t),r,p(n))},structRefNode:function(e,t,r){return(0,i.structRefNode)(void 0===e?void 0:C(e),(n=t,(0,i.structRef)(S(n.innerRef),n.isClosed,p(n.label))),p(r));var n},badSequenceNode:function(e,t,r){return(0,i.badNode)(e,t,p(r))},badStringNode:function(e,t,r){return(0,i.badNode)(e,t,p(r))},operatorNode:function(e,t){return(0,i.operatorNode)(e,p(t))},wsfNode:function(e,t,r){return(0,i.wsfNode)(e,t,p(r))}},b=(0,i.formula)((0,o.reduceBottomUp)(R,e),u,c,l),N=0,T=Object.keys(c);N<T.length;N++){var P=T[N],E=Number(P),k=c[E];switch(null==k?void 0:k.kind){case i.AnnotationKind.LocalNameUse:c[E]=(0,i.localNameUseAnnotation)(k.name,k.whole,d[k.label]);break;case i.AnnotationKind.LocalNameDecl:c[E]=(0,i.localNameDeclAnnotation)(k.name,k.whole,k.uses.map((function(e){var t=e.label;return{label:d[t]}})))}}for(var O=0,A=Object.keys(u).map(Number);O<A.length;O++){var I=A[O],_=u[I],F=null==_?void 0:_.preComments,M=null==_?void 0:_.postComments;(F||M)&&(u[I]=n.__assign(n.__assign({},_),{preComments:F?F.map(m):void 0,postComments:M?M.map(m):void 0}))}return{formula:b,oldToNewLabel:d,newToOldLabel:f}}},7458:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=void 0;var n=r(655),i=r(8350),o=r(8350),a=r(9745),s=r(5499),l=r(3546),u=r(927),c=r(927),d=r(9937),f=r(9937),p=r(7815),m=r(2195);function h(e){return(0,p.isSuccess)(e)&&(0,o.isNone)(e.value)?p.successUndefined:e}function g(e){return!(0,p.isSuccess)(e)||void 0===e.value}function v(e,t,r){var n=(0,s.resolvePosition)(e.row,t.row,f.sheetRows,r),i=(0,s.resolvePosition)(e.col,t.col,f.sheetCols,r);return void 0!==n&&void 0!==i?(0,f.gridCell)(n,i):void 0}function S(e,t){if(t.kind===l.CellRefKind.Error)return p.successUndefined;var r=e.originGridCell;if(!(0,p.isSuccess)(r))return r;var n=r.value,i=e.wrapCellReferences;switch(t.kind){case l.CellRefKind.Single:return(0,p.success)(v(n,t,i));case l.CellRefKind.Range:var o=v(n,t.ref1,i),u=v(n,t.ref2,i);return void 0!==o&&void 0!==u?(0,p.success)((0,c.gridCellRange)(o,u)):p.successUndefined;case l.CellRefKind.Row:var d=(0,s.resolvePosition)(n.row,t.row1,f.sheetRows,i),h=(0,s.resolvePosition)(n.row,t.row2,f.sheetRows,i);return void 0!==d&&void 0!==h?(0,p.success)((0,c.gridCellRange)((0,f.gridCell)(d,0),(0,f.gridCell)(h,f.sheetCols-1))):p.successUndefined;case l.CellRefKind.Col:var g=(0,s.resolvePosition)(n.col,t.col1,f.sheetCols,i),S=(0,s.resolvePosition)(n.col,t.col2,f.sheetCols,i);return void 0!==g&&void 0!==S?(0,p.success)((0,c.gridCellRange)((0,f.gridCell)(0,g),(0,f.gridCell)(f.sheetRows-1,S))):p.successUndefined;case l.CellRefKind.Bad:return(0,p.failure)((0,m.invalidCellRef)(m.InvalidCellRefReason.BadCellRef));default:return(0,a.assertNever)("calc.runtime.resolverService.resolveGridRef",t)}}t.resolveGridRef=S,t.createResolver=function(e){function t(t,r){if(void 0===r){var n=t.originSheet;return(0,p.isSuccess)(n)?[r,(0,p.success)(n.value.document)]:[r,n]}var i=e.getDocumentLoc(r.path,r.document);if(!(0,p.isSuccess)(i))return[r,i];if((0,o.isNone)(i.value))return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.UndefinedDocument))];var a=null==r.path?void 0:i.value.path,s=i.value.name;return[(0,l.documentQualifier)(s,a,r.isQuoted,r.label),(0,p.success)(i.value)]}function r(t,r){if(g(r))return[t,r];var n=h(e.getSheetIndex(r.value,t));if(!(0,p.isSuccess)(n))return[t,n];if((0,o.isNone)(n.value))return[t,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.UndefinedSheetName))];var i=e.getSheetName(r.value,n.value);return(0,p.isSuccess)(i)?[i.value,(0,p.success)((0,f.sheetIndex)(r.value,n.value))]:[t,i]}function s(e,n){var i=t(e,n.document),o=i[0],a=i[1],s=r(n.sheet,a),u=s[0],c=s[1];return[(0,l.sheetQualifier)(u,o,n.isQuoted,n.label),c]}function v(n,i){var o,u,d,h,v=i.qualifier,y=i.ref,C=S(n,y);if(void 0===v||v.kind===l.QualifierKind.Relative){u=v;var R=n.originSheet;if((0,p.isSuccess)(R)){var b=R.value;d=void 0===b.index?(0,p.failure)((0,m.noOriginSheet)(b)):(0,p.success)(b)}else d=R}else u=(o=function(n,i){switch(i.kind){case l.QualifierKind.Error:return[i,p.successUndefined];case l.QualifierKind.Sheet:return s(n,i);case l.QualifierKind.SheetRange:return function(n,i){var o,a=t(n,i.document),s=a[0],u=a[1],d=r(i.sheet1,u),m=d[0],h=d[1],v=r(i.sheet2,u),S=v[0],y=v[1],C=m,R=S;if(g(u))o=u;else if(g(h))o=h;else if(g(y))o=y;else{if((0,c.isSheetIndexEqual)(h.value,y.value))return[(0,l.sheetQualifier)(C,s,i.isQuoted,i.label),(0,p.success)((0,f.sheetIndex)(u.value,h.value.index))];var b=e.getSheetRangeIndexes(h.value),N=e.getSheetRangeIndexes(y.value);(0,p.isSuccess)(b)?(0,p.isSuccess)(N)?N.value.position<b.value.position&&(C=S,R=m):o=N:o=b,o=(0,p.success)((0,f.sheetRange)(u.value,h.value.index,y.value.index))}return[(0,l.sheetRangeQualifier)(C,R,s,i.isQuoted,i.label),o]}(n,i);case l.QualifierKind.Document:return[i,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.SheetRangeName))];case l.QualifierKind.Bad:return[i,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.BadQualifier))];default:return(0,a.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",i)}}(n,v))[0],d=o[1];return h=g(C)?C:g(d)?d:(0,p.success)((0,f.sheetGridCube)(d.value,C.value)),(0,m.resolvedCellRef)((0,l.cellRefNode)(y,u,i.label),h)}function y(r,n,i){var o,u,c,v=n.qualifier,S=n.parts,y=[];if(void 0===v||v.kind===l.QualifierKind.Relative){var C=r.originSheet;if(!(0,p.isSuccess)(C))return(0,m.resolvedName)(n,C,y);var R=C.value;if(i!==f.NameSource.StructRef){if(void 0===R.index)return(0,m.resolvedName)(n,(0,p.failure)((0,m.noOriginSheet)(R)),y);y.push((0,d.nameLoc)(R,S.asWhole));var b=h(e.getNameLoc(R,S.asWhole,i));if(!(0,p.isSuccess)(b))return(0,m.resolvedName)(n,b,y);if(b.value)return(0,m.resolvedName)((0,l.nameNode)((0,l.identNamePart)(b.value.name,S.canDenoteNamedObject,S.label,S.qualifiedLabel),v,n.label),b,y)}u=v,c=(0,p.success)((0,f.documentScope)(R.document))}else u=(o=function(e,r){switch(r.kind){case l.QualifierKind.Document:var n=t(e,r);return[d=n[0],g(h=n[1])?h:(0,p.success)((0,f.documentScope)(h.value))];case l.QualifierKind.Sheet:return s(e,r);case l.QualifierKind.SheetRange:return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.SheetRangeName))];case l.QualifierKind.Ident:var i=s(e,(0,l.sheetQualifier)(r.name,void 0)),o=i[0],u=i[1];if(!(0,p.isSuccess)(u)&&u.reason.kind!==m.ResolveReasonKind.InvalidQualifier)return[r,u];if((0,p.isSuccess)(u)&&void 0!==u.value)return[(0,l.identQualifier)(o.sheet,r.isQuoted,r.label),u];var c=t(e,(0,l.documentQualifier)(r.name)),d=c[0],h=c[1];return[(0,l.identQualifier)(d.document,r.isQuoted,r.label),g(h)?h:(0,p.success)((0,f.documentScope)(h.value))];case l.QualifierKind.Bad:return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.BadQualifier))];default:return(0,a.assertNever)("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,v))[0],c=o[1];var N,T=S;return g(c)?N=c:(y.push((0,d.nameLoc)(c.value,S.asWhole)),g(N=h(e.getNameLoc(c.value,S.asWhole,i)))||(T=(0,l.identNamePart)(N.value.name,S.canDenoteNamedObject,S.label,S.qualifiedLabel))),(0,m.resolvedName)((0,l.nameNode)(T,u,n.label),N,y)}function C(t,r,n){void 0===n&&(n=!1);var i=e.getStructRefColumn(t,r.name);if(!(0,p.isSuccess)(i))return{kind:l.StructRefKind.ColumnRef,innerRef:r,resolution:i};var a=i.value;if((0,o.isNone)(a))return{kind:l.StructRefKind.ColumnRef,innerRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.UndefinedColumnName))};var s=a.range.range;return n&&(s=(0,f.gridRange)(s.row-(a.hasHeadersRow?1:0),s.col,s.rows+(a.hasHeadersRow?1:0)+(a.hasTotalsRow?1:0),s.cols)),{kind:l.StructRefKind.ColumnRef,innerRef:(0,l.columnRef)(a.name,r.isBracketed,r.isClosed,r.label),resolution:(0,p.success)((0,f.sheetGridRange)(a.range.sheet,s))}}function R(t,r,n){if(n===l.SpecialRefId.ThisRow){if(!(0,p.isSuccess)(t.originGridCell))return t.originGridCell;var i=R(t,r,l.SpecialRefId.Data);if(g(i))return i;var o=i.value.range,a=t.originGridCell.value.row;return a<o.row||a>=o.row+o.rows?(0,p.failure)(m.emptyIntersection):(0,p.success)((0,f.sheetGridRange)(i.value.sheet,(0,f.gridRange)(a,o.col,1,o.cols)))}return h(e.getStructRefSpecialRef(r,n))}function b(e,t,r){switch(t.kind){case l.StructRefKind.ColumnRef:return C(e,t,r);case l.StructRefKind.MissingRef:return{kind:l.StructRefKind.MissingRef,innerRef:t,resolution:p.successUndefined}}}function N(e,t,r){var n;void 0===r&&(r=!1);var i,o,a=b(e,t.lhs,r),s=a.innerRef,u=a.resolution,d=b(e,t.rhs,r),h=d.innerRef,g=d.resolution,v=(0,l.rangeOpRef)(s,h,t.label);if(!(0,p.isSuccess)(u)&&u.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:u};if(!(0,p.isSuccess)(g)&&g.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:g};if(!(0,p.isSuccess)(u))return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:u};if(!(0,p.isSuccess)(g))return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:g};if(void 0!==u.value)i=u.value.sheet,o=(0,c.gridRangeJoinOpt)(u.value.range,null===(n=g.value)||void 0===n?void 0:n.range);else{if(void 0===g.value)return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};i=g.value.sheet,o=g.value.range}return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:(0,p.success)((0,f.sheetGridRange)(i,o))}}function T(r,n){var i,o,s,c,f,h,v,S=n.qualifier,y=n.parts,C=null!==(s=null===(o=r.config)||void 0===o?void 0:o.localeInfo)&&void 0!==s?s:e.config.localeInfo;if(void 0===S){var R=r.originSheet;if(!(0,p.isSuccess)(R))return(0,m.resolvedUserDefinedFunc)(n,R,[],y.asWhole);c=S,f=(0,p.success)(R.value.document)}else c=(i=function(e,r){switch(r.kind){case l.QualifierKind.Document:return t(e,r);case l.QualifierKind.Ident:var n=t(e,(0,l.documentQualifier)(r.name)),i=n[0],o=n[1];return[(0,l.identQualifier)(i.document,r.isQuoted,r.label),o];default:return(0,a.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,S))[0],f=i[1];var b=y.asWhole;if(g(f))v=f,h=[];else{b=(0,u.getUserDefinedFuncName)(C,y.asWhole);var N=e.getUserDefinedFuncLoc(f.value,b);h=[(0,d.userDefinedFuncLoc)(f.value,b)],v=(0,p.isSuccess)(N)?0!==N.value.length?N:p.successUndefined:N}return(0,m.resolvedUserDefinedFunc)((0,l.nameNode)((0,l.identNamePart)(y.asWhole,y.canDenoteNamedObject,y.label,y.qualifiedLabel),c,n.label),v,h,b)}return{resolveGridRef:S,resolveCellRef:v,resolveName:y,resolveStructRef:function(t,r){var n,i,a=r.lhs,s=r.rhs,u=a;if(void 0!==a){var d=y(t,a,f.NameSource.StructRef),h=d.node,v=d.resolution,S=d.precedents,b=v;if(!(0,p.isSuccess)(b))return(0,m.resolvedStructRef)(r,void 0,b,S);if((0,o.isNone)(b.value))return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.UndefinedTableName)),S);u=h,n=b.value,i=S}else{var T=t.originGridCell,P=t.originSheet;if(!(0,p.isSuccess)(T))return(0,m.resolvedStructRef)(r,void 0,T,[]);if(!(0,p.isSuccess)(P))return(0,m.resolvedStructRef)(r,void 0,P,[]);if(void 0===P.value.index)return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOriginSheet)),[]);if(b=e.getContainingTable((0,f.sheetGridCell)(P.value,T.value)),!(0,p.isSuccess)(b))return(0,m.resolvedStructRef)(r,void 0,b,[]);if((0,o.isNone)(b.value))return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.MissingTableName)),[]);i=[n=b.value]}var E=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case l.StructRefKind.ColumnRef:var i=C(t,r.innerRef),o=i.innerRef,a=i.resolution;return{structRef:(0,l.structRef)(o,r.isClosed,r.label),resolution:a};case l.StructRefKind.RangeOpRef:var s=N(t,r.innerRef);return o=s.innerRef,a=s.resolution,{structRef:(0,l.structRef)(o,r.isClosed,r.label),resolution:a};case void 0:return{structRef:r,resolution:a=R(e,t,l.SpecialRefId.Data)};case l.StructRefKind.SpecialRef:return{structRef:r,resolution:a=R(e,t,r.innerRef.id)};case l.StructRefKind.CommaOpRef:var u=function(e,t,r){for(var n,i,o=r.refs.map((function(r){return function(e,t,r){switch(r.kind){case l.StructRefKind.ColumnRef:return C(t,r,!0);case l.StructRefKind.SpecialRef:return{kind:l.StructRefKind.SpecialRef,innerRef:r,resolution:R(e,t,r.id)};case l.StructRefKind.RangeOpRef:return N(t,r,!0);case l.StructRefKind.MissingRef:return{kind:l.StructRefKind.MissingRef,innerRef:r,resolution:p.successUndefined};case l.StructRefKind.BadRef:return{kind:l.StructRefKind.BadRef,innerRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}}(e,t,r)})),a=(0,l.commaOpRef)(o.map((function(e){return e.innerRef})),r.label),s=0,u=o;s<u.length;s++){var d=u[s].resolution;if(!(0,p.isSuccess)(d)&&d.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{commaOpRef:a,resolution:d}}for(var h,g,v=[],S=0,y=o;S<y.length;S++){var b=y[S];if(!(0,p.isSuccess)(b.resolution)||b.kind===l.StructRefKind.BadRef)return{commaOpRef:a,resolution:b.resolution};v.push((b.kind===l.StructRefKind.SpecialRef||(b.kind,l.StructRefKind.MissingRef),{kind:b.kind,resolution:b.resolution}))}if(!(0,c.isCommaOpRefWellFormed)(r))return{commaOpRef:a,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};for(var T=0,P=v;T<P.length;T++)(b=P[T]).kind===l.StructRefKind.SpecialRef&&(h=(0,c.gridRangeJoinOpt)(h,null===(n=b.resolution.value)||void 0===n?void 0:n.range),void 0===g&&(g=null===(i=b.resolution.value)||void 0===i?void 0:i.sheet));if(void 0===h||void 0===g)return{commaOpRef:a,resolution:p.successUndefined};for(var E=0,k=v;E<k.length;E++)if((b=k[E]).kind!==l.StructRefKind.SpecialRef&&b.kind!==l.StructRefKind.MissingRef&&void 0===(h=(0,c.gridRangeIsect)(h,b.resolution.value.range)))return{commaOpRef:a,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};return{commaOpRef:a,resolution:(0,p.success)((0,f.sheetGridRange)(g,h))}}(e,t,r.innerRef);return o=u.commaOpRef,a=u.resolution,{structRef:(0,l.structRef)(o,r.isClosed,r.label),resolution:a};case l.StructRefKind.ThisRowOpRef:var d=R(e,t,l.SpecialRefId.ThisRow);if(g(d)||void 0===r.innerRef.ref)return{structRef:r,resolution:d};var h=r.innerRef.ref.kind===l.StructRefKind.ColumnRef?C(t,r.innerRef.ref):N(t,r.innerRef.ref),v=(o=h.innerRef,h.resolution),S=(0,l.thisRowOpRef)(o,o.label);if(g(v))return{structRef:(0,l.structRef)(S,r.isClosed,r.label),resolution:v};var y=(0,c.gridRangeIsect)(d.value.range,v.value.range);return y?{structRef:(0,l.structRef)(S,r.isClosed,r.label),resolution:(0,p.success)((0,f.sheetGridRange)(d.value.sheet,y))}:{structRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};case l.StructRefKind.BadRef:return{structRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}}(t,n,s),k=E.structRef,O=E.resolution;return(0,m.resolvedStructRef)(O.kind===p.ResultKind.Failure&&O.reason.kind!==m.ResolveReasonKind.EmptyIntersection?r:(0,l.structRefNode)(u,k,r.label),n,O,i)},resolveUserDefinedFunc:T,resolveDottedName:function(e,t,r){var o,a,s=t.qualifier,u=t.parts,c=[],d={names:new Array,udfs:new Array},h=r[t.label],g=(null==h?void 0:h.kind)===l.AnnotationKind.AppHeadName;if(!s){var S=(0,l.headNamePart)(u);if(S.kind===l.NamePartKind.IdentNamePart){var C=function(e,t){var r=t[e.label];return(null==r?void 0:r.kind)===l.AnnotationKind.LocalNameUse?(0,m.resolvedLocalName)((0,l.nameNode)((0,l.identNamePart)(r.whole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,p.success)(r)):(0,m.resolvedLocalName)((0,l.nameNode)((0,l.identNamePart)(e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),p.successUndefined)}(S,r);if(void 0!==C.resolution.value){var R=(0,l.flattenNameParts)(u).parts.slice(1),b=R.map((function(e){var t=e.rhs;return(null==t?void 0:t.field.kind)===l.NodeKind.Name?t.field.whole:void 0})).filter((function(e){return void 0!==e}));if(b.length===R.length)return(0,m.resolvedDottedName)(C,b,d)}}}for(;;){if(u.canDenoteNamedObject){var N=(0,l.nameNode)((0,l.identNamePart)(u.asWhole,u.canDenoteNamedObject,u.label,u.qualifiedLabel),s,u.qualifiedLabel),P=y(e,N,g?f.NameSource.AppHead:f.NameSource.Plain);if(a=(0,m.resolvedDottedName)(P,n.__spreadArray([],c,!0).reverse(),d),(0,i.safePush)(d.names,P.precedents),!(0,p.isSuccess)(P.resolution)&&P.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier||(0,p.isSuccess)(P.resolution)&&void 0!==P.resolution.value)return a;if(g&&(void 0===s||s.kind===l.QualifierKind.Document||s.kind===l.QualifierKind.Ident)){var E=T(e,N);if(a=(0,m.resolvedDottedName)(E,n.__spreadArray([],c,!0).reverse(),d),(0,i.safePush)(d.udfs,E.precedents),!(0,p.isSuccess)(E.resolution)&&E.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier||(0,p.isSuccess)(E.resolution)&&void 0!==E.resolution.value)return a}}if(u.kind===l.NamePartKind.CellRefNamePart&&(null==s&&e.allowUnqualifiedCell||null!=s&&s.kind!==l.QualifierKind.Document)){var k=v(e,(0,l.cellRefNode)(u.ref,null!=s&&s.kind===l.QualifierKind.Ident?(0,l.sheetQualifier)(s.name):s,u.qualifiedLabel));return(0,m.resolvedDottedName)(k,n.__spreadArray([],c,!0).reverse(),d)}if(u.kind!==l.NamePartKind.FieldRefNamePart||(null===(o=u.rhs)||void 0===o?void 0:o.field.kind)!==l.NodeKind.Name)return void 0!==a?a:(0,m.resolvedDottedName)((0,m.resolvedNever)((0,l.nameNode)((0,l.identNamePart)(u.asWhole,u.canDenoteNamedObject,u.label,u.qualifiedLabel),s,u.qualifiedLabel)),n.__spreadArray([],c,!0).reverse(),d);c.push(u.rhs.field.whole),u=u.lhs,g=!1}}}}},2195:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;var n,i,o,a,s=r(7815),l=r(8350);t.resolveLocalsGrid=function(e){return{originGridCell:(0,s.success)(e.range),originSheet:(0,s.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(n=t.ResolveReasonKind||(t.ResolveReasonKind={})),t.noOriginSheet=function(e){return{kind:n.NoOriginSheet,origin:e}},(a=t.InvalidQualifierReason||(t.InvalidQualifierReason={})).UndefinedDocument="UndefinedDocument",a.UndefinedSheetName="UndefinedSheetName",a.SheetRangeName="SheetRangeName",a.DocumentCellRef="DocumentCellRef",a.BadQualifier="BadQualifier",t.invalidQualifier=function(e){return{kind:n.InvalidQualifier,reason:e}},(t.InvalidCellRefReason||(t.InvalidCellRefReason={})).BadCellRef="BadCellRef",t.invalidCellRef=function(e){return{kind:n.InvalidCellRef,reason:e}},(o=t.InvalidStructRefReason||(t.InvalidStructRefReason={})).UndefinedColumnName="UndefinedColumnName",o.UndefinedTableName="UndefinedTableName",o.InvalidOriginSheet="InvalidOriginSheet",o.InvalidOp="InvalidOp",o.MissingTableName="MissingTableName",o.NamedObjectNotTable="NamedObjectNotTable",t.invalidStructRef=function(e){return{kind:n.InvalidStructRef,reason:e}},t.emptyIntersection={kind:n.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(i=t.ResolvedKind||(t.ResolvedKind={})),t.resolvedName=(0,l.typedInstanceCreator)()((function(e,t,r){return{kind:i.ResolvedName,node:e,resolution:t,precedents:r}})),t.resolvedCellRef=(0,l.typedInstanceCreator)()((function(e,t){return{kind:i.ResolvedCellRef,node:e,resolution:t}})),t.resolvedUserDefinedFunc=(0,l.typedInstanceCreator)()((function(e,t,r,n){return{kind:i.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}})),t.resolvedLocalName=(0,l.typedInstanceCreator)()((function(e,t){return{kind:i.ResolvedLocalName,node:e,resolution:t}})),t.resolvedStructRef=(0,l.typedInstanceCreator)()((function(e,t,r,n){return{kind:i.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}})),t.resolvedNever=(0,l.typedInstanceCreator)()((function(e){return{kind:i.ResolvedNever,node:e,resolution:s.successUndefined}})),t.resolvedDottedName=(0,l.typedInstanceCreator)()((function(e,t,r){return{kind:i.ResolvedDottedName,resolved:e,fields:t,precedents:r}}))},5947:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;var n=r(3424),i=r(3494);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});var o,a=r(4611);t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.None),t.higherOrderFunctionType=function(){var e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,a.isFeatureEnabled)(a.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,a.isFeatureEnabled)(a.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(o=t.OperatorId||(t.OperatorId={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),c=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.None),p=(0,n.functionType)(2,2,[l,l],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),m=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),h=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),g=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),v=[];function S(e,t){var r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}v[o.Add]=u,v[o.Sub]=u,v[o.Mul]=u,v[o.Div]=u,v[o.Pow]=u,v[o.Percent]=c,v[o.Neg]=c,v[o.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],v[o.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],v[o.Pos]=d,v[o.Concat]=f,v[o.Eq]=p,v[o.Ne]=p,v[o.Lt]=p,v[o.Le]=p,v[o.Gt]=p,v[o.Ge]=p,v[o.Range]=m,v[o.Isect]=h,v[o.Union]=h,v[o.And]=g,v[o.Or]=g,v[o.Xor]=g,v[o.Min]=u,v[o.Max]=u,t.getOperatorType=function(e){var r=v[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=function(e){var r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},S(i.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),S(i.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),S(i.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),S(i.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),S(i.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),S(i.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),S(i.WorksheetFuncId.NOW,n.SpecialPrecs.Time),S(i.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),S(i.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),S(i.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.INFO,n.SpecialPrecs.None)},6791:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n,i,o,a,s,l,u,c=r(8350);(u=t.FontUnderline||(t.FontUnderline={})).None="None",u.Single="Single",u.Double="Double",u.SingleAccounting="SingleAccounting",u.DoubleAccounting="DoubleAccounting",(0,c.staticAssertSame)(),(l=t.FontVerticalAlignment||(t.FontVerticalAlignment={})).None="None",l.Subscript="Subscript",l.Superscript="Superscript",(0,c.staticAssertSame)(),(s=t.FillKind||(t.FillKind={})).Pattern="Pattern",s.Gradient="Gradient",(a=t.PatternType||(t.PatternType={})).None="None",a.Solid="Solid",a.MediumGray="MediumGray",a.DarkGray="DarkGray",a.LightGray="LightGray",a.DarkHorizontal="DarkHorizontal",a.DarkVertical="DarkVertical",a.DarkDown="DarkDown",a.DarkUp="DarkUp",a.DarkGrid="DarkGrid",a.DarkTrellis="DarkTrellis",a.LightHorizontal="LightHorizontal",a.LightVertical="LightVertical",a.LightDown="LightDown",a.LightUp="LightUp",a.LightGrid="LightGrid",a.LightTrellis="LightTrellis",a.Gray125="Gray125",a.Gray0625="Gray0625",(o=t.BorderLineType||(t.BorderLineType={})).None="None",o.Thin="Thin",o.Medium="Medium",o.Dashed="Dashed",o.Dotted="Dotted",o.Thick="Thick",o.Double="Double",o.Hair="Hair",o.MediumDashed="MediumDashed",o.DashDot="DashDot",o.MediumDashDot="MediumDashDot",o.DashDotDot="DashDotDot",o.MediumDashDotDot="MediumDashDotDot",o.SlantDashDot="SlantDashDot",(0,c.staticAssertSame)(),(i=t.HorizontalAlignment||(t.HorizontalAlignment={})).Automatic="Automatic",i.Left="Left",i.Center="Center",i.Right="Right",i.Fill="Fill",i.Justify="Justify",i.CenterAcrossSelection="CenterAcrossSelection",i.Distributed="Distributed",i.JustifyDistributed="JustifyDistributed",(0,c.staticAssertSame)(),(n=t.VerticalAlignment||(t.VerticalAlignment={})).Top="Top",n.Center="Center",n.Bottom="Bottom",n.Justify="Justify",n.Distributed="Distributed",(0,c.staticAssertSame)()},6524:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badMissingNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpNode=t.badFieldRefNode=t.badStructRefNode=t.badSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;var n=r(9937),i=r(927),o=r(3546),a=r(5947);function s(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Sequence,e,t)}function l(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Unexpected,e,t)}function u(e){return function(t){return void 0===t&&(t=0),(0,o.operatorNode)(e,t)}}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){var i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)},t.isNameLocEqual=function(e,t,r){return(0,i.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.expectTrue=function(e){expect(e).toBeTruthy()},t.relPos=function(e){return(0,o.pos)(o.PosKind.Rel,e)},t.absPos=function(e){return(0,o.pos)(o.PosKind.Abs,e)},t.badSeqNode=s,t.badStructRefNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.FieldRef,e,t)},t.badUnexpNode=l,t.badNumberLiteralNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.ParamName,e,t)},t.badMissingNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Missing,e,t)},t.badCellRefNode=function(e,t,r,n){return void 0===t&&(t=e.indexOf("[")>=0),void 0===r&&(r=0),void 0===n&&(n=0),(0,o.cellRefNode)((0,o.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t){void 0===t&&(t=!0);var r=[l("["),e];return t&&r.push(l("]")),s(r)},t.addNode=u(a.OperatorId.Add),t.subNode=u(a.OperatorId.Sub),t.mulNode=u(a.OperatorId.Mul),t.divNode=u(a.OperatorId.Div),t.powNode=u(a.OperatorId.Pow),t.percentNode=u(a.OperatorId.Percent),t.negNode=u(a.OperatorId.Neg),t.posNode=u(a.OperatorId.Pos),t.concatNode=u(a.OperatorId.Concat),t.eqNode=u(a.OperatorId.Eq),t.neNode=u(a.OperatorId.Ne),t.ltNode=u(a.OperatorId.Lt),t.leNode=u(a.OperatorId.Le),t.gtNode=u(a.OperatorId.Gt),t.geNode=u(a.OperatorId.Ge),t.rangeNode=u(a.OperatorId.Range),t.isectNode=u(a.OperatorId.Isect),t.unionNode=u(a.OperatorId.Union),t.andNode=u(a.OperatorId.And),t.orNode=u(a.OperatorId.Or),t.xorNode=u(a.OperatorId.Xor),t.minNode=u(a.OperatorId.Min),t.maxNode=u(a.OperatorId.Max),t.atNode=u(a.OperatorId.At),t.poundNode=u(a.OperatorId.Pound)},3424:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;var n,i,o,a,s=r(637),l=s.assertions.assertNatural,u=s.assertions.assertFalse,c=s.assertions.assertIndex;(a=t.OperKind||(t.OperKind={}))[a.Number=1]="Number",a[a.String=2]="String",a[a.Boolean=4]="Boolean",a[a.Error=8]="Error",a[a.Range=16]="Range",a[a.Array=32]="Array",a[a.Missing=64]="Missing",a[a.Blank=128]="Blank",a[a.Rich=256]="Rich",(o=t.SignatureType||(t.SignatureType={}))[o.None=0]="None",o[o.Goto=512]="Goto",o[o.Ref3D=1024]="Ref3D",o[o.All=2047]="All",(i=t.SpecialPrecs||(t.SpecialPrecs={}))[i.None=0]="None",i[i.OwnDoc=1]="OwnDoc",i[i.OwnSheet=2]="OwnSheet",i[i.OwnRow=4]="OwnRow",i[i.OwnCol=8]="OwnCol",i[i.OwnRowCopy=16]="OwnRowCopy",i[i.OwnColCopy=32]="OwnColCopy",i[i.OwnDocSheets=64]="OwnDocSheets",i[i.CellProps=128]="CellProps",i[i.AllCells=256]="AllCells",i[i.AllNames=512]="AllNames",i[i.Time=1024]="Time",i[i.Calc=2048]="Calc",i[i.InFilterMode=4096]="InFilterMode",i[i.RefStyle=8192]="RefStyle",i[i.All=16383]="All",(n=t.FunctionFlags||(t.FunctionFlags={}))[n.None=0]="None",n[n.Dark=1]="Dark",n[n.Macro=2]="Macro",n[n.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",n[n.Internal=8]="Internal",n[n.Allow3dRef=16]="Allow3dRef",n[n.HiddenFromUI=32]="HiddenFromUI",t.functionType=function(e,t,r,n,i,o,a,s){if(l("calc.lang.functionType",t),c("calc.lang.functionType",e,t+1),0===n.length?0!==i.length:i.length>=n.length){var d=JSON.stringify(i);u("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(d))}return 0===n.length&&r.length+i.length<t&&(d=JSON.stringify(r),u("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(t,"; given ").concat(d))),{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i,returnType:o,staticPrecs:a,flags:s}}},927:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanNode=t.isNumberNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.getSubExpressionFromPosition=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;var i=r(655),o=r(9745),a=r(9937);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return a.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return a.isSheetGridCell}});var s=r(3546),l=r(3424),u=r(7815),c=r(8350),d=r(8832),f=r(5947),p=r(9937);function m(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,s=t.row,l=t.col,u=t.rows,d=t.cols,f=(0,c.fastMin)(r,s),p=(0,c.fastMin)(n,l),m=(0,c.fastMax)(r+i,s+u)-f,h=(0,c.fastMax)(n+o,l+d)-p;return(0,a.unsafeGridRange)(f,p,m,h)}function h(e,t){return e===t||e.name===t.name&&e.path===t.path}function g(e,t){return h(e.document,t.document)&&e.index===t.index}function v(e,t){return e.row===t.row&&e.col===t.col}function S(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function y(e){return(0,a.isGridCell)(e)?e:(0,a.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return p.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return p.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,a.isGridCell)(e))return t(e,0,0);for(var r=e.row,n=e.rows,i=e.col,o=e.cols,s=0;s<n;s+=1)for(var l=0;l<o;l+=1)if(!t((0,a.gridCell)(r+s,i+l),s,l))return!1;return!0},t.forEachTileInRange=function(e,t,r){var n=e.row,i=e.rows,s=e.col,l=e.cols;(0,o.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,o.assertIndex)("calc.lang.forEachTileInRange",n,a.sheetRows),(0,o.assertIndex)("calc.lang.forEachTileInRange",s,a.sheetCols),(0,o.assertPositiveLength)("calc.lang.forEachTileInRange",i,a.sheetRows-n),(0,o.assertPositiveLength)("calc.lang.forEachTileInRange",l,a.sheetCols-s);for(var u=n;u<n+i;u+=t)for(var d=s;d<s+l;d+=t)if(!r((0,a.unsafeGridRange)(u,d,(0,c.fastMin)(t,i+n-u),(0,c.fastMin)(t,l+s-d))))return!1;return!0},t.gridRangeJoin=m,t.gridRangeJoinOpt=function(e,t){return e?t?m(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,o.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(m)},t.gridRangeIsect=function(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,s=t.row,l=t.col,u=t.rows,d=t.cols,f=(0,c.fastMax)(r,s),p=(0,c.fastMax)(n,l),m=(0,c.fastMin)(r+i,s+u)-f,h=(0,c.fastMin)(n+o,l+d)-p;if(!(m<=0||h<=0))return(0,a.unsafeGridRange)(f,p,m,h)},t.gridRangeIsects=function(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,a=t.row,s=t.col,l=t.rows,u=t.cols;return(0,c.fastMax)(r,a)<(0,c.fastMin)(r+i,a+l)&&(0,c.fastMax)(n,s)<(0,c.fastMin)(n+o,s+u)},t.gridCellImplicitIsect=function(e,t){var r=e.row,n=e.col,i=t.row,o=t.col,s=t.rows,l=t.cols,u=i<=r&&r<i+s,c=o<=n&&n<o+l;return u&&c?(0,a.gridCell)(r,n):u&&1===l?(0,a.gridCell)(r,o):c&&1===s?(0,a.gridCell)(i,n):1===l&&1===s?(0,a.gridCell)(i,o):void 0},t.gridRangeCompare=function(e,t){var r=e.row,n=e.col,i=e.rows,o=e.cols,a=t.row,s=t.col,l=r+i,u=a+t.rows,c=n+o,d=s+t.cols;return r===a&&l===u&&n===s&&c===d?0:r<=a&&l>=u&&n<=s&&c>=d?1:r>=a&&l<=u&&n>=s&&c<=d?-1:void 0},t.gridRangeExcept=function(e,t){var r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],i=[t.row,t.row+t.rows],o=[t.col,t.col+t.cols],s=(0,d.ivlCompare)(r,i),l=(0,d.ivlCompare)(n,o);if(void 0!==s&&s<=0){var u=(0,d.ivlExcept)(n,o);if(void 0!==u)return(0,a.gridRange)(e.row,u[0],e.rows,u[1]-u[0])}if(void 0!==l&&l<=0){var c=(0,d.ivlExcept)(r,i);if(void 0!==c)return(0,a.gridRange)(c[0],e.col,c[1]-c[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=h,t.isSheetIndexEqual=g,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return i.__assign(i.__assign({},e),{__isRange:!1})},t.isNameScopeEqual=function(e,t){return h(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=v,t.isGridRangeEqual=S,t.isSheetGridCellEqual=function(e,t){return g(e.sheet,t.sheet)&&v(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return g(e.sheet,t.sheet)&&S(e.range,t.range)},t.gridRangeAnchor=y,t.sheetGridRangeAnchor=function(e){return(0,a.isSheetGridCell)(e)?e:(0,a.sheetGridCell)(e.sheet,y(e.range))},t.gridCellRange=function(e,t){var r=e.row,n=e.col,i=t.row,o=t.col;return(0,a.unsafeGridRange)((0,c.fastMin)(r,i),(0,c.fastMin)(n,o),Math.abs(i-r)+1,Math.abs(o-n)+1)},t.getSubExpressionFromPosition=function(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,i=!0;i;)switch(i=!1,n.kind){case s.NodeKind.Array:for(var a=n.nodes,l=a.length-1;!i&&l>=0;l-=1)for(var u=a[l],c=u.length-1;!i&&c>=0;c-=1)r(f=u[c])&&(n=f,i=!0);break;case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:var d=n.args.map((function(e){return e.kind===s.NodeKind.Param?e.name.name:e}));for(c=d.length-1;!i&&c>=0;c-=1)r(f=d[c])&&(n=f,i=!0);break;case s.NodeKind.Paren:var f;r(f=n.node)&&(n=f,i=!0);break;case s.NodeKind.Bad:case s.NodeKind.Name:case s.NodeKind.CellRef:case s.NodeKind.StructRef:case s.NodeKind.Literal:break;case s.NodeKind.FieldRef:r(n.lhs)&&(n=n.lhs,i=!0);break;default:(0,o.assertNever)("getSubExpressionFromPosition",n)}return n};var C=[];function R(e){return e.kind===s.NodeKind.Literal&&P(e.oper)}function b(e){return e.kind===s.NodeKind.Literal&&T(e.oper)}function N(e){return e.kind===l.OperKind.Number}function T(e){return e.kind===l.OperKind.Boolean}function P(e){return e.kind===l.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.args.length&&R(e.args[0])?0:e.args.length}(e)?C:e.args},t.isOperatorNode=function(e){return e.kind===s.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===s.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===s.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=R,t.isNumberNode=function(e){return e.kind===s.NodeKind.Literal&&N(e.oper)},t.isBooleanNode=b,t.getArgType=function(e,t,r){var n=e.maxArgs,i=e.headTypes,a=e.restTypes,s=e.tailTypes;if((0,o.assertPositiveInteger)("calc.runtime.getArgType: n",r),(0,o.assertIndex)("calc.runtime.getArgType: i",t,r),t>=n)return l.SignatureType.None;if(t<i.length)return i[t];if(0===a.length)return l.SignatureType.None;if(t<i.length+a.length)return a[t-i.length];var u=(r-i.length)%a.length;return u>s.length?l.SignatureType.None:t>=r-u?s[t-(r-u)]:a[(t-i.length)%a.length]},t.isValidArgsLength=function(e,t){var r=e.minArgs,n=e.maxArgs,i=e.headTypes,o=e.restTypes,a=e.tailTypes;return!(t<r||t>n)&&(t<=i.length+o.length||0!==o.length&&(t-i.length)%o.length<=a.length)},t.shouldFieldRefBeBracketed=function(e,t,r){return r.length>0&&t.field.kind===s.NodeKind.Name&&(b(e)||e.kind===s.NodeKind.Name||e.kind===s.NodeKind.CellRef)},t.isNumberOper=N,t.isStringOper=function(e){return e.kind===l.OperKind.String},t.isBooleanOper=T,t.isErrorOper=function(e){return e.kind===l.OperKind.Error},t.isRangeOper=function(e){return e.kind===l.OperKind.Range},t.isArrayOper=function(e){return e.kind===l.OperKind.Array},t.isMissingOper=P,t.isBlankOper=function(e){return e.kind===l.OperKind.Blank},t.isRichOper=function(e){return e.kind===l.OperKind.Rich};var E=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&E)};var k,O=E|l.OperKind.Error|l.OperKind.Array|l.OperKind.Rich;t.isWriteOper=function(e){return 0!=(e.kind&O)},t.isReadOperEqual=function e(t,r,n,i){if(n.kind!==r.kind)return!1;switch(n.kind){case l.OperKind.Boolean:case l.OperKind.String:return n.value===r.value;case l.OperKind.Number:return 0===t.cond2(n,r);case l.OperKind.Error:return n.type===r.type;case l.OperKind.Rich:return i;case l.OperKind.Array:var a=r;if(n.cols!==a.cols||n.rows!==a.rows)return!1;for(var s=0;s<n.rows;s+=1)for(var u=n.opers[s],c=a.opers[s],d=0;d<n.cols;d+=1)if(!e(t,c[d],u[d],i))return!1;return!0;case l.OperKind.Blank:return!0;default:return(0,o.assertNever)("calc.lang.readOperEq",n)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(k=t.LangReasonKind||(t.LangReasonKind={})),t.ReasonKind=i.__assign(i.__assign({},u.ReasonKind),k),t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return 0===e.length&&(0,o.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};var A="_xlfn.",I="_xlws.";t.getWorksheetFuncId=function(e,t){var r=t;return r.length>A.length&&0===e.stringCompareCI(r.substring(0,A.length),A)&&(r=r.substring(A.length)).length>I.length&&0===e.stringCompareCI(r.substring(0,I.length),I)&&(r=r.substring(I.length)),e.getWorksheetFuncId(r)};var _="_xludf.";t.getUserDefinedFuncName=function(e,t){var r=t;return r.length>_.length&&0===e.stringCompareCI(r.substring(0,_.length),_)&&(r=r.substring(_.length)),r};var F="_xlpm.";function M(e){return e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.BadRef||e.isBracketed}function D(e){return e.kind===s.StructRefKind.MissingRef||e.kind===s.StructRefKind.BadRef}function w(e){switch(e.kind){case s.StructRefKind.SpecialRef:case s.StructRefKind.ColumnRef:return e.isClosed;case s.StructRefKind.RangeOpRef:return w(e.lhs)&&w(e.rhs);case s.StructRefKind.MissingRef:return!0;case s.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){var r=t;return r.length>F.length&&0===e.stringCompareCI(r.substring(0,F.length),F)&&(r=r.substring(F.length)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(M)&&function(e){var t=e.specialRefs,r=Object.keys(t).reduce((function(e,r){return e+(t[Number(r)]?1:0)}),0);return 1===r||2===r&&t[s.SpecialRefId.Data]&&(t[s.SpecialRefId.Headers]||t[s.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(w)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(D)},t.isRangeOpClosed=function(e){return w(e.lhs)&&w(e.rhs)},t.isRangeOpNoMissing=function(e){return!D(e.lhs)&&!D(e.rhs)};var L=((n={})[s.SpecialRefId.All]=1,n[s.SpecialRefId.Headers]=2,n[s.SpecialRefId.Data]=3,n[s.SpecialRefId.Totals]=4,n[s.SpecialRefId.ThisRow]=5,n),x=function(e){return e.kind===s.StructRefKind.MissingRef?7:e.kind!==s.StructRefKind.SpecialRef?6:L[e.id]};function B(e,t){return x(e)-x(t)}t.normalizeCommaOpRef=function(e){for(var t={},r=[],n=0,i=e.refs;n<i.length;n++){var o=i[n];o.kind!==s.StructRefKind.SpecialRef?r.push(o):void 0===t[o.id]&&(t[o.id]=!0,r.push(o))}return r.sort(B),r},t.applyComparison=function(e,t){switch(e){case f.OperatorId.Eq:return 0===t;case f.OperatorId.Ne:return 0!==t;case f.OperatorId.Lt:return t<0;case f.OperatorId.Gt:return t>0;case f.OperatorId.Le:return t<=0;case f.OperatorId.Ge:return t>=0}}},2294:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;var i,o,a=r(637),s=a.assertions.assertNatural,l=a.assertions.assertPositiveInteger,u=a.assertions.assertFalse,c=a.util.partialArray,d=r(3424);function f(e){return{kind:d.OperKind.Error,type:e}}(o=t.PrecsBound||(t.PrecsBound={}))[o.Lower=-1]="Lower",o[o.Exact=0]="Exact",o[o.Upper=1]="Upper",t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL"}(i=t.ErrorType||(t.ErrorType={})),t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:d.OperKind.String,value:e}},t.errorOper=function(e){var t=p[e];return void 0!==t?t:f(e)},t.nullErrorOper=f(i.NULL),t.div0ErrorOper=f(i.DIV0),t.valueErrorOper=f(i.VALUE),t.refErrorOper=f(i.REF),t.nameErrorOper=f(i.NAME),t.numErrorOper=f(i.NUM),t.naErrorOper=f(i.NA),t.gettingDataErrorOper=f(i.GETTING_DATA),t.spillErrorOper=f(i.SPILL),t.connectErrorOper=f(i.CONNECT),t.blockedErrorOper=f(i.BLOCKED),t.unknownErrorOper=f(i.UNKNOWN),t.fieldErrorOper=f(i.FIELD),t.calcErrorOper=f(i.CALC),t.busyErrorOper=f(i.BUSY),t.externalErrorOper=f(i.EXTERNAL);var p=c(((n={})[i.NULL]=t.nullErrorOper,n[i.DIV0]=t.div0ErrorOper,n[i.VALUE]=t.valueErrorOper,n[i.REF]=t.refErrorOper,n[i.NAME]=t.nameErrorOper,n[i.NUM]=t.numErrorOper,n[i.NA]=t.naErrorOper,n[i.GETTING_DATA]=t.gettingDataErrorOper,n[i.SPILL]=t.spillErrorOper,n[i.CONNECT]=t.connectErrorOper,n[i.BLOCKED]=t.blockedErrorOper,n[i.UNKNOWN]=t.unknownErrorOper,n[i.FIELD]=t.fieldErrorOper,n[i.CALC]=t.calcErrorOper,n[i.BUSY]=t.busyErrorOper,n[i.EXTERNAL]=t.externalErrorOper,n));t.arrayOper=function(e,t,r){return s("calc.lang.arrayOper",e),s("calc.lang.arrayOper",t),r.length!==e?u("calc.lang.arrayOper: Inconsistent row number"):{kind:d.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return l("calc.lang.rangeSeqOper",t.length),{kind:d.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:d.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:d.OperKind.Missing},t.blankOper={kind:d.OperKind.Blank},t.trueOper={kind:d.OperKind.Boolean,value:!0},t.falseOper={kind:d.OperKind.Boolean,value:!1}},9017:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;var n=r(655),i=r(9745),o=r(8350),a=r(8308),s=r(3546);function l(e,t){switch(t.kind){case s.NodeKind.Literal:var r=t.oper,n=t.isClosed,o=t.label;return e.literalNode(r,n,o);case s.NodeKind.Array:var a=t.nodes;return n=t.isClosed,o=t.label,e.arrayNode(a,n,o);case s.NodeKind.App:var l=t.head,u=t.args;return n=t.isClosed,o=t.label,e.appNode(l,u,n,o);case s.NodeKind.Let:l=t.head;var c=t.vars,d=t.body,f=t.badArgs;return n=t.isClosed,o=t.label,e.letNode(l,c,d,f,n,o);case s.NodeKind.Lambda:l=t.head;var p=t.params;return d=t.body,f=t.badArgs,n=t.isClosed,o=t.label,e.lambdaNode(l,p,d,f,n,o);case s.NodeKind.Paren:var m=t.node;return n=t.isClosed,o=t.label,e.parenNode(m,n,o);case s.NodeKind.Name:var h=t.parts,g=t.qualifier;return o=t.label,e.nameNode(h,g,o);case s.NodeKind.CellRef:var v=t.ref;return g=t.qualifier,o=t.label,e.cellRefNode(v,g,o);case s.NodeKind.FieldRef:var S=t.lhs,y=t.rhs,C=t.shouldBeBracketed;return o=t.label,e.fieldRefNode(S,y,C,o);case s.NodeKind.StructRef:return S=t.lhs,y=t.rhs,o=t.label,e.structRefNode(S,y,o);case s.NodeKind.Bad:switch(o=t.label,t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents,o);default:return e.badStringNode(t.type,t.contents,o)}default:return(0,i.assertNever)("calc.lang.visitFormulaNode",t)}}function u(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function c(e,t){var r=t.id,n=t.whole,i=t.label;return e.wsfNode(r,n,i)}function d(e,t){switch(t.kind){case s.NodeKind.Operator:return u(e,t);case s.NodeKind.WSF:return c(e,t);default:return l(e,t)}}function f(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=l,t.visitOperatorNode=u,t.visitWSFNode=c,t.visitAppHeadNode=d,t.visitQualifier=function(e,t){switch(t.kind){case s.QualifierKind.Error:var r=t.label;return e.errorQualifier(r);case s.QualifierKind.Relative:return r=t.label,e.relativeQualifier(r);case s.QualifierKind.Document:var n=t.document,o=t.path,a=t.isQuoted;return r=t.label,e.documentQualifier(n,o,a,r);case s.QualifierKind.Sheet:var l=t.sheet,u=t.document;return a=t.isQuoted,r=t.label,e.sheetQualifier(l,u,a,r);case s.QualifierKind.Ident:var c=t.name;return a=t.isQuoted,r=t.label,e.identQualifier(c,a,r);case s.QualifierKind.SheetRange:var d=t.sheet1,f=t.sheet2,p=t.document;return a=t.isQuoted,r=t.label,e.sheetRangeQualifier(d,f,p,a,r);case s.QualifierKind.Bad:var m=t.chars;return a=t.isQuoted,r=t.label,e.badQualifier(m,a,r);default:return(0,i.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case s.CellRefKind.Error:var r=t.label;return e.cellRefError(r);case s.CellRefKind.Single:var n=t.row,o=t.col,a=t.isBracketed;return r=t.label,e.cellRefSingle(n,o,a,r);case s.CellRefKind.Range:var l=t.ref1,u=t.ref2;return r=t.label,e.cellRefRange(l,u,r);case s.CellRefKind.Row:var c=t.row1,d=t.row2;return a=t.isBracketed,r=t.label,e.cellRefRow(c,d,a,r);case s.CellRefKind.Col:var f=t.col1,p=t.col2;return a=t.isBracketed,r=t.label,e.cellRefCol(f,p,a,r);case s.CellRefKind.Bad:var m=t.chars;return a=t.isBracketed,r=t.label,e.cellRefBad(m,a,r);default:return(0,i.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=f;var p=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return(0,s.literalNode)(e,t,r)},e.prototype.arrayNode=function(e,t,r){return(0,s.arrayNode)(e,t,r)},e.prototype.appNode=function(e,t,r,n){return(0,s.appNode)(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,o){return(0,s.letNode)(e,t,r,n,i,o)},e.prototype.lambdaNode=function(e,t,r,n,i,o){return(0,s.lambdaNode)(e,t,r,n,i,o)},e.prototype.parenNode=function(e,t,r){return(0,s.parenNode)(e,t,r)},e.prototype.nameNode=function(e,t,r){return(0,s.nameNode)(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return(0,s.cellRefNode)(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return(0,s.fieldRefNode)(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return(0,s.structRefNode)(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return(0,s.badNode)(e,t,r)},e.prototype.badStringNode=function(e,t,r){return(0,s.badNode)(e,t,r)},e.prototype.operatorNode=function(e,t){return(0,s.operatorNode)(e,t)},e.prototype.wsfNode=function(e,t,r){return(0,s.wsfNode)(e,t,r)},e}();t.IdentityVisitor=p,t.identityVisitor=f(new p);var m=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,i,o){return this.value},e.prototype.lambdaNode=function(e,t,r,n,i,o){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r,n){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badStringNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function h(e){return f(new m(e))}t.ConstVisitor=m,t.constVisitor=h,t.voidVisitor=h(void 0);var g=function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,o){return this.visitor.letNode(e,t,r,n,i,o)},e.prototype.lambdaNode=function(e,t,r,n,i,o){return this.visitor.lambdaNode(e,t,r,n,i,o)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badStringNode=function(e,t,r){return this.visitor.badStringNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}();t.DelegatingVisitor=g;var v=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return n.__extends(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,i,o,a){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){return e.binder.arg})),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.lambdaNode=function(e,t,r,i,a,s){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})).filter(o.isDefined),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r,n){return e},t.prototype.badSequenceNode=function(e,t,r){return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(g);function S(e,t){return f(new v(e,t))}t.BinaryVisitor=v,t.binaryVisitor=S;var y=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,i,o){return this.b(this.a.letNode(e,t,r,n,i,o))},e.prototype.lambdaNode=function(e,t,r,n,i,o){return this.b(this.a.lambdaNode(e,t,r,n,i,o))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badStringNode=function(e,t,r){return this.b(this.a.badStringNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function C(e,t){return f(new y(e,t))}t.ComposeVisitor=y,t.composeVisitor=C,t.depthVisitor=C(S(h(0),o.fastMax),(function(e){return e+1}));var R=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var i={},o=0,a=this.keys;o<a.length;o++){var s=a[o];i[s]=this.visitors[s].appNode(e,t,r,n)}return i},e.prototype.letNode=function(e,t,r,n,i,o){for(var a={},s=0,l=this.keys;s<l.length;s++){var u=l[s];a[u]=this.visitors[u].letNode(e,t,r,n,i,o)}return a},e.prototype.lambdaNode=function(e,t,r,n,i,o){for(var a={},s=0,l=this.keys;s<l.length;s++){var u=l[s];a[u]=this.visitors[u].lambdaNode(e,t,r,n,i,o)}return a},e.prototype.parenNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r,n){for(var i={},o=0,a=this.keys;o<a.length;o++){var s=a[o];i[s]=this.visitors[s].fieldRefNode(e,t,r,n)}return i},e.prototype.structRefNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].structRefNode(e,t,r)}return n},e.prototype.badSequenceNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].badSequenceNode(e,t,r)}return n},e.prototype.badStringNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].badStringNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,i=this.keys;n<i.length;n++){var o=i[n];r[o]=this.visitors[o].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].wsfNode(e,t,r)}return n},e}();function b(e,t){var r=function(t){switch(t.kind){case s.NodeKind.Literal:var n=t.oper,o=t.isClosed,a=t.label;return e.literalNode(n,o,a);case s.NodeKind.Array:var l=t.nodes;return o=t.isClosed,a=t.label,e.arrayNode(l.map((function(e){return e.map(r)})),o,a);case s.NodeKind.App:var d=t.head,f=t.args;return o=t.isClosed,a=t.label,e.appNode(function(t){switch(t.kind){case s.NodeKind.Operator:return u(e,t);case s.NodeKind.WSF:return c(e,t);default:return r(t)}}(d),f.map(r),o,a);case s.NodeKind.Let:d=t.head;var p=t.vars,m=t.body,h=t.badArgs;return o=t.isClosed,a=t.label,e.letNode(c(e,d),p.map((function(e){var t=e.name,n=e.binder;return(0,s.letVar)(t,(0,s.indexedArg)(r(n.arg),n.index))})),void 0===m?void 0:(0,s.indexedArg)(r(m.arg),m.index),h.map((function(e){return(0,s.indexedArg)(r(e.arg),e.index)})),o,a);case s.NodeKind.Lambda:d=t.head;var g=t.params;return m=t.body,h=t.badArgs,o=t.isClosed,a=t.label,e.lambdaNode(c(e,d),g.map((function(e){var t=e.name;return void 0===t.arg.def?(0,s.lambdaParam)(t):(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(t.arg.name,(0,s.paramDefault)(r(t.arg.def.rhs),t.arg.def.label),t.arg.label),t.index))})),void 0===m?void 0:(0,s.indexedArg)(r(m.arg),m.index),h.map((function(e){return(0,s.indexedArg)(r(e.arg),e.index)})),o,a);case s.NodeKind.Paren:var v=t.node;return o=t.isClosed,a=t.label,e.parenNode(r(v),o,a);case s.NodeKind.Name:var S=t.parts,y=t.qualifier;return a=t.label,e.nameNode(S,y,a);case s.NodeKind.CellRef:var C=t.ref;return y=t.qualifier,a=t.label,e.cellRefNode(C,y,a);case s.NodeKind.FieldRef:var R=t.lhs,b=t.rhs,N=t.shouldBeBracketed;return a=t.label,e.fieldRefNode(r(R),b,N,a);case s.NodeKind.StructRef:return R=t.lhs,b=t.rhs,a=t.label,e.structRefNode(R,b,a);case s.NodeKind.Bad:switch(a=t.label,t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),a);default:return e.badStringNode(t.type,t.contents,a)}default:return(0,i.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function N(e,t,r,n){var i=[],o=function(e){return i.push(e),a},a=function(){return i.length<t.length?r(e,t[i.length],o):n(i)};return a}function T(e,t,r){return N(e,t,I,r)}function P(e,t,r,n){return function(){return void 0!==t?r(e,t,n):n(void 0)}}function E(e,t,r){var n=t.id,i=t.whole,o=t.label;return function(){return r(e.wsfNode(n,i,o))}}function k(e,t,r){var n=t.name,i=t.binder;return I(e,i.arg,(function(e){return r((0,s.letVar)(n,(0,s.indexedArg)(e,i.index)))}))}function O(e,t,r){var n=t.name,i=n.arg;return void 0===i.def?function(){return r((0,s.lambdaParam)(n))}:I(e,i.def.rhs,(function(e){return r((0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(i.name,(0,s.paramDefault)(e,i.def.label),i.label),n.index)))}))}function A(e,t,r){var n=t.arg,i=t.index;return I(e,n,(function(e){return r((0,s.indexedArg)(e,i))}))}function I(e,t,r){switch(t.kind){case s.NodeKind.Literal:var n=t.oper,o=t.isClosed,a=t.label;return function(){return r(e.literalNode(n,o,a))};case s.NodeKind.Array:var l=t.nodes,u=t.isClosed,c=t.label;return N(e,l,T,(function(t){return r(e.arrayNode(t,u,c))}));case s.NodeKind.App:var d=t.head,f=t.args,p=t.isClosed,m=t.label;return function(){return function(e,t,r){switch(t.kind){case s.NodeKind.Operator:var n=t.id,i=t.label;return function(){return r(e.operatorNode(n,i))};case s.NodeKind.WSF:return E(e,t,r);default:return I(e,t,r)}}(e,d,(function(t){return T(e,f,(function(n){return r(e.appNode(t,n,p,m))}))}))};case s.NodeKind.Let:var h=t.head,g=t.vars,v=t.body,S=t.badArgs,y=t.isClosed,C=t.label;return function(){return E(e,h,(function(t){return N(e,g,k,(function(n){return P(e,v,A,(function(i){return N(e,S,A,(function(o){return r(e.letNode(t,n,i,o,y,C))}))}))}))}))};case s.NodeKind.Lambda:var R=t.head,b=t.params,_=t.body,F=t.badArgs,M=t.isClosed,D=t.label;return function(){return E(e,R,(function(t){return function(){return N(e,b,O,(function(n){return P(e,_,A,(function(i){return N(e,F,A,(function(o){return r(e.lambdaNode(t,n,i,o,M,D))}))}))}))}}))};case s.NodeKind.Paren:var w=t.node,L=t.isClosed,x=t.label;return function(){return I(e,w,(function(t){return function(){return r(e.parenNode(t,L,x))}}))};case s.NodeKind.Name:var B=t.parts,U=t.qualifier,G=t.label;return function(){return r(e.nameNode(B,U,G))};case s.NodeKind.CellRef:var K=t.ref,V=t.qualifier,j=t.label;return function(){return r(e.cellRefNode(K,V,j))};case s.NodeKind.FieldRef:var W=t.lhs,H=t.rhs,Q=t.shouldBeBracketed,q=t.label;return function(){return I(e,W,(function(t){return function(){return r(e.fieldRefNode(t,H,Q,q))}}))};case s.NodeKind.StructRef:var z=t.lhs,Y=t.rhs,J=t.label;return function(){return r(e.structRefNode(z,Y,J))};case s.NodeKind.Bad:var X=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:var $=t.type,Z=t.contents;return T(e,Z,(function(t){return r(e.badSequenceNode($,t,X))}));default:var ee=t.type,te=t.contents;return function(){return r(e.badStringNode(ee,te,X))}}default:return(0,i.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function _(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(I(e,t,(function(e){r=e}))),r}t.ZipVisitor=R,t.zipVisitor=function(e){return f(new R(e))},t.reduceBottomUp_Recursive=b,t.reduceBottomUp_CPS=_;var F=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return l(t,e)},this.lazyVisitFormulaNode=function(e){return a.Pledge.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return d(t,e)},this.lazyVisitAppHeadNode=function(e){return a.Pledge.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return c(t,e)},this.lazyVisitWSFNode=function(e){return a.Pledge.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e.name,n=e.binder;return t.lazyVisitFormulaNode(n.arg).bind((function(e){return(0,s.letVar)(r,(0,s.indexedArg)(e,n.index))}))},this.lazyVisitParam=function(e){var r=e.name,n=r.arg;return void 0===n.def?a.Pledge.resolve((0,s.lambdaParam)(r)):t.lazyVisitFormulaNode(n.def.rhs).bind((function(e){return(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(n.name,(0,s.paramDefault)(e,n.def.label),n.label),r.index))}))},this.lazyVisitIndexedArg=function(e){var r=e.arg,n=e.index;return t.lazyVisitFormulaNode(r).bind((function(e){return(0,s.indexedArg)(e,n)}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return a.Pledge.all(e.map((function(e){return a.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var i=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return a.Pledge.all(t.map(i.lazyVisitFormulaNode)).bind((function(t){return i.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,i,o){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return a.Pledge.all(t.map(s.lazyVisitVar)).bind((function(t){return(void 0===r?a.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return a.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.letNode(e,t,r,n,i,o)}))}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,i,o){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return a.Pledge.all(t.map(s.lazyVisitParam)).bind((function(t){return(void 0===r?a.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return a.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.lambdaNode(e,t,r,n,i,o)}))}))}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r,n){var i=this;return this.lazyVisitFormulaNode(e).bind((function(e){return i.visitor.fieldRefNode(e,t,r,n)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return a.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badStringNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.badStringNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return a.Pledge.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();function M(e,t,r){return r<=50?b(e,t):_(e,t)}function D(e,t){return a.Pledge.settleOrThrow(a.Pledge.resolve(l(e,t)))}t.PledgeReducer=F,t.reduceBottomUp_Pledge=function(e,t){return D(new F(e),t)},t.reduceBottomUp_MaxDepth=M,t.reduceBottomUp=function(e,t){return M(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=D,t.reducePledge=function(e,t){return D(e,t.node)}},3684:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(6059);function i(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=i,t.isChangeGateEnabled=function(e){var t;return null===(t=i()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},8830:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(6059),i={};function o(){return"undefined"==typeof __get_feature_gate_dictionary_variable?i:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var i=parseFloat(n);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var i=parseInt(n,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},6059:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(7933);t.globalThis=n},9992:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(655);n.__exportStar(r(8830),t),n.__exportStar(r(3851),t),n.__exportStar(r(3684),t),n.__exportStar(r(3623),t),n.__exportStar(r(1352),t),n.__exportStar(r(5106),t)},3851:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(8830);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},3623:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(3684);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},1352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(655),i=r(3684);function o(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return(0,i.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},5106:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(655),i=r(8830);function o(e){for(var t,r,o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];o[l]=null===(t=e[l])||void 0===t?void 0:t.toString()}var u=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},u()),o)})),u}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},4143:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;const n=r(4063),i=r(2720),o=r(4319);t.createAnalyzer=function(e){return{checkFormula:(t,r)=>(0,n.checkFormula)(e,t,r),checkFormulaWithDiagnostics:(t,r)=>(0,n.checkFormulaWithDiagnostics)(e,t,r),autocorrectFormula:(t,r)=>(0,i.autocorrectFormula)(e,t,r),resolveStaticPrecedents:(t,r)=>(0,o.resolveStaticPrecedents)(e,t,r)}}},2720:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;const n=r(9866),i=r(6982),o=r(4666),a=r(3357),s=r(7512),l=r(73),u=r(8449),c={getDocumentLoc:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc"),getSheetIndex:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex"),getSheetName:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName"),getNameLoc:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes"),getContainingTable:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable"),getStructRefColumn:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")},d=(0,i.createFailureErrorClass)("AutocorrectError"),f=Object.assign(Object.assign({},(0,s.binaryVisitor)((0,s.constVisitor)(!1),(e,t)=>e||t)),{badSequenceNode:(e,t,r)=>!0,badStringNode:(e,t,r)=>!0});class p extends s.IdentityVisitor{constructor(e,t,r){super(),this.f=r,this.seenUnclosed=!1,this.seenParen=!1,this.seenMissingOperand=!1,this.globals=function(e){var t,r,n,i,o,a,s,l,u,d,f,p,m,h,g,v,S,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:c.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:c.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:c.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:c.getNameLoc,getUserDefinedFuncLoc:null!==(d=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==d?d:c.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(p=null===(f=e.getSheetRangeIndexes)||void 0===f?void 0:f.bind(e))&&void 0!==p?p:c.getSheetRangeIndexes,getContainingTable:null!==(h=null===(m=e.getContainingTable)||void 0===m?void 0:m.bind(e))&&void 0!==h?h:c.getContainingTable,getStructRefColumn:null!==(v=null===(g=e.getStructRefColumn)||void 0===g?void 0:g.bind(e))&&void 0!==v?v:c.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(S=e.getStructRefSpecialRef)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:c.getStructRefSpecialRef}}(e),this.locals=t,this.resolver=(0,u.createResolver)(this.globals)}autocorrect(){return(0,s.reduceBottomUp)(f,this.f)?this.f.node:(0,s.reduceBottomUp)(this,this.f)}literalNode(e,t,r){return t||(this.seenUnclosed=!0),(0,n.literalNode)(e,t,r)}nameNode(e,t,r){const i=(0,n.nameNode)(e,t,r),s=(0,n.flattenNameParts)(e);if(s.kind===n.NamePartKind.CellRefNamePart){const{resolved:e}=this.resolver.resolveDottedName(this.locals,i,this.f.annotations);if(e.kind===l.ResolvedKind.ResolvedCellRef){const{ref:r,qualifier:i,label:a}=e.node,{ref:l}=this.cellRefNode(r,i,a);(0,o.assertTrue)("calc.analyze.autocorrectFormula",s.kind===n.NamePartKind.CellRefNamePart);const[u,c,...d]=s.parts,f=(e,{rhs:t,canDenoteNamedObject:r,label:i,qualifiedLabel:o})=>(0,n.fieldRefNamePart)(e,t,r,i,o);return(0,n.nameNode)(d.reduce(f,f((0,n.cellRefNamePart)(l,u.asWhole,u.label,u.qualifiedLabel),c)),t,a)}if(e.resolution.kind!==a.ResultKind.Success&&e.resolution.reason.kind!==l.ResolveReasonKind.NoOriginSheet&&e.resolution.reason.kind!==l.ResolveReasonKind.InvalidQualifier)throw new d(e.resolution.reason)}return i}arrayNode(e,t,r){return t||(this.seenUnclosed=!0),(0,n.arrayNode)(e,t,r)}appNode(e,t,r,o){const a=this.appNodeBase(e,r,o);return r||(this.seenUnclosed=!0),(0,i.isOperatorNode)(e)||(this.seenParen=!0),(0,i.isOperatorNode)(e)&&t.some(i.isMissingNode)&&(this.seenMissingOperand=!0),(0,n.appNode)(e,t,a,o)}letNode(e,t,r,i,o,a){const s=this.appNodeBase(e,o,a);return o||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.letNode)(e,t,r,i,s,a)}lambdaNode(e,t,r,i,o,a){const s=this.appNodeBase(e,o,a);return o||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.lambdaNode)(e,t,r,i,s,a)}parenNode(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,n.parenNode)(e,t,r)}cellRefNode(e,t,r){const{localeInfo:i}=this.globals.config;return e.isBracketed&&"("===i.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,n.cellRefNode)(e,t,r):(0,n.cellRefNode)(e,this.qualifyCellRef(),r)}fieldRefNode(e,t,r,i){return t.isClosed||(this.seenUnclosed=!0),(0,n.fieldRefNode)(e,t,r,i)}structRefNode(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,n.structRefNode)(e,t,r)}qualifyCellRef(){const e=this.locals.originSheet;if(!(0,a.isSuccess)(e))throw new d(e.reason);if(void 0===e.value.index)return;const t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,a.isSuccess)(t))throw new d(t.reason);return(0,n.sheetQualifier)(t.value,void 0)}appNodeBase(e,t,r){return t||!(0,i.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand}isFormulaRoot(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===n.AnnotationKind.FormulaRoot}}t.autocorrectFormula=function(e,t,r){try{const{spans:i,annotations:o,depthUpperBound:s}=r,l=new p(e,t,r).autocorrect();return(0,a.success)((0,n.formula)(l,i,o,s))}catch(e){return e instanceof d?(0,a.failure)(e.reason):(0,a.failure)((0,a.javaScriptError)(e))}}},4063:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;const n=r(4666),i=r(2518),o=r(5761),a=r(3477),s=r(6982),l=r(6672),u=r(9866),c=r(5630),d=r(1416),f=r(3357),p=r(7082),m=r(869),h={};function g(e,t){return{context:e,result:t}}function v(e){return t=>t.kind===u.NodeKind.Literal&&e(t.oper)}const S=v(s.isMissingOper),y=v(s.isNumberOper),C=l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error,R=v(e=>0!=(e.kind&C));function b(e,t,r,n=!1){n||(e.errorData=e.reportError(t,r,e.errorData))}function N(e,t){return t!==l.OperKind.Range||0!=(e&l.OperKind.Range)}function T(e,t){if(t.kind===u.NodeKind.Literal)switch(b(e,t,o.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case l.OperKind.Number:case l.OperKind.Boolean:case l.OperKind.String:case l.OperKind.Error:return;default:return void b(e,t,o.baseErrors.Illegal_array_literal_element)}b(e,t,o.baseErrors.Illegal_array_literal_element)}function P(e,t,r,i){return m.Pledge.try(()=>{if(e.earlyExit&&!e.isOk())throw h;return A(e,t)}).bind(a=>(N(a.result,r)||((0,n.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==i),b(e,t,{kind:o.TypeError.Types_not_related,typeGiven:a.result,typeExpected:r,typeSource:i})),a.result=r,a))}function E(e,t,r){if((0,s.isUnqualifiedNameNode)(r)&&r.parts.kind===u.NamePartKind.IdentNamePart){const n=(0,s.getBoundName)(e.localeInfo,r.whole);return b(e,r,o.baseErrors.Invalid_binder,n.indexOf(".")<0),b(e,r,o.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return b(e,r,r.kind===u.NodeKind.Bad&&r.type===u.BadType.Missing?o.baseErrors.Missing_binder:o.baseErrors.Invalid_binder),t}const k=e=>0===e.args.length?e:e.args[e.args.length-1];function O(e,t,r){return m.Pledge.try(()=>{var c;const f=(0,d.getWorksheetFuncType)(t),{minArgs:h,maxArgs:v,headTypes:S,restTypes:y,tailTypes:C,flags:R}=f,N=r.args,T=N.length,O=(0,s.getArguments)(r).length;if(b(e,r.head,o.baseErrors.Invalid_function_name,0==(R&l.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad),O<h)switch(t){case d.WorksheetFuncId.IF:case d.WorksheetFuncId.LET:case d.WorksheetFuncId.LETREC:case d.WorksheetFuncId.LAMBDA:break;default:const n=N[T-1];b(e,void 0===n?r:n,{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:O,numArgsExpected:h})}if(O>v){const n=N[T-1];b(e,void 0===n?r:n,{kind:o.TypeError.Excess_function_arguments,funcId:t,numArgsGiven:O,numArgsExpected:v})}else if(y.length>1&&O>S.length+y.length){const n=(O-S.length)%y.length;n>C.length&&b(e,k(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:O,numArgsExpected:O+(y.length-n)})}const I=r.kind===u.NodeKind.App?(0,s.getArguments)(r).map((r,n)=>P(e,r,(0,s.getArgType)(f,n,O),{kind:o.TypeSourceKind.WSFArgument,head:t,argIndex:n,numArgsGiven:O})):[...r.kind===u.NodeKind.Let?r.vars.map(({binder:e})=>e.arg):r.params.map(({name:e})=>{var t;return null===(t=e.arg.def)||void 0===t?void 0:t.rhs}),null===(c=r.body)||void 0===c?void 0:c.arg].filter(i.isDefined).map(t=>A(e,t));return m.Pledge.all(I).bind(l=>(function(e,t,r){const l=(0,s.getArguments)(r).length;switch(t){case d.WorksheetFuncId.IF:const c=e.locals.lexicalKind===p.LexicalKind.NameManager?1:2;return void(l<c&&b(e,k(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:l,numArgsExpected:c}));case d.WorksheetFuncId._UDF:return b(e,r,o.baseErrors.Unexpected_application_head);case d.WorksheetFuncId.LET:case d.WorksheetFuncId.LETREC:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===u.NodeKind.Let);let s=a.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(const{name:t}of r.vars)s=E(e,s,t.arg);for(const t of r.badArgs)b(e,t.arg,o.baseErrors.Invalid_binder);b(e,k(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:l,numArgsExpected:(0,i.fastMax)(3,l+1+l%2)},l>=3&&void 0!==r.body);break}case d.WorksheetFuncId.LAMBDA:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===u.NodeKind.Lambda);let i=a.RedBlackMapTree.create(e.localeInfo.stringCompareCI),c=!1;for(const{name:t}of r.params)b(e,t.arg.name,o.baseErrors.Unclosed_bracket,t.arg.name.isClosed),void 0!==t.arg.def&&(b(e,t.arg.name,o.baseErrors.Binder_requires_brackets,t.arg.name.isBracketed),b(e,t.arg.def.rhs,o.baseErrors.Missing_default_expression,!(0,s.isMissingNode)(t.arg.def.rhs))),t.arg.isOptional?c=!0:b(e,t.arg,o.baseErrors.Mandatory_binder_after_optional,!c),i=E(e,i,t.arg.name.name);for(const t of r.badArgs)b(e,t.arg,o.baseErrors.Invalid_binder);b(e,k(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:l,numArgsExpected:l+1},l>=1&&void 0!==r.body),void 0!==r.body&&b(e,r.body.arg,o.baseErrors.Invalid_body,0===l||!(0,s.isMissingNode)(r.body.arg));break}}}(e,t,r),g(e,f.returnType)))})}function A(e,t){return m.Pledge.try(()=>{var r,i,a,f,p,v,C,E,k;if(e.earlyExit&&!e.isOk())throw h;switch(t.kind){case u.NodeKind.App:case u.NodeKind.Let:case u.NodeKind.Lambda:return function(e,t){return m.Pledge.try(()=>{if(b(e,t,o.baseErrors.Unclosed_application,t.isClosed),(0,s.isWSFNode)(t.head))return O(e,t.head.id,t);const r=t,n=r.args,i=n.length,a=(0,s.getArguments)(r).length;if((0,s.isOperatorNode)(t.head))return function(e,t,r){return m.Pledge.try(()=>{const n=(0,d.getOperatorType)(t.id),i=r.length;let a=i===n.minArgs;return b(e,t,{kind:o.TypeError.Incorrect_number_of_operator_arguments,opId:t.id},a),m.Pledge.all(r.map((r,l)=>m.Pledge.try(()=>(S(r)&&(a=!1,b(e,r,{kind:o.SyntaxError.Missing_operation_argument,opId:t.id})),P(e,r,(0,s.getArgType)(n,l,i),{kind:o.TypeSourceKind.OperatorArgument,head:t.id,argIndex:l,numArgsGiven:i}))))).bind(t=>g(e,a?n.returnType:l.SignatureType.All))})}(e,t.head,n);const c=t.head,f=n[i-1],p=(0,d.higherOrderFunctionType)().maxArgs-1;return a>p&&b(e,void 0===f?t:f,{kind:o.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:a,numArgsExpected:p}),m.Pledge.all(n.map(t=>P(e,t,l.SignatureType.All,void 0))).bind(t=>A(e,c).bind(t=>(N(t.result,l.OperKind.Range)||0!=(t.result&(l.OperKind.Array|l.OperKind.Rich))||b(e,c,R(c)||c.kind===u.NodeKind.Array?o.baseErrors.Unexpected_application_head:o.baseErrors.Unexpected_application_head_with_fix),g(e,l.SignatureType.All))))})}(e,t);case u.NodeKind.Array:return function(e,t){return m.Pledge.try(()=>{b(e,t,o.baseErrors.Unclosed_array,t.isClosed);const r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,s.isMissingNode)(t.nodes[0][0]));if(b(e,t,o.baseErrors.Empty_array_literal,r),!r)return g(e,l.OperKind.Array);const n=t.nodes[0].length;for(let r=0;r<t.nodes.length;r+=1){const i=t.nodes[r],a=i.length;b(e,t,o.baseErrors.Irregular_array_shape,a===n);for(let t=0;t<a;t+=1)T(e,i[t])}return g(e,l.OperKind.Array)})}(e,t);case u.NodeKind.Bad:return function e(t,r){return m.Pledge.try(()=>{switch(r.type){case u.BadType.Sequence:return b(t,r,o.baseErrors.Bad_node,r.contents.some(e=>e.kind===u.NodeKind.Bad)),m.Pledge.all(r.contents.map(r=>r.kind===u.NodeKind.Bad?e(t,r):A(t,r)));case u.BadType.StructRef:return b(t,r,o.baseErrors.Invalid_struct_ref_table_name);case u.BadType.FieldRef:return b(t,r,o.baseErrors.Unexpected_field_ref);case u.BadType.Unexpected:switch(r.contents){case")":return b(t,r,o.baseErrors.Unexpected_closing_paren);case t.localeInfo.rightBrace:return b(t,r,o.baseErrors.Unexpected_closing_brace);case t.localeInfo.rightBracket:return b(t,r,o.baseErrors.Unexpected_closing_bracket);case".":return b(t,r,o.baseErrors.Unexpected_dot);default:return b(t,r,{kind:o.SyntaxError.Unexpected_character,text:r.contents})}case u.BadType.NumberLiteral:return b(t,r,o.baseErrors.Invalid_number_literal);case u.BadType.StringLiteral:return b(t,r,o.baseErrors.Invalid_string_literal);case u.BadType.ErrorLiteral:return b(t,r,o.baseErrors.Invalid_error_literal);case u.BadType.FieldName:case u.BadType.ParamName:case u.BadType.Missing:return b(t,r,o.baseErrors.Bad_node);case u.BadType.Qualifier:return b(t,r,o.baseErrors.Invalid_qualifier);default:(0,n.assertNever)("calc.analyze.diagnoseBadNode",r)}})}(e,t).bind(()=>g(e,l.SignatureType.All));case u.NodeKind.CellRef:return e.locals.allowRelativeQualifier||(null===(r=t.qualifier)||void 0===r?void 0:r.kind)!==u.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?(null===(i=t.qualifier)||void 0===i?void 0:i.kind)===u.QualifierKind.Document||(null===(a=t.qualifier)||void 0===a?void 0:a.kind)===u.QualifierKind.Bad?(b(e,t,o.baseErrors.Invalid_qualifier),g(e,l.SignatureType.All)):t.ref.kind===u.CellRefKind.Bad?(b(e,t,o.baseErrors.Invalid_cell_ref),g(e,l.SignatureType.All)):g(e,l.OperKind.Range):(b(e,t,o.baseErrors.Invalid_unqualified_cell),g(e,l.SignatureType.All)):(b(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_cell),g(e,l.SignatureType.All));case u.NodeKind.Literal:return b(e,t,o.baseErrors.Unclosed_literal,t.isClosed),(0,s.isErrorOper)(t.oper)&&b(e,t,o.baseErrors.Invalid_error_literal,!((k=t.oper.type)>c.ErrorType.GETTING_DATA&&k!==c.ErrorType.BUSY&&k!==c.ErrorType.EXTERNAL)),g(e,t.oper.kind|((0,s.isErrorOper)(t.oper)&&t.oper.type===c.ErrorType.REF?l.OperKind.Range:0));case u.NodeKind.Name:{if(!e.locals.allowRelativeQualifier&&(null===(f=t.qualifier)||void 0===f?void 0:f.kind)===u.QualifierKind.Relative)return b(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_name),g(e,l.SignatureType.All);if(!e.locals.workbookLoad&&(null===(p=t.qualifier)||void 0===p?void 0:p.kind)===u.QualifierKind.Document&&!t.qualifier.isQuoted)return b(e,t,o.baseErrors.Invalid_qualifier),g(e,l.SignatureType.All);if((null===(v=t.qualifier)||void 0===v?void 0:v.kind)===u.QualifierKind.SheetRange||(null===(C=t.qualifier)||void 0===C?void 0:C.kind)===u.QualifierKind.Bad)return b(e,t,o.baseErrors.Invalid_qualifier),g(e,l.SignatureType.All);const r=(0,u.flattenNameParts)(t.parts).parts,n=e.annotations[r[0].label],i=e.annotations[t.label];return(null==n?void 0:n.kind)===u.AnnotationKind.LocalNameUse?b(e,t,o.baseErrors.Invalid_name,r.every(e=>{var t;return e.kind!==u.NamePartKind.FieldRefNamePart||(null===(t=e.rhs)||void 0===t?void 0:t.field.kind)===u.NodeKind.Name})):(null==i?void 0:i.kind)===u.AnnotationKind.LocalNameDecl||b(e,t,o.baseErrors.Invalid_name,r.reduceRight(({anyCanDenoteNamedObject:e,rhsValid:t},r)=>{var n;return{anyCanDenoteNamedObject:e||r.canDenoteNamedObject&&t,rhsValid:t&&(r.kind!==u.NamePartKind.FieldRefNamePart||(null===(n=r.rhs)||void 0===n?void 0:n.field.kind)===u.NodeKind.Name)}},{anyCanDenoteNamedObject:!1,rhsValid:!0}).anyCanDenoteNamedObject),g(e,l.SignatureType.All)}case u.NodeKind.Paren:return b(e,t,o.baseErrors.Unclosed_paren,t.isClosed),b(e,t,o.baseErrors.Empty_parenthesis,!S(t.node)),A(e,t.node);case u.NodeKind.FieldRef:return b(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),b(e,t,o.baseErrors.Unexpected_field_ref,!S(t.lhs)&&!y(t.lhs)),(0,s.isUnqualifiedNameNode)(t.rhs.field)||b(e,t.rhs.field,t.rhs.field.kind===u.NodeKind.Bad&&t.rhs.field.type===u.BadType.Missing?o.baseErrors.Missing_field_name:o.baseErrors.Invalid_field_name),A(e,t.lhs).bind(t=>g(e,l.SignatureType.All));case u.NodeKind.StructRef:if(b(e,t,o.baseErrors.Invalid_struct_ref_table_name,void 0===t.lhs&&e.locals.allowImplicitTable||(null===(E=t.lhs)||void 0===E?void 0:E.kind)===u.NodeKind.Name&&t.lhs.parts.kind===u.NamePartKind.IdentNamePart&&t.lhs.parts.canDenoteNamedObject),void 0===t.rhs.innerRef);else{b(e,t.rhs.innerRef,o.baseErrors.Invalid_struct_ref_comma_parts,t.rhs.innerRef.kind!==u.StructRefKind.CommaOpRef||(0,s.isCommaOpRefWellFormed)(t.rhs.innerRef));const r=t=>{switch(null==t?void 0:t.kind){case void 0:break;case u.StructRefKind.RangeOpRef:r(t.lhs),r(t.rhs);break;case u.StructRefKind.CommaOpRef:t.refs.forEach(r);break;case u.StructRefKind.SpecialRef:case u.StructRefKind.ColumnRef:b(e,t,o.baseErrors.Unclosed_bracket,t.isClosed);break;case u.StructRefKind.ThisRowOpRef:r(t.ref);break;case u.StructRefKind.MissingRef:b(e,t,o.baseErrors.Invalid_struct_ref_missing_part);break;case u.StructRefKind.BadRef:b(e,t,o.baseErrors.Unclosed_bracket,t.isClosed),b(e,t,o.baseErrors.Invalid_struct_ref_bad_part)}};r(t.rhs.innerRef)}return b(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?m.Pledge.resolve(void 0):A(e,t.lhs)).bind(t=>g(e,l.SignatureType.All));default:return(0,n.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}})}const I={ok:!0,isOk:i.identity,collect:(e,t,r)=>!1};function _(e,t,{annotations:r},n,i=!0){var o,a;const s={globals:e,locals:t,localeInfo:null!==(a=null===(o=t.config)||void 0===o?void 0:o.localeInfo)&&void 0!==a?a:e.config.localeInfo,annotations:r,reportError:n.collect,isOk:()=>n.isOk(s.errorData),earlyExit:i,errorData:n.ok};return s}function F(e,t){try{b(e,t.node,o.baseErrors.Empty_formula,!S(t.node));const r=m.Pledge.settleOrThrow(P(e,t.node,l.SignatureType.All,void 0));return function(e,t){const r=t.annotations[t.node.label];function a(t){for(const r of t)b(e,r,o.baseErrors.Unclosed_comment,r.isClosed)}function s(e){const r=t.spans[e];null!=r&&(r.preComments&&a(r.preComments),r.postComments&&a(r.postComments))}(null==r?void 0:r.kind)===u.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[u.SyntaxFeature.Comments]&&m.Pledge.settleOrThrow(function e(t){return m.Pledge.try(()=>{switch(s(t.label),t.kind){case u.NodeKind.Literal:break;case u.NodeKind.App:case u.NodeKind.Let:case u.NodeKind.Lambda:return t.head.kind===u.NodeKind.Operator&&s(t.head.label),m.Pledge.all(t.args.map(e));case u.NodeKind.Array:return m.Pledge.all((0,i.safeConcat)([],t.nodes.map(t=>t.map(e))));case u.NodeKind.Bad:if("string"!=typeof t.contents)return m.Pledge.all(t.contents.map(e));break;case u.NodeKind.CellRef:case u.NodeKind.Name:t.qualifier&&s(t.qualifier.label);break;case u.NodeKind.Paren:return e(t.node);case u.NodeKind.FieldRef:return s(t.rhs.label),s(t.rhs.field.label),e(t.lhs);case u.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case u.NodeKind.Param:if(s(t.name.label),s(t.name.name.label),t.def)return s(t.def.label),e(t.def.rhs);break;default:return(0,n.assertNever)("calc.analyze.checker.comments",t)}})}(t.node))}(e,t),r}catch(t){if(t===h)return g(e,l.SignatureType.All);throw t}}t.checkFormulaWithDiagnostics=function(e,t,r){try{const n=F(_(e,t,r,{ok:void 0,isOk:e=>void 0===e,collect:(e,t,r)=>{var n;const i=null!=r?r:[];return(null!==(n=i[e.label])&&void 0!==n?n:i[e.label]=[]).push(t),i}},!1),r).context.errorData;return(0,f.success)([Object.assign(Object.assign({},r),{isWellFormed:void 0===n}),n])}catch(e){return(0,f.failure)((0,f.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{const n=F(_(e,t,r,I),r).context.errorData;return(0,f.success)(Object.assign(Object.assign({},r),{isWellFormed:n}))}catch(e){return(0,f.failure)((0,f.javaScriptError)(e))}}},5761:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDiagnosticToNLMessage=t.baseNLErrors=t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;const n=r(4546),i=r(7081);var o,a,s;!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(o=t.SyntaxError||(t.SyntaxError={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(a=t.TypeError||(t.TypeError={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(s=t.TypeSourceKind||(t.TypeSourceKind={})),t.baseErrors={[o.Unclosed_application]:{kind:o.Unclosed_application},[o.Unclosed_paren]:{kind:o.Unclosed_paren},[o.Unclosed_bracket]:{kind:o.Unclosed_bracket},[o.Unclosed_array]:{kind:o.Unclosed_array},[o.Unclosed_literal]:{kind:o.Unclosed_literal},[o.Unclosed_comment]:{kind:o.Unclosed_comment},[o.Invalid_number_literal]:{kind:o.Invalid_number_literal},[o.Invalid_string_literal]:{kind:o.Invalid_string_literal},[o.Invalid_error_literal]:{kind:o.Invalid_error_literal},[o.Invalid_function_name]:{kind:o.Invalid_function_name},[o.Invalid_name]:{kind:o.Invalid_name},[o.Illegal_array_literal_element]:{kind:o.Illegal_array_literal_element},[o.Empty_array_literal]:{kind:o.Empty_array_literal},[o.Irregular_array_shape]:{kind:o.Irregular_array_shape},[o.Empty_parenthesis]:{kind:o.Empty_parenthesis},[o.Bad_node]:{kind:o.Bad_node},[o.Invalid_qualifier]:{kind:o.Invalid_qualifier},[o.Invalid_cell_ref]:{kind:o.Invalid_cell_ref},[o.Invalid_binder]:{kind:o.Invalid_binder},[o.Missing_binder]:{kind:o.Missing_binder},[o.Duplicate_binder]:{kind:o.Duplicate_binder},[o.Invalid_body]:{kind:o.Invalid_body},[o.Mandatory_binder_after_optional]:{kind:o.Mandatory_binder_after_optional},[o.Missing_default_expression]:{kind:o.Missing_default_expression},[o.Binder_requires_brackets]:{kind:o.Binder_requires_brackets},[o.Invalid_field_name]:{kind:o.Invalid_field_name},[o.Missing_field_name]:{kind:o.Missing_field_name},[o.Empty_formula]:{kind:o.Empty_formula},[o.Invalid_rel_sheet_qualifier_in_cell]:{kind:o.Invalid_rel_sheet_qualifier_in_cell},[o.Invalid_rel_sheet_qualifier_in_name]:{kind:o.Invalid_rel_sheet_qualifier_in_name},[o.Invalid_unqualified_cell]:{kind:o.Invalid_unqualified_cell},[o.Unexpected_closing_paren]:{kind:o.Unexpected_closing_paren},[o.Unexpected_closing_brace]:{kind:o.Unexpected_closing_brace},[o.Unexpected_closing_bracket]:{kind:o.Unexpected_closing_bracket},[o.Unexpected_field_ref]:{kind:o.Unexpected_field_ref},[o.Unexpected_dot]:{kind:o.Unexpected_dot},[o.Invalid_struct_ref_table_name]:{kind:o.Invalid_struct_ref_table_name},[o.Invalid_struct_ref_comma_parts]:{kind:o.Invalid_struct_ref_comma_parts},[o.Invalid_struct_ref_missing_part]:{kind:o.Invalid_struct_ref_missing_part},[o.Invalid_struct_ref_bad_part]:{kind:o.Invalid_struct_ref_bad_part},[a.Unexpected_application_head]:{kind:a.Unexpected_application_head},[a.Unexpected_application_head_with_fix]:{kind:a.Unexpected_application_head_with_fix}},t.formatDiagnostic=function(e){switch(e.kind){case a.Insufficient_function_arguments:case a.Excess_function_arguments:return`${e.kind}: ${(0,n.englishWorksheetFuncIdToName)(e.funcId)}`;case o.Missing_operation_argument:case a.Incorrect_number_of_operator_arguments:return`${e.kind}: ${(0,n.englishOperatorIdToName)(e.opId)}`;case o.Unexpected_character:return`${e.kind}: ${(0,i.anonymizeFormulaString)(e.text)}`;case a.Types_not_related:return`${e.kind}: ${function(e){const{kind:t,argIndex:r}=e;switch(e.kind){case s.WSFArgument:return JSON.stringify({kind:t,head:(0,n.englishWorksheetFuncIdToName)(e.head),argIndex:r});case s.OperatorArgument:return JSON.stringify({kind:t,head:(0,n.englishOperatorIdToName)(e.head),argIndex:r})}}(e.typeSource)}`;default:return e.kind}};const l="The formulas has an error";t.baseNLErrors={[o.Unclosed_application]:"The formula is missing a parenthesis",[o.Unclosed_paren]:"The formula is missing a parenthesis",[o.Unclosed_bracket]:"The formula is missing a bracket",[o.Unclosed_array]:"The formula is missing a brace",[o.Unclosed_literal]:"The formula is missing a quote",[o.Unclosed_comment]:"The formula comment is missing an end",[o.Invalid_number_literal]:"The formula has an invalid number",[o.Invalid_string_literal]:"The formula has an invalid string",[o.Invalid_error_literal]:"The formula has an invalid value",[o.Invalid_function_name]:"The formula has an invalid function name",[o.Invalid_name]:"The formula has an invalid name",[o.Illegal_array_literal_element]:"The formula has an invalid value",[o.Empty_array_literal]:"The formula has an empty array",[o.Irregular_array_shape]:"The formula has an incorrectly shaped array",[o.Empty_parenthesis]:"The formula is missing values between parentheses",[o.Missing_operation_argument]:"The formula has an extra operator",[o.Bad_node]:l,[o.Invalid_qualifier]:"The formula has an invalid sheet reference",[o.Invalid_cell_ref]:"The formula has an invalid cell reference",[o.Invalid_binder]:l,[o.Missing_binder]:l,[o.Duplicate_binder]:l,[o.Invalid_body]:l,[o.Mandatory_binder_after_optional]:l,[o.Missing_default_expression]:l,[o.Binder_requires_brackets]:l,[o.Invalid_field_name]:"The formula has an invalid field name",[o.Missing_field_name]:"The formula is missing a field name",[o.Empty_formula]:"The formula is empty",[o.Invalid_rel_sheet_qualifier_in_cell]:"The formula has an incorrect reference",[o.Invalid_rel_sheet_qualifier_in_name]:"The formula has an incorrect reference",[o.Invalid_unqualified_cell]:"The formula has an incorrect reference",[o.Unexpected_closing_paren]:"The formula has an extra parenthesis",[o.Unexpected_closing_brace]:"The formula has an extra brace",[o.Unexpected_closing_bracket]:"The formula has an extra bracket",[o.Unexpected_character]:"The formula has some extra characters",[o.Unexpected_field_ref]:"The formula has an extra field",[o.Unexpected_dot]:"The formula has an extra dot",[o.Invalid_struct_ref_table_name]:"The formula has a malformed table name in a structured reference",[o.Invalid_struct_ref_comma_parts]:"The formula has a structured reference with commas that has issues between its brackets",[o.Invalid_struct_ref_missing_part]:"The formula has a structured reference with missing references between its brackets",[o.Invalid_struct_ref_bad_part]:"The formula has a bad reference in a structured reference",[o.Excess_higher_order_function_arguments]:"The formula has a function call with too many arguments",[a.Types_not_related]:"The formula has an operation using data that cannot be mixed together",[a.Unexpected_application_head]:"The formula has a malformed function call",[a.Unexpected_application_head_with_fix]:"The formula has a malformed function call",[a.Incorrect_number_of_operator_arguments]:"The formula has an operation with the wrong number of arguments",[a.Excess_function_arguments]:"The formula has a function call with too many arguments",[a.Insufficient_function_arguments]:"The formula has a function call with missing arguments"},t.convertDiagnosticToNLMessage=function(e){return t.baseNLErrors[e.kind]}},4319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;const n=r(4666),i=r(2518),o=r(3357),a=r(9866),s=r(7082),l=r(8449),u=r(73),c=r(1416),d=r(6672),f=r(6982),p=r(5630),m=r(7512),h=r(9213),g={getDocumentLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes"),getContainingTable:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")},v=(0,f.createFailureErrorClass)("ResolveStaticPrecedentsError");class S extends m.IdentityVisitor{constructor(e,t,r){super(),this.locals=t,this.annotations=r,this.cells=[],this.names=[],this.udfs=[],this.nameSpecial=d.SpecialPrecs.None,this.ownSpecial=d.SpecialPrecs.None,this.resolutions=[],this.globals=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,v,S,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:g.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:g.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:g.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:g.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:g.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:g.getSheetRangeIndexes,getContainingTable:null!==(m=null===(p=e.getContainingTable)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:g.getContainingTable,getStructRefColumn:null!==(v=null===(h=e.getStructRefColumn)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:g.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(S=e.getStructRefSpecialRef)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:g.getStructRefSpecialRef}}(e),this.resolver=(0,l.createResolver)(this.globals)}appNode(e,t,r,n){if(e.kind===a.NodeKind.WSF){const r=e.id;let n=(0,c.getWorksheetFuncType)(r).staticPrecs;switch(r){case c.WorksheetFuncId.LOOKUP:case c.WorksheetFuncId.SUMIF:case c.WorksheetFuncId.AVERAGEIF:const e=({label:e})=>{const t=this.resolutions[e],r=(null==t?void 0:t.kind)===u.ResolvedKind.ResolvedCellRef||(null==t?void 0:t.kind)===u.ResolvedKind.ResolvedStructRef?t.resolution:void 0;return(null==r?void 0:r.kind)===o.ResultKind.Success?r.value:void 0},i=(t,r)=>{const n=e(t),i=e(r);return void 0!==n&&void 0!==i&&(0,s.isSheetGridRange)(n)&&(0,s.isSheetGridRange)(i)&&(0,f.isDocumentLocEqual)(n.sheet.document,i.sheet.document)&&n.range.rows===i.range.rows&&n.range.cols===i.range.cols};(t.length<3||t[2].kind===a.NodeKind.Literal||t[2].kind===a.NodeKind.Array||i(t[2],r===c.WorksheetFuncId.LOOKUP?t[1]:t[0]))&&(n&=~d.SpecialPrecs.AllCells)}n!==d.SpecialPrecs.None&&(this.ownSpecial|=n)}return super.appNode(e,t,r,n)}nameNode(e,t,r){const n=this.resolver.resolveDottedName(this.locals,(0,a.nameNode)(e,t,r),this.annotations);this.resolutions[r]=n,(0,i.safePush)(this.names,n.precedents.names),(0,i.safePush)(this.udfs,n.precedents.udfs);const{resolved:s}=n;switch(s.kind){case u.ResolvedKind.ResolvedName:if(!(0,o.isSuccess)(s.resolution)){this.handleResolutionError(s.resolution.reason);break}void 0!==s.resolution.value&&(this.nameSpecial|=d.SpecialPrecs.All);break;case u.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,o.isSuccess)(s.resolution)){this.handleResolutionError(s.resolution.reason);break}break;case u.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(s.resolution)}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.resolver.resolveCellRef(this.locals,(0,a.cellRefNode)(e,t,r));this.resolutions[r]=n;const{resolution:i}=n;return this.pushResolvedGridRef(i),super.cellRefNode(e,t,r)}structRefNode(e,t,r){const n=this.resolver.resolveStructRef(this.locals,(0,a.structRefNode)(e,t,r));this.resolutions[r]=n,(0,i.safePush)(this.names,n.precedents);const{resolution:o}=n;return this.pushResolvedGridRef(o),super.structRefNode(e,t,r)}pushResolvedGridRef(e){if(e.kind!==o.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){const t=e.value;if((0,s.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=d.SpecialPrecs.OwnDocSheets;const e=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,o.isSuccess)(e))throw new v(e.reason);(0,i.safePush)(this.cells,e.value.sheets.map(e=>(0,s.sheetGridRange)((0,s.sheetIndex)(t.sheet.document,e),t.range)))}}}handleResolutionError(e){switch(e.kind){case u.ResolveReasonKind.NoOriginSheet:case u.ResolveReasonKind.InvalidStructRef:case u.ResolveReasonKind.InvalidCellRef:case u.ResolveReasonKind.InvalidQualifier:case u.ResolveReasonKind.EmptyIntersection:return}throw new v(e)}}t.resolveStaticPrecedents=function(e,t,r){try{const n=new S(e,t,r.annotations);return(0,m.reduceBottomUp)(n,r),(0,o.success)((0,h.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,p.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof v?(0,o.failure)(e.reason):(0,o.failure)((0,o.javaScriptError)(e))}}},9213:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;const n=r(7082),i=r(5761);t.diagnostics=i;const o=r(3357);t.summarizeFormulaDiagnostics=function(e){if(void 0===e)return;const t={};return Object.keys(e).forEach(r=>{e[Number(r)].forEach(e=>{var r;const n=i.formatDiagnostic(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1})}),t},t.staticPrecedents=function(e,t,r,n,i,o,a){return{cells:e,names:t,udfs:r,special:n,ownSpecial:i,bound:o,resolutions:a}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n=!1){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,o.success)(t.range),originSheet:(0,o.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r=!1){return{config:null!=t?t:void 0,lexicalKind:n.LexicalKind.NameManager,originGridCell:(0,o.success)(e.range),originSheet:(0,o.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},7081:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;const n=r(637);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},4666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;const n=r(637);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},3206:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;const n=r(637);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore,t.codePointLeftSingleQuotationMark=n.codePoint.codePointLeftSingleQuotationMark,t.codePointRightSingleQuotationMark=n.codePoint.codePointRightSingleQuotationMark},2518:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;const n=r(637);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},3477:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(637);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},719:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(637);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(1292);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},3357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;const n=r(637);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},869:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(637);t.Pledge=n.pledge.Pledge},2636:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;const n=r(637);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},327:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;const n=r(637);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},5815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;const n=r(9860);t.buildAnnotations=n.annotations.buildAnnotations},8952:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;const n=r(9860);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},5079:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(9860);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.wrapPosition=n.cellParse.wrapPosition},4546:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;const n=r(9860);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},9866:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.contextNameNode=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=void 0;const n=r(9860);t.SyntaxFeature=n.formulaModule.SyntaxFeature,t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.singleLineComment=n.formulaModule.singleLineComment,t.multiLineComment=n.formulaModule.multiLineComment,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.contextNameNode=n.formulaModule.contextNameNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},3453:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isLineBreak=t.isSpace=void 0;const n=r(9860);t.isSpace=n.literalParse.isSpace,t.isLineBreak=n.literalParse.isLineBreak,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},7082:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;const n=r(9860);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},8449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;const n=r(9860);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},73:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;const n=r(9860);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},1416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;const n=r(9860);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},6672:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;const n=r(9860);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},6982:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;const n=r(9860);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},5630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;const n=r(9860);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},7512:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;const n=r(9860);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},7110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;const n=r(7081),i=r(4666),o=r(5630),a=r(1416),s=r(7577),l=r(7971),u=r(6672);function c(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.Dot}function d(e){return e.kind===s.TokenKind.Operator&&e.value===a.OperatorId.Range}function f(e){return e.kind===s.TokenKind.Operator&&e.value===a.OperatorId.At}function p(e){return e.kind===s.TokenKind.Left&&e.value===s.DelimId.Bracket}function m(e){return(e.kind===s.TokenKind.Left||e.kind===s.TokenKind.Right)&&e.value===s.DelimId.Bracket}function h(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function g(e){return(0,l.take)((t,r)=>r.kind===s.TokenKind.Sep&&r.value===e?r:void 0)}function v(e){return(0,l.take)((t,r)=>r.kind===s.TokenKind.Left&&r.value===e?r:void 0)}function S(e){return(0,l.take)((t,r)=>r.kind===s.TokenKind.Right&&r.value===e?r:void 0)}t.isDotSepToken=c,t.isListSepToken=function(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.List},t.isRangeOpToken=d,t.isAtOpToken=f,t.isRefErrorToken=function(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===u.OperKind.Error&&e.oper.type===o.ErrorType.REF},t.isLeftBracketToken=p,t.isRightBracketToken=function(e){return e.kind===s.TokenKind.Right&&e.value===s.DelimId.Bracket},t.isBracketToken=m,t.isCommentToken=function(e){return e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment},t.isWhitespaceToken=h,t.parseWhitespace=(0,l.many)((0,l.take)((e,t)=>h(t)?t:void 0)),t.parseSpacesOnly=(0,l.opt)((0,l.take)((e,t)=>t.kind===s.TokenKind.Spaces?t.chars:void 0),""),t.parseCharIndex=function(e,t,r,o,a){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected token at ${t} in ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(r)}return o(s.start,t)},t.parseListSep=g(s.SepId.List),t.parseRowSep=g(s.SepId.Row),t.parseColSep=g(s.SepId.Col),t.parseQualSep=g(s.SepId.Qual),t.parseDotSepToken=g(s.SepId.Dot),t.parseAssignToken=g(s.SepId.Assign),t.parseLeftParen=v(s.DelimId.Paren),t.parseRightParen=S(s.DelimId.Paren),t.parseLeftBrace=v(s.DelimId.Brace),t.parseRightBrace=S(s.DelimId.Brace),t.parseLeftSQuote=v(s.DelimId.SQuote),t.parseRightSQuote=S(s.DelimId.SQuote),t.parseLeftBracket=v(s.DelimId.Bracket),t.parseRightBracket=S(s.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,l.takePeek)((e,t,r)=>c(t)&&!p(r)?t:void 0),t.parseRangeOp=(0,l.take)((e,t)=>d(t)?t:void 0),t.parseAtOp=(0,l.take)((e,t)=>f(t)?t:void 0),t.parseEscape=(0,l.take)((e,t)=>t.kind===s.TokenKind.Escape?t:void 0),t.parseEnd=(0,l.take)((e,t)=>t.kind===s.TokenKind.End?t:void 0),t.parseIdentContinue=(0,l.apply)((0,l.many1)((0,l.take)((e,t)=>t.isIdentContinue?t:void 0)),(e,t)=>{const r=t[0];return 1===t.length?r:(0,s.identToken)(r.start,t.map(e=>e.chars).join(""))});const y=(0,l.take)((e,t)=>m(t)||t.kind===s.TokenKind.End?void 0:t),C=(0,l.lazy)(()=>(0,l.flatten)((0,l.many)((0,l.any)((0,l.many1)(y),(0,l.concat)((0,l.tuple)(t.parseLeftBracket),C,(0,l.opt)((0,l.tuple)(t.parseRightBracket),[]))))));t.parseBracketedTokens=(0,l.apply)((0,l.tuple)(t.parseLeftBracket,C,t.parseCharIndex,(0,l.opt)(t.parseRightBracket,void 0)),(e,[t,r,n,i])=>(r.push((0,s.endToken)(n)),[r,void 0!==i]))},3075:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;const n=r(9866),i=r(7577),o=r(7971),a=r(4828),s=r(7371),l=r(7110),u=r(3357),c=r(2636),d=r(3206),{codePointQuestionMark:f,codePointBackslash:p,codePointUnderscore:m}=d;function h(e,t){if(0===t.length)return!1;const r=(0,c.stringCodePointAt)(t,0);return!((n=r)===m||n===p||!e.isIdentStart(n)&&!e.isNumeral(n))&&(0,c.codePointIterator)(t,(0,c.numCodeUnits)(r)).every((function(t){return t!==f&&t!==p&&e.isIdentContinue(t)}));var n}t.isUnbracketedField=h;const g=(0,o.take)((e,t)=>(0,l.isBracketToken)(t)||t.kind===i.TokenKind.Escape||t.kind===i.TokenKind.End?void 0:t.chars),v=(0,o.take)((e,t)=>t.kind!==i.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars),S=(0,o.any)(g,(0,o.right)(l.parseEscape,v)),y=(0,o.apply)((0,o.tuple)((0,o.many)(S),l.parseEnd),(e,[t,r])=>t.join("")),C=(0,o.applyTake)(l.parseBracketedTokens,(e,[t,r])=>{const i=(0,o.runParser)(y,t,0,e);if(!(0,u.isSuccess)(i))return;const a=t[0].start,l=t[t.length-1].start,c=i.value.output;if(c.length>255){const r=t.map(e=>e.chars).join("");return[(0,n.badNode)(n.BadType.FieldName,r,(0,s.addSpan)(e,a,l,"","")),!1,!0]}const d=(0,s.addSpan)(e,a,l,"",""),f=(0,s.addSpan)(e,a,l,"","");return[(0,n.nameNode)((0,n.identNamePart)(c,void 0,d,d),void 0,f),!0,r]}),R=(0,o.apply)(l.parseIdentContinue,(e,t)=>{const r=t.start,i=t.start+t.chars.length;if(!h(e.localeInfo,t.chars)||t.chars.length>255)return[(0,n.badNode)(n.BadType.FieldName,t.chars,(0,s.addSpan)(e,r,i,"","")),!1,!0];const o=(0,s.addSpan)(e,r,i,"",""),a=(0,s.addSpan)(e,r,i,"","");return[(0,n.nameNode)((0,n.identNamePart)(t.chars,void 0,o,o),void 0,a),!1,!0]});t.parseFieldRef=(0,o.apply)((0,o.tuple)(l.parseCharIndex,l.parseWhitespace,l.parseDotSepToken,(0,o.any)(R,C),l.parseCharIndex),(e,[t,r,i,[o,l,u],c])=>{const d=(0,s.addSpan)(e,i.start,c,r,""),f=(0,n.fieldRef)(o,l,u,d);return(0,a.fieldRefTerm)(r.length>0,f,t,c)})},6845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;const n=r(7081),i=r(4666),o=r(9866),a=r(9866),s=r(5630),l=r(1416),u=r(7577),c=r(7971),d=r(4828),f=r(7371),p=r(7110),m=r(7914),h=r(6465),g=r(3075),v=r(1913),S=r(3357),y=r(5815),C=r(2636),R=r(637),b=r(5079),N=r(719),T=r(6982),P=(0,c.apply)((0,c.tuple)(p.parseWhitespace,(0,c.lazy)(()=>t.parseFormula),p.parseWhitespace),(e,[t,r,n])=>{const o=(0,f.getNodeSpan)(e,r);return(0,i.assertTrue)("calc.parse.parseSpFormula",!(o.pre.length>0&&t.length>0)),(0,i.assertTrue)("calc.parse.parseSpFormula",!(o.post.length>0&&n.length>0)),t.length>0&&([o.pre,o.preComments]=(0,f.addWhitespace)(e,t)),n.length>0&&([o.post,o.postComments]=(0,f.addWhitespace)(e,n)),r}),E=(0,c.apply)((0,c.tuple)(p.parseLeftParen,(0,f.withDelim)({delimId:u.DelimId.Paren,listSep:f.ListSep.Union},P),(0,c.opt)(p.parseRightParen,void 0),p.parseCharIndex),(e,[t,r,n,i])=>(0,o.parenNode)(r,void 0!==n,(0,f.addSpan)(e,t.start,i,"",""))),k=(0,c.many1)(P,(0,c.right)(p.parseColSep,P)),O=(0,c.many1)(k,(0,c.right)(p.parseRowSep,k)),A=(0,c.apply)((0,c.tuple)(p.parseLeftBrace,(0,f.withDelim)({delimId:u.DelimId.Brace,listSep:f.ListSep.Union},O),(0,c.opt)(p.parseRightBrace,void 0),p.parseCharIndex),(e,[t,r,n,i])=>(0,o.arrayNode)(r,void 0!==n,(0,f.addSpan)(e,t.start,i,"","")));function I(e){return(0,c.takePeek)((t,r,n)=>e(r)?(0,o.badNode)(o.BadType.Unexpected,r.chars,(0,f.addSpan)(t,r.start,n.start,"","")):void 0)}const _=(0,c.apply)((0,c.tuple)(p.parseCharIndex,I(p.isLeftBracketToken),(0,f.withDelim)({delimId:u.DelimId.Bracket,listSep:f.ListSep.Union},P),(0,c.opt)(I(p.isRightBracketToken),void 0),p.parseCharIndex),(e,[t,r,n,i,a])=>{const s=[r,n];return null!=i&&s.push(i),(0,o.badNode)(o.BadType.Sequence,s,(0,f.addSpan)(e,t,a,"",""))}),F=(0,c.takePeek)((e,t,r)=>{switch(t.kind){case u.TokenKind.End:case u.TokenKind.Operator:case u.TokenKind.Spaces:case u.TokenKind.SingleLineComment:case u.TokenKind.MultiLineComment:return;case u.TokenKind.Sep:if(t.value===u.SepId.Dot)return;if(t.value===u.SepId.Qual||t.value===u.SepId.Assign)break;if(e.delim.delimId===u.DelimId.Brace||t.value!==u.SepId.Col&&t.value!==u.SepId.Row)return;break;case u.TokenKind.Right:if((0,N.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix")){if(t.value!==u.DelimId.SQuote&&e.delim.stack[t.value])return}else if(t.value===e.delim.delimId)return}return(0,o.badNode)(o.BadType.Unexpected,t.chars,(0,f.addSpan)(e,t.start,r.start,"",""))}),M=(0,c.any)(m.parseRef,h.parseLiteral,E,A,g.parseFieldRef,v.parseStructRef,_,m.parseUnqualBadRef,F);function D(e){return(0,c.tuple)(p.parseLeftParen,(0,f.withDelim)({delimId:u.DelimId.Paren,listSep:f.ListSep.Arg},(0,c.many1)(e,(0,c.right)(p.parseListSep,e))),(0,c.opt)(p.parseRightParen,void 0),p.parseCharIndex)}const w=(0,c.apply)(D(P),(e,[t,r,n,i])=>(0,d.argsTerm)(r,void 0!==n,t.start,i)),L=(0,c.apply)(D((0,c.any)((0,c.lazy)(()=>t.parseSpParam),P)),(e,[t,r,n,i])=>(0,d.lambdaArgsTerm)(r,void 0!==n,t.start,i)),x=(0,c.take)((e,t)=>t.kind!==u.TokenKind.Operator||t.value!==l.OperatorId.Percent&&t.value!==l.OperatorId.Pound?void 0:t),B=(0,c.take)((e,t)=>t.kind===u.TokenKind.Operator||(0,p.isDotSepToken)(t)?t:function(e,t){return t.kind===u.TokenKind.Sep&&t.value===u.SepId.List&&e.delim.listSep===f.ListSep.Union?(0,u.operatorToken)(t.start,e.localeInfo.listSeparator,l.OperatorId.Union):void 0}(e,t)),U=(0,c.many)((0,c.take)((e,t)=>(0,p.isWhitespaceToken)(t)?t:void 0)),G=(0,c.any)((0,c.concat)((0,c.bind)((0,c.any)(M,x),(e,t)=>{const r=(0,d.isWSFNode)(e.localeInfo,t);return(null==r?void 0:r.id)===l.WorksheetFuncId.LAMBDA?(0,c.concat)((0,c.parseSucceed)([t]),(0,c.opt)((0,c.tuple)(L),[])):(0,c.parseSucceed)([t])}),(0,c.many)((0,c.any)(w,g.parseFieldRef,v.parseStructRef))),(0,c.tuple)(B)),K=(0,c.flatten)((0,c.many1)(G,(0,c.concat)(U,G)));t.parseFormula=(0,c.apply)((0,c.tuple)((0,c.opt)(K,void 0),p.parseCharIndex),(e,[t,r])=>{if(null==t){const t=(0,f.addSpan)(e,r,r,"","");return(0,o.literalNode)(s.missingOper,!0,t)}const n=t;return n.push((0,u.endToken)(r)),(0,d.runOperatorPrecedenceParser)(e,n)}),t.runFormulaParser=function(e,t,r,s,l,d,p,m){const h=m.length-1;if(h<0){const e="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,i.assertFalse)(e)}if(m[h].kind!==u.TokenKind.End){const e="calc.parse.runTokenParser: internal error: array[n] !== End in "+(0,n.anonymize)(m);return(0,i.assertFalse)(e)}const g=(0,f.makeState)(e,t,r,s,l),v=(0,c.runParser)(P,m,0,g);if(!(0,S.isSuccess)(v)||v.value.index<h){const e=`calc.parse.runTokenParser: internal error: consumed ${(0,S.isSuccess)(v)?v.value.index:0} out of ${h} in ${(0,n.anonymize)(m)}`;return(0,i.assertFalse)(e)}const C=v.value.output,R=g.spans,b=(0,y.buildAnnotations)(e,C,d,void 0===p?void 0:{[a.SyntaxFeature.Comments]:!0===p[a.SyntaxFeature.Comments],[a.SyntaxFeature.Statements]:!0===p[a.SyntaxFeature.Statements]});return(0,o.formula)(C,R,b)};const{codePointFullStop:V}=R.codePoint,j=(0,c.apply)((0,c.many1)((0,c.take)((e,t)=>t.isIdentContinue||(0,p.isDotSepToken)(t)?t:void 0)),(e,t)=>{const r=t[0].start,n=t.map(e=>e.chars).join(""),i=(0,f.addSpan)(e,r,r+n.length,"","");if(!function(e,t){if(!e.localeInfo.isIdentStart((0,C.stringCodePointAt)(t,0)))return!1;if(!(0,C.codePointIterator)(t).every(t=>t===V||e.localeInfo.isIdentContinue(t)))return!1;const r=(0,b.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){const n=r.refStyle===o.RefStyle.A1?(0,u.cellRefA1Token)(0,t,r.row,r.col):(0,u.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,m.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n))return(0,o.badNode)(o.BadType.ParamName,n,i);const a=(0,f.addSpan)(e,r,r+n.length,"","");return(0,o.nameNode)((0,o.identNamePart)(n,void 0,a,a),void 0,i)}),W=(0,c.applyTake)((0,c.tuple)(p.parseCharIndex,p.parseLeftBracket,p.parseCharIndex,p.parseSpacesOnly,(0,c.opt)(j,void 0),p.parseSpacesOnly,p.parseCharIndex,(0,c.opt)(p.parseRightBracket,void 0),p.parseCharIndex),(e,[t,r,n,i,a,s,l,u,c])=>{if(void 0!==a){const t=(0,f.getNodeSpan)(e,a);t.pre=i,t.post=s}const d=null!=a?a:(0,o.badNode)(o.BadType.Missing,i+s,(0,f.addSpan)(e,n,l,"",""));return(0,o.paramName)(d,!0,void 0!==u,(0,f.addSpan)(e,t,c,"",""))}),H=(0,c.lazy)(()=>(0,N.isFeatureEnabled)(N.FeatureName.CalcLambdaOptionalParameters)?W:(0,c.parseFail)()),Q=(0,c.applyTake)((0,c.tuple)(p.parseCharIndex,m.parseRef,p.parseCharIndex),(e,[t,r,n])=>{const i=r.kind===d.TermKind.MaybeWSFTerm?r.node:r;if((0,T.isUnqualifiedNameNode)(i))return(0,o.paramName)(i,!1,!0,(0,f.addSpan)(e,t,n,"",""))}),q=(0,c.apply)((0,c.tuple)(p.parseWhitespace,p.parseCharIndex,p.parseAssignToken,p.parseWhitespace,(0,c.lazy)(()=>t.parseFormula),p.parseCharIndex),(e,[t,r,n,i,a,s])=>{const l=(0,f.getNodeSpan)(e,a);return[l.pre,l.preComments]=(0,f.addWhitespace)(e,i),(0,o.paramDefault)(a,(0,f.addSpan)(e,r,s,t,""))}),z=(0,c.lazy)(()=>(0,N.isFeatureEnabled)(N.FeatureName.CalcLambdaDefaultParameters)?q:(0,c.parseFail)());t.parseSpParam=(0,c.applyTake)((0,c.tuple)(p.parseWhitespace,p.parseCharIndex,(0,c.bind)((0,c.any)(Q,H),(e,t)=>t.isClosed?(0,c.apply)((0,c.opt)(z,void 0),(e,r)=>[t,r]):(0,c.parseSucceed)([t,void 0])),p.parseCharIndex,p.parseWhitespace,(0,c.peek)((e,t)=>t)),(e,[t,r,[n,i],a,s,l])=>{if(void 0!==i||l.kind===u.TokenKind.End&&n.isBracketed||(0,p.isListSepToken)(l)&&n.isClosed)return(0,o.paramNode)(n,i,(0,f.addSpan)(e,r,a,t,s))})},6465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;const n=r(9866),i=r(7577),o=r(7971),a=r(4828),s=r(7371),l=r(7110),u=r(5630),c=r(6982),d=r(6672),f=(0,o.take)((e,t)=>t.kind===i.TokenKind.Literal&&t.oper.kind!==d.OperKind.Boolean?t:t.kind===i.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,i.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0),p=(0,o.take)((e,t)=>t.kind===i.TokenKind.Literal&&t.oper.kind===d.OperKind.Boolean?t:void 0);t.parseLiteral=(0,o.apply)((0,o.tuple)((0,o.any)(f,(0,o.left)(p,(0,o.fails)(l.parseDotSepTokenNotFollowedByLeftBracket))),l.parseCharIndex),(e,[t,r])=>{const o=(0,s.addSpan)(e,t.start,r,"","");if((0,i.isBadNumberOper)(t.oper))return(0,n.badNode)(n.BadType.NumberLiteral,t.chars,o);if((0,i.isBadErrorOper)(t.oper))return(0,n.badNode)(n.BadType.ErrorLiteral,t.chars,o);if((0,c.isStringOper)(t.oper)&&t.oper.value.length>u.cellStringLimit)return(0,n.badNode)(n.BadType.StringLiteral,t.chars,o);const l=(0,n.literalNode)(t.oper,t.hasRight,o);return(0,c.isBooleanOper)(t.oper)?(0,a.maybeWSFTerm)(l,t.chars):l})},4828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;const n=r(7081),i=r(4666),o=r(9866),a=r(1416),s=r(5630),l=r(7577),u=r(7971),c=r(7371),d=r(6982),f=r(7110),p=r(3357),m=r(719);var h;function g(e,t,r,n){return{kind:h.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function v(e){return e.kind!==l.TokenKind.Operator&&e.kind!==l.TokenKind.Sep&&e.kind!==l.TokenKind.End&&e.kind!==l.TokenKind.Spaces&&e.kind!==l.TokenKind.SingleLineComment&&e.kind!==l.TokenKind.MultiLineComment&&!(e.kind in h)}function S(e){return e.kind===l.TokenKind.Spaces||e.kind===l.TokenKind.SingleLineComment||e.kind===l.TokenKind.MultiLineComment}function y(e,t){return v(t=t.kind===h.MaybeWSFTerm?t.node:t)?(0,c.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(h=t.TermKind||(t.TermKind={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:h.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:h.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=g,t.structRefTerm=function(e,t,r){return{kind:h.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:h.MaybeWSFTerm,node:e,whole:t}};const C=(0,u.many)((0,u.take)((e,t)=>S(t)?t:void 0)),R=(0,u.many1)((0,u.take)((e,t)=>S(t)?t:void 0)),b=(0,u.peek)((e,t)=>t),N=function(e,t,r,o,a){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected term at ${t} in ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(r)}return o(y(r,s),t)};function T(e){return(0,u.apply)((0,u.tuple)(C,N,(0,u.take)(e),N,C),(e,[t,r,n,i,a])=>(0,o.operatorNode)(n,(0,c.addSpan)(e,r,i,t,a)))}function P(e){return(0,u.apply)((0,u.tuple)(C,N,(0,u.take)(e),N),(e,[t,r,n,i])=>(0,o.operatorNode)(n,(0,c.addSpan)(e,r,i,t,"")))}function E(e){return(0,u.apply)((0,u.tuple)(N,(0,u.take)(e),N,C),(e,[t,r,n,i])=>(0,o.operatorNode)(r,(0,c.addSpan)(e,t,n,"",i)))}const k=T((e,t)=>t.kind!==l.TokenKind.Operator||t.value!==a.OperatorId.Add&&t.value!==a.OperatorId.Sub?void 0:t.value),O=E((e,t)=>{if(t.kind===l.TokenKind.Operator){if(t.value===a.OperatorId.Add)return a.OperatorId.Pos;if(t.value===a.OperatorId.Sub)return a.OperatorId.Neg}}),A=E((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.At?t.value:void 0),I=P((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.Pound?t.value:void 0),_=(0,u.take)((e,t)=>t.kind===h.StructRefTerm?t:void 0),F=T((e,t)=>t.kind!==l.TokenKind.Operator||t.value!==a.OperatorId.Mul&&t.value!==a.OperatorId.Div?void 0:t.value),M=T((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.Pow?t.value:void 0),D=P((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.Percent?t.value:void 0),w=T((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.Concat?t.value:void 0),L=T((e,t)=>t.kind===l.TokenKind.Operator&&t.value>=a.OperatorId.Eq&&t.value<=a.OperatorId.Ge?t.value:void 0),x=T((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.Range?t.value:void 0),B=T((e,t)=>t.kind===l.TokenKind.Operator&&t.value===a.OperatorId.Union?t.value:void 0),U=(0,u.applyTake)((0,u.tuple)(R,b),(e,[t,r])=>{if(!(r.kind===l.TokenKind.End||r.kind===l.TokenKind.Operator&&r.value!==a.OperatorId.At||r.kind===l.TokenKind.Sep&&(0,f.isDotSepToken)(r))){if(1!==t.length||t[0].kind!==l.TokenKind.Spaces)return t;const n=y(e,r),i=(0,c.addSpan)(e,n,n,t[0].chars,"");return(0,o.operatorNode)(a.OperatorId.Isect,i)}}),G=(0,u.take)((e,t)=>t.kind===l.TokenKind.Sep&&(0,f.isDotSepToken)(t)?t:void 0),K=(0,u.take)((e,t)=>t.kind===h.ArgsTerm?t:void 0),V=(0,u.take)((e,t)=>t.kind===h.LambdaArgsTerm?t:void 0),j=(0,u.take)((e,t)=>t.kind===h.ArgsTerm||t.kind===h.FieldRefTerm?t:void 0),W={[a.WorksheetFuncId.LETREC]:m.FeatureName.CalcLetRecFunction,[a.WorksheetFuncId.LAMBDA]:m.FeatureName.CalcLambdaFunction};function H(e,t){if(t.kind===h.MaybeWSFTerm&&void 0!==t.whole){const r=(0,d.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;(0,i.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==a.WorksheetFuncId._UDF);const n=W[r];if(void 0!==n&&!(0,m.isFeatureEnabled)(n))return;return(0,o.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=H;const Q=(0,u.take)((e,t)=>H(e.localeInfo,t)),q=(0,u.take)((e,t)=>{const r=H(e.localeInfo,t);return(null==r?void 0:r.id)===a.WorksheetFuncId.LAMBDA?r:void 0}),z=(0,u.apply)((0,u.tuple)(q,V),(e,[t,r])=>{const n=(0,c.getNodeSpan)(e,t).start,i=r.nodes,a=(t.id,[]);let s;const l=[];for(let e=0;e<i.length;e+=1){const t=i[e];t.kind===o.NodeKind.Param?a.push((0,o.lambdaParam)((0,o.indexedArg)(t,e))):e===i.length-1?s=(0,o.indexedArg)(t,e):l.push((0,o.indexedArg)(t,e))}const u=(0,c.addSpan)(e,n,r.end,"","");return(0,o.lambdaNode)(t,a,s,l,r.isClosed,u)}),Y=(0,u.apply)((0,u.tuple)(Q,K),(e,[t,r])=>{const n=(0,c.getNodeSpan)(e,t).start,s=r.nodes;switch(t.id){case a.WorksheetFuncId.LET:case a.WorksheetFuncId.LETREC:{t.id;const i=[],a=[];let f;for(let t=0;t<s.length;t+=1){const r=s[t];t!==s.length-1?!(t+1<s.length&&(0,d.isUnqualifiedNameNode)(r))||t+3<s.length&&(l=e.refStyle,u=s[t+2],!((0,d.isUnqualifiedNameNode)(u)||l===o.RefStyle.A1&&u.kind===o.NodeKind.CellRef&&void 0===u.qualifier&&u.ref.kind===o.CellRefKind.Single&&u.ref.col.kind===o.PosKind.Rel&&u.ref.row.kind===o.PosKind.Rel))&&(0,d.isUnqualifiedNameNode)(s[t+1])?a.push((0,o.indexedArg)(r,t)):(i.push((0,o.letVar)((0,o.indexedArg)(r,t),(0,o.indexedArg)(s[t+1],t+1))),t+=1):f=(0,o.indexedArg)(r,t)}const p=(0,c.addSpan)(e,n,r.end,"","");return(0,o.letNode)(t,i,f,a,r.isClosed,p)}case a.WorksheetFuncId.LAMBDA:return(0,i.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var l,u;return Z(e,t,s,r.isClosed,n,r.end)});function J(e,t,r){return(0,u.apply)((0,u.tuple)((0,u.many)(e),t),(e,[t,n])=>t.reduceRight(r(e),n))}function X(e,t,r){return(0,u.apply)((0,u.tuple)(e,(0,u.many)(t)),(e,[t,n])=>n.reduce(r(e),t))}function $(e){return(t,[r,n])=>{if(a=r,Array.isArray(a)){const a=(0,c.getNodeSpan)(e,t);(0,i.assertTrue)("calc.parse.makeAppNodeInfix",0===a.post.length),[a.post,a.postComments]=(0,c.addWhitespace)(e,r);const s=(0,c.getNodeSpan)(e,n),l=(0,c.addSpan)(e,a.start,s.end,"","");return(0,o.badNode)(o.BadType.Sequence,[t,n],l)}var a;const s=(0,c.getNodeSpan)(e,t).start,l=(0,c.getNodeSpan)(e,n).end,u=(0,c.addSpan)(e,s,l,"","");return(0,o.appNode)(r,[t,n],!0,u)}}function Z(e,t,r,n,i,a){const s=(0,c.addSpan)(e,i,a,"","");return(0,o.appNode)(t,r,n,s)}function ee(e){return(t,r)=>{const n=(0,c.getNodeSpan)(e,t).start;switch(r.kind){case h.ArgsTerm:return Z(e,t,r.nodes,r.isClosed,n,r.end);case h.FieldRefTerm:{const i=(0,c.addSpan)(e,n,r.end,"",""),{start:a,end:l,pre:u}=(0,c.getNodeSpan)(e,r.rhs);if((0,d.isNumberNode)(t)){const n=(0,c.addSpan)(e,a,a,"",""),u=(0,o.literalNode)(s.missingOper,!0,n),d=r.rhs.label,f=(0,c.addSpan)(e,a,l,"",""),p=(0,o.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,f),m=!1;return(0,o.badNode)(o.BadType.FieldRef,[t,(0,o.fieldRefNode)(u,p,m,d)],i)}const f=!r.rhs.isBracketed&&(0,d.shouldFieldRefBeBracketed)(t,r.rhs,u);return(0,o.fieldRefNode)(t,r.rhs,f,i)}case h.StructRefTerm:{const i=(0,c.addSpan)(e,n,r.end,"","");return t.kind===o.NodeKind.Name||(0,d.isMissingNode)(t)?(0,o.structRefNode)(t.kind===o.NodeKind.Name?t:void 0,r.rhs,i):(0,o.badNode)(o.BadType.StructRef,[t,(0,o.structRefNode)(void 0,r.rhs,(0,c.addSpan)(e,r.start,r.end,"",""))],i)}case o.NodeKind.Operator:return Z(e,r,[t],!0,n,(0,c.getNodeSpan)(e,r).end)}}}function te(e){let t=!0;return(r,n)=>{const i=(0,c.getNodeSpan)(e,n).start,s=(0,c.getNodeSpan)(e,r).end,l=(0,c.addSpan)(e,i,s,"","");if((n.id===a.OperatorId.Pos||n.id===a.OperatorId.Neg)&&t&&(t=!1,(0,d.isNumberNode)(r)&&""===(0,c.getNodeSpan)(e,n).post)){const t=n.id===a.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,o.literalNode)(t,!0,l)}return(0,o.appNode)(n,[r],!0,l)}}const re=(0,u.take)((e,t)=>t.kind===h.MaybeWSFTerm?t.node:v(t)?t:void 0),ne=(0,u.apply)((0,u.tuple)(C,G,N,C),(e,[t,r,n,i])=>(0,o.badNode)(o.BadType.Unexpected,r.chars,(0,c.addSpan)(e,r.start,n,t,i))),ie=(0,u.apply)((0,u.tuple)(N,C,G,N),(e,[t,r,n,i])=>{const a=(0,c.addSpan)(e,i,i,"",""),s=(0,c.addSpan)(e,n.start,i,r,""),l=(0,o.fieldRef)((0,o.badNode)(o.BadType.Missing,"",a),!1,!0,s);return g(r.length>0,l,t,i)}),oe=(0,u.lazy)(()=>(0,u.apply)((0,u.tuple)(N,(0,u.many)((0,u.any)(z,Y,re,ne),(0,u.any)(z,Y,re,(0,u.right)((0,u.succeeds)(A),ce))),N),(e,[t,r,n])=>{if(1===r.length)return r[0];const i=(0,c.addSpan)(e,t,n,"","");return 0===r.length?(0,o.literalNode)(s.missingOper,!0,i):(0,o.badNode)(o.BadType.Sequence,r,i)})),ae=X((0,u.lazy)(()=>(0,u.any)((0,u.right)((0,u.succeeds)(A),ce),(0,u.right)((0,u.succeeds)(O),fe),oe)),(0,u.any)(I,_),ee),se=X(ae,(0,u.tuple)(x,ae),$),le=X(se,(0,u.tuple)(U,se),$),ue=X(le,(0,u.any)(j,ie),ee),ce=J(A,ue,te),de=X(ce,(0,u.tuple)(B,ce),$),fe=J(O,de,te),pe=X(fe,D,ee),me=X(pe,(0,u.tuple)(M,pe),$),he=X(me,(0,u.tuple)(F,me),$),ge=X(he,(0,u.tuple)(k,he),$),ve=X(ge,(0,u.tuple)(w,ge),$),Se=X(ve,(0,u.tuple)(L,ve),$);t.runOperatorPrecedenceParser=function(e,t){let r=t.length-1;if(r<1){const e="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,i.assertFalse)(e)}if(t[r].kind!==l.TokenKind.End){const e="calc.parse.runTermParser: internal error: array[n].kind !== End in "+(0,n.anonymize)(t);return(0,i.assertFalse)(e)}if(1===r&&v(t[0]))return t[0];if(S(t[0])){const e="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in "+(0,n.anonymize)(t);return(0,i.assertFalse)(e)}if(S(t[r-1])){const e="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in "+(0,n.anonymize)(t);return(0,i.assertFalse)(e)}for(;;){const o=(0,u.runParser)(Se,t,0,e);if((0,p.isSuccess)(o)&&o.value.index>=r)return o.value.output;if(!(0,p.isSuccess)(o)||0===o.value.index||1===o.value.index&&v(t[0])){const e=`calc.parse.runTermParser: internal error: consumed ${(0,p.isSuccess)(o)?o.value.index:0} out of ${r} in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}r=(t=[o.value.output,...t.slice(o.value.index)]).length-1}}},6738:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;const n=r(9866),i=r(7971),o=r(7371),a=r(7110),s=r(7577),l=r(3206),u=r(6672),c=r(8952),d=r(4666);function f(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===u.OperKind.Boolean}const{codePointFullStop:p}=l,m=(0,i.opt)((0,i.takePeek)((e,t,r)=>t.kind!==s.TokenKind.Spaces||(0,a.isWhitespaceToken)(r)?void 0:t.chars),""),h=(0,i.take)((e,t)=>t.isIdentContinue&&!f(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==p?t.chars:void 0),g=(0,i.take)((e,t)=>t.isIdentContinue||(0,a.isDotSepToken)(t)?t.chars:void 0),v=(0,i.apply)((0,i.many1)(h,g),(e,t)=>t.join("")),S=(0,i.take)((e,t)=>t.kind===s.TokenKind.Ident?t.chars:void 0),y=(e,t)=>{var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function C(e,t,r,i,o,a){let s,l;if(null==t)null==i?(s=(0,n.identQualifier)(r,o,a),l=r):(s=(0,n.sheetRangeQualifier)(r,i,void 0,o,a),l=`${r}:${i}`);else{const u=y(e.localeInfo,t);null==i?(s=(0,n.sheetQualifier)(r,t,o,a),l=`${u}${r}`):(s=(0,n.sheetRangeQualifier)(r,i,t,o,a),l=`${u}${r}:${i}`)}return[s,o?(0,c.quoteQualifier)(l):l]}const R=(0,i.take)((e,t)=>t.kind===s.TokenKind.Ident||(0,a.isRangeOpToken)(t)?t.chars:void 0),b=(0,i.apply)((0,i.tuple)(a.parseCharIndex,(0,i.many)(R),a.parseLeftBracket,(0,i.many1)(R),a.parseRightBracket,a.parseCharIndex),(e,[t,r,i,a,s,l])=>{const u=r.join(""),c=a.join("");return(0,n.documentQualifier)(c,""!==u?u:void 0,!0,(0,o.addSpan)(e,t,l,"",""))}),N=(0,i.apply)((0,i.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,i.many1)(g),a.parseRightBracket,a.parseCharIndex),(e,[t,r,i,a,s])=>{const l=i.join("");return(0,n.documentQualifier)(l,void 0,!1,(0,o.addSpan)(e,t,s,"",""))}),T=(0,i.apply)((0,i.tuple)(a.parseCharIndex,(0,i.opt)(N,void 0),v,(0,i.opt)((0,i.right)(a.parseRangeOp,v),void 0),a.parseCharIndex),(e,[t,r,n,i,a])=>C(e,r,n,i,!1,(0,o.addSpan)(e,t,a,"",""))),P=(0,i.apply)((0,i.tuple)(a.parseLeftSQuote,(0,i.opt)(b,void 0),S,(0,i.opt)((0,i.right)(a.parseRangeOp,S),void 0),a.parseRightSQuote,a.parseCharIndex),(e,[t,r,n,i,a,s])=>C(e,r,n,i,!0,(0,o.addSpan)(e,t.start,s,"",""))),E=(0,i.apply)(N,(e,t)=>[t,y(e.localeInfo,t)]),k=(0,i.apply)((0,i.tuple)(a.parseLeftSQuote,b,a.parseRightSQuote),(e,[t,r,n])=>[r,(0,c.quoteQualifier)(y(e.localeInfo,r))]),O=(0,i.take)((e,t)=>t.kind===s.TokenKind.End||t.kind===s.TokenKind.Right&&t.value===s.DelimId.SQuote?void 0:t.chars),A=(0,i.apply)((0,i.tuple)(a.parseLeftSQuote,(0,i.many)(O),(0,i.opt)((0,i.tuple)(a.parseRightSQuote,(0,i.opt)((0,i.tuple)(a.parseQualSep,m),[void 0,""])),[void 0,[void 0,""]]),a.parseCharIndex),(e,[t,r,[i,[a,s]],l])=>{const u=`'${r.join("")}${void 0!==i?"'":""}${void 0!==a?"!":""}`,c=(0,o.addSpan)(e,t.start,l-s.length,"",s);return[(0,n.badQualifier)(u,!0,c),u]}),I=(0,i.takePeek)((e,t,r)=>{if((0,a.isRefErrorToken)(t)){const i=(0,o.addSpan)(e,t.start,r.start,"","");return[(0,n.errorQualifier)(i),t.chars]}}),_=(0,i.peek)((e,t)=>{const r=(0,o.addSpan)(e,t.start,t.start,"","");return[(0,n.relativeQualifier)(r),""]}),F=(0,i.apply)((0,i.tuple)((0,i.any)(T,P,E,k,_),a.parseQualSep,m),(e,[[t,r],n,i])=>{const a=(0,o.getNodeSpan)(e,t);return a.end+=1,(0,d.assertTrue)("calc.parse.parseGoodQualifier",0===a.post.length),a.post=i,[t,r+"!"]}),M=(0,i.take)((e,t)=>t.isIdentContinue||(0,a.isDotSepToken)(t)||f(t)||function(e){return e.kind===s.TokenKind.Literal&&(0,s.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0),D=(0,i.apply)((0,i.tuple)(a.parseCharIndex,(0,i.many)(M),a.parseQualSep,a.parseCharIndex,m),(e,[t,r,i,a,s])=>{const l=r.join("")+"!",u=(0,o.addSpan)(e,t,a,"",s);return[(0,n.badQualifier)(l,!1,u),l]});t.parseQualifier=(0,i.any)(I,F,D,A)},7914:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;const n=r(7081),i=r(4666),o=r(9866),a=r(5630),s=r(5079),l=r(7577),u=r(7971),c=r(4828),d=r(7371),f=r(6982),p=r(7110),m=r(6738),h=r(6672),g=r(2636),v=r(3075);function S(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==s.SpecialPos.A1BadDollar&&t.col!==s.SpecialPos.A1BadDollar}function y(e){return e.refStyle===o.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function C(e,t){return t.kind===l.TokenKind.CellRef&&S(e,t)&&y(t)}t.isCompleteCellRefToken=C;const R=(0,o.pos)(o.PosKind.Rel,0);function b(e){return e===s.SpecialPos.RCNoNum?R:e}function N(e,t){if(e.row!==s.SpecialPos.A1BadDollar&&e.col!==s.SpecialPos.A1BadDollar){const r=e.refStyle===o.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,o.cellRefSingle)(b(e.row),b(e.col),r,t);if(null!=e.row){const n=b(e.row);return(0,o.cellRefRow)(n,n,r,t)}if(null!=e.col){const n=b(e.col);return(0,o.cellRefCol)(n,n,r,t)}}const r="calc.parse.cellRefToken2cellRef: bad token "+(0,n.anonymize)(e);return(0,i.assertFalse)(r)}function T(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,g.stringCodePointAt)(t.chars,0))}const P=(0,u.take)((e,t)=>C(e,t)&&!T(e,t)||(0,p.isRefErrorToken)(t)?t:void 0),E=(0,u.take)((e,t)=>C(e,t)&&T(e,t)?t:void 0),k=(0,u.apply)((0,u.tuple)((0,u.any)(P,(0,u.withState)(e=>e.cellRefMustBeCellRefNode?E:(0,u.left)(E,(0,u.fails)((0,u.any)(p.parseIdentContinue,p.parseDotSepTokenNotFollowedByLeftBracket))))),p.parseCharIndex),(e,[t,r])=>{const n=t.kind===l.TokenKind.CellRef?N(t,(0,d.addSpan)(e,t.start,r,"","")):(0,o.cellRefError)((0,d.addSpan)(e,t.start,r,"","")),i=t.kind===l.TokenKind.CellRef?t.chars:void 0;return(0,c.maybeWSFTerm)((0,o.cellRefNode)(n,void 0,(0,d.addSpan)(e,t.start,r,"","")),i)}),O=(0,u.takePeek)((e,t,r)=>t.kind!==l.TokenKind.CellRef||!S(e,t)||function(e,t,r){return r.kind===l.TokenKind.Left&&r.value===l.DelimId.Paren&&t.isIdentContinue&&null!=(0,f.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]),A=(0,u.bind)((0,u.tuple)(O,p.parseSpacesOnly,p.parseRangeOp,p.parseSpacesOnly,O),(e,[[t,r],n,i,a,[s,f]])=>{const p=(0,d.addSpan)(e,t.start,r,"",n),m=(0,d.addSpan)(e,s.start,f,a,""),h=N(t,p),g=N(s,m);let v;if(h.kind===o.CellRefKind.Single&&g.kind===o.CellRefKind.Single){const r=(0,d.addSpan)(e,t.start,f,"","");v=(0,o.cellRefRange)(h,g,r)}else if(0===n.length&&0===a.length)if(h.kind===o.CellRefKind.Row&&g.kind===o.CellRefKind.Row){const r=h.isBracketed||g.isBracketed,n=(0,d.addSpan)(e,t.start,f,"","");v=(0,o.cellRefRow)(h.row1,g.row1,r,n)}else if(h.kind===o.CellRefKind.Col&&g.kind===o.CellRefKind.Col){const r=h.isBracketed||g.isBracketed,n=(0,d.addSpan)(e,t.start,f,"","");v=(0,o.cellRefCol)(h.col1,g.col1,r,n)}if(null==v)return(0,u.parseFail)();const S=(0,c.maybeWSFTerm)((0,o.cellRefNode)(v,void 0,(0,d.addSpan)(e,t.start,f,"","")),void 0);return t.isIdentContinue&&s.isIdentContinue?(0,u.peek)((e,t)=>t.kind===l.TokenKind.Sep&&t.value===l.SepId.Qual?void 0:S):(0,u.parseSucceed)(S)}),I=(0,u.any)(A,k);t.parseUnqualBadRef=(0,u.apply)((0,u.take)((e,t)=>t.kind===l.TokenKind.CellRef?t:void 0),(e,t)=>{const r=t.start+t.chars.length,n=t.refStyle===o.RefStyle.R1C1&&!t.isIdentContinue;return(0,c.maybeWSFTerm)((0,o.cellRefNode)((0,o.cellRefBad)(t.chars,n,(0,d.addSpan)(e,t.start,r,"","")),void 0,(0,d.addSpan)(e,t.start,r,"","")),t.chars)});const _=(0,u.take)((e,t)=>t.kind===l.TokenKind.Ident&&e.localeInfo.isIdentStart((0,g.stringCodePointAt)(t.chars,0))||t.kind===l.TokenKind.CellRef&&T(e,t)?t:void 0),F=(0,u.take)((e,t)=>t.kind===l.TokenKind.Literal&&t.oper.kind===h.OperKind.Boolean?t:void 0),M=(0,u.any)(_,(0,u.left)(F,(0,u.succeeds)(p.parseDotSepTokenNotFollowedByLeftBracket))),D=(0,u.peek)((e,t)=>(0,p.isLeftBracketToken)(t)),w=(0,u.tuple)((0,u.many1)(M,p.parseIdentContinue),(0,u.many)((0,u.any)(p.parseIdentContinue,p.parseDotSepTokenNotFollowedByLeftBracket)),D,p.parseCharIndex),L=(0,u.apply)(w,(function(e,[t,r,n,a]){var u,f,p,m,h;const g=t[0],C=1===t.length&&(null===(u=r[0])||void 0===u?void 0:u.kind)===l.TokenKind.Sep,R=g.kind!==l.TokenKind.CellRef||(b=g).refStyle===o.RefStyle.A1&&null==b.row&&"object"==typeof b.col&&b.col.kind===o.PosKind.Rel||function(e,t){return t.refStyle===o.RefStyle.A1&&e.refStyle===o.RefStyle.A1&&t.isIdentContinue||t.refStyle===o.RefStyle.R1C1&&(0,s.isR1C1IdentStart)(t.row,t.col)}(e,g)&&C;var b;if(n||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===l.TokenKind.Literal||r.some((t,r)=>r%2==0?t.kind!==l.TokenKind.Sep:t.kind===l.TokenKind.Sep||!(0,v.isUnbracketedField)(e.localeInfo,t.chars))}(e,t,r)){const n=[...t,...r].map(e=>e.chars).join(""),i=(0,d.addSpan)(e,g.start,a,"",""),s=(0,d.addSpan)(e,g.start,a,"",""),l=(0,o.identNamePart)(n,R,i,s),u=(0,o.nameNode)(l,void 0,(0,d.addSpan)(e,g.start,a,"",""));return(0,c.maybeWSFTerm)(u,u.whole)}let T,P=R,E=0;const k=null!==(p=null===(f=r[E])||void 0===f?void 0:f.start)&&void 0!==p?p:a,O=(0,d.addSpan)(e,g.start,k,"",""),A=(0,d.addSpan)(e,g.start,k,"","");if(1===t.length&&g.kind===l.TokenKind.CellRef)if(S(e,g))if(y(g)){const t=N(g,(0,d.addSpan)(e,g.start,k,"",""));T=(0,o.cellRefNamePart)(t,g.chars,O,A)}else T=(0,o.identNamePart)(g.chars,P,O,A);else P=!1,T=(0,o.identNamePart)(g.chars,P,O,A);else{let n=t.map(e=>e.chars).join("");0===e.localeInfo.stringCompareCI(n,"_xlpm")&&E+1<r.length&&(n+="."+r[E+1].chars,E+=2),T=(0,o.identNamePart)(n,P,O,A)}let I=T;for(;E+1<r.length;E+=2){const t=r[E+1],n=null!==(h=null===(m=r[E+2])||void 0===m?void 0:m.start)&&void 0!==h?h:a,i=(0,d.addSpan)(e,t.start,n,"","");I=(0,o.fieldRefNamePart)(I,(0,o.fieldRef)((0,o.nameNode)((0,o.identNamePart)(t.chars,void 0,i,i),void 0,(0,d.addSpan)(e,t.start,n,"","")),!1,!0,(0,d.addSpan)(e,t.start,n,"","")),E+2>=r.length?R:P,(0,d.addSpan)(e,g.start,n,"",""),(0,d.addSpan)(e,g.start,n,"",""))}E<r.length&&(I=(0,o.fieldRefNamePart)(I,void 0,R,(0,d.addSpan)(e,g.start,a,"",""),(0,d.addSpan)(e,g.start,a,"","")),E+=1),(0,i.assertTrue)("calc.parse.pUnqualName: i == tailTokens",E===r.length),I.kind===o.NamePartKind.CellRefNamePart&&(0,i.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");const _=(0,o.nameNode)(I,void 0,(0,d.addSpan)(e,g.start,a,"",""));return(0,c.maybeWSFTerm)(_,_.whole)})),x=(0,u.opt)((0,u.any)(I,L,t.parseUnqualBadRef),{node:void 0}),B=(0,u.any)(I,(0,u.right)((0,u.fails)(L),t.parseUnqualBadRef)),U=(0,u.bind)(m.parseQualifier,(e,[t,r])=>(0,u.apply)(t.kind===o.QualifierKind.SheetRange?(0,d.cellRefMustBeCellRefNode)(t.isQuoted?x:B):t.kind===o.QualifierKind.Error?(0,d.cellRefMustBeCellRefNode)(x):x,(e,{node:n})=>{if(null==n)return t.kind===o.QualifierKind.Error?(0,o.literalNode)(a.refErrorOper,!0,t.label):(0,o.badNode)(o.BadType.Qualifier,r,t.label);const s=(0,d.getNodeSpan)(e,t).start,l=(0,d.getNodeSpan)(e,n).end;if(n.kind===o.NodeKind.Name){const r=(0,d.addSpan)(e,s,l,"","");if(t.kind===o.QualifierKind.Error){const e=(0,o.literalNode)(a.refErrorOper,!0,t.label);return(0,o.badNode)(o.BadType.Sequence,[e,n],r)}return(0,i.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==o.QualifierKind.SheetRange||t.isQuoted),(0,o.nameNode)(function(e,t,r){let n=t;for(;(0,d.getSpan)(e,n.qualifiedLabel).start=r,n.kind===o.NamePartKind.FieldRefNamePart;)n=n.lhs;return t}(e,n.parts,s),t,r)}const u=(0,d.addSpan)(e,s,l,"","");return t.kind===o.QualifierKind.Ident&&(t=(0,o.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,o.cellRefNode)(n.ref,t,u)})),G=(0,u.apply)((0,u.any)(I,L),(e,t)=>t.node.kind===o.NodeKind.CellRef&&t.node.ref.kind===o.CellRefKind.Error?(0,o.literalNode)(a.refErrorOper,!0,t.node.label):t);t.parseRef=(0,u.any)(U,G)},1913:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;const n=r(7971),i=r(4828),o=r(7110),a=r(9866),s=r(7371),l=r(7577),u=r(3357),c=(0,n.take)((e,t)=>t.isIdentContinue||t.kind===l.TokenKind.Spaces?t:void 0),d=(0,n.apply)((0,n.many1)(c),(e,t)=>{const r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map(e=>e.kind===l.TokenKind.Escape?"":e.chars).join(""))}),f=(0,n.take)((e,t)=>t.isIdentContinue||t.kind===l.TokenKind.Spaces||t.kind===l.TokenKind.Escape||(0,o.isListSepToken)(t)||(0,o.isRangeOpToken)(t)?t:void 0),p=(0,n.apply)((0,n.many1)(f),(e,t)=>{const r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map(e=>e.kind===l.TokenKind.Escape?"":e.chars).join(""))}),m=(0,n.take)((e,t)=>t.kind===l.TokenKind.SpecialRef?t:void 0),h=(0,n.apply)((0,n.tuple)(o.parseCharIndex,m,o.parseCharIndex),(e,[t,r,n])=>(0,a.specialRef)(r.value,!1,!0,(0,s.addSpan)(e,t,n,"",""))),g=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseLeftBracket,m,(0,n.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(e,[t,r,n,i,o])=>(0,a.specialRef)(n.value,!0,void 0!==i,(0,s.addSpan)(e,t,o,"",""))),v=(0,n.any)(h,g),S=(0,n.apply)((0,n.tuple)(o.parseCharIndex,d,o.parseCharIndex),(e,[t,r,n])=>(0,a.columnRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"",""))),y=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseLeftBracket,(0,n.opt)(p,void 0),(0,n.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(e,[t,r,n,i,o])=>{var l;return(0,a.columnRef)(null!==(l=null==n?void 0:n.chars)&&void 0!==l?l:"",!0,void 0!==i,(0,s.addSpan)(e,t,o,"",""))}),C=(0,n.apply)((0,n.tuple)(o.parseCharIndex,p,o.parseCharIndex),(e,[t,r,n])=>(0,a.columnRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"",""))),R=(0,n.any)(S,y),b=(0,n.apply)(o.parseCharIndex,(e,t)=>(0,a.missingRef)((0,s.addSpan)(e,t,t,"",""))),N=(0,n.any)(R,b),T=(0,n.take)((e,t)=>"#"===t.chars?t:void 0),P=(0,n.apply)((0,n.many1)(T,c),(e,t)=>(0,l.unexpectedToken)(t[0].start,t.map(e=>e.chars).join(""))),E=(0,n.apply)((0,n.many1)(T,f),(e,t)=>(0,l.unexpectedToken)(t[0].start,t.map(e=>e.chars).join(""))),k=(0,n.apply)((0,n.tuple)(o.parseCharIndex,P,o.parseCharIndex),(e,[t,r,n])=>(0,a.badRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,n,"",""))),O=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseLeftBracket,E,(0,n.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(e,[t,r,n,i,o])=>(0,a.badRef)(n.chars,!0,void 0!==i,(0,s.addSpan)(e,t,o,"",""))),A=(0,n.any)(k,O),I=(0,n.apply)((0,n.tuple)(o.parseCharIndex,N,o.parseRangeOp,N,o.parseCharIndex),(e,[t,r,n,i,o])=>(0,a.rangeOpRef)(r,i,(0,s.addSpan)(e,t,o,"",""))),_=(0,n.any)(I,R),F=(0,n.any)(v,A,I,R,b),M=(0,n.apply)((0,n.tuple)(o.parseCharIndex,F,(0,n.many1)((0,n.tuple)(o.parseListSep,F)),o.parseCharIndex),(e,[t,r,n,i])=>(0,a.commaOpRef)([r,...n.map(([e,t])=>t)],(0,s.addSpan)(e,t,i,"",""))),D=(0,n.apply)((0,n.tuple)(o.parseCharIndex,o.parseAtOp,(0,n.opt)(_,void 0),o.parseCharIndex),(e,[t,r,n,i])=>(0,a.thisRowOpRef)(n,(0,s.addSpan)(e,t,i,"",""))),w=(0,n.apply)(o.parseSpacesOnly,()=>{}),L=(0,n.any)((0,n.left)(w,o.parseEnd),(0,n.left)(C,o.parseEnd),(0,n.left)(M,o.parseEnd),(0,n.left)(D,o.parseEnd),(0,n.left)(I,o.parseEnd),(0,n.left)(v,o.parseEnd),(0,n.left)(A,o.parseEnd),(0,n.left)(y,o.parseEnd));t.parseStructRef=(0,n.applyTake)((0,n.tuple)(o.parseCharIndex,o.parseBracketedTokens,o.parseCharIndex),(e,[t,[r,o],l])=>{const c=(0,n.runParser)(L,r,0,e);return(0,u.isSuccess)(c)?(0,i.structRefTerm)((0,a.structRef)(c.value.output,o,(0,s.addSpan)(e,t,l,"","")),t,l):void 0})},7971:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;const n=r(4666),i=r(7081),o=r(3357),a=r(2518);t.runParser=function(e,t,r,a){let s;if(function(e){let t=e;for(;null!=t;)t=t()}(e(t,r,a,(function(e,t){s=(0,o.success)({output:e,index:t})}),(function(){s=(0,o.failure)(void 0)}))),null==s){const e="calc.parse.runParser: internal error: parser did not call resolve or reject on "+(0,i.anonymize)(t);return(0,n.assertFalse)(e)}return s},t.lazy=function(e){let t;return function(r,n,i,o,a){const s=null!=t?t:t=e();return()=>s(r,n,i,o,a)}};let s=!1;function l(e){return function(t,r,n,i,o){return i(e,r)}}t.setDebugging=function(e){s=e},t.warnSucceedOrFail=function(e,t){return function(r,n,i,o,a){return e(r,n,i,(e,n)=>(s&&console.warn(`${t} succeeded, returning index ${n} (of ${r.length}) with`,e),o(e,n)),()=>(s&&console.warn(`${t} failed at index ${n} (of ${r.length})`),a))}},t.parseSucceed=l;const u=(e,t,r,n,i)=>i;function c(){return u}function d(e,t){return function(r,n,i,o,a){return e(r,n,i,(e,n)=>t(i,e)(r,n,i,o,a),a)}}function f(e,t){return function(r,n,i,o,a){return e(r,n,i,(e,r)=>o(t(i,e),r),a)}}function p(e,t){return function(r,n,i,o,a){return e(r,n,i,o,()=>t(r,n,i,o,a))}}function m(e,t){return function(r,n,i,o,a){const s=r[n];if(null==s)return a;const l=e(i,s);return null==l?a:o(l,n+t)}}function h(e,t,r){return function(o,a,s,l,u){let c=r,d=a;function f(){return e(o,d,s,p,m)}function p(e,r){if(r<=d){const e=(0,i.anonymize)(o),t=`calc.parse.reduce: internal error: no progress made at index ${d} on ${e}`;return(0,n.assertFalse)(t)}return c=t(s,e,c),d=r,f}function m(){return l(c,d)}return f}}function g(e,t){return h(e,(function(e,t,r){return r.push(t),r}),t)}function v(...e){if(0===e.length)return l([]);if(1===e.length)return f(e[0],(e,t)=>[t]);const t=e.length;return function(r,n,i,o,a){let s=n;const l=[];function u(){return e[l.length](r,s,i,c,a)}function c(e,r){return s=r,l.push(e),l.length<t?u:o(l,s)}return u}}function S(e){return f(e,(e,t)=>(0,a.safeConcat)([],t))}t.parseFail=c,t.bind=d,t.apply=f,t.withState=function(e){return(t,r,n,i,o)=>e(n)(t,r,n,i,o)},t.any=function(...e){return 0===e.length?c():e.reduce(p)},t.opt=function(e,t){return function(r,n,i,o,a){return e(r,n,i,o,()=>o(t,n))}},t.succeeds=function(e){return function(t,r,n,i,o){return e(t,r,n,()=>i(!0,r),o)}},t.fails=function(e){return function(t,r,n,i,o){return e(t,r,n,o,()=>i(!0,r))}},t.take=function(e){return m(e,1)},t.peek=function(e){return m(e,0)},t.takePeek=function(e){return function(t,r,n,i,o){const a=t[r],s=t[r+1];if(null==a||null==s)return o;const l=e(n,a,s);return null==l?o:i(l,r+1)}},t.applyTake=function(e,t){return function(r,n,i,o,a){return e(r,n,i,(e,r)=>{const n=t(i,e);return null==n?a:o(n,r)},a)}},t.reduce=h,t.many=function(e,t){return void 0===t?function(t,r,n,i,o){return g(e,[])(t,r,n,i,o)}:function(r,n,i,o,a){return e(r,n,i,(e,n)=>g(t,[e])(r,n,i,o,a),()=>o([],n))}},t.many1=function(e,t=e){return d(e,(e,r)=>g(t,[r]))},t.tuple=v,t.left=function(e,t){return f(v(e,t),(e,[t])=>t)},t.right=function(e,t){return f(v(e,t),(e,[,t])=>t)},t.middle=function(e,t,r){return f(v(e,t,r),(e,[,t])=>t)},t.flatten=S,t.concat=function(...e){return S(v(...e))}},1677:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;const n=r(931),i=r(6845),o=r(1866),a=r(6982),s=r(3357),l=r(3206),{codePointEqualsSign:u,codePointPlusSign:c,codePointMinusSign:d,codePointAtSign:f}=l,p={[u]:1,[c]:0,[d]:0,[f]:-1};function m(e,t,r,o){var a,l,u,c;const d=null!==(l=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==l?l:e.config.localeInfo,f=null!==(c=null===(u=t.config)||void 0===u?void 0:u.refStyle)&&void 0!==c?c:e.config.refStyle,p=e.config.mathpack,m=(0,n.tokenizeFormula)(d,p,f,t.originGridCell.value,r,o,t.syntaxFeatures),h=(0,i.runFormulaParser)(d,p,f,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,m);return(0,s.success)(h)}t.createParser=function(e){return{parseFormula:(t,r,n)=>function(e,t,r,n=0){try{const i=n>=0&&n<r.length?p[r.charCodeAt(n)]:void 0;return null==i?(0,s.failure)((0,o.notFormulaString)("first character is not '=', '+', '-' or '@'")):i<0?(0,s.failure)((0,a.notImplemented)(["Lotus 1-2-3 syntax"])):m(e,t,r,n+i)}catch(e){return(0,s.failure)((0,s.javaScriptError)(e))}}(e,t,r,n),parseFormulaExpression:(t,r,n)=>function(e,t,r,n=0){try{return m(e,t,r,n)}catch(e){return(0,s.failure)((0,s.javaScriptError)(e))}}(e,t,r,n)}}},7371:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;const n=r(7081),i=r(4666),o=r(7577),a=r(9866),s=r(7110);var l;!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(l=t.ListSep||(t.ListSep={})),t.makeState=function(e,t,r,n,i){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:i,delim:{delimId:void 0,listSep:l.Union,stack:{[o.DelimId.Paren]:!1,[o.DelimId.Brace]:!1,[o.DelimId.Bracket]:!1}},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){const r=e.spans[t.label];if(null==r){const e="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+(0,n.anonymize)(t);(0,i.assertFalse)(e)}return r},t.getSpan=function(e,t){const r=e.spans[t];return(0,i.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r};const u=[];function c(e,t){const r="string"==typeof t?u:t.filter(s.isCommentToken);return["string"==typeof t?t:t.map(e=>e.chars).join(""),r.length>0?r.map(t=>function(e,t){const r=d(e,t.start,t.start+t.chars.length,"","");return t.kind===o.TokenKind.SingleLineComment?(0,a.singleLineComment)(t.chars,r):(0,a.multiLineComment)(t.chars,t.isClosed,r)}(e,t)):void 0]}function d(e,t,r,n,i){const o=e.label;e.label+=1;const[s,l]=c(e,n),[u,d]=c(e,i);return e.spans[o]=(0,a.formulaSpan)(t,r,s,u,l,d),o}function f(e,t,r){return(n,i,o,a,s)=>{const l=e(o);return r(n,i,o,(e,r)=>(t(o,l),a(e,r)),()=>(t(o,l),s))}}t.addWhitespace=c,t.addSpan=d,t.withDelim=function({delimId:e,listSep:t},r){return f(r=>{const n=r.delim;return r.delim={delimId:e,listSep:t,stack:Object.assign(Object.assign({},n.stack),{[e]:!0})},n},(e,t)=>e.delim=t,r)},t.cellRefMustBeCellRefNode=function(e){return f(e=>{const t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t},(e,t)=>e.cellRefMustBeCellRefNode=t,e)}},1866:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;const n=r(6982),i=r(3357);var o;t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,n,o){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,i.success)(t),contextNames:n,syntaxFeatures:o}},function(e){e.NotFormulaString="NotFormulaString"}(o||(o={})),t.ReasonKind=Object.assign(Object.assign({},n.ReasonKind),o),t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},7577:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;const n=r(1416),i=r(9866),o=r(5630),a=r(6672),s=r(2636),l=r(3206),u=r(5079),{codePointAsterisk:c,codePointMinusSign:d,codePointPlusSign:f,codePointSlash:p,codePointSpace:m}=l;var h,g,v,S;function y(e){return e.kind===S.BadNumber||e.kind===a.OperKind.Number}function C(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}function R(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}function b(e,t,r,n,i,o,a){return{kind:h.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:i,refStyle:o,isBadLocale:a}}function N(e,t,r,n=!0){const i=r.kind===a.OperKind.Boolean||y(r)&&function(e){for(const t of(0,s.codePointIterator)(e))if(t===f||t===d||t===c||t===m||t===p)return!1;return!0}(t);return{kind:h.Literal,start:e,chars:t,isIdentContinue:i,oper:r,hasRight:n}}function T(e,t,r){return{kind:h.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function P(e){const t=n.operatorStrings[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return r=>T(r,t,e)}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(h=t.TokenKind||(t.TokenKind={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(g=t.DelimId||(t.DelimId={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(v=t.SepId||(t.SepId={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(S=t.TokenOperKind||(t.TokenOperKind={})),t.isBadNumberOper=function(e){return e.kind===S.BadNumber},t.isNumberLikeOper=y,t.badNumberOper={kind:S.BadNumber},t.isBadErrorOper=function(e){return e.kind===S.BadError},t.badErrorOper={kind:S.BadError},t.endToken=e=>C(h.End,e,"",!1),t.spacesToken=(e,t)=>C(h.Spaces,e,t,!1),t.unexpectedToken=(e,t)=>C(h.Unexpected,e,t,!1),t.escapeToken=(e,t)=>C(h.Escape,e,t,!1),t.singleLineCommentToken=(e,t)=>C(h.SingleLineComment,e,t,!1),t.multiLineCommentToken=(e,t,r)=>({kind:h.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}),t.identToken=(e,t)=>C(h.Ident,e,t,!0),t.leftParenToken=e=>R(h.Left,e,"(",g.Paren),t.leftBracketToken=(e,t)=>R(h.Left,e,t,g.Bracket),t.leftBraceToken=(e,t)=>R(h.Left,e,t,g.Brace),t.leftSQuoteToken=e=>R(h.Left,e,"'",g.SQuote),t.rightParenToken=e=>R(h.Right,e,")",g.Paren),t.rightBracketToken=(e,t)=>R(h.Right,e,t,g.Bracket),t.rightBraceToken=(e,t)=>R(h.Right,e,t,g.Brace),t.rightSQuoteToken=e=>R(h.Right,e,"'",g.SQuote),t.listSepToken=(e,t)=>R(h.Sep,e,t,v.List),t.colSepToken=(e,t)=>R(h.Sep,e,t,v.Col),t.rowSepToken=(e,t)=>R(h.Sep,e,t,v.Row),t.qualSepToken=e=>R(h.Sep,e,"!",v.Qual),t.dotSepToken=e=>R(h.Sep,e,".",v.Dot),t.assignSepToken=e=>R(h.Sep,e,":=",v.Assign),t.specialRefToken=(e,t,r)=>R(h.SpecialRef,e,t,r),t.cellRefA1Token=function(e,t,r,n){return b(e,t,(null==r||"object"==typeof r&&r.kind===i.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===i.PosKind.Rel),r,n,i.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,o=!1){return b(e,t,!(r!==u.SpecialPos.RCNoNum&&null!=r&&r.kind!==i.PosKind.Abs||n!==u.SpecialPos.RCNoNum&&null!=n&&n.kind!==i.PosKind.Abs),r,n,i.RefStyle.R1C1,o)},t.literalToken=N,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?N(r,n,o.falseOper):0===e.stringCompareCI(e.trueName,n)?N(r,n,o.trueOper):(0,t.identToken)(r,n)},t.operatorToken=T,t.addOperatorToken=P(n.OperatorId.Add),t.subOperatorToken=P(n.OperatorId.Sub),t.mulOperatorToken=P(n.OperatorId.Mul),t.divOperatorToken=P(n.OperatorId.Div),t.powOperatorToken=P(n.OperatorId.Pow),t.percentOperatorToken=P(n.OperatorId.Percent),t.concatOperatorToken=P(n.OperatorId.Concat),t.eqOperatorToken=P(n.OperatorId.Eq),t.ltOperatorToken=P(n.OperatorId.Lt),t.gtOperatorToken=P(n.OperatorId.Gt),t.neOperatorToken=P(n.OperatorId.Ne),t.leOperatorToken=P(n.OperatorId.Le),t.geOperatorToken=P(n.OperatorId.Ge),t.rangeOperatorToken=P(n.OperatorId.Range),t.atOperatorToken=P(n.OperatorId.At),t.poundOperatorToken=P(n.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;const n=r(4666),i=r(7577),o=r(5630),a=r(5079),s=r(3453),l=r(2518),u=r(9866),c=r(5942),d=r(2636),f=r(3206),p=r(327),m=r(719),h=r(7110),{codePointAsterisk:g,codePointAtSign:v,codePointColon:S,codePointDoubleQuote:y,codePointExclamationMark:C,codePointHash:R,codePointLeftParen:b,codePointQuestionMark:N,codePointRightParen:T,codePointSingleQuote:P,codePointFullStop:E,codePointDigitZero:k,codePointSlash:O,codePointMinusSign:A,codePointSpace:I,codePointInvertedExclamationMark:_,codePointInvertedQuestionMark:F,codePointLeftSingleQuotationMark:M,codePointRightSingleQuotationMark:D}=f;let w;function L(e){if(!w){w=(0,l.makeStringMap)();for(const e of Object.getOwnPropertyNames(x))w[e.charCodeAt(0)]=!0;for(const e of Object.getOwnPropertyNames(B))w[e.charCodeAt(0)]=!0}return!0===w[e]}const x={"+":i.addOperatorToken,"-":i.subOperatorToken,"*":i.mulOperatorToken,"/":i.divOperatorToken,"^":i.powOperatorToken,"%":i.percentOperatorToken,"&":i.concatOperatorToken,"=":i.eqOperatorToken,"<":i.ltOperatorToken,">":i.gtOperatorToken,":":i.rangeOperatorToken,".":i.dotSepToken,"@":i.atOperatorToken,"#":i.poundOperatorToken},B={"<>":i.neOperatorToken,"<=":i.leOperatorToken,">=":i.geOperatorToken};function U(e,t,r){if(t<e.length-1){const n=B[e.substring(t,t+2)];if(null!=n)return(0,i.appendToken)(2,n(t),r)}const o=x[e.charAt(t)];return null!=o?(0,i.appendToken)(1,o(t),r):(0,n.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function G(e,t,r,n,o){const a=(0,s.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0===a)return;const{value:l,i:u}=a,c=r.substring(n,u);return(0,i.appendToken)(u-n,(0,i.literalToken)(n,c,null!=l?l:i.badNumberOper,!0),o),u}const K=(e,t)=>e.charCodeAt(t)!==y,V=(e,t)=>e.charCodeAt(t)===y;function j(e,t,r){const[n,a]=(0,c.scanEscapedWhile)(e,t+1,K,'"',V),s=e.substring(t,a+1);return a<e.length?(0,i.appendToken)(a+1-t,(0,i.literalToken)(t,s,(0,o.stringOper)(n),!0),r):(0,i.appendToken)(a-t,(0,i.literalToken)(t,s,(0,o.stringOper)(n),!1),r)}function W(e,t,r,n){if(!(0,m.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix"))return function(e,t,r,n){for(let a=1;a<e.errorNames.length;a+=1){const s=e.errorNames[a];if(null==s)continue;const l=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,l))return(0,i.appendToken)(s.length,(0,i.literalToken)(r,l,(0,o.errorOper)(a)),n)}let a=r+1,s=!1;for(;a<t.length;){const n=(0,d.stringCodePointAt)(t,a);if(a!==r+1||n!==_&&n!==F)if(a>r+1&&n===O&&!s)s=!0,a+=1;else if(a>r+1&&n===E)a+=1;else{if(a>r+1&&n===k){a+=1,a<t.length&&t.charCodeAt(a)===C&&(a+=1);break}if(n===C||n===N){a!==r+1&&(a+=1);break}if(!e.isIdentStart(n))break;a+=(0,d.numCodeUnits)(n)}else a+=1}if(a>r+1){const e=t.substring(r,a);return(0,i.appendToken)(a-r,(0,i.literalToken)(r,e,i.badErrorOper),n)}}(e,t,r,n);for(let a=1;a<e.errorNames.length;a+=1){const s=e.errorNames[a];if(null==s)continue;const l=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,l))return(0,i.appendToken)(s.length,(0,i.literalToken)(r,l,(0,o.errorOper)(a)),n)}let a=r+1,s=!1;for(;a<t.length;){const n=(0,d.stringCodePointAt)(t,a);if(a!==r+1||n!==_&&n!==F)if(!(a>r+1)||n!==O&&n!==A&&n!==I||s)if(a>r+1&&n===E)a+=1;else{if(a>r+1&&n===k){a+=1,a<t.length&&t.charCodeAt(a)===C&&(a+=1);break}if(n===C||n===N){a!==r+1&&(a+=1);break}if(!e.isIdentContinue(n)||e.isNumeral(n)){if(n!==M&&n!==D)break;a+=1}else a+=(0,d.numCodeUnits)(n)}else s=!0,a+=1;else a+=1}for(;a>r+1&&t.charCodeAt(a-1)===I;)--a;if(a>r+1){const e=t.substring(r,a);return(0,i.appendToken)(a-r,(0,i.literalToken)(r,e,i.badErrorOper),n)}}function H(e,t,r,n){for(let o=1;o<e.specialRefNames.length;o+=1){const a=e.specialRefNames[o];if(null==a)continue;const s=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,s))return(0,i.appendToken)(a.length,(0,i.specialRefToken)(r,s,o),n)}}function Q(e,t,r){const n=t.charCodeAt(r);return!((0,s.isSpace)(n)||n===P||n===R||n===S||n===v||(0,p.stringStartsWith)(t,e.listSeparator,r)||(0,p.stringStartsWith)(t,e.leftBracket,r)||(0,p.stringStartsWith)(t,e.rightBracket,r))}const q=(e,t)=>(0,s.isSpace)((0,d.stringCodePointAt)(e,t)),z=(e,t)=>!(0,s.isLineBreak)((0,d.stringCodePointAt)(e,t)),Y=(e,t)=>!(t+1<e.length&&e.charCodeAt(t)===g&&e.charCodeAt(t+1)===O);function J(e,t,r,n){let o=r,a=0;const l=(t,r)=>Q(e,t,r),u=(t,r)=>!Q(e,t,r),f=(0,c.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",o);for(;o<t.length;){f(o);const r=(0,d.stringCodePointAt)(t,o);if(n.length>0&&n[n.length-1].kind===i.TokenKind.Escape&&u(t,o))o=(0,i.appendToken)((0,d.numCodeUnits)(r),(0,i.identToken)(o,(0,d.stringFromCodePoint)(r)),n);else if(r!==v){if(r===R){const r=H(e,t,o,n);if(null!=r){o=r;continue}}if(r!==P)if((0,p.stringStartsWith)(t,e.rightBracket,o)){if(o=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(o,e.rightBracket),n),a-=1,0===a)return o}else if(l(t,o)){const[e,r]=(0,c.scanWhile)(t,o,l);o=(0,i.appendToken)(r-o,(0,i.identToken)(o,e),n)}else if((0,s.isSpace)(r)){const[e,r]=(0,c.scanWhile)(t,o,q);o=(0,i.appendToken)(r-o,(0,i.spacesToken)(o,e),n)}else r!==S?(0,p.stringStartsWith)(t,e.listSeparator,o)?o=(0,i.appendToken)(e.listSeparator.length,(0,i.listSepToken)(o,e.listSeparator),n):(0,p.stringStartsWith)(t,e.leftBracket,o)&&a<2?(o=(0,i.appendToken)(e.leftBracket.length,(0,i.leftBracketToken)(o,e.leftBracket),n),a+=1):o=(0,i.appendToken)((0,d.numCodeUnits)(r),(0,i.unexpectedToken)(o,(0,d.stringFromCodePoint)(r)),n):o=(0,i.appendToken)(1,(0,i.rangeOperatorToken)(o),n);else o=(0,i.appendToken)(1,(0,i.escapeToken)(o,"'"),n)}else o=(0,i.appendToken)(1,(0,i.atOperatorToken)(o),n)}return o}function X(e,t,r,n){let o=(0,i.appendToken)(1,(0,i.leftSQuoteToken)(r),n);const a=(t,r)=>function(e,t,r){const n=t.charCodeAt(r);return n!==P&&n!==S&&n!==g&&n!==N&&!(0,p.stringStartsWith)(t,e.leftBracket,r)&&!(0,p.stringStartsWith)(t,e.rightBracket,r)}(e,t,r),s=(e,t)=>e.charCodeAt(t)===P,l=(0,c.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",o);for(;o<t.length;){l(o);const r=(0,d.stringCodePointAt)(t,o);if(r===P&&!(o+1<t.length&&t.charCodeAt(o+1)===P))return(0,i.appendToken)(1,(0,i.rightSQuoteToken)(o),n);if(r!==S)if((0,p.stringStartsWith)(t,e.leftBracket,o))o=(0,i.appendToken)(e.leftBracket.length,(0,i.leftBracketToken)(o,e.leftBracket),n);else if((0,p.stringStartsWith)(t,e.rightBracket,o))o=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(o,e.rightBracket),n);else if((0,c.getEscapedSkip)(t,o,a,"'",s)>0){const[e,r]=(0,c.scanEscapedWhile)(t,o,a,"'",s);o=(0,i.appendToken)(r-o,(0,i.identToken)(o,e),n)}else o=(0,i.appendToken)((0,d.numCodeUnits)(r),(0,i.unexpectedToken)(o,(0,d.stringFromCodePoint)(r)),n);else o=(0,i.appendToken)(1,(0,i.rangeOperatorToken)(o),n)}return o}function $(e,t,r,n,o,s){const l=(0,a.parseCellRef)(e,t,r,n,o);if(null!=l){const e=l.i,t=n.substring(e,o),r=l.refStyle===u.RefStyle.A1?(0,i.cellRefA1Token)(o,t,l.row,l.col):(0,i.cellRefR1C1Token)(o,t,l.row,l.col,l.enLocale);return(0,i.appendToken)(e-o,r,s)}}function Z(e,t,r,n){let o=n.length-1,a=n[o];if(null==a)return!0;if(a.kind===i.TokenKind.Sep&&a.value===i.SepId.Dot)return!1;if((0,p.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=a&&(0,h.isWhitespaceToken)(a);)a=n[--o];return null==a||a.kind!==i.TokenKind.Ident&&a.kind!==i.TokenKind.CellRef&&a.kind!==i.TokenKind.Right&&(a.kind!==i.TokenKind.Literal||(0,i.isNumberLikeOper)(a.oper))}return e.isNumeral((0,d.stringCodePointAt)(t,r))}function ee(e,t,r,n){let i=e[t],o=t+1;for(;o<e.length;o+=1){const t=e[o];if(t.kind!==r)break;i=n(i,t)}return[i,o]}t.tokenizeFormula=function(e,t,r,o,a,l,f){const[h,v]=function(e,t,r,o,a,l,f){const h=[],v=[],S=(0,m.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix");let N=l;const E=!0===(null==f?void 0:f[u.SyntaxFeature.Comments]),k=!0===(null==f?void 0:f[u.SyntaxFeature.Statements]),A=!(0,p.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,p.stringStartsWith)(e.statementSeparator,e.rowSeparator),I=!(0,p.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,p.stringStartsWith)(e.statementSeparator,e.decimalSeparator),_=(0,c.makeProgressAsserter)("calc.parse.tokenize",N);for(;N<a.length;){_(N);const l=$(e,r,o,a,N,h);if(null!=l){N=l;continue}const u=(0,d.stringCodePointAt)(a,N);if(Z(e,a,N,h)){const r=G(e,t,a,N,h);if(null!=r){N=r;continue}}if(u!==y)if(e.isIdentContinue(u)){const[t,r]=(0,c.scanWhile)(a,N,(t,r)=>e.isIdentContinue((0,d.stringCodePointAt)(t,r)));N=(0,i.appendToken)(r-N,(0,i.identOrBooleanToken)(e,N,t),h)}else if(u!==R)if((0,s.isSpace)(u)){const[e,t]=(0,c.scanWhile)(a,N,q);N=(0,i.appendToken)(t-N,(0,i.spacesToken)(N,e),h)}else if(u!==b)if(u!==T)if((0,p.stringStartsWith)(a,e.leftBrace,N))v.push({delim:i.DelimId.Brace,lastParen:v.length>0?v[v.length-1].lastParen:void 0,lastBrace:v.length}),N=(0,i.appendToken)(e.leftBrace.length,(0,i.leftBraceToken)(N,e.leftBrace),h);else if((0,p.stringStartsWith)(a,e.rightBrace,N)){if(S){const e=v.length>0?v[v.length-1].lastBrace:void 0;void 0!==e&&(v.length=e)}else v.length>0&&v[v.length-1].delim===i.DelimId.Brace&&v.pop();N=(0,i.appendToken)(e.rightBrace.length,(0,i.rightBraceToken)(N,e.rightBrace),h)}else if((0,p.stringStartsWith)(a,e.leftBracket,N))N=J(e,a,N,h);else if((0,p.stringStartsWith)(a,e.rightBracket,N))N=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(N,e.rightBracket),h);else{if(v.length>0&&v[v.length-1].delim===i.DelimId.Brace){if(k&&A&&(0,p.stringStartsWith)(a,e.statementSeparator,N))break;if((0,p.stringStartsWith)(a,e.columnSeparator,N)){N=(0,i.appendToken)(e.columnSeparator.length,(0,i.colSepToken)(N,e.columnSeparator),h);continue}if((0,p.stringStartsWith)(a,e.rowSeparator,N)){N=(0,i.appendToken)(e.rowSeparator.length,(0,i.rowSepToken)(N,e.rowSeparator),h);continue}}if(k&&(0,p.stringStartsWith)(a,e.statementSeparator,N)&&(I||0===v.length))break;if((0,p.stringStartsWith)(a,e.listSeparator,N))N=(0,i.appendToken)(e.listSeparator.length,(0,i.listSepToken)(N,e.listSeparator),h);else if(u!==C)if(u!==P){if(u===O&&N+1<a.length&&E){const e=a.charCodeAt(N+1);if(e===O){const[e,t]=(0,c.scanWhile)(a,N,z);N=(0,i.appendToken)(t-N,(0,i.singleLineCommentToken)(N,e),h);continue}if(e===g){let[e,t]=(0,c.scanWhile)(a,N+2,Y);const r=(0,p.stringStartsWith)(a,"*/",t);(0,n.assertTrue)("calc.parse.tokenize: /**/",r||t===a.length),t+=r?2:0,e="/*"+e+(r?"*/":""),N=(0,i.appendToken)(t-N,(0,i.multiLineCommentToken)(N,e,r),h);continue}}if(L(u)){if((0,p.stringStartsWith)(a,":=",N)&&(0,m.isFeatureEnabled)(m.FeatureName.CalcLambdaDefaultParameters)){N=(0,i.appendToken)(2,(0,i.assignSepToken)(N),h);continue}N=U(a,N,h)}else N=(0,i.appendToken)((0,d.numCodeUnits)(u),(0,i.unexpectedToken)(N,(0,d.stringFromCodePoint)(u)),h)}else N=X(e,a,N,h);else N=(0,i.appendToken)(1,(0,i.qualSepToken)(N),h)}else{if(S){const e=v.length>0?v[v.length-1].lastParen:void 0;void 0!==e&&(v.length=e)}else v.length>0&&v[v.length-1].delim===i.DelimId.Paren&&v.pop();N=(0,i.appendToken)(1,(0,i.rightParenToken)(N),h)}else v.push({delim:i.DelimId.Paren,lastParen:v.length,lastBrace:v.length>0?v[v.length-1].lastBrace:void 0}),N=(0,i.appendToken)(1,(0,i.leftParenToken)(N),h);else{const t=W(e,a,N,h);if(null!=t){N=t;continue}N=U(a,N,h)}else N=j(a,N,h)}return[h,N]}(e,t,r,o,a,l,f),S=[];let N=0;for(;N<h.length;){const e=h[N];if(e.kind!==i.TokenKind.Unexpected)S.push(e),N+=1;else{const[e,t]=ee(h,N,i.TokenKind.Unexpected,(e,t)=>{const r=e,n=t;return(0,i.unexpectedToken)(r.start,r.chars+n.chars)});S.push(e),N=t}}return S.push((0,i.endToken)(v)),S}},5942:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;const n=r(4666),i=r(2636),o=r(327);function a(e,t,r,n,i){return r(e,t)?1:(0,o.stringStartsWith)(e,n,t)&&t+n.length<e.length&&i(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){let r=t-1;return function(t){if(t<=r){const r=`${e}: internal error: no progress made at index ${t}`;return(0,n.assertFalse)(r)}r=t}},t.scanWhile=function(e,t,r){let n=t;for(;n<e.length&&r(e,n);)n+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=a,t.scanEscapedWhile=function(e,t,r,n,o){const s=[];let l=t,u=t;for(;u<e.length;){const t=a(e,u,r,n,o);if(0===t)break;2===t&&(l!==u&&s.push(e.substring(l,u)),l=u+n.length,u+=n.length),u+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,u))}return l!==u&&s.push(e.substring(l,u)),[s.join(""),u]}},3389:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(9231);function i(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=i,t.isChangeGateEnabled=function(e){var t;return null===(t=i()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},3796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(9231),i={};function o(){return"undefined"==typeof __get_feature_gate_dictionary_variable?i:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var i=parseFloat(n);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var i=parseInt(n,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},9231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(7933);t.globalThis=n},1292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(655);n.__exportStar(r(3796),t),n.__exportStar(r(818),t),n.__exportStar(r(3389),t),n.__exportStar(r(2250),t),n.__exportStar(r(2910),t),n.__exportStar(r(8347),t)},818:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(3796);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},2250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(3389);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},2910:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(655),i=r(3389);function o(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return(0,i.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},8347:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(655),i=r(3796);function o(e){for(var t,r,o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];o[l]=null===(t=e[l])||void 0===t?void 0:t.toString()}var u=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},u()),o)})),u}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},2875:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var r={};t.promises=function(){return void 0===r.promises&&(r.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r.promises}},7859:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var n=r(1880),i={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return i},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,n.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),i=e}},3076:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var i=!1,o=r.performance;try{o&&o.now&&o.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var a=0;a<e.length;a+=1){try{if(i){t.perfNow=!0;var s=Math.floor(100*o.now())%10;(s<0||s>9)&&(s=0);for(var l=0;l<s;l+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},7702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},1821:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(69);t.utils=n;var i=r(2714);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var o=r(2875);t.browserSupport=o;var a=r(6062);t.perfWatch=a;var s=r(7859);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var l=r(9371);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return l.initStopwatchFactory}});var u=r(5933);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return u.TelemetryCollector}});var c=r(3076);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return c.getNewGuid}});var d=r(8978);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}});var f=r(7702);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return f.replaceChildren}})},2714:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,(n=t.TraceLevel||(t.TraceLevel={}))[n.Error=10]="Error",n[n.Warning=15]="Warning",n[n.Info=50]="Info",n[n.Verbose=100]="Verbose",n[n.Spam=200]="Spam",(r=t.LogCategory||(t.LogCategory={}))[r.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,i){return t.dnmTraceTag(e,r,n,i)}}}}};var i=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=i;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=o},6062:(e,t)=>{"use strict";function r(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=r(),i=e,o=t,a={},s=function(e,t,r){return function(e,t,r,i,o,a){n(e,"end",r);var s={sessionName:t,result:i?"success":"failure",message:a,marks:e};o(JSON.stringify(s))}(a,i,o,e,t,r)};return a.start=0,{mark:function(e){return function(e){return n(a,e,o)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},8978:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,(n=t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})).Auto="auto",n.Manual="manual",(r=t.TextAreaInputMode||(t.TextAreaInputMode={})).None="none",r.Text="text",r.Tel="tel",r.Url="url",r.Email="email",r.Numeric="numeric",r.Decimal="decimal",r.Search="search"},9371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var r=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=function(){return self.performance.now()}),function(n){var i=r(),o=n;return{reset:function(e){null!=e&&(o=e),i=r()},stop:function(n){var a=r()-i,s=JSON.stringify({Target:o,Duration:a.toFixed(t),StopInfo:n});e(s)}}}}},5933:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var r=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=r},69:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){if(void 0===r&&(r=0),r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var o={};return Object.keys(n).forEach((function(t){o[t]=e(n[t],r+1)})),o}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var r=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(r,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,i=null;if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,t))&&(n=o.offset,i=null!=o.offsetNode&&null!=o.offsetNode.parentElement&&"SPAN"===o.offsetNode.parentElement.nodeName?o.offsetNode.parentElement:o.offsetNode);else if(void 0!==document.caretRangeFromPoint)null!==(o=document.caretRangeFromPoint(e,t))&&(n=o.startOffset,i=null!=o.startContainer&&null!=o.startContainer.parentElement&&"SPAN"===o.startContainer.parentElement.nodeName?o.startContainer.parentElement:o.startContainer);else try{var o;i=document.elementFromPoint(e,t),(o=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(i),a.setEndPoint("EndToStart",o),n=a.text.length}catch(e){return n}if(r)for(var s=!1;null!=i;)null===i.previousSibling&&null!==i.parentNode&&null!==i.parentNode.parentNode&&i.parentNode.parentNode.childNodes.length>1&&!s?(i=i.parentNode,s=!0):null!=(i=i.previousSibling)&&null!=i.textContent&&(n+=i.textContent.length,s&&(n+=1));else for(;null!=i;)null!=(i=i.previousSibling)&&null!=i.textContent&&(n+=i.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function i(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var o=e.childNodes,a=0;a<o.length&&t>=0;a+=1)t=i(o[a],t,r),n&&"DIV"===o[a].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var o=document.createRange();return i(e,t,(function(e,t){return o.setStart(e,t)})),i(e,r,(function(e,t){return o.setEnd(e,t)})),o.getBoundingClientRect()}},2914:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(3263),i=r(3231),o=r(1721),a=new ArrayBuffer(8),s=new Int32Array(a),l=(new Float32Array(a),new Float64Array(a));function u(e){return s[e]}function c(e,t){s[e]=t}function d(){return l[0]}function f(e){l[0]=e}var p,m=new ArrayBuffer(65536),h=(p=new Uint8Array(m),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)p[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)p[e+n]=r[n]});h(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),h(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),h(1152,"sAsAAMgLAADACwAA0As="),h(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),h(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),h(1975,"oAQ="),h(1991,"yAc="),h(2007,"+go="),h(2022,"QJwO"),h(2038,"UMMR"),h(2054,"JPQU"),h(2069,"gJaYGA=="),h(2085,"ILy+Gw=="),h(2101,"KGvuHg=="),h(2117,"+QKVIg=="),h(2132,"QLdDuiU="),h(2148,"EKXU6Cg="),h(2164,"KueEkSw="),h(2179,"gPQg5rUv"),h(2195,"oDGpX+My"),h(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),h(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),h(3728,"ME8=");var g=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int16Array(r),o=new e.Int32Array(r),a=new e.Uint8Array(r),l=new e.Uint16Array(r),p=new e.Uint32Array(r),m=(new e.Float32Array(r),new e.Float64Array(r)),h=e.Math.imul,g=(e.Math.fround,e.Math.abs),v=e.Math.clz32,S=e.Math.min,y=(e.Math.max,e.Math.floor),C=e.Math.ceil,R=e.Math.sqrt,b=t.abort,N=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),T=t.Base_LocaleGetOrdinal,P=t.Base_LocaleDecimalSeparator,E=t.Math_log10,k=t.Math_log,O=(R=t.Math_sqrt,t.Math_sin),A=t.Math_cos,I=t.Math_tan,_=t.Math_atan,F=t.Math_exp,M=t.proc_exit,D=20112,w=0;function L(){}function x(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=a[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=a[0|t],r=r+-1|0;);}function B(e,t){var r,s,c=0,d=0,p=0,h=0;if(d=3680,D=r=D-48|0,o[r+40>>2]=0,i[r+30>>1]=0,i[r+32>>1]=0,m[460]=e,s=Q(e),m[460]=s,ye(s,r+40|0,r,15),l[r+42>>1]){c=(0|(c=de(t)<<16))<0?100:c>>16,f(+t),p=0|u(1),u(0),(h=-65536&p)&&(2146435072!=(2146435072&p)?c=(0|h)<1?0-c|0:c:o[922]=1);e:{if(!((0|(c=i[r+40>>1]+c|0))>=i[r+42>>1])){if((0|c)<1){d=3e3;break e}(255&c)>>>0>=a[r+30|0]||(n[r+30|0]=c)}Se(3100,3680,r)}e=m[d>>3]}return D=r+48|0,e}function U(e,t){var r,n=0,i=0,a=0;if(m[460]=e,f(+e),i=0|u(1),u(0),a=i,i=0,(n=-65536&a)&&(2146435072!=(2146435072&a)?i=(0|n)<1:(o[922]=1,i=0)),o[921]=2147483647&a,te(m[374]),n=-65536&(a=o[921]))if(2146435072!=(2146435072&a)){if(!((0|n)<1))return q(8),0}else o[922]=1;r=re(m[374],e),m[460]=re(m[372],r),ne(r),me();e:{t:{if((n=o[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;o[922]=1}if(t){if(o[920]=0,o[921]=0,!i)break e;return t=o[741],o[920]=o[740],o[921]=t,m[460]}if(n=o[747],o[920]=o[746],o[921]=n,t=n,1^i|n>>>0<65536)break e;return o[921]=-2147483648^t,m[460]}be(e),he(),t&&(m[460]=re(m[373],m[460]))}return m[460]}function G(e,t,r,n){var s,u=0,c=0,d=0,f=0,p=0,m=0,g=0;if(u=o[e+4>>2],p=-2146827284,!((0|(s=(c=l[e>>1])+(e=(0|(d=i[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+h(e,-12)<<16>>16)-1&65535)>>>0>11|(!u|1900==(0|s)&2==(0|d)&29==(0|u)?!r:0))){if(m=(0|(e=(f=(0|(c=s+1e4|0))/4|0)<<2))%100|0,g=(0|e)%400|0,u=(((f=h(f,1461)+u|0)+((0|(u=e+-1|0))/-100|0)|0)+((0|u)/400|0)|0)-1|0,c=(h(c-e|0,12)+d|0)-1|0)for(c=c+(e=g?m?0:12:0)|0;u=a[e+1072|0]+u|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=u+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=u+-4346384|0}else e=u+-4346384|0;e>>>0>2958465||(o[n>>2]=e,p=0)}return p}function K(e,t,r){var n,s,l,u=0,c=0,d=0;c=d=Ee(e,t,711573504,201),o[r+28>>2]=(c+1>>>0)%7,u=c+h(n=(c>>>0)/146097|0,-146097)|0,s=(h(u,100)+75>>>0)/3652425|0,u=((l=h(s,-36524)+u|0)>>>0)/1461|0,c=(((c+(((u=((h(s,100)+h(n,400)|0)+(u<<2)|0)+((h(l+h(u,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(u>>>2)|0)-((u>>>0)/400|0)|0)+h(u,-365)|0,d=Pe(d,w,-864e5,-1),e=Ee(e,t,1e4,0)+d|0,d=!(((t=u+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=a[c+1568|0])<<1)|0:1536+((t=a[c+1168|0])<<1)|0,o[r+12>>2]=(e>>>0)/36e5,o[r+4>>2]=t+1,o[r>>2]=u+1601,t=(e>>>0)/1e3|0,o[r+20>>2]=(t>>>0)%60,o[r+16>>2]=((e>>>0)/6e4>>>0)%60,o[r+24>>2]=e-h(t,1e3),o[r+8>>2]=1+(c-i[d>>1]|0)}function V(e,t){var r=0,n=0,a=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0;return(0|(s=o[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=o[e>>2])+-1601|0)>>>0>29226||(0|(l=o[e+8>>2]))<1||(a=1536,((u=65535&r)>>>0)%400&&(a=3&r?1936:(u>>>0)%100|0?1536:1936),(f=o[e+24>>2])>>>0>999||(u=o[e+20>>2])>>>0>59||(p=o[e+16>>2])>>>0>59||(m=o[e+12>>2])>>>0>23||(l=l+-1|0)>>>0>=i[a+(s<<1)>>1]-i[a+(d<<1)>>1]>>>0||(a=n>>>2,s=h(n,365),n=((e=65535&n)>>>0)/400|0,g=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((c>>>0)%100)|3&r)||(e=1536),c=1,r=(r=h(h(h(m,60)+p|0,60)+u|0,1e3)+f|0)+(n=Pe(e=i[(d<<1)+e>>1]+(n+((l+(s+a|0)|0)-g|0)|0)|0,e>>31,864e5,0))|0,e=w,o[t>>2]=Pe(r,r>>>0<n>>>0?e+1|0:e,1e4,0),o[t+4>>2]=w)),c}function j(e,t,r,n){var i,a=0,s=0,l=0,u=0;D=i=D-112|0,K(r,n,i+80|0);e:{if(o[e>>2]){if(!V(e,t))break e}else{if((0|(s=o[e+8>>2]))>5|!s)break e;if(r=o[e+4>>2],n=o[e+28>>2],a=o[i+80>>2],o[i+56>>2]=1,o[i+52>>2]=r,o[i+48>>2]=a,o[i+60>>2]=o[e+12>>2],o[i+64>>2]=o[e+16>>2],o[i+68>>2]=o[e+20>>2],e=o[e+24>>2],o[i+76>>2]=0,o[i+72>>2]=e,!V(i+48|0,i+8|0)){a=0;break e}e=n+8|0,r=n+1|0,l=(0|s)<2,K(o[i+8>>2],o[i+12>>2],i+16|0),u=i;t:{if((0|n)<(0|(a=o[i+44>>2])))e=e-a|0;else{if(e=1,(0|n)<=(0|a))break t;e=r-a|0}o[u+56>>2]=e}t:if(!l&&(r=e+7|0,o[i+56>>2]=r,a=1,V(i+48|0,i+8|0)))for(;;){if(K(o[i+8>>2],o[i+12>>2],i+16|0),e=o[i+24>>2],(0|s)==(0|(a=a+1|0)))break t;if(r=r+7|0,o[i+56>>2]=r,!V(i+48|0,i+8|0))break}if(o[i+56>>2]=e,!V(i+48|0,i+8|0)){a=0;break e}e=o[i+12>>2],o[t>>2]=o[i+8>>2],o[t+4>>2]=e}a=1}return D=i+112|0,a}function W(e,t,r){var n,a=0,s=0,u=0,c=0,d=0;if(D=n=D-16|0,r&&(u=r>>31,u^=u+r))for(r=(0|r)>0?1952:2448;(a=15&u)&&(s=i[8+(a=(a<<4)+r|0)>>1],d=H(m[e>>3],m[a>>3],n),t=t+s|0,i[n+14>>1]<=0?(a=l[n+6>>1],s=l[n+8>>1]):(s=o[n+4>>2],a=l[n+6>>1]<<1,i[n+6>>1]=a,c=o[n+8>>2],o[n+12>>2]=o[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,o[n+8>>2]=s,t=t+-1|0),(65535&a|1&s|0!=(0|d))>>>0<32769||(s=(a=o[n+8>>2])+1|0,o[n+8>>2]=s,s>>>0>=a>>>0||(s=(a=o[n+12>>2])+1|0,o[n+12>>2]=s,s>>>0>=a>>>0||(o[n+12>>2]=-2147483648,t=t+1|0))),a=o[n+12>>2],o[e>>2]=o[n+8>>2],o[e+4>>2]=a),r=r+240|0,u>>=4;);return D=n+16|0,t}function H(e,t,r){var n,o,a,s=0,l=0,c=0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,C=0,R=0;return f(+t),d=0|u(1),p=65535&(l=0|u(0)),f(+e),y=0|u(1),s=0|u(0),c=y,o=h(v=65535&s,p),i[r>>1]=o,a=((65535&(C=h(S=s>>>16,p)))+(o>>>16)|0)+(65535&(g=h(l>>>=16,v)))|0,i[r+2>>1]=a,C=(((m=((65535&(s=h(n=65535&c,p)))+(C>>>16)|0)+(g>>>16)|0)+(65535&(g=h(l,S)))|0)+(65535&(R=h(y=65535&d,v)))|0)+(a>>>16)|0,i[r+4>>1]=C,g=(((((((65535&(m=h(d>>>=16,v)))+(s>>>16)|0)+(65535&(c=h(s=c>>>16,p)))|0)+(g>>>16)|0)+(R>>>16)|0)+(65535&(p=h(y,S)))|0)+(65535&(v=h(l,n)))|0)+(C>>>16)|0,i[r+6>>1]=g,S=((((((R=(c>>>16)+(m>>>16)|0)+(65535&(c=h(d,S)))|0)+(p>>>16)|0)+(v>>>16)|0)+(65535&(m=h(s,l)))|0)+(65535&(l=h(y,n)))|0)+(g>>>16)|0,i[r+8>>1]=S,m=((l=(((65535&(p=h(d,n)))+(c>>>16)|0)+(m>>>16)|0)+(l>>>16)|0)+(65535&(c=h(s,y)))|0)+(S>>>16)|0,i[r+10>>1]=m,s=(((65535&(d=h(s,d)))+(p>>>16)|0)+(c>>>16)|0)+(m>>>16)|0,i[r+12>>1]=s,i[r+14>>1]=(s>>>16)+(d>>>16),65535&(o|a|C)}function Q(e){var t,r,n=0,i=0,a=0,s=0,l=0,c=0;return D=t=D-16|0,m[t+8>>3]=e,f(+e),n=0|u(1),i=0|u(0),r=n,(n&=2146435072)&&(o[t+8>>2]=i<<11,o[t+12>>2]=r<<11|i>>>21|-2147483648,s=(n=h(i=(n>>>20)-1022|0,39457)>>17)-14|0,a=W(t+8|0,i,14-n|0),i=o[t+8>>2],(0|a)>=(0|(p[t+12>>2]<(i>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(a=W(t+8|0,a,1),i=o[t+8>>2],s=n+-15|0),n=s,s=(s=i)+(i=-2147483648>>>(31&a))|0,o[t+8>>2]=s,s>>>0>=i>>>0||(c=(l=o[t+12>>2])+1|0,o[t+12>>2]=c,c>>>0>=l>>>0||(o[t+12>>2]=-2147483648,a=a+1|0)),o[t+8>>2]=s&0-(i<<1),a=W(t+8|0,a,n),3071&(n=o[t+8>>2])?(i=n+1024|0,o[t+8>>2]=i,n>>>0<4294966272||(s=(n=o[t+12>>2])+1|0,o[t+12>>2]=s,a=(s>>>0<n>>>0)+a|0)):i=n,(0|a)<=-1023?(o[t+8>>2]=0,o[t+12>>2]=0):(0|(n=1071644672+(a<<20)|0))<=-1||(a=o[t+12>>2],o[t+8>>2]=a<<21|i>>>11,o[t+12>>2]=a>>>11&1048575|n|-2147483648&r),e=m[t+8>>3]),D=t+16|0,e}function q(e){var t;return t=o[922],o[922]=e,t}function z(){var e,t,r;return e=o[920],t=o[921],Z(1048576),Z(2146435072),i[1843]<0?(o[920]=e,o[921]=t,-2147483648):(r=ce(),o[920]=e,o[921]=t,-2147483648^r)}function Y(e){var t,r=0,n=0,i=0,o=0;if(f(+e),r=0|u(1),t=0|u(0),o=r,i=0,!((r=2047&(n=r>>>20))>>>0<1023||(i=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|o),+d();o&=n,c(0,0),c(1,0|o),i=+d()}return i}function J(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return o[920]=0,o[921]=-2147483648,n=W(3680,1,e),r=o[920],e=o[921],3071&r&&(t=o[921],(e=o[920]+1024|0)>>>0<1024&&(t=t+1|0),o[920]=e,o[921]=t,r=e,e=t),o[920]=e<<21|r>>>11,void(o[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(o[922]=1),o[920]=0,o[921]=0}function X(e,t,r,n){var a=0,s=0,u=0;e:{t:{r:{n:{if(!n){if(l[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return o[t>>2]=1,void(o[r>>2]=0)}if(l[(n<<1)+e>>1]<=52)break e;for(;;){if(u=l[(s=((a=n+-1|0)<<1)+e|0)>>1]+1|0,i[s>>1]=u,58!=(65535&u))break e;if(!(n=a))break}}return i[e>>1]=49,o[t>>2]=o[t>>2]+1,void(o[r>>2]=1)}for(;t=n,(0|n)>=2&&48==l[((n=t+-1|0)<<1)+e>>1];);o[r>>2]=t}function $(){var e=0,t=0,r=0;e:{if(r=o[920],t=-65536&(e=o[921])){if(2146435072==(2146435072&e))return o[922]=1,void ge();if((0|t)<1)break e}return void ge()}ge(),(0|r)==o[920]&&o[921]==(0|e)||te(1)}function Z(e){m[460]=ee(m[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[922]=1,e=m[375]),e}function te(e){m[460]=re(m[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[922]=1,e=m[375]),e}function ne(e){m[460]=ie(m[460],e)}function ie(e,t){var r,n=0,i=0,a=0;return f(+e*t),n=0|u(1),r=0|u(0),0|2146435072!=(0|(i=2146435072&n))?(a=(i=!(i|a))?o[750]:r,n=i?o[751]:n,c(0,0|a),c(1,0|n),+d()):(o[922]=1,n=o[751],c(0,o[750]),c(1,0|n),+d())}function oe(e){m[460]=ae(m[460],e)}function ae(e,t){var r=0,n=0,i=0,a=0;if(f(+t),r=0|u(1),u(0),2146435072&r){if(n=1,f(+e/t),r=0|u(1),i=0|u(0),!(!0&2146435072==(0|(a=2146435072&r))))return i=(n=!(0|a))?o[750]:i,r=n?o[751]:r,c(0,0|i),c(1,0|r),+d()}else n=4;return o[922]=n,r=o[751],c(0,o[750]),c(1,0|r),+d()}function se(e){m[460]=e>>>0}function le(e){m[460]=0|e}function ue(){var e,t;e=+k(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}function ce(){return de(m[460])}function de(e){var t,r=0,n=0,i=0,o=0;return f(+e),o=1106247680==(0|(i=2146435072&(r=0|u(1))))&o>>>0<0|i>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|u(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(i=g(e)>=1?e>0?~~S(y(e/4294967296),4294967295)>>>0:~~C((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(i=0,r=0),n=o?r:n,!(r=o?i:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return pe(m[460])}function pe(e){var t=0,r=0;return f(+e),t=0|u(1),u(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=g(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function me(){var e,t;e=+R(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}function he(){var e,t;e=+_(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}function ge(){m[460]=Y(m[460])}function ve(){var e,t;e=+F(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=1)}function Se(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=a[r+30|0]){for(s=r;d=10*d+ +(0|Oe[o[o[e>>2]+4>>2]](e,l[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(f(+d),n=0|u(1),e=0|u(0),o[t>>2]=e<<11,o[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=W(t,(n>>>20&2047)-1022|0,((32767&l[r+32>>1])-a[r+30|0]|0)-16384|0),3071&(s=o[t>>2])?(e=s+1024|0,o[t>>2]=e,s>>>0<4294966272||(c=(s=o[t+4>>2])+1|0,o[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=o[t+4>>2],o[t>>2]=n<<21|e>>>11,o[t+4>>2]=-2147483648&i[r+32>>1]|s|n>>>11&1048575,0)}return o[t>>2]=0,o[t+4>>2]=0,0}(e,t,r)}function ye(e,t,r,a){!function(e,t,r,a){var s,c,d=0,p=0,g=0,v=0,S=0,y=0,C=0,R=0,b=0,N=0;D=s=D-16|0,m[s+8>>3]=e,c=t,f(+e),p=0|u(1),g=0|u(0),v=d=p;e:if(p=2146435072&d){if(p=h(S=(p>>>20)-1022|0,39457)>>17,i[r+32>>1]=p+16385|d>>>16&32768,(0|a)<=14){if((0|(a=1+(a+p|0)|0))<=-1){n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;break e}a=(0|a)<15?a:15}if(o[s+8>>2]=g<<11,o[s+12>>2]=v<<11|g>>>21|-2147483648,(0|(d=W(s+8|0,S,-1^p)))>=1)for(g=r+32|0;p=l[g>>1],i[g>>1]=p+1&32767|32768&p,(0|(d=W(s+8|0,d,-1)))>0;);if(d?(p=(g=o[s+12>>2])>>>(v=0-d|0),o[s+12>>2]=p,d=g<<d+32|o[s+8>>2]>>>v,o[s+8>>2]=d):(d=o[s+8>>2],p=o[s+12>>2]),d=(g=p>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,o[s+8>>2]=d,d>>>0<g>>>0&&(p=p+1|0,o[s+12>>2]=p),(0|a)<1)g=r;else{for(y=d>>>16,C=l[s+14>>1],R=r+32|0,N=15==(0|a),g=r,v=1;;){S=a;t:{r:{for(;;){if(a=h(y,10)+(h(65535&d,10)>>>16)>>>16,b=h(C,10)+(a+h(65535&p,10)>>>16)>>>16|48,i[g>>1]=b,C=(p=a+h(p,10)|0)>>>16,y=(d=h(d,10))>>>16,1&(-1^v|48!=(0|b)))break r;if(a=l[R>>1],i[R>>1]=a+-1&32767|32768&a,!N)break}v=1;break t}g=g+2|0,v=0}if(a=S+-1|0,!((0|S)>1))break}o[s+12>>2]=p,o[s+8>>2]=d}d=(a=g-r|0)>>1;t:{if((0|a)<=29){if((0|p)<=-1){i[g>>1]=57,p=d+1|0;break t}i[g>>1]=48}for(;;){if(p=d,(0|d)<1)break t;if(d=p+-1|0,48!=l[(g=g+-2|0)>>1])break}}n[r+30|0]=p,i[t+2>>1]=p,t=(32767&l[r+32>>1])-16384|0}else n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;i[c>>1]=t,D=s+16|0}(e,t,r,a)}function Ce(e){return re(m[460],e)}function Re(e){return ae(m[460],e)}function be(e){m[460]=ae(e,m[460])}function Ne(e,t){m[460]=ae(e,t)}function b(){M(1),b()}function Te(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Pe(e,t,r,n){return e=function(e,t,r,n){var i,o,a,s,l=0,u=0;return s=h(l=r>>>16,u=e>>>16),l=(65535&(u=((a=h(i=65535&r,o=65535&e))>>>16)+h(u,i)|0))+h(l,o)|0,e=(((h(t,r)+s|0)+h(e,n)|0)+(u>>>16)|0)+(l>>>16)|0,w=e,65535&a|l<<16}(e,t,r,n)}function Ee(e,t,r,n){return function(e,t,r,n){var i=0,o=0;return r=function(e,t,r,n){var i=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0;e:{t:{r:{n:{i:{o:{a:{s:{l:{u:{if(a=t){if(!(i=r))break u;if(!(o=n))break l;if((i=v(o)-v(a)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Te(e-h(t=(e>>>0)/(r>>>0)|0,r)|0,0),w=0,t}if(i=n,!e)break a;if(!i)break o;if((o=i+-1|0)&i)break o;return Te(e,a&o),e=a>>>(31&ke(i)),w=0,e}if(!((o=i+-1|0)&i))break i;u=0-(l=(v(i)+33|0)-v(a)|0)|0;break r}l=i+1|0,u=63-i|0;break r}return Te(0,a-h(e=(a>>>0)/(i>>>0)|0,i)|0),w=0,e}if((i=v(i)-v(a)|0)>>>0<31)break n;break t}if(Te(e&o,0),1==(0|i))break e;return n=e,e=31&(r=ke(i)),32<=(63&r)>>>0?(i=0,e=t>>>e):(i=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),w=i,e}l=i+1|0,u=63-i|0}if(o=t,f=e,a=31&(i=63&l),32<=(63&i)>>>0?(i=0,s=o>>>a):(i=o>>>a,s=((1<<a)-1&o)<<32-a|f>>>a),o=i,a=e,e=31&(i=63&u),32<=(63&i)>>>0?(i=a<<e,e=0):(i=(1<<e)-1&a>>>32-e|t<<e,e=a<<e),t=i,l)for(i=n+-1|0,(a=r+-1|0)>>>0<4294967295&&(i=i+1|0),u=i;i=o<<1|s>>>31,o=s<<1,f=i,i=(s=u-((a>>>0<(o|=t>>>31)>>>0)+i|0)|0)>>31,s=(d=o)-(o=r&(c=s>>31))|0,o=f-((n&i)+(d>>>0<o>>>0)|0)|0,i=t<<1|e>>>31,e=p|e<<1,t=0|i,d=0,p=c&=1,l=l+-1|0;);return Te(s,o),w=(i=t<<1|e>>>31)|d,c|e<<1}Te(e,t),e=0,t=0}return w=t,e}((e^=i=t>>31)-i|0,o=((o=t>>31)^t)-((e>>>0<i>>>0)+o|0)|0,(r^=e=n>>31)-e|0,((i=n>>31)^n)-((r>>>0<e>>>0)+i|0)|0),w=((e=(t^=n)>>31)^w)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,r-t|0}(e,t,r,n)}function ke(e){return e?31-v(e+-1^e)|0:32}var Oe=[null,function(e,t){return 0!=(0|N(0|(t|=0)))|0},function(e,t){return 0|T(0|(t|=0))},function(e){return 0|P()},function(e,t){return(t|=0)-48|0},L];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return a[1072+(((h(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=h(r|=0,20)+3616|0,i[r>>1]=0,t=function(e,t,r,n,s){var p=0,g=0,v=0,S=0,y=0,C=0,R=0,b=0,N=0;e:if(!l[e>>1]){if(m[460]=t,f(+t),p=0|u(1),v=0|u(0),C=p,N=-65536&p)if(2146435072!=(2146435072&p)){if(!((0|N)>=1))return-2147467259}else o[922]=1;y=o[770],S=-1;t:{if(!((0|p)<(0|(g=R=o[771]))||(S=1,(0|p)>(0|g)))){if((0|y)==(0|(g=v)))break t;S=g>>>0<y>>>0?-1:1}if(g=-2147467259,1==(0|((C&R)>-1?S:0-S|0)))break e}t:{if(y=o[772],R=g=o[773],S=-1,!((0|p)<(0|g)||(S=1,(0|p)>(0|R)))){if((0|v)==(0|y))break t;S=v>>>0<y>>>0?-1:1}if(y=S,-1==(0|((g&C)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(s|!N))if(2146435072!=(2146435072&p)){if((0|N)<1)break r}else o[922]=1;Z(m[o[1056+(r<<2)>>2]>>3]),b=m[460];break t}$(),te(t),v=C=o[921],c(0,0|(p=o[920])),c(1,0|v),b=+d(),o[750]==(0|p)&&o[751]==(0|v)||(g=o[921])>>>0<65536||(o[921]=-2147483648^g,f(+(b=m[460])),v=0|u(1),p=0|u(0)),C=v,y=v,v=o[1056+(r<<2)>>2],R=o[v+4>>2],g=o[v>>2],S=-1;r:{if(!((0|y)<(0|(v=R))||(S=1,(0|y)>(0|v)))){if((0|p)==(0|g)){m[460]=t;break r}S=p>>>0<g>>>0?-1:1}if(y=S,m[460]=t,-1==(0|((C&R)>-1?y:0-y|0)))break t}te(m[374])}if(i[e+18>>1]=r,p=fe(),g=-2147467259,!q(0)){if(n){if((0|p)>2957003)break e;p=p+1462|0}else if(p+4346018>>>0>7304483)break e;if(i[e+14>>1]=1+((p+6|0)%7|0),!s|p)if(p){if((0|p)<=-1?(v=-4-((n=(-1^p)/1461|0)<<2)|0,g=1461+(h(n,1461)+p|0)|0):(v=(n=(p+-1|0)/1461|0)<<2,g=h(n,-1461)+p|0),!(s&&(0|v)<=199))if((0|(g=(((0|(n=v+-101|0))/100|0)-((0|n)/400|0)|0)+g|0))>=1462){p=3&(n=v+1900|0);t:if(s){if(p|(0|v)<200)break t;p=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else p||(p=!((0|n)%100)&0!=((0|n)%400|0));v=v+4|0,g=(12==(0|h(p,12))?-1460:-1461)+g|0}else(0|g)>0||(v=v+-4|0,g=g+1461|0);p=3&(n=v+1900|0);t:if(s){if(p|(0|v)<200)break t;p=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else p||(p=!((0|n)%100)&0!=((0|n)%400|0));for(p=C=h(p,12);s=p,p=p+1|0,(0|(g=(n=g)-a[s+1072|0]|0))>0;);s=((g=s)-((0|C)<(0|(s=s+-11|0))?C:s)>>>0)/12|0,i[e>>1]=1900+(s+v|0),i[e+2>>1]=(h(s,-12)+p|0)-C}else o[e>>2]=788331,n=30;else o[e>>2]=67436;if(o[e+4>>2]=n,m[460]=b,ge(),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(b),ne(m[379]),t=m[460],n=ce(),i[e+8>>1]=n,se(n<<16>>16),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(t),ne(m[380]),t=m[460],n=ce(),i[e+10>>1]=n,se(n<<16>>16),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(t),ne(m[380]),!r)return r=ce(),i[e+16>>1]=0,i[e+12>>1]=r,0;t=m[460],n=ce(),i[e+12>>1]=n,se(n<<16>>16),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(t),ne(m[o[1152+(r<<2)>>2]>>3]),m[460]=Q(m[460]),i[e+16>>1]=ce(),g=0}}return g}(r,e,t,0!=(0|n),0!=(0|s)),o[922]=0,0|t},Dtr_Yr:function(e){return i[h(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return i[h(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return o[h(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return i[h(e|=0,20)+3624>>1]},Dtr_Min:function(e){return i[h(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return i[h(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return i[h(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return i[h(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return i[h(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,a,s,l,u,c,d){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,l|=0,u|=0,c|=0,d=h(d|=0,20),i[d+3634>>1]=c,i[d+3632>>1]=u,i[d+3630>>1]=l,i[d+3628>>1]=s,i[d+3626>>1]=a,i[d+3624>>1]=n,o[d+3620>>2]=r,i[d+3618>>1]=t,i[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,o[920]=0,o[921]=0,function(e,t,r){var n,a=0;D=n=D-16|0;e:{t:{r:{if((l[e+2>>1]+-32767&65535)>>>0>1){if(i[e+18>>1]>=1?(le(i[e+16>>1]),a=Re(m[o[1152+(i[e+18>>1]<<2)>>2]>>3]),le(i[e+12>>1]),Z(a)):le(i[e+12>>1]),a=Re(m[380]),le(i[e+10>>1]),Z(a),a=Re(m[380]),le(i[e+8>>1]),Z(a),a=Re(m[379]),!((0|G(e,t,r,n+12|0))<0)){if(e=o[n+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=o[921])))break t;if(2146435072==(2146435072&e)){o[922]=1;break t}if((0|t)>=1)break t}}o[920]=0,o[921]=0}o[920]=0,o[921]=0,q(8);break e}se(e)}Z(a)}D=n+16|0}(h(e,20)+3616|0,0!=(0|t),0!=(0|r)),+m[460]},Dtr_ToNumWithDuration:function(e,t,r,n,a){return e|=0,t|=0,r|=0,n|=0,a|=0,o[920]=0,o[921]=0,function(e,t,r,n,a){var s,u=0;D=s=D-16|0;e:{t:{r:{if((l[e+2>>1]+-32767&65535)>>>0>1){n:if(i[e+18>>1]>=1){if(le(i[e+16>>1]),oe(m[o[1152+(i[e+18>>1]<<2)>>2]>>3]),u=m[460],2==(0|a)){m[460]=n,Z(u);break n}le(i[e+12>>1]),Z(u)}else 2!=(0|a)?le(i[e+12>>1]):m[460]=n;if(oe(m[380]),u=m[460],1!=(0|a)?le(i[e+10>>1]):m[460]=n,Z(u),oe(m[380]),u=m[460],a?le(i[e+8>>1]):m[460]=n,Z(u),oe(m[379]),n=m[460],!((0|G(e,t,r,s+12|0))<0)){if(e=o[s+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=o[921])))break t;if(2146435072==(2146435072&e)){o[922]=1;break t}if((0|t)>=1)break t}}o[920]=0,o[921]=0}o[920]=0,o[921]=0,q(8);break e}se(e)}Z(n)}D=s+16|0}(h(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|a),n),+m[460]},Dtr_Days:function(){return o[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(h(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){m[460]=e,Z(m[o[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(m[380]);ne(m[380])}ne(m[379]),ge()}(e=+e,t|=0,r|=0),+m[460]},Dtr_UtcToLocal:function(e,t,r,n,a,s,u,c){var d;return e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,u|=0,c|=0,D=d=D-32|0,o[d+24>>2]=s,o[d+16>>2]=n,o[d+8>>2]=t,o[d+20>>2]=(0|a)>-1?h(a,20)+3616|0:0,o[d+12>>2]=(0|r)>-1?h(r,20)+3616|0:0,e=function(e,t,r,n){var a,s=0;return D=a=D-32|0,function(e,t,r){var n,a=0,s=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0,S=0,y=0;if(D=n=D-96|0,o[n+64>>2]=i[t>>1],o[n+68>>2]=i[t+2>>1],o[n+72>>2]=o[t+4>>2],o[n+76>>2]=i[t+8>>1],o[n+80>>2]=i[t+10>>1],o[n+84>>2]=i[t+12>>1],o[n+92>>2]=i[t+14>>1]+-1,(a=i[t+18>>1])>>>0<=3){e:{t:switch(a-1|0){case 0:a=h(i[t+16>>1],100);break e;case 1:a=h(i[t+16>>1],10);break e;case 2:break t;default:break e}a=i[t+16>>1]}o[n+88>>2]=a}t=0;e:if(V(n- -64|0,n+40|0)){if(u=Pe(u=h(o[e>>2],60),u>>31,1e7,0),d=w,(s=o[e+4>>2])&&(c=o[e+12>>2])){if(o[n+64>>2]=i[s>>1],o[n+68>>2]=i[s+2>>1],o[n+72>>2]=o[s+4>>2],o[n+76>>2]=i[s+8>>1],o[n+80>>2]=i[s+10>>1],o[n+84>>2]=i[s+12>>1],o[n+92>>2]=i[s+14>>1]+-1,(a=i[s+18>>1])>>>0<=3){t:{r:switch(a-1|0){case 0:a=h(i[s+16>>1],100);break t;case 1:a=h(i[s+16>>1],10);break t;case 2:break r;default:break t}a=i[s+16>>1]}o[n+88>>2]=a}if(o[n+8>>2]=i[c>>1],o[n+12>>2]=i[c+2>>1],o[n+16>>2]=o[c+4>>2],o[n+20>>2]=i[c+8>>1],o[n+24>>2]=i[c+10>>1],o[n+28>>2]=i[c+12>>1],o[n+36>>2]=i[c+14>>1]+-1,(a=i[c+18>>1])>>>0<=3){t:{r:switch(a-1|0){case 0:a=h(i[c+16>>1],100);break t;case 1:a=h(i[c+16>>1],10);break t;case 2:break r;default:break t}a=i[c+16>>1]}o[n+32>>2]=a}if(c=s=o[n+44>>2],!j(n- -64|0,n+56|0,a=o[n+40>>2],s))break e;if(!j(n+8|0,n+48|0,a,c))break e;g=o[n+40>>2],p=o[n+44>>2],v=u,S=e+16|0,y=e+8|0,m=(c=d)+o[n+52>>2]|0,(f=(a=u)+o[n+48>>2]|0)>>>0<a>>>0&&(m=m+1|0),s=f,f=Pe(a=h(o[e+8>>2],60),a>>31,1e7,0),a=w+m|0,m=s=s+f|0,f=a=s>>>0<f>>>0?a+1|0:a,s=d+o[n+60>>2]|0,(d=u+o[n+56>>2]|0)>>>0<u>>>0&&(s=s+1|0),u=Pe(e=h(o[e+16>>2],60),e>>31,1e7,0),e=w+s|0,e=(d=u+d|0)>>>0<u>>>0?e+1|0:e,u=d,e=Pe(e=h(o[((e=(0|a)<(0|e)||(0|a)<=(0|e)&&!(m>>>0>=u>>>0)?((0|p)<(0|e)?1:(0|p)<=(0|e)?g>>>0>=u>>>0?0:1:0)&((0|p)>(0|f)?1:(0|p)>=(0|f)?g>>>0<m>>>0?0:1:0):((0|p)<(0|e)?1:(0|p)<=(0|e)?g>>>0>=u>>>0?0:1:0)|((0|p)>(0|f)?1:(0|p)>=(0|f)?g>>>0<m>>>0?0:1:0))?S:y)>>2],60),e>>31,1e7,0),a=w+c|0,d=a=(u=v+e|0)>>>0<e>>>0?a+1|0:a}e=o[n+40>>2],a=o[n+44>>2]-(d+(e>>>0<u>>>0)|0)|0,u=e-u|0,(0|(e=a))<0||(0|e)<=0&&!(u>>>0>=0)||(K(u,e,n- -64|0),i[r>>1]=o[n+64>>2],i[r+2>>1]=o[n+68>>2],o[r+4>>2]=o[n+72>>2],t=1,i[r+14>>1]=l[n+92>>1]+1,i[r+8>>1]=o[n+76>>2],i[r+10>>1]=o[n+80>>2],i[r+12>>1]=o[n+84>>2],e=o[n+88>>2],i[r+18>>1]=3,i[r+16>>1]=e)}return D=n+96|0,t}(n,e,a+8|0)&&(n=o[a+12>>2],o[e>>2]=o[a+8>>2],o[e+4>>2]=n,o[e+16>>2]=o[a+24>>2],n=o[a+20>>2],o[e+8>>2]=o[a+16>>2],o[e+12>>2]=n,n=e,(0|G(e,t,r,a+28|0))>=0?e=1+((o[a+28>>2]+6|0)%7|0)|0:(o[a+28>>2]=-1,e=6),i[n+14>>1]=e,s=1),D=a+32|0,s}(h(e,20)+3616|0,0!=(0|u),0!=(0|c),d+8|0),D=d+32|0,0|e},Mathpack_Zero:function(){return+m[375]},Mathpack_One:function(){return+m[374]},Mathpack_Pi:function(){return+m[370]},Mathpack_Div:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ie(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,a=0,s=0;m[460]=t,f(+t),r=0|u(1),u(0),a=r,o[921]=2147483647&r,t=m[460];e:{if(f(+Ce(m[371])),65535==(0|(r=0|u(1)))&(n=0|u(0))>>>0<=4294967295|r>>>0<65535)m[460]=e,me();else if(ge(),f(+Ce(t)),65535==(0|(r=0|u(1)))&(n=0|u(0))>>>0>4294967295|r>>>0>65535||-1==(0|(r=ce()))){if(m[460]=e,f(+e),n=0|u(1),u(0),(0|(n=(r=n)>>>16<<16))>=1)ue(),ne(t),ve();else if(!((0|n)>-1)){if(Ne(m[374],t),s=Q(m[460]),m[460]=s,ge(),f(+Ce(s)),65535==(0|(n=0|u(1)))&u(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;m[460]=e,o[921]=2147483647&r,ue(),ne(t),ve(),(r=o[921])>>>0<65536||(o[921]=-2147483648^r)}}else m[460]=e,function(e){var t,r=0;if((t=i[1843])|e){if(!((0|t)<1)&&10==(0|ce())){if(r=m[460],ge(),te(r),!l[1843])return void J(e);m[460]=r}for(r=1;1&e&&(r=ie(m[460],r)),e>>>=1;)ne(m[460]);m[460]=r}else o[922]=4&o[922]?4:64}(r);if(a>>>16<<16>>16<=-1){if(1&(a=o[922]))return o[920]=0,o[921]=0,o[922]=-2&a,m[460];be(m[374])}return m[460]}return o[922]=8,m[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|u(1),u(0),(r=-65536&t)?2146435072==(2146435072&t)?(o[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,i,o,a=0,s=0,l=0;f(+(e=+e)),a=0|u(1),r=0|u(0),n=a,o=a,f(+t),i=0|u(1),a=0|u(0),l=-1;e:{if(!((0|n)<(0|(s=i))||(l=1,(0|o)>(0|s)))){if(s=0,(0|a)==(0|r))break e;l=r>>>0<a>>>0?-1:1}a=l,s=(i&n)>-1?a:0-a|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=o[922],o[922]=0,0|e},Mathpack_Trunc:function(e){return+Y(e=+e)},Mathpack_Ceil:function(e){return e=+e,m[460]=e,function(){var e=0,t=0,r=0;e:{if(r=o[920],t=-65536&(e=o[921])){if(2146435072==(2146435072&e))return o[922]=1,void ge();if((0|t)>0)break e}return void ge()}ge(),(0|r)==o[920]&&o[921]==(0|e)||Z(1)}(),+m[460]},Mathpack_Floor:function(e){return e=+e,m[460]=e,$(),+m[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|u(1),t&=2147483647,c(0,0|u(0)),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,i;return f(+(e=+e)),n=-2147483648^(t=0|u(1)),c(0,0|(r=0|u(0))),c(1,0|n),i=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?i:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|pe(e=+e)},Mathpack_SFix:function(e){return e=+e,m[460]=e,0|z()},Mathpack_Round:function(e,t){return+function(e,t){var r,a=0,s=0,c=0,d=0;D=r=D+-64|0,o[r+56>>2]=0,i[r+46>>1]=0,i[r+48>>1]=0,m[460]=e,f(+e),a=0|u(1),u(0);e:if(s=-65536&a)if(2146435072!=(2146435072&a)){(0|s)>0||(d=32768,a>>>0<65536||(o[921]=-2147483648^a,e=m[460])),ye(e,r+56|0,r+16|0,15),l[r+58>>1]||(i[r+56>>1]=1),m[460]=t,a=(0|(a=z()))<0?100:a;t:{if(c=-65536&(s=o[921]))if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((a=o[921])>>>0>=65536&&(o[921]=-2147483648^a),(0|(a=z()))<=-1)break t;a=0-a|0}}else o[922]=1;(0|(c=a+(s=i[r+56>>1])|0))<(0|(a=i[r+58>>1]))&&(o[r+12>>2]=a,o[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),a=o[r+12>>2],i[r+58>>1]=a,s=o[r+8>>2],i[r+56>>1]=s),n[r+46|0]=a,i[r+48>>1]=s+16384&32767|d,Se(3100,3680,r+16|0),e=m[460];break e}e=m[375]}else o[922]=1;return D=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,i=0,a=0,s=0;if(f(+e),r=0|u(1),u(0),(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:o[922]=1),i=B(e,t),m[460]=e,m[460]=Q(e),te(i),(r=o[921])>>>0>=65536){if(2146435072==(2146435072&r))return o[922]=1,i;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|u(1),u(0),(a=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|a)<1?0-r|0:r:o[922]=1),(0|r)<=-309)return q(8),0;J(0-r|0),(0|s)>-1||(r=o[921])>>>0<65536||(o[921]=-2147483648^r),Z(i),i=m[460]}return i}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=B(e=+e,t=+t))),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return J(e|=0),+m[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,i=0,a=0,s=0,l=0;D=r=D-16|0,m[r+8>>3]=e,m[r>>3]=t,f(+e),n=0|u(1),i=0|u(0),a=n,f(+t),l=n=0|u(1);e:{if((0|i)!=(0|(s=0|u(0)))||(0|a)!=(0|n)){if((l+2097152&2146435072)-(2146435072&a)>>>0<=5242879&&(e=Q(e),m[r+8>>3]=e,f(+e),n=0|u(1),u(0),a=n,e=Q(t),m[r>>3]=e,f(+e),n=0|u(1),u(0),l=n),n=1,(0|(a=o[(s=(i=(l&a)>-1)?r+8|0:r)+4>>2]))>(0|(l=o[(i=i?r:r+8|0)+4>>2])))break e;if((0|a)<(0|l)){n=-1;break e}if((s=o[s>>2])>>>0>(i=o[i>>2])>>>0)break e;if(n=-1,s>>>0<i>>>0)break e}n=0}return D=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|u(1),u(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,i;return f(+(e=+e)),i=0|u(1),r=0|u(0),f(+t),n=0|u(1),0|((0|r)==(0|u(0))?(0|i)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|u(1),u(0),2146435072==(2146435072&t)?(o[922]=1,-1):+Q(e)},Mathpack_Sqrt:function(e){return e=+e,m[460]=e,me(),+m[460]},Mathpack_Exp:function(e){return e=+e,m[460]=e,ve(),+m[460]},Mathpack_Ln:function(e){return e=+e,m[460]=e,ue(),+m[460]},Mathpack_Log:function(e){return e=+e,m[460]=e,function(){var e,t;e=+E(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}(),+m[460]},Mathpack_Sin:function(e){return e=+e,m[460]=e,function(){var e=0,t=0;f(+(t=m[460])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+O(+t),m[460]=t,f(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[922]=8)}(),+m[460]},Mathpack_Cos:function(e){return e=+e,m[460]=e,function(){var e=0,t=0;f(+(t=m[460])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+A(+t),m[460]=t,f(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[922]=8)}(),+m[460]},Mathpack_Tan:function(e){return e=+e,m[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=m[460])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),m[460]=t,r=4,f(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[922]=r)}(),+m[460]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,m[460]=e,he(),+m[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,i=0,a=0,s=0;m[460]=e;e:{if(f(+e),r=0|u(1),u(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;o[922]=1}m[460]=t;t:{if(f(+t),r=0|u(1),u(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;o[922]=1}return q(4),0}return le((0|n)<1?-1:1),ne(m[370]),oe(m[372]),m[460]}e:if((0|r)<=-1){f(+t),r=0|u(1),u(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else o[922]=1;i=m[370];break e}f(+(i=m[370])),a=-2147483648^(r=0|u(1)),c(0,0|(n=0|u(0))),c(1,0|a),s=+d(),i=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:i}else i=m[375];return Ne(t,e),he(),Z(i),m[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,a,s=0,c=0;return f(+(e=+e)),r=0|u(1),a=0|u(0),2146435072==(2146435072&r)?(o[922]=1,-1):(m[460]=e,s=3104,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3104,(0|n)>0||(c>>>0>=65536&&(o[921]=-2147483648^c),s=3104,!a&-2147483648==(0|r)||(i[1552]=45,s=3106))):(o[922]=1,s=3104)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var a;D=a=D-16|0,e=0|Oe[o[o[e>>2]+8>>2]](e),o[a+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;i[t>>1]=0}else ye(m[460],a+8|0,t,15),t=function(e,t,r,n,a,s){var u,c,d,f=0,p=0,m=0,g=0,v=0;D=c=D-16|0,u=(t<<1)+e|0,d=c+12|0;t:{r:{n:{i:if(!(m=(0|r)<5&(p=a?n:1)+3>>>0<8)){o:if(!((0|p)>(0|r))){if((0|(n=r+p|0))>=3){if((0|r)<5|(0|p)>-4)break i;if((n+-2|0)<(0|a))break o;break i}if((0|r)<5)break i}if(g=1,n=1,(0|r)<7)break n;n=r-(p+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,p))&&(n=r-((0|p)<(0|r)?(0|p)<1?2-p|0:1:0)|0)}n:{if((0|n)<(0|a)){f=1,a=0;i:if(!((0|t)<1)){o:{a:{if(!n){if(l[e>>1]>52)break a;break i}if((0|n)<1|(0|n)>=(0|t))break i;if(l[(n<<1)+e>>1]<=52)break o;for(;;){if(v=l[(f=((a=n+-1|0)<<1)+e|0)>>1]+1|0,i[f>>1]=v,58!=(65535&v))break o;if(n=a,!a)break}}i[e>>1]=49,a=1,f=p+1|0;break i}for(;(0|(a=n))>=2&&48==l[((n=a+-1|0)<<1)+e>>1];);f=p}if((-1^m)&(0|f)>(0|r)|g)break n;break r}if(f=p,!g)break r}if(o[d>>2]=32768,r=e+2|0,(0|a)<2||(n=r+(a<<1)|0)>>>0>=u>>>0?n=r:(a=a+-1|0,o[d>>2]=32768|a,e=e+4|0,(t<<1)-4>>1>>>0<a>>>0&&b(),x(e,r,a<<1),i[r>>1]=s),n>>>0<u>>>0&&(i[n>>1]=69,n=n+2|0),n>>>0>=u>>>0?a=n:(a=n+2|0,(0|f)<=0?(i[n>>1]=45,f=1-f|0):(i[n>>1]=43,f=f+-1|0)),(0|f)<100|a>>>0>=u>>>0||(e=(f>>>0)/100|0,i[a>>1]=e+48,f=f-h(e,100)|0,a=a+2|0),a>>>0<u>>>0&&(i[a>>1]=48+((0|f)/10|0),a=a+2|0),a>>>0>=u>>>0)break t;i[a>>1]=48+((0|f)%10|0),a=a+2|0;break t}if((0|a)<0|(0|a)>(0|f))if(r=a-f|0,o[d>>2]=r,(0|f)>=1){if(!((r=(n=((m=(r=(p=(0|f)>(0|t)?t:f)<<1)+e|0)+(a<<1)|0)-r|0)-2|0)>>>0<e>>>0|n>>>0>=u>>>0))for(;i[n>>1]=l[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=m>>>0;);(0|f)<(0|t)&&(i[m>>1]=s),a=m+(((0|(e=u-m>>1))>(0|(t=a-p|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(a<<1)|0)|0)>>>0>=u>>>0||(a=((a<<1)+e|0)-2|0)>>>0<e>>>0))for(;i[n>>1]=l[a>>1],n=n+-2|0,(a=a+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(i[e>>1]=48,e=e+2|0),e>>>0<u>>>0&&(i[e>>1]=s,e=e+2|0),n=u-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(a=0;i[(a<<1)+e>>1]=48,(0|t)!=(0|(a=a+1|0)););a=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-a|0)for(t=(a<<1)+e|0,a=0;i[t+(a<<1)>>1]=48,(0|r)!=(0|(a=a+1|0)););a=(n<<1)+e|0}}return D=c+16|0,a}(t,r,n,i[a+8>>1],i[a+10>>1],e);return D=a+16|0,t}(o[256],c,3614-c>>1,(0|t)>0?t:0),o[920]=0,o[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return o[924]},Mathpack_FormatGetSign:function(){return o[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,a=0,s=0;return D=n=D+-64|0,f(+(e=+e)),a=0|u(1),u(0),2146435072!=(2146435072&a)?(o[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,ye(e,n+56|0,n+16|0,(a=t+r|0)>>>0<15?a:15),s=i[n+56>>1],a=i[n+58>>1],o[n+8>>2]=a,t=t+s|0,o[n+12>>2]=t,(0|(t=t+r|0))<(0|a)&&(X(n+16|0,n+12|0,n+8|0,t),a=o[n+8>>2]),a?((0|(r=r+(t=o[n+12>>2])|0))<(0|a)&&(o[n+8>>2]=r,a=r),(0|a)>-1||(o[922]=1)):(a=0,o[n+12>>2]=0,t=0),o[924]=t,o[925]=l[n+48>>1]>>>15^1,r=a,a>>>0>=256&&(b(),r=o[n+8>>2]),x(3104,n+16|0,a<<1)):(o[922]=1,r=-1),D=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,a=0,s=0,c=0;if(D=n=D+-64|0,f(+(e=+e)),s=0|u(1),u(0),2146435072!=(2146435072&s)){if(o[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,ye(e,n+56|0,n+16|0,15),c=i[n+56>>1],o[n+12>>2]=c,s=i[n+58>>1],o[n+8>>2]=s,(0|(a=t))>=2&&(a=(0|c)%(0|t)|0,a=((0|c)<1?t:a?0:t)+a|0),!((0|(a=r+a|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,a),a=(0|a)<(0|(s=o[n+8>>2]))?a:s;s=a,(0|a)>=1&&48==l[(n+16|0)+((a=s+-1|0)<<1)>>1];);o[n+8>>2]=s,(0|t)<2||(0|(a=o[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|a)%(0|t)|0)|0)+((0|a)<1?t:r?0:t)|0)>=(0|s)||(b(),s=o[n+8>>2]))}(0|s)<=-1&&(o[922]=1),o[924]=o[n+12>>2],o[925]=l[n+48>>1]>>>15^1,(a=s)>>>0>=256&&(b(),a=o[n+8>>2]),x(3104,n+16|0,s<<1)}else o[922]=1,a=-1;return D=n- -64|0,0|a},Mathpack_Pack:function(e,t,r){var a;return e|=0,t|=0,r|=0,D=a=D-48|0,n[a+39|0]=0,x(a+8|0,3104,(r=(0|r)<15?r:15)<<1),i[a+40>>1]=t+16384&32767|!e<<15,n[a+38|0]=r,o[a>>2]=0,o[a+4>>2]=0,Se(o[256],a,a+8|0)&&(o[922]=1),D=a+48|0,+m[a>>3]},_start:L,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,o[926]||(o[927]=t,o[926]=e)},stackSave:function(){return 0|D},stackAlloc:function(e){return D=e=D-(e|=0)&-16,0|e},stackRestore:function(e){D=e|=0},__growWasmMemory:function(e){return 0|b()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:i.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:i.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:i.Base_LocaleDecimalSeparator,Math_log10:i.Math_log10,Math_log:i.Math_log,Math_sqrt:i.Math_sqrt,Math_sin:i.Math_sin,Math_cos:i.Math_cos,Math_tan:i.Math_tan,Math_atan:i.Math_atan,Math_exp:i.Math_exp,proc_exit:o.proc_exit},m),v=g.memory;t.memory=v;var S=g.Base_StrBuf;t.Base_StrBuf=S;var y=g.Base_StrBufSize;t.Base_StrBufSize=y;var C=g.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=C;var R=g.Dtr_FromNum;t.Dtr_FromNum=R;var b=g.Dtr_Yr;t.Dtr_Yr=b;var N=g.Dtr_Mon;t.Dtr_Mon=N;var T=g.Dtr_DOM;t.Dtr_DOM=T;var P=g.Dtr_Hour;t.Dtr_Hour=P;var E=g.Dtr_Min;t.Dtr_Min=E;var k=g.Dtr_Sec;t.Dtr_Sec=k;var O=g.Dtr_Wdy;t.Dtr_Wdy=O;var A=g.Dtr_FracSec;t.Dtr_FracSec=A;var I=g.Dtr_Rounding;t.Dtr_Rounding=I;var _=g.Dtr_Write;t.Dtr_Write=_;var F=g.Dtr_ToNum;t.Dtr_ToNum=F;var M=g.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=M;var D=g.Dtr_Days;t.Dtr_Days=D;var w=g.Dtr_ToDays;t.Dtr_ToDays=w;var L=g.Dtr_ToTime;t.Dtr_ToTime=L;var x=g.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var B=g.Mathpack_Zero;t.Mathpack_Zero=B;var U=g.Mathpack_One;t.Mathpack_One=U;var G=g.Mathpack_Pi;t.Mathpack_Pi=G;var K=g.Mathpack_Div;t.Mathpack_Div=K;var V=g.Mathpack_Mul;t.Mathpack_Mul=V;var j=g.Mathpack_Sub;t.Mathpack_Sub=j;var W=g.Mathpack_Add;t.Mathpack_Add=W;var H=g.Mathpack_Power;t.Mathpack_Power=H;var Q=g.Mathpack_Cond;t.Mathpack_Cond=Q;var q=g.Mathpack_Cond2;t.Mathpack_Cond2=q;var z=g.Mathpack_TakeMathError;t.Mathpack_TakeMathError=z;var Y=g.Mathpack_Trunc;t.Mathpack_Trunc=Y;var J=g.Mathpack_Ceil;t.Mathpack_Ceil=J;var X=g.Mathpack_Floor;t.Mathpack_Floor=X;var $=g.Mathpack_Abs;t.Mathpack_Abs=$;var Z=g.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=g.Mathpack_Float;t.Mathpack_Float=ee;var te=g.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=g.Mathpack_Fix;t.Mathpack_Fix=re;var ne=g.Mathpack_LFix;t.Mathpack_LFix=ne;var ie=g.Mathpack_SFix;t.Mathpack_SFix=ie;var oe=g.Mathpack_Round;t.Mathpack_Round=oe;var ae=g.Mathpack_RoundUp;t.Mathpack_RoundUp=ae;var se=g.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var le=g.Mathpack_TenTo;t.Mathpack_TenTo=le;var ue=g.Mathpack_Compare;t.Mathpack_Compare=ue;var ce=g.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=g.Mathpack_Equal;t.Mathpack_Equal=de;var fe=g.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var pe=g.Mathpack_Sqrt;t.Mathpack_Sqrt=pe;var me=g.Mathpack_Exp;t.Mathpack_Exp=me;var he=g.Mathpack_Ln;t.Mathpack_Ln=he;var ge=g.Mathpack_Log;t.Mathpack_Log=ge;var ve=g.Mathpack_Sin;t.Mathpack_Sin=ve;var Se=g.Mathpack_Cos;t.Mathpack_Cos=Se;var ye=g.Mathpack_Tan;t.Mathpack_Tan=ye;var Ce=g.Mathpack_Asin;t.Mathpack_Asin=Ce;var Re=g.Mathpack_Acos;t.Mathpack_Acos=Re;var be=g.Mathpack_Atan;t.Mathpack_Atan=be;var Ne=g.Mathpack_Atan2;t.Mathpack_Atan2=Ne;var Te=g.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Te;var Pe=g.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Pe;var Ee=g.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Ee;var ke=g.Mathpack_FormatFixed;t.Mathpack_FormatFixed=ke;var Oe=g.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Oe;var Ae=g.Mathpack_Pack;t.Mathpack_Pack=Ae;var Ie=g._start;t._start=Ie;var _e=g.__errno_location;t.__errno_location=_e;var Fe=g.setThrew;t.setThrew=Fe;var Me=g.stackSave;t.stackSave=Me;var De=g.stackAlloc;t.stackAlloc=De;var we=g.stackRestore;t.stackRestore=we;var Le=g.__growWasmMemory;t.__growWasmMemory=Le},3231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0;var n=r(4700);const i=Math.sqrt;t.Math_sqrt=i;const o=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=o;const a=Math.log;t.Math_log=a;const s=Math.exp;t.Math_exp=s;const l=Math.sin;t.Math_sin=l;const u=Math.cos;t.Math_cos=u;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d},3263:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const r=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=r},1721:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},2472:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var n,i,o=r(2914),a=r(1039);function s(e,t,r,n,i,o,a,s,l){return{yr:e,mon:t,dom:r,hour:n,min:i,sec:o,wdy:a,fracSec:s,rounding:l}}function l(e){return s((0,o.Dtr_Yr)(e),(0,o.Dtr_Mon)(e),(0,o.Dtr_DOM)(e),(0,o.Dtr_Hour)(e),(0,o.Dtr_Min)(e),(0,o.Dtr_Sec)(e),(0,o.Dtr_Wdy)(e),(0,o.Dtr_FracSec)(e),(0,o.Dtr_Rounding)(e))}function u(e,t){(0,o.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,o.Dtr_DaysPerMonth)(e,t,r?1:0)},(i=t.Rounding||(t.Rounding={}))[i.RoundSec=0]="RoundSec",i[i.Round10ths=1]="Round10ths",i[i.Round100ths=2]="Round100ths",i[i.Round1000ths=3]="Round1000ths",t.dtr=s,t.fromNum=function(e,t,r,n){var i=t;return 0===(0,o.Dtr_FromNum)(e,i,0,r?1:0,n?1:0)&&l(0)},t.toNum=function(e,t,r){u(0,e);var n=(0,o.Dtr_ToNum)(0,t?1:0,r?1:0),i=(0,o.Mathpack_TakeMathError)();return i===a.MathErrorNum.None?n:(0,a.mathError)(i)},t.toNumWithDuration=function(e,t,r,n,i){u(0,e);var s=n,l=(0,o.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,s,i),c=(0,o.Mathpack_TakeMathError)();return c===a.MathErrorNum.None?l:(0,a.mathError)(c)},t.toDays=function(e,t,r){return u(0,e),0===(0,o.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,o.Dtr_Days)()},(n=t.TimeDivision||(t.TimeDivision={}))[n.Hour=0]="Hour",n[n.Minute=1]="Minute",n[n.Second=2]="Second",t.toTime=function(e,t,r){var n=t,i=r,s=(0,o.Dtr_ToTime)(e,n,i);return(0,o.Mathpack_TakeMathError)()===a.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,n){return u(0,e),null!=t.standardDate&&u(1,t.standardDate),null!=t.daylightDate&&u(2,t.daylightDate),0!==(0,o.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,n?1:0)&&l(0)}},9799:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var n=r(1039);t.mathpack=n;var i=r(2472);t.dtr=i;var o=r(4700);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return o.isSupported}}),(0,r(2914)._start)()},1039:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var i,o=r(2914),a=r(4700),s=r(2914);function l(e,t){for(var r=new Uint16Array(s.memory.buffer),n="",i=0;i<t;i+=1)n+=String.fromCharCode(r[e+(i<<1)>>1]);return n}function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(i=t.MathErrorNum||(t.MathErrorNum={}));var c=((n={})[i.Over]=u(i.Over),n[i.Under]=u(i.Under),n[i.DivBy0]=u(i.DivBy0),n[i.Trans]=u(i.Trans),n);function d(e){var t;return null!==(t=c[e])&&void 0!==t?t:u(e)}function f(e){return function(t){var r=e(t),n=(0,o.Mathpack_TakeMathError)();return n===i.None?r:d(n)}}function p(e){return function(t,r){var n=e(t,r),a=(0,o.Mathpack_TakeMathError)();return a===i.None?n:d(a)}}t.mathError=d,t.zero=o.Mathpack_Zero,t.one=o.Mathpack_One,t.pi=o.Mathpack_Pi,t.exp32=o.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,o.Mathpack_Equal)(e,t)},t.trunc=o.Mathpack_Trunc,t.ceil=f(o.Mathpack_Ceil),t.floor=f(o.Mathpack_Floor),t.abs=o.Mathpack_Abs,t.neg=o.Mathpack_Neg,t.float=function(e){return e<0?(0,o.Mathpack_SFloat)(e):(0,o.Mathpack_Float)(e)},t.fix=function(e){return(0,o.Mathpack_Fix)(e)>>>0},t.lfix=o.Mathpack_LFix,t.sfix=f(o.Mathpack_SFix),t.round=p(o.Mathpack_Round),t.roundUp=p(o.Mathpack_RoundUp),t.roundDown=p(o.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return d(i.Over);if(!isFinite(e))return d(i.Over);var t=(0,o.Mathpack_TenTo)(e),r=(0,o.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.compare=o.Mathpack_Compare,t.div=p(o.Mathpack_Div),t.mul=p(o.Mathpack_Mul),t.sub=p(o.Mathpack_Sub),t.add=p(o.Mathpack_Add),t.power=p(o.Mathpack_Power),t.cond=function(e){var t=(0,o.Mathpack_Cond)(e),r=(0,o.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.cond2=o.Mathpack_Cond2,t.viewRound=f(o.Mathpack_ViewRound),t.sqrt=f(o.Mathpack_Sqrt),t.exp=f(o.Mathpack_Exp),t.ln=f(o.Mathpack_Ln),t.log=f(o.Mathpack_Log),t.sin=f(o.Mathpack_Sin),t.cos=f(o.Mathpack_Cos),t.tan=f(o.Mathpack_Tan),t.asin=f(o.Mathpack_Asin),t.acos=f(o.Mathpack_Acos),t.atan=f(o.Mathpack_Atan),t.atan2=p(o.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{(0,a.setLocale)(e);var n=(0,o.Mathpack_FormatGeneral)(t,r);return n<0?d((0,o.Mathpack_TakeMathError)()):l((0,o.Base_StrBuf)(),n)}finally{(0,a.setLocale)(void 0)}},t.formatFixed=function(e,t,r){var n=(0,o.Mathpack_FormatFixed)(e,t,r);if(n<0)return(0,o.Mathpack_TakeMathError)();var i=l((0,o.Base_StrBuf)(),n),a=(0,o.Mathpack_FormatGetExponent)();return{sign:0!==(0,o.Mathpack_FormatGetSign)(),mantissa:i,exponent:a}},t.formatScientific=function(e,t,r){var n=(0,o.Mathpack_FormatScientific)(e,t,r);if(n<0)return(0,o.Mathpack_TakeMathError)();var i=l((0,o.Base_StrBuf)(),n),a=(0,o.Mathpack_FormatGetExponent)();return{sign:0!==(0,o.Mathpack_FormatGetSign)(),mantissa:i,exponent:a}},t.pack=function(e,t,r,n){try{(0,a.setLocale)(e);var l=(0,a.fastMin)(n.length,(0,o.Base_StrBufSize)());!function(e,t){for(var r=new Uint16Array(s.memory.buffer),n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,o.Base_StrBuf)(),n.substring(0,l));var u=(0,o.Mathpack_Pack)(!!t,r,l),c=(0,o.Mathpack_TakeMathError)();return c!==i.None?d(c):isNaN(u)?d(i.Over):u}finally{(0,a.setLocale)(void 0)}}},4700:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var r=void 0;t.setLocale=function(e){r=e},t.Base_LocaleIsNumeral=function(e){return r.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return r.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=r.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},7857:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2825:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=function(e){r=e},t.isChangeGateEnabled=function(e){return!r||r.isChangeGateEnabled(e)}},1880:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(655);n.__exportStar(r(2825),t),n.__exportStar(r(7857),t)},7145:e=>{var t=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},7933:(e,t,r)=>{"use strict";e.exports=r(6344)()?globalThis:r(7145)},6344:e=>{"use strict";e.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},4011:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adHocPostFilter=t.adHocValidAggregation=t.adHocValidRangeOps=t.adHocPostRepair=t.adHocFixParens=t.adHocPreRepair=t.deleteExtraArgs=t.refactorLiftParenExpr=t.deleteExtraOpeningParens=t.deleteExtraClosingParens=t.trimLeadingOps=t.trimTrailingOps=t.closeOffBracket=t.closeOffQuotes=t.changeSemiColonToComma=void 0;const n=r(1583),i=r(7577),o=r(3546),a=r(5947),s=r(4719);function l(e){return e.map(e=>e.chars.length>0&&Array.from(e.chars).every(e=>";"===e)?",":e.chars).join("")}function u(e,t,r,n){const i=[];let o;for(const a of e)if(t(a.chars)){if(void 0!==o){const e=r(o);i.push({chars:e}),o=void 0}if(n(a.chars)){const e=r(a.chars);i.push({chars:e});continue}o=a.chars}else if(null!=o)if(d(a.chars)){const e=r(a.chars,o);i.push({chars:e}),o=void 0}else o+=a.chars;else i.push(a);return void 0!==o&&i.push({chars:r(o)}),i.map(e=>e.chars).join("")}function c(e){return'"'==e[0]&&'"'!=e.slice(-1)}function d(e){return["]",")","(","[","&"].some(t=>e.includes(t))}function f(e,t){const r=function(e){const t=new Set(["]",")","(","[","&"]);return Array.from(e).findIndex(e=>t.has(e))}(e);return r>-1?(null!=t?t:"")+e.slice(0,r).trimEnd()+'"'+e.slice(r):(null!=t?t:"")+e.trimEnd()+'"'}function p(e){return u(e,c,f,d)}function m(e){return"["===e.slice(0,1)}function h(e,t){const r=function(e){const t=new Set(["]","(",")"]);return Array.from(e).findIndex(e=>t.has(e))}(e);return r>-1?"]"===e.slice(r,r+1)?(null!=t?t:"")+e:(null!=t?t:"")+e.slice(0,r)+"]"+e.slice(r):(null!=t?t:"")+e+"]"}function g(e){return["]","(",")"].some(t=>e.includes(t))}function v(e){return u(e,m,h,g)}function S(){return new Set(["+","*","/",".","=","\t"," ","<",">"])}function y(e){const t=S(),r=e.map(e=>e.chars).join("");let n=r.length-1;for(;n>=0&&t.has(r.charAt(n));)n-=1;return n<0?r:r.slice(0,n+1)}function C(e){const t=S(),r=e.map(e=>e.chars).join("");let n=0;const i=r.length;for(;n<i&&t.has(r.charAt(n));)n+=1;return"="+r.slice(n,i)}function R(e,t,r){let n=0;const i=[];for(const o of e)o.chars===t||o.chars===r?o.chars!==t?o.chars===r&&n>0&&(n-=1,i.push(o)):(n+=1,i.push(o)):i.push(o);return i}function b(e){return R(e,"(",")").map(e=>e.chars).join("")}function N(e){const t=R(e.slice().reverse(),")","(");return t.reverse(),t.map(e=>e.chars).join("")}function T(e){const t=new s.ExcelChecker,r=t.parse(e);if(!(0,n.isSuccess)(r))return e;const i=r.value;let a=i.node;for(;a.kind===o.NodeKind.Paren;)a=a.node;const l=function e(t){switch(t.kind){case o.NodeKind.Array:return t;case o.NodeKind.App:{const r=t.args.map(t=>e(t));if(t.head.kind===o.NodeKind.WSF){const e=[];for(const t of r)t.kind===o.NodeKind.Paren?e.push(t.node):e.push(t);return Object.assign(Object.assign({},t),{args:e})}return Object.assign(Object.assign({},t),{args:r})}case o.NodeKind.Paren:const r=e(t.node);return function(e){return!!new Set(["Literal","Name","CellRef","FieldRef","StructRef","Paren"]).has(e.kind)||e.kind==o.NodeKind.App&&e.head.kind==o.NodeKind.WSF}(r)?r:Object.assign(Object.assign({},t),{node:r});default:return t}}(a),u=Object.assign(Object.assign({},i),{node:l}),c=t.printFormula(u);return void 0!==c?c:e}function P(e){switch(e.kind){case o.NodeKind.App:{let t=e.args;if(e.head.kind===o.NodeKind.WSF){const r=(0,a.getWorksheetFuncType)(e.head.id),n=t.length;if(n>r.maxArgs){const e=n-r.maxArgs;t=function(e,t){return e.slice(0,-t)}(t.slice(),e)}}const r=t.map(P);return Object.assign(Object.assign({},e),{args:r})}case o.NodeKind.Paren:{const t=P(e.node);return Object.assign(Object.assign({},e),{node:t})}default:return e}}function E(e){const t=new s.ExcelChecker,r=t.parse(e);if(!(0,n.isSuccess)(r))return e;const i=r.value,o=P(i.node),a=Object.assign(Object.assign({},i),{node:o}),l=t.printFormula(a);return void 0!==l?l:e}function k(e){return e.kind==i.TokenKind.CellRef&&!function(e){var t="0".charCodeAt(0),r="9".charCodeAt(0);const n=e.charCodeAt(0);return n>=t&&n<=r}(e.chars)}function O(e,t){return!(e<1)&&k(t[e-1])}function A(e,t){const r=t.length;if(e>=r-1)return!1;if(k(t[e+1]))return!0;const n=t.slice(e).findIndex(e=>"!"==e.chars);if(n<0)return!1;if(!t.slice(e+1,n).every(e=>e.kind==i.TokenKind.Ident))return!1;const o=e+n+1;return!(o>r-1)&&k(t[o])}function I(e){const t=e.map((e,t)=>t).filter(t=>":"==e[t].chars);if(0==t.length)return!0;for(const r of t)if(!O(r,e)||!A(r,e))return!1;return!0}t.changeSemiColonToComma=l,t.closeOffQuotes=p,t.closeOffBracket=v,t.trimTrailingOps=y,t.trimLeadingOps=C,t.deleteExtraClosingParens=b,t.deleteExtraOpeningParens=N,t.refactorLiftParenExpr=T,t.deleteExtraArgs=E,t.adHocPreRepair=function(e,t=1){let r=[l,p,C,y,v],n=e,i=!1,o=0;for(;o<t;){for(const t of r){const r=n.map(e=>e.chars).join("");let o=r;try{o=t(n)}catch(e){}o!=r&&(n=(0,s.lexFormula)(o),i=!0)}if(!i)break;o+=1}return n.map(e=>e.chars).join("")},t.adHocFixParens=function(e){let t=[b,N],r=[];const n=e.map(e=>e.chars).join("");for(const i of t){let t=n;try{t=i(e),t!==n&&r.push(t)}catch(e){}}return r},t.adHocPostRepair=function(e){let t=[E,T],r=e.map(e=>e.chars).join("");for(const n of t)try{r=n(r)}catch(e){continue}return r},t.adHocValidRangeOps=I;const _=new Set([a.WorksheetFuncId.SUM,a.WorksheetFuncId.PRODUCT,a.WorksheetFuncId.AVERAGE,a.WorksheetFuncId.COUNTBLANK,a.WorksheetFuncId.MAX,a.WorksheetFuncId.MIN,a.WorksheetFuncId.AND,a.WorksheetFuncId.COUNTA,a.WorksheetFuncId.OR,a.WorksheetFuncId.CONCAT,a.WorksheetFuncId.AVERAGEIF,a.WorksheetFuncId.AVERAGEIFS,a.WorksheetFuncId.COUNT,a.WorksheetFuncId.COUNTIF,a.WorksheetFuncId.COUNTIFS,a.WorksheetFuncId.MEDIAN,a.WorksheetFuncId.SUMSQ,a.WorksheetFuncId.SUMIF,a.WorksheetFuncId.SUMIFS,a.WorksheetFuncId.LARGE,a.WorksheetFuncId.SMALL,a.WorksheetFuncId.RANK,a.WorksheetFuncId.RANK_EQ,a.WorksheetFuncId.RANK_AVG,a.WorksheetFuncId.PERCENTILE,a.WorksheetFuncId.PERCENTILE_INC,a.WorksheetFuncId.PERCENTILE_EXC,a.WorksheetFuncId.QUARTILE,a.WorksheetFuncId.QUARTILE_INC,a.WorksheetFuncId.QUARTILE_EXC,a.WorksheetFuncId.TRIMMEAN,a.WorksheetFuncId.AVERAGEA,a.WorksheetFuncId.MAXA,a.WorksheetFuncId.MINA,a.WorksheetFuncId.MAXIFS,a.WorksheetFuncId.MINIFS,a.WorksheetFuncId.XOR,a.WorksheetFuncId.AGGREGATE,a.WorksheetFuncId.SUBTOTAL,a.WorksheetFuncId.VAR,a.WorksheetFuncId.VAR_S,a.WorksheetFuncId.VARP,a.WorksheetFuncId.VAR_P,a.WorksheetFuncId.STDEV,a.WorksheetFuncId.STDEV_S,a.WorksheetFuncId.STDEVP,a.WorksheetFuncId.STDEV_P,a.WorksheetFuncId.VARA,a.WorksheetFuncId.VARPA,a.WorksheetFuncId.STDEVA,a.WorksheetFuncId.STDEVPA,a.WorksheetFuncId.AVEDEV,a.WorksheetFuncId.DEVSQ,a.WorksheetFuncId.MODE,a.WorksheetFuncId.MODE_SNGL,a.WorksheetFuncId.MODE_MULT,a.WorksheetFuncId.TEXTJOIN]);function F(e){switch(e.kind){case o.NodeKind.App:{const t=e.args;if(e.head.kind===o.NodeKind.WSF){const r=_.has(e.head.id),n=t.length;if(r&&1==n){const e=t[0];if(e.kind==o.NodeKind.Literal)return!0;if(e.kind==o.NodeKind.CellRef&&e.ref.kind==o.CellRefKind.Single)return!0}}return t.some(F)}case o.NodeKind.Paren:return F(e.node);default:return!1}}function M(e){const t=(new s.ExcelChecker).parse(e);return!!(0,n.isSuccess)(t)&&!F(t.value.node)}t.adHocValidAggregation=M,t.adHocPostFilter=function(e){const t=[];for(const r of e)I((0,s.lexFormula)(r))&&M(r)&&t.push(r);return t}},4719:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(7837),t),i(r(4011),t)},7837:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelChecker=t.prettyPrintFormula=t.lexFormula=void 0;const n=r(1866),i=r(1677),o=r(8556),a=r(342),s=r(1583),l=r(4143),u=r(9213),c=r(4333),d=r(446),f=r(931),p=r(9585),m=r(3935),h=r(1109),g=r(9937);function v(e,t,r){const n=(0,m.createSimplePrintGlobals)(e),i=(0,g.lexicalSourceCell)(r),o=(0,m.printLocalsGrid)(i,i.range,e),a=(0,h.createPrinter)(n),s=Object.assign(Object.assign({},t),{spans:{}});return a.printFormula(o,s)}t.lexFormula=function(e){const t=(0,o.getEnglishLocaleInfo)(),r=d.xlMathpack,n=c.RefStyle.A1,i=(0,p.createSingleRange)(3,2);return(0,f.tokenizeFormula)(t,r,n,i.range,e,0,{})},t.prettyPrintFormula=v,t.ExcelChecker=class{constructor(e){void 0===e&&(e=(0,o.calcConfig)((0,o.getEnglishLocaleInfo)()));const t=(0,n.createParseGlobals)(e),r=(0,u.createAnalyzeGlobals)(e);this.config=e,this.parser=(0,i.createParser)(t),this.analyzer=(0,l.createAnalyzer)(r)}getDefaultActiveCell(){const e=(0,a.documentLoc)(void 0,"Book1"),t=(0,a.sheetIndex)(e,-1);return(0,a.sheetGridCell)(t,(0,a.gridCell)(0,0))}printFormula(e,t){void 0===t&&(t=this.getDefaultActiveCell());const r=v(this.config,e,t);return(0,s.isSuccess)(r)?r.value:void 0}parse(e,t){void 0===t&&(t=this.getDefaultActiveCell());const r=t.range;return this.parser.parseFormula((0,n.parseLocals)(a.LexicalKind.Cell,r),e)}validate(e,t){void 0===t&&(t=this.getDefaultActiveCell());const r=this.parse(e,t);if(!(0,s.isSuccess)(r))return!1;const n=this.analyzer.checkFormula((0,u.analyzeLocalsGrid)(a.LexicalKind.Cell,(0,a.sheetGridCell)(t.sheet,t.range)),r.value);return!!(0,s.isSuccess)(n)&&n.value.isWellFormed}}},655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>o,__asyncDelegator:()=>R,__asyncGenerator:()=>C,__asyncValues:()=>b,__await:()=>y,__awaiter:()=>c,__classPrivateFieldGet:()=>k,__classPrivateFieldIn:()=>A,__classPrivateFieldSet:()=>O,__createBinding:()=>f,__decorate:()=>s,__exportStar:()=>p,__extends:()=>i,__generator:()=>d,__importDefault:()=>E,__importStar:()=>P,__makeTemplateObject:()=>N,__metadata:()=>u,__param:()=>l,__read:()=>h,__rest:()=>a,__spread:()=>g,__spreadArray:()=>S,__spreadArrays:()=>v,__values:()=>m});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function v(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function S(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function C(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof y?Promise.resolve(r.value.v).then(l,u):c(o[0][2],r)}catch(e){c(o[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function R(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function N(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return T(t,e),t}function E(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function O(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}}},r={};function n(t){var i=r[t];if(void 0!==i)return i.exports;var o=r[t]={exports:{}};return e[t].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=n(4719);t.excelHelper=i})()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var n=r(4),i=r(91),o=r(90);function a(e,t){return function(r,n,i,o){if(e(r,n,i,o),!i)throw new Error("".concat(t," ").concat(r," ").concat(n," ").concat(o))}}function s(e){return{shipAssertTag:a(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:a(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function l(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var u=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var r=this.callBuffer;this.callBuffer=[];var i="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(r.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i);for(var o=0,a=r;o<a.length;o++){var s=a[o];(e=t.ulsLogger.noThrowLogger)[s.method].apply(e,s.args)}}},e}(),c=function(){function e(){this.logger=new u,this.ULS=s(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:l(e.shipAssertTag.bind(e)),assertTag:l(e.assertTag.bind(e)),traceTag:l(e.traceTag.bind(e)),debugTraceTag:l(e.debugTraceTag.bind(e)),dnmTraceTag:l(e.dnmTraceTag.bind(e))}}(e),t instanceof u&&t.invokeBufferedCalls()},e}();function d(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new c,t.assertNever=function(e,r){var i=(0,o.anonymize)(r),a="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(i);return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,a)},t.assertFalse=d,t.assertTrue=function(e,t){t||d("".concat(e,": expected condition to be true"))},t.assertInteger=function(e,t){(0,i.isInteger)(t)||d("".concat(e,": expected integer; given ").concat((0,o.anonymize)(t)))},t.assertNatural=function(e,t){(!(0,i.isInteger)(t)||t<0)&&d("".concat(e,": expected natural number; given ").concat((0,o.anonymize)(t)))},t.assertPositiveInteger=function(e,t){(!(0,i.isInteger)(t)||t<=0)&&d("".concat(e,": expected positive integer; given ").concat((0,o.anonymize)(t)))},t.assertIndex=function(e,t,r){(!(0,i.isInteger)(t)||t<0||t>=r)&&d("".concat(e,": expected natural number less than ").concat((0,o.anonymize)(r),"; given ").concat((0,o.anonymize)(t)))},t.assertPositiveLength=function(e,t,r){(!(0,i.isInteger)(t)||t<=0||t>r)&&d("".concat(e,": expected positive integer at most ").concat((0,o.anonymize)(r),"; given ").concat((0,o.anonymize)(t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;var n=r(2),i=n.assertions.assertNatural,o=n.assertions.assertFalse,a=n.assertions.assertIndex;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(t.OperKind||(t.OperKind={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(t.SignatureType||(t.SignatureType={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(t.SpecialPrecs||(t.SpecialPrecs={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef",e[e.HiddenFromUI=32]="HiddenFromUI"}(t.FunctionFlags||(t.FunctionFlags={})),t.functionType=function(e,t,r,n,s,l,u,c){if(i("calc.lang.functionType",t),a("calc.lang.functionType",e,t+1),0===n.length?0!==s.length:s.length>=n.length){var d=JSON.stringify(s);o("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(d))}if(0===n.length&&r.length+s.length<t){d=JSON.stringify(r);o("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(t,"; given ").concat(d))}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:s,returnType:l,staticPrecs:u,flags:c}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;var n,i=r(0),o=r(50),a=r(22),s=r(31),l=r(19),u=r(33);!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(n=t.ListSep||(t.ListSep={})),t.makeState=function(e,t,r,i,o){var a;return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:i,origin:o,delim:{delimId:void 0,listSep:n.Union,stack:(a={},a[s.DelimId.Paren]=!1,a[s.DelimId.Brace]=!1,a[s.DelimId.Bracket]=!1,a)},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given ".concat((0,o.anonymize)(t));(0,a.assertFalse)(n)}return r},t.getSpan=function(e,t){var r=e.spans[t];return(0,a.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r};var c=[];function d(e,t){var r="string"==typeof t?c:t.filter(u.isCommentToken);return["string"==typeof t?t:t.map((function(e){return e.chars})).join(""),r.length>0?r.map((function(t){return function(e,t){var r=f(e,t.start,t.start+t.chars.length,"","");return t.kind===s.TokenKind.SingleLineComment?(0,l.singleLineComment)(t.chars,r):(0,l.multiLineComment)(t.chars,t.isClosed,r)}(e,t)})):void 0]}function f(e,t,r,n,i){var o=e.label;e.label+=1;var a=d(e,n),s=a[0],u=a[1],c=d(e,i),f=c[0],p=c[1];return e.spans[o]=(0,l.formulaSpan)(t,r,s,f,u,p),o}function p(e,t,r){return function(n,i,o,a,s){var l=e(o);return r(n,i,o,(function(e,r){return t(o,l),a(e,r)}),(function(){return t(o,l),s}))}}t.addWhitespace=d,t.addSpan=f,t.withDelim=function(e,t){var r=e.delimId,n=e.listSep;return p((function(e){var t,o=e.delim;return e.delim={delimId:r,listSep:n,stack:i.__assign(i.__assign({},o.stack),(t={},t[r]=!0,t))},o}),(function(e,t){return e.delim=t}),t)},t.cellRefMustBeCellRefNode=function(e){return p((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(2);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(2);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(1);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(1);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;var n=r(11),i=r(13),o=function(){function e(e,t){void 0===t&&(t=n.valueErrorOper),this._fields=e,this._fallback=t,this.kind=i.OperKind.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}();t.RecordOper=o;var a=function(){function e(e,t,r,n,o,a,s,l,u,c){this.minArity=e,this.maxArity=t,this.lambdaNodeLabel=r,this.paramNodeLabels=n,this.paramNameLabels=o,this.locals=a,this.stackEnv=s,this.stackMap=l,this.defIdxs=u,this.defsAndBody=c,this.kind=i.OperKind.Rich}return e.prototype.getFallback=function(){return n.valueErrorOper},e.prototype.getField=function(e){},e}();t.LambdaOper=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numMod=t.validDateRange=t.chkNumMultiOper=t.chkDateOper=t.atpm1904to1900Days=t.chkNumOper=t.assertString=t.assertNumber=t.wrap2=t.wrap1=void 0;var n=r(11),i=r(20),o=r(10),a=r(9),s=r(35),l=r(13),u=r(16);t.wrap1=function(e){return function(t,r){return e(t)(r[0])}},t.wrap2=function(e){return function(t,r){return e(t)(r[0],r[1])}};t.assertNumber=function(e){return(0,a.isNumberOper)(e)?e:(0,o.assertFalse)("calc.funcs.assertNumber")};function c(e,t){var r=(0,i.refToVal)(e,t,!1),s=(0,a.isRichOper)(r)?r.getFallback():r;switch(s.kind){case l.OperKind.Number:return s;case l.OperKind.Boolean:return n.valueErrorOper;case l.OperKind.String:var u=e.coerceOper(s,l.OperKind.Number);return(0,a.isNumberOper)(u)?u:n.valueErrorOper;case l.OperKind.Error:return s;case l.OperKind.Array:return n.valueErrorOper;case l.OperKind.Missing:return n.naErrorOper;case l.OperKind.Blank:return e.mathpack.zero;default:return(0,o.assertNever)("calc.funcs.chkNumOper",s)}}t.assertString=function(e){return(0,a.isStringOper)(e)?e:(0,o.assertFalse)("calc.funcs.assertString")},t.chkNumOper=c,t.atpm1904to1900Days=1462,t.chkDateOper=function(e,r){var i=c(e,r);if((0,a.isErrorOper)(i))return i;var o=e.mathpack;return o.cond(i)<0?n.numErrorOper:d(e,i=o.floor(i))?(e.config.date1904&&!(0,a.isStringOper)(r)&&(i=o.add(o.fromNumber(t.atpm1904to1900Days),i)),i):n.numErrorOper},t.chkNumMultiOper=function e(t,r){switch(r.kind){case l.OperKind.Number:return(0,u.success)(new s.StrictSparseArray2D(1,1,1,1,[[r]],n.blankOper));case l.OperKind.String:var o=t.coerceOper(r,l.OperKind.Number);return(0,a.isErrorOper)(o)?(0,u.failure)(n.valueErrorOper):(0,u.success)(new s.StrictSparseArray2D(1,1,1,1,[[o]],n.blankOper));case l.OperKind.Blank:return(0,u.success)(new s.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],n.blankOper));case l.OperKind.Missing:return(0,u.failure)(n.naErrorOper);case l.OperKind.Error:return(0,u.failure)(r);case l.OperKind.Range:return e(t,(0,i.refToVal)(t,r,!1));case l.OperKind.Array:return(0,u.success)(new s.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,n.blankOper));default:return(0,u.failure)(n.valueErrorOper)}};function d(e,t){var r,n,i=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),i>=r&&i<=n}t.validDateRange=d,t.numMod=function(e,t,r){var n=e.div(t,r);if((0,a.isErrorOper)(n))return n;var i=e.mul(e.trunc(n),r);if((0,a.isErrorOper)(i))return i;var o=e.sub(t,i);return!(0,a.isErrorOper)(o)&&e.cond(t)<0?e.abs(o):o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,i){return t.dnmTraceTag(e,r,n,i)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;var i,o=r(2),a=o.assertions.assertNatural,s=o.assertions.assertPositiveInteger,l=o.assertions.assertFalse,u=o.util.partialArray,c=r(47);function d(e){return{kind:c.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(t.PrecsBound||(t.PrecsBound={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL"}(i=t.ErrorType||(t.ErrorType={})),t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:c.OperKind.String,value:e}},t.errorOper=function(e){var t=f[e];return void 0!==t?t:d(e)},t.nullErrorOper=d(i.NULL),t.div0ErrorOper=d(i.DIV0),t.valueErrorOper=d(i.VALUE),t.refErrorOper=d(i.REF),t.nameErrorOper=d(i.NAME),t.numErrorOper=d(i.NUM),t.naErrorOper=d(i.NA),t.gettingDataErrorOper=d(i.GETTING_DATA),t.spillErrorOper=d(i.SPILL),t.connectErrorOper=d(i.CONNECT),t.blockedErrorOper=d(i.BLOCKED),t.unknownErrorOper=d(i.UNKNOWN),t.fieldErrorOper=d(i.FIELD),t.calcErrorOper=d(i.CALC),t.busyErrorOper=d(i.BUSY),t.externalErrorOper=d(i.EXTERNAL);var f=u(((n={})[i.NULL]=t.nullErrorOper,n[i.DIV0]=t.div0ErrorOper,n[i.VALUE]=t.valueErrorOper,n[i.REF]=t.refErrorOper,n[i.NAME]=t.nameErrorOper,n[i.NUM]=t.numErrorOper,n[i.NA]=t.naErrorOper,n[i.GETTING_DATA]=t.gettingDataErrorOper,n[i.SPILL]=t.spillErrorOper,n[i.CONNECT]=t.connectErrorOper,n[i.BLOCKED]=t.blockedErrorOper,n[i.UNKNOWN]=t.unknownErrorOper,n[i.FIELD]=t.fieldErrorOper,n[i.CALC]=t.calcErrorOper,n[i.BUSY]=t.busyErrorOper,n[i.EXTERNAL]=t.externalErrorOper,n));t.arrayOper=function(e,t,r){return a("calc.lang.arrayOper",e),a("calc.lang.arrayOper",t),r.length!==e?l("calc.lang.arrayOper: Inconsistent row number"):{kind:c.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return s("calc.lang.rangeSeqOper",t.length),{kind:c.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:c.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:c.OperKind.Missing},t.blankOper={kind:c.OperKind.Blank},t.trueOper={kind:c.OperKind.Boolean,value:!0},t.falseOper={kind:c.OperKind.Boolean,value:!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(2);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(2);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(2);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(2);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;var i,o=r(0),a=r(50),s=r(22),l=r(19),u=r(52),c=r(39),d=r(31),f=r(40),p=r(48),m=r(38),h=r(33),g=r(26),v=r(105);function S(e,t,r,n){return{kind:i.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function y(e){return e.kind!==d.TokenKind.Operator&&e.kind!==d.TokenKind.Sep&&e.kind!==d.TokenKind.End&&e.kind!==d.TokenKind.Spaces&&e.kind!==d.TokenKind.SingleLineComment&&e.kind!==d.TokenKind.MultiLineComment&&!(e.kind in i)}function C(e){return e.kind===d.TokenKind.Spaces||e.kind===d.TokenKind.SingleLineComment||e.kind===d.TokenKind.MultiLineComment}function R(e,t){return y(t=t.kind===i.MaybeWSFTerm?t.node:t)?(0,p.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(i=t.TermKind||(t.TermKind={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:i.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:i.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=S,t.structRefTerm=function(e,t,r){return{kind:i.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:i.MaybeWSFTerm,node:e,whole:t}};var b=(0,f.many)((0,f.take)((function(e,t){return C(t)?t:void 0}))),N=(0,f.many1)((0,f.take)((function(e,t){return C(t)?t:void 0}))),T=(0,f.peek)((function(e,t){return t})),P=function(e,t,r,n,i){var o=e[t];if(null==o){var l="calc.parse.pStart: internal error: expected term at ".concat(t," in ").concat((0,a.anonymize)(e));return(0,s.assertFalse)(l)}return n(R(r,o),t)};function E(e){return(0,f.apply)((0,f.tuple)(b,P,(0,f.take)(e),P,b),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4];return(0,l.operatorNode)(i,(0,p.addSpan)(e,n,o,r,a))}))}function k(e){return(0,f.apply)((0,f.tuple)(b,P,(0,f.take)(e),P),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,l.operatorNode)(i,(0,p.addSpan)(e,n,o,r,""))}))}function O(e){return(0,f.apply)((0,f.tuple)(P,(0,f.take)(e),P,b),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,l.operatorNode)(n,(0,p.addSpan)(e,r,i,"",o))}))}var A=E((function(e,t){return t.kind!==d.TokenKind.Operator||t.value!==u.OperatorId.Add&&t.value!==u.OperatorId.Sub?void 0:t.value})),I=O((function(e,t){if(t.kind===d.TokenKind.Operator){if(t.value===u.OperatorId.Add)return u.OperatorId.Pos;if(t.value===u.OperatorId.Sub)return u.OperatorId.Neg}})),_=O((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.At?t.value:void 0})),F=k((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.Pound?t.value:void 0})),M=(0,f.take)((function(e,t){return t.kind===i.StructRefTerm?t:void 0})),D=E((function(e,t){return t.kind!==d.TokenKind.Operator||t.value!==u.OperatorId.Mul&&t.value!==u.OperatorId.Div?void 0:t.value})),w=E((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.Pow?t.value:void 0})),L=k((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.Percent?t.value:void 0})),x=E((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.Concat?t.value:void 0})),B=E((function(e,t){return t.kind===d.TokenKind.Operator&&t.value>=u.OperatorId.Eq&&t.value<=u.OperatorId.Ge?t.value:void 0})),U=E((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.Range?t.value:void 0})),G=E((function(e,t){return t.kind===d.TokenKind.Operator&&t.value===u.OperatorId.Union?t.value:void 0})),K=(0,f.applyTake)((0,f.tuple)(N,T),(function(e,t){var r=t[0],n=t[1];if(!(n.kind===d.TokenKind.End||n.kind===d.TokenKind.Operator&&n.value!==u.OperatorId.At||n.kind===d.TokenKind.Sep&&(0,h.isDotSepToken)(n))){if(1!==r.length||r[0].kind!==d.TokenKind.Spaces)return r;var i=R(e,n),o=(0,p.addSpan)(e,i,i,r[0].chars,"");return(0,l.operatorNode)(u.OperatorId.Isect,o)}})),V=(0,f.take)((function(e,t){return t.kind===d.TokenKind.Sep&&(0,h.isDotSepToken)(t)?t:void 0})),j=(0,f.take)((function(e,t){return t.kind===i.ArgsTerm?t:void 0})),W=(0,f.take)((function(e,t){return t.kind===i.LambdaArgsTerm?t:void 0})),H=(0,f.take)((function(e,t){return t.kind===i.ArgsTerm||t.kind===i.FieldRefTerm?t:void 0})),Q=((n={})[u.WorksheetFuncId.LETREC]=v.FeatureName.CalcLetRecFunction,n[u.WorksheetFuncId.LAMBDA]=v.FeatureName.CalcLambdaFunction,n);function q(e,t){if(t.kind===i.MaybeWSFTerm&&void 0!==t.whole){var r=(0,m.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;(0,s.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==u.WorksheetFuncId._UDF);var n=Q[r];if(void 0!==n&&!(0,v.isFeatureEnabled)(n))return;return(0,l.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=q;var z=(0,f.take)((function(e,t){return q(e.localeInfo,t)})),Y=(0,f.take)((function(e,t){var r=q(e.localeInfo,t);return(null==r?void 0:r.id)===u.WorksheetFuncId.LAMBDA?r:void 0}));var J=(0,f.apply)((0,f.tuple)(Y,W),(function(e,t){for(var r,n=t[0],i=t[1],o=(0,p.getNodeSpan)(e,n).start,a=i.nodes,s=(n.id,[]),u=[],c=0;c<a.length;c+=1){var d=a[c];d.kind===l.NodeKind.Param?s.push((0,l.lambdaParam)((0,l.indexedArg)(d,c))):c===a.length-1?r=(0,l.indexedArg)(d,c):u.push((0,l.indexedArg)(d,c))}var f=(0,p.addSpan)(e,o,i.end,"","");return(0,l.lambdaNode)(n,s,r,u,i.isClosed,f)})),X=(0,f.apply)((0,f.tuple)(z,j),(function(e,t){var r,n,i=t[0],o=t[1],a=(0,p.getNodeSpan)(e,i).start,c=o.nodes;switch(i.id){case u.WorksheetFuncId.LET:case u.WorksheetFuncId.LETREC:i.id;for(var d=[],f=[],h=void 0,g=0;g<c.length;g+=1){var v=c[g];g!==c.length-1?!(g+1<c.length&&(0,m.isUnqualifiedNameNode)(v))||g+3<c.length&&(r=e.refStyle,n=c[g+2],!((0,m.isUnqualifiedNameNode)(n)||r===l.RefStyle.A1&&n.kind===l.NodeKind.CellRef&&void 0===n.qualifier&&n.ref.kind===l.CellRefKind.Single&&n.ref.col.kind===l.PosKind.Rel&&n.ref.row.kind===l.PosKind.Rel))&&(0,m.isUnqualifiedNameNode)(c[g+1])?f.push((0,l.indexedArg)(v,g)):(d.push((0,l.letVar)((0,l.indexedArg)(v,g),(0,l.indexedArg)(c[g+1],g+1))),g+=1):h=(0,l.indexedArg)(v,g)}var S=(0,p.addSpan)(e,a,o.end,"","");return(0,l.letNode)(i,d,h,f,o.isClosed,S);case u.WorksheetFuncId.LAMBDA:return(0,s.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}return te(e,i,c,o.isClosed,a,o.end)}));function $(e,t,r){return(0,f.apply)((0,f.tuple)((0,f.many)(e),t),(function(e,t){var n=t[0],i=t[1];return n.reduceRight(r(e),i)}))}function Z(e,t,r){return(0,f.apply)((0,f.tuple)(e,(0,f.many)(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function ee(e){return function(t,r){var n,i,o=r[0],a=r[1];if(i=o,Array.isArray(i)){var u=(0,p.getNodeSpan)(e,t);(0,s.assertTrue)("calc.parse.makeAppNodeInfix",0===u.post.length),n=(0,p.addWhitespace)(e,o),u.post=n[0],u.postComments=n[1];var c=(0,p.getNodeSpan)(e,a),d=(0,p.addSpan)(e,u.start,c.end,"","");return(0,l.badNode)(l.BadType.Sequence,[t,a],d)}var f=(0,p.getNodeSpan)(e,t).start,m=(0,p.getNodeSpan)(e,a).end,h=(0,p.addSpan)(e,f,m,"","");return(0,l.appNode)(o,[t,a],!0,h)}}function te(e,t,r,n,i,o){var a=(0,p.addSpan)(e,i,o,"","");return(0,l.appNode)(t,r,n,a)}function re(e){return function(t,r){var n=(0,p.getNodeSpan)(e,t).start;switch(r.kind){case i.ArgsTerm:return te(e,t,r.nodes,r.isClosed,n,r.end);case i.FieldRefTerm:var o=(0,p.addSpan)(e,n,r.end,"",""),a=(0,p.getNodeSpan)(e,r.rhs),s=a.start,u=a.end,d=a.pre;if((0,m.isNumberNode)(t)){var f=(0,p.addSpan)(e,s,s,"",""),h=(0,l.literalNode)(c.missingOper,!0,f),g=r.rhs.label,v=(0,p.addSpan)(e,s,u,"",""),S=(0,l.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,v);return(0,l.badNode)(l.BadType.FieldRef,[t,(0,l.fieldRefNode)(h,S,!1,g)],o)}var y=!r.rhs.isBracketed&&(0,m.shouldFieldRefBeBracketed)(t,r.rhs,d);return(0,l.fieldRefNode)(t,r.rhs,y,o);case i.StructRefTerm:o=(0,p.addSpan)(e,n,r.end,"","");return t.kind===l.NodeKind.Name||(0,m.isMissingNode)(t)?(0,l.structRefNode)(t.kind===l.NodeKind.Name?t:void 0,r.rhs,o):(0,l.badNode)(l.BadType.StructRef,[t,(0,l.structRefNode)(void 0,r.rhs,(0,p.addSpan)(e,r.start,r.end,"",""))],o);case l.NodeKind.Operator:return te(e,r,[t],!0,n,(0,p.getNodeSpan)(e,r).end)}}}function ne(e){var t=!0;return function(r,n){var i=(0,p.getNodeSpan)(e,n).start,o=(0,p.getNodeSpan)(e,r).end,a=(0,p.addSpan)(e,i,o,"","");if((n.id===u.OperatorId.Pos||n.id===u.OperatorId.Neg)&&t&&(t=!1,(0,m.isNumberNode)(r)&&""===(0,p.getNodeSpan)(e,n).post)){var s=n.id===u.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,l.literalNode)(s,!0,a)}return(0,l.appNode)(n,[r],!0,a)}}var ie=(0,f.take)((function(e,t){return t.kind===i.MaybeWSFTerm?t.node:y(t)?t:void 0})),oe=(0,f.apply)((0,f.tuple)(b,V,P,b),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,l.badNode)(l.BadType.Unexpected,n.chars,(0,p.addSpan)(e,n.start,i,r,o))})),ae=(0,f.apply)((0,f.tuple)(P,b,V,P),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=(0,p.addSpan)(e,o,o,"",""),s=(0,p.addSpan)(e,i.start,o,n,""),u=(0,l.fieldRef)((0,l.badNode)(l.BadType.Missing,"",a),!1,!0,s);return S(n.length>0,u,r,o)})),se=(0,f.lazy)((function(){return(0,f.apply)((0,f.tuple)(P,(0,f.many)((0,f.any)(J,X,ie,oe),(0,f.any)(J,X,ie,(0,f.right)((0,f.succeeds)(_),fe))),P),(function(e,t){var r=t[0],n=t[1],i=t[2];if(1===n.length)return n[0];var o=(0,p.addSpan)(e,r,i,"","");return 0===n.length?(0,l.literalNode)(c.missingOper,!0,o):(0,l.badNode)(l.BadType.Sequence,n,o)}))})),le=Z((0,f.lazy)((function(){return(0,f.any)((0,f.right)((0,f.succeeds)(_),fe),(0,f.right)((0,f.succeeds)(I),me),se)})),(0,f.any)(F,M),re),ue=Z(le,(0,f.tuple)(U,le),ee),ce=Z(ue,(0,f.tuple)(K,ue),ee),de=Z(ce,(0,f.any)(H,ae),re),fe=$(_,de,ne),pe=Z(fe,(0,f.tuple)(G,fe),ee),me=$(I,pe,ne),he=Z(me,L,re),ge=Z(he,(0,f.tuple)(w,he),ee),ve=Z(ge,(0,f.tuple)(D,ge),ee),Se=Z(ve,(0,f.tuple)(A,ve),ee),ye=Z(Se,(0,f.tuple)(x,Se),ee),Ce=Z(ye,(0,f.tuple)(B,ye),ee);t.runOperatorPrecedenceParser=function(e,t){var r=t.length-1;if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,s.assertFalse)(n)}if(t[r].kind!==d.TokenKind.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in ".concat((0,a.anonymize)(t));return(0,s.assertFalse)(n)}if(1===r&&y(t[0]))return t[0];if(C(t[0])){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ".concat((0,a.anonymize)(t));return(0,s.assertFalse)(n)}if(C(t[r-1])){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ".concat((0,a.anonymize)(t));return(0,s.assertFalse)(n)}for(;;){var i=(0,f.runParser)(Ce,t,0,e);if((0,g.isSuccess)(i)&&i.value.index>=r)return i.value.output;if(!(0,g.isSuccess)(i)||0===i.value.index||1===i.value.index&&y(t[0])){var l=(0,g.isSuccess)(i)?i.value.index:0;n="calc.parse.runTermParser: internal error: consumed ".concat(l," out of ").concat(r," in ").concat((0,a.anonymize)(t));return(0,s.assertFalse)(n)}r=(t=o.__spreadArray([i.value.output],t.slice(i.value.index),!0)).length-1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=void 0;var n=r(1);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n,i=r(46),o=r(4),a=r(8);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunction="CalcLambdaFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",e.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(n=t.FeatureName||(t.FeatureName={}));var s=function(e){var t="calc.common.isFeatureEnabledCallback: called with ".concat(e," before initCalc");return i.ulsLogger.ULS.traceTag(526989323,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t),!1},l={};function u(e){return void 0===l[e]&&(l[e]=s(e)),l[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=u,t.getFeatures=function(){var e={};for(var t in n){var r=n[t];null!=r&&(e[r]=u(r))}return e};t.getTypedFeatureGate=(0,a.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.ProductSetBugFixFromPR1043532":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaAssistanceRedesign":!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!1,"Microsoft.Office.Excel.UseAggregatedLogging":!1,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1});var c=r(8);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,a.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS","OfficeVSO:6409219_addPluginNameToPluginDataLog","OfficeVSO:6476056_OnlySendNestedDotNotationPath","Microsoft.Office.Excel.ChangeGate.ParseEditEqFix","Microsoft.Office.Excel.ChangeGate.RCBracketFix","Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix","Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix","OfficeVSO:7125313_handleUnavailableFormat","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins","OfficeVSO:7549315_ArgumentAssistance","OfficeVSO:7624977_addPluginRuntimeToX10Log","OfficeVSO:7740479_TableHeadersAutocompleteBehaviorFix_2","OfficeVSO:7826609_ValuePreviewLocalizedErrorUnavailable"])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return n},t.entry=function(e,t){return{key:e,value:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;var n=r(47),i=r(96);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});var o,a=r(264);t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.None),t.higherOrderFunctionType=function(){var e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,a.isFeatureEnabled)(a.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,a.isFeatureEnabled)(a.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(o=t.OperatorId||(t.OperatorId={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),c=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.None),p=(0,n.functionType)(2,2,[l,l],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),m=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),h=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),g=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),v=[];function S(e,t){var r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}v[o.Add]=u,v[o.Sub]=u,v[o.Mul]=u,v[o.Div]=u,v[o.Pow]=u,v[o.Percent]=c,v[o.Neg]=c,v[o.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],v[o.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],v[o.Pos]=d,v[o.Concat]=f,v[o.Eq]=p,v[o.Ne]=p,v[o.Lt]=p,v[o.Le]=p,v[o.Gt]=p,v[o.Ge]=p,v[o.Range]=m,v[o.Isect]=h,v[o.Union]=h,v[o.And]=g,v[o.Or]=g,v[o.Xor]=g,v[o.Min]=u,v[o.Max]=u,t.getOperatorType=function(e){var r=v[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=function(e){var r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},S(i.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),S(i.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),S(i.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),S(i.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),S(i.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),S(i.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),S(i.WorksheetFuncId.NOW,n.SpecialPrecs.Time),S(i.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),S(i.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),S(i.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),S(i.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),S(i.WorksheetFuncId.INFO,n.SpecialPrecs.None)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;var n=r(0),i=r(25),o=r(18),a=r(144),s=r(24);function l(e,t){switch(t.kind){case s.NodeKind.Literal:var r=t.oper,n=t.isClosed,o=t.label;return e.literalNode(r,n,o);case s.NodeKind.Array:var a=t.nodes;n=t.isClosed,o=t.label;return e.arrayNode(a,n,o);case s.NodeKind.App:var l=t.head,u=t.args;n=t.isClosed,o=t.label;return e.appNode(l,u,n,o);case s.NodeKind.Let:l=t.head;var c=t.vars,d=t.body,f=t.badArgs;n=t.isClosed,o=t.label;return e.letNode(l,c,d,f,n,o);case s.NodeKind.Lambda:l=t.head;var p=t.params;d=t.body,f=t.badArgs,n=t.isClosed,o=t.label;return e.lambdaNode(l,p,d,f,n,o);case s.NodeKind.Paren:var m=t.node;n=t.isClosed,o=t.label;return e.parenNode(m,n,o);case s.NodeKind.Name:var h=t.parts,g=t.qualifier;o=t.label;return e.nameNode(h,g,o);case s.NodeKind.CellRef:var v=t.ref;g=t.qualifier,o=t.label;return e.cellRefNode(v,g,o);case s.NodeKind.FieldRef:var S=t.lhs,y=t.rhs,C=t.shouldBeBracketed;o=t.label;return e.fieldRefNode(S,y,C,o);case s.NodeKind.StructRef:S=t.lhs,y=t.rhs,o=t.label;return e.structRefNode(S,y,o);case s.NodeKind.Bad:o=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents,o);default:return e.badStringNode(t.type,t.contents,o)}default:return(0,i.assertNever)("calc.lang.visitFormulaNode",t)}}function u(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function c(e,t){var r=t.id,n=t.whole,i=t.label;return e.wsfNode(r,n,i)}function d(e,t){switch(t.kind){case s.NodeKind.Operator:return u(e,t);case s.NodeKind.WSF:return c(e,t);default:return l(e,t)}}function f(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=l,t.visitOperatorNode=u,t.visitWSFNode=c,t.visitAppHeadNode=d,t.visitQualifier=function(e,t){switch(t.kind){case s.QualifierKind.Error:var r=t.label;return e.errorQualifier(r);case s.QualifierKind.Relative:r=t.label;return e.relativeQualifier(r);case s.QualifierKind.Document:var n=t.document,o=t.path,a=t.isQuoted;r=t.label;return e.documentQualifier(n,o,a,r);case s.QualifierKind.Sheet:var l=t.sheet,u=t.document;a=t.isQuoted,r=t.label;return e.sheetQualifier(l,u,a,r);case s.QualifierKind.Ident:var c=t.name;a=t.isQuoted,r=t.label;return e.identQualifier(c,a,r);case s.QualifierKind.SheetRange:var d=t.sheet1,f=t.sheet2,p=t.document;a=t.isQuoted,r=t.label;return e.sheetRangeQualifier(d,f,p,a,r);case s.QualifierKind.Bad:var m=t.chars;a=t.isQuoted,r=t.label;return e.badQualifier(m,a,r);default:return(0,i.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case s.CellRefKind.Error:var r=t.label;return e.cellRefError(r);case s.CellRefKind.Single:var n=t.row,o=t.col,a=t.isBracketed;r=t.label;return e.cellRefSingle(n,o,a,r);case s.CellRefKind.Range:var l=t.ref1,u=t.ref2;r=t.label;return e.cellRefRange(l,u,r);case s.CellRefKind.Row:var c=t.row1,d=t.row2;a=t.isBracketed,r=t.label;return e.cellRefRow(c,d,a,r);case s.CellRefKind.Col:var f=t.col1,p=t.col2;a=t.isBracketed,r=t.label;return e.cellRefCol(f,p,a,r);case s.CellRefKind.Bad:var m=t.chars;a=t.isBracketed,r=t.label;return e.cellRefBad(m,a,r);default:return(0,i.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=f;var p=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return(0,s.literalNode)(e,t,r)},e.prototype.arrayNode=function(e,t,r){return(0,s.arrayNode)(e,t,r)},e.prototype.appNode=function(e,t,r,n){return(0,s.appNode)(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,o){return(0,s.letNode)(e,t,r,n,i,o)},e.prototype.lambdaNode=function(e,t,r,n,i,o){return(0,s.lambdaNode)(e,t,r,n,i,o)},e.prototype.parenNode=function(e,t,r){return(0,s.parenNode)(e,t,r)},e.prototype.nameNode=function(e,t,r){return(0,s.nameNode)(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return(0,s.cellRefNode)(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return(0,s.fieldRefNode)(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return(0,s.structRefNode)(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return(0,s.badNode)(e,t,r)},e.prototype.badStringNode=function(e,t,r){return(0,s.badNode)(e,t,r)},e.prototype.operatorNode=function(e,t){return(0,s.operatorNode)(e,t)},e.prototype.wsfNode=function(e,t,r){return(0,s.wsfNode)(e,t,r)},e}();t.IdentityVisitor=p,t.identityVisitor=f(new p);var m=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,i,o){return this.value},e.prototype.lambdaNode=function(e,t,r,n,i,o){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r,n){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badStringNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function h(e){return f(new m(e))}t.ConstVisitor=m,t.constVisitor=h,t.voidVisitor=h(void 0);var g=function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,o){return this.visitor.letNode(e,t,r,n,i,o)},e.prototype.lambdaNode=function(e,t,r,n,i,o){return this.visitor.lambdaNode(e,t,r,n,i,o)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badStringNode=function(e,t,r){return this.visitor.badStringNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}();t.DelegatingVisitor=g;var v=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return n.__extends(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,i,o,a){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){return e.binder.arg})),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.lambdaNode=function(e,t,r,i,a,s){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})).filter(o.isDefined),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r,n){return e},t.prototype.badSequenceNode=function(e,t,r){return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(g);function S(e,t){return f(new v(e,t))}t.BinaryVisitor=v,t.binaryVisitor=S;var y=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,i,o){return this.b(this.a.letNode(e,t,r,n,i,o))},e.prototype.lambdaNode=function(e,t,r,n,i,o){return this.b(this.a.lambdaNode(e,t,r,n,i,o))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badStringNode=function(e,t,r){return this.b(this.a.badStringNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function C(e,t){return f(new y(e,t))}t.ComposeVisitor=y,t.composeVisitor=C,t.depthVisitor=C(S(h(0),o.fastMax),(function(e){return e+1}));var R=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var i={},o=0,a=this.keys;o<a.length;o++){var s=a[o];i[s]=this.visitors[s].appNode(e,t,r,n)}return i},e.prototype.letNode=function(e,t,r,n,i,o){for(var a={},s=0,l=this.keys;s<l.length;s++){var u=l[s];a[u]=this.visitors[u].letNode(e,t,r,n,i,o)}return a},e.prototype.lambdaNode=function(e,t,r,n,i,o){for(var a={},s=0,l=this.keys;s<l.length;s++){var u=l[s];a[u]=this.visitors[u].lambdaNode(e,t,r,n,i,o)}return a},e.prototype.parenNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r,n){for(var i={},o=0,a=this.keys;o<a.length;o++){var s=a[o];i[s]=this.visitors[s].fieldRefNode(e,t,r,n)}return i},e.prototype.structRefNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].structRefNode(e,t,r)}return n},e.prototype.badSequenceNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].badSequenceNode(e,t,r)}return n},e.prototype.badStringNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].badStringNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,i=this.keys;n<i.length;n++){var o=i[n];r[o]=this.visitors[o].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},i=0,o=this.keys;i<o.length;i++){var a=o[i];n[a]=this.visitors[a].wsfNode(e,t,r)}return n},e}();function b(e,t){var r=function(t){switch(t.kind){case s.NodeKind.Literal:var n=t.oper,o=t.isClosed,a=t.label;return e.literalNode(n,o,a);case s.NodeKind.Array:var l=t.nodes;o=t.isClosed,a=t.label;return e.arrayNode(l.map((function(e){return e.map(r)})),o,a);case s.NodeKind.App:var d=t.head,f=t.args;o=t.isClosed,a=t.label;return e.appNode(function(t){switch(t.kind){case s.NodeKind.Operator:return u(e,t);case s.NodeKind.WSF:return c(e,t);default:return r(t)}}(d),f.map(r),o,a);case s.NodeKind.Let:d=t.head;var p=t.vars,m=t.body,h=t.badArgs;o=t.isClosed,a=t.label;return e.letNode(c(e,d),p.map((function(e){var t=e.name,n=e.binder;return(0,s.letVar)(t,(0,s.indexedArg)(r(n.arg),n.index))})),void 0===m?void 0:(0,s.indexedArg)(r(m.arg),m.index),h.map((function(e){return(0,s.indexedArg)(r(e.arg),e.index)})),o,a);case s.NodeKind.Lambda:d=t.head;var g=t.params;m=t.body,h=t.badArgs,o=t.isClosed,a=t.label;return e.lambdaNode(c(e,d),g.map((function(e){var t=e.name;return void 0===t.arg.def?(0,s.lambdaParam)(t):(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(t.arg.name,(0,s.paramDefault)(r(t.arg.def.rhs),t.arg.def.label),t.arg.label),t.index))})),void 0===m?void 0:(0,s.indexedArg)(r(m.arg),m.index),h.map((function(e){return(0,s.indexedArg)(r(e.arg),e.index)})),o,a);case s.NodeKind.Paren:var v=t.node;o=t.isClosed,a=t.label;return e.parenNode(r(v),o,a);case s.NodeKind.Name:var S=t.parts,y=t.qualifier;a=t.label;return e.nameNode(S,y,a);case s.NodeKind.CellRef:var C=t.ref;y=t.qualifier,a=t.label;return e.cellRefNode(C,y,a);case s.NodeKind.FieldRef:var R=t.lhs,b=t.rhs,N=t.shouldBeBracketed;a=t.label;return e.fieldRefNode(r(R),b,N,a);case s.NodeKind.StructRef:R=t.lhs,b=t.rhs,a=t.label;return e.structRefNode(R,b,a);case s.NodeKind.Bad:a=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),a);default:return e.badStringNode(t.type,t.contents,a)}default:return(0,i.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function N(e,t,r,n){var i=[],o=function(e){return i.push(e),a},a=function(){return i.length<t.length?r(e,t[i.length],o):n(i)};return a}function T(e,t,r){return N(e,t,I,r)}function P(e,t,r,n){return function(){return void 0!==t?r(e,t,n):n(void 0)}}function E(e,t,r){var n=t.id,i=t.whole,o=t.label;return function(){return r(e.wsfNode(n,i,o))}}function k(e,t,r){var n=t.name,i=t.binder;return I(e,i.arg,(function(e){return r((0,s.letVar)(n,(0,s.indexedArg)(e,i.index)))}))}function O(e,t,r){var n=t.name,i=n.arg;return void 0===i.def?function(){return r((0,s.lambdaParam)(n))}:I(e,i.def.rhs,(function(e){return r((0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(i.name,(0,s.paramDefault)(e,i.def.label),i.label),n.index)))}))}function A(e,t,r){var n=t.arg,i=t.index;return I(e,n,(function(e){return r((0,s.indexedArg)(e,i))}))}function I(e,t,r){switch(t.kind){case s.NodeKind.Literal:var n=t.oper,o=t.isClosed,a=t.label;return function(){return r(e.literalNode(n,o,a))};case s.NodeKind.Array:var l=t.nodes,u=t.isClosed,c=t.label;return N(e,l,T,(function(t){return r(e.arrayNode(t,u,c))}));case s.NodeKind.App:var d=t.head,f=t.args,p=t.isClosed,m=t.label;return function(){return function(e,t,r){switch(t.kind){case s.NodeKind.Operator:var n=t.id,i=t.label;return function(){return r(e.operatorNode(n,i))};case s.NodeKind.WSF:return E(e,t,r);default:return I(e,t,r)}}(e,d,(function(t){return T(e,f,(function(n){return r(e.appNode(t,n,p,m))}))}))};case s.NodeKind.Let:var h=t.head,g=t.vars,v=t.body,S=t.badArgs,y=t.isClosed,C=t.label;return function(){return E(e,h,(function(t){return N(e,g,k,(function(n){return P(e,v,A,(function(i){return N(e,S,A,(function(o){return r(e.letNode(t,n,i,o,y,C))}))}))}))}))};case s.NodeKind.Lambda:var R=t.head,b=t.params,_=t.body,F=t.badArgs,M=t.isClosed,D=t.label;return function(){return E(e,R,(function(t){return function(){return N(e,b,O,(function(n){return P(e,_,A,(function(i){return N(e,F,A,(function(o){return r(e.lambdaNode(t,n,i,o,M,D))}))}))}))}}))};case s.NodeKind.Paren:var w=t.node,L=t.isClosed,x=t.label;return function(){return I(e,w,(function(t){return function(){return r(e.parenNode(t,L,x))}}))};case s.NodeKind.Name:var B=t.parts,U=t.qualifier,G=t.label;return function(){return r(e.nameNode(B,U,G))};case s.NodeKind.CellRef:var K=t.ref,V=t.qualifier,j=t.label;return function(){return r(e.cellRefNode(K,V,j))};case s.NodeKind.FieldRef:var W=t.lhs,H=t.rhs,Q=t.shouldBeBracketed,q=t.label;return function(){return I(e,W,(function(t){return function(){return r(e.fieldRefNode(t,H,Q,q))}}))};case s.NodeKind.StructRef:var z=t.lhs,Y=t.rhs,J=t.label;return function(){return r(e.structRefNode(z,Y,J))};case s.NodeKind.Bad:var X=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:var $=t.type,Z=t.contents;return T(e,Z,(function(t){return r(e.badSequenceNode($,t,X))}));default:var ee=t.type,te=t.contents;return function(){return r(e.badStringNode(ee,te,X))}}default:return(0,i.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function _(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(I(e,t,(function(e){r=e}))),r}t.ZipVisitor=R,t.zipVisitor=function(e){return f(new R(e))},t.reduceBottomUp_Recursive=b,t.reduceBottomUp_CPS=_;var F=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return l(t,e)},this.lazyVisitFormulaNode=function(e){return a.Pledge.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return d(t,e)},this.lazyVisitAppHeadNode=function(e){return a.Pledge.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return c(t,e)},this.lazyVisitWSFNode=function(e){return a.Pledge.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e.name,n=e.binder;return t.lazyVisitFormulaNode(n.arg).bind((function(e){return(0,s.letVar)(r,(0,s.indexedArg)(e,n.index))}))},this.lazyVisitParam=function(e){var r=e.name,n=r.arg;return void 0===n.def?a.Pledge.resolve((0,s.lambdaParam)(r)):t.lazyVisitFormulaNode(n.def.rhs).bind((function(e){return(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(n.name,(0,s.paramDefault)(e,n.def.label),n.label),r.index))}))},this.lazyVisitIndexedArg=function(e){var r=e.arg,n=e.index;return t.lazyVisitFormulaNode(r).bind((function(e){return(0,s.indexedArg)(e,n)}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return a.Pledge.all(e.map((function(e){return a.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var i=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return a.Pledge.all(t.map(i.lazyVisitFormulaNode)).bind((function(t){return i.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,i,o){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return a.Pledge.all(t.map(s.lazyVisitVar)).bind((function(t){return(void 0===r?a.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return a.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.letNode(e,t,r,n,i,o)}))}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,i,o){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return a.Pledge.all(t.map(s.lazyVisitParam)).bind((function(t){return(void 0===r?a.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return a.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.lambdaNode(e,t,r,n,i,o)}))}))}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r,n){var i=this;return this.lazyVisitFormulaNode(e).bind((function(e){return i.visitor.fieldRefNode(e,t,r,n)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return a.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badStringNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.badStringNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return a.Pledge.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return a.Pledge.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();t.PledgeReducer=F,t.reduceBottomUp_Pledge=function(e,t){return D(new F(e),t)};function M(e,t,r){return r<=50?b(e,t):_(e,t)}function D(e,t){return a.Pledge.settleOrThrow(a.Pledge.resolve(l(e,t)))}t.reduceBottomUp_MaxDepth=M,t.reduceBottomUp=function(e,t){return M(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=D,t.reducePledge=function(e,t){return D(e,t.node)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(2);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(2);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore,t.codePointLeftSingleQuotationMark=n.codePoint.codePointLeftSingleQuotationMark,t.codePointRightSingleQuotationMark=n.codePoint.codePointRightSingleQuotationMark},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(2);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(2);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildMMDDYYFormat=t.buildSingle=t.buildCurrencyFormat=t.buildFractionFormat=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.getColor=t.getSingle=t.getSpecial=void 0;var i=r(0),o=r(42),a=r(72),s=r(82),l=r(43),u=r(69);function c(e,t){var r,n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:a.englishPictureSpecial[t];return(0,l.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function d(e,t){var r,n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:a.englishPictureSingle[t];return(0,l.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function f(e,t){var r,n=null!==(r=e.pictureColor[t])&&void 0!==r?r:a.englishPictureColor[t];return(0,l.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==n),n}function p(e,t,r,n){var i="";if(r>1){var o=(0,u.repeat)(d(e,a.PictureSingle.Hash),r-1);i+=t?(0,s.insertCommas)({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:d(e,a.PictureSingle.Comma)},o,1):o}return i+="0",n>0&&(i+=d(e,a.PictureSingle.Decimal),i+=(0,u.repeat)("0",n)),i}function m(e,t){var r="";return r+="0",t>0&&(r+=d(e,a.PictureSingle.Decimal),r+=(0,u.repeat)("0",t)),e.isPercentSepBySpace&&(r+=d(e,a.PictureSingle.Space)),r+=d(e,a.PictureSingle.Percent)}function h(e,t,r,n){var i="";return i+=p(e,!1,t,r),e.isExpSepBySpace&&(i+=d(e,a.PictureSingle.Space)),i+=d(e,a.PictureSingle.E),i+="+",i+=(0,u.repeat)("0",n)}function g(e,t){var r=d(e,a.PictureSingle.Quote);return r+t+r}function v(e,t){var r="";r+=d(e,a.PictureSingle.Hash);var n=e.fractionSeparator;return n===d(e,a.PictureSingle.Comma)?r+=g(e,n):r+=" "===n?d(e,a.PictureSingle.Space):g(e,n),r+=(0,u.repeat)(d(e,a.PictureSingle.Question),t),r+=d(e,a.PictureSingle.Slash),r+=(0,u.repeat)(d(e,a.PictureSingle.Question),t)}function S(e,t,r,n,i,s,l){void 0===l&&(l=!1);for(var m=e.isCurrencySymbolLead,h=e.currencyFormat,v=e.isCurrencySepBySpace,S=l?0:i?3:1,C=p(e,!0,4,r),R="",b=function(l){0!==l&&(R+=d(e,a.PictureSingle.Sep)),1===l&&t&&(R+=d(e,a.PictureSingle.ColorStart)+f(e,a.PictureColor.Red)+d(e,a.PictureSingle.ColorEnd));var p=function(){return 2===l?function(e,t){var r="";return r+=g(e,"-"),t>0&&(r+=(0,u.repeat)(d(e,a.PictureSingle.Question),t)),r}(e,r):3===l?d(e,a.PictureSingle.Text):C},S=function(){return 3!==l?y(e,a.PictureSingle.Star,a.PictureSingle.Space):""},b=function(){return 1===l?d(e,a.PictureSingle.OpenParen):""},N=function(){return 3!==l||m?1===l?d(e,a.PictureSingle.CloseParen):y(e,a.PictureSingle.Underscore,a.PictureSingle.CloseParen):""},T=function(){var t="";if(1!==l)switch(h){case o.CurrencyFormat.Intern:m||3===l||(t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.Minus));break;case o.CurrencyFormat.Lead:case o.CurrencyFormat.Trail:if(h===o.CurrencyFormat.Lead&&!i)break;t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.Minus)}else t+=d(e,a.PictureSingle.Minus);return i&&!m&&h===o.CurrencyFormat.Lead&&(t+=S()),t},P=function(){var t="";return n&&!m&&v&&(t+=d(e,a.PictureSingle.Space)),n&&(t+=null!=s?s:c(e,a.PictureSpecial.Currency)),m&&v&&(t+=d(e,a.PictureSingle.Space)),t},E=function(){var e="";return 3!==l&&(m?(n&&(e+=P()),i&&(e+=S())):e+=P()),e};if(i&&(R+=function(){var t="";if(m)switch(h){case o.CurrencyFormat.Paren:t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.OpenParen);break;case o.CurrencyFormat.Trail:t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.Minus);break;case o.CurrencyFormat.Intern:t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.Space)}else{switch(h){case o.CurrencyFormat.Trail:t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.Minus);break;case o.CurrencyFormat.Paren:case o.CurrencyFormat.Intern:t+=y(e,a.PictureSingle.Underscore,a.PictureSingle.Space)}h!==o.CurrencyFormat.Lead&&(t+=S())}return t}()),m)switch(h){case o.CurrencyFormat.Paren:i||(R+=b()),R+=E(),i&&(R+=b()),R+=p(),R+=N();break;case o.CurrencyFormat.Lead:R+=T(),R+=E(),R+=p();break;case o.CurrencyFormat.Intern:R+=E(),R+=T(),R+=p();break;case o.CurrencyFormat.Trail:R+=E(),R+=p(),R+=T()}else switch(h){case o.CurrencyFormat.Paren:R+=b(),R+=p(),i&&(R+=N()),R+=E(),i||(R+=N());break;case o.CurrencyFormat.Lead:R+=T(),R+=p(),R+=E();break;case o.CurrencyFormat.Intern:R+=p(),R+=T(),R+=E();break;case o.CurrencyFormat.Trail:R+=p(),R+=E(),R+=T()}i&&(R+=function(){if(m)switch(h){case o.CurrencyFormat.Lead:return y(e,a.PictureSingle.Underscore,a.PictureSingle.Minus);case o.CurrencyFormat.Intern:return y(e,a.PictureSingle.Underscore,a.PictureSingle.Space)}else switch(h){case o.CurrencyFormat.Lead:return y(e,a.PictureSingle.Underscore,a.PictureSingle.Minus);case o.CurrencyFormat.Paren:case o.CurrencyFormat.Intern:return y(e,a.PictureSingle.Underscore,a.PictureSingle.Space)}return""}())},N=0;N<=S;N+=1)b(N);return R}function y(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:d(e,t)})).join("")}t.getSpecial=c,t.getSingle=d,t.getColor=f,t.buildNumberFormat=p,t.buildPercentFormat=m,t.buildScientificFormat=h,t.buildFractionFormat=v,t.buildCurrencyFormat=S,t.buildSingle=y;var C=((n={})[o.DateOrder.MDY]=[1,0,2],n[o.DateOrder.DMY]=[0,1,2],n[o.DateOrder.YMD]=[2,1,0],n[o.DateOrder.MYD]=[1,2,0],n[o.DateOrder.DYM]=[0,2,1],n[o.DateOrder.YDM]=[2,0,1],n);function R(e,t){return y(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?a.PictureSingle.Hour:"",a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute)}function b(e,t){return R(e,t)+y(e,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second)}function N(e){var t="";return e.isAMPMSepBySpace&&(t+=d(e,a.PictureSingle.Space)),t+=c(e,a.PictureSpecial.AP1)}function T(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,i=t||e.year4Digits,o=y(e,i?a.PictureSingle.Year:"",i?a.PictureSingle.Year:"",a.PictureSingle.Year,a.PictureSingle.Year),s=y(e,r?a.PictureSingle.Month:"",a.PictureSingle.Month),l=[y(e,n?a.PictureSingle.Day:"",a.PictureSingle.Day),s,o],u=C[e.dateOrder],c="",f=0;f<3;f+=1)c+=l[u[f]],f<2&&(c+=d(e,a.PictureSingle.DateSep));return c}function P(e,t,r){var n=e.day2Digits,i=e.country===a.Country.GER,o="/"===e.dateSeparator&&" "!==e.dateAltSeparator,s="";return t&&(s+=y(e,n?a.PictureSingle.Day:"",a.PictureSingle.Day),o?s+=e.dateAltSeparator:(s+=d(e,a.PictureSingle.DateSep),i&&(s+=d(e,a.PictureSingle.Space)))),s+=y(e,a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month),r&&(s+=o?e.dateAltSeparator:d(e,i?a.PictureSingle.Space:a.PictureSingle.DateSep),s+=y(e,a.PictureSingle.Year,a.PictureSingle.Year)),s}t.buildMMDDYYFormat=T,t.getKnownFormat=function(e,t){switch(t){case o.KnownFormat.General:return c(e,a.PictureSpecial.General);case o.KnownFormat.NoComFixed0:return p(e,!1,1,0);case o.KnownFormat.NoComFixed:return p(e,!1,1,2);case o.KnownFormat.Fixed0:return p(e,!0,4,0);case o.KnownFormat.Fixed:return p(e,!0,4,2);case o.KnownFormat.Currency:return S(e,!1,0,!0,!1);case o.KnownFormat.CoCurrency:return S(e,!0,0,!0,!1);case o.KnownFormat.CurrencyDec:return S(e,!1,2,!0,!1);case o.KnownFormat.CoCurrencyDec:return S(e,!0,2,!0,!1);case o.KnownFormat.Pct0:return m(e,0);case o.KnownFormat.Pct:return m(e,2);case o.KnownFormat.Exp:return h(e,1,2,2);case o.KnownFormat.Fract:return v(e,1);case o.KnownFormat.FractBond:return v(e,2);case o.KnownFormat.MMDDYY:return T(e);case o.KnownFormat.DDMMMYY:return P(e,!0,!0);case o.KnownFormat.DDMMM:return P(e,!0,!1);case o.KnownFormat.MMMYY:return P(e,!1,!0);case o.KnownFormat.HHMMAP:return R(e,!0)+N(e);case o.KnownFormat.HHMMSSAP:return b(e,!0)+N(e);case o.KnownFormat.HHMM:return R(e,!1);case o.KnownFormat.HHMMSS:return b(e,!1);case o.KnownFormat.MDYHMS:return y(e,T(e),a.PictureSingle.Space,R(e,!1));case o.KnownFormat.USCoCurrency:case o.KnownFormat.USCoCurrencyDec:return S(i.__assign(i.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:o.CurrencyFormat.Paren}),!0,t===o.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?g(e,"US$"):"$");case o.KnownFormat.Currency2:return S(e,!1,0,!1,!1);case o.KnownFormat.CoCurrency2:return S(e,!0,0,!1,!1);case o.KnownFormat.CurrencyDec2:return S(e,!1,2,!1,!1);case o.KnownFormat.CoCurrencyDec2:return S(e,!0,2,!1,!1);case o.KnownFormat.Acct:return S(e,!1,0,!1,!0);case o.KnownFormat.AcctDec:return S(e,!1,2,!1,!0);case o.KnownFormat.AcctCur:return S(e,!1,0,!0,!0);case o.KnownFormat.AcctDecCur:return S(e,!1,2,!0,!0);case o.KnownFormat.MMSS:return y(e,a.PictureSingle.Minute,a.PictureSingle.Minute,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second);case o.KnownFormat.AbsHMMSS:return y(e,a.PictureSingle.ColorStart,a.PictureSingle.Hour,a.PictureSingle.ColorEnd,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second);case o.KnownFormat.SS0:return y(e,a.PictureSingle.Minute,a.PictureSingle.Minute,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second,a.PictureSingle.Decimal,"0");case o.KnownFormat.Eng:return h(e,3,1,1);case o.KnownFormat.Text:return d(e,a.PictureSingle.Text)}},t.isKnownFormatDefined=function(e,t){switch(e){case o.KnownFormat.USCoCurrency:case o.KnownFormat.USCoCurrencyDec:return t.isEastAsia;default:return!0}},t.englishXLSXKnownFormat={0:o.KnownFormat.General,1:o.KnownFormat.NoComFixed0,2:o.KnownFormat.NoComFixed,3:o.KnownFormat.Fixed0,4:o.KnownFormat.Fixed,5:o.KnownFormat.Currency,6:o.KnownFormat.CoCurrency,7:o.KnownFormat.CurrencyDec,8:o.KnownFormat.CoCurrencyDec,9:o.KnownFormat.Pct0,10:o.KnownFormat.Pct,11:o.KnownFormat.Exp,12:o.KnownFormat.Fract,13:o.KnownFormat.FractBond,14:o.KnownFormat.MMDDYY,15:o.KnownFormat.DDMMMYY,16:o.KnownFormat.DDMMM,17:o.KnownFormat.MMMYY,18:o.KnownFormat.HHMMAP,19:o.KnownFormat.HHMMSSAP,20:o.KnownFormat.HHMM,21:o.KnownFormat.HHMMSS,22:o.KnownFormat.MDYHMS,37:o.KnownFormat.Currency2,38:o.KnownFormat.CoCurrency2,39:o.KnownFormat.CurrencyDec2,40:o.KnownFormat.CoCurrencyDec2,41:o.KnownFormat.Acct,42:o.KnownFormat.AcctCur,43:o.KnownFormat.AcctDec,44:o.KnownFormat.AcctDecCur,45:o.KnownFormat.MMSS,46:o.KnownFormat.AbsHMMSS,47:o.KnownFormat.SS0,48:o.KnownFormat.Eng,49:o.KnownFormat.Text}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(1);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tooWide=t.stringEdit=t.renderedValueToString=t.renderedValue=t.renderInfiniteWidth=t.renderCallback=t.previousFormatFailure=t.otherEdit=t.numberEdit=t.notValueString=t.notFormatString=t.noFormatPart=t.memoizedRenderCallback=t.isSystemCultureTag=t.isHashesValue=t.isFormatCultureEqual=t.hashesValue=t.fractionOverflow=t.formulaEdit=t.formattedValue=t.formattedUnitString=t.formattedUnitGeneral=t.formattedUnitFlexible=t.formattedUnitBlank=t.evalFormatLocalsGrid=t.dateOverflow=t.createFormatGlobals=t.aggregationError=t.ReasonKind=t.NumberFormatSource=t.NamedColor=t.GetTimeKind=t.FormattedUnitKind=t.FormatValueType=t.FormatReasonKind=t.FormatCurrency=t.EditKind=t.CultureTag=t.Clip=t.BidiDate=t.Alignment=void 0;var n=r(5);t.Alignment=n.serviceTypes.Alignment,t.BidiDate=n.serviceTypes.BidiDate,t.Clip=n.serviceTypes.Clip,t.CultureTag=n.serviceTypes.CultureTag,t.EditKind=n.serviceTypes.EditKind,t.FormatCurrency=n.serviceTypes.FormatCurrency,t.FormatReasonKind=n.serviceTypes.FormatReasonKind,t.FormatValueType=n.serviceTypes.FormatValueType,t.FormattedUnitKind=n.serviceTypes.FormattedUnitKind,t.GetTimeKind=n.serviceTypes.GetTimeKind,t.NamedColor=n.serviceTypes.NamedColor,t.NumberFormatSource=n.serviceTypes.NumberFormatSource,t.ReasonKind=n.serviceTypes.ReasonKind,t.aggregationError=n.serviceTypes.aggregationError,t.createFormatGlobals=n.serviceTypes.createFormatGlobals,t.dateOverflow=n.serviceTypes.dateOverflow,t.evalFormatLocalsGrid=n.serviceTypes.evalFormatLocalsGrid,t.formattedUnitBlank=n.serviceTypes.formattedUnitBlank,t.formattedUnitFlexible=n.serviceTypes.formattedUnitFlexible,t.formattedUnitGeneral=n.serviceTypes.formattedUnitGeneral,t.formattedUnitString=n.serviceTypes.formattedUnitString,t.formattedValue=n.serviceTypes.formattedValue,t.formulaEdit=n.serviceTypes.formulaEdit,t.fractionOverflow=n.serviceTypes.fractionOverflow,t.hashesValue=n.serviceTypes.hashesValue,t.isFormatCultureEqual=n.serviceTypes.isFormatCultureEqual,t.isHashesValue=n.serviceTypes.isHashesValue,t.isSystemCultureTag=n.serviceTypes.isSystemCultureTag,t.memoizedRenderCallback=n.serviceTypes.memoizedRenderCallback,t.noFormatPart=n.serviceTypes.noFormatPart,t.notFormatString=n.serviceTypes.notFormatString,t.notValueString=n.serviceTypes.notValueString,t.numberEdit=n.serviceTypes.numberEdit,t.otherEdit=n.serviceTypes.otherEdit,t.previousFormatFailure=n.serviceTypes.previousFormatFailure,t.renderCallback=n.serviceTypes.renderCallback,t.renderInfiniteWidth=n.serviceTypes.renderInfiniteWidth,t.renderedValue=n.serviceTypes.renderedValue,t.renderedValueToString=n.serviceTypes.renderedValueToString,t.stringEdit=n.serviceTypes.stringEdit,t.tooWide=n.serviceTypes.tooWide},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(1);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(2);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(8);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeValues=t.rangeValues=t.DerefOperKind=t.machine=void 0;var n,i=r(20);t.machine=i,function(e){e.RangeValues="RangeValues"}(n=t.DerefOperKind||(t.DerefOperKind={})),t.rangeValues=function(e){return{kind:n.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===n.RangeValues}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;var n=r(30),i=r(24),o=r(97),a=r(25),s=r(78),l=r(59),u=r(58),c=(0,i.pos)(i.PosKind.Abs,0),d=(0,i.pos)(i.PosKind.Abs,n.sheetRows-1),f=s.codePointCapitalA,p=s.codePointFullStop;function m(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(f+n)+r,t=Math.floor((t-n)/26)}return r}function h(e,t,r,n){if(t.kind===i.PosKind.Abs)return t.index;if(n)return(0,o.wrapPosition)(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function g(e,t,r,n,o,a){var s=h(r,n,o,a);if(void 0!==s){if(n.kind===i.PosKind.Abs)return t+(s+1).toFixed();var l=s-r;return 0===l?t:t+e.rcLeftBracket+l.toFixed()+e.rcRightBracket}}function v(e,t,r,o,a){return t===i.RefStyle.A1?function(e,t,r){var o=h(e,t,n.sheetRows,r);if(void 0!==o){var a=(o+1).toFixed();return t.kind===i.PosKind.Abs?"$"+a:a}}(r,o,a):g(e,e.rowLetter,r,o,n.sheetRows,a)}function S(e,t,r,o,a){return t===i.RefStyle.A1?function(e,t,r){var o=h(e,t,n.sheetCols,r);if(void 0!==o){var a=m(o);return t.kind===i.PosKind.Abs?"$"+a:a}}(r,o,a):g(e,e.columnLetter,r,o,n.sheetCols,a)}function y(e,t,r,n){if(r.kind===i.PosKind.Abs)return r;var o=h(t,r,e,n);if(void 0!==o){var a=o-t;return a===r.index?r:(0,i.pos)(i.PosKind.Rel,a)}}function C(e,t,r,n,i){var o=h(e,t,n,i),a=h(e,r,n,i);if(void 0!==o&&void 0!==a)return o<=a?[t,r,o,a]:[r,t,a,o]}function R(e,t,r,n,o,a,s,l,u){var c=C(a,s,l,r,u);if(void 0!==c){var d=c[0],f=c[1],p=c[2],m=c[3];if(void 0!==t&&0===p&&m===r-1&&s.kind===l.kind)return t(n,o,u);var h=e(n,o,a,d,u);if(void 0!==h){if(o===i.RefStyle.R1C1&&d.kind===f.kind&&d.index===f.index)return h;var g=e(n,o,a,f,u);if(void 0!==g)return h+":"+g}}}function b(e,t,r,n,i,o){var a=C(r,n,i,t,o);if(void 0!==a){var s=a[0],l=a[1],u=a[2],c=a[3];if(void 0!==e&&0===u&&c===t-1&&n.kind===i.kind)return e;var d=y(t,r,s,o),f=y(t,r,l,o);if(void 0!==d&&void 0!==f)return[!1,d,f]}}function N(e,t,r,n,o,a){var s=v(e,t,r.row,n,a),l=S(e,t,r.col,o,a);if(void 0!==s&&void 0!==l)return t===i.RefStyle.A1?l+s:s+l}function T(e,r,i,o,a,s,l,u){var c=C(i.row,o,s,n.sheetRows,u),d=C(i.col,a,l,n.sheetCols,u);if(void 0!==c&&void 0!==d){var f=c[0],p=c[1],m=c[2],h=c[3],g=d[0],v=d[1],S=d[2],y=d[3];if(0===S&&y===n.sheetCols-1&&a.kind===l.kind)return(0,t.formatRowRange)(e,r,i.row,f,p,u);if(0===m&&h===n.sheetRows-1&&o.kind===s.kind)return(0,t.formatColRange)(e,r,i.col,g,v,u);var R=N(e,r,i,f,g,u),b=N(e,r,i,p,v,u);if(void 0!==R&&void 0!==b)return R+":"+b}}function P(e,t){return t===p||e.isIdentContinue(t)}t.columnName=m,t.canonicaliseBrackets=function(e,t){return e===i.RefStyle.R1C1&&t.kind===i.PosKind.Rel&&0!==t.index},t.resolvePosition=h,t.formatRow=v,t.formatCol=S,t.canonicaliseRow=y.bind(void 0,n.sheetRows),t.canonicaliseCol=y.bind(void 0,n.sheetCols),t.formatRowRange=R.bind(void 0,v,void 0,n.sheetRows),t.formatColRange=R.bind(void 0,S,(function(e,r,n){return(0,t.formatRowRange)(e,r,0,c,d,n)}),n.sheetCols),t.canonicaliseRowRange=b.bind(void 0,void 0,n.sheetRows),t.canonicaliseColRange=b.bind(void 0,[!0,c,d],n.sheetCols),t.formatCellPos=N,t.canonicaliseCellPos=function(e,r,n,i){var o=(0,t.canonicaliseRow)(e.row,r,i),a=(0,t.canonicaliseCol)(e.col,n,i);if(void 0!==o&&void 0!==a)return{row:o,col:a}},t.formatRangePos=T,t.canonicaliseRangePos=function(e,r,i,o,a,s){var l=C(e.row,r,o,n.sheetRows,s),u=C(e.col,i,a,n.sheetCols,s);if(void 0!==l&&void 0!==u){var c=l[0],d=l[1],f=l[2],p=l[3],m=u[0],h=u[1],g=u[2],v=u[3],S=(0,t.canonicaliseRow)(e.row,c,s),y=(0,t.canonicaliseCol)(e.col,m,s),R=(0,t.canonicaliseRow)(e.row,d,s),b=(0,t.canonicaliseCol)(e.col,h,s);if(void 0!==S&&void 0!==y&&void 0!==R&&void 0!==b)return 0===g&&v===n.sheetCols-1&&i.kind===a.kind?{row1:S,row2:R,col1:void 0,col2:void 0}:0===f&&p===n.sheetRows-1&&r.kind===o.kind?{col1:y,col2:b,row1:void 0,row2:void 0}:{row1:S,col1:y,row2:R,col2:b}}};var E=/'/g;function k(e,t){if(0===t.length)return!1;var r=0,n=(0,l.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,l.numCodeUnits)(n);for(var i=0,o=(0,l.codePointIterator)(t,r);i<o.length;i++){if(!P(e,o[i]))return!1}return!0}var O=(0,n.gridCell)(0,0);function A(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=(0,o.parseCellRef)(e,t,O,r,0);if(void 0!==n)if(n.refStyle===i.RefStyle.A1){var a=n.i;if(a>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,a)))return!0}else if(!(0,o.isR1C1IdentStart)(n.row,n.col))return!0;return!k(e,r)&&(!function(e,t){var r=0;if(!(0,u.stringStartsWith)(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=(0,l.stringCodePointAt)(t,r);if(!P(e,n))return!1;for(r+=(0,l.numCodeUnits)(n);;){if((0,u.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var i=(0,l.stringCodePointAt)(t,r);if(!P(e,i))return!1;r+=(0,l.numCodeUnits)(i)}var o=t.indexOf(":",r);return o<0?k(e,t.substring(r)):k(e,t.substring(r,o))&&k(e,t.substring(o+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&k(e,t.substring(r,t.length-n))))}(e,r))}function I(e,t,r){return A(e,t,r)?_(r):r}function _(e){return"'".concat(e.replace(E,"''"),"'")}t.shouldQuoteQualifier=A,t.formatQualifier=I,t.quoteQualifier=_,t.formatGridRange=function(e,t,r,o,s){void 0===r&&(r=i.RefStyle.A1);var l=1===t.cols&&1===t.rows?N(e,r,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),!1):T(e,r,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),(0,i.pos)(i.PosKind.Rel,t.row+t.rows-1),(0,i.pos)(i.PosKind.Rel,t.col+t.cols-1),!1);if((0,a.assertTrue)("calc.lang.formatGridRange",void 0!==l),void 0===o&&void 0===s)return l;if(void 0===o||void 0===s)return I(e,r,null!=o?o:s)+"!"+l;var u=o+":"+s;return(A(e,r,o)||A(e,r,s)?_(u):u)+"!"+l},t.formatName=function(e,t,r,n){return void 0===r&&(r=i.RefStyle.A1),void 0===n?t:I(e,r,n)+"!"+t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(2);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;var n,i,o=r(57),a=r(18);t.resolveLocalsGrid=function(e){return{originGridCell:(0,o.success)(e.range),originSheet:(0,o.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(n=t.ResolveReasonKind||(t.ResolveReasonKind={})),t.noOriginSheet=function(e){return{kind:n.NoOriginSheet,origin:e}},function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(t.InvalidQualifierReason||(t.InvalidQualifierReason={})),t.invalidQualifier=function(e){return{kind:n.InvalidQualifier,reason:e}},function(e){e.BadCellRef="BadCellRef"}(t.InvalidCellRefReason||(t.InvalidCellRefReason={})),t.invalidCellRef=function(e){return{kind:n.InvalidCellRef,reason:e}},function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(t.InvalidStructRefReason||(t.InvalidStructRefReason={})),t.invalidStructRef=function(e){return{kind:n.InvalidStructRef,reason:e}},t.emptyIntersection={kind:n.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(i=t.ResolvedKind||(t.ResolvedKind={})),t.resolvedName=(0,a.typedInstanceCreator)()((function(e,t,r){return{kind:i.ResolvedName,node:e,resolution:t,precedents:r}})),t.resolvedCellRef=(0,a.typedInstanceCreator)()((function(e,t){return{kind:i.ResolvedCellRef,node:e,resolution:t}})),t.resolvedUserDefinedFunc=(0,a.typedInstanceCreator)()((function(e,t,r,n){return{kind:i.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}})),t.resolvedLocalName=(0,a.typedInstanceCreator)()((function(e,t){return{kind:i.ResolvedLocalName,node:e,resolution:t}})),t.resolvedStructRef=(0,a.typedInstanceCreator)()((function(e,t,r,n){return{kind:i.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}})),t.resolvedNever=(0,a.typedInstanceCreator)()((function(e){return{kind:i.ResolvedNever,node:e,resolution:o.successUndefined}})),t.resolvedDottedName=(0,a.typedInstanceCreator)()((function(e,t,r){return{kind:i.ResolvedDottedName,resolved:e,fields:t,precedents:r}}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(268),i=r(269),o=r(270),a=new ArrayBuffer(8),s=new Int32Array(a),l=(new Float32Array(a),new Float64Array(a));function u(e){return s[e]}function c(e,t){s[e]=t}function d(){return l[0]}function f(e){l[0]=e}var p,m=new ArrayBuffer(65536),h=(p=new Uint8Array(m),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)p[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)p[e+n]=r[n]});h(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),h(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),h(1152,"sAsAAMgLAADACwAA0As="),h(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),h(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),h(1975,"oAQ="),h(1991,"yAc="),h(2007,"+go="),h(2022,"QJwO"),h(2038,"UMMR"),h(2054,"JPQU"),h(2069,"gJaYGA=="),h(2085,"ILy+Gw=="),h(2101,"KGvuHg=="),h(2117,"+QKVIg=="),h(2132,"QLdDuiU="),h(2148,"EKXU6Cg="),h(2164,"KueEkSw="),h(2179,"gPQg5rUv"),h(2195,"oDGpX+My"),h(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),h(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),h(3728,"ME8=");var g=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int16Array(r),o=new e.Int32Array(r),a=new e.Uint8Array(r),l=new e.Uint16Array(r),p=new e.Uint32Array(r),m=(new e.Float32Array(r),new e.Float64Array(r)),h=e.Math.imul,g=(e.Math.fround,e.Math.abs),v=e.Math.clz32,S=e.Math.min,y=(e.Math.max,e.Math.floor),C=e.Math.ceil,R=e.Math.sqrt,b=t.abort,N=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),T=t.Base_LocaleGetOrdinal,P=t.Base_LocaleDecimalSeparator,E=t.Math_log10,k=t.Math_log,O=(R=t.Math_sqrt,t.Math_sin),A=t.Math_cos,I=t.Math_tan,_=t.Math_atan,F=t.Math_exp,M=t.proc_exit,D=20112,w=0;function L(){}function x(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=a[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=a[0|t],r=r+-1|0;);}function B(e,t){var r,s,c=0,d=0,p=0,h=0;if(d=3680,D=r=D-48|0,o[r+40>>2]=0,i[r+30>>1]=0,i[r+32>>1]=0,m[460]=e,s=Q(e),m[460]=s,ye(s,r+40|0,r,15),l[r+42>>1]){c=(0|(c=de(t)<<16))<0?100:c>>16,f(+t),p=0|u(1),u(0),(h=-65536&p)&&(2146435072!=(2146435072&p)?c=(0|h)<1?0-c|0:c:o[922]=1);e:{if(!((0|(c=i[r+40>>1]+c|0))>=i[r+42>>1])){if((0|c)<1){d=3e3;break e}(255&c)>>>0>=a[r+30|0]||(n[r+30|0]=c)}Se(3100,3680,r)}e=m[d>>3]}return D=r+48|0,e}function U(e,t){var r,n=0,i=0,a=0;if(m[460]=e,f(+e),i=0|u(1),u(0),a=i,i=0,(n=-65536&a)&&(2146435072!=(2146435072&a)?i=(0|n)<1:(o[922]=1,i=0)),o[921]=2147483647&a,te(m[374]),n=-65536&(a=o[921]))if(2146435072!=(2146435072&a)){if(!((0|n)<1))return q(8),0}else o[922]=1;r=re(m[374],e),m[460]=re(m[372],r),ne(r),me();e:{t:{if((n=o[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;o[922]=1}if(t){if(o[920]=0,o[921]=0,!i)break e;return t=o[741],o[920]=o[740],o[921]=t,m[460]}if(n=o[747],o[920]=o[746],o[921]=n,t=n,1^i|n>>>0<65536)break e;return o[921]=-2147483648^t,m[460]}be(e),he(),t&&(m[460]=re(m[373],m[460]))}return m[460]}function G(e,t,r,n){var s,u=0,c=0,d=0,f=0,p=0,m=0,g=0;if(u=o[e+4>>2],p=-2146827284,!((0|(s=(c=l[e>>1])+(e=(0|(d=i[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+h(e,-12)<<16>>16)+-1&65535)>>>0>11|(!u|1900==(0|s)&2==(0|d)&29==(0|u)?!r:0))){if(m=(0|(e=(f=(0|(c=s+1e4|0))/4|0)<<2))%100|0,g=(0|e)%400|0,u=(((f=h(f,1461)+u|0)+((0|(u=e+-1|0))/-100|0)|0)+((0|u)/400|0)|0)-1|0,c=(h(c-e|0,12)+d|0)-1|0)for(c=c+(e=g?m?0:12:0)|0;u=a[e+1072|0]+u|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=u+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=u+-4346384|0}else e=u+-4346384|0;e>>>0>2958465||(o[n>>2]=e,p=0)}return p}function K(e,t,r){var n,s,l,u=0,c=0,d=0;c=d=ke(e,t,711573504,201),o[r+28>>2]=(c+1>>>0)%7,u=c+h(n=(c>>>0)/146097|0,-146097)|0,s=(h(u,100)+75>>>0)/3652425|0,u=((l=h(s,-36524)+u|0)>>>0)/1461|0,c=(((c+(((u=((h(s,100)+h(n,400)|0)+(u<<2)|0)+((h(l+h(u,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(u>>>2)|0)-((u>>>0)/400|0)|0)+h(u,-365)|0,d=Ee(d,w,-864e5,-1),e=ke(e,t,1e4,0)+d|0,d=!(((t=u+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=a[c+1568|0])<<1)|0:1536+((t=a[c+1168|0])<<1)|0,o[r+12>>2]=(e>>>0)/36e5,o[r+4>>2]=t+1,o[r>>2]=u+1601,t=(e>>>0)/1e3|0,o[r+20>>2]=(t>>>0)%60,o[r+16>>2]=((e>>>0)/6e4>>>0)%60,o[r+24>>2]=e-h(t,1e3),o[r+8>>2]=1+(c-i[d>>1]|0)}function V(e,t){var r=0,n=0,a=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0;return(0|(s=o[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=o[e>>2])+-1601|0)>>>0>29226||(0|(l=o[e+8>>2]))<1||(a=1536,((u=65535&r)>>>0)%400&&(a=3&r?1936:(u>>>0)%100|0?1536:1936),(f=o[e+24>>2])>>>0>999||(u=o[e+20>>2])>>>0>59||(p=o[e+16>>2])>>>0>59||(m=o[e+12>>2])>>>0>23||(l=l+-1|0)>>>0>=i[a+(s<<1)>>1]-i[a+(d<<1)>>1]>>>0||(a=n>>>2,s=h(n,365),n=((e=65535&n)>>>0)/400|0,g=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((c>>>0)%100)|3&r)||(e=1536),c=1,r=(r=h(h(h(m,60)+p|0,60)+u|0,1e3)+f|0)+(n=Ee(e=i[(d<<1)+e>>1]+(n+((l+(s+a|0)|0)-g|0)|0)|0,e>>31,864e5,0))|0,e=w,o[t>>2]=Ee(r,r>>>0<n>>>0?e+1|0:e,1e4,0),o[t+4>>2]=w)),c}function j(e,t,r,n){var i,a=0,s=0,l=0,u=0;D=i=D-112|0,K(r,n,i+80|0);e:{if(o[e>>2]){if(!V(e,t))break e}else{if((0|(s=o[e+8>>2]))>5|!s)break e;if(r=o[e+4>>2],n=o[e+28>>2],a=o[i+80>>2],o[i+56>>2]=1,o[i+52>>2]=r,o[i+48>>2]=a,o[i+60>>2]=o[e+12>>2],o[i+64>>2]=o[e+16>>2],o[i+68>>2]=o[e+20>>2],e=o[e+24>>2],o[i+76>>2]=0,o[i+72>>2]=e,!V(i+48|0,i+8|0)){a=0;break e}e=n+8|0,r=n+1|0,l=(0|s)<2,K(o[i+8>>2],o[i+12>>2],i+16|0),u=i;t:{if((0|n)<(0|(a=o[i+44>>2])))e=e-a|0;else{if(e=1,(0|n)<=(0|a))break t;e=r-a|0}o[u+56>>2]=e}t:if(!l&&(r=e+7|0,o[i+56>>2]=r,a=1,V(i+48|0,i+8|0)))for(;;){if(K(o[i+8>>2],o[i+12>>2],i+16|0),e=o[i+24>>2],(0|s)==(0|(a=a+1|0)))break t;if(r=r+7|0,o[i+56>>2]=r,!V(i+48|0,i+8|0))break}if(o[i+56>>2]=e,!V(i+48|0,i+8|0)){a=0;break e}e=o[i+12>>2],o[t>>2]=o[i+8>>2],o[t+4>>2]=e}a=1}return D=i+112|0,a}function W(e,t,r){var n,a=0,s=0,u=0,c=0,d=0;if(D=n=D-16|0,r&&(u=r>>31,u^=u+r))for(r=(0|r)>0?1952:2448;(a=15&u)&&(s=i[(a=(a<<4)+r|0)+8>>1],d=H(m[e>>3],m[a>>3],n),t=t+s|0,i[n+14>>1]<=0?(a=l[n+6>>1],s=l[n+8>>1]):(s=o[n+4>>2],a=l[n+6>>1]<<1,i[n+6>>1]=a,c=o[n+8>>2],o[n+12>>2]=o[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,o[n+8>>2]=s,t=t+-1|0),(65535&a|1&s|0!=(0|d))>>>0<32769||(s=(a=o[n+8>>2])+1|0,o[n+8>>2]=s,s>>>0>=a>>>0||(s=(a=o[n+12>>2])+1|0,o[n+12>>2]=s,s>>>0>=a>>>0||(o[n+12>>2]=-2147483648,t=t+1|0))),a=o[n+12>>2],o[e>>2]=o[n+8>>2],o[e+4>>2]=a),r=r+240|0,u>>=4;);return D=n+16|0,t}function H(e,t,r){var n,o,a,s=0,l=0,c=0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,C=0,R=0;return f(+t),d=0|u(1),p=65535&(l=0|u(0)),f(+e),y=0|u(1),s=0|u(0),c=y,o=h(v=65535&s,p),i[r>>1]=o,a=((65535&(C=h(S=s>>>16,p)))+(o>>>16)|0)+(65535&(g=h(l>>>=16,v)))|0,i[r+2>>1]=a,C=(((m=((65535&(s=h(n=65535&c,p)))+(C>>>16)|0)+(g>>>16)|0)+(65535&(g=h(l,S)))|0)+(65535&(R=h(y=65535&d,v)))|0)+(a>>>16)|0,i[r+4>>1]=C,g=(((((((65535&(m=h(d>>>=16,v)))+(s>>>16)|0)+(65535&(c=h(s=c>>>16,p)))|0)+(g>>>16)|0)+(R>>>16)|0)+(65535&(p=h(y,S)))|0)+(65535&(v=h(l,n)))|0)+(C>>>16)|0,i[r+6>>1]=g,S=((((((R=(c>>>16)+(m>>>16)|0)+(65535&(c=h(d,S)))|0)+(p>>>16)|0)+(v>>>16)|0)+(65535&(m=h(s,l)))|0)+(65535&(l=h(y,n)))|0)+(g>>>16)|0,i[r+8>>1]=S,m=((l=(((65535&(p=h(d,n)))+(c>>>16)|0)+(m>>>16)|0)+(l>>>16)|0)+(65535&(c=h(s,y)))|0)+(S>>>16)|0,i[r+10>>1]=m,s=(((65535&(d=h(s,d)))+(p>>>16)|0)+(c>>>16)|0)+(m>>>16)|0,i[r+12>>1]=s,i[r+14>>1]=(s>>>16)+(d>>>16),65535&(o|a|C)}function Q(e){var t,r,n=0,i=0,a=0,s=0,l=0,c=0;return D=t=D-16|0,m[t+8>>3]=e,f(+e),n=0|u(1),i=0|u(0),r=n,(n&=2146435072)&&(o[t+8>>2]=i<<11,o[t+12>>2]=r<<11|i>>>21|-2147483648,s=(n=h(i=(n>>>20)-1022|0,39457)>>17)+-14|0,a=W(t+8|0,i,14-n|0),i=o[t+8>>2],(0|a)>=(0|(p[t+12>>2]<(i>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(a=W(t+8|0,a,1),i=o[t+8>>2],s=n+-15|0),n=s,s=(s=i)+(i=-2147483648>>>(31&a))|0,o[t+8>>2]=s,s>>>0>=i>>>0||(c=(l=o[t+12>>2])+1|0,o[t+12>>2]=c,c>>>0>=l>>>0||(o[t+12>>2]=-2147483648,a=a+1|0)),o[t+8>>2]=s&0-(i<<1),a=W(t+8|0,a,n),3071&(n=o[t+8>>2])?(i=n+1024|0,o[t+8>>2]=i,n>>>0<4294966272||(s=(n=o[t+12>>2])+1|0,o[t+12>>2]=s,a=(s>>>0<n>>>0)+a|0)):i=n,(0|a)<=-1023?(o[t+8>>2]=0,o[t+12>>2]=0):(0|(n=1071644672+(a<<20)|0))<=-1||(a=o[t+12>>2],o[t+8>>2]=a<<21|i>>>11,o[t+12>>2]=a>>>11&1048575|n|-2147483648&r),e=m[t+8>>3]),D=t+16|0,e}function q(e){var t;return t=o[922],o[922]=e,t}function z(){var e,t,r;return e=o[920],t=o[921],Z(1048576),Z(2146435072),i[1843]<0?(o[920]=e,o[921]=t,-2147483648):(r=ce(),o[920]=e,o[921]=t,-2147483648^r)}function Y(e){var t,r=0,n=0,i=0,o=0;if(f(+e),r=0|u(1),t=0|u(0),o=r,i=0,!((r=2047&(n=r>>>20))>>>0<1023||(i=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|o),+d();o&=n,c(0,0),c(1,0|o),i=+d()}return i}function J(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return o[920]=0,o[921]=-2147483648,n=W(3680,1,e),r=o[920],e=o[921],3071&r&&(t=o[921],(e=o[920]+1024|0)>>>0<1024&&(t=t+1|0),o[920]=e,o[921]=t,r=e,e=t),o[920]=e<<21|r>>>11,void(o[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(o[922]=1),o[920]=0,o[921]=0}function X(e,t,r,n){var a=0,s=0,u=0;e:{t:{r:{n:{if(!n){if(l[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return o[t>>2]=1,void(o[r>>2]=0)}if(l[(n<<1)+e>>1]<=52)break e;for(;;){if(u=l[(s=((a=n+-1|0)<<1)+e|0)>>1]+1|0,i[s>>1]=u,58!=(65535&u))break e;if(!(n=a))break}}return i[e>>1]=49,o[t>>2]=o[t>>2]+1,void(o[r>>2]=1)}for(;t=n,(0|n)>=2&&48==l[((n=t+-1|0)<<1)+e>>1];);o[r>>2]=t}function $(){var e=0,t=0,r=0;e:{if(r=o[920],t=-65536&(e=o[921])){if(2146435072==(2146435072&e))return o[922]=1,void ge();if((0|t)<1)break e}return void ge()}ge(),(0|r)==o[920]&&o[921]==(0|e)||te(1)}function Z(e){m[460]=ee(m[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[922]=1,e=m[375]),e}function te(e){m[460]=re(m[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[922]=1,e=m[375]),e}function ne(e){m[460]=ie(m[460],e)}function ie(e,t){var r,n=0,i=0,a=0;return f(+e*t),n=0|u(1),r=0|u(0),0|2146435072!=(0|(i=2146435072&n))?(a=(i=!(i|a))?o[750]:r,n=i?o[751]:n,c(0,0|a),c(1,0|n),+d()):(o[922]=1,n=o[751],c(0,o[750]),c(1,0|n),+d())}function oe(e){m[460]=ae(m[460],e)}function ae(e,t){var r=0,n=0,i=0,a=0;if(f(+t),r=0|u(1),u(0),2146435072&r){if(n=1,f(+e/t),r=0|u(1),i=0|u(0),!(!0&2146435072==(0|(a=2146435072&r))))return i=(n=!(0|a))?o[750]:i,r=n?o[751]:r,c(0,0|i),c(1,0|r),+d()}else n=4;return o[922]=n,r=o[751],c(0,o[750]),c(1,0|r),+d()}function se(e){m[460]=e>>>0}function le(e){m[460]=0|e}function ue(){var e,t;e=+k(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}function ce(){return de(m[460])}function de(e){var t,r=0,n=0,i=0,o=0;return f(+e),o=1106247680==(0|(i=2146435072&(r=0|u(1))))&o>>>0<0|i>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|u(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(i=g(e)>=1?e>0?~~S(y(e/4294967296),4294967295)>>>0:~~C((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(i=0,r=0),n=o?r:n,!(r=o?i:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return pe(m[460])}function pe(e){var t=0,r=0;return f(+e),t=0|u(1),u(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=g(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function me(){var e,t;e=+R(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}function he(){var e,t;e=+_(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}function ge(){m[460]=Y(m[460])}function ve(){var e,t;e=+F(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=1)}function Se(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=a[r+30|0]){for(s=r;d=10*d+ +(0|Ae[o[o[e>>2]+4>>2]](e,l[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(f(+d),n=0|u(1),e=0|u(0),o[t>>2]=e<<11,o[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=W(t,(n>>>20&2047)-1022|0,((32767&l[r+32>>1])-a[r+30|0]|0)-16384|0),3071&(s=o[t>>2])?(e=s+1024|0,o[t>>2]=e,s>>>0<4294966272||(c=(s=o[t+4>>2])+1|0,o[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=o[t+4>>2],o[t>>2]=n<<21|e>>>11,o[t+4>>2]=-2147483648&i[r+32>>1]|s|n>>>11&1048575,0)}return o[t>>2]=0,o[t+4>>2]=0,0}(e,t,r)}function ye(e,t,r,a){!function(e,t,r,a){var s,c,d=0,p=0,g=0,v=0,S=0,y=0,C=0,R=0,b=0,N=0;D=s=D-16|0,m[s+8>>3]=e,c=t,f(+e),p=0|u(1),g=0|u(0),v=d=p;e:if(p=2146435072&d){if(p=h(S=(p>>>20)-1022|0,39457)>>17,i[r+32>>1]=p+16385|d>>>16&32768,(0|a)<=14){if((0|(a=1+(a+p|0)|0))<=-1){n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;break e}a=(0|a)<15?a:15}if(o[s+8>>2]=g<<11,o[s+12>>2]=v<<11|g>>>21|-2147483648,(0|(d=W(s+8|0,S,-1^p)))>=1)for(g=r+32|0;p=l[g>>1],i[g>>1]=p+1&32767|32768&p,(0|(d=W(s+8|0,d,-1)))>0;);if(d?(p=(g=o[s+12>>2])>>>(v=0-d|0),o[s+12>>2]=p,d=g<<d+32|o[s+8>>2]>>>v,o[s+8>>2]=d):(d=o[s+8>>2],p=o[s+12>>2]),d=(g=p>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,o[s+8>>2]=d,d>>>0<g>>>0&&(p=p+1|0,o[s+12>>2]=p),(0|a)<1)g=r;else{for(y=d>>>16,C=l[s+14>>1],R=r+32|0,N=15==(0|a),g=r,v=1;;){S=a;t:{r:{for(;;){if(a=h(y,10)+(h(65535&d,10)>>>16)>>>16,b=h(C,10)+(a+h(65535&p,10)>>>16)>>>16|48,i[g>>1]=b,C=(p=a+h(p,10)|0)>>>16,y=(d=h(d,10))>>>16,1&(-1^v|48!=(0|b)))break r;if(a=l[R>>1],i[R>>1]=a+-1&32767|32768&a,!N)break}v=1;break t}g=g+2|0,v=0}if(a=S+-1|0,!((0|S)>1))break}o[s+12>>2]=p,o[s+8>>2]=d}d=(a=g-r|0)>>1;t:{if((0|a)<=29){if((0|p)<=-1){i[g>>1]=57,p=d+1|0;break t}i[g>>1]=48}for(;;){if(p=d,(0|d)<1)break t;if(d=p+-1|0,48!=l[(g=g+-2|0)>>1])break}}n[r+30|0]=p,i[t+2>>1]=p,t=(32767&l[r+32>>1])-16384|0}else n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;i[c>>1]=t,D=s+16|0}(e,t,r,a)}function Ce(e){return re(m[460],e)}function Re(e){return ae(m[460],e)}function be(e){m[460]=ae(e,m[460])}function Ne(e,t){m[460]=ae(e,t)}function b(){M(1),b()}function Te(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Pe(e,t,r,n){var i=0,o=0;return r=function(e,t,r,n){var i=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0;e:{t:{r:{n:{i:{o:{a:{s:{l:{u:{if(a=t){if(!(i=r))break u;if(!(o=n))break l;if((i=v(o)-v(a)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Te(e-h(t=(e>>>0)/(r>>>0)|0,r)|0,0),w=0,t}if(i=n,!e)break a;if(!i)break o;if((o=i+-1|0)&i)break o;return Te(e,a&o),e=a>>>(31&Oe(i)),w=0,e}if(!((o=i+-1|0)&i))break i;l=(v(i)+33|0)-v(a)|0,u=0-l|0;break r}l=i+1|0,u=63-i|0;break r}return Te(0,a-h(e=(a>>>0)/(i>>>0)|0,i)|0),w=0,e}if((i=v(i)-v(a)|0)>>>0<31)break n;break t}if(Te(e&o,0),1==(0|i))break e;return r=Oe(i),n=e,e=31&r,32<=(63&r)>>>0?(i=0,e=t>>>e):(i=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),w=i,e}l=i+1|0,u=63-i|0}if(o=t,f=e,a=31&(i=63&l),32<=(63&i)>>>0?(i=0,s=o>>>a):(i=o>>>a,s=((1<<a)-1&o)<<32-a|f>>>a),o=i,a=e,e=31&(i=63&u),32<=(63&i)>>>0?(i=a<<e,e=0):(i=(1<<e)-1&a>>>32-e|t<<e,e=a<<e),t=i,l)for(i=n+-1|0,(a=r+-1|0)>>>0<4294967295&&(i=i+1|0),u=i;i=o<<1|s>>>31,o=s<<1,f=i,i=(s=u-((a>>>0<(o|=t>>>31)>>>0)+i|0)|0)>>31,s=(d=o)-(o=r&(c=s>>31))|0,o=f-((n&i)+(d>>>0<o>>>0)|0)|0,i=t<<1|e>>>31,e=p|e<<1,t=0|i,d=0,p=c&=1,l=l+-1|0;);return Te(s,o),w=(i=t<<1|e>>>31)|d,e=c|e<<1}Te(e,t),e=0,t=0}return w=t,e}((e^=i=t>>31)-i|0,o=((o=t>>31)^t)-((e>>>0<i>>>0)+o|0)|0,(r^=e=n>>31)-e|0,((i=n>>31)^n)-((r>>>0<e>>>0)+i|0)|0),w=((e=(t^=n)>>31)^w)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}function Ee(e,t,r,n){return e=function(e,t,r,n){var i,o,a,s,l=0,u=0;return s=h(l=r>>>16,u=e>>>16),l=(65535&(u=((a=h(i=65535&r,o=65535&e))>>>16)+h(u,i)|0))+h(l,o)|0,e=(((h(t,r)+s|0)+h(e,n)|0)+(u>>>16)|0)+(l>>>16)|0,w=e,t=65535&a|l<<16}(e,t,r,n)}function ke(e,t,r,n){return e=Pe(e,t,r,n)}function Oe(e){return e?31-v(e+-1^e)|0:32}var Ae=[null,function(e,t){return 0,0!=(0|N(0|(t|=0)))|0},function(e,t){return 0,0|T(0|(t|=0))},function(e){return 0,0|P()},function(e,t){return 0,(t|=0)+-48|0},L];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return a[1072+(((h(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=h(r|=0,20)+3616|0,i[r>>1]=0,t=function(e,t,r,n,s){var p=0,g=0,v=0,S=0,y=0,C=0,R=0,b=0,N=0;e:if(!l[e>>1]){if(m[460]=t,f(+t),p=0|u(1),v=0|u(0),C=p,N=-65536&p)if(2146435072!=(2146435072&p)){if(!((0|N)>=1))return-2147467259}else o[922]=1;y=o[770],R=o[771],S=-1;t:{if(!((0|p)<(0|(g=R))||(S=1,(0|p)>(0|g)))){if((0|y)==(0|(g=v)))break t;S=g>>>0<y>>>0?-1:1}if(g=-2147467259,1==(0|((C&R)>-1?S:0-S|0)))break e}t:{if(y=o[772],g=o[773],R=g,S=-1,!((0|p)<(0|g)||(S=1,(0|p)>(0|R)))){if((0|v)==(0|y))break t;S=v>>>0<y>>>0?-1:1}if(y=S,-1==(0|((g&C)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(s|!N))if(2146435072!=(2146435072&p)){if((0|N)<1)break r}else o[922]=1;Z(m[o[1056+(r<<2)>>2]>>3]),b=m[460];break t}$(),te(t),C=o[921],v=C,c(0,0|(p=o[920])),c(1,0|v),b=+d(),o[750]==(0|p)&&o[751]==(0|v)||(g=o[921])>>>0<65536||(o[921]=-2147483648^g,f(+(b=m[460])),v=0|u(1),p=0|u(0)),C=v,y=v,v=o[1056+(r<<2)>>2],R=o[v+4>>2],g=o[v>>2],S=-1;r:{if(!((0|y)<(0|(v=R))||(S=1,(0|y)>(0|v)))){if((0|p)==(0|g)){m[460]=t;break r}S=p>>>0<g>>>0?-1:1}if(y=S,m[460]=t,-1==(0|((C&R)>-1?y:0-y|0)))break t}te(m[374])}if(i[e+18>>1]=r,p=fe(),g=-2147467259,!q(0)){if(n){if((0|p)>2957003)break e;p=p+1462|0}else if(p+4346018>>>0>7304483)break e;if(i[e+14>>1]=1+((p+6|0)%7|0),!s|p)if(p){if((0|p)<=-1?(v=-4-((n=(-1^p)/1461|0)<<2)|0,g=1461+(h(n,1461)+p|0)|0):(v=(n=(p+-1|0)/1461|0)<<2,g=h(n,-1461)+p|0),!(s&&(0|v)<=199))if((0|(g=(((0|(n=v+-101|0))/100|0)-((0|n)/400|0)|0)+g|0))>=1462){p=3&(n=v+1900|0);t:if(s){if(p|(0|v)<200)break t;p=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else p||(p=!((0|n)%100)&0!=((0|n)%400|0));v=v+4|0,g=(12==(0|h(p,12))?-1460:-1461)+g|0}else(0|g)>0||(v=v+-4|0,g=g+1461|0);p=3&(n=v+1900|0);t:if(s){if(p|(0|v)<200)break t;p=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else p||(p=!((0|n)%100)&0!=((0|n)%400|0));for(C=h(p,12),p=C;s=p,p=p+1|0,(0|(g=(n=g)-a[s+1072|0]|0))>0;);s=((g=s)-((0|C)<(0|(s=s+-11|0))?C:s)>>>0)/12|0,i[e>>1]=1900+(s+v|0),i[e+2>>1]=(h(s,-12)+p|0)-C}else o[e>>2]=788331,n=30;else o[e>>2]=67436;if(o[e+4>>2]=n,m[460]=b,ge(),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(b),ne(m[379]),t=m[460],n=ce(),i[e+8>>1]=n,se(n<<16>>16),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(t),ne(m[380]),t=m[460],n=ce(),i[e+10>>1]=n,se(n<<16>>16),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(t),ne(m[380]),!r)return r=ce(),i[e+16>>1]=0,i[e+12>>1]=r,0;t=m[460],n=ce(),i[e+12>>1]=n,se(n<<16>>16),(n=o[921])>>>0>=65536&&(o[921]=-2147483648^n),Z(t),ne(m[o[1152+(r<<2)>>2]>>3]),m[460]=Q(m[460]),i[e+16>>1]=ce(),g=0}}return g}(r,e,t,0!=(0|n),0!=(0|s)),o[922]=0,0|t},Dtr_Yr:function(e){return i[h(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return i[h(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return o[h(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return i[h(e|=0,20)+3624>>1]},Dtr_Min:function(e){return i[h(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return i[h(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return i[h(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return i[h(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return i[h(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,a,s,l,u,c,d){e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,l|=0,u|=0,c|=0,d=h(d|=0,20),i[d+3634>>1]=c,i[d+3632>>1]=u,i[d+3630>>1]=l,i[d+3628>>1]=s,i[d+3626>>1]=a,i[d+3624>>1]=n,o[d+3620>>2]=r,i[d+3618>>1]=t,i[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,o[920]=0,o[921]=0,function(e,t,r){var n,a=0;D=n=D-16|0;e:{t:{r:{if((l[e+2>>1]+-32767&65535)>>>0>1){if(i[e+18>>1]>=1?(le(i[e+16>>1]),a=Re(m[o[1152+(i[e+18>>1]<<2)>>2]>>3]),le(i[e+12>>1]),Z(a)):le(i[e+12>>1]),a=Re(m[380]),le(i[e+10>>1]),Z(a),a=Re(m[380]),le(i[e+8>>1]),Z(a),a=Re(m[379]),!((0|G(e,t,r,n+12|0))<0)){if(e=o[n+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(e=o[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){o[922]=1;break t}if((0|t)>=1)break t}}o[920]=0,o[921]=0}o[920]=0,o[921]=0,q(8);break e}se(e)}Z(a)}D=n+16|0}(h(e,20)+3616|0,0!=(0|t),0!=(0|r)),+m[460]},Dtr_ToNumWithDuration:function(e,t,r,n,a){return e|=0,t|=0,r|=0,n|=0,a|=0,o[920]=0,o[921]=0,function(e,t,r,n,a){var s,u=0;D=s=D-16|0;e:{t:{r:{if((l[e+2>>1]+-32767&65535)>>>0>1){n:if(i[e+18>>1]>=1){if(le(i[e+16>>1]),oe(m[o[1152+(i[e+18>>1]<<2)>>2]>>3]),u=m[460],2==(0|a)){m[460]=n,Z(u);break n}le(i[e+12>>1]),Z(u)}else 2!=(0|a)?le(i[e+12>>1]):m[460]=n;if(oe(m[380]),u=m[460],1!=(0|a)?le(i[e+10>>1]):m[460]=n,Z(u),oe(m[380]),u=m[460],a?le(i[e+8>>1]):m[460]=n,Z(u),oe(m[379]),n=m[460],!((0|G(e,t,r,s+12|0))<0)){if(e=o[s+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(e=o[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){o[922]=1;break t}if((0|t)>=1)break t}}o[920]=0,o[921]=0}o[920]=0,o[921]=0,q(8);break e}se(e)}Z(n)}D=s+16|0}(h(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|a),n),+m[460]},Dtr_Days:function(){return o[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(h(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){m[460]=e,Z(m[o[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(m[380]);ne(m[380])}ne(m[379]),ge()}(e=+e,t|=0,r|=0),+m[460]},Dtr_UtcToLocal:function(e,t,r,n,a,s,u,c){var d;return e|=0,t|=0,r|=0,n|=0,a|=0,s|=0,u|=0,c|=0,D=d=D-32|0,o[d+24>>2]=s,o[d+16>>2]=n,o[d+8>>2]=t,o[d+20>>2]=(0|a)>-1?h(a,20)+3616|0:0,o[d+12>>2]=(0|r)>-1?h(r,20)+3616|0:0,e=function(e,t,r,n){var a,s=0;D=a=D-32|0,function(e,t,r){var n,a=0,s=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0,S=0,y=0;if(D=n=D-96|0,o[n+64>>2]=i[t>>1],o[n+68>>2]=i[t+2>>1],o[n+72>>2]=o[t+4>>2],o[n+76>>2]=i[t+8>>1],o[n+80>>2]=i[t+10>>1],o[n+84>>2]=i[t+12>>1],o[n+92>>2]=i[t+14>>1]+-1,(a=i[t+18>>1])>>>0<=3){e:{t:switch(a-1|0){case 0:a=h(i[t+16>>1],100);break e;case 1:a=h(i[t+16>>1],10);break e;case 2:break t;default:break e}a=i[t+16>>1]}o[n+88>>2]=a}t=0;e:if(V(n- -64|0,n+40|0)){if(u=Ee(u=h(o[e>>2],60),u>>31,1e7,0),d=w,(s=o[e+4>>2])&&(c=o[e+12>>2])){if(o[n+64>>2]=i[s>>1],o[n+68>>2]=i[s+2>>1],o[n+72>>2]=o[s+4>>2],o[n+76>>2]=i[s+8>>1],o[n+80>>2]=i[s+10>>1],o[n+84>>2]=i[s+12>>1],o[n+92>>2]=i[s+14>>1]+-1,(a=i[s+18>>1])>>>0<=3){t:{r:switch(a-1|0){case 0:a=h(i[s+16>>1],100);break t;case 1:a=h(i[s+16>>1],10);break t;case 2:break r;default:break t}a=i[s+16>>1]}o[n+88>>2]=a}if(o[n+8>>2]=i[c>>1],o[n+12>>2]=i[c+2>>1],o[n+16>>2]=o[c+4>>2],o[n+20>>2]=i[c+8>>1],o[n+24>>2]=i[c+10>>1],o[n+28>>2]=i[c+12>>1],o[n+36>>2]=i[c+14>>1]+-1,(a=i[c+18>>1])>>>0<=3){t:{r:switch(a-1|0){case 0:a=h(i[c+16>>1],100);break t;case 1:a=h(i[c+16>>1],10);break t;case 2:break r;default:break t}a=i[c+16>>1]}o[n+32>>2]=a}if(s=o[n+44>>2],c=s,a=o[n+40>>2],!j(n- -64|0,n+56|0,a,s))break e;if(!j(n+8|0,n+48|0,a,c))break e;g=o[n+40>>2],p=o[n+44>>2],v=u,S=e+16|0,y=e+8|0,m=(c=d)+o[n+52>>2]|0,(f=(a=u)+o[n+48>>2]|0)>>>0<a>>>0&&(m=m+1|0),s=f,a=h(o[e+8>>2],60),f=Ee(a,a>>31,1e7,0),a=w+m|0,m=s=s+f|0,f=a=s>>>0<f>>>0?a+1|0:a,s=d+o[n+60>>2]|0,(d=u+o[n+56>>2]|0)>>>0<u>>>0&&(s=s+1|0),e=h(o[e+16>>2],60),u=Ee(e,e>>31,1e7,0),e=w+s|0,e=(d=u+d|0)>>>0<u>>>0?e+1|0:e,u=d,e=Ee(e=h(o[((e=(0|a)<(0|e)||(0|a)<=(0|e)&&!(m>>>0>=u>>>0)?((0|p)<(0|e)?1:(0|p)<=(0|e)?g>>>0>=u>>>0?0:1:0)&((0|p)>(0|f)?1:(0|p)>=(0|f)?g>>>0<m>>>0?0:1:0):((0|p)<(0|e)?1:(0|p)<=(0|e)?g>>>0>=u>>>0?0:1:0)|((0|p)>(0|f)?1:(0|p)>=(0|f)?g>>>0<m>>>0?0:1:0))?S:y)>>2],60),e>>31,1e7,0),a=w+c|0,d=a=(u=v+e|0)>>>0<e>>>0?a+1|0:a}e=o[n+40>>2],a=o[n+44>>2]-(d+(e>>>0<u>>>0)|0)|0,u=e-u|0,(0|(e=a))<0||(0|e)<=0&&!(u>>>0>=0)||(K(u,e,n- -64|0),i[r>>1]=o[n+64>>2],i[r+2>>1]=o[n+68>>2],o[r+4>>2]=o[n+72>>2],t=1,i[r+14>>1]=l[n+92>>1]+1,i[r+8>>1]=o[n+76>>2],i[r+10>>1]=o[n+80>>2],i[r+12>>1]=o[n+84>>2],e=o[n+88>>2],i[r+18>>1]=3,i[r+16>>1]=e)}return D=n+96|0,t}(n,e,a+8|0)&&(n=o[a+12>>2],o[e>>2]=o[a+8>>2],o[e+4>>2]=n,o[e+16>>2]=o[a+24>>2],n=o[a+20>>2],o[e+8>>2]=o[a+16>>2],o[e+12>>2]=n,n=e,(0|G(e,t,r,a+28|0))>=0?e=1+((o[a+28>>2]+6|0)%7|0)|0:(o[a+28>>2]=-1,e=6),i[n+14>>1]=e,s=1);return D=a+32|0,s}(h(e,20)+3616|0,0!=(0|u),0!=(0|c),d+8|0),D=d+32|0,0|e},Mathpack_Zero:function(){return+m[375]},Mathpack_One:function(){return+m[374]},Mathpack_Pi:function(){return+m[370]},Mathpack_Div:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ie(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,a=0,s=0;m[460]=t,f(+t),r=0|u(1),u(0),a=r,o[921]=2147483647&r,t=m[460];e:{if(f(+Ce(m[371])),r=0|u(1),n=0|u(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)m[460]=e,me();else if(ge(),f(+Ce(t)),r=0|u(1),n=0|u(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=ce()))){if(m[460]=e,f(+e),n=0|u(1),u(0),(0|(n=(r=n)>>>16<<16))>=1)ue(),ne(t),ve();else if(!((0|n)>-1)){if(Ne(m[374],t),s=Q(m[460]),m[460]=s,ge(),f(+Ce(s)),65535==(0|(n=0|u(1)))&u(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;m[460]=e,o[921]=2147483647&r,ue(),ne(t),ve(),(r=o[921])>>>0<65536||(o[921]=-2147483648^r)}}else m[460]=e,function(e){var t,r=0;if(!((t=i[1843])|e))return void(o[922]=4&o[922]?4:64);if(!((0|t)<1)&&10==(0|ce())){if(r=m[460],ge(),te(r),!l[1843])return void J(e);m[460]=r}r=1;for(;1&e&&(r=ie(m[460],r)),e>>>=1;)ne(m[460]);m[460]=r}(r);if(a>>>16<<16>>16<=-1){if(1&(a=o[922]))return o[920]=0,o[921]=0,o[922]=-2&a,m[460];be(m[374])}return m[460]}return o[922]=8,m[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|u(1),u(0),(r=-65536&t)?2146435072==(2146435072&t)?(o[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,i,o,a=0,s=0,l=0;f(+(e=+e)),a=0|u(1),r=0|u(0),n=a,o=a,f(+t),i=0|u(1),a=0|u(0),l=-1;e:{if(!((0|n)<(0|(s=i))||(l=1,(0|o)>(0|s)))){if(s=0,(0|a)==(0|r))break e;l=r>>>0<a>>>0?-1:1}a=l,s=(i&n)>-1?a:0-a|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=o[922],o[922]=0,0|e},Mathpack_Trunc:function(e){return+Y(e=+e)},Mathpack_Ceil:function(e){return e=+e,m[460]=e,function(){var e=0,t=0,r=0;e:{if(r=o[920],e=o[921],t=-65536&e){if(2146435072==(2146435072&e))return o[922]=1,void ge();if((0|t)>0)break e}return void ge()}ge(),(0|r)==o[920]&&o[921]==(0|e)||Z(1)}(),+m[460]},Mathpack_Floor:function(e){return e=+e,m[460]=e,$(),+m[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|u(1),t&=2147483647,c(0,0|(0|u(0))),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,i;return f(+(e=+e)),n=-2147483648^(t=0|u(1)),c(0,0|(r=0|u(0))),c(1,0|n),i=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?i:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|pe(e=+e)},Mathpack_SFix:function(e){return e=+e,m[460]=e,0|z()},Mathpack_Round:function(e,t){return+function(e,t){var r,a=0,s=0,c=0,d=0;D=r=D+-64|0,o[r+56>>2]=0,i[r+46>>1]=0,i[r+48>>1]=0,m[460]=e,f(+e),a=0|u(1),u(0);e:if(s=-65536&a)if(2146435072!=(2146435072&a)){(0|s)>0||(d=32768,a>>>0<65536||(o[921]=-2147483648^a,e=m[460])),ye(e,r+56|0,r+16|0,15),l[r+58>>1]||(i[r+56>>1]=1),m[460]=t,a=(0|(a=z()))<0?100:a;t:{if(s=o[921],c=-65536&s)if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((a=o[921])>>>0>=65536&&(o[921]=-2147483648^a),(0|(a=z()))<=-1)break t;a=0-a|0}}else o[922]=1;s=i[r+56>>1],c=a+s|0,a=i[r+58>>1],(0|c)<(0|a)&&(o[r+12>>2]=a,o[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),a=o[r+12>>2],i[r+58>>1]=a,s=o[r+8>>2],i[r+56>>1]=s),n[r+46|0]=a,i[r+48>>1]=s+16384&32767|d,Se(3100,3680,r+16|0),e=m[460];break e}e=m[375]}else o[922]=1;return D=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,i=0,a=0,s=0;f(+e),r=0|u(1),u(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:o[922]=1);if(i=B(e,t),m[460]=e,m[460]=Q(e),te(i),(r=o[921])>>>0>=65536){if(2146435072==(2146435072&r))return o[922]=1,i;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|u(1),u(0),(a=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|a)<1?0-r|0:r:o[922]=1),(0|r)<=-309)return q(8),0;J(0-r|0),(0|s)>-1||(r=o[921])>>>0<65536||(o[921]=-2147483648^r),Z(i),i=m[460]}return i}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=B(e=+e,t=+t))),r=0|u(1),u(0),2146435072==(2146435072&r)&&(o[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return J(e|=0),+m[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,i=0,a=0,s=0,l=0;D=r=D-16|0,m[r+8>>3]=e,m[r>>3]=t,f(+e),n=0|u(1),i=0|u(0),a=n,f(+t),n=0|u(1),s=0|u(0),l=n;e:{if((0|i)!=(0|s)||(0|a)!=(0|n)){if((l+2097152&2146435072)-(2146435072&a)>>>0<=5242879&&(e=Q(e),m[r+8>>3]=e,f(+e),n=0|u(1),u(0),a=n,e=Q(t),m[r>>3]=e,f(+e),n=0|u(1),u(0),l=n),n=1,a=o[(s=(i=(l&a)>-1)?r+8|0:r)+4>>2],l=o[(i=i?r:r+8|0)+4>>2],(0|a)>(0|l))break e;if((0|a)<(0|l)){n=-1;break e}if(s=o[s>>2],i=o[i>>2],s>>>0>i>>>0)break e;if(n=-1,s>>>0<i>>>0)break e}n=0}return D=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|u(1),u(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,i=0;return f(+(e=+e)),i=0|u(1),r=0|u(0),f(+t),n=0|u(1),0|(i=(0|r)==(0|u(0))?(0|i)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|u(1),u(0),2146435072==(2146435072&t)?(o[922]=1,-1):+Q(e)},Mathpack_Sqrt:function(e){return e=+e,m[460]=e,me(),+m[460]},Mathpack_Exp:function(e){return e=+e,m[460]=e,ve(),+m[460]},Mathpack_Ln:function(e){return e=+e,m[460]=e,ue(),+m[460]},Mathpack_Log:function(e){return e=+e,m[460]=e,function(){var e,t;e=+E(+m[460]),m[460]=e,f(+e),t=0|u(1),u(0),2146435072==(2146435072&t)&&(o[922]=8)}(),+m[460]},Mathpack_Sin:function(e){return e=+e,m[460]=e,function(){var e=0,t=0;f(+(t=m[460])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+O(+t),m[460]=t,f(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[922]=8)}(),+m[460]},Mathpack_Cos:function(e){return e=+e,m[460]=e,function(){var e=0,t=0;f(+(t=m[460])),e=0|u(1),u(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+A(+t),m[460]=t,f(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[922]=8)}(),+m[460]},Mathpack_Tan:function(e){return e=+e,m[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=m[460])),e=0|u(1),u(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),m[460]=t,r=4,f(+t),e=0|u(1),u(0),2146435072!=(2146435072&e))||(o[922]=r)}(),+m[460]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,m[460]=e,he(),+m[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,i=0,a=0,s=0,l=0;m[460]=e;e:{if(f(+e),r=0|u(1),u(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;o[922]=1}m[460]=t;t:{if(f(+t),r=0|u(1),u(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;o[922]=1}return q(4),0}return le((0|n)<1?-1:1),ne(m[370]),oe(m[372]),m[460]}e:if((0|r)<=-1){f(+t),r=0|u(1),u(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else o[922]=1;i=m[370];break e}f(+(i=m[370])),r=0|u(1),n=0|u(0),a=-2147483648^r,c(0,0|n),c(1,0|a),s=+d(),l=i,i=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:l}else i=m[375];return Ne(t,e),he(),Z(i),m[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,a,s=0,c=0;return f(+(e=+e)),r=0|u(1),a=0|u(0),2146435072==(2146435072&r)?(o[922]=1,-1):(m[460]=e,s=3104,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3104,(0|n)>0||(c>>>0>=65536&&(o[921]=-2147483648^c),s=3104,!a&-2147483648==(0|r)||(i[1552]=45,s=3106))):(o[922]=1,s=3104)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var a;D=a=D-16|0,e=0|Ae[o[o[e>>2]+8>>2]](e),o[a+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;i[t>>1]=0}else ye(m[460],a+8|0,t,15),t=function(e,t,r,n,a,s){var u,c,d,f=0,p=0,m=0,g=0,v=0;D=c=D-16|0,u=(t<<1)+e|0,d=c+12|0;t:{r:{n:{i:if(!(m=(0|r)<5&(p=a?n:1)+3>>>0<8)){o:if(!((0|p)>(0|r))){if((0|(n=r+p|0))>=3){if((0|r)<5|(0|p)>-4)break i;if((n+-2|0)<(0|a))break o;break i}if((0|r)<5)break i}if(g=1,n=1,(0|r)<7)break n;n=r-(p+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,p))&&(n=r-((0|p)<(0|r)?(0|p)<1?2-p|0:1:0)|0)}n:{if((0|n)<(0|a)){f=1,a=0;i:if(!((0|t)<1)){o:{a:{if(!n){if(l[e>>1]>52)break a;break i}if((0|n)<1|(0|n)>=(0|t))break i;if(l[(n<<1)+e>>1]<=52)break o;for(;;){if(v=l[(f=((a=n+-1|0)<<1)+e|0)>>1]+1|0,i[f>>1]=v,58!=(65535&v))break o;if(n=a,!a)break}}i[e>>1]=49,a=1,f=p+1|0;break i}for(;(0|(a=n))>=2&&48==l[((n=a+-1|0)<<1)+e>>1];);f=p}if((-1^m)&(0|f)>(0|r)|g)break n;break r}if(f=p,!g)break r}if(o[d>>2]=32768,r=e+2|0,(0|a)<2||(n=r+(a<<1)|0)>>>0>=u>>>0?n=r:(a=a+-1|0,o[d>>2]=32768|a,e=e+4|0,(t<<1)-4>>1>>>0<a>>>0&&b(),x(e,r,a<<1),i[r>>1]=s),n>>>0<u>>>0&&(i[n>>1]=69,n=n+2|0),n>>>0>=u>>>0?a=n:(a=n+2|0,(0|f)<=0?(i[n>>1]=45,f=1-f|0):(i[n>>1]=43,f=f+-1|0)),(0|f)<100|a>>>0>=u>>>0||(e=(f>>>0)/100|0,i[a>>1]=e+48,f=f-h(e,100)|0,a=a+2|0),a>>>0<u>>>0&&(i[a>>1]=48+((0|f)/10|0),a=a+2|0),a>>>0>=u>>>0)break t;i[a>>1]=48+((0|f)%10|0),a=a+2|0;break t}if((0|a)<0|(0|a)>(0|f))if(r=a-f|0,o[d>>2]=r,(0|f)>=1){if(!((r=(n=((m=(r=(p=(0|f)>(0|t)?t:f)<<1)+e|0)+(a<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=u>>>0))for(;i[n>>1]=l[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=m>>>0;);(0|f)<(0|t)&&(i[m>>1]=s),a=m+(((0|(e=u-m>>1))>(0|(t=a-p|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(a<<1)|0)|0)>>>0>=u>>>0||(a=((a<<1)+e|0)-2|0)>>>0<e>>>0))for(;i[n>>1]=l[a>>1],n=n+-2|0,(a=a+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(i[e>>1]=48,e=e+2|0),e>>>0<u>>>0&&(i[e>>1]=s,e=e+2|0),n=u-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(a=0;i[(a<<1)+e>>1]=48,(0|t)!=(0|(a=a+1|0)););a=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-a|0)for(t=(a<<1)+e|0,a=0;i[t+(a<<1)>>1]=48,(0|r)!=(0|(a=a+1|0)););a=(n<<1)+e|0}}return D=c+16|0,a}(t,r,n,i[a+8>>1],i[a+10>>1],e);return D=a+16|0,t}(o[256],c,3614-c>>1,(0|t)>0?t:0),o[920]=0,o[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return o[924]},Mathpack_FormatGetSign:function(){return o[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,a=0,s=0;return D=n=D+-64|0,f(+(e=+e)),a=0|u(1),u(0),2146435072!=(2146435072&a)?(o[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,ye(e,n+56|0,n+16|0,(a=t+r|0)>>>0<15?a:15),s=i[n+56>>1],a=i[n+58>>1],o[n+8>>2]=a,t=t+s|0,o[n+12>>2]=t,(0|(t=t+r|0))<(0|a)&&(X(n+16|0,n+12|0,n+8|0,t),a=o[n+8>>2]),a?((0|(r=r+(t=o[n+12>>2])|0))<(0|a)&&(o[n+8>>2]=r,a=r),(0|a)>-1||(o[922]=1)):(a=0,o[n+12>>2]=0,t=0),o[924]=t,o[925]=l[n+48>>1]>>>15^1,r=a,a>>>0>=256&&(b(),r=o[n+8>>2]),x(3104,n+16|0,a<<1)):(o[922]=1,r=-1),D=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,a=0,s=0,c=0;if(D=n=D+-64|0,f(+(e=+e)),s=0|u(1),u(0),2146435072!=(2146435072&s)){if(o[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,ye(e,n+56|0,n+16|0,15),c=i[n+56>>1],o[n+12>>2]=c,s=i[n+58>>1],o[n+8>>2]=s,(0|(a=t))>=2&&(a=(0|c)%(0|t)|0,a=((0|c)<1?t:a?0:t)+a|0),!((0|(a=r+a|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,a),a=(0|a)<(0|(s=o[n+8>>2]))?a:s;s=a,(0|a)>=1&&48==l[(n+16|0)+((a=s+-1|0)<<1)>>1];);o[n+8>>2]=s,(0|t)<2||(0|(a=o[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|a)%(0|t)|0)|0)+((0|a)<1?t:r?0:t)|0)>=(0|s)||(b(),s=o[n+8>>2]))}(0|s)<=-1&&(o[922]=1),o[924]=o[n+12>>2],o[925]=l[n+48>>1]>>>15^1,(a=s)>>>0>=256&&(b(),a=o[n+8>>2]),x(3104,n+16|0,s<<1)}else o[922]=1,a=-1;return D=n- -64|0,0|a},Mathpack_Pack:function(e,t,r){var a;return e|=0,t|=0,r|=0,D=a=D-48|0,n[a+39|0]=0,x(a+8|0,3104,(r=(0|r)<15?r:15)<<1),i[a+40>>1]=t+16384&32767|!e<<15,n[a+38|0]=r,o[a>>2]=0,o[a+4>>2]=0,Se(o[256],a,a+8|0)&&(o[922]=1),D=a+48|0,+m[a>>3]},_start:L,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,o[926]||(o[927]=t,o[926]=e)},stackSave:function(){return 0|D},stackAlloc:function(e){return D=e=D-(e|=0)&-16,0|e},stackRestore:function(e){D=e|=0},__growWasmMemory:function(e){return 0,0|b()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:i.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:i.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:i.Base_LocaleDecimalSeparator,Math_log10:i.Math_log10,Math_log:i.Math_log,Math_sqrt:i.Math_sqrt,Math_sin:i.Math_sin,Math_cos:i.Math_cos,Math_tan:i.Math_tan,Math_atan:i.Math_atan,Math_exp:i.Math_exp,proc_exit:o.proc_exit},m),v=g.memory;t.memory=v;var S=g.Base_StrBuf;t.Base_StrBuf=S;var y=g.Base_StrBufSize;t.Base_StrBufSize=y;var C=g.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=C;var R=g.Dtr_FromNum;t.Dtr_FromNum=R;var b=g.Dtr_Yr;t.Dtr_Yr=b;var N=g.Dtr_Mon;t.Dtr_Mon=N;var T=g.Dtr_DOM;t.Dtr_DOM=T;var P=g.Dtr_Hour;t.Dtr_Hour=P;var E=g.Dtr_Min;t.Dtr_Min=E;var k=g.Dtr_Sec;t.Dtr_Sec=k;var O=g.Dtr_Wdy;t.Dtr_Wdy=O;var A=g.Dtr_FracSec;t.Dtr_FracSec=A;var I=g.Dtr_Rounding;t.Dtr_Rounding=I;var _=g.Dtr_Write;t.Dtr_Write=_;var F=g.Dtr_ToNum;t.Dtr_ToNum=F;var M=g.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=M;var D=g.Dtr_Days;t.Dtr_Days=D;var w=g.Dtr_ToDays;t.Dtr_ToDays=w;var L=g.Dtr_ToTime;t.Dtr_ToTime=L;var x=g.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var B=g.Mathpack_Zero;t.Mathpack_Zero=B;var U=g.Mathpack_One;t.Mathpack_One=U;var G=g.Mathpack_Pi;t.Mathpack_Pi=G;var K=g.Mathpack_Div;t.Mathpack_Div=K;var V=g.Mathpack_Mul;t.Mathpack_Mul=V;var j=g.Mathpack_Sub;t.Mathpack_Sub=j;var W=g.Mathpack_Add;t.Mathpack_Add=W;var H=g.Mathpack_Power;t.Mathpack_Power=H;var Q=g.Mathpack_Cond;t.Mathpack_Cond=Q;var q=g.Mathpack_Cond2;t.Mathpack_Cond2=q;var z=g.Mathpack_TakeMathError;t.Mathpack_TakeMathError=z;var Y=g.Mathpack_Trunc;t.Mathpack_Trunc=Y;var J=g.Mathpack_Ceil;t.Mathpack_Ceil=J;var X=g.Mathpack_Floor;t.Mathpack_Floor=X;var $=g.Mathpack_Abs;t.Mathpack_Abs=$;var Z=g.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=g.Mathpack_Float;t.Mathpack_Float=ee;var te=g.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=g.Mathpack_Fix;t.Mathpack_Fix=re;var ne=g.Mathpack_LFix;t.Mathpack_LFix=ne;var ie=g.Mathpack_SFix;t.Mathpack_SFix=ie;var oe=g.Mathpack_Round;t.Mathpack_Round=oe;var ae=g.Mathpack_RoundUp;t.Mathpack_RoundUp=ae;var se=g.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var le=g.Mathpack_TenTo;t.Mathpack_TenTo=le;var ue=g.Mathpack_Compare;t.Mathpack_Compare=ue;var ce=g.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=g.Mathpack_Equal;t.Mathpack_Equal=de;var fe=g.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var pe=g.Mathpack_Sqrt;t.Mathpack_Sqrt=pe;var me=g.Mathpack_Exp;t.Mathpack_Exp=me;var he=g.Mathpack_Ln;t.Mathpack_Ln=he;var ge=g.Mathpack_Log;t.Mathpack_Log=ge;var ve=g.Mathpack_Sin;t.Mathpack_Sin=ve;var Se=g.Mathpack_Cos;t.Mathpack_Cos=Se;var ye=g.Mathpack_Tan;t.Mathpack_Tan=ye;var Ce=g.Mathpack_Asin;t.Mathpack_Asin=Ce;var Re=g.Mathpack_Acos;t.Mathpack_Acos=Re;var be=g.Mathpack_Atan;t.Mathpack_Atan=be;var Ne=g.Mathpack_Atan2;t.Mathpack_Atan2=Ne;var Te=g.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Te;var Pe=g.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Pe;var Ee=g.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Ee;var ke=g.Mathpack_FormatFixed;t.Mathpack_FormatFixed=ke;var Oe=g.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Oe;var Ae=g.Mathpack_Pack;t.Mathpack_Pack=Ae;var Ie=g._start;t._start=Ie;var _e=g.__errno_location;t.__errno_location=_e;var Fe=g.setThrew;t.setThrew=Fe;var Me=g.stackSave;t.stackSave=Me;var De=g.stackAlloc;t.stackAlloc=De;var we=g.stackRestore;t.stackRestore=we;var Le=g.__growWasmMemory;t.__growWasmMemory=Le},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(1);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.wrapPosition=n.cellParse.wrapPosition},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.insertCommas=t.convertNumberShape=t.convertDigitsShape=void 0;var o=r(34),a=r(43),s=r(110),l=r(83),u=r(42),c=r(32),d=l.codePointDigitZero,f=l.codePointDigitNine,p=l.codePointDigitOne,m=((n={})[u.NumberShape.ArabicIndic]={zero:1632,one:1633},n[u.NumberShape.ExtendedArabicIndic]={zero:1776,one:1777},n[u.NumberShape.Devanagari]={zero:2406,one:2407},n[u.NumberShape.Bengali]={zero:2534,one:2535},n[u.NumberShape.Gurmukhi]={zero:2662,one:2663},n[u.NumberShape.Gujarati]={zero:2790,one:2791},n[u.NumberShape.Oriya]={zero:2918,one:2919},n[u.NumberShape.Tamil]={zero:48,one:3047},n[u.NumberShape.Telugu]={zero:3174,one:3175},n[u.NumberShape.Kannada]={zero:3302,one:3303},n[u.NumberShape.Malayalam]={zero:3430,one:3431},n[u.NumberShape.Thai]={zero:3664,one:3665},n[u.NumberShape.Lao]={zero:3792,one:3793},n[u.NumberShape.Tibetan]={zero:3872,one:3873},n[u.NumberShape.Myanmar]={zero:4160,one:4161},n[u.NumberShape.Ethiopic]={zero:48,one:4969},n[u.NumberShape.Khmer]={zero:6112,one:6113},n[u.NumberShape.Mongolian]={zero:6160,one:6161},n),h=((i={})[u.NumberShape.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[u.NumberShape.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},i[u.NumberShape.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[u.NumberShape.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[u.NumberShape.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},i[u.NumberShape.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[u.NumberShape.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},i[u.NumberShape.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},i[u.NumberShape.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},i[u.NumberShape.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},i[u.NumberShape.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},i[u.NumberShape.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},i[u.NumberShape.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},i);function g(e,t){if(t===u.NumberShape.ASCII)return e;switch(t){case u.NumberShape.ArabicIndic:case u.NumberShape.ExtendedArabicIndic:case u.NumberShape.Devanagari:case u.NumberShape.Bengali:case u.NumberShape.Gurmukhi:case u.NumberShape.Gujarati:case u.NumberShape.Oriya:case u.NumberShape.Tamil:case u.NumberShape.Telugu:case u.NumberShape.Kannada:case u.NumberShape.Malayalam:case u.NumberShape.Thai:case u.NumberShape.Lao:case u.NumberShape.Tibetan:case u.NumberShape.Myanmar:case u.NumberShape.Ethiopic:case u.NumberShape.Khmer:case u.NumberShape.Mongolian:for(var r="",n=m[t],i=0;i<e.length;i+=1){var o=e.charCodeAt(i);(0,a.assertTrue)("calc.numfmt.convertDigitsShape",d<=o&&o<=f),r+=o===d?(0,s.stringFromCodePoint)(n.zero):(0,s.stringFromCodePoint)(n.one+(o-p))}return r;case u.NumberShape.ChineseTrad1:case u.NumberShape.ChineseTrad2:case u.NumberShape.ChineseTrad3:case u.NumberShape.ChineseSimp1:case u.NumberShape.ChineseSimp2:case u.NumberShape.ChineseSimp3:case u.NumberShape.Japanese1:case u.NumberShape.Japanese2:case u.NumberShape.Japanese3:case u.NumberShape.Korean1:case u.NumberShape.Korean2:case u.NumberShape.Korean3:case u.NumberShape.Korean4:for(r="",n=h[t],i=0;i<e.length;i+=1){o=e.charCodeAt(i);(0,a.assertTrue)("calc.numfmt.convertDigitsShape",d<=o&&o<=f),r+=(0,s.stringFromCodePoint)(n.digits[o-d])}return r}}t.convertDigitsShape=g,t.convertNumberShape=function(e,t,r){var n=e.decimalSeparator;if(r===u.NumberShape.ASCII)return(0,c.success)(t);switch(r){case u.NumberShape.ArabicIndic:case u.NumberShape.ExtendedArabicIndic:case u.NumberShape.Devanagari:case u.NumberShape.Bengali:case u.NumberShape.Gurmukhi:case u.NumberShape.Gujarati:case u.NumberShape.Oriya:case u.NumberShape.Tamil:case u.NumberShape.Telugu:case u.NumberShape.Kannada:case u.NumberShape.Malayalam:case u.NumberShape.Thai:case u.NumberShape.Lao:case u.NumberShape.Tibetan:case u.NumberShape.Myanmar:case u.NumberShape.Ethiopic:case u.NumberShape.Khmer:case u.NumberShape.Mongolian:var i=t.indexOf(n),s=g(t.substring(0,i<0?void 0:i),r),l=i<0?"":n,d=i<0?"":g(t.substring(i+n.length),r);return(0,c.success)(s+l+d);case u.NumberShape.ChineseTrad1:case u.NumberShape.ChineseTrad2:case u.NumberShape.ChineseTrad3:case u.NumberShape.ChineseSimp1:case u.NumberShape.ChineseSimp2:case u.NumberShape.ChineseSimp3:case u.NumberShape.Japanese1:case u.NumberShape.Japanese2:case u.NumberShape.Japanese3:case u.NumberShape.Korean1:case u.NumberShape.Korean2:case u.NumberShape.Korean3:case u.NumberShape.Korean4:return(0,c.failure)((0,o.notImplemented)(["convertNumberShape: ideographic shape ".concat(String(r))]));default:return(0,a.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";for(var n=(0,s.countCodePoints)(t,0,t.length),i="",o=0,a=0;o<t.length;){var l=(0,s.stringCodePointAt)(t,o),u=(0,s.numCodeUnits)(l);i+=t.substring(o,o+u),o+=u,a+=1,e.isThousandsPosition(r+(n-a))&&(i+=e.thousandsSeparator)}return i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(2);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(2);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(2);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(2);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;var n,i=r(125),o=r(187);!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(n||(n={}));var a=i.codePointTilde,s=i.codePointQuestionMark,l=i.codePointAsterisk,u=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];for(var n="",i=0;i<t.length;i+=1){var u=t.charCodeAt(i);if(u===a&&i+1<t.length){var c=(0,o.stringCodePointAt)(t,i+1);n+=(0,o.stringFromCodePoint)(c),i+=(0,o.numCodeUnits)(c)}else u!==a&&(u!==s&&u!==l?n+=t.charAt(i):(this.pushBlock(n),n="",this.pushMeta(u)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(l)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(n.OP_DOT)}},e.prototype.pushMeta=function(e){e===s?this.bytecode.push(n.OP_DOT):this.bytecode.push(n.OP_DOTSTAR)},e.prototype.test=function(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var i=Object.keys(t);if(t=Object.create(null),0===i.length)return!1;for(var o=0;o<i.length;o+=1){var a=Number(i[o]);if(a!==this.bytecode.length){var s=this.bytecode[a];switch(s){case n.OP_DOT:this.addState(t,a+1);break;case n.OP_DOTSTAR:this.addState(t,a);break;default:var l=this.blocks[s];r+l.length<=e.length&&0===this.localeInfo.stringCompareCI(l,e.substring(r,r+l.length))&&this.addState(t,a+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,i=t;i<r.length&&r[i]===n.OP_DOTSTAR;i+=1)e[i+1]=!0},e.prototype.testSimple=function(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))},e}();t.WildExp=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(2);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var n=r(131);function i(e){return e}function o(e,r){if("string"==typeof r&&null!=a[r])return e;var n=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),i=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===i&&(i=s[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==i?i(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(o(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: ".concat(String(JSON.stringify(e)),">");var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error ".concat(r,">"):"<error ".concat(t,": ").concat(r,">")}};var a={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:i,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol ".concat(String(e),">")},undefined:i,null:i,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function ".concat(t,">"):"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=o(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(o):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};var l=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),u=/[0-9]/g,c=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(u,"d").replace(l,"w")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var n=r(90),i=r(131);Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return i.mathLog2}}),t.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.stringStartsWith=function(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t},t.stringEndsWith=function(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t},t.repeat=function(e,t){return Array(t+1).join(e)},t.arrayFill=function(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);var t=e,r=String(t.name),i=String(t.message);if(null!=t.stack){var o=String(t.stack);return o.indexOf(i)>=0&&o.indexOf(r)>=0?o:"".concat(r,": ").concat(i,"\n").concat(o)}return i.indexOf(r)>=0?i:"".concat(r,": ").concat(i)},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message="".concat(t," ").concat(String(r.message)),r},t.values=function(e){var t=[];for(var r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(132),i={};function o(){return void 0===n.globalThis.__get_feature_gate_dictionary_variable?i:n.globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var i=parseFloat(n);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var i=parseInt(n,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(132);function i(){return void 0===n.globalThis.__get_change_gate_dictionary_variable?{}:n.globalThis.__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=i,t.isChangeGateEnabled=function(e){var t;return null===(t=i()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=void 0;var n=r(29);function i(e){return(0,n.isDefined)(e)&&"function"==typeof e.then}t.promiseFinally=function(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))},t.newPromise=function(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]},t.promiseLoop=function(e,t){var r;return new Promise((function(n,i){Promise.resolve(t).then((function t(o){if(void 0!==o){r=o;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))},t.isThenable=i,t.bindMaybeThenable=function(e,t,r){return i(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e}},function(e,t,r){"use strict";var n,i;function o(e){return{kind:n.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(n=t.ResultKind||(t.ResultKind={})),t.success=o,t.successUndefined=o(void 0),t.failure=function(e){return{kind:n.Failure,reason:e}},t.isSuccess=function(e){return e.kind===n.Success},function(e){e.JavaScriptError="JavaScriptError"}(i=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(e){return{kind:i.JavaScriptError,error:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;var n=r(47);!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PYO=668]="PYO",e[e.TESTFUNCTIONBEGIN=669]="TESTFUNCTIONBEGIN",e[e.GRF=670]="GRF",e[e.RICHERROR=671]="RICHERROR",e[e.COUNTER=672]="COUNTER",e[e.BROKENRECORD=673]="BROKENRECORD",e[e.STREAM=674]="STREAM",e[e.GETRICHERRORS=675]="GETRICHERRORS",e[e.DBGSTAT=676]="DBGSTAT",e[e.RICHNUMBER=677]="RICHNUMBER",e[e.RICHERNUMBER=678]="RICHERNUMBER",e[e.DBGWRITE=679]="DBGWRITE",e[e.TEST=680]="TEST",e[e.AAC=681]="AAC",e[e.AWC=682]="AWC",e[e.WEBADDRESS_IMAGETEST=683]="WEBADDRESS_IMAGETEST",e[e.PARSEDEXPRESSION=684]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=685]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=686]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=687]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=688]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=689]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=690]="ARRAYVALUE",e[e.RECORD=691]="RECORD",e[e.STR_PYTHON=692]="STR_PYTHON",e[e.TYPE_PYTHON=693]="TYPE_PYTHON",e[e.DISPLAYSTRING_GENERALTEST=694]="DISPLAYSTRING_GENERALTEST",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(t.WorksheetFuncId||(t.WorksheetFuncId={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[683,"WEBADDRESS_IMAGETEST"],[685,"AGE_CONTACTTEST"],[686,"FIRSTNAME_CONTACTTEST"],[687,"FULLNAME_CONTACTTEST"],[688,"LASTNAME_CONTACTTEST"],[689,"TRANSLATENAME_CONTACTTEST"],[692,"STR_PYTHON"],[693,"TYPE_PYTHON"],[694,"DISPLAYSTRING_GENERALTEST"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]);var i=[];t.worksheetFuncTypes=[[1,255,i,[57],i,1,0,16],[1,3,[36,831,831],i,i,823,0,0],[1,1,[15],i,i,4,0,0],[1,1,[15],i,i,4,0,0],[1,255,i,[305],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[0,1,[16],i,i,33,0,0],[0,1,[16],i,i,33,0,0],[0,0,i,i,i,3,0,16],[2,255,[1],[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,2,[1,1],i,i,2,0,0],[1,3,[1,65,4],i,i,2,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,3,[263,48,48],i,i,263,0,0],[2,4,[48,1,1,1],i,i,311,0,0],[2,2,[2,1],i,i,2,0,0],[3,3,[2,1,1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[7],i,i,1,0,0],[0,0,i,i,i,4,0,16],[0,0,i,i,i,4,0,16],[1,255,i,[52],i,4,0,16],[1,255,i,[52],i,4,0,16],[1,1,[4],i,i,4,0,16],[2,2,[1,1],i,i,1,0,0],[3,3,[16,83,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,255,i,[49],i,1,0,16],[3,3,[16,19,18],i,i,1,0,0],[2,2,[263,2],i,i,2,0,0],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,1,[16],i,i,512,0,2],[0,1,[4],i,i,512,0,2],[0,1,[575],i,i,512,0,2],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,6,[1,1,1,1,1,1],i,i,1,0,0],[3,3,[48,1,1],i,i,1,0,16],[1,2,[48,1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[2,3,[263,305,17],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[1,1,[16],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[3,5,[16,65,65,65,65],i,i,16,16383,0],[2,2,[2,16],i,i,16,0,2],[2,2,[16,16],i,i,2,0,2],[0,3,[66,81,16],i,i,4,0,2],[2,3,[2,2,1],i,i,1,0,0],[1,1,[39],i,i,32,0,0],[0,2,[1,24],i,i,4,0,2],[0,0,i,i,i,4,0,2],[1,1,[303],i,i,1,0,0],[0,1,[4],i,i,4,0,2],[1,2,[2,63],i,i,4,0,2],[0,0,i,i,i,50,0,2],[1,1,[16],i,i,47,0,2],[0,2,[65,66],i,i,32,0,2],[4,5,[87,117,117,1,117],i,i,4,0,0],[0,2,[1,66],i,i,32,0,2],[0,0,i,i,i,16,0,2],[0,0,i,i,i,16,0,2],[0,1,[1],i,i,4,0,2],[2,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[33],[831],i,823,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[0,2,[66,65],i,i,32,0,2],[1,7,[2,65,66,67,65,65,2],i,i,575,0,2],[1,1,[63],i,i,4,0,0],[1,1,[18],i,i,2,0,2],[1,2,[2,4],i,i,6,0,2],[2,2,[16,47],i,i,4,0,2],[1,2,[1,1],i,i,1,0,0],[1,4,[2,1,4,4],i,i,7,0,2],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[1,2,[2,9],i,i,2,0,0],[1,2,[2,9],i,i,2,0,0],[2,2,[258,258],i,i,4,0,0],[1,1,[2],i,i,2,0,0],[4,4,[2,1,1,2],i,i,2,0,0],[3,4,[2,2,2,2],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[0,3,[66,65,66],i,i,32,0,2],[0,1,[2],i,i,2,0,2],[2,3,[2,2,1],i,i,1,0,0],[1,2,[2,16],i,i,303,16383,0],[1,1,[15],i,i,4,0,0],[1,1,[143],i,i,4,0,0],[1,1,[143],i,i,4,0,0],[1,1,[143],i,i,4,0,0],[1,1,[23],i,i,2,0,0],[1,1,[23],i,i,1,0,0],[1,2,[2,1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,2,0,2],[2,2,[1,1],i,i,2,0,2],[2,2,[1,2],i,i,1,0,2],[2,2,[1,2],i,i,1,0,2],[1,2,[1,1],i,i,1,0,2],[1,1,[3],i,i,1,0,0],[1,1,[3],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[4,5,[1,1,1,1,1],i,i,1,0,0],[1,3,[2,66,65],i,i,2,0,2],[1,2,[16,4],i,i,2,0,2],[1,2,[2,4],i,i,16,0,2],[1,2,[2,4],i,i,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],i,3,0,2],[1,255,[3],[127],i,575,0,2],[0,1,[3],i,i,1,0,2],[2,4,[3,115,83,3],i,i,1,0,2],[3,5,[3,83,115,83,3],i,i,1,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,3,3],i,i,4,0,2],[0,1,[3],i,i,4,0,2],[2,3,[3,3,3],i,i,4,0,2],[3,4,[3,3,3,3],i,i,4,0,2],[1,3,[1,67,66],i,i,1,0,2],[1,1,[52],i,i,36,0,2],[1,1,[2],i,i,2,0,0],[1,1,[32],i,i,1,0,0],[1,1,[32],i,i,32,0,0],[2,2,[32,32],i,i,32,0,0],[0,2,[2,2],i,i,32,0,2],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[1,255,i,[121],i,1,0,16],[0,2,[1,16],i,i,4,0,2],[3,4,[2,1,1,1],i,i,512,0,2],[1,1,[4],i,i,512,0,2],[0,0,i,i,i,512,0,2],[0,0,i,i,i,512,0,2],[2,2,[2,2],i,i,1,0,2],[2,2,[1,2],i,i,32,0,2],[3,3,[1,18,18],i,i,4,0,2],[2,2,[1,2],i,i,4,0,2],[1,1,[1],i,i,4,0,2],[0,1,[1],i,i,512,0,2],[0,1,[2],i,i,4,0,2],[0,4,[3,3,3,3],i,i,3,0,2],[1,255,i,[113],i,1,0,16],[1,1,[1],i,i,1,0,0],[1,2,[1,16],i,i,47,0,2],[1,1,[1],i,i,47,0,2],[1,2,[1,2],i,i,47,0,2],[1,2,[1,2],i,i,63,0,2],[3,3,[16,19,18],i,i,1,0,0],[1,1,[143],i,i,4,0,0],[0,3,[82,65,65],i,i,2,0,2],[0,4,[66,82,17,17],i,i,1,0,2],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[143],i,i,4,0,0],[3,3,[16,83,18],i,i,1,0,0],[1,1,[3],i,i,4,0,2],[1,1,[3],i,i,4,0,2],void 0,void 0,[1,2,[1,1],i,i,2,0,32],[2,3,[2,2,1],i,i,1,0,32],[2,3,[2,2,1],i,i,1,0,32],[4,4,[2,1,1,2],i,i,2,0,32],[1,2,[2,9],i,i,2,0,32],[1,2,[2,9],i,i,2,0,32],[3,3,[2,1,1],i,i,2,0,32],[1,1,[2],i,i,1,0,32],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,1,[2],i,i,2,0,32],[1,1,[2],i,i,2,0,32],[2,3,[1,16,4],i,i,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],i,i,2,0,0],[2,3,[1,1,4],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[5,7,[1,1,1,1,1,1,4],i,i,1,0,0],[0,0,i,i,i,512,0,2],[1,1,[12],i,i,512,0,2],[0,0,i,i,i,512,0,2],[1,3,[2,82,84],i,i,512,0,2],[1,255,i,[49],i,1,0,16],[1,255,i,[32],i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[16,19,18],i,i,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],i,i,2,0,2],[0,1,[4],i,i,4,0,2],[0,0,i,i,i,16,0,2],[0,2,[2,2],i,i,4,0,2],[0,3,[2,2,2],i,i,4,0,2],[2,5,[2,23,23,23,23],i,i,2,0,2],[2,4,[2,1,1,2],i,i,1,0,2],[1,4,[2,66,65,65],i,i,1,0,2],[1,1,[2],i,i,3,16383,0],[0,0,i,i,i,2,0,2],[1,5,[1,2,1,1,1],i,i,47,0,2],[4,5,[1,1,1,1,1],i,i,1,0,0],[0,1,[4],i,i,512,0,2],void 0,void 0,[0,1,[1],i,i,512,0,2],[2,2,[48,48],i,i,32,0,16],[0,2,[66,96],i,i,2,0,2],[1,1,[2],i,i,4,0,2],[1,255,[17],[127],i,575,0,32],[1,1,[3],i,i,4,0,2],[1,1,[2],i,i,63,0,2],[1,2,[1,3],i,i,47,0,2],[1,3,[1,3,1],i,i,47,0,2],[1,3,[2,66,4],i,i,4,0,2],[1,1,[15],i,i,1,0,0],[0,1,[2],i,i,4,0,2],[0,1,[2],i,i,4,0,2],[0,2,[99,66],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[2,3,[2,3,66],i,i,1,0,2],[1,2,[1,2],i,i,35,0,2],[1,255,i,[49],i,1,0,16],[3,5,[1,1,1,65,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[3,4,[32,32,1,65],i,i,1,0,0],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[2,3,[49,1,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,3,[49,1,65],i,i,1,0,16],[1,255,i,[32],i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[1,1],i,i,1,0,0],void 0,[3,4,[2,1,1,1],i,i,1,0,34],[2,3,[2,1,1],i,i,1,0,34],[1,255,i,[2],i,2,0,0],[2,2,[1,1],i,i,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],i,i,2,0,2],[1,2,[1,2],i,i,35,0,2],[1,3,[1,66,2],i,i,35,0,2],[1,4,[1,66,66,2],i,i,7,0,2],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[1],[16],i,1,0,0],[2,3,[16,15,16],i,i,1,0,0],[2,2,[16,15],i,i,1,0,0],[1,1,[16],i,i,1,0,0],[1,2,[1,2],i,i,19,0,2],[1,1,[33],i,i,33,0,2],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,2],i,i,1,0,32],[1,1,[1],i,i,2,0,32],[2,2,[1,1],i,i,2,0,32],[1,2,[1,5],i,i,2,0,0],[0,4,[66,66,66,65],i,i,6,0,2],[0,5,[66,66,66,66,65],i,i,6,0,2],[1,2,[1,2],i,i,19,0,2],[2,255,[18,18],[2,79],i,15,0,0],[1,2,[2,39],i,i,39,0,0],[1,1,[16],i,i,2,0,32],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,1,[1],i,i,2,0,0],[1,1,[1],i,i,2,0,32],[1,1,[3],i,i,2,0,32],[1,1,[1],i,i,2,0,32],[1,1,[1],i,i,2,0,32],[1,1,[1],i,i,2,0,32],[1,1,[2],i,i,1,0,32],[1,1,[2],i,i,4,0,32],[1,1,[1],i,i,1,0,32],[1,1,[1],i,i,1,0,32],[1,1,[1],i,i,1,0,32],[3,255,i,[2],i,2,0,0],[1,255,[2],[50],i,15,0,0],[2,3,[2,50,2],i,i,10,0,0],[3,3,[2,2,2],i,i,15,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[4,4,[95,95,95,127],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[127,127,95],i,i,9,0,0],[3,3,[95,127,127],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,16383,0],[1,2,[95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,32],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[2,2,[95,127],i,i,9,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[2,5,[2,50,2,1,2],i,i,10,0,0],[1,1,[2],i,i,9,0,0],[2,2,[47,575],i,i,303,0,0],[2,255,i,[16,15],i,1,0,0],[3,255,[16],[16,15],i,1,0,0],[2,3,[16,15,16],i,i,1,0,0],[3,255,[16],[16,15],i,1,0,0],[3,254,[1,1,48,17],[16],i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,254,i,[32],i,32,0,16],[1,254,i,[32],i,1,0,16],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,3,[49,1,65],i,i,1,0,16],[2,3,[49,1,65],i,i,1,0,16],[3,3,[1,1,4],i,i,1,0,0],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,3,[1,16,4],i,i,1,0,16],[2,3,[1,16,4],i,i,1,0,16],[1,254,i,[49],i,1,0,16],[1,254,i,[49],i,1,0,16],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[49],i,1,0,16],[1,254,i,[49],i,1,0,16],[4,4,[1,1,1,4],i,i,1,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,2,[1,1],i,i,1,0,32],[1,2,[1,65],i,i,1,0,32],void 0,[4,6,[1,1,1,4,65,65],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[5,5,[1,1,1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[2,3,[49,1,1],i,i,1,0,16],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,65],i,i,1,0,32],[1,2,[1,65],i,i,1,0,32],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[52],i,4,0,16],[3,3,[1,1,1],i,i,1,0,0],[2,3,[1,1,65],i,i,2,0,0],[2,2,[2,1],i,i,1,0,0],[2,2,[3,3],i,i,1,0,0],[3,4,[1,1,1,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,254,i,[49],i,1,0,16],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,32,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,3,[2,66,66],i,i,1,0,0],[0,1,[50],i,i,1,16383,16],[0,1,[48],i,i,1,16383,16],[1,1,[16],i,i,2,16383,0],[1,1,[16],i,i,4,0,0],[2,2,[47,575],i,i,303,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[2,2],i,i,47,0,0],[1,1,[2],i,i,10,0,0],[1,1,[2],i,i,10,0,0],[3,6,[1,48,48,65,65,65],i,i,1,0,0],[3,7,[1,48,48,65,65,65,65],i,i,1,0,0],[2,4,[48,48,65,65],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[3,6,[48,48,1,65,65,65],i,i,1,0,0],[3,254,[16],[16,15],i,1,0,0],[3,254,[16],[16,15],i,1,0,0],[3,254,[114,68],[114],i,2,0,16],[1,254,i,[114],i,2,0,16],[2,254,i,[44,575],i,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],i,i,1503,0,53],[2,254,i,[113,113],i,1,0,17],[1,1,[16],i,i,48,0,21],[2,3,[271,2,4],i,i,303,0,21],[2,2,[271,2],i,i,303,0,17],[2,3,[48,48,111],i,i,303,0,1],[1,4,[160,96,96,4],i,i,32,0,1],[1,3,[160,4,4],i,i,32,0,1],[2,2,[2,256],i,i,1,0,8],[3,3,[2,49,1],i,i,1,0,25],[3,3,[2,49,1],i,i,1,0,25],[2,254,[2],[49],i,1,0,25],[2,7,[34,2,65,65,65,74,68],i,i,1,0,1],[1,3,[2,65,65],i,i,2,0,1],[2,6,[2,34,65,65,65,74],i,i,2,0,1],[2,6,[2,34,65,65,65,74],i,i,2,0,1],[2,6,[2,98,98,68,65,495],i,i,32,0,1],[1,4,[32,96,96,4],i,i,32,0,9],[2,2,[4,16],i,i,32,0,25],[2,4,[391,48,65,65],i,i,1,0,1],[3,6,[391,48,48,511,65,65],i,i,319,0,1],[2,254,[160],[160,65],i,32,0,1],[0,5,[65,65,65,65,68],i,i,32,16383,1],[1,4,[65,65,65,65],i,i,32,0,1],[2,254,[258,1,65,65,65],[65],i,32,0,17],[2,3,[32,1,463],i,i,32,0,1],[1,254,i,[48],i,32,0,17],[1,254,i,[48],i,32,0,17],[2,254,[48],[33],i,32,0,1],[2,254,[48],[33],i,32,0,1],[3,254,i,[319,319],[319],319,0,1],[1,254,i,[319],i,319,0,1],[3,3,[65,65,319],i,i,32,0,1],[1,254,i,[319],i,319,0,1],[1,1,[271],i,i,4,0,1],[1,1,[271],i,i,9,0,1],[0,0,i,i,i,319,0,1],void 0,[1,2,[399,1],i,i,2,0,1],[1,2,[32,1],i,i,2,0,1],[2,2,[15,2],i,i,256,0,17],[1,3,[48,65,68],i,i,32,0,17],[1,3,[48,65,68],i,i,32,0,17],[2,3,[32,1,463],i,i,32,0,1],[2,254,[48],[319],i,32,0,1],[3,3,[511,48,271],i,i,319,0,1],[3,3,[511,48,271],i,i,32,0,1],[1,2,[48,271],i,i,32,0,1],[1,2,[48,271],i,i,32,0,1],[1,1,[1535],i,i,4,0,1],[2,4,[32,65,65,495],i,i,32,0,1],[2,3,[48,65,65],i,i,48,0,1],[2,3,[48,65,65],i,i,48,0,1],[1,254,[1,1],[48],i,303,0,17],void 0,[1,5,[2,66,65,65,65],i,i,264,0,1],[2,2,[15,2],i,i,271,0,17],[3,6,[48,32,96,65,65,96],i,i,32,0,1],[3,9,[48,48,32,96,65,65,96,65,96],i,i,32,0,1],[1,254,[1,1],[48],i,1087,0,17],[0,0,i,i,i,1,0,1],[1,2,[287,2],i,i,288,0,17],[1,2,[1,1],i,i,10,0,17],[0,0,i,i,i,1,0,1],[3,254,[47],[2,47],i,47,0,17],[0,1,[1],i,i,1,0,1],[0,1,[1],i,i,32,0,1],[1,2,[2,1],i,i,47,0,1],[1,1,[1],i,i,264,0,17],[1,1,[1],i,i,264,0,17],[2,2,[2,47],i,i,47,0,1],[1,254,[2],[1151],i,1087,0,16],[1,254,[1],[1151],i,1087,0,0],[1,254,[1],[1151],i,1087,0,0],[1,1,[256],i,i,258,0,17],[1,1,[16],i,i,32,0,1],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[2,2,[256,2],i,i,2,0,17],[1,1,[32],i,i,256,0,17],[3,254,[15],[2,47],i,303,0,17],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,i,[319,319],[319],319,0,1],[3,254,[15],[2,303],i,303,0,17]].map((function(e){return void 0===e?void 0:n.functionType.apply(void 0,e)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(30),i=r(18),o=r(24),a=r(143),s=r(78),l=r(58),u=r(59),c=n.sheetRows,d=c.toString(10).length,f=n.sheetCols,p=f.toString(26).length,m=f.toString(10).length,h=s.codePointCapitalA,g=s.codePointCapitalZ,v=s.codePointSmallA,S=s.codePointSmallZ,y=s.codePointPlusSign,C=s.codePointMinusSign,R=s.codePointColon;function b(e){return e>=v&&e<=S||e>=h&&e<=g}function N(e){return 1+(e>=v?e-v:e-h)}function T(e,t,r,n){return function(i,a,s,c,d){var f=function(e,t){return(0,l.stringStartsWith)(e,"$",t)?[o.PosKind.Abs,t+1]:[o.PosKind.Rel,t]}(s,c),p=f[0],m=f[1],h=e(i,r,s,m),g=h[0],v=h[1];if(v>m){if(g<1||g>t)return p===o.PosKind.Abs||(!0===n?"object"==typeof d&&d.kind===o.PosKind.Abs||d===O.A1BadDollar:(0,l.stringStartsWith)(s,"$",v))?[O.A1BadDollar,!0,v]:void 0;var S=p===o.PosKind.Rel?g-a:g;return[(0,o.pos)(p,S-1),p===o.PosKind.Abs,v]}return p!==o.PosKind.Abs||!0!==n&&v!==s.length&&i.isNumeral((0,u.stringCodePointAt)(s,v))?[void 0,!1,c]:[O.A1BadDollar,!0,v]}}function P(e,t,r){return L(e,t,r)-e}function E(e,t,r,n){return function(i,s,u,c){var d=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(c>=u.length||0!==i.stringCompareCI(d,u[c]))return[void 0,!1,c];var f=c+d.length,p=(0,a.parseUint)(i,n,u,f),m=p[0],h=p[1];if(h>f&&m>=1&&m<=r)return[(0,o.pos)(o.PosKind.Abs,m-1),!1,h];if((0,l.stringStartsWith)(u,i.rcLeftBracket,f)){if(f+=i.rcLeftBracket.length,(0,l.stringStartsWith)(u,i.rcRightBracket,f))return[(0,o.pos)(o.PosKind.Rel,P(s,0,r)),!0,f+i.rcRightBracket.length];var g=1,v=u.charCodeAt(f);v===y?f+=1:v===C&&(g=-1,f+=1);var S=(0,a.parseUint)(i,n,u,f),R=S[0],b=S[1];if(b>f&&R<r&&(0,l.stringStartsWith)(u,i.rcRightBracket,b))return[(0,o.pos)(o.PosKind.Rel,P(s,R*g,r)),!0,b+i.rcRightBracket.length]}return[O.RCNoNum,!1,c+d.length]}}function k(e,t,r,n,i,o,a){var s=n(e,t,o,a,void 0);if(null==s)return[void 0,void 0,a];var l=s[0],u=s[1],c=s[2];if(c>a){var d=i(e,r,o,c,l);if(null==d)return u?[l,void 0,c]:[void 0,void 0,a];var f=d[0],p=d[2];return p>c?[l,f,p]:[l,void 0,c]}var m=i(e,r,o,a,l);if(null==m)return[void 0,void 0,a];var h=m[0],g=m[2];return g>a?[void 0,h,g]:[void 0,void 0,a]}var O,A=T(a.parseUint,c,d,!0),I=T((function(e,t,r,n){return function(e,t,r){for(var n=0,o=r,a=(0,i.fastMin)(t.length,r+e);o<a;o+=1){var s=t.charCodeAt(o);if(!b(s))break;n=26*n+N(s)}return o===a&&o<t.length&&b(t.charCodeAt(o))?[0,r]:[n,o]}(t,r,n)}),f,p,!1),_=E(!1,!0,c,d),F=E(!1,!1,f,m),M=E(!0,!0,c,d),D=E(!0,!1,f,m);function w(e,t){return"object"!=typeof e&&"object"!=typeof t}function L(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(O=t.SpecialPos||(t.SpecialPos={})),t.isR1C1IdentStart=w,t.parseCellRef=function(e,t,r,n,i){var a=function(e,t,r,n,i){var a=k(e,r.col,r.row,I,A,n,i),s=a[0],l=a[1],c=a[2],d="object"==typeof l&&l.kind===o.PosKind.Abs||l===O.A1BadDollar||"object"==typeof s&&s.kind===o.PosKind.Abs||s===O.A1BadDollar;if(null!=l&&null!=s||d||(null!=l||null!=s)&&(i-1>=0&&n.charCodeAt(i-1)===R||c<n.length&&n.charCodeAt(c)===R)){if(c<n.length&&e.isIdentContinue((0,u.stringCodePointAt)(n,c)))return;if(t!==o.RefStyle.A1&&!d)return;return{refStyle:o.RefStyle.A1,row:l,col:s,i:c}}}(e,t,r,n,i);return void 0!==a?a:function(e,t,r,n,i){var a,s=r.col,l=r.row,c=!1,d=k(e,l,s,_,F,n,i),f=d[0],p=d[1],m=d[2];if(null!=f||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(c=!0,f=(a=k(e,l,s,M,D,n,i))[0],p=a[1],m=a[2]),(null!=f||null!=p)&&(m>=n.length||!w(f,p)||!e.isIdentContinue((0,u.stringCodePointAt)(n,m))))return{refStyle:o.RefStyle.R1C1,row:f,col:p,i:m,enLocale:c}}(e,0,r,n,i)},t.parseGridCellA1=function(e,t){var r=k(e,0,0,I,A,t,0),i=r[0],o=r[1],a=r[2];return"object"==typeof i&&"object"==typeof o&&a===t.length?(0,n.gridCell)(o.index,i.index):void 0},t.parseGridRangeA1=function(e,t){var r=k(e,0,0,I,A,t,0),o=r[0],a=r[1],s=r[2];if("object"==typeof o&&"object"==typeof a){if(s===t.length)return(0,n.gridCell)(a.index,o.index);if(t.charCodeAt(s)===R){var l=k(e,0,0,I,A,t,s+1),u=l[0],c=l[1],d=l[2];if("object"==typeof u&&"object"==typeof c&&d===t.length){var f=(0,i.fastMin)(a.index,c.index),p=(0,i.fastMin)(o.index,u.index);return(0,n.gridRange)(f,p,(0,i.fastMax)(a.index,c.index)+1-f,(0,i.fastMax)(o.index,u.index)+1-p)}}}},t.parseQualifier=function(e){var t=e.lastIndexOf("!");if(!(t<0||0===t||t===e.length-1)){var r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if((0,l.stringStartsWith)(r,"'")&&(0,l.stringEndsWith)(r,"'")){for(var i=[],o=1;o<r.length-1;++o){var a=r.charAt(o);if("'"===a){if(o+1>=r.length-1||"'"!==r.charAt(o+1))return;i.push(a),++o}else i.push(a)}return{qualifier:i.join(""),unqualified:n}}}},t.wrapPosition=L},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(t.CurrencyFormat||(t.CurrencyFormat={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(t.DateOrder||(t.DateOrder={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(t.NumberShape||(t.NumberShape={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(t.Calendar||(t.Calendar={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(t.KnownFormat||(t.KnownFormat={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=void 0;var n=r(0),i=r(18),o=r(18),a=r(25),s=r(77),l=r(24),u=r(37),c=r(37),d=r(30),f=r(30),p=r(57),m=r(79);function h(e){return(0,p.isSuccess)(e)&&(0,o.isNone)(e.value)?p.successUndefined:e}function g(e){return!(0,p.isSuccess)(e)||void 0===e.value}function v(e,t,r){var n=(0,s.resolvePosition)(e.row,t.row,f.sheetRows,r),i=(0,s.resolvePosition)(e.col,t.col,f.sheetCols,r);return void 0!==n&&void 0!==i?(0,f.gridCell)(n,i):void 0}function S(e,t){if(t.kind===l.CellRefKind.Error)return p.successUndefined;var r=e.originGridCell;if(!(0,p.isSuccess)(r))return r;var n=r.value,i=e.wrapCellReferences;switch(t.kind){case l.CellRefKind.Single:return(0,p.success)(v(n,t,i));case l.CellRefKind.Range:var o=v(n,t.ref1,i),u=v(n,t.ref2,i);return void 0!==o&&void 0!==u?(0,p.success)((0,c.gridCellRange)(o,u)):p.successUndefined;case l.CellRefKind.Row:var d=(0,s.resolvePosition)(n.row,t.row1,f.sheetRows,i),h=(0,s.resolvePosition)(n.row,t.row2,f.sheetRows,i);return void 0!==d&&void 0!==h?(0,p.success)((0,c.gridCellRange)((0,f.gridCell)(d,0),(0,f.gridCell)(h,f.sheetCols-1))):p.successUndefined;case l.CellRefKind.Col:var g=(0,s.resolvePosition)(n.col,t.col1,f.sheetCols,i),S=(0,s.resolvePosition)(n.col,t.col2,f.sheetCols,i);return void 0!==g&&void 0!==S?(0,p.success)((0,c.gridCellRange)((0,f.gridCell)(0,g),(0,f.gridCell)(f.sheetRows-1,S))):p.successUndefined;case l.CellRefKind.Bad:return(0,p.failure)((0,m.invalidCellRef)(m.InvalidCellRefReason.BadCellRef));default:return(0,a.assertNever)("calc.runtime.resolverService.resolveGridRef",t)}}t.resolveGridRef=S,t.createResolver=function(e){function t(t,r){if(void 0===r){var n=t.originSheet;return(0,p.isSuccess)(n)?[r,(0,p.success)(n.value.document)]:[r,n]}var i=e.getDocumentLoc(r.path,r.document);if(!(0,p.isSuccess)(i))return[r,i];if((0,o.isNone)(i.value))return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.UndefinedDocument))];var a=null==r.path?void 0:i.value.path,s=i.value.name;return[(0,l.documentQualifier)(s,a,r.isQuoted,r.label),(0,p.success)(i.value)]}function r(t,r){if(g(r))return[t,r];var n=h(e.getSheetIndex(r.value,t));if(!(0,p.isSuccess)(n))return[t,n];if((0,o.isNone)(n.value))return[t,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.UndefinedSheetName))];var i=e.getSheetName(r.value,n.value);return(0,p.isSuccess)(i)?[i.value,(0,p.success)((0,f.sheetIndex)(r.value,n.value))]:[t,i]}function s(e,n){var i=t(e,n.document),o=i[0],a=i[1],s=r(n.sheet,a),u=s[0],c=s[1];return[(0,l.sheetQualifier)(u,o,n.isQuoted,n.label),c]}function v(n,i){switch(i.kind){case l.QualifierKind.Error:return[i,p.successUndefined];case l.QualifierKind.Sheet:return s(n,i);case l.QualifierKind.SheetRange:return function(n,i){var o,a=t(n,i.document),s=a[0],u=a[1],d=r(i.sheet1,u),m=d[0],h=d[1],v=r(i.sheet2,u),S=v[0],y=v[1],C=m,R=S;if(g(u))o=u;else if(g(h))o=h;else if(g(y))o=y;else{if((0,c.isSheetIndexEqual)(h.value,y.value))return[(0,l.sheetQualifier)(C,s,i.isQuoted,i.label),(0,p.success)((0,f.sheetIndex)(u.value,h.value.index))];var b=e.getSheetRangeIndexes(h.value),N=e.getSheetRangeIndexes(y.value);(0,p.isSuccess)(b)?(0,p.isSuccess)(N)?N.value.position<b.value.position&&(C=S,R=m):o=N:o=b,o=(0,p.success)((0,f.sheetRange)(u.value,h.value.index,y.value.index))}return[(0,l.sheetRangeQualifier)(C,R,s,i.isQuoted,i.label),o]}(n,i);case l.QualifierKind.Document:return[i,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.SheetRangeName))];case l.QualifierKind.Bad:return[i,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.BadQualifier))];default:return(0,a.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",i)}}function y(e,t){var r,n,i,o,a=t.qualifier,s=t.ref,u=S(e,s);if(void 0===a||a.kind===l.QualifierKind.Relative){n=a;var c=e.originSheet;if((0,p.isSuccess)(c)){var d=c.value;i=void 0===d.index?(0,p.failure)((0,m.noOriginSheet)(d)):(0,p.success)(d)}else i=c}else n=(r=v(e,a))[0],i=r[1];return o=g(u)?u:g(i)?i:(0,p.success)((0,f.sheetGridCube)(i.value,u.value)),(0,m.resolvedCellRef)((0,l.cellRefNode)(s,n,t.label),o)}function C(r,n,i){var o,u,c,v=n.qualifier,S=n.parts,y=[];if(void 0===v||v.kind===l.QualifierKind.Relative){var C=r.originSheet;if(!(0,p.isSuccess)(C))return(0,m.resolvedName)(n,C,y);var R=C.value;if(i!==f.NameSource.StructRef){if(void 0===R.index)return(0,m.resolvedName)(n,(0,p.failure)((0,m.noOriginSheet)(R)),y);y.push((0,d.nameLoc)(R,S.asWhole));var b=h(e.getNameLoc(R,S.asWhole,i));if(!(0,p.isSuccess)(b))return(0,m.resolvedName)(n,b,y);if(b.value)return(0,m.resolvedName)((0,l.nameNode)((0,l.identNamePart)(b.value.name,S.canDenoteNamedObject,S.label,S.qualifiedLabel),v,n.label),b,y)}u=v,c=(0,p.success)((0,f.documentScope)(R.document))}else u=(o=function(e,r){switch(r.kind){case l.QualifierKind.Document:var n=t(e,r);return[d=n[0],g(h=n[1])?h:(0,p.success)((0,f.documentScope)(h.value))];case l.QualifierKind.Sheet:return s(e,r);case l.QualifierKind.SheetRange:return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.SheetRangeName))];case l.QualifierKind.Ident:var i=s(e,(0,l.sheetQualifier)(r.name,void 0)),o=i[0],u=i[1];if(!(0,p.isSuccess)(u)&&u.reason.kind!==m.ResolveReasonKind.InvalidQualifier)return[r,u];if((0,p.isSuccess)(u)&&void 0!==u.value)return[(0,l.identQualifier)(o.sheet,r.isQuoted,r.label),u];var c=t(e,(0,l.documentQualifier)(r.name)),d=c[0],h=c[1];return[(0,l.identQualifier)(d.document,r.isQuoted,r.label),g(h)?h:(0,p.success)((0,f.documentScope)(h.value))];case l.QualifierKind.Bad:return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.BadQualifier))];default:return(0,a.assertNever)("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,v))[0],c=o[1];var N,T=S;return g(c)?N=c:(y.push((0,d.nameLoc)(c.value,S.asWhole)),g(N=h(e.getNameLoc(c.value,S.asWhole,i)))||(T=(0,l.identNamePart)(N.value.name,S.canDenoteNamedObject,S.label,S.qualifiedLabel))),(0,m.resolvedName)((0,l.nameNode)(T,u,n.label),N,y)}function R(t,r,n){void 0===n&&(n=!1);var i=e.getStructRefColumn(t,r.name);if(!(0,p.isSuccess)(i))return{kind:l.StructRefKind.ColumnRef,innerRef:r,resolution:i};var a=i.value;if((0,o.isNone)(a))return{kind:l.StructRefKind.ColumnRef,innerRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.UndefinedColumnName))};var s=a.range.range;return n&&(s=(0,f.gridRange)(s.row-(a.hasHeadersRow?1:0),s.col,s.rows+(a.hasHeadersRow?1:0)+(a.hasTotalsRow?1:0),s.cols)),{kind:l.StructRefKind.ColumnRef,innerRef:(0,l.columnRef)(a.name,r.isBracketed,r.isClosed,r.label),resolution:(0,p.success)((0,f.sheetGridRange)(a.range.sheet,s))}}function b(t,r,n){if(n===l.SpecialRefId.ThisRow){if(!(0,p.isSuccess)(t.originGridCell))return t.originGridCell;var i=b(t,r,l.SpecialRefId.Data);if(g(i))return i;var o=i.value.range,a=t.originGridCell.value.row;return a<o.row||a>=o.row+o.rows?(0,p.failure)(m.emptyIntersection):(0,p.success)((0,f.sheetGridRange)(i.value.sheet,(0,f.gridRange)(a,o.col,1,o.cols)))}return h(e.getStructRefSpecialRef(r,n))}function N(e,t,r){switch(t.kind){case l.StructRefKind.ColumnRef:return R(e,t,r);case l.StructRefKind.MissingRef:return{kind:l.StructRefKind.MissingRef,innerRef:t,resolution:p.successUndefined}}}function T(e,t,r){var n;void 0===r&&(r=!1);var i,o,a=N(e,t.lhs,r),s=a.innerRef,u=a.resolution,d=N(e,t.rhs,r),h=d.innerRef,g=d.resolution,v=(0,l.rangeOpRef)(s,h,t.label);if(!(0,p.isSuccess)(u)&&u.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:u};if(!(0,p.isSuccess)(g)&&g.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:g};if(!(0,p.isSuccess)(u))return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:u};if(!(0,p.isSuccess)(g))return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:g};if(void 0!==u.value)i=u.value.sheet,o=(0,c.gridRangeJoinOpt)(u.value.range,null===(n=g.value)||void 0===n?void 0:n.range);else{if(void 0===g.value)return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};i=g.value.sheet,o=g.value.range}return{kind:l.StructRefKind.RangeOpRef,innerRef:v,resolution:(0,p.success)((0,f.sheetGridRange)(i,o))}}function P(r,n){var i,o,s,c,f,h,v,S=n.qualifier,y=n.parts,C=null!==(s=null===(o=r.config)||void 0===o?void 0:o.localeInfo)&&void 0!==s?s:e.config.localeInfo;if(void 0===S){var R=r.originSheet;if(!(0,p.isSuccess)(R))return(0,m.resolvedUserDefinedFunc)(n,R,[],y.asWhole);c=S,f=(0,p.success)(R.value.document)}else c=(i=function(e,r){switch(r.kind){case l.QualifierKind.Document:return t(e,r);case l.QualifierKind.Ident:var n=t(e,(0,l.documentQualifier)(r.name)),i=n[0],o=n[1];return[(0,l.identQualifier)(i.document,r.isQuoted,r.label),o];default:return(0,a.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,S))[0],f=i[1];var b=y.asWhole;if(g(f))v=f,h=[];else{b=(0,u.getUserDefinedFuncName)(C,y.asWhole);var N=e.getUserDefinedFuncLoc(f.value,b);h=[(0,d.userDefinedFuncLoc)(f.value,b)],v=(0,p.isSuccess)(N)?0!==N.value.length?N:p.successUndefined:N}return(0,m.resolvedUserDefinedFunc)((0,l.nameNode)((0,l.identNamePart)(y.asWhole,y.canDenoteNamedObject,y.label,y.qualifiedLabel),c,n.label),v,h,b)}return{resolveGridRef:S,resolveCellRef:y,resolveName:C,resolveStructRef:function(t,r){var n,i,a=r.lhs,s=r.rhs,u=a;if(void 0!==a){var d=C(t,a,f.NameSource.StructRef),h=d.node,v=d.resolution,S=d.precedents,y=v;if(!(0,p.isSuccess)(y))return(0,m.resolvedStructRef)(r,void 0,y,S);if((0,o.isNone)(y.value))return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.UndefinedTableName)),S);u=h,n=y.value,i=S}else{var N=t.originGridCell,P=t.originSheet;if(!(0,p.isSuccess)(N))return(0,m.resolvedStructRef)(r,void 0,N,[]);if(!(0,p.isSuccess)(P))return(0,m.resolvedStructRef)(r,void 0,P,[]);if(void 0===P.value.index)return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOriginSheet)),[]);y=e.getContainingTable((0,f.sheetGridCell)(P.value,N.value));if(!(0,p.isSuccess)(y))return(0,m.resolvedStructRef)(r,void 0,y,[]);if((0,o.isNone)(y.value))return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.MissingTableName)),[]);i=[n=y.value]}var E=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case l.StructRefKind.ColumnRef:var i=R(t,r.innerRef),o=i.innerRef,a=i.resolution;return{structRef:(0,l.structRef)(o,r.isClosed,r.label),resolution:a};case l.StructRefKind.RangeOpRef:var s=T(t,r.innerRef);o=s.innerRef,a=s.resolution;return{structRef:(0,l.structRef)(o,r.isClosed,r.label),resolution:a};case void 0:a=b(e,t,l.SpecialRefId.Data);return{structRef:r,resolution:a};case l.StructRefKind.SpecialRef:a=b(e,t,r.innerRef.id);return{structRef:r,resolution:a};case l.StructRefKind.CommaOpRef:var u=function(e,t,r){for(var n,i,o=r.refs.map((function(r){return function(e,t,r){switch(r.kind){case l.StructRefKind.ColumnRef:return R(t,r,!0);case l.StructRefKind.SpecialRef:return{kind:l.StructRefKind.SpecialRef,innerRef:r,resolution:b(e,t,r.id)};case l.StructRefKind.RangeOpRef:return T(t,r,!0);case l.StructRefKind.MissingRef:return{kind:l.StructRefKind.MissingRef,innerRef:r,resolution:p.successUndefined};case l.StructRefKind.BadRef:return{kind:l.StructRefKind.BadRef,innerRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}}(e,t,r)})),a=(0,l.commaOpRef)(o.map((function(e){return e.innerRef})),r.label),s=0,u=o;s<u.length;s++){var d=u[s].resolution;if(!(0,p.isSuccess)(d)&&d.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{commaOpRef:a,resolution:d}}for(var h,g,v=[],S=0,y=o;S<y.length;S++){var C=y[S];if(!(0,p.isSuccess)(C.resolution)||C.kind===l.StructRefKind.BadRef)return{commaOpRef:a,resolution:C.resolution};v.push((C.kind===l.StructRefKind.SpecialRef||(C.kind,l.StructRefKind.MissingRef),{kind:C.kind,resolution:C.resolution}))}if(!(0,c.isCommaOpRefWellFormed)(r))return{commaOpRef:a,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};for(var N=0,P=v;N<P.length;N++){(C=P[N]).kind===l.StructRefKind.SpecialRef&&(h=(0,c.gridRangeJoinOpt)(h,null===(n=C.resolution.value)||void 0===n?void 0:n.range),void 0===g&&(g=null===(i=C.resolution.value)||void 0===i?void 0:i.sheet))}if(void 0===h||void 0===g)return{commaOpRef:a,resolution:p.successUndefined};for(var E=0,k=v;E<k.length;E++){if((C=k[E]).kind!==l.StructRefKind.SpecialRef&&(C.kind!==l.StructRefKind.MissingRef&&void 0===(h=(0,c.gridRangeIsect)(h,C.resolution.value.range))))return{commaOpRef:a,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}return{commaOpRef:a,resolution:(0,p.success)((0,f.sheetGridRange)(g,h))}}(e,t,r.innerRef);o=u.commaOpRef,a=u.resolution;return{structRef:(0,l.structRef)(o,r.isClosed,r.label),resolution:a};case l.StructRefKind.ThisRowOpRef:var d=b(e,t,l.SpecialRefId.ThisRow);if(g(d)||void 0===r.innerRef.ref)return{structRef:r,resolution:d};var h=r.innerRef.ref.kind===l.StructRefKind.ColumnRef?R(t,r.innerRef.ref):T(t,r.innerRef.ref),v=(o=h.innerRef,h.resolution),S=(0,l.thisRowOpRef)(o,o.label);if(g(v))return{structRef:(0,l.structRef)(S,r.isClosed,r.label),resolution:v};var y=(0,c.gridRangeIsect)(d.value.range,v.value.range);return y?{structRef:(0,l.structRef)(S,r.isClosed,r.label),resolution:(0,p.success)((0,f.sheetGridRange)(d.value.sheet,y))}:{structRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};case l.StructRefKind.BadRef:return{structRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}}(t,n,s),k=E.structRef,O=E.resolution;return(0,m.resolvedStructRef)(O.kind===p.ResultKind.Failure&&O.reason.kind!==m.ResolveReasonKind.EmptyIntersection?r:(0,l.structRefNode)(u,k,r.label),n,O,i)},resolveUserDefinedFunc:P,resolveDottedName:function(e,t,r){var o,a,s=t.qualifier,u=t.parts,c=[],d={names:new Array,udfs:new Array},h=r[t.label],g=(null==h?void 0:h.kind)===l.AnnotationKind.AppHeadName;if(!s){var v=(0,l.headNamePart)(u);if(v.kind===l.NamePartKind.IdentNamePart){var S=function(e,t){var r=t[e.label];return(null==r?void 0:r.kind)===l.AnnotationKind.LocalNameUse?(0,m.resolvedLocalName)((0,l.nameNode)((0,l.identNamePart)(r.whole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,p.success)(r)):(0,m.resolvedLocalName)((0,l.nameNode)((0,l.identNamePart)(e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),p.successUndefined)}(v,r);if(void 0!==S.resolution.value){var R=(0,l.flattenNameParts)(u).parts.slice(1),b=R.map((function(e){var t=e.rhs;return(null==t?void 0:t.field.kind)===l.NodeKind.Name?t.field.whole:void 0})).filter((function(e){return void 0!==e}));if(b.length===R.length)return(0,m.resolvedDottedName)(S,b,d)}}}for(;;){if(u.canDenoteNamedObject){var N=(0,l.nameNode)((0,l.identNamePart)(u.asWhole,u.canDenoteNamedObject,u.label,u.qualifiedLabel),s,u.qualifiedLabel),T=C(e,N,g?f.NameSource.AppHead:f.NameSource.Plain);if(a=(0,m.resolvedDottedName)(T,n.__spreadArray([],c,!0).reverse(),d),(0,i.safePush)(d.names,T.precedents),!(0,p.isSuccess)(T.resolution)&&T.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier||(0,p.isSuccess)(T.resolution)&&void 0!==T.resolution.value)return a;if(g&&(void 0===s||s.kind===l.QualifierKind.Document||s.kind===l.QualifierKind.Ident)){var E=P(e,N);if(a=(0,m.resolvedDottedName)(E,n.__spreadArray([],c,!0).reverse(),d),(0,i.safePush)(d.udfs,E.precedents),!(0,p.isSuccess)(E.resolution)&&E.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier||(0,p.isSuccess)(E.resolution)&&void 0!==E.resolution.value)return a}}if(u.kind===l.NamePartKind.CellRefNamePart&&(null==s&&e.allowUnqualifiedCell||null!=s&&s.kind!==l.QualifierKind.Document)){var k=y(e,(0,l.cellRefNode)(u.ref,null!=s&&s.kind===l.QualifierKind.Ident?(0,l.sheetQualifier)(s.name):s,u.qualifiedLabel));return(0,m.resolvedDottedName)(k,n.__spreadArray([],c,!0).reverse(),d)}if(u.kind!==l.NamePartKind.FieldRefNamePart||(null===(o=u.rhs)||void 0===o?void 0:o.field.kind)!==l.NodeKind.Name)return void 0!==a?a:(0,m.resolvedDottedName)((0,m.resolvedNever)((0,l.nameNode)((0,l.identNamePart)(u.asWhole,u.canDenoteNamedObject,u.label,u.qualifiedLabel),s,u.qualifiedLabel)),n.__spreadArray([],c,!0).reverse(),d);c.push(u.rhs.field.whole),u=u.lhs,g=!1}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var n=void 0;t.setLocale=function(e){n=e};t.Base_LocaleIsNumeral=function(e){return n.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return n.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=n.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.convertDiagnosticToNLMessage=t.baseNLErrors=t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;var o,a,s,l=r(153),u=r(50);!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(o=t.SyntaxError||(t.SyntaxError={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(a=t.TypeError||(t.TypeError={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(s=t.TypeSourceKind||(t.TypeSourceKind={})),t.baseErrors=((n={})[o.Unclosed_application]={kind:o.Unclosed_application},n[o.Unclosed_paren]={kind:o.Unclosed_paren},n[o.Unclosed_bracket]={kind:o.Unclosed_bracket},n[o.Unclosed_array]={kind:o.Unclosed_array},n[o.Unclosed_literal]={kind:o.Unclosed_literal},n[o.Unclosed_comment]={kind:o.Unclosed_comment},n[o.Invalid_number_literal]={kind:o.Invalid_number_literal},n[o.Invalid_string_literal]={kind:o.Invalid_string_literal},n[o.Invalid_error_literal]={kind:o.Invalid_error_literal},n[o.Invalid_function_name]={kind:o.Invalid_function_name},n[o.Invalid_name]={kind:o.Invalid_name},n[o.Illegal_array_literal_element]={kind:o.Illegal_array_literal_element},n[o.Empty_array_literal]={kind:o.Empty_array_literal},n[o.Irregular_array_shape]={kind:o.Irregular_array_shape},n[o.Empty_parenthesis]={kind:o.Empty_parenthesis},n[o.Bad_node]={kind:o.Bad_node},n[o.Invalid_qualifier]={kind:o.Invalid_qualifier},n[o.Invalid_cell_ref]={kind:o.Invalid_cell_ref},n[o.Invalid_binder]={kind:o.Invalid_binder},n[o.Missing_binder]={kind:o.Missing_binder},n[o.Duplicate_binder]={kind:o.Duplicate_binder},n[o.Invalid_body]={kind:o.Invalid_body},n[o.Mandatory_binder_after_optional]={kind:o.Mandatory_binder_after_optional},n[o.Missing_default_expression]={kind:o.Missing_default_expression},n[o.Binder_requires_brackets]={kind:o.Binder_requires_brackets},n[o.Invalid_field_name]={kind:o.Invalid_field_name},n[o.Missing_field_name]={kind:o.Missing_field_name},n[o.Empty_formula]={kind:o.Empty_formula},n[o.Invalid_rel_sheet_qualifier_in_cell]={kind:o.Invalid_rel_sheet_qualifier_in_cell},n[o.Invalid_rel_sheet_qualifier_in_name]={kind:o.Invalid_rel_sheet_qualifier_in_name},n[o.Invalid_unqualified_cell]={kind:o.Invalid_unqualified_cell},n[o.Unexpected_closing_paren]={kind:o.Unexpected_closing_paren},n[o.Unexpected_closing_brace]={kind:o.Unexpected_closing_brace},n[o.Unexpected_closing_bracket]={kind:o.Unexpected_closing_bracket},n[o.Unexpected_field_ref]={kind:o.Unexpected_field_ref},n[o.Unexpected_dot]={kind:o.Unexpected_dot},n[o.Invalid_struct_ref_table_name]={kind:o.Invalid_struct_ref_table_name},n[o.Invalid_struct_ref_comma_parts]={kind:o.Invalid_struct_ref_comma_parts},n[o.Invalid_struct_ref_missing_part]={kind:o.Invalid_struct_ref_missing_part},n[o.Invalid_struct_ref_bad_part]={kind:o.Invalid_struct_ref_bad_part},n[a.Unexpected_application_head]={kind:a.Unexpected_application_head},n[a.Unexpected_application_head_with_fix]={kind:a.Unexpected_application_head_with_fix},n),t.formatDiagnostic=function(e){switch(e.kind){case a.Insufficient_function_arguments:case a.Excess_function_arguments:return"".concat(e.kind,": ").concat((0,l.englishWorksheetFuncIdToName)(e.funcId));case o.Missing_operation_argument:case a.Incorrect_number_of_operator_arguments:return"".concat(e.kind,": ").concat((0,l.englishOperatorIdToName)(e.opId));case o.Unexpected_character:return"".concat(e.kind,": ").concat((0,u.anonymizeFormulaString)(e.text));case a.Types_not_related:return"".concat(e.kind,": ").concat(function(e){var t=e.kind,r=e.argIndex;switch(e.kind){case s.WSFArgument:return JSON.stringify({kind:t,head:(0,l.englishWorksheetFuncIdToName)(e.head),argIndex:r});case s.OperatorArgument:return JSON.stringify({kind:t,head:(0,l.englishOperatorIdToName)(e.head),argIndex:r})}}(e.typeSource));default:return e.kind}};var c="The formulas has an error";t.baseNLErrors=((i={})[o.Unclosed_application]="The formula is missing a parenthesis",i[o.Unclosed_paren]="The formula is missing a parenthesis",i[o.Unclosed_bracket]="The formula is missing a bracket",i[o.Unclosed_array]="The formula is missing a brace",i[o.Unclosed_literal]="The formula is missing a quote",i[o.Unclosed_comment]="The formula comment is missing an end",i[o.Invalid_number_literal]="The formula has an invalid number",i[o.Invalid_string_literal]="The formula has an invalid string",i[o.Invalid_error_literal]="The formula has an invalid value",i[o.Invalid_function_name]="The formula has an invalid function name",i[o.Invalid_name]="The formula has an invalid name",i[o.Illegal_array_literal_element]="The formula has an invalid value",i[o.Empty_array_literal]="The formula has an empty array",i[o.Irregular_array_shape]="The formula has an incorrectly shaped array",i[o.Empty_parenthesis]="The formula is missing values between parentheses",i[o.Missing_operation_argument]="The formula has an extra operator",i[o.Bad_node]=c,i[o.Invalid_qualifier]="The formula has an invalid sheet reference",i[o.Invalid_cell_ref]="The formula has an invalid cell reference",i[o.Invalid_binder]=c,i[o.Missing_binder]=c,i[o.Duplicate_binder]=c,i[o.Invalid_body]=c,i[o.Mandatory_binder_after_optional]=c,i[o.Missing_default_expression]=c,i[o.Binder_requires_brackets]=c,i[o.Invalid_field_name]="The formula has an invalid field name",i[o.Missing_field_name]="The formula is missing a field name",i[o.Empty_formula]="The formula is empty",i[o.Invalid_rel_sheet_qualifier_in_cell]="The formula has an incorrect reference",i[o.Invalid_rel_sheet_qualifier_in_name]="The formula has an incorrect reference",i[o.Invalid_unqualified_cell]="The formula has an incorrect reference",i[o.Unexpected_closing_paren]="The formula has an extra parenthesis",i[o.Unexpected_closing_brace]="The formula has an extra brace",i[o.Unexpected_closing_bracket]="The formula has an extra bracket",i[o.Unexpected_character]="The formula has some extra characters",i[o.Unexpected_field_ref]="The formula has an extra field",i[o.Unexpected_dot]="The formula has an extra dot",i[o.Invalid_struct_ref_table_name]="The formula has a malformed table name in a structured reference",i[o.Invalid_struct_ref_comma_parts]="The formula has a structured reference with commas that has issues between its brackets",i[o.Invalid_struct_ref_missing_part]="The formula has a structured reference with missing references between its brackets",i[o.Invalid_struct_ref_bad_part]="The formula has a bad reference in a structured reference",i[o.Excess_higher_order_function_arguments]="The formula has a function call with too many arguments",i[a.Types_not_related]="The formula has an operation using data that cannot be mixed together",i[a.Unexpected_application_head]="The formula has a malformed function call",i[a.Unexpected_application_head_with_fix]="The formula has a malformed function call",i[a.Incorrect_number_of_operator_arguments]="The formula has an operation with the wrong number of arguments",i[a.Excess_function_arguments]="The formula has a function call with too many arguments",i[a.Insufficient_function_arguments]="The formula has a function call with missing arguments",i),t.convertDiagnosticToNLMessage=function(e){return t.baseNLErrors[e.kind]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(1);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(1);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;var n=r(19),i=r(31),o=r(40),a=r(61),s=r(48),l=r(33),u=r(26),c=r(60),d=r(68),f=d.codePointQuestionMark,p=d.codePointBackslash,m=d.codePointUnderscore;function h(e,t){if(0===t.length)return!1;var r,n=(0,c.stringCodePointAt)(t,0);return!((r=n)===m||r===p||!e.isIdentStart(r)&&!e.isNumeral(r))&&(0,c.codePointIterator)(t,(0,c.numCodeUnits)(n)).every((function(t){return t!==f&&t!==p&&e.isIdentContinue(t)}))}t.isUnbracketedField=h;var g=(0,o.take)((function(e,t){return(0,l.isBracketToken)(t)||t.kind===i.TokenKind.Escape||t.kind===i.TokenKind.End?void 0:t.chars})),v=(0,o.take)((function(e,t){return t.kind!==i.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars})),S=(0,o.any)(g,(0,o.right)(l.parseEscape,v)),y=(0,o.apply)((0,o.tuple)((0,o.many)(S),l.parseEnd),(function(e,t){var r=t[0];t[1];return r.join("")})),C=(0,o.applyTake)(l.parseBracketedTokens,(function(e,t){var r=t[0],i=t[1],a=(0,o.runParser)(y,r,0,e);if((0,u.isSuccess)(a)){var l=r[0].start,c=r[r.length-1].start,d=a.value.output;if(d.length>255){var f=r.map((function(e){return e.chars})).join("");return[(0,n.badNode)(n.BadType.FieldName,f,(0,s.addSpan)(e,l,c,"","")),!1,!0]}var p=(0,s.addSpan)(e,l,c,"",""),m=(0,s.addSpan)(e,l,c,"","");return[(0,n.nameNode)((0,n.identNamePart)(d,void 0,p,p),void 0,m),!0,i]}})),R=(0,o.apply)(l.parseIdentContinue,(function(e,t){var r=t.start,i=t.start+t.chars.length;if(!h(e.localeInfo,t.chars)||t.chars.length>255)return[(0,n.badNode)(n.BadType.FieldName,t.chars,(0,s.addSpan)(e,r,i,"","")),!1,!0];var o=(0,s.addSpan)(e,r,i,"",""),a=(0,s.addSpan)(e,r,i,"","");return[(0,n.nameNode)((0,n.identNamePart)(t.chars,void 0,o,o),void 0,a),!1,!0]}));t.parseFieldRef=(0,o.apply)((0,o.tuple)(l.parseCharIndex,l.parseWhitespace,l.parseDotSepToken,(0,o.any)(R,C),l.parseCharIndex),(function(e,t){var r=t[0],i=t[1],o=t[2],l=t[3],u=l[0],c=l[1],d=l[2],f=t[4],p=(0,s.addSpan)(e,o.start,f,i,""),m=(0,n.fieldRef)(u,c,d,p);return(0,a.fieldRefTerm)(i.length>0,m,r,f)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(2);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(8);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(2);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;var n=r(69),i=r(166),o=r(41),a=r(108),s=r(111),l=r(32),u=r(288);function c(e){var t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>i.cellStringLimit?(0,l.failure)((0,o.notValueString)("cell text too long")):(0,l.success)((0,o.stringEdit)((0,i.stringOper)(r),t))}function d(e,t,r){return(0,s.parseDateInternal)((0,s.initParseDateGlobals)(e),t,r,o.GetTimeKind.ValueCell)}function f(e,t,r){var n=e.config,i=n.localeInfo,s=n.mathpack,l=i.isEastAsia&&r.valueType===o.FormatValueType.Percentage&&!0,u=!1;switch(r.valueType){case o.FormatValueType.Number:case o.FormatValueType.Currency:case o.FormatValueType.Percentage:case o.FormatValueType.Fraction:case o.FormatValueType.Scientific:case o.FormatValueType.Accounting:u=!0}return(0,a.parseConstInternal)(i,s,t,l,!0,u)}function p(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return i.trueOper;if(0===e.stringCompareCI(t,e.falseName))return i.falseOper;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,i.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==n)return(0,l.success)((0,o.otherEdit)(n));for(var a=0,s=r.valueType===o.FormatValueType.Date||r.valueType===o.FormatValueType.Time?[d,f]:[f,d];a<s.length;a++){var u=(0,s[a])(e,t,r);if(!(0,l.isSuccess)(u))return u;if(void 0!==u.value){var c=u.value,p=c.value,m=c.format;return(0,l.success)((0,o.numberEdit)(p,m))}}return(0,l.success)(void 0)}t.parseEdit=function(e,t,r){try{if(r.valueType===o.FormatValueType.Text)return c(t);if(""===t)return(0,l.success)((0,o.otherEdit)(i.blankOper));var a=(0,u.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.ParseEditEqFix");if((t.length>1||!a)&&(0,n.stringStartsWith)(t,"="))return(0,l.success)((0,o.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){var s=p(e,t,r);if(!(0,l.isSuccess)(s))return s;if(void 0!==s.value)return(0,l.success)(s.value)}return(t.length>1||!a)&&("="===(d=t.charAt(0))||"+"===d||"-"===d||"@"===d)?(0,l.success)((0,o.formulaEdit)(t)):c(t)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}var d},t.shouldInstallFormat=function(e,t){return e!==t&&(t.source===o.NumberFormatSource.Builtin&&(t.valueType===o.FormatValueType.General||function(e,t){return(null==e?void 0:e.valueType)!==o.FormatValueType.Number&&t.valueType!==o.FormatValueType.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=void 0;var n=r(0),i=r(109),o=r(34),a=r(42),s=r(71),l=r(83),u=r(32),c=l.codePointDollarSign,d=l.codePointBackslash,f=l.codePointPercentSign,p=l.codePointSpace,m=l.codePointLeftParen,h=l.codePointMinusSign,g=l.codePointPlusSign,v=l.codePointRightParen;function S(e,t,r,n){if(" "!==t&&""!==t){var i="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===c&&!i)return{currency:1,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?1:2,i:n+3};if((""===t&&e.isJapan||""===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===d)return{currency:0,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:2,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:0,i:n+t.length}:void 0}}function y(e,t,r,l,c,d){var y,C=0,R=!1,b=!1,N=!1,T=e.isCurrencySymbolLead,P=e.currencySymbol;0!==c&&(T=1===c,P="");for(var E=0;E<r.length;){if(void 0===y&&T)if(void 0!==(I=S(e,P,r,E))){y=I.currency,E=I.i;continue}switch(_=r.charCodeAt(E)){case f:E+=1,C+=1;continue;case p:E+=1;continue;case m:case h:case g:if(E+=1,b)return(0,u.success)(void 0);b=!0,_===m&&(R=!0),N=_!==g;continue}break}var k=(0,i.parseNumberLiteral)(e,t,r,E,!0,C>0||l,d);if(void 0===k||void 0===k.value)return(0,u.success)(void 0);E=k.i;for(var O,A=N?t.neg(k.value):k.value;E<r.length;){var I,_;if(void 0===y&&!T)if(void 0!==(I=S(e,P,r,E))){y=I.currency,E=I.i;continue}switch(_=r.charCodeAt(E)){case f:E+=1,C+=1;continue;case p:E+=1;continue;case v:if(E+=1,!R)return(0,u.success)(void 0);R=!1;continue}break}if(E!==r.length||R||C>1||void 0!==y&&C>0)return(0,u.success)(void 0);if(void 0!==k.format)O=k.format;else if(1===y)O=k.consumedDecimal?a.KnownFormat.USCoCurrencyDec:a.KnownFormat.USCoCurrency;else if(2===y){O=e.isChinaT?k.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':k.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(k.numShape!==a.NumberShape.ASCII)return(0,u.failure)((0,o.notImplemented)(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==y)switch(c){case 0:O=k.consumedDecimal?a.KnownFormat.CoCurrencyDec:a.KnownFormat.CoCurrency;break;case 1:O=(0,s.buildCurrencyFormat)(n.__assign(n.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,k.consumedDecimal?2:0,!0,!1,"[$-x-euro2]");break;case 2:O=(0,s.buildCurrencyFormat)(n.__assign(n.__assign({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,k.consumedDecimal?2:0,!0,!1,"[$-x-euro1]")}else O=C>0?k.consumedDecimal?a.KnownFormat.Pct:a.KnownFormat.Pct0:k.consumedThousands?k.consumedDecimal?a.KnownFormat.Fixed:a.KnownFormat.Fixed0:a.KnownFormat.General}return(0,u.success)({value:A,format:O})}t.parseConstInternal=function(e,t,r,n,i,o){if(!i)return y(e,t,r,n,0,o);for(var a=0;a<=2;a+=1){var s=y(e,t,r,n,a,o);if(!(0,u.isSuccess)(s))return s;if(void 0!==s.value)return s;if(0===a&&r.indexOf("")<0)break}return(0,u.success)(void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isSpace=void 0;var n=r(1);t.isSpace=n.literalParse.isSpace,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(2);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateInternal=t.initParseDateGlobals=void 0;var i=r(0),o=r(72),a=r(41),s=r(70),l=r(34),u=r(110),c=r(83),d=r(109),f=r(43),p=r(42),m=r(167),h=r(69),g=r(32),v=c.codePointSlash,S=c.codePointSpace,y=c.codePointMinusSign,C=c.codePointColon,R={getTime:function(){return(0,f.assertFalse)("calc.numfmt.parseDateInternal: default getTime")}};function b(e,t){return(0,f.assertTrue)("calc.numfmt.monthToken",U(e,1,12)),{kind:0,value:e,bidiDate:t}}t.initParseDateGlobals=function(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:R.getTime}};var N=i.__spreadArray([],new Array(12),!0).map((function(e,t){return b(t+1)})),T=function(e){return N[e]},P=function(e){return b(e+1,a.BidiDate.English)},E=function(e){return b(e+1,a.BidiDate.Lunar)},k=[!0,!1].map((function(e){return{kind:1,am:e}})),O=k[0],A=k[1],I=function(e){return 0===e?O:A};function _(e,t,r){return(0,f.assertTrue)("calc.numfmt.numberToken",(0,h.isInteger)(e)&&U(e,-9999,9999)&&U(t,1,4)),{kind:2,value:e,digits:t,numShape:r}}var F=function(e){return 3===e||4===e},M=function(e,t){return e.lcid===o.LCID.Hungarian&&2===t},D=function(e){return e<=1},w=function(e){return e<=2},L=["",""],x=((n={})[o.Country.FRN]=[["Jun",b(6)],["Jul",b(7)]],n[o.Country.DUT]=[["Mrt",b(3)]],n[o.Country.GER]=[["Mrz",b(3)]],n),B=["",""," "," "," "," ","","","",""," "," "];function U(e,t,r){return e>=t&&e<=r}function G(e,t){var r=e.getTime(m.TimeGranularity.Year,t);if(!(0,g.isSuccess)(r))return r;var n=e.config,i=n.datepack.fromNum(n,r.value,m.Rounding.RoundSec);return(0,f.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==i),(0,g.success)(i.yr)}function K(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function V(e,t,r,n,i,o){for(var a=t.indexOf(" ",r),l=0;l<n.length;l+=1){var u=n[l],c=(0,s.fastMin)(i,u.length);if(a>=0&&u.indexOf(" ")<0&&a-r>=c&&a-r<=u.length)if(K(e,p=u.substring(0,a-r),t,r))return[o(l),r+p.length];for(var d=void 0,f=c;f<=u.length;f+=1){var p;if(!K(e,p=u.substring(0,f),t,r))break;d=r+p.length}if(void 0!==d)return[o(l),d]}}function j(e,t,r,n,i){for(var o=0;o<n.length;o+=1){var a=n[o];if(K(e,a,t,r))return[i(o),r+a.length]}}function W(e,t,r){var n,i=x[e.country];if(void 0!==i)for(var a=0,s=i;a<s.length;a++){var l=s[a],u=l[0],c=l[1];if(K(e,u,t,r))return[c,r+u.length]}if(e.isEastAsia){if(void 0!==(n=V(e,t,r,(0,o.getEnglishLocaleInfo)().monthNameLong,3,T)))return n}else if(e.isComplexScript){if(void 0!==(n=j(e,t,r,e.monthNameLong,T)))return n;if(void 0!==(n=j(e,t,r,e.monthNameShort,T)))return n;if(void 0!==(n=j(e,t,r,(0,o.getEnglishLocaleInfo)().monthNameLong,P)))return n;if(void 0!==(n=j(e,t,r,(0,o.getEnglishLocaleInfo)().monthNameShort,P)))return n}else if(void 0!==(n=V(e,t,r,e.monthNameLong,3,T)))return n;return(e.lcid&o.LCID.LANG)==(o.LCID.Arabic&o.LCID.LANG)&&void 0!==(n=j(e,t,r,B,E))||void 0!==(n=V(e,t,r,e.ampmSymbols,1,I))||void 0!==(n=V(e,t,r,(0,o.getEnglishLocaleInfo)().ampmSymbols,1,I))||(e.isChinaS||e.isChinaT)&&void 0!==(n=V(e,t,r,L,1,I))?n:[void 0,r]}function H(e,t,r,n){var i,o,a,s,l,c=r,m=t.charCodeAt(c)===y;if(m&&(c+=1),5===n){if(a=(i=(0,d.parseUint)(e,4,c+4<t.length?t.substring(0,c+4):t,c))[0],l=(s=i[1])-c,(0,f.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",U(l,1,4)),4===l){for(var h=void 0;s<t.length&&e.isNumeral(h=(0,u.stringCodePointAt)(t,s));)s+=(0,u.numCodeUnits)(h);a=Math.round(a/10),l=3}}else if(a=(o=(0,d.parseUint)(e,4,t,c))[0],(l=(s=o[1])-c)>4||l>2&&a<100)return[void 0,r];if(0===l)return[void 0,r];var g=function(e,t){for(var r=p.NumberShape.ASCII,n=0,i=(0,u.codePointIterator)(t);n<i.length;n++){var o=i[n],a=e.getNumberShape(o);a!==p.NumberShape.ASCII&&(r=a)}return r}(e,t.substring(c,s));return c=s,[_(m?-a:a,l,g),c]}function Q(e,t,r,n){var i=0,o=r;if(t.charCodeAt(o)===S)for(i=1;t.charCodeAt(o)===S;)o+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&3===n&&(0,h.stringStartsWith)(t,e.timeAltSeparator,o)?(i=4,o+=e.timeAltSeparator.length):(0,h.stringStartsWith)(t,e.dateSeparator,o)?(i=2,o+=e.dateSeparator.length):(0,h.stringStartsWith)(t,e.timeSeparator,o)?(i=3,o+=e.timeSeparator.length):(0,h.stringStartsWith)(t,e.decimalSeparator,o)&&3===n?(i=5,o+=e.decimalSeparator.length):t.charCodeAt(o)===v||t.charCodeAt(o)===y?(i=2,o+=1):t.charCodeAt(o)===C?(i=3,o+=1):(0,h.stringStartsWith)(t,", ",o)&&(i=6,o+=2),1===i&&(" "===e.dateSeparator?i=2:" "===e.timeSeparator?i=3:" "===e.decimalSeparator&&3===n&&(i=5)),[i,o]}t.parseDateInternal=function(e,t,r,n){var i=e.config,o=i.localeInfo;if(!o.isEastAsia&&!function(e,t){for(var r=0,n=(0,u.codePointIterator)(t);r<n.length;r++){var i=n[r];if(e.isNumeral(i))return!0}return!1}(o,t))return(0,g.success)(void 0);if(o.isEastAsia)return(0,g.failure)((0,l.notImplemented)(["parse East Asia date"]));if(o.isThai){var s=t.indexOf("b");if(s<0&&(s=t.indexOf("B")),s>=0&&s+1<t.length&&o.isNumeral((0,u.stringCodePointAt)(t,s+1)))return(0,g.failure)((0,l.notImplemented)(["parse Thai Buddhist date"]))}var c=function(e,t,r){for(var n,i=e.localeInfo,o=e.dateCompatibility,a=[],s=null==r?void 0:r.bidiDate,c=p.NumberShape.ASCII,d=null==r?void 0:r.culture,m=!1,h=!1,v=0;v<t.length;){if(a.length>=9)return(0,g.success)(void 0);var C=void 0;if(i.isNumeral((0,u.stringCodePointAt)(t,v))||!o&&v+1<t.length&&t.charCodeAt(v)===y&&i.isNumeral((0,u.stringCodePointAt)(t,v+1))){var R=H(i,t,v,n),b=R[0],N=R[1];if(void 0===b)return(0,g.success)(void 0);v=N,b.numShape!==p.NumberShape.ASCII&&(c=b.numShape),C=b}else{if(t.charCodeAt(v)===S)return(0,g.failure)((0,l.notImplemented)(["absurd date/time string with leading space"]));var T=W(i,t,v),P=T[0],E=T[1];if(void 0===P)return(0,g.success)(void 0);if(v=E,0===P.kind){if(m)return(0,g.success)(void 0);m=!0,void 0!==P.bidiDate&&(s=P.bidiDate)}if(1===P.kind){if(h)return(0,g.success)(void 0);if(h=!0,0===a.length||1!==a[a.length-1].sep)return(0,g.success)(void 0);n=a[a.length-1].sep=3}C=P}var k=Q(i,t,v,n),O=k[0];for(v=k[1];v<t.length&&t.charCodeAt(v)===S;)v+=1;a.push({tok:C,sep:O}),n=O}return(0,f.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==a.length),(0,g.success)({tokens:a,bidiDate:s,numShape:c,culture:d})}(i,t,r);if(!(0,g.isSuccess)(c)||void 0===c.value)return c;var d=c.value,h=d.tokens,v=d.bidiDate,C=d.numShape,R=d.culture;if(v===a.BidiDate.Lunar)return(0,g.failure)((0,l.notImplemented)(["Lunar calendar"]));if(void 0!==R&&(R.localCalendarInput||R.tag===a.CultureTag.Gannen))return(0,g.failure)((0,l.notImplemented)(["parse date: possible local calendar"]));var b=function(e,t){for(var r,n,i,o,a,s,u,c=e.localeInfo,d=0;d<t.length;d+=1)if(F(t[d].sep)){r={start:d,end:d+1};break}if(void 0!==r){if(0!==r.start&&1!==t[r.start-1].sep&&!M(c,t[r.start-1].sep))return(0,g.success)(void 0);for(;r.end<t.length&&F(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&5===t[r.end-1].sep){r.end+=1;var p=t[r.end-1];if(2!==p.tok.kind)return(0,g.success)(void 0);p.tok;if(s=p,r.end<t.length&&F(t[r.end-1].sep)){if(r.end+=1,1!==(m=t[r.end-1]).tok.kind)return(0,g.failure)((0,l.notImplemented)(["non-AM/PM after FracSec"]));m.tok;u=m}}else{var m;if(1===(m=t[r.end-1]).tok.kind){m.tok;u=m}}var h=r.end-r.start-(void 0!==s?1:0)-(void 0!==u?1:0);for(d=0;d<h;d+=1)if(2!==t[r.start+d].tok.kind)return(0,g.failure)((0,l.notImplemented)(["non-number in H/M/S component"]));switch(h){case 0:return(0,f.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,f.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===s),i=t[r.start];break;case 2:void 0===s?(i=t[r.start],o=t[r.start+1]):(o=t[r.start],a=t[r.start+1]);break;case 3:i=t[r.start],o=t[r.start+1],a=t[r.start+2];break;default:return(0,g.success)(void 0)}for(d=r.end;d<t.length;d+=1)if(F(t[d].sep))return(0,g.success)(void 0);if(r.end===t.length){var v=t[r.end-1].sep;if(!(D(v)||void 0!==u&&5===v))return(0,g.failure)((0,l.notImplemented)(["trailing sep after time"]))}else{var S=t[r.end-1].sep;if(!D(S)&&6!==S)return(0,g.failure)((0,l.notImplemented)(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return(0,g.failure)((0,l.notImplemented)(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return(0,g.success)({time:r,date:n,hour:i,min:o,sec:a,fracSec:s,ampm:u})}(i,h);if(!(0,g.isSuccess)(b)||void 0===b.value)return b;var N=b.value,T=N.time,P=N.date,E=N.hour,k=N.min,O=N.sec,A=N.fracSec,I=N.ampm,L=function(e,t,r,n){var i,o,a,s=e.config,u=s.localeInfo,c=s.dateCompatibility,d=s.datepack,m=!1;if(void 0!==n){var h=n.end-n.start;if(h<2||h>3)return(0,g.success)(void 0);var v=r[n.start],S=v.tok,y=v.sep,C=r[n.start+1],R=C.tok,b=C.sep,N=r[n.end-1],T=N.tok,P=N.sep;if((0,f.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",1!==S.kind&&1!==R.kind&&1!==T.kind),!D(P)&&!M(u,P))return(0,g.success)(void 0);var E=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(0===e[r].tok.kind)return r}(r,n);if(m=E,E)if(w(y)&&w(b))if(0===S.kind){if(h>2)return(0,g.success)(void 0);o=S,(0,f.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",0!==T.kind),i=T}else{if(0!==R.kind)return(0,g.success)(void 0);a=S,o=R,3===h&&((0,f.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",0!==T.kind),i=T)}else{if(3!==h)return(0,g.success)(void 0);if(D(b))return(0,g.success)(void 0);var k=u.longDateFormat?S:R,O=u.longDateFormat?R:S;if(0!==k.kind)return(0,g.success)(void 0);(0,f.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",0!==O.kind&&0!==T.kind),a=O,o=k,i=T}else if((0,f.assertTrue)("calc.numfmt.parseDateInternal: all not Month",0!==S.kind&&0!==R.kind&&0!==T.kind),2===h&&2===y)switch(m=!0,u.dateOrder){case p.DateOrder.MDY:o=S,i=T;break;case p.DateOrder.YMD:U(S.value,1,12)?(o=S,a=T):(i=S,o=T);break;case p.DateOrder.DMY:U(T.value,1,12)?(a=S,o=T):(o=S,i=T);break;default:return(0,g.failure)((0,l.notImplemented)(["date parse date order"]))}else{if(h<3||2!==y||2!==b)return(0,g.success)(void 0);switch(S.value>999||!c&&S.value>99?p.DateOrder.YMD:u.dateOrder){case p.DateOrder.MDY:o=S,a=R,i=T;break;case p.DateOrder.YMD:i=S,o=R,a=T;break;case p.DateOrder.DMY:a=S,o=R,i=T;break;default:return(0,g.failure)((0,l.notImplemented)(["date parse date order"]))}}}var A=!1;if(u.dateOrder!==p.DateOrder.DMY&&void 0===a&&void 0!==o&&U(o.value,1,12)&&void 0!==i&&U(i.value,1,31)){var I=G(e,t);if(!(0,g.isSuccess)(I))return I;i.value<=d.daysPerMonth(o.value,I.value,c)&&(a=i,i=_(I.value,4,p.NumberShape.ASCII),A=!0)}return(0,g.success)({yr:i,mon:o,dom:a,useMonthName:m,usingCurrentYear:A})}(e,n,h,P);if(!(0,g.isSuccess)(L)||void 0===L.value)return L;var x=L.value,B=x.yr,K=x.mon,V=x.dom,j=x.useMonthName,q=x.usingCurrentYear,z=function(e,t,r,n,i,o,a,s,u,c){var d,p,h,v,S=e.config,y=S.mathpack,C=S.datepack,R=S.dateCompatibility;if(void 0!==n||void 0!==i||void 0!==r){if((0,f.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==i||void 0!==r),(0,f.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==n),!U(h=n.value,1,12))return(0,g.success)(void 0);if(void 0===r){var b=G(e,t);if(!(0,g.isSuccess)(b))return b;p=b.value}else p=U(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!U(p,1900,9999))return(0,g.success)(void 0);if(!U(v=null!==(d=null==i?void 0:i.value)&&void 0!==d?d:1,1,C.daysPerMonth(h,p,R)))return(0,g.success)(void 0)}else{var N=C.fromNum(S,y.zero,m.Rounding.RoundSec);(0,f.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==N),p=N.yr,h=N.mon,v=N.dom}var T,P=0,E=0,k=0,O=0,A=m.Rounding.RoundSec,I=0;if(void 0!==o){if(o.value<0)return(0,g.failure)((0,l.notImplemented)(["negative hour"]));if(o.value>23){if(void 0!==T)return(0,g.success)(void 0);I=o.value,T=m.TimeDivision.Hour}else P=o.value}if(void 0!==a){if(a.value<0)return(0,g.failure)((0,l.notImplemented)(["negative minute"]));if(a.value>59){if(void 0!==T)return(0,g.success)(void 0);I=a.value,T=m.TimeDivision.Minute}else E=a.value}if(void 0!==s){if(s.value<0)return(0,g.failure)((0,l.notImplemented)(["negative second"]));if(s.value>59){if(void 0!==T)return(0,g.success)(void 0);I=s.value,T=m.TimeDivision.Second}else k=s.value}if(void 0!==u){if(u.value<0)return(0,g.failure)((0,l.notImplemented)(["negative fractional second"]));(0,f.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",u.digits>=1&&u.digits<=3),A=u.digits,(0,f.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",u.value<(3===A?1001:2===A?100:10)),O=u.value}if(void 0!==c){if(void 0!==T||P>12)return(0,g.success)(void 0);c.am?12===P&&(P=0):P<12&&(P+=12)}var _=(0,m.dateTime)(p,h,v,P,E,k,1,O,A),F=void 0!==T?C.toNumWithDuration(S,_,T,I):C.toNum(S,_);return(0,l.isErrorOper)(F)?(0,g.success)(void 0):(0,g.success)({value:F,duration:T})}(e,n,B,K,V,null==E?void 0:E.tok,null==k?void 0:k.tok,null==O?void 0:O.tok,null==A?void 0:A.tok,null==I?void 0:I.tok);if(!(0,g.isSuccess)(z)||void 0===z.value)return z;var Y=z.value,J=Y.value,X=function(e,t,r,n,i,o,a,s,u,c,d,h){if(e!==p.NumberShape.ASCII)return(0,g.failure)((0,l.notImplemented)(["parseDateInternal ifmt for non-ASCII"]));if(a)return 4===(null==s?void 0:s.sep)?(0,g.failure)((0,l.notImplemented)(["parseDateInternal ifmt for alternate time separator"])):void 0!==c?(0,g.success)(p.KnownFormat.SS0):void 0!==h?h!==m.TimeDivision.Hour||void 0!==d||t?(0,g.success)(p.KnownFormat.General):(0,g.success)(p.KnownFormat.AbsHMMSS):t?(0,g.success)(p.KnownFormat.MDYHMS):void 0!==d?(0,g.success)(void 0!==u?p.KnownFormat.HHMMSSAP:p.KnownFormat.HHMMAP):(0,g.success)(void 0!==u?p.KnownFormat.HHMMSS:p.KnownFormat.HHMM);if((0,f.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!i)return(0,g.success)(p.KnownFormat.MMDDYY);var v=void 0!==r&&!o;return(0,g.success)(void 0===n?p.KnownFormat.MMMYY:v?p.KnownFormat.DDMMMYY:p.KnownFormat.DDMMM)}(C,void 0!==P,B,V,j,q,void 0!==T,k,O,A,I,Y.duration);return(0,g.isSuccess)(X)?(0,g.success)({value:J,format:X.value}):X}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(1);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderHashesValue=t.renderValue=t.renderGeneral=void 0;var n=r(41),i=r(34),o=r(43),a=r(70),s=r(82),l=r(69),u=r(32),c=function(e){return e.kind!==n.FormattedUnitKind.General},d=function(e){return e.kind!==n.FormattedUnitKind.Flexible};function f(e,t,r){return 0!=(t&n.Clip.MaxChars)&&r.length>255?n.Clip.MaxChars:0!=(t&n.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.Clip.CellWidth:void 0}function p(e,t,r,n,i,s,l){var u=(0,a.fastMax)(0,255-r.length-n.length),c=0===i.length?u:Math.floor(u/i.length);if(e.renderWidth!==1/0){var d=e.getTextWidth(i);d>0&&(c=(0,a.fastMin)(c,(0,a.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/d),0)))}var p,m=l(c);if(e.bestFit&&s&&(!1===m||m.indexOf("E")>=0)){for(var h=1,v=m;(!1===v||v.indexOf("E")>=0)&&c+h<=g;)v=l(c+h),h++;if(!1!==v)return v}if(!1===m||void 0===(p=f(e,t,r+m+n))){for(var S=m,y=c+1;y<c+50;y+=1){if(!1!==(R=l(y))){if(R===S)break;if(void 0!==(b=f(e,t,r+R+n))){!1===S&&(S=b);break}S=R}}return(0,o.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==S),S}var C=p;for(y=c-1;y>=0;y-=1){var R,b;if(!1===(R=l(y)))break;if(void 0===(b=f(e,t,r+R+n)))return R;C=b}return C}var m=(0,i.createFailureErrorClass)("RenderHashesError"),h=(0,i.createFailureErrorClass)("RenderError"),g=11;function v(e,t,r){var n=e.fromNumber(t.num),i=t.includeSign&&e.cond(n)<0?"-":"",a=i+e.formatGeneral(t,e.abs(n),r-i.length);if("-0"===a&&(a="0"),a.length>r)return(0,u.success)(!1);var l=a.indexOf("E");if(l>=0){var c=(0,s.convertNumberShape)(t,a.substring(0,l),t.expNumberShape);if(!(0,u.isSuccess)(c))return c;var d=a.substring(l,l+2),f=(0,s.convertDigitsShape)(a.substring(l+2),t.expNumberShape);return(0,o.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===d||"E+"===d),(0,u.success)(c.value+d+f)}var p=(0,s.convertNumberShape)(t,a,t.numberShape);return(0,u.isSuccess)(p)?(0,u.success)(p.value):p}t.renderGeneral=v,t.renderValue=function(e,t,r){try{return(0,n.isHashesValue)(t)?(0,u.success)((0,n.hashesValue)(t.units,t.color)):(0,u.success)(function(e,t,r){var i,s,S=t.units,y=t.color,C=t.alignment,R=t.clip,b=(0,n.memoizedRenderCallback)(r);if(S.every(c))i=S;else if(b.renderWidth===1/0)i=S.map((function(t){if(t.kind!==n.FormattedUnitKind.General)return t;var r=v(e,t,g);if(!(0,u.isSuccess)(r))throw new h(r.reason);return(0,o.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),(0,n.formattedUnitString)(r.value)}));else{for(var N="",T="",P=void 0,E=void 0,k=0;k<S.length;k+=1){var O=S[k];switch(O.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==P?T+=O.str:N+=O.str;break;case n.FormattedUnitKind.General:(0,o.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===P),P=k,E=O;break;case n.FormattedUnitKind.Flexible:}}(0,o.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==P&&void 0!==E);var A=E,I=p(b,R,N,T,"0",A.builtin,(function(t){var r=v(e,A,(0,a.fastMin)(t,g));if(!(0,u.isSuccess)(r))throw new h(r.reason);return r.value}));if("number"==typeof I)throw new m((0,n.tooWide)(I));i=S.map((function(e){return e.kind===n.FormattedUnitKind.General?(0,n.formattedUnitString)(I):e}))}if(i.every(d))s=i;else if(b.renderWidth===1/0||b.bestFit)s=i.filter(d);else{N="",T="";var _,F=void 0;for(k=0;k<i.length;k+=1){var M=i[k];switch(M.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==_?T+=M.str:N+=M.str;break;case n.FormattedUnitKind.Flexible:_=k,F=M}}(0,o.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==_&&void 0!==F);var D=F,w=p(b,n.Clip.All,N,T,F.str,!1,(function(e){return(0,l.repeat)(D.str,e)}));if("number"==typeof w){if(0!=(w&R))throw new m((0,n.tooWide)(w));w=""}var L=w.length/D.str.length;L=(0,a.fastMax)(L-1,0);var x=(0,l.repeat)(D.str,L);s=i.map((function(e,t){return e.kind!==n.FormattedUnitKind.Flexible?e:(0,n.formattedUnitString)(t===_?x:"")}))}if(R!==n.Clip.None){var B="";for(k=0;k<s.length;k+=1)B+=s[k].str;var U=f(b,R,B);if(b.bestFit&&U===n.Clip.CellWidth)return(0,n.renderedValue)(s,y,C,R);if(void 0!==U)throw new m((0,n.tooWide)(U))}return(0,n.renderedValue)(s,y,C,R)}(e,t,r))}catch(e){return e instanceof m?(0,u.success)((0,n.hashesValue)(e.reason,t.color)):e instanceof h?(0,u.failure)(e.reason):(0,u.failure)((0,u.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{var r=p((0,n.memoizedRenderCallback)(t),e.clip,"","","#",!1,(function(e){return(0,l.repeat)("#",e)}));if("number"==typeof r)switch(r){case n.Clip.MaxChars:r=(0,l.repeat)("#",255);break;case n.Clip.CellWidth:r="";break;default:return(0,o.assertNever)("calc.numFmt.renderHashesValue",r)}var i=(0,n.formattedUnitString)(r);return(0,u.success)((0,n.renderedValue)([i],e.color,e.alignment,e.clip))}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(1);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=void 0;var n=r(17),i=r(12),o=r(13),a=r(11),s=r(73),l=r(9),u=r(16),c=r(17),d=r(10);function f(e,t){return 0!=(t&o.OperKind.Number)?e.zero:0!=(t&o.OperKind.String)?c.emptyStringOper:0!=(t&o.OperKind.Boolean)?a.falseOper:a.valueErrorOper}t.coerceOper=function(e,t,r){var c=function e(t,r,n){var c=t.globals.config,p=c.localeInfo,m=c.mathpack;if(0!=(n&r.kind))return r;if((0,l.isNumberOper)(r)){if(0!=(n&o.OperKind.String)){return(0,a.stringOper)(m.formatGeneral(p,r,20))}return 0!=(n&o.OperKind.Boolean)?(0,a.booleanOper)(0!==m.cond(r)):0!=(n&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[r]]):a.valueErrorOper}if((0,l.isStringOper)(r)){if(0!=(n&o.OperKind.Number)){if(0===r.value.length)return a.valueErrorOper;if(r.value.length>255)return a.valueErrorOper;var h=t.numberFormatter.parseGeneral(r.value,!1,!0,s.GetTimeKind.NonVolatile);return(0,u.isSuccess)(h)||(0,i.throwEvaluationError)(h.reason),void 0!==h.value?h.value.value:a.valueErrorOper}return 0!=(n&o.OperKind.Boolean)?0===p.stringCompareCI(r.value,p.trueName)?a.trueOper:0===p.stringCompareCI(r.value,p.falseName)?a.falseOper:a.valueErrorOper:0!=(n&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[r]]):a.valueErrorOper}if((0,l.isBooleanOper)(r))return 0!=(n&o.OperKind.Number)?r.value?m.one:m.zero:0!=(n&o.OperKind.String)?(0,a.stringOper)(r.value?p.trueName:p.falseName):0!=(n&o.OperKind.Array)?(0,a.arrayOper)(1,1,[[r]]):a.valueErrorOper;switch(r.kind){case o.OperKind.Error:return r;case o.OperKind.Missing:return 0!=(n&o.OperKind.Blank)?a.blankOper:f(m,n);case o.OperKind.Blank:return f(m,n);case o.OperKind.Rich:return e(t,r.getFallback(),n);case o.OperKind.Range:case o.OperKind.Array:return a.valueErrorOper;default:return(0,d.assertNever)("calc.runtime.coerceOper",r)}}(e,t,r);return(0,l.isErrorOper)(c)&&!(0,l.isErrorOper)(t)&&(0,n.traceErrorOper)("calc.runtime.coerceOper",c.type,"kind = ".concat(t.kind)),c}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;var i=r(0),o=r(49),a=r(10),s=r(36),l=r(36),u=r(27),c=r(17),d=r(62),f=r(9),p=r(28),m=r(84),h=r(11),g=r(16),v=r(177),S=r(21),y=r(85),C=r(14),R=(0,f.createFailureErrorClass)("CompileError"),b=(0,c.makeStrict)((0,p.getWorksheetFuncType)(p.WorksheetFuncId.IF)),N=(0,c.makeStrict)((0,p.getWorksheetFuncType)(p.WorksheetFuncId.CHOOSE));function T(e){return(0,l.isOperTerm)(e)&&(0,f.isWriteOper)(e)}var P=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,v.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return y.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e,t,r){return y.Pledge.resolve(this.noopTerm(e,r))},e.prototype.arrayNode=function(e,t,r){var n=this;return y.Pledge.all(e.map((function(e){return y.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.toArrayTerm(e,r)}))},e.prototype.toArrayTerm=function(e,t){var r=e.length,n=void 0===e[0]?0:e[0].length,i=e.map((function(e){return e.map((function(e){return e.kind===l.TermKind.Noop?e.children:e}))}));return i.every((function(e){return e.every(T)}))?this.noopTerm((0,h.arrayOper)(r,n,i),t):(0,l.arrayTerm)(r,n,e,t)},e.prototype.appNode=function(t,r,n,o){var s,u=this,c=(0,f.getArguments)((0,d.appNode)(t,r,n)),m=(null===(s=this.context.annotations[o])||void 0===s?void 0:s.kind)===d.AnnotationKind.FormulaRoot;if((0,f.isOperatorNode)(t)){var h=(0,p.getOperatorType)(t.id);return y.Pledge.all(c.map(this.lazyVisitFormulaNode)).bind((function(e){return(0,l.appTerm)((0,l.operatorIdToName)(t.id),h,m,e,o)}))}if((0,f.isWSFNode)(t)){var g=t.id;switch(g){case p.WorksheetFuncId.IFERROR:case p.WorksheetFuncId.IFNA:(0,a.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===c.length);var S=c[0],C=c[1],R=new e(i.__assign(i.__assign({},this.context),{numNames:this.context.numNames+1}));return y.Pledge.all([this.lazyVisitFormulaNode(S),y.Pledge.try((function(){return(0,v.visitFormulaNode)(R,C)}))]).bind((function(e){var t=e[0],r=e[1];return u.toIfPredicateTerm(g===p.WorksheetFuncId.IFERROR?p.WorksheetFuncId.ISERROR:p.WorksheetFuncId.ISNA,t,r,o)}));case p.WorksheetFuncId._UDF:return(0,a.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return y.Pledge.all(c.map(this.lazyVisitFormulaNode)).bind((function(e){switch(g){case p.WorksheetFuncId.IF:return u.toIfTerm(e,o);case p.WorksheetFuncId.CHOOSE:return u.toChooseTerm(e,o)}var t=(0,p.getWorksheetFuncType)(g);return(0,l.appTerm)((0,l.worksheetFunctionIdToName)(g),t,!1,e,o)}))}return this.lazyVisitFormulaNode(t).bind((function(e){return y.Pledge.all(c.map(u.lazyVisitFormulaNode)).bind((function(t){return u.toAppTerm(e,t,o)}))}))},e.prototype.toIfPredicateTerm=function(e,t,r,n){var i=(0,l.readStackTerm)(0,void 0),o=(0,l.conditionalTerm)((0,l.worksheetFunctionIdToName)(p.WorksheetFuncId.IF),b,!1,(0,l.appTerm)((0,l.worksheetFunctionIdToName)(e),(0,p.getWorksheetFuncType)(e),!1,[i],void 0),[r,i],void 0);return(0,l.letTerm)([t],!1,[void 0],o,n)},e.prototype.toIfTerm=function(e,t){switch(e.length){case 3:return(0,l.conditionalTerm)((0,l.worksheetFunctionIdToName)(p.WorksheetFuncId.IF),b,!1,e[0],[e[1],e[2]],t);case 2:return(0,l.conditionalTerm)((0,l.worksheetFunctionIdToName)(p.WorksheetFuncId.IF),b,!1,e[0],[e[1],h.falseOper],t);case 1:throw new R((0,f.notImplemented)(["single-argument IF"]));default:return(0,a.assertFalse)("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(e,t){return(0,a.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,l.conditionalTerm)((0,l.worksheetFunctionIdToName)(p.WorksheetFuncId.CHOOSE),N,!1,e[0],e.slice(1),t)},e.prototype.toAppTerm=function(e,t,r){return(0,l.appTerm)((0,l.worksheetFunctionIdToName)(p.WorksheetFuncId._UDF),(0,p.higherOrderFunctionType)(),!1,i.__spreadArray([e],t,!0),r)},e.prototype.letNode=function(e,t,r,n,i,o){var s=this,c=e.id===p.WorksheetFuncId.LETREC||e.id!==p.WorksheetFuncId.LET&&(0,a.assertFalse)("calc.runtime.compile");(0,a.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);var d=this.bindNames(t),f=d[t.length],m=t.map((function(e){return e.name.arg.label}));return(c?y.Pledge.all(t.map((function(e){var t=e.binder;return y.Pledge.try((function(){return(0,v.visitFormulaNode)(f,t.arg)}))}))):y.Pledge.all(t.map((function(e,t){var r=e.binder,n=d[t];return y.Pledge.try((function(){return(0,v.visitFormulaNode)(n,r.arg)}))})))).bind((function(e){return(0,v.visitFormulaNode)(f,r.arg).bind((function(r){return(0,l.letTerm)(e.map((function(e,r){return s.noopTerm(e,(0,u.runtimePositionLetVal)(t[r].name.arg.label,t[r].binder.arg.label))})),c,m,r,o)}))}))},e.prototype.lambdaNode=function(e,t,r,n,o,s){(0,a.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);var u=this.bindNames(t),c=u[t.length],d=t.reduce((function(e,t,r){var n=t.name;return(0,S.fastMax)(e,n.arg.isOptional?0:r+1)}),0),f=t.length,p=t.map((function(e){return e.name.arg.label})),m=t.map((function(e){return e.name.arg.name.name.label}));return y.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return y.Pledge.resolve(void 0);var n=u[t],i=r.arg.def.rhs;return y.Pledge.try((function(){return(0,v.visitFormulaNode)(n,i)}))}))).bind((function(e){return(0,v.visitFormulaNode)(c,r.arg).bind((function(t){var r=e.map((function(e,t){return[e,t]})).filter((function(e){return void 0!==e[0]})),n=r.map((function(e){return e[1]})),o=i.__spreadArray(i.__spreadArray([],r.map((function(e){return e[0]})),!0),[t],!1);return(0,l.lambdaTerm)(d,f,p,m,n,o,s)}))}))},e.prototype.bindNames=function(t){var r=this,n=this.context.numNames,o=[this];return t.reduce((function(t,s,l){var u=s.name;(0,a.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==u.arg.whole);var c=t.setValue((0,f.getBoundName)(r.context.localeInfo,u.arg.whole),n+l);return o.push(new e(i.__assign(i.__assign({},r.context),{names:c,numNames:n+l+1}))),c}),this.context.names),o},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.noopTerm(e,r)}))},e.prototype.nameNode=function(e,t,r){var n,i=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===d.AnnotationKind.AppHeadName;return y.Pledge.resolve(this.toNameTerm(e,t,i))},e.prototype.toNameTerm=function(e,t,r){var n=this,i=this.context,o=i.locals,s=i.names,u=i.numNames;if(!t){var c=(0,d.flattenNameParts)(e);if(c.kind===d.NamePartKind.IdentNamePart){var p=c.parts,m=p[0],h=p.slice(1),g=s.getEntry((0,f.getBoundName)(this.context.localeInfo,m.asWhole));if(void 0!==g){var v=g.value,S=(0,l.readStackTerm)(u-v-1,m.qualifiedLabel);return y.Pledge.resolve(h.reduce((function(e,t){var r;return(0,a.assertTrue)("calc.runtime.toNameTerm: expected wff",(null===(r=t.rhs)||void 0===r?void 0:r.field.kind)===d.NodeKind.Name),n.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)}),S))}}}var R=function(e,r){var i,a=y.Pledge.resolve(void 0);if(r.kind===d.NamePartKind.FieldRefNamePart&&(null===(i=r.rhs)||void 0===i?void 0:i.field.kind)===d.NodeKind.Name){var s=r.rhs.field.whole;a=y.Pledge.try((function(){return R(!1,r.lhs)})).bind((function(e){return void 0===e?void 0:n.toFieldRefTerm(e,s,r.qualifiedLabel)}))}return r.kind===d.NamePartKind.CellRefNamePart&&(null==t&&o.allowUnqualifiedCell||null!=t&&t.kind!==d.QualifierKind.Document)&&(a=y.Pledge.resolve((0,l.cellRefTerm)(r.ref,null!=t&&t.kind===d.QualifierKind.Ident?(0,d.sheetQualifier)(t.name):t,r.qualifiedLabel))),r.canDenoteNamedObject&&(!e||t&&t.kind!==d.QualifierKind.Document&&t.kind!==d.QualifierKind.Ident||(a=a.bind((function(e){return(0,l.udfTerm)(r.asWhole,t,e,r.qualifiedLabel)}))),a=a.bind((function(n){return(0,l.nameTerm)(r.asWhole,t,e?C.NameSource.AppHead:C.NameSource.Plain,n,r.qualifiedLabel)}))),a};return R(r,e).bind((function(e){return void 0!==e?e:(0,a.assertFalse)("calc.runtime.compile: expected wff NameNode")}))},e.prototype.cellRefNode=function(e,t,r){return y.Pledge.resolve((0,l.cellRefTerm)(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){var i=this;(0,a.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===d.NodeKind.Name);var o=t.field.whole;return this.lazyVisitFormulaNode(e).bind((function(e){return i.toFieldRefTerm(e,o,n)}))},e.prototype.toFieldRefTerm=function(e,t,r){var n=p.WorksheetFuncId.FIELDVALUE;return(0,l.appTerm)((0,l.worksheetFunctionIdToName)(n),(0,p.getWorksheetFuncType)(n),!1,[e,(0,h.stringOper)(t)],r)},e.prototype.noopTerm=function(e,t){return this.context.locals.emitStepInfo?(0,s.noopTerm)(e,t):e},e.prototype.structRefNode=function(e,t,r){return y.Pledge.resolve((0,l.structRefTerm)((0,d.structRefNode)(e,t,r),r))},e.prototype.badSequenceNode=function(e,t,r){return(0,a.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.badStringNode=function(e,t,r){return(0,a.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(e,t){return y.Pledge.resolve((0,d.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return y.Pledge.resolve((0,d.wsfNode)(e,t,r))},e}(),E=((n={})[p.OperatorId.At]=p.WorksheetFuncId.SINGLE,n[p.OperatorId.Pound]=p.WorksheetFuncId.ANCHORARRAY,n);var k=[function(e){if(!(0,l.isOperTerm)(e)&&e.kind===l.TermKind.App&&(0,l.isOperatorName)(e.data.funName)){var t=E[(0,l.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,l.appTerm)((0,l.worksheetFunctionIdToName)(t),(0,p.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.children,e.position)}return e}],O=function(e,t){return t(e)},A=function(e){return k.reduce(O,e)};function I(e,t){return i.__assign(i.__assign({},e),{term:t})}function _(e,t,r){var n,i,o;try{var a=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,s=function(e,t){var r=t.annotations[t.node.label],n=m.RedBlackMapTree.create(e.stringCompareCI);if((null==r?void 0:r.kind)===d.AnnotationKind.FormulaRoot){var i=r.contextNames,o=void 0===i?[]:i;return{names:o.reduce((function(t,r,n){return t.setValue((0,f.getBoundName)(e,r.whole),n)}),n),numNames:o.length}}return{names:n,numNames:0}}(a,r),u=s.names,c=s.numNames,p={globals:e,locals:t,localeInfo:a,annotations:r.annotations,names:u,numNames:c},h=(0,v.reducePledge)(new P(p),r),S=(o=h,(0,l.transformBottomUp)(o,A));return(0,g.success)(I(r,S))}catch(e){return e instanceof R?(0,g.failure)(e.reason):(0,g.failure)((0,g.javaScriptError)(e))}}t.compiledFormula=I,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,a.assertFalse)("".concat(e,": expected known compiled formula type; given ").concat((0,o.anonymize)(t))):t.term},t.createCompiler=function(e){return{compileFormula:function(t,r){return _(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dereferenceOpers=t.dereferenceOper=t.dereference=t.getCellValuesAsArray=void 0;var n=r(10),i=r(75),o=r(35),a=r(49),s=r(27),l=r(12),u=r(20),c=r(17),d=r(4),f=r(11),p=r(21),m=r(9),h=r(14),g=r(44),v=r(13),S=r(16);function y(e,t){var r=t.map.getValue(e);if(void 0!==r){var n=(0,g.recordCellCycle)(r,t.current);return(0,l.throwEvaluationError)(n)}}function C(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===S.ResultKind.Failure)return(0,l.throwEvaluationError)(n.reason);var i=n.value;if(i.kind===s.CellKind.FinalValue)return i.oper;y(i.anchor,e.visitedCells),r.push(i.anchor)}function R(e,t,r,i){var a;if(e.precedents.cells.push(t),!i||(0,m.gridRangeSize)(t.range)<=16)a=t;else{var u=e.globals.getUsedRange(t.sheet),c=void 0;(0,S.isSuccess)(u)?c=null==u.value?void 0:u.value.range:(0,l.throwEvaluationError)(u.reason);var d=void 0===c?void 0:(0,m.gridRangeIsect)(t.range,(0,h.gridRange)(0,0,c.row+c.rows,c.col+c.cols));if(void 0===d)return new o.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],f.blankOper);a=(0,h.sheetGridRange)(t.sheet,d)}var g=e.globals.getCellValues(a);if(g.kind===S.ResultKind.Failure)return(0,l.throwEvaluationError)(g.reason);var v=r.length,C=function(e,t,r,i,a){var l=[],u=i.length,c=0;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",u===r.rows);for(var d=0;d<u;d+=1){l.push([]);var h=i[d].length;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",h===r.cols),c=0===d?h:(0,p.fastMin)(h,c);for(var g=0;g<h;g+=1){var v=i[d][g];s.CellKind.FinalValue===v.kind?l[d][g]=v.oper:(y(v.anchor,e.visitedCells),(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,m.isSheetIndexEqual)(v.anchor.sheet,t.sheet)),a.push(v.anchor),l[d][g]=f.refErrorOper)}}return new o.StrictSparseArray2D(t.range.rows,t.range.cols,u,c,l,f.blankOper)}(e,t,a.range,g.value,r);return v===r.length?C:void 0}function b(e,t,r){var n=R(e,t,r,!1);if(null!=n)return(0,f.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,o.array2DToJaggedArray)(n))}function N(e,t,r,n){if(0!=(r&v.OperKind.Range))return t;if(!(0,m.isRangeOper)(t))return t;var o=t.sheets;if(!(0,m.isSheetIndex)(o))return(0,c.traceErrorOper)("calc.runtime.dereference",f.ErrorType.REF,"3D range, oper = ".concat((0,a.anonymize)(t))),f.refErrorOper;if(1!==t.ranges.length)return(0,c.traceErrorOper)("calc.runtime.dereference",f.ErrorType.VALUE,"union range, oper = ".concat((0,a.anonymize)(t))),f.valueErrorOper;var s=t.ranges[0];if(0!=(r&u.singleReadOperType)){if((0,m.isGridCell)(s))return C(e,(0,h.sheetGridCell)(o,s),n);if(e.locals.implicitIntersect&&(0,i.isFeatureEnabled)(i.FeatureName.CalcLegacyImplicitIntersection)&&!(0,i.isFeatureEnabled)(i.FeatureName.CalcPreventSpillingHack)){var d=e.locals.originGridCell;if(!(0,S.isSuccess)(d))return(0,l.throwEvaluationError)(d.reason);var p=(0,m.gridCellImplicitIsect)(d.value,s);return null==p?((0,c.traceErrorOper)("calc.runtime.dereference",f.ErrorType.VALUE,"empty intersection, oper = ".concat((0,a.anonymize)(t))),f.valueErrorOper):C(e,(0,h.sheetGridCell)(o,p),n)}return b(e,(0,h.sheetGridRange)(o,s),n)}return 0!=(r&v.OperKind.Array)?b(e,(0,h.sheetGridRange)(o,s),n):((0,c.traceErrorOper)("calc.runtime.dereference",f.ErrorType.VALUE,"bad target type ".concat(r)),f.valueErrorOper)}t.getCellValuesAsArray=R,t.dereference=N,t.dereferenceOper=function(e,t,r){var i=[],o=N(e,t,r,i);if(null==o){if(i.length>0)return(0,l.throwEvaluationError)((0,l.unevaluated)(i));var s=(0,a.anonymize)(t),u="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ".concat(s);return n.ulsLogger.ULS.assertTag(595980819,d.LogCategory.msoulscat_ES_EWAJS,!1,u)}return o},t.dereferenceOpers=function(e,t,r){for(var n=[],i=0;i<t.length;i+=1){var o=N(e,t[i],(0,m.getArgType)(r,i,t.length),n);null!=o&&(t[i]=o)}if(n.length>0)return(0,l.throwEvaluationError)((0,l.unevaluated)(n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLocals=t.notFormulaString=t.createParseGlobals=t.ReasonKind=void 0;var n=r(3);t.ReasonKind=n.parseServiceTypes.ReasonKind,t.createParseGlobals=n.parseServiceTypes.createParseGlobals,t.notFormulaString=n.parseServiceTypes.notFormulaString,t.parseLocals=n.parseServiceTypes.parseLocals},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluationRuntime=t.runtimeTimer=t.calculateNextDeadline=t.createSchedule=void 0;var n=r(10),i=r(27),o=r(21),a=r(20),s=r(86),l=r(16);function u(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=(0,o.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,o.fastMin)(e.endTimeMs,t)}}t.createSchedule=function(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,o.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}},t.calculateNextDeadline=u,t.runtimeTimer=function(){return{doTimeout:function(e){return void 0!==e&&(0,o.now)()>=e}}};var c={kind:i.ReasonKind.Timeout},d={kind:i.ReasonKind.Breakpoint},f=function(){function e(e,t){(0,n.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new a.MachineRuntime(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===i.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(u(e));return Array.isArray(r)?Promise.resolve(r):((0,n.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",r.kind===i.ReasonKind.Timeout),new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))})))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(o){if(t.context.globals.interruptToken[0]===i.Interrupt.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(o);if(Array.isArray(a))return a;switch(a.kind){case i.ReasonKind.Timeout:return(0,i.paused)((function(t){return r(null!=t?t:u(e))}));case i.ReasonKind.Breakpoint:return(0,i.breaked)((function(){return r(u(e))}));default:return(0,n.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",a)}};return r(u(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var i=this.machineRuntimes[this.results.length].run(r);if(i.kind===a.TransitionKind.Next)return c;if(i.kind===a.TransitionKind.Break)return d;this.pushResult(i)}return this.results}catch(e){var o="calc.runtime.EvaluationRuntime.evaluate: unhandled error ".concat((0,s.messageFromError)(e));return(0,n.assertFalse)(o)}},e.prototype.pushResult=function(e){return this.results.push(e),a.nextTransition},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,l.failure)(i.stopped))},e}();t.EvaluationRuntime=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellEvaluationMachine=void 0;var n=r(10),i=r(27),o=r(12),a=r(20),s=r(16),l=r(44),u=r(44),c=r(14),d=r(85),f=r(11),p=r(49),m=r(9),h=r(17),g=r(53),v=r(75),S=function(){function e(e,t,r,n,i){this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=n,this.isPrecedent=i}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===s.ResultKind.Failure)return d.Pledge.reject(e.reason);var t=e.value;if(t.kind===i.CellKind.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===s.ResultKind.Failure){var c="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,n.assertFalse)(c)}var f=r.value;if(null==f){var m="client error: expected getCellFormula(".concat((0,p.anonymize)(t.anchor),") != null");c="calc.runtime.CellEvaluationMachine.next: ".concat(m);return(0,n.assertFalse)(c)}var h=this.visitAnchor(f),g=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,o.evalLocalsGrid)(h.source),h.precedents,(0,u.appendVisitedCell)(this.visitedCells,h),l.emptyVisitedNames,a.readOperType,f.formula);return d.Pledge.fromMachine(g).bind(this.receiveSuccess(h)).catch(this.receiveFailure(h))},e.prototype.visitAnchor=function(e){var t=(0,m.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var i="unexpected visitValue at ".concat((0,p.anonymize)(t),"; given ").concat((0,p.anonymize)(r)),a="calc.runtime.CellEvaluationMachine.visitAnchor: ".concat(i);return(0,n.assertFalse)(a)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,o.bottomEvalPrecedents)()}},e.prototype.receiveSuccess=function(e){var t=this;return function(r){if((0,m.isRangeOper)(r)||(0,m.isMissingOper)(r)){var i="expected ReadOper; given ".concat((0,p.anonymize)(r)),o="calc.runtime.CellEvaluationMachine.receiveSuccess: ".concat(i);return(0,n.assertFalse)(o)}return t.writeSuccess(e.source,r,e.precedents),r}},e.prototype.receiveFailure=function(e){var t=this;return function(r){if(r.kind===o.RuntimeInternalReasonKind.Unevaluated){var a="unexpected reason ".concat((0,p.anonymize)(r)),s="calc.runtime.CellEvaluationMachine.receiveFailure: ".concat(a);return(0,n.assertFalse)(s)}var l=r.kind===i.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:r;return t.writeFailure(e.source,l,e.precedents),d.Pledge.reject(t.isPrecedent?(0,i.previousFailure)(e.source.range):l)}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,i=(0,m.isBlankOper)(t)?n:t;if(e.kind===c.LexicalKind.Cell){if((0,m.isArrayOper)(i)){var o=void 0===i.opers[0]?f.naErrorOper:i.opers[0][0],a=(0,m.isBlankOper)(o)?n:o;if(!this.isLambdaEnabled(e,a,r))return;return this.context.globals.setCellValue(e.range,a,r)}if(!this.isLambdaEnabled(e,i,r))return;return this.context.globals.setCellValue(e.range,i,r)}var s=e.range.range,l=(0,h.broadcastWriteOper)(s.rows,s.cols,i).opers,u=function(e){return(0,m.isBlankOper)(e)?n:e},d=l.map((function(e){return e.map(u)}));if(this.isLambdaEnabled(e,d,r))return this.context.globals.setCellValues(e.range,d,r)},e.prototype.isLambdaEnabled=function(e,t,r){return!((Array.isArray(t)?t.some((function(e){return e.some((function(e){return e instanceof g.LambdaOper}))})):t instanceof g.LambdaOper)&&!(0,v.isFeatureEnabled)(v.FeatureName.CalcLambdaCellValues))||(this.context.globals.setCellFailure(e.range,(0,m.notImplemented)(["LAMBDA cell values"]),r),!1)},e}();t.createCellEvaluationMachine=function(e,t,r,n,i){return d.Pledge.try((function(){return new S(e,t,r,n,i).evalCell()}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCallTermEvaluationMachine=t.createFormulaEvaluationMachine=void 0;var n=r(10),i=r(27),o=r(12),a=r(12),s=r(12),l=r(12),u=r(12),c=r(12),d=r(21),f=r(20),p=r(16),m=r(44),h=r(14),g=r(14),v=r(11),S=r(49),y=r(9),C=r(17),R=r(53),b=r(75),N=r(36),T=r(178),P=r(117),E=r(13),k=r(115),O=r(116),A=r(17),I=r(114),_=r(62),F=r(28),M=function(){return(0,c.throwEvaluationError)((0,y.notImplemented)(["LETREC cycle"]))};function D(e,t){return{context:e,holeIndex:0,locals:t}}var w=function(){function e(e,t,r,i,o,a,s,l,c,d,f){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=i,this.visitedCells=o,this.visitedNames=a,this.usage=s,this.target=l,this.isNested=c,this.runStatus=!1,this.stackEnv=u.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],d.kind!==N.TermKind.CallLambda&&d.kind!==N.TermKind.CallFirstOrderFunc?(this.term=null!=t?(0,N.noopTerm)(d,void 0):d,this.caller=void 0):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",void 0===d.position),this.term=d,this.caller=d.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,f.length>0&&(this.stackEnv=f.reduce((function(e,t){var r=t.value;return e.setValue(e.getCount(),r)}),this.stackEnv),this.stackMapLabels=f.map((function(e){return e.label})),this.stackMapNumPushed=f.length)}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof c.EvaluationError)return(0,c.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return(0,p.isSuccess)(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if((0,N.isOperTerm)(this.term)){var e=this.continuation;if(0===e.length){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);var t=(0,P.dereferenceOper)(this,this.term,this.target),r=(0,k.coerceOper)(this,t,this.target);return this.precedents.bound=v.PrecsBound.Exact,!(0,b.isFeatureEnabled)(b.FeatureName.CalcPreventSpillingHack)||this.isNested||this.locals.lexicalSource.kind!==g.LexicalKind.Cell||!(0,y.isArrayOper)(r)||1===r.rows&&1===r.cols?(0,p.success)(r):(0,p.failure)((0,y.notImplemented)(["spilling"]))}var i=e[e.length-1];return this.applyContinuation(this.term,i)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r,i=t.context;switch(i.kind){case N.TermKind.App:var o=t.holeIndex,a=i.children.length;return(s=t.locals)[o]=e,o+1<a?this.nextHoleTransition(t,i.children[o+1]):this.dispatchFunction(s,i.data,i.position);case N.TermKind.Conditional:var s;if(0===(o=t.holeIndex)){var l=(0,N.worksheetFunctionNameToId)(i.data.funName),u=l===F.WorksheetFuncId.IF?E.OperKind.Boolean:E.OperKind.Number,c=(0,P.dereferenceOper)(this,e,u);if((0,y.isArrayOper)(c))return t.locals=[c],this.nextHoleTransition(t,i.children[o+1]);if((0,y.isRichOper)(c))return(0,p.failure)((0,y.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(c=(0,k.coerceOper)(this,c,u),l===F.WorksheetFuncId.IF&&(0,y.isBooleanOper)(c))return this.popContextTransition(i.children[c.value?1:2]);if(l===F.WorksheetFuncId.CHOOSE&&(0,y.isNumberOper)(c)){var d=this.context.globals.config.mathpack.fix(c);if(d<1||d>i.children.length-1){var f="CHOOSE; out of bounds option = ".concat((0,S.anonymize)(d));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",v.ErrorType.VALUE,f),this.popContextTransition(v.valueErrorOper)}return this.popContextTransition(i.children[d])}return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,y.isErrorOper)(c)),this.popContextTransition(c)}return(s=t.locals)[o]=e,o+1<i.children.length?this.nextHoleTransition(t,i.children[o+1]):this.dispatchFunction(s,i.data,i.position);case N.TermKind.CallName:var m=t.locals;return this.locals=m.locals,this.caller=m.caller,this.restoreStack(m),this.visitedNames=m.visitedNames,this.popContextTransition(e);case N.TermKind.Let:o=t.holeIndex;var h=i.children.length-1;if(o>=h){m=t.locals;return this.restoreStack(m),this.popContextTransition(e)}if(i.data.rec){var g=this.stackEnv.getCount()-h+o;this.stackEnv.getValue(g).value=e,this.stackEnv=this.stackEnv.setValue(g,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return o+1>=h&&this.isLetTcoPossible()?this.popContextTransition(i.children[o+1]):this.nextHoleTransition(t,i.children[o+1]);case N.TermKind.Array:var R=(0,P.dereferenceOper)(this,e,C.writeOperType),b=i.data,T=b.rows,O=b.cols,I=t.holeIndex,_=I%O,M=O===_+1,D=(I-_)/O,w=t.locals;if(w[D][_]=(0,k.coerceOper)(this,R,C.writeOperType),T===D+1&&M)return this.popContextTransition((0,v.arrayOper)(T,O,w));var L=M?D+1:D,x=M?0:_+1;return this.nextHoleTransition(t,i.children[L][x]);case N.TermKind.CallLambda:m=t.locals;return this.locals=m.locals,this.caller=m.caller,this.restoreStack(m),this.usage.lambdaDepth-=1,this.popContextTransition(e);case N.TermKind.CallFirstOrderFunc:m=t.locals;return this.locals=m.locals,this.caller=m.caller,this.restoreStack(m),this.popContextTransition(e);case N.TermKind.PostStep:var B=t.locals;return null===(r=this.stepConfig)||void 0===r||r.postStep(B,e),this.popContextTransition(e);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",i)}},e.prototype.reduceFormula=function(e){var t,r;switch(e.kind){case N.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case N.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case N.TermKind.App:var a=e.data.funName;if(!(0,N.isOperatorName)(a)){var s=(0,N.worksheetFunctionNameToId)(a);if(s!==F.WorksheetFuncId._UDF){var l=this.globals.getWorksheetFunc(s);if(l.kind===p.ResultKind.Failure)return(0,c.throwEvaluationError)(l.reason)}}if(0===e.children.length){var d=new T.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.position),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(a,e.data.funType,e.data.isFormulaRoot,[]);return this.updateTermTransition(d)}return this.pushContextTransition(e,e.children[0],[]);case N.TermKind.CallLambda:var m=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>(null!==(t=this.globals.limits.maxLambdaCalls)&&void 0!==t?t:1/0))return(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaCalls));if(!m&&this.usage.lambdaDepth+1>(null!==(r=this.globals.limits.maxLambdaDepth)&&void 0!==r?r:1/0))return(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaDepth));m||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;var g=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;var v=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;var S=this.locals;this.locals=(0,c.evalLocalsLambda)(e.data.capturedLocals,this.locals);var y=this.caller;return this.switchCaller(e.data.caller,m),m?this.updateTermTransition(e.children):this.pushContextTransition(e,e.children,{locals:S,caller:y,stackEnv:g,stackMap:v});case N.TermKind.CallFirstOrderFunc:S=this.locals;this.locals=(0,o.evalLocalsFirstOrderFunc)(e.data.source,this.locals);y=this.caller;this.switchCaller(e.data.caller,!1);g=this.stackEnv;this.stackEnv=u.emptyStackEnv;v=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(e,e.children,{locals:S,caller:y,stackEnv:g,stackMap:v});case N.TermKind.CallMachine:return(0,f.callMachineTransition)(e.data.machine,this);case N.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case N.TermKind.Let:var C=e.children.length-1;if(0===C)return this.updateTermTransition(e.children[0]);g=this.stackEnv,v=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=v,e.data.rec){for(var b=0;b<C;b+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new u.LazyOper(M));this.stackMapNumPushed+=C}return this.pushContextTransition(e,e.children[0],{stackEnv:g,stackMap:v});case N.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case N.TermKind.CallName:var P=e.data.loc,E=this.checkForNameCycle(P),k=this.stackFrameList(e.position);S=this.locals;this.locals=(0,c.evalLocalsName)((0,h.lexicalSourceName)(P),S);y=this.caller;this.switchCaller(k,!1);g=this.stackEnv;this.stackEnv=u.emptyStackEnv;v=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;var O=this.visitedNames;return this.visitedNames=E,this.pushContextTransition(e,e.children,{locals:S,caller:y,stackEnv:g,stackMap:v,visitedNames:O});case N.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case N.TermKind.ReadStack:var A=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==A),this.updateTermTransition(A instanceof u.LazyOper?A.value:A);case N.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case N.TermKind.Lambda:return this.updateTermTransition(new R.LambdaOper(e.data.minArity,e.data.maxArity,e.position,e.data.paramNodeLabels,e.data.paramNameLabels,this.locals,this.stackEnv,this.stackMapList(),e.data.defIdxs,e.children));case N.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=t.funName,i=t.funType,o=t.isFormulaRoot;(0,P.dereferenceOpers)(this,e,i);var a=new T.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,i,o,e);return this.popContextTransition(a)},e.prototype.stackFrameList=function(e){return(0,s.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)},e.prototype.stackMapList=function(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,a.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext},e.prototype.noopTerm=function(e,t){return null!=this.stepConfig?(0,N.noopTerm)(e,t):e},e.prototype.pushContextTransition=function(e,t,r){var n=D(e,r);return this.continuation.push(n),this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){if(this.term=e,null!=this.stepConfig&&!(0,N.isOperTerm)(e)&&void 0!==e.position&&e.kind!==N.TermKind.Name&&e.kind!==N.TermKind.Udf){var t=(r=this.locals.lexicalSource,n=e.position,o=this.stackEnv,a=this.stackMapList(),u=this.caller,c=(0,s.stackFrameList)(r,n,o,a,u),{stack:new l.ES5IterableStackFrame(c)});if(this.continuation.push(D(N.postStepTerm,t)),this.stepConfig.preStep(t)===i.StepAction.Break)return f.breakTransition}var r,n,o,a,u,c;return f.nextTransition},e.prototype.switchCaller=function(e,t){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",e.caller===this.caller),t||(this.caller=e)},e.prototype.restoreStack=function(e){var t,r=e.stackEnv,n=e.stackMap;this.stackEnv=r,this.stackMapLabels=null==n?void 0:n.labels,this.stackMapNumPushed=null!==(t=null==n?void 0:n.numPushed)&&void 0!==t?t:0,this.stackMapNext=null==n?void 0:n.next},e.prototype.isLetTcoPossible=function(){var e=this.continuation[this.continuation.length-2];if(void 0===e)return!1;var t=e.context;return t.kind===N.TermKind.Let?e.holeIndex>=t.children.length-1:t.kind===N.TermKind.CallLambda||t.kind===N.TermKind.CallName},e.prototype.isCallLambdaTcoPossible=function(){var e=this.continuation[this.continuation.length-1];return void 0!==e&&e.context.kind===N.TermKind.CallLambda},e.prototype.getNameFormulaAsTerm=function(e,t){var r=this.globals.getNameFormula(e,t);if(r.kind===p.ResultKind.Failure)return(0,c.throwEvaluationError)(r.reason);var n=r.value;return null!=n?(0,O.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);if(void 0!==n){var o=(0,m.recordNameCycle)(n,r.current);return(0,c.throwEvaluationError)(o)}return this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.NameChain)):(0,m.appendVisitedName)(this.visitedNames,e)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,(0,_.nameNode)((0,_.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.names,n),!(0,p.isSuccess)(r)){if(r.reason.kind===I.ResolveReasonKind.NoOriginSheet){var o="error ref, no sheet, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",v.ErrorType.REF,o),this.noopTerm(v.refErrorOper,e.position)}var a=e.children;return r.reason.kind===I.ResolveReasonKind.InvalidQualifier&&void 0!==a?a:(0,c.throwEvaluationError)(r.reason)}var s,l=r.value;if(void 0===l||void 0===(s=this.getNameFormulaAsTerm(l,e.data.source))){if(void 0===(a=e.children)){o="error ref, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",v.ErrorType.NAME,o),this.noopTerm(v.nameErrorOper,e.position)}return a}return(0,N.callNameTerm)(l,this.noopTerm(s,i.runtimePositionFormulaRoot),e.position)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,(0,_.cellRefNode)(e.data.ref,e.data.qualifier)).resolution;if(!(0,p.isSuccess)(t)){if(t.reason.kind===I.ResolveReasonKind.NoOriginSheet){var r="error ref, no sheet, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",v.ErrorType.REF,r),v.refErrorOper}return(0,c.throwEvaluationError)(t.reason)}var n=t.value;if(!n){r="error ref, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",v.ErrorType.REF,r),v.refErrorOper}return(0,v.range3DOper)(n.sheet,n.range)},e.prototype.evalStructRefTerm=function(e){var t=this.context.resolver.resolveStructRef(this.locals,e.data),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.names,n),!(0,p.isSuccess)(r)){if(r.reason.kind===I.ResolveReasonKind.NoOriginSheet){var i="error ref, no sheet, struct ref = ".concat((0,S.anonymize)(e.data));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",v.ErrorType.REF,i),v.refErrorOper}if(r.reason.kind===I.ResolveReasonKind.EmptyIntersection){i="error ref, empty intersection, struct ref = ".concat((0,S.anonymize)(e.data));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",v.ErrorType.VALUE,i),v.valueErrorOper}return(0,c.throwEvaluationError)(r.reason)}var o=r.value;if(!o){i="error ref, struct ref = ".concat((0,S.anonymize)(e.data));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",v.ErrorType.REF,i),v.refErrorOper}return(0,v.range3DOper)(o.sheet,o.range)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,_.nameNode)((0,_.identNamePart)(e.data.name,!0),e.data.qualifier)),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.udfs,n),!(0,p.isSuccess)(r)){var i=e.children;if(r.reason.kind===I.ResolveReasonKind.InvalidQualifier&&void 0!==i)return i;(0,c.throwEvaluationError)(r.reason)}var o=r.value;if(!o){if(void 0===(i=e.children)){var a="UDF resolution, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",v.ErrorType.NAME,a),this.noopTerm(v.nameErrorOper,e.position)}return i}if(o.length>1){a="UDF resolution, ambiguous name";return(0,A.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",v.ErrorType.NAME,a),this.noopTerm(v.nameErrorOper,e.position)}var s=o[0],l=this.globals.getUserDefinedFunc(s);return(0,p.isSuccess)(l)||(0,c.throwEvaluationError)(l.reason),new T.UdfOper(s,l.value)},e}();t.createFormulaEvaluationMachine=function(e,t,r,o,a,s,l,u){var d,f=r.contextNames,p=void 0===f?[]:f,m=u.annotations[u.node.label],h=null!==(d=(null==m?void 0:m.kind)===_.AnnotationKind.FormulaRoot?m.contextNames:void 0)&&void 0!==d?d:[];return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",h.length===p.length&&p.every((function(e,t){return e.label===h[t].label}))),new w(e,t,r,o,a,s,(0,c.evalUsage)([0],0),l,!1,(0,N.noopTerm)((0,O.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",u),i.runtimePositionFormulaRoot),p)},t.createCallTermEvaluationMachine=function(e,t,r,n,i,o,a,s){return new w(e,t,r,n,i,o,(0,c.evalUsage)(a.lambdaCalls,a.lambdaDepth),E.SignatureType.All,!0,s,[])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n=r(1);t.anonymizeFormula=n.printService.anonymizeFormula,t.createPrinter=n.printService.createPrinter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(5);t.createNumberFormatter=n.formatService.createNumberFormatter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var n=r(3);t.createParser=n.parserService.createParser},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(2);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sqrtpi=t.factdouble=t.fact=t.quotient=t.radians=t.degrees=t.sign=t.abs=t.odd=t.even=t.floor_precise=t.floor_math=t.floor=t.ceiling_precise=t.ceiling_math=t.ceiling=t.mround=t.rounddown=t.roundup=t.trunc=t.round=t.int=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.log10=t.ln=t.power=t.exp=t.sqrt=t.pi=void 0;var n=r(54),i=r(11),o=r(9);function a(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return i.numErrorOper;if(0===n||0===a)return e.zero;var s=e.div(t,r);return(0,o.isErrorOper)(s)?s:e.mul(e.ceil(e.viewRound(s)),r)}function s(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return i.numErrorOper;if(0===n&&0===a)return t;var s=e.div(t,r);return(0,o.isErrorOper)(s)?s:e.mul(e.floor(e.viewRound(s)),r)}function l(e,t,r){var i=r[0],o=t.mathpack;if(o.cond(i)>=0){var a=o.ceil(i);return 0===o.cond2((0,n.assertNumber)((0,n.numMod)(o,a,o.fromNumber(2))),o.one)===e?o.add(a,o.one):a}var s=o.floor(i);return 0===o.cond2((0,n.assertNumber)((0,n.numMod)(o,s,o.fromNumber(2))),o.one)===e?o.sub(s,o.one):s}t.pi=function(e,t){return e.mathpack.pi},t.sqrt=(0,n.wrap1)((function(e){return e.mathpack.sqrt})),t.exp=(0,n.wrap1)((function(e){return e.mathpack.exp})),t.power=(0,n.wrap2)((function(e){return e.mathpack.power})),t.ln=(0,n.wrap1)((function(e){return e.mathpack.ln})),t.log10=(0,n.wrap1)((function(e){return e.mathpack.log})),t.log=function(e,t){var r=t[0],n=t[1],i=e.mathpack;if(void 0===n)return i.log(r);var a=i.ln(r);if((0,o.isErrorOper)(a))return a;var s=i.ln(n);return(0,o.isErrorOper)(s)?s:i.div(a,s)},t.sin=(0,n.wrap1)((function(e){return e.mathpack.sin})),t.cos=(0,n.wrap1)((function(e){return e.mathpack.cos})),t.tan=(0,n.wrap1)((function(e){return e.mathpack.tan})),t.asin=(0,n.wrap1)((function(e){return e.mathpack.asin})),t.acos=(0,n.wrap1)((function(e){return e.mathpack.acos})),t.atan=(0,n.wrap1)((function(e){return e.mathpack.atan})),t.atan2=(0,n.wrap2)((function(e){return e.mathpack.atan2})),t.int=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.round=(0,n.wrap2)((function(e){return e.mathpack.round})),t.trunc=function(e,t){var r=t[0],n=t[1],i=void 0===n?e.mathpack.zero:n;return e.mathpack.roundDown(r,i)},t.roundup=(0,n.wrap2)((function(e){return e.mathpack.roundUp})),t.rounddown=(0,n.wrap2)((function(e){return e.mathpack.roundDown})),t.mround=function(e,t){var r=t[0],a=t[1],s=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(s))return s;var l=(0,n.chkNumOper)(e,a);if((0,o.isErrorOper)(l))return l;var u=e.mathpack;if(0===u.cond(l))return u.zero;if(0!==u.cond(s)&&u.cond(s)<0!=u.cond(l)<0)return i.numErrorOper;var c=u.div(s,l);if((0,o.isErrorOper)(c))return i.numErrorOper;var d=u.floor(c),f=(0,n.assertNumber)(u.sub(c,d)),p=u.fromNumber(.5-5e-15);if(u.cond2(f,p)<0)return u.mul(d,l);var m=u.add(d,u.one);return(0,o.isErrorOper)(m)?m:u.mul(m,l)},t.ceiling=function(e,t){var r=t[0],n=t[1];return a(e.mathpack,r,n)},t.ceiling_math=function(e,t){var r=t[0],n=t[1],i=t[2],s=e.mathpack,l=void 0===n||(0,o.isMissingOper)(n)?s.one:s.abs(n),u=void 0===i||(0,o.isMissingOper)(i)?s.zero:i;return 0!==s.cond(u)&&s.cond(r)<0&&(l=s.neg(l)),0===s.cond(l)?s.zero:a(s,r,l)},t.ceiling_precise=function(e,t){var r=t[0],n=t[1],i=e.mathpack,s=void 0===n||(0,o.isMissingOper)(n)?i.one:i.abs(n);return 0===i.cond(s)?i.zero:a(i,r,s)},t.floor=function(e,t){var r=t[0],n=t[1];return s(e.mathpack,r,n)},t.floor_math=function(e,t){var r=t[0],n=t[1],i=t[2],a=e.mathpack,l=void 0===n||(0,o.isMissingOper)(n)?a.one:a.abs(n),u=void 0===i||(0,o.isMissingOper)(i)?a.zero:i;return 0!==a.cond(u)&&a.cond(r)<0&&(l=a.neg(l)),0===a.cond(l)?a.zero:s(a,r,l)},t.floor_precise=function(e,t){var r=t[0],n=t[1],i=e.mathpack,a=void 0===n||(0,o.isMissingOper)(n)?i.one:i.abs(n);return 0===i.cond(a)?i.zero:s(i,r,a)},t.even=l.bind(void 0,!0),t.odd=l.bind(void 0,!1),t.abs=(0,n.wrap1)((function(e){return e.mathpack.abs})),t.sign=function(e,t){var r=t[0],n=e.mathpack;return n.fromNumber(n.cond(r))},t.degrees=function(e,t){var r=t[0],i=e.mathpack,o=(0,n.assertNumber)(i.div(i.fromNumber(180),i.pi));return i.mul(r,o)},t.radians=function(e,t){var r=t[0],i=e.mathpack,o=(0,n.assertNumber)(i.div(i.pi,i.fromNumber(180)));return i.mul(r,o)},t.quotient=function(e,t){var r=t[0],a=t[1],s=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(s))return s;var l=(0,n.chkNumOper)(e,a);if((0,o.isErrorOper)(l))return l;var u=e.mathpack;if(0===u.cond(l))return i.div0ErrorOper;var c=u.div(s,l);return(0,o.isErrorOper)(c)?i.numErrorOper:u.cond(c)>0?u.floor(c):u.ceil(c)},t.fact=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return i.numErrorOper;for(var s=n.one,l=a;l>0;l-=1){if((0,o.isErrorOper)(s))return s;s=n.mul(n.fromNumber(l),s)}return s},t.factdouble=function(e,t){var r=t[0],a=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(a))return a;var s=e.mathpack,l=s.floor(a);if(s.cond2(l,s.fromNumber(-1))<0||s.cond2(l,s.fromNumber(300))>0)return i.numErrorOper;for(var u=s.one,c=s.toNumber(l);c>1;c-=2){if((0,o.isErrorOper)(u))return u;u=s.mul(s.fromNumber(c),u)}return u},t.sqrtpi=function(e,t){var r=t[0],a=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(a))return a;var s=e.mathpack;if(s.cond(a)<0)return i.numErrorOper;var l=s.mul(s.pi,a);return(0,o.isErrorOper)(l)?l:s.sqrt(l)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;var n,i,o=(0,r(128).createPerf)();t.watchdog=(n=1/0,(i=function(e){if(void 0===e&&(e=""),o.now()>n)throw new Error("Time limit exceeded with message: ".concat(e))}).arm=function(e){n=o.now()+e},i)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0;function n(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}t.createPerf=n;var i=function(){function e(e){this.perf=n(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var n=r(2);t.setImmediateUnified=n.setTimeoutInterfaceModule.setImmediateUnified,t.clearTimerUnified=n.setTimeoutInterfaceModule.clearTimerUnified,t.defaultSetTimeoutInterface=n.setTimeoutInterfaceModule.defaultSetTimeoutInterface},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=function(e,t){return(e<<t|e>>>32-t)>>>0},i=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-n(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^n(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();t.JSF32=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(n=Math.log2)&&void 0!==n?n:function(e){return Math.log(e)*Math.LOG2E}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(228);t.globalThis=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var n=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var i=n,o=1+(n<<1),a=2+(n<<1);if(o<=r&&this.cmp(this.items[o],t)<0&&(i=o),a<=r&&this.cmp(this.items[a],i===o?this.items[i]:t)<0&&(i=a),n===i)break;this.items[n]=this.items[i],n=i}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}();t.BinaryHeap=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var n,i=r(0),o=r(0).__assign;function a(e,t,r){return void 0===r&&(r=10),function(n){if(void 0!==n.split)return n.split;var i=e(n),o=n===t?0:n.depth;return void 0!==o&&o<r&&(n.split=i,i[0][0].depth=o+1,i[1][0].depth=o+1),i}}function s(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function l(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:s(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,r.root))}function u(e,r,n,i){if(i===t.empty)return n;if(i===t.dense)return i;if(n===t.empty)return i;if(n===t.dense)return n;if(n.isExact&&i.isExact){var o=function(e,r,n,i){var o=n.key,a=i.key,s=e.compare(o,a);if(void 0!==s)return s<0?i:n;var l=e.union(o,a);if(void 0!==l){var u=e.compare(l,r);return void 0!==u&&0===u?t.dense:y(e,r,l,!0)}return}(e,r,n,i);if(void 0!==o)return o}var a=C(e,r,n),s=C(e,r,i),l=e.split(r),c=l[0][0],d=l[1][0];return g(e,c,d,u(e,c,a.left,s.left),u(e,d,a.right,s.right))}function c(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return i;if(n===t.dense)return i;if(i===t.dense)return n;if(n.isExact&&i.isExact){var o=function(e,r,n,i){var o=n.key,a=i.key;if(!e.meets(o,a))return t.empty;var s=e.compare(o,a);if(void 0!==s)return s<0?n:i;var l=e.intersect(o,a);if(void 0!==l)return y(e,r,l,!0);return}(e,r,n,i);if(void 0!==o)return o}var a=C(e,r,n),s=C(e,r,i),l=e.split(r),u=l[0][0],d=l[1][0];return g(e,u,d,c(e,u,a.left,s.left),c(e,d,a.right,s.right))}function d(e,r,n,i){if(n===t.empty||i===t.empty)return!1;if(n===t.dense||i===t.dense)return!0;if(n.isExact&&i.isExact)return e.meets(n.key,i.key);var o=C(e,r,n),a=C(e,r,i),s=e.split(r),l=s[0][0],u=s[1][0];return d(e,l,o.left,a.left)||d(e,u,o.right,a.right)}function f(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?s(r.setOperations,p(r.setOperations,r.setOperations.top,e,r.root)):s(e.setOperations,p(e.setOperations,e.setOperations.top,e.root,r.root))}function p(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return n;if(i===t.dense)return t.empty;if(n===t.dense){var o=C(e,r,i),a=e.split(r),s=a[0][0],l=a[1][0];return g(e,s,l,p(e,s,t.dense,o.left),p(e,l,t.dense,o.right))}if(n.isExact&&i.isExact){var u=function(e,t,r,n){var i=r.key,o=n.key;if(!e.meets(i,o))return r;var a=e.except(i,o);if(void 0!==a)return y(e,t,a,!0);return}(e,r,n,i);if(void 0!==u)return u}var c=C(e,r,n),d=C(e,r,i),f=e.split(r),m=f[0][0],h=f[1][0];return g(e,m,h,p(e,m,c.left,d.left),p(e,h,c.right,d.right))}function m(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function h(e,r,n,i){if(n===i)return 0;if(n===t.empty)return-1;if(i===t.empty)return 1;if(n===t.dense)return i===t.dense?0:1;if(i===t.dense)return-1;if(n.isExact&&i.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,i);var o=C(e,r,n),a=C(e,r,i),s=e.split(r),l=s[0][0],u=s[1][0],c=h(e,l,o.left,a.left);if(void 0!==c){var d=h(e,u,o.right,a.right);if(void 0!==d)return m(c,d)}}function g(e,r,n,i,o){return i===t.empty?o===t.empty?t.empty:o===t.dense?v(i,o,void 0,!1,e.infimum(n,n),e.supremum(n,n)):v(i,o,void 0,!1,o.infimum,o.supremum):o===t.empty?i===t.dense?v(i,o,void 0,!1,e.infimum(r,r),e.supremum(r,r)):v(i,o,void 0,!1,i.infimum,i.supremum):i===t.dense?o===t.dense?t.dense:v(i,o,void 0,!1,e.combineInfima(e.infimum(r,r),o.infimum),e.combineSuprema(e.supremum(r,r),o.supremum)):o===t.dense?v(i,o,void 0,!1,e.combineInfima(i.infimum,e.infimum(n,n)),e.combineSuprema(i.supremum,e.supremum(n,n))):v(i,o,void 0,!1,e.combineInfima(i.infimum,o.infimum),e.combineSuprema(i.supremum,o.supremum))}function v(e,t,r,n,i,o){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:o}}function S(e,r,n){if(!e.meets(r,n))return t.empty;var i=e.compare(r,n);if(void 0!==i)return i<=0?t.dense:y(e,r,n,!0);var o=e.intersect(r,n);return void 0!==o?y(e,r,o,!0):y(e,r,n,!1)}function y(e,t,r,n){return v(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function C(e,r,n){if(void 0!==n.left)return n;var i=e.split(r),a=i[0][0],s=i[1][0],l=g(e,a,s,S(e,a,n.key),S(e,s,n.key));if(l===t.empty||l===t.dense)throw new Error("incorrect set operations implementation");var u=l;return o(n,{left:u.left,right:u.right})}function R(e,r,n){return function r(i,o){if(o===t.empty)return!0;if(o===t.dense)return n(i);if(o.isExact)return n(o.key);var a=C(e,i,o),s=e.split(i),l=s[0][0],u=s[1][0];return r(l,a.left)&&r(u,a.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(n=t.SetKind||(t.SetKind={})),t.cacheKeySplitting=a,t.createFromKey=function(e){var t=i.__assign(i.__assign({},e),{split:a(e.split,e.top)});return function(e){return s(t,S(t,t.top,e))}},t.fromUntyped=s,t.union=l,t.unionUntyped=u,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:s(e.setOperations,c(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=c,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||d(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=d,t.except=f,t.exceptUntyped=p,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:h(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=m,t.compareUntyped=h,t.dense=n.Dense,t.empty=n.Empty,t.lazy=S,t.symmetricDiff=function(e,t){return l(f(e,t),f(t,e))},t.complement=function(e){return f(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:function e(r){if(void 0===r||r===t.empty||r===t.dense)return 0;return e(r.left)+e(r.right)+1}(e.root)},t.forEachKey=function(e,r){return e===t.empty||R(e.setOperations,e.root,r)},t.forEachKeyUntyped=R},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;var n=r(4),i=r(46),o={},a=0;t.logCollisionKey=function(e){!function(e){var t=o[e];o[e]=(void 0===t?0:t)+1,(a+=1)%100==0&&(i.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(o),".")),o={})}(function(e){return"object"==typeof e?null===e?"null":"Object {".concat(Object.keys(e),"}"):typeof e}(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(29);t.ivlJoin=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return[(0,n.fastMin)(r,o),(0,n.fastMax)(i,a)]},t.ivlMeet=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return[(0,n.fastMax)(r,o),(0,n.fastMin)(i,a)]},t.ivlDistance=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return.5*(0,n.fastAbs)(r+i-(o+a))},t.ivlMeets=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return(0,n.fastMax)(r,o)<(0,n.fastMin)(i,a)},t.ivlMeetsOrTouches=function(e,t){var r=e[0],i=e[1],o=t[0],a=t[1];return(0,n.fastMax)(r,o)<=(0,n.fastMin)(i,a)},t.ivlExcept=function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1];return r<i&&o>=n?[r,i]:r>=i&&o<n?[o,n]:void 0},t.ivlCompare=function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1];return r===i&&n===o?0:r>=i&&n<=o?-1:r<=i&&n>=o?1:void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var n,i,o=r(46);!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(n=t.Color||(t.Color={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(i||(i={}));var a=n.Red,s=n.Black,l=i.DoubleBlack,u={c:s,l:void 0,r:void 0},c={c:l,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function f(e){return void 0===e.l}function p(e){return e.c===a}function m(e){return e.c===s&&void 0!==e.l}function h(e){return e.c===s&&void 0===e.l}function g(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function v(e,t){return g(e,t.l,t.key,t.value,t.r)}function S(e){return f(e)?u:v(s,e)}function y(e,t,r){if(!f(r)){var n=e.keyCompare(t,r.key);return n<0?y(e,t,r.l):n>0?y(e,t,r.r):r}}function C(e,t){return!!f(t)||!!C(e,t.l)&&(!!e(t.key,t.value)&&C(e,t.r))}function R(e,t,r,n,i){if(e===s){if(p(t)&&p(t.l))return g(a,v(s,t.l),t.key,t.value,g(s,t.r,r,n,i));if(p(i)&&p(i.r))return g(a,g(s,t,r,n,i.l),i.key,i.value,v(s,i.r));if(p(t)&&p(t.r))return g(a,g(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,g(s,t.r.r,r,n,i));if(p(i)&&p(i.l))return g(a,g(s,t,r,n,i.l.l),i.l.key,i.l.value,g(s,i.l.r,i.key,i.value,i.r))}if(e===l){if(p(i)&&p(i.l))return g(s,g(s,t,r,n,i.l.l),i.l.key,i.l.value,g(s,i.l.r,i.key,i.value,i.r));if(p(t)&&p(t.r))return g(s,g(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,g(s,t.r.r,r,n,i))}return g(e,t,r,n,i)}function b(e,t,r,n,i){return e===a&&t.c===l&&m(i)?R(s,g(a,S(t),r,n,i.l),i.key,i.value,i.r):e===a&&m(t)&&i.c===l?R(s,t.l,t.key,t.value,g(a,t.r,r,n,S(i))):e===s&&t.c===l&&m(i)?R(l,g(a,S(t),r,n,i.l),i.key,i.value,i.r):e===s&&m(t)&&i.c===l?R(l,t.l,t.key,t.value,g(a,t.r,r,n,S(i))):e===s&&t.c===l&&p(i)&&m(i.l)?g(s,R(s,g(a,S(t),r,n,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===s&&p(t)&&m(t.r)&&i.c===l?g(s,t.l,t.key,t.value,R(s,t.r.l,t.r.key,t.r.value,g(a,t.r.r,r,n,S(i)))):((0,o.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==l&&i.c!==l),g(e,t,r,n,i))}function N(e,t,r,n){return function(e){return!p(e)||e.l.c!==a&&e.r.c!==a?e:v(s,e)}(function e(t,r,n,i){if(f(i))return g(a,u,r,n,u);var o=t.keyCompare(r,i.key);return o<0?R(i.c,e(t,r,n,i.l),i.key,i.value,i.r):o>0?R(i.c,i.l,i.key,i.value,e(t,r,n,i.r)):g(i.c,i.l,r,n,i.r)}(e,t,r,n))}function T(e,t,r){if(f(r))return r;if(r.c===a&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?u:r;if(r.c===s&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&p(r.l)&&h(r.l.l)&&h(r.l.r)&&h(r.r)){var n=e.keyCompare(t,r.key);return n<0?g(s,T(e,t,r.l),r.key,r.value,u):n>0?r:g(s,u,r.l.key,r.l.value,u)}var i=e.keyCompare(t,r.key);if(i<0)return b(r.c,T(e,t,r.l),r.key,r.value,r.r);if(i>0)return b(r.c,r.l,r.key,r.value,T(e,t,r.r));(0,o.assertTrue)("calc.common.rbTree.rem: expected node",!f(r.r));var l=function e(t){if(t.c===a&&h(t.l)&&h(t.r))return[t.key,t.value,u];if(t.c===s&&h(t.l)&&h(t.r))return[t.key,t.value,c];if(t.c===s&&h(t.l)&&p(t.r))return[t.key,t.value,v(s,t.r)];(0,o.assertTrue)("calc.common.rbTree.remMin: expected node",!f(t.l));var r=e(t.l),n=r[0],i=r[1],l=r[2];return[n,i,b(t.c,l,t.key,t.value,t.r)]}(r.r),d=l[0],m=l[1],S=l[2];return b(r.c,r.l,d,m,S)}function P(e,t,r){var n=T(e,t,function(e){return m(e)&&e.l.c===s&&e.r.c===s?v(a,e):e}(r));return(0,o.assertTrue)("calc.common.rbTree.remove: expected R|B",n.c===a||n.c===s),n}t.fromUntyped=d,t.isLeaf=f,t.emptyUntyped=u,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=y,t.find=function(e,t){return y(t.ops,e,t.root)},t.forEachUntyped=C,t.forEach=function(e,t){return C(e,t.root)},t.insertUntyped=N,t.insert=function(e,t,r){return d(r.ops,N(r.ops,e,t,r.root))},t.removeUntyped=P,t.remove=function(e,t){return d(t.ops,P(t.ops,e,t.root))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var n=r(0),i=r(46);function o(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return{kind:"Immediate",timer:setImmediate.apply(void 0,n.__spreadArray([e],t,!1))}}function a(e){switch(e.kind){case"Immediate":clearImmediate(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,i.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=o,t.clearTimerUnified=a,t.defaultSetTimeoutInterface={setImmediate:o,setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return{kind:"Timeout",timer:setTimeout.apply(void 0,n.__spreadArray([e,t],r,!1))}},clearImmediate:a,clearTimeout:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;var n=r(4),i={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((function(e){return i.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),t.initStopwatch=function(e){i.ULS=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromise=void 0;var n=r(94),i=function(){function e(){var e=this;this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),(0,n.isThenable)(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),(0,n.isThenable)(e)?this.promise.then():void 0},e}();t.ResolvablePromise=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var n,i=r(0),o=r(95);function a(e,t,r){return{kind:e,machine:t,receiver:r}}function s(e,t){return a(n.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(n=t.TransitionKind||(t.TransitionKind={})),t.nextTransition=a(n.Next,void 0,void 0),t.breakTransition=a(n.Break,void 0,void 0),t.callMachineTransition=s;var l={receiveResult:function(e){return(0,o.isSuccess)(e)?t.nextTransition:e}};t.nextOnSuccessReceiver=function(){return l};var u=function(e){function t(t,r){var n=this.constructor,i=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;i.machine=t,i.stackDepth=r;var o=n.prototype;return Object.getPrototypeOf(i)!==o&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(i,o):i.__proto__=o),i}return i.__extends(t,e),t}(Error);t.MachineCycle=u;var c=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(s(e,{receiveResult:function(e){return e}})),this.transition=t.nextTransition}catch(e){this.transition=(0,o.failure)((0,o.javaScriptError)(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new u(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case n.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case n.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case n.Break:return this.transition=t.nextTransition,e;default:var r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,o.failure)((0,o.javaScriptError)(e)),t.nextTransition}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r.kind===n.Break)return r;if(r.kind!==n.Next)return this.result=r;if(t())return e.numPauses+=1,r}}catch(e){return this.result=(0,o.failure)((0,o.javaScriptError)(e))}},e.prototype.runToResult=function(){for(;;){var e=this.run();if(e.kind!==n.Break)return e}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}();t.MachineRuntime=c;var d=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?s(this.machines[this.values.length],this):(0,o.success)(this.values)},e.prototype.receiveResult=function(e){return(0,o.isSuccess)(e)?(this.values.push(e.value),this.next()):e},e}();t.AllMachine=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCharCodeBits=void 0;var n=r(2).unicode.makeGetCharCodeBits;t.getCharCodeBits=n([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;var n=r(18),i=r(25),o=r(58),a=r(59),s=r(98),l=r(78),u=r(37),c=l.codePointSpace,d=l.codePointLF,f=l.codePointMinusSign,p=l.codePointPlusSign,m=l.codePointSlash;function h(e){return e===c||e===d}function g(e,t,r,o){(0,i.assertIndex)("calc.parse.parseUint",t,16);for(var s=0,l=o,u=r.length;l<u;){var c=(0,a.stringCodePointAt)(r,l);if(!e.isNumeral(c))break;var d=e.getOrdinal(c);0===s&&0!==d&&(u=(0,n.fastMin)(u,l+t)),s=10*s+d,l+=(0,a.numCodeUnits)(c)}return l===u&&l<r.length&&e.isNumeral((0,a.stringCodePointAt)(r,l))?[0,o]:[s,l]}function v(e,t,r,n){var o=n,a=g(e,5,r,o),s=a[0],l=a[1];if(l===o)return!1;if(s>32767)return!1;if(!((o=l)<r.length&&r.charCodeAt(o)===m))return!1;var c=g(e,5,r,o+=1),d=c[0],f=c[1];if(f===o)return!1;if(d>32767)return!1;if(o=f,0===d)return[!1,0,o];var p=t.div(t.fromNumber(s),t.fromNumber(d));return(0,i.assertTrue)("calc.lang.tryTokenizeFrac",(0,u.isNumberOper)(p)),[p,d,o]}function S(e,t,r,l,c,d,m){var S,y,C,R=l,b=0,N="",T=!1,P=!1,E=s.NumberShape.ASCII;if((0,o.stringStartsWith)(r,e.decimalSeparator,l)||l<r.length&&e.isNumeral((0,a.stringCodePointAt)(r,l))){for(var k=function(){if((d||c&&r.indexOf("%",R)>=0)&&(b-=2,void 0!==S)){var o=t.div(S,t.fromNumber(100));(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,u.isNumberOper)(o)),S=o,C=s.KnownFormat.Pct}if((0,n.fastAbs)(b)>=309)return{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C};var a=t.parse(e,!0,b,N);if(void 0!==S){var l=t.add(a,S);(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,u.isNumberOper)(l)),a=l}return{value:a,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}};R<r.length;){var O=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(O))break;if(0!==e.getOrdinal(O))break;(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O)}if(m)if(!1!==(F=v(e,t,r,R))){var A=F[0],I=F[1],_=F[2];return R=_,!1===A?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:(C=I>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,S=A,k())}for(var F,M=R;R<r.length;){O=(0,a.stringCodePointAt)(r,R);if(e.isNumeral(O))b+=1,(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O);else{if(!(c&&b>0&&(0,o.stringStartsWith)(r,e.thousandsSeparator,R)))break;T=!0,R+=e.thousandsSeparator.length}}if(N+=r.substring(M,R),T){var D=function(e,t,r){for(var n=r,i="",o=0;o<t.length;){var s=(0,a.stringCodePointAt)(t,o);if(e.isNumeral(s)){var l=(0,a.numCodeUnits)(s);i+=t.substring(o,o+l),o+=l,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;o+=e.thousandsSeparator.length}}return i}(e,N,b);if(void 0===D)return;N=D}if(l<R&&R<r.length&&h(r.charCodeAt(R)))if(!1!==(F=v(e,t,r,R+1))){A=F[0],I=F[1],_=F[2];return R=_,!1===A?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:(C=I>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,S=A,k())}var w=!1;if((0,o.stringStartsWith)(r,e.decimalSeparator,R)&&(w=R===l,P=!0,R+=e.decimalSeparator.length),0===b)for(;R<r.length;){O=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(O))break;if(0!==e.getOrdinal(O))break;b-=1,(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O)}for(M=R;R<r.length;){O=(0,a.stringCodePointAt)(r,R);if(!e.isNumeral(O))break;(y=e.getNumberShape(O))!==s.NumberShape.ASCII&&(E=y),R+=(0,a.numCodeUnits)(O)}if(N+=r.substring(M,R),!(w&&R<=l+e.decimalSeparator.length)){var L=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,o.stringStartsWith)(t,"**",n))return[0,r];n+=2}var i=!1;if(n<t.length){var s=(0,a.stringCodePointAt)(t,n);((i=s===f)||s===p)&&(n+=(0,a.numCodeUnits)(s))}if(n>=t.length||!e.isNumeral((0,a.stringCodePointAt)(t,n)))return!1;var l=g(e,10,t,n),u=l[0],c=l[1];return c!==n&&(!(u>2147483647)&&[i?-u:u,c])}(e,r,R);if(!1!==L){var x=L[0];_=L[1];b+=x,_!==R&&(C=s.KnownFormat.Exp),R=_}return!1===L?{value:void 0,i:R,consumedThousands:T,consumedDecimal:P,numShape:E,format:C}:k()}}}t.isSpace=h,t.isLineBreak=function(e){return e===d},t.parseUint=g,t.parseNumberLiteral=S,t.parseSignedLiteral=function(e,t,r,n,i){var o=n,a=!1;if(o<r.length){var s=r.charCodeAt(o);if((s===p||s===f)&&(a=s===f,o+=1,i))for(;o<r.length&&h(r.charCodeAt(o));)o+=1}var l=S(e,t,r,o,!1,!1,!1);return void 0===(null==l?void 0:l.value)?[t.zero,n]:(o=l.i,[a?t.neg(l.value):l.value,o])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(2);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";var n,i,o,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var u=r(4);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return u.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return u.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return u.NulLogger}});var c=r(18),d=r(25);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return d.ulsLogger}});var f,p,m,h,g,v,S=r(65),y=r(58),C=r(59),R=r(142),b=r(267),N=r(56),T=r(24),P=r(98),E=r(146),k=r(149);function O(e,t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,b,N,T,P,E,k,O,A,I,_,F,M,D,w,L,x,B,U,G,K,V,j,W,H,Q,q,z,Y,J,X,$,Z,ee,te,re,ne,ie,oe,ae,se,le,ue,ce,de,fe,pe){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:o,isIdentStart:a,isIdentContinue:s,stringCompareCI:l,errorNames:u,specialRefNames:c,trueName:d,falseName:f,rowLetter:p,columnLetter:m,leftBrace:h,rightBrace:g,leftBracket:v,rightBracket:S,rcLeftBracket:y,rcRightBracket:C,decimalSeparator:R,listSeparator:b,columnSeparator:N,rowSeparator:T,thousandsSeparator:P,statementSeparator:E,lcid:k,country:O,isThai:A,isEastAsia:I,isKorea:_,isJapan:F,isChinaT:M,isChinaS:D,isComplexScript:w,numberDecimals:L,isExpSepBySpace:x,fractionSeparator:B,isPercentSepBySpace:U,currencyFormat:G,isCurrencySymbolLead:K,isCurrencySepBySpace:V,currencySymbol:j,currencyDecimals:W,dateOrder:H,dateSeparator:Q,dateAltSeparator:q,year4Digits:z,month2Digits:Y,day2Digits:J,longDateFormat:X,timeSeparator:$,timeAltSeparator:Z,hour2Digits:ee,clock24Hour:te,isAMPMSepBySpace:re,ampmSymbols:ne,dayNameShort:ie,dayNameLong:oe,monthNameShort:ae,monthNameLong:se,pictureSpecial:le,pictureSingle:ue,pictureColor:ce,pictureDbnum:de,sysDateFormat:fe,sysTimeFormat:pe}}function A(e){var t=0|e;if(t<128)return t>=48&&t<58;var r=15&t;switch(2147483632&t){case 1632:case 1776:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 3664:case 3792:case 3872:case 4160:return r<=9;case 4960:return r>=9;case 4976:return r<=1;case 6112:case 6160:return r<=9;default:return!1}}function I(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getOrdinal"),15&t;var r,n=15&t;switch(2147483632&t){case 1632:case 1776:r=n;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:r=n-6;break;case 3664:case 3792:case 3872:case 4160:r=n;break;case 4960:r=n-8;break;case 4976:r=n+8;break;case 6112:case 6160:r=n;break;default:return(0,d.assertFalse)("calc.config.getOrdinal")}return(r<0||r>9||4968===t)&&(0,d.assertFalse)("calc.config.getOrdinal"),r}function _(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getNumberShape"),P.NumberShape.ASCII;switch(A(t)||(0,d.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return P.NumberShape.ArabicIndic;case 1776:return P.NumberShape.ExtendedArabicIndic;case 2400:return P.NumberShape.Devanagari;case 2528:return P.NumberShape.Bengali;case 2656:return P.NumberShape.Gurmukhi;case 2784:return P.NumberShape.Gujarati;case 2912:return P.NumberShape.Oriya;case 3040:return P.NumberShape.Tamil;case 3168:return P.NumberShape.Telugu;case 3296:return P.NumberShape.Kannada;case 3424:return P.NumberShape.Malayalam;case 3664:return P.NumberShape.Thai;case 3792:return P.NumberShape.Lao;case 3872:return P.NumberShape.Tibetan;case 4160:return P.NumberShape.Myanmar;case 4960:case 4976:return P.NumberShape.Ethiopic;case 6112:return P.NumberShape.Khmer;case 6160:return P.NumberShape.Mongolian;default:return(0,d.assertFalse)("calc.config.getNumberShape")}}function F(e){return 0!=((0,R.getCharCodeBits)(e)&C.CharCodeBits.IdentStartClass)}function M(e){return 0!=((0,R.getCharCodeBits)(e)&C.CharCodeBits.IdentContinueClass)}t.calcConfig=function(e,t,r,n,i,o,a){return void 0===t&&(t=T.RefStyle.A1),void 0===r&&(r=k.xlMathpack),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===o&&(o=E.tzUTC),void 0===a&&(a=E.xlDatepack),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:o,datepack:a}},t.localeInfo=O,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(f=t.Country||(t.Country={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(p=t.LCID||(t.LCID={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(m=t.PictureSpecial||(t.PictureSpecial={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(h=t.PictureSingle||(t.PictureSingle={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(g=t.PictureColor||(t.PictureColor={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(v=t.PictureDbnum||(t.PictureDbnum={})),t.isNumeral=A,t.getOrdinal=I,t.getNumberShape=_,t.isIdentStart=F,t.isIdentContinue=M,t.englishErrorNames=(0,y.partialArray)(((n={})[N.ErrorType.NULL]="#NULL!",n[N.ErrorType.DIV0]="#DIV/0!",n[N.ErrorType.VALUE]="#VALUE!",n[N.ErrorType.REF]="#REF!",n[N.ErrorType.NAME]="#NAME?",n[N.ErrorType.NUM]="#NUM!",n[N.ErrorType.NA]="#N/A",n[N.ErrorType.GETTING_DATA]="#GETTING_DATA",n[N.ErrorType.SPILL]="#SPILL!",n[N.ErrorType.CONNECT]="#CONNECT!",n[N.ErrorType.BLOCKED]="#BLOCKED!",n[N.ErrorType.UNKNOWN]="#UNKNOWN!",n[N.ErrorType.FIELD]="#FIELD!",n[N.ErrorType.CALC]="#CALC!",n[N.ErrorType.BUSY]="#BUSY!",n[N.ErrorType.EXTERNAL]="#EXTERNAL!",n)),t.englishSpecialRefNames=(0,y.partialArray)(((i={})[T.SpecialRefId.All]="#All",i[T.SpecialRefId.Data]="#Data",i[T.SpecialRefId.Headers]="#Headers",i[T.SpecialRefId.Totals]="#Totals",i[T.SpecialRefId.ThisRow]="#This Row",i)),t.englishPictureSpecial=(0,y.partialArray)(((o={})[m.AP1]="AM/PM",o[m.AP2]="A/P",o[m.AP3]="/",o[m.General]="General",o[m.Currency]="$",o)),t.englishPictureSingle=(0,y.partialArray)(((a={})[h.Sep]=";",a[h.Hash]="#",a[h.Zero]="0",a[h.Decimal]=".",a[h.Percent]="%",a[h.Comma]=",",a[h.Colon]=":",a[h.DateSep]="/",a[h.Slash]="/",a[h.Space]=" ",a[h.Minus]="-",a[h.Plus]="+",a[h.OpenParen]="(",a[h.CloseParen]=")",a[h.Backslash]="\\",a[h.Star]="*",a[h.Year]="y",a[h.Month]="m",a[h.Day]="d",a[h.Hour]="h",a[h.Minute]="m",a[h.Second]="s",a[h.E]="E",a[h.APDelim]="/",a[h.Quote]='"',a[h.ColorStart]="[",a[h.ColorEnd]="]",a[h.Text]="@",a[h.Question]="?",a[h.Underscore]="_",a[h.Reign]="r",a[h.LocDay]="a",a[h.Era]="g",a[h.EraYear]="e",a[h.BidiDate]="B",a[h.BidiNum]="N",a[h.DayTh]="",a[h.MonthTh]="",a[h.YearTh]="",a[h.EngYearTh]="b",a[h.ThYear]="",a[h.HourTh]="",a[h.MinuteTh]="",a[h.SecondTh]="",a[h.ZeroTh]="",a)),t.englishPictureColor=(0,y.partialArray)(((s={})[g.Black]="Black",s[g.White]="White",s[g.Red]="Red",s[g.Green]="Green",s[g.Blue]="Blue",s[g.Yellow]="Yellow",s[g.Magenta]="Magenta",s[g.Cyan]="Cyan",s[g.Color]="Color",s)),t.englishPictureDbnum=(0,y.partialArray)(((l={})[v.DBNUM1]="DBNum1",l[v.DBNUM2]="DBNum2",l[v.DBNUM3]="DBNum3",l[v.DBNUM4]="DBNum4",l)),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM";var D=void 0;t.englishWorksheetFuncIdToName=function(e){var t=L()[e];return void 0===t?"wsf:".concat(e):t},t.englishErrorTypeToName=function(e){var r=t.englishErrorNames[e];return void 0===r?"error.type:".concat(e):r},t.englishOperatorIdToName=function(e){if(e===S.OperatorId.Isect)return" ";if(e===S.OperatorId.Union)return",";var t=S.operatorStrings[e];return void 0===t?"op:".concat(e):t},t.operatorIdToName=function(e,t,r){return t===S.OperatorId.Isect?r:t===S.OperatorId.Union?e.listSeparator:S.operatorStrings[t]};var w=/_/g;function L(){if(null==D){D=[];for(var e=0,t=(0,c.numEnumArray)(S.WorksheetFuncId);e<t.length;e++){var r=t[e],n=(0,S.getWorksheetFuncEnglishName)(r),i=null!=n?n:S.WorksheetFuncId[r].replace(w,".");D[r]=i}}return D}function x(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),b.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?(0,d.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(e)):r}}}t.getEnglishWorksheetFuncIdToName=L,t.createWorksheetFuncNameCallbacks=x;var B=void 0;t.getEnglishLocaleInfo=function(){return null==B&&(B=function(){var e=L(),r=(0,c.makeStringCompareCI)("en-US"),n=x(r,e),i=n.getWorksheetFuncId,o=n.getWorksheetFuncName;return O(i,o,A,I,_,(function(e){return e>0&&e%3==0}),F,M,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",p.USA,f.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,P.CurrencyFormat.Paren,!0,!1,"$",2,P.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),B}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;var n=r(147),i=r(56),o=r(18);t.tzData=(0,o.typedInstanceCreator)()((function(e,t,r,n,i){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i}})),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=n.dtr.Rounding,t.dateTime=n.dtr.dtr,t.TimeDivision=n.dtr.TimeDivision,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(t.TimeGranularity||(t.TimeGranularity={})),t.xlDatepack={fromNum:function(e,t,r){return n.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=n.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):i.numErrorOper},toNumWithDuration:function(e,t,r,o){var a=n.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,o);return"number"==typeof a?e.mathpack.fromNumber(a):i.numErrorOper},daysPerMonth:n.dtr.daysPerMonth,toDays:function(e,t){return n.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,i){return n.dtr.toTime(e.mathpack.toNumber(t),r,i)},utcToLocal:function(e,t,r){return n.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var n=r(148);t.mathpack=n;var i=r(271);t.dtr=i;var o=r(100);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return o.isSupported}}),(0,r(80)._start)()},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var i,o=r(80),a=r(100),s=r(80);function l(e,t){for(var r=new Uint16Array(s.memory.buffer),n="",i=0;i<t;i+=1)n+=String.fromCharCode(r[e+(i<<1)>>1]);return n}function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(i=t.MathErrorNum||(t.MathErrorNum={}));var c=((n={})[i.Over]=u(i.Over),n[i.Under]=u(i.Under),n[i.DivBy0]=u(i.DivBy0),n[i.Trans]=u(i.Trans),n);function d(e){var t;return null!==(t=c[e])&&void 0!==t?t:u(e)}function f(e){return function(t){var r=e(t),n=(0,o.Mathpack_TakeMathError)();return n===i.None?r:d(n)}}function p(e){return function(t,r){var n=e(t,r),a=(0,o.Mathpack_TakeMathError)();return a===i.None?n:d(a)}}t.mathError=d,t.zero=o.Mathpack_Zero,t.one=o.Mathpack_One,t.pi=o.Mathpack_Pi,t.exp32=o.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,o.Mathpack_Equal)(e,t)},t.trunc=o.Mathpack_Trunc,t.ceil=f(o.Mathpack_Ceil),t.floor=f(o.Mathpack_Floor),t.abs=o.Mathpack_Abs,t.neg=o.Mathpack_Neg,t.float=function(e){return e<0?(0,o.Mathpack_SFloat)(e):(0,o.Mathpack_Float)(e)},t.fix=function(e){return(0,o.Mathpack_Fix)(e)>>>0},t.lfix=o.Mathpack_LFix,t.sfix=f(o.Mathpack_SFix),t.round=p(o.Mathpack_Round),t.roundUp=p(o.Mathpack_RoundUp),t.roundDown=p(o.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return d(i.Over);if(!isFinite(e))return d(i.Over);var t=(0,o.Mathpack_TenTo)(e),r=(0,o.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.compare=o.Mathpack_Compare,t.div=p(o.Mathpack_Div),t.mul=p(o.Mathpack_Mul),t.sub=p(o.Mathpack_Sub),t.add=p(o.Mathpack_Add),t.power=p(o.Mathpack_Power),t.cond=function(e){var t=(0,o.Mathpack_Cond)(e),r=(0,o.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.cond2=o.Mathpack_Cond2,t.viewRound=f(o.Mathpack_ViewRound),t.sqrt=f(o.Mathpack_Sqrt),t.exp=f(o.Mathpack_Exp),t.ln=f(o.Mathpack_Ln),t.log=f(o.Mathpack_Log),t.sin=f(o.Mathpack_Sin),t.cos=f(o.Mathpack_Cos),t.tan=f(o.Mathpack_Tan),t.asin=f(o.Mathpack_Asin),t.acos=f(o.Mathpack_Acos),t.atan=f(o.Mathpack_Atan),t.atan2=p(o.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{(0,a.setLocale)(e);var n=(0,o.Mathpack_FormatGeneral)(t,r);return n<0?d((0,o.Mathpack_TakeMathError)()):l((0,o.Base_StrBuf)(),n)}finally{(0,a.setLocale)(void 0)}},t.formatFixed=function(e,t,r){var n=(0,o.Mathpack_FormatFixed)(e,t,r);if(n<0)return(0,o.Mathpack_TakeMathError)();var i=l((0,o.Base_StrBuf)(),n),a=(0,o.Mathpack_FormatGetExponent)();return{sign:0!==(0,o.Mathpack_FormatGetSign)(),mantissa:i,exponent:a}},t.formatScientific=function(e,t,r){var n=(0,o.Mathpack_FormatScientific)(e,t,r);if(n<0)return(0,o.Mathpack_TakeMathError)();var i=l((0,o.Base_StrBuf)(),n),a=(0,o.Mathpack_FormatGetExponent)();return{sign:0!==(0,o.Mathpack_FormatGetSign)(),mantissa:i,exponent:a}},t.pack=function(e,t,r,n){try{(0,a.setLocale)(e);var l=(0,a.fastMin)(n.length,(0,o.Base_StrBufSize)());!function(e,t){for(var r=new Uint16Array(s.memory.buffer),n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,o.Base_StrBuf)(),n.substring(0,l));var u=(0,o.Mathpack_Pack)(!!t,r,l),c=(0,o.Mathpack_TakeMathError)();return c!==i.None?d(c):isNaN(u)?d(i.Over):u}finally{(0,a.setLocale)(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var n=r(147),i=r(56),o=r(25),a=r(47),s=r(18);function l(e){return{kind:a.OperKind.Number,_valueXL:e}}var u=l(n.mathpack.zero()),c=l(n.mathpack.one()),d=l(n.mathpack.pi());function f(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?i.div0ErrorOper:i.numErrorOper}function p(e){return function(t){return(0,o.assertFalse)("calc.lang.".concat(e,": error ").concat(JSON.stringify(t)))}}function m(e,t,r){return function(n){var i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function h(e,t,r){return function(n,i){var o=e(n._valueXL,i._valueXL);return"number"==typeof o?t(o):r(o)}}var g=h((function(e,t){return n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)}),l,f),v=m((function(e){return n.mathpack.div(e,100)}),l,p("xlPercent"));var S=m(n.mathpack.ceil,l,p("xlCeil")),y=m(n.mathpack.floor,l,p("xlFloor")),C=m(n.mathpack.cond,s.identity,p("xlCond, isSupported = ".concat((0,n.isSupported)()))),R=h(n.mathpack.cond2,s.identity,p("xlCond2"));var b=m(n.mathpack.sfix,s.identity,p("xlSfix")),N=m(n.mathpack.viewRound,l,p("xlViewRound"));t.xlMathpack={zero:u,one:c,pi:d,add:h(n.mathpack.add,l,f),sub:h(n.mathpack.sub,l,f),mul:h(n.mathpack.mul,l,f),div:h(n.mathpack.div,l,f),power:g,percent:v,neg:function(e){return 0!==C(e)?l(n.mathpack.neg(e._valueXL)):e},compare:function(e,t){return n.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var i=t._valueXL,a=n.mathpack.formatGeneral(e,i,r);return"string"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(a))):a},formatFixed:function(e,t,r){var i=e._valueXL,a=n.mathpack.formatFixed(i,t,r);return"object"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(a))):a},formatScientific:function(e,t,r){var i=e._valueXL,a=n.mathpack.formatScientific(i,t,r);return"object"!=typeof a?(0,o.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(a))):a},parse:function(e,t,r,i){var a=n.mathpack.pack(e,t,r,i);return"number"!=typeof a?(0,o.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify(a))):l(a)},trunc:function(e){return l(n.mathpack.trunc(e._valueXL))},ceil:S,floor:y,abs:function(e){return l(n.mathpack.abs(e._valueXL))},cond:C,cond2:R,fromNumber:function(e){return(0,o.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),l(e)},toNumber:function(e){var t=e._valueXL;return(0,o.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:m(n.mathpack.sqrt,l,f),exp:m(n.mathpack.exp,l,f),ln:m(n.mathpack.ln,l,f),log:m(n.mathpack.log,l,f),sin:m(n.mathpack.sin,l,f),cos:m(n.mathpack.cos,l,f),tan:m(n.mathpack.tan,l,f),asin:m(n.mathpack.asin,l,f),acos:m(n.mathpack.acos,l,f),atan:m(n.mathpack.atan,l,f),atan2:h(n.mathpack.atan2,l,f),round:h(n.mathpack.round,l,f),roundUp:h(n.mathpack.roundUp,l,f),roundDown:h(n.mathpack.roundDown,l,f),tenTo:function(e){(0,o.assertInteger)("calc.lang.xlTenTo",e);var t=n.mathpack.tenTo(e);return"number"==typeof t?l(t):f(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,i=t._valueXL;return n.mathpack.exp32(r)-n.mathpack.exp32(i)>=52428800?u:t},fix:function(e){return n.mathpack.fix(e._valueXL)},lfix:function(e){return n.mathpack.lfix(e._valueXL)},sfix:b,viewRound:N}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;var n=r(18);t.numberComponents=(0,n.typedInstanceCreator)()((function(e,t,r){return{sign:e,mantissa:t,exponent:r}})),t.formatScientificLeft=function(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(30),i=r(57),o=r(37),a=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return(0,i.success)((0,n.documentLoc)(e,t))},e.prototype.getSheetIndex=function(e,t){return(0,i.success)(t)},e.prototype.getSheetName=function(e,t){return(0,i.success)(t)},e.prototype.getNameLoc=function(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return(0,i.success)([(0,n.userDefinedFuncLoc)(e,t)])},e.prototype.getSheetRangeIndexes=function(e){if(void 0===e.index)return(0,i.failure)((0,o.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))},e.prototype.getContainingTable=function(e){return i.successUndefined},e.prototype.getStructRefColumn=function(e,t){return i.successUndefined},e.prototype.getStructRefSpecialRef=function(e,t){return i.successUndefined},e.prototype.getNamedRanges=function(e){return(0,i.success)([])},e}();t.createSimplePrintGlobals=function(e){return new a(e)},t.printLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.printLocalsName=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;var n=r(0),i=r(22),o=r(67),a=r(101),s=r(280),l=r(38),u=r(51),c=r(19),d=r(39),f=r(52),p=r(26),m=r(102),h=r(281),g={};function v(e,t){return{context:e,result:t}}function S(e){return function(t){return t.kind===c.NodeKind.Literal&&e(t.oper)}}var y=S(l.isMissingOper),C=S(l.isNumberOper),R=u.OperKind.String|u.OperKind.Boolean|u.OperKind.Error,b=S((function(e){return 0!=(e.kind&R)}));function N(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function T(e,t){return t!==u.OperKind.Range||0!=(e&u.OperKind.Range)}function P(e,t){if(t.kind===c.NodeKind.Literal)switch(N(e,t,a.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case u.OperKind.Number:case u.OperKind.Boolean:case u.OperKind.String:case u.OperKind.Error:return;default:return void N(e,t,a.baseErrors.Illegal_array_literal_element)}N(e,t,a.baseErrors.Illegal_array_literal_element)}function E(e,t,r,n){return h.Pledge.try((function(){if(e.earlyExit&&!e.isOk())throw g;return _(e,t)})).bind((function(o){return T(o.result,r)||((0,i.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==n),N(e,t,{kind:a.TypeError.Types_not_related,typeGiven:o.result,typeExpected:r,typeSource:n})),o.result=r,o}))}function k(e,t,r){if((0,l.isUnqualifiedNameNode)(r)&&r.parts.kind===c.NamePartKind.IdentNamePart){var n=(0,l.getBoundName)(e.localeInfo,r.whole);return N(e,r,a.baseErrors.Invalid_binder,n.indexOf(".")<0),N(e,r,a.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return N(e,r,r.kind===c.NodeKind.Bad&&r.type===c.BadType.Missing?a.baseErrors.Missing_binder:a.baseErrors.Invalid_binder),t}var O=function(e){return 0===e.args.length?e:e.args[e.args.length-1]};function A(e,t,r){return h.Pledge.try((function(){var d,p=(0,f.getWorksheetFuncType)(t),g=p.minArgs,S=p.maxArgs,y=p.headTypes,C=p.restTypes,R=p.tailTypes,b=p.flags,T=r.args,P=T.length,A=(0,l.getArguments)(r).length;if(N(e,r.head,a.baseErrors.Invalid_function_name,0==(b&u.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad),A<g)switch(t){case f.WorksheetFuncId.IF:case f.WorksheetFuncId.LET:case f.WorksheetFuncId.LETREC:case f.WorksheetFuncId.LAMBDA:break;default:var I=T[P-1];N(e,void 0===I?r:I,{kind:a.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:A,numArgsExpected:g})}if(A>S){var F=T[P-1];N(e,void 0===F?r:F,{kind:a.TypeError.Excess_function_arguments,funcId:t,numArgsGiven:A,numArgsExpected:S})}else if(C.length>1&&A>y.length+C.length){var M=(A-y.length)%C.length;M>R.length&&N(e,O(r),{kind:a.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:A,numArgsExpected:A+(C.length-M)})}var D=r.kind===c.NodeKind.App?(0,l.getArguments)(r).map((function(r,n){return E(e,r,(0,l.getArgType)(p,n,A),{kind:a.TypeSourceKind.WSFArgument,head:t,argIndex:n,numArgsGiven:A})})):n.__spreadArray(n.__spreadArray([],r.kind===c.NodeKind.Let?r.vars.map((function(e){return e.binder.arg})):r.params.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})),!0),[null===(d=r.body)||void 0===d?void 0:d.arg],!1).filter(o.isDefined).map((function(t){return _(e,t)}));return h.Pledge.all(D).bind((function(n){return function(e,t,r){var n=(0,l.getArguments)(r).length;switch(t){case f.WorksheetFuncId.IF:var u=e.locals.lexicalKind===m.LexicalKind.NameManager?1:2;return void(n<u&&N(e,O(r),{kind:a.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:u}));case f.WorksheetFuncId._UDF:return N(e,r,a.baseErrors.Unexpected_application_head);case f.WorksheetFuncId.LET:case f.WorksheetFuncId.LETREC:(0,i.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===c.NodeKind.Let);for(var d=s.RedBlackMapTree.create(e.localeInfo.stringCompareCI),p=0,h=r.vars;p<h.length;p++){d=k(e,d,h[p].name.arg)}for(var g=0,v=r.badArgs;g<v.length;g++){N(e,v[g].arg,a.baseErrors.Invalid_binder)}N(e,O(r),{kind:a.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:(0,o.fastMax)(3,n+1+n%2)},n>=3&&void 0!==r.body);break;case f.WorksheetFuncId.LAMBDA:(0,i.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===c.NodeKind.Lambda);d=s.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(var S=!1,y=0,C=r.params;y<C.length;y++){var R=C[y].name;N(e,R.arg.name,a.baseErrors.Unclosed_bracket,R.arg.name.isClosed),void 0!==R.arg.def&&(N(e,R.arg.name,a.baseErrors.Binder_requires_brackets,R.arg.name.isBracketed),N(e,R.arg.def.rhs,a.baseErrors.Missing_default_expression,!(0,l.isMissingNode)(R.arg.def.rhs))),R.arg.isOptional?S=!0:N(e,R.arg,a.baseErrors.Mandatory_binder_after_optional,!S),d=k(e,d,R.arg.name.name)}for(var b=0,T=r.badArgs;b<T.length;b++){N(e,T[b].arg,a.baseErrors.Invalid_binder)}N(e,O(r),{kind:a.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:n+1},n>=1&&void 0!==r.body),void 0!==r.body&&N(e,r.body.arg,a.baseErrors.Invalid_body,0===n||!(0,l.isMissingNode)(r.body.arg))}}(e,t,r),v(e,p.returnType)}))}))}function I(e,t){return h.Pledge.try((function(){if(N(e,t,a.baseErrors.Unclosed_application,t.isClosed),(0,l.isWSFNode)(t.head))return A(e,t.head.id,t);var r=t,n=r.args,i=n.length,o=(0,l.getArguments)(r).length;if((0,l.isOperatorNode)(t.head))return function(e,t,r){return h.Pledge.try((function(){var n=(0,f.getOperatorType)(t.id),i=r.length,o=i===n.minArgs;return N(e,t,{kind:a.TypeError.Incorrect_number_of_operator_arguments,opId:t.id},o),h.Pledge.all(r.map((function(r,s){return h.Pledge.try((function(){return y(r)&&(o=!1,N(e,r,{kind:a.SyntaxError.Missing_operation_argument,opId:t.id})),E(e,r,(0,l.getArgType)(n,s,i),{kind:a.TypeSourceKind.OperatorArgument,head:t.id,argIndex:s,numArgsGiven:i})}))}))).bind((function(t){return v(e,o?n.returnType:u.SignatureType.All)}))}))}(e,t.head,n);var s=t.head,d=n[i-1],p=(0,f.higherOrderFunctionType)().maxArgs-1;return o>p&&N(e,void 0===d?t:d,{kind:a.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:o,numArgsExpected:p}),h.Pledge.all(n.map((function(t){return E(e,t,u.SignatureType.All,void 0)}))).bind((function(t){return _(e,s).bind((function(t){return T(t.result,u.OperKind.Range)||0!=(t.result&(u.OperKind.Array|u.OperKind.Rich))||N(e,s,b(s)||s.kind===c.NodeKind.Array?a.baseErrors.Unexpected_application_head:a.baseErrors.Unexpected_application_head_with_fix),v(e,u.SignatureType.All)}))}))}))}function _(e,t){return h.Pledge.try((function(){var r,n,o,s,f,p,m,S,R;if(e.earlyExit&&!e.isOk())throw g;switch(t.kind){case c.NodeKind.App:case c.NodeKind.Let:case c.NodeKind.Lambda:return I(e,t);case c.NodeKind.Array:return function(e,t){return h.Pledge.try((function(){N(e,t,a.baseErrors.Unclosed_array,t.isClosed);var r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,l.isMissingNode)(t.nodes[0][0]));if(N(e,t,a.baseErrors.Empty_array_literal,r),!r)return v(e,u.OperKind.Array);for(var n=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],s=o.length;N(e,t,a.baseErrors.Irregular_array_shape,s===n);for(var c=0;c<s;c+=1)P(e,o[c])}return v(e,u.OperKind.Array)}))}(e,t);case c.NodeKind.Bad:return function e(t,r){return h.Pledge.try((function(){switch(r.type){case c.BadType.Sequence:return N(t,r,a.baseErrors.Bad_node,r.contents.some((function(e){return e.kind===c.NodeKind.Bad}))),h.Pledge.all(r.contents.map((function(r){return r.kind===c.NodeKind.Bad?e(t,r):_(t,r)})));case c.BadType.StructRef:return N(t,r,a.baseErrors.Invalid_struct_ref_table_name);case c.BadType.FieldRef:return N(t,r,a.baseErrors.Unexpected_field_ref);case c.BadType.Unexpected:switch(r.contents){case")":return N(t,r,a.baseErrors.Unexpected_closing_paren);case t.localeInfo.rightBrace:return N(t,r,a.baseErrors.Unexpected_closing_brace);case t.localeInfo.rightBracket:return N(t,r,a.baseErrors.Unexpected_closing_bracket);case".":return N(t,r,a.baseErrors.Unexpected_dot);default:return N(t,r,{kind:a.SyntaxError.Unexpected_character,text:r.contents})}case c.BadType.NumberLiteral:return N(t,r,a.baseErrors.Invalid_number_literal);case c.BadType.StringLiteral:return N(t,r,a.baseErrors.Invalid_string_literal);case c.BadType.ErrorLiteral:return N(t,r,a.baseErrors.Invalid_error_literal);case c.BadType.FieldName:case c.BadType.ParamName:case c.BadType.Missing:return N(t,r,a.baseErrors.Bad_node);case c.BadType.Qualifier:return N(t,r,a.baseErrors.Invalid_qualifier);default:(0,i.assertNever)("calc.analyze.diagnoseBadNode",r)}}))}(e,t).bind((function(){return v(e,u.SignatureType.All)}));case c.NodeKind.CellRef:return e.locals.allowRelativeQualifier||(null===(r=t.qualifier)||void 0===r?void 0:r.kind)!==c.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?(null===(n=t.qualifier)||void 0===n?void 0:n.kind)===c.QualifierKind.Document||(null===(o=t.qualifier)||void 0===o?void 0:o.kind)===c.QualifierKind.Bad?(N(e,t,a.baseErrors.Invalid_qualifier),v(e,u.SignatureType.All)):t.ref.kind===c.CellRefKind.Bad?(N(e,t,a.baseErrors.Invalid_cell_ref),v(e,u.SignatureType.All)):v(e,u.OperKind.Range):(N(e,t,a.baseErrors.Invalid_unqualified_cell),v(e,u.SignatureType.All)):(N(e,t,a.baseErrors.Invalid_rel_sheet_qualifier_in_cell),v(e,u.SignatureType.All));case c.NodeKind.Literal:return N(e,t,a.baseErrors.Unclosed_literal,t.isClosed),(0,l.isErrorOper)(t.oper)&&N(e,t,a.baseErrors.Invalid_error_literal,!((R=t.oper.type)>d.ErrorType.GETTING_DATA&&R!==d.ErrorType.BUSY&&R!==d.ErrorType.EXTERNAL)),v(e,t.oper.kind|((0,l.isErrorOper)(t.oper)&&t.oper.type===d.ErrorType.REF?u.OperKind.Range:0));case c.NodeKind.Name:if(!e.locals.allowRelativeQualifier&&(null===(s=t.qualifier)||void 0===s?void 0:s.kind)===c.QualifierKind.Relative)return N(e,t,a.baseErrors.Invalid_rel_sheet_qualifier_in_name),v(e,u.SignatureType.All);if(!e.locals.workbookLoad&&(null===(f=t.qualifier)||void 0===f?void 0:f.kind)===c.QualifierKind.Document&&!t.qualifier.isQuoted)return N(e,t,a.baseErrors.Invalid_qualifier),v(e,u.SignatureType.All);if((null===(p=t.qualifier)||void 0===p?void 0:p.kind)===c.QualifierKind.SheetRange||(null===(m=t.qualifier)||void 0===m?void 0:m.kind)===c.QualifierKind.Bad)return N(e,t,a.baseErrors.Invalid_qualifier),v(e,u.SignatureType.All);var b=(0,c.flattenNameParts)(t.parts).parts,T=e.annotations[b[0].label],E=e.annotations[t.label];return(null==T?void 0:T.kind)===c.AnnotationKind.LocalNameUse?N(e,t,a.baseErrors.Invalid_name,b.every((function(e){var t;return e.kind!==c.NamePartKind.FieldRefNamePart||(null===(t=e.rhs)||void 0===t?void 0:t.field.kind)===c.NodeKind.Name}))):(null==E?void 0:E.kind)===c.AnnotationKind.LocalNameDecl||N(e,t,a.baseErrors.Invalid_name,b.reduceRight((function(e,t){var r,n=e.anyCanDenoteNamedObject,i=e.rhsValid;return{anyCanDenoteNamedObject:n||t.canDenoteNamedObject&&i,rhsValid:i&&(t.kind!==c.NamePartKind.FieldRefNamePart||(null===(r=t.rhs)||void 0===r?void 0:r.field.kind)===c.NodeKind.Name)}}),{anyCanDenoteNamedObject:!1,rhsValid:!0}).anyCanDenoteNamedObject),v(e,u.SignatureType.All);case c.NodeKind.Paren:return N(e,t,a.baseErrors.Unclosed_paren,t.isClosed),N(e,t,a.baseErrors.Empty_parenthesis,!y(t.node)),_(e,t.node);case c.NodeKind.FieldRef:return N(e,t,a.baseErrors.Unclosed_bracket,t.rhs.isClosed),N(e,t,a.baseErrors.Unexpected_field_ref,!y(t.lhs)&&!C(t.lhs)),(0,l.isUnqualifiedNameNode)(t.rhs.field)||N(e,t.rhs.field,t.rhs.field.kind===c.NodeKind.Bad&&t.rhs.field.type===c.BadType.Missing?a.baseErrors.Missing_field_name:a.baseErrors.Invalid_field_name),_(e,t.lhs).bind((function(t){return v(e,u.SignatureType.All)}));case c.NodeKind.StructRef:if(N(e,t,a.baseErrors.Invalid_struct_ref_table_name,void 0===t.lhs&&e.locals.allowImplicitTable||(null===(S=t.lhs)||void 0===S?void 0:S.kind)===c.NodeKind.Name&&t.lhs.parts.kind===c.NamePartKind.IdentNamePart&&t.lhs.parts.canDenoteNamedObject),void 0===t.rhs.innerRef);else{N(e,t.rhs.innerRef,a.baseErrors.Invalid_struct_ref_comma_parts,t.rhs.innerRef.kind!==c.StructRefKind.CommaOpRef||(0,l.isCommaOpRefWellFormed)(t.rhs.innerRef));var k=function(t){switch(null==t?void 0:t.kind){case void 0:break;case c.StructRefKind.RangeOpRef:k(t.lhs),k(t.rhs);break;case c.StructRefKind.CommaOpRef:t.refs.forEach(k);break;case c.StructRefKind.SpecialRef:case c.StructRefKind.ColumnRef:N(e,t,a.baseErrors.Unclosed_bracket,t.isClosed);break;case c.StructRefKind.ThisRowOpRef:k(t.ref);break;case c.StructRefKind.MissingRef:N(e,t,a.baseErrors.Invalid_struct_ref_missing_part);break;case c.StructRefKind.BadRef:N(e,t,a.baseErrors.Unclosed_bracket,t.isClosed),N(e,t,a.baseErrors.Invalid_struct_ref_bad_part)}};k(t.rhs.innerRef)}return N(e,t,a.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?h.Pledge.resolve(void 0):_(e,t.lhs)).bind((function(t){return v(e,u.SignatureType.All)}));default:return(0,i.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}}))}var F={ok:!0,isOk:o.identity,collect:function(e,t,r){return!1}};function M(e,t,r,n,i){var o,a,s=r.annotations;void 0===i&&(i=!0);var l={globals:e,locals:t,localeInfo:null!==(a=null===(o=t.config)||void 0===o?void 0:o.localeInfo)&&void 0!==a?a:e.config.localeInfo,annotations:s,reportError:n.collect,isOk:function(){return n.isOk(l.errorData)},earlyExit:i,errorData:n.ok};return l}function D(e,t){try{N(e,t.node,a.baseErrors.Empty_formula,!y(t.node));var r=h.Pledge.settleOrThrow(E(e,t.node,u.SignatureType.All,void 0));return function(e,t){var r=t.annotations[t.node.label];function n(t){for(var r=0,n=t;r<n.length;r++){var i=n[r];N(e,i,a.baseErrors.Unclosed_comment,i.isClosed)}}function s(e){var r=t.spans[e];null!=r&&(r.preComments&&n(r.preComments),r.postComments&&n(r.postComments))}(null==r?void 0:r.kind)===c.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[c.SyntaxFeature.Comments]&&h.Pledge.settleOrThrow(function e(t){return h.Pledge.try((function(){switch(s(t.label),t.kind){case c.NodeKind.Literal:break;case c.NodeKind.App:case c.NodeKind.Let:case c.NodeKind.Lambda:return t.head.kind===c.NodeKind.Operator&&s(t.head.label),h.Pledge.all(t.args.map(e));case c.NodeKind.Array:return h.Pledge.all((0,o.safeConcat)([],t.nodes.map((function(t){return t.map(e)}))));case c.NodeKind.Bad:if("string"!=typeof t.contents)return h.Pledge.all(t.contents.map(e));break;case c.NodeKind.CellRef:case c.NodeKind.Name:t.qualifier&&s(t.qualifier.label);break;case c.NodeKind.Paren:return e(t.node);case c.NodeKind.FieldRef:return s(t.rhs.label),s(t.rhs.field.label),e(t.lhs);case c.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case c.NodeKind.Param:if(s(t.name.label),s(t.name.name.label),t.def)return s(t.def.label),e(t.def.rhs);break;default:return(0,i.assertNever)("calc.analyze.checker.comments",t)}}))}(t.node))}(e,t),r}catch(t){if(t===g)return v(e,u.SignatureType.All);throw t}}t.checkFormulaWithDiagnostics=function(e,t,r){try{var i=D(M(e,t,r,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,i=null!=r?r:[];return(null!==(n=i[e.label])&&void 0!==n?n:i[e.label]=[]).push(t),i}},!1),r).context.errorData;return(0,p.success)([n.__assign(n.__assign({},r),{isWellFormed:void 0===i}),i])}catch(e){return(0,p.failure)((0,p.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{var i=D(M(e,t,r,F),r).context.errorData;return(0,p.success)(n.__assign(n.__assign({},r),{isWellFormed:i}))}catch(e){return(0,p.failure)((0,p.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(1);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;var n=r(0),i=r(19),o=r(38),a=r(22),s=r(26),l=r(103),u=r(155),c=r(156),d={getDocumentLoc:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,a.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};var f=(0,o.createFailureErrorClass)("AutocorrectError"),p=n.__assign(n.__assign({},(0,l.binaryVisitor)((0,l.constVisitor)(!1),(function(e,t){return e||t}))),{badSequenceNode:function(e,t,r){return!0},badStringNode:function(e,t,r){return!0}}),m=function(e){function t(t,r,n){var i=e.call(this)||this;return i.f=n,i.seenUnclosed=!1,i.seenParen=!1,i.seenMissingOperand=!1,i.globals=function(e){var t,r,n,i,o,a,s,l,u,c,f,p,m,h,g,v,S,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:d.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:d.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:d.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:d.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:d.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(p=null===(f=e.getSheetRangeIndexes)||void 0===f?void 0:f.bind(e))&&void 0!==p?p:d.getSheetRangeIndexes,getContainingTable:null!==(h=null===(m=e.getContainingTable)||void 0===m?void 0:m.bind(e))&&void 0!==h?h:d.getContainingTable,getStructRefColumn:null!==(v=null===(g=e.getStructRefColumn)||void 0===g?void 0:g.bind(e))&&void 0!==v?v:d.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(S=e.getStructRefSpecialRef)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:d.getStructRefSpecialRef}}(t),i.locals=r,i.resolver=(0,c.createResolver)(i.globals),i}return n.__extends(t,e),t.prototype.autocorrect=function(){return(0,l.reduceBottomUp)(p,this.f)?this.f.node:(0,l.reduceBottomUp)(this,this.f)},t.prototype.literalNode=function(e,t,r){return t||(this.seenUnclosed=!0),(0,i.literalNode)(e,t,r)},t.prototype.nameNode=function(e,t,r){var n=(0,i.nameNode)(e,t,r),o=(0,i.flattenNameParts)(e);if(o.kind===i.NamePartKind.CellRefNamePart){var l=this.resolver.resolveDottedName(this.locals,n,this.f.annotations).resolved;if(l.kind===u.ResolvedKind.ResolvedCellRef){var c=l.node,d=c.ref,p=c.qualifier,m=c.label,h=this.cellRefNode(d,p,m).ref;(0,a.assertTrue)("calc.analyze.autocorrectFormula",o.kind===i.NamePartKind.CellRefNamePart);var g=o.parts,v=g[0],S=g[1],y=g.slice(2),C=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,o=t.label,a=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,r,n,o,a)};return(0,i.nameNode)(y.reduce(C,C((0,i.cellRefNamePart)(h,v.asWhole,v.label,v.qualifiedLabel),S)),t,m)}if(l.resolution.kind!==s.ResultKind.Success&&l.resolution.reason.kind!==u.ResolveReasonKind.NoOriginSheet&&l.resolution.reason.kind!==u.ResolveReasonKind.InvalidQualifier)throw new f(l.resolution.reason)}return n},t.prototype.arrayNode=function(e,t,r){return t||(this.seenUnclosed=!0),(0,i.arrayNode)(e,t,r)},t.prototype.appNode=function(e,t,r,n){var a=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),(0,o.isOperatorNode)(e)||(this.seenParen=!0),(0,o.isOperatorNode)(e)&&t.some(o.isMissingNode)&&(this.seenMissingOperand=!0),(0,i.appNode)(e,t,a,n)},t.prototype.letNode=function(e,t,r,n,o,a){var s=this.appNodeBase(e,o,a);return o||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.letNode)(e,t,r,n,s,a)},t.prototype.lambdaNode=function(e,t,r,n,o,a){var s=this.appNodeBase(e,o,a);return o||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.lambdaNode)(e,t,r,n,s,a)},t.prototype.parenNode=function(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.parenNode)(e,t,r)},t.prototype.cellRefNode=function(e,t,r){var n=this.globals.config.localeInfo;return e.isBracketed&&"("===n.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,i.cellRefNode)(e,t,r):(0,i.cellRefNode)(e,this.qualifyCellRef(),r)},t.prototype.fieldRefNode=function(e,t,r,n){return t.isClosed||(this.seenUnclosed=!0),(0,i.fieldRefNode)(e,t,r,n)},t.prototype.structRefNode=function(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,i.structRefNode)(e,t,r)},t.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!(0,s.isSuccess)(e))throw new f(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,s.isSuccess)(t))throw new f(t.reason);return(0,i.sheetQualifier)(t.value,void 0)}},t.prototype.appNodeBase=function(e,t,r){return t||!(0,o.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},t.prototype.isFormulaRoot=function(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===i.AnnotationKind.FormulaRoot},t}(l.IdentityVisitor);t.autocorrectFormula=function(e,t,r){try{var n=r.spans,o=r.annotations,a=r.depthUpperBound,l=new m(e,t,r).autocorrect();return(0,s.success)((0,i.formula)(l,n,o,a))}catch(e){return e instanceof f?(0,s.failure)(e.reason):(0,s.failure)((0,s.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(1);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(1);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;var n=r(102),i=r(101);t.diagnostics=i;var o=r(26);t.summarizeFormulaDiagnostics=function(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=i.formatDiagnostic(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t}},t.staticPrecedents=function(e,t,r,n,i,o,a){return{cells:e,names:t,udfs:r,special:n,ownSpecial:i,bound:o,resolutions:a}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n){return void 0===n&&(n=!1),{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,o.success)(t.range),originSheet:(0,o.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r){return void 0===r&&(r=!1),{config:null!=t?t:void 0,lexicalKind:n.LexicalKind.NameManager,originGridCell:(0,o.success)(e.range),originSheet:(0,o.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;var n,i=r(0),o=r(38),a=r(26);t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,n,i){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,a.success)(t),contextNames:n,syntaxFeatures:i}},function(e){e.NotFormulaString="NotFormulaString"}(n||(n={})),t.ReasonKind=i.__assign(i.__assign({},o.ReasonKind),n),t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;var n=r(50),i=r(22),o=r(19),a=r(19),s=r(39),l=r(52),u=r(31),c=r(40),d=r(61),f=r(48),p=r(33),m=r(160),h=r(162),g=r(104),v=r(163),S=r(26),y=r(284),C=r(60),R=r(2),b=r(81),N=r(105),T=r(38),P=(0,c.apply)((0,c.tuple)(p.parseWhitespace,(0,c.lazy)((function(){return t.parseFormula})),p.parseWhitespace),(function(e,t){var r,n,o=t[0],a=t[1],s=t[2],l=(0,f.getNodeSpan)(e,a);return(0,i.assertTrue)("calc.parse.parseSpFormula",!(l.pre.length>0&&o.length>0)),(0,i.assertTrue)("calc.parse.parseSpFormula",!(l.post.length>0&&s.length>0)),o.length>0&&(r=(0,f.addWhitespace)(e,o),l.pre=r[0],l.preComments=r[1]),s.length>0&&(n=(0,f.addWhitespace)(e,s),l.post=n[0],l.postComments=n[1]),a})),E=(0,c.apply)((0,c.tuple)(p.parseLeftParen,(0,f.withDelim)({delimId:u.DelimId.Paren,listSep:f.ListSep.Union},P),(0,c.opt)(p.parseRightParen,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,o.parenNode)(n,void 0!==i,(0,f.addSpan)(e,r.start,a,"",""))})),k=(0,c.many1)(P,(0,c.right)(p.parseColSep,P)),O=(0,c.many1)(k,(0,c.right)(p.parseRowSep,k)),A=(0,c.apply)((0,c.tuple)(p.parseLeftBrace,(0,f.withDelim)({delimId:u.DelimId.Brace,listSep:f.ListSep.Union},O),(0,c.opt)(p.parseRightBrace,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,o.arrayNode)(n,void 0!==i,(0,f.addSpan)(e,r.start,a,"",""))}));function I(e){return(0,c.takePeek)((function(t,r,n){return e(r)?(0,o.badNode)(o.BadType.Unexpected,r.chars,(0,f.addSpan)(t,r.start,n.start,"","")):void 0}))}var _=(0,c.apply)((0,c.tuple)(p.parseCharIndex,I(p.isLeftBracketToken),(0,f.withDelim)({delimId:u.DelimId.Bracket,listSep:f.ListSep.Union},P),(0,c.opt)(I(p.isRightBracketToken),void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],l=[n,i];return null!=a&&l.push(a),(0,o.badNode)(o.BadType.Sequence,l,(0,f.addSpan)(e,r,s,"",""))})),F=(0,c.takePeek)((function(e,t,r){switch(t.kind){case u.TokenKind.End:case u.TokenKind.Operator:case u.TokenKind.Spaces:case u.TokenKind.SingleLineComment:case u.TokenKind.MultiLineComment:return;case u.TokenKind.Sep:if(t.value===u.SepId.Dot)return;if(t.value===u.SepId.Qual||t.value===u.SepId.Assign)break;if(e.delim.delimId===u.DelimId.Brace||t.value!==u.SepId.Col&&t.value!==u.SepId.Row)return;break;case u.TokenKind.Right:if((0,N.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix")){if(t.value!==u.DelimId.SQuote&&e.delim.stack[t.value])return}else if(t.value===e.delim.delimId)return}return(0,o.badNode)(o.BadType.Unexpected,t.chars,(0,f.addSpan)(e,t.start,r.start,"",""))})),M=(0,c.any)(m.parseRef,h.parseLiteral,E,A,g.parseFieldRef,v.parseStructRef,_,m.parseUnqualBadRef,F);function D(e){return(0,c.tuple)(p.parseLeftParen,(0,f.withDelim)({delimId:u.DelimId.Paren,listSep:f.ListSep.Arg},(0,c.many1)(e,(0,c.right)(p.parseListSep,e))),(0,c.opt)(p.parseRightParen,void 0),p.parseCharIndex)}var w=(0,c.apply)(D(P),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,d.argsTerm)(n,void 0!==i,r.start,o)})),L=(0,c.apply)(D((0,c.any)((0,c.lazy)((function(){return t.parseSpParam})),P)),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,d.lambdaArgsTerm)(n,void 0!==i,r.start,o)})),x=(0,c.take)((function(e,t){return t.kind!==u.TokenKind.Operator||t.value!==l.OperatorId.Percent&&t.value!==l.OperatorId.Pound?void 0:t}));var B=(0,c.take)((function(e,t){return t.kind===u.TokenKind.Operator||(0,p.isDotSepToken)(t)?t:function(e,t){return t.kind===u.TokenKind.Sep&&t.value===u.SepId.List&&e.delim.listSep===f.ListSep.Union?(0,u.operatorToken)(t.start,e.localeInfo.listSeparator,l.OperatorId.Union):void 0}(e,t)})),U=(0,c.many)((0,c.take)((function(e,t){return(0,p.isWhitespaceToken)(t)?t:void 0}))),G=(0,c.any)((0,c.concat)((0,c.bind)((0,c.any)(M,x),(function(e,t){var r=(0,d.isWSFNode)(e.localeInfo,t);return(null==r?void 0:r.id)===l.WorksheetFuncId.LAMBDA?(0,c.concat)((0,c.parseSucceed)([t]),(0,c.opt)((0,c.tuple)(L),[])):(0,c.parseSucceed)([t])})),(0,c.many)((0,c.any)(w,g.parseFieldRef,v.parseStructRef))),(0,c.tuple)(B)),K=(0,c.flatten)((0,c.many1)(G,(0,c.concat)(U,G)));t.parseFormula=(0,c.apply)((0,c.tuple)((0,c.opt)(K,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1];if(null==r){var i=(0,f.addSpan)(e,n,n,"","");return(0,o.literalNode)(s.missingOper,!0,i)}var a=r;return a.push((0,u.endToken)(n)),(0,d.runOperatorPrecedenceParser)(e,a)})),t.runFormulaParser=function(e,t,r,s,l,d,p,m){var h,g=m.length-1;if(g<0){var v="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,i.assertFalse)(v)}if(m[g].kind!==u.TokenKind.End){v="calc.parse.runTokenParser: internal error: array[n] !== End in ".concat((0,n.anonymize)(m));return(0,i.assertFalse)(v)}var C=(0,f.makeState)(e,t,r,s,l),R=(0,c.runParser)(P,m,0,C);if(!(0,S.isSuccess)(R)||R.value.index<g){var b=(0,S.isSuccess)(R)?R.value.index:0;v="calc.parse.runTokenParser: internal error: consumed ".concat(b," out of ").concat(g," in ").concat((0,n.anonymize)(m));return(0,i.assertFalse)(v)}var N=R.value.output,T=C.spans,E=(0,y.buildAnnotations)(e,N,d,void 0===p?void 0:((h={})[a.SyntaxFeature.Comments]=!0===p[a.SyntaxFeature.Comments],h[a.SyntaxFeature.Statements]=!0===p[a.SyntaxFeature.Statements],h));return(0,o.formula)(N,T,E)};var V=R.codePoint.codePointFullStop;var j=(0,c.apply)((0,c.many1)((0,c.take)((function(e,t){return t.isIdentContinue||(0,p.isDotSepToken)(t)?t:void 0}))),(function(e,t){var r=t[0].start,n=t.map((function(e){return e.chars})).join(""),i=(0,f.addSpan)(e,r,r+n.length,"","");if(!function(e,t){if(!e.localeInfo.isIdentStart((0,C.stringCodePointAt)(t,0)))return!1;if(!(0,C.codePointIterator)(t).every((function(t){return t===V||e.localeInfo.isIdentContinue(t)})))return!1;var r=(0,b.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){var n=r.refStyle===o.RefStyle.A1?(0,u.cellRefA1Token)(0,t,r.row,r.col):(0,u.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,m.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n))return(0,o.badNode)(o.BadType.ParamName,n,i);var a=(0,f.addSpan)(e,r,r+n.length,"","");return(0,o.nameNode)((0,o.identNamePart)(n,void 0,a,a),void 0,i)})),W=(0,c.applyTake)((0,c.tuple)(p.parseCharIndex,p.parseLeftBracket,p.parseCharIndex,p.parseSpacesOnly,(0,c.opt)(j,void 0),p.parseSpacesOnly,p.parseCharIndex,(0,c.opt)(p.parseRightBracket,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8];if(void 0!==a){var d=(0,f.getNodeSpan)(e,a);d.pre=i,d.post=s}var p=null!=a?a:(0,o.badNode)(o.BadType.Missing,i+s,(0,f.addSpan)(e,n,l,"",""));return(0,o.paramName)(p,!0,void 0!==u,(0,f.addSpan)(e,r,c,"",""))})),H=(0,c.lazy)((function(){return(0,N.isFeatureEnabled)(N.FeatureName.CalcLambdaOptionalParameters)?W:(0,c.parseFail)()})),Q=(0,c.applyTake)((0,c.tuple)(p.parseCharIndex,m.parseRef,p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=n.kind===d.TermKind.MaybeWSFTerm?n.node:n;if((0,T.isUnqualifiedNameNode)(a))return(0,o.paramName)(a,!1,!0,(0,f.addSpan)(e,r,i,"",""))})),q=(0,c.apply)((0,c.tuple)(p.parseWhitespace,p.parseCharIndex,p.parseAssignToken,p.parseWhitespace,(0,c.lazy)((function(){return t.parseFormula})),p.parseCharIndex),(function(e,t){var r,n=t[0],i=t[1],a=(t[2],t[3]),s=t[4],l=t[5],u=(0,f.getNodeSpan)(e,s);return r=(0,f.addWhitespace)(e,a),u.pre=r[0],u.preComments=r[1],(0,o.paramDefault)(s,(0,f.addSpan)(e,i,l,n,""))})),z=(0,c.lazy)((function(){return(0,N.isFeatureEnabled)(N.FeatureName.CalcLambdaDefaultParameters)?q:(0,c.parseFail)()}));t.parseSpParam=(0,c.applyTake)((0,c.tuple)(p.parseWhitespace,p.parseCharIndex,(0,c.bind)((0,c.any)(Q,H),(function(e,t){return t.isClosed?(0,c.apply)((0,c.opt)(z,void 0),(function(e,r){return[t,r]})):(0,c.parseSucceed)([t,void 0])})),p.parseCharIndex,p.parseWhitespace,(0,c.peek)((function(e,t){return t}))),(function(e,t){var r=t[0],n=t[1],i=t[2],a=i[0],s=i[1],l=t[3],c=t[4],d=t[5];if(void 0!==s||d.kind===u.TokenKind.End&&a.isBracketed||(0,p.isListSepToken)(d)&&a.isClosed)return(0,o.paramNode)(a,s,(0,f.addSpan)(e,n,l,r,c))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;var n=r(0),i=r(50),o=r(22),a=r(19),s=r(39),l=r(81),u=r(31),c=r(40),d=r(61),f=r(48),p=r(38),m=r(33),h=r(161),g=r(51),v=r(60),S=r(104);function y(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==l.SpecialPos.A1BadDollar&&t.col!==l.SpecialPos.A1BadDollar}function C(e){return e.refStyle===a.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function R(e,t){return t.kind===u.TokenKind.CellRef&&y(e,t)&&C(t)}t.isCompleteCellRefToken=R;var b=(0,a.pos)(a.PosKind.Rel,0);function N(e){return e===l.SpecialPos.RCNoNum?b:e}function T(e,t){if(e.row!==l.SpecialPos.A1BadDollar&&e.col!==l.SpecialPos.A1BadDollar){var r=e.refStyle===a.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,a.cellRefSingle)(N(e.row),N(e.col),r,t);if(null!=e.row){var n=N(e.row);return(0,a.cellRefRow)(n,n,r,t)}if(null!=e.col){var s=N(e.col);return(0,a.cellRefCol)(s,s,r,t)}}var u="calc.parse.cellRefToken2cellRef: bad token ".concat((0,i.anonymize)(e));return(0,o.assertFalse)(u)}function P(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,v.stringCodePointAt)(t.chars,0))}var E=(0,c.take)((function(e,t){return R(e,t)&&!P(e,t)||(0,m.isRefErrorToken)(t)?t:void 0})),k=(0,c.take)((function(e,t){return R(e,t)&&P(e,t)?t:void 0})),O=(0,c.apply)((0,c.tuple)((0,c.any)(E,(0,c.withState)((function(e){return e.cellRefMustBeCellRefNode?k:(0,c.left)(k,(0,c.fails)((0,c.any)(m.parseIdentContinue,m.parseDotSepTokenNotFollowedByLeftBracket)))}))),m.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=r.kind===u.TokenKind.CellRef?T(r,(0,f.addSpan)(e,r.start,n,"","")):(0,a.cellRefError)((0,f.addSpan)(e,r.start,n,"","")),o=r.kind===u.TokenKind.CellRef?r.chars:void 0;return(0,d.maybeWSFTerm)((0,a.cellRefNode)(i,void 0,(0,f.addSpan)(e,r.start,n,"","")),o)}));var A=(0,c.takePeek)((function(e,t,r){return t.kind!==u.TokenKind.CellRef||!y(e,t)||function(e,t,r){return r.kind===u.TokenKind.Left&&r.value===u.DelimId.Paren&&t.isIdentContinue&&null!=(0,p.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]})),I=(0,c.bind)((0,c.tuple)(A,m.parseSpacesOnly,m.parseRangeOp,m.parseSpacesOnly,A),(function(e,t){var r=t[0],n=r[0],i=r[1],o=t[1],s=(t[2],t[3]),l=t[4],p=l[0],m=l[1],h=(0,f.addSpan)(e,n.start,i,"",o),g=(0,f.addSpan)(e,p.start,m,s,""),v=T(n,h),S=T(p,g),y=void 0;if(v.kind===a.CellRefKind.Single&&S.kind===a.CellRefKind.Single){var C=(0,f.addSpan)(e,n.start,m,"","");y=(0,a.cellRefRange)(v,S,C)}else if(0===o.length&&0===s.length)if(v.kind===a.CellRefKind.Row&&S.kind===a.CellRefKind.Row){var R=v.isBracketed||S.isBracketed;C=(0,f.addSpan)(e,n.start,m,"","");y=(0,a.cellRefRow)(v.row1,S.row1,R,C)}else if(v.kind===a.CellRefKind.Col&&S.kind===a.CellRefKind.Col){R=v.isBracketed||S.isBracketed,C=(0,f.addSpan)(e,n.start,m,"","");y=(0,a.cellRefCol)(v.col1,S.col1,R,C)}if(null==y)return(0,c.parseFail)();var b=(0,d.maybeWSFTerm)((0,a.cellRefNode)(y,void 0,(0,f.addSpan)(e,n.start,m,"","")),void 0);return n.isIdentContinue&&p.isIdentContinue?(0,c.peek)((function(e,t){return t.kind===u.TokenKind.Sep&&t.value===u.SepId.Qual?void 0:b})):(0,c.parseSucceed)(b)})),_=(0,c.any)(I,O);t.parseUnqualBadRef=(0,c.apply)((0,c.take)((function(e,t){return t.kind===u.TokenKind.CellRef?t:void 0})),(function(e,t){var r=t.start+t.chars.length,n=t.refStyle===a.RefStyle.R1C1&&!t.isIdentContinue;return(0,d.maybeWSFTerm)((0,a.cellRefNode)((0,a.cellRefBad)(t.chars,n,(0,f.addSpan)(e,t.start,r,"","")),void 0,(0,f.addSpan)(e,t.start,r,"","")),t.chars)}));var F=(0,c.take)((function(e,t){return t.kind===u.TokenKind.Ident&&e.localeInfo.isIdentStart((0,v.stringCodePointAt)(t.chars,0))||t.kind===u.TokenKind.CellRef&&P(e,t)?t:void 0})),M=(0,c.take)((function(e,t){return t.kind===u.TokenKind.Literal&&t.oper.kind===g.OperKind.Boolean?t:void 0})),D=(0,c.any)(F,(0,c.left)(M,(0,c.succeeds)(m.parseDotSepTokenNotFollowedByLeftBracket))),w=(0,c.peek)((function(e,t){return(0,m.isLeftBracketToken)(t)})),L=(0,c.tuple)((0,c.many1)(D,m.parseIdentContinue),(0,c.many)((0,c.any)(m.parseIdentContinue,m.parseDotSepTokenNotFollowedByLeftBracket)),w,m.parseCharIndex),x=(0,c.apply)(L,(function(e,t){var r,i,s,c,p,m,h=t[0],g=t[1],v=t[2],R=t[3],b=h[0],N=1===h.length&&(null===(r=g[0])||void 0===r?void 0:r.kind)===u.TokenKind.Sep,P=b.kind!==u.TokenKind.CellRef||(m=b).refStyle===a.RefStyle.A1&&null==m.row&&"object"==typeof m.col&&m.col.kind===a.PosKind.Rel||function(e,t){return t.refStyle===a.RefStyle.A1&&e.refStyle===a.RefStyle.A1&&t.isIdentContinue||t.refStyle===a.RefStyle.R1C1&&(0,l.isR1C1IdentStart)(t.row,t.col)}(e,b)&&N;if(v||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===u.TokenKind.Literal||r.some((function(t,r){return r%2==0?t.kind!==u.TokenKind.Sep:t.kind===u.TokenKind.Sep||!(0,S.isUnbracketedField)(e.localeInfo,t.chars)}))}(e,h,g)){var E=n.__spreadArray(n.__spreadArray([],h,!0),g,!0).map((function(e){return e.chars})).join(""),k=(0,f.addSpan)(e,b.start,R,"",""),O=(0,f.addSpan)(e,b.start,R,"",""),A=(0,a.identNamePart)(E,P,k,O),I=(0,a.nameNode)(A,void 0,(0,f.addSpan)(e,b.start,R,"",""));return(0,d.maybeWSFTerm)(I,I.whole)}var _,F=P,M=0,D=null!==(s=null===(i=g[M])||void 0===i?void 0:i.start)&&void 0!==s?s:R,w=(0,f.addSpan)(e,b.start,D,"",""),L=(0,f.addSpan)(e,b.start,D,"","");if(1===h.length&&b.kind===u.TokenKind.CellRef)if(y(e,b))if(C(b)){var x=T(b,(0,f.addSpan)(e,b.start,D,"",""));_=(0,a.cellRefNamePart)(x,b.chars,w,L)}else _=(0,a.identNamePart)(b.chars,F,w,L);else F=!1,_=(0,a.identNamePart)(b.chars,F,w,L);else{var B=h.map((function(e){return e.chars})).join("");0===e.localeInfo.stringCompareCI(B,"_xlpm")&&M+1<g.length&&(B+="."+g[M+1].chars,M+=2),_=(0,a.identNamePart)(B,F,w,L)}for(var U=_;M+1<g.length;M+=2){var G=g[M+1],K=null!==(p=null===(c=g[M+2])||void 0===c?void 0:c.start)&&void 0!==p?p:R,V=(0,f.addSpan)(e,G.start,K,"","");U=(0,a.fieldRefNamePart)(U,(0,a.fieldRef)((0,a.nameNode)((0,a.identNamePart)(G.chars,void 0,V,V),void 0,(0,f.addSpan)(e,G.start,K,"","")),!1,!0,(0,f.addSpan)(e,G.start,K,"","")),M+2>=g.length?P:F,(0,f.addSpan)(e,b.start,K,"",""),(0,f.addSpan)(e,b.start,K,"",""))}M<g.length&&(U=(0,a.fieldRefNamePart)(U,void 0,P,(0,f.addSpan)(e,b.start,R,"",""),(0,f.addSpan)(e,b.start,R,"","")),M+=1),(0,o.assertTrue)("calc.parse.pUnqualName: i == tailTokens",M===g.length),U.kind===a.NamePartKind.CellRefNamePart&&(0,o.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var j=(0,a.nameNode)(U,void 0,(0,f.addSpan)(e,b.start,R,"",""));return(0,d.maybeWSFTerm)(j,j.whole)})),B=(0,c.opt)((0,c.any)(_,x,t.parseUnqualBadRef),{node:void 0}),U=(0,c.any)(_,(0,c.right)((0,c.fails)(x),t.parseUnqualBadRef));var G=(0,c.bind)(h.parseQualifier,(function(e,t){var r=t[0],n=t[1];return(0,c.apply)(r.kind===a.QualifierKind.SheetRange?(0,f.cellRefMustBeCellRefNode)(r.isQuoted?B:U):r.kind===a.QualifierKind.Error?(0,f.cellRefMustBeCellRefNode)(B):B,(function(e,t){var i=t.node;if(null==i)return r.kind===a.QualifierKind.Error?(0,a.literalNode)(s.refErrorOper,!0,r.label):(0,a.badNode)(a.BadType.Qualifier,n,r.label);var l=(0,f.getNodeSpan)(e,r).start,u=(0,f.getNodeSpan)(e,i).end;if(i.kind===a.NodeKind.Name){var c=(0,f.addSpan)(e,l,u,"","");if(r.kind===a.QualifierKind.Error){var d=(0,a.literalNode)(s.refErrorOper,!0,r.label);return(0,a.badNode)(a.BadType.Sequence,[d,i],c)}return(0,o.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",r.kind!==a.QualifierKind.SheetRange||r.isQuoted),r.kind===a.QualifierKind.SheetRange&&void 0===r.document&&(r=(0,a.identQualifier)("".concat(r.sheet1,":").concat(r.sheet2),r.isQuoted,r.label)),(0,a.nameNode)(function(e,t,r){for(var n=t;;){if((0,f.getSpan)(e,n.qualifiedLabel).start=r,n.kind!==a.NamePartKind.FieldRefNamePart)break;n=n.lhs}return t}(e,i.parts,l),r,c)}var p=(0,f.addSpan)(e,l,u,"","");return r.kind===a.QualifierKind.Ident&&(r=(0,a.sheetQualifier)(r.name,void 0,r.isQuoted,r.label)),(0,a.cellRefNode)(i.ref,r,p)}))})),K=(0,c.apply)((0,c.any)(_,x),(function(e,t){return t.node.kind===a.NodeKind.CellRef&&t.node.ref.kind===a.CellRefKind.Error?(0,a.literalNode)(s.refErrorOper,!0,t.node.label):t}));t.parseRef=(0,c.any)(G,K)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;var n=r(19),i=r(40),o=r(48),a=r(33),s=r(31),l=r(68),u=r(51),c=r(283),d=r(22);function f(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===u.OperKind.Boolean}var p=l.codePointFullStop,m=(0,i.opt)((0,i.takePeek)((function(e,t,r){return t.kind!==s.TokenKind.Spaces||(0,a.isWhitespaceToken)(r)?void 0:t.chars})),""),h=(0,i.take)((function(e,t){return t.isIdentContinue&&!f(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==p?t.chars:void 0})),g=(0,i.take)((function(e,t){return t.isIdentContinue||(0,a.isDotSepToken)(t)?t.chars:void 0})),v=(0,i.apply)((0,i.many1)(h,g),(function(e,t){return t.join("")})),S=(0,i.take)((function(e,t){return t.kind===s.TokenKind.Ident?t.chars:void 0})),y=function(e,t){var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function C(e,t,r,i,o,a){var s,l;if(null==t)null==i?(s=(0,n.identQualifier)(r,o,a),l=r):(s=(0,n.sheetRangeQualifier)(r,i,void 0,o,a),l="".concat(r,":").concat(i));else{var u=y(e.localeInfo,t);null==i?(s=(0,n.sheetQualifier)(r,t,o,a),l="".concat(u).concat(r)):(s=(0,n.sheetRangeQualifier)(r,i,t,o,a),l="".concat(u).concat(r,":").concat(i))}return[s,o?(0,c.quoteQualifier)(l):l]}var R=(0,i.take)((function(e,t){return t.kind===s.TokenKind.Ident||(0,a.isRangeOpToken)(t)?t.chars:void 0})),b=(0,i.apply)((0,i.tuple)(a.parseCharIndex,(0,i.many)(R),a.parseLeftBracket,(0,i.many1)(R),a.parseRightBracket,a.parseCharIndex),(function(e,t){var r=t[0],i=t[1],a=(t[2],t[3]),s=(t[4],t[5]),l=i.join(""),u=a.join("");return(0,n.documentQualifier)(u,""!==l?l:void 0,!0,(0,o.addSpan)(e,r,s,"",""))})),N=(0,i.apply)((0,i.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,i.many1)(g),a.parseRightBracket,a.parseCharIndex),(function(e,t){var r=t[0],i=(t[1],t[2]),a=(t[3],t[4]),s=i.join("");return(0,n.documentQualifier)(s,void 0,!1,(0,o.addSpan)(e,r,a,"",""))})),T=(0,i.apply)((0,i.tuple)(a.parseCharIndex,(0,i.opt)(N,void 0),v,(0,i.opt)((0,i.right)(a.parseRangeOp,v),void 0),a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4];return C(e,n,i,a,!1,(0,o.addSpan)(e,r,s,"",""))})),P=(0,i.apply)((0,i.tuple)(a.parseLeftSQuote,(0,i.opt)(b,void 0),S,(0,i.opt)((0,i.right)(a.parseRangeOp,S),void 0),a.parseRightSQuote,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=(t[4],t[5]);return C(e,n,i,a,!0,(0,o.addSpan)(e,r.start,s,"",""))})),E=(0,i.apply)(N,(function(e,t){return[t,y(e.localeInfo,t)]})),k=(0,i.apply)((0,i.tuple)(a.parseLeftSQuote,b,a.parseRightSQuote),(function(e,t){t[0];var r=t[1];t[2];return[r,(0,c.quoteQualifier)(y(e.localeInfo,r))]})),O=(0,i.take)((function(e,t){return t.kind===s.TokenKind.End||t.kind===s.TokenKind.Right&&t.value===s.DelimId.SQuote?void 0:t.chars})),A=(0,i.apply)((0,i.tuple)(a.parseLeftSQuote,(0,i.many)(O),(0,i.opt)((0,i.tuple)(a.parseRightSQuote,(0,i.opt)((0,i.tuple)(a.parseQualSep,m),[void 0,""])),[void 0,[void 0,""]]),a.parseCharIndex),(function(e,t){var r=t[0],i=t[1],a=t[2],s=a[0],l=a[1],u=l[0],c=l[1],d=t[3],f="'".concat(i.join("")).concat(void 0!==s?"'":"").concat(void 0!==u?"!":""),p=(0,o.addSpan)(e,r.start,d-c.length,"",c);return[(0,n.badQualifier)(f,!0,p),f]})),I=(0,i.takePeek)((function(e,t,r){if((0,a.isRefErrorToken)(t)){var i=(0,o.addSpan)(e,t.start,r.start,"","");return[(0,n.errorQualifier)(i),t.chars]}})),_=(0,i.peek)((function(e,t){var r=(0,o.addSpan)(e,t.start,t.start,"","");return[(0,n.relativeQualifier)(r),""]})),F=(0,i.apply)((0,i.tuple)((0,i.any)(T,P,E,k,_),a.parseQualSep,m),(function(e,t){var r=t[0],n=r[0],i=r[1],a=(t[1],t[2]),s=(0,o.getNodeSpan)(e,n);return s.end+=1,(0,d.assertTrue)("calc.parse.parseGoodQualifier",0===s.post.length),s.post=a,[n,"".concat(i,"!")]})),M=(0,i.take)((function(e,t){return t.isIdentContinue||(0,a.isDotSepToken)(t)||f(t)||function(e){return e.kind===s.TokenKind.Literal&&(0,s.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0})),D=(0,i.apply)((0,i.tuple)(a.parseCharIndex,(0,i.many)(M),a.parseQualSep,a.parseCharIndex,m),(function(e,t){var r=t[0],i=t[1],a=(t[2],t[3]),s=t[4],l="".concat(i.join(""),"!"),u=(0,o.addSpan)(e,r,a,"",s);return[(0,n.badQualifier)(l,!1,u),l]}));t.parseQualifier=(0,i.any)(I,F,D,A)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;var n=r(19),i=r(31),o=r(40),a=r(61),s=r(48),l=r(33),u=r(39),c=r(38),d=r(51);var f=(0,o.take)((function(e,t){return t.kind===i.TokenKind.Literal&&t.oper.kind!==d.OperKind.Boolean?t:t.kind===i.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,i.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),p=(0,o.take)((function(e,t){return t.kind===i.TokenKind.Literal&&t.oper.kind===d.OperKind.Boolean?t:void 0}));t.parseLiteral=(0,o.apply)((0,o.tuple)((0,o.any)(f,(0,o.left)(p,(0,o.fails)(l.parseDotSepTokenNotFollowedByLeftBracket))),l.parseCharIndex),(function(e,t){var r=t[0],o=t[1],l=(0,s.addSpan)(e,r.start,o,"","");if((0,i.isBadNumberOper)(r.oper))return(0,n.badNode)(n.BadType.NumberLiteral,r.chars,l);if((0,i.isBadErrorOper)(r.oper))return(0,n.badNode)(n.BadType.ErrorLiteral,r.chars,l);if((0,c.isStringOper)(r.oper)&&r.oper.value.length>u.cellStringLimit)return(0,n.badNode)(n.BadType.StringLiteral,r.chars,l);var d=(0,n.literalNode)(r.oper,r.hasRight,l);return(0,c.isBooleanOper)(r.oper)?(0,a.maybeWSFTerm)(d,r.chars):d}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;var n=r(0),i=r(40),o=r(61),a=r(33),s=r(19),l=r(48),u=r(31),c=r(26),d=(0,i.take)((function(e,t){return t.isIdentContinue||t.kind===u.TokenKind.Spaces?t:void 0})),f=(0,i.apply)((0,i.many1)(d),(function(e,t){var r=t[0];return 1===t.length?r:(0,u.identToken)(r.start,t.map((function(e){return e.kind===u.TokenKind.Escape?"":e.chars})).join(""))})),p=(0,i.take)((function(e,t){return t.isIdentContinue||t.kind===u.TokenKind.Spaces||t.kind===u.TokenKind.Escape||(0,a.isListSepToken)(t)||(0,a.isRangeOpToken)(t)?t:void 0})),m=(0,i.apply)((0,i.many1)(p),(function(e,t){var r=t[0];return 1===t.length?r:(0,u.identToken)(r.start,t.map((function(e){return e.kind===u.TokenKind.Escape?"":e.chars})).join(""))})),h=(0,i.take)((function(e,t){return t.kind===u.TokenKind.SpecialRef?t:void 0})),g=(0,i.apply)((0,i.tuple)(a.parseCharIndex,h,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.specialRef)(n.value,!1,!0,(0,l.addSpan)(e,r,i,"",""))})),v=(0,i.apply)((0,i.tuple)(a.parseCharIndex,a.parseLeftBracket,h,(0,i.opt)(a.parseRightBracket,void 0),a.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],o=t[4];return(0,s.specialRef)(n.value,!0,void 0!==i,(0,l.addSpan)(e,r,o,"",""))})),S=(0,i.any)(g,v),y=(0,i.apply)((0,i.tuple)(a.parseCharIndex,f,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.columnRef)(n.chars,!1,!0,(0,l.addSpan)(e,r,i,"",""))})),C=(0,i.apply)((0,i.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,i.opt)(m,void 0),(0,i.opt)(a.parseRightBracket,void 0),a.parseCharIndex),(function(e,t){var r,n=t[0],i=(t[1],t[2]),o=t[3],a=t[4];return(0,s.columnRef)(null!==(r=null==i?void 0:i.chars)&&void 0!==r?r:"",!0,void 0!==o,(0,l.addSpan)(e,n,a,"",""))})),R=(0,i.apply)((0,i.tuple)(a.parseCharIndex,m,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.columnRef)(n.chars,!1,!0,(0,l.addSpan)(e,r,i,"",""))})),b=(0,i.any)(y,C),N=(0,i.apply)(a.parseCharIndex,(function(e,t){return(0,s.missingRef)((0,l.addSpan)(e,t,t,"",""))})),T=(0,i.any)(b,N),P=(0,i.take)((function(e,t){return"#"===t.chars?t:void 0})),E=(0,i.apply)((0,i.many1)(P,d),(function(e,t){return(0,u.unexpectedToken)(t[0].start,t.map((function(e){return e.chars})).join(""))})),k=(0,i.apply)((0,i.many1)(P,p),(function(e,t){return(0,u.unexpectedToken)(t[0].start,t.map((function(e){return e.chars})).join(""))})),O=(0,i.apply)((0,i.tuple)(a.parseCharIndex,E,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.badRef)(n.chars,!1,!0,(0,l.addSpan)(e,r,i,"",""))})),A=(0,i.apply)((0,i.tuple)(a.parseCharIndex,a.parseLeftBracket,k,(0,i.opt)(a.parseRightBracket,void 0),a.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],o=t[4];return(0,s.badRef)(n.chars,!0,void 0!==i,(0,l.addSpan)(e,r,o,"",""))})),I=(0,i.any)(O,A),_=(0,i.apply)((0,i.tuple)(a.parseCharIndex,T,a.parseRangeOp,T,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=(t[2],t[3]),o=t[4];return(0,s.rangeOpRef)(n,i,(0,l.addSpan)(e,r,o,"",""))})),F=(0,i.any)(_,b),M=(0,i.any)(S,I,_,b,N),D=(0,i.apply)((0,i.tuple)(a.parseCharIndex,M,(0,i.many1)((0,i.tuple)(a.parseListSep,M)),a.parseCharIndex),(function(e,t){var r=t[0],i=t[1],o=t[2],a=t[3];return(0,s.commaOpRef)(n.__spreadArray([i],o.map((function(e){e[0];return e[1]})),!0),(0,l.addSpan)(e,r,a,"",""))})),w=(0,i.apply)((0,i.tuple)(a.parseCharIndex,a.parseAtOp,(0,i.opt)(F,void 0),a.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3];return(0,s.thisRowOpRef)(n,(0,l.addSpan)(e,r,i,"",""))})),L=(0,i.apply)(a.parseSpacesOnly,(function(){})),x=(0,i.any)((0,i.left)(L,a.parseEnd),(0,i.left)(R,a.parseEnd),(0,i.left)(D,a.parseEnd),(0,i.left)(w,a.parseEnd),(0,i.left)(_,a.parseEnd),(0,i.left)(S,a.parseEnd),(0,i.left)(I,a.parseEnd),(0,i.left)(C,a.parseEnd));t.parseStructRef=(0,i.applyTake)((0,i.tuple)(a.parseCharIndex,a.parseBracketedTokens,a.parseCharIndex),(function(e,t){var r=t[0],n=t[1],a=n[0],u=n[1],d=t[2],f=(0,i.runParser)(x,a,0,e);return(0,c.isSuccess)(f)?(0,o.structRefTerm)((0,s.structRef)(f.value.output,u,(0,l.addSpan)(e,r,d,"","")),r,d):void 0}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;var n,i=r(22),o=r(31),a=r(39),s=r(81),l=r(287),u=r(67),c=r(19),d=r(165),f=r(60),p=r(68),m=r(106),h=r(105),g=r(33),v=p.codePointAsterisk,S=p.codePointAtSign,y=p.codePointColon,C=p.codePointDoubleQuote,R=p.codePointExclamationMark,b=p.codePointHash,N=p.codePointLeftParen,T=p.codePointQuestionMark,P=p.codePointRightParen,E=p.codePointSingleQuote,k=p.codePointFullStop,O=p.codePointDigitZero,A=p.codePointSlash,I=p.codePointMinusSign,_=p.codePointSpace,F=p.codePointInvertedExclamationMark,M=p.codePointInvertedQuestionMark,D=p.codePointLeftSingleQuotationMark,w=p.codePointRightSingleQuotationMark;function L(e){if(!n){n=(0,u.makeStringMap)();for(var t=0,r=Object.getOwnPropertyNames(x);t<r.length;t++){var i=r[t];n[i.charCodeAt(0)]=!0}for(var o=0,a=Object.getOwnPropertyNames(B);o<a.length;o++){var s=a[o];n[s.charCodeAt(0)]=!0}}return!0===n[e]}var x={"+":o.addOperatorToken,"-":o.subOperatorToken,"*":o.mulOperatorToken,"/":o.divOperatorToken,"^":o.powOperatorToken,"%":o.percentOperatorToken,"&":o.concatOperatorToken,"=":o.eqOperatorToken,"<":o.ltOperatorToken,">":o.gtOperatorToken,":":o.rangeOperatorToken,".":o.dotSepToken,"@":o.atOperatorToken,"#":o.poundOperatorToken},B={"<>":o.neOperatorToken,"<=":o.leOperatorToken,">=":o.geOperatorToken};function U(e,t,r){if(t<e.length-1){var n=B[e.substring(t,t+2)];if(null!=n)return(0,o.appendToken)(2,n(t),r)}var a=x[e.charAt(t)];if(null!=a)return(0,o.appendToken)(1,a(t),r);return(0,i.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function G(e,t,r,n,i){var a=(0,l.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0!==a){var s=a.value,u=a.i,c=r.substring(n,u);return(0,o.appendToken)(u-n,(0,o.literalToken)(n,c,null!=s?s:o.badNumberOper,!0),i),u}}var K=function(e,t){return e.charCodeAt(t)!==C},V=function(e,t){return e.charCodeAt(t)===C};function j(e,t,r){var n=(0,d.scanEscapedWhile)(e,t+1,K,'"',V),i=n[0],s=n[1],l=e.substring(t,s+1);return s<e.length?(0,o.appendToken)(s+1-t,(0,o.literalToken)(t,l,(0,a.stringOper)(i),!0),r):(0,o.appendToken)(s-t,(0,o.literalToken)(t,l,(0,a.stringOper)(i),!1),r)}function W(e,t,r,n){if(!(0,h.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix"))return function(e,t,r,n){for(var i=1;i<e.errorNames.length;i+=1){var s=e.errorNames[i];if(null!=s){var l=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,l))return(0,o.appendToken)(s.length,(0,o.literalToken)(r,l,(0,a.errorOper)(i)),n)}}var u=r+1,c=!1;for(;u<t.length;){var d=(0,f.stringCodePointAt)(t,u);if(u!==r+1||d!==F&&d!==M)if(u>r+1&&d===A&&!c)c=!0,u+=1;else if(u>r+1&&d===k)u+=1;else{if(u>r+1&&d===O){(u+=1)<t.length&&t.charCodeAt(u)===R&&(u+=1);break}if(d===R||d===T){u!==r+1&&(u+=1);break}if(!e.isIdentStart(d))break;u+=(0,f.numCodeUnits)(d)}else u+=1}if(u>r+1){l=t.substring(r,u);return(0,o.appendToken)(u-r,(0,o.literalToken)(r,l,o.badErrorOper),n)}return}(e,t,r,n);for(var i=1;i<e.errorNames.length;i+=1){var s=e.errorNames[i];if(null!=s){var l=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,l))return(0,o.appendToken)(s.length,(0,o.literalToken)(r,l,(0,a.errorOper)(i)),n)}}for(var u=r+1,c=!1;u<t.length;){var d=(0,f.stringCodePointAt)(t,u);if(u!==r+1||d!==F&&d!==M)if(!(u>r+1)||d!==A&&d!==I&&d!==_||c)if(u>r+1&&d===k)u+=1;else{if(u>r+1&&d===O){(u+=1)<t.length&&t.charCodeAt(u)===R&&(u+=1);break}if(d===R||d===T){u!==r+1&&(u+=1);break}if(!e.isIdentContinue(d)||e.isNumeral(d)){if(d!==D&&d!==w)break;u+=1}else u+=(0,f.numCodeUnits)(d)}else c=!0,u+=1;else u+=1}for(;u>r+1&&t.charCodeAt(u-1)===_;)--u;if(u>r+1){l=t.substring(r,u);return(0,o.appendToken)(u-r,(0,o.literalToken)(r,l,o.badErrorOper),n)}}function H(e,t,r,n){for(var i=1;i<e.specialRefNames.length;i+=1){var a=e.specialRefNames[i];if(null!=a){var s=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,s))return(0,o.appendToken)(a.length,(0,o.specialRefToken)(r,s,i),n)}}}function Q(e,t,r){var n=t.charCodeAt(r);return!((0,l.isSpace)(n)||n===E||n===b||n===y||n===S||(0,m.stringStartsWith)(t,e.listSeparator,r)||(0,m.stringStartsWith)(t,e.leftBracket,r)||(0,m.stringStartsWith)(t,e.rightBracket,r))}var q=function(e,t){return(0,l.isSpace)((0,f.stringCodePointAt)(e,t))},z=function(e,t){return!(0,l.isLineBreak)((0,f.stringCodePointAt)(e,t))},Y=function(e,t){return!(t+1<e.length&&e.charCodeAt(t)===v&&e.charCodeAt(t+1)===A)};function J(e,t,r,n){for(var i=r,a=0,s=function(t,r){return Q(e,t,r)},u=function(t,r){return!Q(e,t,r)},c=(0,d.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",i);i<t.length;){c(i);var p=(0,f.stringCodePointAt)(t,i);if(n.length>0&&n[n.length-1].kind===o.TokenKind.Escape&&u(t,i))i=(0,o.appendToken)((0,f.numCodeUnits)(p),(0,o.identToken)(i,(0,f.stringFromCodePoint)(p)),n);else if(p!==S){if(p===b)if(null!=(v=H(e,t,i,n))){i=v;continue}if(p!==E)if((0,m.stringStartsWith)(t,e.rightBracket,i)){if(i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n),0===(a-=1))return i}else if(s(t,i)){var h=(0,d.scanWhile)(t,i,s),g=h[0],v=h[1];i=(0,o.appendToken)(v-i,(0,o.identToken)(i,g),n)}else if((0,l.isSpace)(p)){var C=(0,d.scanWhile)(t,i,q);g=C[0],v=C[1];i=(0,o.appendToken)(v-i,(0,o.spacesToken)(i,g),n)}else p!==y?(0,m.stringStartsWith)(t,e.listSeparator,i)?i=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(i,e.listSeparator),n):(0,m.stringStartsWith)(t,e.leftBracket,i)&&a<2?(i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n),a+=1):i=(0,o.appendToken)((0,f.numCodeUnits)(p),(0,o.unexpectedToken)(i,(0,f.stringFromCodePoint)(p)),n):i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n);else i=(0,o.appendToken)(1,(0,o.escapeToken)(i,"'"),n)}else i=(0,o.appendToken)(1,(0,o.atOperatorToken)(i),n)}return i}function X(e,t,r,n){for(var i=(0,o.appendToken)(1,(0,o.leftSQuoteToken)(r),n),a=function(t,r){return function(e,t,r){var n=t.charCodeAt(r);return n!==E&&n!==y&&n!==v&&n!==T&&!(0,m.stringStartsWith)(t,e.leftBracket,r)&&!(0,m.stringStartsWith)(t,e.rightBracket,r)}(e,t,r)},s=function(e,t){return e.charCodeAt(t)===E},l=(0,d.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){l(i);var u=(0,f.stringCodePointAt)(t,i);if(u===E&&!(i+1<t.length&&t.charCodeAt(i+1)===E))return(0,o.appendToken)(1,(0,o.rightSQuoteToken)(i),n);if(u!==y)if((0,m.stringStartsWith)(t,e.leftBracket,i))i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n);else if((0,m.stringStartsWith)(t,e.rightBracket,i))i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n);else if((0,d.getEscapedSkip)(t,i,a,"'",s)>0){var c=(0,d.scanEscapedWhile)(t,i,a,"'",s),p=c[0],h=c[1];i=(0,o.appendToken)(h-i,(0,o.identToken)(i,p),n)}else i=(0,o.appendToken)((0,f.numCodeUnits)(u),(0,o.unexpectedToken)(i,(0,f.stringFromCodePoint)(u)),n);else i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n)}return i}function $(e,t,r,n,i,a){var l=(0,s.parseCellRef)(e,t,r,n,i);if(null!=l){var u=l.i,d=n.substring(u,i),f=l.refStyle===c.RefStyle.A1?(0,o.cellRefA1Token)(i,d,l.row,l.col):(0,o.cellRefR1C1Token)(i,d,l.row,l.col,l.enLocale);return(0,o.appendToken)(u-i,f,a)}}function Z(e,t,r,n){var i=n.length-1,a=n[i];if(null==a)return!0;if(a.kind===o.TokenKind.Sep&&a.value===o.SepId.Dot)return!1;if((0,m.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=a&&(0,g.isWhitespaceToken)(a);)a=n[--i];return null==a||a.kind!==o.TokenKind.Ident&&a.kind!==o.TokenKind.CellRef&&a.kind!==o.TokenKind.Right&&(a.kind!==o.TokenKind.Literal||(0,o.isNumberLikeOper)(a.oper))}return e.isNumeral((0,f.stringCodePointAt)(t,r))}function ee(e,t,r,n){for(var i=e[t],o=t+1;o<e.length;o+=1){var a=e[o];if(a.kind!==r)break;i=n(i,a)}return[i,o]}t.tokenizeFormula=function(e,t,r,n,a,s,u){for(var p=function(e,t,r,n,a,s,u){for(var p=[],g=[],S=(0,h.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix"),y=s,T=!0===(null==u?void 0:u[c.SyntaxFeature.Comments]),k=!0===(null==u?void 0:u[c.SyntaxFeature.Statements]),O=!(0,m.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,m.stringStartsWith)(e.statementSeparator,e.rowSeparator),I=!(0,m.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,m.stringStartsWith)(e.statementSeparator,e.decimalSeparator),_=(0,d.makeProgressAsserter)("calc.parse.tokenize",y);y<a.length;){_(y);var F=$(e,r,n,a,y,p);if(null==F){var M=(0,f.stringCodePointAt)(a,y);if(Z(e,a,y,p)){var D=G(e,t,a,y,p);if(null!=D){y=D;continue}}if(M!==C)if(e.isIdentContinue(M)){var w=(0,d.scanWhile)(a,y,(function(t,r){return e.isIdentContinue((0,f.stringCodePointAt)(t,r))})),x=w[0],B=w[1];y=(0,o.appendToken)(B-y,(0,o.identOrBooleanToken)(e,y,x),p)}else if(M!==b)if((0,l.isSpace)(M)){var K=(0,d.scanWhile)(a,y,q),V=(x=K[0],K[1]);y=(0,o.appendToken)(V-y,(0,o.spacesToken)(y,x),p)}else if(M!==N)if(M!==P)if((0,m.stringStartsWith)(a,e.leftBrace,y))g.push({delim:o.DelimId.Brace,lastParen:g.length>0?g[g.length-1].lastParen:void 0,lastBrace:g.length}),y=(0,o.appendToken)(e.leftBrace.length,(0,o.leftBraceToken)(y,e.leftBrace),p);else if((0,m.stringStartsWith)(a,e.rightBrace,y)){if(S){var H=g.length>0?g[g.length-1].lastBrace:void 0;void 0!==H&&(g.length=H)}else g.length>0&&g[g.length-1].delim===o.DelimId.Brace&&g.pop();y=(0,o.appendToken)(e.rightBrace.length,(0,o.rightBraceToken)(y,e.rightBrace),p)}else if((0,m.stringStartsWith)(a,e.leftBracket,y))y=J(e,a,y,p);else if((0,m.stringStartsWith)(a,e.rightBracket,y))y=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(y,e.rightBracket),p);else{if(g.length>0&&g[g.length-1].delim===o.DelimId.Brace){if(k&&O&&(0,m.stringStartsWith)(a,e.statementSeparator,y))break;if((0,m.stringStartsWith)(a,e.columnSeparator,y)){y=(0,o.appendToken)(e.columnSeparator.length,(0,o.colSepToken)(y,e.columnSeparator),p);continue}if((0,m.stringStartsWith)(a,e.rowSeparator,y)){y=(0,o.appendToken)(e.rowSeparator.length,(0,o.rowSepToken)(y,e.rowSeparator),p);continue}}if(k&&(0,m.stringStartsWith)(a,e.statementSeparator,y)&&(I||0===g.length))break;if((0,m.stringStartsWith)(a,e.listSeparator,y))y=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(y,e.listSeparator),p);else if(M!==R)if(M!==E){if(M===A&&y+1<a.length&&T){var Q=a.charCodeAt(y+1);if(Q===A){var ee=(0,d.scanWhile)(a,y,z),te=(x=ee[0],ee[1]);y=(0,o.appendToken)(te-y,(0,o.singleLineCommentToken)(y,x),p);continue}if(Q===v){var re=(0,d.scanWhile)(a,y+2,Y),ne=(x=re[0],re[1]),ie=(0,m.stringStartsWith)(a,"*/",ne);(0,i.assertTrue)("calc.parse.tokenize: /**/",ie||ne===a.length),ne+=ie?2:0,x="/*"+x+(ie?"*/":""),y=(0,o.appendToken)(ne-y,(0,o.multiLineCommentToken)(y,x,ie),p);continue}}if(L(M)){if((0,m.stringStartsWith)(a,":=",y)&&(0,h.isFeatureEnabled)(h.FeatureName.CalcLambdaDefaultParameters)){y=(0,o.appendToken)(2,(0,o.assignSepToken)(y),p);continue}y=U(a,y,p)}else y=(0,o.appendToken)((0,f.numCodeUnits)(M),(0,o.unexpectedToken)(y,(0,f.stringFromCodePoint)(M)),p)}else y=X(e,a,y,p);else y=(0,o.appendToken)(1,(0,o.qualSepToken)(y),p)}else{if(S){var oe=g.length>0?g[g.length-1].lastParen:void 0;void 0!==oe&&(g.length=oe)}else g.length>0&&g[g.length-1].delim===o.DelimId.Paren&&g.pop();y=(0,o.appendToken)(1,(0,o.rightParenToken)(y),p)}else g.push({delim:o.DelimId.Paren,lastParen:g.length,lastBrace:g.length>0?g[g.length-1].lastBrace:void 0}),y=(0,o.appendToken)(1,(0,o.leftParenToken)(y),p);else{var ae=W(e,a,y,p);if(null!=ae){y=ae;continue}y=U(a,y,p)}else y=j(a,y,p)}else y=F}return[p,y]}(e,t,r,n,a,s,u),g=p[0],S=p[1],y=[],T=0;T<g.length;){var k=g[T];if(k.kind!==o.TokenKind.Unexpected)y.push(k),T+=1;else{var O=ee(g,T,o.TokenKind.Unexpected,(function(e,t){var r=e,n=t;return(0,o.unexpectedToken)(r.start,r.chars+n.chars)})),I=O[0],_=O[1];y.push(I),T=_}}return y.push((0,o.endToken)(S)),y}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;var n=r(22),i=r(60),o=r(106);function a(e,t,r,n,i){return r(e,t)?1:(0,o.stringStartsWith)(e,n,t)&&t+n.length<e.length&&i(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){var r=t-1;return function(t){if(t<=r){var i="".concat(e,": internal error: no progress made at index ").concat(t);return(0,n.assertFalse)(i)}r=t}},t.scanWhile=function(e,t,r){for(var n=t;n<e.length&&r(e,n);)n+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=a,t.scanEscapedWhile=function(e,t,r,n,o){for(var s=[],l=t,u=t;u<e.length;){var c=a(e,u,r,n,o);if(0===c)break;2===c&&(l!==u&&s.push(e.substring(l,u)),l=u+n.length,u+=n.length),u+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,u))}return l!==u&&s.push(e.substring(l,u)),[s.join(""),u]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.spillErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(1);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.spillErrorOper=n.value.spillErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(1);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormat=t.evalFormatImpl=void 0;var o=r(0),a=r(43),s=r(34),l=r(289),u=r(41),c=r(290),d=r(291),f=r(169),p=r(112),m=r(70),h=r(42),g=r(32),v=r(292),S=r(293),y=(0,m.typedInstanceCreator)()((function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}})),C={},R=(0,s.createFailureErrorClass)("InferenceError"),b={getDocumentLoc:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,a.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function N(e,t){var r,n,i=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,N,T,P,E,k;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:b.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:b.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:b.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:b.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:b.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:b.getSheetRangeIndexes,getCellFormat:null!==(m=null===(p=e.getCellFormat)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:b.getCellFormat,getKnownFormat:null!==(g=null===(h=e.getKnownFormat)||void 0===h?void 0:h.bind(e))&&void 0!==g?g:b.getKnownFormat,getIformat:null!==(S=null===(v=e.getIformat)||void 0===v?void 0:v.bind(e))&&void 0!==S?S:b.getIformat,getFormatString:null!==(C=null===(y=e.getFormatString)||void 0===y?void 0:y.bind(e))&&void 0!==C?C:b.getFormatString,getContainingTable:null!==(N=null===(R=e.getContainingTable)||void 0===R?void 0:R.bind(e))&&void 0!==N?N:b.getContainingTable,getStructRefColumn:null!==(P=null===(T=e.getStructRefColumn)||void 0===T?void 0:T.bind(e))&&void 0!==P?P:b.getStructRefColumn,getStructRefSpecialRef:null!==(k=null===(E=e.getStructRefSpecialRef)||void 0===E?void 0:E.bind(e))&&void 0!==k?k:b.getStructRefSpecialRef}}(e);return{globals:i,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!(0,g.isSuccess)(e))throw new R(e);return e.value.document},get defaultFormat(){var e=I(this,h.KnownFormat.General);return y(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=I(this,h.KnownFormat.General);return y(!0,e,e.valueType,e.decimals)},resolver:(0,d.createResolver)(i),multOrDivTainted:!1}}var T,P=((n={})[u.FormatValueType.General]=0,n[u.FormatValueType.Number]=1,n[u.FormatValueType.Currency]=2,n[u.FormatValueType.Accounting]=2,n[u.FormatValueType.Percentage]=3,n[u.FormatValueType.Date]=4,n[u.FormatValueType.Time]=5,n[u.FormatValueType.Fraction]=6,n[u.FormatValueType.Scientific]=7,n[u.FormatValueType.Text]=8,n[u.FormatValueType.Custom]=9,n);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(T||(T={}));var E=((i={})[f.WorksheetFuncId.INT]=T.Propagate,i[f.WorksheetFuncId.MOD]=T.Propagate,i[f.WorksheetFuncId.ROUND]=T.Propagate,i[f.WorksheetFuncId.SUM]=T.Propagate,i[f.WorksheetFuncId.TRUNC]=T.Propagate,i[f.WorksheetFuncId.AVERAGE]=T.Propagate,i[f.WorksheetFuncId.MAX]=T.Propagate,i[f.WorksheetFuncId.MEDIAN]=T.Propagate,i[f.WorksheetFuncId.MIN]=T.Propagate,i[f.WorksheetFuncId.ROUNDUP]=T.Propagate,i[f.WorksheetFuncId.ROUNDDOWN]=T.Propagate,i[f.WorksheetFuncId.NPV]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.PV]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.FV]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.PMT]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.RATE]=h.KnownFormat.Pct0,i[f.WorksheetFuncId.MIRR]=h.KnownFormat.Pct0,i[f.WorksheetFuncId.IRR]=h.KnownFormat.Pct0,i[f.WorksheetFuncId.DATE]=h.KnownFormat.MMDDYY,i[f.WorksheetFuncId.TIME]=h.KnownFormat.HHMMAP,i[f.WorksheetFuncId.NOW]=h.KnownFormat.MDYHMS,i[f.WorksheetFuncId.SLN]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.SYD]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.DDB]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.IPMT]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.PPMT]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.TODAY]=h.KnownFormat.MMDDYY,i[f.WorksheetFuncId.VDB]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.DB]=h.KnownFormat.CoCurrencyDec,i);var k=[[u.FormatValueType.General,u.FormatValueType.Number,u.FormatValueType.Currency,u.FormatValueType.Percentage,u.FormatValueType.Date,u.FormatValueType.Time,u.FormatValueType.Fraction,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.Number,u.FormatValueType.Currency,u.FormatValueType.Percentage,u.FormatValueType.Date,u.FormatValueType.Time,u.FormatValueType.Number,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Currency,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Currency,u.FormatValueType.Currency,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Percentage,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Percentage,u.FormatValueType.Percentage,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Date,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Time,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Fraction,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Custom]],O=[[u.FormatValueType.General,u.FormatValueType.Number,u.FormatValueType.Currency,u.FormatValueType.General,u.FormatValueType.Date,u.FormatValueType.Time,u.FormatValueType.Fraction,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.Number,u.FormatValueType.Currency,u.FormatValueType.Number,u.FormatValueType.Date,u.FormatValueType.Time,u.FormatValueType.Fraction,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Currency,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Currency,u.FormatValueType.Currency,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Percentage,u.FormatValueType.Date,u.FormatValueType.Time,u.FormatValueType.Percentage,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Date,u.FormatValueType.Date,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Time,u.FormatValueType.Time,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Fraction,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Scientific,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Text,u.FormatValueType.Custom],[u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.General,u.FormatValueType.Custom]];function A(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!(0,g.isSuccess)(r))throw new R(r.reason);return r.value}function I(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!(0,g.isSuccess)(r))throw new R(r.reason);return r.value}function _(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!(0,g.isSuccess)(r))throw new R(r.reason);return void 0!==r.value?r.value:t}function F(e,t,r){return(0,a.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,t[0],t[1])}function M(e,t,r,n){var i=r[0],o=n[0],a=P[i.valueType],s=P[o.valueType],l=a<=s?t[a][s]:t[s][a],u=P[l],c=o.decimals>i.decimals?o.decimals:i.decimals;switch(u){case a:return y(!0,i.format,i.valueType,c);case s:return y(!0,o.format,o.valueType,c);default:return e.unitlessFormat}}function D(e,t,r){return M(e,O,t,r)}function w(e,t,r){var n=t[0],i=r[0];if(n.format===i.format&&n.valueType===i.valueType&&n.valueType===u.FormatValueType.Time)return y(!0,n.format,n.valueType,n.decimals);if(n.valueType===u.FormatValueType.Date&&i.valueType===u.FormatValueType.Time||n.valueType===u.FormatValueType.Time&&i.valueType===u.FormatValueType.Date){var o=I(e,h.KnownFormat.MDYHMS),a=o.valueType,s=o.decimals;return y(!0,o,a,s)}return M(e,k,t,r)}var L=function(e){return e.unitlessFormat};function x(e,t,r){var n=t[0],i=r[0];return n.format===i.format?y(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function B(e){return P[e]===P[u.FormatValueType.General]}var U=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,v.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return S.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){switch(e.kind){case p.OperKind.String:case p.OperKind.Boolean:case p.OperKind.Error:case p.OperKind.Missing:return S.Pledge.resolve(this.context.defaultFormat);case p.OperKind.Number:var t=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),21),r=t.indexOf(this.context.localeInfo.decimalSeparator),n=r>=0?t.length-r-1:0,i=I(this.context,h.KnownFormat.General);return S.Pledge.resolve(y(!1,i,i.valueType,n));default:return(0,a.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}},e.prototype.arrayNode=function(e){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.appNode=function(e,t){var r=this;if((0,s.isOperatorNode)(e))return S.Pledge.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return function(e,t,r){switch(t){case f.OperatorId.Mul:case f.OperatorId.Div:return e.multOrDivTainted=!0,F(e,r,D);case f.OperatorId.Pow:return F(e,r,D);case f.OperatorId.Add:case f.OperatorId.Sub:return F(e,r,w);case f.OperatorId.Percent:(0,a.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);var n=r[0],i=n[0],o=n[1];if(!(0,s.isNumberNode)(o))return e.defaultFormat;var l=i.strong,u=i.decimals,c=I(e,h.KnownFormat.Pct);return y(l,c,c.valueType,u);case f.OperatorId.Pound:case f.OperatorId.At:return e.defaultFormat;case f.OperatorId.Neg:case f.OperatorId.Pos:return(0,a.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length),i=r[0][0];case f.OperatorId.Lt:case f.OperatorId.Le:case f.OperatorId.Eq:case f.OperatorId.Ge:case f.OperatorId.Gt:case f.OperatorId.Ne:return F(e,r,L);case f.OperatorId.Isect:case f.OperatorId.Union:case f.OperatorId.Range:case f.OperatorId.Concat:return F(e,r,x);case f.OperatorId.And:case f.OperatorId.Or:case f.OperatorId.Xor:case f.OperatorId.Min:case f.OperatorId.Max:throw new R((0,s.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,a.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(r.context,e.id,t)}));if((0,s.isWSFNode)(e)){var n=e.id,i=function(e){var t;return null!==(t=E[e])&&void 0!==t?t:T.Ignore}(n),o=(0,f.getWorksheetFuncType)(n),u=(0,s.getArguments)((0,l.appNode)(e,t));if((0,a.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,s.isValidArgsLength)(o,u.length)),i===T.Ignore)return S.Pledge.resolve(this.context.defaultFormat);if(i===T.Propagate)return 0===u.length?S.Pledge.resolve(this.context.defaultFormat):S.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(e){var t=e[0],n=t.format,i=t.valueType,o=t.decimals,a=!B(i);if(!t.strong&&a)return r.context.unitlessFormat;for(var s=a,l=1;l<e.length;l+=1){var u=e[l],c=!B(u.valueType);if(!u.strong&&c)return r.context.unitlessFormat;s||(n=u.format,i=u.valueType,o=u.decimals,s=c)}return y(!0,n,i,o)}));var c=I(this.context,i),d=c.valueType,p=c.decimals;return S.Pledge.resolve(y(!0,c,d,p))}return this.lazyVisitFormulaNode(e)},e.prototype.letNode=function(e,t,r,n){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(e,t,r,n){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(e,t){var r=this.context.resolver.resolveCellRef(this.context.locals,(0,l.cellRefNode)(e,t)).resolution;if(!(0,g.isSuccess)(r))throw(0,a.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==c.ResolveReasonKind.NoOriginSheet),new R(r.reason);var n=r.value;if(void 0===n)throw C;return(0,s.isSheetGridRange)(n)?S.Pledge.resolve(K(this.context,n)):S.Pledge.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(e,t){var r=this;return this.lazyVisitFormulaNode(e).bind((function(e){return r.context.defaultFormat}))},e.prototype.structRefNode=function(e,t){var r=(0,l.structRefNode)(e,t),n=this.context.resolver.resolveStructRef(this.context.locals,r).resolution;if(!(0,g.isSuccess)(n)){if((0,a.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==c.ResolveReasonKind.NoOriginSheet),n.reason.kind===c.ResolveReasonKind.EmptyIntersection)throw C;throw new R(n.reason)}var i=n.value;if(void 0===i)throw C;return S.Pledge.resolve(K(this.context,i))},e.prototype.badSequenceNode=function(e,t){return(0,a.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badStringNode=function(e,t){return(0,a.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(e,t){return S.Pledge.resolve((0,l.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return S.Pledge.resolve((0,l.wsfNode)(e,t,r))},e}();function G(e,t){return(0,v.reducePledge)(new U(e),t)}function K(e,t){var r=(0,s.sheetGridRangeAnchor)(t),n=e.globals.getCellFormat(r);if(!(0,g.isSuccess)(n))throw new R(n.reason);var i=n.value,o=A(e,i);if(!(0,s.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof i||o.source!==u.NumberFormatSource.Builtin))return e.defaultFormat;var a=o.valueType,l=o.decimals;return y(!0,i,a,l)}t.evalFormatImpl=function(e,t,r){try{var n=N(e,t),i=G(n,r);return(0,g.success)(o.__assign(o.__assign({},i),{format:_(n,i.format),mulOrDivTainted:n.multOrDivTainted}))}catch(e){return e instanceof R?(0,g.failure)(e.reason):e===C?g.successUndefined:(0,g.failure)((0,g.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{var n=N(e,t),i=G(n,r);return(0,g.success)(function(e,t){var r=t.strong,n=t.format,i=t.valueType,o=t.decimals;if(i!==u.FormatValueType.Number||!e.multOrDivTainted){if(o>0&&r&&(i===u.FormatValueType.Number||i===u.FormatValueType.Currency||i===u.FormatValueType.Accounting||i===u.FormatValueType.Percentage)){var a=A(e,n);o!==a.decimals&&(n=a.synthesizeDecimals(o))}if(i!==u.FormatValueType.General&&r)return n=_(e,n)}}(n,i))}catch(e){return e instanceof R?(0,g.failure)(e.reason):e===C?g.successUndefined:(0,g.failure)((0,g.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(1);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";var n,i,o,a,s,l,u,c,d,f;Object.defineProperty(t,"__esModule",{value:!0}),t.changeFormatDecimals=t.applyFormat=t.createFormat=t.NumberFormatImpl=void 0;var p=r(0),m=r(72),h=r(43),g=r(34),v=r(41),S=r(110),y=r(166),C=r(169),R=r(109),b=r(69),N=r(295),T=r(70),P=r(34),E=r(82),k=r(83),O=r(42),A=r(167),I=r(113),_=r(112),F=r(32),M=r(296),D=r(171),w=k.codePointMinusSign,L=k.codePointPlusSign,x=k.codePointDigitZero,B=k.codePointHash,U=k.codePointFullStop,G=k.codePointDigitOne,K=k.codePointDigitTwo,V=k.codePointLeftParen,j=k.codePointRightParen,W=k.codePointSmallT,H=k.codePointBackslash,Q={decimalSeparator:"NOTUSED"};function q(e,t,r,n){var i=e.formatFixed(t,0,0),o=i.mantissa,a=i.exponent;(0,h.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",o.length<=a),(0,h.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==o.length||0===a);var s=(0,E.convertDigitsShape)(a<r?(0,b.repeat)("0",r-a):"",n),l=(0,E.convertNumberShape)(Q,o+(0,b.repeat)("0",a-o.length),n);if(!(0,F.isSuccess)(l))throw new De(l.reason);return s+l.value}function z(e,t,r,n,i){var o=e.formatFixed(t,0,0),a=o.mantissa,s=o.exponent;(0,h.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",a.length<=s),(0,h.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==a.length||0===s);var l=((s<r?(0,b.repeat)("0",r-s):"")+a+(0,b.repeat)("0",s-a.length)).substring(0,n);return(0,E.convertDigitsShape)(l,i)}function Y(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,i=r.exponent;return(0,h.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=i),(0,h.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===i),""===n?"0":n.length<i?n+(0,b.repeat)("0",i-n.length):n}function J(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];switch(n.kind){case v.FormattedUnitKind.Blank:case v.FormattedUnitKind.String:for(var i=n.str;r+1<e.length;){var o=e[r+1];if(o.kind!==n.kind)break;i+=o.str,r+=1}t.push({kind:n.kind,str:i});break;case v.FormattedUnitKind.Flexible:case v.FormattedUnitKind.General:t.push(n)}}return t}var X=function(e){return e.kind===v.FormattedUnitKind.Flexible};var $,Z=((n={})[1]=O.NumberShape.ChineseTrad1,n[2]=O.NumberShape.ChineseTrad2,n[3]=O.NumberShape.ChineseTrad3,n),ee=((i={})[1]=O.NumberShape.ChineseSimp1,i[2]=O.NumberShape.ChineseSimp2,i[3]=O.NumberShape.ChineseSimp3,i),te=((o={})[1]=O.NumberShape.Japanese1,o[2]=O.NumberShape.Japanese2,o[3]=O.NumberShape.Japanese3,o),re=((a={})[1]=O.NumberShape.Korean1,a[2]=O.NumberShape.Korean2,a[3]=O.NumberShape.Korean3,a[4]=O.NumberShape.Korean4,a);function ne(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}($||($={}));var ie,oe=(0,b.partialArray)(((s={})[$.Ne]="<>",s[$.Le]="<=",s[$.Ge]=">=",s[$.Eq]="=",s[$.Lt]="<",s[$.Gt]=">",s)),ae=((l={})[$.Ne]=C.OperatorId.Ne,l[$.Le]=C.OperatorId.Le,l[$.Ge]=C.OperatorId.Ge,l[$.Eq]=C.OperatorId.Eq,l[$.Lt]=C.OperatorId.Lt,l[$.Gt]=C.OperatorId.Gt,l),se=((u={})[C.OperatorId.Ne]=$.Ne,u[C.OperatorId.Le]=$.Le,u[C.OperatorId.Ge]=$.Ge,u[C.OperatorId.Eq]=$.Eq,u[C.OperatorId.Lt]=$.Lt,u[C.OperatorId.Gt]=$.Gt,u);function le(e,t,r,n){for(var i=0;i<t.length;i+=1){var o=t[i];if(null!=o&&!(n+o.length>r.length)){var a=r.substring(n,n+o.length);if(0===e.stringCompareCI(o,a))return Number(i)}}}function ue(e,t,r,n){for(var i=0;i<t.length;i+=1){var o=t[i];if(null!=o&&(0,b.stringStartsWith)(r,o,n))return Number(i)}return le(e,t,r,n)}function ce(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}function de(e,t){var r=t.indexOf(ce(e.pictureSingle,m.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(ie||(ie={}));var fe=/^[0-9A-F]{1,8}$/i,pe=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,me=(0,b.partialArray)(((c={})[1]=O.NumberShape.ASCII,c[2]=O.NumberShape.ArabicIndic,c[3]=O.NumberShape.ExtendedArabicIndic,c[4]=O.NumberShape.Devanagari,c[5]=O.NumberShape.Bengali,c[6]=O.NumberShape.Gurmukhi,c[7]=O.NumberShape.Gujarati,c[8]=O.NumberShape.Oriya,c[9]=O.NumberShape.Tamil,c[10]=O.NumberShape.Telugu,c[11]=O.NumberShape.Kannada,c[12]=O.NumberShape.Malayalam,c[13]=O.NumberShape.Thai,c[14]=O.NumberShape.Lao,c[15]=O.NumberShape.Tibetan,c[16]=O.NumberShape.Myanmar,c[17]=O.NumberShape.Ethiopic,c[18]=O.NumberShape.Khmer,c[19]=O.NumberShape.Mongolian,c[27]=O.NumberShape.Japanese1,c[28]=O.NumberShape.Japanese2,c[29]=O.NumberShape.Japanese3,c[30]=O.NumberShape.ChineseSimp1,c[31]=O.NumberShape.ChineseSimp2,c[32]=O.NumberShape.ChineseSimp3,c[33]=O.NumberShape.ChineseTrad1,c[34]=O.NumberShape.ChineseTrad2,c[35]=O.NumberShape.ChineseTrad3,c[36]=O.NumberShape.Korean1,c[37]=O.NumberShape.Korean2,c[38]=O.NumberShape.Korean3,c[39]=O.NumberShape.Korean4,c)),he=(0,b.partialArray)(((d={})[1]=O.Calendar.Gregorian,d[2]=O.Calendar.GregorianUS,d[3]=O.Calendar.Japan,d[4]=O.Calendar.Taiwan,d[5]=O.Calendar.Korea,d[6]=O.Calendar.Hijri,d[7]=O.Calendar.Thai,d[8]=O.Calendar.Hebrew,d[9]=O.Calendar.GregorianMEFrench,d[10]=O.Calendar.GregorianArabic,d[11]=O.Calendar.GregorianXlitEnglish,d[12]=O.Calendar.GregorianXlitFrench,d[22]=O.Calendar.Persian,d[23]=O.Calendar.UmAlQura,d)),ge=Object.keys(v.CultureTag).reduce((function(e,t){var r=v.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function ve(e){return e.toString(16).toUpperCase()}function Se(e){return Number("0x"+e)}var ye={culture:"en-US",tag:void 0},Ce={culture:"fr-FR",tag:void 0},Re={culture:"ar-IQ",tag:void 0},be={culture:"ar-SA",tag:void 0},Ne={culture:"ar-DZ",tag:void 0},Te={culture:"th-TH",tag:void 0},Pe=((f={})[m.PictureSingle.Hour]=A.TimeDivision.Hour,f[m.PictureSingle.HourTh]=A.TimeDivision.Hour,f[m.PictureSingle.Minute]=A.TimeDivision.Minute,f[m.PictureSingle.MinuteTh]=A.TimeDivision.Minute,f[m.PictureSingle.Second]=A.TimeDivision.Second,f[m.PictureSingle.SecondTh]=A.TimeDivision.Second,f);function Ee(e){return 400===e.kind?e.formattedStr:void 0}var ke={kind:ie.General};function Oe(e){return 1===e.length&&e[0].kind===ie.General}var Ae={code:[ke],color:void 0,dbnum:void 0,dtrRounding:A.Rounding.RoundSec};function Ie(e){return void 0===e.color&&void 0===e.dbnum&&Oe(e.code)}function _e(e){return void 0===e.color&&void 0===e.dbnum&&(1===(t=e.code).length&&t[0].kind===m.PictureSingle.Text);var t}var Fe={},Me=(0,g.createFailureErrorClass)("ApplyHashesError"),De=(0,g.createFailureErrorClass)("ApplyError"),we=(0,g.createFailureErrorClass)("InitError"),Le=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,void 0===t.old?(this.logFormatString=(0,M.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=v.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!1,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return(0,F.success)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof De?(0,F.failure)(e.reason):(0,F.failure)((0,F.javaScriptError)((0,b.prependErrorMessage)(e,"(while applying format ".concat(this.logFormatString,")"))))}},e.prototype.applyImpl=function(e,t,r,n){var i,o=this.config,a=o.mathpack,s=o.localeInfo;if(this.valueType===v.FormatValueType.General){var l=void 0;if((0,g.isStringOper)(e))return(0,v.formattedValue)([(0,v.formattedUnitString)(e.value)],l,t,r);if(!n&&0===a.cond(e))return(0,v.formattedValue)([],l,t,r);var u=(0,v.formattedUnitGeneral)(a.toNumber(e),s.decimalSeparator,!0,O.NumberShape.ASCII,O.NumberShape.ASCII,!0);return(0,v.formattedValue)([u],l,t,r)}for(var c=!1;;){var d=void 0;try{var f=void 0,p=!1,m=[];if((0,g.isStringOper)(e))f=3;else{var S=a.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(f=(i=this.getPart(e)).partKind,p=i.forceNeg):f=S<0?1:S>0?0:2,S<0&&(this.onlyOneNumberPart||p)&&m.push((0,v.formattedUnitString)("-"))}l=(d=this.parts[f]).color;var y=d.dbnum,C=d.code,R=d.dtrRounding;if(!n&&2===f&&d===this.parts[0]&&!c)return(0,v.formattedValue)([],l,t,r);var b=this.getNumShape(y);this.applyPart({dtrRounding:R,dbnum:y,forceNeg:p,units:m,numShape:b,bidiDate:void 0},C,e,void 0);var N=r|(3!==f||Ie(d)||_e(d)?v.Clip.None:v.Clip.MaxChars),T=m.some(X)?v.Alignment.Left:t;return(0,v.formattedValue)(J(m),l,T,N)}catch(t){if(t===Fe){(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,g.isStringOper)(e)&&0!==a.cond(e)),e=a.zero,c=!0;continue}if(t instanceof Me)return(0,v.hashesValue)(t.reason,null==d?void 0:d.color);throw t}}},e.prototype.applyPart=function(e,t,r,n){for(var i,o,a,s,l,u=this,c=this.config,d=c.mathpack,f=c.datepack,p=c.localeInfo,y=null!==(s=null===(a=this.applyCurrCode)||void 0===a?void 0:a.calendar)&&void 0!==s?s:O.Calendar.Gregorian,C=function(){if(void 0!==l)return l;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,g.isStringOper)(r));var t=u.config,n=t.date1904,i=t.dateCompatibility;if(!i&&d.cond(r)<0)throw new Me(v.dateOverflow);if(i&&d.cond(r)<0){if(n)throw new De((0,g.notImplemented)(["negative date 1904"]));throw new Me(v.dateOverflow)}var o=f.fromNum(u.config,d.abs(r),e.dtrRounding);if(!1===o)throw new Me(v.dateOverflow);switch(y){case O.Calendar.Gregorian:case O.Calendar.GregorianUS:case O.Calendar.GregorianMEFrench:case O.Calendar.GregorianArabic:case O.Calendar.GregorianXlitEnglish:case O.Calendar.GregorianXlitFrench:break;case O.Calendar.Thai:o.yr+=543;break;default:throw new De((0,g.notImplemented)(["calendar: "+y]))}return(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",o.yr>=0&&o.mon>=1&&o.mon<=12&&o.dom>=0&&o.dom<=31&&o.hour>=0&&o.hour<=23&&o.min>=0&&o.min<=59&&o.sec>=0&&o.sec<=59&&o.fracSec>=0&&o.wdy>=1&&o.wdy<=7),l=o},R=function(){if(void 0!==l)throw new De((0,g.notImplemented)(["use of value after date component"]));return r},P=!1,k=e.numShape,A=e.units,_=0;_<t.length;_+=1){var M=t[_];switch(M.kind){case ie.General:P=!0;var D=R();if((0,g.isStringOper)(D))A.push((0,v.formattedUnitString)(D.value));else{var w=d.abs(D);if(d.cond(D)<0&&"0"===d.formatGeneral(p,w,1))throw new De((0,g.notImplemented)(["potential LRestart in interval (-0.5,0)"]));var L=(0,v.formattedUnitGeneral)(d.toNumber(w),p.decimalSeparator,!1,k,this.getNumShape(void 0),this.valueType===v.FormatValueType.General);if(void 0!==e.dbnum){var x=(0,I.renderGeneral)(d,L,255);if(!(0,F.isSuccess)(x))throw new De(x.reason);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==x.value),A.push((0,v.formattedUnitString)(x.value));break}A.push(L)}break;case m.PictureSingle.Text:var B=R();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,g.isStringOper)(B)),A.push((0,v.formattedUnitString)(B.value));break;case ie.Exp:case m.PictureSingle.Slash:case 400:A.push((0,v.formattedUnitString)(M.formattedStr));break;case m.PictureSingle.Star:A.push((0,v.formattedUnitFlexible)(M.escaped));break;case m.PictureSingle.Underscore:A.push((0,v.formattedUnitBlank)(M.escaped));break;case ie.StrLit:A.push((0,v.formattedUnitString)(M.escaped));break;case m.PictureSingle.Percent:case ie.Numeral:A.push((0,v.formattedUnitString)(M.formattedStr));break;case ie.Currency:A.push((0,v.formattedUnitString)(p.currencySymbol));break;case ie.CurrCode:var U=M.currencySymbol,G=M.currCode;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,v.isSystemCultureTag)(null==G?void 0:G.tag)),void 0!==U&&A.push((0,v.formattedUnitString)(U));break;case 405:A.push((0,v.formattedUnitString)(p.dateSeparator));break;case 406:M.printAsTimeSep?A.push((0,v.formattedUnitString)(p.timeSeparator)):A.push((0,v.formattedUnitString)(M.formattedStr));break;case 403:var K=R();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,g.isStringOper)(K)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);var V=M.numDigLeft,j=M.numDigDec,W=2*(se=M.numPercent)-3*(le=M.numThousands),H=d.formatFixed(K,W,j),Q=H.mantissa,J=H.exponent;if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==Q.length||0===J),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",Q.length<=J+j),d.cond(K)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===Q.length)throw Fe;this.applyPart(e,M.codeBefore,d.zero,void 0),this.applyPart(e,M.code,d.zero,{comma:M.comma,fractionDenom:!1,decimal:!1,digits:Q,digitsExp:J,numDigLeft:V});break;case 402:var X=R();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,g.isStringOper)(X)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);var $=M.numMantDigLeft,Z=M.numMantDigDec,ee=0===$&&0===Z,te=d.formatScientific(X,$,Z);Q=te.mantissa,J=te.exponent;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==Q.length||0===J||ee);var re=(0,N.formatScientificLeft)(J,$);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",Q.length<=re+Z),this.applyPart(e,M.codeMant,d.zero,{comma:M.commaMant,fractionDenom:!1,decimal:!1,digits:Q,digitsExp:re,numDigLeft:M.numMantDigLeft}),this.applyPart(e,M.codeBetween,d.zero,void 0);var ne=""!==Q||ee?J-re:0;ne<0?A.push((0,v.formattedUnitString)("-")):M.isNeg||A.push((0,v.formattedUnitString)("+"));var oe=Y(d,d.fromNumber(ne));this.applyPart(e,M.codeExp,d.zero,{comma:M.commaMant,fractionDenom:!1,decimal:!1,digits:oe,digitsExp:oe.length,numDigLeft:M.numExpDigLeft});break;case 401:var ae=R();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,g.isStringOper)(ae)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);var se=M.numPercent,le=M.numThousands,ue=M.numIntDigLeft,ce=M.numNumerDig,fe=M.numDenomDig,pe=M.commaInt,me=M.denomValue,he=(W=2*se-3*le,d.tenTo(W)),ge=(0,g.isErrorOper)(he)?he:d.mul(d.abs(ae),he);if((0,g.isErrorOper)(ge))throw new De((0,g.notImplemented)(["overflow on fraction exp adjust"]));var ve=function(e){for(var t=e;t<A.length;t+=1){var r=A[t];r.kind===v.FormattedUnitKind.String&&(A[t]=(0,v.formattedUnitBlank)(r.str))}},Se=M.anyZeroNumer,ye=void 0,Ce=void 0,Re=void 0;if(void 0!==M.codeInt){var be=d.trunc(ge),Ne=d.sub(ge,be);if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,g.isNumberOper)(Ne)),ye=(i=this.formFraction(Ne,me,fe)).numer,Ce=i.denom,(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",d.cond2(ye,Ce)<=0),0===d.cond2(ye,Ce)){ye=d.zero;var Ee=d.add(be,d.one);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,g.isNumberOper)(Ee)),be=Ee}0!==d.cond(ye)&&(Se=!0);var ke=Y(d,be),Oe={comma:pe,fractionDenom:!1,decimal:!1,digits:ke,digitsExp:ke.length,numDigLeft:ue},Ae=A.length;this.applyPart(e,M.codeInt,d.zero,Oe),Re=A.length,(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==M.lastDigInt),0!==d.cond(be)||!Se||M.lastDigInt===m.PictureSingle.Zero?this.applyPart(e,M.codeBetween1,d.zero,void 0):(M.lastDigInt!==m.PictureSingle.Question&&(A.length=Ae),this.applyPart(e,M.codeBetween1,d.zero,void 0),ve(Ae),M.firstDigNumer!==m.PictureSingle.Question&&(A.length=Ae))}else{if(ye=(o=this.formFraction(ge,me,fe)).numer,Ce=o.denom,d.cond(ae)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===d.cond(ye))throw Fe;Se=!0,Re=A.length}var Ie=Y(d,ye),_e={comma:!1,fractionDenom:!1,decimal:!1,digits:Ie,digitsExp:Ie.length,numDigLeft:ce};this.applyPart(e,M.codeNumer,d.zero,_e),this.applyPart(e,M.codeBetween2,d.zero,void 0);var we=Y(d,Ce),Le={comma:!1,fractionDenom:!0,decimal:_e.decimal,digits:we,digitsExp:we.length,numDigLeft:fe};this.applyPart(e,M.codeDenom,d.zero,Le),Se||(M.anyQuestionNumer||M.firstDigDenom===m.PictureSingle.Question?ve(Re):A.length=Re);break;case m.PictureSingle.Decimal:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,A.push((0,v.formattedUnitString)(p.decimalSeparator));break;case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);var xe=M.count;if(n.decimal||n.fractionDenom&&M.kind===m.PictureSingle.Question){if(n.fractionDenom&&_!==t.length-1)throw new De((0,g.notImplemented)(["left-align bug in denominator"]));if(n.digitsExp<0){var Be=(0,T.fastMin)(xe,-n.digitsExp),Ue=(0,E.convertDigitsShape)((0,b.repeat)("0",Be),k);A.push((0,v.formattedUnitString)(Ue)),n.digitsExp+=Be,xe-=Be}var Ge=(0,T.fastMin)(xe,n.digits.length);Ue=(0,E.convertDigitsShape)(n.digits.substring(0,Ge),k);if(A.push((0,v.formattedUnitString)(Ue)),n.digits=n.digits.substring(Ge),xe-=Ge,M.kind!==m.PictureSingle.Hash&&xe>0){Ue=(0,E.convertDigitsShape)((0,b.repeat)("0",xe),k);A.push(M.kind===m.PictureSingle.Question?(0,v.formattedUnitBlank)(Ue):(0,v.formattedUnitString)(Ue))}break}if(n.numDigLeft>n.digitsExp){Be=(0,T.fastMin)(xe,n.numDigLeft-n.digitsExp);if(M.kind!==m.PictureSingle.Hash){Ue=(0,E.convertDigitsShape)((0,b.repeat)("0",Be),k);n.comma&&(Ue=(0,E.insertCommas)(p,Ue,n.numDigLeft-Be)),A.push(M.kind===m.PictureSingle.Question?(0,v.formattedUnitBlank)(Ue):(0,v.formattedUnitString)(Ue))}xe-=Be,n.numDigLeft-=Be}else xe+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,xe);break;case ie.PrefixDigTh:p.isThai&&(k=e.numShape=O.NumberShape.Thai);break;case ie.LatinDate:this.hasTokenCurrCode||(e.bidiDate=v.BidiDate.English);break;case ie.BidiDate:throw new De((0,g.notImplemented)(["TokenKind.BidiDate"]));case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:var Ke=(rt=M.kind===m.PictureSingle.HourTh||M.kind===m.PictureSingle.MinuteTh||M.kind===m.PictureSingle.SecondTh)&&!this.hasTokenCurrCode?O.NumberShape.Thai:k;if(M.isAbs){var Ve=R();if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,g.isStringOper)(Ve)),rt&&this.hasTokenCurrCode)throw new De((0,g.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));var je=f.toTime(this.config,d.abs(Ve),Pe[M.kind],e.dtrRounding);if(!1===je)throw new De((0,g.notImplemented)(["absolute time overflow"]));A.push((0,v.formattedUnitString)(q(d,d.fromNumber(je),M.count,Ke)))}else{var We=C(),He=void 0;if(M.kind===m.PictureSingle.Minute||M.kind===m.PictureSingle.MinuteTh)He=We.min;else if(M.kind===m.PictureSingle.Second||M.kind===m.PictureSingle.SecondTh)He=We.sec;else if(He=We.hour,M.isAMPM){if(M.kind===m.PictureSingle.HourTh)throw new De((0,g.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));He>12&&(He-=12),0===He&&(He=12)}A.push((0,v.formattedUnitString)(q(d,d.fromNumber(He),M.count,Ke)))}break;case ie.AMPM:case ie.AMPMFE:var Qe=void 0;if(Qe=!!(0,g.isStringOper)(r)||C().hour<12,(!this.hasTokenCurrCode||M.kind===ie.AMPMFE)&&(M.kind===ie.AMPMFE||p.isEastAsia||M.pictureKind===m.PictureSpecial.AP2)){var qe=de(p,M.tokenStr);A.push((0,v.formattedUnitString)(qe[Qe?0:1]));break}var ze=this.getBundledLocaleInfo("localised AM/PM string",O.Calendar.Gregorian,this.applyCurrCode);A.push((0,v.formattedUnitString)(ze.ampmSymbols[Qe?0:1]));break;case 404:var Ye=C();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",Ye.rounding>=M.rounding);var Je=z(d,d.fromNumber(Ye.fracSec),Ye.rounding,M.rounding,k);A.push((0,v.formattedUnitString)(p.decimalSeparator+Je));break;case m.PictureSingle.Era:throw new De((0,g.notImplemented)(["PictureSingle.Era"]));case m.PictureSingle.EraYear:throw new De((0,g.notImplemented)(["PictureSingle.EraYear"]));case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Year:Ke=M.kind!==m.PictureSingle.YearTh&&M.kind!==m.PictureSingle.ThYear||this.hasTokenCurrCode?k:O.NumberShape.Thai;var Xe=(M.kind===m.PictureSingle.YearTh||M.kind===m.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,$e=C().yr+(Xe?543:0);He=M.count>2?$e:$e%100;A.push((0,v.formattedUnitString)(q(d,d.fromNumber(He),M.count,Ke)));break;case m.PictureSingle.Month:case m.PictureSingle.MonthTh:var Ze=C().mon;switch(M.count){case 1:case 2:Ke=M.kind!==m.PictureSingle.MonthTh||this.hasTokenCurrCode?k:O.NumberShape.Thai;A.push((0,v.formattedUnitString)(q(d,d.fromNumber(Ze),M.count,Ke)));break;case 3:case 4:case 5:var et=void 0;if(et=e.bidiDate===v.BidiDate.English?(0,m.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised month string",y,M.kind!==m.PictureSingle.MonthTh||this.hasTokenCurrCode?this.applyCurrCode:Te),3===M.count)A.push((0,v.formattedUnitString)(et.monthNameShort[Ze-1]));else if(4===M.count||e.bidiDate===v.BidiDate.English)A.push((0,v.formattedUnitString)(et.monthNameLong[Ze-1]));else{var tt=et.monthNameLong[Ze-1];A.push((0,v.formattedUnitString)(tt.substring(0,(0,S.numCodeUnits)((0,S.stringCodePointAt)(tt,0)))))}}break;case m.PictureSingle.Day:case m.PictureSingle.DayTh:case m.PictureSingle.LocDay:var rt=M.kind===m.PictureSingle.DayTh;if(M.count<3){Ke=rt&&!this.hasTokenCurrCode?O.NumberShape.Thai:k;var nt=C().dom;A.push((0,v.formattedUnitString)(q(d,d.fromNumber(nt),M.count,Ke)))}else{var it=C().wdy;et=void 0;if(et=e.bidiDate===v.BidiDate.English||!this.hasTokenCurrCode&&p.isEastAsia&&M.kind===m.PictureSingle.Day?(0,m.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",y,rt&&!this.hasTokenCurrCode?Te:this.applyCurrCode),rt&&this.hasTokenCurrCode&&3===M.count)throw new De((0,g.notImplemented)(["fcDay3Th && fIntlNum bug"]));Ue=3===M.count?et.dayNameShort[it-1]:et.dayNameLong[it-1];A.push((0,v.formattedUnitString)(Ue))}break;case 407:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===n),this.applyPart(e,M.codeSysFormat,r,n);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",M)}}P&&R()},e.prototype.dumpDigLeft=function(e,t,r){var n=this.config.localeInfo,i=e.units,o=e.numShape,a=r,s=(0,T.fastMin)(a,t.digits.length),l=(0,E.convertDigitsShape)(t.digits.substring(0,s),o);if(t.comma&&(l=(0,E.insertCommas)(n,l,t.numDigLeft-s)),i.push((0,v.formattedUnitString)(l)),t.digits=t.digits.substring(s),a-=s,t.digitsExp-=s,t.numDigLeft-=s,a>0){l=(0,E.convertDigitsShape)((0,b.repeat)("0",a),o);t.comma&&(l=(0,E.insertCommas)(n,l,t.numDigLeft-a)),i.push((0,v.formattedUnitString)(l)),t.digitsExp-=a,t.numDigLeft-=a}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=0;r<2;r+=1){var n=r,i=void 0;if(0===r){if(void 0===(i=this.condPos)&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[0])throw new Me(v.noFormatPart);if(0===this.parts[0].code.length)throw new De((0,g.notImplemented)(['emulation of ";[COND]foo" bug']));if(void 0===(i=this.condNeg)){if(this.parts[2]===this.parts[0])return(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===C.OperatorId.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0!==i){var o=i.operator,a=i.operand,s=t.sub(e,a);if((0,g.isErrorOper)(s))throw new De((0,g.notImplemented)(["overflow in condition check"]));if((0,P.applyComparison)(o,t.cond2(e,a)))switch(o){case C.OperatorId.Eq:return{partKind:n,forceNeg:!1};case C.OperatorId.Ne:case C.OperatorId.Gt:case C.OperatorId.Ge:return{partKind:n,forceNeg:!0};case C.OperatorId.Lt:return{partKind:n,forceNeg:t.cond(a)>0};case C.OperatorId.Le:return{partKind:n,forceNeg:t.cond(a)>=0}}}}if(this.parts[2]===this.parts[0])throw new Me(v.noFormatPart);return{partKind:2,forceNeg:!0}},e.prototype.getNumShape=function(e){var t=this.applyCurrCode,r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return O.NumberShape.ASCII;var n=this.getBundledLocaleInfo("localised DBNUM culture",O.Calendar.Gregorian,t);return n.isEastAsia&&(n.isKorea?r=re[e]:n.isJapan?r=te[e]:n.isChinaT?r=Z[e]:n.isChinaS&&(r=ee[e])),null!=r?r:O.NumberShape.ASCII},e.prototype.formFraction=function(e,t,r){var n,i,o,a=this.config.mathpack;if(void 0!==t){var s=a.fromNumber(137438953472);if((0,g.isErrorOper)(a.sub(e,s)))throw new De((0,g.notImplemented)(["overflow in fraction threshold check"]));if(a.cond2(e,s)<0){var l=a.mul(e,a.fromNumber(1.0000000000000002));(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,g.isNumberOper)(l)),e=l}var u=t,c=a.toNumber(u)<<1,d=a.mul(e,a.fromNumber(c));if(!(0,g.isNumberOper)(d))throw new De((0,g.notImplemented)(["overflow in fraction denom mul"]));var f=a.lfix(d);if(f<0||f>=65535)throw new Me(v.fractionOverflow);return{numer:a.fromNumber(f+1>>1),denom:u}}switch(r){case 1:o=10;break;case 2:o=100;break;case 3:o=1e3;break;case 4:o=1e4;break;case 5:o=1e5;break;case 6:o=1e6;break;default:o=1e7}var p=a.fix(e);if(p>=2147483647)throw new Me(v.fractionOverflow);for(var m=e,S=1,y=1,C=0,R=0;;){var b=S*p;R+=b;var N=C*p;if(y+=N,b>2147483647||N>2147483647||y>=o){1===C&&2===p&&0===a.cond2(m,a.trunc(m))&&(S+=1);break}S=(n=[R,S])[0],R=n[1],C=(i=[y,C])[0],y=i[1];var T=a.sub(m,a.trunc(m));if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,g.isNumberOper)(T)),0===a.cond(T))break;var P=a.div(a.one,T);if((0,g.isErrorOper)(P))throw new De((0,g.notImplemented)(["overflow in fraction inversion"]));if(m=P,(p=a.fix(m))>2147483647)break}return 0===C&&(C=S=1),{numer:a.fromNumber(S),denom:a.fromNumber(C)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=(0,T.fastMax)(0,(0,T.fastMin)(t,127)),i=[],o=function(e){var t=a.parts[e];if((1===e||2===e)&&t===a.parts[0])return i.push(i[0]),"continue";if(3===e)return i.push(t===a.parts[0]?i[0]:t),"continue";var o=t.code,s=t.color,l=t.dbnum,u=t.dtrRounding,c={code:o.map((function(t){if(403===t.kind){var i=t.numDigLeft,o=t.numPercent,a=t.numThousands,s=t.comma,l=t.codeBefore;return{kind:403,numDigLeft:i,numDigDec:n,numPercent:o,numThousands:a,comma:s,code:r.adjustDecimals(e,t.numDigDec,t.code,n),codeBefore:l}}if(402===t.kind){var u=t.isNeg,c=t.numMantDigLeft,d=t.numExpDigLeft,f=t.commaMant,p=t.codeBetween,m=t.codeExp;return{kind:402,isNeg:u,numMantDigLeft:c,numMantDigDec:n,numExpDigLeft:d,commaMant:f,codeMant:r.adjustDecimals(e,t.numMantDigDec,t.codeMant,n),codeBetween:p,codeExp:m}}return t})),color:s,dbnum:l,dtrRounding:u};i.push(c)},a=this,s=0;s<=3;s+=1)o(s);try{var l=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec=".concat(n," on ").concat(this.logFormatString,")"),synth:i});if(l.formatString.length>255)throw new we(this.notFormatString("format string too long: max length"));return l}catch(e){if(e instanceof we)return this;throw e}},e.prototype.adjustDecimals=function(e,t,r,n){var i;if(n===t)return r;for(var o=!1,a=void 0,s=void 0,l=void 0,u=0;u<r.length;u+=1){switch((R=r[u]).kind){case m.PictureSingle.Decimal:void 0===l&&(l=u);break;case m.PictureSingle.Hash:case m.PictureSingle.Question:case m.PictureSingle.Zero:void 0!==l?s=u:(a=u,R.kind===m.PictureSingle.Question&&(o=!0))}}var c=function(e){return e===m.PictureSingle.Percent||e===ie.Currency||e===ie.CurrCode||e===m.PictureSingle.Star};if(0===n){if(void 0===l)return r;var d=0,f=0;void 0===a?void 0!==s&&(d=l+1,f=s+1):(d=l,f=(null!=s?s:l)+1);var g=r.slice(0,d);for(u=d;u<f;u+=1)c(r[u].kind)&&g.push(r[u]);return(0,T.safePush)(g,r.slice(f)),g}if(t>n){(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==l);var v=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(v||(v={}));var S=v.AfterDigs,y=[],C=t-n;for(u=r.length-1;u>=0;u-=1){u<=l&&(S=v.Keeping);var R=r[u];if(S===v.AfterDigs&&(R.kind!==m.PictureSingle.Hash&&R.kind!==m.PictureSingle.Question&&R.kind!==m.PictureSingle.Zero||(S=v.Dropping)),S===v.Keeping||S===v.AfterDigs||c(R.kind))y.push(R);else if(R.kind===m.PictureSingle.Hash||R.kind===m.PictureSingle.Question||R.kind===m.PictureSingle.Zero){var b=(0,T.fastMin)(C,R.count);b<R.count&&y.push({kind:R.kind,count:R.count-b}),0===(C-=b)&&(S=v.Keeping)}}return y.reverse(),y}if(2===e&&o&&void 0===s)return r;var N=n-t;if(void 0!==s){var P=r.slice();R=P[s];return P[s]={kind:R.kind,count:R.count+N},P}var E=r.slice(),k=null!==(i=null!=l?l:a)&&void 0!==i?i:E.length-1,O=[];return void 0===l&&O.push({kind:m.PictureSingle.Decimal}),O.push({kind:m.PictureSingle.Zero,count:N}),E.splice.apply(E,p.__spreadArray([k+1,0],O,!1)),E},e.prototype.parseString=function(e){if(this.source!==v.NumberFormatSource.CustomBytecode&&e.length>255)throw new we(this.notFormatString("format string too long: max length"));for(var t,r,n=!1,i=!1,o=0,a=!1,s=0;s<=3&&!a;s+=1){var l=this.tokenize(e.substring(o)),u=l.cond,c=l.currencySymbol,d=l.hasTokenCurrCode,f=this.convertTokToSun(l),p=f.currCode,m=f.hasPercent,S=f.hasDate,y=f.hasTime,C=this.classifySunPartKind(f,3===s?3:0),R=this.convertSunToCode(f),b=R.part,N=R.applyCurrCode;if(o+=l.consumed,a=l.eos,m&&(this.hasPercent=!0),S&&(this.hasDate=!0),y&&(this.hasTime=!0),d){if(!(0===s||this.hasTokenCurrCode&&(t=this.thisCurrCode,r=p,t===r||void 0!==t&&void 0!==r&&(0,v.isFormatCultureEqual)(t,r))))throw new we((0,g.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=p)}if(void 0!==N&&void 0===this.applyCurrCode&&(this.applyCurrCode=N),void 0!==c&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=c),this.source===v.NumberFormatSource.System&&((0,h.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",0===s),!a||3===C))throw new we(this.notFormatString("system format with more than one part"));if((3===C||0===s&&1===C)&&(n=!0,this.parts[3]=b,3===C)){if(void 0!==u)throw new we(this.notFormatString("condition in text part"));if(void 0!==p)throw new we((0,g.notImplemented)(["CurrCode in text part"]));break}if(i=!0,this.parts[s]=b,this.onlyOneNumberPart=0===s,0===s)this.parts[1]=b,this.parts[2]=b,this.condPos=u;else if(1===s)this.condNeg=u;else if(void 0!==u)throw new we(this.notFormatString("condition in zero part"))}if(!a)throw new we(this.notFormatString("too many parts"));i||(this.parts[0]=Ae,this.parts[1]=Ae,this.parts[2]=Ae,this.posBeforeText=!1),n||(this.parts[3]=Ae),i&&!n&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Oe(this.parts[0].code)&&(this.parts[1]=Ae,this.onlyOneNumberPart=!1),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((function(e){return void 0!==e}))),this.checkBytecode()},e.prototype.tokenize=function(e){for(var t,r,n,i=this.config.localeInfo,o={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};o.consumed<e.length&&o.eos;){var a=this.readToken(o,e,o.consumed),s=t;switch(t=a,o.consumed+=a.tokenStr.length,a.kind){case m.PictureSingle.Sep:o.eos=!1;continue;case ie.Color:if(void 0!==o.color)throw new we(this.notFormatString("more than one color"));if(0!==o.tokens.length)throw new we((0,g.notImplemented)(["colour in middle of format"]));o.color=a.color;continue;case ie.Dbnum:if(void 0!==o.dbnum)throw new we(this.notFormatString("more than one DBNUM"));if(o.dbnumForbidden)throw new we(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==o.tokens.length)throw new we((0,g.notImplemented)(["DBNUM in middle of format"]));o.dbnum=a.dbnum;continue;case ie.Cond:if(void 0!==o.cond)throw new we(this.notFormatString("more than one condition"));if(0!==o.tokens.length)throw new we((0,g.notImplemented)(["condition in middle of format"]));o.cond=a.cond;continue;case ie.CurrCode:if(void 0!==r)throw new we(this.notFormatString("more than one currency code in section"));r=a;break;case ie.Currency:n=a;break;case ie.AMPM:case ie.AMPMFE:case m.PictureSingle.Colon:case m.PictureSingle.DateSep:case ie.LatinDate:case ie.BidiDate:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case m.PictureSingle.Reign:case m.PictureSingle.LocDay:case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.EngYearTh:case m.PictureSingle.DayTh:case m.PictureSingle.MonthTh:case m.PictureSingle.YearTh:case m.PictureSingle.ThYear:case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:if((null==s?void 0:s.kind)===a.kind){s.count+=a.count;continue}}o.tokens.push(a)}return void 0!==r?(o.hasTokenCurrCode=!0,o.currCode=r.currCode,o.currencySymbol=r.currencySymbol):void 0!==n&&void 0===o.currencySymbol&&(o.currencySymbol=v.FormatCurrency.LocaleInfo),4!==o.dbnum||i.isKorea||void 0===o.currCode&&!i.isThai||(o.dbnum=void 0),o},e.prototype.readToken=function(e,t,r){var n=this.config,i=n.mathpack,o=n.localeInfo,a=le(o,o.pictureSpecial,t,r);if(void 0!==a){var s=a,l=ce(o.pictureSpecial,s);o.isJapan&&s===m.PictureSpecial.GeneralOldMAC&&(s=m.PictureSpecial.General);var u=t.substring(r,r+l.length);switch(s){case m.PictureSpecial.AP1:case m.PictureSpecial.AP2:return{kind:ie.AMPM,tokenStr:u,count:1,pictureKind:s};case m.PictureSpecial.AP3:return{kind:ie.AMPMFE,tokenStr:u,count:1};case m.PictureSpecial.General:return{kind:ie.General,tokenStr:u};case m.PictureSpecial.Currency:return{kind:ie.Currency,tokenStr:u}}}var c,d=(0,S.stringCodePointAt)(t,r),f=(0,S.numCodeUnits)(d),v=t.substring(r,r+f),y=ue(o,o.pictureSingle,t,r);if(void 0!==y){s=y;if((o.isJapan||o.isChinaT)&&(s===m.PictureSingle.E||s===m.PictureSingle.EraYear)){var C=void 0,N=void 0;s=!(r+f+1<t.length)||(C=t.charCodeAt(r+f))!==w&&C!==L||(N=t.charCodeAt(r+f+1))!==x&&N!==B&&N!==U?m.PictureSingle.EraYear:m.PictureSingle.E}if(s===m.PictureSingle.BidiDate||s===m.PictureSingle.EngYearTh){C=void 0;if(r+f<t.length&&((C=t.charCodeAt(r+f))===G||C===K))return{kind:C===G?ie.LatinDate:ie.BidiDate,tokenStr:t.substring(r,r+f+1),count:1};s=m.PictureSingle.EngYearTh}if(s===m.PictureSingle.BidiNum)throw new we(this.notFormatString("bidi num not allowed"));switch(s){case m.PictureSingle.Star:case m.PictureSingle.Underscore:if(r+f>=t.length)throw new we(this.notFormatString("unterminated "+v));C=(0,S.stringCodePointAt)(t,r+f);var T=(0,S.numCodeUnits)(C),P=(0,S.stringFromCodePoint)(C);return{kind:s,tokenStr:u=t.substring(r,r+f+T),escaped:P};case m.PictureSingle.Backslash:return this.readToken_Backslash(t,r,f);case m.PictureSingle.Quote:var E=t.indexOf(v,r+f);if(E<0)throw new we(this.notFormatString("unterminated quoted string"));var k=t.substring(r+f,E),A=(u=t.substring(r,E+f),le(o,o.pictureSpecial,k,0));return void 0!==A&&A===m.PictureSpecial.Currency&&ce(o.pictureSpecial,A).length===k.length?{kind:ie.Currency,tokenStr:u}:{kind:ie.StrLit,tokenStr:u,escaped:k};case m.PictureSingle.E:if(o.isEastAsia){if(void 0!==e.dbnum)throw new we(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new we((0,g.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+f>=t.length)throw new we(this.notFormatString("unterminated exp"));if((C=t.charCodeAt(r+f))!==L&&C!==w)throw new we(this.notFormatString("exp not followed by sign"));u=t.substring(r,r+f+1);return{kind:ie.Exp,tokenStr:u,eStr:v,isNeg:C===w};case m.PictureSingle.Hash:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case m.PictureSingle.YearTh:case m.PictureSingle.MonthTh:case m.PictureSingle.DayTh:case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Question:case m.PictureSingle.Comma:case m.PictureSingle.Reign:case m.PictureSingle.LocDay:case m.PictureSingle.Era:case m.PictureSingle.EraYear:if(s===m.PictureSingle.Reign&&!o.isJapan&&!o.isChinaT)break;for(var I=f,_=1;(0,b.stringStartsWith)(t,v,r+I)&&void 0===le(o,o.pictureSpecial,t,r+I);)I+=f,_+=1;if(s===m.PictureSingle.LocDay&&_<3)break;return{kind:s,tokenStr:u=t.substring(r,r+I),count:_};case m.PictureSingle.Sep:case m.PictureSingle.Text:case m.PictureSingle.Decimal:case m.PictureSingle.Slash:case m.PictureSingle.Minus:case m.PictureSingle.Plus:return{kind:s,tokenStr:v};case m.PictureSingle.Space:return{kind:ie.Char,tokenStr:v,escaped:v};case m.PictureSingle.Colon:return{kind:s,tokenStr:v,count:1};case m.PictureSingle.Percent:if(o.isEastAsia){if(void 0!==e.dbnum)throw new we(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new we((0,g.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:m.PictureSingle.Percent,tokenStr:v};case m.PictureSingle.DateSep:return v===ce(o.pictureSingle,m.PictureSingle.Slash)?{kind:m.PictureSingle.Slash,tokenStr:v}:v===ce(o.pictureSingle,m.PictureSingle.Minus)?{kind:m.PictureSingle.Minus,tokenStr:v}:{kind:m.PictureSingle.DateSep,tokenStr:v,count:1};case m.PictureSingle.ColorStart:var F=ce(o.pictureSingle,m.PictureSingle.ColorEnd),M=t.indexOf(F,r+f);if(M<0)throw new we(this.notFormatString("unterminated ["));var D=t.substring(r+f,M),Q=(u=t.substring(r,M+F.length),le(o,oe,D,0));if(void 0!==Q){for(var q=ce(oe,Q).length;q<D.length&&(0,R.isSpace)(D.charCodeAt(q));)q+=1;var z=(0,R.parseSignedLiteral)(o,i,D,q,!1);if(z[1]===q)throw new we((0,g.notImplemented)(["invalid number in condition"]));if(z[1]!==D.length)throw new we((0,g.notImplemented)(["trailing junk after condition"]));return{kind:ie.Cond,tokenStr:u,cond:{operator:ae[Q],operand:z[0]}}}var Y=le(o,o.pictureColor,D,0);if(void 0!==Y){var J=ce(o.pictureColor,Y);if(Y!==m.PictureColor.Color){if(J.length!==D.length)throw new we((0,g.notImplemented)(["trailing junk after named color"]));return{kind:ie.Color,tokenStr:u,color:(c=Y,m.PictureColor[c])}}if(Y===m.PictureColor.Color){for(var X=J.length;X<D.length&&(0,R.isSpace)(D.charCodeAt(X));)X+=1;var $=(0,R.parseUint)(o,4,D,X),Z=$[0],ee=$[1];if(ee===X)throw new we(this.notFormatString("missing number for numbered color"));if(ee!==D.length)throw new we((0,g.notImplemented)(["trailing junk after numbered color"]));if(Z<1||Z>56)throw new we(this.notFormatString("out-of-range numbered color"));return{kind:ie.Color,tokenStr:u,color:Z+8}}}var te=le(o,o.pictureDbnum,D,0);if(void 0!==te){if(ce(o.pictureDbnum,te).length!==D.length)throw new we((0,g.notImplemented)(["trailing junk after DBNUM"]));return{kind:ie.Dbnum,tokenStr:u,dbnum:ne(te)}}return(0,b.stringStartsWith)(D,"$")?p.__assign({kind:ie.CurrCode,tokenStr:u},this.parseCurrCode(D.substring("$".length))):{kind:s,tokenStr:v};case m.PictureSingle.ColorEnd:return{kind:s,tokenStr:v};case m.PictureSingle.OpenParen:case m.PictureSingle.CloseParen:return{kind:s,tokenStr:v,escaped:v};case m.PictureSingle.Extra:case m.PictureSingle.APDelim:case m.PictureSingle.Nen1:case m.PictureSingle.Gatsu1:case m.PictureSingle.Nichi1:case m.PictureSingle.Nen2:case m.PictureSingle.Gatsu2:case m.PictureSingle.Nichi2:break;case m.PictureSingle.Zero:case m.PictureSingle.ZeroTh:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",s)}}if(o.isNumeral(d)){if(o.getNumberShape(d)!==O.NumberShape.ASCII)throw new we((0,g.notImplemented)(["non-ASCII digits"]));var re=o.getOrdinal(d);if(0===re){var se=f;for(_=1;(0,b.stringStartsWith)(t,v,r+se);)se+=f,_+=1;u=t.substring(r,r+se);return{kind:m.PictureSingle.Zero,tokenStr:u,count:_}}return{kind:ie.Numeral,tokenStr:v,ordinal:re}}switch(d){case V:return{kind:m.PictureSingle.OpenParen,tokenStr:v,escaped:v};case j:return{kind:m.PictureSingle.CloseParen,tokenStr:v,escaped:v};case H:return this.readToken_Backslash(t,r,f);case W:if(o.isThai)return{kind:ie.PrefixDigTh,tokenStr:v}}return{kind:ie.Char,tokenStr:v,escaped:v}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new we(this.notFormatString("unterminated backslash"));var n=(0,S.stringCodePointAt)(e,t+r),i=(0,S.numCodeUnits)(n),o=(0,S.stringFromCodePoint)(n),a=e.substring(t,t+r+i);return n===V||n===j?{kind:n===V?m.PictureSingle.OpenParen:m.PictureSingle.CloseParen,tokenStr:a,escaped:o}:{kind:ie.Char,tokenStr:a,escaped:o}},e.prototype.convertTokToSun=function(e){var t,r,n,i,o,a,s,l=this,u=e.color,c=e.dbnum,d=e.cond,f=e.currCode,p=e.tokens,v=this.config.localeInfo,S={suns:[],dtrRounding:A.Rounding.RoundSec,color:u,dbnum:c,currCode:f,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===d&&void 0===u&&void 0===c&&void 0===f}},y=0===v.stringCompareCI(ce(v.pictureSingle,m.PictureSingle.Month),ce(v.pictureSingle,m.PictureSingle.Minute)),C=!1,R=0,b=0,N=!1,P=!1,E=!1,k=!1,O=0,I=function(e,t){var n=Pe[e];if(t){if(P)throw new we(l.notFormatString("more than one absolute time"));if(void 0!==r&&n>=r)throw new we(l.notFormatString("absolute time must be largest division"));P=!0}else if(P&&n<=r)throw new we((0,g.notImplemented)(["larger time division after absolute time"]));(void 0===r||n<r)&&(r=n)};function _(e,t,n){var i=r;if(I(e,t),e===m.PictureSingle.Hour||e===m.PictureSingle.HourTh)E=!0,o=n,a=void 0;else if(e===m.PictureSingle.Second||e===m.PictureSingle.SecondTh)if(void 0===a||P)void 0===i&&(E=!0);else{var s=a.code[0];(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",s.kind===m.PictureSingle.Month);var l=m.PictureSingle.Minute,u=s.count;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===u||2===u);I(l,!1),R-=1,b+=1,a.code=[{kind:l,count:u,isAbs:!1}],a=void 0}else E=!1}function F(e){var t=ce(v.pictureSingle,e.kind);return{kind:406,printAsTimeSep:R>0||b>0,formattedStr:t}}function M(e){var t=ce(v.pictureSingle,e.kind);return t===ce(v.pictureSingle,m.PictureSingle.DateSep)?{kind:405}:t===ce(v.pictureSingle,m.PictureSingle.Colon)?F(e):{kind:400,formattedStr:t}}for(var D=0;D<p.length;D+=1){var w=p[D];switch(w.kind){case ie.AMPM:case ie.AMPMFE:case m.PictureSingle.Colon:case m.PictureSingle.DateSep:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case m.PictureSingle.Reign:case m.PictureSingle.LocDay:case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.EngYearTh:case ie.LatinDate:case ie.BidiDate:case m.PictureSingle.DayTh:case m.PictureSingle.MonthTh:case m.PictureSingle.YearTh:case m.PictureSingle.ThYear:case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:var L={kind:1,code:[]};switch(S.suns.push(L),N=!0,w.kind){case ie.LatinDate:case ie.BidiDate:if(0!==D&&(1!==D||p[0].kind!==ie.CurrCode))throw new we(this.notFormatString("bidi date must be first"));L.code.push(w);break;case m.PictureSingle.DateSep:L.code.push({kind:405});break;case m.PictureSingle.Colon:L.code.push(F(w));break;case m.PictureSingle.Reign:R+=1,v.isJapan&&w.count>=2&&L.code.push({kind:m.PictureSingle.Era,count:3}),L.code.push({kind:m.PictureSingle.EraYear,count:v.isChinaT?1:2});break;case m.PictureSingle.Era:R+=1,L.code.push({kind:m.PictureSingle.Era,count:(0,T.fastMin)(3,w.count)});break;case m.PictureSingle.EraYear:R+=1,L.code.push({kind:m.PictureSingle.EraYear,count:(0,T.fastMin)(2,w.count)});break;case m.PictureSingle.Year:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:a=void 0,R+=1,L.code.push({kind:w.kind,count:w.count<=2?2:4});break;case m.PictureSingle.Month:if(y&&w.count<=2){if(E){_($=m.PictureSingle.Minute,x=!1,L),b+=1,L.code.push({kind:$,count:w.count,isAbs:x}),E=!1;break}a=L}else a=void 0;R+=1,L.code.push({kind:w.kind,count:(0,T.fastMin)(5,w.count)});break;case m.PictureSingle.MonthTh:R+=1,L.code.push({kind:w.kind,count:(0,T.fastMin)(4,w.count)});break;case m.PictureSingle.Day:case m.PictureSingle.DayTh:a=void 0,R+=1,L.code.push({kind:w.kind,count:(0,T.fastMin)(4,w.count)});break;case m.PictureSingle.LocDay:a=void 0,R+=1,L.code.push({kind:m.PictureSingle.LocDay,count:3===w.count?3:4});break;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:var x=!1;_(w.kind,x,L),b+=1;var B=(0,T.fastMin)(2,w.count);w.kind===m.PictureSingle.Hour||w.kind===m.PictureSingle.HourTh?L.code.push({kind:w.kind,count:B,isAbs:x,isAMPM:!1}):L.code.push({kind:w.kind,count:B,isAbs:x});break;case ie.AMPM:case ie.AMPMFE:if(P)throw new we(this.notFormatString("AM/PM after absolute time"));if(w.count>1)throw new we((0,g.notImplemented)(["multiple AM/PM symbols"]));if(void 0!==o)(Q=o.code[0]).isAMPM=!0,o=void 0;k=!0,L.code.push(w);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",w)}break;case m.PictureSingle.Decimal:case ie.Numeral:case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:case m.PictureSingle.Comma:if(N){if(w.kind!==m.PictureSingle.Decimal&&w.kind!==m.PictureSingle.Comma)throw new we(this.notFormatString("number picture in date/time format"));var U={kind:1,code:[]};S.suns.push(U);var G=p[D+1];if(w.kind===m.PictureSingle.Decimal&&(null==G?void 0:G.kind)===m.PictureSingle.Zero){var K=G.count;if(K>3)throw new we(this.notFormatString("invalid number of fractional seconds"));D+=1,_(m.PictureSingle.Second,!1,U),b+=1,U.code.push({kind:404,rounding:K}),S.dtrRounding=(0,T.fastMax)(S.dtrRounding,K)}else U.code.push(M(w));break}if(w.kind===m.PictureSingle.Comma){var V={kind:7,code:[{kind:400,formattedStr:ce(v.pictureSingle,w.kind)}]};S.suns.push(V);break}L={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};S.suns.push(L),void 0===n&&(n=L),i=L;var j=void 0;for(D-=1;D+1<p.length;D+=1){var W=p[D+1],H=!0;switch(W.kind){case m.PictureSingle.Decimal:C=L.decimal=!0,L.code.push(W),j=void 0;break;case ie.Numeral:L.code.push({kind:W.kind,formattedStr:W.tokenStr,ordinal:W.ordinal}),L.numVal=L.nonZero=!0,j=void 0;break;case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:if(L.decimal?L.numDigDec+=W.count:L.numDigLeft+=W.count,void 0===L.firstDig&&(L.firstDig=W.kind),L.lastDig=W.kind,W.kind===m.PictureSingle.Hash?L.anyHash=!0:W.kind===m.PictureSingle.Question?L.anyQuestion=!0:(L.anyZero=!0,L.numVal=!0),void 0!==j&&j.kind===W.kind)j.count+=W.count;else{var Q={kind:W.kind,count:W.count};L.code.push(Q),j=Q}break;case m.PictureSingle.Comma:G=null===(t=p[D+2])||void 0===t?void 0:t.kind;if((s=G)!==ie.Numeral&&s!==m.PictureSingle.Hash&&s!==m.PictureSingle.Zero&&s!==m.PictureSingle.Question){B=W.count;var q=ce(v.pictureSingle,m.PictureSingle.Space);q===ce(v.pictureSingle,m.PictureSingle.Comma)&&(!v.isCurrencySymbolLead&&v.isCurrencySepBySpace&&G===ie.Currency||v.isPercentSepBySpace&&G===m.PictureSingle.Percent)&&(L.code.push({kind:400,formattedStr:q}),B-=1),B>0&&(L.numThousands+=B)}else C||(L.comma=!0);break;default:H=!1}if(!H)break}break;case m.PictureSingle.Percent:O+=1;L={kind:3,code:[{kind:m.PictureSingle.Percent,formattedStr:w.tokenStr}]};S.suns.push(L),S.hasPercent=!0;break;case ie.Exp:L={kind:4,code:[{kind:ie.Exp,formattedStr:w.eStr,isNeg:w.isNeg}],isNeg:w.isNeg};S.suns.push(L);break;case ie.General:L={kind:6,code:[w]};S.suns.push(L);break;case m.PictureSingle.Text:L={kind:5,code:[w]};S.suns.push(L);break;case m.PictureSingle.Slash:if(N){var z={kind:1,code:[M(w)]};S.suns.push(z);break}L={kind:2,code:[{kind:m.PictureSingle.Slash,formattedStr:w.tokenStr}]};S.suns.push(L);break;case m.PictureSingle.Star:case ie.PrefixDigTh:case m.PictureSingle.Underscore:case ie.Currency:case ie.CurrCode:case ie.StrLit:L={kind:7,code:[w]};S.suns.push(L);break;case m.PictureSingle.ColorEnd:case m.PictureSingle.Plus:L={kind:7,code:[{kind:400,formattedStr:w.tokenStr}]};S.suns.push(L);break;case m.PictureSingle.OpenParen:case m.PictureSingle.CloseParen:case ie.Char:L={kind:7,code:[{kind:400,formattedStr:w.escaped}]};S.suns.push(L);break;case m.PictureSingle.Minus:if(N){var Y={kind:1,code:[M(w)]};S.suns.push(Y);break}L={kind:7,code:[{kind:400,formattedStr:ce(v.pictureSingle,w.kind)}]};S.suns.push(L);break;case m.PictureSingle.ColorStart:var J=0;for(L={kind:1,code:[]};D+1<p.length&&2!==J;D+=1){var X=p[D+1];switch(X.kind){case m.PictureSingle.ColorEnd:if(1!==J)throw new we(this.notFormatString("unexpected closing ]"));J=2;continue;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Month:case m.PictureSingle.Minute:case m.PictureSingle.Second:if(X.kind===m.PictureSingle.Month&&!y)break;var $;_($=X.kind===m.PictureSingle.Month?m.PictureSingle.Minute:X.kind,x=!0,L),b+=1;B=(0,T.fastMin)(2,X.count);$===m.PictureSingle.Hour||$===m.PictureSingle.HourTh?L.code.push({kind:$,count:B,isAbs:x,isAMPM:!1}):L.code.push({kind:$,count:B,isAbs:x}),N=!0,J=1;continue;case ie.Char:if(X.tokenStr===ce(v.pictureSingle,m.PictureSingle.Space))continue}throw new we(this.notFormatString("unexpected token after ["))}if(2!==J)throw new we((0,g.notImplemented)(["semicolon inside [ ]"]));S.suns.push(L);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",w)}if(S.suns.length>=2){var Z=S.suns[S.suns.length-2],ee=S.suns[S.suns.length-1];if(7===Z.kind&&7===ee.kind){var te=Z.code;(0,T.safePush)(te,ee.code),S.suns.pop()}}}(void 0!==n&&(n.numThousands=i.numThousands,n.numPercent=O),k&&void 0!==o)&&((Q=o.code[0]).isAMPM=!0);if(P)for(var re=0,ne=S.suns;re<ne.length;re++){if(1===(L=ne[re]).kind)for(var oe=0,ae=L.code;oe<ae.length;oe++){switch((Q=ae[oe]).kind){case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:Q.isAbs=Pe[Q.kind]===r}}}if(S.suns.length>32)throw new we(this.notFormatString("format string too long: SUNs limit"));return S.hasDate=R>0,S.hasTime=b>0,S},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,i=e.hasDate,o=e.hasTime,a=2===t,s=3===t,l=!a&&!s,u=0,c=r;u<c.length;u++){var d=c[u];switch(d.kind){case 0:case 2:case 3:case 4:a=!0;break;case 5:s=!0;break;case 6:continue;case 7:case 1:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",d)}l=!1}if((a?1:0)+(i||o?1:0)+(s?1:0)>1)throw new we(this.notFormatString("cannot mix number/date/text"));return a||i||o?2:s?3:l&&!n?1:t},e.prototype.convertSunToCode=function(t){var r,n=t.suns,i=t.isEmpty,o=t.dtrRounding,a=t.color,s=t.dbnum,l=t.currCode,u=this.config.localeInfo,c=[];function d(e){for(var t=e-1;t>=0;t-=1){var r=n[t];if(0===r.kind)return[t,r]}}function f(e){for(var t=e+1;t<n.length;t+=1){var r=n[t];if(0===r.kind)return[t,r]}}for(var m=!1,g=0,S=0;S<n.length;S+=1){var y=n[S];switch(y.kind){case 5:if(5===r)break;if(void 0!==r)throw new we(this.notFormatString("@ after other control"));r=5;break;case 6:if(void 0!==r)throw new we(this.notFormatString("General after other control"));if(m)throw new we(this.notFormatString("General after number"));r=6;break;case 0:if(m=!0,6===r)throw new we(this.notFormatString("number after General"));break;case 2:if(void 0!==r)throw new we(this.notFormatString("/ after other control"));if(u.isEastAsia&&void 0!==s)throw new we(this.notFormatString("/ not allowed with DBNUM"));r=2;var C=d(S);if(void 0===C)throw new we(this.notFormatString("no number before /"));var R=this.mergeNumSuns(n,g,C[0]),b=R[0],N=R[1],P=R[2],E=f(S);if(void 0===E)throw new we(this.notFormatString("no number after /"));var k=n.slice(C[0]+1,E[0]),O=void 0!==f(E[0]);(0,T.safePush)(c,this.flattenSuns(b)),(0,T.safePush)(c,this.buildFractCode(N,P,C[1],k,E[1],O)),g=E[0]+1;break;case 4:if(void 0!==r)throw new we(this.notFormatString("E after other control"));r=4;var A=this.mergeNumSuns(n,g,S),I=A[0],_=A[1],F=A[2];if(void 0===_)throw new we(this.notFormatString("no number before E"));var M=this.mergeNumSuns(n,S+1,n.length),D=M[0],w=M[1],L=M[2];if(void 0===w)throw new we(this.notFormatString("no number after E"));(0,T.safePush)(c,this.flattenSuns(I)),(0,T.safePush)(c,this.buildExpCode(y.isNeg,_,p.__spreadArray(p.__spreadArray(p.__spreadArray([],F,!0),[n[S]],!1),D,!0),w)),(0,T.safePush)(c,this.flattenSuns(L)),g=n.length;break;case 3:case 7:case 1:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",y)}}if(void 0===r){var x=this.mergeNumSuns(n,g,n.length),B=(b=x[0],x[1]),U=x[2];void 0!==B?(0,T.safePush)(c,this.buildNumberCode(b,B)):(0,T.safePush)(c,this.flattenSuns(b)),(0,T.safePush)(c,this.flattenSuns(U)),g=n.length}(0,T.safePush)(c,this.flattenSuns(n.slice(g))),0!==n.length||i||c.push(ke);var G=null==l?void 0:l.tag;if((0,v.isSystemCultureTag)(G)){var K=G===v.CultureTag.SysDate?u.sysDateFormat:u.sysTimeFormat,V=new e(this.config,{old:void 0,formatString:K,source:v.NumberFormatSource.System}),j=V.parts[0];return{part:{code:[{kind:407,codeSysFormat:j.code,codeThisFormat:c}],color:j.color,dbnum:j.dbnum,dtrRounding:j.dtrRounding},applyCurrCode:V.thisCurrCode}}return{part:{code:c,color:a,dbnum:s,dtrRounding:o},applyCurrCode:l}},e.prototype.flattenSuns=function(e){return(0,T.safeConcat)([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new we(this.notFormatString("comma following E"));var i=t.numDigDec;if(i>127)throw new we(this.notFormatString("too many decimal digits"));var o=this.bumpDigitsForComma(t),a=o.code,s=o.comma;return[{kind:402,isNeg:e,numMantDigLeft:o.numDigLeft,numMantDigDec:i,numExpDigLeft:n.numDigLeft,commaMant:s,codeMant:a,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=t.numDigDec;if(r>127)throw new we(this.notFormatString("too many decimal digits"));var n=this.bumpDigitsForComma(t),i=n.code,o=n.comma;return[{kind:403,numDigLeft:n.numDigLeft,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:o,codeBefore:this.flattenSuns(e),code:i}]},e.prototype.buildFractCode=function(e,t,r,n,i,o){var a,s,l,u,c=this.config.mathpack;if(r.comma)throw new we(this.notFormatString("comma in numerator"));if(r.decimal)throw new we((0,g.notImplemented)(["decimals in numerator"]));if(i.comma)throw new we(this.notFormatString("comma in denominator"));if(i.decimal)throw new we(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new we(this.notFormatString("decimals in numerator"));if((u=i).numVal&&u.nonZero&&u.digitTokens)throw new we(this.notFormatString("literal and placeholder digits mixed in denominator"));if(o)throw new we((0,g.notImplemented)(["fraction number formats with trailing numbers"]));var d,f=!1,p=0;if(void 0!==e){if(!e.reallyNum)throw new we((0,g.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new we((0,g.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new we(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new we((0,g.notImplemented)(["numerals in fraction integer part"]));d=(a=this.bumpDigitsForComma(e)).code,f=a.comma,p=a.numDigLeft}var v=null!==(s=null==e?void 0:e.numPercent)&&void 0!==s?s:r.numPercent,S=null!==(l=null==e?void 0:e.numThousands)&&void 0!==l?l:r.numThousands;if(S>0)throw new we((0,g.notImplemented)(["fraction number formats with thousands"]));var y,C=i.code,R=i.numDigLeft,b=i.firstDig;if(i.numVal&&i.nonZero){if(o)throw new we((0,g.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(i.code.length>5)throw new we((0,g.notImplemented)(["too many digits in denominator"]));for(var N=0,T=0;T<i.code.length;T+=1){var P=i.code[T];switch(P.kind){case ie.Numeral:N=10*N+P.ordinal;break;case m.PictureSingle.Zero:if(0===T)throw new we((0,g.notImplemented)(["leading zero in denominator"]));N*=10;break;default:return(0,h.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(N>32767)throw new we((0,g.notImplemented)(["overflow in denominator not emulated"]));C=[{kind:m.PictureSingle.Hash,count:1}],R=1,b=void 0,y=c.fromNumber(N)}return[{kind:401,numIntDigLeft:p,numPercent:v,numThousands:S,numNumerDig:r.numDigLeft,numDenomDig:R,commaInt:f,codeInt:d,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:C,denomValue:y,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:b,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,i=[],o=[],a=t;a<e.length&&a<r;a+=1){var s=e[a];void 0!==n?0===s.kind?(n.decimal?n.numDigDec+=s.numDigLeft+s.numDigDec:(n.numDigLeft+=s.numDigLeft,n.numDigDec+=s.numDigDec),n.comma=n.comma||s.comma,n.decimal=n.decimal||s.decimal,n.numVal=n.numVal||s.numVal,n.nonZero=n.nonZero||s.nonZero,void 0!==s.lastDig&&(n.lastDig=s.lastDig),void 0===n.firstDig&&(n.firstDig=s.firstDig),n.anyHash=n.anyHash||s.anyHash,n.anyQuestion=n.anyQuestion||s.anyQuestion,n.anyZero=n.anyZero||s.anyZero,(0,T.safePush)(n.code,this.flattenSuns(o)),o.length=0,(0,T.safePush)(n.code,s.code)):o.push(s):0===s.kind?n=s:i.push(s)}return[i,n,o]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var i=e.code[n];switch(i.kind){case m.PictureSingle.Hash:return(o=e.code.slice())[n]=p.__assign(p.__assign({},i),{count:i.count+(r-e.numDigLeft)}),{code:o,comma:!0,numDigLeft:r};case m.PictureSingle.Zero:case m.PictureSingle.Question:case m.PictureSingle.Decimal:var o;return(o=e.code.slice()).splice(n,0,{kind:m.PictureSingle.Hash,count:r-e.numDigLeft}),{code:o,comma:!0,numDigLeft:r}}}throw new we((0,g.notImplemented)(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t=null==e?void 0:e.kind;return t===m.PictureSingle.Hash||t===m.PictureSingle.Zero||t===m.PictureSingle.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var i=e.code[n];if(i.kind===m.PictureSingle.Decimal)return!1;if(t(i))for(var o=0;o<i.count;o+=1)if((r-=1)>0&&r%3==0&&(o+1<i.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){var t,r,n,i=this.config.localeInfo,o=e.indexOf("-");if(0!==e.length&&0!==o){if((t=o<0?e:e.substring(0,o)).length>61)throw new we(this.notFormatString("currencySymbol too long"));for(var a=0,s=(0,S.codePointIterator)(t);a<s.length;a++){var l=s[a];if(i.isNumeral(l)&&i.getNumberShape(l)!==O.NumberShape.ASCII)throw new we((0,g.notImplemented)(["non-ASCII digits in currencySymbol"]))}}if(o>=0&&(n=e.substring(o+"-".length)),void 0!==n&&void 0===(r=this.parseFormatCulture(n)))throw new we((0,g.notImplemented)(["unhandled CurrCode: "+(0,M.anonymizeFormulaString)(e)]));if((0,v.isSystemCultureTag)(null==r?void 0:r.tag)){if(void 0!==t)throw new we(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===v.NumberFormatSource.System)throw new we(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:t,currCode:r}},e.prototype.parseFormatCulture=function(e){var t,r,n={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},i=e.match(pe);if(null!=i){n.culture=null!==(t=i[1])&&void 0!==t?t:"";var o=null!==(r=i[2])&&void 0!==r?r:i[3];if(null!=o){if(n.tag=ge[o.toLowerCase()],void 0===n.tag)throw new we((0,g.notImplemented)(["unknown CurrCode tag: "+(0,M.anonymizeFormulaString)(e)]));switch(n.tag){case v.CultureTag.SysDate:case v.CultureTag.SysTime:case v.CultureTag.Euro1:case v.CultureTag.Euro2:case v.CultureTag.Bitcoin1:case v.CultureTag.Bitcoin2:if(""!==n.culture)throw new we(this.notFormatString("CultureTag ".concat(String(n.tag)," cannot have culture")));break;case v.CultureTag.GenLower:case v.CultureTag.GenUpper:case v.CultureTag.NomLower:case v.CultureTag.Gannen:if(""===n.culture)throw new we(this.notFormatString("CultureTag ".concat(String(n.tag)," must have culture")))}}var a=i[4];if(null!=a){var s=Se(a),l=(32512&s)>>8;if(0!==l&&(n.numberShape=me[l],void 0===n.numberShape))throw new we((0,g.notImplemented)(["unknown number shape ".concat(l," in culture: ").concat((0,M.anonymizeFormulaString)(e))]));n.nationalNumberInput=0!=(32768&s);var u=127&s;if(0!==u&&(n.calendar=he[u],void 0===n.calendar))throw new we((0,g.notImplemented)(["unknown calendar ".concat(u," in culture: ").concat((0,M.anonymizeFormulaString)(e))]));n.localCalendarInput=0!=(128&s)}return n}if(fe.test(e)){var c=Se(e);switch(c){case m.LCID.SystemLongDate:n.tag=v.CultureTag.SysDate;break;case m.LCID.SystemTime:n.tag=v.CultureTag.SysTime;break;case m.LCID.EuroTrailing:n.tag=v.CultureTag.Euro1;break;case m.LCID.EuroLeading:n.tag=v.CultureTag.Euro2;break;default:64512==(64512&c)&&(n.tag=v.CultureTag.GenLower),63488==(64512&c)&&(n.tag=v.CultureTag.GenUpper),62464==(64512&c)&&(n.tag=v.CultureTag.NomLower),void 0!==n.tag&&(c&=-63489),n.culture=(0,D.convertKnownLCID)(c)}return n}},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,n=this.parts;r<n.length;r++){var i=n[r];t.accountFill=!1;var o=this.determineValueTypeCodes(t,i.code);if(void 0!==o)return o;if(t.accountFill&&(t.fvt===v.FormatValueType.Number||t.fvt===v.FormatValueType.Currency))return v.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===ce(e.pictureSpecial,m.PictureSpecial.General)?v.FormatValueType.General:v.FormatValueType.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,n=0;n<t.length;n+=1){var i=t[n];switch(i.kind){case ie.General:break;case m.PictureSingle.Text:return v.FormatValueType.Text;case m.PictureSingle.Star:e.accountFill=!0;break;case 400:case ie.Exp:case m.PictureSingle.Slash:case ie.StrLit:case m.PictureSingle.Percent:case m.PictureSingle.Underscore:case ie.Numeral:case 405:case 406:break;case ie.Currency:e.fvt=v.FormatValueType.Currency;break;case ie.CurrCode:void 0!==i.currencySymbol&&(e.fvt=v.FormatValueType.Currency);break;case 403:e.fvt=1===i.numPercent&&0===i.numThousands?v.FormatValueType.Percentage:v.FormatValueType.Number;var o=i.codeBefore,a=0;if(r.isEastAsia){if(a<o.length&&"("===Ee(o[a])&&(a+=1),a<o.length&&"US$"===Ee(o[a]))return v.FormatValueType.Currency;if(r.isChinaT){if(a<o.length&&"NT$"===Ee(o[a]))return v.FormatValueType.Currency}else if(a<o.length&&"$"===Ee(o[a]))return v.FormatValueType.Currency}var s=void 0;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBefore.slice(a))))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.code)))return s;break;case 402:e.fvt=v.FormatValueType.Scientific;s=void 0;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeMant)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeExp)))return s;break;case 401:e.fvt=v.FormatValueType.Fraction;s=void 0;if(void 0!==i.codeInt&&void 0!==(s=this.determineValueTypeCodes(e,i.codeInt)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween1)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeNumer)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween2)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeDenom)))return s;break;case m.PictureSingle.Decimal:case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:break;case ie.PrefixDigTh:case ie.LatinDate:case ie.BidiDate:break;case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case 404:return v.FormatValueType.Time;case ie.AMPM:case ie.AMPMFE:break;case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.MonthTh:case m.PictureSingle.DayTh:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.LocDay:return v.FormatValueType.Date;case 407:return this.determineValueTypeCodes(e,i.codeThisFormat);default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",i)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[0].code;e<t.length;e++){var r=t[e];switch(r.kind){case 403:return r.numDigDec;case 402:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=ce(this.config.localeInfo.pictureSingle,m.PictureSingle.BidiDate);return(0,b.stringStartsWith)(this.formatString,e+"1")?v.BidiDate.English:(0,b.stringStartsWith)(this.formatString,e+"2")?v.BidiDate.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],i=t[2],o=t[3],a=!(Ie(o)||o===r),s=this.posBeforeText||!a,l="";return s&&(l+=this.printPart(r,this.condPos),n!==r&&(l+=ce(e.pictureSingle,m.PictureSingle.Sep),l+=this.printPart(n,this.condNeg),i!==r&&(l+=ce(e.pictureSingle,m.PictureSingle.Sep),l+=this.printPart(i,void 0)))),a&&(s&&(l+=ce(e.pictureSingle,m.PictureSingle.Sep)),l+=this.printPart(o,void 0)),l},e.prototype.printPart=function(e,t){var r,n=this.config,i=n.mathpack,o=n.localeInfo,a="";if(void 0!==e.color&&(a+=ce(o.pictureSingle,m.PictureSingle.ColorStart)+("number"==typeof e.color?ce(o.pictureColor,m.PictureColor.Color)+String(e.color-8):ce(o.pictureColor,(r=e.color,m.PictureColor[r])))+ce(o.pictureSingle,m.PictureSingle.ColorEnd)),void 0!==t){a+=ce(o.pictureSingle,m.PictureSingle.ColorStart)+ce(oe,se[t.operator])+i.formatGeneral(o,t.operand,21)+ce(o.pictureSingle,m.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(a+=ce(o.pictureSingle,m.PictureSingle.ColorStart)+ce(o.pictureDbnum,e.dbnum-1)+ce(o.pictureSingle,m.PictureSingle.ColorEnd)),a+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var n,i=this.config,o=i.mathpack,a=i.localeInfo,s="";if(void 0!==r&&r.numThousands>0){for(var l=0;l<t.length;l+=1){var u=t[l].kind;u!==m.PictureSingle.Zero&&u!==m.PictureSingle.Hash&&u!==m.PictureSingle.Question&&u!==m.PictureSingle.Decimal&&u!==ie.Numeral||(n=l)}(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==n)}var c=function(i){var l=t[i],u=e.wasPrevDig;switch(e.wasPrevDig=!1,l.kind){case ie.General:s+=ce(a.pictureSpecial,m.PictureSpecial.General);break;case m.PictureSingle.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,s+=ce(a.pictureSingle,m.PictureSingle.Decimal);break;case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:e.seenDig=!0,e.wasPrevDig=!0;var c=l.kind===m.PictureSingle.Zero?"0":ce(a.pictureSingle,l.kind),f=(0,b.repeat)(c,l.count);if(void 0===r||r.decimal){s+=f;break}if(r.comma){var p=r.numDigLeft-l.count;s+=(0,E.insertCommas)({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>p||((n=null===(r=t[i+1])||void 0===r?void 0:r.kind)===m.PictureSingle.Hash||n===m.PictureSingle.Zero||n===m.PictureSingle.Question))},thousandsSeparator:ce(a.pictureSingle,m.PictureSingle.Comma)},f,p)}else s+=f;r.numDigLeft-=l.count;break;case ie.Numeral:e.wasPrevDig=!0,s+=l.formattedStr;break;case 402:s+=d.printCodes(e,l.codeMant,{comma:l.commaMant,numThousands:0,decimal:!1,numDigLeft:l.numMantDigLeft})+d.printCodes(e,l.codeBetween,void 0)+d.printCodes(e,l.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:l.numExpDigLeft});break;case 403:s+=d.printCodes(e,l.codeBefore,void 0)+d.printCodes(e,l.code,{comma:l.comma,numThousands:l.numThousands,decimal:!1,numDigLeft:l.numDigLeft});break;case 401:var g=void 0===l.codeInt?"":d.printCodes(e,l.codeInt,{comma:l.commaInt,numThousands:0,decimal:!1,numDigLeft:l.numIntDigLeft}),y=d.printCodes(e,l.codeBetween1,void 0),C=d.printCodes(e,l.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:l.numNumerDig}),R=d.printCodes(e,l.codeBetween2,void 0),N=d.printCodes(e,l.codeDenom,{comma:!1,numThousands:l.numThousands,decimal:!1,numDigLeft:l.numDenomDig});s+=g+y+C+R+(void 0!==l.denomValue?Y(o,l.denomValue):N);break;case 400:var T=ce(a.pictureSingle,m.PictureSingle.Backslash),P=ue(a,a.pictureSingle,l.formattedStr,0),k=function(e,t,r,n){for(var i=r.substring(n,n+(0,S.numCodeUnits)((0,S.stringCodePointAt)(r,n))),o=0;o<t.length;o+=1){var a=t[o];if(null!=a&&0!==a.length){var s=a.substring(0,(0,S.numCodeUnits)((0,S.stringCodePointAt)(a,0)));if(0===e.stringCompareCI(i,s))return!0}}return!1}(a,a.pictureSpecial,l.formattedStr,0);if(void 0!==P&&P!==m.PictureSingle.Extra&&P!==m.PictureSingle.Zero)switch(P){case m.PictureSingle.Comma:var O=t[i+1];if(u){var A=ce(a.pictureSingle,m.PictureSingle.Space);if(l.formattedStr!==A||void 0===O||(a.isCurrencySymbolLead||!a.isCurrencySepBySpace||O.kind!==ie.Currency)&&(!a.isPercentSepBySpace||O.kind!==m.PictureSingle.Percent)){s+=T;break}}if(400===(null==O?void 0:O.kind)&&(null==O?void 0:O.formattedStr)===l.formattedStr){s+=T;break}break;case m.PictureSingle.Decimal:s+=T;break;case m.PictureSingle.Slash:e.seenDig&&(s+=T);break;case m.PictureSingle.Space:case m.PictureSingle.Minus:case m.PictureSingle.Plus:case m.PictureSingle.OpenParen:case m.PictureSingle.CloseParen:break;case m.PictureSingle.DateSep:ce(a.pictureSingle,m.PictureSingle.DateSep)!==ce(a.pictureSingle,m.PictureSingle.Minus)&&(s+=T);break;default:s+=T}else(k||a.isNumeral((0,S.stringCodePointAt)(l.formattedStr,0)))&&(s+=T);s+=l.formattedStr;break;case ie.Exp:s+=l.formattedStr+(l.isNeg?"-":"+");break;case ie.StrLit:T=ce(a.pictureSingle,m.PictureSingle.Quote);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",l.escaped.indexOf(T)<0),s+=T+l.escaped+T;break;case m.PictureSingle.Slash:s+=ce(a.pictureSingle,m.PictureSingle.Slash);break;case m.PictureSingle.Percent:s+=ce(a.pictureSingle,m.PictureSingle.Percent);break;case m.PictureSingle.Star:s+=ce(a.pictureSingle,m.PictureSingle.Star)+l.escaped;break;case m.PictureSingle.Underscore:s+=ce(a.pictureSingle,m.PictureSingle.Underscore)+l.escaped;break;case ie.PrefixDigTh:s+="t";break;case ie.Currency:s+=ce(a.pictureSpecial,m.PictureSpecial.Currency);break;case ie.CurrCode:if(s+=ce(a.pictureSingle,m.PictureSingle.ColorStart),s+="$",void 0!==l.currencySymbol&&(s+=l.currencySymbol),void 0!==l.currCode){var I=l.currCode,_=I.culture,F=I.numberShape,M=I.nationalNumberInput,D=I.calendar,w=I.localCalendarInput,L=I.tag;switch(s+="-",typeof _){case"number":var x=_;switch((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes lcid",void 0===F&&!M&&void 0===D&&!w),L){case void 0:break;case v.CultureTag.GenLower:x|=64512;break;case v.CultureTag.GenUpper:x|=63488;break;case v.CultureTag.NomLower:x|=62464;break;default:(0,h.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var B=ve(x);/^[a-f]{1,7}$/i.test(B)&&(B="0"+B),s+=B;break;case"string":s+=_,void 0!==L&&(""!==_&&(s+="-"),s+="x-",s+=String(L));var U=0;void 0!==F&&(U|=me.indexOf(F)<<8),M&&(U|=32768),void 0!==D&&(U|=he.indexOf(D)),w&&(U|=128),0!==U&&(s+=",",s+=ve(U))}}s+=ce(a.pictureSingle,m.PictureSingle.ColorEnd);break;case m.PictureSingle.Text:s+=ce(a.pictureSingle,m.PictureSingle.Text);break;case ie.LatinDate:s+=ce(a.pictureSingle,m.PictureSingle.BidiDate)+"1";break;case ie.BidiDate:s+=ce(a.pictureSingle,m.PictureSingle.BidiDate)+"2";break;case 404:s+=ce(a.pictureSingle,m.PictureSingle.Decimal)+(0,b.repeat)("0",l.rounding);break;case 405:s+=ce(a.pictureSingle,m.PictureSingle.DateSep);break;case 406:s+=ce(a.pictureSingle,m.PictureSingle.Colon);break;case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.Year:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Month:case m.PictureSingle.MonthTh:case m.PictureSingle.Day:case m.PictureSingle.DayTh:case m.PictureSingle.LocDay:s+=(0,b.repeat)(ce(a.pictureSingle,l.kind),l.count);break;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:if(l.isAbs){s+=ce(a.pictureSingle,m.PictureSingle.ColorStart)+(0,b.repeat)(ce(a.pictureSingle,l.kind),l.count)+ce(a.pictureSingle,m.PictureSingle.ColorEnd);break}s+=(0,b.repeat)(ce(a.pictureSingle,l.kind),l.count);break;case ie.AMPM:case ie.AMPMFE:l.kind===ie.AMPMFE||a.isEastAsia||l.pictureKind===m.PictureSpecial.AP2?s+=l.tokenStr:s+=ce(a.pictureSpecial,l.pictureKind);break;case 407:s+=d.printCodes(e,l.codeThisFormat,void 0);break;default:return{value:(0,h.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",l)}}i===n&&(s+=(0,b.repeat)(ce(a.pictureSingle,m.PictureSingle.Comma),r.numThousands))},d=this;for(l=0;l<t.length;l+=1){var f=c(l);if("object"==typeof f)return f.value}return s},e.prototype.countBytecodeBuffer=function(e){for(var t,r,n=this.config,i=n.mathpack,o=n.localeInfo,a=0,s=0;s<e.length;s+=1){var l=e[s],u=1;switch(l.kind){case m.PictureSingle.Percent:case ie.Numeral:case 400:case m.PictureSingle.Star:case m.PictureSingle.Underscore:u+=2;break;case ie.StrLit:u+=1+2*l.escaped.length;break;case 404:case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:case ie.Exp:u+=1;break;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:l.isAbs&&(u+=1);break;case 401:if(u+=5,void 0!==l.codeInt&&(u+=this.countBytecodeBuffer(l.codeInt)),u+=this.countBytecodeBuffer(l.codeBetween1),u+=this.countBytecodeBuffer(l.codeNumer),u+=this.countBytecodeBuffer(l.codeBetween2),u+=this.countBytecodeBuffer(l.codeDenom),void 0!==l.denomValue)u-=2,u+=2+2*Y(i,l.denomValue).length;l.commaInt&&(u+=1);break;case 402:u+=3,u+=this.countBytecodeBuffer(l.codeMant),u+=this.countBytecodeBuffer(l.codeBetween),u+=this.countBytecodeBuffer(l.codeExp),l.commaMant&&(u+=1);break;case 403:u+=3,u+=this.countBytecodeBuffer(l.codeBefore),u+=this.countBytecodeBuffer(l.code),l.comma&&(u+=1);break;case 407:u=0,u+=this.countBytecodeBuffer(l.codeThisFormat);break;case ie.CurrCode:u+=2*((null!==(r=null===(t=l.currencySymbol)||void 0===t?void 0:t.length)&&void 0!==r?r:0)+1),u+=8;break;case ie.AMPM:var c=o.isEastAsia||l.pictureKind===m.PictureSpecial.AP2?de(o,l.tokenStr):o.ampmSymbols;u+=2+2*(c[0].length+c[1].length);break;case ie.AMPMFE:break;case ie.General:case m.PictureSingle.Decimal:case m.PictureSingle.Slash:case ie.PrefixDigTh:case ie.Currency:case m.PictureSingle.Text:case ie.LatinDate:case ie.BidiDate:case 405:case 406:case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.Year:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Month:case m.PictureSingle.MonthTh:case m.PictureSingle.Day:case m.PictureSingle.DayTh:case m.PictureSingle.LocDay:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",l)}a+=u}return a},e.prototype.countBytecodePart=function(e){var t=e.code,r=0;return void 0!==e.color&&(r+=2),void 0!==e.dbnum&&(r+=2),0!==e.dtrRounding&&(r+=2),r+=this.countBytecodeBuffer(t)},e.prototype.countBytecode=function(){for(var e=0,t=0;t<=3;t+=1){(0===t&&void 0!==this.condPos||1===t&&void 0!==this.condNeg)&&(e+=10);for(var r=this.parts[t],n=!1,i=0;i<t;i+=1)if(this.parts[i]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e},e.prototype.checkBytecode=function(){if(this.countBytecode()>255)throw new we(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new we((0,g.notImplemented)(["format string too long: close to bytecode limit"]))},e.prototype.getBundledLocaleInfo=function(e,t,r){var n=r;switch(t){case O.Calendar.GregorianUS:n=ye;break;case O.Calendar.GregorianMEFrench:n=Ce;break;case O.Calendar.GregorianArabic:n=Re;break;case O.Calendar.GregorianXlitEnglish:n=be;break;case O.Calendar.GregorianXlitFrench:n=Ne;break;case O.Calendar.UmAlQura:case O.Calendar.Hijri:break;case O.Calendar.Thai:n=Te}if(void 0!==(null==n?void 0:n.culture)&&""!==n.culture){var i=(0,D.getBundledLocaleInfo)(n);if(void 0===i)throw new De(this.notImplementedCulture(e,n.culture));return i}return this.config.localeInfo},e.prototype.notFormatString=function(e){return(0,v.notFormatString)("".concat(e," (source=").concat(String(this.source),"): ").concat(this.logFormatString))},e.prototype.notImplementedCulture=function(e,t){var r="number"==typeof t?"lcid:".concat(ve(t)):"lang:".concat(t);return(0,g.notImplemented)(["".concat(e,": culture = ").concat(r)])},e}();t.NumberFormatImpl=Le,t.createFormat=function(e,t,r){try{return(0,F.success)(new Le(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof we?(0,F.failure)(e.reason):(0,F.failure)((0,F.javaScriptError)(e))}},t.applyFormat=function(e,t,r,n){try{var i=void 0,o=void 0,a=void 0,s=e.config.localeInfo;switch(r.kind){case _.OperKind.String:i=function(e){if(0===e.length)return!1;var t=(0,S.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?v.Alignment.Right:v.Alignment.Left,o=v.Clip.None,a=r;break;case _.OperKind.Number:i=t.isTextOnly?v.Alignment.Left:v.Alignment.Right,o=v.Clip.All,a=r;break;case _.OperKind.Boolean:i=v.Alignment.Center,o=v.Clip.All,a=(0,y.stringOper)(r.value?s.trueName:s.falseName);break;case _.OperKind.Blank:return(0,F.success)((0,v.formattedValue)([],void 0,v.Alignment.Left,v.Clip.All));case _.OperKind.Error:var l=s.errorNames[r.type];return null==l?(0,F.failure)((0,g.internal)("No locale data for error type ".concat(r.type))):(0,F.success)((0,v.formattedValue)([(0,v.formattedUnitString)(l)],void 0,v.Alignment.Center,v.Clip.All));case _.OperKind.Array:return(0,F.failure)((0,g.notImplemented)(["Array applyFormat"]));case _.OperKind.Rich:return(0,F.failure)((0,g.notImplemented)(["Rich applyFormat"]))}return t.apply(a,i,o,n)}catch(e){return(0,F.failure)((0,F.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case v.FormatValueType.General:return(0,F.failure)((0,g.notImplemented)(["changeDecimals General"]));case v.FormatValueType.Number:case v.FormatValueType.Currency:case v.FormatValueType.Accounting:case v.FormatValueType.Percentage:case v.FormatValueType.Scientific:if(0===e.decimals&&t<0)return F.successUndefined;var r=(0,T.fastMax)(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?F.successUndefined:(0,F.success)(n);default:return F.successUndefined}}catch(e){return(0,F.failure)((0,F.javaScriptError)(e))}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.convertKnownLCID=t.getBundledLocaleInfo=void 0;var i,o=r(72),a=r(43),s={ar:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","s."],["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],["a. m.","p. m."],"z"],fr:[["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["sijeanj","veljaa","oujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","et","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","etvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sn","mn","tis","ons","tor","fre","lr"],["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","luned","marted","mercoled","gioved","venerd","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sm."],["duminic","luni","mari","miercuri","joi","vineri","smbt"],["a.m.","p.m."],"z"],ru:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","et","pet","sub"],["nedelja","ponedeljak","utorak","sreda","etvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","'",""],"en","z"],bg:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","nor","bezen","duben","kvten","erven","ervenec","srpen","z","jen","listopad","prosinec"],["ne","po","t","st","t","p","so"],["nedle","pondl","ter","steda","tvrtek","ptek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["s","ma","ti","on","to","fr","l"],["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],"sv","z"],el:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],et:[["jaan","veebr","mrts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","mrts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["phapev","esmaspev","teisipev","kolmapev","neljapev","reede","laupev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kes","hein","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],hu:[["jan.","febr.","mrc.","pr.","mj.","jn.","jl.","aug.","szept.","okt.","nov.","dec."],["janur","februr","mrcius","prilis","mjus","jnius","jlius","augusztus","szeptember","oktber","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasrnap","htf","kedd","szerda","cstrtk","pntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"j"],ko:["ja",["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","bir.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegu","birelis","liepa","rugpjtis","rugsjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","t"],["sekmadienis","pirmadienis","antradienis","treiadienis","ketvirtadienis","penktadienis","etadienis"],["priepiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jn.","jl.","aug.","sept.","okt.","nov.","dec."],["janvris","februris","marts","aprlis","maijs","jnijs","jlijs","augusts","septembris","oktobris","novembris","decembris"],["svtd.","pirmd.","otrd.","tred.","ceturtd.","piektd.","sestd."],["svtdiena","pirmdiena","otrdiena","trediena","ceturtdiena","piektdiena","sestdiena"],["priekp.","pcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["sn","man","tir","ons","tor","fre","lr"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],["niedz.","pon.","wt.","r.","czw.","pt.","sob."],["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sb"],["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"],"en","z"],sk:["ja",["janur","februr","marec","aprl","mj","jn","jl","august","september","oktber","november","december"],["ne","po","ut","st","t","pi","so"],["nedea","pondelok","utorok","streda","tvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","et.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","etrtek","petek","sobota"],["dop.","pop."],"z"],th:[["..","..","..","..","..","..","..","..","..","..","..",".."],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],"en","z"],tr:[["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],["Paz","Pzt","Sal","ar","Per","Cum","Cmt"],["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],["","S"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Thang Ging","Thang Hai","Thang Ba","Thang T","Thang Nm","Thang Sau","Thang Bay","Thang Tam","Thang Chin","Thang Mi","Thang Mi Mt","Thang Mi Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chu Nht","Th Hai","Th Ba","Th T","Th Nm","Th Sau","Th Bay"],["SA","CH"],"z"],ta:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],syr:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],[".","."],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],dv:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],hi:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],["",""],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["","","","","","","","","","","",""],["","","","","","","","","","","",""],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mi.","jue.","vie.","sb."],"es",["a.m.","p.m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mi","jue","vie","sb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fv.","mar.","avr.","mai","jui.","juil.","aot","sept.","oct.","nov.","dc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["","","","","","",""],"zh","zh","s"],"zh-SG":[["","","","","","","","","","","",""],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jn","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jnner","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","S"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[[".",".","",".","","","",".",".",".",".","."],["","","","","","","","","","","",""],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","et.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["","","","","","","","","","","",""],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["","","","","","","","","","","",""],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};t.getBundledLocaleInfo=function(e){var t=e.culture,r=e.tag;if("number"!=typeof t){var n=t;return void 0!==r&&(""!==t&&(n+="-"),n+="x-"+String(r)),void 0===i&&(i=function(){for(var e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],r=0,n=Object.keys(s);r<n.length;r++){var i=n[r],o=s[i];if("string"!=typeof o){var l=o.slice(0,5).map((function(r,n){if("string"==typeof r){var i=e[r];return(0,a.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==i),i[t[n]]}return r})),u=l[0],c=l[1],d=l[2],f=l[3],p=l[4],m=o[5],h="k"===m,g="j"===m,v="t"===m,S="s"===m,y=h||g||v||S;e[i]={monthNameShort:u,monthNameLong:c,dayNameShort:d,dayNameLong:f,ampmSymbols:p,isEastAsia:y,isKorea:h,isJapan:g,isChinaT:v,isChinaS:S}}else{var C=e[o];(0,a.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==C),e[i]=C}}return e}()),i[n]}};var l=((n={})[o.LCID.USA]="en-US",n[o.LCID.Greek]="el-GR",n[o.LCID.Hungarian]="hu-HU",n[o.LCID.Turkish]="tr-TR",n[o.LCID.Thailand]="th-TH",n[o.LCID.Vietnam]="vi-VN",n[o.LCID.Arabic]="ar-SA",n[o.LCID.Hebrew]="he-IL",n[o.LCID.Tamil]="ta-IN",n[o.LCID.Syriac]="syr-SY",n[o.LCID.Iraq]="ar-IQ",n[o.LCID.Algerian]="ar-DZ",n[o.LCID.Basque]="eu-ES",n[o.LCID.PortBrazil]="pt-BR",n[o.LCID.Croatian]="hr-HR",n[o.LCID.Czech]="cs-CZ",n[o.LCID.Danish]="da-DK",n[o.LCID.Dutch]="nl-NL",n[o.LCID.Australian]="en-AU",n[o.LCID.CanadianEnglish]="en-CA",n[o.LCID.British]="en-GB",n[o.LCID.Finnish]="fi-FI",n[o.LCID.French]="fr-FR",n[o.LCID.FrenchCanadian]="fr-CA",n[o.LCID.Italian]="it-IT",n[o.LCID.NorskBokmal]="nb-NO",n[o.LCID.NorskNynorsk]="nn-NO",n[o.LCID.Polish]="pl-PL",n[o.LCID.PortIberian]="pt-PT",n[o.LCID.Romanian]="ro-RO",n[o.LCID.Russian]="ru-RU",n[o.LCID.Ukrainian]="uk-UA",n[o.LCID.Belarusian]="be-BY",n[o.LCID.SerbianCyrillic]="sr-Cyrl-CS",n[o.LCID.SerbianLatin]="sr-Latn-CS",n[o.LCID.Slovak]="sk-SK",n[o.LCID.Slovenian]="sl-SI",n[o.LCID.SpanishModern]="es-ES",n[o.LCID.Swedish]="sv-SE",n[o.LCID.HongKong]="zh-HK",n[o.LCID.ChinaT]="zh-TW",n[o.LCID.Korea]="ko-KR",n[o.LCID.Japan]="ja-JP",n[o.LCID.China]="zh-CN",n[o.LCID.Devihi]="dv-MV",n[o.LCID.Hindi]="hi-IN",n[o.LCID.German]="de-DE",n[o.LCID.Swiss]="fr-CH",n);t.convertKnownLCID=function(e){var t;return"string"==typeof e?e:null!==(t=l[e])&&void 0!==t?t:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=void 0;var n=r(41),i=r(34),o=r(71),a=r(43),s=r(173),l=r(42),u=r(112),c=r(32);function d(e,t,r,u,d){if(d.isDate||d.isTime){var f=function(e,t,r,u,d){var f=t.config,p=f.mathpack,m=f.localeInfo;if(p.cond(u)<0)return(0,c.success)(void 0);var h="",g=0!==p.fix(u)||d.isDate,v=u;if(g){var S=p.trunc(u),y=(0,s.getFormatString)(e,t,r,(0,o.buildMMDDYYFormat)(m,!0),n.NumberFormatSource.CustomString);if(!(0,c.isSuccess)(y))return y;var C=(0,s.renderFormat)(e,y.value,S);if(!(0,c.isSuccess)(C))return C;if("string"!=typeof C.value)return(0,c.success)(void 0);h+=C.value;var R=p.sub(u,S);(0,a.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,i.isErrorOper)(R)),v=R}if(p.cond(v)>0||d.isTime){g&&(h+="  ");var b=t.getKnownFormat(r,m.clock24Hour?l.KnownFormat.HHMMSS:l.KnownFormat.HHMMSSAP);if(!(0,c.isSuccess)(b))return b;C=(0,s.renderFormat)(e,b.value,v);if(!(0,c.isSuccess)(C))return C;if("string"!=typeof C.value)return(0,c.success)(void 0);h+=C.value}return(0,c.success)(h)}(e,(0,s.initUtilGlobals)(t),r,u,d);if(!(0,c.isSuccess)(f))return f;if(void 0!==f.value){f.value;return f}}var p=t.config,m=p.mathpack,h=p.localeInfo;if(d.isPercent){var g=m.mul(u,m.fromNumber(100));return(0,i.isErrorOper)(g)?(0,c.failure)((0,i.notImplemented)(["renderFormulaBar % overflow"])):(0,c.success)(m.formatGeneral(h,g,21)+"%")}return(0,c.success)(m.formatGeneral(h,u,21))}t.renderFormulaBar=function(e,t,r,n,o,s){try{var l=t.config.localeInfo;switch(n.kind){case u.OperKind.Number:return d(e,t,r,n,o);case u.OperKind.String:return(0,c.success)(s?"'"+n.value:n.value);case u.OperKind.Boolean:return(0,c.success)(n.value?l.trueName:l.falseName);case u.OperKind.Error:var f=l.errorNames[n.type];return null==f?(0,c.failure)((0,i.internal)("No locale data for error type ".concat(n.type))):(0,c.success)(f);case u.OperKind.Array:return(0,c.failure)((0,i.notImplemented)(["Array renderFormulaBar"]));case u.OperKind.Rich:return(0,c.failure)((0,i.notImplemented)(["Rich renderFormulaBar"]));case u.OperKind.Blank:return(0,c.success)("");default:return(0,a.assertNever)("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return(0,c.failure)((0,c.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.renderFormat=t.getFormatString=t.initUtilGlobals=void 0;var n=r(34),i=r(41),o=r(42),a=r(32),s=r(43),l=r(107),u=r(71),c={getKnownFormat:function(){return(0,s.assertFalse)("calc.numfmt: default getKnownFormat")},getIformat:function(){return(0,s.assertFalse)("calc.numfmt: default getIformat")},getFormatString:function(){return(0,s.assertFalse)("calc.numfmt: default getFormatString")}};t.initUtilGlobals=function(e){var t,r,n,i,o,a;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:c.getKnownFormat,getIformat:null!==(i=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:c.getIformat,getFormatString:null!==(a=null===(o=e.getFormatString)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:c.getFormatString}},t.getFormatString=function(e,t,r,n,o){var s=t.getFormatString(r,n);if(!(0,a.isSuccess)(s))return s;if(void 0!==s.value)return t.getIformat(r,s.value);var l=e.createFormat(n,o);return(0,a.isSuccess)(l)?l:l.reason.kind===i.FormatReasonKind.NotFormatString?(0,a.failure)((0,i.previousFormatFailure)()):(0,a.failure)(l.reason)},t.renderFormat=function(e,t,r){var o=(0,n.isStringOper)(r)?i.Clip.None:i.Clip.All,s=t.apply(r,i.Alignment.Right,o,!0);if(!(0,a.isSuccess)(s))return s;var l=e.renderValue(s.value,i.renderInfiniteWidth);return(0,a.isSuccess)(l)?(0,i.isHashesValue)(l.value)?(0,a.success)(l.value.units):(0,a.success)((0,i.renderedValueToString)(l.value)):l},t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,n){var s=r;if(n.kind===i.EditKind.Number&&n.format!==o.KnownFormat.General){var c=n.format,d="string"==typeof c?c:(0,u.getKnownFormat)(t,c),f="string"!=typeof c,p=e.createFormat(d,f);if(!(0,a.isSuccess)(p))return p;var m=p.value;(0,l.shouldInstallFormat)(m,r)&&(s=m)}return e.applyFormat(s,n.value,!0)},t.toXLNumber=function(e,t,r){var n=t.parseGeneral(r,!1,!0,i.GetTimeKind.NonVolatile);return(0,a.isSuccess)(n)?null==n.value?(0,a.failure)(null):(0,a.success)(e.toNumber(n.value.value)):n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseGeneral=void 0;var n=r(108),i=r(111),o=r(32);t.parseGeneral=function(e,t,r,a,s){try{var l=e.config,u=l.localeInfo,c=l.mathpack,d=(0,n.parseConstInternal)(u,c,t,r,a,!1);return(0,o.isSuccess)(d)?void 0!==d.value?d:(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,s):d}catch(e){return(0,o.failure)((0,o.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,o.failure)((0,o.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;var n=r(300),i=r(21),o=r(9);function a(e,t){var r=e.row,n=e.col,o=e.rows,a=e.cols,s=t.row,l=t.col,u=t.rows,c=t.cols;return(0,i.fastAbs)(r-s+.5*(o-u))+(0,i.fastAbs)(n-l+.5*(a-c))}t.gridRangeDistance=a,t.makeGridRangeTable=function(){return n.RTree.create(o.gridRangeJoin,o.gridRangeIsects,o.gridRangeCompare,a)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.AllMachine=void 0;var n=r(2);t.AllMachine=n.machine.AllMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(1);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.UdfOper=void 0;var n=r(49),i=r(10),o=r(35),a=r(27),s=r(27),l=r(12),u=r(12),c=r(12),d=r(76),f=r(179),p=r(36),m=r(36),h=r(36),g=r(36),v=r(36),S=r(36),y=r(17),C=r(17),R=r(21),b=r(74),N=r(14),T=r(14),P=r(9),E=r(9),k=r(62),O=r(114),A=r(118),I=r(11),_=r(11),F=r(180),M=r(301),D=r(53),w=r(28),L=r(20),x=r(73),B=r(302),U=r(13),G=r(117),K=r(115),V=r(16),j=r(86),W=r(181),H=r(75),Q=function(){function e(e,t){this.kind=U.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}return e.prototype.getFallback=function(){return(0,i.assertFalse)("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return(0,i.assertFalse)("calc.runtime.UdfOper.getField")},e}();function q(e,t,r,n){(0,i.assertTrue)("calc.runtime.compileCallLambda",t.length>=e.minArity&&t.length<=e.maxArity);for(var o=t.slice();o.length<e.maxArity;)o.push(I.missingOper);for(var s=o.slice(),l=0;l<e.defIdxs.length;l+=1){var u=e.defIdxs[l],c=e.defsAndBody[l],d=s[u];(0,h.isOperTerm)(d)&&(0,P.isMissingOper)(d)&&(s[u]=c)}var f=e.defsAndBody[e.defsAndBody.length-1],p=(0,m.letTerm)(n?s.map((function(t,r){return(0,m.noopTerm)(t,(0,a.runtimePositionLambdaParam)(e.paramNodeLabels[r],e.paramNameLabels[r]))})):s,!1,e.paramNodeLabels,f,(0,a.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,o));return(0,m.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,r,p)}t.UdfOper=Q;var z=function(){function e(e,t,r,n,i,o,a,s){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=i,this.visitedCells=o,this.visitedNames=a,this.usage=s,this.internalSource=void 0;var l=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return i.special|=U.SpecialPrecs.RefStyle,l},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalCaller",{get:function(){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",void 0!==this.internalSource),(0,l.stackFrameList)(this.internalSource,e.internalPosition,u.emptyStackEnv,void 0,this.caller)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return(0,V.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return(0,V.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return(0,V.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return(0,V.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return(0,V.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),e.prototype.makeChildDispatcher=function(t){return new e(this.context,this.stepConfig,this.locals,t,this.precedents,this.visitedCells,this.visitedNames,this.usage)},e.prototype.useAsFuncContext=function(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this},e.prototype.applyFunction=function(e,t){var r=this.makeChildDispatcher(this.internalCaller),n=(0,w.getWorksheetFuncType)(e),i=t.some(E.isRangeOper)?t.slice(0):t;return(0,G.dereferenceOpers)(r,i,n),r.termToFuncResult(r.dispatchFunction((0,S.worksheetFunctionIdToName)(e),n,!1,i))},e.prototype.applyLambda=function(e,t){return this.termToFuncResult(q(e,t,this.internalCaller,null!=this.stepConfig))},e.prototype.handleEvaluationError=function(e){if(e instanceof c.EvaluationError)return(0,c.handleEvaluationError)(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if((0,S.isOperatorName)(e))return(0,f.applyOperator)(this.globals,(0,S.operatorNameToId)(e),t,r);var n=(0,S.worksheetFunctionNameToId)(e);if(n===w.WorksheetFuncId._UDF){if(t[0]instanceof D.LambdaOper){var o=t[0],a=t.slice(1);return a.length>=o.minArity&&a.length<=o.maxArity?((0,i.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",void 0===this.internalSource),q(o,a,this.caller,null!=this.stepConfig)):_.valueErrorOper}if(t[0]instanceof Q){var s=t[0];if(t.length-1!==s.arity)return _.valueErrorOper;if((p=s.func(this.useAsFuncContext((0,N.lexicalSourceUDF)(s.loc)),t.slice(1))).kind===U.OperKind.Error){var l="UDF function return value";(0,C.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",p.type,l)}return this.funcContextResultToTerm(p)}switch(t[0].kind){case U.OperKind.Error:return t[0];case U.OperKind.Number:return _.valueErrorOper;case U.OperKind.Rich:return(0,c.throwEvaluationError)((0,E.notImplemented)(["Rich UDF head"]));case U.OperKind.String:case U.OperKind.Boolean:case U.OperKind.Blank:case U.OperKind.Missing:return _.refErrorOper;case U.OperKind.Array:return(0,H.isFeatureEnabled)(H.FeatureName.CalcLambdaArrayLifting)?(0,i.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,c.throwEvaluationError)((0,E.notImplemented)(["Array UDF head"]));case U.OperKind.Range:return(0,H.isFeatureEnabled)(H.FeatureName.CalcLambdaCellValues)?(0,i.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,c.throwEvaluationError)((0,E.notImplemented)(["Range UDF head"]));default:return(0,i.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var u=this.globals.getWorksheetFunc(n);if(u.kind===V.ResultKind.Failure)return(0,c.throwEvaluationError)(u.reason);var d=u.value;if(null==d){l="nonexistent worksheet function ".concat(n);return(0,C.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",_.ErrorType.NAME,l),_.nameErrorOper}try{var p;if((p=d(this.useAsFuncContext((0,N.lexicalSourceWSF)(n)),t)).kind===U.OperKind.Error){l="worksheet function ".concat(n," return value");(0,C.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",p.type,l)}return this.funcContextResultToTerm(p)}catch(e){throw(0,j.prependErrorMessage)(e,"(in WSF ".concat((0,b.englishWorksheetFuncIdToName)(n),")"))}},e.prototype.termToFuncResult=function(e){switch(e.kind){case v.TermKind.CallLambda:case v.TermKind.CallFirstOrderFunc:return(0,L.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e));case v.TermKind.CallMachine:return(0,L.machineCall)(e.data.machine)}return e},e.prototype.funcContextResultToTerm=function(t){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,L.isMachineCall)(t)?(0,p.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,g.callMachineTerm)(t.machine,e.internalPosition)):t},e.prototype.dispatchFunction=function(e,t,r,o){var a=this;if(!(0,E.isValidArgsLength)(t,o.length)){var s=JSON.stringify(t),l="bad application of ".concat(JSON.stringify(e)," to ").concat(o.length," arguments, ftype = ").concat(s),u="calc.runtime.FunctionDispatcher.dispatchFunction: ".concat(l);return(0,i.assertFalse)(u)}for(var c=o.length,d=U.SignatureType.None,f=0;f<c;f+=1){var p=o[f],m=p.kind;0==(m&(0,E.getArgType)(t,f,c))&&(d|=m),(0,E.isRangeOper)(p)&&0==(t.flags&U.FunctionFlags.Allow3dRef)&&!(0,E.isSheetIndex)(p.sheets)&&(d|=m)}if(d===U.SignatureType.None)return this.applyOperatorOrFunction(e,o,r);if(0!=(d&U.OperKind.Array)){var h=(0,y.arrayLift)(this.useAsFuncContext(void 0),t,(function(r){var n=a.makeChildDispatcher(a.caller);return n.termToFuncResult(n.dispatchFunction(e,t,!1,r))}),o).machine;return(0,g.callMachineTerm)(h,void 0)}d&=~U.OperKind.Array;var v=[];for(f=0;f<c;f+=1){var S=o[f];if(0!=(d&S.kind)){var R=(0,E.getArgType)(t,f,c);if(S=this.coerceOper(S,R),(0,E.isErrorOper)(S)&&0==(R&U.OperKind.Error))return S;if((0,E.isRangeOper)(S)&&0==(t.flags&U.FunctionFlags.Allow3dRef)&&!(0,E.isSheetIndex)(S.sheets)){l="3D reference, oper = ".concat((0,n.anonymize)(S));return(0,C.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",_.ErrorType.VALUE,l),_.valueErrorOper}}v[f]=S}return this.applyOperatorOrFunction(e,v,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return(0,V.isSuccess)(t)?(0,R.isNone)(t.value)?void 0:t.value:(0,c.throwEvaluationError)(t.reason)},e.prototype.getNameFormula=function(e,t,r){var n=this.context.resolver.resolveName(this.locals,(0,k.nameNode)((0,k.identNamePart)(t,!0),e),r),i=n.resolution,o=n.precedents;if((0,R.safePush)(this.precedents.names,o),!(0,V.isSuccess)(i))switch(i.reason.kind){case O.ResolveReasonKind.NoOriginSheet:case O.ResolveReasonKind.InvalidQualifier:return;default:return(0,c.throwEvaluationError)(i.reason)}var a=i.value;if(a){var s=this.globals.getNameFormula(a,r);(0,V.isSuccess)(s)||(0,c.throwEvaluationError)(s.reason);var l=s.value;if(!(0,R.isNone)(l))return[a,l.node]}},e.prototype.getCellRef=function(e,t,r,n){var i={originGridCell:(0,V.success)(r.range),originSheet:(0,V.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},o=this.context.resolver.resolveCellRef(i,(0,k.cellRefNode)(t,e)).resolution;if(!(0,V.isSuccess)(o))switch(o.reason.kind){case O.ResolveReasonKind.NoOriginSheet:case O.ResolveReasonKind.InvalidQualifier:return;default:return(0,c.throwEvaluationError)(o.reason)}var a=o.value;if(a)return(0,_.range3DOper)(a.sheet,a.range)},e.prototype.getStructRef=function(e,t,r){var n={originGridCell:(0,V.success)(r.range),originSheet:(0,V.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},i=this.context.resolver.resolveStructRef(n,(0,k.structRefNode)(e,t)),o=i.resolution,a=i.precedents;if((0,R.safePush)(this.precedents.names,a),!(0,V.isSuccess)(o))switch(o.reason.kind){case O.ResolveReasonKind.NoOriginSheet:case O.ResolveReasonKind.InvalidQualifier:case O.ResolveReasonKind.InvalidStructRef:case O.ResolveReasonKind.EmptyIntersection:return;default:return(0,c.throwEvaluationError)(o.reason)}var s=o.value;if(s)return(0,_.range3DOper)(s.sheet,s.range)},e.prototype.dereferenceOper=function(e,t){return(0,G.dereferenceOper)(this,e,t)},e.prototype.dereferenceOpers=function(e,t){(0,G.dereferenceOpers)(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return(0,V.isSuccess)(t)?this.getAvailableFormula(e):(0,c.throwEvaluationError)(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return(0,V.isSuccess)(r)?(this.precedents.special|=U.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,T.sheetIndex)(e,r.value)):(0,c.throwEvaluationError)(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=U.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return(0,V.isSuccess)(t)?t.value.position:(0,c.throwEvaluationError)(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=U.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return(0,V.isSuccess)(t)?t.value.sheets:(0,c.throwEvaluationError)(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var o=[],a=[],s=function(s){var u=e[s];if(!(0,E.isRangeOper)(u))return a.push(u),"continue";for(var f=[],p=function(e){var r=(0,G.getCellValuesAsArray)(n,e,o,!0);void 0!==r&&f.push(t(r,e))},m=l.getSheetRangeIndexes(u.sheets),h=function(e){for(var t=(0,T.sheetIndex)(u.sheets.document,m[e]),n=function(e){var n=u.ranges[e];if(!r)return p((0,T.sheetGridRange)(t,n)),"continue";var o=l.globals.tryGetHiddenRows(t,n.row,n.row+n.rows);if(!(0,V.isSuccess)(o))return{value:(0,c.throwEvaluationError)(o.reason)};var a=o.value;if(0===a.length)return p((0,T.sheetGridRange)(t,n)),"continue";for(var s=function(e,r){var i=(0,T.gridRange)(e,n.col,r-e,n.cols);p((0,T.sheetGridRange)(t,i))},d=0;d<a.length;d+=1){var f=a[d],m=f.start,h=f.end,g=0===d?n.row:a[d-1].end;(0,i.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",g<=m&&m<h&&h<=n.row+n.rows),g!==m&&s(g,m);var v=(0,T.gridRange)(m,n.col,h-m,n.cols);l.precedents.cells.push((0,T.sheetGridRange)(t,v))}var S=a[a.length-1].end;S!==n.row+n.rows&&s(S,n.row+n.rows)},o=0;o<u.ranges.length;o+=1){var a=n(o);if("object"==typeof a)return a}},g=0;g<m.length;g+=1){var v=h(g);if("object"==typeof v)return v}a.push({kind:d.DerefOperKind.RangeValues,arrays:f})},l=this,u=0;u<e.length;u+=1){var f=s(u);if("object"==typeof f)return f.value}return o.length>0?(0,c.throwEvaluationError)((0,c.unevaluated)(o)):a},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,R.identity,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new o.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,i){var o=e.get(n,i),a=(0,T.sheetGridCell)(t.sheet,(0,T.gridCell)(t.range.row+n,t.range.col+i));return[o,r.getAvailableFormula(a)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var i=this.context.parser.parseFormula((0,A.parseLocals)(r.lexicalKind,t,{refStyle:e}),n);if(!(0,V.isSuccess)(i))return i;var o=this.context.analyzer.checkFormula(r,i.value);if(!(0,V.isSuccess)(o))return o;if(!(0,E.isWellFormed)(o.value))return(0,V.failure)((0,s.illFormedFormula)("ill-formed indirect formula","indirect"));o.value;return o},e.prototype.getRandom=function(){this.precedents.special|=U.SpecialPrecs.Calc;var e=this.globals.getRandom();return(0,V.isSuccess)(e)||(0,c.throwEvaluationError)(e.reason),e.value},e.prototype.getTime=function(e){this.precedents.special|=U.SpecialPrecs.Time;var t=this.globals.getTime(e,x.GetTimeKind.Volatile);return(0,V.isSuccess)(t)||(0,c.throwEvaluationError)(t.reason),t.value},e.prototype.coerceOper=function(e,t){return(0,K.coerceOper)(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,x.GetTimeKind.NonVolatile);return(0,V.isSuccess)(n)||(0,c.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,x.GetTimeKind.NonVolatile);return(0,V.isSuccess)(r)||(0,c.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=(0,w.getOperatorType)(e),n=[_.falseOper,_.falseOper];return function(o,a){n[0]=o,n[1]=a,(0,G.dereferenceOpers)(t,n,r);var s=t.dispatchFunction((0,S.operatorIdToName)(e),r,!1,n);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,h.isOperTerm)(s)),s}},e.prototype.getUnaryOperator=function(e){var t=this,r=(0,w.getOperatorType)(e),n=[_.falseOper];return function(o){n[0]=o,(0,G.dereferenceOpers)(t,n,r);var a=t.dispatchFunction((0,S.operatorIdToName)(e),r,!1,n);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,h.isOperTerm)(a)),a}},e.prototype.isInFilterMode=function(e){this.precedents.special|=U.SpecialPrecs.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if((0,E.isRangeOper)(n))for(var i=0,o=this.getSheetRangeIndexes(n.sheets);i<o.length;i++){var a=o[i],s=this.globals.isInFilterMode((0,T.sheetIndex)(n.sheets.document,a));if(!(0,V.isSuccess)(s))return(0,c.throwEvaluationError)(s.reason);if(s.value)return!0}}return!1},e.prototype.printFormula=function(e,t){var r=(0,T.sheetGridCell)(e.source.range.sheet,t),n=(0,M.adjustFormulaOrigin)(this.globals,(0,F.analyzeLocalsGrid)(T.LexicalKind.Cell,(0,E.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,V.isSuccess)(n))return(0,c.throwEvaluationError)(n.reason);var i=this.context.printer.printFormula((0,W.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),n.value);return(0,V.isSuccess)(i)?i.value:(0,c.throwEvaluationError)(i.reason)},e.prototype.applyFormat=function(e,t,r,n){var i;if("number"==typeof t){var o=this.globals.getKnownFormat(e,t);if(!(0,V.isSuccess)(o))return(0,c.throwEvaluationError)(o.reason);i=o.value}else{var a=(0,B.getFormatString)(this.context.numberFormatter,this.globals,e,t,n);if(!(0,V.isSuccess)(a))switch(a.reason.kind){case x.FormatReasonKind.PreviousFormatFailure:return;default:return(0,c.throwEvaluationError)(a.reason)}i=a.value}var s=(0,B.renderFormat)(this.context.numberFormatter,i,r);return(0,V.isSuccess)(s)?"string"==typeof s.value?s.value:void 0:(0,c.throwEvaluationError)(s.reason)},e.internalPosition=a.runtimePositionFirstOrderFunc,e}();t.FunctionDispatcher=z},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyOperator=t.cmpNum=t.cmpStr=t.cmpBool=t.cmpInt=void 0;var n=r(49),i=r(17),o=r(74),a=r(11),s=r(10),l=r(28),u=r(13),c=r(14),d=r(9),f=r(17);function p(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function m(e,r,n,i){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,i.value))}function h(e,r,n,i){return(0,t.cmpInt)(r,e.compare(n,i))}function g(e,t,r){if((0,d.isSheetIndex)(t.sheets))if((0,d.isSheetIndex)(r.sheets))if((0,d.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,c.sheetIndex)(t.sheets.document,t.sheets.index);o="different sheet, range1 = ".concat((0,n.anonymize)(t),", range2 = ").concat((0,n.anonymize)(r));(0,i.traceErrorOper)(e,a.ErrorType.VALUE,o)}else{var o="different document, range1 = ".concat((0,n.anonymize)(t),", range2 = ").concat((0,n.anonymize)(r));(0,i.traceErrorOper)(e,a.ErrorType.VALUE,o)}else(0,i.traceErrorOper)(e,a.ErrorType.VALUE,"3D reference, range2 = ".concat((0,n.anonymize)(r)));else(0,i.traceErrorOper)(e,a.ErrorType.VALUE,"3D reference, range1 = ".concat((0,n.anonymize)(t)))}t.cmpInt=d.applyComparison,t.cmpBool=p,t.cmpStr=m,t.cmpNum=h,t.applyOperator=function(e,r,c,v){void 0===v&&(v=!1);var S,y,C,R=e.config.mathpack;if(1===c.length){var b=c[0];switch(r){case l.OperatorId.Percent:return R.percent(b);case l.OperatorId.Neg:return R.neg(b);case l.OperatorId.Pos:return b;default:var N="bad application of ".concat(r," to 1 argument"),T="calc.runtime.applyOperator: ".concat(N);return s.ulsLogger.ULS.assertTag(593372496,o.LogCategory.msoulscat_ES_EWAJS,!1,T)}}if(2===c.length){b=c[0];var P=c[1];switch(r){case l.OperatorId.Add:var E=R.add(b,P);return v&&(0,d.isNumberOper)(E)?R.checkAlmostCancellation(b,E):E;case l.OperatorId.Sub:E=R.sub(b,P);return v&&(0,d.isNumberOper)(E)?R.checkAlmostCancellation(b,E):E;case l.OperatorId.Mul:return R.mul(b,P);case l.OperatorId.Div:return R.div(b,P);case l.OperatorId.Pow:return R.power(b,P);case l.OperatorId.Concat:return(0,a.stringOper)((b.value+P.value).substring(0,a.cellStringLimit));case l.OperatorId.Eq:case l.OperatorId.Ne:case l.OperatorId.Lt:case l.OperatorId.Le:case l.OperatorId.Gt:case l.OperatorId.Ge:return(0,a.booleanOper)(function(e,r,n,i){var o=e.config,s=o.localeInfo,l=o.mathpack;if(n.kind!==i.kind){if((0,d.isBlankOper)(n))switch(i.kind){case u.OperKind.Number:return h(l,r,l.zero,i);case u.OperKind.String:return m(s,r,f.emptyStringOper,i);case u.OperKind.Boolean:return p(r,a.falseOper,i)}if((0,d.isBlankOper)(i))switch(n.kind){case u.OperKind.Number:return h(l,r,n,l.zero);case u.OperKind.String:return m(s,r,n,f.emptyStringOper);case u.OperKind.Boolean:return p(r,n,a.falseOper)}return(0,t.cmpInt)(r,n.kind-i.kind)}switch(n.kind){case u.OperKind.Number:return h(l,r,n,i);case u.OperKind.String:return m(s,r,n,i);case u.OperKind.Boolean:return p(r,n,i);case u.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,b,P));case l.OperatorId.Range:return function(e,t){var r=g("calc.runtime.applyRangeOp",e,t);if(null==r)return a.valueErrorOper;var n=(0,d.gridRangesJoin)(e.ranges),i=(0,d.gridRangesJoin)(t.ranges),o=[(0,d.gridRangeJoin)(n,i)];return(0,a.rangeSeqOper)(r,o)}(b,P);case l.OperatorId.Isect:return function(e,t){var r=g("calc.runtime.applyIsectOp",e,t);if(null==r)return a.valueErrorOper;for(var o=[],s=0;s<e.ranges.length;s+=1)for(var l=0;l<t.ranges.length;l+=1){var u=(0,d.gridRangeIsect)(e.ranges[s],t.ranges[l]);null!=u&&o.push(u)}if(0===o.length){var c="empty intersection, range1 = ".concat((0,n.anonymize)(e),", range2 = ").concat((0,n.anonymize)(t));return(0,i.traceErrorOper)("calc.runtime.applyIsectOp",a.ErrorType.NULL,c),a.nullErrorOper}return(0,a.rangeSeqOper)(r,o)}(b,P);case l.OperatorId.Union:return null==(C=g("calc.runtime.applyUnionOp",S=b,y=P))?a.valueErrorOper:(0,a.rangeSeqOper)(C,S.ranges.concat(y.ranges));case l.OperatorId.And:return(0,a.booleanOper)(b.value&&P.value);case l.OperatorId.Or:return(0,a.booleanOper)(b.value||P.value);case l.OperatorId.Xor:return(0,a.booleanOper)(b.value!==P.value);case l.OperatorId.Min:return R.cond2(b,P)<=0?b:P;case l.OperatorId.Max:return R.cond2(b,P)>=0?b:P;default:var k="bad application of ".concat(r," to 2 arguments"),O="calc.runtime.applyOperator: ".concat(k);return s.ulsLogger.ULS.assertTag(593372497,o.LogCategory.msoulscat_ES_EWAJS,!1,O)}}var A="bad application of ".concat(r," to ").concat(c.length," arguments"),I="calc.runtime.applyOperator: ".concat(A);return s.ulsLogger.ULS.assertTag(593372498,o.LogCategory.msoulscat_ES_EWAJS,!1,I)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.summarizeFormulaDiagnostics=t.diagnostics=t.createAnalyzeGlobals=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;var n=r(3);t.analyzeLocalsGrid=n.analyzeServiceTypes.analyzeLocalsGrid,t.analyzeLocalsName=n.analyzeServiceTypes.analyzeLocalsName,t.createAnalyzeGlobals=n.analyzeServiceTypes.createAnalyzeGlobals,t.diagnostics=n.analyzeServiceTypes.diagnostics,t.summarizeFormulaDiagnostics=n.analyzeServiceTypes.summarizeFormulaDiagnostics},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(1);t.createSimplePrintGlobals=n.printServiceTypes.createSimplePrintGlobals,t.printLocalsGrid=n.printServiceTypes.printLocalsGrid,t.printLocalsName=n.printServiceTypes.printLocalsName},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(3);t.createAnalyzer=n.analyzeService.createAnalyzer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(1);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;var n=r(185),i=r(189),o=r(191),a=r(192),s=r(193),l=r(194),u=r(195),c=r(126),d=r(196),f=r(197),p=r(198),m=r(199),h=r(200),g=r(201),v=r(202),S=r(203),y=r(75),C=r(28),R={};R[C.WorksheetFuncId.SUM]=n.sum,R[C.WorksheetFuncId.PRODUCT]=n.product,R[C.WorksheetFuncId.AVERAGE]=n.average,R[C.WorksheetFuncId.COUNTBLANK]=n.countblank,R[C.WorksheetFuncId.MAX]=n.max,R[C.WorksheetFuncId.MIN]=n.min,R[C.WorksheetFuncId.AND]=n.and,R[C.WorksheetFuncId.COUNTA]=n.counta,R[C.WorksheetFuncId.OR]=n.or,R[C.WorksheetFuncId.CONCAT]=n.concat,R[C.WorksheetFuncId.AVERAGEIF]=n.averageif,R[C.WorksheetFuncId.AVERAGEIFS]=n.averageifs,R[C.WorksheetFuncId.COUNT]=n.count,R[C.WorksheetFuncId.COUNTIF]=n.countif,R[C.WorksheetFuncId.COUNTIFS]=n.countifs,R[C.WorksheetFuncId.MEDIAN]=n.median,R[C.WorksheetFuncId.SUMSQ]=n.sumsq,R[C.WorksheetFuncId.SUMIF]=n.sumif,R[C.WorksheetFuncId.SUMIFS]=n.sumifs,R[C.WorksheetFuncId.LARGE]=n.large,R[C.WorksheetFuncId.SMALL]=n.small,R[C.WorksheetFuncId.RANK]=n.rank,R[C.WorksheetFuncId.RANK_EQ]=n.rank,R[C.WorksheetFuncId.RANK_AVG]=n.rank_avg,R[C.WorksheetFuncId.PERCENTILE]=n.percentile,R[C.WorksheetFuncId.PERCENTILE_INC]=n.percentile,R[C.WorksheetFuncId.PERCENTILE_EXC]=n.percentile_exc,R[C.WorksheetFuncId.QUARTILE]=n.quartile,R[C.WorksheetFuncId.QUARTILE_INC]=n.quartile,R[C.WorksheetFuncId.QUARTILE_EXC]=n.quartile_exc,R[C.WorksheetFuncId.TRIMMEAN]=n.trimmean,R[C.WorksheetFuncId.AVERAGEA]=n.averagea,R[C.WorksheetFuncId.MAXA]=n.maxa,R[C.WorksheetFuncId.MINA]=n.mina,R[C.WorksheetFuncId.MAXIFS]=n.maxifs,R[C.WorksheetFuncId.MINIFS]=n.minifs,R[C.WorksheetFuncId.XOR]=n.xor,R[C.WorksheetFuncId.AGGREGATE]=n.aggregate,R[C.WorksheetFuncId.SUBTOTAL]=n.subtotal,R[C.WorksheetFuncId.VAR]=n.var_,R[C.WorksheetFuncId.VAR_S]=n.var_,R[C.WorksheetFuncId.VARP]=n.varp,R[C.WorksheetFuncId.VAR_P]=n.varp,R[C.WorksheetFuncId.STDEV]=n.stdev,R[C.WorksheetFuncId.STDEV_S]=n.stdev,R[C.WorksheetFuncId.STDEVP]=n.stdevp,R[C.WorksheetFuncId.STDEV_P]=n.stdevp,R[C.WorksheetFuncId.VARA]=n.vara,R[C.WorksheetFuncId.VARPA]=n.varpa,R[C.WorksheetFuncId.STDEVA]=n.stdeva,R[C.WorksheetFuncId.STDEVPA]=n.stdevpa,R[C.WorksheetFuncId.AVEDEV]=n.avedev,R[C.WorksheetFuncId.DEVSQ]=n.devsq,R[C.WorksheetFuncId.MODE]=n.mode,R[C.WorksheetFuncId.MODE_SNGL]=n.mode,R[C.WorksheetFuncId.MODE_MULT]=n.mode_mult,R[C.WorksheetFuncId.TEXTJOIN]=n.textjoin,R[C.WorksheetFuncId.YEAR]=i.year,R[C.WorksheetFuncId.MONTH]=i.month,R[C.WorksheetFuncId.DAY]=i.day,R[C.WorksheetFuncId.HOUR]=i.hour,R[C.WorksheetFuncId.MINUTE]=i.minute,R[C.WorksheetFuncId.SECOND]=i.second,R[C.WorksheetFuncId.WEEKNUM]=i.weeknum,R[C.WorksheetFuncId.ISOWEEKNUM]=i.isoweeknum,R[C.WorksheetFuncId.WEEKDAY]=i.weekday,R[C.WorksheetFuncId.DATE]=i.date,R[C.WorksheetFuncId.TIME]=i.time,R[C.WorksheetFuncId.DAYS360]=i.days360,R[C.WorksheetFuncId.DAYS]=i.days,R[C.WorksheetFuncId.DATEDIF]=i.datedif,R[C.WorksheetFuncId.WORKDAY]=i.workday,R[C.WorksheetFuncId.WORKDAY_INTL]=i.workday_intl,R[C.WorksheetFuncId.EDATE]=i.edate,R[C.WorksheetFuncId.EOMONTH]=i.eomonth,R[C.WorksheetFuncId.NETWORKDAYS]=i.networkdays,R[C.WorksheetFuncId.NETWORKDAYS_INTL]=i.networkdays_intl,R[C.WorksheetFuncId.YEARFRAC]=i.yearFrac,R[C.WorksheetFuncId.DELTA]=o.delta,R[C.WorksheetFuncId.GESTEP]=o.gestep,R[C.WorksheetFuncId.NA]=a.na,R[C.WorksheetFuncId.T]=a.t_,R[C.WorksheetFuncId.N]=a.n_,R[C.WorksheetFuncId.TYPE]=a.type,R[C.WorksheetFuncId.ERROR_TYPE]=a.error_type,R[C.WorksheetFuncId.INFO]=a.info,R[C.WorksheetFuncId.IF]=l.if_,R[C.WorksheetFuncId.IFS]=l.ifs,R[C.WorksheetFuncId.SWITCH]=l.switch_,R[C.WorksheetFuncId.TRUE]=l.true_,R[C.WorksheetFuncId.FALSE]=l.false_,R[C.WorksheetFuncId.NOT]=l.not,R[C.WorksheetFuncId.CHOOSE]=l.choose,R[C.WorksheetFuncId.INDEX]=u.index,R[C.WorksheetFuncId.MATCH]=u.match,R[C.WorksheetFuncId.LOOKUP]=u.lookup,R[C.WorksheetFuncId.HLOOKUP]=u.hlookup,R[C.WorksheetFuncId.VLOOKUP]=u.vlookup,R[C.WorksheetFuncId.ABS]=c.abs,R[C.WorksheetFuncId.CEILING]=c.ceiling,R[C.WorksheetFuncId.ECMA_CEILING]=c.ceiling,R[C.WorksheetFuncId.DEGREES]=c.degrees,R[C.WorksheetFuncId.FLOOR]=c.floor,R[C.WorksheetFuncId.RADIANS]=c.radians,R[C.WorksheetFuncId.ROUND]=c.round,R[C.WorksheetFuncId.ROUNDUP]=c.roundup,R[C.WorksheetFuncId.ROUNDDOWN]=c.rounddown,R[C.WorksheetFuncId.EVEN]=c.even,R[C.WorksheetFuncId.SIGN]=c.sign,R[C.WorksheetFuncId.PI]=c.pi,R[C.WorksheetFuncId.SQRT]=c.sqrt,R[C.WorksheetFuncId.EXP]=c.exp,R[C.WorksheetFuncId.POWER]=c.power,R[C.WorksheetFuncId.LN]=c.ln,R[C.WorksheetFuncId.LOG10]=c.log10,R[C.WorksheetFuncId.LOG]=c.log,R[C.WorksheetFuncId.SIN]=c.sin,R[C.WorksheetFuncId.COS]=c.cos,R[C.WorksheetFuncId.TAN]=c.tan,R[C.WorksheetFuncId.ASIN]=c.asin,R[C.WorksheetFuncId.ACOS]=c.acos,R[C.WorksheetFuncId.ATAN]=c.atan,R[C.WorksheetFuncId.ATAN2]=c.atan2,R[C.WorksheetFuncId.FACT]=c.fact,R[C.WorksheetFuncId.SQRTPI]=c.sqrtpi,R[C.WorksheetFuncId.FACTDOUBLE]=c.factdouble,R[C.WorksheetFuncId.INT]=c.int,R[C.WorksheetFuncId.TRUNC]=c.trunc,R[C.WorksheetFuncId.ODD]=c.odd,R[C.WorksheetFuncId.MROUND]=c.mround,R[C.WorksheetFuncId.QUOTIENT]=c.quotient,R[C.WorksheetFuncId.FLOOR_MATH]=c.floor_math,R[C.WorksheetFuncId.FLOOR_PRECISE]=c.floor_precise,R[C.WorksheetFuncId.CEILING_MATH]=c.ceiling_math,R[C.WorksheetFuncId.CEILING_PRECISE]=c.ceiling_precise,R[C.WorksheetFuncId.ISO_CEILING]=c.ceiling_precise,R[C.WorksheetFuncId.TEXT]=d.text,R[C.WorksheetFuncId.FIXED]=d.fixed,R[C.WorksheetFuncId.DOLLAR]=d.dollar,R[C.WorksheetFuncId.VALUE]=d.value,R[C.WorksheetFuncId.DATEVALUE]=d.datevalue,R[C.WorksheetFuncId.TIMEVALUE]=d.timevalue,R[C.WorksheetFuncId.ISERROR]=f.iserror,R[C.WorksheetFuncId.ISERR]=f.iserr,R[C.WorksheetFuncId.ISBLANK]=f.isblank,R[C.WorksheetFuncId.ISLOGICAL]=f.islogical,R[C.WorksheetFuncId.ISNA]=f.isna,R[C.WorksheetFuncId.ISNONTEXT]=f.isnontext,R[C.WorksheetFuncId.ISTEXT]=f.istext,R[C.WorksheetFuncId.ISNUMBER]=f.isnumber,R[C.WorksheetFuncId.ISREF]=f.isref,R[C.WorksheetFuncId.ISEVEN]=f.iseven,R[C.WorksheetFuncId.ISODD]=f.isodd,R[C.WorksheetFuncId.ISFORMULA]=f.isformula,R[C.WorksheetFuncId.FORMULATEXT]=f.formulatext,R[C.WorksheetFuncId.ROWS]=p.rows,R[C.WorksheetFuncId.COLUMNS]=p.columns,R[C.WorksheetFuncId.AREAS]=p.areas,R[C.WorksheetFuncId.SHEETS]=p.sheets,R[C.WorksheetFuncId.ROW]=p.row,R[C.WorksheetFuncId.COLUMN]=p.column,R[C.WorksheetFuncId.SHEET]=p.sheet,R[C.WorksheetFuncId.OFFSET]=p.offset,R[C.WorksheetFuncId.TRANSPOSE]=p.transpose,R[C.WorksheetFuncId.SINGLE]=p.single,R[C.WorksheetFuncId.ADDRESS]=h.address,R[C.WorksheetFuncId.INDIRECT]=h.indirect,R[C.WorksheetFuncId.LEFT]=g.left,R[C.WorksheetFuncId.RIGHT]=g.right,R[C.WorksheetFuncId.MID]=g.mid,R[C.WorksheetFuncId.LEN]=g.len,R[C.WorksheetFuncId.CONCATENATE]=g.concatenate,R[C.WorksheetFuncId.EXACT]=g.exact,R[C.WorksheetFuncId.REPT]=g.rept,R[C.WorksheetFuncId.TRIM]=g.trim,R[C.WorksheetFuncId.CLEAN]=g.clean,R[C.WorksheetFuncId.CHAR]=g.char,R[C.WorksheetFuncId.UNICHAR]=g.unichar,R[C.WorksheetFuncId.CODE]=g.code,R[C.WorksheetFuncId.UNICODE]=g.unicode,R[C.WorksheetFuncId.LOWER]=g.lower,R[C.WorksheetFuncId.UPPER]=g.upper,R[C.WorksheetFuncId.PROPER]=g.proper,R[C.WorksheetFuncId.FIND]=g.find,R[C.WorksheetFuncId.REPLACE]=g.replace,R[C.WorksheetFuncId.SEARCH]=g.search,R[C.WorksheetFuncId.SUBSTITUTE]=g.substitute,R[C.WorksheetFuncId.RAND]=v.rand,R[C.WorksheetFuncId.RANDBETWEEN]=v.randbetween,R[C.WorksheetFuncId.NOW]=v.now,R[C.WorksheetFuncId.TODAY]=v.today,R[C.WorksheetFuncId.HYPERLINK]=S.hyperlink,R[C.WorksheetFuncId.FIELDVALUE]=m.fieldvalue,R[C.WorksheetFuncId._FV]=m.fieldvalue;var b=!1;t.getWorksheetFunc=function(e){return b||(b=!0,(0,y.isFeatureEnabled)(y.FeatureName.CalcRecordFunctions)&&(R[C.WorksheetFuncId.RECORD]=m.record),(0,y.isFeatureEnabled)(y.FeatureName.CalcNestedRecordFunction)&&(R[C.WorksheetFuncId.NESTEDRECORD]=m.record),(0,y.isFeatureEnabled)(y.FeatureName.CalcLambdaBasicFunctions)&&(R[C.WorksheetFuncId.ARITY]=s.arity,R[C.WorksheetFuncId.APPLY]=s.apply,R[C.WorksheetFuncId.ISLAMBDA]=f.islambda),(0,y.isFeatureEnabled)(y.FeatureName.CalcLambdaHelperFunctions)&&(R[C.WorksheetFuncId.MAKEARRAY]=s.makearray,R[C.WorksheetFuncId.ISOMITTED]=f.isomitted)),R[e]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.devsq=t.avedev=t.rank_avg=t.rank=t.aggregate=t.subtotal=t.mode_mult=t.mode=t.varpa=t.vara=t.varp=t.var_=t.stdevpa=t.stdeva=t.stdevp=t.stdev=t.trimmean=t.median=t.quartile_exc=t.quartile=t.percentile_exc=t.percentile=t.small=t.large=t.xor=t.or=t.and=t.minifs=t.maxifs=t.mina=t.maxa=t.min=t.max=t.countifs=t.countif=t.counta=t.countblank=t.count=t.textjoin=t.concat=t.averagea=t.averageifs=t.averageif=t.average=t.product=t.sumifs=t.sumif=t.sumsq=t.sum=void 0;var n=r(0),i=r(10),o=r(11),a=r(9),s=r(76),l=r(14),u=r(186),c=r(21),d=r(28),f=r(188),p=r(54),m=r(17),h=r(13),g=r(16),v=r(177);function S(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Number:return r;case h.OperKind.Boolean:case h.OperKind.String:return;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function y(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case h.OperKind.Number:return r;case h.OperKind.String:return e.mathpack.zero;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function C(e){return function(t,r,n){if(void 0!==t&&(0,a.isErrorOper)(t))return t;if((0,i.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,a.isNumberOper)(t)),(0,a.isErrorOper)(r))return r;var o,s;(0,i.assertTrue)("calc.funcs.numberReducer",(0,a.isNumberOper)(r)),void 0===t?(o=r,s=n-1):(o=t,s=n);for(var l=0;l<s;l+=1){var u=e(o,r);if((0,a.isErrorOper)(u))return u;o=u}return o}}function R(e){return function(t,r,n){return e.count+=n,r}}function b(e,t,r){if(!(0,a.isNumberOper)(r))return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if(void 0!==r&&(0,s.isRangeValues)(r))for(var n=r.arrays.length-1;n>=0;n-=1){var i=r.arrays[n];if(i.rows>i.denseRows||i.cols>i.denseCols)if((null==(l=i.getSparse())?void 0:l.kind)===h.OperKind.Number)return l;for(var o=i.denseRows-1;o>=0;o-=1)for(var a=i.denseCols-1;a>=0;a-=1){var l;if((null==(l=i.get(o,a))?void 0:l.kind)===h.OperKind.Number)return l}}}}(t);return(null==n?void 0:n.kind)!==h.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function N(e,t,r){var n=(0,f.reduceDerefOpers)(t,C(t.mathpack.add),S,r);return null==n?t.mathpack.zero:(e&&(n=b(t,r,n)),n)}var T=N.bind(void 0,!1),P=N.bind(void 0,!0);function E(e){return(0,a.isRangeOper)(e)&&1!==e.ranges.length}function k(e,t,r){if(E(t))return(0,g.failure)(o.valueErrorOper);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return(0,g.success)({values:n,valuesToFilter:n})}if(E(r))return(0,g.failure)(o.valueErrorOper);var i=function(e,t){var r=e.ranges[0],n=t.ranges[0],i=(0,c.fastMin)(r.cols,l.sheetCols-n.col),a=(0,c.fastMin)(r.rows,l.sheetRows-n.row),s=(0,l.gridRange)(r.row,r.col,a,i),u=(0,o.range3DOper)(e.sheets,s),d=(0,l.gridRange)(n.row,n.col,a,i),f=(0,o.range3DOper)(t.sheets,d);return{actualEvalRange:u,actualFilterRange:f}}(t,r),a=i.actualEvalRange,s=i.actualFilterRange,u=a.ranges[0],d=s.ranges[0],f=e.dereferenceAllOpers([a])[0];if(u.col===d.col&&u.row===d.row)return(0,g.success)({values:f,valuesToFilter:f});var p=e.dereferenceAllOpers([s])[0];return(0,g.success)({values:f,valuesToFilter:p})}function O(e,t){var r=t[0],n=t[1],i=k(e,r,t[2]);if(!(0,g.isSuccess)(i))return i.reason;var o=i.value,a=o.values,l=o.valuesToFilter,c=[(0,s.rangeValues)([(0,u.applyCriteria)(e,a.arrays[0],n,l.arrays[0])])];return T(e,c)}function A(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var i,a,l=t[0];if(E(l))return(0,g.failure)(o.valueErrorOper);if(r){var c=t[1],d=e.dereferenceAllOpers([l])[0];i=(0,u.applyCriteria)(e,d.arrays[0],c),a=2}else{i=e.dereferenceAllOpers([l])[0].arrays[0],a=1}for(var f=a;f<t.length;f+=2){var p=t[f],m=t[f+1];if(E(p))return(0,g.failure)(o.valueErrorOper);if(p.ranges[0].cols!==l.ranges[0].cols||p.ranges[0].rows!==l.ranges[0].rows)return(0,g.failure)(o.valueErrorOper);d=e.dereferenceAllOpers([p])[0];i=(0,u.applyCriteria)(e,d.arrays[0],m,i)}return n&&(i=i.strict()),(0,g.success)((0,s.rangeValues)([i]))}function I(e,t){var r=(0,f.reduceDerefOpers)(e,C(e.mathpack.mul),S,t);return null==r?e.mathpack.zero:r}function _(e,t,r,n,o,s){var l=(0,f.reduceDerefOpers)(o,C(o.mathpack.add),e,s,t);if(null==l)return n;if(r&&(l=b(o,s,l)),(0,a.isErrorOper)(l))return l;var u={count:0},c=(0,f.reduceDerefOpers)(o,R(u),e,s,t);(0,i.assertTrue)("calc.funcs.averageCoerceInner",(0,a.isNumberOper)(l)&&(null==c?void 0:c.kind)===h.OperKind.Number&&u.count>0);var d=o.mathpack.div(l,o.mathpack.fromNumber(u.count));return(0,a.isErrorOper)(d)?d:[d,u.count]}function F(e,t,r,n,i){var a=_(e,t,r,o.div0ErrorOper,n,i);return Array.isArray(a)?a[0]:a}t.sum=function(e,t){var r=e.dereferenceAllOpers(t);return P(e,r)},t.sumsq=function(e,t){var r=e.dereferenceAllOpers(t),n=pe(S),i=(0,f.reduceDerefOpers)(e,C(e.mathpack.add),n,r);return null==i?e.mathpack.zero:i},t.sumif=O,t.sumifs=function(e,t){if(3===t.length)return O(e,[t[1],t[2],t[0]]);var r=A(e,t);return(0,g.isSuccess)(r)?T(e,[r.value]):r.reason},t.product=function(e,t){var r=e.dereferenceAllOpers(t);return I(e,r)};var M=F.bind(void 0,S,void 0,!1),D=F.bind(void 0,S,void 0,!0),w=F.bind(void 0,y,(function(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;return(0,a.isStringOper)(r)?e.mathpack.zero:S(0,r)}),!0);function L(e,t){var r=t[0],n=t[1],i=k(e,r,t[2]);if(!(0,g.isSuccess)(i))return i.reason;var o=i.value,a=o.values,l=o.valuesToFilter,c=[(0,s.rangeValues)([(0,u.applyCriteria)(e,a.arrays[0],n,l.arrays[0]).strict()])];return M(e,c)}function x(e,t,r,n,s){for(var l=void 0,u=0,c="",d=function(e,t){return e.coerceOper(t,h.OperKind.String)},p=function(e,n,s){if(void 0!==e&&(0,a.isErrorOper)(e))return e;for(var d=0;d<s;d+=1){if(void 0!==l&&t.length>0&&(!r||l.value.length>0)){var f=t[u];if(u=(u+1)%t.length,c.length+f.value.length>o.cellStringLimit)return o.valueErrorOper;c+=f.value}if((0,a.isErrorOper)(n))return n;if((0,i.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,a.isStringOper)(n)),c.length+n.value.length>o.cellStringLimit)return o.valueErrorOper;if(c+=n.value,l=n,""===n.value&&(0===t.length||r))break}return n},m=0;m<s.length;m+=1){var g=n[m];if((0,a.isRangeOper)(g)&&g.ranges.length>1)return o.valueErrorOper;var v=(0,f.reduceDerefOpers)(e,p,d,s.slice(m,m+1));if(void 0!==v&&(0,a.isErrorOper)(v))return v;(0,i.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==v&&(0,a.isStringOper)(v))}if(r&&void 0!==l&&""===l.value&&t.length>0&&c.length>0){var S=t[(u+t.length-1)%t.length];c=c.substring(0,c.length-S.value.length)}return(0,o.stringOper)(c)}function B(e,t,r){var n={count:0};return(0,f.reduceDerefOpers)(t,R(n),e,r),t.mathpack.fromNumber(n.count)}t.average=function(e,t){var r=e.dereferenceAllOpers(t);return D(e,r)},t.averageif=L,t.averageifs=function(e,t){if(3===t.length)return L(e,[t[1],t[2],t[0]]);var r=A(e,t,void 0,!0);return(0,g.isSuccess)(r)?M(e,[r.value]):r.reason},t.averagea=function(e,t){var r=e.dereferenceAllOpers(t);return w(e,r)},t.concat=function(e,t){var r=e.dereferenceAllOpers(t);return x(e,[],!0,t,r)},t.textjoin=function(e,t){var r=t[0],n=t[1],s=t.slice(2),l=[];if(!(0,a.isMissingOper)(r)){if((0,a.isRangeOper)(r)&&r.ranges.length>1)return o.valueErrorOper;var u=(0,f.reduceDerefOpers)(e,re(l,p.assertString),(function(e,t){return e.coerceOper(t,h.OperKind.String)}),e.dereferenceAllOpers([r]));if(void 0!==u&&(0,a.isErrorOper)(u))return u;(0,i.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==u&&(0,a.isStringOper)(u))}return x(e,l,(0,a.isMissingOper)(n)||n.value,s,e.dereferenceAllOpers(s))};var U=B.bind(void 0,(function(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;return(0,a.isNumberOper)(r)?r:void 0}));t.count=function(e,t){var r=e.dereferenceAllOpers(t);return U(e,r)};var G=B.bind(void 0,(function(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;return(0,a.isBlankOper)(r)||(0,m.isEmptyStringOper)(r)?r:void 0}));t.countblank=function(e,t){var r=t[0];if(!(0,a.isSheetIndex)(r.sheets)||1!==r.ranges.length)return o.valueErrorOper;var n=e.dereferenceAllOpers(t);return G(e,n)};var K=B.bind(void 0,(function(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;return(0,a.isPrimitiveOper)(r)||(0,a.isErrorOper)(r)?r:void 0}));t.counta=function(e,t){var r=e.dereferenceAllOpers(t);return K(e,r)};var V=B.bind(void 0,(function(e,t){return t}));function j(e,t){var r=t[0],n=t[1];if(E(r))return o.valueErrorOper;var i=e.dereferenceAllOpers([r])[0],a=[(0,s.rangeValues)([(0,u.applyCriteria)(e,i.arrays[0],n)])];return V(e,a)}t.countif=j,t.countifs=function(e,t){if(2===t.length)return j(e,t);var r=A(e,t,!0);return(0,g.isSuccess)(r)?V(e,[r.value]):r.reason};var W=function(e,t,r){return e.mathpack.cond2(t,r)>0},H=function(e,t,r){return e.mathpack.cond2(t,r)<0};function Q(e,t,r,n,o){var s=(0,f.reduceDerefOpers)(n,(function(t,r,o){return void 0===t?r:(0,a.isErrorOper)(t)?t:((0,i.assertTrue)("calc.funcs.minMaxCoerceInner",(0,a.isNumberOper)(t)),(0,a.isErrorOper)(r)?r:((0,i.assertTrue)("calc.funcs.minMaxCoerceInner",(0,a.isNumberOper)(r)),e(n,t,r)?t:r))}),t,o,r);return null==s?n.mathpack.zero:s}var q=Q.bind(void 0,W,S,void 0),z=Q.bind(void 0,H,S,void 0),Y=Q.bind(void 0,W,y,S),J=Q.bind(void 0,H,y,S);function X(e,t){var r=(0,a.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Boolean:return r;case h.OperKind.Number:return(0,o.booleanOper)(0!==e.mathpack.cond(r));case h.OperKind.String:return;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function $(e,t,r){var n=(0,f.reduceDerefOpers)(t,(function(t,r,n){return void 0!==t&&(0,a.isErrorOper)(t)?t:(0,a.isErrorOper)(r)?r:((0,i.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,a.isBooleanOper)(t))&&(0,a.isBooleanOper)(r)),(0,o.booleanOper)(e(null==t?void 0:t.value,r.value,n)))}),X,r);return null==n?o.valueErrorOper:n}t.max=function(e,t){var r=e.dereferenceAllOpers(t);return q(e,r)},t.min=function(e,t){var r=e.dereferenceAllOpers(t);return z(e,r)},t.maxa=function(e,t){var r=e.dereferenceAllOpers(t);return Y(e,r)},t.mina=function(e,t){var r=e.dereferenceAllOpers(t);return J(e,r)},t.maxifs=function(e,t){var r=A(e,t);return(0,g.isSuccess)(r)?q(e,[r.value]):r.reason},t.minifs=function(e,t){var r=A(e,t);return(0,g.isSuccess)(r)?z(e,[r.value]):r.reason};var Z=$.bind(void 0,(function(e,t){return!1!==e&&t})),ee=$.bind(void 0,(function(e,t){return!0===e||t})),te=$.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function re(e,t){return function(r,n,i){if(void 0!==r&&(0,a.isErrorOper)(r))return r;if(!(0,a.isErrorOper)(n))for(var o=t(n),s=0;s<i;s+=1)e.push(o);return n}}function ne(e,t,r,n){var i=[],s=(0,f.reduceDerefOpers)(t,re(i,p.assertNumber),S,[r]);if(null==s)return o.numErrorOper;if((0,a.isErrorOper)(s))return s;var l=t.mathpack;if(l.cond2(n,l.one)<0)return o.numErrorOper;if(l.cond2(n,l.fromNumber(i.length))>0)return o.numErrorOper;var u=i.sort(l.cond2);if(e){var c=(0,p.assertNumber)(l.add((0,p.assertNumber)(l.sub(l.fromNumber(i.length),n)),l.one));return u[l.lfix(c)-1]}return u[l.lfix(n)-1]}t.and=function(e,t){var r=e.dereferenceAllOpers(t);return Z(e,r)},t.or=function(e,t){var r=e.dereferenceAllOpers(t);return ee(e,r)},t.xor=function(e,t){var r=e.dereferenceAllOpers(t);return te(e,r)};var ie=ne.bind(void 0,!0),oe=ne.bind(void 0,!1);function ae(e,t,r,n){var i=e.mathpack,s=[],l=(0,f.reduceDerefOpers)(e,re(s,p.assertNumber),S,t);if(null==l)return o.numErrorOper;if((0,a.isErrorOper)(l))return l;if((0,a.isErrorOper)(r))return r;if(i.cond(r)<0)return o.numErrorOper;if(i.cond2(r,i.one)>0)return o.numErrorOper;var u=s.sort(i.cond2),c=(0,p.assertNumber)(i.sub(i.fromNumber(u.length),i.one)),d=(0,p.assertNumber)(i.add(i.fromNumber(u.length),i.one)),m=n?(0,p.assertNumber)(i.mul(c,r)):(0,p.assertNumber)(i.sub((0,p.assertNumber)(i.mul(d,r)),i.one));if(i.cond(m)<0||i.cond2(m,c)>0)return o.numErrorOper;var h=i.lfix(m),g=(0,p.assertNumber)(i.sub(m,i.fromNumber(h)));if(0===i.cond(g))return u[h];var v=i.sub(u[h+1],u[h]);return(0,a.isErrorOper)(v)?v:i.add(u[h],(0,p.assertNumber)(i.mul(v,g)))}t.large=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ie(e,n,i)},t.small=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return oe(e,n,i)};var se=function(e,t,r){return ae(e,[t],r,!0)};t.percentile=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return se(e,n,i)};var le=function(e,t,r){return ae(e,[t],r,!1)};function ue(e,t){var r=e.mathpack;if(r.cond(t)<0)return o.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return o.numErrorOper;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}t.percentile_exc=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return le(e,n,i)};var ce=function(e,t,r){return ae(e,[t],ue(e,r),!0)};t.quartile=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ce(e,n,i)};var de=function(e,t,r){return ae(e,[t],ue(e,r),!1)};function fe(e,t){return ae(e,t,e.mathpack.fromNumber(.5),!0)}function pe(e){return function(t,r){var n=e(t,r);return void 0!==n&&(0,a.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function me(e,t){return function(r,n){var i=e(r,n);if((null==i?void 0:i.kind)!==h.OperKind.Number)return i;var o=r.mathpack,s=o.sub(i,t);return(0,a.isErrorOper)(s)?s:o.mul(s,s)}}function he(e,t,r,n){var s={count:0};if(null==(0,f.reduceDerefOpers)(r,R(s),e,n,t))return o.div0ErrorOper;(0,i.assertTrue)("calc.funcs.varFirstPass: unexpected count type",s.count>=1);var l=C(r.mathpack.add),u=(0,f.reduceDerefOpers)(r,l,e,n,t),c=(0,f.reduceDerefOpers)(r,l,pe(e),n,void 0===t?void 0:pe(t));if((0,i.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=u),(0,i.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=c),(0,a.isErrorOper)(u))return u;if((0,a.isErrorOper)(c))return c;(0,i.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,a.isNumberOper)(u)&&(0,a.isNumberOper)(c));var d=r.mathpack,p=d.div(u,d.fromNumber(s.count));return(0,a.isErrorOper)(p)?p:[s.count,u,c,p]}function ge(e,t,r,n,o){var a=C(r.mathpack.add),s=(0,f.reduceDerefOpers)(r,a,me(e,o),n,void 0===t?void 0:me(t,o));return(0,i.assertTrue)("calc.funcs.varSecondPass: unexpected error",(null==s?void 0:s.kind)===h.OperKind.Number),s}function ve(e,t,r,n){var i=he(e,t,r,n);if(!Array.isArray(i))return i;var s=r.mathpack,l=i[0],u=i[1],c=i[2],d=i[3];if(l<2)return o.div0ErrorOper;var f=s.mul(u,u);if((0,a.isErrorOper)(f))return f;var m=(0,p.assertNumber)(s.div(f,s.fromNumber(l))),h=(0,p.assertNumber)(s.sub(c,m));if(0===s.cond(d))return s.cond(h)<0?s.zero:s.div(h,s.fromNumber(l-1));if(s.cond(h)>=0){var g=(0,p.assertNumber)(s.div(h,s.fromNumber(l-1)));if(s.cond2(g,s.fromNumber(21219957905e-324))>0){var v=s.div(m,c),S=(0,a.isErrorOper)(v)?v:s.sub(v,s.one);if(!(0,a.isErrorOper)(S)&&s.cond2(s.abs(S),s.fromNumber(.01))>0){var y=s.div(d,g),C=(0,a.isErrorOper)(y)?y:s.sub(s.abs(y),s.fromNumber(1e3));if(!(0,a.isErrorOper)(C)&&s.cond(C)<0)return g}}}var R=ge(e,t,r,n,d);return s.cond(R)<0?s.zero:s.div(R,s.fromNumber(l-1))}function Se(e,t,r,n){var i=he(e,t,r,n);if(!Array.isArray(i))return i;var s=r.mathpack,l=i[0],u=i[1],c=i[2],d=i[3];if(l<1)return o.div0ErrorOper;var f=s.mul(u,u);if((0,a.isErrorOper)(f))return f;var m=s.mul(c,s.fromNumber(l));if((0,a.isErrorOper)(m))return m;var h=(0,p.assertNumber)(s.sub(m,f));if(0===s.cond(d))return s.cond(h)<0?s.zero:s.div(h,s.fromNumber(l*l));if(s.cond(h)>=0){var g=(0,p.assertNumber)(s.div(h,s.fromNumber(l*l)));if(s.cond2(g,s.fromNumber(21219957905e-324))>0){var v=s.div((0,p.assertNumber)(s.div(f,s.fromNumber(l))),c),S=(0,a.isErrorOper)(v)?v:s.sub(v,s.one);if(!(0,a.isErrorOper)(S)&&s.cond2(s.abs(S),s.fromNumber(.01))>0){var y=s.div(d,g),C=(0,a.isErrorOper)(y)?y:s.sub(s.abs(y),s.fromNumber(1e3));if(!(0,a.isErrorOper)(C)&&s.cond(C)<0)return g}}}var R=ge(e,t,r,n,d);return s.cond(R)<0?s.zero:s.div(R,s.fromNumber(l))}t.quartile_exc=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return de(e,n,i)},t.median=function(e,t){var r=e.dereferenceAllOpers(t);return fe(e,r)},t.trimmean=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],s=r[1],l=[],u=(0,f.reduceDerefOpers)(e,re(l,p.assertNumber),S,[n]);if(null==u)return o.numErrorOper;if((0,a.isErrorOper)(u))return u;var c=e.mathpack;if(c.cond(s)<0)return o.numErrorOper;if(c.cond2(s,c.one)>=0)return o.numErrorOper;l=l.sort(c.cond2);var d=c.lfix((0,p.assertNumber)(c.div((0,p.assertNumber)(c.mul(c.fromNumber(l.length),s)),c.fromNumber(2))));(0,i.assertTrue)("calc.funcs.trimmean",d+d<l.length);var m=l[d],h=l[l.length-1-d],g=0,v=0,y=(0,f.reduceDerefOpers)(e,C(e.mathpack.add),(function(e,t){var r=S(0,t);if(void 0===r)return r;(0,i.assertTrue)("calc.funcs.trimmean: unexpected error",(0,a.isNumberOper)(r));var n=e.mathpack;if(n.cond2(r,m)<0)g+=1;else{if(!(n.cond2(r,h)>0))return r;v+=1}}),[n]);(0,i.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==y&&(0,a.isNumberOper)(y)),(0,i.assertTrue)("calc.funcs.trimmean: trimmed too many",g<=d&&v<=d);for(var R=y;g<d;g+=1){var b=c.sub(R,m);if((0,a.isErrorOper)(b))return b;R=b}for(;v<d;v+=1){b=c.sub(R,h);if((0,a.isErrorOper)(b))return b;R=b}return c.div(R,c.fromNumber(l.length-d-d))};var ye=ve.bind(void 0,S,void 0),Ce=Se.bind(void 0,S,void 0),Re=ve.bind(void 0,y,S),be=Se.bind(void 0,y,S);function Ne(e){return function(t,r){var n=e(t,r);return(0,a.isNumberOper)(n)?t.mathpack.sqrt(n):n}}var Te=Ne(ye),Pe=Ne(Ce),Ee=Ne(Re),ke=Ne(be);t.stdev=function(e,t){var r=e.dereferenceAllOpers(t);return Te(e,r)},t.stdevp=function(e,t){var r=e.dereferenceAllOpers(t);return Pe(e,r)},t.stdeva=function(e,t){var r=e.dereferenceAllOpers(t);return Ee(e,r)},t.stdevpa=function(e,t){var r=e.dereferenceAllOpers(t);return ke(e,r)},t.var_=function(e,t){var r=e.dereferenceAllOpers(t);return ye(e,r)},t.varp=function(e,t){var r=e.dereferenceAllOpers(t);return Ce(e,r)},t.vara=function(e,t){var r=e.dereferenceAllOpers(t);return Re(e,r)},t.varpa=function(e,t){var r=e.dereferenceAllOpers(t);return be(e,r)};var Oe=[D,U,K,q,z,I,Te,Pe,P,ye,Ce];function Ae(e,t){var r,n=[],s=(0,f.reduceDerefOpers)(e,(r=n,function(e,t,n){if(void 0!==e&&(0,a.isErrorOper)(e))return e;if((0,a.isNumberOper)(t))for(var i=0;i<n;i+=1)r.push({value:t,index:r.length});return t}),S,t);if(null==s)return o.naErrorOper;if((0,a.isErrorOper)(s))return s;var l=e.mathpack,u=n.sort((function(e,t){return l.cond2(e.value,t.value)})),c=1,d=0,p=1/0,m=[];function h(e){c=1,p=e.index}var g,v,y,C=function(e){var t=e.value;c>d?(d=c,m.length=0,m.push({value:t,index:p})):c===d&&m.push({value:t,index:p})};h(u[0]);for(var R=1;R<u.length;R+=1)v=u[R-1],y=u[R],0===l.cond2(v.value,y.value)?((g=u[R]).index<p&&(p=g.index),c+=1):(C(u[R-1]),h(u[R]));return C(u[u.length-1]),d<2?o.naErrorOper:((0,i.assertTrue)("calc.funcs.modeInner: unexpected error",0!==m.length),m.sort((function(e,t){return e.index-t.index})))}function Ie(e,t){var r=Ae(e,t);return Array.isArray(r)?r[0].value:r}t.mode=function(e,t){return Ie(e,t)},t.mode_mult=function(e,t){var r=Ae(e,t);return Array.isArray(r)?(0,o.arrayOper)(r.length,1,r.map((function(e){return[e.value]}))):r};var _e=(0,v.binaryVisitor)(n.__assign(n.__assign({},(0,v.constVisitor)(!1)),{wsfNode:function(e){return e===d.WorksheetFuncId.SUBTOTAL||e===d.WorksheetFuncId.AGGREGATE}}),(function(e,t){return e||t}));function Fe(e){if(!(0,s.isRangeValues)(e))return e;var t=e.arrays.map((function(e){return e.map((function(e){var t,r=e[0],n=e[1];return void 0!==n&&(t=n.formula,(0,v.reduceBottomUp)(_e,t))?void 0:r}))}));return(0,s.rangeValues)(t)}t.subtotal=function(e,t){var r=t[0],n=t.slice(1),i=e.mathpack.sfix(r),a=Oe.length;if(!(i>=1&&i<=a||i>=101&&i<=a+100))return o.valueErrorOper;var s=i>100||e.isInFilterMode(n),l=e.dereferenceAllOpersAndFormulae(n,s).map(Fe);return(0,Oe[i%100-1])(e,l)};var Me=n.__spreadArray(n.__spreadArray([],Oe,!0),[fe,Ie],!1),De=[ie,oe,se,ce,le,de];function we(e,t,r){var n=t[0],i=t[1],s=t[2],l=(void 0===s?o.falseOper:s).value?1:-1,u=0,c=0,d=e.mathpack,m=(0,f.reduceDerefOpers)(e,(function(e,t,r){if(void 0!==e)return e;if((0,a.isErrorOper)(t))return t;var i=d.cond2(n,(0,p.assertNumber)(t));0===i?u+=r:i===l&&(c+=r)}),S,e.dereferenceAllOpers([i]));if(void 0!==m)return m;if(0===u)return o.naErrorOper;var h=d.fromNumber(c+1);if(r){var g=d.div(d.fromNumber(u-1),d.fromNumber(2));return d.add(h,(0,p.assertNumber)(g))}return h}function Le(e){return function(t,r){var n=e(t,r);return(null==n?void 0:n.kind)===h.OperKind.Number?t.mathpack.abs(n):n}}function xe(e,t,r){var n=_(S,void 0,!0,o.numErrorOper,t,r);if(!Array.isArray(n))return n;var s=n[0],l=n[1],u=(0,f.reduceDerefOpers)(t,C(t.mathpack.add),e(function(e,t){return function(r,n){var i=e(r,n);return(null==i?void 0:i.kind)===h.OperKind.Number?r.mathpack.sub(i,t):i}}(S,s)),r);return(0,i.assertTrue)("calc.funcs.sumDevAndCount",void 0!==u),(0,a.isErrorOper)(u)?u:[(0,p.assertNumber)(u),l]}t.aggregate=function(e,t){var r=t[0],n=t[1],l=t[2],u=t[3],c=t.slice(4),d=e.mathpack,p=d.sfix(r),m=d.sfix(n);if(!(p>=1&&p<=Me.length+De.length&&m>=0&&m<=7))return o.valueErrorOper;var g=1==(1&m),v=2==(2&m),S=!(4==(4&m));function y(t){var r=S?e.dereferenceAllOpersAndFormulae(t,g).map(Fe):e.dereferenceAllOpers(t,g);return v&&(r=r.map((function(e){if((0,f.isPrimitiveCoercedOper)(e))return e;if((0,s.isRangeValues)(e)){var t=e.arrays.map((function(e){return e.map((function(e){return void 0===e||(0,a.isErrorOper)(e)?void 0:e}))}));return(0,s.rangeValues)(t)}if((0,f.isCoercedArrayOper)(e)){var r=e.opers.map((function(e){return e.map((function(e){return void 0===e||(0,a.isErrorOper)(e)?void 0:e}))}));return(0,f.coercedArrayOper)(e.rows,e.cols,r)}return e}))),r}if(p>Me.length){if(void 0===u||c.length>0)return o.valueErrorOper;var C=h.OperKind.Number,R=e.coerceOper(e.dereferenceOper(u,C),C);if((0,a.isErrorOper)(R))return o.valueErrorOper;if((0,a.isRangeOper)(l)&&!(0,a.isSheetIndex)(l.sheets))return o.valueErrorOper;var b=y([l])[0],N=Me.length;return(0,De[p-N-1])(e,b,R)}for(var T=2;T<t.length;T+=1){var P=t[T];if(!P||!(0,a.isRangeOper)(P)||!(0,a.isSheetIndex)(P.sheets))return o.valueErrorOper}var E=y(t.slice(2));return(0,i.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",p>=1&&p<=Me.length),(0,Me[p-1])(e,E)},t.rank=function(e,t){return we(e,t,!1)},t.rank_avg=function(e,t){return we(e,t,!0)},t.avedev=function(e,t){var r=e.dereferenceAllOpers(t),n=xe(Le,e,r);if(!Array.isArray(n))return n;var i=n[0],o=n[1];return e.mathpack.div(i,e.mathpack.fromNumber(o))},t.devsq=function(e,t){var r=e.dereferenceAllOpers(t),n=xe(pe,e,r);return Array.isArray(n)?n[0]:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyCriteria=t.compileCriteria=t.parseCriteria=void 0;var n=r(11),i=r(28),o=r(35),a=r(21),s=r(179),l=r(9),u=r(10),c=r(87),d=r(17),f=r(13),p={"=":i.OperatorId.Eq,"<":i.OperatorId.Lt,">":i.OperatorId.Gt},m={"<>":i.OperatorId.Ne,"<=":i.OperatorId.Le,">=":i.OperatorId.Ge};function h(e,t){if(!(0,l.isStringOper)(t))return t;var r,i,o=(r=t.value).length>=2&&void 0!==(i=m[r.substring(0,2)])?[i,r.substring(2)]:r.length>=1&&void 0!==(i=p[r.substring(0,1)])?[i,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:o[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return n.trueOper;if(0===r.stringCompareCI(t,r.falseName))return n.falseOper;for(var i=1;i<r.errorNames.length;i+=1){var o=r.errorNames[i];if(null!=o&&0===r.stringCompareCI(o,t))return(0,n.errorOper)(i)}var a=e.parseGeneral(t,!1);return void 0!==a?a:(0,n.stringOper)(t)}(e,o[1])}}function g(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:i.OperatorId.Eq,operand:t},n=e.config,o=n.mathpack,a=n.localeInfo;if(r.operator===i.OperatorId.Ne&&(0,d.isEmptyStringOper)(r.operand))return function(e){return!(0,l.isBlankOper)(e)};if(r.operator===i.OperatorId.Eq&&(0,d.isEmptyStringOper)(r.operand))return l.isBlankOper;if(void 0!==r.operator&&(0,d.isEmptyStringOper)(r.operand))return function(e){return!1};if(void 0===r.operator&&(0,d.isEmptyStringOper)(r.operand))return function(e){return(0,l.isBlankOper)(e)||(0,d.isEmptyStringOper)(e)};var p,m,h=void 0===r.operator?i.OperatorId.Eq:r.operator;switch(r.operand.kind){case f.OperKind.Number:return p=h,m=r.operand,function(t){var r=(0,l.isRichOper)(t)?t.getFallback():t;if((0,l.isNumberOper)(r))return(0,s.cmpNum)(o,p,r,m);if((0,l.isStringOper)(r)&&p===i.OperatorId.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&(0,s.cmpNum)(o,p,n,m)}return p===i.OperatorId.Ne};case f.OperKind.Boolean:return function(e,t){return function(r){var n=(0,l.isRichOper)(r)?r.getFallback():r;return(0,l.isBooleanOper)(n)?(0,s.cmpBool)(e,n,t):e===i.OperatorId.Ne}}(h,r.operand);case f.OperKind.String:return function(e,t){switch(e){case i.OperatorId.Eq:case i.OperatorId.Ne:var r=new c.WildExp(a,t.value);return function(t){var n=(0,l.isRichOper)(t)?t.getFallback():t;return(0,l.isStringOper)(n)?r.test(n.value)===(e===i.OperatorId.Eq):e===i.OperatorId.Ne};case i.OperatorId.Lt:case i.OperatorId.Gt:case i.OperatorId.Le:case i.OperatorId.Ge:return function(r){var n=(0,l.isRichOper)(r)?r.getFallback():r;return!!(0,l.isStringOper)(n)&&(0,s.cmpStr)(a,e,n,t)}}}(h,r.operand);case f.OperKind.Error:return function(e,t){return function(r){var n=(0,l.isRichOper)(r)?r.getFallback():r;return(0,l.isErrorOper)(n)?(0,s.cmpInt)(e,n.type-t.type):e===i.OperatorId.Ne}}(h,r.operand);default:return(0,u.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}}t.parseCriteria=h,t.compileCriteria=g,t.applyCriteria=function(e,t,r,n){var i=g(e,h(e,r)),s=t,l=void 0===n?s:n;return new o.NonstrictSparseArray2D(l.rows,l.cols,(0,a.fastMax)(s.denseRows,l.denseRows),(0,a.fastMax)(s.denseCols,l.denseCols),(function(e,t){var r=s.get(e,t);return i(r)?l.get(e,t):void 0}),(function(){var e=s.getSparse();return i(e)?l.getSparse():void 0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(2);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceDerefOpers=t.isPrimitiveCoercedOper=t.isCoercedArrayOper=t.coercedArrayOper=void 0;var n=r(76),i=r(35),o=r(10),a=r(13);t.coercedArrayOper=function(e,t,r){return(0,o.assertNatural)("calc.runtime.coercedArrayOper",e),(0,o.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,o.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:a.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===a.OperKind.Array};var s=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean;t.isPrimitiveCoercedOper=function(e){var t=e.kind;return"number"==typeof t&&0!=(t&s)},t.reduceDerefOpers=function(e,t,r,o,s){var l=function(n,o,l,c){if((null==o?void 0:o.kind)===a.OperKind.Array){for(var d=new i.StrictArray2D(o.rows,o.cols,o.opers),f=n,p=0;p<l;p+=1)f=u(f,d);return f}var m=(c&&void 0!==s?s:r)(e,o);return null==m?n:t(n,m,l)};function u(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var i=0;i<t.cols;i+=1){var o=t.get(n,i);void 0!==o&&(r=l(r,o,1,!0))}return r}function c(e,t){for(var r=e,n=t.getSparse(),i=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var a=0;a<t.denseCols;a+=1){var s=t.get(o,a);void 0!==s&&(r=l(r,s,1,!1))}i>0&&void 0!==n&&(r=l(r,n,i,!1))}var u=(t.rows-t.denseRows)*t.cols;return u>0&&void 0!==n&&(r=l(r,n,u,!1)),r}return o.reduce((function(e,t){return(0,n.isRangeValues)(t)?t.arrays.reduce(c,e):l(e,t,1,!1)}),void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yearFrac=t.networkdays=t.networkdays_intl=t.eomonth=t.edate=t.workday=t.workday_intl=t.days=t.datedif=t.days360=t.time=t.date=t.weeknum=t.isoweeknum=t.weekday=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0;var n=r(0),i=r(11),o=r(190),a=r(54),s=r(9),l=r(16),u=r(13),c=r(10);function d(e,t,r){var n=r[0],a=t.datepack,s=t.config,l=a.fromNum(s,n,o.Rounding.RoundSec);return!1===l?i.numErrorOper:t.mathpack.fromNumber(e(l))}function f(e,t,r){var a=t[0],s=t[1];void 0===r&&(r=!1);var l,u=e.config,c=e.mathpack,d=e.datepack.fromNum(n.__assign(n.__assign({},u),{date1904:u.date1904&&!r}),a,o.Rounding.RoundSec);if(!1===d)return i.numErrorOper;switch(void 0!==s?c.sfix(s):1){case 1:case 17:l=d.wdy;break;case 2:case 11:l=1===d.wdy?7:d.wdy-1;break;case 3:l=1===d.wdy?6:d.wdy-2;break;case 12:l=(d.wdy+4)%7+1;break;case 13:l=(d.wdy+3)%7+1;break;case 14:l=(d.wdy+2)%7+1;break;case 15:l=(d.wdy+1)%7+1;break;case 16:l=d.wdy%7+1;break;default:return i.numErrorOper}return c.fromNumber(l)}function p(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return i.numErrorOper}function m(e,t,r){var l=r[0],u=r[1],d=(0,a.chkDateOper)(t,l);if((0,s.isErrorOper)(d))return d;var m=function(e,t,r){if(void 0===t||(0,s.isMissingOper)(t))return[r?2:1,r];var n=(0,a.chkNumOper)(e,t);if(!(0,s.isErrorOper)(n)){var i=e.mathpack.sfix(n);if(r){if(1===i||2===i)return[i,r]}else{if(1===i||2===i)return[i,r];if(i>=11&&i<=16)return[i-9,r];if(17===i)return[1,r];if(21===i)return[2,!0]}}return[void 0,r]}(t,u,e),h=m[0],g=m[1];if(void 0===h)return i.numErrorOper;var v=t.mathpack,S=t.datepack,y=t.config,C=n.__assign(n.__assign({},y),{date1904:!1}),R=S.fromNum(C,d,o.Rounding.RoundSec);if(!1===R)return p(v,C.dateCompatibility,d);var b=(0,o.dateTime)(R.yr,1,1,0,0,0,0,0,o.Rounding.RoundSec),N=S.toNum(C,b);if((0,s.isErrorOper)(N))return p(v,C.dateCompatibility,d);var T=f(t,[N],!0);if((0,s.isErrorOper)(T))return T;var P=(0,a.assertNumber)(v.add((0,a.assertNumber)(v.sub(T,v.fromNumber(h))),v.fromNumber(7))),E=(0,a.assertNumber)((0,a.numMod)(v,P,v.fromNumber(7))),k=(0,a.assertNumber)(v.add(v.floor((0,a.assertNumber)(v.div((0,a.assertNumber)(v.add((0,a.assertNumber)(v.sub(d,N)),E)),v.fromNumber(7)))),v.one));return g?function(e,t,r,i){var o=e.mathpack,s=e.datepack,l=e.config,u=n.__assign({},i),d=(t+6-u.wdy)%7;if(12===u.mon&&u.dom+d>=35)return o.one;u.dom=4,u.mon=1;var f=s.toDays(l,u);if((0,c.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==f),((f=(f-1)%7+1)-t+7)%7<3){var p=(0,a.assertNumber)(o.sub(r,o.one));if(0===o.cond(p)){var m=u.yr-1;return t===f||m%4==0&&(m%100!=0||m%400==0)&&(t-f+7)%7==6?o.fromNumber(53):o.fromNumber(52)}return p}return r}(t,h,k,R):k}t.year=d.bind(void 0,(function(e){return e.yr})),t.month=d.bind(void 0,(function(e){return e.mon})),t.day=d.bind(void 0,(function(e){return e.dom})),t.hour=d.bind(void 0,(function(e){return e.hour})),t.minute=d.bind(void 0,(function(e){return e.min})),t.second=d.bind(void 0,(function(e){return e.sec})),t.weekday=function(e,t){return f(e,t)},t.isoweeknum=m.bind(void 0,!0),t.weeknum=m.bind(void 0,!1);t.date=function(e,t){var r=t[0],n=t[1],a=t[2],s=e.mathpack,l=e.datepack,u=e.config,c=s.sfix(r);if(c>9999)return i.numErrorOper;var d=s.sfix(n);if(d>32767||d<-32768)return i.numErrorOper;var f=s.sfix(a);(f>32767||f<-32768)&&(f=32767),u.dateCompatibility?c<1900&&(c+=1900):c<1900&&!(1899===c&&12===d&&f>=30)&&(c+=1900);var p=(0,o.dateTime)(c,d,f,0,0,0,0,0,o.Rounding.RoundSec);return l.toNum(u,p)};var h;function g(e,t){var r;if((0,s.isStringOper)(t)){var n=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,i.stringOper)(n),u.OperKind.Number),(0,s.isErrorOper)(r))return r}else r=t;return(0,a.chkDateOper)(e,r)}function v(e,t,r){return r?(0,a.assertNumber)(e.sub(t,e.fromNumber(a.atpm1904to1900Days))):t}function S(e,t){return 0!=(e>>t%7&1)}function y(e){switch(e){case 1:return h.Saturday|h.Sunday;case 2:return h.Sunday|h.Monday;case 3:return h.Monday|h.Tuesday;case 4:return h.Tuesday|h.Wednesday;case 5:return h.Wednesday|h.Thursday;case 6:return h.Thursday|h.Friday;case 7:return h.Friday|h.Saturday;case 11:return h.Sunday;case 12:return h.Monday;case 13:return h.Tuesday;case 14:return h.Wednesday;case 15:return h.Thursday;case 16:return h.Friday;case 17:return h.Saturday;default:return!1}}function C(e){if(7!==e.length)return!1;for(var t=h.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function R(e,t){var r=t[0],n=t[1],o=t[2],c=t[3],d=h.Saturday|h.Sunday,f=(0,a.chkDateOper)(e,r);if((0,s.isErrorOper)(f))return f;var p=(0,a.chkNumOper)(e,n);if((0,s.isErrorOper)(p))return p;var m=e.mathpack,g=e.config;p=m.floor(p);var R=m.cond(p)>0?m.one:m.fromNumber(-1),b=m.abs(p),N=(0,a.assertNumber)(m.add(f,p));if(!(0,a.validDateRange)(e,N))return i.numErrorOper;if(0===m.cond(b))return v(m,f,g.date1904);var T=null,P=[];if(o){if(!(0,s.isMissingOper)(o)){if((0,s.isNumberOper)(o)){var E=y(m.lfix(o));if(!1===E)return i.numErrorOper;d=E}else{if(!(0,s.isStringOper)(o))return i.numErrorOper;var k=C(o.value);if(!1===k)return i.valueErrorOper;d=k}if(127===d)return i.valueErrorOper}if(c&&!(0,s.isMissingOper)(c)){var O=(0,a.chkNumMultiOper)(e,c);if(!(0,l.isSuccess)(O))return O.reason;T=O.value}}for(var A=null==T?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,i=0;i<e.denseRows;i+=1){for(var o=0;o<e.denseCols;o+=1){var a=e.get(i,o);void 0!==a&&t.push(a)}if(n>0&&void 0!==r)for(var s=0;s<n;s+=1)t.push(r)}var l=(e.rows-e.denseRows)*e.cols;if(l>0&&void 0!==r)for(i=0;i<l;i+=1)t.push(r);return t}(T),I=A.length-1;I>=0;I-=1){var _=A[I];switch(_.kind){case u.OperKind.Number:case u.OperKind.String:case u.OperKind.Blank:var F=(0,a.chkDateOper)(e,_);if((0,s.isErrorOper)(F))return F;P[I]=F;break;case u.OperKind.Error:return _;default:return i.valueErrorOper}}for(;m.cond(b)>0;){if(f=(0,a.assertNumber)(m.add(f,R)),!S(d,m.lfix(f))){var M=!0;for(I=0;I<A.length;I+=1)if(0===m.cond2(P[I],f)){M=!1;break}M&&(b=(0,a.assertNumber)(m.sub(b,m.one)))}}return f=v(m,f,g.date1904),(0,a.validDateRange)(e,f)?f:i.numErrorOper}t.time=function(e,t){var r=t[0],n=t[1],a=t[2],l=e.mathpack,u=e.datepack,c=e.config,d=l.sfix(r);if(d>32767)return i.numErrorOper;var f=l.sfix(n);if(f>32767)return i.numErrorOper;var p,m,h,g=l.sfix(a);if(g>32767)return i.numErrorOper;c.dateCompatibility?(p=c.date1904?1904:1900,m=1,h=c.date1904?1:0):(p=1899,m=12,h=30);var v=(0,o.dateTime)(p,m,h,d,f,g,0,0,o.Rounding.RoundSec),S=u.toNum(c,v);return(0,s.isErrorOper)(S)?S:l.cond(S)<0?i.numErrorOper:l.sub(S,l.trunc(S))},t.days360=function(e,t){var r,n=t[0],a=t[1],s=t[2],l=e.mathpack,u=e.datepack,c=e.config,d=null!==(r=null==s?void 0:s.value)&&void 0!==r&&r,f=u.fromNum(c,n,o.Rounding.RoundSec);if(!1===f)return i.naErrorOper;var p=31===f.dom||!d&&2===f.mon&&f.dom===u.daysPerMonth(2,f.yr,c.dateCompatibility)?30:f.dom,m=l.fromNumber(360*(f.yr-1900)+30*f.mon+p),h=u.fromNum(c,a,o.Rounding.RoundSec);if(!1===h)return i.naErrorOper;var g=31!==h.dom||!d&&30!==f.dom?h.dom:30,v=l.fromNumber(360*(h.yr-1900)+30*h.mon+g);return l.sub(v,m)},t.datedif=function(e,t){var r=t[0],n=t[1],a=t[2].value;if(a.length>2||0===a.length)return i.numErrorOper;var s=e.mathpack,l=e.datepack,u=e.config,c=s.lfix(r),d=l.fromNum(u,r,o.Rounding.RoundSec);if(!1===d)return i.numErrorOper;var f=e.mathpack.lfix(n),p=l.fromNum(u,n,o.Rounding.RoundSec);if(!1===p)return i.numErrorOper;if(c>f)return i.numErrorOper;var m=p.dom,h=p.mon,g=p.yr;d.dom>m&&(0===(h-=1)&&(h=12,g-=1),m+=l.daysPerMonth(h,g,u.dateCompatibility)),d.mon>h&&(h+=12,g-=1);var v=function(e,t){return 0===u.localeInfo.stringCompareCI(e,t)};if(v(a,"Y"))return s.fromNumber(g-d.yr);if(v(a,"M"))return s.fromNumber(12*(g-d.yr)+(h-d.mon));if(v(a,"D"))return s.fromNumber(f-c);if(v(a,"MD"))return s.fromNumber(m-d.dom);if(v(a,"YM"))return s.fromNumber(h-d.mon);if(v(a,"YD")){for(var S=0,y=d.mon;y<h;y+=1)S+=l.daysPerMonth(y,d.yr,u.dateCompatibility);return s.fromNumber(S+(m-d.dom))}return i.numErrorOper},t.days=function(e,t){var r=t[0],n=t[1];if((0,s.isStringOper)(r)&&r.value.length>255||(0,s.isStringOper)(n)&&n.value.length>255)return i.valueErrorOper;var o=g(e,r);if((0,s.isErrorOper)(o))return o;var a=g(e,n);return(0,s.isErrorOper)(a)?a:e.mathpack.sub(o,a)},function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(h||(h={})),t.workday_intl=R,t.workday=function(e,t){var r=t[0],n=t[1],o=t[2];return R(e,o?[r,n,i.missingOper,o]:[r,n])};var b;function N(e,t,r,i){var l=e.mathpack,u=e.datepack,c=e.config,d=n.__assign(n.__assign({},c),{date1904:!1}),f=u.fromNum(d,t,o.Rounding.RoundSec);if(!1===f)return f;var p=l.fromNumber(f.dom),m=l.fromNumber(f.mon),h=l.fromNumber(12),g=l.fromNumber(f.yr);if(l.cond(r)>=0){g=(0,a.assertNumber)(l.add(l.floor((0,a.assertNumber)(l.div(r,h))),g));var v=(0,a.assertNumber)((0,a.numMod)(l,r,h)),S=(0,a.assertNumber)(l.add(v,m));1===l.cond2(S,h)&&(g=(0,a.assertNumber)(l.add(g,l.one))),m=(0,a.assertNumber)((0,a.numMod)(l,S,h))}else{var y=l.neg(r),C=l.floor((0,a.assertNumber)(l.div(y,h)));g=(0,a.assertNumber)(l.sub(g,C));v=(0,a.assertNumber)((0,a.numMod)(l,y,h));if(l.cond2(v,m)>=0)g=(0,a.assertNumber)(l.sub(g,l.one)),m=(0,a.assertNumber)(l.add((0,a.assertNumber)(l.sub(m,v)),h));else{var R=(0,a.assertNumber)(l.sub(m,v));m=(0,a.assertNumber)((0,a.numMod)(l,R,h))}}0===l.cond(m)&&(m=h);var b=l.lfix(m);switch(b){case 4:case 6:case 9:case 11:var N=l.fromNumber(30);l.cond2(p,N)>0&&(p=N);break;case 2:l.cond2(p,l.fromNumber(28))>0&&(p=l.fromNumber(u.daysPerMonth(2,l.toNumber(g),!1)))}if(i&&(p=l.fromNumber(u.daysPerMonth(b,l.toNumber(g),!1))),l.lfix(g)<(d.dateCompatibility?1900:-9999))return!1;var T=function(e,t,r,n,i,a){var s=e.lfix(n),l=e.lfix(i),u=e.lfix(a);return t.toNum(r,(0,o.dateTime)(u,l,s,0,0,0,0,0,o.Rounding.RoundSec))}(l,u,d,p,m,g);return!(0,s.isErrorOper)(T)&&T}function T(e,t,r){var n=r[0],o=r[1],l=(0,a.chkDateOper)(t,n);if((0,s.isErrorOper)(l))return l;var u=(0,a.chkNumOper)(t,o);if((0,s.isErrorOper)(u))return u;var c=t.mathpack,d=t.config,f=N(t,l,u=c.cond(u)>0?c.floor(u):c.ceil(u),!e);return!1===f?i.numErrorOper:v(c,f,d.date1904)}function P(e,t){var r,n=t[0],o=t[1],l=t[2],c=t[3],d=e.mathpack,f=h.Saturday|h.Sunday,p=5;function m(e){p=7;for(var t=f=e;0!==t;)1==(1&t)&&(p-=1),t>>=1}if(void 0!==l&&!(0,s.isMissingOper)(l))if((0,s.isStringOper)(l)){var g=C(l.value);if(!1===g)return i.valueErrorOper;m(g)}else{var v=(0,a.chkNumOper)(e,l);if((0,s.isErrorOper)(v))return i.valueErrorOper;var R=y(d.lfix(v));if(!1===R)return i.numErrorOper;m(R)}var b=null!=c?c:i.missingOper,N=(0,a.chkDateOper)(e,n);if((0,s.isErrorOper)(N))return N;var T=(0,a.chkDateOper)(e,o);if((0,s.isErrorOper)(T))return T;var P,E=d.lfix(N),k=d.lfix(T);E>k?(P=E,E=k,k=P,r=-1):r=1,P=E%7,P=k%7;for(var O=0,A=E<k?E:k,I=E<k?k:E;A%7!=0&&A!==I;)S(f,A)||(O+=1),A+=1;for(;I%7!=6&&A!==I;)S(f,I)||(O+=1),I-=1;if(I===A&&1!=(f>>A%7&1)&&(O+=1),E>k){var _=A;A=I,I=_}var F=d.fromNumber(p*Math.floor((I+1-A)/7)+O);switch(b.kind){case u.OperKind.Number:case u.OperKind.String:var M=(0,a.chkDateOper)(e,b);if((0,s.isErrorOper)(M))return M;(P=d.lfix(M))>=E&&P<=k&&P%7>=2&&(F=(0,a.assertNumber)(d.sub(F,d.one)));break;case u.OperKind.Range:case u.OperKind.Array:var D=function(e,t,r,n,o,l){var c,d=e.mathpack;if(void 0===l||(0,s.isMissingOper)(l))c=h.Saturday|h.Sunday;else if((0,s.isStringOper)(l)){var f=C(l.value);if(!1===f)return i.valueErrorOper;c=f}else{var p=(0,a.chkNumOper)(e,l);if((0,s.isErrorOper)(p))return i.valueErrorOper;var m=y(d.lfix(p));if(!1===m)return i.numErrorOper;c=m}var g=d.fromNumber(r),v=d.fromNumber(n),R=e.dereferenceOper(o,u.OperKind.Array);if(!(0,s.isArrayOper)(R))return i.valueErrorOper;var b=[];function N(e){if(d.cond2(e,g)>=0&&d.cond2(e,v)<=0){var t=d.lfix(e);S(c,t)||b.push(e)}}for(var T=0;T<R.rows;T+=1)for(var P=0;P<R.cols;P+=1){var E=R.opers[T][P];switch(E.kind){case u.OperKind.Number:case u.OperKind.String:var k=(0,a.chkDateOper)(e,E);if((0,s.isErrorOper)(k))return k;N(k);break;case u.OperKind.Blank:break;case u.OperKind.Error:return E;default:return i.valueErrorOper}}var O=t;if(0!==b.length){var A=b.sort((function(e,t){return d.cond2(e,t)})),I=A[0];O=(0,a.assertNumber)(d.sub(O,d.one));for(T=0;T<A.length;T+=1){var _=A[T];0!==d.cond2(_,I)&&(I=_,O=(0,a.assertNumber)(d.sub(O,d.one)))}}return O}(e,F,E,k,b,l);if((0,s.isErrorOper)(D))return D;F=D;break;case u.OperKind.Error:return b;case u.OperKind.Missing:break;default:return i.valueErrorOper}return d.mul(d.fromNumber(r),F)}function E(e,t,r,n,i,o,a){var s=360*(r-t),l=30*(i-n);return e.mathpack.fromNumber(a-o+l+s)}function k(e,t,r,n){var i=e.datepack,o=e.config;return t===i.daysPerMonth(r,n,o.dateCompatibility)}function O(e,t,r,n,i){var s=e.mathpack;switch(s.cond2(t,r)){case 1:break;case 0:return s.zero;case-1:switch(n){case b.Basis30360:return function(e,t,r,n,i){var a=e.datepack,s=e.config,l=a.fromNum(s,t,o.Rounding.RoundSec);if(!1===l)return!1;var u=l.dom,c=l.mon,d=l.yr,f=a.fromNum(s,r,o.Rounding.RoundSec);if(!1===f)return!1;var p=f.dom,m=f.mon,h=f.yr;return 2===p&&k(e,p,m,h)&&(2===u&&k(e,u,c,d)||3===n)&&(p=30),31===p&&(u>=30||3===n)&&(p=30),31===u&&(u=30),i&&2===c&&k(e,u,c,d)&&(u=30),E(e,d,h,c,m,u,p)}(e,t,r,i,!0);case b.BasisActual360:case b.BasisActual365:case b.BasisActual:return(0,a.assertNumber)(s.sub(r,t));case b.BasisE30360:return function(e,t,r){var n=e.datepack,i=e.config,a=n.fromNum(i,t,o.Rounding.RoundSec);if(!1===a)return!1;var s=a.dom,l=a.mon,u=a.yr,c=n.fromNum(i,r,o.Rounding.RoundSec);if(!1===c)return!1;var d=c.dom,f=c.mon;return 31===s&&(s=30),31===d&&(d=30),E(e,u,c.yr,l,f,s,d)}(e,t,r)}}return!1}t.edate=T.bind(void 0,!0),t.eomonth=T.bind(void 0,!1),t.networkdays_intl=P,t.networkdays=function(e,t){var r=t[0],n=t[1],o=t[2];return P(e,o?[r,n,i.missingOper,o]:[r,n])},function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(b||(b={})),t.yearFrac=function(e,t){var r=t[0],n=t[1],l=t[2],u=b.DefaultBasis;if(void 0!==l){var c=function(e,t){var r=b.DefaultBasis;if(void 0===t||(0,s.isMissingOper)(t))return r;var n=(0,a.chkNumOper)(e,t);if((0,s.isErrorOper)(n))return n;var o=e.mathpack;switch(r=o.lfix(o.floor(n))){case b.Basis30360:case b.BasisActual:case b.BasisActual360:case b.BasisActual365:case b.BasisE30360:return r;default:return i.numErrorOper}}(e,l);if("number"!=typeof c)return c;u=c}var d=(0,a.chkDateOper)(e,r);if((0,s.isErrorOper)(d))return d;var f=(0,a.chkDateOper)(e,n);if((0,s.isErrorOper)(f))return f;var p=e.mathpack;if(p.cond2(d,f)>0){var m=d;d=f,f=m}var h=O(e,d,f,u,0);if(!1===h)return i.numErrorOper;var g=function(e,t,r,n){var i=e.mathpack,l=e.datepack,u=e.config,c=i.fromNumber(360),d=i.fromNumber(365),f=i.fromNumber(366);switch(t){case b.BasisActual:var p=l.fromNum(u,r,o.Rounding.RoundSec);if(!1===p)return!1;var m=p.dom,h=p.mon,g=p.yr,v=l.fromNum(u,n,o.Rounding.RoundSec);if(!1===v)return!1;var S=v.dom,y=v.mon,C=v.yr,R=C-1;if(g===C)return 29===l.daysPerMonth(2,g,u.dateCompatibility)?f:d;if(R===g&&(h>y||h===y&&m>=S)){if(29===l.daysPerMonth(2,g,u.dateCompatibility)){var N=l.toNum(u,(0,o.dateTime)(g,2,29,0,0,0,0,0,o.Rounding.RoundSec));return!(0,s.isErrorOper)(N)&&(i.cond2(N,r)>=0?f:d)}if(29===l.daysPerMonth(2,C,u.dateCompatibility)){N=l.toNum(u,(0,o.dateTime)(g,2,29,0,0,0,0,0,o.Rounding.RoundSec));return!(0,s.isErrorOper)(N)&&(i.cond2(N,n)<=0?f:d)}return d}for(var T=0,P=g;P<=C;P+=1)29===l.daysPerMonth(2,P,u.dateCompatibility)?T+=366:T+=365;var E=i.fromNumber(C-g+1);return(0,a.assertNumber)(i.div(i.fromNumber(T),E));case b.Basis30360:case b.BasisActual360:case b.BasisE30360:return c;case b.BasisActual365:return d;default:return c}}(e,u,d,f);return!1===g?i.numErrorOper:p.div(h,g)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(1);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gestep=t.delta=void 0;var n=r(54),i=r(9);function o(e,t){var r=t[0],o=t[1],a=void 0===o||(0,i.isMissingOper)(o)?e.mathpack.zero:(0,n.chkNumOper)(e,o);if((0,i.isErrorOper)(a))return a;var s=(0,n.chkNumOper)(e,r);return(0,i.isErrorOper)(s)?s:[s,a]}t.delta=function(e,t){var r=o(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],a=e.mathpack;return 0===a.cond2(n,i)?a.one:a.zero},t.gestep=function(e,t){var r=o(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],a=e.mathpack;return a.cond2(n,i)>=0?a.one:a.zero}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.error_type=t.type=t.n_=t.t_=t.na=void 0;var n=r(11),i=r(20),o=r(9),a=r(10),s=r(13),l=r(17),u=r(12);function c(e,t){if((0,o.isRangeOper)(t)){if((0,o.isSheetIndex)(t.sheets)){var r=(0,n.rangeSeqOper)(t.sheets,[(0,o.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,i.readOperType)}return n.valueErrorOper}return t}t.na=function(e,t){return n.naErrorOper},t.t_=function(e,t){var r=c(e,t[0]);return(0,o.isStringOper)(r)||(0,o.isErrorOper)(r)?r:l.emptyStringOper},t.n_=function(e,t){var r=c(e,t[0]);if((0,o.isNumberOper)(r)||(0,o.isErrorOper)(r))return r;var n=e.mathpack;return(0,o.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case s.OperKind.Number:return n.fromNumber(1);case s.OperKind.String:return n.fromNumber(2);case s.OperKind.Boolean:return n.fromNumber(4);case s.OperKind.Error:return n.fromNumber(16);case s.OperKind.Array:return n.fromNumber(64);case s.OperKind.Rich:return n.fromNumber(128);default:return(0,a.assertNever)("calc.funcs.type",r)}},t.error_type=function(e,t){var r=t[0];return(0,o.isErrorOper)(r)?(r.type>n.ErrorType.CALC&&(0,u.throwEvaluationError)((0,o.notImplemented)(["ERROR.TYPE for "+String(r.type)])),e.mathpack.fromNumber(r.type)):n.naErrorOper},t.info=function(e,t){return n.valueErrorOper}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arity=t.makearray=t.apply=void 0;var n=r(11),i=r(53),o=r(20),a=r(20),s=r(12),l=r(9);function u(e,t,r){var a=(0,o.refToVal)(e,t,!0);return a instanceof i.LambdaOper?void 0===r||r>=a.minArity&&r<=a.maxArity?a:n.naErrorOper:(0,l.isErrorOper)(a)?a:n.refErrorOper}t.apply=function(e,t){var r=t[0],n=t.slice(1),i=u(e,r,n.length);return(0,l.isErrorOper)(i)?i:e.applyLambda(i,n)},t.makearray=function(e,t){var r=t[0],i=t[1],o=t[2],c=u(e,o,2);if((0,l.isErrorOper)(c))return c;var d=e.mathpack,f=(0,l.isMissingOper)(r)?1:d.fix(r),p=(0,l.isMissingOper)(i)?1:d.fix(i);if(f<1||p<1)return n.valueErrorOper;if(f*p>1e6)return(0,s.throwEvaluationError)((0,l.notImplemented)(["MAKEARRAY with very large size"]));var m=[n.falseOper,n.falseOper];return(0,a.machineCall)(new a.ArrayMachine(e,f,p,(function(t,r){return(0,a.machineCall)(new a.ThenMachine(e,(function(){var n=e.mathpack;return m[0]=n.fromNumber(t+1),m[1]=n.fromNumber(r+1),e.applyLambda(c,m)}),(function(e){return(0,l.isRangeOper)(e)?(0,s.throwEvaluationError)((0,l.notImplemented)(["MAKEARRAY with nested RangeOper"])):(0,l.isArrayOper)(e)?(0,s.throwEvaluationError)((0,l.notImplemented)(["MAKEARRAY with nested ArrayOper"])):e})))})))},t.arity=function(e,t){var r=(0,o.refToVal)(e,t[0],!0);return r instanceof i.LambdaOper?e.mathpack.fromNumber(r.maxArity):n.naErrorOper}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=t.false_=t.true_=t.switch_=t.ifs=t.choose=t.if_=void 0;var n=r(11),i=r(10),o=r(17),a=r(28),s=r(9),l=r(12),u=r(13),c=(0,o.makeStrict)((0,a.getWorksheetFuncType)(a.WorksheetFuncId.IFS)),d=(0,o.makeStrict)((0,a.getWorksheetFuncType)(a.WorksheetFuncId.SWITCH));function f(e,t,r,n){var i=n.slice();return e.dereferenceOpers(i,t),(0,o.arrayLift)(e,t,(function(n){for(var i=[],o=0;o<n.length;o+=1){var a=(0,s.getArgType)(t,o,n.length);i[o]=e.coerceOper(n[o],a)}return r(e,i)}),i)}t.if_=function(e,t){var r=t[0];(0,i.assertTrue)("calc.funcs.if: condition is not a boolean",(0,s.isBooleanOper)(r));var n=t[r.value?1:2];return(0,i.assertTrue)("calc.funcs.if: result is undefined",void 0!==n),n},t.choose=function(e,t){var r=t[0];(0,i.assertTrue)("calc.funcs.choose",(0,s.isNumberOper)(r));var o=e.mathpack.fix(r);return o<1||o>t.length-1?n.valueErrorOper:t[o]},t.ifs=function e(t,r){for(var o=0;o<r.length;o+=2){var a=r[o];if((0,s.isArrayOper)(a)){var l=r.slice(o);return f(t,c,e,l)}if((0,s.isErrorOper)(a))return a;if((0,i.assertTrue)("calc.funcs.ifs",(0,s.isBooleanOper)(a)),a.value)return r[o+1]}return n.naErrorOper},t.switch_=function e(t,r){var o=r[0];if((0,s.isArrayOper)(o))return f(t,d,e,r);if((0,s.isErrorOper)(o))return o;for(var a=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case u.OperKind.Number:return function(e){return(0,s.isRichOper)(e)?(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isNumberOper)(e)&&0===r.compare(t,e)};case u.OperKind.String:return function(e){return(0,s.isRichOper)(e)?(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isStringOper)(e)&&0===n.stringCompareCI(t.value,e.value)};case u.OperKind.Boolean:return function(e){return(0,s.isRichOper)(e)?(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isBooleanOper)(e)&&t.value===e.value};case u.OperKind.Rich:return(0,l.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,i.assertNever)("calc.funcs.makeSwitchComparer",t)}}(t.config,o),c=1;c<r.length-1;c+=2){var p=u.OperKind.Error|u.OperKind.Rich|u.OperKind.Number|u.OperKind.Boolean|u.OperKind.String|u.OperKind.Array,m=t.coerceOper(t.dereferenceOper(r[c],p),p);if((0,s.isArrayOper)(m))return f(t,d,e,r);if((0,s.isErrorOper)(m))return m;if(a(m))return r[c+1]}return r.length%2==0?r[r.length-1]:n.naErrorOper},t.true_=function(e,t){return n.trueOper},t.false_=function(e,t){return n.falseOper},t.not=function(e,t){var r=t[0];return(0,n.booleanOper)(!r.value)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vlookup=t.hlookup=t.lookup=t.match=t.linearSearch=t.binarySearch=t.index=void 0;var n=r(28),i=r(11),o=r(76),a=r(9),s=r(10),l=r(12),u=r(87),c=r(14),d=r(35),f=r(21),p=r(13);t.index=function(e,t){var r=t[0],n=t[1],o=t[2],l=t[3],u=e.mathpack,d=u.sfix(n);if(d<0)return i.valueErrorOper;var m=void 0===o?void 0:u.sfix(o);if(void 0!==m&&m<0)return i.valueErrorOper;var h,g,v=void 0===l?0:u.sfix(l)-1;if(v<0)return i.valueErrorOper;switch(r.kind){case p.OperKind.Range:if(!(0,a.isSheetIndex)(r.sheets))return i.valueErrorOper;if(v>=r.ranges.length)return i.refErrorOper;var S=r.ranges[v];if(void 0===m)if(1===S.rows)h=0,g=d-1;else{if(1!==S.cols)return i.refErrorOper;h=d-1,g=-1}else h=d-1,g=m-1;if(h>=S.rows||g>=S.cols)return i.refErrorOper;var y=(0,c.gridRange)(S.row+(0,f.fastMax)(h,0),S.col+(0,f.fastMax)(g,0),-1===h?S.rows:1,-1===g?S.cols:1);return(0,i.rangeSeqOper)(r.sheets,[y]);case p.OperKind.Array:return v>0?i.refErrorOper:(void 0===m?1===r.rows?(h=0,g=d-1):(h=d-1,g=-1):(h=d-1,g=m-1),h>=r.rows||g>=r.cols?i.refErrorOper:-1===h&&-1===g?r:-1===h?(0,i.arrayOper)(r.rows,1,r.opers.map((function(e){return[e[g]]}))):-1===g?(0,i.arrayOper)(1,r.cols,[r.opers[h]]):r.opers[h][g]);default:return(0,s.assertNever)("calc.funcs.lookupFuncs: INDEX",r)}};var m=function(e){return e<0?n.OperatorId.Lt:e>0?n.OperatorId.Gt:n.OperatorId.Eq};function h(e,t,r){void 0===r&&(r=!1);var i,o=e.config,c=o.localeInfo,d=o.mathpack;switch(t.kind){case p.OperKind.Number:i=function(e){return{correctType:!0,sgnT:(r=d,n=e,i=t,m(r.cond2(n,i)))};var r,n,i};break;case p.OperKind.String:if(r){var f=new u.WildExp(c,t.value);i=function(e){return{correctType:!0,sgnT:f.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}}}else i=function(e){return{correctType:!0,sgnT:m(c.stringCompareCI(e.value,t.value))}};break;case p.OperKind.Boolean:i=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,m(r-n))};var r,n};break;case p.OperKind.Rich:return(0,l.throwEvaluationError)((0,a.notImplemented)(["lookup with rich value condition"]));default:return(0,s.assertNever)("calc.funcs.makeLookupComparer",t)}return function(e){var r=(0,a.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:n.OperatorId.Ne}:i(r)}}function g(e,t,r){for(var i=!1,o=r.length-1,a=Math.floor((0+o)/2),s=0,l=o,u=h(e,t);;){var c=u(r.get(a)).sgnT;if(c===n.OperatorId.Ne){if(a<l)for(var d=a+1;d<=l;d+=1)if((c=u(r.get(d)).sgnT)!==n.OperatorId.Ne){a=d;break}c===n.OperatorId.Ne&&(a=Math.floor((s+l)/2),c=n.OperatorId.Gt)}if(c===n.OperatorId.Eq){if(a<o){i=!0,s=a+=1,l=a;continue}return a}if(c===n.OperatorId.Lt?s=a+1:l=a-1,!(s<=l)){if(i)a-=1;else if(c===n.OperatorId.Gt&&(a-=1)>=0){s=a,l=a;continue}return a}a=Math.floor((s+l)/2)}}function v(e,t,r,i){for(var o=-1,a=h(e,t,i===n.OperatorId.Eq),s=0;s<r.length;s+=1){var l=a(r.get(s)),u=l.correctType,c=l.sgnT;if(u){if(c===n.OperatorId.Eq)return s;if(c!==n.OperatorId.Ne&&c===i)return o;o=s}s===r.denseLength&&(s=(0,f.fastMax)(s,r.length-2))}return i!==n.OperatorId.Eq?o:r.length}function S(e){switch(e.kind){case p.OperKind.Number:return i.naErrorOper;case p.OperKind.Range:return(0,a.isSheetIndex)(e.sheets)?e.ranges.length>1?i.naErrorOper:e:i.valueErrorOper;case p.OperKind.Array:return e}}function y(e,t){var r;switch(t.kind){case p.OperKind.Number:return t;case o.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case p.OperKind.Array:r=t.opers[0][0];break;default:return(0,s.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,p.OperKind.Number),(0,a.isErrorOper)(r)?i.refErrorOper:r}function C(e){switch(e.kind){case p.OperKind.Number:case p.OperKind.Rich:return i.naErrorOper;case p.OperKind.Range:if(!(0,a.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.naErrorOper;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?i.naErrorOper:e;case p.OperKind.Array:return 1!==e.rows&&1!==e.cols?i.naErrorOper:e}}function R(e){switch(e.kind){case o.DerefOperKind.RangeValues:return e.arrays[0];case p.OperKind.Array:return new d.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,i.blankOper)}}function b(e,t){switch(t.kind){case p.OperKind.Range:var r=t.sheets,n=t.ranges[0];return new d.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,(function(t,o){var a=(0,c.gridCell)(n.row+t,n.col+o);return e.dereferenceAllOpers([(0,i.rangeSeqOper)(r,[a])])[0].arrays[0].get(0,0)}),(function(){return(0,s.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case p.OperKind.Array:return new d.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,i.blankOper)}}function N(e){if((0,a.isRangeOper)(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function T(e,t,r){var o=t[0],s=t[1],u=t[2],c=t[3],d=void 0===c?i.trueOper:c,f=S(s);if((0,a.isErrorOper)(f))return f;var m=E(f,r),h=P(R(e.dereferenceAllOpers([m])[0]),r),C=!d.value?v(e,o,h,n.OperatorId.Eq):g(e,o,h);if(C<0||C>=h.length)return i.naErrorOper;var N=function(e,t){switch(t.kind){case p.OperKind.Number:return t;case p.OperKind.Range:if(!(0,a.isSheetIndex)(t.sheets))return i.valueErrorOper;if(t.ranges.length>1)return i.refErrorOper;var r=t.ranges;return e.calcingArray?(0,l.throwEvaluationError)((0,a.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,l.throwEvaluationError)((0,a.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case p.OperKind.Array:return(0,l.throwEvaluationError)((0,a.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,u);if((0,a.isErrorOper)(N))return N;var T=e.dereferenceAllOpers([N])[0],k=y(e,T);if((0,a.isErrorOper)(k))return k;var O=e.mathpack.sfix(k)-1,A=b(e,f);return O<0?i.valueErrorOper:O>=(r?A.rows:A.cols)?i.refErrorOper:r?A.get(O,C):A.get(C,O)}function P(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function E(e,t){if((0,a.isRangeOper)(e)){var r=e.ranges[0],n=(0,c.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,i.rangeSeqOper)(e.sheets,[n])}return e}t.binarySearch=g,t.linearSearch=v,t.match=function(e,t){var r=t[0],o=t[1],s=t[2],l=void 0===s?e.mathpack.one:s,u=e.mathpack,c=function(e){switch(e.kind){case p.OperKind.Number:return e;case p.OperKind.Range:if(!(0,a.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.refErrorOper;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?i.refErrorOper:e}}(l);if((0,a.isErrorOper)(c))return c;var d=e.dereferenceAllOpers([c])[0],f=y(e,d);if((0,a.isErrorOper)(f))return f;var m=C(o);if((0,a.isErrorOper)(m))return m;var h=R(e.dereferenceAllOpers([m])[0]),S=P(h,1===h.rows),b=-1;return(b=u.cond(f)>0?g(e,r,S):0===u.cond(f)?v(e,r,S,n.OperatorId.Eq):v(e,r,S,n.OperatorId.Lt))<0||b>=S.length?i.naErrorOper:e.mathpack.fromNumber(b+1)},t.lookup=function(e,t){var r=t[0],n=t[1],o=t[2],s=S(n);if((0,a.isErrorOper)(s))return s;var l=N(s),u=E(s,l),d=P(R(e.dereferenceAllOpers([u])[0]),l),p=g(e,r,d);if(p<0)return i.naErrorOper;if(void 0!==o){var m=C(o);if((0,a.isErrorOper)(m))return m;var h=N(m),v=P(b(e,function(e,t,r){if((0,a.isRangeOper)(r)){var n=r.ranges[0],o=(0,c.gridRange)(n.row,n.col,(0,f.fastMin)(t?1:e,c.sheetRows-n.row),(0,f.fastMin)(t?e:1,c.sheetCols-n.col));return(0,i.range3DOper)(r.sheets,o)}return r}(d.length,h,m)),h);return p>=v.length?(0,a.isArrayOper)(m)?i.naErrorOper:i.blankOper:v.get(p)}var y=b(e,s);return l?y.get(y.rows-1,p):y.get(p,y.cols-1)},t.hlookup=function(e,t){return T(e,t,!0)},t.vlookup=function(e,t){return T(e,t,!1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timevalue=t.datevalue=t.value=t.dollar=t.fixed=t.text=void 0;var n=r(11),i=r(10),o=r(126),a=r(309),s=r(125),l=r(9),u=r(310),c=r(13),d=r(73),f=s.codePointSpace;function p(e,t,r,a){if(void 0===r||(0,l.isMissingOper)(r))return{formatValue:t,formatDecimals:null!=a?a:2};var s=e.config.mathpack;if(s.cond(r)<0){var u=(0,o.round)(e,[t,r]);return(0,i.assertTrue)("calc.funcs.fixedDollarRound",(0,l.isNumberOper)(u)||(0,l.isErrorOper)(u)),{formatValue:u,formatDecimals:0}}var c=s.sfix(r);return c<0||c>127?{formatValue:n.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:c}}function m(e){for(var t=0;t<e.length&&e.charCodeAt(t)===f;)t+=1;return e.substring(t)}function h(e,t){var r;return(0,l.isStringOper)(t)?t.value.length>255?n.valueErrorOper:null!==(r=e.parseDate(m(t.value)))&&void 0!==r?r:n.valueErrorOper:n.valueErrorOper}t.text=function(e,t){var r,o=t[0],a=t[1].value,s=(0,l.isRichOper)(o)?o.getFallback():o;if((0,l.isStringOper)(s)&&s.value.length>255||a.length>255)return n.valueErrorOper;switch(s.kind){case c.OperKind.String:var u=e.coerceOper(s,c.OperKind.Number);r=(0,l.isNumberOper)(u)?u:s;break;case c.OperKind.Number:r=s;break;case c.OperKind.Boolean:u=e.coerceOper(s,c.OperKind.String);(0,i.assertTrue)("calc.funcs.text",(0,l.isStringOper)(u)),r=u;break;case c.OperKind.Error:return n.valueErrorOper}var f=e.applyFormat(e.originSheet.document,a,r,d.NumberFormatSource.CustomString);return void 0!==f?(0,n.stringOper)(f):n.valueErrorOper},t.fixed=function(e,t){var r,i,o=t[0],s=t[1],c=t[2],f=p(e,o,s,void 0),m=f.formatValue,h=f.formatDecimals;if((0,l.isErrorOper)(m))return m;i=null!==(r=null==c?void 0:c.value)&&void 0!==r&&r?0===h?a.KnownFormat.NoComFixed0:2===h?a.KnownFormat.NoComFixed:(0,u.buildNumberFormat)(e.config.localeInfo,!1,1,h):0===h?a.KnownFormat.Fixed0:2===h?a.KnownFormat.Fixed:(0,u.buildNumberFormat)(e.config.localeInfo,!0,4,h);var g=e.applyFormat(e.originSheet.document,i,m,d.NumberFormatSource.CustomBytecode);return void 0!==g?(0,n.stringOper)(g):n.valueErrorOper},t.dollar=function(e,t){var r=t[0],i=t[1],o=e.config.localeInfo,s=p(e,r,i,o.isEastAsia?o.currencyDecimals:void 0),c=s.formatValue,m=s.formatDecimals;if((0,l.isErrorOper)(c))return c;var h=0===m?a.KnownFormat.Currency:2===m?a.KnownFormat.CurrencyDec:(0,u.buildCurrencyFormat)(o,!1,m,!0,!1),g=e.applyFormat(e.originSheet.document,h,c,d.NumberFormatSource.CustomBytecode);return void 0!==g&&g.length>0&&g.charCodeAt(g.length-1)===f?(0,n.stringOper)(g.substring(0,g.length-1)):void 0!==g?(0,n.stringOper)(g):n.valueErrorOper},t.value=function(e,t){var r=t[0];switch(r.kind){case c.OperKind.Boolean:return n.valueErrorOper;case c.OperKind.Number:return r;case c.OperKind.String:return r.value.length>255?n.valueErrorOper:e.coerceOper((0,n.stringOper)(m(r.value)),c.OperKind.Number)}},t.datevalue=function(e,t){var r=h(e,t[0]);return(0,l.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,t){var r=h(e,t[0]);return(0,l.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulatext=t.isformula=t.isodd=t.iseven=t.isomitted=t.islambda=t.isref=t.isnumber=t.istext=t.isnontext=t.isna=t.islogical=t.isblank=t.iserr=t.iserror=void 0;var n=r(11),i=r(9),o=r(14),a=r(35),s=r(20),l=r(53),u=r(54);function c(e,t){var r=t[0],o=(0,u.chkNumOper)(e,r);if((0,i.isErrorOper)(o))return o;var a=e.mathpack,s=(0,u.assertNumber)(a.add(a.abs(o),a.fromNumber(1.0000000000000003e-10))),l=(0,u.assertNumber)(a.div(a.floor(s),a.fromNumber(2)));return(0,n.booleanOper)(0===a.cond2(l,a.floor(l)))}function d(e,t,r){if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;var s=t.ranges[0];if(e.calcingArray||!(0,i.isGridCell)(s)){var l=t.sheets;return(0,n.arrayOper)(s.rows,s.cols,(0,a.jaggedArray)(s.rows,s.cols,(function(t,n){var i=(0,o.sheetGridCell)(l,(0,o.gridCell)(s.row+t,s.col+n));return r(e.getCellFormula(i),i)})))}var u=(0,i.sheetGridRangeAnchor)((0,o.sheetGridRange)(t.sheets,s));return r(e.getCellFormula(u),u)}t.iserror=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r))},t.iserr=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r)&&r.type!==n.ErrorType.NA)},t.isblank=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isBlankOper)(r))},t.islogical=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isBooleanOper)(r))},t.isna=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r)&&r.type===n.ErrorType.NA)},t.isnontext=function(e,t){var r=t[0];return(0,n.booleanOper)(!(0,i.isStringOper)(r))},t.istext=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isStringOper)(r))},t.isnumber=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isNumberOper)(r))},t.isref=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isRangeOper)(r))},t.islambda=function(e,t){var r=(0,s.refToVal)(e,t[0],!0);return(0,n.booleanOper)(r instanceof l.LambdaOper)},t.isomitted=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isMissingOper)(r))},t.iseven=c,t.isodd=function(e,t){var r=c(e,t);return(0,i.isBooleanOper)(r)?(0,n.booleanOper)(!r.value):r},t.isformula=function(e,t){return d(e,t[0],(function(e){return(0,n.booleanOper)(void 0!==e)}))},t.formulatext=function(e,t){var r=t[0];return d(e,r,(function(t,r){if(void 0===t)return n.naErrorOper;var i=e.printFormula(t,r.range);return t.source.kind===o.LexicalKind.Cell?(0,n.stringOper)(i):(0,n.stringOper)("{"+i+"}")}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=t.transpose=t.offset=t.sheet=t.sheets=t.column=t.row=t.columns=t.rows=t.areas=void 0;var n=r(11),i=r(9),o=r(14),a=r(21),s=r(10),l=r(35);function u(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;if(t.ranges.length>1)return n.refErrorOper;var r=t.ranges[0];return[r,(0,i.isGridCell)(r)]}t.areas=function(e,t){var r=t[0];return(0,i.isSheetIndex)(r.sheets)?e.mathpack.fromNumber(r.ranges.length):n.valueErrorOper},t.rows=function(e,t){var r=t[0],o=e.mathpack;return(0,i.isArrayOper)(r)?o.fromNumber(r.rows):(0,i.isSheetIndex)(r.sheets)?r.ranges.length>1?n.refErrorOper:o.fromNumber(r.ranges[0].rows):n.valueErrorOper},t.columns=function(e,t){var r=t[0],o=e.mathpack;return(0,i.isArrayOper)(r)?o.fromNumber(r.cols):(0,i.isSheetIndex)(r.sheets)?r.ranges.length>1?n.refErrorOper:o.fromNumber(r.ranges[0].cols):n.valueErrorOper},t.row=function(e,t){var r=u(e,t[0]);if(!Array.isArray(r))return r;var i=r[0],o=r[1],a=e.mathpack;return o?a.fromNumber(i.row+1):(0,n.arrayOper)(i.rows,1,(0,l.jaggedArray)(i.rows,1,(function(e){return a.fromNumber(i.row+e+1)})))},t.column=function(e,t){var r=u(e,t[0]);if(!Array.isArray(r))return r;var i=r[0],o=r[1],a=e.mathpack;return o?a.fromNumber(i.col+1):(0,n.arrayOper)(1,i.cols,(0,l.jaggedArray)(1,i.cols,(function(e,t){return a.fromNumber(i.col+t+1)})))},t.sheets=function(e,t){var r=t[0],a=e.mathpack;return r?(0,i.isArrayOper)(r)?n.naErrorOper:a.fromNumber(e.getSheetRangeIndexes(r.sheets).length):a.fromNumber(e.getSheetRangeIndexes((0,o.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,t){var r=t[0],o=e.mathpack;if(!r){var a=e.reflectionSheet;return void 0===a.index?n.naErrorOper:o.fromNumber(e.getSheetRangePosition(a)+1)}if((0,i.isStringOper)(r)){var l=e.getSheetIndex(e.reflectionSheet.document,r.value);return void 0===l?n.naErrorOper:o.fromNumber(e.getSheetRangePosition(l)+1)}return(0,i.isRangeOper)(r)?o.fromNumber(e.getSheetRangePosition(r.sheets)+1):(0,i.isArrayOper)(r)?n.naErrorOper:(0,s.assertNever)("calc.funcs.sheet",r)},t.offset=function(e,t){var r=t[0],s=t[1],l=t[2],u=t[3],c=t[4];if(!(0,i.isSheetIndex)(r.sheets))return n.valueErrorOper;if(1!==r.ranges.length)return n.valueErrorOper;var d=e.mathpack,f=r.ranges[0],p=f.row,m=f.col,h=f.rows,g=f.cols,v=p;(0,i.isNumberOper)(s)&&(v+=d.lfix(s));var S=m;(0,i.isNumberOper)(l)&&(S+=d.lfix(l));var y=v+h-1;if(void 0!==u&&(0,i.isNumberOper)(u)){if(0===(R=d.cond(u)))return n.refErrorOper;y=v+d.lfix(u)-(R>0?1:-1)}var C=S+g-1;if(void 0!==c&&(0,i.isNumberOper)(c)){var R;if(0===(R=d.cond(c)))return n.refErrorOper;C=S+d.lfix(c)-(R>0?1:-1)}var b=(0,a.fastMin)(v,y),N=(0,a.fastMin)(S,C),T=(0,a.fastMax)(v,y)-b+1,P=(0,a.fastMax)(S,C)-N+1;return b<0||N<0||b+T>o.sheetRows||N+P>o.sheetCols?n.refErrorOper:(0,n.rangeSeqOper)(r.sheets,[(0,o.gridRange)(b,N,T,P)])},t.transpose=function(e,t){var r=t[0];return(0,i.isArrayOper)(r)?(0,n.arrayOper)(r.cols,r.rows,(0,l.jaggedArray)(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},t.single=function(e,t){var r=t[0];if((0,i.isPrimitiveOper)(r)||(0,i.isMissingOper)(r)||(0,i.isBlankOper)(r)||(0,i.isRichOper)(r))return r;if((0,i.isArrayOper)(r))return r.opers[0][0];if(!(0,i.isSheetIndex)(r.sheets))return n.refErrorOper;if(1!==r.ranges.length)return n.valueErrorOper;var o=e.originGridCell,a=(0,i.gridCellImplicitIsect)(o,r.ranges[0]);return void 0===a?n.valueErrorOper:(0,n.rangeSeqOper)(r.sheets,[a])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.fieldvalue=void 0;var n=r(11),i=r(9),o=r(84),a=r(53);t.fieldvalue=function(e,t){var r=t[0],o=t[1].value;if((0,i.isRichOper)(r)){var a=r.getField(o);if(void 0!==a)return a}return n.fieldErrorOper},t.record=function(e,t){for(var r=t[0],n=e.config.localeInfo,i=o.RedBlackMapTree.create(n.stringCompareCI),s=1;s<t.length;s+=2){var l=t[s].value,u=t[s+1];i=i.setValue(l,u)}return new a.RecordOper(i,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.indirect=t.address=void 0;var n=r(11),i=r(14),o=r(62),a=r(311),s=r(9),l=r(28),u=r(10),c=r(86),d=r(16),f=r(13),p=r(12);t.address=function(e,t){var r=t[0],l=t[1],c=t[2],d=t[3],p=t[4],m=e.mathpack,h=(null==c?void 0:c.kind)===f.OperKind.Number?m.sfix(c)-1:0;if(h<0||h>3)return n.valueErrorOper;var g=0!=(1&h),v=0!=(2&h),S=(null==d?void 0:d.kind)!==f.OperKind.Boolean||d.value?o.RefStyle.A1:o.RefStyle.R1C1,y=function(e,t,r){return S===o.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},C=m.sfix(r);if(!y(v,i.sheetRows,C))return n.valueErrorOper;if(!(0,s.isNumberOper)(l))return n.valueErrorOper;var R=m.sfix(l);if(!y(g,i.sheetCols,R))return n.valueErrorOper;var b=(0,i.gridCell)(C<0?i.sheetRows-1:0,R<0?i.sheetCols-1:0),N=(0,o.pos)(v?o.PosKind.Rel:o.PosKind.Abs,S===o.RefStyle.R1C1&&v?C:C-1),T=(0,o.pos)(g?o.PosKind.Rel:o.PosKind.Abs,S===o.RefStyle.R1C1&&g?R:R-1),P=(0,a.formatCellPos)(e.config.localeInfo,S,b,N,T,!1);return(0,u.assertTrue)("calc.funcs.address: cell wrapped",void 0!==P),(null==p?void 0:p.kind)===f.OperKind.String?""===p.value?(0,n.stringOper)("!"+P):p.value.length>255?n.valueErrorOper:(0,n.stringOper)((0,a.formatQualifier)(e.config.localeInfo,e.config.refStyle,p.value)+"!"+P):(0,n.stringOper)(P)},t.indirect=function(e,t){var r,a=t[0].value,u=t[1],f=null===(r=null==u?void 0:u.value)||void 0===r||r?o.RefStyle.A1:o.RefStyle.R1C1;if(a.length>255||(0,c.stringStartsWith)(a," "))return n.valueErrorOper;var m=(0,i.originCell)(e.originSheet,e.originGridCell),h={lexicalKind:i.LexicalKind.Indirect,originGridCell:(0,d.success)(m.range),originSheet:(0,d.success)(m.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},g=e.parseFormula(f,m.range,h,"="+a);if(!(0,d.isSuccess)(g))return n.refErrorOper;for(var v=g.value.node,S=!1,y=!1;;){var C;if(!S&&v.kind===o.NodeKind.App&&(0,s.isOperatorNode)(v.head)&&v.head.id===l.OperatorId.Pound&&1===v.args.length&&(S=!0,v=v.args[0]),y||v.kind!==o.NodeKind.Name)return v.kind===o.NodeKind.CellRef?void 0===(C=e.getCellRef(v.qualifier,v.ref,m,!0))?n.refErrorOper:(0,s.isSheetIndex)(C.sheets)?S?(0,p.throwEvaluationError)((0,s.notImplemented)(["# operator in INDIRECT"])):C:n.refErrorOper:v.kind===o.NodeKind.StructRef?void 0===v.lhs||void 0===(C=e.getStructRef(v.lhs,v.rhs,m))||S?n.refErrorOper:C:n.refErrorOper;var R=e.getNameFormula(v.qualifier,v.whole,i.NameSource.Indirect);if(void 0===R)return n.refErrorOper;m=(0,i.originCell)(m.sheet,(0,i.gridCell)(0,0)),v=R[1],y=!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.substitute=t.search=t.replace=t.find=t.proper=t.upper=t.lower=t.unicode=t.code=t.unichar=t.char=t.clean=t.trim=t.rept=t.exact=t.concatenate=t.len=t.mid=t.left=t.right=void 0;var n=r(9),i=r(11),o=r(12),a=r(187),s=r(87),l=r(125),u=r(86),c=r(13),d=r(17),f=l.codePointSpace,p=l.codePointCapitalA,m=l.codePointCapitalZ,h=l.codePointSmallA,g=l.codePointSmallZ;function v(e,t){return void 0===t?1:e.cond(t)<0?i.valueErrorOper:e.sfix(t)}function S(e){return e>=p&&e<=m||e>=h&&e<=g}function y(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,o.throwEvaluationError)((0,n.notImplemented)([t+" for non-ASCII input"]))}t.right=function(e,t){var r,o=t[0].value,s=t[1];if(void 0!==s&&(0,n.isErrorOper)(s))return s;var l=v(e.mathpack,s);if("number"!=typeof l&&(0,n.isErrorOper)(l))return i.valueErrorOper;var u=null!==(r=(0,a.scanCodePointsBack)(o,o.length,l))&&void 0!==r?r:0;return(0,i.stringOper)(o.substring(u))},t.left=function(e,t){var r,o=t[0].value,s=t[1];if(void 0!==s&&(0,n.isErrorOper)(s))return s;var l=v(e.mathpack,s);if("number"!=typeof l&&(0,n.isErrorOper)(l))return i.valueErrorOper;var u=null!==(r=(0,a.scanCodePoints)(o,0,l))&&void 0!==r?r:o.length;return(0,i.stringOper)(o.substring(0,u))},t.mid=function(e,t){var r,n,o=t[0].value,s=t[1],l=t[2],u=e.mathpack,c=u.fix(s)-1,d=u.fix(l);if(u.cond(s)<0||c<0||u.cond(l)<0||d<0)return i.valueErrorOper;var f=null!==(r=(0,a.scanCodePoints)(o,0,c))&&void 0!==r?r:o.length,p=null!==(n=(0,a.scanCodePoints)(o,f,d))&&void 0!==n?n:o.length;return(0,i.stringOper)(o.substring(f,p))},t.len=function(e,t){var r=t[0].value;return e.mathpack.fromNumber((0,a.countCodePoints)(r,0,r.length))},t.concatenate=function(e,t){for(var r="",n=0;n<t.length;n+=1){var o=t[n].value;if(r.length+o.length>i.cellStringLimit){r+=o.substring(0,i.cellStringLimit-r.length);break}r+=o}return(0,i.stringOper)(r)},t.exact=function(e,t){var r=t[0],a=t[1];return((0,n.isRichOper)(r)||(0,n.isRichOper)(a))&&(0,o.throwEvaluationError)((0,n.notImplemented)(["EXACT rich argument"])),(0,i.booleanOper)(r.value===a.value)},t.rept=function(e,t){var r=t[0].value,n=t[1],o=e.mathpack,a=o.fix(n);return o.cond(n)<0||a>2147483647?i.valueErrorOper:""===r?d.emptyStringOper:a*r.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)((0,u.repeat)(r,a))},t.trim=function(e,t){for(var r=t[0].value,n="",o=0;o<r.length;){for(;o<r.length&&r.charCodeAt(o)===f;)o+=1;for(var a=o;o<r.length;){var s=r.charCodeAt(o)===f;if(o+=1,s)break}n+=r.substring(a,o)}return n.length>0&&n.charCodeAt(n.length-1)===f&&(n=n.substring(0,n.length-1)),(0,i.stringOper)(n)},t.clean=function(e,t){for(var r=t[0].value,n="",o=0;o<r.length;o+=1){var a=r.charCodeAt(o);(a>=256||(127&a)>=32)&&(n+=r.charAt(o))}return(0,i.stringOper)(n)},t.char=function(e,t){var r=t[0],n=e.mathpack.sfix(r);return n<1||n>255?i.valueErrorOper:(0,i.stringOper)(String.fromCharCode(n))},t.unichar=function(e,t){var r=t[0],n=e.mathpack,o=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||o>=1114112?i.valueErrorOper:o<=65535&&(0,a.isAnySurrogate)(o)||o>=64976&&o<=65007||(65535&o)>=65534?i.naErrorOper:(0,i.stringOper)((0,a.stringFromCodePoint)(o))},t.code=function(e,t){var r=t[0].value;if(0===r.length)return i.valueErrorOper;var a=r.charCodeAt(0);return a>255?(0,o.throwEvaluationError)((0,n.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(a)},t.unicode=function(e,t){var r=t[0].value;if(0===r.length)return i.valueErrorOper;var n=r.charCodeAt(0),o=e.mathpack;if(!(0,a.isAnySurrogate)(n))return o.fromNumber(n);if(1===r.length)return i.valueErrorOper;var s=r.charCodeAt(1),l=(0,a.surrogatePairToCodePoint)(n,s);return void 0===l?i.valueErrorOper:o.fromNumber(l)},t.lower=function(e,t){var r=t[0].value;return(0,i.stringOper)(y(r,"LOWER",r.toLowerCase.bind(r)))},t.upper=function(e,t){var r=t[0].value;return(0,i.stringOper)(y(r,"UPPER",r.toUpperCase.bind(r)))},t.proper=function(e,t){var r=t[0].value;return(0,i.stringOper)(y(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var i=n;n<e.length&&!S(e.charCodeAt(n));)n+=1;if(t+=e.substring(i,n),n===e.length)break;var o=n,s=(0,a.stringCodePointAt)(e,n);for(t+=(0,a.stringFromCodePoint)(s).toUpperCase(),n+=(0,a.numCodeUnits)(s);n<e.length&&S(e.charCodeAt(n));)n+=1;t+=e.substring(o+1,n)}return t})))},t.find=function(e,t){var r,n=t[0].value,o=t[1].value,s=t[2],l=void 0!==s?e.mathpack.sfix(s)-1:0;if(l<0||l>=2147483647)return i.valueErrorOper;var u=null!==(r=(0,a.scanCodePoints)(o,0,l))&&void 0!==r?r:o.length,c=o.indexOf(n,u);return c>=0?e.mathpack.fromNumber((0,a.countCodePoints)(o,0,c)+1):i.valueErrorOper},t.replace=function(e,t){var r,n,o=t[0].value,s=t[1],l=t[2],u=t[3].value,c=e.mathpack.sfix(s)-1;if(c<0||c>=i.cellStringLimit)return i.valueErrorOper;var d=e.mathpack.sfix(l);if(d<0||d>i.cellStringLimit)return i.valueErrorOper;var f=null!==(r=(0,a.scanCodePoints)(o,0,c))&&void 0!==r?r:o.length,p=null!==(n=(0,a.scanCodePoints)(o,f,d))&&void 0!==n?n:o.length,m=o.slice(0,f),h=o.slice(p);return m.length+u.length+h.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)(m+u+h)},t.search=function(e,t){var r,n=t[0].value,o=t[1].value,l=t[2],u=void 0!==l?e.mathpack.sfix(l)-1:0;if(u<0||u>=2147483647)return i.valueErrorOper;for(var c=null!==(r=(0,a.scanCodePoints)(o,0,u))&&void 0!==r?r:o.length,d=new s.WildExp(e.config.localeInfo,n,!0);c<o.length;c+=1)if(d.test(o.slice(c)))return e.mathpack.fromNumber((0,a.countCodePoints)(o,0,c)+1);return i.valueErrorOper},t.substitute=function(e,t){var r=t[0],o=t[1].value,a=t[2].value,s=t[3],l=r.value,u=1/0;if(void 0!==s){var d=e.coerceOper(s,c.OperKind.Number);if((0,n.isErrorOper)(d))return d;if((u=e.mathpack.sfix(d))<1||u>2147483646)return i.valueErrorOper}var f=o.length;if(f>0){for(var p="",m=0,h=0;u>=0&&-1!==(h=l.indexOf(o,h));)if((u-=1)===1/0||0===u){var g=l.slice(m,h);if(p.length+g.length+a.length>i.cellStringLimit)return i.valueErrorOper;p+=g,p+=a,m=h+=f}else h+=1;var v=l.slice(m);return p.length+v.length>i.cellStringLimit?i.valueErrorOper:(p+=v,(0,i.stringOper)(p))}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.today=t.now=t.randbetween=t.rand=void 0;var n=r(11),i=r(54),o=r(9),a=r(190);t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,t){var r=t[0],a=t[1],s=(0,i.chkNumOper)(e,r),l=(0,i.chkNumOper)(e,a);if((0,o.isErrorOper)(s))return s;if((0,o.isErrorOper)(l))return l;var u=e.mathpack;if(u.cond2(s,l)>0)return n.numErrorOper;var c=e.getRandom(),d=u.ceil(s),f=u.floor(l),p=u.sub(f,d);return(0,o.isErrorOper)(p)?p:u.add(u.floor((0,i.assertNumber)(u.mul((0,i.assertNumber)(u.add(p,u.one)),c))),d)},t.now=function(e,t){return e.getTime(a.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(a.TimeGranularity.Day)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=void 0,t.hyperlink=function(e,t){var r=t[0],n=t[1];return e.followHyperlinks?r:null!=n?n:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;var n=r(127),i=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,i){(0,n.watchdog)("wd0x1a9bd3");var o;if(o=e.cell_both_absolute.exec(t)){var a=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a,s,0]}if((0,n.watchdog)("wd0xa26bda"),o=e.cell_col_absolute.exec(t)){a=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a,s-i,0]}if((0,n.watchdog)("wd0x2a23e1"),o=e.cell_row_absolute.exec(t)){a=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a-r,s,0]}if((0,n.watchdog)("wd0x3ebc91"),o=e.cell_both_relative.exec(t)){a=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>=""&&(s=Number(o[2].charCodeAt(0)-16384)),[a-r,s-i,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var i=e.cell_dependency(t,0,0),o=e.cell_dependency(r,0,0),a="R",s="C";n&&(a="",s="");var l=[];o.forEach((function(e,t,r){l.push(e-i[t])}));var u="";return e.cell_both_absolute.exec(r)?u=a+o[1]+s+o[0]:e.cell_col_absolute.exec(r)?(0===l[1]?u+=a:u+=a+"["+l[1]+"]",u+=s+o[0]):e.cell_row_absolute.exec(r)?(0===l[0]?u+=s:u+=s+"["+l[0]+"]",u=a+o[1]+u):(0===l[1]?u+=a:u+=a+"["+l[1]+"]",0===l[0]?u+=s:u+=s+"["+l[0]+"]"),u},e.formulaToR1C1=function(t,r,n){for(var i,o=t.slice(),a=e.column_index_to_name(r)+n;i=e.range_pair.exec(o);)if(i){var s=i[1];i[2];o=o.replace(i[0],e.toR1C1(a,i[1],!0)+":"+e.toR1C1(a,i[2],!0))}for(var l=null;l=e.single_dep.exec(o);)if(l){s=l[1];o=o.replace(l[0],e.toR1C1(a,s,!0))}return o=(o=o.replace(//g,"R")).replace(//g,"C")},e.extract_sheet_cell=function(t){(0,n.watchdog)("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,i,o){void 0===o&&(o=!0),(0,n.watchdog)("wd0x2f82fe");var a=null,s=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");a=e.range_pair.exec(t);)if((0,n.watchdog)("wd0x784918"),a){for(var l=a[1],u=e.cell_dependency(l,r,i),c=a[2],d=e.cell_dependency(c,r,i),f=d[0]-u[0]+1,p=d[1]-u[1]+1,m=0;m<f;m++)for(var h=0;h<p;h++)s.push([m+u[0],h+u[1],0]);t=t.replace(a[0],"_")}for(var g=null;g=e.single_dep.exec(t);)if((0,n.watchdog)("wd0x0fb232"),g){l=g[1];var v=e.cell_dependency(l,r,i);s.push(v),t=t.replace(g[0],"_")}if(o)for(var S=null;S=e.number_dep.exec(t);)(0,n.watchdog)("wd0xd82ed1"),S&&(s.push([0,0,1]),t=t.replace(S[0],"_"));return s},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var i=null;i=e.single_dep.exec(t);)i&&(t=t.replace(i[0],"_"));for(var o=null;o=e.number_dep.exec(t);)o&&(r.push(parseFloat(o)),t=t.replace(o[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,i,o,a){(0,n.watchdog)("wd0x961028");var s=[];if(t>=a.length||r>=a[0].length||t<0||r<0)return[];var l=a[t][r];return l.length>1&&"="===l[0]&&(s=e.all_cell_dependencies(l,o,i)),s},e.generate_all_references=function(t,r,i){(0,n.watchdog)("wd0x6a6002");for(var o={},a=0;a<t.length;a++)for(var s=t[a],l=0;l<s.length;l++){(0,n.watchdog)("wd0x93d412");var u=s[l];if("="===u[0])for(var c=0,d=e.all_cell_dependencies(u,0,0);c<d.length;c++){var f=d[c];if((0,n.watchdog)("wd0x8a466e"),0===f[0]&&0===f[1]&&0!==f[2]);else{var p=f[0]-r-1,m=f[1]-i-1,h=!1;if(m>=t.length||p>=t[0].length||p<0||m<0)h=!0;else{var g=t[m][p];void 0!==g&&"="!==g[0]&&(h=!0)}h&&(o[f.join(",")]=!0)}}}return o},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepeatedTaskScheduler=t.TaskKind=void 0;var n,i,o=r(206),a=r(88),s=r(129);function l(e,t){return{kind:e,handle:t}}function u(e){return void 0!==e?(e.kind=n.NoWorkScheduled,e.handle=void 0,e):l(n.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(n||(n={})),(0,a.staticAssertExtends)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(i=t.TaskKind||(t.TaskKind={}));var c=Promise.resolve(),d=function(){function e(e,t){void 0===t&&(t=s.defaultSetTimeoutInterface);var r=this;this.timer=t,this.handleState=u(),this.clearHandleClosureAndRunBody=function(){var t;switch(r.handleState.kind){case n.NoWorkScheduled:t=i.Sync;break;case n.PromiseScheduled:t=i.MicroTask;break;case n.ImmediateScheduled:case n.FutureScheduled:t=i.MacroTask;break;default:(0,o.assertNever)("Unknown handle state",r.handleState)}r.handleState=u(r.handleState),e(t)},this.promiseClosure=function(){r.handleState.kind===n.PromiseScheduled&&r.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case n.PromiseScheduled:return;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=n.PromiseScheduled,e.handle=void 0,e):l(n.PromiseScheduled,void 0),c.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case n.ImmediateScheduled:return;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=n.ImmediateScheduled,t.handle=e,t):l(n.ImmediateScheduled,e))},e.prototype.runNextInFuture=function(e){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=n.FutureScheduled,r.handle=t,r):l(n.FutureScheduled,t))},e.prototype.clear=function(){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=u(this.handleState)},e}();t.RepeatedTaskScheduler=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(2);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineQueueProcessor=t.defaultTimerInterface=void 0;var n=r(0),i=r(88),o=r(208),a=r(129),s=r(205);t.defaultTimerInterface=n.__assign(n.__assign({},a.defaultSetTimeoutInterface),{now:i.now});var l=function(){function e(e,r,n,i){void 0===i&&(i=t.defaultTimerInterface);var a,l,u=this;this.cmp=e,this.consumeMessage=r,this.timer=i,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new o.PriorityQueue((function(t,r){var n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=null!==(a=null==n?void 0:n.costThreshold)&&void 0!==a?a:1,this.timeThreshold=null!==(l=null==n?void 0:n.timeThreshold)&&void 0!==l?l:10,this.scheduler=new s.RepeatedTaskScheduler((function(e){u.totalSyncCost=0,u.lastFutureAbsoluteTime=void 0,e===s.TaskKind.MacroTask&&(u.startTime=void 0),u.continue()}),i)}return e.prototype.enqueue=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.push=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.pop=function(){var e;return 1===this.queue.getCount()&&this.scheduler.clear(),null===(e=this.queue.pop())||void 0===e?void 0:e.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var e;for(this.startTime=null!==(e=this.startTime)&&void 0!==e?e:this.now();this.totalSyncCost<this.costThreshold;){var t=this.queue.peek();if(void 0===t)return;if(t.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(t.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=t.abstractCost,this.consumeMessage(t.payload)}var r=this.queue.peek();if(void 0!==r){var n=this.now();n-this.startTime<this.timeThreshold&&r.delayUntil<=n?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(r.delayUntil,n)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}();t.TimelineQueueProcessor=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(2);t.PriorityQueue=n.priorityQueue.PriorityQueue},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(316);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},function(e,t,r){r(211),r(212),e.exports=r(347)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,i=void 0,o=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(i?i(p):S())},a="undefined"!=typeof window?window:void 0,s=a||{},l=s.MutationObserver||s.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(p,1)}}var f=new Array(1e3);function p(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var m,h,g,v,S=void 0;function y(e,t){var r=this,n=new this.constructor(b);void 0===n[R]&&F(n);var i=r._state;if(i){var a=arguments[i-1];o((function(){return I(i,n,a,r._result)}))}else O(r,n,e,t);return n}function C(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(b);return T(t,e),t}u?S=function(){return process.nextTick(p)}:l?(h=0,g=new l(p),v=document.createTextNode(""),g.observe(v,{characterData:!0}),S=function(){v.data=h=++h%2}):c?((m=new MessageChannel).port1.onmessage=p,S=function(){return m.port2.postMessage(0)}):S=void 0===a?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(p)}:d()}catch(e){return d()}}():d();var R=Math.random().toString(36).substring(2);function b(){}function N(t,r,n){r.constructor===t.constructor&&n===y&&r.constructor.resolve===C?function(e,t){1===t._state?E(e,t._result):2===t._state?k(e,t._result):O(t,void 0,(function(t){return T(e,t)}),(function(t){return k(e,t)}))}(t,r):void 0===n?E(t,r):e(n)?function(e,t,r){o((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?T(e,r):E(e,r))}),(function(t){n||(n=!0,k(e,t))}),e._label);!n&&i&&(n=!0,k(e,i))}),e)}(t,r,n):E(t,r)}function T(e,t){if(e===t)k(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)E(e,t);else{var r=void 0;try{r=t.then}catch(t){return void k(e,t)}N(e,t,r)}var n,i}function P(e){e._onerror&&e._onerror(e._result),A(e)}function E(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&o(A,e))}function k(e,t){void 0===e._state&&(e._state=2,e._result=t,o(P,e))}function O(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+1]=r,i[a+2]=n,0===a&&e._state&&o(A,e)}function A(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)n=t[a],i=t[a+r],n?I(r,n,i,o):i(o);e._subscribers.length=0}}function I(t,r,n,i){var o=e(n),a=void 0,s=void 0,l=!0;if(o){try{a=n(i)}catch(e){l=!1,s=e}if(r===a)return void k(r,new TypeError("A promises callback cannot return that same promise."))}else a=i;void 0!==r._state||(o&&l?T(r,a):!1===l?k(r,s):1===t?E(r,a):2===t&&k(r,a))}var _=0;function F(e){e[R]=_++,e._state=void 0,e._result=void 0,e._subscribers=[]}var M=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(b),this.promise[R]||F(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&E(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===C){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(e){a=!0,o=e}if(i===y&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===D){var s=new r(b);a?k(s,o):N(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?k(n,r):this._result[t]=r),0===this._remaining&&E(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;O(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),D=function(){function t(e){this[R]=_++,this._result=this._state=void 0,this._subscribers=[],b!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){T(e,t)}),(function(t){k(e,t)}))}catch(t){k(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return D.prototype.then=y,D.all=function(e){return new M(this,e).promise},D.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var i=e.length,o=0;o<i;o++)r.resolve(e[o]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},D.resolve=C,D.reject=function(e){var t=new this(b);return k(t,e),t},D._setScheduler=function(e){i=e},D._setAsap=function(e){o=e},D._asap=o,D.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=D},D.Promise=D,D.polyfill(),D},e.exports=n()},function(e,t){!function(e,t){"use strict";if(!e.setImmediate){var r,n,i,o,a,s=1,l={},u=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,r=function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[s]=i,r(s),s++},d.clearImmediate=f}function f(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0;t.fnv1a=function(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r,n){void 0===r&&(r=function(){return""}),void 0===n&&(n=function(){return 1});for(var i=[e],o=new Set(i),a=0;a<i.length;a+=1)for(var s=0,l=t(i[a]);s<l.length;s++){var u=l[s];o.has(u)||(o.add(u),i.push(u))}o.clear(),i.reverse();var c=new Map,d=[],f=new Map,p=[];i.forEach((function(e,i){var o=t(e).map((function(e){return c.get(e)}));if(o.some((function(e){return void 0===e})))throw new Error("Circular references in the tree");var a=o.map((function(e){return d[e]})),s=function(e){var t=f.get(e);return void 0!==t||(t=f.size,f.set(e,t)),t}(a.join("/")+"/"+r(e));if(d.push(s),void 0===p[s]){var l=a.map((function(e){return p[e]})),u=l.map((function(e){return e.size})).reduce((function(e,t){return e+t}),n(e)),m=l.map((function(e){return e.depth})).reduce((function(e,t){return Math.max(e,t)}),0)+1;p[s]={subtrees:[e],size:u,depth:m}}else p[s].subtrees.push(e);c.set(e,i)}));for(var m=0,h=p;m<h.length;m++){(y=h[m]).subtrees.reverse()}for(var g=new Array(i.length),v=0,S=p;v<S.length;v++){var y=S[v];g[g.length-c.get(y.subtrees[0])-1]=y}return g.filter((function(e){return void 0!==e}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0;var n=r(0);t.combinations=function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)return[[]];for(var i=t[0],o=t.slice(1),a=e.apply(void 0,o),s=[],l=0,u=i;l<u.length;l++)for(var c=u[l],d=0,f=a;d<f.length;d++){var p=f[d];s.push(n.__spreadArray([c],p,!0))}return s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var o={};return Object.keys(n).forEach((function(t){o[t]=e(n[t],r+1)})),o}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,i=null;if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,t))&&(n=o.offset,i=null!=o.offsetNode&&null!=o.offsetNode.parentElement&&"SPAN"===o.offsetNode.parentElement.nodeName?o.offsetNode.parentElement:o.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,t))&&(n=o.startOffset,i=null!=o.startContainer&&null!=o.startContainer.parentElement&&"SPAN"===o.startContainer.parentElement.nodeName?o.startContainer.parentElement:o.startContainer)}else try{var o;i=document.elementFromPoint(e,t),(o=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(i),a.setEndPoint("EndToStart",o),n=a.text.length}catch(e){return n}if(r)for(var s=!1;null!=i;)null===i.previousSibling&&null!==i.parentNode&&null!==i.parentNode.parentNode&&i.parentNode.parentNode.childNodes.length>1&&!s?(i=i.parentNode,s=!0):null!=(i=i.previousSibling)&&null!=i.textContent&&(n+=i.textContent.length,s&&(n+=1));else for(;null!=i;)null!=(i=i.previousSibling)&&null!=i.textContent&&(n+=i.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function i(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var o=e.childNodes,a=0;a<o.length&&t>=0;a+=1)t=i(o[a],t,r),n&&"DIV"===o[a].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var o=document.createRange();return i(e,t,(function(e,t){return o.setStart(e,t)})),i(e,r,(function(e,t){return o.setEnd(e,t)})),o.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function i(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=n(),r=e,o=t,a={},s=function(e,t,n){return function(e,t,r,n,o,a){i(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:a,marks:e},l=JSON.stringify(s);o(l)}(a,r,o,e,t,n)};return a.start=0,{mark:function(e){return function(e){return i(a,e,o)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var n=r(220),i={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return i},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,n.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),i=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(221),t),n.__exportStar(r(222),t)},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){n=e};t.isChangeGateEnabled=function(e){return!n||n.isChangeGateEnabled(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var i=n(),o=r;return{reset:function(e){null!=e&&(o=e),i=n()},stop:function(r){var a=n()-i,s=JSON.stringify({Target:o,Duration:a.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var n=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var i=!1,o=r.performance;try{o&&o.now&&o.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var a=0;a<e.length;a+=1){try{if(i){t.perfNow=!0;var s=Math.floor(100*o.now())%10;(s<0||s>9)&&(s=0);for(var l=0;l<s;l+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0;t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)};t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},function(e,t,r){"use strict";e.exports=r(229)()?globalThis:r(230)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(92);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(93);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),i=r(93);function o(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return(0,i.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),i=r(92);function o(e){for(var t,r,o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];o[l]=null===(t=e[l])||void 0===t?void 0:t.toString()}var u=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},u()),o)})),u}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n,i,o=r(46),a=r(130),s=(n=.4531024141007942,i=null!=Object({NODE_ENV:"production"}).BUILD_BUILDID?n:Math.random()*Date.now(),new a.JSF32(i));function l(e){return(0,o.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(s.next()*e))}t.randomFloat=function(){return s.next()},t.randomIndex=l,t.randomShuffled=function(e){return e.map((function(e){return[s.next(),e]})).sort((function(e,t){return e[0]<t[0]?-1:e[0]===t[0]?0:1})).map((function(e){return e[1]}))},t.randomElement=function(e){return e[l(e.length)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(64);function i(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}t.floorToPowerOf2=i;var o=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var i=e[0],o=e[1];return r.push([i,o,t+n])})),r.sort((function(e,r){var n=e[0],i=e[2],o=r[0],a=r[2],s=t.keyCompare(n,o);return 0!==s?s:i-a}));for(var i=[],o=void 0,a=0;a<r.length;a+=1){var s=r[a],l=s[0],u=s[1];void 0===o||0!==this.keyCompare(l,o)?(i.push([l,u]),o=l):i[i.length-1]=[l,u]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var r=t.RootPointer;r>=0&&r<this.keys.length;){var n=this.keyCompare(e,this.keys[r]);if(0===n)return r;n<0?r=s(r):n>0&&(r=l(r))}},e.prototype.ofSequence=function(r){var n=this,o=r.slice();o.sort((function(e,t){var r=e[0],i=t[0];return n.keyCompare(r,i)}));for(var a=new Array(o.length),u=new Array(o.length),c=function(e){var r=new Array(e);return function e(t,r,n,o){if(t>=r.length)return;var a=function(e){var t=i(e);if(t/2-1<=e-t)return t-1;return e-t/2}(o);r[t]=n+a,e(s(t),r,n,a),e(l(t),r,n+a+1,o-a-1)}(t.RootPointer,r,0,e),r}(o.length),d=0;d<o.length;d+=1){var f=o[c[d]],p=f[0],m=f[1];a[d]=p,u[d]=m}return new e(this.keyCompare,a,u)},e}();function a(e,t){var r=[];return function e(t,r,n){if(r<0||r>=t.keys.length)return;e(t,s(r),n),n.push([t.keys[r],t.values[r]]),e(t,l(r),n)}(e,t,r),r}function s(e){return 2*e+1}function l(e){return 2*e+2}t.ArrayMapTree=o,t.RootPointer=0,t.enumerateInOrder=a,t.enumerateKeysInOrder=function(e,t){return a(e,t).map((function(e){return e[0]}))}},function(e,t,r){"use strict";function n(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var i=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[n(this.front+t,r)]=this.values[n(this.front+t,e)];this.values.length=r,this.front=n(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[n(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=n(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[n(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(e){if(!(e<0||e>=this.count))return this.values[n(this.front+e,this.values.length)]},e.prototype.popBack=function(){var e=n(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=n(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[n(this.front+r,t)]))return!1}return!0},e}();t.Deque=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var n=r(64),i=r(29);function o(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,i.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)?n.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue:function(e,r){var o=this.keyToString(e),a=t(this.entries,o)?this.entries[o]:void 0;(0,i.isDefined)(a)?a.value=r:this.entries[o]=(0,n.entry)(e,r)},contains:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)},remove:function(e){var r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var o=this.keyToString(e),a=t(this.entries,o)?this.entries[o]:void 0;if((0,i.isDefined)(a))return a.value;var s=r();return delete this.entries[o],this.entries[o]=(0,n.entry)(e,s),s},forEach:function(e){for(var r in this.entries){var n=t(this.entries,r)?this.entries[r]:void 0;if((0,i.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}t.makeDictionary=o,t.makeStringDict=function(){return o(i.identity)},t.makeNumberDict=function(){return o((function(e){return String(e)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var n=r(29),i=r(135);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add:function(e){var t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],o=0;o<r.length;o+=1)if(this.keyEquals(e,r[o]))return;(0,i.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(var o=0;o<r.length;o+=1)if(this.keyEquals(e,r[o]))return!0;return(0,i.logCollisionKey)(e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[Number(r)].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),o=this.map[r];if((0,n.isNone)(o))return!1;var a=[],s=!1;return o.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,s=!0):a.push(r)})),this.map[r]=a,s||(0,i.logCollisionKey)(e),s}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var n=r(64),i=r(135),o=r(29);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount:function(){return this.nentries},getValue:function(e){var t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry:function(e){var t=this.keyToHash(e),r=this.map[t];if(!(0,o.isNone)(r)){for(var n=0;n<r.length;n+=1){var a=r[n];if(this.keyEquals(e,a.key))return a}(0,i.logCollisionKey)(e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,t){var r=this.keyToHash(e),o=this.map[r];if(null==o)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(var a=0;a<o.length;a+=1){var s=o[a];if(this.keyEquals(s.key,e))return void(s.value=t)}o.push((0,n.entry)(e,t)),this.nentries+=1,(0,i.logCollisionKey)(e)}},remove:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,o.isNone)(r))return!1;for(var n=[],a=!1,s=0;s<r.length;s+=1){var l=r[s];this.keyEquals(e,l.key)?(this.nentries-=1,a=!0):n.push(l)}return this.map[t]=n,a||(0,i.logCollisionKey)(e),a},getOrSetValue:function(e,t){var r=this.keyToHash(e),a=this.map[r];if((0,o.isNone)(a)){var s=t();return this.map[r]=[(0,n.entry)(e,s)],this.nentries+=1,s}for(var l=0;l<a.length;l+=1){var u=a[l];if(this.keyEquals(e,u.key))return u.value}var c=t();return a.push((0,n.entry)(e,c)),this.nentries+=1,(0,i.logCollisionKey)(e),c},forEach:function(e){var t=this;return Object.keys(this.map).every((function(r){return t.map[Number(r)].every((function(t){return e(t.key,t.value)}))}))},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var n=function(){function e(e){var t,r,n=this;this.buckets=e,this.createSampleCounts=function(){return new Array(n.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(t=function(e,t){return e-t},r=n.buckets.length,function(e){return i(n.buckets,0,r,e,t)})}return e.prototype.addSample=function(e){var t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e},e}();function i(e,t,r,n,i){for(var o=t,a=t+r-1;o<=a;){var s=o+(a-o>>>1),l=i(e[s],n);if(0===l)return s;l<0?o=s+1:a=s-1}return~o}t.Histogram=n,t.linearBuckets=function(e,t,r){for(var n=(t-e)/(r-1),i=[],o=e,a=0;a<r;o+=n,a+=1)i.push(o);return i},t.exponentialBuckets=function(e,t,r){for(var n=Math.log(e),i=(Math.log(t)-n)/(r-1),o=[],a=0,s=0;s<r;a+=i,s+=1)o.push(Math.exp(n+a));return o},t.binarySearch=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(133),i=function(){function e(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((function(t,r){var n=t[0],i=t[1],o=r[0],a=r[1],s=e(n,o);return 0!==s?s:i-a}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();t.PriorityQueue=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var n=r(0),i=r(134),o=r(63),a=function(e,t){var r,n,i=e[0],o=t[0];return r=String(i),n=String(o),r<n?-1:r>n?1:0},s={};var l=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push([i,e[i].id])}var o=function(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r];t+=String(i[0]),t+="\0",t+=String(i[1]),t+="\0"}return t}(t.sort(a)),l=s[o];return void 0===l&&(l={box:{},probabilities:{},depth:1},s[o]=l),l};function u(e){return Object.getOwnPropertyNames(e).length>0}var c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?d.apply(void 0,e):f.apply(void 0,e)};function d(e){return u(e)?{isSubspace:!0,bounds:e}:i.dense}function f(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];if(Object.prototype.hasOwnProperty.call(e,o)){t=!1;break}}return t?i.dense:{isSubspace:!0,bounds:e}}function p(e){return e.isSubspace?1:e.subspaceCount}var m=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:p(e)+p(t)}};function h(e,t){if(t===i.dense)return t;if(t.isSubspace){for(var r=!1,n=0,o=Object.keys(t.bounds);n<o.length;n++){var a=o[n];if(Object.prototype.hasOwnProperty.call(e,a)){r=!0;break}}if(!r)return i.dense}return{productOperations:e,root:t}}function g(e){return void 0===e?i.dense:e}var v={unzip:function(e){for(var t={},r={},n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a];if(s===i.empty)return i.empty;if(s===i.dense)continue;t[a]=s.setOperations,r[a]=s.root}}return h(t,c(r))},combineProduct:function(e,t,r,n){for(var o={},a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];if(Object.prototype.hasOwnProperty.call(e,l)){var u=n(e[l],e[l].top,g(t[l]),g(r[l]));if(u===i.empty)return i.empty;if(u===i.dense)continue;o[l]=u}}return o},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},i=0,o=t;i<o.length;i++){var a=o[i];if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a];n[a]=s}}return n},fromUntypedProduct:function(e,t,r){for(var n={},o=0,a=r;o<a.length;o++){var s=a[o],l=t[s];n[s]=(0,i.fromUntyped)(e[s],void 0!==l?l:i.dense)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=i.dense}return t}};function S(e,t,r){var n=v.combineProduct(e,t,r,i.unionUntyped);if(n===i.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function y(e,t,r){for(var n=0,o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(Object.prototype.hasOwnProperty.call(e,s)){var l=g(t[s]),u=g(r[s]),c=e[s];if(void 0===(n=(0,i.combineCmp)(n,(0,i.compareUntyped)(c,c.top,l,u))))return}}return n}t.createFromProduct=v.unzip.bind(v);var C,R=(C={},function(e,t,r){var o;if(t===C.left&&r===C.right)return C.res;C.left=t,C.right=r;var a,s=y(e,t.bounds,r.bounds);if(void 0!==s)return C.res=s<=0?r:t;for(var l=0,u=Object.keys(e);l<u.length;l++){var d=u[l];if(Object.prototype.hasOwnProperty.call(e,d)&&0!==(0,i.compareUntyped)(e[d],e[d].top,g(t.bounds[d]),g(r.bounds[d]))){if(void 0!==a)return C.res=void 0;a=d}}if(void 0!==a){var f=(0,i.unionUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(f===i.empty)return C.res=i.empty;if(f===i.dense){var p=t.bounds,m=a,h=(p[m],n.__rest(p,["symbol"==typeof m?m:m+""]));return C.res=c(h)}var v=n.__assign(n.__assign({},t.bounds),((o={})[a]=f,o));return C.res=c(v)}return C.res=void 0});function b(e,t,r){if(r===i.empty)return t;if(r===i.dense)return r;if(t===i.empty)return r;if(t===i.dense)return t;if(!t.isSubspace||!r.isSubspace)return m(t,r,S(e,t.bounds,r.bounds));var n=R(e,t,r);return void 0!==n?n:m(t,r,S(e,t.bounds,r.bounds))}function N(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var a=v.restrict.apply(v,n.__spreadArray([t.bounds],r,!1));if(t.isSubspace)return c(a);var s=N.apply(void 0,n.__spreadArray([e,t.left],r,!1));if(s===i.dense)return i.dense;var l=N.apply(void 0,n.__spreadArray([e,t.right],r,!1));return b(e,s,l)}function T(e,t,r){for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];if(t===i.empty||t===i.dense)return t;if(t.isSubspace){var s=v.restrict.apply(v,n.__spreadArray([t.bounds],o,!1));return c(s)}var l=k(e,r),u=l[0],d=l[1],f=O(e,t,u,d),p=f[0],m=f[1],h=T.apply(void 0,n.__spreadArray([e,p,u],o,!1)),g=T.apply(void 0,n.__spreadArray([e,m,d],o,!1));return b(e,h,g)}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var o=v.restrict.apply(v,n.__spreadArray([e.productOperations],t,!1));if(!u(o))return i.dense;var a=T.apply(void 0,n.__spreadArray([o,e.root,l(o)],t,!1));return a===i.empty?a:h(o,a)}function E(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var o=v.restrict.apply(v,n.__spreadArray([e.productOperations],t,!1)),a=N.apply(void 0,n.__spreadArray([o,e.root],t,!1));return a===i.empty?a:h(o,a)}function k(e,t){var r,o,a,s;if(void 0!==t.children)return t.children;for(var l,u,c=t.box,d=t.probabilities,f=0,p=0,m=Object.keys(e);p<m.length;p++){var h=m[p];if(Object.prototype.hasOwnProperty.call(e,h)){var v=d[h],S=e[h];if(void 0===v){l=h,u=S.top;break}if(v>f){var y=g(c[h]);if(y===i.empty)throw new Error("the key split can never return empty");var C=S.top;if(y!==i.dense){if(!y.isExact)throw new Error("the key can always be represented exactly");C=y.key}if(!S.canSplit(C))continue;l=h,f=v,u=C}}}if(void 0===l||void 0===u)throw new Error("there has to be at least one dimension");var R=e[l],b=R.split(u),N=b[0],T=N[0],P=N[1],E=b[1],k=E[0],O=E[1],A=[{box:n.__assign(n.__assign({},c),(r={},r[l]=(0,i.lazy)(R,R.top,T),r)),probabilities:n.__assign(n.__assign({},d),(o={},o[l]=P,o)),depth:t.depth+1},{box:n.__assign(n.__assign({},c),(a={},a[l]=(0,i.lazy)(R,R.top,k),a)),probabilities:n.__assign(n.__assign({},d),(s={},s[l]=O,s)),depth:t.depth+1}];return t.depth<10&&(t.children=A),A}t.project=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?P.apply(void 0,e):E.apply(void 0,e)};var O=function(e,t,r,n){return function e(t,r,n,o){if(r===i.empty)return[i.empty,i.empty];if(r===i.dense)return[c(n),c(o)];var a=y(t,r.bounds,n);if(void 0!==a&&a<=0)return[r,i.empty];var s=v.combineProduct(t,r.bounds,n,i.intersectUntyped);if(s===i.empty)return[i.empty,r];var l=v.combineProduct(t,r.bounds,o,i.intersectUntyped);if(r.isSubspace)return[c(s),l===i.empty?i.empty:c(l)];var u=e(t,r.left,n,o),d=u[0],f=u[1],p=e(t,r.right,n,o),m=p[0],h=p[1];return[b(t,d,m),b(t,f,h)]}(e,t,r.box,n.box)};function A(e,t,r,n,o){var a=k(e,n),s=a[0],l=a[1],u=O(e,t,s,l),c=u[0],d=u[1],f=O(e,r,s,l),p=f[0],m=f[1],h=o(e,c,p,s);return h===i.dense?i.dense:b(e,h,o(e,d,m,l))}function I(e,t,r,n){if(r===i.empty)return t;if(t===i.empty)return r;if(t===i.dense)return t;if(r===i.dense)return r;if(t.isSubspace&&r.isSubspace){var o=R(e,t,r);if(void 0!==o)return o}return A(e,t,r,n,I)}function _(e,t){if(t===i.empty)return e;if(t===i.dense)return t;if(e===i.empty)return t;if(e===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=I(r,e.root,t.root,l(r));return o===i.empty?o:h(r,o)}function F(e,t,r,n){if(t===i.empty||r===i.empty)return i.empty;if(t===i.dense)return r;if(r===i.dense)return t;if(t.isSubspace&&r.isSubspace){var o=v.combineProduct(e,t.bounds,r.bounds,i.intersectUntyped);return o===i.empty?i.empty:c(o)}return A(e,t,r,n,F)}function M(e,t,r,o){if(t===i.empty)return t;if(r===i.dense)return i.empty;if(r===i.empty)return t;if(t===i.dense)return A(e,t,r,o,M);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var o,a,s=y(e,t.bounds,r.bounds);if(0===s||-1===s)return i.empty;for(var l=0,u=Object.keys(e);l<u.length;l++){var d=u[l];if(Object.prototype.hasOwnProperty.call(e,d)){var f=(0,i.compareUntyped)(e[d],e[d].top,g(t.bounds[d]),g(r.bounds[d]));if(void 0===f||f>0){if(void 0!==a)return;a=d}}}if(void 0!==a){var p=(0,i.exceptUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(p===i.empty)return i.empty;if(p===i.dense){var m=t.bounds,h=a,v=(m[h],n.__rest(m,["symbol"==typeof h?h:h+""]));return c(v)}var S=n.__assign(n.__assign({},t.bounds),((o={})[a]=p,o));return c(S)}}(e,t,r);if(void 0!==a)return a}return A(e,t,r,o,M)}function D(e,t){if(e===i.empty)return e;if(t===i.empty)return e;if(t===i.dense)return i.empty;if(e===i.dense){var r=M(t.productOperations,i.dense,t.root,l(t.productOperations));return r===i.empty?r:h(t.productOperations,r)}var o=n.__assign(n.__assign({},e.productOperations),t.productOperations),a=M(o,e.root,t.root,l(o));return a===i.empty?a:h(o,a)}function w(e,t,r,n){if(t===i.empty||r===i.empty)return!1;if(t===i.dense||r===i.dense)return!0;if(!function(e,t,r){for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(Object.prototype.hasOwnProperty.call(e,a)){var s=g(t[a]),l=g(r[a]),u=e[a];if(!(0,i.meetsUntyped)(u,u.top,s,l))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var o=k(e,n),a=o[0],s=o[1],l=O(e,t,a,s),u=l[0],c=l[1],d=O(e,r,a,s),f=d[0],p=d[1];return w(e,u,f,a)||w(e,c,p,s)}t.unionProduct=_,t.intersectProduct=function(e,t){if(e===i.empty)return e;if(t===i.empty)return t;if(e===i.dense)return t;if(t===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=F(r,e.root,t.root,l(r));return o===i.empty?o:h(r,o)},t.exceptProduct=D,t.compareProduct=function(e,t){if(e===t)return 0;if(e===i.empty)return-1;if(t===i.empty)return 1;if(e===i.dense)return t===i.dense?0:1;if(t===i.dense)return-1;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return function e(t,r,n,o){if(r===n)return 0;if(r===i.empty)return-1;if(n===i.empty)return 1;if(r===i.dense)return n===i.dense?0:1;if(n===i.dense)return-1;if(r.isSubspace&&n.isSubspace)return y(t,r.bounds,n.bounds);var a=k(t,o),s=a[0],l=a[1],u=O(t,r,s,l),c=u[0],d=u[1],f=O(t,n,s,l),p=f[0],m=f[1],h=e(t,c,p,s);return void 0!==h?(0,i.combineCmp)(h,e(t,d,m,l)):void 0}(r,e.root,t.root,l(r))},t.meetsProduct=function(e,t){if(e===i.empty||t===i.empty)return!1;if(e===i.dense||t===i.dense)return!0;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return w(r,e.root,t.root,l(r))};t.complementProduct=function(e){return D(i.dense,e)};t.symmetricDiffProduct=function(e,t){return _(D(e,t),D(t,e))},t.getSubspaces=function(e){if(e===i.empty||e===i.dense)return[];var t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,r){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s=t.project.apply(void 0,n.__spreadArray([e],o,!1));if(s===i.empty)return!0;if(s===i.dense)return r(v.denseProduct(o));var l=s.productOperations,u=s.root;function c(e){return e.isSubspace?r(v.fromUntypedProduct(l,e.bounds,o)):c(e.left)&&c(e.right)}return c(u)},t.getSubspaceCount=function(e){return e===i.empty||e===i.dense?0:p(e.root)};var L=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),x=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function B(e,t){return function(r,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s=t.get(r);void 0===s?(e.apply(void 0,n.__spreadArray([r,i],o,!1)),t.set(r,t.size)):i.push("__cached__",s)}}function U(e,t){return function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if("__cached__"===r.pick()){r.pop();var a=r.pop();return t[a]}var s=e.apply(void 0,n.__spreadArray([r],i,!1));return t.push(s),s}}var G=function(){function e(t){var r,n,o,a,s=this;for(var l in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new x,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==i.empty&&e!==i.dense){var r=e,n=s.getDims(r.productOperations);t.push(n),s.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===i.empty||t===i.dense)return t;e.putBack(t);for(var r={},n=e.pop(),o=0,a=n;o<a.length;o++){var l=a[o],u=s.globalProductOperations[l];r[l]=u}return{productOperations:r,root:s.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(s.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(s.serializers[n].serializeBound(null==t?void 0:t.supremum));var o=e.normalizeKey(null==t?void 0:t.key);r.push(s.serializers[n].serializeKey(o));for(var a=0,l=[null==t?void 0:t.left,null==t?void 0:t.right];a<l.length;a++){var u=l[a];null==u||u===i.empty||u===i.dense?r.push(u):(r.push("us"),s.serializeUntypedSparseCached(u,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=s.serializers[t].deserializeBound(e.pop()),i=s.serializers[t].deserializeBound(e.pop()),o=s.serializers[t].deserializeKey(e.pop()),a=["left","right"].map((function(r){var n=e.pop();return"us"===n?s.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:i,isExact:r,key:o,left:a[0],right:a[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,i=r;n<i.length;n++){var o=i[n],a=e.bounds[o];s.serializeUntypedSparseCached(a,t,o)}e.isSubspace||(s.serializeUntypedSparseProductCached(e.left,t,r),s.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},i=0,o=t;i<o.length;i++){var a=o[i],l=s.deserializeUntypedSparseCached(e,a);n[a]=l}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:s.deserializeUntypedSparseProductCached(e,t),right:s.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=B(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=U(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=B(this.serializeProductSet,this.cached),this.deserializeProductSetCached=U(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=B(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=U(this.deserializeUntypedSparseProduct,this.cache),t){var u={serializeKey:null!==(r=t[l].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[l].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(o=t[l].serializeBound)&&void 0!==o?o:function(e){return JSON.stringify(e)},deserializeBound:null!==(a=t[l].deserializeBound)&&void 0!==a?a:function(e){return JSON.parse(e)}};this.serializers[l]=u}}return e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var i=n[r];this.serializeProductSetCached(i,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new L(JSON.parse(e)),r=t.pop(),n=[],i=0;i<r;i+=1){var o=this.deserializeProductSetCached(t);n.push(o)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=n.__assign({},e);return delete t.depth,delete t.split,t}return e},e}();t.ProductSetSerializer=G,t.productSetSerializer=function(e){return new G(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(137),i=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(n.emptyUntyped,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=(0,n.findUntyped)(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return(0,n.findUntyped)(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return(0,n.forEachUntyped)(e,this.root)},e.prototype.setValue=function(t,r){return new e((0,n.insertUntyped)(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e((0,n.removeUntyped)(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var i=this.getValue(t);if(void 0!==i)return[this,i];var o=r();return[new e((0,n.insertUntyped)(this,t,o,this.root),this.count+1,this.keyCompare),o]},e.prototype.filter=function(t){var r=this,i=n.emptyUntyped,o=0;return this.forEach((function(e,a){return t(e,a)&&(i=(0,n.insertUntyped)(r,e,a,i),o+=1),!1})),new e(i,o,this.keyCompare)},e}();t.RedBlackMapTree=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var n=function(){function e(e){void 0===e&&(e=1/0),this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return 0===this.counter},e.prototype.enqueue=function(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}},e.prototype.executeOnEveryElement=function(e){for(var t=0;t<this.counter;t++){var r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n)if(!e(n))return!1}return!0},e}();t.RingBuffer=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n,i=r(0),o=r(29),a=r(64);function s(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var i=e.slice(0,-1);return t<e.length-1&&(i[t]=e[e.length-1]),i}function l(e,t,r){return{kind:e,key:t,value:r}}function u(e,t){return l(n.Ptr,e,t)}function c(e,t){return l(n.Leaf,e,t)}function d(e,t){return l(n.Branch,e,t)}t.copyExcept=s,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(n=t.RTKind||(t.RTKind={}));var f=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,i,o){void 0===o&&(o=2);var a=o>1?Math.ceil(o):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:i,minChildren:a,maxChildren:2*a,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,i){var o=r.keyCompare(i.key,e);if(i.kind===n.Ptr)return 0===o?i.value:void 0;if(!(void 0===o||o<0))for(var a=0,s=i.value;a<s.length;a++){var l=t(r,s[a]);if(void 0!==l)return l}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:(0,a.entry)(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var i=S(this.lattice,this.root,t,n,r);return void 0!==i?i===this.root?this:new e(this.lattice,i,this.count):new e(this.lattice,v(this.lattice,this.root,u(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==S(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return p(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var i=[],a=this.lattice,l=function(e,r){var u=a.keyCompare(e.key,t);if(void 0===u||u<0)return(0,o.pair)(e,1);if(e.kind===n.Leaf){for(var f=e.value,p=0;p<f.length;p+=1)if(0===a.keyCompare(f[p].key,t)){if((y=s(f,p)).length<r){var m=c(e.key,y);return i.push(m),(0,o.pair)(m,3)}return(0,o.pair)(c(h(a,y),y),2)}}else for(f=e.value,p=0;p<f.length;p+=1){var g=l(f[p],a.minChildren),v=g[0],S=g[1];if(3===S){var y;if((y=s(f,p)).length>=r)return(0,o.pair)(d(h(a,y),y),2);m=d(e.key,y);return i.push(m),(0,o.pair)(m,3)}if(2===S)return(0,o.pair)(d(e.key,s(f,p,v)),2)}return(0,o.pair)(e,1)},f=this.root.kind===n.Leaf?1:2,m=l(this.root,f),g=m[0],S=m[1];if(g===this.root)return this;for(var y=3===S?void 0:g,C=0;C<i.length;C+=1)p(i[C],(function(e,t){return y=v(r.lattice,y,u(e,t)),!0}));return new e(this.lattice,y,this.count-1)},e}();function p(e,t,r,i){var o=void 0!==r?r:function(){return!0},a=void 0!==i?i:function(){return!0};if(null==e)return!0;var s=function(e){if(!o(e.key))return!0;if(e.kind===n.Leaf)for(var r=e.value,i=0;i<r.length;i+=1){var l=r[i];if(a(l.key)&&!t(l.key,l.value))return!1}else for(r=e.value,i=0;i<r.length;i+=1)if(!s(r[i]))return!1;return!0};return s(e)}function m(e,t){for(var r=function(e,t){for(var r=0,n=1,i=e.keyDistance(t[0].key,t[1].key),a=2;a<t.length;a+=1)for(var s=0;s<a;s+=1){var l=e.keyDistance(t[s].key,t[a].key);l>i&&(r=s,n=a,i=l)}return(0,o.pair)(r,n)}(e,t),n=r[0],i=r[1],a=t[n].key,s=t[i].key,l=[],u=0;u<t.length;u+=1){var c=t[u];l.push([c,e.keyDistance(a,c.key)-e.keyDistance(s,c.key)])}l.sort((function(e,t){return e[1]-t[1]}));for(var d=e.minChildren;d<t.length-e.minChildren&&l[d][1]<0;d+=1);var f=[],p=[];for(u=0;u<d;u+=1)f.push(l[u][0]);for(u=d;u<t.length;u+=1)p.push(l[u][0]);return(0,o.pair)(f,p)}function h(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function g(e,t,r){var n=m(e,r),i=n[0],a=n[1];return(0,o.pair)(l(t,h(e,i),i),l(t,h(e,a),a))}function v(e,t,r){if(null==t)return c(r.key,[r]);var a=function t(a){if(a.kind===n.Leaf){var s=i.__spreadArray(i.__spreadArray([],a.value,!0),[r],!1);if(s.length>e.maxChildren){var l=g(e,a.kind,s),u=l[0],f=l[1];return(0,o.pair)(c(u.key,u.value),f)}return(0,o.pair)(c(e.keyJoin(a.key,r.key),s),void 0)}var p=a.value.slice(),m=function(e,t,r){for(var n=0,i=e.keyDistance(t[0].key,r),o=t[0].value.length,a=1;a<t.length;a+=1){var s=t[a],l=e.keyDistance(s.key,r);(l<i||l===i&&s.value.length<o)&&(n=a,i=l,o=s.value.length)}return n}(e,p,r.key),h=t(p[m]),v=h[0],S=h[1];if(p[m]=v,null!=S&&(p.push(S),p.length>e.maxChildren)){var y=g(e,a.kind,p),C=y[0];f=y[1];return(0,o.pair)(d(C.key,C.value),f)}return(0,o.pair)(d(e.keyJoin(a.key,r.key),p),void 0)}(t),s=a[0],l=a[1];return null!=l?d(e.keyJoin(s.key,l.key),[s,l]):s}function S(e,t,r,i,o){if(void 0!==t)return function t(i){if(i.kind!==n.Leaf)for(o=0;o<i.value.length;o+=1){l=i.value[o];if(e.keyMeets(l.key,r))if(void 0!==(u=t(l)))return d(i.key,s(i.value,o,u))}else for(var o=0;o<i.value.length;o+=1){var l,u;if(void 0!==(u=a(l=i.value[o])))return c(i.key,s(i.value,o,u))}}(t);function a(t){if(0===e.keyCompare(t.key,r))return void 0!==o&&t.value!==o&&i(t.value)?u(t.key,o):t}}t.RTree=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var n=r(29),i=r(136);function o(e,t,r){var n=Math.pow(t,e),i=1-Math.pow(t/r,e),o=Math.pow(r,e),a=o*n,s=o-n,l=-1/e;return{cdf:1===e?function(e){return(1-n/e)/i}:function(t){return(1-n*Math.pow(t,-e))/i},invCdf:1===e?function(e){return 1/((o-e*s)/a)}:function(e){return Math.pow((o-e*s)/a,l)}}}function a(e,t,r){var i=o(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],o=i.cdf(r),a=i.cdf(t+1),s=i.invCdf((o+a)/2),l=(0,n.fastMin)((0,n.fastMax)(Math.round(s),t+1),r-1);return[[[t,l],i.cdf(l)-i.cdf(t+1)],[[l,r],i.cdf(r)-i.cdf(l)]]}}}t.boundedPareto=o,t.boundedParetoSplitter=a,t.boundedParetoSetOperations=function(e,t,r,o,s){var l=a(e,t,r);return{id:s,split:function(e){return l.split(e)},canSplit:function(e){return l.canSplit(e)},meets:i.ivlMeets,intersect:i.ivlMeet,union:function(e,t){return(0,i.ivlMeetsOrTouches)(e,t)?(0,i.ivlJoin)(e,t):void 0},except:i.ivlExcept,compare:i.ivlCompare,top:o,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return(0,n.fastMin)(e,t)},combineSuprema:function(e,t){return(0,n.fastMax)(e,t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.strictArray2D=t.StrictArray2D=void 0;var n=r(46),i=r(29),o=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);var i=r.length;i<e&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(e,"; given ").concat(i));for(var o=0;o<i;o+=1){var a=r[o].length;a<t&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(o,"].length >= ").concat(e,"; given ").concat(a))}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new s(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();t.StrictArray2D=o,t.strictArray2D=function(e,t,r){return new o(e,t,r)};var a=function(){function e(e,t,r,i,o,a){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",i,t+1);var s=o.length;s<r&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(r,"; given ").concat(s));for(var l=0;l<s;l+=1){var u=o[l].length;u<i&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(l,"].length >= ").concat(i,"; given ").concat(u))}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseElements=o,this.sparseElement=a}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new l(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}();t.StrictSparseArray2D=a;var s=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=u(this.rows,this.cols,this.func);return new o(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}();t.NonstrictArray2D=s;var l=function(){function e(e,t,r,i,o,a){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",i,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseFunc=o,this.sparseFunc=a}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=u(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new a(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function u(e,t,r){for(var n=[],i=0;i<e;i+=1){for(var o=[],a=0;a<t;a+=1)o[a]=r(i,a);n[i]=o}return n}function c(e,t,r){for(var n=[],i=[],o=0;o<t;o+=1)i[o]=r;for(var a=0;a<e;a+=1)n[a]=i;return n}function d(e,t,r){return new s(e,t,(function(e,t){return r}))}t.NonstrictSparseArray2D=l,t.array2DForall=function(e,t){for(var r=0;r<t.rows;r+=1)for(var n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){for(var n=(0,i.fastMin)(t.rows,r.rows),o=(0,i.fastMin)(t.cols,r.cols),a=0;a<n;a+=1)for(var s=0;s<o;s+=1)if(!e(t.get(a,s),r.get(a,s)))return!1;return!0},t.jaggedArray=u,t.array2DToJaggedArray=function(e){return u(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,(function(t,r){return e[r]}))},t.colArray2D=function(e){return new s(e.length,1,(function(t,r){return e[t]}))},t.broadcastArray=function(e,t,r,n,i,o){if(e===r&&t===n)return i;if(1===e&&1===t)return c(r,n,void 0===i[0]?o:i[0][0]);var a,s=[];a=1===e?function(e,r){return r<t?i[0][r]:o}:1===t?function(t,r){return t<e?i[t][0]:o}:function(r,n){return r<e&&n<t?i[r][n]:o};for(var l=0;l<r;l+=1){s.push([]);for(var u=0;u<n;u+=1)s[l][u]=a(l,u)}return s},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new s(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new s(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;var n=r(29),i=r(94),o=r(138);function a(e){return function(t){return new Promise((function(r){return e.setTimeout(r,t,void 0)}))}}function s(e){return function(t,r){var o,a,s,l=null!==(o=null==r?void 0:r.timeThreshold)&&void 0!==o?o:10,u=null!==(a=null==r?void 0:r.costThreshold)&&void 0!==a?a:1,c=null!==(s=null==r?void 0:r.macrotaskDelay)&&void 0!==s?s:0,d={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},f=(0,i.newPromise)(),p=f[0],m=f[1],h=m[0],g=m[1];var v=!0;var S=e(c),y=(0,n.now)();return function r(){if(!v||!function(){try{for(var e=0;e<u;){d.iterations+=1;var r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return g(e),!1}}())return h();var i=(0,n.now)();i-y<l?(Promise.resolve().then(r),d.microtaskContinues+=1):(S.then((function(){S=e(c),y=(0,n.now)(),d.macrotaskTotalDelay+=y-i,r()})),d.macrotaskContinues+=1)}(),{promise:p,stop:function(){v=!1},stats:d}}}t.delayPromiseImpl=a,t.asyncLoopFactory=s,t.asyncLoop=s(a(o.defaultSetTimeoutInterface))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;var n=r(0),i=r(4),o=r(15),a=r(46),s=r(139),l=r(63),u=r(91),c=r(140),d=r(253);t.initCalcCalled=new c.ResolvablePromise,t.maxRetriesForLoadingScript=9;var f=/^(https)|(http)|(file):\/\//,p=!1,m=void 0;function h(){if(null==m)throw new Error("initCalc was not passed calcAbsUrl");return m}function g(e,r,n,c){if(p){a.ulsLogger.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{if(a.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,l.initFeatureConfiguration)(r),null!=n&&!f.test(n)){var h="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(n);a.ulsLogger.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,h)}o.setConfig(null!=c?c:{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError:function(e){var t={error:(0,u.messageFromError)(e),innerError:e.info.error?(0,u.messageFromError)(e.info.error):void 0},r="calc.onWorkerError: ".concat(JSON.stringify(t));a.ulsLogger.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: ".concat(JSON.stringify(e));a.ulsLogger.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}),m=n,p=!0;var g=" (".concat("production",")"),v="calc.config.initCalc: Calc version ".concat(d.excelOnlineCalcPackageVersion).concat(g," initialized");a.ulsLogger.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,v),t.initCalcCalled.resolve(void 0)}}t.isCalcInit=function(){return p},t.getCalcAbsUrl=function(){return m},t.getCalcAbsUrlOrThrow=h,t.initCalc=function(e,t,r){g(e,t,r,void 0)},t.initCalcInThread=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,(function(){var a;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,o.Endpoint.createOutside(e)];case 1:return a=n.sent(),g((s=a.post,l=function(e){return"[".concat((new Date).toISOString(),"] ").concat(e)},{shipAssertTag:function(e,t,r,n){s.shipAssertTag(e,t,r,l(n))},assertTag:function(e,t,r,n){s.assertTag(e,t,r,l(n))},traceTag:function(e,t,r,n){s.traceTag(e,t,r,l(n))},debugTraceTag:function(e,t,r,n){s.debugTraceTag(e,t,r,l(n))},dnmTraceTag:function(e,t,r,n){s.dnmTraceTag(e,t,r,l(n))}}),(function(e){return!0===t[e]}),r,i),[2]}var s,l}))}))},t.initCalcThread=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,i,s,u;return n.__generator(this,(function(n){switch(n.label){case 0:t=h(),r=new MessageChannel,i={port:r.port1,options:{id:"WorkerThreadLogger"}},s={port:r.port2,options:{id:"WorkerThreadLogger"}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all([o.Endpoint.createInside(i,(function(){return a.ulsLogger.noThrowLogger})),e.call.initCalcThreadInside.transfer([s.port],s,(0,l.getFeatures)(),t)])];case 2:return[2,n.sent()[0]];case 3:throw u=n.sent(),i.port.close(),u;case 4:return[2]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelOnlineCalcPackageVersion=void 0,t.excelOnlineCalcPackageVersion="40.4.3"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(0);t.mixin=function(e,t,r){return function(e){function i(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var o=e.apply(this,n)||this,a=t(o),s=0,l=r;s<l.length;s++){var u=l[s];Object.defineProperty(o,u,{value:a[u].bind(a),enumerable:!1,configurable:!1})}return o}return n.__extends(i,e),i}(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetCharCodeBits=t.forEachClassInterval=t.CharCodeBits=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;var n,i=r(29);function o(e){return 55296==(64512&e)}function a(e){return 56320==(64512&e)}function s(e){return 55296==(63488&e)}function l(e,t){if(o(e)&&a(t))return 65536+((1023&e)<<10|1023&t)}function u(e,t){var r=e.charCodeAt(t);if(!s(r))return r;if(t+1>=e.length)return 65533;var n=l(r,e.charCodeAt(t+1));return null!=n?n:65533}function c(e){return e>=65536?2:1}function d(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],i=e[r+1],o=n;o<i;o+=1)t(o,n,i)}t.isHighSurrogate=o,t.isLowSurrogate=a,t.isAnySurrogate=s,t.surrogatePairToCodePoint=l,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)},t.scanCodePoints=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n>=e.length)return;o(e.charCodeAt(n))&&n+1<e.length&&a(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n-1<0)return;a(e.charCodeAt(n-1))&&n-2>=0&&o(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){for(var n=0,i=t;i<r;n+=1){o(e.charCodeAt(i))&&i+1<r&&a(e.charCodeAt(i+1))?i+=2:i+=1}return n},t.stringCodePointAt=u,t.numCodeUnits=c,t.codePointIterator=function(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var i=u(e,n);r.push(i),n+=c(i)}return r},function(e){e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(n=t.CharCodeBits||(t.CharCodeBits={})),t.forEachClassInterval=d,t.makeGetCharCodeBits=function(e,t){var r;function o(e){r[e]|=n.IdentStartClass}function a(e){r[e]|=n.IdentContinueClass}return function(n){if(void 0===r){var s=(0,i.fastMax)(e[e.length-1],t[t.length-1]);r=new Uint8Array(s),d(e,o),d(t,a)}var l=r[n];return void 0!==l?l:0}}},function(e,t,r){"use strict";function n(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=(t=this.obj)[e].apply(t,r);return Promise.resolve(i)}},n=0,i=e;n<i.length;n++){r(i[n])}return t}(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=n,t.wrapIntoAsync=function(e,t){return new(n()(t))(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(0);t.createArrayLogger=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=function(){return!0});var i=new Set,o=new Set;return{log:[],addTriggerListener:function(e){i.add(e)},waitForMessage:function(e,t){var r=this;return new Promise((function(n){var i=setTimeout((function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(t)),n(!1)}),t);r.addTriggerListener((function(t){var r=e(t);return r&&(clearTimeout(i),n(!0)),r}))}))},waitForReceivedButDelayedMessages:function(){var e=[];return o.forEach((function(t){return e.push(t)})),Promise.all(e).then((function(){}))},addLogMessage:function(a){var s=this;if(t(a)){var l=new Promise((function(t){var o;o=function(){s.log.push(a),e&&console.log.apply(console,n.__spreadArray([(new Date).toISOString()],a,!1)),i.forEach((function(e){e(a)&&i.delete(e)})),t()},void 0===r?o():setTimeout((function(){return o()}),r)})).then((function(){o.delete(l)}));o.add(l)}},shipAssertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["shipAssertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("shipAssertTag: ".concat(n))},assertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["assertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("assertTag: ".concat(n))},traceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["traceTag",e])},dnmTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["dnmTraceTag",e])},debugTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["debugTraceTag",e])}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;var n=r(63),i=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(console.assert(r,"shipAssertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(console.assert(r,"assertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag2",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag2",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag2",e,n,t,r)},e}();t.ConsoleLogger=i;var o=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e}();t.AssertLogger=o,t.featureEnabledDummyCallback=function(e){switch(e){case n.FeatureName.FeatureCheckingEnabled:return!0;case n.FeatureName.CalcRecordFunctions:case n.FeatureName.CalcNestedRecordFunction:case n.FeatureName.CalcLetRecFunction:case n.FeatureName.CalcLambdaFunction:case n.FeatureName.CalcLambdaBasicFunctions:case n.FeatureName.CalcLambdaHelperFunctions:case n.FeatureName.CalcLambdaOptionalParameters:case n.FeatureName.CalcLambdaDefaultParameters:case n.FeatureName.CalcLambdaCellValues:case n.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(141),i=r(95),o=function(){function e(t,r,i){this.transition=t,this.onFulfilled=r,this.onRejected=i,this.runStatus=!(t instanceof e||t.kind===n.TransitionKind.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if((0,i.isSuccess)(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState((0,i.failure)((0,i.javaScriptError)(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState((0,i.success)(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new n.AllMachine(t.map(e.resolve)))},e.prototype.settle=function(){return new n.MachineRuntime(this).runToResult()},e.settleOrThrow=function(e){var t=e.settle();if((0,i.isSuccess)(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e((0,i.success)(t),void 0,void 0)},e.reject=function(t){return new e((0,i.failure)(t),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefinedPledge,void 0,void 0);return r.transition=(0,n.callMachineTransition)(t,r),r},e.try=function(t){return e.undefinedPledge.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?(0,n.callMachineTransition)(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return(0,i.isSuccess)(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?(0,i.success)(this.accum):(this.accum=e,n.nextTransition)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}();t.Pledge=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){return(r+=1)>=t}},t.throwAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){if((r+=1)<t)return!1;throw t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;var n=function(){function e(e,t){var r=this;this.target=e,this.isRevoked=!1;var n=function(e){if(r.isRevoked)throw new TypeError("".concat(String(e),": ").concat(t))};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:function(e,t,r){return n(t),Reflect.get(e,t,r)},set:function(e,t,r,i){return n(t),Reflect.set(e,t,r,i)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),i=function(){function e(e){this.message=e}return e.prototype.getInstance=function(){var e;return null===(e=this.instance)||void 0===e?void 0:e.proxy},e.prototype.setInstance=function(e){var t;return null===(t=this.instance)||void 0===t||t.revoke(),void 0===e?this.instance=void 0:(this.instance=new n(e,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new n(this.instance.target,this.message),this.instance.proxy},e}();t.RevocableSingleton=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(0),i=r(30),o=r(24),a=r(37),s=r(77),l=r(97),u=r(57),c=r(25),d=r(79),f=r(99),p=r(66);function m(e,t,r,n){if(r.kind===o.PosKind.Abs)return r;var i=(0,l.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,o.pos)(o.PosKind.Rel,i)}function h(e,t,r,n){var a=m(t.row,r.row,n.row,i.sheetRows),l=m(t.col,r.col,n.col,i.sheetCols),u=(0,s.canonicaliseBrackets)(e,a)||(0,s.canonicaliseBrackets)(e,l);return(0,o.cellRefSingle)(a,l,u,n.label)}function g(e,t,r,n){switch(n.kind){case o.CellRefKind.Error:case o.CellRefKind.Bad:return n;case o.CellRefKind.Single:return h(e,t,r,n);case o.CellRefKind.Range:var a=h(e,t,r,n.ref1),l=h(e,t,r,n.ref2);return a===n.ref1&&l===n.ref2?n:(0,o.cellRefRange)(a,l,n.label);case o.CellRefKind.Row:var u=m(t.row,r.row,n.row1,i.sheetRows),c=m(t.row,r.row,n.row2,i.sheetRows),d=(0,s.canonicaliseBrackets)(e,u)||(0,s.canonicaliseBrackets)(e,c);return(0,o.cellRefRow)(u,c,d,n.label);case o.CellRefKind.Col:var f=m(t.col,r.col,n.col1,i.sheetCols),p=m(t.col,r.col,n.col2,i.sheetCols);d=(0,s.canonicaliseBrackets)(e,f)||(0,s.canonicaliseBrackets)(e,p);return(0,o.cellRefCol)(f,p,d,n.label)}}var v=(0,a.createFailureErrorClass)("TransformRefsError"),S=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.fn=t,o.locals=n,o.annotations=i,o.resolver=(0,f.createResolver)(r),o}return n.__extends(t,e),t.prototype.nameNode=function(e,t,r){var n=(0,o.nameNode)(e,t,r),i=this.resolver.resolveDottedName(this.locals,n,this.annotations).resolved;if(i.kind===d.ResolvedKind.ResolvedCellRef){var a=(0,o.flattenNameParts)(e);(0,c.assertTrue)("calc.lang.adjustFormulaOrigin",a.kind===o.NamePartKind.CellRefNamePart);var s=a.parts,l=s[0],f=s[1],p=s.slice(2),m=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,i=t.label,a=t.qualifiedLabel;return(0,o.fieldRefNamePart)(e,r,n,i,a)};return(0,o.nameNode)(p.reduce(m,m((0,o.cellRefNamePart)(this.fn(l.ref),l.asWhole,l.label,l.qualifiedLabel),f)),t,r)}if(i.resolution.kind!==u.ResultKind.Success&&i.resolution.reason.kind!==d.ResolveReasonKind.NoOriginSheet&&i.resolution.reason.kind!==d.ResolveReasonKind.InvalidQualifier)throw new v(i.resolution.reason);return n},t.prototype.cellRefNode=function(e,t,r){return(0,o.cellRefNode)(this.fn(e),t,r)},t}(p.IdentityVisitor);t.adjustFormulaOrigin=function(e,t,r,i){var o=t.originGridCell.value;if((0,a.isGridCellEqual)(o,r))return(0,u.success)(i);try{var s=(0,p.reduceBottomUp)(new S(g.bind(void 0,e.config.refStyle,o,r),e,t,i.annotations),i);return(0,u.success)(n.__assign(n.__assign({},i),{node:s}))}catch(e){if(e instanceof v)return(0,u.failure)(e.reason);throw e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(2);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(2);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(8);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(0),i=r(25),o=r(266),a=r(144),s=r(96),l=r(24),u=r(37),c=r(66),d=function(e){function t(t,r,n){var i=e.call(this,c.voidVisitor)||this;return i.localeInfo=t,i.annotations=r,i.names=n,i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var o=this;return a.Pledge.try((function(){return t.kind===l.NodeKind.Name&&(o.annotations[t.label]=l.appHeadNameAnnotation),e.prototype.appNode.call(o,t,r,n,i)}))},t.prototype.letNode=function(e,t,r,n){var o=this,l=e.id===s.WorksheetFuncId.LETREC||e.id!==s.WorksheetFuncId.LET&&(0,i.assertFalse)("calc.lang.buildAnnotations"),u=this.bindNames(t),d=u[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return l?a.Pledge.all(t.map((function(e){var t=e.binder;return a.Pledge.try((function(){return(0,c.visitFormulaNode)(d,t.arg)}))}))):a.Pledge.all(t.map((function(e,t){var r=e.binder,n=u[t];return a.Pledge.try((function(){return(0,c.visitFormulaNode)(n,r.arg)}))})))})).bind((function(e){return void 0===r?void 0:(0,c.visitFormulaNode)(d,r.arg)})).bind((function(e){return a.Pledge.all(n.map((function(e){return a.Pledge.try((function(){return(0,c.visitFormulaNode)(o,e.arg)}))})))})).bind((function(e){}))},t.prototype.lambdaNode=function(e,t,r,n){var i=this,o=this.bindNames(t),s=o[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return a.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return a.Pledge.resolve(void 0);var n=o[t],i=r.arg.def;return a.Pledge.try((function(){return(0,c.visitFormulaNode)(n,i.rhs)}))})))})).bind((function(e){return void 0===r?void 0:(0,c.visitFormulaNode)(s,r.arg)})).bind((function(e){return a.Pledge.all(n.map((function(e){return a.Pledge.try((function(){return(0,c.visitFormulaNode)(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.bindNames=function(e){var r=this,n=[this];return e.reduce((function(e,i){var o=i.name;if(void 0===o.arg.whole)return n.push(new t(r.localeInfo,r.annotations,e)),e;var a=(0,u.getBoundName)(r.localeInfo,o.arg.whole),s=e.setValue(a,o.arg);return n.push(new t(r.localeInfo,r.annotations,s)),r.annotations[o.arg.label]=(0,l.localNameDeclAnnotation)(a,o.arg.whole),s}),this.names),n},t.prototype.nameNode=function(t,r,n){var i=this;return a.Pledge.try((function(){if(void 0===r){var o=(0,l.headNamePart)(t),a=i.names.getEntry((0,u.getBoundName)(i.localeInfo,o.asWhole));if(void 0===a);else if(a.value.kind===l.NodeKind.ContextName)i.annotations[o.label]=(0,l.localNameUseAnnotation)(a.key,a.value.whole,a.value.label);else{i.annotations[o.label]=(0,l.localNameUseAnnotation)(a.key,a.value.whole,a.value.label),i.annotations[a.value.label].uses.push({label:o.label})}}return e.prototype.nameNode.call(i,t,r,n)}))},t}(c.PledgeReducer);t.buildAnnotations=function(e,t,r,n){var i=[];return(0,c.reduceTopDown_Pledge)(new d(e,i,(null!=r?r:[]).reduce((function(t,r){var n=(0,u.getBoundName)(e,r.whole);return t.setValue(n,r)}),o.RedBlackMapTree.create(e.stringCompareCI))),t),i[t.label]=(0,l.formulaRootAnnotation)(r,n),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(2);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(2);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0;var n=r(100);const i=Math.sqrt;t.Math_sqrt=i;const o=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=o;const a=Math.log;t.Math_log=a;const s=Math.exp;t.Math_exp=s;const l=Math.sin;t.Math_sin=l;const u=Math.cos;t.Math_cos=u;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var n=r(80),i=r(148);function o(e,t,r,n,i,o,a,s,l){return{yr:e,mon:t,dom:r,hour:n,min:i,sec:o,wdy:a,fracSec:s,rounding:l}}function a(e){return o((0,n.Dtr_Yr)(e),(0,n.Dtr_Mon)(e),(0,n.Dtr_DOM)(e),(0,n.Dtr_Hour)(e),(0,n.Dtr_Min)(e),(0,n.Dtr_Sec)(e),(0,n.Dtr_Wdy)(e),(0,n.Dtr_FracSec)(e),(0,n.Dtr_Rounding)(e))}function s(e,t){(0,n.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,n.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=o,t.fromNum=function(e,t,r,i){var o=t;return 0===(0,n.Dtr_FromNum)(e,o,0,r?1:0,i?1:0)&&a(0)},t.toNum=function(e,t,r){s(0,e);var o=(0,n.Dtr_ToNum)(0,t?1:0,r?1:0),a=(0,n.Mathpack_TakeMathError)();return a===i.MathErrorNum.None?o:(0,i.mathError)(a)},t.toNumWithDuration=function(e,t,r,o,a){s(0,e);var l=o,u=(0,n.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,l,a),c=(0,n.Mathpack_TakeMathError)();return c===i.MathErrorNum.None?u:(0,i.mathError)(c)},t.toDays=function(e,t,r){return s(0,e),0===(0,n.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,n.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(t.TimeDivision||(t.TimeDivision={})),t.toTime=function(e,t,r){var o=t,a=r,s=(0,n.Dtr_ToTime)(e,o,a);return(0,n.Mathpack_TakeMathError)()===i.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,i){return s(0,e),null!=t.standardDate&&s(1,t.standardDate),null!=t.daylightDate&&s(2,t.daylightDate),0!==(0,n.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,i?1:0)&&a(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;var n=r(0),i=r(24),o=r(66);t.relabelFormula=function(e,t){var r;void 0===t&&(r=1,t=function(){return r++});var a=e.spans,s=e.annotations,l=e.depthUpperBound,u=[],c=[],d=[],f=[];function p(e){var r=t(),n=a[e];null!=n&&(u[r]=n);var i=s[e];return null!=i&&(c[r]=i),d[e]=r,f[r]=e,r}function m(e){return n.__assign(n.__assign({},e),{label:p(e.label)})}function h(e){if(e.kind===i.CellRefKind.Range){var t=e;return(0,i.cellRefRange)(h(t.ref1),h(t.ref2),p(e.label))}return n.__assign(n.__assign({},e),{label:p(e.label)})}function g(e){return null!=e?(0,i.documentQualifier)(e.document,e.path,e.isQuoted,p(e.label)):void 0}function v(e){return(0,i.fieldRef)((t=e.field).kind===i.NodeKind.Name?y(t.parts,t.qualifier,t.label):(0,i.badNode)(t.type,t.contents,p(t.label)),e.isBracketed,e.isClosed,p(e.label));var t}function S(e){switch(null==e?void 0:e.kind){case void 0:return;case i.StructRefKind.SpecialRef:return(0,i.specialRef)(e.id,e.isBracketed,e.isClosed,p(e.label));case i.StructRefKind.ColumnRef:return(0,i.columnRef)(e.name,e.isBracketed,e.isClosed,p(e.label));case i.StructRefKind.RangeOpRef:return(0,i.rangeOpRef)(S(e.lhs),S(e.rhs),p(e.label));case i.StructRefKind.CommaOpRef:return(0,i.commaOpRef)(e.refs.map(S),p(e.label));case i.StructRefKind.ThisRowOpRef:return(0,i.thisRowOpRef)(void 0!==e.ref?S(e.ref):void 0,p(e.label));case i.StructRefKind.MissingRef:return(0,i.missingRef)(p(e.label));case i.StructRefKind.BadRef:return(0,i.badRef)(e.contents,e.isBracketed,e.isClosed,p(e.label))}}function y(e,t,r){return(0,i.nameNode)(function(e){var t=(0,i.flattenNameParts)(e),r=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,o=t.label,a=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,void 0===r?r:v(r),n,p(o),p(a))};if(t.kind===i.NamePartKind.IdentNamePart){var n=t.parts,o=n[0],a=n.slice(1),s=(0,i.identNamePart)(o.asWhole,o.canDenoteNamedObject,p(o.label),p(o.qualifiedLabel));return a.reduce(r,s)}var l=t.parts,u=l[0],c=l[1],d=l.slice(2),f=(0,i.cellRefNamePart)(h(u.ref),u.asWhole,p(u.label),p(u.qualifiedLabel));return d.reduce(r,r(f,c))}(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:g(e.document),label:p(e.label)}):n.__assign(n.__assign({},e),{label:p(e.label)})}(t),p(r))}function C(e){return y(e.parts,e.qualifier,e.label)}function R(e){var t=(0,i.paramName)(function(e){switch(e.kind){case i.NodeKind.Name:return C(e);case i.NodeKind.Bad:return(0,i.badNode)(e.type,e.contents,p(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,p(e.name.label)),r=void 0===e.def?void 0:(0,i.paramDefault)(e.def.rhs,p(e.def.label));return(0,i.paramNode)(t,r,p(e.label))}for(var b={literalNode:function(e,t,r){return(0,i.literalNode)(e,t,p(r))},arrayNode:function(e,t,r){return(0,i.arrayNode)(e,t,p(r))},appNode:function(e,t,r,n){return(0,i.appNode)(e,t,r,p(n))},letNode:function(e,t,r,n,o,a){return(0,i.letNode)(e,t.map((function(e){var t=e.name,r=e.binder;return(0,i.letVar)((0,i.indexedArg)(C(t.arg),t.index),r)})),r,n,o,p(a))},lambdaNode:function(e,t,r,n,o,a){return(0,i.lambdaNode)(e,t.map((function(e){var t=e.name;return(0,i.lambdaParam)((0,i.indexedArg)(R(t.arg),t.index))})),r,n,o,p(a))},parenNode:function(e,t,r){return(0,i.parenNode)(e,t,p(r))},nameNode:function(e,t,r){return y(e,t,r)},cellRefNode:function(e,t,r){return(0,i.cellRefNode)(h(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:g(e.document),label:p(e.label)}):n.__assign(n.__assign({},e),{label:p(e.label)})}(t),p(r))},fieldRefNode:function(e,t,r,n){return(0,i.fieldRefNode)(e,v(t),r,p(n))},structRefNode:function(e,t,r){return(0,i.structRefNode)(void 0===e?void 0:C(e),(n=t,(0,i.structRef)(S(n.innerRef),n.isClosed,p(n.label))),p(r));var n},badSequenceNode:function(e,t,r){return(0,i.badNode)(e,t,p(r))},badStringNode:function(e,t,r){return(0,i.badNode)(e,t,p(r))},operatorNode:function(e,t){return(0,i.operatorNode)(e,p(t))},wsfNode:function(e,t,r){return(0,i.wsfNode)(e,t,p(r))}},N=(0,i.formula)((0,o.reduceBottomUp)(b,e),u,c,l),T=0,P=Object.keys(c);T<P.length;T++){var E=P[T],k=Number(E),O=c[k];switch(null==O?void 0:O.kind){case i.AnnotationKind.LocalNameUse:c[k]=(0,i.localNameUseAnnotation)(O.name,O.whole,d[O.label]);break;case i.AnnotationKind.LocalNameDecl:c[k]=(0,i.localNameDeclAnnotation)(O.name,O.whole,O.uses.map((function(e){var t=e.label;return{label:d[t]}})))}}for(var A=0,I=Object.keys(u).map(Number);A<I.length;A++){var _=I[A],F=u[_],M=null==F?void 0:F.preComments,D=null==F?void 0:F.postComments;(M||D)&&(u[_]=n.__assign(n.__assign({},F),{preComments:M?M.map(m):void 0,postComments:D?D.map(m):void 0}))}return{formula:N,oldToNewLabel:d,newToOldLabel:f}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;var n=r(56),i=r(18),o=r(150),a=r(78),s=r(58),l=r(25),u=r(47),c=r(59);var d=a.codePointDigitZero;function f(e){return{kind:u.OperKind.Number,_valueIEEE:e}}var p=f(0),m=f(1),h=f(Math.PI);function g(e){return isFinite(e)?f(e):n.numErrorOper}function v(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function S(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),i=!(0,s.stringStartsWith)(r,"-"),o=r.substring(i?0:1,n).replace(".",""),a=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==d)return!1;return!0}(o)?{sign:i,mantissa:"",exponent:0}:{sign:i,mantissa:o,exponent:a}}var y=["0","1","2","3","4","5","6","7","8","9"];function C(e){var t=e._valueIEEE;return f(t<0?Math.ceil(t):Math.floor(t))}function R(e){var t=e._valueIEEE;return f(Math.floor(t))}function b(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:p,one:m,pi:h,add:function(e,t){return g(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return g(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return g(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,i=t._valueIEEE;return 0===i?n.div0ErrorOper:g(r/i)},power:function(e,t){var r=e._valueIEEE,i=t._valueIEEE,o=Math.pow(r,i);return isFinite(o)?f(o):isNaN(o)?n.div0ErrorOper:n.numErrorOper},percent:function(e){return f(e._valueIEEE/100)},neg:function(e){return f(-e._valueIEEE)},compare:v,formatGeneral:function(e,t,r){var n=e.decimalSeparator,i=t._valueIEEE,o=String(i).replace("e","E");return"."!==n&&(o=o.replace(".",n)),o},formatFixed:function(e,t,r){var n,i=e._valueIEEE,a=S(i),s=a.sign,l=a.mantissa,u=a.exponent,c=r+(u+t);if(0===c){var d=parseFloat("5e"+String(u-1));if(Math.abs(i)>=d)return(0,o.numberComponents)(s,"1",u+t+1)}if(c<1)return(0,o.numberComponents)(!0,"",0);c<=21&&(s=(n=S(i,c-1)).sign,l=n.mantissa,c=r+((u=n.exponent)+t));var f=l.substring(0,c);return(0,o.numberComponents)(s,f,0===f.length?0:u+t)},formatScientific:function(e,t,r){var n,i=e._valueIEEE,a=S(i),s=a.sign,u=a.mantissa,c=a.exponent,d=(0,o.formatScientificLeft)(c,t),f=d+r;if((0,l.assertTrue)("calc.lang.ieeeFormatScientific",f>0),0===f){var p=parseFloat("5e"+String(c-1));if(Math.abs(i)>=p)return(0,o.numberComponents)(s,"",c+1)}if(f<1)return(0,o.numberComponents)(!0,"",0);f<=21&&(s=(n=S(i,f-1)).sign,u=n.mantissa,c=n.exponent,f=(d=(0,o.formatScientificLeft)(c,t))+r);var m=u.substring(0,f);return(0,o.numberComponents)(s,m,0===m.length?0:c)},parse:function(e,t,r,n){return f(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",i=0,o=(0,c.codePointIterator)(t);i<o.length;i++){var a=o[i];n+=y[r(a)]}return n}(e,n)+"E"+String(r)))},trunc:C,ceil:function(e){var t=e._valueIEEE;return f(Math.ceil(t))},floor:R,abs:function(e){return f(Math.abs(e._valueIEEE))},cond:function(e){return v(e,p)},cond2:v,fromNumber:f,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return g(Math.sqrt(e._valueIEEE))},exp:function(e){return g(Math.exp(e._valueIEEE))},ln:function(e){return g(Math.log(e._valueIEEE))},log:function(e){return g(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return f(Math.sin(e._valueIEEE))},cos:function(e){return f(Math.cos(e._valueIEEE))},tan:function(e){return f(Math.tan(e._valueIEEE))},asin:function(e){return g(Math.asin(e._valueIEEE))},acos:function(e){return g(Math.acos(e._valueIEEE))},atan:function(e){return g(Math.atan(e._valueIEEE))},atan2:function(e,t){return f(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=S(r).exponent,i=C(t)._valueIEEE+n;if(0===i){var o=parseFloat("5e"+String(n-1));if(Math.abs(r)>=o)return g((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return i<1?p:i>21?e:g(parseFloat(r.toExponential(i-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=S(r),i=n.sign,o=n.mantissa,a=n.exponent,s=C(t)._valueIEEE+a;return s<1?g(parseFloat((i?"":"-")+"10e"+String(a-1-s))):s>21?e:g(parseFloat((i?"":"-")+function(e,t){if(e.length<=t)return b(e);for(var r=e.substring(0,t),n=0,i=r.length-1;i>=0&&r.charCodeAt(i)-d==9;i-=1)n+=1;return n===r.length?"10":b(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(o,s)+"e"+String(a-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=S(r),i=n.sign,o=n.mantissa,a=n.exponent,s=C(t)._valueIEEE+a;if(s<1)return p;if(s>21)return e;var l=o.substring(0,s);return g(parseFloat((i?"":"-")+b(l)+"e"+String(a-1)))},tenTo:function(e){return(0,l.assertInteger)("calc.lang.ieeeTenTo",e),g(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=C(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=R(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:i.identity}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n,i=r(0),o=r(24),a=r(56),s=r(65),l=r(25),u=r(37),c=r(30),d=r(145),f=r(275),p=r(77),m=r(58),h=r(79),g=r(99),v=r(57),S=r(66),y=r(47),C=r(276),R=r(151),b=r(59),N=/"/g,T=(0,c.sheetGridCell)((0,c.sheetIndex)((0,c.documentLoc)(void 0,"Book1"),0),(0,c.gridCell)(0,0));function P(e){if(!(0,v.isSuccess)(e)&&e.reason.kind!==h.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==h.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==h.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==h.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==h.ResolveReasonKind.EmptyIntersection)throw new _(e.reason)}function E(e){for(var t=[],r=[],n=0,i=e;n<i.length;n++){var o=i[n];o.length>0&&(0,b.numCodeUnits)((0,b.stringCodePointAt)(o,0))===o.length?t[(0,b.stringCodePointAt)(o,0)]=!0:r.push(o)}return function(e,n){var i=(0,b.stringCodePointAt)(e,n);if(!0===t[i])return!0;for(var o=0,a=r;o<a.length;o++){var s=a[o];if((0,m.stringStartsWith)(e,s,n))return!0}return!1}}function k(e,t){for(var r="",n=0;n<e.length;){t(e,n)&&(r+="'");var i=(0,b.stringCodePointAt)(e,n);r+=(0,b.stringFromCodePoint)(i),n+=(0,b.numCodeUnits)(i)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(n||(n={}));var O={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,i,o){return o},lambdaNode:function(e,t,r,n,i,o){return o},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r,n){return n},structRefNode:function(e,t,r){return r},badSequenceNode:function(e,t,r){return r},badStringNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},A=i.__assign(i.__assign({},(0,S.constVisitor)(void 0)),{operatorNode:function(e){return e}}),I=function(){function e(e,t,r,n){var o,a,s,l,u=this;this.root=r,this.anonymize=n,this.anon=function(e){return u.anonymize?(0,f.anonymizeFormulaString)(e):e},this.locals=t,this.localeInfo=null!==(a=null===(o=t.config)||void 0===o?void 0:o.localeInfo)&&void 0!==a?a:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(l=null===(s=t.config)||void 0===s?void 0:s.refStyle)&&void 0!==l?l:e.config.refStyle,this.resolver=(0,g.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;var c=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],d=i.__spreadArray(i.__spreadArray([],c,!0),["\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=E(c),this.isStructRefBracketedThisRef=E(d),this.isFieldRefEscapable=E(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var e=new S.ZipVisitor({str:this,label:O,op:A});return"="+this.pre(this.root.node.label,"")+(0,S.reduceBottomUp)(e,this.root).str+this.postIfComments(this.root.node.label)},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t},e.prototype.preIfComments=function(e){if(this.anonymize)return"";var t=this.spans[e];return null!=(null==t?void 0:t.preComments)&&t.preComments.length>0?t.pre:""},e.prototype.postIfComments=function(e){if(this.anonymize)return"";var t=this.spans[e];return null!=(null==t?void 0:t.postComments)&&t.postComments.length>0?t.post:""},e.prototype.printRef=function(e,t){var r="";switch(e.kind){case o.StructRefKind.SpecialRef:(t===n.Original&&e.isBracketed||t===n.Bracketed)&&(r+=this.localeInfo.leftBracket);var i=this.localeInfo.specialRefNames[e.id];if(null==i)throw new _((0,u.internal)("No locale data for specialRefName"));r+=i,(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case o.StructRefKind.ColumnRef:var a=0===e.name.length||(0,m.stringStartsWith)(e.name," ")||(0,m.stringEndsWith)(e.name," ");(t===n.Original&&e.isBracketed||t===n.Bracketed||t===n.Unbracketed&&a)&&(r+=this.localeInfo.leftBracket);var s=k(e.name,this.isStructRefEscapable);r+=this.anon(s),(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed||t===n.Unbracketed&&a)&&(r+=this.localeInfo.rightBracket);break;case o.StructRefKind.RangeOpRef:r+=this.printRef(e.lhs,t===n.Original?t:n.Bracketed)+":"+this.printRef(e.rhs,t===n.Original?t:n.Bracketed);break;case o.StructRefKind.MissingRef:break;case o.StructRefKind.BadRef:e.isBracketed&&(r+=this.localeInfo.leftBracket),r+=e.contents,e.isBracketed&&e.isClosed&&(r+=this.localeInfo.rightBracket)}return r},e.prototype.printThisRowOpRef=function(e){var t="@";return e&&(e.kind===o.StructRefKind.ColumnRef?t+=this.printRef(e,e.isClosed?function(e,t){for(var r=0;r<e.length;){if(t(e,r))return!0;r+=(0,b.numCodeUnits)((0,b.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?n.Bracketed:n.Unbracketed:n.Original):t+=this.printRef(e,(0,u.isRangeOpClosed)(e)&&(0,u.isRangeOpNoMissing)(e)?n.Bracketed:n.Original)),t},e.prototype.printApplication=function(e,t,r){var n=this,i=t.map((function(e,t,r){return n.pre(e.label,0===t||""===e.str?"":" ")+e.str+(t===r.length-1?n.post(e.label,""):n.postIfComments(e.label))}));return e.str+"("+i.join(this.localeInfo.listSeparator)+(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?(0,S.visitQualifier)(this,r)+this.postIfComments(r.label):"")+(0,S.visitCellRef)(this,t)},e.prototype.printName=function(e){var t=e.whole,r=e.qualifier;return(void 0!==r?(0,S.visitQualifier)(this,r)+this.postIfComments(r.label):"")+this.anon(t)},e.prototype.printUnanonymisedDocQual=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e.prototype.printOptionalParamName=function(e){return e.kind===o.NodeKind.Name?this.anon((0,u.getBoundName)(this.localeInfo,e.whole)):this.pre(e.label,"")+this.anon(e.contents)+this.post(e.label,"")},e.prototype.literalNode=function(e,t,r){switch(e.kind){case y.OperKind.String:return'"'+this.anon(e.value).replace(N,'""')+'"';case y.OperKind.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case y.OperKind.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21));case y.OperKind.Missing:return"";case y.OperKind.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new _((0,u.internal)("No locale data for error type ".concat(e.type)));return n;default:return(0,l.assertNever)("calc.lang.printFormula",e)}},e.prototype.arrayNode=function(e,t,r){var n=this;return this.localeInfo.leftBrace+e.map((function(e){return e.map((function(e){return n.preIfComments(e.label)+e.str+n.postIfComments(e.label)})).join(n.localeInfo.columnSeparator)})).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var i=t[0];switch(e.op){case s.OperatorId.Percent:return i.str+this.pre(e.label,"")+e.str;case s.OperatorId.Pound:return i.str+this.preIfComments(e.label)+e.str;default:return e.str+this.post(e.label,"")+i.str}}if(2===t.length){var o=t[0],a=t[1],u=" ",c=" ";switch(e.op){case s.OperatorId.Range:u=c="";break;case s.OperatorId.Isect:c="";break;case s.OperatorId.Union:u=""}return o.str+this.pre(e.label,u)+e.str+this.post(e.label,c)+a.str}return(0,l.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)},e.prototype.letNode=function(e,t,r,n,i,a){var s=this,l=t.map((function(e){var t=e.name,r=e.binder;return(0,o.letVar)((0,o.indexedArg)({str:s.anon((0,u.getBoundName)(s.localeInfo,t.arg.whole)),label:t.arg.label,op:void 0},t.index),r)}));return this.printApplication(e,(0,o.flattenLetArgs)(l,r,n),i)},e.prototype.lambdaNode=function(e,t,r,n,i,a){var s=this,l=t.map((function(e){var t=e.name,r=(t.arg.name.isBracketed?s.localeInfo.leftBracket:"")+s.printOptionalParamName(t.arg.name.name)+(t.arg.name.isBracketed&&t.arg.name.isClosed?s.localeInfo.rightBracket:"");return void 0!==t.arg.def&&(r+=s.pre(t.arg.def.label," ")+":="+s.pre(t.arg.def.rhs.label,""===t.arg.def.rhs.str?"":" ")+t.arg.def.rhs.str),(0,o.lambdaParam)((0,o.indexedArg)({str:r,label:t.arg.label,op:void 0},t.index))}));return this.printApplication(e,(0,o.flattenLambdaArgs)(l,r,n),i)},e.prototype.parenNode=function(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,(0,o.nameNode)(e,t,r),this.annotations),a=n.resolved,s=n.fields;return P(a.resolution),a.kind===h.ResolvedKind.ResolvedCellRef?i.__spreadArray([this.printCellRef(a.node)],s.map(this.anon),!0).join("."):a.kind===h.ResolvedKind.ResolvedLocalName&&void 0!==a.resolution.value?i.__spreadArray([this.anon(a.resolution.value.name)],s.map(this.anon),!0).join("."):a.kind===h.ResolvedKind.ResolvedUserDefinedFunc?i.__spreadArray([this.anon(a.name)],s.map(this.anon),!0).join("."):i.__spreadArray([this.printName(a.node)],s.map(this.anon),!0).join(".")},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,(0,o.cellRefNode)(e,t,r)),i=n.node;return P(n.resolution),this.printCellRef(i)},e.prototype.fieldRefNode=function(e,t,r,n){var i=e.str,a=r,s=t.isBracketed||a?this.localeInfo.leftBracket:"",l=t.isBracketed&&t.isClosed||a?this.localeInfo.rightBracket:"",u=t.field.kind===o.NodeKind.Name?k(t.field.whole,this.isFieldRefEscapable):t.field.contents;return t.field.kind!==o.NodeKind.Name?i+=this.pre(t.label,""):i+=this.preIfComments(t.label),i+="."+s+this.anon(u)+l+this.post(t.label,"")},e.prototype.structRefNode=function(e,t,r){var i,a=this,s=this.resolver.resolveStructRef(this.locals,(0,o.structRefNode)(e,t,r)),l=s.node,c=s.table;P(s.resolution);var d=l.rhs.innerRef,f=l.lhs;void 0!==f||void 0===c||!l.rhs.isClosed||(null==d?void 0:d.kind)===o.StructRefKind.ColumnRef||(null==d?void 0:d.kind)===o.StructRefKind.ThisRowOpRef&&(null===(i=d.ref)||void 0===i?void 0:i.kind)===o.StructRefKind.ColumnRef||(f=(0,o.nameNode)((0,o.identNamePart)(c.name)));var p=void 0!==f?this.printName(f):"";if(void 0===d&&l.rhs.isClosed&&void 0!==f)return p;switch(p+=this.localeInfo.leftBracket,null==d?void 0:d.kind){case o.StructRefKind.ColumnRef:case o.StructRefKind.SpecialRef:if(d.kind===o.StructRefKind.SpecialRef&&d.id===o.SpecialRefId.ThisRow&&d.isClosed){p+=this.printThisRowOpRef(void 0);break}p+=this.printRef(d,d.isClosed?n.Unbracketed:n.Original);break;case o.StructRefKind.RangeOpRef:var m=(h=(0,u.isRangeOpClosed)(d)&&(0,u.isRangeOpNoMissing)(d))?n.Bracketed:n.Original;p+=this.printRef(d,m);break;case o.StructRefKind.CommaOpRef:var h;if((h=(0,u.isCommaOpRefWellFormed)(d)&&(0,u.isCommaOpClosed)(d)&&(0,u.isCommaOpNoBadOrMissing)(d))&&d.specialRefs[o.SpecialRefId.ThisRow]){p+=this.printThisRowOpRef(0===d.columnRefs.length?void 0:d.columnRefs[0]);break}var g=h?(0,u.normalizeCommaOpRef)(d):d.refs,v=h?1===g.length?n.Unbracketed:n.Bracketed:n.Original;p+=g.map((function(e){return a.printRef(e,v)})).join(this.localeInfo.listSeparator);break;case o.StructRefKind.ThisRowOpRef:p+=this.printThisRowOpRef(d.ref);break;case o.StructRefKind.BadRef:p+=this.printRef(d,n.Original)}return l.rhs.isClosed&&(p+=this.localeInfo.rightBracket),p},e.prototype.badSequenceNode=function(e,t,r){var n=this;return t.map((function(e){return n.pre(e.label,"")+e.str+n.post(e.label,"")})).join("")},e.prototype.badStringNode=function(e,t,r){return this.anon(t)},e.prototype.operatorNode=function(e,t){var r=(0,d.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new _((0,u.internal)("Invalid operator"));return r},e.prototype.wsfNode=function(e,t,r){return this.localeInfo.getWorksheetFuncName(e)},e.prototype.cellRefError=function(){var e=this.localeInfo.errorNames[a.ErrorType.REF];if(null==e)throw new _((0,u.internal)("No locale data for #REF"));return e},e.prototype.cellRefSingle=function(e,t,r){var n=(0,p.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefRange=function(e,t){var r=(0,p.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()},e.prototype.cellRefRow=function(e,t,r){var n=(0,p.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefCol=function(e,t,r){var n=(0,p.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefBad=function(e,t){return this.anon(e)},e.prototype.errorQualifier=function(){var e=this.localeInfo.errorNames[a.ErrorType.REF];if(null==e)throw new _((0,u.internal)("No locale data for #REF"));return e},e.prototype.relativeQualifier=function(){return"!"},e.prototype.documentQualifier=function(e,t,r){return(0,p.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,o.documentQualifier)(e,t))))+"!"},e.prototype.sheetQualifier=function(e,t,r){return(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(t)+e))+"!"},e.prototype.identQualifier=function(e,t){return(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"},e.prototype.sheetRangeQualifier=function(e,t,r,n){var i=this.anon(this.printUnanonymisedDocQual(r)+e),o=this.anon(t),a=i+":"+o;return((0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,i)||(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,o)?(0,p.quoteQualifier)(a):a)+"!"},e.prototype.badQualifier=function(e,t){return this.anon(e)},e}(),_=(0,u.createFailureErrorClass)("PrintFormulaError"),F=(0,u.createFailureErrorClass)("PrintRangeError");function M(e,t,r,n){void 0===n&&(n=!1);try{return(0,v.success)(new I(e,t,r,n).print())}catch(e){return e instanceof _?(0,v.failure)(e.reason):(0,v.failure)((0,v.javaScriptError)(e))}}function D(e,t){return(0,o.cellRefSingle)((0,o.pos)(o.PosKind.Rel,t.row-e.row),(0,o.pos)(o.PosKind.Rel,t.col-e.col))}function w(e,t){if(0===t.col&&t.cols===c.sheetCols)return function(e,t,r){return(0,o.cellRefRow)((0,o.pos)(o.PosKind.Rel,t-e.row),(0,o.pos)(o.PosKind.Rel,t+r-1-e.row))}(e,t.row,t.rows);if(0===t.row&&t.rows===c.sheetRows)return function(e,t,r){return(0,o.cellRefCol)((0,o.pos)(o.PosKind.Rel,t-e.col),(0,o.pos)(o.PosKind.Rel,t+r-1-e.col))}(e,t.col,t.cols);var r=D(e,(0,u.gridRangeAnchor)(t));if((0,u.isGridCell)(t))return r;var n=D(e,(0,c.gridCell)(t.row+t.rows-1,t.col+t.cols-1));return(0,o.cellRefRange)(r,n)}function L(e){return(0,v.isSuccess)(e)?((0,l.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,v.success)(e.value)):e.reason.kind===h.ResolveReasonKind.InvalidStructRef?(0,l.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,v.failure)(e.reason)}function x(e,t,r,n){var a,s;void 0===n&&(n=(0,C.makeEmptyTable)());try{var l=t.originSheet.value;if(!(0,u.isDocumentLocEqual)(l.document,r.sheet.document))throw new F((0,u.notImplemented)(["printRange cross-document"]));return(0,v.success)(null!==(s=null!==(a=function(e,t,r,n){var a=t.originSheet.value,s=e.getNamedRanges(r);if(!(0,v.isSuccess)(s))throw new F(s.reason);if(0!==s.value.length){var l=function(e){return void 0!==e.index&&(void 0===a.index||!(0,u.isSheetIndexEqual)(e,a))},d=s.value.filter((function(e){var t=e.scope;return void 0===t.index?(0,u.isDocumentLocEqual)(t.document,r.sheet.document):(0,u.isSheetIndexEqual)(t,r.sheet)})).filter((function(t){var r=t.scope,n=t.name;if(void 0!==r.index||void 0===a.index)return!0;var i=a,o=e.getNameLoc(i,n,c.NameSource.Plain);if(!(0,v.isSuccess)(o))throw new F(o.reason);return null==o.value})).filter((function(e){var t=e.scope,r=e.name;return l(t)||!n.contains(r)}));if(0!==d.length){var f,p=1===d.length?d[0]:i.__spreadArray([],d,!0).sort((function(t,r){return e.config.localeInfo.stringCompareCI(t.name,r.name)}))[0];if(l(p.scope)){var m=e.getSheetName(p.scope.document,p.scope.index);if(!(0,v.isSuccess)(m))throw new F(m.reason);f=(0,o.sheetQualifier)(m.value)}return(0,o.nameNode)((0,o.identNamePart)(p.name),f)}}}(e,t,r,n))&&void 0!==a?a:function(e,t,r){var n=r.sheet,i=r.range,a=e.getContainingTable((0,c.sheetGridCell)(n,(0,u.gridRangeAnchor)(i)));if(!(0,v.isSuccess)(a))throw new F(a.reason);if(null!=a.value){var s=a.value,l=L(e.getStructRefSpecialRef(s,o.SpecialRefId.All));if(!(0,v.isSuccess)(l))throw new F(l.reason);var d=l.value.range,f=l.value.sheet,p=(0,u.gridRangeCompare)(d,i);if(!(void 0===p||p<0)){var m=L(e.getStructRefSpecialRef(s,o.SpecialRefId.Data));if(!(0,v.isSuccess)(m))throw new F(m.reason);var h=m.value.range,g=t.originGridCell.value,S=t.originSheet.value,y=void 0!==S.index&&(0,u.isSheetIndexEqual)(S,f)&&(0,u.gridRangeIsects)(d,g)?void 0:(0,o.nameNode)((0,o.identNamePart)(s.name)),C=null!=y?y:(0,o.nameNode)((0,o.identNamePart)(s.name)),R=h.cols>1&&i.col===h.col&&i.cols===h.cols,b=function(){var t=L(e.getStructRefColumn(s,i.col));if(!(0,v.isSuccess)(t))throw new F(t.reason);if(1===i.cols)return(0,o.columnRef)(t.value.name);var r=L(e.getStructRefColumn(s,i.col+i.cols-1));if(!(0,v.isSuccess)(r))throw new F(r.reason);return(0,o.rangeOpRef)((0,o.columnRef)(t.value.name),(0,o.columnRef)(r.value.name))};if(i.row===d.row&&i.rows===d.rows)return(0,o.structRefNode)(C,(0,o.structRef)(R?(0,o.specialRef)(o.SpecialRefId.All):(0,o.commaOpRef)([(0,o.specialRef)(o.SpecialRefId.All,!0),b()])));if(1===i.rows&&i.row===g.row&&i.row>=h.row&&i.row<h.row+h.rows)return(0,o.structRefNode)(1===i.cols?y:C,(0,o.structRef)((0,o.thisRowOpRef)(R?void 0:b())));if(i.row===h.row&&i.rows===h.rows)return R?(0,o.structRefNode)(C,(0,o.structRef)(void 0)):(0,o.structRefNode)(1===i.cols?y:C,(0,o.structRef)(b()));var N=i.row===d.row&&i.row+i.rows===h.row,T=i.row===h.row+h.rows&&i.row+i.rows===d.row+d.rows;if(N||T){var P=(0,o.specialRef)(N?o.SpecialRefId.Headers:o.SpecialRefId.Totals,!R);return(0,o.structRefNode)(C,(0,o.structRef)(R?P:(0,o.commaOpRef)([P,b()])))}var E=i.row===d.row&&d.row<h.row&&i.row+i.rows===h.row+h.rows,k=i.row===h.row&&d.row+d.rows>h.row+h.rows&&i.row+i.rows===d.row+d.rows;if(E||k){var O=(0,o.specialRef)(E?o.SpecialRefId.Headers:o.SpecialRefId.Data,!0),A=(0,o.specialRef)(E?o.SpecialRefId.Data:o.SpecialRefId.Totals,!0);return(0,o.structRefNode)(C,(0,o.structRef)(R?(0,o.commaOpRef)([O,A]):(0,o.commaOpRef)([O,A,b()])))}}}}(e,t,r))&&void 0!==s?s:function(e,t,r){var n,i=t.originSheet.value,a=w(t.originGridCell.value,r.range);if(void 0===i.index||!(0,u.isSheetIndexEqual)(i,r.sheet)){var s=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,v.isSuccess)(s))throw new F(s.reason);n=(0,o.sheetQualifier)(s.value)}return(0,o.cellRefNode)(a,n)}(e,t,r))}catch(e){return e instanceof F?(0,v.failure)(e.reason):(0,v.failure)((0,v.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{var n=r.kind===c.LexicalKind.Cell||r.kind===c.LexicalKind.Range?(0,R.printLocalsGrid)(r,(0,u.sheetGridRangeAnchor)(r.range)):r.kind===c.LexicalKind.NameManager?(0,R.printLocalsName)(r,T):(0,l.assertNever)("calc.lang.anonymizeFormula",r),i=M((0,R.createSimplePrintGlobals)((0,d.calcConfig)((0,d.getEnglishLocaleInfo)(),o.RefStyle.A1,e.mathpack)),n,t,!0);if(i.kind===v.ResultKind.Success)return i.value;if(i.reason.kind===v.ReasonKind.JavaScriptError)throw i.reason.error}catch(e){var a="calc.lang.anonymizeFormula: Format failed: "+(0,m.messageFromError)(e);l.ulsLogger.ULS.traceTag(556863706,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,a)}return(0,f.anonymize)(t)};var B={getNamedRanges:function(){return(0,l.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};t.createPrinter=function(e){var t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:B.getNamedRanges}}(e);return{printFormula:function(t,r){return M(e,t,r)},printRange:function(e,r,n){return x(t,e,r,n)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(2);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n=r(2);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badMissingNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpNode=t.badFieldRefNode=t.badStructRefNode=t.badSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;var n=r(30),i=r(37),o=r(24),a=r(65);function s(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Sequence,e,t)}function l(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Unexpected,e,t)}function u(e){return function(t){return void 0===t&&(t=0),(0,o.operatorNode)(e,t)}}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){var i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)},t.isNameLocEqual=function(e,t,r){return(0,i.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.expectTrue=function(e){expect(e).toBeTruthy()},t.relPos=function(e){return(0,o.pos)(o.PosKind.Rel,e)},t.absPos=function(e){return(0,o.pos)(o.PosKind.Abs,e)},t.badSeqNode=s,t.badStructRefNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.FieldRef,e,t)},t.badUnexpNode=l,t.badNumberLiteralNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.ParamName,e,t)},t.badMissingNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Missing,e,t)},t.badCellRefNode=function(e,t,r,n){return void 0===t&&(t=e.indexOf("[")>=0),void 0===r&&(r=0),void 0===n&&(n=0),(0,o.cellRefNode)((0,o.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t){return void 0===t&&(t=0),(0,o.badNode)(o.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t){void 0===t&&(t=!0);var r=[l("["),e];return t&&r.push(l("]")),s(r)},t.addNode=u(a.OperatorId.Add),t.subNode=u(a.OperatorId.Sub),t.mulNode=u(a.OperatorId.Mul),t.divNode=u(a.OperatorId.Div),t.powNode=u(a.OperatorId.Pow),t.percentNode=u(a.OperatorId.Percent),t.negNode=u(a.OperatorId.Neg),t.posNode=u(a.OperatorId.Pos),t.concatNode=u(a.OperatorId.Concat),t.eqNode=u(a.OperatorId.Eq),t.neNode=u(a.OperatorId.Ne),t.ltNode=u(a.OperatorId.Lt),t.leNode=u(a.OperatorId.Le),t.gtNode=u(a.OperatorId.Gt),t.geNode=u(a.OperatorId.Ge),t.rangeNode=u(a.OperatorId.Range),t.isectNode=u(a.OperatorId.Isect),t.unionNode=u(a.OperatorId.Union),t.andNode=u(a.OperatorId.And),t.orNode=u(a.OperatorId.Or),t.xorNode=u(a.OperatorId.Xor),t.minNode=u(a.OperatorId.Min),t.maxNode=u(a.OperatorId.Max),t.atNode=u(a.OperatorId.At),t.poundNode=u(a.OperatorId.Pound)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n=r(18);!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),(0,n.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),(0,n.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(t.FillKind||(t.FillKind={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(t.PatternType||(t.PatternType={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),(0,n.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),(0,n.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),(0,n.staticAssertSame)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(152),i=r(154),o=r(282);t.createAnalyzer=function(e){return{checkFormula:function(t,r){return(0,n.checkFormula)(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return(0,n.checkFormulaWithDiagnostics)(e,t,r)},autocorrectFormula:function(t,r){return(0,i.autocorrectFormula)(e,t,r)},resolveStaticPrecedents:function(t,r){return(0,o.resolveStaticPrecedents)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(2);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(2);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;var n=r(0),i=r(22),o=r(67),a=r(26),s=r(19),l=r(102),u=r(156),c=r(155),d=r(52),f=r(51),p=r(38),m=r(39),h=r(103),g=r(157),v={getDocumentLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc")},getSheetIndex:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex")},getSheetName:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName")},getNameLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes")},getContainingTable:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable")},getStructRefColumn:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")}};var S=(0,p.createFailureErrorClass)("ResolveStaticPrecedentsError"),y=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locals=r,i.annotations=n,i.cells=[],i.names=[],i.udfs=[],i.nameSpecial=f.SpecialPrecs.None,i.ownSpecial=f.SpecialPrecs.None,i.resolutions=[],i.globals=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,S,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:v.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:v.getSheetIndex,getSheetName:null!==(a=null===(o=e.getSheetName)||void 0===o?void 0:o.bind(e))&&void 0!==a?a:v.getSheetName,getNameLoc:null!==(l=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:v.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e))&&void 0!==c?c:v.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:v.getSheetRangeIndexes,getContainingTable:null!==(m=null===(p=e.getContainingTable)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:v.getContainingTable,getStructRefColumn:null!==(g=null===(h=e.getStructRefColumn)||void 0===h?void 0:h.bind(e))&&void 0!==g?g:v.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(S=e.getStructRefSpecialRef)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:v.getStructRefSpecialRef}}(t),i.resolver=(0,u.createResolver)(i.globals),i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var o,u,m,h,g=this;if(t.kind===s.NodeKind.WSF){var v=t.id,S=(0,d.getWorksheetFuncType)(v).staticPrecs;switch(v){case d.WorksheetFuncId.LOOKUP:case d.WorksheetFuncId.SUMIF:case d.WorksheetFuncId.AVERAGEIF:var y=function(e){var t=e.label,r=g.resolutions[t],n=(null==r?void 0:r.kind)===c.ResolvedKind.ResolvedCellRef||(null==r?void 0:r.kind)===c.ResolvedKind.ResolvedStructRef?r.resolution:void 0;return(null==n?void 0:n.kind)===a.ResultKind.Success?n.value:void 0};(r.length<3||r[2].kind===s.NodeKind.Literal||r[2].kind===s.NodeKind.Array||(o=r[2],u=v===d.WorksheetFuncId.LOOKUP?r[1]:r[0],m=y(o),h=y(u),void 0!==m&&void 0!==h&&(0,l.isSheetGridRange)(m)&&(0,l.isSheetGridRange)(h)&&(0,p.isDocumentLocEqual)(m.sheet.document,h.sheet.document)&&m.range.rows===h.range.rows&&m.range.cols===h.range.cols))&&(S&=~f.SpecialPrecs.AllCells)}S!==f.SpecialPrecs.None&&(this.ownSpecial|=S)}return e.prototype.appNode.call(this,t,r,n,i)},t.prototype.nameNode=function(t,r,n){var i=this.resolver.resolveDottedName(this.locals,(0,s.nameNode)(t,r,n),this.annotations);this.resolutions[n]=i,(0,o.safePush)(this.names,i.precedents.names),(0,o.safePush)(this.udfs,i.precedents.udfs);var l=i.resolved;switch(l.kind){case c.ResolvedKind.ResolvedName:if(!(0,a.isSuccess)(l.resolution)){this.handleResolutionError(l.resolution.reason);break}void 0!==l.resolution.value&&(this.nameSpecial|=f.SpecialPrecs.All);break;case c.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,a.isSuccess)(l.resolution)){this.handleResolutionError(l.resolution.reason);break}break;case c.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(l.resolution)}return e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i=this.resolver.resolveCellRef(this.locals,(0,s.cellRefNode)(t,r,n));this.resolutions[n]=i;var o=i.resolution;return this.pushResolvedGridRef(o),e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.structRefNode=function(t,r,n){var i=this.resolver.resolveStructRef(this.locals,(0,s.structRefNode)(t,r,n));this.resolutions[n]=i,(0,o.safePush)(this.names,i.precedents);var a=i.resolution;return this.pushResolvedGridRef(a),e.prototype.structRefNode.call(this,t,r,n)},t.prototype.pushResolvedGridRef=function(e){if(e.kind!==a.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){var t=e.value;if((0,l.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=f.SpecialPrecs.OwnDocSheets;var r=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,a.isSuccess)(r))throw new S(r.reason);(0,o.safePush)(this.cells,r.value.sheets.map((function(e){return(0,l.sheetGridRange)((0,l.sheetIndex)(t.sheet.document,e),t.range)})))}}},t.prototype.handleResolutionError=function(e){switch(e.kind){case c.ResolveReasonKind.NoOriginSheet:case c.ResolveReasonKind.InvalidStructRef:case c.ResolveReasonKind.InvalidCellRef:case c.ResolveReasonKind.InvalidQualifier:case c.ResolveReasonKind.EmptyIntersection:return}throw new S(e)},t}(h.IdentityVisitor);t.resolveStaticPrecedents=function(e,t,r){try{var n=new y(e,t,r.annotations);return(0,h.reduceBottomUp)(n,r),(0,a.success)((0,g.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,m.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof S?(0,a.failure)(e.reason):(0,a.failure)((0,a.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(1);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(1);t.buildAnnotations=n.annotations.buildAnnotations},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.ExtractLetVisitor=void 0;var n=r(0),i=r(22),o=r(19),a=r(153),s=r(52),l=r(26),u=r(103),c=r(67),d=r(106);function f(e,t){var r=e[t];return(0,i.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}var p=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.references=[],n}return n.__extends(t,e),t.prototype.letNode=function(t,r,n,i,o,a){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var l=0;l<r.length;l+=1){var u=r[l].binder;if(this.caretInNode(u.arg)){this.pushNames(t.id===s.WorksheetFuncId.LET?r.slice(0,l):r);break}}return e.prototype.letNode.call(this,t,r,n,i,o,a)},t.prototype.lambdaNode=function(t,r,n,i,o,a){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var s=0;s<r.length;s+=1){var l=r[s].name;if(void 0!==l.arg.def&&this.caretInNode(l.arg.def.rhs)){this.pushNames(r.slice(0,s));break}}return e.prototype.lambdaNode.call(this,t,r,n,i,o,a)},t.prototype.caretInNode=function(e){if(void 0===e)return!1;var t=this.formula.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end},t.prototype.pushNames=function(e){(0,c.safePush)(this.references,e.map((function(e){return e.name.arg.whole})).filter(c.isDefined).reverse())},t}(u.IdentityVisitor);function m(e,t,r,s,c,p,m){if(void 0===c&&(c=!1),!(0,l.isSuccess)(e))return!1;try{!function(e,t,r,i,a,s,c){if(null==e||null==i)return;var d={};null!=r?r.forEach((function(e){d[e]=!0})):d["*"]=!0;var p={},m=0,h=[],g=n.__assign(n.__assign({},u.voidVisitor),{letNode:function(t,r,n,i,o,a){for(var s=0,l=r;s<l.length;s++){var u=l[s].name;p[u.arg.label]=m}h.push({letCount:m,span:f(e.spans,a)}),m+=1},lambdaNode:function(t,r,n,i,o,a){for(var s=0,l=r;s<l.length;s++){var u=l[s].name;p[u.arg.label]=m}h.push({letCount:m,span:f(e.spans,a)}),m+=1}});(0,u.reduceBottomUp)(g,e),h.sort((function(e,t){return e.span.start-t.span.start}));for(var v={},S=0;S<h.length;S+=1)v[h[S].letCount]=S;for(var y=0,C=Object.keys(p).map(Number);y<C.length;y++){var R=C[y];p[R]=v[p[R]]}var b={literalNode:function(e,t,r){var n=u.identityVisitor.literalNode(e,t,r);return N("literal")&&i("literal",{label:r,value:n,valueKind:e.kind}),n},arrayNode:function(e,t,r){return u.identityVisitor.arrayNode(e,t,r)},appNode:function(e,t,r,n){var i=u.identityVisitor.appNode(e,t,r,n);return P(e,t,r,n),i},letNode:function(e,t,r,n,a,s){var l=(0,o.letNode)(e,t,r,n,a,s);P(e,l.args,a,s);for(var u=0,c=t;u<c.length;u++){var d=c[u].name;N("letName")&&i("letName",{label:d.arg.label,name:d.arg.whole,number:p[d.arg.label],qualifier:void 0})}return l},lambdaNode:function(e,t,r,n,a,s){var l=(0,o.lambdaNode)(e,t,r,n,a,s);P(e,l.args,a,s);for(var u=0,c=t;u<c.length;u++){var d=c[u].name;N("letName")&&i("letName",{label:d.arg.name.name.label,name:d.arg.whole,number:p[d.arg.label],qualifier:void 0})}return l},parenNode:function(e,t,r){return u.identityVisitor.parenNode(e,t,r)},nameNode:function(t,r,n){var a=(0,o.nameNode)(t,r,n),s=e.annotations[t.label],l=e.annotations[n];if((null==l?void 0:l.kind)===o.AnnotationKind.AppHeadName);else if((null==s?void 0:s.kind)===o.AnnotationKind.LocalNameUse){var u=p[s.label];N("letName")&&null!=u&&i("letName",{label:n,name:s.name,number:u,qualifier:void 0})}else if(N("namedRange")){var c=a.whole.split(".");i("namedRange",{label:n,name:c[0],names:c.slice(1),qualifier:T(a)})}return a},cellRefNode:function(t,r,n){var a=(0,o.cellRefNode)(t,r,n);return N("range")&&function(t){if(null==e||null==i)return;switch(t.ref.kind){case o.CellRefKind.Error:break;case o.CellRefKind.Col:var r=t.ref;i("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:f(e.spans,r.label),qualifier:T(t)});break;case o.CellRefKind.Row:var n=t.ref;i("range",{label:t.label,type:"row",startIndex:n.row1,endIndex:n.row2,span:f(e.spans,n.label),qualifier:T(t)});break;case o.CellRefKind.Single:var a=t.ref;i("range",{label:t.label,type:"cell",row:a.row,col:a.col,span:f(e.spans,a.label),qualifier:T(t)});break;case o.CellRefKind.Range:var s=t.ref;i("range",{label:t.label,type:"range",top:s.ref1.row,left:s.ref1.col,bottom:s.ref2.row,right:s.ref2.col,topLeftSpan:f(e.spans,s.ref1.label),bottomRightSpan:f(e.spans,s.ref2.label),qualifier:T(t)})}}(a),a},fieldRefNode:function(e,t,r,n){return u.identityVisitor.fieldRefNode(e,t,r,n)},structRefNode:function(t,r,n){var a=(0,o.structRefNode)(t,r,n);if(N("structRefRange")){if(null==c||null==s)return a;var u=c.resolveStructRef(s,a).resolution;if(!(0,l.isSuccess)(u)||void 0===u.value)return a;var d=u.value;i("structRefRange",{label:n,type:"range",top:(0,o.pos)(o.PosKind.Rel,d.range.row),left:(0,o.pos)(o.PosKind.Rel,d.range.col),bottom:(0,o.pos)(o.PosKind.Rel,d.range.row+d.range.rows-1),right:(0,o.pos)(o.PosKind.Rel,d.range.col+d.range.cols-1),span:f(e.spans,n),qualifier:void 0!==t?T(t):void 0,name:void 0!==t?t.whole:void 0})}return a},badSequenceNode:function(e,t,r){return u.identityVisitor.badSequenceNode(e,t,r)},badStringNode:function(e,t,r){return u.identityVisitor.badStringNode(e,t,r)},operatorNode:function(e,t){return u.identityVisitor.operatorNode(e,t)},wsfNode:function(e,t,r){return u.identityVisitor.wsfNode(e,t,r)}};function N(e){return d[e]||d["*"]}function T(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case o.QualifierKind.Sheet:var r=e.qualifier;t.type="Sheet",t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case o.QualifierKind.SheetRange:var n=e.qualifier;t.type="SheetRange",t.sheet1=n.sheet1,t.sheet2=n.sheet2,null!=n.document&&(t.document=n.document.document,null!=n.document.path&&(t.documentPath=n.document.path));break;case o.QualifierKind.Ident:var i=e.qualifier;t.type="Ident",t.name=i.name;break;case o.QualifierKind.Document:var a=e.qualifier;t.type="Document",t.document=a.document,null!=a.path&&(t.documentPath=a.path)}return t}}function P(e,t,r,n){if(null!=i)switch(e.kind){case o.NodeKind.Operator:N("operator")&&i("operator",{label:n,value:e.id});break;case o.NodeKind.WSF:case o.NodeKind.Name:N("function")&&i("function",{label:n,name:e.whole,isClosed:r,args:[]})}}(0,u.reduceBottomUp)(b,e)}(e.value,null!=s||(0,a.getEnglishLocaleInfo)(),t,r,0,p,m)}catch(e){var h="ParseResultHelper.traverse: unhandled error ".concat((0,d.messageFromError)(e));i.ulsLogger.ULS.traceTag(540645344,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,h)}return!0}t.ExtractLetVisitor=p,t.parseResultHelper={isSuccess:l.isSuccess,traverse:m,extractReferences:function(e,t,r,n,i){if(void 0===r&&(r=!1),(0,l.isSuccess)(e)){var o=[];return m(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:f(e.value.spans,r.label)};o.push(n)}),t,r,n,i),o.sort((function(e,t){var r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),o}},extractLetVariables:function(e,t){if((0,l.isSuccess)(e))try{var r=new p(e.value,t);return(0,u.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){var n="ParseResultHelper.extractLetVariables: unhandled error ".concat((0,d.messageFromError)(e));return i.ulsLogger.ULS.traceTag(540645343,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,n),[]}}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var i=r(164),o=r(159),a=r(158),s=r(38),l=r(26),u=r(68),c=u.codePointEqualsSign,d=u.codePointPlusSign,f=u.codePointMinusSign,p=u.codePointAtSign,m=((n={})[c]=1,n[d]=0,n[f]=0,n[p]=-1,n);function h(e,t,r,n){var a,s,u,c,d=null!==(s=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==s?s:e.config.localeInfo,f=null!==(c=null===(u=t.config)||void 0===u?void 0:u.refStyle)&&void 0!==c?c:e.config.refStyle,p=e.config.mathpack,m=(0,i.tokenizeFormula)(d,p,f,t.originGridCell.value,r,n,t.syntaxFeatures),h=(0,o.runFormulaParser)(d,p,f,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,m);return(0,l.success)(h)}t.createParser=function(e){return{parseFormula:function(t,r,n){return function(e,t,r,n){void 0===n&&(n=0);try{var i=n>=0&&n<r.length?m[r.charCodeAt(n)]:void 0;return null==i?(0,l.failure)((0,a.notFormulaString)("first character is not '=', '+', '-' or '@'")):i<0?(0,l.failure)((0,s.notImplemented)(["Lotus 1-2-3 syntax"])):h(e,t,r,n+i)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}(e,t,r,n)},parseFormulaExpression:function(t,r,n){return function(e,t,r,n){void 0===n&&(n=0);try{return h(e,t,r,n)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}(e,t,r,n)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isLineBreak=t.isSpace=void 0;var n=r(1);t.isSpace=n.literalParse.isSpace,t.isLineBreak=n.literalParse.isLineBreak,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(2);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(8);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=void 0;var n=r(1);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(1);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(1);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(1);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(2);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(41),i=r(170),o=r(107),a=r(113),s=r(168),l=r(172),u=r(174);t.createNumberFormatter=function(e){return{createFormat:function(t,r){return(0,i.createFormat)(e,t,"boolean"!=typeof r?r:r?n.NumberFormatSource.Builtin:n.NumberFormatSource.CustomString)},applyFormat:function(t,r,n){return(0,i.applyFormat)(e,t,r,n)},changeFormatDecimals:i.changeFormatDecimals,renderValue:function(t,r){return(0,a.renderValue)(e.config.mathpack,t,r)},renderHashesValue:function(e,t){return(0,a.renderHashesValue)(e,t)},renderFormulaBar:function(t,r,n,i){return(0,l.renderFormulaBar)(this,e,t,r,n,i)},parseGeneral:function(t,r,n,i){return(0,u.parseGeneral)(e,t,r,n,i)},parseDate:function(t,r){return(0,u.parseDate)(e,t,r)},parseEdit:function(t,r){return(0,o.parseEdit)(e,t,r)},evalFormat:function(t,r){return(0,s.evalFormat)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=t.formatScientificLeft=void 0;var n=r(1);t.formatScientificLeft=n.mathpack.formatScientificLeft,t.numberComponents=n.mathpack.numberComponents},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(2);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;var n,i=r(0),o=r(72),a=r(42),s=r(71);function l(e,t){return(0,s.buildSingle)(e,o.PictureSingle.ColorStart,"$-",t,o.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(n=t.RibbonFormat||(t.RibbonFormat={})),t.getRibbonFormat=function(e,t,r){var u,c,d=(null!==(c=null===(u=null==r?void 0:r.culture)||void 0===u?void 0:u.calendar)&&void 0!==c?c:a.Calendar.Gregorian)===a.Calendar.Gregorian;switch(t){case n.GalleryGeneral:case n.KeyboardGeneral:return(0,s.getKnownFormat)(e,a.KnownFormat.General);case n.GalleryNumber:return(0,s.buildNumberFormat)(e,!1,1,e.currencyDecimals);case n.KeyboardNumber:return(0,s.buildNumberFormat)(e,!0,4,e.currencyDecimals);case n.GalleryCurrency:var f=i.__assign(i.__assign({},e),{currencyFormat:e.currencyFormat===a.CurrencyFormat.Paren?a.CurrencyFormat.Lead:e.currencyFormat});return(0,s.buildCurrencyFormat)(f,!1,e.currencyDecimals,!0,!1,void 0,!0);case n.KeyboardCurrency:return(0,s.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case n.GalleryAccounting:case n.ButtonAccounting:return(0,s.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case n.GalleryShortDate:return d?(0,s.getKnownFormat)(e,a.KnownFormat.MMDDYY):(0,s.buildSingle)(e,o.PictureSingle.Month,o.PictureSingle.DateSep,o.PictureSingle.Day,o.PictureSingle.Sep,o.PictureSingle.Text);case n.GalleryLongDate:return d?l(e,"x-sysdate")+(0,s.buildSingle)(e,o.PictureSingle.Day,o.PictureSingle.Day,o.PictureSingle.Day,o.PictureSingle.Day,", ",o.PictureSingle.Month,o.PictureSingle.Month,o.PictureSingle.Month,o.PictureSingle.Month," ",o.PictureSingle.Day,o.PictureSingle.Day,", ",o.PictureSingle.Year,o.PictureSingle.Year,o.PictureSingle.Year,o.PictureSingle.Year):(0,s.buildSingle)(e,o.PictureSingle.Month,o.PictureSingle.DateSep,o.PictureSingle.Day,o.PictureSingle.DateSep,o.PictureSingle.Year,o.PictureSingle.Year,o.PictureSingle.Sep,o.PictureSingle.Text);case n.GalleryTime:return l(e,"x-systime")+(0,s.buildSingle)(e,o.PictureSingle.Hour,o.PictureSingle.Colon,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second," ")+(0,s.getSpecial)(e,o.PictureSpecial.AP1);case n.KeyboardDate:return l(e,"en-US")+(0,s.buildSingle)(e,o.PictureSingle.Day,"-",o.PictureSingle.Month,o.PictureSingle.Month,o.PictureSingle.Month,"-",o.PictureSingle.Year,o.PictureSingle.Year,o.PictureSingle.Sep,o.PictureSingle.Text);case n.KeyboardTime:return l(e,"en-US")+(0,s.buildSingle)(e,o.PictureSingle.Hour,o.PictureSingle.Colon,o.PictureSingle.Minute,o.PictureSingle.Minute," ",(0,s.getSpecial)(e,o.PictureSpecial.AP1),o.PictureSingle.Sep,o.PictureSingle.Text);case n.GalleryPercentage:return(0,s.buildPercentFormat)(e,e.currencyDecimals);case n.ButtonPercentage:case n.KeyboardPercentage:return(0,s.getKnownFormat)(e,a.KnownFormat.Pct0);case n.GalleryFraction:return(0,s.getKnownFormat)(e,a.KnownFormat.Fract);case n.GalleryScientific:case n.KeyboardScientific:return(0,s.buildScientificFormat)(e,1,e.currencyDecimals,2);case n.GalleryText:return(0,s.getKnownFormat)(e,a.KnownFormat.Text);case n.ButtonComma:return(0,s.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonFormats=void 0,t.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$-809]#,##0","[$-809]#,##0.00","[$-809]#,##0.00;[Red]\\-[$-809]#,##0.00","[$-809]#,##0;[Red][$-809]#,##0","[$-411]#,##0","[$-2]\\ #,##0.00","[$-2]\\ #,##0.00_);[Red]\\([$-2]\\ #,##0.00\\)","[$-2]\\ #,##0_);[Red]\\([$-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'""#,##0','""#,##0;\\-""#,##0',"\\#,##0_);\\(\\#,##0\\)",'_ ""* #,##0_ ;_ ""* \\-#,##0_ ;_ ""* "-"_ ;_ @_ ','_(""* #,##0_);_(""* \\(#,##0\\);_(""* "-"_);_(@_)','_-""* #,##0_-;\\-""* #,##0_-;_-""* "-"_-;_-@_-','""#,##0.0',"\\#,##0.0_);\\(\\#,##0.0\\)",'""#,##0.00','""#,##0.00;\\-""#,##0.00',"\\#,##0.00_);\\(\\#,##0.00\\)",'_ ""* #,##0.00_ ;_ ""* \\-#,##0.00_ ;_ ""* "-"??_ ;_ @_ ','_(""* #,##0.00_);_(""* \\(#,##0.00\\);_(""* "-"??_);_(@_)','_-""* #,##0.00_-;\\-""* #,##0.00_-;_-""* "-"??_-;_-@_-',"\\#,##0.000_);\\(\\#,##0.000\\)","\\#,##0.0000_);\\(\\#,##0.0000\\)",'_-""* #,##0.0000_-;\\-""* #,##0.0000_-;_-""* "-"??_-;_-@_-','""#,##0.00;[Red]\\-""#,##0.00','""#,##0.00_);[Red]\\(""#,##0.00\\)',"\\#,##0.00_);[Red]\\(\\#,##0.00\\)","\\#,##0.0_);[Red]\\(\\#,##0.0\\)",'""#,##0;[Red]\\-""#,##0','""#,##0_);[Red]\\(""#,##0\\)',"\\#,##0_);[Red]\\(\\#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0""_);\\(#,##0""\\)','_ * #,##0_)""_ ;_ * \\(#,##0\\)""_ ;_ * "-"_)""_ ;_ @_ ','_ * #,##0_)__ ;_ * \\(#,##0\\)__ ;_ * "-"_)__ ;_ @_ ','#,##0""_);[Red]\\(#,##0""\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00""_);\\(#,##0.00""\\)','_ * #,##0.00_)""_ ;_ * \\(#,##0.00\\)""_ ;_ * "-"??_)""_ ;_ @_ ','_ * #,##0.00_)__ ;_ * \\(#,##0.00\\)__ ;_ * "-"??_)__ ;_ @_ ','#,##0.00""_);[Red]\\(#,##0.00""\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --\x3e 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "--\x3e6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IterativeRecalcState=t.cellRead=t.cellWrite=t.rangeWrite=t.TransactionLogMessageKind=t.TransactionLog=t.WriteResultKind=void 0;var n,i=r(0),o=r(14),a=r(175),s=r(21),l=r(44),u=r(17),c=r(9);!function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"}(n=t.WriteResultKind||(t.WriteResultKind={}));var d,f=function(){function e(e){this.state=e}return e.prototype.forEachMeets=function(e,t){var r=this.state[e.sheet.index];void 0!==r&&r.forEachMeets(e.range,t)},e.prototype.setValue=function(t,r){var n,o,s=null!==(o=this.state[t.sheet.index])&&void 0!==o?o:(0,a.makeGridRangeTable)();return new e(i.__assign(i.__assign({},this.state),((n={})[t.sheet.index]=s.setValue(t.range,r),n)))},e.empty=function(){return new e({})},e}(),p=function(){function e(){this.log=[]}return e.prototype.extract=function(){return this.log},e.prototype.lookup=function(t){var r=[];return void 0!==this.current&&(this.current.previousVersions.forEachMeets(t,(function(e,t){return r.push(t),!0})),e.meets(t,this.current.range)&&r.push(this.current)),r},Object.defineProperty(e.prototype,"current",{get:function(){return this.log[this.log.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.log.length},enumerable:!1,configurable:!0}),e.prototype.insert=function(e,t){if(void 0!==this.current){var r={version:this.current.version+1,range:e,message:t,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(r)}else this.log.push({version:0,range:e,message:t,previousVersions:f.empty()})},e.prototype.rollBack=function(t){if(void 0===this.current)return!1;var r=void 0;return this.current.previousVersions.forEachMeets(t,(function(e,t){return(void 0===r||t.version<r.version)&&(r=t),!0})),void 0===r?!!e.meets(t,this.current.range)&&(this.truncLog(this.log.length-1),!0):(this.truncLog(r.version),!0)},e.prototype.truncLog=function(e){this.log.length=(0,s.fastMax)(e,0)},e.meets=function(e,t){return e.sheet.index===t.sheet.index&&(0,c.gridRangeIsects)(e.range,t.range)},e}();function m(e,t){return{kind:d.RangeWrite,range:e,opers:t}}function h(e,t){return{kind:d.CellWrite,cell:e,oper:t}}t.TransactionLog=p,function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"}(d=t.TransactionLogMessageKind||(t.TransactionLogMessageKind={})),t.rangeWrite=m,t.cellWrite=h,t.cellRead={kind:d.CellRead};var g={kind:n.CellWriteLimitReached},v=function(){function e(e){this.transactionLog=new p,this.anchorVisitCounts={},this.workStack=[[e,l.emptyVisitedCells]]}return e.prototype.registerVisibleCells=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.ensureNeedsVisit(i)}return{kind:n.Next,address:this.address}},e.prototype.registerDynamicDependency=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],o={cell:i,previous:this.visitedCells.current,cycle:void 0},a=this.visitedCells.map.getValue(i);if(void 0!==a)return(0,l.recordCellCycle)(a,this.visitedCells.current),{kind:n.CellCycle,cycle:a.cycle};this.workStack.push([i,(0,l.appendVisitedCell)(this.visitedCells,o)]),this.ensureNeedsVisit(i)}return{kind:n.Next,address:this.address}},e.prototype.registerRead=function(){return 0===this.transactionLog.lookup(this.address).length&&this.transactionLog.insert(this.address,t.cellRead),this.next()},e.prototype.writeRange=function(e){var t=this.address,r=t.sheet,n=t.range,i=n.row,a=n.col,s=(0,o.sheetGridRange)(r,(0,o.gridRange)(i,a,e.length,e[0].length));return this.write(s,m(s,e))},e.prototype.writeCell=function(e){return this.write(this.address,h(this.address,e))},Object.defineProperty(e.prototype,"address",{get:function(){return this.workStack[this.workStack.length-1][0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visitedCells",{get:function(){return this.workStack[this.workStack.length-1][1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this.transactionLog},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remainingWork",{get:function(){return this.workStack},enumerable:!1,configurable:!0}),e.prototype.incrementCellWriteCount=function(e){var t=this.ensureNeedsVisit(e);if(t[1]+=1,t[1]>10)return g},e.prototype.ensureNeedsVisit=function(e){var t,r=this.anchorVisitCounts[e.sheet.index];return void 0===r&&(r=this.anchorVisitCounts[e.sheet.index]={}),r[(0,u.gridRangeAnchorHash)(e.range)]=null!==(t=r[(0,u.gridRangeAnchorHash)(e.range)])&&void 0!==t?t:[e,0]},e.prototype.write=function(e,t){if(this.transactionLog.rollBack(e))return{kind:n.Next,address:this.address};var r=this.incrementCellWriteCount(this.address);return void 0!==r?r:(this.transactionLog.insert(e,t),this.next())},e.prototype.next=function(){for(;this.workStack.length>1;)if(this.workStack.pop(),0===this.transactionLog.lookup(this.address).length)return{kind:n.Next,address:this.address};if(0===this.transactionLog.lookup(this.address).length)return{kind:n.Next,address:this.address};var e=this.unevaluatedVisibleRanges();if((0,s.safePush)(this.workStack,e),e.length>0)return{kind:n.Next,address:this.address};for(var t=[],r=[],i=0,o=this.transactionLog.extract();i<o.length;i++){var a=o[i];switch(a.message.kind){case d.CellWrite:t.push([a.message.cell,a.message.oper]);break;case d.RangeWrite:r.push([a.range,a.message.opers])}}return{kind:n.Done,cellWrites:t,rangeWrites:r}},e.prototype.unevaluatedVisibleRanges=function(){var e=[];for(var t in this.anchorVisitCounts)for(var r in this.anchorVisitCounts[t]){var n=this.anchorVisitCounts[t][r][0];0===this.transactionLog.lookup(n).length&&e.push([n,l.emptyVisitedCells])}return e},e}();t.IterativeRecalcState=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n=r(2);t.copyExcept=n.rTree.copyExcept,t.RTKind=n.rTree.RTKind,t.RTree=n.rTree.RTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(1);t.adjustFormulaOrigin=n.adjust.adjustFormulaOrigin},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.renderFormat=t.initUtilGlobals=t.getValueEditOperKind=t.getFormatString=t.applyValueEdit=void 0;var n=r(5);t.applyValueEdit=n.util.applyValueEdit,t.getFormatString=n.util.getFormatString,t.getValueEditOperKind=n.util.getValueEditOperKind,t.initUtilGlobals=n.util.initUtilGlobals,t.renderFormat=n.util.renderFormat,t.toXLNumber=n.util.toXLNumber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.evalName=t.evalCellsAsync=t.evalCells=t.evalFormula=t.evaluationMachineContext=t.runtimeEvaluationContext=void 0;var n=r(182),i=r(49),o=r(10),a=r(16),s=r(122),l=r(183),u=r(9),c=r(123),d=r(124),f=r(120),p=r(121),m=r(304),h=r(119),g=r(12),v=r(20),S=r(27),y=r(44);function C(e){return{globals:e,timer:(0,h.runtimeTimer)(),machineContext:R(e)}}function R(e){return{globals:e,resolver:(0,l.createResolver)(e),numberFormatter:(0,c.createNumberFormatter)(e),parser:(0,d.createParser)(e),printer:(0,s.createPrinter)(e),analyzer:(0,n.createAnalyzer)(e),createCellEvaluationMachine:f.createCellEvaluationMachine,createFormulaEvaluationMachine:p.createFormulaEvaluationMachine,createCallTermEvaluationMachine:p.createCallTermEvaluationMachine}}function b(e,t,r){var n,s=C(e),l=(0,g.bottomEvalPrecedents)(),c=(0,p.createFormulaEvaluationMachine)(s.machineContext,t.stepConfig,(0,g.evalLocalsSlice)(t),l,y.emptyVisitedCells,y.emptyVisitedNames,v.readOperType,r),d=new h.EvaluationRuntime(s,[c]),f=(0,h.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return function e(t){if(Array.isArray(t)){var r=t[0];if(r.kind===a.ResultKind.Success){if((0,u.isRangeOper)(r.value)||(0,u.isMissingOper)(r.value)){var n="expected ReadOper; given ".concat((0,i.anonymize)(r)),s="calc.runtime.evalFormula: ".concat(n);return(0,o.assertFalse)(s)}return r}return r}return t.kind===a.ResultKind.Paused?(0,S.paused)((function(r){return e(t.resume(r))})):(0,S.breaked)((function(){return e(t.resume())}))}(d.evaluateSync(f))}function N(e,t,r){for(var n=C(e),i=[],o=0;o<r.length;o+=1)i.push((0,f.createCellEvaluationMachine)(n.machineContext,t,y.emptyVisitedCells,r[o],!1));return new h.EvaluationRuntime(n,i)}function T(e,t,r){var n;if(0===r.length)return[];var i=N(e,t.stepConfig,r),o=(0,h.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateSync(o)}function P(e,t,r){var n;if(0===r.length)return Promise.resolve([]);var i=N(e,void 0,r),o=(0,h.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateAsync(o)}function E(e,t,r,n){var i,o=C(e),s=(0,m.createNameEvaluationMachine)(o.machineContext,t.stepConfig,r,n),l=new h.EvaluationRuntime(o,[s]),u=(0,h.createSchedule)(null!==(i=t.schedulerConfig)&&void 0!==i?i:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:t.kind===a.ResultKind.Paused?(0,S.paused)((function(r){return e(t.resume(r))})):(0,S.breaked)((function(){return e(t.resume())}))}(l.evaluateSync(u))}t.runtimeEvaluationContext=C,t.evaluationMachineContext=R,t.evalFormula=b,t.evalCells=T,t.evalCellsAsync=P,t.evalName=E,t.createEvaluator=function(e){return{evalFormula:function(t,r){return b(e,t,r)},evalCells:function(t,r){return T(e,t,r)},evalName:function(t,r,n){return E(e,t,r,n)},evalCellsAsync:function(t,r){return P(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNameEvaluationMachine=void 0;var n=r(49),i=r(10),o=r(16),a=r(85),s=r(14),l=r(13),u=r(12),c=r(44),d=function(){function e(e,t,r,n){this.context=e,this.stepConfig=t,this.name=r,this.origin=n}return e.prototype.evalName=function(){var e=this.context.globals.getNameFormula(this.name,s.NameSource.Plain);if(e.kind===o.ResultKind.Failure)return a.Pledge.reject(e.reason);var t=e.value;if(null==t)return a.Pledge.resolve(void 0);var r=(0,u.bottomEvalPrecedents)(),n=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,u.evalLocalsName)((0,s.lexicalSourceName)(this.name),(0,u.evalLocalsGrid)(this.origin)),r,c.emptyVisitedCells,(0,c.appendVisitedName)(c.emptyVisitedNames,this.name),l.SignatureType.All,t);return a.Pledge.fromMachine(n).catch(this.receiveFailure())},e.prototype.receiveFailure=function(){return function(e){if(e.kind===u.RuntimeInternalReasonKind.Unevaluated){var t="unexpected reason ".concat((0,n.anonymize)(e)),r="calc.runtime.NameEvaluationMachine.receiveFailure: ".concat(t);return(0,i.assertFalse)(r)}return a.Pledge.reject(e)}},e}();t.createNameEvaluationMachine=function(e,t,r,n){return a.Pledge.try((function(){return new d(e,t,r,n).evalName()}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFormulaSubExpressionVolatile=t.getSubstitutedSubExpressionString=t.getFormulaSubExpressionObject=t.getSubExpressionSubspans=t.getSubExpressionSpan=t.getSubExpressionFromFormulaCharacterIndex=void 0;var n=r(9),i=r(14),o=r(118),a=r(124),s=r(62),l=r(181),u=r(122),c=r(28),d=r(74),f=r(10),p=r(13),m=r(16);function h(e,t,r,n,i){switch(r.kind){case s.NodeKind.Let:return function(e,t,r,n,i){for(var o=[],a=0;a<r.args.length;a+=1){var l=t.spans[r.args[a].label];if(l&&n.start>=l.start&&n.end<=l.end){var u=r.args[a];if((n.start>l.start||n.end<l.end)&&(u=h(e,t,r.args[a],n,i)),a===r.args.length-1&&r.args.length%2==1)o.push(u);else if(a%2==1){if(1===a)return u;o.pop(),o.push(u)}else o.push(u),o.push(r.args[a+1]),o.push(u);return(0,s.appNode)(r.head,o,!0,r.label)}o.push(r.args[a])}return i}(e,t,r,n,i);case s.NodeKind.App:case s.NodeKind.Lambda:for(var o=0;o<r.args.length;o+=1){var a=t.spans[r.args[o].label];if(a&&n.start>=a.start&&n.end<=a.end)return h(e,t,r.args[o],n,i)}return i;case s.NodeKind.Array:for(o=0;o<r.nodes.length;o+=1)for(var l=0;l<r.nodes[o].length;l+=1){var u=t.spans[r.nodes[o][l].label];if(u&&n.start>=u.start&&n.end<=u.end)return h(e,t,r.nodes[o][l],n,i)}return i;case s.NodeKind.Paren:var c=t.spans[r.node.label];return c&&n.start>=c.start&&n.end<=c.end?h(e,t,r.node,n,i):i;case s.NodeKind.Bad:case s.NodeKind.CellRef:case s.NodeKind.FieldRef:case s.NodeKind.Literal:case s.NodeKind.Name:case s.NodeKind.Param:case s.NodeKind.StructRef:return i;default:return(0,f.assertNever)("calc.runtime.makeSubstitutions",r)}}t.getSubExpressionFromFormulaCharacterIndex=function(e,t,r,s){var l=(0,a.createParser)((0,o.createParseGlobals)(e)).parseFormula((0,o.parseLocals)(i.LexicalKind.Cell,s.range),r);if((0,m.isSuccess)(l)){var u=l.value;if(!(t<0||t>=r.length))return{formula:u,subexpression:(0,n.getSubExpressionFromPosition)(u,t)}}},t.getSubExpressionSpan=function(e){return e.formula.spans[e.subexpression.label]},t.getSubExpressionSubspans=function(e,t,r){var i=t.formula;return function(e,t,r,i){if((t.kind===s.NodeKind.App||t.kind===s.NodeKind.Let)&&(0,n.isWSFNode)(t.head)&&t.head.id===c.WorksheetFuncId.LET){for(var o=[],a=r.spans[t.label],l=0;l<t.args.length-1;l+=2){var u=0===l?r.spans[t.head.label]:r.spans[t.args[l].label],d=r.spans[t.args[l+1].label];if(a&&u&&d){var p=i.indexOf(e.listSeparator,d.end);p>=0?p+=1:(p=i.indexOf(")",d.end))<0&&(p=d.end);var m=(0,s.formulaSpan)(0===l?u.end+1:u.start,p,"","");o.push(m)}}return o}if(t.kind===s.NodeKind.Name||t.kind===s.NodeKind.CellRef&&void 0===t.qualifier&&t.ref.kind===s.CellRefKind.Bad)return function e(t,r,i,o){switch(r.kind){case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:if((0,n.isWSFNode)(r.head)&&r.head.id===c.WorksheetFuncId.LET)for(var a=0;a<r.args.length;a+=1)if(a%2==0&&a<r.args.length-1){var l=r.args[a],u=r.args[a+1];if(l.kind===s.NodeKind.Name&&o.kind===s.NodeKind.Name&&0===t.stringCompareCI(l.whole,o.whole)||l.kind===s.NodeKind.CellRef&&o.kind===s.NodeKind.CellRef&&void 0===l.qualifier&&void 0===o.qualifier&&l.ref.kind===s.CellRefKind.Bad&&o.ref.kind===s.CellRefKind.Bad&&0===t.stringCompareCI(l.ref.chars,o.ref.chars)){var d=[],p=i.spans[l.label],m=i.spans[u.label],h=i.spans[o.label];if(h&&p&&m&&p.start===h.start&&p.end===h.end)return d.push((0,s.formulaSpan)(p.start,m.end,"","")),d}}else{if((d=e(t,r.args[a],i,o)).length>0)return d}else for(a=0;a<r.args.length;a+=1){if((d=e(t,r.args[a],i,o)).length>0)return d}return[];case s.NodeKind.Array:for(a=0;a<r.nodes.length;a+=1)for(var g=0;g<r.nodes[a].length;g+=1){if((d=e(t,r.nodes[a][g],i,o)).length>0)return d}return[];case s.NodeKind.Paren:return e(t,r.node,i,o);case s.NodeKind.Bad:case s.NodeKind.CellRef:case s.NodeKind.FieldRef:case s.NodeKind.Literal:case s.NodeKind.Name:case s.NodeKind.Param:case s.NodeKind.StructRef:return[];default:return(0,f.assertNever)("calc.runtime.addLETNameSubspans",r)}}(e,r.node,r,t);return[]}(e,t.subexpression,i,r)},t.getFormulaSubExpressionObject=function(e,t,r,n){var s=r;s.startsWith("=")||(s="="+r);var l=(0,a.createParser)((0,o.createParseGlobals)(e)),u=l.parseFormula((0,o.parseLocals)(i.LexicalKind.Cell,n.range),t),c=l.parseFormula((0,o.parseLocals)(i.LexicalKind.Cell,n.range),s);if((0,m.isSuccess)(u)&&(0,m.isSuccess)(c))return{formula:u.value,subexpression:c.value.node}},t.getSubstitutedSubExpressionString=function(e,t,r,n){var o=h(e.localeInfo,t.formula,t.formula.node,r,t.subexpression),a=(0,d.calcConfig)((0,d.getEnglishLocaleInfo)()),c=t.formula,f=c.spans,p=c.annotations,g=c.depthUpperBound,v=(0,u.createPrinter)((0,l.createSimplePrintGlobals)(a)).printFormula((0,l.printLocalsGrid)((0,i.lexicalSourceGrid)(i.LexicalKind.Cell,n),n,a),(0,s.formula)(o,f,p,g));return(0,m.isSuccess)(v)?v.value:""},t.isFormulaSubExpressionVolatile=function(e,t){var r=[];for(r.push(t.subexpression);r.length>0;){var i=r.pop();if(void 0!==i)switch(i.kind){case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:if((0,n.isWSFNode)(i.head)&&0!=((0,c.getWorksheetFuncType)(i.head.id).staticPrecs&(p.SpecialPrecs.Time|p.SpecialPrecs.Calc)))return!0;i.args.forEach((function(e){r.push(e)}));break;case s.NodeKind.Array:i.nodes.map((function(e){return e.map((function(e){r.push(e)}))}));break;case s.NodeKind.FieldRef:r.push(i.lhs);break;case s.NodeKind.Paren:r.push(i.node);break;case s.NodeKind.Bad:case s.NodeKind.CellRef:case s.NodeKind.StructRef:case s.NodeKind.Literal:case s.NodeKind.Name:case s.NodeKind.Param:case s.NodeKind.Operator:break;default:(0,f.assertNever)("calc.runtime.isVolatile",i)}}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomCellEvaluationTest=t.randomTestSheetContents=t.randomTestCellContents=t.randomTestFormula=t.runCellEvaluationTest=t.runMockCellEvaluationTest=t.makeRandomizedTimer=t.abstractEvalCells=t.sheet=t.document=t.makeDirtyCellContents=t.makeFailedCellContents=t.makeFinalCellContents=t.TestCellState=t.SpecialContents=t.locationFormula=t.locationValue=t.parsed=t.compiled=t.makeTestContext=void 0;var n,i,o=r(0),a=r(10),s=r(35),l=r(307),u=r(180),c=r(27),d=r(12),f=r(119),p=r(116),m=r(308),h=r(184),g=r(14),v=r(9),S=r(118),y=r(124),C=r(74),R=r(312),b=r(62),N=r(11),T=r(28),P=r(183),E=r(182),k=r(44),O=r(123),A=r(16),I=r(313),_=r(122),F=r(314),M=r(120),D=r(121);function w(e,r,n,i,a){void 0===a&&(a=!1);var s=r.kind===g.LexicalKind.NameManager?(0,u.analyzeLocalsName)((0,g.sheetGridCell)(t.sheet,n)):(0,u.analyzeLocalsGrid)(r.kind,(0,g.sheetGridCell)(t.sheet,n)),l=e.analyzer.checkFormula(s,i);if((0,A.isSuccess)(l)&&(0,v.isWellFormed)(l.value)){var d=r.kind===g.LexicalKind.NameManager?(0,c.compileLocalsName)(n):(0,c.compileLocalsGrid)(r.kind,n),f=e.compiler.compileFormula(a?o.__assign(o.__assign({},d),{emitStepInfo:a}):d,l.value);if(f.kind===A.ResultKind.Success)return f.value;throw new Error("unexpected result ".concat(JSON.stringify(f)))}throw new Error("not well formed formula ".concat(JSON.stringify(l)))}t.makeTestContext=function(e,t,r){var n=(0,F.createArrayLogger)();(0,R.initCalc)(n,null!=e?e:l.featureEnabledDummyCallback);var i=(0,C.calcConfig)(null!=t?t:(0,C.getEnglishLocaleInfo)(),void 0,r),o={config:i},a={config:i},s={config:i};return{logger:n,config:i,compileGlobals:a,parser:(0,y.createParser)(o),analyzer:(0,E.createAnalyzer)(s),compiler:(0,p.createCompiler)(a)}},t.compiled=w,t.parsed=function(e,t,r,n,i,o,s){void 0===n&&(n=b.RefStyle.A1),void 0===i&&(i=t.kind!==g.LexicalKind.NameManager?(0,v.gridRangeAnchor)(t.range.range):(0,a.assertFalse)("must pass origin for LexicalSourceName")),void 0===o&&(o=!1);var l=e.parser.parseFormula((0,S.parseLocals)(t.kind,i,{refStyle:n},s),r);if(l.kind!==A.ResultKind.Success)throw new Error("unexpected result ".concat(JSON.stringify(l)));return w(e,t,i,l.value,o)},t.locationValue=function(e,t){return{cell:e,oper:t}},t.locationFormula=function(e,t){return{source:e,formula:(0,b.formula)(t,[],[],1)}},function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"}(n=t.SpecialContents||(t.SpecialContents={})),function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"}(i=t.TestCellState||(t.TestCellState={}));var L,x=((L=(0,d.bottomEvalPrecedents)()).bound=N.PrecsBound.Exact,L);function B(e,t,r){return{oper:e,reason:t,state:r,precedents:x}}function U(e){return B(e,void 0,i.Final)}function G(e){return B(e,void 0,i.Dirty)}function K(e){var t=e.row,r=e.col;return"R".concat(t+1,"C").concat(r+1)}function V(e,t){return"number"==typeof t?(0,b.literalNode)(e.config.mathpack.fromNumber(t)):t===n.EvalNotImplemented?(0,b.appNode)((0,b.wsfNode)(T.WorksheetFuncId.RAND,"RAND"),[]):t===n.EvalJavaScriptError?(0,b.appNode)((0,b.wsfNode)(T.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(t)?(0,b.appNode)((0,b.wsfNode)(T.WorksheetFuncId.SUM,"SUM"),t.map(V.bind(void 0,e))):(0,b.cellRefNode)((0,b.cellRefSingle)((0,m.absPos)(t.row),(0,m.absPos)(t.col)))}function j(e,t,r){var o={};for(var s in t){var l=t[s];if(null!=l){var u=l[1];if("number"==typeof u){var d=U(e.config.mathpack.fromNumber(u));o[s]=d}else if(Array.isArray(u)||u===n.FormulaUnavailable||u===n.EvalNotImplemented||u===n.EvalJavaScriptError){d=G(N.blankOper);o[s]=d}else u===n.ValueUnavailable||u===n.ValueMocked||(0,a.assertNever)("calc.runtime.abstractEvalCells, tc",u)}}var f={},p=[];function m(r){var s=K(r),l=t[s];if(null==l)return N.blankOper;var u=l[1];if("number"==typeof u)return e.config.mathpack.fromNumber(u);if(u===n.ValueUnavailable)return c.ReasonKind.Unavailable;var d=o[s];if(null==d&&(d=G(N.blankOper),o[s]=d),d.state===i.Failed)return(0,a.assertTrue)("calc.runtime.makeCellEvaluationTest",null!=d.reason),c.ReasonKind.PreviousFailure;if(d.state===i.Final)return d.oper;var h={cycle:!1};(0,a.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",null==f[s]),f[s]=h,p.push(h);try{switch(u){case n.ValueMocked:return(0,a.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case n.FormulaUnavailable:throw!0}var g=function r(a,s){if("number"==typeof s)return(0,A.success)(e.config.mathpack.fromNumber(s));if(s===n.EvalNotImplemented)return(0,A.failure)({kind:c.ReasonKind.NotImplemented});if(s===n.EvalJavaScriptError)return(0,A.failure)({kind:c.ReasonKind.JavaScriptError});for(var l=[],u=0;u<s.length;u+=1){var d=s[u];if("object"!=typeof d||Array.isArray(d)){var h=r(a,d);if(!(0,A.isSuccess)(h))return h;l.push(e.config.mathpack.toNumber(h.value))}else l.push(d)}var g=function(e){var r=l[e];if("number"==typeof r)return"continue";var a=K(r),s=t[a];if(null!=s&&s[1]===n.ValueUnavailable)return{value:(0,A.failure)({kind:c.ReasonKind.Unavailable})};var u=o[a];if(null!=u&&u.state===i.Failed)return{value:(0,A.failure)({kind:c.ReasonKind.PreviousFailure})};var d=f[a];if(void 0!==d){for(var m=p.findIndex((function(e){return e===d}));-1!==m&&m<p.length;m+=1)p[m].cycle=!0;return{value:(0,A.failure)({kind:c.ReasonKind.CellCycle})}}};for(u=0;u<l.length;u+=1){var v=g(u);if("object"==typeof v)return v.value}var S=0;for(u=0;u<l.length;u+=1){var y=l[u];if("number"!=typeof y){try{m(y)}catch(e){return(0,A.failure)({kind:c.ReasonKind.JavaScriptError})}var C=K(y),R=o[C];if(null!=R){if(R.state===i.Failed)return(0,A.failure)({kind:a.cycle?c.ReasonKind.CellCycle:c.ReasonKind.PreviousFailure});S+=e.config.mathpack.toNumber(R.oper)}}else S+=y}return(0,A.success)(e.config.mathpack.fromNumber(S))}(h,u);return(0,A.isSuccess)(g)?(function(e,t){if(e.state!==i.Dirty){var r="expected dirty cellContent; given ".concat(JSON.stringify(e));(0,a.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFinal: ".concat(r))}e.oper=t,e.state=i.Final}(d,g.value),g.value):(function(e,t){if(e.state!==i.Dirty){var r="expected dirty cellContent; given ".concat(JSON.stringify(e));(0,a.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFailed: ".concat(r))}e.reason=t,e.state=i.Failed}(d,g.reason.kind),g.reason.kind)}finally{delete f[s],p.pop()}}return{evalResults:r.map((function(e){try{return m(e)}catch(e){return c.ReasonKind.JavaScriptError}})),sheetState:o}}function W(e){return"string"==typeof e?c.ReasonKind.PreviousFailure:e}function H(e){return null==e?e:o.__assign(o.__assign({},e),{reason:void 0})}function Q(e,t){for(var r in e){var n=e[r];null!=n&&n.state===i.Dirty&&(delete e[r],delete t[r])}}function q(e,t){var r={};for(var n in e)r[n]=t(e[n]);return r}function z(e){for(var t=[],r=0;r<e;r+=1)t.push(r);return t}function Y(e,t){return null==t?t:"number"==typeof t.row&&"number"==typeof t.col&&1===t.rows&&1===t.cols?"gridCell(".concat(t.row,", ").concat(t.col,")"):128===t.kind&&1===Object.getOwnPropertyNames(t).length?"blankOper":t}function J(e,r,o,l,u,p,m,S){void 0===S&&(S={});var C=function(e,r){var o={},l={};function u(e){var t=o[e];return null==t&&(t=U(N.blankOper),o[e]=t),t}for(var f in r){var p=r[f];if(null!=p){var m=p[0],S=p[1];if("number"==typeof S)u(f).oper=e.config.mathpack.fromNumber(S);else if(Array.isArray(S)||S===n.EvalNotImplemented||S===n.EvalJavaScriptError){u(f).state=i.Dirty;var y=(0,b.formula)(V(e,S),[],[],2);l[f]=w(e,(0,g.lexicalSourceCell)((0,g.sheetGridCell)(t.sheet,m)),m,y)}else if(S===n.ValueMocked||S===n.FormulaUnavailable){u(f).state=i.Dirty}else S===n.ValueUnavailable||(0,a.assertNever)("calc.runtime.makeCellEvaluationTest, tc",S)}}function C(e,t){return(0,d.throwEvaluationError)((0,v.notImplemented)(["RAND"]))}function R(e,t){throw new Error("JavaScript error")}var P={config:e.config,getDocumentLoc:function(e,r){return(0,A.success)(t.document)},getSheetIndex:function(e,r){return(0,A.success)(t.sheet.index)},getSheetName:function(e,t){return(0,A.success)("Sheet1")},getSheetRangeIndexes:function(e){return(0,A.success)((0,g.sheetRangeIndexes)([t.sheet.index],0))},getNameLoc:function(e,t){return(0,A.failure)((0,v.unavailable)(["name at ".concat(JSON.stringify((0,g.nameLoc)(e,t)))]))},getUserDefinedFuncLoc:function(e,t){return(0,A.success)([])},getCellValue:function(e){var t=K(e.range),a=r[t];if(null!=a&&a[1]===n.ValueUnavailable)return(0,A.failure)((0,v.unavailable)(["value at ".concat(t)]));var s=o[t];return null==s?(0,A.success)((0,c.finalValue)(N.blankOper)):s.state===i.Final?(0,A.success)((0,c.finalValue)(s.oper)):s.state===i.Failed?(0,A.failure)((0,c.previousFailure)(e)):(0,A.success)((0,c.pendingValue)(e))},getCellValues:function(e){var t=e.sheet,r=e.range,n=r.row,i=r.col,o=r.rows,a=r.cols,l=void 0,u=(0,s.jaggedArray)(o,a,(function(e,r){var o=P.getCellValue((0,g.sheetGridCell)(t,(0,g.gridCell)(e+n,r+i)));return o.kind===A.ResultKind.Failure?(null==l&&(l=o),(0,c.finalValue)(N.blankOper)):o.value}));return null!=l?l:(0,A.success)(u)},getWorksheetFunc:function(e){if(e===T.WorksheetFuncId.SUM){var t=(0,h.getWorksheetFunc)(e);return null!=t?(0,A.success)(t):(0,A.failure)((0,v.notImplemented)(["SUM"]))}return(0,A.success)(e===T.WorksheetFuncId.RAND?C:R)},getUserDefinedFunc:function(){return(0,A.failure)((0,v.unavailable)(["getUserDefinedFunc"]))},getNameFormula:function(e){return(0,A.failure)((0,v.unavailable)(["name at ".concat(JSON.stringify(e))]))},getCellFormula:function(e){var t=K(e.range),i=r[t];if(null!=i&&i[1]===n.FormulaUnavailable)return(0,A.failure)((0,v.unavailable)(["formula at ".concat(t)]));var o=l[t];return null!=o?(0,A.success)((0,c.cellFormula)((0,g.lexicalSourceCell)(e),o)):(0,A.success)(void 0)},interruptToken:[c.Interrupt.Continue],tryGetHiddenRows:function(e,t,r){return(0,A.success)([])},tryGetHiddenCols:function(e,t,r){return(0,A.success)([])},isInFilterMode:function(e){return(0,A.success)(!1)},getKnownFormat:function(){return(0,A.failure)((0,v.notImplemented)(["getKnownFormat"]))},getIformat:function(){return(0,A.failure)((0,v.notImplemented)(["getIformat"]))},getFormatString:function(){return(0,A.failure)((0,v.notImplemented)(["getFormatString"]))},getRandom:function(){return(0,A.failure)((0,v.notImplemented)(["getRandom"]))},getTime:function(){return(0,A.failure)((0,v.notImplemented)(["getTime"]))},schedulerConfig:{},limits:{},setCellValue:function(e,t){var r=K(e.range),n=o[r];if(null==n)n=U(N.blankOper),o[r]=n;else if(n.state!==i.Dirty){var s="expected dirty cell at ".concat(JSON.stringify(e)," but have ").concat(JSON.stringify(n),"; given ").concat(JSON.stringify(t));(0,a.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellValue: ".concat(s))}n.oper=t,n.state=i.Final},setCellValues:function(e,t){throw new Error("unexpected call to setCellValues")},setCellFailure:function(e,t){if(!(0,v.isSheetGridCell)(e)){var r="expected cell; given range ".concat(JSON.stringify(e));return(0,a.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(r))}var n=K(e.range),s=o[n];if(null==s)s=U(N.blankOper),o[n]=s;else if(s.state!==i.Dirty){r="expected dirty cell at ".concat(JSON.stringify(e)," but have ").concat(JSON.stringify(s),"; given ").concat(JSON.stringify(t));(0,a.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(r))}s.reason=t.kind,s.state=i.Failed},getUsedRange:function(e){return(0,A.success)((0,g.sheetGridRange)(e,(0,g.gridRange)(0,0,g.sheetRows,g.sheetCols)))},getContainingTable:function(){return(0,A.failure)((0,v.notImplemented)(["getContainingTable"]))},getIntersectingTables:function(){return(0,A.failure)((0,v.notImplemented)(["getIntersectingTables"]))},getStructRefColumn:function(){return(0,A.failure)((0,v.notImplemented)(["getStructRefColumn"]))},getStructRefSpecialRef:function(){return(0,A.failure)((0,v.notImplemented)(["getStructRefSpecialRef"]))}};return[t.sheet,o,P]}(e,l),R=C[0],I=C[1],F=C[2];for(var M in S){var D=M;F[D]=S[D](F[D])}for(var L=[l,u,p,m],x=u.map((function(e){return(0,g.sheetGridCell)(R,e)})),B=null!=m?m:z(u.length),G=[],j=0;j<B.length;j+=1)G[B[j]]=j;var J={globals:F,resolver:(0,P.createResolver)(F),numberFormatter:(0,O.createNumberFormatter)(F),parser:(0,y.createParser)(F),printer:(0,_.createPrinter)(F),analyzer:(0,E.createAnalyzer)(F),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createCallTermEvaluationMachine:r.createCallTermEvaluationMachine.bind(r)},X={globals:F,timer:o,machineContext:J},$=[];for(j=0;j<B.length;j+=1){var Z=x[B[j]];$.push(J.createCellEvaluationMachine(J,void 0,k.emptyVisitedCells,Z,!1))}return new f.EvaluationRuntime(X,$).evaluateAsync((0,f.createSchedule)(X.globals.schedulerConfig)).then((function(e){return G.map((function(t){var r=e[t];return r.kind===A.ResultKind.Success?r.value:r.reason.kind}))})).catch((function(e){return null!=e.reason?e.reason.stack:e.stack})).then((function(e){if(Array.isArray(e)){var t=e,r=I,n=p.evalResults,i=p.sheetState;null!=m&&(t=t.map(W),n=n.map(W),function(e,t){Q(e,t),Q(t,e)}(r=q(r,H),i=q(i,H)));try{expect([L,t,r]).toEqual([L,n,i])}catch(e){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:L,testResults:t,testState:r},Y,2)),e}}else expect([L,e]).toEqual([L,void 0])}))}t.makeFinalCellContents=U,t.makeFailedCellContents=function(e,t){return B(e,t,i.Failed)},t.makeDirtyCellContents=G,t.document={path:void 0,name:"Book1"},t.sheet=(0,g.sheetIndex)(t.document,0),t.abstractEvalCells=j,t.makeRandomizedTimer=function(e){return void 0===e&&(e=.5),{doTimeout:function(t){return(0,I.randomFloat)()>e}}},t.runMockCellEvaluationTest=J,t.runCellEvaluationTest=function(e,t,r,n,i,o){return void 0===o&&(o={}),J(e,{createCellEvaluationMachine:M.createCellEvaluationMachine,createFormulaEvaluationMachine:D.createFormulaEvaluationMachine,createCallTermEvaluationMachine:function(e){}},(0,f.runtimeTimer)(),t,r,n,i,o)};function X(e,t,r){void 0===r&&(r=0);var i=(0,I.randomFloat)()*(r<3?1:.625);return i<.05?n.EvalJavaScriptError:i<.1?n.EvalNotImplemented:i<.55?1:o.__spreadArray([],new Array((0,I.randomIndex)(3)+1),!0).map((function(){return(0,I.randomFloat)()<.5?(0,g.gridCell)((0,I.randomIndex)(e),(0,I.randomIndex)(t)):X(e,t,r+1)}))}function $(e,t){for(;;){var r=(0,I.randomFloat)();return r<.1?n.ValueUnavailable:r<.2?n.FormulaUnavailable:X(e,t)}}function Z(e,t){for(var r={},n=0;n<e;n+=1)for(var i=0;i<t;i+=1)if((0,I.randomFloat)()<.5){var o=$(e,t),a=(0,g.gridCell)(n,i);r[K(a)]=[a,o]}return r}t.randomTestFormula=X,t.randomTestCellContents=$,t.randomTestSheetContents=Z,t.randomCellEvaluationTest=function(e,t,r){var n=Z(t,r),i=[];for(var o in n){var a=n[o];null!=a&&(0,I.randomFloat)()<.75&&i.push(a[0])}return[n,i=(0,I.randomShuffled)(i),j(e,n,i),(0,I.randomFloat)()<.5?(0,I.randomShuffled)(z(i.length)):void 0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.ConsoleLogger=t.AssertLogger=void 0;var n=r(2);t.AssertLogger=n.testConfig.AssertLogger,t.ConsoleLogger=n.testConfig.ConsoleLogger,t.featureEnabledDummyCallback=n.testConfig.featureEnabledDummyCallback},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xorNode=t.unionNode=t.subNode=t.sheet1Name=t.sheet1=t.relPos=t.rangeNode=t.powNode=t.poundNode=t.posNode=t.percentNode=t.orNode=t.negNode=t.neNode=t.mulNode=t.minNode=t.maxNode=t.ltNode=t.leNode=t.isectNode=t.isNameLocEqual=t.gtNode=t.geNode=t.expectTrue=t.eqNode=t.document1=t.divNode=t.createSingleRange=t.concatNode=t.badUnexpNode=t.badStructRefNode=t.badStringLiteralNode=t.badSeqNode=t.badQualNode=t.badParamNameNode=t.badNumberLiteralNode=t.badMissingNode=t.badFieldRefNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badCellRefNode=t.badBracketNode=t.atNode=t.andNode=t.addNode=t.absPos=void 0;var n=r(1);t.absPos=n.testUtil.absPos,t.addNode=n.testUtil.addNode,t.andNode=n.testUtil.andNode,t.atNode=n.testUtil.atNode,t.badBracketNode=n.testUtil.badBracketNode,t.badCellRefNode=n.testUtil.badCellRefNode,t.badErrorLiteralNode=n.testUtil.badErrorLiteralNode,t.badFieldNameNode=n.testUtil.badFieldNameNode,t.badFieldRefNode=n.testUtil.badFieldRefNode,t.badMissingNode=n.testUtil.badMissingNode,t.badNumberLiteralNode=n.testUtil.badNumberLiteralNode,t.badParamNameNode=n.testUtil.badParamNameNode,t.badQualNode=n.testUtil.badQualNode,t.badSeqNode=n.testUtil.badSeqNode,t.badStringLiteralNode=n.testUtil.badStringLiteralNode,t.badStructRefNode=n.testUtil.badStructRefNode,t.badUnexpNode=n.testUtil.badUnexpNode,t.concatNode=n.testUtil.concatNode,t.createSingleRange=n.testUtil.createSingleRange,t.divNode=n.testUtil.divNode,t.document1=n.testUtil.document1,t.eqNode=n.testUtil.eqNode,t.expectTrue=n.testUtil.expectTrue,t.geNode=n.testUtil.geNode,t.gtNode=n.testUtil.gtNode,t.isNameLocEqual=n.testUtil.isNameLocEqual,t.isectNode=n.testUtil.isectNode,t.leNode=n.testUtil.leNode,t.ltNode=n.testUtil.ltNode,t.maxNode=n.testUtil.maxNode,t.minNode=n.testUtil.minNode,t.mulNode=n.testUtil.mulNode,t.neNode=n.testUtil.neNode,t.negNode=n.testUtil.negNode,t.orNode=n.testUtil.orNode,t.percentNode=n.testUtil.percentNode,t.posNode=n.testUtil.posNode,t.poundNode=n.testUtil.poundNode,t.powNode=n.testUtil.powNode,t.rangeNode=n.testUtil.rangeNode,t.relPos=n.testUtil.relPos,t.sheet1=n.testUtil.sheet1,t.sheet1Name=n.testUtil.sheet1Name,t.subNode=n.testUtil.subNode,t.unionNode=n.testUtil.unionNode,t.xorNode=n.testUtil.xorNode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(1);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownFormatDefined=t.getSpecial=t.getSingle=t.getKnownFormat=t.getColor=t.englishXLSXKnownFormat=t.buildSingle=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.buildMMDDYYFormat=t.buildFractionFormat=t.buildCurrencyFormat=void 0;var n=r(5);t.buildCurrencyFormat=n.knownFormat.buildCurrencyFormat,t.buildFractionFormat=n.knownFormat.buildFractionFormat,t.buildMMDDYYFormat=n.knownFormat.buildMMDDYYFormat,t.buildNumberFormat=n.knownFormat.buildNumberFormat,t.buildPercentFormat=n.knownFormat.buildPercentFormat,t.buildScientificFormat=n.knownFormat.buildScientificFormat,t.buildSingle=n.knownFormat.buildSingle,t.englishXLSXKnownFormat=n.knownFormat.englishXLSXKnownFormat,t.getColor=n.knownFormat.getColor,t.getKnownFormat=n.knownFormat.getKnownFormat,t.getSingle=n.knownFormat.getSingle,t.getSpecial=n.knownFormat.getSpecial,t.isKnownFormatDefined=n.knownFormat.isKnownFormatDefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(1);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.isCalcInit=t.initCalcThread=t.initCalcInThread=t.initCalcCalled=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=void 0;var n=r(2);t.getCalcAbsUrl=n.config.getCalcAbsUrl,t.getCalcAbsUrlOrThrow=n.config.getCalcAbsUrlOrThrow,t.initCalc=n.config.initCalc,t.initCalcCalled=n.config.initCalcCalled,t.initCalcInThread=n.config.initCalcInThread,t.initCalcThread=n.config.initCalcThread,t.isCalcInit=n.config.isCalcInit,t.maxRetriesForLoadingScript=n.config.maxRetriesForLoadingScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n=r(2);t.randomFloat=n.testUtil.randomFloat,t.randomIndex=n.testUtil.randomIndex,t.randomShuffled=n.testUtil.randomShuffled,t.randomElement=n.testUtil.randomElement},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(2);t.createArrayLogger=n.arrayLogger.createArrayLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FuncContextMock=void 0;var n=r(123),i=r(12),o=r(73),a=r(16),s=function(){function e(e){this.config=e,this.formatter=(0,n.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"calcingArray",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.applyFunction=function(e,t){throw new Error("Method not implemented.")},e.prototype.applyLambda=function(e,t){throw new Error("Method not implemented.")},e.prototype.handleEvaluationError=function(e){throw new Error("Method not implemented.")},e.prototype.coerceOper=function(e,t){throw new Error("Method not implemented.")},e.prototype.parseGeneral=function(e,t){var r,n=this.formatter.parseGeneral(e,!1,t,o.GetTimeKind.NonVolatile);return(0,a.isSuccess)(n)||(0,i.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.formatter.parseDate(e,o.GetTimeKind.NonVolatile);return(0,a.isSuccess)(r)||(0,i.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getCellFormula=function(e){throw new Error("Method not implemented.")},e.prototype.getSheetIndex=function(e,t){throw new Error("Method not implemented.")},e.prototype.getSheetRangePosition=function(e){throw new Error("Method not implemented.")},e.prototype.getSheetRangeIndexes=function(e){throw new Error("Method not implemented.")},e.prototype.getNameFormula=function(e,t){throw new Error("Method not implemented.")},e.prototype.getCellRef=function(e,t,r,n){throw new Error("Method not implemented.")},e.prototype.getStructRef=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpers=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpersAndFormulae=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceOper=function(e,t){throw new Error("Method not implemented.")},e.prototype.dereferenceOpers=function(e,t){throw new Error("Method not implemented.")},e.prototype.isInFilterMode=function(){throw new Error("Method not implemented.")},e.prototype.printFormula=function(e,t){throw new Error("Method not implemented.")},e.prototype.getBinaryOperator=function(e){throw new Error("Method not implemented.")},e.prototype.getUnaryOperator=function(e){throw new Error("Method not implemented.")},e.prototype.parseFormula=function(e,t,r,n){throw new Error("Method not implemented.")},e.prototype.applyFormat=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.getRandom=function(){throw new Error("Method not implemented.")},e.prototype.getTime=function(e){throw new Error("Method not implemented.")},e}();t.FuncContextMock=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(204),i=r(317),o=r(128),a=r(127);function s(e,t){for(var r=e[0],n=e[1],i=t[0],o=t[1],a=[],s=r;s<=i;s++)for(var l=n;l<=o;l++)a.push([s,l,0]);return a}t.detect_errors=function(e,t,r,l){void 0===l&&(l=1/0),t=null!=t?t:i.Colorize.getFormattingDiscount(),r=null!=r?r:i.Colorize.getReportingThreshold(),a.watchdog.arm(l);for(var u={},c=0,d=e.worksheets.map((function(e){if((0,a.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var l=e.usedRangeAddress;l=l.replace(/!(!+)/,"!");var u=new o.Timer("excelint"),c=i.Colorize.process_suspicious(l,e.formulas,e.values),d=(c[0],c[1],c[2],c[3]);(0,a.watchdog)("wd0x7919b4");var f=u.elapsedTime(),p=i.Colorize.adjust_proposed_fixes(d,e.styles,0,0),m=u.elapsedTime(),h=p.map((function(e){(0,a.watchdog)("wd0xfb8f16");var n=e[0],o=e[1],s=e[2],l=e[3],u=-n;return l||(u*=(100-t)/100),100*u>=r?(0,i.tuple)(u,o,s,l):null})).filter((function(e){return null!==e})),g=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},v=u.elapsedTime(),S=h.map((function(t){(0,a.watchdog)("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",i=[],o=[],s=[],l=[],u=[],c=[],d=[],f=[],p=[],m=t[3],h=[g.apply(void 0,t[1]),g.apply(void 0,t[2])],v=0;v<2;v++){var S=t[v+1][0],y=S[1]-1,C=S[0]-1,R=e.formulas[y][C],b=n.ExcelUtils.numeric_constants(R);u.push(b),c.push(c.reduce((function(e,t){return e+t}),0));var N=n.ExcelUtils.all_cell_dependencies(R,C+1,y+1,!1);d.push(N.length);var T=n.ExcelUtils.formulaToR1C1(R,C+1,y+1),P=n.ExcelUtils.column_index_to_name(C+1)+(y+1)+":",E=P+T;s.push(T),l.push(E),i.push(R),o.push(P+R),f.push((R.match(/\$/g)||[]).length),p.push(N)}var k=Math.abs(c[0]-c[1]),O=[];for(v=0;v<p.length;v++)if(p[v].length>0){if("vertical"===r&&0===p[v][0][0]&&-1===p[v][0][1]){O.push("recurrent-formula");break}if("horizontal"===r&&-1===p[v][0][0]&&0===p[v][0][1]){O.push("recurrent-formula");break}}d[0]!==d[1]&&O.push("different-referent-count"),u[0].length!==u[1].length&&(1===Math.abs(u[0].length-u[1].length)?O.push("one-extra-constant"):O.push("number-of-constants-mismatch")),u[0].length>0&&u[1].length>0&&(d[0]+d[1]===0?O.push("both-constants"):d[0]*d[1]==0&&O.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(p[0].sort())!==JSON.stringify(p[1].sort())&&O.push("r1c1-mismatch"),f[0]!==f[1]&&O.push("absolute-ref-mismatch");for(v=0;v<p.length;v++)if(p[v].length>0&&p[v][0][0]*p[v][0][1]!=0){O.push("off-axis-reference");break}return 0===O.length&&O.push("unclassified"),{bin:O,direction:r,sameFormat:m,rangeSizes:h,numbers:c,sameConstants:u[0]===u[1],numeric_difference:k,magnitude_numeric_difference:0===k?0:Math.log10(k),formulas:o,r1c1formulas:l,dependence_vectors:p}})),y=u.elapsedTime(),C=e.formulas.flat().filter((function(e){return e.length>0})).length,R=e.values.flat().filter((function(e){return e.length>0})).length,b=e.values[0].length,N=e.values.length,T=N*b,P=h.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),E=h.map((function(e){return(0,a.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[]})),k=Array.from(new Set(E.flat(1).map((function(e){return JSON.stringify(e)}))));E=k.map((function(e){return JSON.parse(e)}));var O=u.elapsedTime(),A={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:h,exampleFixes:S,suspiciousRanges:h.length,weightedSuspiciousRanges:P,suspiciousCells:E.length,elapsedTimeSeconds:O/1e3,proposedFixesTimeSeconds:f/1e3,adjustProposedFixesTimeSeconds:(m-f)/1e3,adjustFormatProposedFixesTimeSeconds:(v-m)/1e3,exampleFixesTimeSeconds:(y-v)/1e3,numCountingTimeSeconds:(O-y)/1e3,columns:b,rows:N,totalCells:T,numFormulaCells:C,numValueCells:R};return{name:e.sheetName,out:A}})).filter((function(e){return null!==e.out}));c<d.length;c++){var f=d[c],p=f.name,m=f.out;u[p]=m}return{workbookName:e.workbookName,worksheets:u}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numComparator=t.find_all_proposed_fixes=t.Colorize=t.tuple=void 0;var n=r(204),i=r(318),o=r(128),a=r(319),s=r(320),l=r(127),u=r(321);function c(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var f=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,i){(0,l.watchdog)("wd0xea1170");for(var o=JSON.stringify(n.ExcelUtils.baseVector()),a=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},s=[],u=0;u<t.length;u++){(0,l.watchdog)("wd0xa1597b");for(var c=t[u],d=0;d<c.length;d++){(0,l.watchdog)("wd0x0d7fc8");var f=c[d].toString();if(f.length>0){var p=n.ExcelUtils.all_dependencies(u,d,i+u,r+d,t),m=d+r+1,h=u+i+1;if(0===p.length)"="===f[0]&&s.push([[m,h,0],e.distinguishedZeroHash]);else{var g=p.reduce(a);if(JSON.stringify(g)===o)s.push([[m,h,0],g.toString()]);else{var v=this.hash_vector(g).toString();s.push([[m,h,0],v])}}}}}return s},e.color_all_data=function(t){for(var r=[],n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];(0,l.watchdog)("wd0xc22046");var a=o.split(","),s=Number(a[0]),u=Number(a[1]);r.push([[s,u,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,i){for(var o=[],a=0;a<t.length;a++){(0,l.watchdog)("wd0x503d57");for(var s=t[a],u=0;u<s.length;u++){(0,l.watchdog)("wd0x366ad1");var c=s[u].toString();if(c.length>0&&"="!==r[a][u][0])if(Number(c).toString()===c){var d=u+n+1,f=a+i+1;o.push([[d,f,1],e.distinguishedZeroHash])}}}return o},e.identify_ranges=function(e,t){for(var r={},n=0,i=e;n<i.length;n++){var o=i[n];(0,l.watchdog)("wd0x770d8c"),r[o[1]]=r[o[1]]||[],r[o[1]].push(o[0])}for(var a=0,s=Object.keys(r);a<s.length;a++){var u=s[a];(0,l.watchdog)("wd0x84ae4d"),r[u].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,i=1;t||(n=1,i=0);for(var o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];(0,l.watchdog)("wd0xa372ae"),r[s]=[];for(var u=e[s].shift(),c=u,d=0,f=e[s];d<f.length;d++){var p=f[d];p[n]===c[n]&&p[i]===c[i]+1||(r[s].push([u,c]),u=p),c=p}r[s].push([u,c])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=a.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,i,o){for(var a=new Array(t),s=0;s<t;s++)a[s]=new Array(r).fill(0);for(var l=0,u=o;l<u.length;l++){var c=u[l],d=c[0],f=d[0],p=d[1],m=d[2],h=c[1],g=p-i-1,v=f-n-1,S=Number(e.distinguishedZeroHash);1===m||(S=Number(h)),a[g][v]=S}return a},e.stencilize=function(e){return s.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),i=0;i<e;i++)n[i]=new Array(t).fill(0);var o=0,a={};for(i=0;i<e;i++)for(var s=0;s<t;s++)a[r[i][s]]=a[r[i][s]]+1||1,0!==r[i][s]&&(o+=1);for(i=0;i<e;i++)for(s=0;s<t;s++)n[i][s]=a[r[i][s]]/o;var l=0,u=0;for(i=0;i<e;i++)for(s=0;s<t;s++)r[i][s]>0&&(u+=a[r[i][s]]);for(i=0;i<e;i++)for(s=0;s<t;s++)a[r[i][s]]>0&&(l+=this.entropy(a[r[i][s]]/u));Math.log2(o);return n},e.generate_suspicious_cells=function(e,t,r,n,i,o,a){void 0===a&&(a=.01);for(var s=[],l=0,u=0,c=0;c<e;c++)for(var d=0;d<t;d++){var f=d+r+1,p=c+n+1;o[c][d]>0&&(l+=i[c][d],u+=1,o[c][d]<=a&&0!==i[c][d]&&s.push([f,p,o[c][d]]))}var m=l/u;return s.sort((function(e,t){return Math.abs(t[2]-m)-Math.abs(e[2]-m)})),s},e.process_suspicious=function(t,r,i){(0,l.watchdog)("wd0x72fd38");new o.Timer("process_suspicious");var a=n.ExcelUtils.extract_sheet_cell(t),s=(a[0],a[1]),u=n.ExcelUtils.cell_dependency(s,0,0),c=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):c=e.process_formulas(r,u[0]-1,u[1]-1);var f=[],p=[],m=i.length,h=i[0].length;if(i.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var g=n.ExcelUtils.generate_all_references(r,u[0]-1,u[1]-1);f=e.color_all_data(g),p=e.process_values(i,r,u[0]-1,u[1]-1)}var v=e.identify_groups(f),S=e.identify_groups(c),y=[];return i.length<1e4&&(y=e.find_suspicious_cells(m,h,u,r,c,p,1)),d(y,S,v,e.generate_proposed_fixes(S))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var o=t[0],a=t[1],s=n[0],l=n[1],u=i.RectangleUtils.area([[o[0],o[1],0],[a[0],a[1],0]]),c=i.RectangleUtils.area([[s[0],s[1],0],[l[0],l[1],0]]),d=Math.min(u,c),f=Math.max(u,c),p=Math.min(r,e),m=Math.max(r,e),h=Math.abs(m-p)/this.Multiplier;h<1&&(h=1);var g=(1+this.entropydiff(d,f))/(h*d);return g=-g},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],o=n[0],a=n[1],s=e[r][2],l=s[0],u=s[1];t+=i.RectangleUtils.diagonal([[o[0],o[1],0],[a[0],a[1],0]]),t+=i.RectangleUtils.diagonal([[l[0],l[1],0],[u[0],u[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var i in t){if(t[i][1]>t[i][2]){var o=t[i][1];t[i][1]=t[i][2],t[i][2]=o}r[JSON.stringify(t[i][1])]=t[i],n[JSON.stringify(t[i][2])]=t[i]}var a=[],s={};for(var i in t){var l=t[i][0];if(!(-l<e.reportingThreshold/100)){var u=JSON.stringify(t[i][1]),c=JSON.stringify(t[i][2]);if(u in n||c in r){if(!s[u]&&u in n){var d=[-l*JSON.parse(n[u][0]),t[i][1],n[u][1]];a.push(d),s[u]=!0,s[c]=!0;continue}if(!s[c]&&c in r){d=[-l*JSON.parse(r[c][0]),t[i][1],r[c][2]];a.push(d),s[c]=!0,s[u]=!0}}else a.push(t[i])}}return a},e.generate_proposed_fixes=function(e){var t=m(e);return t.sort(c),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];(0,l.watchdog)("wd0x781a33");var i=e[n].slice();e[n]=this.merge_individual_groups(i)}return e},e.merge_individual_groups=function(e){var t=new o.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){(0,l.watchdog)("wd0x0a3668");for(var n=!1,a={},s=[],u=e.slice();u.length>0;)for(var c=u.shift(),d=0;d<u.length;d++)if((0,l.watchdog)("wd0x9cf1d5"),i.RectangleUtils.is_mergeable(c,u[d])){var f=JSON.stringify(c),p=JSON.stringify(u[d]);if(!(f in a)&&!(p in a)){s.push(i.RectangleUtils.bounding_box(c,u[d])),a[f]=!0,a[p]=!0,n=!0;break}}for(d=0;d<e.length;d++)(0,l.watchdog)("wd0x1bc2bb"),JSON.stringify(e[d])in a||s.push(e[d]);if(s.sort(),!n)return s;if(e=s.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),i=Math.abs(e[1]-r),o=e[2];return this.Multiplier*(n+i+o)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var i=e[0];if(100*-i<1)return null;for(var o=e[1].map((function(e){return e.toString().padStart(10,"0")})),a=e[2].map((function(e){return e.toString().padStart(10,"0")})),s=o<a?e[1]:e[2],l=o<a?e[2]:e[1],u=s[0],c=u[0],f=u[1],p=s[1],m=(p[0],p[1],l[0]),h=(m[0],m[1],l[1]),g=h[0],v=h[1],S=c-r-1,y=f-n-1,C=g-r-1,R=v-n-1,b=!0,N=JSON.stringify(t[y][S]),T=y;T<=R;T++)for(var P=S;P<=C;P++){if(JSON.stringify(t[T][P])!==N){b=!1;break}}return d(i,s,l,b)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,i,o,a){return(0,l.watchdog)("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();function p(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function m(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];(0,l.watchdog)("wd0xa287cd"),t[i]=e[i].sort(p).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},i={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];(0,l.watchdog)("wd0xb02b87"),n[s]=r[s].map((function(e,t,r){var n=e[0];e[1];return n})),i[s]=r[s].map((function(e,t,r){e[0];return e[1]}))}var u=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var i=n[r],o=1e6,a=1e6,s=-1e6,l=-1e6,u=0;u<e[i].length;u++){var c=e[i][u][0][0],d=e[i][u][1][0],f=e[i][u][0][1],p=e[i][u][1][1];d>s&&(s=d),c<o&&(o=c),p>l&&(l=p),f<a&&(a=f)}t[i]=[[o,a,0],[s,l,0]]}return t}(e),c=Object.keys(e);h(c,(function(e,t){return u[e][0][0]-u[t][0][0]}));var d=c.map((function(e,t,r){return u[e]})),f=Object.keys(e);h(f,(function(e,t){return u[e][0][1]-u[t][0][1]}));for(var m,S=f.map((function(e,t,r){return u[e]})),y=0,C=Object.keys(e);y<C.length;y++){s=C[y];for(var R=0;R<r[s].length;R++){(0,l.watchdog)("wd0xe37031");var b=v(s,r[s][R],r,c,f,n,i,u,d,S);t=t.concat(b)}}return t=t.map((function(e,t,r){return g(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),m={},t=t.filter((function(e){return!(m[e]=e in m)}))}function h(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}function g(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function v(e,t,r,n,i,o,a,s,l,c){var d,p,m,h=t[0],v=t[1],S=[],y=(0,u.binsearch)(l,t,(function(e,t){return e[0][0]-t[0][0]})),C=(0,u.binsearch)(c,t,(function(e,t){return e[0][1]-t[0][1]}));y>C?(d=n,m=y,p=0):(d=i,m=C,p=1),m>0&&(m-=1);for(var R=function(r){var n=d[r];if(n===e)return"continue";var i=s[n];if(0===p){if(v[0]+1<i[0][0])return"break"}else if(v[1]+1<i[0][1])return"break";if(v[0]+1<i[0][0]||v[1]+1<i[0][1]||i[1][0]+1<h[0]||i[1][1]+1<h[1]);else{var l=function(e,t,r,n){var i=e[0],o=e[1],a=t[0],s=t[1],l=[i-1,s,0],c=[a,o-1,0],d=[a+1,o,0],f=[i,s+1,0],p=[],m=-1;if(-1!==(m=(0,u.strict_binsearch)(n,l,g))&&r[m][1]===o){var h=[r[m],n[m]];p.push(h)}if(-1!==(m=(0,u.strict_binsearch)(n,c,g))&&r[m][0]===i){h=[r[m],n[m]];p.push(h)}if(-1!==(m=(0,u.strict_binsearch)(r,d,g))&&n[m][1]===s){h=[r[m],n[m]];p.push(h)}if(-1!==(m=(0,u.strict_binsearch)(r,f,g))&&n[m][0]===a){h=[r[m],n[m]];p.push(h)}return p}(h,v,o[n],a[n]);l.length>0&&(S=S.concat(l.map((function(r,i,o){return[f.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]}))))}},b=m;b<d.length;b++){if("break"===R(b))break}return S}t.Colorize=f,t.find_all_proposed_fixes=m,t.numComparator=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;var n=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],i=r[1],o=(r[2],e[1]),a=o[0],s=o[1],l=(o[2],t[0]),u=l[0],c=l[1],d=(l[2],t[1]),f=d[0],p=d[1];d[2];return!(n-f>1||u-a>1||i-p>1||c-s>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],i=r[1],o=(r[2],e[1]),a=o[0],s=o[1],l=(o[2],t[0]),u=l[0],c=l[1],d=(l[2],t[1]),f=d[0],p=d[1];d[2];return[[Math.min(n,u),Math.min(i,c),0],[Math.max(a,f),Math.max(s,p),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),o=i[0],a=i[1];i[2];return(o-r+1)*(a-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),o=i[0],a=i[1],s=(i[2],o-r+1),l=a-n+1;return Math.sqrt(s*s+l*l)},e.overlap=function(e,t){var r=e[0],n=r[0],i=r[1],o=(r[2],e[1]),a=o[0],s=o[1],l=(o[2],t[0]),u=l[0],c=l[1],d=(l[2],t[1]),f=d[0],p=d[1];d[2];return(a>f?f-n+1:a-u+1)*(s>p?p-i+1:s-c+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;var n=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];r[o]=e.clone(t[o])}return r}return t}return null},e}();t.JSONclone=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0;var n=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var i=e[n]/t;0!==i&&(r-=i*Math.log2(i))}return r/Math.log2(t)},e}();t.InfoGain=n;var i=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,i,o,a){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var s=o,l=0;l<t.length;l++){var u=t[l],c=u[0];s=a(s,r[n+u[1]][i+c])}return s},e.stencil_computation=function(t,r,n){e.initialize();for(var i=t.length,o=t[0].length,a=Array(i).fill(0).map((function(){return Array(o).fill(0)})),s=1;s<o-1;s++)for(var l=1;l<i-1;l++)a[l][s]=e.apply_stencil(e.stencil,t,s,l,n,r);for(l=1;l<o-1;l++)a[0][l]=e.apply_stencil(e.stencil_top,t,0,l,n,r),a[i-1][l]=e.apply_stencil(e.stencil_bottom,t,i-1,l,n,r);for(s=1;s<i-1;s++)a[s][0]=e.apply_stencil(e.stencil_left,t,s,0,n,r),a[s][o-1]=e.apply_stencil(e.stencil_right,t,s,o-1,n,r);return a[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),a[0][o-1]=e.apply_stencil(e.stencil_topright,t,0,o-1,n,r),a[i-1][0]=e.apply_stencil(e.stencil_bottomleft,t,i-1,0,n,r),a[i-1][o-1]=e.apply_stencil(e.stencil_bottomright,t,i-1,o-1,n,r),a},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=i},function(e,t,r){"use strict";function n(e,t,r){for(var n=0,i=e.length;n<i;){var o=Math.floor((n+i)/2);r(e[o],t)<0?n=o+1:i=o}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),n(e,t,r)},t.strict_binsearch=function(e,t,r){void 0===r&&(r=void 0);var i=n(e,t,r);return i===e.length||0!==r(e[i],t)?-1:i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.definedNameInfoDefinitions=void 0,t.definedNameInfoDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},enums:[{name:"DefinedNameInfoType",values:[{name:"Invalid",value:-1},{name:"Table",value:0},{name:"NamedRange",value:1}]}],pods:[{name:"DefinedNameInfo",fields:[{name:"name",type:"string"},{name:"tooltip",type:"string"},{name:"namedRange",type:"DefinedNameInfoRange"},{name:"sheetName",type:"string"},{name:"type",type:"DefinedNameInfoType"}]},{name:"DefinedNameInfoRange",fields:[{name:"top",type:"number-int"},{name:"left",type:"number-int"},{name:"bottom",type:"number-int"},{name:"right",type:"number-int"},{name:"maxRows",type:"number-int"},{name:"maxColumns",type:"number-int"},{name:"sheetName",type:"string"}]}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderDefinitions=void 0,t.dynamicPluginLoaderDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},interfaces:[{name:"DynamicPluginLoaderBase",comment:["Base type for both kinds of plugin loaders (main and other thread).","Instantiate `PluginParam` with a type wide enough to include any plugin factory's parameter."],genericParameterDefinitions:["PluginParam"],methods:[{name:"loadPluginScript",parameters:[{name:"identifier",type:"string"},{name:"isLocalized",type:"boolean"}],async:!0},{name:"createAndAttachPlugin",parameters:[{name:"factoryName",type:"PluginFactoryName"},{name:"param",type:"PluginParam"}],async:!0}]},{name:"DynamicPluginLoader",comment:"Allows loading plugins, and creating threads that load plugins.",genericParameterDefinitions:["PluginParam"],extends:[{type:"DynamicPluginLoaderBase",genericParameters:["PluginParam"]}],methods:[{name:"isThreadingSupported",returnType:"boolean"},{name:"createPluginThread",parameters:[{name:"pluginThreadName",type:"string"}],returnType:{type:"DynamicPluginLoaderThread",genericParameters:["PluginParam"]},async:!0}]},{name:"DynamicPluginLoaderThread",comment:"Client-facing interface to a plugin thread.",genericParameterDefinitions:["PluginParam"],extends:[{type:"DynamicPluginLoaderBase",genericParameters:["PluginParam"]}],methods:[{name:"close"}]}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(t.MajorityDataType||(t.MajorityDataType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaAssistanceDefinitions=void 0,t.formulaAssistanceDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},enums:[{name:"CompletionItemKind",nameLookup:"TypeScript",comment:"taken from LSP. Do *not* change the values, but pick the correct ones from the spec.",values:[{name:"Function",value:3},{name:"NamedRange",value:100},{name:"TableHeader",value:101},{name:"LetVariable",value:102},{name:"RichEntity",value:103},{name:"Lambda",value:104},{name:"CustomFunction",value:105},{name:"Table",value:106},{name:"TableSpecialStructRef",value:107},{name:"RichEntityEmptyCellRef",value:108},{name:"RangeRef",value:109}]},{name:"SuggestionKind",nameLookup:"TypeScript",values:[{name:"Simple",value:0},{name:"Smart",value:1}]},{name:"DiagnosticSeverity",nameLookup:"TypeScript",comment:"take from LSP https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnosticSeverity, do *not* change the values, but pick the correct ones from the spec.",values:[{name:"Error",value:1},{name:"Warning",value:2},{name:"Information",value:3},{name:"Hint",value:4}]},{name:"DiagnosticTag",nameLookup:"TypeScript",comment:"take from LSP https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnosticTag , do *not* change the values, but pick the correct ones from the spec.",values:[{name:"Unnecessary",value:1},{name:"Deprecated",value:2}]},{name:"CodeActionKind",nameLookup:"TypeScript",comment:"take from LSP https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeActionKind . Spec defines this as string and then defines own values, we use standard enum instead.",values:[{name:"Empty",value:0},{name:"QuickFix",value:1},{name:"Refactor",value:2},{name:"RefactorExtract",value:3},{name:"RefactorInline",value:4},{name:"RefactorRewrite",value:5},{name:"Source",value:6},{name:"SourceOrganizeImports",value:7,comment:"including for completeness but not relevant for spreadsheets"},{name:"SourceFixAll",value:8}]},{name:"RepairItemPartType",nameLookup:"TypeScript",values:[{name:"None",value:0},{name:"Added",value:1},{name:"Removed",value:2},{name:"Replaced",value:3}]}],pods:[{name:"FunctionRenderingInfo",comment:"All data representing a function for the argument assistance card.",fields:[{name:"functionName",type:"string",comment:"Function name"},{name:"functionDescription",type:"string",comment:"Function description"},{name:"signatures",type:"FunctionSignature[]",comment:"Array of all function signatures"},{name:"activeSignature",type:"number-int",comment:"Current active function signature",nullable:!0},{name:"listSeparator",type:"string",comment:"The list separator for the current locale"},{name:"isUDF",type:"boolean",comment:"Indicates whether a user defined function"},{name:"helpID",type:"string",comment:"Link for the extended help for this function"}]},{name:"FunctionSignature",comment:"Represents all function signatures, with all the info specific to it",fields:[{name:"signatureParams",type:"Parameters",comment:"Function signature parameters"},{name:"exampleParams",type:"Parameters",comment:"Function example parameters"},{name:"descriptionParams",type:"Parameters",comment:"Parameters to be described"},{name:"descriptions",type:"string[]",comment:"Description of each function parameter"},{name:"exampleDescription",type:"string",comment:"Description of the function example"}]},{name:"Parameters",comment:"Represents a group of parameters, and which one is active",fields:[{name:"params",type:"string[]",comment:"Function parameters"},{name:"activeParam",type:"number-int",comment:"Current active parameter in the group"}]},{name:"Position",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#position",fields:[{name:"line",type:"number-int",comment:"should be uint, according to spec, but the generator doesn't support the type."},{name:"character",type:"number-int",comment:"should be uint, according to spec, but the generator doesn't support the type."}]},{name:"LSPRange",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#range",fields:[{name:"start",type:"Position"},{name:"end",type:"Position"}]},{name:"TextEdit",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#textEdit",fields:[{name:"range",type:"LSPRange"},{name:"newText",type:"string"}]},{name:"AnyObject1",fields:[]},{name:"Data",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#data",fields:[{name:"type",type:"string"},{name:"value",type:"AnyObject1"}]},{name:"CompletionItem",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#completionItem",fields:[{name:"label",type:"string"},{name:"textEdit",type:"TextEdit"},{name:"evaluation",type:"string"},{name:"kind",type:"CompletionItemKind"},{name:"type",comment:"Excel-specific extension, consider removing if we find a better LSP mapping.",type:"SuggestionKind",nullable:!0},{name:"detail",type:"string"},{name:"isPrefixed",type:"boolean",nullable:!0},{name:"shouldRequestAutocompleteOnCommit",comment:"Whether an autocomplete request should be sent upon commiting this completion item",type:"boolean",nullable:!0}]},{name:"CompletionList",comment:"from LSP: https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#completionList",fields:[{name:"items",type:"CompletionItem[]"},{name:"data",type:"Data"}]},{name:"Diagnostic",comment:"from https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnostic",fields:[{name:"range",type:"LSPRange"},{name:"severity",type:"DiagnosticSeverity",nullable:!0},{name:"code",type:"number-int",comment:"type is integer | string, we opt for number-int and leave string description to codeDescription"},{name:"codeDescription",type:"CodeDescription"},{name:"source",type:"string"},{name:"message",type:"string"},{name:"tags",type:"DiagnosticTag[]",nullable:!0},{name:"data",type:"string",comment:"spec type is unknown"}]},{name:"CodeDescription",comment:"from https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeDescription",fields:[{name:"href",type:"string",comment:"true spec type is URI type"}]},{name:"CodeAction",comment:"from https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#codeAction . We skip WorkspaceEdit.",fields:[{name:"title",type:"string"},{name:"kind",type:"CodeActionKind"},{name:"diagnostics",type:"Diagnostic[]"},{name:"isPreferred",type:"boolean",nullable:!0},{name:"disabled",type:"DisabledReason"},{name:"textEdit",type:"TextEdit",comment:"spec defines command, but we don't have a general use case for that yet. Using TextEdit as an initial case."},{name:"data",type:"string",comment:"spec type is LSPAny"}]},{name:"DisabledReason",comment:"Not an actual specification type, but LSP defines `disabled` in CodeAction as object literal",fields:[{name:"reason",type:"string"}]},{name:"ArgumentProp",comment:"Function-param data for the function arguments dialog",fields:[{name:"name",type:"string"},{name:"description",type:"string"},{name:"type",type:"string"},{name:"isOptional",type:"boolean"}]},{name:"FormulaRepairResult",fields:[{name:"diagnostics",type:"string"},{name:"description",type:"string"},{name:"formula",type:"string"},{name:"repairs",type:"RepairItem[]"}]},{name:"RepairItem",fields:[{name:"text",type:"string"},{name:"repairedFormulaParts",type:"RepairItemPart[]"},{name:"originalFormulaParts",type:"RepairItemPart[]"}]},{name:"RepairItemPart",fields:[{name:"type",type:"RepairItemPartType"},{name:"location",type:"Location"}]},{name:"Location",fields:[{name:"start",type:"number-int"},{name:"end",type:"number-int"}]}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pluginSchedulerFactoryDefinition=void 0,t.pluginSchedulerFactoryDefinition={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},factory:{name:"PluginSchedulerSingleton",module:"../x10-formula-bar/schedulerExports",methods:[{name:"instance",parameters:[],returnType:"PluginScheduler"}]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schedulerInterfaceDefinitions=void 0,t.schedulerInterfaceDefinitions={config:{scriptSharpNamespace:"Microsoft.Office.Excel.WebUI.Client",webpackChunkName:"excelOnlineCalc",typescriptInterfaceStartsWithI:!0},enums:[{name:"EditorMessageType",values:[{name:"FunctionMessage",value:0}],nameLookup:"ScriptSharpAndTypeScript"},{name:"MessageType",values:[{name:"Insert",value:0},{name:"Delete",value:1},{name:"Replace",value:2}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginFactoryName",values:[{name:"TestPlugin",value:0},{name:"AutocompletePlugin",value:1},{name:"DragPlugin",value:2},{name:"ConfigTestPlugin",value:3},{name:"ArgumentAssistancePlugin",value:4},{name:"FeatureGateTestPlugin",value:5},{name:"DNMTraceTagTestPlugin",value:7},{name:"ParenthesesCouplingPlugin",value:8},{name:"AutocompleteFunctionPlugin",value:9},{name:"AutocompleteLetPlugin",value:10},{name:"AutocompleteRichValuePlugin",value:11},{name:"AutocompleteNamedObjectsPlugin",value:12},{name:"AutocompleteTableHeadersPlugin",value:13},{name:"ColoredReferencesPlugin",value:14},{name:"ValuePreviewPlugin",value:15},{name:"AutocompleteRangeSuggestionPlugin",value:16},{name:"SyntaxErrorsPlugin",value:17},{name:"AutocompletePrecisionMeasurements",value:1e3},{name:"AutocompleteGroundTruthMeasurements",value:1002},{name:"FormulaCollectionPlugin",value:1004},{name:"ParserPerformanceMeasurements",value:1005},{name:"AutocompleteAuthoringPrecisionMeasurements",value:1006},{name:"FormulaRepairShadowEvalPlugin",value:1007},{name:"PythonAutocompletePlugin",value:1008},{name:"AutocompleteWrapperPlugin",value:1009},{name:"AutocompleteBinaryModelExperimentPlugin",value:1010},{name:"ChangeGateTestPlugin",value:2e3},{name:"SlowTestPlugin",value:2001},{name:"EvalOnCloneTestPlugin",value:2002},{name:"EvalFormulaTestPlugin",value:2003},{name:"PythonTestPlugin",value:2004},{name:"ChatGPTPlugin",value:2005}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginGroup",values:[{name:"Excel",value:0},{name:"Python",value:1}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginAttachGroup",comment:"We have various attach groups. By default, plugins are in the `Core` group unless put elsewhere. The `Core` group has an opt-out behavior, whilst the others have opt-in. This convention is enforced statically.",values:[{name:"Core",value:0},{name:"Python",value:1},{name:"SmartSuggestionsAutoComplete",value:2}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PluginSchedulerResultKind",values:[{name:"Done",value:0,comment:"The scheduler has provided the final message"},{name:"Superseded",value:1,comment:"The event was abandonned due to another one. You are guaranteed to receive another response shortly."}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PerCharacterExperimentResultKind",values:[{name:"AutocompleteWrapperPluginResult",value:0}],nameLookup:"ScriptSharpAndTypeScript"},{name:"HighlightKind",values:[{name:"CellRef",value:0},{name:"StructRef",value:1},{name:"NamedRange",value:2},{name:"Parentheses",value:3}],nameLookup:"ScriptSharpAndTypeScript"},{name:"PositionKind",values:[{name:"Absolute",value:0},{name:"Relative",value:1}],nameLookup:"ScriptSharpAndTypeScript"},{name:"ValuePreviewResultKind",values:[{name:"Failure",value:0},{name:"Success",value:1},{name:"Unavailable",value:2}],nameLookup:"ScriptSharpAndTypeScript"}],interfaces:[{name:"ChatGPTSession",methods:[{name:"send",parameters:[{name:"message",type:"string"}],async:!0,returnType:{type:"string"}},{name:"close",parameters:[],async:!0}]},{name:"ChatGPTProvider",methods:[{name:"createChatGPTSession",parameters:[{name:"options",type:"AnyObject"}],async:!0,returnType:{type:"ChatGPTSession"}}]},{name:"Notifier",methods:[{name:"setActiveCell",parameters:[{name:"notification",type:"CellMessage"}]},{name:"doNothing",parameters:[{name:"notification",type:"string"}]},{name:"setFunctionsInfo",parameters:[{name:"functionsInfo",type:"FunctionInfo[]"}]},{name:"setDefinedNamesInfo",parameters:[{name:"definedNamesInfo",type:"DefinedNameInfo[]"}]},{name:"notifyWorkbookClosing"}]},{name:"ObsoleteRequester",methods:[{name:"functionSuggestion",parameters:[{name:"request",type:"FunctionSuggestionRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["SuggestionResult"]}},{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaHighlightingResult"]}},{name:"argumentAssistance",parameters:[{name:"request",type:"ArgumentAssistanceRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionRenderingInfo"]}},{name:"runExperiment",parameters:[{name:"request",type:"RunExperimentRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runAuthoringExperiment",parameters:[{name:"request",type:"RunAuthoringExperimentRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runTest",parameters:[{name:"request",type:"RunTestRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["AnyObjectResults"]}},{name:"chatGPTQuery",parameters:[{name:"request",type:"ChatGPTRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ChatGPTResult"]}}]},{name:"Requester",methods:[{name:"functionSuggestion",parameters:[{name:"request",type:"FunctionSuggestionRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["SuggestionResult"]}},{name:"inCellSuggestion",parameters:[{name:"request",type:"InCellSuggestionRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["InCellSuggestionResult"]}},{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaHighlightingResult"]}},{name:"argumentAssistance",parameters:[{name:"request",type:"ArgumentAssistanceRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionRenderingInfo"]}},{name:"runExperiment",parameters:[{name:"request",type:"RunExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runAuthoringExperiment",parameters:[{name:"request",type:"RunAuthoringExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunExperimentResults"]}},{name:"runPerCharacterExperiment",parameters:[{name:"request",type:"RunPerCharacterExperimentRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["RunPerCharacterExperimentResults"]}},{name:"runTest",parameters:[{name:"request",type:"RunTestRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["AnyObjectResults"]}},{name:"valuePreview",parameters:[{name:"request",type:"ValuePreviewRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ValuePreviewResult"]}},{name:"formulaRepair",parameters:[{name:"request",type:"FormulaRepairRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FormulaRepairResult"]}},{name:"chatGPTQuery",parameters:[{name:"request",type:"ChatGPTRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["ChatGPTResult"]}}]},{name:"ObsoleteSyncRequester",methods:[{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"}],returnType:{type:"FormulaHighlightingResult"}}]},{name:"SyncRequester",methods:[{name:"formulaHighlighting",parameters:[{name:"request",type:"FormulaHighlightingRequest"},{name:"pluginGroup",type:"PluginGroup"}],returnType:{type:"FormulaHighlightingResult"}}]},{name:"ObsoleteBatchRequester",methods:[{name:"functionSuggestionAndArgumentAssistance",parameters:[{name:"functionSuggestionAndArgumentAssistanceRequest",type:"FunctionSuggestionAndArgumentAssistanceRequest"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionSuggestionAndArgumentAssistanceResult"]}}]},{name:"BatchRequester",methods:[{name:"functionSuggestionAndArgumentAssistance",parameters:[{name:"functionSuggestionAndArgumentAssistanceRequest",type:"FunctionSuggestionAndArgumentAssistanceRequest"},{name:"pluginGroup",type:"PluginGroup"}],async:!0,returnType:{type:"PluginSchedulerResult",genericParameters:["FunctionSuggestionAndArgumentAssistanceResult"]}}]},{name:"PluginScheduler",methods:[{name:"notifier",returnType:"Notifier"},{name:"requester",comment:"@obsolete use getRequester now",returnType:"ObsoleteRequester"},{name:"getRequester",returnType:"Requester"},{name:"syncRequester",comment:"@obsolete use getSyncRequester now",returnType:"ObsoleteSyncRequester"},{name:"getSyncRequester",returnType:"SyncRequester"},{name:"recalcServiceAttached",returnType:"void",async:!0},{name:"getFunctionsShortDescriptions",returnType:"functionShortDescriptionsMap"},{name:"batchRequester",comment:"@obsolete use getBatchRequester now",returnType:"ObsoleteBatchRequester"},{name:"getBatchRequester",returnType:"BatchRequester"},{name:"setServerDataProvider",parameters:[{name:"serverDataProvider",type:"ServerDataProvider"}]}]},{name:"PluginSchedulerSingleton",methods:[{name:"instance",parameters:[],returnType:"PluginScheduler"}]},{name:"ServerDataProvider",methods:[{name:"getRichValueFieldListContext",comment:["Returns the fieldInfo data for given range"],async:!0,parameters:[{name:"rangeToQuery",type:"SharedSheetRange"},{name:"dotNotationPath",type:"string"},{name:"singleColumn",type:"boolean"},{name:"findRange",type:"boolean"}],returnType:"FieldInfoListContextData[]"},{name:"getTableColHeaders",comment:["Returns the col header names for a given table"],async:!0,parameters:[{name:"tableName",type:"string"}],returnType:"string[]"}]}],pods:[{name:"PluginSchedulerResult",genericParameterDefinitions:["TPayload"],fields:[{name:"kind",type:"PluginSchedulerResultKind"},{name:"payload",type:"TPayload"}]},{name:"SuggestionResult",extends:"CompletionList",fields:[]},{name:"InCellSuggestionResult",fields:[{name:"completionItem",type:"CompletionItem"},{name:"data",type:"Data"}]},{name:"ChatGPTResult",fields:[{name:"result",type:"string"},{name:"details",type:"string"}]},{name:"AnyObject",fields:[]},{name:"RunExperimentResult",extends:"AnyObject",fields:[]},{name:"RunPerCharacterExperimentResult",fields:[{name:"kind",type:"PerCharacterExperimentResultKind"},{name:"value",type:"AnyObject"}]},{name:"RunPerCharacterExperimentResults",fields:[{name:"results",type:"RunPerCharacterExperimentResult[]"}]},{name:"FormulaHighlightingResult",fields:[{name:"formulaHighlights",type:"FormulaHighlight[]"}]},{name:"RunExperimentResults",fields:[{name:"results",type:"RunExperimentResult[]"}]},{name:"AnyObjectResults",fields:[{name:"results",type:"AnyObject[]"}]},{name:"FunctionSuggestionAndArgumentAssistanceResult",fields:[{name:"functionSuggestion",type:"SuggestionResult"},{name:"argumentAssistance",type:"FunctionRenderingInfo"},{name:"inCellSuggestion",type:"InCellSuggestionResult"}]},{name:"RunExperimentRequest",fields:[]},{name:"RunAuthoringExperimentRequest",fields:[{name:"content",type:"string"},{name:"isCellContentOnlyEqualDuringEdit",type:"boolean"}]},{name:"RunTestRequest",fields:[{name:"content",type:"string"}]},{name:"FunctionSuggestionRequest",extends:"SuggestionRequest",fields:[]},{name:"InCellSuggestionRequest",extends:"SuggestionRequest",fields:[]},{name:"ChatGPTRequest",fields:[{name:"query",type:"string"},{name:"context",type:"AnyObject"}]},{name:"RunPerCharacterExperimentRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int"},{name:"enableAutocompleteWrapperPlugin",type:"boolean"}]},{name:"ArgumentAssistanceRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int"}]},{name:"FunctionSuggestionAndArgumentAssistanceRequest",fields:[{name:"functionSuggestion",type:"FunctionSuggestionRequest"},{name:"argumentAssistance",type:"ArgumentAssistanceRequest"},{name:"inCellSuggestion",type:"InCellSuggestionRequest"}]},{name:"FormulaHighlightingRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int",comment:"The caret position is always at the start of the selection (left for ltr, right for rtl)"},{name:"selectionLength",type:"number-int",nullable:!0}]},{name:"DisplayObject",fields:[{name:"value",type:"string"},{name:"help",type:"string"},{name:"toolTip",type:"string"}]},{name:"FormulaHighlight",fields:[{name:"kind",type:"HighlightKind",comment:"The type of the highlight"},{name:"span",type:"Span",comment:"The index range of the highlight in the formula (start, end)"},{name:"rangeInfo",type:"RangeInfo",comment:"Optional. If the highlight is a reference to a range, contains the range information"}]},{name:"RangeInfo",fields:[{name:"sharedRange",type:"SharedRange"},{name:"positionKindInfo",type:"PositionKindInfo",comment:"Optional. If the range is RangeRef, Contains information about the position kind of the range columns/rows"}]},{name:"PositionKindInfo",fields:[{name:"firstRow",type:"PositionKind"},{name:"firstColumn",type:"PositionKind"},{name:"secondRow",type:"PositionKind"},{name:"secondColumn",type:"PositionKind"}]},{name:"Span",fields:[{name:"start",type:"number-int"},{name:"end",type:"number-int"}]},{name:"CellMessage",fields:[{name:"colIndex",type:"number-int"},{name:"rowIndex",type:"number-int"},{name:"sheetIndex",type:"string"},{name:"docPath",type:"string"},{name:"docName",type:"string"},{name:"formatString",type:"string"},{name:"builtIn",type:"boolean",nullable:!0}]},{name:"functionShortDescriptionsMap",fields:[{name:"descriptionsMap",type:"Map",genericParameters:["number-int","string"]}]},{name:"ValuePreviewRequest",extends:"ContextualText",fields:[]},{name:"ValuePreviewResult",fields:[{name:"kind",type:"ValuePreviewResultKind"},{name:"value",type:"string"},{name:"unformattedValue",type:"string"},{name:"color",type:"AnyObject"},{name:"operKind",type:"number-int",nullable:!0},{name:"evaluatedFormula",type:"string"},{name:"index",type:"number-int"},{name:"length",type:"number-int"}]},{name:"ContextualText",fields:[{name:"text",type:"string"},{name:"index",type:"number-int"},{name:"length",type:"number-int"}]},{name:"SuggestionRequest",fields:[{name:"content",type:"string"},{name:"caretPosition",type:"number-int",comment:"TODO: remove nullable once passed by S#",nullable:!0}]},{name:"FormulaRepairRequest",fields:[{name:"formula",type:"string"}]}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange"}(t.DefinedNameInfoType||(t.DefinedNameInfoType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef"}(t.CompletionItemKind||(t.CompletionItemKind={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(t.SuggestionKind||(t.SuggestionKind={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(t.DiagnosticSeverity||(t.DiagnosticSeverity={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(t.DiagnosticTag||(t.DiagnosticTag={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(t.CodeActionKind||(t.CodeActionKind={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(t.RepairItemPartType||(t.RepairItemPartType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialFormat=void 0,function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known"}(t.SpecialFormat||(t.SpecialFormat={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;var n=r(0),i=r(208),o=r(334),a=r(129),s=function(){function e(e){var t=this;this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(void 0!==t.handle)throw"setImmediate called, even though we already have a callback";return t.setImmediateCalls.push(n.__spreadArray([e],r,!0)),t.handle=(0,a.setImmediateUnified)((function(){return t.handle=void 0,e.apply(void 0,r)}))},this.clearImmediate=function(e){if(t.handle!==e)throw"clearImmediate called with a different handle than the one supplied";(0,a.clearTimerUnified)(t.handle),t.clearImmediateCalls.push([e]),t.handle=void 0},this.setTimeout=function(e,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(void 0!==t.handle)throw"setTimeout called, even though we already have a callback";return t.setTimeoutCalls.push(n.__spreadArray([e,r],i,!0)),t.handle=(0,a.setImmediateUnified)((function(){return t.handle=void 0,e.apply(void 0,i)}))},this.clearTimeout=function(e){if(t.handle!==e)throw"clearTimeout called with a different handle than the one supplied";(0,a.clearTimerUnified)(t.handle),t.clearTimeoutCalls.push([e]),t.handle=void 0}}return e.prototype.now=function(){var e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e},e}();t.MockTimer=s;var l=function(){function e(t,r){void 0===t&&(t=1),void 0===r&&(r=0);var n=this;this.precisionMs=t,this.startTime=r,this.setImmediate=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o={delayUntil:-1,callback:t,args:r,isValid:!0};return n.queue.enqueue(o),new e.Immediate(o)},this.clearImmediate=function(t){if(!(t instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,a.clearTimerUnified)(t)},this.setTimeout=function(t,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=n.time+(r>4?r:4),s={delayUntil:a,callback:t,args:i,isValid:!0};return n.queue.enqueue(s),new e.Timeout(s)},this.clearTimeout=function(t){if(!(t instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,a.clearTimerUnified)(t)},this.time=r>0?r:0,this.queue=new i.PriorityQueue((function(e,t){return e.delayUntil-t.delayUntil}))}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(e){this.time+=e>0?e:0},e.prototype.busyWaitUntil=function(e){this.time=this.time<e?e:this.time},e.prototype.runMacrotasksWhile=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setImmediate((function(){return e()}))}))];case 1:if(r.sent(),!e())return[2];if(!(t=this.queue.pop()))return[2];if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback.apply(t,t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:(0,o.messageFromError)(e),filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}}))}))},e.Immediate=function(e){this.delayedCallback=e,this.kind="Mocking"},e.Timeout=function(e){this.delayedCallback=e,this.kind="Mocking"},e}();t.MockTimerImmediate=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(2);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;var n=r(0),i=r(336);t.runQueueProcessorUntil=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,o,a,s=this;return n.__generator(this,(function(l){switch(l.label){case 0:return r=!1,(o=Promise.resolve(t)).then((function(){return r=!0})),a=0,[4,(0,i.promiseLoop)((function(){return n.__awaiter(s,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return++a%100!=0?[3,2]:[4,new Promise((function(e){return setTimeout(e,1)}))];case 1:t.sent(),t.label=2;case 2:return r?[2,void 0]:(e.step(),[2,!0])}}))}))}),!0)];case 1:return l.sent(),[2,o]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseLoop=t.promiseFinally=t.newPromise=t.isThenable=t.collapseThenable=t.bindMaybeThenable=void 0;var n=r(2);t.bindMaybeThenable=n.promise.bindMaybeThenable,t.collapseThenable=n.promise.collapseThenable,t.isThenable=n.promise.isThenable,t.newPromise=n.promise.newPromise,t.promiseFinally=n.promise.promiseFinally,t.promiseLoop=n.promise.promiseLoop},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchedulerVersion=void 0,function(e){e.Dev="Dev",e.Stable="Stable"}(t.SchedulerVersion||(t.SchedulerVersion={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0,function(e){e.setActiveCell="setActiveCell",e.doNothing="doNothing",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.setFunctionsInfo="setFunctionsInfo",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing"}(t.NotificationKind||(t.NotificationKind={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockGlobals=void 0;var n=r(340),i=r(341),o=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(){return(0,n.failure)((0,i.notImplemented)(["getDocumentLoc"]))},e.prototype.getSheetIndex=function(){return(0,n.failure)((0,i.notImplemented)(["getSheetIndex"]))},e.prototype.getSheetName=function(){return(0,n.failure)((0,i.notImplemented)(["getSheetName"]))},e.prototype.getNameLoc=function(){return(0,n.failure)((0,i.notImplemented)(["getNameLoc"]))},e.prototype.getUserDefinedFuncLoc=function(){return(0,n.failure)((0,i.notImplemented)(["getUserDefinedFuncLoc"]))},e.prototype.getSheetRangeIndexes=function(){return(0,n.failure)((0,i.notImplemented)(["getSheetRangeIndexes"]))},e.prototype.getContainingTable=function(){return(0,n.failure)((0,i.notImplemented)(["getContainingTable"]))},e.prototype.getStructRefColumn=function(){return(0,n.failure)((0,i.notImplemented)(["getStructRefColumn"]))},e.prototype.getStructRefSpecialRef=function(){return(0,n.failure)((0,i.notImplemented)(["getStructRefSpecialRef"]))},e.prototype.getTime=function(){return(0,n.failure)((0,i.unavailable)(["getTime"]))},e}();t.MockGlobals=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(2);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(1);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.Timeline=t.spanToLSPRange=t.indexToLSPPosition=void 0;var n=r(0),i=r(88),o=r(207),a=r(4),s=r(206),l=r(15);function u(e,t){for(var r=0,n=0;n<t;){var o=e.indexOf("\n",n),a=e.indexOf("\r",n),s=o<0?a:a<0?o:(0,i.fastMin)(o,a);if(s<0||s>=t)break;r+=1,n=s+1+(s===a&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-n}}t.indexToLSPPosition=u,t.spanToLSPRange=function(e,t,r){return{start:u(e,t),end:u(e,r)}};var c=function(){function e(e,t,r){void 0===r&&(r=!0),this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=o.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,l.isWorkerThread)(),workerName:(0,l.workerName)()},s.ulsLogger.ULS.traceTag(526223315,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Timeline[".concat(this.name,"]: Initializing, ").concat(JSON.stringify(this.workerInfo)))}return e.prototype.stamp=function(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())},e.prototype.log=function(e){if(this.enabled){this.stamp(e);var t={},r=this.timer.now(),i=0;this.timestamps.forEach((function(e,n){r=Math.min(r,e),i=Math.max(i,e),t[n]=e})),i-r>this.logThreshold&&s.ulsLogger.ULS.traceTag(526234881,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Timeline[".concat(this.name,"]: ").concat(JSON.stringify(n.__assign(n.__assign({},t),this.workerInfo)))),this.timestamps.clear()}},e}();t.Timeline=c,t.spanCompare=function(e,t){var r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeFormat=t.emptyRangeFormula=t.emptyRangeValue=t.FormulaKind=void 0;var n,i=r(0),o=r(344),a=r(345),s=r(88);!function(e){e.Value="Value",e.CellFormula="CellFormula"}(n=t.FormulaKind||(t.FormulaKind={})),t.emptyRangeValue=a.blankOper,t.emptyRangeFormula={kind:n.Value,formulaBarText:"",origin:(0,o.gridCell)(0,0)},(0,s.staticAssertExtends)(),t.emptyRangeFormat=0,t.wrapIntoResumeRecalc=function(e,t){return{evalClonedModelOnSnapshot:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.evalClonedModelOnSnapshot.apply(e,i.__spreadArray([r],n,!1));return t(r),a},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getRangeFormats.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getRangeValues:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getRangeValues.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getRangeFormulae:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getRangeFormulae.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getSheetNames:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getSheetNames.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getIntersectingTables:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getIntersectingTables.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getIformats:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getIformats.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getHiddenRows:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getHiddenRows.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getHiddenCols:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.getHiddenCols.apply(e,i.__spreadArray([r],n,!1));return t(r),a},evalFormulaOnSnapshot:function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=e.evalFormulaOnSnapshot.apply(e,i.__spreadArray([r],n,!1));return t(r),a},getCorrespondingSnapshotID:function(t){return e.getCorrespondingSnapshotID(t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceRange=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(1);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.lexicalSourceRange=n.location.lexicalSourceRange,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(1);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t){function r(e,t,r){return Array(e).fill().map(()=>Array(t).fill(r))}const n={EQUAL:0,INSERT:1,DELETE:2,REPLACE:3};class i{constructor(e,t,r){this.op=e,this.from_elem=t,this.to_elem=r}}function o(e,t,r){let[i,o]=e<=t?[e,n.DELETE]:[t,n.INSERT];return[i,o]=r<=i?[r,n.REPLACE]:[i,o],[i,o]}e.exports={EDIT_OP_ENUM:n,EditOp:i,levenshtein:function(e,t,a,s,l){a=a||(e=>1),s=s||(e=>1),l=l||((e,t)=>e!=t?1:0);const u=e.length,c=t.length,d=r(u+1,c+1,0),f=r(u+1,c+1,null);e.forEach((e,t)=>{d[t+1][0]=t+1}),t.forEach((e,t)=>{d[0][t+1]=t+1});for(let[r,i]of e.entries()){r+=1;for(let[e,u]of t.entries()){e+=1;let t=l(i,u),[c,p]=o(d[r-1][e]+s(i),d[r][e-1]+a(u),d[r-1][e-1]+t);d[r][e]=c,p=p==n.REPLACE&&0==t?n.EQUAL:p,f[r][e]=p}}return[d[u][c],function(e,t,r){const o=e.length,a=t.length,s=[];let l=o,u=a,c=null;for(;l>0&u>0;){const o=r[l][u];switch(o){case n.EQUAL:case n.REPLACE:c=[e[l-1],t[u-1]],l-=1,u-=1;break;case n.INSERT:c=[null,t[u-1]],u-=1;break;case n.DELETE:c=[e[l-1],null],l-=1;break;default:throw Error("Encountered invalid EDIT_OP value")}s.push(new i(o,c[0],c[1]))}for(;u>0&&0==l;)new i(n.INSERT,null,t[u-1]),u-=1;for(;l>0&&0==u;)new i(n.DELETE,e[l-1],null),l-=1;return s.reverse(),s}(e,t,f)]},defaultExcelTokenUpdateCostFn:function(e,t){return e.chars!=t.chars?1:0}}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"checkRequest",(function(){return Pv})),r.d(n,"UiFrameExecutionStopReason",(function(){return Sv})),r.d(n,"ExecutionStopReason",(function(){return Ov})),r.d(n,"ResponseState",(function(){return Av}));var i={};r.r(i),r.d(i,"InternalSchedulerResponseKind",(function(){return kv})),r.d(i,"wrapSyncRequest",(function(){return Iv})),r.d(i,"wrapRequest",(function(){return _v})),r.d(i,"checkSyncRequest",(function(){return Dv}));var o={};r.r(o),r.d(o,"PrefetchingCache",(function(){return NS}));var a={};r.r(a),r.d(a,"createGridProvider",(function(){return OS})),r.d(a,"createGridImportManager",(function(){return AS})),r.d(a,"createPrefetchingCacheFactory",(function(){return IS})),r.d(a,"timelineQueueProcessorFactory",(function(){return _S})),r.d(a,"createFormulaBarScheduler",(function(){return FS})),r.d(a,"createExperimentFormulaBarScheduler",(function(){return MS})),r.d(a,"createTestableFormulaBarScheduler",(function(){return wS})),r.d(a,"createDynamicPluginLoader",(function(){return LS})),r.d(a,"dynamicPluginLoaderInsideInit",(function(){return xS})),r.d(a,"createIGridFromRecalcService",(function(){return BS})),r.d(a,"Cache",(function(){return US})),r.d(a,"SchedulerMessages",(function(){return GS})),r.d(a,"PluginMessages",(function(){return KS}));var s={};r.r(s),r.d(s,"createGridProvider",(function(){return OS})),r.d(s,"createGridImportManager",(function(){return AS})),r.d(s,"createPrefetchingCacheFactory",(function(){return IS})),r.d(s,"timelineQueueProcessorFactory",(function(){return _S})),r.d(s,"createFormulaBarScheduler",(function(){return FS})),r.d(s,"createExperimentFormulaBarScheduler",(function(){return MS})),r.d(s,"createTestableFormulaBarScheduler",(function(){return wS})),r.d(s,"createDynamicPluginLoader",(function(){return LS})),r.d(s,"dynamicPluginLoaderInsideInit",(function(){return xS})),r.d(s,"createIGridFromRecalcService",(function(){return BS})),r.d(s,"Cache",(function(){return US})),r.d(s,"SchedulerMessages",(function(){return GS})),r.d(s,"PluginMessages",(function(){return KS}));var l,u,c=r(2),d=(c.core.makeNewtypeIso,c.core.staticAssertExtends),f=c.core.staticAssertSame,p=c.core.staticAssertIs,m=c.core.staticAssertIsOptional,h=c.core.identity,g=c.core.makeStringMap,v=(c.core.cloneStringMap,c.core.numEnumArray),S=c.core.numEnumMap,y=c.core.strEnumArray,C=c.core.safePush,R=c.core.safeConcat,b=c.core.isDefined,N=c.core.isNone,T=(c.core.filterOutNones,c.core.pair),P=c.core.fastMin,E=c.core.fastMax,k=c.core.fastAbs,O=c.core.makeStringCompareCI,A=c.core.typedInstanceCreator,I=c.core.singleton,_=c.core.mapFromArrayOfPairs,F=c.core.now,M=c.assertions.ulsLogger,D=c.assertions.assertTrue,w=c.assertions.assertFalse,L=c.assertions.assertNever,x=c.assertions.assertNatural,B=c.assertions.assertIndex,U=(c.assertions.assertInteger,c.assertions.assertPositiveInteger),G=c.assertions.assertPositiveLength,K=c.util.arrayFill,V=c.util.isInteger,j=(c.util.mathLog2,c.util.messageFromError),W=(c.util.partialArray,c.util.prependErrorMessage,c.util.repeat,c.util.stringEndsWith),H=c.util.stringStartsWith,Q=(c.util.values,c.deque.Deque),q=c.pledge.Pledge;(u=l||(l={})).fastMin=P,u.fastMax=E,u.fastAbs=k,u.identity=h,u.numEnumArray=v,u.numEnumMap=S,u.safePush=C,u.safeConcat=R,u.isDefined=b,u.isNone=N,u.makeStringMap=g,u.now=F,u.staticAssertExtends=d,u.staticAssertSame=f,u.staticAssertIs=p,u.staticAssertIsOptional=m,u.JSF32=c.JSF32,u.Pledge=q,u.assertNever=L,u.assertNatural=x,u.assertTrue=D,u.assertFalse=w,u.assertPositiveLength=G,u.assertPositiveInteger=U,u.assertIndex=B,u.messageFromError=j,u.isInteger=V,u.stringStartsWith=H,u.stringEndsWith=W,u.arrayFill=K,(u.ds||(u.ds={})).Deque=Q;var z,Y,J,X,$,Z,ee,te,re,ne,ie,oe,ae,se,le,ue,ce=r(8),de=c.featureConfiguration.FeatureName,fe=(c.featureConfiguration.initFeatureConfiguration,c.featureConfiguration.isFeatureEnabled,c.featureConfiguration.getFeatures,c.featureConfiguration.getTypedFeatureGate),pe=c.featureConfiguration.isTypedChangeGateEnabled,me=(c.result.ReasonKind,c.result.ResultKind),he=c.result.failure,ge=c.result.isSuccess,ve=c.result.javaScriptError,Se=c.result.success,ye=c.result.successUndefined,Ce=r(1),Re=Ce.location.LexicalKind,be=Ce.location.NameSource,Ne=Ce.location.allSheetsRange,Te=Ce.location.documentLoc,Pe=Ce.location.documentScope,Ee=Ce.location.gridCell,ke=Ce.location.gridRange,Oe=(Ce.location.isGridCell,Ce.location.isSheetGridCell,Ce.location.isSheetGridRange,Ce.location.isSheetIndex,Ce.location.lexicalSourceCell),Ae=Ce.location.lexicalSourceGrid,Ie=Ce.location.lexicalSourceName,_e=Ce.location.lexicalSourceWSF,Fe=Ce.location.lexicalSourceUDF,Me=Ce.location.lexicalSourceRange,De=Ce.location.nameLoc,we=Ce.location.nameScope,Le=Ce.location.originCell,xe=Ce.location.sheetCols,Be=Ce.location.sheetGridCell,Ue=Ce.location.sheetGridCube,Ge=Ce.location.sheetGridRange,Ke=Ce.location.sheetIndex,Ve=Ce.location.sheetRange,je=Ce.location.sheetRangeIndexes,We=Ce.location.sheetRows,He=Ce.location.structRefColumnLoc,Qe=Ce.location.unsafeGridRange,qe=Ce.location.userDefinedFuncLoc,ze=Ce.value.ErrorType,Ye=Ce.value.PrecsBound,Je=Ce.value.arrayOper,Xe=Ce.value.blankOper,$e=Ce.value.booleanOper,Ze=(Ce.value.cellStringLimit,Ce.value.div0ErrorOper),et=Ce.value.errorOper,tt=Ce.value.falseOper,rt=Ce.value.gettingDataErrorOper,nt=Ce.value.spillErrorOper,it=Ce.value.connectErrorOper,ot=Ce.value.blockedErrorOper,at=Ce.value.unknownErrorOper,st=Ce.value.fieldErrorOper,lt=Ce.value.calcErrorOper,ut=Ce.value.busyErrorOper,ct=Ce.value.externalErrorOper,dt=Ce.value.missingOper,ft=Ce.value.naErrorOper,pt=Ce.value.nameErrorOper,mt=Ce.value.nullErrorOper,ht=Ce.value.numErrorOper,gt=Ce.value.precedents,vt=Ce.value.range3DOper,St=Ce.value.rangeSeqOper,yt=Ce.value.refErrorOper,Ct=Ce.value.stringOper,Rt=Ce.value.trueOper,bt=Ce.value.valueErrorOper,Nt=Ce.formulaModule.SyntaxFeature,Tt=Ce.formulaModule.AnnotationKind,Pt=Ce.formulaModule.BadType,Et=Ce.formulaModule.CellRefKind,kt=Ce.formulaModule.CommentKind,Ot=Ce.formulaModule.NamePartKind,At=Ce.formulaModule.NodeKind,It=Ce.formulaModule.PosKind,_t=Ce.formulaModule.QualifierKind,Ft=Ce.formulaModule.RefStyle,Mt=Ce.formulaModule.SpecialRefId,Dt=Ce.formulaModule.StructRefKind,wt=Ce.formulaModule.appHeadNameAnnotation,Lt=Ce.formulaModule.appNode,xt=Ce.formulaModule.arrayNode,Bt=Ce.formulaModule.badNode,Ut=Ce.formulaModule.badQualifier,Gt=Ce.formulaModule.badRef,Kt=Ce.formulaModule.cellRefBad,Vt=Ce.formulaModule.cellRefCol,jt=Ce.formulaModule.cellRefError,Wt=Ce.formulaModule.cellRefNamePart,Ht=Ce.formulaModule.cellRefNode,Qt=Ce.formulaModule.cellRefRange,qt=Ce.formulaModule.cellRefRow,zt=Ce.formulaModule.cellRefSingle,Yt=Ce.formulaModule.columnRef,Jt=Ce.formulaModule.commaOpRef,Xt=Ce.formulaModule.documentQualifier,$t=Ce.formulaModule.errorQualifier,Zt=Ce.formulaModule.fieldRef,er=Ce.formulaModule.fieldRefNamePart,tr=Ce.formulaModule.contextNameNode,rr=Ce.formulaModule.fieldRefNode,nr=Ce.formulaModule.flattenLambdaArgs,ir=Ce.formulaModule.flattenLetArgs,or=Ce.formulaModule.flattenNameParts,ar=Ce.formulaModule.formula,sr=Ce.formulaModule.formulaRootAnnotation,lr=Ce.formulaModule.multiLineComment,ur=Ce.formulaModule.singleLineComment,cr=Ce.formulaModule.formulaSpan,dr=Ce.formulaModule.headNamePart,fr=Ce.formulaModule.identNamePart,pr=Ce.formulaModule.identQualifier,mr=Ce.formulaModule.indexedArg,hr=Ce.formulaModule.lambdaNode,gr=Ce.formulaModule.lambdaParam,vr=Ce.formulaModule.letNode,Sr=Ce.formulaModule.letVar,yr=Ce.formulaModule.literalNode,Cr=Ce.formulaModule.localNameDeclAnnotation,Rr=Ce.formulaModule.localNameUseAnnotation,br=Ce.formulaModule.missingRef,Nr=Ce.formulaModule.nameNode,Tr=Ce.formulaModule.operatorNode,Pr=Ce.formulaModule.paramDefault,Er=Ce.formulaModule.paramName,kr=Ce.formulaModule.paramNode,Or=Ce.formulaModule.parenNode,Ar=Ce.formulaModule.pos,Ir=Ce.formulaModule.rangeOpRef,_r=Ce.formulaModule.relativeQualifier,Fr=Ce.formulaModule.sheetQualifier,Mr=Ce.formulaModule.sheetRangeQualifier,Dr=Ce.formulaModule.specialRef,wr=Ce.formulaModule.structRef,Lr=Ce.formulaModule.structRefNode,xr=Ce.formulaModule.thisRowOpRef,Br=Ce.formulaModule.wsfNode,Ur=(Ce.formulaModule.getDepthUpperBound,Ce.signature.OperatorId),Gr=Ce.signature.WorksheetFuncId,Kr=Ce.signature.getOperatorType,Vr=(Ce.signature.getWorksheetFuncEnglishName,Ce.signature.getWorksheetFuncType),jr=(Ce.signature.higherOrderFunctionType,Ce.signature.operatorStrings),Wr=Ce.signature.unknownFunctionType,Hr=(Ce.cellFormat.canonicaliseBrackets,Ce.cellFormat.canonicaliseCellPos,Ce.cellFormat.canonicaliseCol,Ce.cellFormat.canonicaliseColRange,Ce.cellFormat.canonicaliseRangePos,Ce.cellFormat.canonicaliseRow,Ce.cellFormat.canonicaliseRowRange,Ce.cellFormat.columnName),Qr=Ce.cellFormat.formatCellPos,qr=Ce.cellFormat.formatCol,zr=Ce.cellFormat.formatColRange,Yr=Ce.cellFormat.formatGridRange,Jr=Ce.cellFormat.formatName,Xr=(Ce.cellFormat.formatQualifier,Ce.cellFormat.formatRangePos,Ce.cellFormat.formatRow),$r=Ce.cellFormat.formatRowRange,Zr=(Ce.cellFormat.quoteQualifier,Ce.cellFormat.resolvePosition,Ce.cellFormat.shouldQuoteQualifier,Ce.cellParse.SpecialPos,Ce.cellParse.isR1C1IdentStart,Ce.cellParse.parseCellRef,Ce.cellParse.parseGridCellA1),en=Ce.cellParse.parseGridRangeA1,tn=Ce.cellParse.parseQualifier,rn=(Ce.cellParse.wrapPosition,Ce.util.LangReasonKind),nn=Ce.util.ReasonKind,on=Ce.util.createFailureErrorClass,an=Ce.util.forEachCellInRange,sn=Ce.util.forEachTileInRange,ln=Ce.util.getArgType,un=Ce.util.getArguments,cn=(Ce.util.getBoundName,Ce.util.getSubExpressionFromPosition),dn=(Ce.util.getUserDefinedFuncName,Ce.util.getWorksheetFuncId,Ce.util.gridCellImplicitIsect),fn=Ce.util.gridCellRange,pn=Ce.util.gridRangeAnchor,mn=Ce.util.gridRangeCompare,hn=Ce.util.gridRangeExcept,gn=Ce.util.gridRangeIsect,vn=Ce.util.gridRangeIsects,Sn=Ce.util.gridRangeJoin,yn=Ce.util.gridRangeJoinOpt,Cn=Ce.util.gridRangeSize,Rn=Ce.util.gridRangesJoin,bn=Ce.util.internal,Nn=Ce.util.isArrayOper,Tn=Ce.util.isBlankOper,Pn=(Ce.util.isBooleanNode,Ce.util.isBooleanOper),En=(Ce.util.isCommaOpClosed,Ce.util.isCommaOpNoBadOrMissing,Ce.util.isCommaOpRefWellFormed,Ce.util.isDocumentLocEqual),kn=Ce.util.isErrorOper,On=Ce.util.isGridCell,An=Ce.util.isGridCellEqual,In=Ce.util.isGridRangeEqual,_n=(Ce.util.isMissingNode,Ce.util.isMissingOper),Fn=Ce.util.isNameScopeEqual,Mn=Ce.util.isNumberNode,Dn=Ce.util.isNumberOper,wn=Ce.util.isOperatorNode,Ln=Ce.util.isPrimitiveOper,xn=(Ce.util.isRangeOpClosed,Ce.util.isRangeOpNoMissing,Ce.util.isRangeOper),Bn=Ce.util.isReadOperEqual,Un=Ce.util.isRichOper,Gn=Ce.util.isSheetGridCell,Kn=Ce.util.isSheetGridCellEqual,Vn=Ce.util.isSheetGridRange,jn=Ce.util.isSheetGridRangeEqual,Wn=Ce.util.isSheetIndex,Hn=Ce.util.isSheetIndexEqual,Qn=Ce.util.sheetRangeToSheetIndex,qn=Ce.util.isStringOper,zn=Ce.util.isUnqualifiedNameNode,Yn=Ce.util.isValidArgsLength,Jn=Ce.util.isWSFNode,Xn=Ce.util.isWellFormed,$n=Ce.util.isWriteOper,Zn=(Ce.util.normalizeCommaOpRef,Ce.util.notImplemented),ei=Ce.util.sheetGridRangeAnchor,ti=(Ce.util.shouldFieldRefBeBracketed,Ce.util.unavailable),ri=Ce.config.Country,ni=Ce.config.LCID,ii=Ce.config.LogCategory,oi=Ce.config.NulLogger,ai=Ce.config.PictureColor,si=Ce.config.PictureDbnum,li=Ce.config.PictureSingle,ui=Ce.config.PictureSpecial,ci=Ce.config.TraceLevel,di=Ce.config.calcConfig,fi=Ce.config.createWorksheetFuncNameCallbacks,pi=Ce.config.englishErrorNames,mi=Ce.config.englishErrorTypeToName,hi=Ce.config.englishOperatorIdToName,gi=(Ce.config.englishPictureColor,Ce.config.englishPictureDbnum,Ce.config.englishPictureSingle,Ce.config.englishPictureSpecial,Ce.config.englishSpecialRefNames,Ce.config.englishSysDateFormat,Ce.config.englishSysTimeFormat,Ce.config.englishWorksheetFuncIdToName),vi=Ce.config.getEnglishLocaleInfo,Si=Ce.config.getEnglishWorksheetFuncIdToName,yi=Ce.config.getNumberShape,Ci=Ce.config.getOrdinal,Ri=Ce.config.isIdentContinue,bi=Ce.config.isIdentStart,Ni=Ce.config.isNumeral,Ti=Ce.config.localeInfo,Pi=Ce.config.operatorIdToName,Ei=Ce.config.ulsLogger,ki=c.config.getCalcAbsUrl,Oi=c.config.getCalcAbsUrlOrThrow,Ai=c.config.initCalc,Ii=c.config.initCalcCalled,_i=c.config.initCalcInThread,Fi=c.config.initCalcThread,Mi=c.config.isCalcInit,Di=c.config.maxRetriesForLoadingScript,wi=Ce.resolveService.createResolver,Li=Ce.resolveService.resolveGridRef,xi=Ce.resolveServiceTypes.InvalidCellRefReason,Bi=Ce.resolveServiceTypes.InvalidQualifierReason,Ui=Ce.resolveServiceTypes.InvalidStructRefReason,Gi=Ce.resolveServiceTypes.ResolveReasonKind,Ki=Ce.resolveServiceTypes.ResolvedKind,Vi=Ce.resolveServiceTypes.emptyIntersection,ji=Ce.resolveServiceTypes.invalidCellRef,Wi=Ce.resolveServiceTypes.invalidQualifier,Hi=Ce.resolveServiceTypes.invalidStructRef,Qi=Ce.resolveServiceTypes.noOriginSheet,qi=Ce.resolveServiceTypes.resolveLocalsGrid,zi=Ce.resolveServiceTypes.resolvedCellRef,Yi=Ce.resolveServiceTypes.resolvedDottedName,Ji=Ce.resolveServiceTypes.resolvedLocalName,Xi=Ce.resolveServiceTypes.resolvedName,$i=Ce.resolveServiceTypes.resolvedNever,Zi=Ce.resolveServiceTypes.resolvedStructRef,eo=Ce.resolveServiceTypes.resolvedUserDefinedFunc,to=Ce.visitor.BinaryVisitor,ro=Ce.visitor.ComposeVisitor,no=Ce.visitor.ConstVisitor,io=Ce.visitor.DelegatingVisitor,oo=Ce.visitor.IdentityVisitor,ao=(Ce.visitor.PledgeReducer,Ce.visitor.ZipVisitor,Ce.visitor.binaryVisitor),so=(Ce.visitor.bindVisitor,Ce.visitor.composeVisitor),lo=Ce.visitor.constVisitor,uo=(Ce.visitor.depthVisitor,Ce.visitor.identityVisitor),co=Ce.visitor.reduceBottomUp,fo=(Ce.visitor.reduceBottomUp_CPS,Ce.visitor.reduceBottomUp_MaxDepth,Ce.visitor.reduceBottomUp_Pledge,Ce.visitor.reduceBottomUp_Recursive,Ce.visitor.reducePledge),po=(Ce.visitor.reduceTopDown_Pledge,Ce.visitor.visitAppHeadNode),mo=Ce.visitor.visitCellRef,ho=Ce.visitor.visitFormulaNode,go=Ce.visitor.visitOperatorNode,vo=Ce.visitor.visitQualifier,So=Ce.visitor.visitWSFNode,yo=Ce.visitor.voidVisitor,Co=(Ce.visitor.zipVisitor,Ce.printService.anonymizeFormula),Ro=Ce.printService.createPrinter,bo=Ce.printServiceTypes.createSimplePrintGlobals,No=Ce.printServiceTypes.printLocalsGrid,To=Ce.printServiceTypes.printLocalsName,Po=Ce.mathpack.formatScientificLeft,Eo=Ce.mathpack.numberComponents,ko=Ce.mathpackIEEE.ieeeMathpack,Oo=Ce.mathpackXL.xlMathpack,Ao=Ce.datepack.Rounding,Io=Ce.datepack.TimeDivision,_o=Ce.datepack.TimeGranularity,Fo=Ce.datepack.dateTime,Mo=Ce.datepack.tzData,Do=Ce.datepack.tzUTC,wo=Ce.datepack.xlDatepack,Lo=Ce.types.FunctionFlags,xo=Ce.types.OperKind,Bo=Ce.types.SignatureType,Uo=Ce.types.SpecialPrecs,Go=Ce.types.functionType,Ko=Ce.annotations.buildAnnotations,Vo=Ce.relabel.relabelFormula;(Y=z||(z={})).LexicalKind=Re,Y.NameSource=be,Y.sheetRows=We,Y.sheetCols=xe,Y.lexicalSourceCell=Oe,Y.lexicalSourceRange=Me,Y.lexicalSourceGrid=Ae,Y.lexicalSourceName=Ie,Y.lexicalSourceWSF=_e,Y.lexicalSourceUDF=Fe,Y.documentLoc=Te,Y.structRefColumnLoc=He,Y.sheetIndex=Ke,Y.sheetRange=Ve,Y.gridCell=Ee,Y.gridRange=ke,Y.allSheetsRange=Ne,Y.sheetRangeIndexes=je,Y.sheetGridCell=Be,Y.sheetGridRange=Ge,Y.sheetGridCube=Ue,Y.originCell=Le,Y.documentScope=Pe,Y.nameLoc=De,Y.nameScope=we,Y.userDefinedFuncLoc=qe,(X=J||(J={})).SpecialPrecs=Uo,X.PrecsBound=Ye,X.OperKind=xo,X.trueOper=Rt,X.falseOper=tt,X.ErrorType=ze,X.precedents=gt,X.stringOper=Ct,X.booleanOper=$e,X.errorOper=et,X.nullErrorOper=mt,X.div0ErrorOper=Ze,X.valueErrorOper=bt,X.refErrorOper=yt,X.nameErrorOper=pt,X.numErrorOper=ht,X.naErrorOper=ft,X.gettingDataErrorOper=rt,X.spillErrorOper=nt,X.connectErrorOper=it,X.blockedErrorOper=ot,X.unknownErrorOper=at,X.fieldErrorOper=st,X.calcErrorOper=lt,X.busyErrorOper=ut,X.externalErrorOper=ct,X.arrayOper=Je,X.rangeSeqOper=St,X.range3DOper=vt,X.missingOper=dt,X.blankOper=Xe,(Z=$||($={})).RefStyle=Ft,Z.SyntaxFeature=Nt,Z.QualifierKind=_t,Z.CellRefKind=Et,Z.PosKind=It,Z.CommentKind=kt,Z.NodeKind=At,Z.NamePartKind=Ot,Z.SpecialRefId=Mt,Z.StructRefKind=Dt,Z.BadType=Pt,Z.errorQualifier=$t,Z.relativeQualifier=_r,Z.documentQualifier=Xt,Z.sheetQualifier=Fr,Z.identQualifier=pr,Z.sheetRangeQualifier=Mr,Z.badQualifier=Ut,Z.pos=Ar,Z.cellRefError=jt,Z.cellRefSingle=zt,Z.cellRefRange=Qt,Z.cellRefRow=qt,Z.cellRefCol=Vt,Z.cellRefBad=Kt,Z.formula=ar,Z.multiLineComment=lr,Z.singleLineComment=ur,Z.formulaSpan=cr,Z.literalNode=yr,Z.arrayNode=xt,Z.appNode=Lt,Z.flattenLetArgs=ir,Z.indexedArg=mr,Z.letVar=Sr,Z.letNode=vr,Z.flattenLambdaArgs=nr,Z.paramName=Er,Z.paramDefault=Pr,Z.paramNode=kr,Z.lambdaParam=gr,Z.lambdaNode=hr,Z.operatorNode=Tr,Z.wsfNode=Br,Z.parenNode=Or,Z.nameNode=Nr,Z.identNamePart=fr,Z.cellRefNamePart=Wt,Z.fieldRefNamePart=er,Z.contextNameNode=tr,Z.cellRefNode=Ht,Z.fieldRefNode=rr,Z.fieldRef=Zt,Z.structRefNode=Lr,Z.structRef=wr,Z.specialRef=Dr,Z.columnRef=Yt,Z.rangeOpRef=Ir,Z.commaOpRef=Jt,Z.thisRowOpRef=xr,Z.missingRef=br,Z.badRef=Gt,Z.badNode=Bt,Z.flattenNameParts=or,Z.headNamePart=dr,Z.AnnotationKind=Tt,Z.appHeadNameAnnotation=wt,Z.formulaRootAnnotation=sr,Z.localNameUseAnnotation=Rr,Z.localNameDeclAnnotation=Cr,(te=ee||(ee={})).SignatureType=Bo,te.FunctionFlags=Lo,te.OperatorId=Ur,te.WorksheetFuncId=Gr,te.SpecialPrecs=Uo,te.functionType=Go,te.unknownFunctionType=Wr,te.getOperatorType=Kr,te.getWorksheetFuncType=Vr,(ne=re||(re={})).isSheetIndex=Wn,ne.isSheetGridRange=Vn,ne.isGridCell=On,ne.isSheetGridCell=Gn,ne.forEachCellInRange=an,ne.gridRangeJoin=Sn,ne.gridRangeJoinOpt=yn,ne.gridRangesJoin=Rn,ne.gridRangeIsect=gn,ne.gridRangeIsects=vn,ne.gridCellImplicitIsect=dn,ne.gridRangeCompare=mn,ne.gridRangeExcept=hn,ne.gridRangeSize=Cn,ne.isDocumentLocEqual=En,ne.isSheetIndexEqual=Hn,ne.isNameScopeEqual=Fn,ne.isGridCellEqual=An,ne.isGridRangeEqual=In,ne.isSheetGridCellEqual=Kn,ne.isSheetGridRangeEqual=jn,ne.isWellFormed=Xn,ne.isUnqualifiedNameNode=zn,ne.isOperatorNode=wn,ne.isWSFNode=Jn,ne.gridRangeAnchor=pn,ne.sheetGridRangeAnchor=ei,ne.gridCellRange=fn,ne.getArguments=un,ne.getArgType=ln,ne.isValidArgsLength=Yn,ne.isNumberOper=Dn,ne.isStringOper=qn,ne.isBooleanOper=Pn,ne.isErrorOper=kn,ne.isRangeOper=xn,ne.isArrayOper=Nn,ne.isMissingOper=_n,ne.isBlankOper=Tn,ne.isRichOper=Un,ne.isPrimitiveOper=Ln,ne.isWriteOper=$n,ne.isReadOperEqual=Bn,ne.ResultKind=me,ne.success=Se,ne.failure=he,ne.successUndefined=ye,ne.isSuccess=ge,ne.ReasonKind=nn,ne.notImplemented=Zn,ne.unavailable=ti,ne.internal=bn,ne.javaScriptError=ve,ne.createFailureErrorClass=on,ne.columnName=Hr,ne.formatRow=Xr,ne.formatCol=qr,ne.formatRowRange=$r,ne.formatColRange=zr,ne.formatCellPos=Qr,ne.formatGridRange=Yr,ne.formatName=Jr,ne.parseGridCellA1=Zr,ne.parseGridRangeA1=en,ne.parseQualifier=tn,ne.getSubExpressionFromPosition=cn,ne.resolveLocalsGrid=qi,ne.ResolveReasonKind=Gi,ne.noOriginSheet=Qi,ne.invalidQualifier=Wi,ne.InvalidQualifierReason=Bi,ne.invalidCellRef=ji,ne.InvalidCellRefReason=xi,ne.invalidStructRef=Hi,ne.InvalidStructRefReason=Ui,ne.emptyIntersection=Vi,ne.ResolvedKind=Ki,ne.resolvedName=Xi,ne.resolvedCellRef=zi,ne.resolvedUserDefinedFunc=eo,ne.resolvedLocalName=Ji,ne.resolvedStructRef=Zi,ne.resolvedNever=$i,ne.resolvedDottedName=Yi,ne.createResolver=wi,ne.resolveGridRef=Li,ne.visitFormulaNode=ho,ne.visitOperatorNode=go,ne.visitWSFNode=So,ne.visitAppHeadNode=po,ne.visitQualifier=vo,ne.visitCellRef=mo,ne.IdentityVisitor=oo,ne.identityVisitor=uo,ne.ConstVisitor=no,ne.constVisitor=lo,ne.voidVisitor=yo,ne.DelegatingVisitor=io,ne.BinaryVisitor=to,ne.binaryVisitor=ao,ne.ComposeVisitor=ro,ne.composeVisitor=so,ne.reduceBottomUp=co,ne.reducePledge=fo,ne.buildAnnotations=Ko,ne.createSimplePrintGlobals=bo,ne.printLocalsGrid=No,ne.printLocalsName=To,ne.createPrinter=Ro,ne.relabelFormula=Vo,(oe=ie||(ie={})).LogCategory=ii,oe.TraceLevel=ci,oe.NulLogger=oi,oe.ulsLogger=Ei,oe.localeInfo=Ti,oe.LCID=ni,oe.Country=ri,oe.PictureSpecial=ui,oe.PictureSingle=li,oe.PictureColor=ai,oe.PictureDbnum=si,oe.calcConfig=di,oe.initCalc=Ai,oe.getEnglishLocaleInfo=vi,oe.englishWorksheetFuncIdToName=gi,oe.englishErrorTypeToName=mi,oe.englishOperatorIdToName=hi,oe.operatorIdToName=Pi,oe.createWorksheetFuncNameCallbacks=fi,oe.isCalcInit=Mi,oe.getCalcAbsUrl=ki,oe.FeatureName=de,(se=ae||(ae={})).numberComponents=Eo,se.ieeeMathpack=ko,se.xlMathpack=Oo,se.formatScientificLeft=Po,(ue=le||(le={})).TimeDivision=Io,ue.Rounding=Ao,ue.tzData=Mo,ue.tzUTC=Do,ue.dateTime=Fo,ue.TimeGranularity=_o,ue.xlDatepack=wo;var jo,Wo,Ho=r(3),Qo=Ho.parseServiceTypes.ReasonKind,qo=Ho.parseServiceTypes.createParseGlobals,zo=Ho.parseServiceTypes.notFormulaString,Yo=Ho.parseServiceTypes.parseLocals,Jo=Ho.parserService.createParser,Xo=Ho.parseResultHelperModule.ExtractLetVisitor,$o=Ho.parseResultHelperModule.parseResultHelper;(Wo=jo||(jo={})).createParseGlobals=qo,Wo.ReasonKind=Qo,Wo.parseLocals=Yo,Wo.notFormulaString=zo,Wo.createParser=Jo,Wo.parseResultHelper=$o;var Zo,ea,ta=Ho.analyzeServiceTypes.analyzeLocalsGrid,ra=Ho.analyzeServiceTypes.analyzeLocalsName,na=Ho.analyzeServiceTypes.createAnalyzeGlobals,ia=Ho.analyzeServiceTypes.diagnostics,oa=Ho.analyzeServiceTypes.summarizeFormulaDiagnostics,aa=Ho.analyzeService.createAnalyzer;(ea=Zo||(Zo={})).analyzeLocalsGrid=ta,ea.analyzeLocalsName=ra,ea.diagnostics=ia,ea.summarizeFormulaDiagnostics=oa,ea.createAnalyzeGlobals=na,ea.createAnalyzer=aa;var sa,la,ua=r(5),ca=ua.serviceTypes.Alignment,da=ua.serviceTypes.BidiDate,fa=ua.serviceTypes.Clip,pa=ua.serviceTypes.CultureTag,ma=ua.serviceTypes.EditKind,ha=ua.serviceTypes.FormatCurrency,ga=ua.serviceTypes.FormatReasonKind,va=ua.serviceTypes.FormatValueType,Sa=ua.serviceTypes.FormattedUnitKind,ya=ua.serviceTypes.GetTimeKind,Ca=ua.serviceTypes.NamedColor,Ra=ua.serviceTypes.NumberFormatSource,ba=ua.serviceTypes.ReasonKind,Na=ua.serviceTypes.aggregationError,Ta=ua.serviceTypes.createFormatGlobals,Pa=ua.serviceTypes.dateOverflow,Ea=ua.serviceTypes.evalFormatLocalsGrid,ka=ua.serviceTypes.formattedUnitBlank,Oa=ua.serviceTypes.formattedUnitFlexible,Aa=ua.serviceTypes.formattedUnitGeneral,Ia=ua.serviceTypes.formattedUnitString,_a=ua.serviceTypes.formattedValue,Fa=ua.serviceTypes.formulaEdit,Ma=ua.serviceTypes.fractionOverflow,Da=ua.serviceTypes.hashesValue,wa=(ua.serviceTypes.isFormatCultureEqual,ua.serviceTypes.isHashesValue),La=(ua.serviceTypes.isSystemCultureTag,ua.serviceTypes.memoizedRenderCallback),xa=ua.serviceTypes.noFormatPart,Ba=ua.serviceTypes.notFormatString,Ua=ua.serviceTypes.notValueString,Ga=ua.serviceTypes.numberEdit,Ka=ua.serviceTypes.otherEdit,Va=ua.serviceTypes.previousFormatFailure,ja=ua.serviceTypes.renderCallback,Wa=ua.serviceTypes.renderInfiniteWidth,Ha=ua.serviceTypes.renderedValue,Qa=ua.serviceTypes.renderedValueToString,qa=ua.serviceTypes.stringEdit,za=ua.serviceTypes.tooWide,Ya=Ce.numfmt.Calendar,Ja=Ce.numfmt.CurrencyFormat,Xa=Ce.numfmt.DateOrder,$a=Ce.numfmt.KnownFormat,Za=Ce.numfmt.NumberShape,es=(ua.knownFormat.buildCurrencyFormat,ua.knownFormat.buildFractionFormat,ua.knownFormat.buildMMDDYYFormat,ua.knownFormat.buildNumberFormat,ua.knownFormat.buildPercentFormat,ua.knownFormat.buildScientificFormat,ua.knownFormat.buildSingle,ua.knownFormat.englishXLSXKnownFormat),ts=(ua.knownFormat.getColor,ua.knownFormat.getKnownFormat),rs=(ua.knownFormat.getSingle,ua.knownFormat.getSpecial,ua.knownFormat.isKnownFormatDefined),ns=ua.ribbonFormat.RibbonFormat,is=ua.ribbonFormat.getRibbonFormat,os=(ua.edit.parseEdit,ua.edit.shouldInstallFormat),as=ua.formatService.createNumberFormatter,ss=ua.util.applyValueEdit,ls=(ua.util.getFormatString,ua.util.getValueEditOperKind),us=(ua.util.initUtilGlobals,ua.util.renderFormat,ua.util.toXLNumber);(la=sa||(sa={})).FormatReasonKind=ga,la.ReasonKind=ba,la.notValueString=Ua,la.notFormatString=Ba,la.noFormatPart=xa,la.tooWide=za,la.aggregationError=Na,la.dateOverflow=Pa,la.fractionOverflow=Ma,la.previousFormatFailure=Va,la.FormatValueType=va,la.BidiDate=da,la.CultureTag=pa,la.FormatCurrency=ha,la.NamedColor=Ca,la.Alignment=ca,la.GetTimeKind=ya,la.Clip=fa,la.FormattedUnitKind=Sa,la.formattedUnitGeneral=Aa,la.formattedUnitString=Ia,la.formattedUnitBlank=ka,la.formattedUnitFlexible=Oa,la.formattedValue=_a,la.renderedValue=Ha,la.hashesValue=Da,la.isHashesValue=wa,la.renderCallback=ja,la.memoizedRenderCallback=La,la.renderInfiniteWidth=Wa,la.renderedValueToString=Qa,la.EditKind=ma,la.formulaEdit=Fa,la.stringEdit=qa,la.numberEdit=Ga,la.otherEdit=Ka,la.NumberFormatSource=Ra,la.createFormatGlobals=Ta,la.evalFormatLocalsGrid=Ea,la.KnownFormat=$a,la.CurrencyFormat=Ja,la.DateOrder=Xa,la.NumberShape=Za,la.Calendar=Ya,la.getKnownFormat=ts,la.isKnownFormatDefined=rs,la.englishXLSXKnownFormat=es,la.RibbonFormat=ns,la.getRibbonFormat=is,la.shouldInstallFormat=os,la.createNumberFormatter=as,la.getValueEditOperKind=ls,la.applyValueEdit=ss,la.toXLNumber=us;var cs,ds,fs,ps=r(6),ms=ps.serviceTypes.CellKind,hs=ps.serviceTypes.Interrupt,gs=ps.serviceTypes.LimitKind,vs=ps.serviceTypes.ReasonKind,Ss=ps.serviceTypes.StepAction,ys=ps.serviceTypes.RuntimePositionKind,Cs=ps.serviceTypes.runtimePositionLetVal,Rs=ps.serviceTypes.runtimePositionLambdaRoot,bs=ps.serviceTypes.runtimePositionLambdaParam,Ns=ps.serviceTypes.runtimePositionFormulaRoot,Ts=ps.serviceTypes.runtimePositionFirstOrderFunc,Ps=ps.serviceTypes.cellCycle,Es=ps.serviceTypes.cellFormula,ks=ps.serviceTypes.cellWellFormedFormula,Os=ps.serviceTypes.compileLocalsGrid,As=ps.serviceTypes.compileLocalsName,Is=ps.serviceTypes.createCompileGlobals,_s=ps.serviceTypes.evalGlobals,Fs=ps.serviceTypes.evalLocals,Ms=ps.serviceTypes.finalValue,Ds=ps.serviceTypes.getEvalFailureReason,ws=ps.serviceTypes.illFormedFormula,Ls=ps.serviceTypes.interval,xs=ps.serviceTypes.limitExceeded,Bs=ps.serviceTypes.nameCycle,Us=ps.serviceTypes.paused,Gs=ps.serviceTypes.breaked,Ks=ps.serviceTypes.pendingValue,Vs=ps.serviceTypes.previousFailure,js=ps.serviceTypes.previousNameFailure,Ws=ps.serviceTypes.stopped,Hs=ps.serviceTypes.userDefinedFunc,Qs=(ps.compilerService.compiledFormula,ps.compilerService.compiledFormulaTerm,ps.compilerService.createCompiler),qs=ps.evaluatorService.createEvaluator,zs=ps.extensionTypes.DerefOperKind,Ys=(ps.extensionTypes.isRangeValues,ps.extensionTypes.machine),Js=(ps.extensionTypes.rangeValues,ps.subexpressionEvaluation.getFormulaSubExpressionObject),Xs=ps.subexpressionEvaluation.getSubExpressionFromFormulaCharacterIndex,$s=ps.subexpressionEvaluation.getSubExpressionSpan,Zs=ps.subexpressionEvaluation.getSubExpressionSubspans,el=ps.subexpressionEvaluation.getSubstitutedSubExpressionString,tl=ps.subexpressionEvaluation.isFormulaSubExpressionVolatile;(fs=cs||(cs={})).ReasonKind=vs,fs.interval=Ls,fs.CellKind=ms,fs.Interrupt=hs,fs.StepAction=Ss,fs.RuntimePositionKind=ys,fs.runtimePositionLetVal=Cs,fs.runtimePositionLambdaRoot=Rs,fs.runtimePositionLambdaParam=bs,fs.runtimePositionFormulaRoot=Ns,fs.runtimePositionFirstOrderFunc=Ts,fs.finalValue=Ms,fs.pendingValue=Ks,fs.cellWellFormedFormula=ks,fs.cellFormula=Es,fs.userDefinedFunc=Hs,fs.stopped=Ws,fs.nameCycle=Bs,fs.cellCycle=Ps,fs.paused=Us,fs.breaked=Gs,fs.previousFailure=Vs,fs.previousNameFailure=js,fs.evalGlobals=_s,fs.evalLocals=Fs,fs.compileLocalsGrid=Os,fs.compileLocalsName=As,fs.getEvalFailureReason=Ds,fs.illFormedFormula=ws,fs.createCompileGlobals=Is,fs.limitExceeded=xs,fs.LimitKind=gs,fs.createCompiler=Qs,fs.createEvaluator=qs,(ds=fs.extension||(fs.extension={})).DerefOperKind=zs,ds.machine=Ys,fs.getSubExpressionFromFormulaCharacterIndex=Xs,fs.getSubExpressionSpan=$s,fs.getFormulaSubExpressionObject=Js,fs.getSubstitutedSubExpressionString=el,fs.getSubExpressionSubspans=Zs,fs.isFormulaSubExpressionVolatile=tl;var rl=A()((function(e,t){return{functionId:e,functionName:t}})),nl=A()((function(e,t){return{errorType:e,errorName:t}})),il=A()((function(e,t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,b,N,T,P,E,k,O,A,I,_,F,M,D,w,L,x,B,U,G,K,V,j,W,H,Q,q,z,Y,J){return{worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:z,trueName:r,falseName:n,rowLetter:i,columnLetter:o,leftBrace:a,rightBrace:s,leftBracket:l,rightBracket:u,decimalSeparator:c,listSeparator:d,columnSeparator:f,rowSeparator:p,thousandsData:m,thousandsSeparator:h,lcid:g,country:v,numberDecimals:S,isExpSepBySpace:y,fractionSeparator:C,isPercentSepBySpace:R,currencyFormat:b,isCurrencySymbolLead:N,isCurrencySepBySpace:T,currencySymbol:P,currencyDecimals:E,dateOrder:k,dateSeparator:O,dateAltSeparator:A,year4Digits:I,month2Digits:_,day2Digits:F,longDateFormat:M,timeSeparator:D,timeAltSeparator:w,hour2Digits:L,clock24Hour:x,isAMPMSepBySpace:B,ampmSymbols:U,dayNameShort:G,dayNameLong:K,monthNameShort:V,monthNameLong:j,pictureSpecial:W,pictureSingle:H,pictureColor:Q,pictureDbnum:q,sysDateFormat:Y,sysTimeFormat:J}})),ol=A()((function(e,t,r){return{iformat:e,formatString:t,builtIn:r}})),al=A()((function(e,t){return{sheetId:e,sheetName:t}})),sl={kind:"Blank"},ll=A()((function(e){return{kind:"Error",type:e}})),ul=A()((function(e){return{kind:"Rich",fields:e}}));function cl(e){return"object"==typeof e?e.kind:typeof e}function dl(e){return"object"==typeof e?e.kind:typeof e}var fl=A()((function(e,t){return{row:e,column:t}})),pl=A()((function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}})),ml=A()((function(e,t,r,n,i){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}})),hl=A()((function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}})),gl=A()((function(e,t,r,n,i){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}}));function vl(e,t,r,n){return gl(e,t,r,n,"CellFormula")}function Sl(e,t,r){return gl(void 0,e,t,r,"ArrayFormula")}function yl(e,t,r,n){return gl(e,t,r,n,"Value")}var Cl=A()((function(e,t,r,n,i){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}})),Rl=A()((function(e,t,r,n){return Cl(e,t,void 0,r,n)}));function bl(e,t,r,n){return Cl(e,void 0,t,r,n)}var Nl=A()((function(e,t){return{isSpilled:e,formulaBarText:t}})),Tl=A()((function(e,t,r){return{range:e,data:t,fromStateId:r}}));function Pl(e,t){return Tl(e,t,void 0)}function El(e,t){return Tl(e,void 0,t)}var kl=A()((function(e,t){return{sheetId:e,usedRange:t}})),Ol=A()((function(e){return{kind:"NamedValue",value:e}})),Al=A()((function(e){return{kind:"NamedFormula",formulaBarText:e}})),Il=A()((function(e){return{kind:"NamedRange",range:e}})),_l=A()((function(e,t){return{column:e,name:t}})),Fl=A()((function(e,t,r,n){return{kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}})),Ml=A()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),Dl=A()((function(e,t){return{name:e,data:t}})),wl=A()((function(e,t,r){return{scope:e,objects:t,fromStateId:r}}));function Ll(e,t){return wl(e,t,void 0)}function xl(e){return wl(e,void 0,void 0)}function Bl(e,t){return wl(e,void 0,t)}var Ul=function(e,t,r,n,i,o){return void 0===o&&(o="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:i,kind:o}};function Gl(e,t,r,n){return Ul(e,t,void 0,r,n,"CellFormula")}function Kl(e,t,r,n){return Ul(e,t,r,void 0,n,"Value")}function Vl(e,t,r,n){return Ul(e,t,void 0,r,n,"Inferred")}var jl=A()((function(e,t,r,n){return{kind:e,format:t,ribbon:r,changeDecimals:n}}));function Wl(e){return jl("SetFormat",e,void 0,void 0)}function Hl(e){return jl("RibbonFormat",void 0,e,void 0)}function Ql(e){return jl("ChangeDecimals",void 0,void 0,e)}var ql=A()((function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}})),zl=A()((function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}})),Yl=A()((function(e,t,r,n){return{kind:e,target:t,source:r,viewport:n}}));function Jl(e,t,r){var n=hl(e.sheetId,e.row,e.column);return Yl("CopyPaste",n,t,r)}var Xl=A()((function(e,t,r){return{format:e,category:t,decimals:r}})),$l=A()((function(e,t,r,n,i){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:i}})),Zl=A()((function(e,t){return{range:e,data:t}})),eu=A()((function(e,t){return{range:e,data:t}})),tu=A()((function(e,t){return{range:e,reason:t}})),ru=A()((function(e,t,r,n,i,o){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:o}})),nu=A()((function(e,t,r){return{kind:e,iformat:t,knownFormat:r}}));function iu(){return nu("Origin")}function ou(e){return nu("Iformat",e)}function au(e){return nu("Known",void 0,e)}function su(){return nu("Inferred")}function lu(){return nu("Aggregate")}function uu(e,t){return{value:e,formatted:t}}var cu,du=A()((function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}})),fu=A()((function(e,t){return{name:e,param:t}})),pu=A()((function(e,t,r,n,i,o,a,s,l,u,c,d){return void 0===c&&(c=null==u?void 0:u/(u>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:u,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:o,sampleCellEvalStopwatchRate:a,rngSeed:r,volatileMode:d,runExperiments:l}})),mu=A()((function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}}));!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(cu||(cu={}));var hu,gu=r(0),vu=r(15),Su=r(4),yu=c.interval.ivlJoin,Cu=(c.interval.ivlMeet,c.interval.ivlDistance,c.interval.ivlMeets,c.interval.ivlMeetsOrTouches,c.interval.ivlExcept,c.interval.ivlCompare,c.bspSet.SetKind,c.bspSet.cacheKeySplitting,c.bspSet.createFromKey),Ru=c.bspSet.fromUntyped,bu=c.bspSet.union,Nu=(c.bspSet.unionUntyped,c.bspSet.intersect),Tu=(c.bspSet.intersectUntyped,c.bspSet.meets,c.bspSet.meetsUntyped,c.bspSet.except),Pu=(c.bspSet.exceptUntyped,c.bspSet.compare),Eu=(c.bspSet.combineCmp,c.bspSet.compareUntyped,c.bspSet.dense),ku=c.bspSet.empty,Ou=(c.bspSet.lazy,c.bspSet.symmetricDiff,c.bspSet.complement,c.bspSet.getNodeCount),Au=c.bspSet.forEachKey,Iu=(c.bspSet.forEachKeyUntyped,c.split.boundedPareto,c.split.boundedParetoSplitter,c.split.boundedParetoSetOperations),_u=c.productSet.createFromProduct,Fu=c.productSet.project,Mu=c.productSet.unionProduct,Du=c.productSet.intersectProduct,wu=c.productSet.exceptProduct,Lu=c.productSet.compareProduct,xu=c.productSet.meetsProduct,Bu=c.productSet.complementProduct,Uu=(c.productSet.symmetricDiffProduct,c.productSet.getSubspaces,c.productSet.forEachProduct),Gu=c.productSet.getSubspaceCount;c.productSet.ProductSetSerializer,c.productSet.productSetSerializer;!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(hu||(hu={}));var Ku=[hu.AvailableSet,hu.AvailableRead+1],Vu=[0,We],ju=[0,xe],Wu={availability:Iu(1,Ku[0]+1,Ku[1],Ku,"Availability operations, alpha = 1"),row:Iu(.2,Vu[0]+1,Vu[1],Vu,"Row operations, alpha = 0.2"),col:Iu(.35,ju[0]+1,ju[1],ju,"Col operations, alpha = 0.35")},Hu={availability:Cu(Wu.availability),row:Cu(Wu.row),col:Cu(Wu.col)};function Qu(e){return _u({row:Hu.row([e.row,e.row+e.rows]),col:Hu.col([e.col,e.col+e.cols])})}function qu(e){if(e!==ku){var t,r,n=e===Eu?void 0:e.root.bounds.row,i=e===Eu?void 0:e.root.bounds.col,o=void 0===n?Wu.row.top:(t=Ru(Wu.row,n),r=[],ec(t,(function(e){return r.push(e),!0})),r.reduce(yu)),a=o[0],s=o[1],l=void 0===i?Wu.col.top:function(e){var t=[];return tc(e,(function(e){return t.push(e),!0})),t.reduce(yu)}(Ru(Wu.col,i)),u=l[0],c=l[1];return ke(a,u,s-a,c-u)}}var zu,Yu,Ju,Xu=_u({availability:Hu.availability([hu.AvailableSet,hu.AvailableSet+1])}),$u=_u({availability:Hu.availability([hu.AvailableRead,hu.AvailableRead+1])}),Zu=_u({availability:Hu.availability([hu.AvailableSet,hu.AvailableRead+1])});function ec(e,t){return e!==Eu?Au(e,t):t(Wu.row.top)}function tc(e,t){return e!==Eu?Au(e,t):t(Wu.col.top)}function rc(e,t){return Uu(e,(function(e){return ec(e.row,(function(r){var n=r[0],i=r[1];return tc(e.col,(function(e){var r=e[0],o=e[1];return t(ke(n,r,i-n,o-r))}))}))}),"row","col")}function nc(e,t){return rc(e,(function(e){return an(e,t)}))}function ic(e,t){return{sheet:e,set:t}}function oc(e){return ic(e.sheet,Qu(e.range))}!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(zu||(zu={})),function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(Yu||(Yu={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(Ju||(Ju={}));var ac,sc,lc,uc,cc,dc,fc={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function pc(e,t){var r,n;return Object(gu.__assign)(Object(gu.__assign)({},e),((r={})[t]=(null!==(n=e[t])&&void 0!==n?n:0)+1,r))}function mc(e,t){switch(t.message){case ac.ChangedCell:return Object(gu.__assign)(Object(gu.__assign)({},e),{changedCellCount:pc(e.changedCellCount,t.cellKind),calculatedCellCount:pc(e.calculatedCellCount,t.cellKind)});case ac.UnchangedCell:return Object(gu.__assign)(Object(gu.__assign)({},e),{calculatedCellCount:pc(e.calculatedCellCount,t.cellKind)});case ac.ContinueComputation:return Object(gu.__assign)(Object(gu.__assign)({},e),{continueCount:e.continueCount+1});case ac.StateTimedOut:return Object(gu.__assign)(Object(gu.__assign)({},e),{stateTimedOut:!0});case ac.EditFinished:return Object(gu.__assign)(Object(gu.__assign)({},e),{editFinishedCount:e.editFinishedCount+1});case ac.RecalcFinished:return Object(gu.__assign)(Object(gu.__assign)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return L("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(ac||(ac={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(sc||(sc={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known"}(lc||(lc={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(uc||(uc={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(cc||(cc={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(dc||(dc={}));ps.rtree.gridRangeDistance;var hc=ps.rtree.makeGridRangeTable;function gc(e){return Array.isArray(e)}var vc,Sc,yc=function(e){return 0===e};!function(e){e.ClientValueUnknown="ClientValueUnknown"}(vc||(vc={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(Sc||(Sc={}));var Cc={fmla:"",lexicalKind:Re.Cell,origin:Ee(0,0),compiledFmla:void 0,hasHyperlink:!1};d();var Rc={fmla:"",lexicalKind:Re.Range,origin:Ee(0,0),compiledFmla:void 0,hasHyperlink:!1};d();var bc,Nc=function(e,t){return""===e&&!t},Tc=Cc;!function(e){e.ClientValueUnknown="ClientValueUnknown"}(bc||(bc={}));var Pc={kind:bc.ClientValueUnknown};function Ec(e){return e.kind===bc.ClientValueUnknown}var kc={oper:Xe,failure:void 0};function Oc(e,t){return Tn(e)&&void 0===t}function Ac(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!An(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function Ic(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===Re.Cell?Cc:Rc;e=e.setValue(t,n)}return!0})),e}function _c(e,t){return e.forEachMeets(t,(function(t,r){return(r.fmla===Sc.ClientValueUnknown||r.fmla.length>0)&&(e=e.setValue(t,Tc)),!0})),e}function Fc(e,t,r,n){var i=Du(t,$u),o=Fu(Du(r,i),"row","col");return nc(wu(t,o),(function(t){return e=e.setValue(t,n),!0})),e}d();var Mc={hidden:[],available:[]},Dc={values:hc(),formats:hc(),styles:hc(),formulae:hc(),dirty:ku},wc={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0};var Lc,xc=ke(0,0,We,xe);function Bc(e,t){return void 0===e?t:void 0===t?e:Sn(e,t)}function Uc(e,t){return void 0===e||void 0===t?void 0:gn(e,t)}!function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(Lc||(Lc={}));var Gc,Kc=function(){function e(e,t,r,n,i,o,a,s,l,u){void 0===e&&(e=Dc),void 0===t&&(t=ku),void 0===r&&(r=xc),void 0===n&&(n=ku),void 0===i&&(i=ku),void 0===o&&(o=ku),void 0===a&&(a=ku),void 0===s&&(s=hc()),void 0===l&&(l=!1),void 0===u&&(u=!1),this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=t,this.serverUsed=r,this.hiddenRows=n,this.hiddenRowsAvailability=i,this.hiddenCols=o,this.hiddenColsAvailability=a,this.mergeCells=s,this.inFilterMode=l,this.filterModeAvailable=u,this.rollBackToServerState(0)}return e.create=function(){return new e},e.prototype.clone=function(t){void 0===t&&(t=Lc.Server);var r=new e(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return t===Lc.Client&&(r.editedContents=this.editedContents,r.clientContents=this.clientContents,r.recalcValues=this.recalcValues,r.recalcDirty=this.recalcDirty,r.recalcFailures=this.recalcFailures,r.editedTaint=this.editedTaint,r.recalcTaint=this.recalcTaint,r.editedAvailability=this.editedAvailability),r},e.prototype.advanceState=function(e,t){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=ku,this.serverUsed=xc,this.hiddenRows=this.hiddenRowsAvailability=ku,this.hiddenCols=this.hiddenColsAvailability=ku,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(t)},e.prototype.rollBackToServerState=function(e){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=ku,this.rollBackToEditedState(e)},e.prototype.rollBackToEditedState=function(e){this.setClientContents(this.editedContents,e),this.recalcValues=this.editedContents.values,this.recalcFailures=ku,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=Qu(e),n=Du(r,$u),i=Du(t,n),o=Fu(wu(n,i),"row","col"),a=Lu(i,n);return!!(void 0!==a&&a>=0)||o},e.prototype.forEachRecalcDirty=function(e,t){return nc(Du(this.recalcDirty,Qu(e)),t)},e.prototype.hasRecalcDirty=function(e){return xu(this.recalcDirty,Qu(e))},e.prototype.hasRecalcFailure=function(e){return xu(this.recalcFailures,Qu(e))},e.prototype.hasEditedEditTaint=function(e){return xu(this.editedTaint,Qu(e))},e.prototype.hasRecalcEditTaint=function(e){return xu(this.recalcTaint,Qu(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r=Hu.row(T(e,t)),n=Nu(this.hiddenRowsAvailability,r),i=[];ec(n,(function(e){var t=e[0],r=e[1];return i.push(Ls(t,r)),!0}));var o=[];return ec(Nu(this.hiddenRows,n),(function(e){var t=e[0],r=e[1];return o.push(Ls(t,r)),!0})),{hidden:o,available:i}},e.prototype.tryGetHiddenRows=function(e,t){var r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?Se(r.hidden):he({kind:zu.HiddenRows})},e.prototype.setHiddenRows=function(e,t){var r=Hu.row(T(e.row,e.row+e.rows));this.hiddenRows=bu(Tu(this.hiddenRows,r),Nu(t,r)),this.hiddenRowsAvailability=bu(this.hiddenRowsAvailability,r)},e.prototype.getHiddenCols=function(e,t){var r=Hu.col(T(e,t)),n=Nu(this.hiddenColsAvailability,r),i=[];tc(n,(function(e){var t=e[0],r=e[1];return i.push(Ls(t,r)),!0}));var o=[];return tc(Nu(this.hiddenCols,n),(function(e){var t=e[0],r=e[1];return o.push(Ls(t,r)),!0})),{hidden:o,available:i}},e.prototype.tryGetHiddenCols=function(e,t){var r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?Se(r.hidden):he({kind:zu.HiddenCols})},e.prototype.setHiddenCols=function(e,t){var r=Hu.col(T(e.col,e.col+e.cols));this.hiddenCols=bu(Tu(this.hiddenCols,r),Nu(t,r)),this.hiddenColsAvailability=bu(this.hiddenColsAvailability,r)},e.prototype.setMergeCell=function(e){this.mergeCells=this.mergeCells.setValue(e,!0)},e.prototype.getMergeCell=function(e){var t;return this.mergeCells.forEachGe(e,(function(e){return t=e,!0})),t},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?Se(this.inFilterMode):he({kind:zu.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,t,r,n){var i=Du(e,Xu);return rc(Du(r,i),(function(e){return n.formulae.forEachMeets(e,(function(r,n){return!!Nc(n.fmla,void 0!==n.compiledFmla)||an(gn(e,r),t)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=Du(e,$u);return rc(Du(r,n),(function(e){return an(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=Du(e,Xu),n=this.oldAvailabilities[t];if(void 0===n)return!1;var i=Lu(n,r);return void 0!==i&&i>=0&&(this.unionAvailability(!0,Du(e,Zu)),this.unionTaint(!0,ku),this.unionUsed(!0,qu(e)),!0)},e.prototype.extendServerUnused=function(e,t){var r=void 0===e?ku:Qu(e),n=Bu(r),i=this.serverContents,o=i.values,a=i.formats,s=i.styles,l=i.formulae,u=i.dirty;rc(n,(function(e){return o.forEachLe(e,(function(e,t){return Oc(t.oper,t.failure)||(o=o.setValue(e,kc)),!0})),a.forEachLe(e,(function(e,t){return yc(t)||(a=a.setValue(e,0)),!0})),s.forEachLe(e,(function(e,t){return t!==uc.Blank&&(s=s.setValue(e,uc.Blank)),!0})),!0})),rc(n,(function(e){return l=Ic(l,e),!0})),u=wu(u,n),this.setContents(!0,{values:o,formats:a,styles:s,formulae:l,dirty:u},t);var c=Du(n,$u);this.serverAvailability=this.editedAvailability=Mu(this.serverAvailability,c),this.editedTaint=this.recalcTaint=ku;var d=this.serverUsed;d=Uc(d,e),this.serverUsed=this.editedUsed=d},e.prototype.setRecalcFailure=function(e){this.recalcFailures=Mu(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=Mu(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;an(e,(function(e,n,i){return r.recalcValues=r.recalcValues.setValue(e,{oper:gc(t)?t[n][i]:t,failure:void 0}),!0})),this.recalcDirty=wu(this.recalcDirty,Qu(e))},e.prototype.setClientContents=function(e,t){this.clientContents=e},e.prototype.setClientValue=function(e,t,r){var n=this.clientContents.values;an(e,(function(e,r,i){return n=n.setValue(e,{oper:gc(t)?t[r][i]:t,failure:void 0}),!0})),this.setClientContents(Object(gu.__assign)(Object(gu.__assign)({},this.clientContents),{values:n}),r)},e.prototype.setClientFormula=function(e,t,r,n){var i=this.clientContents.formulae;i=_c(i,e),void 0!==t?i=i.setValue(t,r):an(e,(function(e){return i=i.setValue(e,r),!0})),this.setClientContents(Object(gu.__assign)(Object(gu.__assign)({},this.clientContents),{formulae:i}),n)},e.prototype.setClientFormat=function(e,t,r){var n=this.clientContents.formats;an(e,(function(e){return n=n.setValue(e,t),!0})),this.setClientContents(Object(gu.__assign)(Object(gu.__assign)({},this.clientContents),{formats:n}),r)},e.prototype.getRecalcValues=function(e){for(var t=e.row,r=e.col,n=e.rows,i=e.cols,o=new Array(n),a=0;a<n;a+=1)o[a]=K(new Array(i),kc);return this.recalcValues.forEachLe(e,(function(e,n){return o[e.row-t][e.col-r]=n,!0})),o},e.prototype.forEachRecalcValue=function(e,t){return this.recalcValues.forEachMeets(e,t)},e.prototype.getClientValue=function(e){var t=this.clientContents.values.getValue(e);return null!=t?t:kc},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return null!=t?t:kc},e.prototype.getEditedValue=function(e){var t=this.editedContents.values.getValue(e);return null!=t?t:kc},e.prototype.forEachEditedValue=function(e,t){return this.editedContents.values.forEachMeets(e,t)},e.prototype.getServerFormula=function(e){return this.getFormula(e,this.serverContents.formulae)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(gu.__assign)(Object(gu.__assign)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return null!=t?t:0},e.prototype.forEachEditedFormat=function(e,t){return this.editedContents.formats.forEachMeets(e,t)},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return null!=t?t:0},e.prototype.getEditedStyle=function(e){var t=this.editedContents.styles.getValue(e);return null!=t?t:uc.Blank},e.prototype.getServerStyle=function(e){var t=this.serverContents.styles.getValue(e);return null!=t?t:uc.Blank},e.prototype.getClientFormat=function(e){var t=this.clientContents.formats.getValue(e);return null!=t?t:0},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(e,t){return this.editedContents.formulae.forEachMeets(e,t)},e.prototype.getFormula=function(e,t){var r=void 0;return t.forEachGe(e,(function(e,t){return!!Nc(t.fmla,void 0!==t.compiledFmla)||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,t,r){e&&(this.serverContents=t),this.editedContents=t,e&&this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=ku},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=Mu(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?ku:Mu(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r=e?this.serverUsed:this.editedUsed;r=Bc(r,t),e&&(this.serverUsed=r),this.editedUsed=r},e.prototype.setCellContents=function(e,t,r,n,i,o,a,s,l){this.setCommon(e,t,void 0,r,n,i,o,a,s,l)},e.prototype.setRangeFormula=function(e,t,r,n,i,o,a,s){var l=Qu(t);this.setCommon(e,l,t,r,n,void 0,i,o,a,s)},e.prototype.setCommon=function(e,t,r,n,i,o,a,s,l,u){var c=this,d=e?this.serverContents:this.editedContents,f=d.values,p=d.formats,m=d.styles,h=d.formulae,g=d.dirty,v=void 0===n&&void 0!==i||void 0!==(null==n?void 0:n.compiledFmla),S=n;void 0!==n&&(rc(t,(function(e){return h=Ic(h,e),!0})),Nc(n.fmla,void 0!==n.compiledFmla)&&(S=void 0));var y=void 0!==S&&void 0===r?n:void 0,C=void 0!==S&&void 0!==r?n:void 0,R=i;void 0!==i&&Oc(i,o)&&(rc(t,(function(e){return f.forEachLe(e,(function(e,t){return Oc(t.oper,t.failure)||(f=f.setValue(e,kc)),!0})),!0})),g=v?Mu(g,t):wu(g,t),R=void 0);var b=void 0!==R?{oper:R,failure:o}:void 0,N=a;void 0!==a&&yc(a)&&(rc(t,(function(e){return p.forEachLe(e,(function(e,t){return yc(t)||(p=p.setValue(e,0)),!0})),!0})),N=void 0);var T=N===lc.Weak?void 0:N,P=N===lc.Weak?N:void 0,E=s;void 0!==s&&s===uc.Blank&&(rc(t,(function(e){return m.forEachLe(e,(function(e,t){return t!==uc.Blank&&(m=m.setValue(e,uc.Blank)),!0})),!0})),E=void 0);var k=E===uc.Weak?void 0:E,O=E===uc.Weak?E:void 0,A=t;if(!e){var I=Du(t,Xu),_=Fu(Du(this.editedAvailability,I),"row","col"),F=Du(t,void 0!==l?Qu(l):ku);A=Mu(_,F)}if(void 0===y&&void 0===T&&void 0===k&&void 0===b||(nc(A,(function(e){return void 0!==y&&(h=Ac(h,e,y)),void 0!==T&&(p=p.setValue(e,T)),void 0!==k&&(m=m.setValue(e,k)),void 0!==b&&(f=f.setValue(e,b)),!0})),void 0===y&&void 0===b||(g=v?Mu(g,A):wu(g,A))),void 0!==C){h=Ac(h,r,C);var M=Qu(r);g=v?Mu(g,M):wu(g,M)}void 0!==P&&(p=Fc(p,A,e?this.serverAvailability:this.editedAvailability,lc.Unavailable)),void 0!==O&&(m=function(e,t,r){var n=Du(t,$u),i=Fu(Du(r,n),"row","col");return nc(wu(t,i),(function(t){return e=e.setValue(t,uc.Unavailable),!0})),e}(m,A,e?this.serverAvailability:this.editedAvailability));var D=void 0===i?ku:A,w=void 0===n?ku:A,L=void 0===a?ku:A,x=void 0===i&&void 0===a?ku:A;e||(rc(D,(function(e){return c.setClientValue(e,Pc,u),!0})),void 0!==n&&(void 0!==r?this.setClientFormula(r,r,n,u):rc(w,(function(e){return c.setClientFormula(e,void 0,n,u),!0}))),a===lc.Weak?this.setClientContents(Object(gu.__assign)(Object(gu.__assign)({},this.clientContents),{formats:Fc(this.clientContents.formats,L,this.editedAvailability,lc.ClientValueUnknown)}),u):rc(L,(function(e){return c.setClientFormat(e,lc.ClientValueUnknown,u),!0}))),this.setContents(e,{values:f,formats:p,styles:m,formulae:h,dirty:g},u),this.unionAvailability(e,Du(D,Zu)),e||(this.editedAvailability=wu(this.editedAvailability,wu(t,A))),this.unionTaint(e,x),this.unionUsed(e,qu(t))},e.prototype.copyRange=function(e){function t(t,r){return t.forEachLe(e,(function(e,t){return r=r.setValue(e,t),!0})),r}var r=Dc.values,n=Dc.formats,i=Dc.styles,o=Dc.formulae,a=this.editedContents,s=a.values,l=a.formats,u=a.styles,c=a.formulae;r=t(s,r),n=t(l,n),i=t(u,i),c.forEachMeets(e,(function(t,r){return o=o.setValue(gn(t,e),r),!0}));var d=pn(e),f=Du(this.editedAvailability,Qu(e)),p=Uc(this.editedUsed,e);return{origin:d,formats:n,styles:i,values:r,formulae:o,availability:f,used:p}},e.prototype.pasteRange=function(e,t,r){var n=Qu(e),i=ke(t.origin.row,t.origin.col,e.rows,e.cols),o=this.editedContents,a=o.values,s=o.formats,l=o.styles,u=o.formulae,c=o.dirty,d=this.editedUsed,f=e.row-t.origin.row,p=e.col-t.origin.col;function m(e){return ke(e.row+f,e.col+p,e.rows,e.cols)}function h(t,r,n){return r.forEachMeets(e,(function(e,t){return r=r.setValue(e,n),!0})),t.forEachLe(i,(function(e,t){return r=r.setValue(m(e),t),!0})),r}var g=Bc(d,void 0!==t.used?m(t.used):void 0),v=Uc(g,e);a=h(t.values,a,kc),void 0!==v&&this.setClientValue(v,Pc,r),s=h(t.formats,s,0),l=h(t.styles,l,uc.Blank),void 0!==v&&this.setClientFormat(v,lc.ClientValueUnknown,r),u=h(t.formulae,u,Cc),c=wu(c,n);var S=this.clientContents.formulae;S=_c(S,e),u.forEachLe(e,(function(e,t){var r=t.origin,n=t.compiledFmla;return void 0!==n&&(c=Mu(c,Qu(e))),S=S.setValue(e,{fmla:Sc.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:vc.ClientValueUnknown}),!0})),this.setClientContents(Object(gu.__assign)(Object(gu.__assign)({},this.clientContents),{formulae:S}),r);this.setContents(!1,{values:a,formats:s,styles:l,formulae:u,dirty:c},r),this.editedAvailability=wu(this.editedAvailability,n),this.unionAvailability(!1,function(e,t,r){var n=ku;return Uu(e,(function(e){var i=ku;ec(e.row,(function(e){var r=e[0],n=e[1];return i=bu(i,Hu.row([r+t,n+t])),!0}));var o=ku;tc(e.col,(function(e){var t=e[0],n=e[1];return o=bu(o,Hu.col([t+r,n+r])),!0}));var a=_u({row:i,col:o,availability:e.availability});return n=Mu(n,a),!0}),"row","col","availability"),n}(t.availability,f,p)),this.unionTaint(!1,void 0===v?ku:Qu(v)),this.unionUsed(!1,g)},e.prototype.getDirtyEditedCells=function(){return Du(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return wu(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return wu(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e,t){var r=e?this.serverContents:this.editedContents;this.setContents(e,r,t),this.unionAvailability(e,ku),this.unionTaint(e,ku),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:Gu(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:Gu(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:Gu(this.recalcDirty),recalcFailuresSetSubspaceCount:Gu(this.recalcFailures),recalcTaintSetSubspaceCount:Gu(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:Gu(this.editedAvailability),hiddenRowsNodeCount:Ou(this.hiddenRows)+Ou(this.hiddenRowsAvailability),hiddenColsNodeCount:Ou(this.hiddenCols)+Ou(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(e,t){var r=ku;for(var n in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(n)){var i=Number(n);if(i>=e){r=Mu(r,this.oldAvailabilities[i]);continue}delete this.oldAvailabilities[i],this.availabilityHistorySize-=1}function o(e){return xu(Du(Qu(e),Xu),r)}function a(e,t){return!Nc(t.fmla,void 0!==t.compiledFmla)&&o(e)}function s(e,t){return!yc(t)&&o(e)}function l(e,t){return t!==uc.Blank&&o(e)}function u(e,t){return!(!Ec(t.oper)&&Oc(t.oper,t.failure))&&o(e)}var c=Fu(r,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(a),formats:this.serverContents.formats.filter(s),styles:this.serverContents.styles.filter(l),values:this.serverContents.values.filter(u),dirty:Du(this.serverContents.dirty,c)},this.editedContents={formulae:this.editedContents.formulae.filter(a),formats:this.editedContents.formats.filter(s),styles:this.editedContents.styles.filter(l),values:this.editedContents.values.filter(u),dirty:Du(this.editedContents.dirty,c)},this.setClientContents({formulae:this.clientContents.formulae.filter(a),formats:this.clientContents.formats.filter(s),values:this.clientContents.values.filter(u)},t),this.recalcValues=this.recalcValues.filter(u),this.recalcDirty=Du(this.recalcDirty,c)},e}();function Vc(e,t){var r;e[t]=(null!==(r=e[t])&&void 0!==r?r:0)+1}function jc(e,t,r){return e.push("".concat(t.join("."),": expected ").concat(r)),!1}function Wc(e,t){return function(r,n,i){return b(r)&&e(r)||jc(n,i,t)}}function Hc(e,t,r,n){for(var i=[],o=t(e,i,[n]),a=0,s=i;a<s.length;a++){Vc(r,s[a])}return o}function Qc(e,t,r,n){if(!Hc(e,dd,r,n))return[];var i="".concat(n,".<index>");return e.filter((function(e){return Hc(e,t,r,i)}))}function qc(e){return function(t,r,n){return!!N(t)||e(t,r,n)}}function zc(e){return function(t,r,n){if(N(t))return jc(r,n,"non-null object");var i=n.length;try{var o=!0;for(var a in e)n[i]=a,o=o&&e[a](t[a],r,n);return o}finally{n.length=i}}}function Yc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,i){return e&&i(t,r,n)}),!0)}}function Jc(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,i){return t.reduce((function(e,t){return e&&t(r)(r,n,i)}),e(r,n,i))}}function Xc(e){return function(t,r,n){if(!Array.isArray(t))return jc(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,i){return t&&e(i,r,n)}),!0)}finally{n.pop()}}}function $c(e){var t="one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,i){if(N(r))return jc(n,i,"non-null object");var o=i.length;try{var a="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return N(a)?(i.push("kind"),jc(n,i,t)):a(r,n,i)}finally{i.length=o}}}function Zc(e){var t="typeof one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,i){var o=e[typeof r];return N(o)?jc(n,i,t):o(r,n,i)}}function ed(e){return"number"==typeof e&&e>-1/0&&e<1/0}function td(e){return(0|e)===e||Math.floor(e)===e}function rd(e,t,r){return void 0===r&&(r=0!==e?"integer >= ".concat(e," and < ").concat(t):"natural < ".concat(t)),Wc((function(r){return"number"==typeof r&&r>=e&&r<t&&td(r)}),r)}var nd=Wc((function(e){return!1}),"never"),id=Wc((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),od=Wc(ed,"finite number"),ad=Wc((function(e){return ed(e)&&td(e)}),"integer"),sd=rd(0,1/0,"natural"),ld=Wc((function(e){return"string"==typeof e}),"string"),ud=Wc((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),cd=Wc((function(e){return"boolean"==typeof e}),"boolean"),dd=Wc((function(e){return Array.isArray(e)}),"Array");function fd(e){return Wc((function(t){return t===e}),JSON.stringify(e))}function pd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=Object.create(null),n=Object.create(null),i=0,o=e;i<o.length;i++){var a=o[i];"number"==typeof a?n[a]=!0:r[a]=!0}var s="one of ".concat(JSON.stringify(e.slice().sort()));return Wc((function(e){switch(typeof e){case"string":case"symbol":return!0===r[e];case"number":return!0===n[e]}return!1}),s)}function md(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var hd=Wc((function(e){return"string"==typeof e&&md(e)}),"formula text"),gd=zc({functionId:sd,functionName:ud}),vd=zc({errorType:sd,errorName:Wc((function(e){return"string"==typeof e&&e.length>1&&H(e,"#")}),"error name")}),Sd=zc({iformat:sd,formatString:ld,builtIn:cd}),yd=Wc((function(e){return"string"==typeof e||ed(e)}),"string or finite number"),Cd=zc({sheetId:yd,sheetName:ld}),Rd=rd(0,We),bd=rd(0,xe),Nd=zc({row:Rd,column:bd}),Td=Wc((function(e){return null==e.lastRow||e.lastRow>=e.row}),"lastRow >= row"),Pd=Wc((function(e){return null==e.lastColumn||e.lastColumn>=e.column}),"lastColumn >= column"),Ed=Jc(Yc(Nd,zc({lastRow:qc(Rd),lastColumn:qc(bd)})),(function(e){return Td}),(function(e){return Pd})),kd=Yc(Ed,zc({sheetId:yd})),Od=Yc(kd,zc({lastRow:qc(nd),lastColumn:qc(nd)})),Ad=zc({kind:fd("Blank")}),Id=zc({kind:fd("Error"),type:sd}),_d=Zc({number:od,string:ld,boolean:cd,object:$c({Blank:Ad,Error:Id})}),Fd=Zc({number:sd,string:ld}),Md=Yc(zc({value:_d,iformat:sd,failureReason:qc(ld)}),$c({CellFormula:zc({formulaBarText:hd}),ArrayFormula:zc({formulaBarText:qc(nd)}),Value:zc({formulaBarText:ld})})),Dd=zc({range:kd,excludeRows:qc(Xc(Rd)),excludeColumns:qc(Xc(bd)),data:qc(Md),fromStateId:qc(ad)}),wd=zc({isSpilled:cd,formulaBarText:hd}),Ld=zc({range:kd,data:qc(wd),fromStateId:qc(ad)}),xd=zc({sheetId:yd,usedRange:qc(Ed)}),Bd=Zc({number:od,string:ld,boolean:cd,object:$c({Error:Id})}),Ud=zc({kind:fd("NamedValue"),value:Bd}),Gd=zc({kind:fd("NamedFormula"),formulaBarText:hd}),Kd=zc({kind:fd("NamedRange"),range:kd}),Vd=zc({column:sd,name:ud}),jd=function(e){var t;return(null!==(t=e.lastRow)&&void 0!==t?t:e.row)-e.row+1},Wd=function(e){var t;return(null!==(t=e.lastColumn)&&void 0!==t?t:e.column)-e.column+1},Hd=Wc((function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+jd(e.range)<We)}),"enough rows for headers and totals"),Qd=Wc((function(e){var t=e.range.column,r=e.range.column+Wd(e.range);return e.columns.every((function(e){return e.column>=t&&e.column<r}))}),"column names in range"),qd=Jc(zc({kind:fd("NamedTable"),range:kd,hasHeadersRow:cd,hasTotalsRow:cd,columns:Xc(Vd)}),(function(e){return Hd}),(function(e){return Qd})),zd=zc({kind:fd("NamedFailure"),failureReason:ld,objectKind:qc(pd("NamedValue","NamedFormula","NamedRange","NamedTable"))}),Yd=zc({name:ld,data:qc($c({NamedValue:Ud,NamedFormula:Gd,NamedRange:Kd,NamedTable:qd,NamedFailure:zd}))}),Jd=function(e){return Jc(Yd,(function(t){return function(e){return Wc((function(t){var r;return"NamedTable"!==(null===(r=t.data)||void 0===r?void 0:r.kind)||null==e}),"NamedTable at global scope")}(e)}))},Xd=zc({scope:qc(yd),objects:qc(dd),fromStateId:qc(ad)}),$d=Wc((function(e){return e.length>0}),"a non-empty array"),Zd=Wc((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),ef=Jc(Xc(kd),(function(e){return $d}),(function(e){return Zd})),tf=Yc(zc({range:ef,origin:qc(Nd),viewport:qc(kd)}),$c({CellFormula:zc({formulaBarText:hd,value:qc(nd)}),Value:zc({formulaBarText:ld,value:_d}),Inferred:zc({formulaBarText:ld,value:qc(nd)})})),rf=$c({SetFormat:zc({format:Fd}),RibbonFormat:zc({ribbon:pd.apply(void 0,y(ns))}),ChangeDecimals:zc({changeDecimals:rd(-20,20)})}),nf=zc({range:ef,operation:rf,origin:qc(Nd),viewport:qc(kd)}),of=zc({range:kd,formulaBarText:Wc((function(e){return"string"==typeof e&&(0===e.length||md(e))}),"empty string or text denoting formula"),origin:qc(Nd),viewport:qc(kd)}),af=Wc((function(e){var t=Wd(e.source),r=jd(e.source);return e.target.column+t<=xe&&e.target.row+r<=We}),"(target,source) in range"),sf=Jc(zc({kind:pd("CopyPaste"),target:Od,source:kd,viewport:qc(kd)}),(function(e){return af})),lf=Wc((function(e){return 2===e.length}),"2 AM/PM symbols"),uf=Wc((function(e){return 7===e.length}),"7 day symbols"),cf=Wc((function(e){return 12===e.length}),"12 month symbols");function df(e){var t=S(e,h);return Wc((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var ff,pf=df(Mt),mf=df(ui),hf=df(li),gf=df(ai),vf=df(si),Sf=zc({worksheetFunctionNames:dd,thousandsData:Xc(sd),errorTypeNames:dd,specialRefNames:Jc(Xc(qc(ud)),(function(e){return pf})),trueName:ud,falseName:ud,rowLetter:ud,columnLetter:ud,leftBrace:ud,rightBrace:ud,leftBracket:ud,rightBracket:ud,decimalSeparator:ud,listSeparator:ud,columnSeparator:ud,rowSeparator:ud,thousandsSeparator:ld,lcid:sd,country:sd,numberDecimals:sd,isExpSepBySpace:cd,fractionSeparator:ud,isPercentSepBySpace:cd,currencyFormat:pd(Ja.Paren,Ja.Lead,Ja.Intern,Ja.Trail),isCurrencySymbolLead:cd,isCurrencySepBySpace:cd,currencySymbol:ld,currencyDecimals:sd,dateOrder:pd(Xa.MDY,Xa.DMY,Xa.YMD,Xa.MYD,Xa.DYM,Xa.YDM),dateSeparator:ld,dateAltSeparator:ld,year4Digits:cd,month2Digits:cd,day2Digits:cd,longDateFormat:cd,timeSeparator:ld,timeAltSeparator:qc(ld),hour2Digits:cd,clock24Hour:cd,isAMPMSepBySpace:cd,ampmSymbols:Jc(Xc(ld),(function(e){return lf})),dayNameShort:Jc(Xc(ld),(function(e){return uf})),dayNameLong:Jc(Xc(ld),(function(e){return uf})),monthNameShort:Jc(Xc(ld),(function(e){return cf})),monthNameLong:Jc(Xc(ld),(function(e){return cf})),pictureSpecial:Jc(Xc(qc(ud)),(function(e){return mf})),pictureSingle:Jc(Xc(qc(ud)),(function(e){return hf})),pictureColor:Jc(Xc(qc(ud)),(function(e){return gf})),pictureDbnum:Jc(Xc(qc(ud)),(function(e){return vf})),sysDateFormat:ld,sysTimeFormat:ld}),yf=zc({yr:ad,mon:rd(1,13),dom:rd(1,6),wdy:rd(1,8),hour:rd(0,24),min:rd(0,60),sec:rd(0,60),fracSec:fd(0),rounding:rd(0,4)}),Cf=Jc(zc({bias:od,standardDate:qc(yf),standardBias:od,daylightDate:qc(yf),daylightBias:od}),(function(e){return Wc((function(e){return N(e.standardDate)===N(e.daylightDate)}),"standardDate iff daylightDate")})),Rf=zc({date1904:qc(cd),dateCompatibility:qc(cd),timezone:qc(Cf)}),bf=qc($c({Origin:zc({iformat:qc(nd),knownFormat:qc(nd)}),Iformat:zc({iformat:sd,knownFormat:qc(nd)}),Known:zc({iformat:qc(nd),knownFormat:pd.apply(void 0,v($a))}),Inferred:zc({iformat:qc(nd),knownFormat:qc(nd)}),Aggregate:zc({iformat:qc(nd),knownFormat:qc(nd)})})),Nf=((Gc={})[xo.Number]=!0,Gc[xo.String]=!0,Gc[xo.Boolean]=!0,Gc[xo.Error]=!0,Gc[xo.Array]=!1,Gc[xo.Blank]=!0,Gc[xo.Rich]=!1,Gc),Tf=Wc((function(e){return Nf[e.kind]}),"supported ReadOper"),Pf=(c.arrayMapTree.floorToPowerOf2,c.arrayMapTree.ArrayMapTree),Ef=(c.arrayMapTree.RootPointer,c.arrayMapTree.enumerateInOrder,c.arrayMapTree.enumerateKeysInOrder,function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}());function kf(e){return new Ef(e)}function Of(e){var t=e.value;if(ge(t)){var r=t.value;switch(typeof r){case"object":switch(r.kind){case"Blank":return xo.Blank;case"Error":return xo.Error;case"Rich":return xo.Rich;default:L("calc.calc.extractResultValue",r)}case"boolean":return xo.Boolean;case"number":return xo.Number;case"string":return xo.String;default:return L("calc.calc.extractResultValue",r)}}}function Af(e){var t=e.value;if(!ge(t))return t.reason.kind}function If(e,t,r,n){switch(void 0===n&&(n=ff.Estimation),n){case ff.PrecisionTest:return he(ti([{kind:zu.GetTimeKind,getTimeKind:r}]));case ff.Estimation:switch(r){case ya.NonVolatile:return he(ti([{kind:zu.GetTimeKind,getTimeKind:r}]));case ya.ValueCell:case ya.Volatile:}break;case ff.GroundTruth:}var i=e.mathpack,o=e.datepack,a=new Date,s=o.utcToLocal(e,Fo(a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCDay()+1,a.getUTCMilliseconds(),Ao.Round1000ths),e.timezone);D("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==s);var l=s.yr,u=s.rounding,c=s.mon,d=s.dom,f=s.hour,p=s.min,m=s.sec,h=s.fracSec;t<_o.Instant&&(h=0,m=0,p=0,f=0),t<_o.Day&&(d=1,c=1);var g=Fo(l,c,d,f,p,m,1,h,u),v=o.toNum(e,g);D("calc.calc.PartialWorkbookDocumentCollection: toNum",!kn(v));var S=i.toNumber(v);if(n===ff.GroundTruth)return Se(v);var y=o.toNum(e,s);D("calc.calc.PartialWorkbookDocumentCollection: toNum",!kn(y));var C,R=i.toNumber(y);switch(t){case _o.Instant:C=R;break;case _o.Day:C=S+1;break;case _o.Year:var b=Fo(l+1,c,d,f,p,m,1,h,u),N=o.toNum(e,b);D("calc.calc.PartialWorkbookDocumentCollection: toNum",!kn(N)),C=i.toNumber(N)}return R<S+10/1440||R>C-10/1440?he(ti([{kind:zu.TimeGranularity,granularity:t}])):Se(v)}!function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(ff||(ff={}));var _f=c.rbMapTree.RedBlackMapTree,Ff=A()((function(e){return{kind:"NamedValue",value:e}})),Mf=A()((function(e){return{kind:"NamedRange",value:e}})),Df=_f.create((function(e,t){return e-t}));function wf(e,t,r,n,i){var o,a=e.sheet,s=e.range,l=t?ke(s.row-1,s.col,1,s.cols):void 0,u=r?ke(s.row+s.rows,s.col,1,s.cols):void 0,c=yn(yn(l,e.range),u),d=n.reduce((function(t,r){return D("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name)}),Df),f=_f.create(i);d.forEach((function(e,t){return f=f.setValue(t,e),!0}));var p=d.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(o={},o[Mt.Data]=e,o[Mt.Headers]=l?Ge(a,l):void 0,o[Mt.Totals]=u?Ge(a,u):void 0,o[Mt.All]=Ge(a,c),o),columnNames:f,columnIndexes:d,allColumnNamesAvailable:p,hasHeadersRow:t,hasTotalsRow:r}}var Lf=A()((function(e){return{kind:"NamedFormula",fmla:e}})),xf=A()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),Bf=hc(),Uf=hc(),Gf={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var Kf=function(){function e(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}return e.create=function(t){return new e(_f.create(t),!1,Bf,Uf)},e.prototype.update=function(t,r,n,i){return t!==this.names||r!==this.allAvailable||n!==this.tables||i!==this.ranges?new e(t,r,n,i):this},e.prototype.getEntry=function(e,t,r){var n=this.names.getEntry(t);return void 0===n?this.allAvailable?Se(void 0):he(ti([{kind:zu.NameLoc,name:De(e,t),source:r}])):Se(!1!==n.value?n:void 0)},e.prototype.getEntryIfDefined=function(e){var t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(e){var t;return this.tables.forEachGe(e,(function(e,r){return t=r,!1})),t},e.prototype.getIntersectingTables=function(e){var t=[];return this.tables.forEachMeets(e,(function(e,r){return t.push(r),!0})),t},e.prototype.getNamedRanges=function(e){var t;return null!==(t=this.ranges.getValue(e))&&void 0!==t?t:[]},e.prototype.getAvailableNames=function(e){var t=[];return this.names.forEach((function(r,n){return!1!==n&&t.push(De(e,r)),!0})),t},e.prototype.forEachAvailableName=function(e){return this.names.forEach((function(t,r){return e(t,!1===r?void 0:r)}))},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter((function(e,t){return!1!==t})):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.resetLazyData=function(){this.names.forEach((function(e,t){return!1!==t&&t.lazyData.reset(),!0}))},e.prototype.onWriteNamedTable=function(e,t,r){var n=t.specialRefRanges[Mt.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)},e.prototype.onWriteNamedRange=function(e,t,r){var n,i=t.value.ranges[0],o=null!==(n=this.ranges.getValue(i))&&void 0!==n?n:[],a="remove"===r?o.filter((function(t){return Fn(e.scope,t.scope)&&e.name===t.name})):Object(gu.__spreadArray)(Object(gu.__spreadArray)([],o,!0),[e],!1);return this.update(this.names,this.allAvailable,this.tables,0===a.length?this.ranges.remove(i):this.ranges.setValue(i,a))},e}(),Vf=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=Kf.create(e),this.emptyRecalcFailures=this.recalcFailures=Pf.create(e)}return e.prototype.clone=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return ge(r)?Se(void 0!==r.value?De(this.scope,r.value.key):void 0):r},e.prototype.getNameFormula=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return ge(r)?Se(void 0!==r.value?r.value.value:void 0):r},e.prototype.getContainingTable=function(e){return this.contents.getContainingTable(e)},e.prototype.getIntersectingTables=function(e){return this.contents.getIntersectingTables(e)},e.prototype.getNamedRanges=function(e){return this.contents.getNamedRanges(e)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.getAvailableNames=function(e){return this.contents.getAvailableNames(e)},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.resetLazyData=function(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()},e.prototype.setNamedObject=function(e,t,r,n,i){var o,a=this.contents.getEntryIfDefined(t.name);if(void 0!==a&&(o=i(De(this.scope,a.key),a.value.obj,"remove")).kind===me.Failure)return o;if((this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new Ef((function(){return n(e,t,r)}))}),this.isCurrent=this.isChanged=!0,void 0!==r)&&(o=i(t,r,"add")).kind===me.Failure)return o;return ye},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e,t){var r=this;if(this.isChanged||e!==this.oldStateId)return Se(!1);this.contents=this.oldContents,this.isCurrent=!0;var n=Se(!0);return this.contents.forEachAvailableName((function(e,i){if(void 0===i)return!0;var o=t(De(r.scope,e),i.obj,"add");return o.kind===me.Success||(n=o,!1)})),n},e.prototype.onWriteNamedTable=function(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)},e.prototype.onWriteNamedRange=function(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)},e.prototype.forEachAvailableName=function(e){return this.contents.forEachAvailableName(e)},e}(),jf=(c.table.makeEmptyTable,c.table.entry),Wf=function(){function e(e,t,r,n,i){var o=this;this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=n,this.onWriteNamedObject=function(e,t,r){if("NamedRange"===t.kind){var n=t.value;if(D("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",En(t.value.sheets.document,e.scope.document)),(i=o.getNamesBySheetId(n.sheets.index)).kind===me.Failure)return i;i.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){var i;if((i=o.getNamesBySheetId(t.specialRefRanges[Mt.All].sheet.index)).kind===me.Failure)return i;i.value.onWriteNamedTable(e,t,r)}return ye},this.globalNames=null!=i?i:new Vf(t,Pe(e))}return e.prototype.clone=function(){var t;if(this.sheetScopedNames)for(var r in t=g(),this.sheetScopedNames){var n=this.sheetScopedNames[r];t[r]=n.clone()}return new e(this.document,this.stringCompareCI,t,void 0,this.globalNames.clone())},e.prototype.setNamedObject=function(e,t,r,n){var i,o,a=this.getNameFormula(t,be.StructRef);void 0!==r&&"NamedTable"===r.kind&&ge(a)&&void 0!==a.value&&"NamedTable"===a.value.obj.kind&&(i=a.value.obj,o=r,jn(i.specialRefRanges[Mt.Data],o.specialRefRanges[Mt.Data])&&i.hasHeadersRow===o.hasHeadersRow&&i.hasTotalsRow===o.hasTotalsRow)&&(r=function(e,t){var r=e.columnNames,n=e.columnIndexes;t.columnIndexes.forEach((function(t,n){var i=e.columnIndexes.getValue(t);return void 0!==i&&(r=r.remove(i)),!0})),t.columnIndexes.forEach((function(e,t){return r=r.setValue(t,e),n=n.setValue(e,t),!0}));var i=n.getCount()===t.specialRefRanges[Mt.All].range.cols;return Object(gu.__assign)(Object(gu.__assign)({},t),{columnNames:r,columnIndexes:n,allColumnNamesAvailable:i})}(a.value.obj,r));var s=this.getNamesBySheetId(t.scope.index);return s.kind===me.Failure?s:s.value.setNamedObject(e,t,r,n,this.onWriteNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getNamesBySheetId(e.index);return t.kind===me.Failure?t:Se(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNamesBySheetId(e.index);return r.kind===me.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)},e.prototype.setSheetNames=function(t){for(var r,n,i=null!==(r=this.sheetScopedNames)&&void 0!==r?r:this.oldSheetScopedNames,o=g(),a=0,s=t;a<s.length;a++){var l=s[a].sheetId;o[l]=null!==(n=null==i?void 0:i[l])&&void 0!==n?n:new Vf(this.stringCompareCI,Ke(this.document,l))}return new e(this.document,this.stringCompareCI,o,void 0,this.globalNames)},e.prototype.getNameLoc=function(e,t,r){var n=this.getNamesBySheetId(e);if(n.kind===me.Failure)return n;var i=n.value.getNameLoc(t,r);return i.kind,me.Failure,i},e.prototype.getAvailableNamesInScope=function(e){var t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===me.Success&&C(t,r.value.getAvailableNames(we(this.document,e))),t},e.prototype.getAllDocumentNames=function(){return this.globalNames.getAvailableNames(Pe(this.document))},e.prototype.getAvailableTableColumns=function(e){var t=this.getNameFormula(e,be.StructRef),r=[];if(t.kind!==me.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind)return{cols:r,isPartial:!0};var n=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach((function(e){return r.push(e),!0})),{cols:r,isPartial:n}},e.prototype.getNameFormula=function(e,t){var r=this.getNamesBySheetId(e.scope.index);return r.kind===me.Failure?r:r.value.getNameFormula(e.name,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===me.Failure?t:Se(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===me.Failure?t:Se(t.value.setRecalcFailure(e.name))},e.prototype.getNamesBySheetId=function(e){if(void 0===e)return Se(this.globalNames);if(!this.sheetScopedNames)return he(ti([{kind:zu.SheetNames}]));var t=this.sheetScopedNames[e];return void 0===t?he(ti([{kind:zu.SheetId,document:this.document,sheetId:e}])):Se(t)},e.prototype.getContainingTable=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getContainingTable(e.range))},e.prototype.getNamedRanges=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getNamedRanges(e.range))},e.prototype.getIntersectingTables=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getIntersectingTables(e.range))},e.prototype.getStructRefColumn=function(e,t){var r=this.getNameFormula(e,be.StructRef);if(r.kind===me.Failure)return r;if(void 0===r.value)return Se(void 0);if("NamedTable"!==r.value.obj.kind)return he(Hi(Ui.NamedObjectNotTable));var n,i=r.value.obj;if("string"==typeof t)n=i.columnNames.getEntry(t);else{var o=i.columnIndexes.getValue(t);n=void 0===o?void 0:jf(o,t)}if(void 0===n)return i.allColumnNamesAvailable?Se(void 0):he(ti([{kind:zu.ColumnName,table:e,columnNameOrIndex:t}]));var a=i.specialRefRanges[Mt.Data],s=a.sheet,l=a.range,u=Ge(s,ke(l.row,n.value,l.rows,1));return Se(He(n.key,u,i.hasHeadersRow,i.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getNameFormula(e,be.StructRef);return r.kind===me.Failure?r:void 0===r.value?Se(void 0):"NamedTable"!==r.value.obj.kind?he(Hi(Ui.NamedObjectNotTable)):Se(r.value.obj.specialRefRanges[t])},e.prototype.onCellModified=function(e){this.forEachSheetScope((function(t){t.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheetScope((function(t){t.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheetScope((function(t){t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0},e.prototype.resetLazyData=function(){this.forEachSheetScope((function(e){e.resetLazyData()})),this.globalNames.resetLazyData()},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheetScope((function(t){return r=e,n=t.getStatistics(),e={namesCount:r.namesCount+n.namesCount,tablesCount:r.tablesCount+n.tablesCount,rangesCount:r.rangesCount+n.rangesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.forEachSheetScope=function(e){for(var t in this.sheetScopedNames){if(Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t))e(this.sheetScopedNames[t])}},e}(),Hf=function(){function e(e,t,r,n,i,o){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=i,this.oldData=o}return e.prototype.clone=function(){return new e(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)},e.prototype.setSheetNames=function(t){for(var r,n=null!==(r=this.data)&&void 0!==r?r:this.oldData,i=g(),o=[],a=[],s=0;s<t.length;s+=1){var l=t[s],u=l.sheetName,c=l.sheetId;o[s]=c,a.push([u,c]);var d=null==n?void 0:n[c];if(void 0===d){var f=Ke(this.document,c);i[c]={pos:s,name:u,sheetIndex:f}}else i[c]=Object(gu.__assign)(Object(gu.__assign)({},d),{pos:s,name:u})}var p=Pf.create(this.stringCompareCI).setValues(a);return new e(this.document,this.stringCompareCI,o,p,i,void 0)},e.prototype.advanceState=function(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0},e.prototype.getSheetRangeIds=function(e){var t,r;if(!this.sheetPosToId)return he(ti([{kind:zu.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!ge(n))return n;var i=this.getSheetById(e.index2);if(!ge(i))return i;t=P(n.value.pos,i.value.pos),r=E(n.value.pos,i.value.pos)+1}for(var o=[],a=t;a<r;a+=1)o.push(this.sheetPosToId[a]);return Se(je(o,t))},e.prototype.getSheetById=function(e){if(!this.data)return he(ti([{kind:zu.SheetNames}]));var t=this.data[e];return void 0===t?he(ti([{kind:zu.SheetId,document:this.document,sheetId:e}])):Se(t)},e.prototype.getSheetByName=function(e){if(!this.sheetNameToId)return he(ti([{kind:zu.SheetNames}]));var t=this.sheetNameToId.getValue(e);return void 0===t?Se(void 0):this.getSheetById(t)},e.prototype.forEachSheet=function(e){if(this.sheetPosToId&&this.data)for(var t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],i=this.data[n];i&&e(i,n)}},e}(),Qf=function(){function e(e,t,r,n,i,o,a,s){void 0===i&&(i=new Hf(e,t)),void 0===s&&(s=new Wf(e,t)),this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=i,this.grids=o,this.oldGrids=a,this.nameManager=s}return e.prototype.clone=function(t){var r;if(void 0===t&&(t=Lc.Server),this.grids)for(var n in r=g(),this.grids){var i=this.grids[n];r[n]=i.clone(t)}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),r,void 0,this.nameManager.clone())},e.prototype.setClientValue=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===me.Failure?n:Se(n.value.setClientValue(e.range,t,r))},e.prototype.setClientFormula=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===me.Failure?n:Se(n.value.setClientFormula(e.range,e.range,t,r))},e.prototype.setRecalcFailure=function(e,t){var r=this.getGridById(e);return r.kind===me.Failure?r:Se(r.value.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getGridById(e);return r.kind===me.Failure?r:Se(r.value.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===me.Failure?n:Se(n.value.setClientFormat(e.range,t,r))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.setHiddenRows(t,r))},e.prototype.setHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.setHiddenCols(t,r))},e.prototype.setMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.setMergeCell(e.range))},e.prototype.setInFilterMode=function(e,t){var r=this.getGridById(e);return r.kind===me.Failure?r:Se(r.value.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,i,o,a,s,l){var u=this.getGridById(t.sheet.index);if(u.kind===me.Failure)return u;var c=void 0!==s&&Hn(t.sheet,s.sheet)?s.range:void 0;return Se(u.value.setCellContents(e,t.set,r,n,i,o,a,c,l))},e.prototype.setRangeFormula=function(e,t,r,n,i,o,a,s){var l=this.getGridById(t.sheet.index);if(l.kind===me.Failure)return l;var u=void 0!==a&&Hn(t.sheet,a.sheet)?a.range:void 0;return Se(l.value.setRangeFormula(e,t.range,r,n,i,o,u,s))},e.prototype.copyRange=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.copyRange(e.range))},e.prototype.pasteRange=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===me.Failure?n:Se(n.value.pasteRange(e.range,t,r))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(ic(t.sheetIndex,r.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(ic(t.sheetIndex,r.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(ic(t.sheetIndex,r.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)},e.prototype.setUndefinedNames=function(e){return this.nameManager.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){return this.nameManager.promoteNamedObjects(e,t)},e.prototype.setSheetNames=function(t){for(var r,n,i=null!==(r=this.grids)&&void 0!==r?r:this.oldGrids,o=g(),a=0,s=t;a<s.length;a++){var l=s[a].sheetId;o[l]=null!==(n=null==i?void 0:i[l])&&void 0!==n?n:Kc.create()}return new e(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(t),o,void 0,this.nameManager.setSheetNames(t))},e.prototype.extendServerUnused=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.extendServerUnused(t,r))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e,t,r)},e.prototype.getNameFormula=function(e,t){return this.nameManager.getNameFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){return this.nameManager.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){return this.nameManager.setRecalcNameFailure(e)},e.prototype.getContainingTable=function(e){var t=this.nameManager.getContainingTable(e);if(t.kind===me.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===me.Failure)return he(ti([r.reason]));var n=Du(Qu(e.range),Xu);return xu(n,r.value.getServerAvailability())?ye:he(ti([{kind:zu.ContainingTable,range:e}]))},e.prototype.getNamedRanges=function(e){var t=this.nameManager.getNamedRanges(e);if(t.kind===me.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===me.Failure)return he(ti([r.reason]));var n=Du(Qu(e.range),Xu);return xu(n,r.value.getServerAvailability())?Se([]):he(ti([{kind:zu.NamedRanges,range:e}]))},e.prototype.getIntersectingTables=function(e){return this.nameManager.getIntersectingTables(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getEditedFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getEditedFormula(e.range))},e.prototype.forEachEditedFormula=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.forEachEditedFormula(e.range,t))},e.prototype.getEditedValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getEditedValue(e.range))},e.prototype.forEachEditedValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.forEachEditedValue(e.range,t))},e.prototype.getEditedFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getEditedFormat(e.range))},e.prototype.forEachEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.forEachEditedFormat(e.range,t))},e.prototype.getEditedStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getEditedStyle(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getGridById(e);return t.kind===me.Failure?t:t.value.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?Mc:n.value.getHiddenRows(t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:n.value.tryGetHiddenRows(t,r)},e.prototype.getHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?Mc:n.value.getHiddenCols(t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:n.value.tryGetHiddenCols(t,r)},e.prototype.getMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getMergeCell(e.range))},e.prototype.getServerFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getServerFormat(e.range))},e.prototype.getServerStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getServerStyle(e.range))},e.prototype.getClientFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getClientValue(e.range))},e.prototype.getRecalcValues=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getRecalcValues(e.range))},e.prototype.forEachRecalcValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.forEachRecalcValue(e.range,t))},e.prototype.getServerValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getGridById(e);return t.kind===me.Failure?t:Se(t.value.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.allEditedAvailable(e.range))},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===me.Failure?r:Se(r.value.forEachRecalcDirty(e.range,t))},e.prototype.hasRecalcDirty=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===me.Failure?t:Se(t.value.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===me.Failure?n:Se(n.value.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.sheets.getSheetByName(e);return t.kind===me.Failure||void 0===t.value?t:Se(t.value.sheetIndex)},e.prototype.getSheetName=function(e){var t=this.sheets.getSheetById(e);return t.kind===me.Failure?t:Se(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getGridById(e);return t.kind===me.Failure?t:Se(t.value.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.resolveCellStyle=function(e){return this.styles.resolveCellStyle(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.setStyles=function(e,t){this.styles.setStyles(e,t)},e.prototype.setFonts=function(e,t){this.styles.setFonts(e,t)},e.prototype.setFills=function(e,t){this.styles.setFills(e,t)},e.prototype.setBorders=function(e,t){this.styles.setBorders(e,t)},e.prototype.onCellModified=function(e,t){this.forEachSheet((function(r,n){n.onCellModified(e,t)})),this.nameManager.onCellModified(e)},e.prototype.collectGarbage=function(e,t){this.forEachSheet((function(r,n){n.collectGarbage(e,t)})),this.nameManager.collectGarbage(e)},e.prototype.advanceState=function(e,t){this.forEachSheet((function(r,n){n.advanceState(e,t)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e,t){t.clearCompiledFormulas()})),this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=wc;return this.forEachSheet((function(t,r){return n=e,i=r.getStatistics(),e={serverFormulaeNodeCount:n.serverFormulaeNodeCount+i.serverFormulaeNodeCount,serverFormatsNodeCount:n.serverFormatsNodeCount+i.serverFormatsNodeCount,serverStylesNodeCount:n.serverStylesNodeCount+i.serverStylesNodeCount,serverValuesNodeCount:n.serverValuesNodeCount+i.serverValuesNodeCount,serverDirtySetSubspaceCount:n.serverDirtySetSubspaceCount+i.serverDirtySetSubspaceCount,editedFormulaeNodeCount:n.editedFormulaeNodeCount+i.editedFormulaeNodeCount,editedFormatsNodeCount:n.editedFormatsNodeCount+i.editedFormatsNodeCount,editedStylesNodeCount:n.editedStylesNodeCount+i.editedStylesNodeCount,editedValuesNodeCount:n.editedValuesNodeCount+i.editedValuesNodeCount,editedDirtySetSubspaceCount:n.editedDirtySetSubspaceCount+i.editedDirtySetSubspaceCount,clientFormulaeNodeCount:n.clientFormulaeNodeCount+i.clientFormulaeNodeCount,clientFormatsNodeCount:n.clientFormatsNodeCount+i.clientFormatsNodeCount,clientValuesNodeCount:n.clientValuesNodeCount+i.clientValuesNodeCount,recalcValuesNodeCount:n.recalcValuesNodeCount+i.recalcValuesNodeCount,recalcDirtySetSubspaceCount:n.recalcDirtySetSubspaceCount+i.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:n.recalcFailuresSetSubspaceCount+i.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:n.recalcTaintSetSubspaceCount+i.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:n.availabilitySetSubspaceCount+i.availabilitySetSubspaceCount,availabilityHistorySize:n.availabilityHistorySize+i.availabilityHistorySize,hiddenRowsNodeCount:n.hiddenRowsNodeCount+i.hiddenRowsNodeCount,hiddenColsNodeCount:n.hiddenColsNodeCount+i.hiddenColsNodeCount};var n,i})),e},e.prototype.getNameStatistics=function(){return this.nameManager.getNameStatistics()},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e},e.prototype.forEachSheet=function(e){var t=this.grids;t&&this.sheets.forEachSheet((function(r,n){var i=t[n];i&&e(r,i)}))},e.prototype.getGridById=function(e){var t=this.grids;if(!t)return he({kind:zu.SheetNames});var r=t[e];return void 0===r?he({kind:zu.SheetId,document:this.document,sheetId:e}):Se(r)},e}(),qf=ps.getWorksheetFuncModule.getWorksheetFunc,zf=(c.anonymizer.anonymize,c.anonymizer.anonymizeFormulaString),Yf=c.anonymizer.anonymizeMagnitude,Jf=(c.anonymizer.kindAnonymizers,Ce.adjust.adjustFormulaOrigin),Xf=function(){function e(e){this.iformats=[],this.formatStrings=g(),this.knownFormats=e}return e.prototype.clone=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=g(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?he({kind:zu.NumberFormat,iformat:e}):Se(t.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(e){return Se(this.knownFormats[e])},e.prototype.getFormatString=function(e){return Se(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=g()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var i=e[t];r.iformats[t]=i,r.formatStrings[i.formatString]=t}))},e}(),$f=Ce.styleServiceTypes.BorderLineType,Zf=Ce.styleServiceTypes.FillKind,ep=Ce.styleServiceTypes.FontUnderline,tp=Ce.styleServiceTypes.FontVerticalAlignment,rp=Ce.styleServiceTypes.HorizontalAlignment,np=Ce.styleServiceTypes.PatternType,ip=Ce.styleServiceTypes.VerticalAlignment,op={type:$f.None,color:{argb:"00000000"}},ap={font:{name:"Calibri",bold:!1,italic:!1,underline:ep.None,strikethrough:!1,verticalAlign:tp.None,size:11,color:{argb:"ff000000"}},fill:{kind:Zf.Pattern,pattern:np.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:op,bottom:op,left:op,right:op},alignment:{horizontal:rp.Automatic,vertical:ip.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}},sp=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function t(e,t){Object.keys(e).map(Number).forEach((function(r){t[r]=e[r]}))}var r=new e;return t(this.styles,r.styles),t(this.fonts,r.fonts),t(this.fills,r.fills),t(this.borders,r.borders),r},e.prototype.resolveCellStyle=function(e){if(e===uc.Blank)return Se(ap);var t=this.styles[e];if(void 0===t)return he({kind:zu.StyleId,styleId:e});var r=t.fontId,n=t.fillId,i=t.borderId,o=t.alignment,a=void 0!==r?this.fonts[r]:ap.font;if(void 0===a)return he({kind:zu.FontId,fontId:r});var s=void 0!==n?this.fills[n]:ap.fill;if(void 0===s)return he({kind:zu.FillId,fillId:n});var l=void 0!==i?this.borders[i]:ap.border;return void 0===l?he({kind:zu.BorderId,borderId:i}):Se({font:a,fill:s,border:l,alignment:o})},e.prototype.setStyles=function(e,t){var r=this;t||(this.styles=[]),Object.keys(e).map(Number).forEach((function(t){r.styles[t]=e[t]}))},e.prototype.setFonts=function(e,t){var r=this;t||(this.fonts=[]),Object.keys(e).map(Number).forEach((function(t){r.fonts[t]=e[t]}))},e.prototype.setFills=function(e,t){var r=this;t||(this.fills=[]),Object.keys(e).map(Number).forEach((function(t){r.fills[t]=e[t]}))},e.prototype.setBorders=function(e,t){var r=this;t||(this.borders=[]),Object.keys(e).map(Number).forEach((function(t){r.borders[t]=e[t]}))},e}(),lp=Ee(0,0),up=function(e){function t(){var t=e.call(this,void 0)||this;return t.fns=[],t}return Object(gu.__extends)(t,e),t.prototype.wsfNode=function(e){this.fns.push(gi(e))},t.prototype.operatorNode=function(e){this.fns.push(hi(e))},t}(no);var cp,dp=gt([],[],[],Uo.None,Ye.Exact),fp={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onUnavailable:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}},pp=function(){function e(e,t,r,n,i,o){var a=this;this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=i,this.isServerWorkbookLoad=o,this.renderBlanksAsZerosEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new c.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[hs.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=function(e,t,r){var n=e?cc.ServerNamedFormula:cc.EditNamedFormula;switch(r.kind){case"NamedFormula":var i=r.fmla,o=a.parser.parseFormula(Yo(Re.NameManager,lp),i);D("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var s=e&&a.isServerWorkbookLoad,l=ra(Le(Pe(a.documentLoc),lp),void 0,s),u=o,c=a.checkFormula(l,u,i,n);return a.compileFormula(As(lp),c);case"NamedValue":case"NamedRange":case"NamedTable":var d;o=void 0;if("NamedRange"===r.kind){var f=r.value;D("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",En(r.value.sheets.document,t.scope.document));var p=f.sheets,m=a.getDocument(p.document);if(!ge(m))return a.cb.onUnavailableObject(m.reason),he(ti([m.reason]));var h=m.value.getSheetName(p.index);if(!ge(h))return a.cb.onUnavailable(h.reason),h;var g=r.value.ranges[0];o=ar(Ht(Qt(zt(Ar(It.Abs,g.row),Ar(It.Abs,g.col)),zt(Ar(It.Abs,g.row+g.rows-1),Ar(It.Abs,g.col+g.cols-1))),Fr(h.value)),[],[],1),d=Be(p,lp)}else"NamedTable"===r.kind?(o=ar(Lr(Nr(t.name),wr(void 0)),[],[],1),d=Le(Pe(a.documentLoc),lp)):(o=ar(yr(r.value,!0),[],[],1),d=Le(Pe(a.documentLoc),lp));c=a.analyzer.checkFormula(ra(d),o);return ge(c)&&Xn(c.value)?a.compileFormula(As(lp),Se(c.value)):w("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ".concat(Co(a.config,o,Ie(t))));case"NamedFailure":return he(ti([{kind:zu.ClientFailure,reason:r.failureReason}]));default:return L("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=Jo(this),this.printer=Ro(this),this.analyzer=aa(this),this.formatter=as(this),this.compiler=Qs(this),this.evaluator=qs(this)}return e.prototype.clone=function(t,r){var n;void 0===t&&(t=fp),void 0===r&&(r=Lc.Server);var i=new e(this.config,t,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return i.documentLoc=this.documentLoc,i.document=null===(n=this.document)||void 0===n?void 0:n.clone(r),i.worksheetFuncOverrides=this.worksheetFuncOverrides,i.userDefinedFuncOverrides=this.userDefinedFuncOverrides,i.version=this.version,i},e.prototype.compareVersion=function(e){return this.version===e.version},e.prototype.reconfigure=function(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n,this.advanceVersion()},e.prototype.setConfig=function(e){this.config=e},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?he(ti([{kind:zu.DocumentLoc,document:Te(e,t)}])):Se(r)},e.prototype.getNameLoc=function(e,t,r){var n=this.getDocument(e.document);return n.kind===me.Failure?he(ti([n.reason])):n.value.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){var r=qe(e,t);return Se([r])}return he(Zn(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===me.Failure)return he(ti([t.reason]));if(!0!==t.value)return he(ti([{kind:zu.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===me.Failure?he(ti([r.reason])):r.value===lc.Unavailable?he(ti([{kind:zu.CellFormat}])):Se(r.value)},e.prototype.getCellStyle=function(e){var t=this.allEditedAvailable(e);if(!ge(t))return he(ti([t.reason]));if(!0!==t.value)return he(ti([{kind:zu.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedStyle(e);return ge(r)?r.value===uc.Unavailable?he(ti([{kind:zu.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):he(ti([r.reason]))},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getIformat(t);if(n.kind===me.Failure)return he(ti([n.reason]));var i=n.value.getValue();return i.kind===me.Failure?he(Va()):i},e.prototype.getIformats=function(e,t,r){var n=this.getDocument(e);if(n.kind===me.Failure)return he(ti([n.reason]));for(var i=n.value.getIformats(),o=[],a=t,s=P(i.length,r);a<s;a+=1){var l=i[a];void 0!==l&&o.push({iformat:a,formatString:l.formatString,builtIn:l.builtIn})}return Se(o)},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===me.Failure)return he(ti([n.reason]));var i=n.value.getValue();return i.kind===me.Failure?he(Va()):i},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getFormatString(t);return n.kind===me.Failure?he(ti([n.reason])):n},e.prototype.getNameFormula=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getNameFormula(e,t);if(n.kind===me.Failure)return n;if(void 0===n.value)return Se(void 0);var i=n.value.lazyData.getValue();if(ge(i))return i;var o=this.hasRecalcNameFailure(e);return ge(o)?o.value||this.setNameFailure(e,i.reason):this.cb.onUnavailable(o.reason),he(js(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===me.Failure)return he(ti([t.reason]));if(void 0===t.value)return Se(void 0);var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return Se(void 0);var o=Ge(e.sheet,n),a=this.readCompiledFmla(o,i.compiledFmla);return ge(a)?Se(Es(Ae(i.lexicalKind,o),a.value)):a},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===me.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.propagateEditTaint(e,r);if(i.kind===me.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValue(e,t,r,i.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===me.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.setRecalcValue(e,t);if(i.kind===me.Failure)return this.cb.onUnavailableObject(i.reason);var o=this.propagateEditTaint(e,r);if(o.kind===me.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onSetCellValues(e,t,r,o.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if(0!=(Vr(e).staticPrecs&(Uo.Time|Uo.Calc))){var r=!1,n=this.evalParams.volatileMode;switch(e){case Gr.RAND:case Gr.RANDBETWEEN:case Gr.RANDARRAY:case Gr.NOW:r=n===ff.GroundTruth;break;case Gr.TODAY:r=n===ff.GroundTruth||n===ff.Estimation;break;default:r=void 0===Gr[e]}if(!r)return he(ti([{kind:zu.VolatileFunction,name:gi(e)}]))}var i=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:qf(e);return null!=i?Se(i):he(Zn([gi(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?Se(this.userDefinedFuncOverrides[t]):he(Zn(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.getSheetRangeIds(e)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,Qu(e.range));if(n.kind===me.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.setClientValue(e,Pc);if(i.kind===me.Failure)return this.cb.onUnavailableObject(i.reason);var o=this.setRecalcValue(e,Xe);if(o.kind===me.Failure)return this.cb.onUnavailableObject(o.reason);var a=this.propagateEditTaint(e,r);if(a.kind===me.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onRangeFailure(e,t,r,a.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===me.Failure?he(ti([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getSheetName(t);return n.kind===me.Failure||void 0===n.value?n:Se(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===me.Failure||void 0===n.value?n:Se(n.value.index)},e.prototype.getContainingTable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.getContainingTable(e)},e.prototype.getNamedRanges=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.getNamedRanges(e)},e.prototype.getStructRefColumn=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===me.Failure?he(ti([r.reason])):r.value.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===me.Failure?he(ti([r.reason])):r.value.getStructRefSpecialRef(e,t)},e.prototype.getIntersectingTables=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.getIntersectingTables(e)},e.prototype.getNamedObject=function(e,t){var r,n=this.getDocument(e.scope.document);if(n.kind===me.Failure)return he(ti([n.reason]));var i=n.value.getNameFormula(e,t);return i.kind===me.Failure?i:Se(null===(r=i.value)||void 0===r?void 0:r.obj)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===me.Failure?Mc:n.value.getHiddenRows(e.index,t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===me.Failure)return he(ti([n.reason]));var i=n.value.tryGetHiddenRows(e.index,t,r);return i.kind===me.Failure?he(ti([i.reason])):i},e.prototype.getHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===me.Failure?Mc:n.value.getHiddenCols(e.index,t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===me.Failure)return he(ti([n.reason]));var i=n.value.tryGetHiddenCols(e.index,t,r);return i.kind===me.Failure?he(ti([i.reason])):i},e.prototype.getMergeCell=function(e){var t=this.allEditedAvailable(e);if(t.kind===me.Failure)return he(ti([t.reason]));if(!0!==t.value)return he(ti([{kind:zu.GridRange,unavailableCells:t.value,range:e}]));var r=this.getDocument(e.sheet.document);if(r.kind===me.Failure)return he(ti([r.reason]));var n=r.value.getMergeCell(e);return n.kind===me.Failure?he(ti([n.reason])):n},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===me.Failure)return he(ti([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===me.Failure?he(ti([r.reason])):r},e.prototype.getRandom=function(){return D("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===ff.GroundTruth),Se(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){return If(this.config,e,t,this.evalParams.volatileMode)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return Array.isArray(i)?i:i.kind===me.Paused?Us((function(){return r.withEvalParams(e,i.resume)})):Gs((function(){return r.withEvalParams(e,i.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return i.kind===me.Paused?Us((function(){return r.withEvalParamsEvalFormula(e,i.resume)})):i.kind===me.Breaked?Gs((function(){return r.withEvalParamsEvalFormula(e,i.resume)})):i}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r){var n=this;return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r},(function(){return n.evaluator.evalCells({},t)}))},e.prototype.evalFormula=function(e,t,r,n){var i=this,o={lexicalKind:Re.Other,originGridCell:Se(t.range),originSheet:Se(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},a={lexicalSource:{kind:Re.Other},originGridCell:Se(t.range),originSheet:Se(t.sheet),calcingArray:!1,reflectionGridCell:Se(t.range),reflectionSheet:Se(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:Se(!1),contextNames:void 0},s=function(e,n){if(n.kind===me.Paused)return Us((function(){return s(e,n.resume())}));if(n.kind===me.Breaked)return Gs((function(){return s(e,n.resume())}));if(!ge(n))return Se({value:n});var o=i.evalFormulaFormat(t,e,n.value,r);return Se({value:Se(n.value),formatted:o})};return this.withEvalParamsEvalFormula({computeKind:Yu.EvalFormula,computeCells:[t],volatileMode:n},(function(){var t=i.parser.parseFormula(o,e),r=i.checkFormula(o,t,e,cc.EvalFormula),n=i.compileFormula(o,r);return ge(n)?s(n.value,i.evaluator.evalFormula(a,n.value)):Se({value:n})}))},e.prototype.evalFormulaFormat=function(e,t,r,n){var i;if(void 0!==n){if("number"==typeof n)return this.formatValueIformat(e.sheet.document,n,r);if(n.kind===lc.Known)return this.formatValueKnownFormat(e.sheet.document,n.knownFormat,r);var o=r;if(this.renderBlanksAsZerosEnabled&&Tn(r)&&(n.kind===lc.Origin||n.kind===lc.Inferred)&&null!==(i=n.renderBlanksAsZeros)&&void 0!==i&&i&&(o=this.config.mathpack.zero),n.kind===lc.Origin||n.kind===lc.Aggregate){var a=this.allEditedAvailable(e);return ge(a)?!0!==a.value?he(ti([{kind:zu.GridRange,unavailableCells:a.value,range:e}])):n.kind===lc.Origin?this.formatValueCell(e,o):this.formatValueAggregate(e,o):void this.cb.onUnavailableObject(a.reason)}if(n.kind===lc.Inferred){var s={lexicalSource:{kind:Re.Other},originGridCell:Se(e.range),originSheet:Se(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},l=this.formatter.evalFormat(s,t);return ge(l)?void 0===l.value?this.formatValueKnownFormat(e.sheet.document,$a.General,o):"number"==typeof l.value?this.formatValueIformat(e.sheet.document,l.value,o):this.formatter.applyFormat(l.value,o,!0):l}return L("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",n)}},e.prototype.evalValue=function(e,t,r){var n,i=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{var o=this.getEditedFormula(e);if(!ge(o))return this.cb.onUnavailableObject(o.reason);if(void 0!==(null===(n=o.value)||void 0===n?void 0:n[1].compiledFmla))return;var a=this.hasRecalcDirty(e);if(!ge(a))return this.cb.onUnavailableObject(a.reason);if(a.value)return;var s=this.tryGetCellValue(e.range,e.sheet);if(void 0===s)return;D("calc.calc.PartialWorkbookDocumentCollection.evalValue",s.kind===ms.FinalValue),this.cb.onReturnCellValue(e,s.oper,Ju.EditedCell)}finally{this.evalParams=i}},e.prototype.advanceVersion=function(){return this.version++,this.version},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e,this.advanceVersion()},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e,this.advanceVersion()},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===me.Failure?r:(this.document=r.value.setSheetNames(t),Se(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e,this.advanceVersion())},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e,this.advanceVersion())},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,o=this.getDocument(i);return o.kind===me.Failure?o:o.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,o=this.getDocument(i);return o.kind===me.Failure?o:o.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,i=e.document,o=this.getDocument(i);return o.kind===me.Failure?o:o.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():wc},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():Gf},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e,this.advanceVersion())},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getEditedFormula(e)},e.prototype.forEachEditedFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.forEachEditedFormula(e,t)},e.prototype.getEditedValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getEditedValue(e)},e.prototype.forEachEditedValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.forEachEditedValue(e,t)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getEditedFormat(e)},e.prototype.forEachEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.forEachEditedFormat(e,t)},e.prototype.getEditedStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getEditedStyle(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getServerFormat(e)},e.prototype.getServerStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getServerStyle(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValues=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getRecalcValues(e)},e.prototype.forEachRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.forEachRecalcValue(e,t)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===me.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===me.Failure||void 0===r.value?r:Se(Ge(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){C(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,i=this.getDocument(r.document);return i.kind===me.Failure?i:i.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===me.Failure?r:r.value.extendServerUnused(e.index,t,this.advanceVersion())},e.prototype.setCellContents=function(e,t,r,n,i,o,a,s,l,u){var c=this.getDocument(t.sheet.document);if(c.kind===me.Failure)return c;var d=void 0===r?void 0:n?this.compileFmla(e,Re.Cell,Be(t.sheet,i),void 0,r):""===r?Cc:{fmla:r,lexicalKind:Re.Cell,origin:i,compiledFmla:void 0,hasHyperlink:vc.ClientValueUnknown};return c.value.setCellContents(e,t,d,o,a,s,l,u,this.advanceVersion())},e.prototype.setRangeFormula=function(e,t,r,n,i,o,a,s){var l=this.getDocument(t.sheet.document);if(l.kind===me.Failure)return l;var u=""===r?Rc:this.compileFmla(e,Re.Range,Be(t.sheet,n),pn(t.range),r);return l.value.setRangeFormula(e,t,u,i,o,a,s,this.advanceVersion())},e.prototype.copyRange=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.copyRange(e)},e.prototype.pasteRange=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.pasteRange(e,t,this.advanceVersion())},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);return n.kind===me.Failure?he(ti([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===me.Failure?he(ti([r.reason])):r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,i=this.ensureDocument(e);if(i.kind===me.Failure)return he(ti([i.reason]));var o=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,i=e.builtIn,a=n.compileNumberFormat(r,i);o[t]={formatString:r,builtIn:i,compiledFormat:a}})),Se(i.value.setNumberFormats(o,r))},e.prototype.setStyles=function(e,t,r){var n=this.ensureDocument(e);return n.kind===me.Failure?n:Se(n.value.setStyles(t,r))},e.prototype.setFonts=function(e,t,r){var n=this.ensureDocument(e);return n.kind===me.Failure?n:Se(n.value.setFonts(t,r))},e.prototype.setFills=function(e,t,r){var n=this.ensureDocument(e);return n.kind===me.Failure?n:Se(n.value.setFills(t,r))},e.prototype.setBorders=function(e,t,r){var n=this.ensureDocument(e);return n.kind===me.Failure?n:Se(n.value.setBorders(t,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===me.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===me.Failure?n:n.value.setHiddenCols(e.index,t,r)},e.prototype.writeMergeCell=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.setMergeCell(e)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===me.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return Se(t);var r=this.getDocument(e);if(!ge(r))return he(ti([r.reason]));var n=r.value.getIformat(t);return ge(n)?n.value.getValue():he(ti([n.reason]))},e.prototype.resolveCellStyle=function(e,t){var r=this.getDocument(e);if(!ge(r))return he(ti([r.reason]));var n=r.value.resolveCellStyle(t);return ge(n)?Se(n.value):he(ti([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!ge(n))return n;var i=this.getFormatString(e,n.value.formatString);return ge(i)?Se(null!==(r=i.value)&&void 0!==r?r:n.value):i},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return ge(r)?void 0!==r.value?Se(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveObjectFormat=function(e,t){var r=this.getFormatString(e,t.formatString);return ge(r)?void 0!==r.value?Se(r.value):Se(t):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?Se(t):this.resolveStringFormat(e,t)},e.prototype.resolveRibbonFormat=function(e,t,r){var n;switch(t){case ns.GalleryShortDate:case ns.GalleryLongDate:var i=this.getCellFormat(r);if(!ge(i))return i;var o=this.resolveCellFormat(r.sheet.document,i.value);if(!ge(o))return o;n=o.value}var a=is(this.config.localeInfo,t,n);return this.resolveStringFormat(e,a)},e.prototype.resolveChangeDecimals=function(e,t,r){var n=this.getCellFormat(r);if(!ge(n))return n;var i=this.resolveCellFormat(r.sheet.document,n.value);if(!ge(i))return i;var o=this.formatter.changeFormatDecimals(i.value,t);return ge(o)?void 0===o.value?ye:this.resolveObjectFormat(e,o.value):o},e.prototype.parseInferredEdit=function(e,t,r){var n=this.getCellFormat(e);if(!ge(n))return n;var i=this.resolveCellFormat(e.sheet.document,n.value);if(!ge(i))return i;var o=this.evalParams;this.evalParams={computeKind:Yu.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,i.value)}finally{this.evalParams=o}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!ge(t))return Se(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return Se(void this.cb.onUnavailableObject({kind:zu.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!ge(r))return r;var n=Ae(t.value[1].lexicalKind,Ge(e.sheet,t.value[0])),i=r.value;return this.formatter.evalFormat(Ea(n),i)},e.prototype.fillInferredFormat=function(e,t){var r=this,n=t,i=t===lc.Unavailable?Se(lc.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!ge(i)){var o=i.reason;rc(e.set,(function(t){var n=Ge(e.sheet,t);return r.cb.onInferFormatFailure(n,o),!0})),i=Se(lc.Unavailable),n=lc.Unavailable}var a=i.value;nc(e.set,(function(t){var i=Be(e.sheet,t),o=r.getEditedFormat(i);if(!ge(o))return r.cb.onUnavailableObject(o.reason),!0;if(o.value===lc.Unavailable)return!0;var s=r.resolveCellFormat(e.sheet.document,o.value);if(!ge(s))return r.cb.onInferFormatFailure(i,s.reason),!0;if(os(a===lc.Unavailable?void 0:a,s.value)){var l=r.setEditedFormat(i,n);ge(l)||r.cb.onUnavailableObject(l.reason)}return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,i,o=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==o&&ge(o)?[Co(this.config,o.value,e),(n=o.value,i=new up,co(i,n),i.fns)]:[zf(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,i){var o=this;return{fmla:i,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new Ef((function(){var a=o.parser.parseFormula(Yo(t,r.range),i),s=e?a:o.autocorrectFormula(ta(t,r),a),l=e&&o.isServerWorkbookLoad,u=o.checkFormula(ta(t,r,void 0,l),s,i,e?cc.ServerCellFormula:cc.EditCellFormula),c=o.adjustFormulaOrigin(u,r,n);return o.compileFormula(Os(t,r.range),c)})),hasHyperlink:vc.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return ge(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.checkFormula=function(e,t,r,n){if(!ge(t))return t;var i=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!ge(i))return i;if(!Xn(i.value[0])){var o="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+zf(r);return he(ws(o,n,oa(i.value[1])))}return Se(i.value[0])},e.prototype.autocorrectFormula=function(e,t){return ge(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){if(!ge(e)||void 0===r)return e;var n=qi(t);return Jf(this,n,r,e.value)},e.prototype.compileNumberFormat=function(e,t){var r=this;return new Ef((function(){var n=r.formatter.createFormat(e,t);return ge(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return S($a,(function(t){return e.compileNumberFormat(ts(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.printer.printFormula(No(e,Be(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return ge(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,H(r,"'")):n},e.prototype.formatValueCell=function(e,t){if(Tn(t))return Se(_a([],void 0,ca.Left,fa.All));var r=this.getEditedResolvedFormat(e);if(!ge(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueAggregate=function(e,t){if(!Dn(t))return Se(Da(Na,void 0));var r;if(Dn(t)&&0===this.config.mathpack.cond(t))r=this.getKnownFormat(e.sheet.document,$a.General);else{if(r=this.getEditedResolvedFormat(e),!ge(r))return r;var n=r.value.valueType;n===va.Text?r=this.getKnownFormat(e.sheet.document,$a.General):n===va.Time&&(r=this.getKnownFormat(e.sheet.document,$a.AbsHMMSS))}if(!ge(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return ge(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return ge(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return ge(t)?t.value===lc.Unavailable?he(ti([{kind:zu.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):he(ti([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&En(this.documentLoc,e)?Se(this.document):he({kind:zu.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new Qf(e,this.config.localeInfo.stringCompareCI,new Xf(this.compileKnownFormats()),new sp)),this.getDocument(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=Ge(t,e),i=e.row,o=e.col,a=e.rows,s=e.cols,l=this.getRecalcValues(n);if(l.kind!==me.Failure){for(var u=!1,c=0;c<a;c+=1)for(var d=l.value[c],f=0;f<s;f+=1){var p=d[f].failure;void 0!==p&&(this.setCellFailure(Be(t,Ee(i+c,o+f)),p,dp),u=!0)}if(!u){var m=function(e){return Ms(e.oper)},h=l.value.map((function(e){return e.map(m)})),g=this.forEachRecalcDirty(n,(function(e){var n=Be(t,e),a=r.getEditedFormula(n);if(a.kind===me.Failure)return r.cb.onUnavailableObject(a.reason),!1;if(void 0===a.value)return r.setCellFailure(n,ti([{kind:zu.CellMissingFormula}]),dp),u=!0,!0;var s=a.value,l=s[0],c=s[1];if(void 0===c.compiledFmla)return r.cb.onUnavailableObject({kind:zu.CellEvaluatingValue}),!1;var d=r.readCompiledFmla(Ge(t,l),c.compiledFmla);return ge(d)?(h[e.row-i][e.col-o]=Ks(Be(t,pn(l))),!0):(u=!0,!0)}));if(ge(g)){if(g.value&&!u)return h}else this.cb.onUnavailableObject(g.reason)}}else this.cb.onUnavailableObject(l.reason)},e.prototype.tryGetCellValue=function(e,t){var r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===me.Failure)return he(ti([n.reason]));if(!0!==n.value)return he(ti([{kind:zu.GridRange,range:r,unavailableCells:n.value}]));var i=t.hasRecalcFailure(r);if(i.kind===me.Failure)return he(ti([i.reason]));if(i.value)return he(Vs(r));if(Cn(r.range)>t.maxDereferenceCells)return he(ti([{kind:zu.GridRangeSize,range:r}]));var o=e(r.range,r.sheet);return void 0===o?he(Vs(r)):Se(o)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(ge(r))return r;if(this.setCellFailure(e,r.reason,dp),r.reason.kind===vs.Unavailable){r.reason;return r}return he(ti([{kind:zu.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===me.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===me.Failure||void 0===r.value?r:Se(Ge(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.allEditedAvailable(e)},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.forEachRecalcDirty(e,t)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===me.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.setClientFormat(e,t,this.advanceVersion())},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===me.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===me.Failure)return r;var n=Ec(r.value.oper)||!Bn(this.config.mathpack,r.value.oper,t,!0);if(n){var i=this.setClientValue(e,t);if(i.kind===me.Failure)return i}return Se(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===me.Failure)return r;var n=t!==r.value;if(n){var i=this.setClientFormat(e,t);if(i.kind===me.Failure)return i}return Se(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,i=this.getClientFormula(ei(e));if(i.kind===me.Failure)return i;var o=null!==(n=i.value)&&void 0!==n?n:[e.range,Tc],a=o[0],s=o[1],l=pn(e.range),u=void 0!==t&&t!==s.fmla||void 0!==s.compiledFmla&&!An(l,s.origin),c=void 0!==r&&r!==s.hasHyperlink;if(u||c){var d=s.compiledFmla,f=this.setClientFormula(Ge(e.sheet,a),{fmla:null!=t?t:s.fmla,compiledFmla:d,origin:void 0!==t?l:s.origin,hasHyperlink:null!=r?r:s.hasHyperlink});if(f.kind===me.Failure)return f}return Se({hasFmlaChanged:u,hasHyperlinkChanged:c})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===me.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===me.Failure)return r;if(r.value)return Se(Ju.EditedCell);for(var n=0,i=t.cells;n<i.length;n++){var o,a=i[n],s=this.hasRecalcEditTaint(a);if(s.kind===me.Failure)return s;if(s.value)return(o=this.setRecalcEditTaint(e.sheet,Qu(e.range))).kind===me.Failure?o:Se(Ju.DependentCell)}return 0!=(t.special&(Uo.Calc|Uo.Time))?(o=this.setRecalcEditTaint(e.sheet,Qu(e.range))).kind===me.Failure?o:Se(Ju.DependentCell):t.bound===Ye.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===Yu.EditedCell?Se(Ju.IndependentCell):Se(Ju.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.setClientValue(e,t,this.advanceVersion())},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===me.Failure?r:r.value.setClientFormula(e,t,this.advanceVersion())},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===me.Failure?he(ti([t.reason])):t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===me.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e}(),mp=(c.stopwatch.initStopwatch,c.stopwatch.ulsStopwatchFactory);!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(cp||(cp={}));var hp=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var n,i=null!==(n=this.taskDeqs[e])&&void 0!==n?n:this.taskDeqs[e]=new Q;t===cp.Back?i.pushBack(r):i.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}(),gp=(ps.machine.ArrayMachine,ps.machine.MachineCallKind,ps.machine.ThenMachine,ps.machine.isMachineCall,ps.machine.machineCall,ps.machine.nextOnSuccessReceiver,ps.machine.callMachineTransition,ps.machine.nextTransition,ps.machine.breakTransition,ps.machine.MachineRuntime),vp=(ps.machine.readOperType,ps.machine.refToVal,ps.machine.singleReadOperType,c.machine.AllMachine,c.machine.MachineCycle,c.machine.MachineRuntime,c.machine.TransitionKind);c.machine.callMachineTransition,c.machine.nextOnSuccessReceiver,c.machine.nextTransition,c.machine.breakTransition;function Sp(e,t){var r=O("en-US"),n=function(e,t,r){var n=Si().slice();return Qc(t,gd,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),fi(e,n)}(r,e.worksheetFunctionNames,t),i=n.getWorksheetFuncId,o=n.getWorksheetFuncName,a=function(e){if(N(e))return function(e){return e>0&&e%3==0};if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,i=0;i<e.length&&!((n-=e[i])<=0);i+=1);return n>0&&r?n%e[e.length-2]==0:0===n}}(e.thousandsData),s=function(e,t){var r=pi.slice();return Qc(e,vd,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),l=e.lcid,u=l===ni.Thailand,c=l===ni.Korea,d=l===ni.Japan,f=l===ni.ChinaT||l===ni.HongKong,p=l===ni.China,m=c||d||p||f,h=l===ni.Hindi||l===ni.Tamil,g=l===ni.Thailand||l===ni.Vietnam||h,v=(l&ni.LANG)==(ni.Hebrew&ni.LANG)||(l&ni.LANG)==(ni.Arabic&ni.LANG)||l===ni.Syriac||g,S=";"===e.listSeparator||";"===e.decimalSeparator?";;":";",y=pe("Microsoft.Office.Excel.ChangeGate.RCBracketFix");return Object(gu.__assign)(Object(gu.__assign)({},e),{leftBracket:y?"[":e.leftBracket,rightBracket:y?"]":e.rightBracket,rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:i,getWorksheetFuncName:o,isNumeral:Ni,getOrdinal:Ci,getNumberShape:yi,isThousandsPosition:a,isIdentStart:bi,isIdentContinue:Ri,stringCompareCI:r,errorNames:s,statementSeparator:S,isThai:u,isEastAsia:m,isKorea:c,isJapan:d,isChinaT:f,isChinaS:p,isComplexScript:v})}function yp(e){return Sp(e,{})}function Cp(e,t){return N(t)?{index:e,length:1}:{index:e,length:k(t-e)+1}}function Rp(e,t){var r=Cp(t.row,t.lastRow),n=r.index,i=r.length,o=Cp(t.column,t.lastColumn),a=o.index,s=o.length;return Ge(Ke(e,t.sheetId),ke(n,a,i,s))}function bp(e,t){var r=t.row,n=t.column;return Be(Ke(e,t.sheetId),Ee(r,n))}function Np(e,t){var r=t.sheetId,n=t.usedRange;return b(n)?Rp(e,Object(gu.__assign)({sheetId:r},n)):{sheet:Ke(e,r),range:void 0}}function Tp(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=_u({row:t}),i=_u({col:r}),o=Mu(n,i);return wu(Qu(e),o)}(e.range,t,r)}}function Pp(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function Ep(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function kp(e){return Gn(e)?ml(e.sheet.index,e.range.row,e.range.col):ml(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function Op(e){return{row:e.row,column:e.col}}function Ap(e,t,r,n){var i=ku;if(N(n))return i;for(var o=0;o<n.length;o+=1){var a=n[o];if(e<=a&&a<e+t){for(var s=1;o+s<n.length&&n[o+s]===a+s;)s+=1;o+=s-1,i=bu(i,r(T(a,a+s)))}}return i}function Ip(e,t){switch(typeof t){case"string":return Ct(t);case"boolean":return $e(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return Xe;case"Error":return et(t.type);default:return}}function _p(e,t){switch(t.kind){case xo.String:case xo.Boolean:return t.value;case xo.Number:return e.toNumber(t);case xo.Error:return ll(t.type);case xo.Blank:return sl;default:return}}function Fp(e,t,r,n){if(!N(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return Ff(Ct(n.value));case"boolean":return Ff($e(n.value));case"number":return Ff(e.fromNumber(n.value))}return"Error"===n.value.kind?Ff(et(n.value.type)):L("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return Lf(n.formulaBarText);case"NamedRange":var i=Rp(r,n.range);return Mf(vt(i.sheet,i.range));case"NamedTable":return wf(Rp(r,n.range),n.hasHeadersRow,n.hasTotalsRow,n.columns,t);case"NamedFailure":return xf(n.failureReason,N(n.objectKind)?void 0:n.objectKind);default:return L("calc.calc.namedObjectDataToNamedObject: kind",n)}}var Mp,Dp,wp,Lp,xp={localeInfo:vi(),mathpack:Oo,refStyle:Ft.A1,timezone:Do,date1904:!1,dateCompatibility:!0,datepack:wo},Bp=function(){function e(){this.document=Te(void 0,""),this.langConfig=xp}return e.prototype.getLangConfig=function(){return this.langConfig},e.prototype.setA1ReferenceStyle=function(e,t,r){this.langConfig=Object(gu.__assign)(Object(gu.__assign)({},this.langConfig),{refStyle:r?Ft.A1:Ft.R1C1}),e.setLangConfig(t,this.langConfig)},e.prototype.setLocaleInfo=function(e,t,r,n){Hc(r,Sf,n,"localeData")&&(this.langConfig=Object(gu.__assign)(Object(gu.__assign)({},this.langConfig),{localeInfo:Sp(r,n)}),e.setLangConfig(t,this.langConfig))},e.prototype.setWorkbookProps=function(e,t,r,n){var i,o,a;Hc(r,Rf,n,"workbookProps")&&(this.langConfig=Object(gu.__assign)(Object(gu.__assign)({},this.langConfig),{date1904:null!==(i=r.date1904)&&void 0!==i?i:xp.date1904,dateCompatibility:null!==(o=r.dateCompatibility)&&void 0!==o?o:xp.dateCompatibility,timezone:null!==(a=r.timezone)&&void 0!==a?a:xp.timezone}),e.setLangConfig(t,this.langConfig))},e.prototype.updateSheetNames=function(e,t,r,n){e.setSheetNames(this.document,Qc(r,Cd,n,"sheetNames"),t)},e.prototype.updateNamedObjects=function(e,t,r,n){for(var i=0,o=Qc(r,Xd,n,"namedObjectsUpdates");i<o.length;i++){var a=o[i],s=a.scope,l=a.objects,u=a.fromStateId,c=we(this.document,b(s)?s:void 0);if(b(l))for(var d=0,f=Qc(l,Jd(s),n,"namedObjectsUpdates.<index>.objects");d<f.length;d++){var p=f[d],m=p.name,h=p.data;e.writeNamedObject(t,c,m,Fp(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,h))}else b(u)?e.promoteNamedObjects(t,c,u):e.writeUndefinedNames(t,c)}},e}();function Up(e,t){var r,n;switch(t.kind){case vs.NotImplemented:for(var i=0,o=t.features;i<o.length;i++){var a=o[i];Vc(e,"".concat(vs.NotImplemented," ").concat(a))}break;case vs.IllFormedFormula:Vc(e,"".concat(vs.IllFormedFormula," ").concat(null!==(r=t.mode)&&void 0!==r?r:""," ").concat(JSON.stringify({diagnostics:null!==(n=t.diagnostics)&&void 0!==n?n:{},message:t.mode===cc.ServerCellFormula||t.mode===cc.ServerNamedFormula?t.message:void 0})));break;case vs.Unavailable:for(var s=0,l=t.objects;s<l.length;s++){var u=l[s],c=[vs.Unavailable];if("string"==typeof u.kind&&u.kind in zu){var d=u;switch(c.push(d.kind),d.kind){case zu.SheetId:c.push(d.sheetId);break;case zu.NameLoc:c.push(d.source),c.push(void 0===d.name.scope.index?"global":"sheet");break;case zu.ClientFailure:c.push(d.reason);break;case zu.VolatileFunction:c.push(d.name);break;case zu.TimeGranularity:c.push(_o[d.granularity]);break;case zu.GetTimeKind:c.push(d.getTimeKind)}}else c.push(JSON.stringify(u));Vc(e,c.join(" "))}break;case vs.LimitExceeded:Vc(e,"".concat(t.kind," ").concat(gs[t.limit]));break;case ga.NotFormatString:case ga.NotValueString:Vc(e,"".concat(t.kind," ").concat(t.message));break;case vs.InvalidQualifier:case vs.InvalidCellRef:case vs.InvalidStructRef:Vc(e,"".concat(t.kind," ").concat(t.reason));break;case vs.Internal:Vc(e,"".concat(t.kind," ").concat(t.message));break;case vs.JavaScriptError:case Qo.NotFormulaString:case vs.CellCycle:case vs.NameCycle:case vs.Stopped:case vs.PreviousFailure:case vs.PreviousNameFailure:case ga.PreviousFormatFailure:Vc(e,t.kind);break;default:L("calc.calc.incrementFailure",t)}}function Gp(e,t){switch(t.kind){case xo.Number:return{kind:"n",magnitude:Yf(e.toNumber(t))};case xo.String:return{kind:"s"};case xo.Boolean:return{kind:"b"};case xo.Error:return{kind:"e",type:mi(t.type)};case xo.Rich:return{kind:"r"};case xo.Array:return{kind:"a"};case xo.Blank:return{kind:"z"};default:return L("calc.calc.precisionValue",t)}}function Kp(e,t){var r=e[t.sheet.index];return void 0!==r&&xu(r,Qu(t.range))}function Vp(e,t){var r,n=null!==(r=e[t.sheet.index])&&void 0!==r?r:ku;e[t.sheet.index]=Mu(n,Qu(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(wp||(wp={})),function(e){e.Success="Success",e.Timeout="Timeout"}(Lp||(Lp={}));var jp=((Mp={})[Ur.Add]=.05,Mp[Ur.Sub]=.069,Mp[Ur.Eq]=.097,Mp[Ur.Mul]=.1,Mp[Ur.Div]=.11,Mp[Ur.Concat]=.36,Mp[Ur.Gt]=.65,Mp[Ur.Ne]=.79,Mp[Ur.Lt]=.89,Mp[Ur.Le]=1.6,Mp[Ur.Ge]=1.9,Mp[Ur.Percent]=2.9,Mp[Ur.At]=6.2,Mp[Ur.Pow]=13,Mp[Ur.Range]=67,Mp),Wp=((Dp={})[Gr.IF]=.076,Dp[Gr.SUM]=.11,Dp[Gr.IFERROR]=.5,Dp[Gr.COUNTIF]=.77,Dp[Gr.AND]=.82,Dp[Gr.VLOOKUP]=1.5,Dp[Gr.AVERAGE]=1.5,Dp[Gr.HOUR]=1.9,Dp[Gr.MINUTE]=1.9,Dp[Gr.TEXT]=2,Dp[Gr.OR]=2,Dp[Gr.NOW]=2.1,Dp[Gr.ISBLANK]=2.3,Dp[Gr.CONCATENATE]=2.6,Dp[Gr.SUMIF]=2.7,Dp[Gr.COUNTIFS]=3.3,Dp[Gr.LEFT]=3.4,Dp[Gr.ISNUMBER]=3.7,Dp[Gr.MID]=3.9,Dp[Gr.COUNTA]=4,Dp[Gr.MONTH]=4.2,Dp[Gr.SECOND]=4.3,Dp[Gr.LEN]=4.9,Dp[Gr.WEEKNUM]=5,Dp[Gr.DAY]=5.2,Dp[Gr.ROUND]=5.4,Dp[Gr.FIND]=5.8,Dp[Gr.NETWORKDAYS]=6.2,Dp[Gr.COUNT]=6.2,Dp[Gr.YEAR]=6.3,Dp[Gr.INT]=6.4,Dp[Gr.RIGHT]=6.7,Dp[Gr.ABS]=7,Dp[Gr.CONCAT]=7.2,Dp[Gr.CHAR]=7.4,Dp[Gr.MAX]=8,Dp[Gr.ROW]=8.1,Dp[Gr.WEEKDAY]=9.1,Dp[Gr.DAYS]=9.2,Dp[Gr.MIN]=9.8,Dp[Gr.SEARCH]=9.8,Dp[Gr.WORKDAY]=11,Dp[Gr.DATEDIF]=12,Dp[Gr.TIME]=13,Dp[Gr.HYPERLINK]=13,Dp[Gr.IFS]=13,Dp[Gr.ISERROR]=13,Dp[Gr.COUNTBLANK]=14,Dp[Gr.TODAY]=14,Dp[Gr.VALUE]=18,Dp[Gr.ROUNDUP]=18,Dp[Gr.MATCH]=19,Dp[Gr.DATE]=20,Dp[Gr.SUBSTITUTE]=20,Dp[Gr.INDIRECT]=22,Dp[Gr.INDEX]=23,Dp[Gr.TRIM]=24,Dp[Gr.UPPER]=25,Dp[Gr.SUMIFS]=28,Dp[Gr.EXACT]=29,Dp[Gr.NOT]=32,Dp[Gr.PRODUCT]=35,Dp[Gr.ROUNDDOWN]=37,Dp[Gr.AVERAGEIF]=38,Dp[Gr.ISTEXT]=40,Dp[Gr.ISOWEEKNUM]=41,Dp[Gr.EOMONTH]=42,Dp[Gr.MROUND]=45,Dp[Gr.COLUMN]=45,Dp[Gr.ROWS]=46,Dp[Gr.TIMEVALUE]=52,Dp[Gr.TRUNC]=53,Dp[Gr.LOOKUP]=59,Dp[Gr.NA]=59,Dp[Gr.DAYS360]=61,Dp[Gr.RANK]=67,Dp[Gr.EDATE]=72,Dp[Gr.MOD]=82,Dp[Gr.OFFSET]=83,Dp[Gr.STDEV]=87,Dp[Gr.SUBTOTAL]=91,Dp),Hp=ao(Object(gu.__assign)(Object(gu.__assign)({},lo(.01)),{nameNode:function(){return 1},operatorNode:function(e){var t;return null!==(t=jp[e])&&void 0!==t?t:100},wsfNode:function(e){var t;return null!==(t=Wp[e])&&void 0!==t?t:100}}),E);var Qp=function(){function e(e){var t,r,n,i,o=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){var t=e.cell,r=e.p;return o.resumeToPledge((function(){return o.docs.evaluate(Yu.EditedCell,[t],ff.PrecisionTest)}),r)},this.testPrint=function(e){var t=e.cell,r=e.p;return q.try((function(){var e=o.getFormula(t);if(!ge(e))return o.onUnavailableObject(e.reason);var n,i=e.value,a=i[0],s=i[1];if(void 0===s.compiledFmla){var l=o.docs.getServerValue(t);if(!ge(l))return o.onUnavailableObject(l.reason);n=o.docs.renderValueBarText(t,l.value.oper,s.fmla)}else{var u=s.compiledFmla.getValue();n=ge(u)?o.docs.printFormulaBarText(a,s.origin,u.value):u}if(ge(n)){var c=zf(s.fmla),d=n.value===s.fmla?{expected:c,p:r}:{expected:c,sampled:zf(n.value),p:r};o.log.push({kind:wp.PrintFormulaStatistics,stats:{samples:[d],failures:[]}})}else o.log.push({kind:wp.PrintFormulaStatistics,stats:{samples:[],failures:[n.reason]}})}))},this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,samplePrecisionPrintValueRate:null!==(n=e.samplePrecisionPrintValueRate)&&void 0!==n?n:0,rngSeed:null!==(i=e.rngSeed)&&void 0!==i?i:0|F()},this.rng=new c.JSF32(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(Lp.Success)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(Lp.Timeout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new gp(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return q.all(Object(gu.__spreadArray)(Object(gu.__spreadArray)([],r.map(t.testEval),!0),n.map(t.testPrint),!0))})).catch((function(e){t.log.push({kind:wp.UnhandledFailure,reason:e})})))},e.prototype.step=function(){if(!this.result){var e=this.runtime.step();this.result=e.kind===vp.Break||e.kind===vp.Next?void 0:e}},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(i){var o=i.sheetIdx;return n.push(q.try((function(){e.docs.forEachServerNonBlankCellInSet(o,Eu,(function(n){var i=Be(o,n),a=e.config,s=a.samplePrecisionEvalRate,l=a.samplePrecisionPrintFormulaRate,u=a.samplePrecisionPrintValueRate;if(s>0){var c=e.getWeight(i);void 0!==(f=void 0===c?void 0:s>=1?1:P(1,s*c))&&e.rng.next()<f&&(Vp(e.sampledSets,i),t.push({cell:i,p:f}))}var d=E(l,u);if(d>0){var f,p=e.rng.next();if(p<d)p<(f=e.isValueCell(i)?u:l)&&r.push({cell:i,p:f})}return!0}))}))),!0})),q.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getWeight=function(e){var t=this.getFormula(e);if(!ge(t))return this.onUnavailableObject(t.reason);var r=t.value[1];return void 0!==r.compiledFmla?function(e){return ge(e)?co(Hp,e.value):1}(r.compiledFmla.getValue()):void 0},e.prototype.isValueCell=function(e){var t=this.getFormula(e);return ge(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)},e.prototype.resumeToPledge=function(e,t){var r=this;return q.try((function(){try{r.p=t;var n=e();return Array.isArray(n)?n:r.resumeToPledge(n.resume,t)}finally{r.p=void 0}}))},e.prototype.getFormula=function(e){var t,r=this.docs.getEditedFormula(e);if(!ge(r))return r;var n=null!==(t=r.value)&&void 0!==t?t:[e.range,Cc],i=n[0],o=n[1],a=Ae(o.lexicalKind,Ge(e.sheet,i));return Se([a,o])},e.prototype.onRangeFailure=function(e,t,r,n,i){var o={samples:[],failures:[t]};this.log.push({kind:wp.EvalStatistics,stats:o})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=ti([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.log.push({kind:wp.UnhandledFailure,reason:e})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return Kp(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,i){var o=this.getFormula(e);if(!ge(o))return this.onUnavailableObject(o.reason);var a=o.value,s=a[0],l=a[1],u=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,s,l,u)},e.prototype.onSetCellValues=function(e,t,r,n,i){var o=this,a=this.getFormula(ei(e));if(!ge(a))return this.onUnavailableObject(a.reason);var s=a.value,l=s[0],u=s[1],c=this.hasWrongPrecedent(r);an(e.range,(function(r,n,i){return o.logPrecisionResult(Be(e.sheet,r),t[n][i],l,u,c),!0}))},e.prototype.logPrecisionResult=function(e,t,r,n,i){var o=this.docs.allServerAvailable(e);if(!ge(o))return this.onUnavailableObject(o.reason);if(!0===o.value){var a=this.docs.getServerValue(e);if(!ge(a))return this.onUnavailableObject(a.reason);var s=Kp(this.sampledSets,e),l=this.precisionResult(t,a.value.oper,r,n,s,i);(function(e){return void 0===e.sampled})(l)||Vp(this.precisionWrongSets,e);var u={samples:[l],failures:[]};this.log.push({kind:wp.EvalStatistics,stats:u})}},e.prototype.precisionResult=function(e,t,r,n,i,o){var a=this.p,s=this.docs.config.mathpack,l=Gp(s,t),u=this.docs.anonymizeFormula(r,n),c=u[0],d=u[1];if(Bn(s,e,t,!0))return{expected:l,formula:c,functions:d,root:i,cascaded:o,p:a};var f=Gp(s,e);if(Dn(t)&&Dn(e)){var p=s.toNumber(t),m=s.toNumber(e);return{expected:l,sampled:f,relMagnitude:Yf(0===p?m:(m-p)/p),formula:c,functions:d,root:i,cascaded:o,p:a}}return{expected:l,sampled:f,formula:c,functions:d,root:i,cascaded:o,p:a}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==Lp.Success){for(var n={samples:[],failures:{}},i={samples:[],failures:{}},o={},a=0,s=this.log;a<s.length;a++){var l=s[a];switch(l.kind){case wp.EvalStatistics:(t=n.samples).push.apply(t,l.stats.samples);for(var u=0,c=l.stats.failures;u<c.length;u++){var d=c[u];Up(n.failures,d)}break;case wp.PrintFormulaStatistics:(r=i.samples).push.apply(r,l.stats.samples);for(var f=0,p=l.stats.failures;f<p.length;f++){d=p[f];Up(i.failures,d)}break;case wp.UnhandledFailure:Up(o,l.reason);break;default:L("calc.calc.PrecisionExperiment.createResultMessage",l)}}return["PrecisionExperiment",e,"stateId = ".concat(this.stateId),"evalStats = ".concat(JSON.stringify(n)),"printStats = ".concat(JSON.stringify(i)),"unhandledFailures = ".concat(JSON.stringify(o))].join(", ")}},e}(),qp=r(209);var zp,Yp=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{M.ULS.traceTag(578588694,ii.msoulscat_ES_EWAJS,ci.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,n,i,o=e.getServerDocument(),a=[],s=0,l=e.getServerAvailableCells();s<l.length;s++){var u=l[s],d="UndefinedSheet";if(void 0!==o){var f=e.getSheetName(o,u.sheetIdx.index);f.kind===me.Success&&(d=f.value)}var p=e.getServerUsedRange(u.sheetIdx);if(p.kind!==me.Failure&&void 0!==p.value){var m=p.value.sheet,h=Object(gu.__assign)({},p.value.range);h.cols=Math.min(h.cols,75),h.rows=Math.min(h.rows,1e3);for(var g=[],v=[],S=[],y=0,C=h.row,R=h.row+h.rows-1;C<=R;C+=1){for(var b=[],N=[],T=[],P=h.col,E=h.col+h.cols-1;P<=E;P+=1){var k=Be(m,Ee(C,P)),O=e.getServerValue(k),A=O.kind===me.Success?JSON.stringify(O.value):"";N.push(A);var I=e.getServerFormat(k),_=I.kind===me.Success?Object(c.fnv1a)(JSON.stringify(I.value)).toString():"";T.push(_);var F=e.getServerFormula(k),M=F.kind===me.Success?null===(r=null===(t=F.value)||void 0===t?void 0:t[1].compiledFmla)||void 0===r?void 0:r.getValue():void 0,D=(null==M?void 0:M.kind)===me.Success&&null!==(i=null===(n=F.value)||void 0===n?void 0:n[1].fmla)&&void 0!==i?i:"";""!==D&&(y+=1),b.push(D)}g.push(b),v.push(N),S.push(T)}if(0!==y){var w={sheetName:d,usedRangeAddress:Yr(e.config.localeInfo,h,Ft.A1,d),values:v,formulas:g,styles:S};a.push(w)}}}return{workbookName:"PartialWorkbook",worksheets:a}}(t);this.result=Object(qp.detect_errors)(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: ".concat(e)}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],i=e.rangeSizes,o=i.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:o,sizeOfEachSFRRange:i,redactedFormulaForEachSFR:e.formulas.map(zf),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),i=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:i,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: ".concat(JSON.stringify(this.report))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!1,configurable:!0}),e}();function Jp(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}!function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(zp||(zp={}));var Xp=function(e,t){return Jp(e.consts,t)};function $p(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),D(e,void 0===t.name||1===t.varCount),D(e,t.varCount===r)}function Zp(e,t,r){var n={varCount:e,vars:t,consts:r,name:void 0};return $p(zp.Root,n),n}function em(){}function tm(){return new em}var rm=tm();function nm(){return Zp(0,{},tm())}function im(e){return Zp(0,{},e)}function om(e){var t,r=Zp(1,((t={})[e]=1,t),rm);return r.name=e,r}var am=function(){return!1};function sm(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===rm||Xp(e,am))){var t=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==t&&(e.name=t,!0)}return!1}function lm(e,t){return r=function(e,r){return t.vars[e]===r},Jp(e.vars,r)&&Xp(e,(function(e,r){return t.consts[e]===r}));var r}function um(e,t){var r,n,i=nm(),o=e.vars,a=e.consts,s=t.vars,l=t.consts;for(var u in o){0!==(c=o[u]+(null!==(r=s[u])&&void 0!==r?r:0))&&(i.vars[u]=c,i.varCount+=1)}for(var u in a){var c;0!==(c=a[u]+(null!==(n=l[u])&&void 0!==n?n:0))&&(i.consts[u]=c)}for(var u in s)void 0===o[u]&&(i.vars[u]=s[u],i.varCount+=1);for(var u in l)void 0===a[u]&&(i.consts[u]=l[u]);return $p(zp.Root,i),i}function cm(e,t,r){var n=t.vars,i=t.consts,o=n[e];if(void 0===o)return t;var a=0,s=nm(),l=s.vars,u=s.consts;for(var c in n){var d=r.vars[c],f=void 0===d?0:d;0!==(p=(c===e?0:n[c])+f*o)&&(a+=1,l[c]=p)}for(var c in r.vars){void 0===n[c]&&(a+=1,l[c]=o*r.vars[c])}for(var c in i){var p,m=r.consts[c];0!==(p=i[c]+o*(void 0===m?0:m))&&(u[c]=p)}for(var c in r.consts){void 0===i[c]&&(u[c]=o*r.consts[c])}return Zp(a,l,u)}var dm=function(){},fm={kind:1,substitution:dm},pm=function(e){return{kind:1,substitution:e}},mm={kind:0},hm=function(e){return e<0?-e:e};function gm(e,t,r){var n={};return r===dm?t:t===dm?r:function(i){var o=n[i];if(void 0!==o)return o;var a=r(i);return n[i]=void 0===a?t(i):e(t,a)}}function vm(e,t){return function(r){return e===r?t:void 0}}var Sm=function(e,t,r){return function e(t,r,n){if(t>=100)return w(zp.UnifyBound);if(0===n.varCount)return Xp(n,am)?fm:mm;if(1===n.varCount){var i;for(var o in n.vars){i=o;break}D(zp.Root,void 0!==i);var a=n.vars[i],s={};for(var l in n.consts){if((h=n.consts[l])%a!=0)return mm;s[l]=-h/a}return pm(vm(i,im(s)))}var u,c=0,d=void 0,f=n.vars,p=n.consts,m=n.varCount;for(var l in f){var h=f[l],g=hm(h);(void 0===d||g<d)&&(c=h,d=g,u=l)}D(zp.Root,void 0!==u),D(zp.Root,0!==c);var v={},S={};for(var l in f)if(l===u)v[l]=1;else{h=f[l];v[l]=-Math.floor(h/c)}for(var l in p){h=p[l];S[l]=-Math.floor(h/c)}var y=Zp(m,v,S),C=e(t+1,r,cm(u,n,y));return 0===C.kind?C:pm(gm(r,C.substitution,vm(u,y)))}(0,e,function(e,t){var r,n,i=nm(),o=e.vars,a=e.consts,s=t.vars,l=t.consts;for(var u in o){0!==(c=o[u]-(null!==(r=s[u])&&void 0!==r?r:0))&&(i.vars[u]=c,i.varCount+=1)}for(var u in a){var c;0!==(c=a[u]-(null!==(n=l[u])&&void 0!==n?n:0))&&(i.consts[u]=c)}for(var u in s)void 0===o[u]&&(i.vars[u]=-s[u],i.varCount+=1);for(var u in l)void 0===a[u]&&(i.consts[u]=-l[u]);return $p(zp.Root,i),i}(t,r))};function ym(e,t){return void 0===t&&(t=void 0),{kind:0,flags:e,unit:t}}function Cm(e){return{kind:1,reference:e,resolution:void 0}}function Rm(e,t){return{kind:2,elementType:e,dimensions:t}}function bm(e){return{kind:3,flags:e}}function Nm(e){var t;switch(e.kind){case 1:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!On(r)||{rows:r.rows,columns:r.cols,exact:!0});case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function Tm(e,t){return function(e,t){if("object"==typeof e)return"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:Object(gu.__assign)(Object(gu.__assign)({},e),{exact:e.exact&&t});if("object"==typeof t)return Object(gu.__assign)(Object(gu.__assign)({},t),{exact:t.exact&&e});return e&&t}(Nm(e),Nm(t))}function Pm(e,t){return!0===t?e:Rm(e,t)}var Em,km=ym(xo.Boolean),Om=ym(xo.String),Am=ym(xo.Number),Im=im({}),_m=ym(xo.Number,Im),Fm=ym(xo.Error),Mm=ym(xo.Missing|xo.Blank),Dm=bm(Bo.None),wm=bm(Bo.All),Lm=ym(xo.Number|xo.Boolean|xo.String),xm=function(e){return ym(xo.Number|xo.Boolean|xo.String,e)};!function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(Em||(Em={}));var Bm,Um=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),i=this.find(t);if(n!==i){var o=this.roots,a=this.backlinks,s=this.ranks;if(r){var l=a[i];return a[i]=a[n],a[n]=l,o[i]=n,void(s[n]<=s[i]&&(s[n]=s[i]+1))}if(s[n]<s[i]){l=a[n];a[n]=a[i],a[i]=l,o[n]=i}else{l=a[i];a[i]=a[n],a[n]=l,o[i]=n,s[n]===s[i]&&(s[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}(),Gm={get UnitlessTimeAndDate(){return fe("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return fe("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}},Km={kind:0},Vm=function(e){return{kind:2,constraint:e}},jm=im({error:1}),Wm=im({}),Hm=im({currency:1}),Qm=im({date:1}),qm=im({time:1});function zm(e,t,r){var n,i=new Um,o=i.makePoint(jm),a=(n=jm,function(e,t){if(0===t.varCount||e===dm)return t;var r=t;for(var i in t.vars){var o=e(i);if(o===n)return n;void 0!==o&&(r=cm(i,r,o))}return r});return{symbolContext:e,typeContext:t,stats:r,uf:i,errorPoint:o,errorUnit:jm,apply:a}}function Ym(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function Jm(e,t,r,n){return D(zp.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),Km}function Xm(e,t,r,n,i){return t===e.errorUnit?(D(zp.Root,r===e.errorPoint),void 0!==i&&e.uf.union(e.errorPoint,i,!0),Km):n===e.errorUnit?(D(zp.Root,i===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),Km):0===t.varCount?0===n.varCount?lm(o=t,a=n)&&lm(a,o)?Km:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==i&&e.uf.union(e.errorPoint,i,!0),{kind:1,error:[t,n]}):(D(zp.Root,void 0!==i),Jm(e,i,t,r)):1===n.varCount?(D(zp.Root,void 0!==r),D(zp.Root,void 0!==i),e.uf.union(r,i),Km):(D(zp.Root,void 0!==r),Jm(e,r,n,i));var o,a}function $m(e,t,r){if(!sm(t))return Vm({kind:2,unit:t,target:r});var n=Ym(e,r),i=e.uf.findWithDescriptor(n),o=i[0],a=i[1];if(1===t.varCount){D(zp.Root,void 0!==t.name);var s=e.symbolContext.getTable().getValue(t.name);D(zp.Root,void 0!==s);var l=e.uf.findWithDescriptor(Ym(e,s)),u=l[0];return Xm(e,l[1],u,a,o)}return Xm(e,t,void 0,a,o)}function Zm(e,t){if(t===lc.Unavailable||0===t)return!1;var r=th(e,t);if(void 0===r)return!1;var n=null==r?void 0:r.valueType;return void 0!==n&&n!==va.General&&(n!==va.Currency&&n!==va.Accounting||void 0!==r.currencySymbol)}function eh(e,t,r,n){var i,o,a;n?r.referencedFormatCells+=1:r.allFormatCells+=1;var s=th(e,t),l=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,u=null==s?void 0:s.valueType;if(void 0!==u&&(l[u]=(null!==(i=l[u])&&void 0!==i?i:0)+1),u===va.Currency||u===va.Accounting){var c=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,d=null==s?void 0:s.currencySymbol,f=null===(o=null==s?void 0:s.culture)||void 0===o?void 0:o.culture,p=void 0===d?"none":d===ha.LocaleInfo?"defaultSymbol":d+"_"+f;c[p]=(null!==(a=c[p])&&void 0!==a?a:0)+1}}function th(e,t){if("number"==typeof t){var r=e.getIformat(t);return ge(r)?r.value:void 0}return t}function rh(e,t,r){var n=e.typeContext.types[t.index];if(void 0===n)return w(zp.Root);var i=n.getValue(r);if(void 0===i){var o=Be(t,r),a=e.typeContext.formats(o);if(ge(a)){if(!Zm(e.typeContext,a.value)||e.typeContext.isStringValue(o)){var s=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,xm(s)),s}var l=nh(e,a.value);return void 0===l?l=e.symbolContext.freshSymbol().unit:eh(e.typeContext,a.value,e.stats,!0),e.typeContext.types[t.index]=n.setValue(r,xm(l)),l}var u=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,xm(u)),u}return 0===i.kind?i.unit:void 0}function nh(e,t){var r=function(e,t){var r;return null===(r=th(e,t))||void 0===r?void 0:r.valueType}(e.typeContext,t);if(void 0!==r)switch(r){case va.Currency:case va.Accounting:return Hm;case va.Percentage:return Wm;case va.Date:return Gm.UnitlessTimeAndDate?Wm:Qm;case va.Time:return Gm.UnitlessTimeAndDate?Wm:qm;default:return}}var ih=((Bm={})[2]=function(e,t){return $m(e,t.unit,t.target)},Bm[3]=function(e,t){var r=nh(e,t.format);if(void 0===r)return Km;var n=rh(e,t.cell.sheet,t.cell.range);if(void 0===n)return Km;if(!sm(n))return Vm(t);if(1===n.varCount){D(zp.Root,void 0!==n.name);var i=e.symbolContext.getTable().getValue(n.name);D(zp.Root,void 0!==i);var o=e.uf.findWithDescriptor(Ym(e,i)),a=o[0];return Xm(e,o[1],a,r,void 0)}return Xm(e,n,void 0,r,void 0)},Bm[0]=function(e,t){var r=t.type.resolution;if(!Wn(r.sheet))return Km;if(On(r.range)){var n=rh(e,r.sheet,r.range);return void 0===n?Km:$m(e,n,t.target)}var i=e.typeContext.available[r.sheet.index];if(void 0===i)return Km;var o=i.usedRange;if(void 0===o)return Km;var a=gn(r.range,o);if(void 0===a)return Km;var s=Du(Du(Qu(a),$u),i.availableCells),l=[];return nc(s,(function(e){return l.push(e),!0})),{kind:3,constraint:{kind:1,cursor:0,index:i.sheetIdx,cells:l,target:t.target},output:void 0}},Bm[1]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return Km;var i=n[r],o=rh(e,t.index,i),a=void 0===o?Km:$m(e,o,t.target);return t.cursor+=1,{kind:3,constraint:t,output:a}},Bm);function oh(e){return e.kind===Em.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,i=n.apply,o=n.errorUnit,a={kind:Em.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=i(a.substitution,e);if(r!==o){var n=i(a.substitution,t);if(n!==o){var s=Sm(i,r,n);1!==s.kind?(a.stats.errorCount+=1,a.stats.enriched.errors.push({error:[i(a.substitution,e),i(a.substitution,t)]})):a.substitution=gm(i,s.substitution,a.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return a}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,i=e.deferred,o=t[n],a=ih[o.kind](r,o);switch(a.kind){case 2:i.push(a.constraint);break;case 1:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:a.error});break;case 3:if(t[n]=a.constraint,void 0!==a.output)switch(a.output.kind){case 2:i.push(a.output.constraint);break;case 1:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:a.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,i=e.unifyNF,o=t[n];switch(o.kind){case 2:i(o.unit,o.target.unit);break;case 3:var a=nh(r,o.format);if(void 0===a)break;var s=rh(r,o.cell.sheet,o.cell.range);if(void 0===s)break;i(a,s);break;default:return e.constraintCursor+=1,L(zp.Root,o)}return e.constraintCursor+=1,e}(e)}var ah=function(){function e(){this.isDone=!1,this.lastStepMessage="before started"}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!1,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=this;this.lastStepMessage="freshCheckingState";var r=[],n={};e.getServerAvailableCells().forEach((function(i){var o,a=e.getServerUsedRange(i.sheetIdx);if(a.kind!==me.Success)return t.isDone=!0,void(t.statsMessage="Unit experiment: getServerUsedRange failed");var s=Object(gu.__assign)(Object(gu.__assign)({},i),{usedRange:null===(o=a.value)||void 0===o?void 0:o.range});n[i.sheetIdx.index]=s,r.push(s)}));var i=void 0===e.getServerDocument()?function(){return he(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:Em.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:wi(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:n,getIformat:i,isStringValue:function(t){if(void 0===e.getServerDocument())return!1;var r=e.getServerValue(t);return r.kind===me.Success&&r.value.oper.kind===xo.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:r,mutableState:{symbolContext:sh.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return this.lastStepMessage="freshSolvingState",{kind:Em.SolvingSimple,stats:e.stats,context:zm(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,L("".concat(zp.Root,".").concat(zp.Initialised),this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case Em.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case Em.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=oh(e));case Em.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=oh(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage="".concat(zp.Root,".").concat(zp.Failure,": ").concat(j(e)),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e){this.lastStepMessage="initialiseSheetStep";var t=e.mutableState,r=e.sheets[t.sheetCursor],n=r.usedRange,i=[];void 0!==n&&rc(Du(r.availableCells,$u),(function(e){var t=gn(e,n);if(void 0!==t){if(Cn(t)<250)return i.push(t),!0;sn(t,15,(function(e){return i.push(e),!0}))}return!0}));return t.ranges=i,t.rangeCursor=0,e.documentTypeContext.types[r.sheetIdx.index]=hc(),e},e.prototype.initialiseRangeCells=function(e,t){this.lastStepMessage="initialiseRangeCells";var r=t.mutableState,n=t.stats,i=t.sheets,o=r.sheetCursor,a=[],s=i[o],l=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(s.sheetIdx,Qu(l),(function(r){var i,o=Be(s.sheetIdx,r),l=e.getServerFormula(o);l.kind===me.Success&&void 0!==(null===(i=l.value)||void 0===i?void 0:i[1].compiledFmla)&&(a.push(l.value[1]),n.formulaCells+=1);var u=e.getServerFormat(o);return u.kind===me.Success&&Zm(t.documentTypeContext,u.value)&&eh(t.documentTypeContext,u.value,n,!1),n.totalCells+=1,!0})),r.cells=a,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){this.lastStepMessage="checkCell";var r=t.sheets,n=t.constraints,i=t.stats,o=t.mutableState,a=o.cells,s=o.sheetCursor,l=o.cellCursor,u=r[s],c=a[l],d=c.compiledFmla.getValue();if(d.kind===me.Success){var f=Be(u.sheetIdx,c.origin),p=function(e,t,r){var n=e.constraints,i=e.locale,o=e.mathpack,a=e.resolver,s=e.documentTypeContext,l=s.types[t.sheet.index],u=e.mutableState.symbolContext.copy(),c={origin:t,locale:i,mathpack:o,resolver:a,symbolContext:u,pushConstraint:function(e){return void 0!==e&&(n.push(e),!0)}},d=function(e,t){return fo(new hh(e),t)}(c,r),f=dh(c,d),p=function e(t,r){switch(r.kind){case 0:if(void 0===r.unit){var n=t.symbolContext.freshSymbol();return ym(r.flags,n.unit)}return r;case 2:for(var i=r,o=[];2===i.kind;)o.push(i.dimensions),i=i.elementType;var a=e(t,i);return o.reduceRight(Rm,a);case 1:case 3:return r;default:return L(zp.Root,r)}}(c,void 0===f?wm:f);if(1===p.kind){var m=u.freshSymbol(),h={kind:0,type:p,target:m};p=xm(m.unit),n.push(h)}if(e.mutableState.symbolContext=u,2===p.kind)return l;return l.setValue(t.range,p)}(t,f,d.value);t.documentTypeContext.types[u.sheetIdx.index]=p;var m=e.getServerFormat(f);m.kind===me.Success&&Zm(t.documentTypeContext,m.value)&&(n.push({kind:3,cell:f,format:m.value}),eh(t.documentTypeContext,m.value,i,!0))}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);var r=t.mutableState;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)},e.prototype.statsForLogging=function(e){return JSON.stringify(e)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:"".concat(zp.Root,".").concat(zp.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var e,t,r,n,i,o=null===(e=this.state)||void 0===e?void 0:e.kind,a=(null===(t=this.state)||void 0===t?void 0:t.kind)===Em.Checking&&0===(null===(r=this.state)||void 0===r?void 0:r.mutableState.cellCursor);return"Units experiment timed out. Last step: ".concat(this.lastStepMessage,". Experiment state: ").concat(void 0!==o?Em[o]:"NotStarted",". isCellCursorZero: ").concat(a,". Number of constraints: ").concat(null===(n=this.state)||void 0===n?void 0:n.constraints.length,". Stats: ").concat(this.statsForLogging(null===(i=this.state)||void 0===i?void 0:i.stats))},enumerable:!1,configurable:!0}),e}(),sh=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,_f.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t="".concat(void 0===e?"gen":e,"@").concat(this.seed+=1),r={unit:om(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function lh(e,t,r){switch(e.kind){case 2:if(1===e.elementType.kind)return;return r?lh(e.elementType,t,!1):void 0;case 1:return{kind:0,type:e,target:t};case 0:return void 0===e.unit?void 0:{kind:2,unit:e.unit,target:t};case 3:return;default:return L(zp.Root,e)}}function uh(e,t,r){switch(t.kind){case 2:if(1===t.elementType.kind)return;return r?uh(e,t.elementType,!1):void 0;case 1:var n=e.symbolContext.freshSymbol(),i={kind:0,type:t,target:n};return[n.unit,i];case 0:return void 0===t.unit?void 0:[t.unit,void 0];case 3:return;default:return L(zp.Root,t)}}function ch(e){var t=e.length;if(0===t)return wm;for(var r,n,i=Dm,o=e[0].length,a=0;a<e.length;a+=1)for(var s=e[a],l=0;l<s.length;l+=1)r=i,n=s[l],i=r===Dm?n:n===Dm||r===wm?r:n===wm?n:0===r.kind&&0===n.kind&&void 0===r.unit&&void 0===n.unit?ym(r.flags|n.flags):wm;return Rm(i,{rows:t,columns:o,exact:!0})}function dh(e,t){if(1===t.kind&&void 0===t.resolution){var r=function(e,t){var r=qi(e.origin),n=e.resolver.resolveCellRef(r,t.reference).resolution;return!!ge(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?function(e,t){var r=Cm(e);return r.resolution=t,r}(t.reference,r):r?Fm:void 0}if(2===t.kind){var n=dh(e,t.elementType);return void 0===n?n:n===t.elementType?t:Rm(n,t.dimensions)}return t}function fh(e,t,r,n,i){var o=e.symbolContext.freshSymbol(),a=lh(t,o,n),s=lh(r,o,n);if(void 0!==a&&void 0!==s||i&&(void 0!==a||void 0!==s))return e.pushConstraint(a),e.pushConstraint(s),o}function ph(e,t,r){if(r.length<2)return wm;var n=dh(e,r[0][0]),i=dh(e,r[1][0]);if(void 0===n||void 0===i)return wm;var o=Tm(n,i);if(!1===o)return wm;var a="object"==typeof o;switch(t){case Ur.Add:case Ur.Sub:case Ur.Min:case Ur.Max:var s=fh(e,n,i,a,!0);return Pm(void 0===s?Am:ym(xo.Number,s.unit),o);case Ur.Eq:case Ur.Ne:case Ur.Lt:case Ur.Le:case Ur.Gt:case Ur.Ge:return fh(e,n,i,a,!1),Pm(km,o);case Ur.Mul:case Ur.Div:if(Gm.IgnoreDivMul)return Am;var l=e.symbolContext.freshSymbol(),u=e.symbolContext.freshSymbol(),c=lh(n,l,a),d=lh(i,u,a);if(e.pushConstraint(c),e.pushConstraint(d),void 0===c&&void 0===d)return Pm(Am,o);var f=t===Ur.Mul?um(l.unit,u.unit):um(l.unit,function(e){var t=nm(),r=e.vars,n=e.consts;for(var i in r)t.vars[i]=-r[i];for(var i in n)t.consts[i]=-n[i];return t.varCount=e.varCount,$p(zp.Root,t),t}(u.unit));return Pm(ym(xo.Number,f),o);case Ur.Pow:var p=r[1][1];if(Mn(p)){var m=e.mathpack.toNumber(p.oper);if(V(m)){var h=uh(e,n,"object"==typeof o);return void 0===h?Pm(Am,o):(e.pushConstraint(h[1]),Pm(ym(xo.Number,function(e,t,r){if(0===t)return r;var n=nm(),i=e.vars,o=e.consts;for(var a in i)n.vars[a]=i[a]*t;for(var a in o)n.consts[a]=o[a]*t;return n.varCount=e.varCount,$p(zp.Root,n),n}(h[0],m,Im)),o))}}return wm;case Ur.Range:case Ur.Isect:case Ur.Union:return wm;case Ur.Concat:return Pm(Om,o);case Ur.And:case Ur.Or:case Ur.Xor:return Pm(km,o);default:return L(zp.Root,t)}}function mh(e,t,r){switch(t){case Ur.Add:case Ur.Sub:case Ur.Mul:case Ur.Div:case Ur.Pow:case Ur.Eq:case Ur.Ne:case Ur.Lt:case Ur.Le:case Ur.Gt:case Ur.Ge:case Ur.Range:case Ur.Isect:case Ur.Union:case Ur.Concat:case Ur.And:case Ur.Or:case Ur.Xor:case Ur.Min:case Ur.Max:return ph(e,t,r);case Ur.Percent:case Ur.Neg:case Ur.Pos:case Ur.At:case Ur.Pound:return function(e,t,r){if(r.length<1)return wm;var n=dh(e,r[0][0]);if(void 0===n)return wm;var i=Nm(n);if(!1===i)return wm;switch(t){case Ur.Percent:return Pm(_m,i);case Ur.Neg:case Ur.Pos:var o=uh(e,n,"object"==typeof i);return void 0===o?Pm(Am,i):(e.pushConstraint(o[1]),Pm(ym(xo.Number,o[0]),i));case Ur.At:case Ur.Pound:return wm;default:return L(zp.Root,t)}}(e,t,r);default:return L(zp.Root,t)}}var hh=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return ho(t,e)},this.lazyVisitFormulaNode=function(e){return q.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){return q.resolve(function(e){switch(e.kind){case xo.Number:return Am;case xo.String:return Om;case xo.Boolean:return km;case xo.Error:return Fm;default:return Mm}}(e))},e.prototype.arrayNode=function(e){var t=this;return q.all(e.map((function(e){return q.all(e.map(t.lazyVisitFormulaNode))}))).bind(ch)},e.prototype.appNode=function(e,t){var r=this;return e.kind===At.Operator?q.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return mh(r.context,e.id,t)})):e.kind===At.WSF?q.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return function(e,t,r){switch(t){case Gr.SUM:case Gr.AVERAGE:case Gr.MAX:case Gr.MIN:if(0===r.length)return wm;var n=e.symbolContext.freshSymbol(),i=!0;return r.forEach((function(t){var r=dh(e,t);r&&e.pushConstraint(lh(r,n,!0))&&(i=!1)})),i?Am:ym(xo.Number,n.unit);case Gr.IF:if(r.length<2)return wm;var o=dh(e,r[0]),a=dh(e,r[1]),s=dh(e,void 0===r[2]?km:r[2]);if(void 0===o)return void 0!==a&&void 0!==s&&fh(e,a,s,!0,!1),wm;var l=Nm(o),u="object"==typeof l;if(void 0===a||void 0===s)return wm;var c=fh(e,a,s,!0,!0),d=c?xm(c.unit):Lm;return u?Rm(d,l):d;default:return wm}}(r.context,e.id,t)})):q.resolve(wm)},e.prototype.letNode=function(e,t,r,n){return q.resolve(wm)},e.prototype.lambdaNode=function(e,t,r,n){return q.resolve(wm)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return q.resolve(wm)},e.prototype.cellRefNode=function(e,t){return q.resolve(Cm(Ht(e,t)))},e.prototype.fieldRefNode=function(e,t){return q.resolve(wm)},e.prototype.structRefNode=function(e,t){return q.resolve(wm)},e.prototype.badSequenceNode=function(e,t){return q.resolve(wm)},e.prototype.badStringNode=function(e,t){return q.resolve(wm)},e.prototype.operatorNode=function(e,t){return q.resolve(Tr(e,t))},e.prototype.wsfNode=function(e,t,r){return q.resolve(Br(e,t,r))},e}();var gh,vh=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given ".concat(t);M.ULS.traceTag(591974878,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=F();F()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(gh||(gh={}));var Sh={TestExperiment:function(e){return{experimentName:"TestExperiment",kind:gh.OneShot,create:function(){return vh.create(e)}}},ExceLintExperiment:function(){return{experimentName:"ExceLintExperiment",kind:gh.OneShot,create:function(){return new Yp}}},UnitExperiment:function(){return{experimentName:"UnitExperiment",kind:gh.OneShot,create:function(){return new ah},stepBudget:80}}};function yh(e,t){Sh[e]=t}var Ch=c.resolvablePromise.ResolvablePromise,Rh=r(7),bh=(Rh.smartCompletionEwaFacadeModule.EditorMessageType,Rh.smartCompletionEwaFacadeModule.MessageType,Rh.smartCompletionEwaFacadeModule.PluginFactoryName),Nh=Rh.smartCompletionEwaFacadeModule.PluginGroup,Th=Rh.smartCompletionEwaFacadeModule.PluginAttachGroup,Ph=Rh.smartCompletionEwaFacadeModule.PluginSchedulerResultKind,Eh=Rh.smartCompletionEwaFacadeModule.HighlightKind,kh=Rh.smartCompletionEwaFacadeModule.ValuePreviewResultKind,Oh=Rh.smartCompletionEwaFacadeModule.PositionKind;d(),d();var Ah,Ih={snapshotCreation:function(e){return M.ULS.traceTag(512305240,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.snapshotCreation: snapshot created; isFreshSnapshot = ".concat(e))},beginRequest:function(e){return M.ULS.traceTag(553734792,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.beginRequest: ".concat(JSON.stringify(e)))},requestSkipped:function(e){var t=e.requestKind;return M.ULS.traceTag(553734793,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.requestSkipped: no plugins attached for kind ".concat(t))},registerPluginFactory:function(e){var t=e.factoryName,r=e.threadId;return M.ULS.traceTag(571246212,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.registerPluginFactory: registered ".concat(bh[t]," on ").concat(r))},pluginCompletedInTime:function(e){var t=e.pluginName,r=e.logInfo;return M.ULS.traceTag(553734790,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.pluginCompletedInTime: plugin completed in time. plugin name:".concat(t,". data:").concat(JSON.stringify(r)))},pluginStoppedExecution:function(e){var t=e.pluginName,r=e.stopReason,n=e.logInfo;return M.ULS.traceTag(509109120,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.pluginStoppedExecution: ".concat(JSON.stringify(Object(gu.__assign)({pluginName:t,stopReason:r},n))))},closeUIMessageFrame:function(e){return M.ULS.traceTag(553734789,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.closeUIMessageFrame: ".concat(JSON.stringify(e)))}},_h={snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},pluginStoppedExecution:{},closeUIMessageFrame:{}},Fh={snapshotCreation:function(e,t){return{numSnapshots:e.numSnapshots+1,numFreshSnapshots:e.numFreshSnapshots+(t?1:0)}},beginRequest:function(e,t){var r,n,i=t.requestKind;return Object(gu.__assign)(Object(gu.__assign)({},e),((r={})[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1,r))},requestSkipped:function(e,t){var r,n,i=t.requestKind;return Object(gu.__assign)(Object(gu.__assign)({},e),((r={})[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1,r))},registerPluginFactory:function(e,t){var r=e.factories,n=t.factoryName,i=t.threadId;return{factories:Object(gu.__spreadArray)(Object(gu.__spreadArray)([],r,!0),[bh[n]],!1),threadId:i}},pluginCompletedInTime:function(e,t){var r,n,i=t.pluginName;return Object(gu.__assign)(Object(gu.__assign)({},e),((r={})[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1,r))},pluginStoppedExecution:function(e,t){var r,n,i,o,a=t.pluginName,s=t.stopReason;return Object(gu.__assign)(Object(gu.__assign)({},e),((r={})[a]=Object(gu.__assign)(Object(gu.__assign)({},e[a]),((n={})[s]=(null!==(o=null===(i=e[a])||void 0===i?void 0:i[s])&&void 0!==o?o:0)+1,n)),r))},closeUIMessageFrame:function(e,t){var r,n,i,o;return Object(gu.__assign)(Object(gu.__assign)({},e),((r={})[t.pluginKind]=Object(gu.__assign)(Object(gu.__assign)({},e[t.pluginKind]),((n={})[t.stopReason]=(null!==(o=null===(i=e[t.pluginKind])||void 0===i?void 0:i[t.stopReason])&&void 0!==o?o:0)+1,n)),r))}},Mh=function(){function e(){}return e.prototype.log=function(e){Ih[e.kind](e.payload)},e.prototype.flush=function(){},e}(),Dh=function(){function e(){this.loggingStates=Object(gu.__assign)({},_h)}return e.prototype.log=function(e){this.loggingStates[e.kind]=Fh[e.kind](this.loggingStates[e.kind],e.payload)},e.prototype.flush=function(){M.ULS.traceTag(512274703,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.AgggregationLogger.flush: summary logs for session: ".concat(JSON.stringify(this.loggingStates)))},e}(),wh=function(){function e(){this.aggregatingLogger=new Dh,fe("Microsoft.Office.Excel.EnableFullSessionLogging")&&(this.immediateLogger=new Mh)}return e.prototype.log=function(e){var t;null===(t=this.immediateLogger)||void 0===t||t.log(e),this.aggregatingLogger.log(e)},e.prototype.flush=function(){var e;null===(e=this.immediateLogger)||void 0===e||e.flush(),this.aggregatingLogger.flush()},e}(),Lh=fe("Microsoft.Office.Excel.UseAggregatedLogging")?new wh:new Mh,xh=2*xe,Bh=ke(0,0,We,xe),Uh=ao(Object(gu.__assign)(Object(gu.__assign)({},lo(!1)),{wsfNode:function(e){return e===Gr.HYPERLINK}}),(function(e,t){return e||t}));!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(Ah||(Ah={}));var Gh,Kh=function(e,t){this.formatResults=t,this.cloneLazy=new Ef((function(){return e.createSnapshotSync()})),this.resultsPromise=new Ch,this.stateId=-1},Vh=function(e,t){this.formatResults=t,this.resultsPromise=new Ch,this.stateId=-1,this.cloneLazy=new Ef((function(){return e.clone(fp,Lc.Client)}))};!function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(Gh||(Gh={}));var jh=function(){function e(e,t){void 0===t&&(t={});var r,n,i=this;this.scheduler=new hp,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=function(e){var t=ei(e),r=i.getAvailableFormula(t);if(ge(r)){var n=r.value,o=n[0],a=n[1],s=a.compiledFmla.getValue(),l=ge(s)?i.docs.printFormulaBarText(o,t.range,s.value):s;return{formulaBarText:l.kind===me.Success?l.value:void i.outputMessageLog.push({kind:dc.PrintFormulaFailure,stateId:i.stateId,range:e,reason:l.reason}),hasHyperlink:i.formulaHasHyperlink(a),isFormula:!0}}i.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,o=i.docs.getEditedFormula(e);if(ge(o)){var a=null!==(n=null===(r=o.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",s=i.docs.renderValueBarText(e,t,a);return{formulaBarText:ge(s)?s.value:void i.outputMessageLog.push({kind:dc.PrintFormulaFailure,stateId:i.stateId,range:e,reason:s.reason}),hasHyperlink:!1,isFormula:!1}}i.onUnavailableObject(o.reason)},this.scheduleAvailableFormulas=function(e,t){var r=i.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=Be(e.sheet,r),o=i.docs.getEditedFormula(n);return o.kind===me.Failure?(i.onUnavailableObject(o.reason),!0):(void 0!==o.value&&void 0!==o.value[1].compiledFmla&&i.enqueueComputeCellValue(n,t),!0)}));ge(r)||i.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=i.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=Be(e.sheet,r),o=i.docs.getEditedFormula(n);return o.kind===me.Failure?(i.onUnavailableObject(o.reason),!0):(void 0!==o.value&&void 0!==o.value[1].compiledFmla||i.enqueueReturnCellValue(n,t),!0)}));ge(r)||i.onUnavailableObject(r.reason)},this.docs=new pp(e,this,t,t,null!==(r=t.maxDereferenceCells)&&void 0!==r?r:xh,null!==(n=t.isServerWorkbookLoad)&&void 0!==n&&n),this.reconfigure(t)}return e.prototype.reconfigure=function(e){var t,r;this.config=e,this.rng=new c.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:xh,null!==(r=e.isServerWorkbookLoad)&&void 0!==r&&r)},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==Yu.EvalFormula&&this.outputMessageLog.push({kind:dc.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,i){i.computeKind!==Yu.EvalFormula&&this.outputMessageLog.push({kind:dc.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:dc.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:dc.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=ti([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.outputMessageLog.push({kind:dc.UnhandledFailure,stateId:this.stateId,reason:e})},e.prototype.onSetCellValue=function(e,t,r,n,i){if(i.computeKind!==Yu.EvalFormula){var o=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==o?(this.outputMessageLog.push({kind:dc.RecalcStatistics,message:ac.ChangedCell,stateId:this.stateId,cellKind:n}),n!==Ju.EditedCell&&n!==Ju.DependentCell||this.outputMessageLog.push(Object(gu.__assign)(Object(gu.__assign)({kind:dc.CellWrite,stateId:this.stateId,cellKind:n,cell:e},o),{formatted:this.formatValue(n,e,t)}))):this.outputMessageLog.push({kind:dc.RecalcStatistics,message:ac.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,i){var o=this;if(i.computeKind!==Yu.EvalFormula){var a=this.outputRange(e,t,n);void 0!==a&&(n!==Ju.EditedCell&&n!==Ju.DependentCell||this.outputMessageLog.push(Object(gu.__assign)(Object(gu.__assign)({kind:dc.RangeWrite,stateId:this.stateId,cellKind:n,range:e},a),{formatted:t.map((function(t,r){return t.map((function(t,i){return o.formatValue(n,Be(e.sheet,Ee(e.range.row+r,e.range.col+i)),t)}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var n=this,i=this.outputCell(e,t,r,(function(){return n.printValueProperties(e,t)}));void 0!==i?(this.outputMessageLog.push({kind:dc.RecalcStatistics,message:ac.ChangedCell,stateId:this.stateId,cellKind:Ju.EditedCell}),r===Ju.EditedCell&&this.outputMessageLog.push(Object(gu.__assign)(Object(gu.__assign)({kind:dc.CellWrite,stateId:this.stateId,cellKind:Ju.EditedCell,cell:e},i),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:dc.RecalcStatistics,message:ac.UnchangedCell,stateId:this.stateId,cellKind:Ju.EditedCell})},e.prototype.createSnapshot=function(e,t){var r=this;return void 0===t&&(t=Lc.Client),new Promise((function(n){r.scheduler.addTask(Gh.CompleteDataQuery,cp.Back,{onRun:function(){var i=!1,o=r.docs.clone(fp,t);void 0!==r.latestSnapshot&&-1!==r.latestSnapshotID&&r.latestSnapshot.compareVersion(o)||(i=!0,r.latestSnapshot=o,r.latestSnapshotID=e),Lh.log({kind:"snapshotCreation",payload:i}),n({snapshot:r.latestSnapshot,correspondingId:r.latestSnapshotID})},onDeleted:function(){n(void 0)}})}))},e.prototype.createSnapshotSync=function(e){return void 0===e&&(e=Lc.Client),this.docs.clone(fp,e)},e.prototype.outputCell=function(e,t,r,n){var i;if(r===Ju.EditedCell||r===Ju.DependentCell){var o=this.docs.testAndSetClientValue(e,t);i=ge(o)?o.value?t:void 0:void this.onUnavailableObject(o.reason)}var a=this.outputFormat(e,r),s=this.outputFormulaProperties(e,r,n);return void 0!==i||void 0!==a||void 0!==s?{value:t,format:a,formulaBarText:null==s?void 0:s.formulaBarText,hasHyperlink:null==s?void 0:s.hasHyperlink}:void 0},e.prototype.outputRange=function(e,t,r){var n=this;if(r===Ju.EditedCell||r===Ju.DependentCell){var i=this.docs.setClientValue(e,t);ge(i)||this.onUnavailableObject(i.reason)}var o=t.map((function(t,i){return t.map((function(t,o){return n.outputFormat(Be(e.sheet,Ee(e.range.row+i,e.range.col+o)),r)}))})),a=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:o,formulaBarText:null==a?void 0:a.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===Ju.EditedCell){var r=this.docs.getEditedFormat(e);if(ge(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if(ge(n)){if(n.value){var i=r.value;if(i===lc.Unavailable)return{format:ti([{kind:zu.CellFormat}]),valueType:va.Custom,decimals:0};var o=this.docs.resolveCellFormat(e.sheet.document,i);return ge(o)?{format:"number"==typeof i?i:i.formatString,valueType:o.value.valueType,decimals:o.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===Ju.EditedCell){var n=r(e);if(void 0!==n){var i=n.formulaBarText,o=n.hasHyperlink,a=n.isFormula,s=this.docs.testAndSetClientFormula(e,i,o);if(ge(s)){var l=s.value,u=l.hasFmlaChanged,c=l.hasHyperlinkChanged;return u||c?{formulaBarText:u?i:void 0,hasHyperlink:c?o:void 0,isFormula:a}:void 0}this.onUnavailableObject(s.reason)}}},e.prototype.formatValue=function(e,t,r,n){var i=null!=n?n:this.docs,o=i.formatValueCell(t,r);if(ge(o))return o.value;i===this.docs&&this.outputMessageLog.push({kind:dc.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:o.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!ge(t))return t;if(void 0===t.value)return he({kind:zu.CellMissingFormula});var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return he({kind:zu.CellEvaluatingValue});var o=Ae(i.lexicalKind,Ge(e.sheet,n));return Se([o,i])},e.prototype.formulaHasHyperlink=function(e){if(e.lexicalKind!==Re.Cell)return!1;var t=null==e?void 0:e.compiledFmla.getValue();return ge(t)?co(Uh,t.value):void 0},e.prototype.handleSetCellContents=function(e,t,r,n,i,o,a,s,l,u,c){var d,f,p,m,h=void 0!==l?ti([{kind:zu.ClientFailure,reason:l}]):void 0,g=a;void 0!==n?(f=n,D("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==i),p=i):void 0===r?(D("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===i&&void 0!==a&&void 0===h),f=!1,p=void 0):(D("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===h&&g===lc.Weak),f=(d=this.parseInferredEdit(t,r,o,h,g,c)).isFormula,p=d.oper,h=d.cellFailure,g=d.cellFormat,m=d.inferredFormat);var v=void 0!==c?c.cloneLazy.getValue():this.docs,S=v.setCellContents(e,t,r,f,o,p,h,g,s,u);if(S.kind===me.Failure)return this.onUnavailableObject(S.reason);if(v.onCellModified(e),!e){var y=Be(t.sheet,o),C=void 0===r?Se(void 0):f?v.inferFormulaFormat(y):void 0!==m&&m!==$a.General?v.resolveValueFormat(t.sheet.document,m):Se(void 0);C.kind!==me.Success&&(this.onInferFormatFailure(y,C.reason),C=Se(lc.Unavailable)),void 0!==C.value&&v.fillInferredFormat(t,C.value),void 0!==c?(c.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,v,c)):this.enqueueBeforeCompute(u)}},e.prototype.parseInferredEdit=function(e,t,r,n,i,o){var a=o?o.cloneLazy.getValue().parseInferredEdit(Be(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit(Be(e.sheet,r),t,this.getVolatileMode());if(!ge(a))return{isFormula:!1,oper:Xe,cellFailure:a.reason,cellFormat:lc.Unavailable};var s=t.length>0?t.charAt(0):"";switch("="!==s&&"+"!==s&&"-"!==s||a.value.kind!==ma.Formula&&a.value.kind!==ma.Number||M.ULS.dnmTraceTag(541189698,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(a.value.kind)})),a.value.kind){case ma.Formula:return{isFormula:!0,oper:Xe,cellFailure:n,cellFormat:i};case ma.String:case ma.Other:return{isFormula:!1,oper:a.value.value,cellFailure:n,cellFormat:i};case ma.Number:return{isFormula:!1,oper:a.value.value,cellFailure:n,cellFormat:i,inferredFormat:a.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,i){var o=md(r);D("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||o);var a=e?void 0:Xe,s=e?void 0:lc.Weak,l=e?void 0:uc.Weak,u=this.docs.setRangeFormula(e,t,r,n,a,s,l,i);if(u.kind===me.Failure)return this.onUnavailableObject(u.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(i)},e.prototype.handleEditPaste=function(e,t,r,n){var i=Ge(t.sheet,ke(t.range.row,t.range.col,r.range.rows,r.range.cols)),o=this.docs.copyRange(r);if(o.kind===me.Failure)return this.onUnavailableObject(o.reason);var a=this.docs.pasteRange(i,o.value);if(a.kind===me.Failure)return this.onUnavailableObject(a.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)},e.prototype.evalFormula=function(e,t,r,n,i){var o=this;return new Promise((function(a){var s=function(){return a({value:he(Ws)})};o.scheduler.deleteTasks(Gh.EvalFormula,void 0),o.scheduler.addTask(Gh.EvalFormula,cp.Back,{onRun:function(){if(!i&&!o.trySetStateId(Gh.EvalFormula,e))return s();o.enqueueComputeEvalFormula(t,r,n,i,a)},onDeleted:s}),o.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(Gh.BeforeCompute,void 0),this.scheduler.addTask(Gh.BeforeCompute,cp.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,Yu.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,Yu.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,Yu.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=F();try{r=e()}finally{this.stateEvalTime+=E(1,F()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(Ah.EvalTimedOut),this.outputMessageLog.push({kind:dc.RecalcStatistics,stateId:this.stateId,message:ac.StateTimedOut}),r=[])}return r},e.prototype.enqueueEvalFormulaComputeCellValuesOnDocs=function(e,t,r){var n=this,i=[];nc(e.set,(function(t){return i.push(Be(e.sheet,t)),!0}));var o=function(){return t.evaluate(Yu.EvalFormula,i,n.getVolatileMode())},a={onRun:function(){var e=n.withEvalTiming(o);if(Array.isArray(e)){var s=e.map((function(e,o){if(e.kind===me.Failure){var a=void 0;if("objects"in e.reason){var s=e.reason.objects[0];"kind"in s&&(a=s.kind)}return he({kind:e.reason.kind,innerKind:a,cell:i[o].range})}if(!0===r.formatResults){var l=n.formatValue(Ju.EditedCell,i[o],e.value,t);return Se({cell:i[o].range,value:e.value,formatted:l})}return!1===r.formatResults?Se({cell:i[o].range,value:e.value,formatted:void 0}):Se(T(i[o].range,e.value))}));r.resultsPromise.resolve({stateId:r.stateId,results:s})}else o=e.resume,n.scheduler.addTask(Gh.ComputeEvalOnClone,cp.Front,a)},onDeleted:function(){return r.resultsPromise.resolve({stateId:r.stateId,results:K(new Array(i.length),he(Ws))})}};this.scheduler.addTask(Gh.ComputeEvalOnClone,cp.Front,a)},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,i=t===Yu.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?mp("calc.calc.PartialWorkbook: recalc edited"):void 0,o=!0,a=function(){return n.docs.evaluate(t,[e],n.getVolatileMode())},s=function(){if(o){o=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?mp("calc.calc.PartialWorkbook: cell eval"):void 0;var t=n.docs.getEditedFormula(e);if(!ge(t))return n.onUnavailableObject(t.reason);if(void 0===t.value)return}else n.outputMessageLog.push({kind:dc.RecalcStatistics,stateId:n.stateId,message:ac.ContinueComputation});var l=n.withEvalTiming(a);if(Array.isArray(l))return null==r||r.stop(),void(null==i||i.stop());a=l.resume,n.scheduler.addTask(Gh.ComputeCellValue,cp.Front,s)};this.scheduler.addTask(Gh.ComputeCellValue,cp.Back,s)},e.prototype.enqueueComputeEvalFormula=function(e,t,r,n,i){var o=this;void 0===n&&(n=this.docs);var a=this.getVolatileMode(),s=function(){return n.evalFormula(e,t,r,a)},l={onRun:function(){var e=s();e.kind===me.Paused||e.kind===me.Breaked?(s=e.resume,o.scheduler.addTask(Gh.ComputeEvalFormula,cp.Front,l)):i(e.value)},onDeleted:function(){return i({value:he(Ws)})}};this.scheduler.addTask(Gh.ComputeEvalFormula,cp.Back,l)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,n=this.getVolatileMode();this.scheduler.addTask(Gh.ComputeCellValue,cp.Back,(function(){r.docs.evalValue(e,t,n)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(Gh.AfterCompute,Ah.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?mp("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(Gh.AfterCompute,cp.Back,{onRun:function(){null==t||t.stop(Ah.EvalFinished),e.outputMessageLog.push({kind:dc.RecalcStatistics,message:ac.EditFinished,stateId:e.stateId})},onDeleted:function(e){null==t||t.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(Gh.RecalcFinished,void 0),this.scheduler.addTask(Gh.RecalcFinished,cp.Back,(function(){e.outputMessageLog.push({kind:dc.RecalcStatistics,message:ac.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var i=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(i.trySetStateId(Gh.ServerUpdate,e)){var o=i.docs.promoteServerAvailability(r,n);if(o.kind===me.Failure)return i.onUnavailableObject(o.reason);i.docs.onCellModified(!0),o.value||i.outputMessageLog.push({kind:dc.UpdateRequest,stateId:i.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,i,o,a,s,l,u){var c=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){(u||c.trySetStateId(Gh.ServerUpdate,e))&&c.handleSetCellContents(!0,t,r,n,o,i,a,s,l,void 0,u)}))},e.prototype.editCellContents=function(e,t,r,n,i,o,a,s){var l=this;void 0===o&&(o=Xe),void 0===a&&(a=Ge(t.sheet,Bh)),this.lastViewport=a,this.scheduler.addTask(Gh.ClientEdit,cp.Back,(function(){l.trySetStateId(Gh.ClientEdit,e)&&l.handleSetCellContents(!1,t,r,n,o,i,lc.Weak,uc.Weak,void 0,a,s)})),this.enqueueRecalcFinished()},e.prototype.editCellContentsOnClone=function(e,t,r,n,i){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,i)},e.prototype.editCellFormats=function(e,t,r,n,i){var o=this;void 0===i&&(i=Ge(t.sheet,Bh)),this.lastViewport=i,this.scheduler.addTask(Gh.ClientEdit,cp.Back,(function(){if(o.trySetStateId(Gh.ClientEdit,e)){var a="SetFormat"===r.kind?o.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?o.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,Be(t.sheet,n)):"ChangeDecimals"===r.kind?o.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,Be(t.sheet,n)):L("calc.calc.PartialWorkbook: editCellFormats",r);ge(a)||rc(t.set,(function(e){return o.onInferFormatFailure(Ge(t.sheet,e),a.reason),!0})),ge(a)&&void 0===a.value||o.handleSetCellContents(!1,t,void 0,void 0,void 0,Ee(0,0),ge(a)?a.value:lc.Unavailable,void 0,void 0,i)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,i){var o=this;void 0===n&&(n=pn(t.range)),void 0===i&&(i=!1),this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){o.trySetStateId(Gh.ServerUpdate,e)&&o.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,i){var o=this;void 0===n&&(n=pn(t.range)),void 0===i&&(i=Ge(t.sheet,Bh)),this.lastViewport=i,this.scheduler.addTask(Gh.ClientEdit,cp.Back,(function(){o.trySetStateId(Gh.ClientEdit,e)&&o.handleSetRangeFormula(!1,t,r,n,i)})),this.enqueueRecalcFinished()},e.prototype.editPaste=function(e,t,r,n,i){var o=this;void 0===i&&(i=Ge(r.sheet,Bh)),this.scheduler.addTask(Gh.ClientEdit,cp.Back,(function(){o.trySetStateId(Gh.ClientEdit,e)&&o.handleEditPaste(t,r,n,i)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(Gh.TestAdvanceState,cp.Back,(function(){t.trySetStateId(Gh.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(t,r){var n,i,o,a,s,l=this;if(r<this.stateId)return!1;if(t===Gh.ClientEdit&&(this.deleteComputeTasks(Ah.EditReceived),this.stateEvalTime=0),r>this.stateId){if(this.stateId!==-1/0){var u=this.config.sampleWorkbookStatisticsRate;void 0!==u&&this.shouldSample(u)&&this.outputMessageLog.push({kind:dc.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:u})}1===this.stateChanges&&this.enqueueRunExperiments(gh.OneShot),this.stateChanges>=1&&0===this.scheduler.getCount(Gh.RunExperiment)&&this.enqueueRunExperiments(gh.Recurring);var c=null!==(n=this.config.samplePrecisionEvalRate)&&void 0!==n?n:0,d=null!==(i=this.config.samplePrecisionPrintFormulaRate)&&void 0!==i?i:0,f=null!==(o=this.config.samplePrecisionPrintValueRate)&&void 0!==o?o:0;if(this.stateChanges>=1&&(c>0||d>0||f>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&0===this.scheduler.getCount(Gh.RunExperiment)){var p=this.config.experimentFactories,m=null!==(a=null==p?void 0:p.stepBudget)&&void 0!==a?a:10,h=null!==(s=null==p?void 0:p.totalBudget)&&void 0!==s?s:1e4,g=new Qp({samplePrecisionEvalRate:c,samplePrecisionPrintFormulaRate:d,samplePrecisionPrintValueRate:f}),v={stateId:this.stateId,documents:this.docs.clone(g),stepBudget:m,totalBudget:h,viewport:this.lastViewport};g.setContext(v),this.enqueueRunExperiment("PrecisionExperiment",m,h,gh.Precision,g,(function(){return l.numPrecisionFailures=0}),(function(){return l.numPrecisionFailures+=1}))}this.deleteComputeTasks(Ah.StateIdAdvanced),this.lastViewport=void 0;var S=this.stateId;this.stateId=r,this.docs.advanceState(S),this.outputMessageLog.push({kind:dc.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(Gh.BeforeCompute,void 0),this.scheduler.deleteTasks(Gh.ComputeCellValue,void 0),this.scheduler.deleteTasks(Gh.AfterCompute,e),e!==Ah.EvalTimedOut&&this.scheduler.deleteTasks(Gh.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r,n,i,o,a){var s=this,l=0,u=0,c=function(t,r,o,a){var l=i.failedLogMessage;void 0!==l&&s.outputMessageLog.push({experimentName:e,kind:dc.ExperimentRunResult,experimentKind:n,logMessage:l,timeoutReason:{budgetType:t,budget:r,elapsedTime:o,stepsCount:a}})},d=function(){if(i.done){var f=i.resultLogMessage;return void 0!==f&&s.outputMessageLog.push({experimentName:e,kind:dc.ExperimentRunResult,experimentKind:n,logMessage:f}),void o()}for(var p=F(),m=p,h=0;h<1e3&&m===p;h+=1){i.step(),u+=1;var g=F(),v=g-m;if(v>=t&&!i.done)return c("stepBudget",t,v,u),void a();m=g}if((l+=m>p?m-p:1)>=r&&!i.done)return c("totalBudget",r,l,u),void a();s.scheduler.addTask(Gh.RunExperiment,cp.Front,d)};this.scheduler.addTask(Gh.RunExperiment,cp.Back,d)},e.prototype.enqueueRunExperiments=function(e){var t;if(this.config.experimentFactories){var r=this.config.experimentFactories,n=r.stepBudget,i=r.totalBudget,o=r.factories.filter((function(t){var r,n;return t.kind===e&&(null!==(r=t.numFailures)&&void 0!==r?r:0)<(null!==(n=t.maxFailures)&&void 0!==n?n:3)}));if(0!==o.length)for(var a={stateId:this.stateId,documents:this.docs.clone(fp,e===gh.OneShot?Lc.Server:Lc.Client),stepBudget:n,totalBudget:i,viewport:this.lastViewport},s=function(r){var o=r.create();if(!o)return"continue";o.setContext(a),l.enqueueRunExperiment(r.experimentName,null!==(t=r.stepBudget)&&void 0!==t?t:n,i,e,o,(function(){return r.numFailures=0}),(function(){var e;return r.numFailures=(null!==(e=r.numFailures)&&void 0!==e?e:0)+1}))},l=this,u=0,c=o;u<c.length;u++){s(c[u])}}},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(n.trySetStateId(Gh.ServerUpdate,r)){var i=n.docs.setSheetNames(e,t);i.kind===me.Failure&&n.onUnavailableObject(i.reason),n.deleteComputeTasks(Ah.SetSheetNames)}}))},e.prototype.setLangConfig=function(e,t){var r=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(r.trySetStateId(Gh.ServerUpdate,e)){var n=r.docs.config.localeInfo!==t.localeInfo,i=r.docs.config.refStyle!==t.refStyle;r.docs.setConfig(t),n&&r.docs.clearCompiledNumberFormats(),(n||i)&&(r.docs.clearCompiledFormulas(),r.deleteComputeTasks(Ah.SetLangConfig))}}))},e.prototype.setNumberFormats=function(e,t,r,n){var i=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(i.trySetStateId(Gh.ServerUpdate,n)){var o=i.docs.setNumberFormats(e,t,r);return o.kind===me.Failure?i.onUnavailable(o.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,n){var i=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(i.trySetStateId(Gh.ServerUpdate,e)){var o=i.docs.setNamedObject(!0,De(t,r),n);return o.kind===me.Failure?i.onUnavailable(o.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(r.trySetStateId(Gh.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===me.Failure?r.onUnavailable(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(n.trySetStateId(Gh.ServerUpdate,e)){var i=n.docs.promoteNamedObjects(t,r);if(i.kind===me.Failure)return n.onUnavailable(i.reason);i.value||n.outputMessageLog.push({kind:dc.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(r.trySetStateId(Gh.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===me.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(r.trySetStateId(Gh.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===me.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeHiddenCols=function(e,t){var r=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(r.trySetStateId(Gh.ServerUpdate,e)){var n=r.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return n.kind===me.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(Gh.ServerUpdate,cp.Back,(function(){if(r.trySetStateId(Gh.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===me.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(Gh.MaybeCollectGarbage,void 0),this.scheduler.addTask(Gh.MaybeCollectGarbage,cp.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:dc.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var i=t.sheet,o=Qu(t.range),a=0,s=e;a<s.length;a++){var l=s[a];Hn(i,l.sheet)&&n(ic(i,Du(l.set,o)),r)}else for(var u=0,c=e;u<c.length;u++){n(l=c[u],r)}},e.prototype.getVolatileMode=function(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:ff.Estimation},e.maxPrecisionFailures=3,e}(),Wh=c.asyncLoopModule.asyncLoop,Hh=c.asyncLoopModule.asyncLoopFactory,Qh=c.asyncLoopModule.delayPromiseImpl,qh=c.promise.bindMaybeThenable,zh=(c.promise.collapseThenable,c.promise.isThenable),Yh=(c.promise.newPromise,c.promise.promiseFinally),Jh=c.promise.promiseLoop;var Xh=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i"),!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function $h(){return Xh.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function Zh(e){e().then((function(e){var t={main:$h(),worker:e},r="calc.calc.logMissingJSFeatures: missing = ".concat(JSON.stringify(t));M.ULS.traceTag(561534152,ii.msoulscat_ES_EWAJS,ci.Info,r)})).catch((function(e){var t="calc.calc.logMissingJSFeatures: threw ".concat(j(e));M.ULS.traceTag(561534153,ii.msoulscat_ES_EWAJS,ci.Info,t)}))}var eg=Rh.gridinterface.FormulaKind,tg=Rh.gridinterface.emptyRangeFormat,rg=Rh.gridinterface.emptyRangeFormula,ng=Rh.gridinterface.emptyRangeValue,ig=Rh.gridinterface.wrapIntoResumeRecalc;f(),f(),f(),f();var og,ag=function(){function e(e){this.calcGrid=e,this.snapshotPromises=[]}return e.prototype.createIGridExportEndpoint=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return[4,vu.Endpoint.createInside(e,(function(){return t}))];case 1:return r.sent(),[2]}}))}))},e.prototype.discardSnapshot=function(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)},e.prototype.evalClonedModelOnSnapshot=function(e,t,r){var n;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(i=(null!==(n=u.sent())&&void 0!==n?n:{snapshot:void 0}).snapshot)?[2,he(ti(["evalOnClonedModel"]))]:(c=t,d=i.config.mathpack,o=c.map((function(e){if(!b(e.data))return{data:void 0,range:kp(e.range)};var t=_p(d,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:null!=t?t:sl,iformat:e.data.iformat,failureReason:void 0===t?"unsupported Oper serialization":void 0},range:kp(e.range)}})),a=function(e,t){return e.map((function(e){var r=e.range,n=r[0],i=r.slice(1),o=Object(gu.__spreadArray)([kp(n)],i.map((function(e){return kp(e)})),!0);return{kind:e.kind,range:o,formulaBarText:e.formulaBarText,value:b(e.value)?_p(t,e.value):void 0,origin:b(e.origin)?Op(e.origin):void 0}}))}(r,i.config.mathpack),s=this.calcGrid.evalOnClonedModelOnSnapshot(o,a,i,void 0),this.calcGrid.resumeRecalc(),l=Se,[4,s]);case 2:return[2,l.apply(void 0,[u.sent()])]}var c,d}))}))},e.prototype.evalFormulaOnSnapshot=function(e,t,r,n){var i;return void 0===n&&(n={kind:lc.Origin}),Object(gu.__awaiter)(this,void 0,void 0,(function(){var o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=(null!==(i=u.sent())&&void 0!==i?i:{snapshot:void 0}).snapshot)?[2,he(ti(["evalFormula"]))]:(a=this.calcGrid.evalFormulaOnSnapshotImpl(t,r,n,o),this.calcGrid.resumeRecalc(),l=sg,[4,a]);case 2:return s=l.apply(void 0,[u.sent()]),[2,Se(s)]}}))}))},e.prototype.getSheetNames=function(e){var t;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(r=(null!==(t=u.sent())&&void 0!==t?t:{snapshot:void 0}).snapshot))return[2,he(ti(["getSheetNames"]))];if(n={document:this.calcGrid.document,sheets:new Array},i=r.getSheetRangeIndexes(Ne(this.calcGrid.document)),!ge(i))return[2,i];for(o=0,a=i.value.sheets;o<a.length;o++){if(s=a[o],l=r.getSheetName(this.calcGrid.document,s),!ge(l))return[2,l];n.sheets.push({sheetIndex:Ke(this.calcGrid.document,s),sheetName:l.value})}return[2,Se(n)]}}))}))},e.prototype.getCorrespondingSnapshotID=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(t=r.sent())?[2,-1]:[2,t.correspondingId]}}))}))},e.prototype.getOrCreateSnapshot=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(t){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(e),this.calcGrid.resumeRecalc().catch((function(e){setTimeout((function(){throw e}))}))),[2,this.snapshotPromises[e]]}))}))},e.prototype.getRangeFormats=function(e,t){return this.getRangeData(e,t,"formats")},e.prototype.getRangeValues=function(e,t){return this.getRangeData(e,t,"values")},e.prototype.getRangeFormulae=function(e,t){return this.getRangeData(e,t,"formulae")},e.prototype.getRangeData=function(e,t,r){var n;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,l,u,c;return Object(gu.__generator)(this,(function(d){switch(d.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(i=(null!==(n=d.sent())&&void 0!==n?n:{snapshot:void 0}).snapshot)?[2,he(ti(["getRangeData/getOrCreateSnapshot"]))]:(o=i.allEditedAvailable(t)).kind!==me.Success?[2,he(ti(["getRangeData/allEditedAvailable"]))]:(a=Qu(t.range),!0!==o.value&&(a=wu(a,o.value)),s=function(e){var r=[];return rc(a,(function(n){var i=e(Ge(t.sheet,n),(function(e){a=wu(a,Qu(e))}),(function(e,t){r.push([[e.row,e.col],t])}));return i.kind===me.Success&&i.value}))?Se(r):he(ti(["getRangeData/extractData"]))},l={formulae:function(){return s((function(e,t,r){return i.forEachEditedFormula(e,(function(e,n){var i=n.lexicalKind,o=n.compiledFmla,a=n.fmla,s=n.origin;return i!==Re.Range&&On(e)?Nc(a,void 0!==o)||r(e,{kind:void 0!==o?eg.CellFormula:eg.Value,formulaBarText:a,origin:An(s,e)?void 0:s}):t(e),!0}))}))},formats:function(){return s((function(e,t,r){return i.forEachEditedFormat(e,(function(e,n){return n===lc.Unavailable?t(e):yc(n)||r(e,"number"==typeof n?n:n.formatString),!0}))}))},values:function(){return s((function(e,t,r){return i.forEachRecalcValue(e,(function(e,n){return void 0!==n.failure?t(e):Oc(n.oper,n.failure)||r(e,n.oper),!0}))}))}}[r](),(u=l).kind!==me.Success?[2,u]:(c=[],rc(a,(function(e){return c.push(e),!0})),[2,Se({nonEmptyCells:u.value,availableRanges:c})]))}}))}))},e.prototype.getIntersectingTables=function(e,t){var r,n;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,l,u,c,d,f,p,m,h;return Object(gu.__generator)(this,(function(g){switch(g.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(i=(null!==(r=g.sent())&&void 0!==r?r:{snapshot:void 0}).snapshot))return[2,he(ti(["getIntersectingTables/getOrCreateSnapshot"]))];if((o=i.allServerAvailable(t)).kind!==me.Success)return[2,he(ti(["getIntersectingTables/allServerAvailable"]))];if(a=i.getIntersectingTables(t),!ge(a))return[2,he(ti(["getIntersectingTables/getIntersectingTables"]))];for(s=[],l=function(e){var t=i.getNamedObject(e,be.Plain);if(t.kind!==me.Success)return{value:t};if("NamedTable"!==(null===(n=t.value)||void 0===n?void 0:n.kind))return"continue";var r=[];t.value.columnIndexes.forEach((function(e,t){return r.push({column:e,name:t}),!0})),s.push({name:e.name,dataRange:t.value.specialRefRanges[Mt.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:r})},u=0,c=a.value;u<c.length;u++)if(d=c[u],"object"==typeof(f=l(d)))return[2,f.value];return p=Qu(t.range),m=!0===o.value?p:wu(p,o.value),h=[],rc(m,(function(e){return h.push(e),!0})),[2,Se({tables:s,availableRanges:h})]}}))}))},e.prototype.getIformats=function(e,t,r,n){var i;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(gu.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=(null!==(i=s.sent())&&void 0!==i?i:{snapshot:void 0}).snapshot)?[2,he(ti(["getIformats/getOrCreateSnapshot"]))]:(a=o.getIformats(t,r,n),ge(a)?[2,Se({availableFormats:a.value})]:[2,he(ti(["getIformats/getIntersectingTables"]))])}}))}))},e.prototype.getHiddenRows=function(e,t,r,n){var i;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var o;return Object(gu.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=(null!==(i=a.sent())&&void 0!==i?i:{snapshot:void 0}).snapshot)?[2,Mc]:[2,o.getHiddenRows(t,r,n)]}}))}))},e.prototype.getHiddenCols=function(e,t,r,n){var i;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var o;return Object(gu.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=(null!==(i=a.sent())&&void 0!==i?i:{snapshot:void 0}).snapshot)?[2,Mc]:[2,o.getHiddenCols(t,r,n)]}}))}))},e}();function sg(e){if(e.value.kind===me.Failure&&e.value.reason.kind===nn.Unavailable)for(var t=e.value.reason.objects,r=0;r<t.length;r++){var n=t[r];n.kind===zu.GridRange&&(t[r]=Object(gu.__assign)(Object(gu.__assign)({},n),{unavailableCells:!0}))}return e}var lg=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==Ju.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){C(e!==Ju.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==Ju.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(du(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults(ru(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var i=0;i<E(E(t.length,r.length),n.length);i+=10)this.onRecalcResults(ru(this.currentOutputStateId,e,!1,t.slice(i,i+10),r.slice(i,i+10),n.slice(i,i+10)))},e}();function ug(e){return{kind:e.kind}}var cg=function(){function e(e,t,r,n,i,o){void 0===i&&(i={}),void 0===o&&(o="Local");var a=this;this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.asyncLoopFactory=n,this.twConfig=i,this.dataTransformer=new Bp,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=fc,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(e,t,r){return Object(gu.__awaiter)(a,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(n){return[2,_i(e,t,r,this.twConfig)]}))}))},this.setConfig({}),this.dataModel=new jh(this.dataTransformer.getLangConfig(),this.config)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.dataTransformer.getLangConfig().mathpack},enumerable:!1,configurable:!0}),e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});var t=this.recalcLoop;return Yh(this.recalcLoop.promise,(function(){e.recalcLoop===t&&(e.recalcLoop=void 0)}))},e.prototype.testResumeRecalc=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.resumeRecalc()];case 1:return r.sent(),void 0!==e&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = ".concat(e),M.ULS.traceTag(574128980,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,t)),[2]}}))}))},e.prototype.processRecalcResults=function(e){for(var t=new lg(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var i=n[r];if(i.kind!==dc.GarbageCollected)if(i.kind!==dc.ExperimentRunResult){if(this.setOutputStateId(i.stateId))switch(t.setOutputStateId(i.stateId),i.kind){case dc.CellWrite:var o=i.cell,a=i.value,s=i.format,l=i.cellKind,u=i.formulaBarText,c=i.formatted,d=i.hasHyperlink,f=o.sheet,p=o.range,m=this.cellWriteToRangeDelta(f.index,p.row,p.col,a,s,u,c,d,"messages.<index>.value");b(m)&&t.pushCellWrite(l,m);break;case dc.RangeWrite:var h=i.range,g=i.values,v=(l=i.cellKind,u=i.formulaBarText,c=i.formatted,i.formats);f=h.sheet,p=h.range;t.pushRangeWrite(l,this.rangeWriteToRangeDeltas(f.index,p,g,v,u,c,"messages.<index>.values"));break;case dc.NameFailure:this.nameFailures.push(i);break;case dc.RangeFailure:h=i.range,l=i.cellKind;var S=i.reason;t.pushRangeFailure(l,this.rangeFailure(h,S)),this.rangeFailures.push(i);break;case dc.NumberFormatFailure:this.numberFormatFailures.push(i);break;case dc.PrintFormulaFailure:this.printFormulaFailures.push(i);break;case dc.InferFormatFailure:this.inferFormatFailures.push(i);break;case dc.FormatValueFailure:h=i.range,l=i.cellKind,S=i.reason;t.pushRangeFailure(l,this.rangeFailure(h,S)),this.formatValueFailures.push(i);break;case dc.UnhandledFailure:this.unhandledFailures.push(i);break;case dc.UpdateRequest:t.pushUpdateRequest(kp(i.range));break;case dc.UpdateNamesRequest:t.pushUpdateNameRequest(i.scope);break;case dc.RecalcStatistics:t.pushRecalcFinished(i.message===ac.RecalcFinished),this.recalcStatistics=mc(this.recalcStatistics,i);break;case dc.WorkbookStatistics:this.logWorkbookStats(i.stateId,i.stats,i.p);break;case dc.StateAdvanced:break;default:return L("calc.calc.RecalcServiceImpl.processRecalcResults",i)}}else this.logExperimentRunResult(i.experimentName,JSON.stringify({message:i.logMessage,timeoutReason:i.timeoutReason}));else this.onGC(i.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e,t){M.ULS.traceTag(594409422,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,"calc.calc.RecalcService: ".concat(e," done; ").concat(t)),"UnitExperiment"===e&&M.ULS.traceTag(538567681,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,"calc.calc.RecalcService: UnitExperiment done: ".concat(t))},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var i=this.inferFormatFailures;this.inferFormatFailures=[];var o=this.formatValueFailures;this.formatValueFailures=[];var a=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",Su.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",Su.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",Su.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",Su.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",Su.TraceLevel.Info),this.logCellFailureStats(o,590484948,"format-value",Su.TraceLevel.Info),this.logGenFailureStats(a,595194338,"unhandled",Su.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var i={},o=0,a=e;o<a.length;o++){Up(i,a[o].reason)}var s="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(i));M.ULS.traceTag(t,Su.LogCategory.msoulscat_ES_EWAJS,n,s),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var i,o=this;if(0!==e.length){for(var a={},s=0,l=e;s<l.length;s++){var u=l[s],c=u.reason,d=u.cellKind;Up(null!==(i=a[d])&&void 0!==i?i:a[d]={},c)}Object.getOwnPropertyNames(a).sort().forEach((function(e){var i=a[e],s="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(o.currentOutputStateId,", cell kind = ").concat(e,", stats = ").concat(JSON.stringify(i));M.ULS.traceTag(t,Su.LogCategory.msoulscat_ES_EWAJS,n,s)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r].reason;if(i.kind===vs.JavaScriptError){var o=j(i.error),a="calc.calc.RecalcService: recalc ".concat(t," JavaScript error: ").concat(o);M.ULS.traceTag(595658721,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,a)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var i="stateId = ".concat(t,", stats = ").concat(JSON.stringify(n)),o="calc.calc.RecalcService: ignored ".concat(r," data; ").concat(i);M.ULS.traceTag(e,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,o)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==fc)){var e=this.recalcStatistics;this.recalcStatistics=fc,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var r="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e),", p = ").concat(JSON.stringify(t)),n="calc.calc.RecalcService: recalc statistics; ".concat(r);M.ULS.traceTag(595654593,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,n)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=function(e){for(var t,r,n,i,o,a,s,l=g(),u=g(),c=0,d=e;c<d.length;c++){var f=d[c],p=f.range;if(f.reason.kind===rn.Unavailable)for(var m=0,h=f.reason.objects;m<h.length;m++){var v=h[m];v.kind===zu.GridRange&&(Hn(v.range.sheet,p.sheet)?l[v.range.sheet.index]=Mu(null!==(t=l[v.range.sheet.index])&&void 0!==t?t:ku,!0!==v.unavailableCells?v.unavailableCells:ku):u[v.range.sheet.index]=Mu(null!==(r=u[v.range.sheet.index])&&void 0!==r?r:ku,!0!==v.unavailableCells?v.unavailableCells:ku))}}var S=0,y=0,C=0,R=g();for(var b in l){var N=null!==(n=l[b])&&void 0!==n?n:ku;R[b]=Mu(null!==(i=R[b])&&void 0!==i?i:ku,N),rc(N,(function(e){return S+=e.rows*e.cols,!0}))}for(var b in u){N=null!==(o=u[b])&&void 0!==o?o:ku;R[b]=Mu(null!==(a=R[b])&&void 0!==a?a:ku,N),rc(N,(function(e){return y+=e.rows*e.cols,!0}))}for(var b in R){rc(N=null!==(s=R[b])&&void 0!==s?s:ku,(function(e){return C+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:S,numOfUnavailableCellsInDifferentSheet:y,totalNumOfUnavailableCells:C}}(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e)),r="calc.calc.RecalcService: unavailable cells statistics; ".concat(t);M.ULS.traceTag(589632004,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,r)}}},e.prototype.logWorkbookStats=function(e,t,r){var n="stateId = ".concat(e,", stats = ").concat(JSON.stringify(t),", p = ").concat(JSON.stringify(r)),i="calc.calc.RecalcService: workbook statistics; ".concat(n);M.ULS.traceTag(595359882,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,i)},e.prototype.logInputStateIdDecrease=function(e){Vc(this.ignoredInputStats,"".concat(e,": input stateId went backwards"))},e.prototype.logOutputStateIdDecrease=function(){Vc(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,i,o,a,s,l){if(Hc(n,Tf,this.ignoredOutputStats,l)){var u=_p(this.mathpack,n),c=function(e){var t;if(void 0!==e)return t=e.format,Xl("object"==typeof t?{kind:e.format.kind}:e.format,e.valueType,e.decimals)}(i);return b(o)||b(u)||b(c)||b(a)||b(s)?Zl(ml(e,t,r),$l(o,u,c,a,s)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,i,o,a){for(var s="".concat(a,".<index>.<index>"),l=t.row,u=t.col,c=t.rows,d=t.cols,f=[],p=0;p<c;p+=1)for(var m=0;m<d;m+=1){var h=this.cellWriteToRangeDelta(e,l+p,u+m,r[p][m],n[p][m],0===p&&0===m?i:void 0,o[p][m],void 0,s);b(h)&&f.push(h)}return f},e.prototype.rangeFailure=function(e,t){return tu(kp(e),ug(t))},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,Qc(e,Sd,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateNamedObjects=function(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Qc(t,xd,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var i=n[r];this.dataModel.extendUnusedRange(Np(this.document,i),e)}}},e.prototype.updateRanges=function(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Qc(t,Ld,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var i=n[r],o=i.range,a=i.data,s=i.fromStateId,l=Rp(this.document,o);if(b(a)){var u=a.formulaBarText,c=a.isSpilled,d=pn(l.range);this.dataModel.writeArrayFormula(e,l,u,d,c)}else b(s)}}},e.prototype.editRangeFormulas=function(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))},e.prototype.evalOnClonedModel=function(e,t,r){return this.evalOnClonedModelOnSnapshot(e,t,void 0,r)},e.prototype.evalOnClonedModelOnSnapshot=function(e,t,r,n){void 0===r&&(r=void 0),U("edits array should not be empty",t.length);var i=void 0===r?new Kh(this.dataModel,n):new Vh(r,n);return this.applyRangeUpdates(-1,e,i),this.applyRangeFormulaEdits(t,-1,i),i.resultsPromise.toPromise()},e.prototype.applyRangeUpdates=function(e,t,r){for(var n,i,o=0,a=Qc(t,Dd,this.ignoredInputStats,"rangeUpdates");o<a.length;o++){var s=a[o],l=s.range,u=s.excludeRows,c=s.excludeColumns,d=s.data,f=s.fromStateId,p=Rp(this.document,l),m=p.range,h=Ap(m.row,m.rows,Hu.row,u),g=Ap(m.col,m.cols,Hu.col,c),v=Tp(p,h,g),S=b(d)?Ip(this.mathpack,d.value):Xe;D("calc.calc.RecalcService: updateRanges oper",null!=S);var y=pn(m);if(b(d)){var C=d.iformat,R="ArrayFormula"===d.kind?void 0:null!==(n=d.formulaBarText)&&void 0!==n?n:void 0,T=null!==(i=d.failureReason)&&void 0!==i?i:void 0,P="CellFormula"===d.kind;this.dataModel.writeCellContents(e,v,R,P,y,S,C,uc.Blank,T,r)}else if(N(f))this.dataModel.writeCellContents(e,v,"",!1,y,Xe,0,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,p,v,f)}r||(this.dataModel.writeHiddenRows(e,Pp(p,h)),this.dataModel.writeHiddenCols(e,Ep(p,g)))}},e.prototype.applyRangeFormulaEdits=function(e,t,r){for(var n=this,i=Qc(e,tf,this.ignoredInputStats,"rangeFormulaEdits"),o=function(e){var i=e.kind,o=e.range,s=e.formulaBarText,l=e.value,u=e.origin,c=e.viewport,d=ku;o.forEach((function(e){d=Mu(d,Qu(Rp(n.document,e).range))}));var f=Rp(a.document,o[0]),p=b(u)?Ee(u.row,u.column):pn(f.range),m=b(c)?Rp(a.document,c):void 0,h=void 0;b(l)?(h=Ip(a.mathpack,l),D("calc.calc.RecalcService: editRangeFormulas oper",null!=h)):h=void 0;var g="CellFormula"===i||"Value"!==i&&void 0;r?a.dataModel.editCellContentsOnClone(ic(f.sheet,d),s,g,p,r):a.dataModel.editCellContents(t,ic(f.sheet,d),s,g,p,h,m)},a=this,s=0,l=i;s<l.length;s++){o(l[s])}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=Qc(t,nf,this.ignoredInputStats,"rangeFormatEdits"),i=function(t){var n=t.range,i=t.operation,a=t.origin,s=t.viewport,l="SetFormat"!==i.kind||N(i.format)?"RibbonFormat"!==i.kind||N(i.ribbon)?"ChangeDecimals"!==i.kind||N(i.changeDecimals)?void 0:{kind:i.kind,changeDecimals:i.changeDecimals}:{kind:i.kind,ribbon:i.ribbon}:{kind:i.kind,format:i.format};D("calc.calc.RecalcService: editRangeFormats operation",null!=l);var u=ku;n.forEach((function(e){u=Mu(u,Qu(Rp(r.document,e).range))}));var c=Rp(o.document,n[0]),d=null!=a?Ee(a.row,a.column):pn(c.range),f=b(s)?Rp(o.document,s):void 0;o.dataModel.editCellFormats(e,ic(c.sheet,u),l,d,f)},o=this,a=0,s=n;a<s.length;a++){i(s[a])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=Qc(t,of,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var i=n[r],o=i.range,a=i.formulaBarText,s=i.origin,l=i.viewport,u=Rp(this.document,o),c=b(s)?Ee(s.row,s.column):Ee(o.row,o.column),d=b(l)?Rp(this.document,l):void 0;this.dataModel.editArrayFormula(e,u,a,c,d)}}},e.prototype.editRangePaste=function(e,t){if(this.setInputStateId(e,"editRangePaste")){this.clearAsyncResumeRecalc();for(var r=0,n=Qc(t,sf,this.ignoredInputStats,"pasteEdits");r<n.length;r++){var i=n[r],o=i.kind,a=i.source,s=i.target,l=i.viewport,u=Rp(this.document,a),c=bp(this.document,s),d=b(l)?Rp(this.document,l):void 0;this.dataModel.editPaste(e,o,c,u,d)}}},e.prototype.setConfig=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,factories:(p=e.runExperiments,p.map((function(e){var t,r=e.name,n=e.param;return null===(t=Sh[r])||void 0===t?void 0:t.call(Sh,n)})).filter((function(e){return void 0!==e})))}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:2*xe,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(i=e.samplePrecisionEvalRate)&&void 0!==i?i:.02,samplePrecisionPrintFormulaRate:null!==(o=e.samplePrecisionPrintFormulaRate)&&void 0!==o?o:.001,samplePrecisionPrintValueRate:null!==(a=e.samplePrecisionPrintValueRate)&&void 0!==a?a:1e-4,sampleRecalcStatisticsRate:null!==(s=e.sampleRecalcStatisticsRate)&&void 0!==s?s:.2,sampleWorkbookStatisticsRate:null!==(l=e.sampleWorkbookStatisticsRate)&&void 0!==l?l:.1,sampleCellEvalStopwatchRate:null!==(u=e.sampleCellEvalStopwatchRate)&&void 0!==u?u:.003,sampleRecalcEditedStopwatchRate:null!==(c=e.sampleRecalcEditedStopwatchRate)&&void 0!==c?c:1,sampleRecalcViewportStopwatchRate:null!==(d=e.sampleRecalcViewportStopwatchRate)&&void 0!==d?d:1,rngSeed:null!==(f=e.rngSeed)&&void 0!==f?f:1e3*Date.now(),volatileMode:null!=e.volatileMode?ff[e.volatileMode]:ff.Estimation,experimentFactories:m}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new jh(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=fc,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormula=function(e,t,r,n){var i=this;return Hc(r,Od,this.ignoredInputStats,"origin")?Hc(n,bf,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,bp(this.document,r),function(e){if(null!=e)switch(e.kind){case"Origin":return{kind:lc.Origin};case"Iformat":return D("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Known":return D("calc.calc.evalFormulaFormatToUnion: knownFormat","number"==typeof e.knownFormat),{kind:lc.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:lc.Inferred};case"Aggregate":return{kind:lc.Aggregate};default:return L("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}(n)).then((function(e){var t,r=e.value,n=e.formatted;if(ge(r)){if(!Hc(r.value,Tf,i.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var o=_p(i.mathpack,r.value);D("calc.calc.RecalcService.evalFormula",void 0!==o),t=Se(o)}else t=he(ug(r.reason));return uu(t,void 0===n?void 0:ge(n)?n:he(ug(n.reason)))})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.evalFormulaOnSnapshotImpl=function(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.getMissingJSFeatures=function(){return $h()},e}(),dg=Object(c.mixin)(cg,(function(e){return new ag(e)}),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if(fe("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(og=self.__retries)&&void 0!==og?og:-1)+1,0===self.__retries))throw"";var fg=function(e){var t=e.config,r=e.connection;return vu.Endpoint.createInside(r,(function(e){return new dg((function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onRecalcResults.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onUpdateRequest.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onGC.apply(t,r)}),Wh,t,r.createMode)}))},pg=Rh.notificationKinds.NotificationKind,mg={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetIntersectingTables:"GetIntersectingTables",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetConfig:"GetConfig",AwaitPromise:"AwaitPromise",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",CreateChatGPTSession:"CreateChatGPTSession",CloseChatGPTSession:"CloseChatGPTSession",SendChatGPTRequest:"SendChatGPTRequest"};d(),d(),d(),d();var hg,gg=[pg.setActiveCell,pg.doNothing,pg.setFunctionsInfo,pg.setDefinedNamesInfo,pg.notifyWorkbookClosing];function vg(e,t){var r;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(gu.__assign)({kind:e},t)];case 1:if("RequestFailure"===(r=n.sent()).kind)throw"RequestFailure: typedRequest got error response";return D("Response kind coincides with request kind",r.kind===e),[2,r]}}))}function Sg(e){var t;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:mg.AwaitPromise,promise:e}];case 1:return t=r.sent(),D("Response kind coincides with request kind",t.kind===mg.AwaitPromise),[2,t.result]}}))}function yg(e){return vg(mg.GetRange,{range:e})}function Cg(){return vg(mg.GetSheetNames,{})}function Rg(e){return vg(mg.GetCell,{cell:e})}function bg(){return vg(mg.Delay,{})}f(),function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery"}(hg||(hg={})),d(),d(),d(),d();var Ng,Tg,Pg={kind:mg.Delay};function Eg(e,t,r){return void 0===r&&(r=!1),vg(mg.ParseCellFormula,{cell:e,formula:t,useEnglishLocaleInfo:r})}!function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepPlugin=3]="StepPlugin",e[e.StopPlugins=4]="StopPlugins"}(Ng||(Ng={})),function(e){e.DevOnly="DevOnly",e.StableOnly="StableOnly",e.Both="Both",e.SyncDevOnly="SyncDevOnly",e.SyncStableOnly="SyncStableOnly",e.SyncBoth="SyncBoth"}(Tg||(Tg={})),d(),d(),d();function kg(e,t){for(var r={},n=function(t){r[t]=function(){for(var r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return(r=e.getValue())[t].apply(r,n)}},i=0,o=t;i<o.length;i++){n(o[i])}return r}var Og=function(){function e(){}return e.prototype.unbox=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e(t)}},e.prototype.nullcheck=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++){var o=i[n];if(N(o))return null}return e.apply(void 0,t)}},e}();function Ag(e){var t=new Og,r=t[e].bind(t);return function(e,t){for(var n={},i=0,o=t;i<o.length;i++){var a=o[i],s=e[a].bind(e);n[a]=r(s)}return n}}var Ig=Ag("unbox"),_g=Ag("nullcheck"),Fg={methodF:function(e){return e+1},methodG:function(e){return e[0]+1}},Mg=Ig(Fg,["methodG"]);_g(Fg,["methodG"]),_g(Mg,["methodG"]);function Dg(e){var t,r=function(e,t){for(var r={},n=function(t){r[t]=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.apply(void 0,Object(gu.__spreadArray)([t],r,!1))}},i=0,o=t;i<o.length;i++){n(o[i])}return r}(e.doNotify.bind(e),gg),n=Ig(r,gg),i=_g(n,gg);return Object(gu.__assign)(Object(gu.__assign)({},i),((t={})[pg.notifyWorkbookClosing]=function(){return n.notifyWorkbookClosing([])},t))}d(),d(),d();var wg,Lg,xg,Bg,Ug,Gg,Kg=Rh.schedulerVersion.SchedulerVersion,Vg=((wg={})[bh.TestPlugin]=hg.runTest,wg[bh.PythonTestPlugin]=hg.runTest,wg[bh.AutocompletePlugin]=hg.functionSuggestion,wg[bh.AutocompleteRangeSuggestionPlugin]=hg.inCellSuggestion,wg[bh.DragPlugin]=hg.functionSuggestion,wg[bh.ConfigTestPlugin]=hg.runTest,wg[bh.FeatureGateTestPlugin]=hg.runTest,wg[bh.ChangeGateTestPlugin]=hg.runTest,wg[bh.ArgumentAssistancePlugin]=hg.argumentAssistance,wg[bh.FormulaRepairShadowEvalPlugin]=hg.runAuthoringExperiment,wg[bh.FormulaCollectionPlugin]=hg.functionSuggestion,wg[bh.DNMTraceTagTestPlugin]=hg.runTest,wg[bh.AutocompletePrecisionMeasurements]=hg.runExperiment,wg[bh.AutocompleteAuthoringPrecisionMeasurements]=hg.runAuthoringExperiment,wg[bh.AutocompleteGroundTruthMeasurements]=hg.runExperiment,wg[bh.AutocompleteWrapperPlugin]=hg.runPerCharacterExperiment,wg[bh.AutocompleteBinaryModelExperimentPlugin]=hg.runAuthoringExperiment,wg[bh.ParenthesesCouplingPlugin]=hg.formulaHighlighting,wg[bh.ColoredReferencesPlugin]=hg.formulaHighlighting,wg[bh.SlowTestPlugin]=hg.functionSuggestion,wg[bh.EvalOnCloneTestPlugin]=hg.runTest,wg[bh.EvalFormulaTestPlugin]=hg.runTest,wg[bh.AutocompleteFunctionPlugin]=hg.functionSuggestion,wg[bh.AutocompleteLetPlugin]=hg.functionSuggestion,wg[bh.AutocompleteRichValuePlugin]=hg.functionSuggestion,wg[bh.AutocompleteNamedObjectsPlugin]=hg.functionSuggestion,wg[bh.ParserPerformanceMeasurements]=hg.runExperiment,wg[bh.AutocompleteTableHeadersPlugin]=hg.functionSuggestion,wg[bh.PythonAutocompletePlugin]=hg.functionSuggestion,wg[bh.ValuePreviewPlugin]=hg.valuePreview,wg[bh.SyntaxErrorsPlugin]=hg.formulaRepair,wg[bh.ChatGPTPlugin]=hg.chatGPTQuery,wg);d(),d(),d();var jg=((Lg={})[bh.ParenthesesCouplingPlugin]=Tg.SyncBoth,Lg[bh.ColoredReferencesPlugin]=Tg.SyncBoth,Lg);d(),d();var Wg="Main";var Hg=g(),Qg=g();function qg(e,t){var r=(t===Kg.Stable?Hg:Qg)[e];if(!r){var n="x10arch.getPluginFactory: ".concat(bh[e]," has not been registered on ").concat(Wg);throw M.ULS.traceTag(557056858,ii.msoulscat_ES_EWAJS,ci.Error,n),new Error(n)}return r}function zg(e){var t,r,n=e.factoryName,i=jg,o=null!==(t=Hg[n])&&void 0!==t?t:Qg[n];if(void 0!==o&&o!==e){var a="x10arch.registerPluginFactory: ".concat(bh[n]," is already registered on ").concat(Wg);if(M.ULS.traceTag(557056859,ii.msoulscat_ES_EWAJS,ci.Error,a),!fe("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(a)}var s=null!==(r=i[n])&&void 0!==r?r:Tg.Both;switch(s){case Tg.Both:case Tg.SyncBoth:Qg[n]=e,Hg[n]=e;break;case Tg.StableOnly:case Tg.SyncStableOnly:Hg[n]=e;break;case Tg.DevOnly:case Tg.SyncDevOnly:Qg[n]=e;break;default:L("x10arch.registerPluginFactory: ".concat(bh[n],", unknown compatibility: ").concat(s),s)}Lh.log({kind:"registerPluginFactory",payload:{factoryName:n,threadId:Wg}})}var Yg=((xg={})[Nh.Excel]=!0,xg[Nh.Python]=!1,xg);d();var Jg=((Bg={})[Nh.Excel]=((Ug={})[bh.PythonTestPlugin]=!1,Ug[bh.PythonAutocompletePlugin]=!1,Ug),Bg[Nh.Python]=((Gg={})[bh.PythonTestPlugin]=!0,Gg[bh.PythonAutocompletePlugin]=!0,Gg),Bg),Xg=Rh.timelineQueueProcessor.TimelineQueueProcessor,$g=Rh.timelineQueueProcessor.defaultTimerInterface,Zg=Rh.formulaAssistanceModule.CompletionItemKind,ev=Rh.formulaAssistanceModule.SuggestionKind,tv=(Rh.formulaAssistanceModule.DiagnosticSeverity,Rh.formulaAssistanceModule.DiagnosticTag,Rh.formulaAssistanceModule.CodeActionKind,Rh.formulaAssistanceModule.RepairItemPartType);function rv(e,t,r,n){void 0===n&&(n=!1);var i=[],o=[],a=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:o}:(t.forEach((function(e){var t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(!t.startsWith(a)||n&&t===a)if(n){var s=t.split(" ");b(s.find((function(e){return e.startsWith(a)})))&&o.push(e)}else a.length>2&&t.includes(a)&&o.push(e);else i.push(e)})),{prefixedSuggestions:i,notPrefixedSuggestions:o})}var nv,iv,ov=function(e){var t,r,n,i,o=e.kind===Zg.TableHeader?1:null!==(r=null===(t=e.label)||void 0===t?void 0:t.startsWith("#"))&&void 0!==r&&r?0:null!==(i=null===(n=e.label)||void 0===n?void 0:n.startsWith("@"))&&void 0!==i&&i?2:void 0;return N(o)?(M.ULS.traceTag(526411872,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,"conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ".concat(JSON.stringify(e))),0):o},av=(Rh.helpers.Timeline,Rh.helpers.indexToLSPPosition,Rh.helpers.spanToLSPRange),sv=Rh.helpers.spanCompare,lv={runTest:cv,runExperiment:cv,runAuthoringExperiment:cv,runPerCharacterExperiment:cv,inCellSuggestion:function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t],i=n[0],o=n[1];if(i===bh.AutocompleteRangeSuggestionPlugin&&b(o))return o}return null},formulaHighlighting:function(e){var t;if(e.length>0){for(var r=[],n=0,i=e;n<i.length;n++){var o=i[n],a=(o[0],null===(t=o[1].formulaHighlights)||void 0===t?void 0:t.filter(b));void 0!==a&&(r=r.concat(a))}return r.sort((function(e,t){return b(e.span)&&b(t.span)?sv(e.span,t.span):b(e)?1:b(t)?-1:0})),{formulaHighlights:r}}return null},functionSuggestion:function(e){for(var t=[],r=[],n=void 0,i=0,o=e;i<o.length;i++){var a=o[i],s=a[0],l=a[1];u(s)===ev.Smart?(b(l.items)&&l.items.filter(b).filter((function(e){return b(e.textEdit)||b(e.label)})).forEach((function(e){return t.push(Object(gu.__assign)(Object(gu.__assign)({},e),{type:ev.Smart}))})),b(l.data)&&(n=l.data)):b(l.items)&&l.items.filter(b).filter((function(e){return b(e.textEdit)||b(e.label)})).forEach((function(e){return r.push(Object(gu.__assign)(Object(gu.__assign)({},e),{type:ev.Simple}))}))}return{items:Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!0),r.sort((function(e,t){if(b(e.label)&&b(t.label)){if(b(e.isPrefixed)&&b(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(uv.includes(e.kind)&&uv.includes(t.kind)){var r=ov(e),n=ov(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return b(e.label)?1:b(t.label)?-1:0})),!0),data:n};function u(e){switch(e){case bh.AutocompletePlugin:case bh.FormulaCollectionPlugin:return ev.Smart;case bh.DragPlugin:case bh.SlowTestPlugin:case bh.AutocompleteFunctionPlugin:case bh.AutocompleteLetPlugin:case bh.AutocompleteRichValuePlugin:case bh.AutocompleteNamedObjectsPlugin:case bh.AutocompleteTableHeadersPlugin:case bh.PythonAutocompletePlugin:return ev.Simple;default:L("unknown plugin factory name: ".concat(e),e)}}},argumentAssistance:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: argumentAssistance: ".concat(e.length," results received, while only one active plugin is currently supported"))},valuePreview:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: valuePreview: ".concat(e.length," results received, while only one active plugin is currently supported"))},formulaRepair:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: formulaRepair: ".concat(e.length," results received, while only one active plugin is currently supported"))},chatGPTQuery:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: chatGPTSuggestion: ".concat(e.length," results received, while only one active plugin is currently supported"))}},uv=[Zg.TableHeader,Zg.TableSpecialStructRef];function cv(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],o=(i[0],i[1].results);b(o)&&t.push.apply(t,o.filter(b))}return{results:t}}d(),function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(iv||(iv={}));var dv,fv=((nv={})[iv.FunctionSuggestionAndArgumentAssistance]=[hg.functionSuggestion,hg.argumentAssistance,hg.inCellSuggestion],nv);d(),d(),d(),d(),d();var pv=function(){function e(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new Ch}return e.prototype.consumeResult=function(e){var t;if(Object(ce.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(e.kind){case hg.functionSuggestion:D("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case hg.argumentAssistance:D("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case hg.inCellSuggestion:D("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=e.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:L("unknown result: ".concat(e),e)}else switch(e.kind){case hg.functionSuggestion:if(D("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),b(e.result)&&b(e.result.items)&&e.result.items.length>0&&(null===(t=e.result.items[e.result.items.length-1])||void 0===t?void 0:t.type)===ev.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0;break;case hg.argumentAssistance:if(D("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;case hg.inCellSuggestion:break;default:L("unknown result: ".concat(e),e)}},e.create=function(){return new e},e.prototype.resolvePromiseIfPossible=function(){var e,t;if(this.functionSuggestionSet){if(b(this.functionSuggestionResult)&&b(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return(null===(e=this.functionSuggestionResult.items[length-1])||void 0===e?void 0:e.type)===ev.Smart&&(D("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||null==this.argumentAssistanceResult),D("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||null==(null===(t=this.inCellSuggestionResult)||void 0===t?void 0:t.completionItem))),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}},e}();d();var mv,hv=((dv={})[iv.FunctionSuggestionAndArgumentAssistance]=pv,dv);d();var gv=((mv={})[hg.functionSuggestion]={startDelta:5,stopDelta:2e3},mv[hg.inCellSuggestion]={startDelta:5,stopDelta:2e3},mv[hg.formulaHighlighting]={startDelta:5,stopDelta:2e3},mv[hg.argumentAssistance]={startDelta:5,stopDelta:2e3},mv[hg.valuePreview]={startDelta:5,stopDelta:2e3},mv[hg.formulaRepair]={startDelta:5,stopDelta:2e3},mv[hg.runExperiment]={startDelta:0,stopDelta:15e3},mv[hg.runAuthoringExperiment]={startDelta:0,stopDelta:15e3},mv[hg.runPerCharacterExperiment]={startDelta:5,stopDelta:2e3},mv[hg.runTest]={startDelta:0,stopDelta:15e3},mv[hg.chatGPTQuery]={startDelta:0,stopDelta:15e3},mv);d(),d(),d(),d();var vv,Sv,yv,Cv=new Ef((function(){try{for(var e=new Map,t=0,r=Object.keys(Gr);t<r.length;t++){var n=r[t],i=Number(n);isNaN(Number(i))||e.set(i,FormulaAuthoringStrings[Gr[i]+"ShortDescription"])}return{descriptionsMap:e}}catch(e){return M.ULS.traceTag(538792415,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,"failed to get functionShortDescriptionsMap with exception ".concat(e)),{}}})),Rv=function(){function e(){this.subscribers=[]}return e.prototype.next=function(e){for(var t=0,r=this.subscribers;t<r.length;t++){(0,r[t])(e)}},e.prototype.subscribe=function(e){this.subscribers.push(e)},e}(),bv=function(e){function t(t){var r=e.call(this)||this;return r.initializeSubscriber=t,r}return Object(gu.__extends)(t,e),t.prototype.subscribe=function(t){e.prototype.subscribe.call(this,t),this.initializeSubscriber().map(t)},t}(Rv),Nv=function(e){this.value=e},Tv=((vv={})[mg.GetSheetNames]=!0,vv[mg.GetRange]=!0,vv[mg.Delay]=!0,vv[mg.GetCell]=!0,vv[mg.GetContainingTable]=!0,vv[mg.UnsafeGetContainingTableName]=!0,vv[mg.GetAvailableTableHeaders]=!0,vv[mg.GetIntersectingTables]=!0,vv[mg.UnsafeGetIntersectingTableNames]=!0,vv[mg.GetIformat]=!0,vv[mg.GetStructRefColumn]=!0,vv[mg.GetStructRefSpecialRef]=!0,vv[mg.ParseCellFormula]=!0,vv[mg.ParseEdit]=!0,vv[mg.ParseActiveCell]=!0,vv[mg.ParseNumberFormat]=!0,vv[mg.PrintFormula]=!0,vv[mg.GetActiveCell]=!0,vv[mg.GetActiveCellFormat]=!0,vv[mg.GetConfig]=!0,vv[mg.AwaitPromise]=!0,vv[mg.GetFunctionsInfo]=!0,vv[mg.GetFunctionInfo]=!0,vv[mg.GetCorrelationId]=!0,vv[mg.SetActiveCell]=!0,vv[mg.GetRichValueFieldListContext]=!0,vv[mg.GetHiddenRows]=!0,vv[mg.GetHiddenCols]=!0,vv[mg.GetDefinedNameInfo]=!0,vv[mg.GetDefinedNamesInfo]=!0,vv[mg.ResolveReferences]=!0,vv[mg.EvalOnClonedModel]=!0,vv[mg.EvalFormula]=!0,vv[mg.GetCorrespondingSnapshotID]=!0,vv[mg.GetFullTableHeadersFromServer]=!0,vv[mg.CreateChatGPTSession]=!0,vv[mg.CloseChatGPTSession]=!0,vv[mg.SendChatGPTRequest]=!0,vv);function Pv(e){return!0===Tv[e.kind]}f(),d(),d(),function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"}(Sv||(Sv={})),function(e){e.Done="Done",e.Exception="Exception"}(yv||(yv={}));var Ev,kv,Ov={Unknown:"Unknown",UiFrame:Sv,Plugin:yv},Av=function(){function e(e){this.pluginKind=e,this.numPlugins=0,this.numSyncPlugins=0,this.resolveCorrelatedRequestsWithNoPluginsEnabled=pe("OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins")}return Object.defineProperty(e.prototype,"uiMessageFrame",{get:function(){return this._uiMessageFrame},enumerable:!1,configurable:!0}),e.prototype.createUIMessageFrame=function(e,t,r,n){var i=new Ch,o=this.pluginKind;return this._uiMessageFrame={correlationId:e,cache:t,config:r,startTime:n,successfulResults:{kind:o,results:[]},resolvable:i,stopReasonRef:new Nv(Ov.Unknown),numFailures:0,numSkippedPlugins:0},i},e.prototype.closeUIMessageFrame=function(e,t){var r,n=this.uiMessageFrame;if(n&&(this._uiMessageFrame=void 0,n.stopReasonRef.value=e,n.resolvable.resolve(e===Ov.UiFrame.Superseded?{kind:Ph.Superseded}:{kind:Ph.Done,payload:n.successfulResults}),null===(r=n.cache)||void 0===r||r.close(),this.resolveCorrelatedRequestsWithNoPluginsEnabled||this.numPlugins>0)){var i=this.pluginKind,o=this.numPlugins,a=this.numSyncPlugins,s=n.correlationId,l=n.startTime,u=n.numSkippedPlugins,c={correlationId:s,pluginKind:i,numPlugins:o,numSyncPlugins:a,numSent:n.successfulResults.results.length,numSkippedPlugins:u,stopReason:e,startTime:l,stopTime:t};Lh.log({kind:"closeUIMessageFrame",payload:c})}},e.prototype.stop=function(e,t){void 0!==this.uiMessageFrame&&this.closeUIMessageFrame(e,t)},e}();function Iv(e,t){switch(e.kind){case mg.Delay:case mg.GetActiveCell:case mg.GetActiveCellFormat:case mg.GetConfig:case mg.GetCorrelationId:case mg.GetFunctionInfo:case mg.GetFunctionsInfo:case mg.GetDefinedNameInfo:case mg.GetDefinedNamesInfo:case mg.SetActiveCell:return{kind:Ng.NoOpRequest,request:e,computation:t};case mg.GetSheetNames:case mg.GetAvailableTableHeaders:case mg.ParseCellFormula:case mg.ParseNumberFormat:case mg.PrintFormula:case mg.ParseActiveCell:case mg.ResolveReferences:case mg.UnsafeGetContainingTableName:case mg.UnsafeGetIntersectingTableNames:case mg.GetStructRefColumn:case mg.GetStructRefSpecialRef:return{kind:Ng.SyncRequest,request:e,computation:t};default:L("unknown request: ".concat(e),e)}}function _v(e,t){switch(e.kind){case mg.GetRange:case mg.GetCell:case mg.GetContainingTable:case mg.GetIntersectingTables:case mg.GetIformat:case mg.AwaitPromise:case mg.ParseEdit:case mg.GetRichValueFieldListContext:case mg.GetHiddenRows:case mg.GetHiddenCols:case mg.EvalOnClonedModel:case mg.EvalFormula:case mg.GetCorrespondingSnapshotID:case mg.GetFullTableHeadersFromServer:case mg.CreateChatGPTSession:case mg.CloseChatGPTSession:case mg.SendChatGPTRequest:return{kind:Ng.AsyncRequest,request:e,computation:t};default:return Iv(e,t)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure",e[e.AsyncException=3]="AsyncException"}(kv||(kv={})),d(),d(),d(),d();var Fv,Mv=((Ev={})[mg.Delay]=!0,Ev[mg.ParseCellFormula]=!0,Ev[mg.ParseActiveCell]=!0,Ev[mg.ParseNumberFormat]=!0,Ev[mg.PrintFormula]=!0,Ev[mg.GetActiveCell]=!0,Ev[mg.GetActiveCellFormat]=!0,Ev[mg.GetSheetNames]=!0,Ev[mg.GetConfig]=!0,Ev[mg.GetFunctionsInfo]=!0,Ev[mg.GetFunctionInfo]=!0,Ev[mg.GetDefinedNamesInfo]=!0,Ev[mg.GetDefinedNameInfo]=!0,Ev[mg.GetCorrelationId]=!0,Ev[mg.GetAvailableTableHeaders]=!0,Ev[mg.SetActiveCell]=!0,Ev[mg.ResolveReferences]=!0,Ev[mg.UnsafeGetIntersectingTableNames]=!0,Ev[mg.UnsafeGetContainingTableName]=!0,Ev[mg.GetStructRefColumn]=!0,Ev[mg.GetStructRefSpecialRef]=!0,Ev);function Dv(e){return!0===Mv[e.kind]}function wv(e,t){return e.kind===me.Failure?e:Se(t(e.value))}f();var Lv=((Fv={})[mg.Delay]=function(){return Se({})},Fv[mg.AwaitPromise]=function(e){var t=e.request.promise;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t];case 1:return e=n.sent(),[2,Se({result:e})];case 2:return r=n.sent(),[2,he(r)];case 3:return[2]}}))}))},Fv[mg.GetCell]=function(e){var t=e.request.cell,r=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,he(void 0)]:[4,r.getCell(t)];case 1:return e=n.sent(),[2,Se({result:e})]}}))}))},Fv[mg.GetContainingTable]=function(e){var t=e.request.cell,r=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,he(void 0)]:[4,r.getContainingTable(t)];case 1:return e=n.sent(),[2,Se({result:e})]}}))}))},Fv[mg.UnsafeGetContainingTableName]=function(e){var t=e.request.cell,r=e.cache;if(void 0===r)return he(void 0);var n=r.getContainingTableName(t);return Se({result:n})},Fv[mg.GetAvailableTableHeaders]=function(e){var t=e.request.tableName,r=e.cache;if(void 0===r)return he(void 0);var n=r.getAvailableTableHeaders(t);return Se({result:n})},Fv[mg.GetIntersectingTables]=function(e){var t=e.request.range,r=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,he(void 0)]:[4,r.getIntersectingTables(t)];case 1:return e=n.sent(),[2,Se({result:e})]}}))}))},Fv[mg.UnsafeGetIntersectingTableNames]=function(e){var t=e.request.range,r=e.cache;if(void 0===r)return he(void 0);var n=r.getIntersectingTableNames(t);return Se({result:n})},Fv[mg.GetRange]=function(e){var t=e.request,r=t.range,n=t.layers,i=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return void 0===i?[2,he(void 0)]:[4,i.getRange(r,n)];case 1:return e=t.sent(),[2,Se({localSheetGrid:e})]}}))}))},Fv[mg.GetSheetNames]=function(e){var t=e.cache;return void 0===t?he(void 0):t.getSheetNames()},Fv[mg.GetStructRefColumn]=function(e){var t=e.request,r=t.table,n=t.nameOrCol,i=e.cache;if(void 0===i)return he(void 0);var o=i.getStructRefColumn(r,n);return Se({result:o})},Fv[mg.GetStructRefSpecialRef]=function(e){var t=e.request,r=t.table,n=t.id,i=e.cache;if(void 0===i)return he(void 0);var o=i.getStructRefSpecialRef(r,n);return Se({result:o})},Fv[mg.GetIformat]=function(e){var t=e.request,r=t.document,n=t.iformat,i=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return void 0===i?[2,he(void 0)]:[4,i.getIformat(r,n)];case 1:return e=t.sent(),[2,Se({result:e})]}}))}))},Fv[mg.ParseCellFormula]=function(e){var t=e.request,r=t.cell,n=t.formula,i=t.useEnglishLocaleInfo,o=e.cache;return void 0===o?he(void 0):Se(o.parseCellFormula(r,n,i))},Fv[mg.ParseEdit]=function(e){var t=e.request,r=t.cell,n=t.formulaBarText,i=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return void 0===i?[2,he(void 0)]:(e=Se,[4,i.parseEdit(r,n)]);case 1:return[2,e.apply(void 0,[t.sent()])]}}))}))},Fv[mg.ParseActiveCell]=function(e){var t=e.request.formulaText,r=e.schedulerState,n=r.activeCell,i=r.activeCellFormat,o=e.cache;if(void 0===o||N(n)||void 0===i)return he(void 0);if(pe("OfficeVSO:7125313_handleUnavailableFormat")){var a=null!=i?i:{formatString:"General",builtIn:!0};return Se(o.parseEditSync(n,t,a))}return N(i)?he(void 0):Se(o.parseEditSync(n,t,i))},Fv[mg.ParseNumberFormat]=function(e){var t=e.request,r=t.formatString,n=t.builtIn,i=e.cache;return void 0===i?he(void 0):Se(i.parseNumberFormat(r,n))},Fv[mg.PrintFormula]=function(e){var t=e.request,r=t.formula,n=t.origin,i=e.config;if(void 0===i)return he([]);var o=Ro(bo(i)).printFormula(No(Ae(Re.Cell,n),n),r);return Se({result:o})},Fv[mg.GetActiveCell]=function(e){var t=e.schedulerState.activeCell;return void 0===t?(Ei.ULS.traceTag(512274723,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.GetActiveCell failed because activeCell was undefined"),he(void 0)):Se({activeCell:t})},Fv[mg.GetActiveCellFormat]=function(e){var t=e.schedulerState.activeCellFormat;return void 0===t?he(void 0):Se(null===t?{result:he(ti(["unavailableFormat"]))}:{result:Se(t)})},Fv[mg.GetConfig]=function(e){var t=e.config;return void 0===t?he(void 0):Se({config:t})},Fv[mg.GetFunctionsInfo]=function(e){var t=e.schedulerState.functionsInfoMap;if(void 0===t)return Ei.ULS.traceTag(512274722,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.GetFunctionsInfo failed because functionsInfoMap was undefined"),he(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return Se({functionsInfo:r})},Fv[mg.GetFunctionInfo]=function(e){var t=e.request.functionName,r=e.schedulerState;if(void 0===r.functionsInfoMap)return Ei.ULS.traceTag(512274721,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.GetFunctionInfo failed because functionsInfoMap was undefined"),he(void 0);var n=r.functionsInfoMap[t.toUpperCase()];return void 0===n?he(void 0):Se({functionInfo:n})},Fv[mg.GetDefinedNamesInfo]=function(e){var t=e.schedulerState.definedNamesInfoMap;if(void 0===t)return Ei.ULS.traceTag(512274720,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.GetDefinedNamesInfo failed because definedNamesInfoMap was undefined"),he(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return Se({definedNamesInfo:r})},Fv[mg.GetDefinedNameInfo]=function(e){var t=e.request.definedName,r=e.schedulerState;if(void 0===r.definedNamesInfoMap)return he(void 0);var n=r.definedNamesInfoMap[t.toUpperCase()];return Se({definedNameInfo:n})},Fv[mg.EvalOnClonedModel]=function(e){var t=e.cache,r=e.request;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==t?void 0:t.evalOnClonedModel(r.updates,r.edits)];case 1:return void 0===(e=n.sent())||e.kind!==me.Success?[2,he(void 0)]:[2,Se({result:e.value})]}}))}))},Fv[mg.EvalFormula]=function(e){var t=e.cache,r=e.request;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==t?void 0:t.evalFormula(r.formula,r.origin,r.format)];case 1:return void 0===(e=n.sent())?[2,he(void 0)]:e.kind!==me.Success?[2,he(e.reason)]:[2,Se({result:e.value})]}}))}))},Fv[mg.GetCorrelationId]=function(e){var t=e.correlationId;return Se({correlationId:t})},Fv[mg.SetActiveCell]=function(e){return e.schedulerState=Object(gu.__assign)(Object(gu.__assign)({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),Se({})},Fv[mg.GetRichValueFieldListContext]=function(e){var t=e.schedulerState,r=e.request,n=r.rangeToQuery,i=r.dotNotationPath,o=r.singleColumn,a=r.findRange;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(gu.__generator)(this,(function(s){switch(s.label){case 0:return e=t.serverDataProvider,N(e)?[2,he(void 0)]:[4,e.getRichValueFieldListContext(n,i,o,a)];case 1:return r=s.sent(),N(r)?[2,Se({result:[]})]:[2,Se({result:r.filter(b)})]}}))}))},Fv[mg.GetHiddenRows]=function(e){var t=e.cache,r=e.request;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0===t?[2,he([])]:[4,t.getHiddenRows(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,Se({result:e})]}}))}))},Fv[mg.GetHiddenCols]=function(e){var t=e.cache,r=e.request;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0===t?[2,he([])]:[4,t.getHiddenCols(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,Se({result:e})]}}))}))},Fv[mg.ResolveReferences]=function(e){var t=e.cache,r=e.request,n=r.locals,i=r.nodes;if(void 0===t||void 0===n||void 0===i)return he(void 0);var o=t.resolveReferences(n,i);return Se({resolverResults:o})},Fv[mg.GetCorrespondingSnapshotID]=function(e){var t=e.cache;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return void 0===t?[2,he(void 0)]:[4,t.getCorrespondingSnapshotID()];case 1:return e=r.sent(),[2,Se({snapshotID:e})]}}))}))},Fv[mg.GetFullTableHeadersFromServer]=function(e){var t=e.schedulerState,r=e.request.tableName;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e,n;return Object(gu.__generator)(this,(function(i){switch(i.label){case 0:return e=t.serverDataProvider,N(e)?[2,he(void 0)]:[4,e.getTableColHeaders(r)];case 1:return n=i.sent(),N(n)?[2,Se({result:[]})]:[2,Se({result:n.filter(b)})]}}))}))},Fv[mg.CreateChatGPTSession]=function(e){var t=e.schedulerState.scheduler,r=e.finalizer,n=e.request.options;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(i){switch(i.label){case 0:return void 0===n?[2,he(void 0)]:[4,t.createChatGPTSession(n)];case 1:return(e=i.sent()).kind===me.Success&&r.subscribe((function(){return t.closeChatGPTSession(e.value)})),[2,wv(e,(function(e){return{result:e}}))]}}))}))},Fv[mg.CloseChatGPTSession]=function(e){var t=e.schedulerState.scheduler,r=e.request.session;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,he(void 0)]:(e=wv,[4,t.closeChatGPTSession(r)]);case 1:return[2,e.apply(void 0,[n.sent(),function(){return{result:void 0}}])]}}))}))},Fv[mg.SendChatGPTRequest]=function(e){var t=e.schedulerState.scheduler,r=e.request,n=r.session,i=r.request;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return void 0===n||void 0===i?[2,he(void 0)]:[4,t.sendChatGPTRequest(n,i)];case 1:return[2,wv(e.sent(),(function(e){return{result:e}}))]}}))}))},Fv);function xv(e,t,r,n,i){var o={request:t,correlationId:r.info.correlationId,cache:n,config:i,schedulerState:r.schedulerState,finalizer:r.finalizer},a=(0,e[t.kind])(o);return a.kind!==me.Success?he(void 0):(r.schedulerState=o.schedulerState,Se(Object(gu.__assign)({kind:t.kind},a.value)))}var Bv=c.priorityQueue.PriorityQueue,Uv=function(){},Gv=function(){function e(){this.dataTransformer=new Bp,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new Hf(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new Wf(this.dataTransformer.document,this.config.localeInfo.stringCompareCI)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),e.prototype.getStateAsNotifications=function(){return Object(gu.__spreadArray)(Object(gu.__spreadArray)(Object(gu.__spreadArray)([],this.configNotifications,!0),this.getSheetStateAsNotifications(),!0),this.getNameStateAsNotifications(),!0)},e.prototype.getSheetStateAsNotifications=function(){var e=[];return this.sheets.forEachSheet((function(t,r){e.push(al(r,t.name))})),e.length>0?[[pg.updateSheetNames,[this.stateId,e]]]:[]},e.prototype.getNameStateAsNotifications=function(){var e=this,t=[],r=function(r){var n=[];r.forEachAvailableName((function(t,r){var i=function(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case xo.Number:return Ol(e.toNumber(r.value));case xo.String:case xo.Boolean:return Ol(r.value.value);case xo.Error:return Ol(r.value.type);default:return}case"NamedFormula":return Al(r.fmla);case"NamedRange":var n=Ge(Ke(t,r.value.sheets.index),r.value.ranges[0]);return Il(kp(n));case"NamedTable":var i=r.specialRefRanges[Mt.Data],o=[];return r.columnIndexes.forEach((function(e,t){return o.push(_l(e,t)),!0})),Fl(kp(i),r.hasHeadersRow,r.hasTotalsRow,o);case"NamedFailure":return r;default:return L("calc.calc.namedObjectToNamedObjectData: kind",r)}}(e.config.mathpack,e.dataTransformer.document,null==r?void 0:r.obj);return n.push(Dl(t,i)),!0})),n.length>0&&t.push(Ll(r.scope.index,n)),r.allAvailable()&&t.push(xl(r.scope.index))},n=this.nameManager.getNamesBySheetId(void 0);return ge(n)&&r(n.value),this.nameManager.forEachSheetScope((function(e){r(e)})),t.length>0?[[pg.updateNamedObjects,[this.stateId,t]]]:[]},e.prototype.trySetStateId=function(e,t){if(t<this.stateId)return!1;if(t>this.stateId){var r=this.stateId;if(this.stateId=t,this.sheets.advanceState(r),this.nameManager.advanceState(r),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=17){this.stateChangesSinceLastGC=0;var n=this.stateId-17;this.nameManager.collectGarbage(n)}}return!0},e.prototype.clearCompiledFormulas=function(){this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){},e.prototype.setA1ReferenceStyle=function(e){this.configNotifications.push([pg.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)},e.prototype.setLocale=function(e){this.configNotifications.push([pg.setLocale,[e]]);this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})},e.prototype.setWorkbookProps=function(e){this.configNotifications.push([pg.setWorkbookProps,[e]]);this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})},e.prototype.updateSheetNames=function(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})},e.prototype.updateNamedObjects=function(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})},e.prototype.setLangConfig=function(e,t){if(this.trySetStateId(!0,e)){var r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}},e.prototype.setSheetNames=function(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))},e.prototype.writeNamedObject=function(e,t,r,n){if(this.trySetStateId(!0,e)){var i=this.nameManager.setNamedObject(!0,De(t,r),n,Uv);ge(i)}},e.prototype.writeUndefinedNames=function(e,t){if(this.trySetStateId(!0,e)){var r=this.nameManager.setUndefinedNames(t);ge(r)}},e.prototype.promoteNamedObjects=function(e,t,r){if(this.trySetStateId(!0,e)){var n=this.nameManager.promoteNamedObjects(t,r);ge(n)&&n.value}},e.prototype.getDocumentLoc=function(e,t){var r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?he(ti([Te(e,t)])):Se(r)},e.prototype.getSheetIndex=function(e,t){var r=this.sheets.getSheetByName(t);return ge(r)?void 0===r.value?r:Se(r.value.sheetIndex.index):r},e.prototype.getSheetName=function(e,t){var r=this.sheets.getSheetById(t);return ge(r)?Se(r.value.name):r},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){return he(Zn(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getContainingTable=function(e){return this.nameManager.getContainingTable(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getTime=function(){return he(ti(["getTime"]))},e}(),Kv=r(89),Vv="".concat(c.PackageName,", ").concat(Ce.PackageName,",\n  ").concat(Ho.PackageName,", ").concat(ua.PackageName,", ").concat(ps.PackageName,", ").concat(Kv.PackageName);var jv,Wv,Hv=function(){function e(e){this.provider=e,this.map=new Map,this.counter=0}return e.prototype.createSession=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return t=this.counter++,[4,this.provider.createChatGPTSession(e)];case 1:return r=n.sent(),b(r)?(this.map.set(t,r),[2,Se(t)]):[2,he(void 0)]}}))}))},e.prototype.closeSession=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:if(void 0===(t=this.map.get(e)))return[2,he(void 0)];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.close()];case 2:return r.sent(),this.map.delete(e),[2,Se(void 0)];case 3:return r.sent(),[2,he(void 0)];case 4:return[2]}}))}))},e.prototype.request=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n;return Object(gu.__generator)(this,(function(i){switch(i.label){case 0:if(void 0===(r=this.map.get(e)))return[2,he(void 0)];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.send(t)];case 2:return n=i.sent(),[2,Se(n)];case 3:return i.sent(),[2,he(void 0)];case 4:return[2]}}))}))},e}(),Qv=function(e){function t(t){var r=e.call(this,"Plugin execution was terminated with '".concat(t,"'."))||this;return r.stopReason=t,r}return Object(gu.__extends)(t,e),t}(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(gu.__extends)(t,e),t}(Error)),qv=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.subject=new Rv,this.isClosed=!1,this.isExtendedPluginRuntimeLogEnabled=pe("OfficeVSO:7624977_addPluginRuntimeToX10Log");for(var r=0,n=e;r<n.length;r++){var i=n[r];this.subscribe(i)}}return e.prototype.subscribe=function(e){if(!this.isClosed)return this.subject.subscribe(e);Ei.ULS.traceTag(509109123,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.PluginFinalizer: subscription for a closed finalizer was requested.")},e.prototype.finalize=function(e,t){var r=this.extractComputationInfo(e);t===Ov.Unknown&&Ei.ULS.traceTag(509109122,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.PluginFinalizer: finalize was invoked with an unknown stop reason. data: ".concat(r)),this.isClosed?Ei.ULS.traceTag(509109121,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.PluginFinalizer: finalizer was invoked more than once. data: ".concat(Object(gu.__assign)({stopReason:t},r))):(this.isClosed=!0,this.finalizePluginGeneratorExecution(e,t),this.subject.next({computationInfo:r,stopReason:t}))},e.prototype.finalizePluginGeneratorExecution=function(e,t){switch(t){case Ov.Unknown:case Ov.UiFrame.Timeout:case Ov.UiFrame.Superseded:case Ov.UiFrame.ConflictResolverEarlyTermination:var r=!1;try{e.generator.throw(new Qv(t))}catch(n){r=!0,n instanceof Qv&&n.stopReason&&(null==n?void 0:n.stopReason)!==t&&Ei.ULS.traceTag(508903693,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.finalizePluginGeneratorExecution: plugin threw an exception during computation. ".concat(JSON.stringify(e.info)))}finally{Ei.ULS.assertTag(508903692,ii.msoulscat_ES_EWAJS,r,"x10arch.finalizePluginGeneratorExecution: plugin terminated by x10 with exception but did not threw the exception back. ".concat(JSON.stringify(e.info)))}break;case Ov.Plugin.Done:case Ov.Plugin.Exception:break;default:L("Unknown stopReason",t)}},e.prototype.extractComputationInfo=function(e){var t,r,n=e.info;if(this.isExtendedPluginRuntimeLogEnabled)for(var i in n.totalRuntime=e.info.pluginTime,e.info.requestTimes)n.totalRuntime+=null!==(r=null===(t=e.info.requestTimes[i])||void 0===t?void 0:t.requestDuration)&&void 0!==r?r:0;return n},e}(),zv=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),Yv=["createChatGPTSession","closeChatGPTSession","sendChatGPTRequest"],Jv=["addResult","addToPluginCount"];f();var Xv={kind:"RequestFailure"},$v={kind:kv.FirstStep},Zv=((jv={})[pg.setActiveCell]=!0,jv[pg.doNothing]=!0,jv),eS=function(){function e(e,t,r,n,i){var o;void 0===r&&(r=Object(gu.__assign)({},gv)),void 0===n&&(n=$g);var a,s=this;this.createPrefetchingCache=t,this.pluginResultWindows=r,this.timer=n,this.parent=i,this.responseStates=_(y(hg).map((function(e){return[e,new Av(e)]}))),this.uiMessages=_(y(hg).map((function(e){return[e,new Rv]}))),this.syncUIMessages=_(y(hg).map((function(e){return[e,new Rv]}))),this.syncMessageQueue=new Bv((function(){return 0})),this.doNotifyStatelessSubject=new Rv,this.doNotifyStatefulSubject=new bv((function(){return s.syncDataModel.getStateAsNotifications()})),this.requestWithCorrelationIdSubject=new Rv,this.syncDataModel=new Gv,this.idFactory=new zv,this.state={scheduler:this},this.notificationProcessorMap=((o={})[pg.setActiveCell]=this.setActiveCellImpl.bind(this),o[pg.setA1ReferenceStyle]=this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),o[pg.setLocale]=this.syncDataModel.setLocale.bind(this.syncDataModel),o[pg.setWorkbookProps]=this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),o[pg.updateSheetNames]=this.syncDataModel.updateSheetNames.bind(this.syncDataModel),o[pg.updateNamedObjects]=this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),o[pg.doNothing]=function(){},o[pg.setFunctionsInfo]=this.setFunctionInfo.bind(this),o[pg.conflictResolverEarlyTermination]=function(e,t){return s.stopPlugins(e,t,Ov.UiFrame.ConflictResolverEarlyTermination)},o[pg.setDefinedNamesInfo]=this.setDefinedNamesInfo.bind(this),o[pg.notifyWorkbookClosing]=this.onWorkbookClosing.bind(this),o),this.notifierObject=Dg(this),this.requesterObject=function(e){var t=function(t){return function(r,n){return N(r)?Promise.resolve(null):Promise.resolve(e.doRequest(t,r,n))}};d();for(var r={},n=0,i=y(hg);n<i.length;n++){var o=i[n];r[o]=t(o)}return r}(this),this.syncRequesterObject=(a=this,{formulaHighlighting:function(e,t){return N(e)?null:a.doSyncRequest(hg.formulaHighlighting,e,t)}}),this.batchRequesterObject=function(e){return{functionSuggestionAndArgumentAssistance:function(t,r){if(N(t))return Promise.resolve(null);var n=t.functionSuggestion,i=t.argumentAssistance,o=t.inCellSuggestion;return N(n)||N(i)||N(o)?Promise.resolve(null):e.doBatchRequest({strategy:iv.FunctionSuggestionAndArgumentAssistance,functionSuggestion:n,argumentAssistance:i,inCellSuggestion:o},r)}}}(this),this.obsoleteRequesterObject={argumentAssistance:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).argumentAssistance.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))},functionSuggestion:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).functionSuggestion.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))},formulaHighlighting:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).formulaHighlighting.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))},runExperiment:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).runExperiment.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))},runAuthoringExperiment:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).runAuthoringExperiment.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))},runTest:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).runTest.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))},chatGPTQuery:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.requesterObject).chatGPTQuery.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))}},this.obsoleteSyncRequesterObject={formulaHighlighting:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.syncRequesterObject).formulaHighlighting.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))}},this.obsoleteBatchRequesterObject={functionSuggestionAndArgumentAssistance:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=s.batchRequesterObject).functionSuggestionAndArgumentAssistance.apply(e,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],t,!1),[Nh.Excel],!1))}},this.notificationQueue=[],this.handleUnavailableFormatEnabled=pe("OfficeVSO:7125313_handleUnavailableFormat"),this.resolveCorrelatedRequestsWithNoPluginsEnabled=pe("OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins"),this.recalcServiceAttachedPromise=new Ch,this.chatGPTProviderAttachedPromise=new Ch,this.pluginFinalizerHandlers=[nS],this.warmupParse=kf((function(){return Object(gu.__awaiter)(s,void 0,void 0,(function(){var e,t,r;return Object(gu.__generator)(this,(function(n){return(e=this.createPrefetchingCache(this.syncDataModel,-1))&&(t=Te(void 0,""),r=Be(Ke(t,0),Ee(1,1)),e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})),[2]}))}))})),M.ULS.traceTag(537796811,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.excelOnlineCalcPackages:  ".concat(Vv)),this.processor=e(this.consumeMessage.bind(this))}return e.prototype.setFunctionInfo=function(e){if(N(e))M.ULS.traceTag(512274762,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.setFunctionInfo functionsInfo was none");else{for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];b(i)&&(t[i.NameDataStrings]=i)}this.state=Object(gu.__assign)(Object(gu.__assign)({},this.state),{functionsInfoMap:t}),M.ULS.traceTag(512274761,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.setFunctionInfo set functionsInfoMap")}},e.prototype.setDefinedNamesInfo=function(e){if(N(e))M.ULS.traceTag(512274760,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.setDefinedNamesInfo definedNamesInfo was none");else{for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];b(i)&&b(i.name)&&(t[i.name.toUpperCase()]=i)}this.state=Object(gu.__assign)(Object(gu.__assign)({},this.state),{definedNamesInfoMap:t}),M.ULS.traceTag(512274759,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.setDefinedNamesInfo set definedNamesInfoMap")}},e.prototype.onWorkbookClosing=function(){Lh.flush()},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}},e.prototype.consumeMessage=function(e){switch(e.kind){case Ng.StepPlugin:this.stepPlugin(e.computation,e.payload);break;case Ng.NoOpRequest:case Ng.SyncRequest:case Ng.AsyncRequest:var t=this.timer.now();this.processRequest(e.computation,e.request),e.computation.info.schedulerTime+=this.timer.now()-t;break;case Ng.StopPlugins:this.stopPlugins(e.correlationId,e.pluginKind,Ov.UiFrame.Timeout);break;default:L("unknown message: ".concat(e),e)}},e.prototype.enqueueMessage=function(t,r){var n=e.abstractStepCosts[t.kind];this.processor.enqueue(t,n,r)},e.prototype.stepPlugin=function(e,t){var r=this.responseStates[e.info.pluginKind].uiMessageFrame;if(e.info.correlationId===(null==r?void 0:r.correlationId))try{var n=this.timer.now(),i=tS(e.generator,t);if(e.info.pluginTime+=this.timer.now()-n,!0!==i.done){var o=i.value;this.enqueueMessage(_v(o,e))}else this.addResultAndFinalizePluginSession(e,{kind:"Successful",message:i.value},Ov.Plugin.Done,r.correlationId)}catch(t){this.addResultAndFinalizePluginSession(e,{kind:"Exception"},Ov.Plugin.Exception,r.correlationId),M.ULS.traceTag(553734791,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.stepPlugin: plugin threw exception: ".concat(t," during computation. ").concat(JSON.stringify(e.info)))}else e.finalizer.finalize(e,e.stopReasonRef.value)},e.prototype.addResultAndFinalizePluginSession=function(e,t,r,n){e.finalizer.finalize(e,r);var i=e.info.pluginFactoryName;return this.addResult(i,t,n)},e.prototype.addResult=function(e,t,r){var n=Vg[e],i=this.responseStates[n].uiMessageFrame;if(!(void 0===i||i.correlationId>r)){switch(M.ULS.assertTag(523360267,ii.msoulscat_ES_EWAJS,i.correlationId===r,"x10arch.addResult: main scheduler corelationID (".concat(i.correlationId,") is less than the child one (").concat(r,"), pluginFactoryName: ").concat(bh[e])),this.parent&&this.parent.addResult(e,t,r),t.kind){case"Successful":i.successfulResults.results.push([e,t.message]);break;case"Exception":i.numFailures+=1;break;case"Skipped":i.numSkippedPlugins+=1;break;default:L("unknown result",t)}(function(e){return e.numFailures+e.numSkippedPlugins+e.successfulResults.results.length})(i)===this.responseStates[n].numPlugins&&this.stopPlugins(i.correlationId,n,Ov.Plugin.Done)}},e.prototype.processRequest=function(e,t){var r,n,i=this,o=this.responseStates[e.info.pluginKind],a=o.uiMessageFrame;if(e.info.correlationId===(null==a?void 0:a.correlationId)){var s=this.timer.now(),l=function(e,t,r,n,i){var o=r.info.correlationId,a=r.schedulerState,s=r.finalizer,l=e[t.kind],u={request:t,correlationId:o,cache:n,config:i,schedulerState:a,finalizer:s},c=l(u);return qh(c,(function(e){return e.kind!==me.Success?he(void 0):(r.schedulerState=u.schedulerState,Se(Object(gu.__assign)({kind:t.kind},e.value)))}))}(Lv,t,e,null===(r=o.uiMessageFrame)||void 0===r?void 0:r.cache,null===(n=o.uiMessageFrame)||void 0===n?void 0:n.config);qh(l,(function(r){if(i.addProcessingTime(e,t.kind,s),r.kind!==me.Success)return i.enqueueMessage({kind:Ng.StepPlugin,computation:e,payload:{kind:kv.RequestFailure}}),void M.ULS.traceTag(538788238,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.processRequest: request returned a scheduler-side failure: ".concat(JSON.stringify(Object(gu.__assign)(Object(gu.__assign)({},e.info),{failedRequest:t.kind}))));i.enqueueMessage({kind:Ng.StepPlugin,computation:e,payload:{kind:kv.NormalResponse,response:r.value}})}),(function(r){i.addProcessingTime(e,t.kind,s),i.enqueueMessage({kind:Ng.StepPlugin,computation:e,payload:{kind:kv.AsyncException,error:r}}),M.ULS.traceTag(540611209,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.processRequest: request processor threw ".concat(JSON.stringify(Object(gu.__assign)(Object(gu.__assign)({},e.info),{failedRequest:t.kind,error:j(r)}))))}))}else e.finalizer.finalize(e,e.stopReasonRef.value)},e.prototype.addProcessingTime=function(e,t,r){var n=this.timer.now(),i=e.info.requestTimes[t];return i?(i.requestDuration=i.requestDuration+n-r,i.numberOfRequests+=1,i.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,numberOfRequests:1,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n},e.prototype.stopPlugins=function(e,t,r){var n,i=this.responseStates[t];e===(null===(n=i.uiMessageFrame)||void 0===n?void 0:n.correlationId)&&i.stop(r,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.chatGPTProviderAttached=function(){return this.chatGPTProviderAttachedPromise.toPromise()},e.prototype.getFunctionsShortDescriptions=function(){return Cv.getValue()},e.prototype.doNotify=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];M.ULS.traceTag(512274758,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.doNotify: received notification of kind:\n       ".concat(e[0],"\n      ")),this.enqueueNotification(e)},e.prototype.enqueueNotification=function(e){var t=this.notificationQueue.length-1,r=this.notificationQueue[t];if(void 0===r)this.notificationQueue.push(e),M.ULS.traceTag(512274757,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.enqueueNotification: queue empty, notification of kind:\n         ".concat(e[0]," pushed to queue\n        "));else{var n=r[0];n===e[0]&&!0===Zv[n]?(this.notificationQueue[t]=e,M.ULS.traceTag(512274756,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.enqueueNotification: notification of kind:\n           ".concat(e[0]," overrode previous notification\n          "))):(this.notificationQueue.push(e),M.ULS.traceTag(512274755,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.enqueueNotification: couldn't coalesce, notification of kind:\n           ".concat(e[0]," pushed to queue\n          ")))}},e.prototype.processNotifications=function(){for(var e=0,t=this.notificationQueue;e<t.length;e++){var r=t[e];M.ULS.traceTag(512274754,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.processNotifications: processing notification of kind:\n         ".concat(r[0],"\n        ")),this.processNotification(r)}this.notificationQueue.length=0},e.prototype.processNotification=function(e){var t,r=e[0],n=e[1];switch((t=this.notificationProcessorMap)[r].apply(t,n),r){case pg.setA1ReferenceStyle:case pg.setLocale:case pg.setWorkbookProps:case pg.updateSheetNames:case pg.updateNamedObjects:this.doNotifyStatefulSubject.next(e);break;default:this.doNotifyStatelessSubject.next(e)}},e.prototype.requestWithCorrelationId=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],n=e[1],i=e[2],o=e[3],a=this.timer.now(),s=this.responseStates[r];s.closeUIMessageFrame(Ov.UiFrame.Superseded,a);var l=this.createPrefetchingCache(this.syncDataModel,i),u=s.createUIMessageFrame(i,l,this.syncDataModel.config,a);return this.resolveCorrelatedRequestsWithNoPluginsEnabled&&0===this.responseStates[r].numPlugins?(Lh.log({kind:"requestSkipped",payload:{requestKind:r}}),u.resolve({kind:Ph.Done,payload:{kind:r,results:[]}})):Lh.log({kind:"beginRequest",payload:{correlationId:i,requestKind:r}}),this.uiMessages[r].next([n,o]),this.enqueueMessage({kind:Ng.StopPlugins,correlationId:i,pluginKind:r},a+this.pluginResultWindows[r].stopDelta),this.requestWithCorrelationIdSubject.next([r,n,i,o]),u},e.prototype.syncRequestWithCorrelationId=function(e,t,r,n){var i,o,a=this.timer.now(),s=this.createPrefetchingCache(this.syncDataModel,r);Lh.log({kind:"beginRequest",payload:{correlationId:r,requestKind:e}}),this.syncUIMessages[e].next([t,r,n]);var l=a+this.pluginResultWindows[e].stopDelta,u=this.runToCompletion(s,this.syncDataModel.config,l),c=u[0],d=u[1],f={startTime:a,stopTime:this.timer.now(),pluginKind:e,correlationId:r,numPlugins:this.responseStates[e].numPlugins,numSyncPlugins:this.responseStates[e].numSyncPlugins,numSkippedPlugins:null!==(o=null===(i=this.responseStates[e].uiMessageFrame)||void 0===i?void 0:i.numSkippedPlugins)&&void 0!==o?o:0,numSent:d.length,stopReason:c};return Lh.log({kind:"closeUIMessageFrame",payload:f}),{kind:e,results:d}},e.prototype.runToCompletion=function(e,t,r){for(var n=[],i=this.timer.now(),o=this.syncMessageQueue.pop();void 0!==o;o=this.syncMessageQueue.pop(),i=this.timer.now()){if(i>=r){o.computation.finalizer.finalize(o.computation,Ov.UiFrame.Timeout);break}var a=void 0;switch(o.kind){case Ng.StepPlugin:var s=o.computation,l=o.payload;try{var u=tS(s.generator,l);if(s.info.pluginTime+=this.timer.now()-i,!0!==u.done){var c=u.value;this.syncMessageQueue.enqueue(Iv(c,s))}else s.finalizer.finalize(s,Ov.Plugin.Done),n.push([s.info.pluginFactoryName,u.value])}catch(e){M.ULS.traceTag(538581056,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.FormulaBarScheduler.runToCompletion: plugin threw exception during computation. ".concat(JSON.stringify(s.info))),s.finalizer.finalize(s,Ov.Plugin.Exception)}break;case Ng.NoOpRequest:case Ng.SyncRequest:var d=xv(Lv,o.request,o.computation,e,t);a=this.addProcessingTime(o.computation,o.request.kind,i),o.computation.info.schedulerTime+=a-i,d.kind===me.Success?this.syncMessageQueue.enqueue({kind:Ng.StepPlugin,computation:o.computation,payload:{kind:kv.NormalResponse,response:d.value}}):(M.ULS.traceTag(538469328,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.FormulaBarScheduler.runToCompletion: request returned a scheduler-side failure: ".concat(JSON.stringify(Object(gu.__assign)(Object(gu.__assign)({},o.computation.info),{failedRequest:o.request.kind})))),this.syncMessageQueue.enqueue({kind:Ng.StepPlugin,computation:o.computation,payload:{kind:kv.RequestFailure}}));break;default:L("unknown message: ".concat(o),o)}}return this.syncMessageQueue.clear(),[i<r?Ov.Plugin.Done:Ov.UiFrame.Timeout,n]},e.prototype.doRequest=function(e,t,r){return this.processNotifications(),this.doRequestUntyped(e,t,r)},e.prototype.doRequestUntyped=function(e,t,r){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(gu.__generator)(this,(function(a){switch(a.label){case 0:return this.resolveCorrelatedRequestsWithNoPluginsEnabled||0!==this.responseStates[e].numPlugins?(i=this.idFactory.create(),n=this.requestWithCorrelationId(e,t,i,r)):(Lh.log({kind:"requestSkipped",payload:{requestKind:e}}),(n=new Ch).resolve({kind:Ph.Done,payload:{kind:e,results:[]}})),[4,this.resolveConflicts(n)];case 1:return(o=a.sent()).kind===Ph.Superseded?[2,o]:[2,Object(gu.__assign)(Object(gu.__assign)({},o),{payload:o.payload.result})]}}))}))},e.prototype.doSyncRequest=function(e,t,r){return this.processNotifications(),this.doSyncRequestUntyped(e,t,r)},e.prototype.doSyncRequestUntyped=function(e,t,r){var n;if(0===this.responseStates[e].numSyncPlugins)Lh.log({kind:"requestSkipped",payload:{requestKind:e}}),n={kind:e,results:[]};else{var i=this.idFactory.create();n=this.syncRequestWithCorrelationId(e,t,i,r)}return this.syncResolveConflicts(n).result},e.prototype.resolveConflicts=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t;return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return(t=r.sent()).kind===Ph.Superseded?[2,t]:[2,{kind:Ph.Done,payload:this.syncResolveConflicts(t.payload)}]}}))}))},e.prototype.syncResolveConflicts=function(e){var t=e.results.filter((function(e){var t=e[1];return b(t)}));return{kind:e.kind,result:lv[e.kind](t)}},e.prototype.doBatchRequest=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u,c,d,f;return Object(gu.__generator)(this,(function(p){switch(p.label){case 0:for(this.processNotifications(),r=this.idFactory.create(),n=fv[e.strategy],i=hv[e.strategy].create(),o=n.map((function(){return!0})),a=new Ch,s=function(s){var u=n[s],c=e[u],d=l.requestWithCorrelationId(u,c,r,t);l.resolveConflicts(d).then((function(e){if(o[s]=!1,e.kind===Ph.Superseded)a.resolve({kind:Ph.Superseded});else{var t=e.payload;i.consumeResult(t)}}),(function(){M.ULS.traceTag(553734794,ii.msoulscat_ES_EWAJS,ci.Error,'x10arch.doBatchRequest: Custom conflict resolver "'.concat(e.strategy,'" got an exception for plugin kind "').concat(u,'". Skipping kind.')),o[s]=!1,i.consumeResult({kind:u,result:null})}))},l=this,d=0;d<n.length;d+=1)s(d);return u=qh(i.promise,(function(e){return{kind:Ph.Done,payload:e}})),[4,Promise.race([a,u])];case 1:for(c=p.sent(),d=0;d<n.length;d+=1)f=n[d],o[d]&&(this.doNotify(pg.conflictResolverEarlyTermination,[r,f]),this.processNotifications());return[2,c]}}))}))},e.prototype.notifier=function(){return this.notifierObject},e.prototype.requester=function(){return this.obsoleteRequesterObject},e.prototype.getRequester=function(){return this.requesterObject},e.prototype.syncRequester=function(){return this.obsoleteSyncRequesterObject},e.prototype.getSyncRequester=function(){return this.syncRequesterObject},e.prototype.batchRequester=function(){return this.obsoleteBatchRequesterObject},e.prototype.getBatchRequester=function(){return this.batchRequesterObject},e.prototype.setServerDataProvider=function(e){N(e)||(this.state=Object(gu.__assign)(Object(gu.__assign)({},this.state),{serverDataProvider:e}))},e.prototype.setActiveCellImpl=function(e){if(N(e.docName)||N(e.sheetIndex))M.ULS.traceTag(553734796,ii.msoulscat_ES_EWAJS,ci.Warning,"x10arch.setActiveCellImpl early exit, some of the arguments is None");else{var t=Te(void 0,""),r=Qe(e.rowIndex,e.colIndex,1,1),n=Be(Ke(t,e.sheetIndex),r),i=null;N(e.formatString)||N(e.builtIn)||(i={formatString:e.formatString,builtIn:e.builtIn}),this.handleUnavailableFormatEnabled?this.state=Object(gu.__assign)(Object(gu.__assign)({},this.state),{activeCell:n,activeCellFormat:i}):(this.state=Object(gu.__assign)(Object(gu.__assign)({},this.state),{activeCell:n}),N(e.formatString)||N(e.builtIn)||(this.state=Object(gu.__assign)(Object(gu.__assign)({},this.state),{activeCellFormat:i}))),M.ULS.traceTag(512274752,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.setActiveCellImpl updated activeCell to col: ".concat(n.range.col,", row: ").concat(n.range.row))}},e.prototype.getConfig=function(){return this.syncDataModel.config},e.prototype.createAndAttachPlugin=function(e,t){var r=this;this.parent&&this.warmupParse.getValue();var n=e.create(t),i=Vg[e.factoryName];this.uiMessages[i].subscribe((function(t){var o=t[0],a=t[1],s=r.responseStates[i].uiMessageFrame;if(D("`frame` should be always defined at this point",void 0!==s),rS(e.factoryName,a)){var l=n.run(o,Pv);r.enqueueMessage({kind:Ng.StepPlugin,computation:{info:{correlationId:s.correlationId,pluginKind:i,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0,requestTimes:{}},generator:l,finalizer:new(qv.bind.apply(qv,Object(gu.__spreadArray)([void 0],r.pluginFinalizerHandlers,!1))),stopReasonRef:s.stopReasonRef,schedulerState:r.state,lastTimestamp:r.timer.now()},payload:$v},s.startTime+r.pluginResultWindows[i].startDelta)}else r.addResult(e.factoryName,{kind:"Skipped"},s.correlationId)})),M.ULS.traceTag(545378970,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.createAndAttachPlugin: ".concat(bh[e.factoryName]," was attached.")),this.addToPluginCount(i,1)},e.prototype.createAndAttachSyncPlugin=function(e,t){var r=this,n=e.create(t),i=Vg[e.factoryName];this.syncUIMessages[i].subscribe((function(t){var o=t[0],a=t[1],s=t[2];if(rS(e.factoryName,s)){var l=n.run(o,Dv);r.syncMessageQueue.enqueue({kind:Ng.StepPlugin,computation:{info:{correlationId:a,pluginKind:i,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0,requestTimes:{}},generator:l,finalizer:new(qv.bind.apply(qv,Object(gu.__spreadArray)([void 0],r.pluginFinalizerHandlers,!1))),stopReasonRef:new Nv(Ov.Unknown),schedulerState:r.state,lastTimestamp:r.timer.now()},payload:$v})}})),M.ULS.traceTag(538581058,ii.msoulscat_ES_EWAJS,ci.Info,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ".concat(bh[e.factoryName]," was attached.")),this.responseStates[i].numSyncPlugins+=1},e.prototype.addToPluginCount=function(e,t){this.parent&&this.parent.addToPluginCount(e,t),this.responseStates[e].numPlugins+=t},e.prototype.registerAsyncGrid=function(){this.recalcServiceAttachedPromise.resolve(void 0)},e.prototype.registerChatGPTProvider=function(e){var t=new Hv(e);return this.chatGPTProviderAttachedPromise.resolve(t)},e.prototype.createChatGPTSession=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return void 0!==this.parent?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return[2,t.sent().createSession(e)];case 2:return[2,this.parent.createChatGPTSession(e)]}}))}))},e.prototype.closeChatGPTSession=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return void 0!==this.parent?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return[2,t.sent().closeSession(e)];case 2:return[2,this.parent.closeChatGPTSession(e)]}}))}))},e.prototype.sendChatGPTRequest=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return void 0!==this.parent?[3,3]:[4,this.chatGPTProviderAttached()];case 1:return[4,n.sent().request(e,t)];case 2:return(r=n.sent()).kind!==me.Success||b(r.value)?[2,r]:[2,he(void 0)];case 3:return[2,this.parent.sendChatGPTRequest(e,t)]}}))}))},e.abstractStepCosts=((Wv={})[Ng.NoOpRequest]=.01,Wv[Ng.AsyncRequest]=.1,Wv[Ng.SyncRequest]=.5,Wv[Ng.StepPlugin]=1,Wv[Ng.StopPlugins]=.01,Wv),e}();function tS(e,t){switch(t.kind){case kv.FirstStep:return e.next();case kv.NormalResponse:return e.next(t.response);case kv.AsyncException:case kv.RequestFailure:return e.next(Xv);default:L("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}function rS(e,t){var r;return null!==(r=Jg[t][e])&&void 0!==r?r:Yg[t]}function nS(e){Lh.log({kind:"pluginStoppedExecution",payload:{pluginName:bh[e.computationInfo.pluginFactoryName],stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===Ov.Plugin.Done&&Lh.log({kind:"pluginCompletedInTime",payload:{pluginName:bh[e.computationInfo.pluginFactoryName],logInfo:e.computationInfo}})}var iS=function(){function e(e){this.onGridReady=e,this.gridService=void 0}return e.prototype.getGrid=function(){var e;return null===(e=this.gridService)||void 0===e?void 0:e.call},e.prototype.createIGridImportEndpoint=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t,r=this;return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return this.onGridExporterClosed(),[4,vu.Endpoint.createOutside(e,(function(e){r.gridService={call:void 0,close:function(){return e.close("Force")}}}))];case 1:return(t=n.sent()).hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call)),[2]}}))}))},e.prototype.onGridExporterClosed=function(){if(this.gridService){var e=this.gridService;this.gridService=void 0,e.close()}},e}();function oS(e,t,r){var n=new MessageChannel,i=n.port1,o=n.port2;Promise.all([e.createIGridImportEndpoint({port:o,options:r}),t.createIGridExportEndpoint({port:i,options:r},(function(){return e.onGridExporterClosed()}))]).catch((function(t){M.ULS.traceTag(540674071,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,"x10arch.connectGridImporterExporter: ".concat(j(t)));try{e.onGridExporterClosed()}catch(t){M.ULS.traceTag(540644190,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,"x10arch.connectGridImporterExporter: importer threw ".concat(j(t)))}}))}var aS=function(){function e(e){this.timeout=e,this.exporter=void 0,this.importers=[]}return e.prototype.onGridExporterCreated=function(e){this.exporter=e;for(var t=0,r=this.importers;t<r.length;t++){var n=r[t];oS(n.importer,e,{id:n.id,createTimeout:this.timeout})}},e.prototype.onGridImporterCreated=function(e,t){this.importers.push({importer:e,id:t}),this.exporter&&oS(e,this.exporter,{id:t,createTimeout:this.timeout})},e}(),sS=Kg.Stable,lS=function(){function e(e,t){if(this.threadId=e,!(t instanceof eS))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ".concat(JSON.stringify(t)));this.scheduler=t}return e.prototype.loadPluginScriptTrace=function(e,t){var r="x10arch.loadPluginScript: ".concat(e," loaded on ").concat(this.threadId,", time to load ").concat(t);M.ULS.traceTag(553734797,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,r)},e.prototype.createAndAttachPlugin=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r;return Object(gu.__generator)(this,(function(n){return r=qg(e,sS),this.scheduler.createAndAttachPlugin(r,t),[2]}))}))},e.prototype.createAndAttachSyncPlugin=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r;return Object(gu.__generator)(this,(function(n){return r=qg(e,sS),this.scheduler.createAndAttachSyncPlugin(r,t),[2]}))}))},e}(),uS=function(e){function t(t,r,n,i){var o=e.call(this,"Main",n)||this;o.threadEntryPoint=t,o.gridManager=r,o.loader=i;var a=i.getConfig();return o.resolveScript=a.resolveScript,o}return Object(gu.__extends)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i;return Object(gu.__generator)(this,(function(o){switch(o.label){case 0:return N(e)||N(t)?[2]:(n=(r=$g).now(),[4,this.loader.loadScript(e)]);case 1:return o.sent(),i=r.now()-n,this.loadPluginScriptTrace(e,i),[2]}}))}))},t.prototype.isThreadingSupported=function(){return vu.isThreadingSupported()&&void 0!==ki()},t.prototype.createPluginThread=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u=this;return Object(gu.__generator)(this,(function(c){switch(c.label){case 0:return r="DynamicPluginLoaderThread-".concat(t.lastThreadNum+=1,"-").concat(e),n="".concat(r,"-IGrid"),[4,Ii];case 1:return c.sent(),[4,vu.createWorker({createMode:"Thread",id:r},vu.paramInsideDef({scriptUrl:Oi(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(function(){return Object(gu.__assign)(Object(gu.__assign)({},function(e,t){for(var r={},n=function(t){r[t]=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e[t].apply(e,r)}},i=0,o=t;i<o.length;i++){n(o[i])}return r}(u.scheduler,Object(gu.__spreadArray)(Object(gu.__spreadArray)([],Yv,!0),Jv,!0))),{resolveScript:u.resolveScript})}))];case 2:i=c.sent(),c.label=3;case 3:return c.trys.push([3,5,,6]),o=function(){},i.onClose=function(){o();var e="x10arch.DynamicPluginLoader: ".concat(r," closed");M.ULS.traceTag(553734798,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,e)},[4,Fi(i)];case 4:return a=c.sent(),o=function(){return a.close()},this.scheduler.doNotifyStatelessSubject.subscribe((function(e){return i.post.processNotification(e)})),this.scheduler.requestWithCorrelationIdSubject.subscribe((function(e){var t;return(t=i.post).requestWithCorrelationId.apply(t,e)})),this.scheduler.doNotifyStatefulSubject.subscribe((function(e){return i.post.processNotification(e)})),s={createIGridImportEndpoint:function(e){return i.call.createIGridImportEndpoint.transfer([e.port],e)},onGridExporterClosed:i.post.onGridExporterClosed},this.gridManager.onGridImporterCreated(s,n),[2,new cS(i)];case 5:throw l=c.sent(),i.close(),l;case 6:return[2]}}))}))},t.lastThreadNum=0,t}(lS),cS=function(){function e(e){this.outside=e}return e.prototype.loadPluginScript=function(e,t){return this.outside.call.loadPluginScript(e,t)},e.prototype.createAndAttachPlugin=function(e,t){return this.outside.call.createAndAttachPlugin(e,t)},e.prototype.createAndAttachSyncPlugin=function(e,t){return this.outside.call.createAndAttachSyncPlugin(e,t)},e.prototype.recalcServiceAttached=function(){return this.outside.call.recalcServiceAttached()},e.prototype.close=function(){this.outside.close()},e}(),dS=function(e){function t(t,r,n,i,o){var a=e.call(this,t,n)||this;return a.gridImporter=r,a.twConfig=i,a.inside=o,a.loadedScripts=g(),a.initCalcThreadInside=function(e,t,r){return Object(gu.__awaiter)(a,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(n){switch(n.label){case 0:return[4,_i(e,t,r,this.twConfig)];case 1:return n.sent(),[2]}}))}))},a.createIGridImportEndpoint=a.gridImporter.createIGridImportEndpoint.bind(a.gridImporter),a.onGridExporterClosed=a.gridImporter.onGridExporterClosed.bind(a.gridImporter),a.processNotification=a.scheduler.processNotification.bind(a.scheduler),a.requestWithCorrelationId=a.scheduler.requestWithCorrelationId.bind(a.scheduler),Wg=t,a}return Object(gu.__extends)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a;return Object(gu.__generator)(this,(function(s){switch(s.label){case 0:return N(e)||N(t)||!0===this.loadedScripts[e]?[2]:(n=(r=$g).now(),o=(i=vu).importScriptsWithRetry,[4,this.inside.call.resolveScript({identifier:e,isLocalized:t})]);case 1:return o.apply(i,[[s.sent()],Di]),a=r.now()-n,this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,a),[2]}}))}))},t.prototype.recalcServiceAttached=function(){return this.scheduler.recalcServiceAttached()},t}(lS),fS=function(){function e(t,r,n,i){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,ge(r)&&(this.values=e.buildSparseMatrix(r.value.nonEmptyCells,(function(e){return e})),this.valueAvailabilitySet=e.unionRanges(r.value.availableRanges)),ge(i)&&(this.formats=e.buildSparseMatrix(i.value.nonEmptyCells,(function(e){return e})),this.formatAvailabilitySet=e.unionRanges(i.value.availableRanges)),ge(n)&&(this.formulae=e.buildSparseMatrix(n.value.nonEmptyCells,(function(e){return e})),this.formulaAvailabilitySet=e.unionRanges(n.value.availableRanges))}return e.buildSparseMatrix=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++)for(var o=i[n],a=o[0],s=a[0],l=a[1],u=a[2],c=void 0===u?1:u,d=a[3],f=void 0===d?1:d,p=o.slice(1),m=p.length,h=l,g=0;h<l+f;h+=1)for(var v=s;v<s+c;v+=1,g=(g+1)%m)void 0===r[v]&&(r[v]=[]),r[v][h]=t(p[g],v,h);return r},e.forEachInSparseMatrix=function(e,t,r){void 0===r&&(r=function(){return!1});var n=!0;return e.forEach((function(e,i){n&&e.forEach((function(e,o){n&&(r(e)||t(Ee(i,o),e)||(n=!1))}))})),n},e.unionRanges=function(e){return e.map(Qu).reduce(Mu,ku)},e.prototype.getCellValue=function(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?Se(this.values[e][t]):Se(ng):he(ti(["getCellValue"]))},e.prototype.getCellFormat=function(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?Se(this.formats[e][t]):Se(tg):he(ti(["getCellFormat"]))},e.prototype.getCellFormula=function(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?Se(this.formulae[e][t]):Se(rg):he(ti(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(t){return void 0===this.values||e.forEachInSparseMatrix(this.values,t,(function(e){return e.kind===xo.Blank}))},e.prototype.foreachNonBlankCellFormula=function(t){return void 0===this.formulae||e.forEachInSparseMatrix(this.formulae,t,(function(e){return e.kind===rg.kind&&e.formulaBarText===rg.formulaBarText}))},e.prototype.isAvailable=function(e,t,r){var n,i;switch(r){case"value":i=this.valueAvailabilitySet;break;case"formula":i=this.formulaAvailabilitySet;break;case"format":i=this.formatAvailabilitySet;break;default:L("isAvailable",r)}return void 0!==i&&(null!==(n=Lu(Qu(Ee(e,t)),i))&&void 0!==n?n:1)<=0},e}();function pS(e){var t=e.hasHeadersRow,r=e.hasTotalsRow,n=e.dataRange;return ke(n.row-Number(t),n.col,n.rows+Number(t)+Number(r),n.cols)}function mS(e,t,r,n){for(var i=t.name,o=t.hasHeadersRow,a=t.hasTotalsRow,s=t.dataRange,l=t.columns,u=o?ke(s.row-1,s.col,1,s.cols):void 0,c=a?ke(s.row+s.rows,s.col,1,s.cols):void 0,d={},f=_f.create(e.stringCompareCI),p=0,m=l;p<m.length;p++){var h=m[p];d[h.column]=h,f=f.setValue(h.name,h)}return{name:i,sheet:r,dataRange:s,headersRange:u,totalsRange:c,allRange:n,indexToColumn:d,nameToColumn:f,allColumnNamesAvailable:l.length===s.cols}}function hS(e,t){var r;return(null!==(r=Lu(Qu(t),e))&&void 0!==r?r:1)<=0}d();var gS=he(ti(["getCell"])),vS=he(ti(["getContainingTable"])),SS=he(ti(["getIntersectingTables"])),yS=he(ti(["getIntersectingTableNames"])),CS=he(ti(["getIformats"])),RS=he(ti(["GetAvailableTableHeaders"]));function bS(e,t){var r=Object.create(e);for(var n in t)r[n]=t[n];return r}var NS=function(){function e(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.correspondingSnapshotID=-1,this.sheet2contents=g(),this.currentDocumentLoc=Te(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=Jo(t),this.analyzer=aa(t),this.formatter=as(t),this.resolver=wi(t);var n=bS(t,{config:bS(t.config,{localeInfo:vi()})});this.englishParser=Jo(n),this.englishAnalyzer=aa(n)}return e.getOrFetchTile=function(t,r,n){var i=r.range.row>>>e.tileHeightPow,o=r.range.col>>>e.tileWidthPow;void 0===t[i]&&(t[i]=[]);var a=t[i][o];return void 0===a?n(Ge(r.sheet,ke(i<<e.tileHeightPow,o<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow))).then((function(e){return t[i][o]=e})):a},e.create=function(t,r,n){return new e(t,r,n)},e.prototype.getSheetContents=function(e){var t;return null!==(t=this.sheet2contents[e])&&void 0!==t?t:this.sheet2contents[e]={cellTiles:[],tables:hc(),tableTiles:[],hiddenRows:ku,hiddenRowsAvailability:ku,hiddenCols:ku,hiddenColsAvailability:ku}},e.prototype.getCurrentDocumentLoc=function(){return this.currentDocumentLoc},e.prototype.getSheetNames=function(){if(void 0===this.sheetNames){var e=[];this.syncDataStore.sheets.forEachSheet((function(t){e.push({sheetIndex:t.sheetIndex,sheetName:t.name})}));for(var t={},r=_f.create(this.syncDataStore.config.localeInfo.stringCompareCI),n=0;n<e.length;n+=1){var i=e[n],o=i.sheetIndex,a=i.sheetName;t[o.index]=n,r=r.setValue(a,n)}var s=this.getCurrentDocumentLoc();this.sheetNames={document:s,sheets:e,idToIndex:t,nameToIndex:r}}return Se(this.sheetNames)},e.prototype.getRangeValues=function(e){return this.grid.getRangeValues(this.correlationId,e)},e.prototype.getRangeFormulae=function(e){return this.grid.getRangeFormulae(this.correlationId,e)},e.prototype.getRangeFormats=function(e){return this.grid.getRangeFormats(this.correlationId,e)},e.prototype.getHiddenRows=function(e,t,r){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return n=this.getSheetContents(e.index),i=Hu.row([t,r]),o=Pu(i,n.hiddenRowsAvailability),0===o||-1===o?[3,2]:[4,this.grid.getHiddenRows(this.correlationId,e,E(0,t-10),P(We,r+10))];case 1:a=u.sent(),n.hiddenRows=a.hidden.reduce((function(e,t){var r=t.start,n=t.end;return bu(e,Hu.row([r,n]))}),n.hiddenRows),n.hiddenRowsAvailability=a.available.reduce((function(e,t){var r=t.start,n=t.end;return bu(e,Hu.row([r,n]))}),n.hiddenRowsAvailability),u.label=2;case 2:return s=[],ec(Nu(n.hiddenRowsAvailability,i),(function(e){var t=e[0],r=e[1];return s.push(Ls(t,r)),!0})),l=[],ec(Nu(n.hiddenRows,i),(function(e){var t=e[0],r=e[1];return l.push(Ls(t,r)),!0})),[2,{available:s,hidden:l}]}}))}))},e.prototype.getHiddenCols=function(e,t,r){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return n=this.getSheetContents(e.index),i=Hu.col([t,r]),o=Pu(i,n.hiddenColsAvailability),0===o||-1===o?[3,2]:[4,this.grid.getHiddenCols(this.correlationId,e,E(0,t-10),P(xe,r+10))];case 1:a=u.sent(),n.hiddenCols=a.hidden.reduce((function(e,t){var r=t.start,n=t.end;return bu(e,Hu.col([r,n]))}),n.hiddenCols),n.hiddenColsAvailability=a.available.reduce((function(e,t){var r=t.start,n=t.end;return bu(e,Hu.col([r,n]))}),n.hiddenColsAvailability),u.label=2;case 2:return s=[],tc(Nu(n.hiddenColsAvailability,i),(function(e){var t=e[0],r=e[1];return s.push(Ls(t,r)),!0})),l=[],tc(Nu(n.hiddenCols,i),(function(e){var t=e[0],r=e[1];return l.push(Ls(t,r)),!0})),[2,{available:s,hidden:l}]}}))}))},e.prototype.getRange=function(e,t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u;return Object(gu.__generator)(this,(function(c){switch(c.label){case 0:return r=void 0===t||t.indexOf("values")>-1,n=void 0===t||t.indexOf("formulae")>-1,i=void 0===t||t.indexOf("formats")>-1,o=he(ti(["getRange"])),[4,Promise.all([r?this.getRangeValues(e):o,n?this.getRangeFormulae(e):o,i?this.getRangeFormats(e):o])];case 1:return a=c.sent(),s=a[0],l=a[1],u=a[2],[2,new fS(e.sheet,s,l,u)]}}))}))},e.prototype.getCell=function(t){var r=this,n=this.getSheetContents(t.sheet.index),i=e.getOrFetchTile(n.cellTiles,t,(function(e){return Object(gu.__awaiter)(r,void 0,void 0,(function(){var r,n,i,o,a;return Object(gu.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,e)];case 1:return a=[s.sent()],[4,this.grid.getRangeFormulae(this.correlationId,e)];case 2:return a=a.concat([s.sent()]),[4,this.grid.getRangeFormats(this.correlationId,e)];case 3:return r=a.concat([s.sent()]),n=r[0],i=r[1],o=r[2],ge(n)&&ge(i)&&ge(o)?[2,new fS(t.sheet,n,i,o)]:[2,"unavailable"]}}))}))}));return qh(i,(function(e){if("unavailable"===e)return gS;var r=e.getCellValue(t.range.row,t.range.col),n=e.getCellFormula(t.range.row,t.range.col),i=e.getCellFormat(t.range.row,t.range.col);return ge(r)&&ge(n)&&ge(i)?Se({value:r.value,formula:n.value,format:i.value}):gS}))},e.prototype.getAvailableTableHeaders=function(e){var t=this.syncDataStore.nameManager;if(!t)return RS;var r=t.getAllDocumentNames().find((function(t){return t.name===e}));if(!r)return RS;var n=t.getAvailableTableColumns(r);return Se(n)},e.prototype.getStructRefColumn=function(e,t){var r=this.syncDataStore.getStructRefColumn(e,t);return r.kind===me.Failure?he(ti(["getStructRefColumn"])):r},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.syncDataStore.getStructRefSpecialRef(e,t);return r.kind===me.Failure?he(ti(["getStructRefSpecialRef"])):r},e.prototype.getContainingTableName=function(e){var t=this.syncDataStore.getContainingTable(e);return t.kind===me.Failure?he(ti(["getContainingTableName"])):t},e.prototype.getContainingTable=function(t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i=this;return Object(gu.__generator)(this,(function(o){return r=this.getSheetContents(t.sheet.index),n=e.getOrFetchTile(r.tableTiles,t,(function(e){return Object(gu.__awaiter)(i,void 0,void 0,(function(){var n,i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,e)];case 1:if(n=u.sent(),!ge(n))return[2,"unavailable"];for(i=n.value.availableRanges.map(Qu).reduce(Mu,ku),o=0,a=n.value.tables;o<a.length;o++)s=a[o],l=pS(s),r.tables.getValue(l)||(r.tables=r.tables.setValue(l,mS(this.syncDataStore.config.localeInfo,s,t.sheet,l)));return[2,i]}}))}))})),[2,qh(n,(function(e){return"unavailable"===e?vS:(r.tables.forEachGe(t.range,(function(e,t){return n=t,!1})),void 0!==n||hS(e,t.range)?Se(n):vS);var n}))]}))}))},e.prototype.getIntersectingTables=function(t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u,c,d,f=this;return Object(gu.__generator)(this,(function(p){switch(p.label){case 0:r=this.getSheetContents(t.sheet.index),n=ku,i=t.range.row,o=t.range.row+t.range.rows,p.label=1;case 1:if(!(i<o))return[3,8];a=t.range.col,s=t.range.col+t.range.cols,p.label=2;case 2:return a<s?(l=e.getOrFetchTile(r.tableTiles,Be(t.sheet,Ee(i,a)),(function(e){return f.fetchTableTile(e.sheet,r,e)})),zh(l)?[4,l]:[3,4]):[3,7];case 3:return c=p.sent(),[3,5];case 4:c=l,p.label=5;case 5:if("unavailable"===(u=c))return[2,SS];n=Mu(n,u),p.label=6;case 6:return a+=1<<e.tileWidthPow,[3,2];case 7:return i+=1<<e.tileHeightPow,[3,1];case 8:return d=[],r.tables.forEachMeets(t.range,(function(e,t){return d.push(t),n=Mu(n,Qu(e)),!0})),[2,hS(n,t.range)?Se(d):SS]}}))}))},e.prototype.getIntersectingTableNames=function(e){if(void 0===this.syncDataStore.nameManager)return yS;var t=this.syncDataStore.nameManager.getIntersectingTables(e);return t.kind===me.Failure?yS:t},e.prototype.fetchTableTile=function(e,t,r){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,r)];case 1:if(n=u.sent(),!ge(n))return[2,"unavailable"];for(i=n.value.availableRanges.map(Qu).reduce(Mu,ku),o=0,a=n.value.tables;o<a.length;o++)s=a[o],l=pS(s),t.tables.getValue(l)||(t.tables=t.tables.setValue(l,mS(this.syncDataStore.config.localeInfo,s,e,l)));return[2,i]}}))}))},e.prototype.getIformat=function(t,r){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,l,u,c,d,f;return Object(gu.__generator)(this,(function(p){switch(p.label){case 0:return n=r>>>e.formatPagePow,i=n<<e.formatPagePow,o=i+(1<<e.formatPagePow),void 0!==(a=this.formatPages[n])?[3,2]:[4,this.grid.getIformats(this.correlationId,t,i,o)];case 1:if(s=p.sent(),ge(s)){for(l=[],u=0,c=s.value.availableFormats;u<c.length;u++)(d=c[u]).iformat<i||d.iformat>=o||(l[d.iformat-i]=d);a=this.formatPages[n]=l}else a=this.formatPages[n]="unavailable";p.label=2;case 2:return"unavailable"===a||void 0===(f=a[r-i])?[2,CS]:[2,Se(f)]}}))}))},e.prototype.parseCellFormula=function(t,r,n){return{result:e.cachedParseFormula(n?this.englishFormulaCache:this.formulaCache,n?this.englishParser:this.parser,n?this.englishAnalyzer:this.analyzer,t,r)}},e.prototype.parseEdit=function(e,t){var r;return Object(gu.__awaiter)(this,void 0,void 0,(function(){var n;return Object(gu.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getEditFormat(e)];case 1:return n=null!==(r=i.sent())&&void 0!==r?r:{valueType:va.General,bidiDate:void 0,culture:void 0},[2,this.parseEditInternal(e,t,n)]}}))}))},e.prototype.parseEditSync=function(e,t,r){var n,i=this.parseNumberFormat(r.formatString,r.builtIn).result;return n=ge(i)?i.value:{valueType:va.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,n)},e.prototype.resolveReferences=function(e,t){var r=this;return t.map((function(t){switch(t.kind){case At.StructRef:return r.resolveStructRefSync(e,t).result;case At.CellRef:return r.resolveCellRefNodeSync(e,t).result}}))},e.prototype.getCorrespondingSnapshotID=function(){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return-1!==this.correspondingSnapshotID?[3,2]:(e=this,[4,this.grid.getCorrespondingSnapshotID(this.correlationId)]);case 1:e.correspondingSnapshotID=t.sent(),t.label=2;case 2:return[2,this.correspondingSnapshotID]}}))}))},e.prototype.parseEditInternal=function(t,r,n){var i=this.formatter.parseEdit(r,n);if(!ge(i))return{result:i};if(i.value.kind===ma.String&&"="===r&&n.valueType!==va.Text&&(i=Se(Fa(r))),i.value.kind!==ma.Formula)return{result:Se(i.value)};var o=e.parseCheckedFormula(this.parser,this.analyzer,t,i.value.fmla,t.range);return ge(o)?{result:Se({kind:ma.Formula,fmla:i.value.fmla,formula:o.value})}:{result:o}},e.prototype.getEditFormat=function(e){return Object(gu.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i,o,a;return Object(gu.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.getCell(e)];case 1:return t=s.sent(),ge(t)?"string"!=typeof t.value.format?[3,2]:(r=this.parseNumberFormat(t.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(e.sheet.document,t.value.format)];case 3:if(n=s.sent(),!ge(n))return[2,void 0];i=n.value,o=i.formatString,a=i.builtIn,r=this.parseNumberFormat(o,a).result,s.label=4;case 4:return[2,ge(r)?r.value:void 0]}}))}))},e.cachedParseFormula=function(t,r,n,i,o){var a,s=t.get(o);if(void 0!==s)return s;var l=e.parseWellFormedFormula(r,n,i,o.formulaBarText,null!==(a=o.origin)&&void 0!==a?a:i.range);return t.set(o,l),l},e.parseWellFormedFormula=function(t,r,n,i,o){var a=e.parseCheckedFormula(t,r,n,i,o);return ge(a)?Xn(a.value)?Se(a.value):he(ws("ill-formed formula")):a},e.parseCheckedFormula=function(e,t,r,n,i){var o=e.parseFormula(Yo(Re.Cell,i),n);if(!ge(o))return o;var a=t.checkFormula(ta(Re.Cell,Be(r.sheet,i)),o.value);return ge(a)?Se(a.value):a},e.prototype.parseNumberFormat=function(e,t){return{result:this.cachedParseNumberFormat(e,t)}},e.prototype.evalOnClonedModel=function(e,t){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t)},e.prototype.evalFormula=function(e,t,r){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t,r)},e.prototype.cachedParseNumberFormat=function(e,t){var r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;var n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n},e.prototype.resolveStructRefSync=function(e,t){return{result:this.resolver.resolveStructRef(e,t)}},e.prototype.resolveCellRefNodeSync=function(e,t){return{result:this.resolver.resolveCellRef(e,t)}},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch((function(e){var t="x10arch.PrefetchingCache.close: ".concat(j(e));M.ULS.traceTag(553734788,ii.msoulscat_ES_EWAJS,ci.Warning,t)}))},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}(),TS=function(){function e(e){this.consumeMessage=e,this.queue=new Bv((function(){return 0}))}return e.prototype.enqueue=function(e,t,r){b(r)&&e.kind===Ng.StopPlugins||this.queue.enqueue(e)},e.prototype.step=function(){var e=this.queue.pop();b(e)&&this.consumeMessage(e)},Object.defineProperty(e.prototype,"done",{get:function(){return 0===this.queue.getCount()},enumerable:!1,configurable:!0}),e}();d();var PS,ES,kS,OS=function(e){return new iS(e)},AS=function(e){return new aS(e)},IS=function(e){return function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.getGrid();if(void 0!==i)return(t=NS).create.apply(t,Object(gu.__spreadArray)([i],r,!1))}},_S=function(e){return function(t){return new Xg((function(e,t){return e.kind-t.kind}),t,void 0,e)}},FS=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(eS.bind.apply(eS,Object(gu.__spreadArray)([void 0,_S(t[1]),IS(e)],t,!1)))},MS=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=function(e){return t=new TS(e)},o=new(eS.bind.apply(eS,Object(gu.__spreadArray)([void 0,i,IS(e)],r,!1)));if(void 0===t)throw"not initialized";return[o,t]},DS=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(gu.__extends)(t,e),Object.defineProperty(t.prototype,"PluginFinalizerHandlers",{get:function(){return this.pluginFinalizerHandlers},set:function(e){this.pluginFinalizerHandlers=e},enumerable:!1,configurable:!0}),t}(eS),wS=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(DS.bind.apply(DS,Object(gu.__spreadArray)([void 0,_S(t[1]),IS(e)],t,!1)))},LS=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(uS.bind.apply(uS,Object(gu.__spreadArray)([void 0,e],t,!1)))},xS=(PS=_S,ES=IS,function(e,t){var r=e.config,n=e.connection,i=t.pluginResponseWindows;return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){return[2,vu.Endpoint.createInside(n,(function(e){var t=Object(gu.__assign)(Object(gu.__assign)({},kg(new Ef((function(){return e.call})),Yv)),kg(new Ef((function(){return e.post})),Jv)),o=new iS((function(){return a.registerAsyncGrid()})),a=new eS(PS(void 0),ES(o),i,void 0,t);return new dS(String(n.options.id),o,a,r,e)}))]}))}))}),BS=function(){throw new Error("createIGridFromRecalcService: unimplemented in dev")},US=o,GS=i,KS=n,VS=I((function(){var e=YS().createGridProvider((function(){return WS.instance().registerAsyncGrid()}));return jS.instance().onGridImporterCreated(e,"Main-IGrid"),e})),jS=I((function(){return YS().createGridImportManager()})),WS=I((function(){return YS().createFormulaBarScheduler(VS.instance())}));function HS(e){return YS().createDynamicPluginLoader(jS.instance(),WS.instance(),e)}d();var QS=function(){function e(){}return e.create=function(e){return HS(e)},e}();d();var qS={createFormulaBarScheduler:FS,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return LS.apply(s,Object(gu.__spreadArray)(["excelOnlineCalc.x10.devDynamicPluginLoaderInsideInit"],e,!1))},createGridImportManager:AS,createGridProvider:OS,createExperimentFormulaBarScheduler:MS,createTestableFormulaBarScheduler:wS},zS={createFormulaBarScheduler:FS,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return LS.apply(a,Object(gu.__spreadArray)(["excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit"],e,!1))},createGridImportManager:AS,createGridProvider:OS,createExperimentFormulaBarScheduler:MS,createTestableFormulaBarScheduler:wS};function YS(e){return void 0===e&&(e=fe("Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler")?Kg.Dev:Kg.Stable),e===Kg.Dev?qS:zS}if(fe("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(kS=self.__retries)&&void 0!==kS?kS:-1)+1,0===self.__retries))throw"";var JS,XS,$S,ZS,ey,ty,ry,ny;function iy(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=t[0],i=t[1];return Object(gu.__awaiter)(this,void 0,void 0,(function(){function t(e){void 0===e&&(e="Requested"),d=e,u.close()}var r,o,a,s,l,u,c,d,f,p,m,h,g,v,S=this;return Object(gu.__generator)(this,(function(y){switch(y.label){case 0:return r="boolean"==typeof n?n?[(new WS).instance(),(new jS).instance()]:[void 0,void 0]:[n,i],o=r[0],a=r[1],s=-1/0,l={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){s=e}},[4,vu.createWorker({id:"RecalcService",createMode:e},{local:fg,thread:{scriptUrl:Oi(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(function(){return l}))];case 1:u=y.sent(),c=[],d="Requested",u.onClose=function(){for(var e=0,t=c;e<t.length;e++){var r=t[e];try{r()}catch(e){M.ULS.traceTag(539341771,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,"calc.calc.createRecalcService.service.onClose: callback threw ".concat(j(e)))}}var n="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ".concat(d);M.ULS.traceTag(561534148,Su.LogCategory.msoulscat_ES_EWAJS,"Requested"===d?Su.TraceLevel.Info:Su.TraceLevel.Warning,n)},y.label=2;case 2:return y.trys.push([2,5,,6]),"Thread"!==u.createMode?[3,4]:[4,Fi(u)];case 3:f=y.sent(),c.push((function(){return f.close()})),Zh(u.call.getMissingJSFeatures),y.label=4;case 4:return u.call.ping.callTimeout=3e4,p=3,m=0,h=function(){},Jh((function(){return Object(gu.__awaiter)(S,void 0,void 0,(function(){var e,r,n,i,o,a,s;return Object(gu.__generator)(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(l.sent(),u.hasBeenClosed())return[2,void 0];e=u.call.ping.callTimeout,r=F(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,u.call.ping()];case 3:return l.sent(),[3,5];case 4:if(n=l.sent(),!vu.WorkerError.isWorkerError(n)||"Timeout"!==n.info.cause)throw n;return i=F()-r,(m+=1)>=p&&t("Unresponsive"),o=u.hasBeenClosed(),a={timeout:e,waitTime:i,timeoutCount:m,hasBeenClosed:o},s="calc.calc.RecalcService: unresponsive; ".concat(JSON.stringify(a)),M.ULS.traceTag(561534149,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,s),h(e,i,m,o),[2,!0];case 5:return m=0,[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: ".concat(j(e));M.ULS.traceTag(561534150,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,t)})),u.post.updateRanges.onPostMessageError=vu.dispatchWorkerError,g={setOnRecalcResults:function(e){l.onRecalcResults=e},setOnUpdateRequest:function(e){l.onUpdateRequest=e},setOnUnresponsive:function(e){h=e},setA1ReferenceStyle:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=u.post).setA1ReferenceStyle.apply(e,t),void 0!==o&&o.doNotify(pg.setA1ReferenceStyle,t)},setLocale:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=u.post).setLocale.apply(e,t),void 0!==o&&o.doNotify(pg.setLocale,t)},setWorkbookProps:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=u.post).setWorkbookProps.apply(e,t),void 0!==o&&o.doNotify(pg.setWorkbookProps,t)},updateSheetNames:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=u.post).updateSheetNames.apply(e,t),void 0!==o&&o.doNotify(pg.updateSheetNames,t)},updateNamedObjects:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=u.post).updateNamedObjects.apply(e,t),void 0!==o&&o.doNotify(pg.updateNamedObjects,t)},setNumberFormats:u.post.setNumberFormats,updateUnusedCells:u.post.updateUnusedCells,updateRanges:u.post.updateRanges,updateArrays:u.post.updateArrays,editRangeFormulas:u.post.editRangeFormulas,editRangeFormats:u.post.editRangeFormats,editArrayFormulas:u.post.editArrayFormulas,editRangePaste:u.post.editRangePaste,resumeRecalc:u.post.resumeRecalc,reconfigure:function(e){var t,r;u.call.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,p=null!==(r=e.responsivenessPingAttempts)&&void 0!==r?r:3,u.post.reconfigure(e)},clearCache:function(){u.post.clearCache(),s=-1/0},testAdvanceState:u.post.testAdvanceState,testResumeRecalc:u.call.testResumeRecalc,close:t,stateIdAvailable:function(e){return e>=s},evalFormula:u.call.evalFormula,evalOnClonedModel:u.call.evalOnClonedModel,createIGridExportEndpoint:function(e,t){return c.push(t),u.call.createIGridExportEndpoint.transfer([e.port],e)}},void 0!==a&&a.onGridExporterCreated(g),[2,g];case 5:throw v=y.sent(),t("Error"),v;case 6:return[2]}}))}))}function oy(){}function ay(){return Promise.resolve()}($S=JS||(JS={})).worksheetFunctionName=rl,$S.errorTypeName=nl,$S.localeData=il,$S.numberFormat=ol,$S.sheetName=al,$S.blankValue=sl,$S.errorValue=ll,$S.richValue=ul,$S.getCellValueKind=cl,$S.getCellFormatKind=dl,$S.cellLocation=fl,$S.rangeLocation=pl,$S.sheetRangeLocation=ml,$S.sheetCellLocation=hl,$S.cellData=gl,$S.cellFormulaCellData=vl,$S.arrayFormulaCellData=Sl,$S.valueCellData=yl,$S.rangeUpdate=Cl,$S.rangeWrite=Rl,$S.rangePromote=bl,$S.arrayData=Nl,$S.arrayUpdate=Tl,$S.arrayWrite=Pl,$S.arrayPromote=El,$S.unusedCellsUpdate=kl,$S.namedValueData=Ol,$S.namedFormulaData=Al,$S.namedRangeData=Il,$S.namedFailureData=Ml,$S.namedObject=Dl,$S.namedObjectsUpdate=wl,$S.namedObjectsWrite=Ll,$S.undefinedNamesWrite=xl,$S.namedObjectsPromote=Bl,$S.namedTableData=Fl,$S.columnData=_l,$S.rangeFormulaEdit=Ul,$S.cellFormulaRangeFormulaEdit=Gl,$S.valueRangeFormulaEdit=Kl,$S.inferredRangeFormulaEdit=Vl,$S.RibbonFormat=ns,$S.formatEditOperation=jl,$S.formatEditSetFormat=Wl,$S.formatEditRibbonFormat=Hl,$S.formatEditChangeDecimals=Ql,$S.rangeFormatEdit=ql,$S.arrayFormulaEdit=zl,$S.rangePasteEdit=Yl,$S.copyPasteRangePasteEdit=Jl,$S.inferredFormat=Xl,$S.cellDataDelta=$l,$S.rangeDelta=Zl,$S.arrayDelta=eu,$S.rangeFailure=tu,$S.recalcResults=ru,$S.evalFormulaData=uu,$S.evalFormulaFormat=nu,$S.evalFormulaFormatOrigin=iu,$S.evalFormulaFormatIformat=ou,$S.evalFormulaFormatKnown=au,$S.evalFormulaFormatInferred=su,$S.evalFormulaFormatAggregate=lu,$S.updateRequest=du,$S.runExperiment=fu,$S.recalcServiceConfig=pu,$S.workbookProps=mu,$S.createRecalcService=iy,$S.RecalcServiceCreateMode=cu,$S.localeInfoFromData=yp,$S.cellValueToReadOper=Ip,$S.readOperToCellValue=_p,$S.recalcServiceInsideInit=fg,$S.getEvalResultKind=Of,$S.getEvalFailureReason=Af,$S.getTime=If,$S.RecalcServiceDataTransformer=Bp,(XS=$S.internal||($S.internal={})).PartialWorkbookDocumentCollection=pp,XS.VolatileMode=ff,XS.voidCallback=fp,XS.sheetCellSet=ic,XS.createSheetCellSetFromRange=oc,XS.ComputedCellKind=Ju,XS.ComputeKind=Yu,XS.SpecialStyle=uc,XS.SpecialFormat=lc,XS.OutputMessageKind=dc,XS.UnavailableKind=zu,XS.CloningTarget=Lc,XS.PartialWorkbook=jh,XS.createCellSetFromRange=Qu,XS.bspFactory=Hu,XS.forEachCellInSet=nc,XS.forEachRangeInSet=rc,XS.makeGridRangeTable=hc,XS.namedFormula=Lf,XS.namedTable=wf,XS.empty=ku,XS.dense=Eu,XS.union=bu,XS.unionProduct=Mu,XS.meetsProduct=xu,XS.exceptProduct=wu,XS.intersectProduct=Du,XS.blankStyleValue=ap,XS.UnitExperiment=ah,XS.ExperimentKind=gh,XS.registerExperimentFactory=yh,XS.incrementFailure=Up,XS.arrayChecker=Xc,XS.chBoolean=cd,XS.check=Hc,XS.chFiniteNumber=od,XS.chPossiblyInfiniteNumber=id,XS.objectChecker=zc,XS.oneOfChecker=pd,XS.optChecker=qc,(ZS||(ZS={})).getWorksheetFunc=qf,(ty=ey||(ey={})).FontUnderline=ep,ty.FontVerticalAlignment=tp,ty.FillKind=Zf,ty.PatternType=np,ty.BorderLineType=$f,ty.HorizontalAlignment=rp,ty.VerticalAlignment=ip,(ny=ry||(ry={})).runSmokeTest=ay,ny.cancelSmokeTest=oy;c.setTimeoutInterfaceModule.setImmediateUnified,c.setTimeoutInterfaceModule.clearTimerUnified;var sy=c.setTimeoutInterfaceModule.defaultSetTimeoutInterface,ly=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};var uy=c.wrapIntoAsyncModule.wrapIntoAsync;function cy(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return vi().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var dy=function(e){function t(){var t,r=this,n=(void 0===t&&(t=sy),(new(function(e){function r(){var r=e.call(this,ly,ly,ly,Hh(Qh(t)))||this;return r.calcGrid=r,r}return Object(gu.__extends)(r,e),Object.defineProperty(r.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),r}(cg))).calcGrid),i=new ag(n);return(r=e.call(this,i)||this).sheetNames=[],r.calcGrid=n,r.document=n.document,r}return Object(gu.__extends)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),t.prototype.setSheet=function(e,t,r){var n=Te(void 0,""),i=Ke(n,e);D("Sheet having sheetId ".concat(e," is already in the mock workbook"),!this.sheetNames.some((function(t){return t.sheetId===e}))),this.sheetNames.push(al(i.index,t)),this.calcGrid.updateSheetNames(0,this.sheetNames);for(var o=[],a=0;a<r.length;a+=1){var s=r[a];if(void 0!==s)for(var l=0;l<s.length;l+=1){var u=s[l];if(void 0!==u){var c=ml(i.index,a,l),d=cy(u);d.startsWith("=")?o.push(Rl(c,vl(d,u,0))):o.push(Rl(c,yl(d,u,0)))}}}this.calcGrid.updateRanges(0,Object(gu.__spreadArray)([Rl(ml(i.index,0,0))],o,!0)),this.runTasks()},t.prototype.setNamedObjects=function(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()},t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t}((0,c.wrapIntoAsyncModule.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIntersectingTables","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID"]));function fy(){var e=new dy,t=ig(e,(function(){return e.calcGrid.resumeRecalc()}));return t.setSheet=e.setSheet.bind(e),t.setNamedObjects=e.setNamedObjects.bind(e),t.document=e.document,Object.defineProperty(t,"calcConfig",{get:function(){return e.calcConfig}}),t}function py(e){return{getGrid:function(){return e}}}function my(e){return{createIGridExportEndpoint:function(t){return Object(gu.__awaiter)(this,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(r){switch(r.label){case 0:return[4,vu.Endpoint.createInside(t,(function(){return e}))];case 1:return r.sent(),[2]}}))}))}}}function hy(e,t,r,n,i,o){void 0===o&&(o=0),r.setSheet(e,t,n);var a={sheetId:e,sheetName:t};i.doNotify(pg.updateSheetNames,[o,[a]])}Rh.mockTimer.MockTimer;var gy=Rh.mockTimer.MockTimerImmediate,vy=new Ef((function(){var e;return(e={})[Gr.ABS]="=ABS(2)",e[Gr.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Time,"].[").concat(FormulaAuthoringStrings.Fiscal,'].[2014]",$A$3)'),e[Gr.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",$D$4,1,"').concat(FormulaAuthoringStrings.TopMonth,'")'),e[Gr.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[Gr.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[Gr.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[Gr.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[Gr.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[Gr.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[Gr.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[Gr.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[Gr.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[Gr.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[Gr.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[Gr.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'.concat(FormulaAuthoringStrings.Sales,'","').concat(FormulaAuthoringStrings.MySalesKPI,'",1)'),e[Gr.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[Gr.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[Gr.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[Gr.GETPIVOTDATA]='=GETPIVOTDATA("'.concat(FormulaAuthoringStrings.Sales,'", $A$3, "').concat(FormulaAuthoringStrings.Region,'", "').concat(FormulaAuthoringStrings.South,'")'),e[Gr.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[Gr.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[Gr.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[Gr.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[Gr.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[Gr.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[Gr.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[Gr.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[Gr.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[Gr.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[Gr.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[Gr.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[Gr.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[Gr.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[Gr.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[Gr.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[Gr.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[Gr.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[Gr.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[Gr.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[Gr.REGISTER_ID]='=REGISTER.ID(Kernel32, "GetTickCount", "J!")',e[Gr.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[Gr.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[Gr.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[Gr.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[Gr.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[Gr.FORMULATEXT]="=FORMULATEXT(A2)",e[Gr.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[Gr.CONCATENATE]='=CONCATENATE("'.concat(FormulaAuthoringStrings.Andreas,'", " ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[Gr.ISO_CEILING]="=ISO.CEILING(4.3)",e[Gr.VALUETOTEXT]='=VALUETOTEXT("'.concat(FormulaAuthoringStrings.SomeText,'")'),e[Gr.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[Gr.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[Gr.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[Gr.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[Gr.CUBEMEMBER]='=CUBEMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",(B4, C6, D5),"').concat(FormulaAuthoringStrings.SalesFor2004,'")'),e[Gr.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[Gr.SUBSTITUTE]='=SUBSTITUTE("'.concat(FormulaAuthoringStrings.SalesData,'", "').concat(FormulaAuthoringStrings.Sales,'", "').concat(FormulaAuthoringStrings.Cost,'")'),e[Gr.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[Gr.WEBSERVICE]="=WEBSERVICE(".concat(FormulaAuthoringStrings.WebServiceLink,")"),e[Gr.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[Gr.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[Gr.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[Gr.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[Gr.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[Gr.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[Gr.NORM_S_INV]="=NORM.S.INV(0.908789)",e[Gr.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[Gr.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[Gr.FIELDVALUE]='=FIELDVALUE(A2, "'.concat(FormulaAuthoringStrings.Price,'")'),e[Gr.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[Gr.BITLSHIFT]="=BITLSHIFT(4,2)",e[Gr.BITRSHIFT]="=BITRSHIFT(13,2)",e[Gr.DATEVALUE]="=DATEVALUE(40685)",e[Gr.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[Gr.CUBEVALUE]='=CUBEVALUE(Sales,"['.concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.Profit,']","[').concat(FormulaAuthoringStrings.Time,'].[2004]","[').concat(FormulaAuthoringStrings.AllProduct,"].[").concat(FormulaAuthoringStrings.Beverages,']")'),e[Gr.ENCODEURL]='=ENCODEURL("'.concat(FormulaAuthoringStrings.EncodeURLExmapleLink,'")'),e[Gr.HYPERLINK]='=HYPERLINK("'.concat(FormulaAuthoringStrings.HyperlinkExampleLink,'", "').concat(FormulaAuthoringStrings.ClickForReport,'")'),e[Gr.ISLOGICAL]="=ISLOGICAL(TRUE)",e[Gr.ISNONTEXT]="=ISNONTEXT(A2)",e[Gr.ISFORMULA]="=ISFORMULA(A2)",e[Gr.PDURATION]="=PDURATION(2.5%,2000,2200)",e[Gr.TIMEVALUE]="=TIMEVALUE(0.1)",e[Gr.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[Gr.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[Gr.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[Gr.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[Gr.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[Gr.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[Gr.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[Gr.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[Gr.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[Gr.FISHERINV]="=FISHERINV(0.972955)",e[Gr.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[Gr.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[Gr.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[Gr.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[Gr.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[Gr.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[Gr.MODE_MULT]="=MODE.MULT(A2:A13)",e[Gr.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[Gr.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[Gr.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[Gr.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[Gr.DAVERAGE]='=DAVERAGE(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:B2)'),e[Gr.BAHTTEXT]="=BAHTTEXT(1234)",e[Gr.DPRODUCT]='=DPRODUCT(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:F3)'),e[Gr.INDIRECT]="=INDIRECT(B&A)",e[Gr.ISNUMBER]="=ISNUMBER(A2)",e[Gr.MINVERSE]="=MINVERSE(A1:D4)",e[Gr.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[Gr.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[Gr.BETADIST]="=BETADIST(2,8,10,1,3)",e[Gr.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[Gr.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[Gr.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[Gr.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[Gr.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[Gr.NORMSINV]="=NORMSINV(0.9088)",e[Gr.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[Gr.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[Gr.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[Gr.QUARTILE]="=QUARTILE(A2:A9,1)",e[Gr.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[Gr.T_INV_2T]="=T.INV.2T(0.546449,60)",e[Gr.AVERAGEA]="=AVERAGEA(A2:A6)",e[Gr.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[Gr.SEQUENCE]="=SEQUENCE(4,5)",e[Gr.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['.concat(FormulaAuthoringStrings.Book1,"]").concat(FormulaAuthoringStrings.Sheet1,'")'),e[Gr.AVERAGE]="=AVERAGE(A2:A6)",e[Gr.COLUMNS]="=COLUMNS(C1:E4)",e[Gr.COUNTIF]='=COUNTIF(B2:B5,">55")',e[Gr.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[Gr.DCOUNTA]='=DCOUNTA(A4:E10, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F2)'),e[Gr.DECIMAL]="=DECIMAL(FF,16)",e[Gr.DEGREES]="=DEGREES(PI())",e[Gr.DSTDEVP]='=DSTDEVP(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[Gr.CUBESET]='=CUBESET("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Product,"].[").concat(FormulaAuthoringStrings.AllProducts,"].").concat(FormulaAuthoringStrings.Children,'","').concat(FormulaAuthoringStrings.Products,'",1,"[').concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.SalesAmount,']")'),e[Gr.HLOOKUP]='=HLOOKUP("'.concat(FormulaAuthoringStrings.Axles,'", A1:C4, 2, TRUE)'),e[Gr.IFERROR]='=IFERROR(55/0, "'.concat(FormulaAuthoringStrings.ErrorInCalculation,'")'),e[Gr.ISBLANK]="=ISBLANK(A2)",e[Gr.ISERROR]="=ISERROR(#REF!)",e[Gr.XLOOKUP]='=XLOOKUP("'.concat(FormulaAuthoringStrings.Tom,'",A2:A9,C2:C9,"').concat(FormulaAuthoringStrings.NotFound,'",0,1)'),e[Gr.MDETERM]="=MDETERM(A2:D5)",e[Gr.PRODUCT]="=PRODUCT(A2:A4)",e[Gr.RADIANS]="=RADIANS(270)",e[Gr.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[Gr.REPLACE]='=REPLACE(2009,3,2,"10")',e[Gr.STDEV_S]="=STDEV.S(A2:A11)",e[Gr.STDEV_P]="=STDEV.P(A3:A12)",e[Gr.UNICODE]="=UNICODE(B)",e[Gr.UNICHAR]="=UNICHAR(66)",e[Gr.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[Gr.WEEKDAY]="=WEEKDAY(39492)",e[Gr.GAMMALN]="=GAMMALN(4)",e[Gr.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[Gr.CHIDIST]="=CHIDIST(18.307,10)",e[Gr.COMBINA]="=COMBINA(4,3)",e[Gr.CEILING]="=CEILING(2.5, 1)",e[Gr.NORMINV]="=NORMINV(0.908789,40,1.5)",e[Gr.POISSON]="=POISSON(1, 2, TRUE)",e[Gr.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[Gr.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[Gr.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[Gr.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[Gr.GEOMEAN]="=GEOMEAN(A2:A8)",e[Gr.HARMEAN]="=HARMEAN(A2:A8)",e[Gr.STDEVPA]="=STDEVPA(A3:A12)",e[Gr.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[Gr.ARABIC]="=ARABIC(LVII)",e[Gr.CHOOSE]='=CHOOSE(3,"'.concat(FormulaAuthoringStrings.Wide,'",115,"').concat(FormulaAuthoringStrings.World,'",8)'),e[Gr.COLUMN]="=COLUMN(C9)",e[Gr.COUNTA]="=COUNTA(B2:B6)",e[Gr.DCOUNT]='=DCOUNT(A5:E11, "'.concat(FormulaAuthoringStrings.Age,'", A1:F2)'),e[Gr.DOLLAR]="=DOLLAR(1.2351, 4)",e[Gr.DSTDEV]='=DSTDEV(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[Gr.GROWTH]="=GROWTH(#VALUE!)",e[Gr.IMCOSH]='=IMCOSH("4+3i")',e[Gr.IMCSCH]='=IMCSCH("4+3i")',e[Gr.IMSECH]='=IMSECH("4+3i")',e[Gr.IMSINH]='=IMSINH("4+3i")',e[Gr.ISTEXT]='=ISTEXT("'.concat(FormulaAuthoringStrings.Region1,'")'),e[Gr.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[Gr.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[Gr.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[Gr.XMATCH]="=XMATCH(F2,C3:C9,1)",e[Gr.MEDIAN]="=MEDIAN(A2:A6)",e[Gr.MINUTE]="=MINUTE(0.53125)",e[Gr.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[Gr.PROPER]='=PROPER("'.concat(FormulaAuthoringStrings.ThisIsATITLE,'")'),e[Gr.SEARCH]='=SEARCH("'.concat(FormulaAuthoringStrings.E,'","').concat(FormulaAuthoringStrings.Statements,'",6)'),e[Gr.SECOND]="=SECOND(0.700208333333333)",e[Gr.SHEETS]="=SHEETS(".concat(FormulaAuthoringStrings.My3DRef,")"),e[Gr.STDEVP]="=STDEVP(A3:A12)",e[Gr.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'.concat(FormulaAuthoringStrings.Bananas,'", C2:C9, "').concat(FormulaAuthoringStrings.Tom,'")'),e[Gr.AVEDEV]="=AVEDEV(A2:A8)",e[Gr.CHIINV]="=CHIINV(0.3, 2)",e[Gr.COMBIN]="=COMBIN(8,2)",e[Gr.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[Gr.FISHER]="=FISHER(0.75)",e[Gr.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[Gr.PERMUT]="=PERMUT(100,3)",e[Gr.T_DIST]="=T.DIST(60,1,TRUE)",e[Gr.CORREL]="=CORREL(A2:A6, B2:B6)",e[Gr.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[Gr.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[Gr.SKEW_P]="=SKEW.P(A2:A11)",e[Gr.Z_TEST]="=Z.TEST(A2:A11,4)",e[Gr.STDEVA]="=STDEVA(A3:A12)",e[Gr.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[Gr.MINIFS]='=MINIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[Gr.CONCAT]='=CONCAT("'.concat(FormulaAuthoringStrings.Andreas,'"," ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[Gr.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'.concat(FormulaAuthoringStrings.Sunday,'",2,"').concat(FormulaAuthoringStrings.Monday,'",3,"').concat(FormulaAuthoringStrings.Tuesday,'","').concat(FormulaAuthoringStrings.NoMatch,'")'),e[Gr.FILTER]='=FILTER(A5:D20,(C5:C20="'.concat(FormulaAuthoringStrings.Apple,'")*(A5:A20="').concat(FormulaAuthoringStrings.East,'"),"")'),e[Gr.UNIQUE]="=UNIQUE(A2:A12)",e[Gr.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[Gr.BITAND]="=BITAND(1,5)",e[Gr.BITXOR]="=BITXOR(5,3)",e[Gr.ACOSH]="=ACOSH(10)",e[Gr.ACOTH]="=ACOTH(6)",e[Gr.ATANH]="=ATANH(-0.1)",e[Gr.ATAN2]="=ATAN2(4,0)",e[Gr.CLEAN]="=CLEAN(A2)",e[Gr.COUNT]="=COUNT(A2:A7)",e[Gr.DVARP]='=DVARP(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[Gr.EXACT]='=EXACT("'.concat(FormulaAuthoringStrings.Hello,'", "').concat(FormulaAuthoringStrings.Goodbye,'")'),e[Gr.FALSE]="=FALSE()",e[Gr.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[Gr.IMCOT]='=IMCOT("4+3i")',e[Gr.IMCSC]='=IMCSC("4+3i")',e[Gr.IMSEC]='=IMSEC("4+3i")',e[Gr.IMTAN]='=IMTAN("4+3i")',e[Gr.INDEX]="=INDEX(A2:B3,2,1)",e[Gr.ISERR]="=ISERR(#N/A)",e[Gr.ISREF]="=ISREF(A2)",e[Gr.LOWER]='=LOWER("'.concat(FormulaAuthoringStrings.EECummings,'")'),e[Gr.MATCH]="=MATCH(39,B2:B5,1)",e[Gr.MMULT]="=MMULT(A1:B3, C1:F2)",e[Gr.MONTH]="=MONTH(40648)",e[Gr.RIGHT]='=RIGHT("'.concat(FormulaAuthoringStrings.SalePrice,'",5)'),e[Gr.ROUND]="=ROUND(2.149, 1)",e[Gr.SHEET]="=SHEET(".concat(FormulaAuthoringStrings.Table1,")"),e[Gr.STDEV]="=STDEV(A3:A12)",e[Gr.SUMIF]='=SUMIF(A2:A5,">160000")',e[Gr.TODAY]="=TODAY()",e[Gr.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[Gr.TRUNC]="=TRUNC(8.9)",e[Gr.UPPER]='=UPPER("'.concat(FormulaAuthoringStrings.KelliXu,'")'),e[Gr.VALUE]="=VALUE(1000)",e[Gr.VAR_S]="=VAR.S(A2:A11)",e[Gr.VAR_P]="=VAR.P(A2:A11)",e[Gr.GAMMA]="=GAMMA(-3.75)",e[Gr.GAUSS]="=GAUSS(2)",e[Gr.FDIST]="=FDIST(15.20686486,6,4)",e[Gr.F_INV]="=F.INV(0.01,6,4)",e[Gr.FLOOR]="=FLOOR(23.25, 0.1)",e[Gr.TDIST]="=TDIST(60, 1, 1)",e[Gr.COVAR]="=COVAR(A2:A6, B2:B6)",e[Gr.FTEST]="=FTEST(A2:A6,B2:B6)",e[Gr.STEYX]="=STEYX(A3:A9,B3:B9)",e[Gr.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[Gr.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[Gr.DEVSQ]="=DEVSQ(A2:A8)",e[Gr.SUMSQ]="=SUMSQ(3, 4)",e[Gr.ZTEST]="=ZTEST(A2:A11,6)",e[Gr.LARGE]="=LARGE(A2:B6,7)",e[Gr.SMALL]="=SMALL(A2:A10,4)",e[Gr.MUNIT]="=MUNIT(2)",e[Gr.T_INV]="=T.INV(0.75,2)",e[Gr.ROMAN]="=ROMAN(499,0)",e[Gr.POWER]="=POWER(5,2)",e[Gr.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[Gr.VARPA]="=VARPA(1, 2)",e[Gr.AREAS]="=AREAS(B2:D4)",e[Gr.ASINH]="=ASINH(10)",e[Gr.BITOR]="=BITOR(23,10)",e[Gr.ACOS]="=ACOS(-0.5)",e[Gr.ACOT]="=ACOT(2)",e[Gr.ATAN]="=ATAN(1)",e[Gr.CALL]="=CALL(A5)",e[Gr.CELL]='=CELL("'.concat(FormulaAuthoringStrings.Address,'", C2)'),e[Gr.CHAR]="=CHAR(65)",e[Gr.COSH]="=COSH(EXP(1))",e[Gr.COTH]="=COTH(2)",e[Gr.CSCH]="=CSCH(2)",e[Gr.DATE]="=DATE(2008,1,2)",e[Gr.DAYS]="=DAYS(3/15/11,2/1/11)",e[Gr.DGET]='=DGET(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[Gr.DMAX]='=DMAX(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[Gr.DMIN]='=DMIN(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[Gr.DSUM]='=DSUM(A4:E10,"'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[Gr.DVAR]='=DVAR(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[Gr.FACT]="=FACT(5)",e[Gr.FIND]='=FIND("'.concat(FormulaAuthoringStrings.M,'",A2)'),e[Gr.HOUR]="=HOUR(0.75)",e[Gr.IFNA]='=IFNA("'.concat(FormulaAuthoringStrings.NoNAError,'", "').concat(FormulaAuthoringStrings.Error,'")'),e[Gr.IPMT]="=IPMT(10%, 3, 3, 8000)",e[Gr.ISNA]="=ISNA(#REF!)",e[Gr.LEFT]='=LEFT("'.concat(FormulaAuthoringStrings.SalePrice,'",4)'),e[Gr.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[Gr.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[Gr.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[Gr.RAND]="=RAND()",e[Gr.RANK]="=RANK(3.5,A2:A6,1)",e[Gr.RATE]="=RATE(4*12, -200, 8000)",e[Gr.REPT]='=REPT("*-", 3)',e[Gr.ROWS]="=ROWS(C1:E4)",e[Gr.SECH]="=SECH(0)",e[Gr.SIGN]="=SIGN(10)",e[Gr.SINH]="=SINH(2)",e[Gr.SQRT]="=SQRT(16)",e[Gr.TANH]="=TANH(0.5)",e[Gr.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[Gr.TIME]="=TIME(16,48,10)",e[Gr.TRIM]='=TRIM("'.concat(FormulaAuthoringStrings.FirstQuarterEarnings,'")'),e[Gr.TRUE]="=TRUE()",e[Gr.TYPE]='=TYPE("'.concat(FormulaAuthoringStrings.Smith,'")'),e[Gr.VARP]="=VARP(A2:A11)",e[Gr.YEAR]="=YEAR(39634)",e[Gr.INFO]='=INFO("'.concat(FormulaAuthoringStrings.Numfile,'")'),e[Gr.EVEN]="=EVEN(1.5)",e[Gr.FINV]="=FINV(0.42, 2, 3)",e[Gr.PROB]="=PROB(A3:A6,B3:B6,2)",e[Gr.KURT]="=KURT(A2:A11)",e[Gr.SKEW]="=SKEW(A2:A11)",e[Gr.MODE]="=MODE(A2:A7)",e[Gr.MINA]="=MINA(A2:A6)",e[Gr.MAXA]="=MAXA(A2:A6)",e[Gr.VARA]="=VARA(1, 2)",e[Gr.SORT]="=SORT(A2:A17)",e[Gr.ASIN]="=ASIN(-0.5)",e[Gr.BASE]="=BASE(7,2)",e[Gr.CODE]='=CODE("'.concat(FormulaAuthoringStrings.CodeA,'")'),e[Gr.AND]="=AND(A2>1,A2<100)",e[Gr.COS]="=COS(1.047)",e[Gr.COT]="=COT(30)",e[Gr.CSC]="=CSC(15)",e[Gr.DAY]="=DAY(40648)",e[Gr.DDB]="=DDB(2400,300,10*365,1)",e[Gr.RTD]='=RTD(mycomaddin.progid,,"'.concat(FormulaAuthoringStrings.ServerName,'","').concat(FormulaAuthoringStrings.Price,'")'),e[Gr.EXP]="=EXP(1)",e[Gr.INT]="=INT(8.9)",e[Gr.IRR]="=IRR(A2:A4,-10%)",e[Gr.LEN]='=LEN("'.concat(FormulaAuthoringStrings.Excel,'")'),e[Gr.LOG]="=LOG(10)",e[Gr.MAX]="=MAX(A2:A6)",e[Gr.MID]='=MID("'.concat(FormulaAuthoringStrings.FluidFlow,'",1,5)'),e[Gr.MIN]="=MIN(A2:A6)",e[Gr.MOD]="=MOD(3, 2)",e[Gr.NOT]="=NOT(A2>100)",e[Gr.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[Gr.PMT]="=PMT(0.08/12,10,10000)",e[Gr.ROW]="=ROW(C10)",e[Gr.RRI]="=RRI(96,10000,11000)",e[Gr.SEC]="=SEC(30)",e[Gr.SIN]="=SIN(PI())",e[Gr.SLN]="=SLN(30000, 7500, 10)",e[Gr.SUM]="=SUM(A1:A3)",e[Gr.SYD]="=SYD(30000,7500,10,1)",e[Gr.TAN]="=TAN(0.785)",e[Gr.VAR]="=VAR(A2:A11)",e[Gr.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[Gr.XOR]="=XOR(3>0,2<9)",e[Gr.ODD]="=ODD(1.5)",e[Gr.PHI]="=PHI(0.75)",e[Gr.RSQ]="=RSQ(A3:A9, B3:B9)",e[Gr.IFS]='=IFS(A2>89,"'.concat(FormulaAuthoringStrings.IfsA,'",A2>79,"').concat(FormulaAuthoringStrings.IfsB,'",A2>69,"').concat(FormulaAuthoringStrings.IfsC,'",A2>59,"').concat(FormulaAuthoringStrings.IfsD,'",TRUE,"').concat(FormulaAuthoringStrings.IfsF,'")'),e[Gr.DB]="=DB(1000000,100000,6,1,7)",e[Gr.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[Gr.IF]='=IF(C2>B2,"'.concat(FormulaAuthoringStrings.OverBudget,'","').concat(FormulaAuthoringStrings.WithinBudget,'")'),e[Gr.LN]="=LN(86)",e[Gr.NA]="=NA()",e[Gr.OR]="=OR(A2>1,A2<100)",e[Gr.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[Gr.N]="=N(".concat(FormulaAuthoringStrings.Even,")"),e[Gr.T]='=T("'.concat(FormulaAuthoringStrings.Hello,'")'),e[Gr.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[Gr.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[Gr.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[Gr.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[Gr.BESSELI]="=BESSELI(1.5,1)",e[Gr.BESSELJ]="=BESSELJ(1.9,2)",e[Gr.BESSELK]="=BESSELK(1.5,1)",e[Gr.BESSELY]="=BESSELY(2.5,1)",e[Gr.BIN2DEC]="=BIN2DEC(1100100)",e[Gr.BIN2HEX]="=BIN2HEX(11111011, 4)",e[Gr.BIN2OCT]="=BIN2OCT(1001, 3)",e[Gr.COMPLEX]='=COMPLEX(3,4,"j")',e[Gr.CONVERT]='=CONVERT(1,"lbm","kg")',e[Gr.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[Gr.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[Gr.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[Gr.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[Gr.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[Gr.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[Gr.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[Gr.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[Gr.DEC2BIN]="=DEC2BIN(9, 4)",e[Gr.DEC2HEX]="=DEC2HEX(100,4)",e[Gr.DEC2OCT]="=DEC2OCT(58,3)",e[Gr.DELTA]="=DELTA(5,4)",e[Gr.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[Gr.DOLLARDE]="=DOLLARDE(1.02,16)",e[Gr.DOLLARFR]="=DOLLARFR(1.125,16)",e[Gr.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[Gr.EDATE]="=EDATE(15-Jan-11,1)",e[Gr.EFFECT]="=EFFECT(0.0525,4)",e[Gr.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[Gr.ERF]="=ERF(0.745)",e[Gr.ERFC]="=ERFC(1)",e[Gr.FACTDOUBLE]="=FACTDOUBLE(6)",e[Gr.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[Gr.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[Gr.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[Gr.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[Gr.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[Gr.GCD]="=GCD(24,36)",e[Gr.GESTEP]="=GESTEP(5,4)",e[Gr.HEX2BIN]="=HEX2BIN(F,8)",e[Gr.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[Gr.HEX2OCT]="=HEX2OCT(F, 3)",e[Gr.IMABS]='=IMABS("5+12i")',e[Gr.IMAGE]='=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',e[Gr.IMAGINARY]='=IMAGINARY("3+4i")',e[Gr.IMARGUMENT]='=IMARGUMENT("3+4i")',e[Gr.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[Gr.IMCOS]='=IMCOS("1+i")',e[Gr.IMDIV]='=IMDIV("-238+240i","10+24i")',e[Gr.IMEXP]='=IMEXP("1+i")',e[Gr.IMLN]='=IMLN("3+4i")',e[Gr.IMLOG10]='=IMLOG10("3+4i")',e[Gr.IMLOG2]='=IMLOG2("3+4i")',e[Gr.IMPOWER]='=IMPOWER("2+3i", 3)',e[Gr.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[Gr.IMREAL]='=IMREAL("6-9i")',e[Gr.IMSIN]='=IMSIN("4+3i")',e[Gr.IMSQRT]='=IMSQRT("1+i")',e[Gr.IMSUB]='=IMSUB("13+4i","5+3i")',e[Gr.IMSUM]='=IMSUM("3+4i","5-3i")',e[Gr.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[Gr.ISEVEN]="=ISEVEN(2.5)",e[Gr.ISODD]="=ISODD(2.5)",e[Gr.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[Gr.LET]="=LET(".concat(FormulaAuthoringStrings.Total,", SUM(A1:A10), ").concat(FormulaAuthoringStrings.Count,", COUNT(A1:A10), ").concat(FormulaAuthoringStrings.Total," / ").concat(FormulaAuthoringStrings.Count,")"),e[Gr.LCM]="=LCM(5,2)",e[Gr.LOG10]="=LOG10(86)",e[Gr.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[Gr.MROUND]="=MROUND(10,3)",e[Gr.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[Gr.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[Gr.NOMINAL]="=NOMINAL(0.053543, 4)",e[Gr.NOW]="=NOW()",e[Gr.OCT2BIN]="=OCT2BIN(3,3)",e[Gr.OCT2DEC]="=OCT2DEC(54)",e[Gr.OCT2HEX]="=OCT2HEX(100,4)",e[Gr.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[Gr.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[Gr.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[Gr.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[Gr.PI]="=PI()",e[Gr.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[Gr.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[Gr.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[Gr.QUOTIENT]="=QUOTIENT(5,2)",e[Gr.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[Gr.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[Gr.RECURSE]="=RECURSE()",e[Gr.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[Gr.ROUNDUP]="=ROUNDUP(3.14159,3)",e[Gr.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[Gr.SQRTPI]="=SQRTPI(1)",e[Gr.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[Gr.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[Gr.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[Gr.TINV]="=TINV(0.05464,60)",e[Gr.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[Gr.WORKDAY]="=WORKDAY(10/1/2008,151)",e[Gr.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[Gr.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[Gr.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[Gr.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[Gr.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[Gr.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e[Gr.TEXTSPLIT]='=TEXTSPLIT("1,2,3;4,5,6",",",";")',e[Gr.TEXTBEFORE]='=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',e[Gr.TEXTAFTER]='=TEXTAFTER("Red riding hood\'s, red hood", "hood")',e[Gr.VSTACK]="=VSTACK({1,2},{3,4},5)",e[Gr.HSTACK]="=HSTACK({1;2},{3;4},5)",e[Gr.MAP]="=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",e[Gr.WRAPROWS]="=WRAPROWS(A2:G2,3)",e[Gr.SCAN]="=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",e[Gr.MAKEARRAY]="=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",e[Gr.REDUCE]="=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",e[Gr.NORMSDIST]="=NORMDIST(A2,A3,A4,TRUE)",e[Gr.CHOOSEROWS]="=CHOOSEROWS(A2:B7,1,3,5,1)",e[Gr.CHOOSECOLS]="=CHOOSECOLS(A2:E7,1,3,5,1)",e[Gr.DROP]="=DROP(A2:C4,2)",e[Gr.WRAPCOLS]="=WRAPCOLS(A2:F2,3)",e[Gr.TOCOL]="=TOCOL(A2:D4)",e[Gr.TAKE]="=TAKE(A2:C4,2)",e[Gr.TOROW]="=TOROW(A2:D4)",e[Gr.BYCOL]="=BYCOL(A1:C2, LAMBDA(".concat(FormulaAuthoringStrings.Array,", MAX(").concat(FormulaAuthoringStrings.Array,")))"),e[Gr.BYROW]="=BYROW(A1:C2, LAMBDA(".concat(FormulaAuthoringStrings.Array,", MAX(").concat(FormulaAuthoringStrings.Array,")))"),e})),Sy=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n.assistedFunctionScopeStart=0,n.autoCompleteAfterFunctionNameEnabled=!1,n.autoCompleteAfterFunctionNameEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:6128020_AutoCompleteAfterFunctionName"),n}return Object(gu.__extends)(t,e),t.prototype.appNode=function(t,r,n,i){return t.kind===At.WSF&&this.updateAssistedFunction(t,r),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.letNode=function(t,r,n,i,o,a){var s=e.prototype.letNode.call(this,t,r,n,i,o,a);return this.updateAssistedFunction(t,s.args),s},t.prototype.lambdaNode=function(t,r,n,i,o,a){var s=e.prototype.lambdaNode.call(this,t,r,n,i,o,a);return this.updateAssistedFunction(t,s.args),s},t.prototype.updateAssistedFunction=function(e,t){return(this.autoCompleteAfterFunctionNameEnabled?this.updateAssistedFunction_NEW.bind(this):this.updateAssistedFunction_OLD.bind(this))(e,t)},t.prototype.updateAssistedFunction_OLD=function(e,t){var r,n,i,o=null===(r=this.parsedFormulaTree.spans[t[0].label])||void 0===r?void 0:r.start,a=null===(n=this.parsedFormulaTree.spans[t[t.length-1].label])||void 0===n?void 0:n.end;void 0!==a&&void 0!==o&&this.caretPosition<=a&&(this.caretPosition>=o||1===(null===(i=this.parsedFormulaTree.spans[e.label])||void 0===i?void 0:i.start))&&(void 0===this.assistedFunctionHead||o>this.assistedFunctionScopeStart)&&void 0!==this.parsedFormulaTree.spans[e.label]&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=o)},t.prototype.updateAssistedFunction_NEW=function(e,t){var r=this.parsedFormulaTree.spans[t[0].label].start,n=this.parsedFormulaTree.spans[t[t.length-1].label].end;this.caretPosition<=n&&this.caretPosition>=r&&(void 0===this.assistedFunctionHead||r>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=r)},t}(oo);function yy(e,t,r,n,i,o,a,s){var l=function(e,t,r){for(var n,i=0,o=t.length-1;o>=0;o-=1){var a=null===(n=e.spans[t[o].label])||void 0===n?void 0:n.end;void 0!==a&&r<=a&&(i=o)}return i}(t,r,n),u=e.Params.split("!");return{functionName:e.NameDataStrings,functionDescription:e.Help,signatures:u.map((function(t,r){return function(e,t,r,n,i,o,a,s){var l=Vr(i),u=""!==t?t.split(o+" ").filter((function(e){return"..."!==e})):[],c=function(e,t,r){var n=e.slice(),i=t.headTypes.length,o=t.restTypes.length;if(o>0){for(var a=by(r,i,o),s=i;s<n.length;s+=o){for(var l=0;l<o;l+=1){var u=Ty(n[s+l]),c=a>1&&l%o==0?"[":"",d=a>1&&l%o==o-1?"]":"";n[s+l]="".concat(c).concat(u).concat(a).concat(d)}a+=1}n.push("..."),Ny(r,t)&&n.splice(i,0,"...")}return n}(u,l,n),d=function(e,t){if(void 0===e||void 0===t)return null;return t.node.args.map((function(r){var n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(a,s),f=function(e,t,r,n){var i=e.split("!");i=0===n?i.slice(0,t.length):i.slice(-1*t.length);if(r.restTypes.length>0){for(var o=r.headTypes.length;o<i.length;o+=1){var a=Ty(t[o]),s="".concat(a,"1,").concat(a,"2,... ");i[o]=s+i[o]}1===r.restTypes.length&&i.push(i[r.headTypes.length])}return i}(e.ParamsHelp,u,l,r),p=function(e,t){return e.filter((function(e){return"..."!==e})).slice(0,t.length).map((function(e){return function(e){if(e.startsWith("[")&&!e.endsWith("]"))return e+"]";if(!e.startsWith("[")&&e.endsWith("]"))return"["+e;return e}(e)}))}(c,f);return{signatureParams:Py(c,Ry(n,u.length,l)),descriptions:f,descriptionParams:Py(p,Cy(n,p.length,l)),exampleParams:null!==d?Py(d,Cy(n,d.length,l,!0)):null,exampleDescription:""}}(e,t,r,l,i,o,a,s)})),activeSignature:0,listSeparator:o,isUDF:e.IsDynamicUdf,helpID:e.HelpId}}function Cy(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var o=t-1,a=r.restTypes.length,s=r.headTypes.length;if(e<s+a)return e;if(e>=s&&0===a)return-1;var l=(e-s)%a;return n?e<=o-r.tailTypes.length?e:o-r.tailTypes.length-(a-1)+l:s+(i&&0===l&&r.tailTypes.length>0?a:l)}function Ry(e,t,r){var n=Cy(e,t,r);return Ny(e,r)&&(n+=1),n}function by(e,t,r){return 1+Math.max(Math.floor((e-t)/r),0)}function Ny(e,t){return t.restTypes.length>0&&e>=t.headTypes.length+t.restTypes.length}function Ty(e){return e.match(/[^0-9\[\]]+/)}function Py(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}var Ey=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ay.getValue()];case 1:return[4,e.sent().loadPluginScript("formula-authoring-strings",!0)];case 2:return e.sent(),[2]}}))}))})),ky=new Ch,Oy=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return e=WS.instance(),My.getValue()?[4,Ey.getValue()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,e.recalcServiceAttached()];case 3:return t.sent(),[2,e]}}))}))})),Ay=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,ky];case 1:return[2,HS(e.sent())]}}))}))})),Iy=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ay.getValue()];case 1:return[2,e.sent().createPluginThread("worker")]}}))}))})),_y=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Iy.getValue()];case 1:return e.sent(),[2]}}))}))})),Fy=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return fe("Microsoft.Office.Excel.AutoCompleteOnMainThread")?[4,Ay.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,Iy.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[2,e]}}))}))})),My=new Ef((function(){return!fe("Microsoft.Office.Excel.FormulaAssistanceRedesign")&&pe("OfficeVSO:7549315_ArgumentAssistance")})),Dy=function(){function e(){this.factoryName=bh.ArgumentAssistancePlugin}return e.prototype.create=function(){return new wy},e}(),wy=function(){function e(){this.timer=$g,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v;return Object(gu.__generator)(this,(function(S){switch(S.label){case 0:return this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map,[4,{kind:mg.GetActiveCell}];case 1:return(t=S.sent()).kind!==mg.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(this.addTimeStamp("GetActiveCell"),[4,{kind:mg.ParseActiveCell,formulaText:e.content}]);case 2:return r=S.sent(),this.addTimeStamp("ParseCellContentSync"),void 0!==r&&r.kind===mg.ParseActiveCell&&ge(r.result)?[3,4]:[4,{kind:mg.ParseEdit,cell:t.activeCell,formulaBarText:e.content}];case 3:if(r=S.sent(),this.addTimeStamp("ParseCellContentAsync"),r.kind!==mg.ParseEdit||!ge(r.result))return[2,null];S.label=4;case 4:return r.result.value.kind!==ma.Formula?[2,null]:(n=r.result.value.formula,i=new Sy(n,e.caretPosition),co(i,n),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===i.assistedFunctionHead?(this.logTimeStamp(),[2,null]):[4,{kind:mg.GetFunctionInfo,functionName:i.assistedFunctionHead.whole}]);case 5:return o=S.sent(),this.addTimeStamp("GetFunctionInfo"),o.kind!==mg.GetFunctionInfo?(this.logFailure("failed to get function info for ".concat(i.assistedFunctionHead.whole)),[2,null]):[4,{kind:mg.GetConfig}];case 6:return a=S.sent(),this.addTimeStamp("GetConfig"),s=a.kind===mg.GetConfig?a.config.localeInfo.listSeparator:",",l=new Ef((function(){return yy(o.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,i.assistedFunctionHead.id,s)})),u=vy.getValue()[i.assistedFunctionHead.id],this.addTimeStamp("GetExampleString"),void 0===u?(this.logFailure("no example found for function: ".concat(i.assistedFunctionHead.whole,", id: ").concat(i.assistedFunctionHead.id)),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),[2,l.getValue()]):[4,{kind:mg.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:u,kind:eg.CellFormula},useEnglishLocaleInfo:!0}];case 7:return c=S.sent(),this.addTimeStamp("ParseExample"),c.kind===mg.ParseCellFormula&&ge(c.result)?a.kind===mg.GetConfig&&a.config.localeInfo.lcid===ni.USA?(f=yy(o.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,i.assistedFunctionHead.id,s,u,c.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),[2,f]):[4,{kind:mg.PrintFormula,formula:c.result.value,origin:t.activeCell}]:(this.logFailure("failed to parse example for function: ".concat(i.assistedFunctionHead.whole)),d=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),[2,d]);case 8:return p=S.sent(),this.addTimeStamp("localize example string"),p.kind===mg.PrintFormula&&ge(p.result)?[4,{kind:mg.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:p.result.value,kind:eg.CellFormula},useEnglishLocaleInfo:!1}]:(this.logFailure("failed to pretty print localized example for function: ".concat(i.assistedFunctionHead.whole)),m=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),[2,m]);case 9:return h=S.sent(),this.addTimeStamp("parse localized example string"),h.kind===mg.ParseCellFormula&&ge(h.result)?(v=yy(o.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,i.assistedFunctionHead.id,s,p.result.value,h.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),[2,v]):(this.logFailure("failed to parse localized example for function: ".concat(i.assistedFunctionHead.whole)),g=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),[2,g])}}))},e.prototype.logFailure=function(e){Ei.ULS.traceTag(545388683,ii.msoulscat_ES_EWAJS,ci.Warning,"ArgumentAssistancePlugin encountered a failure with msg ".concat(e))},e.prototype.addTimeStampAndLog=function(e){this.addTimeStamp(e),this.logTimeStamp()},e.prototype.logTimeStamp=function(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);var e={};this.timeStamps.forEach((function(t,r){e[r]=t})),Ei.ULS.traceTag(540377222,ii.msoulscat_ES_EWAJS,ci.Info,"".concat(JSON.stringify(e)))},e.prototype.addTimeStamp=function(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()},e}();zg(new Dy);var Ly=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return fe("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?[4,Ay.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,Iy.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[4,e.loadPluginScript("formula-authoring-strings",!0)];case 5:return t.sent(),[4,e.createAndAttachPlugin(bh.ArgumentAssistancePlugin)];case 6:return t.sent(),[4,Oy.getValue()];case 7:return t.sent(),[2]}}))}))})),xy=function(e){function t(t,r,n,i,o){var a=e.call(this)||this;return a.parsedFormulaTree=t,a.caretPosition=r,a.formulaString=n,a.autoCompleteAfterFunctionNameEnabled=i,a.autoCompleteForCellRefEnabled=o,a.autoCompleteFixForArrayNodesEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled"),a}return Object(gu.__extends)(t,e),t.prototype.nameNode=function(e,t,r){return(this.autoCompleteAfterFunctionNameEnabled?this.nameNode_NEW.bind(this):this.nameNode_OLD.bind(this))(e,t,r)},t.prototype.nameNode_NEW=function(t,r,n){return t.kind!==Ot.IdentNamePart&&t.kind!==Ot.FieldRefNamePart||this.updateAutocompleteString(n,t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t.prototype.nameNode_OLD=function(t,r,n){var i,o,a;return t.kind===Ot.IdentNamePart&&(null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end)===this.caretPosition&&(this.autocompleteString=t.asWhole,this.stringStartPosition=null===(o=this.parsedFormulaTree.spans[n])||void 0===o?void 0:o.start,this.stringEndPosition=null===(a=this.parsedFormulaTree.spans[n])||void 0===a?void 0:a.end),e.prototype.nameNode.call(this,t,r,n)},t.prototype.appNode=function(t,r,n,i){return this.autoCompleteForCellRefEnabled&&t.kind===At.WSF&&this.updateAutocompleteString(i,t.whole),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.arrayNode=function(t,r,n){var i=this.parsedFormulaTree.spans[n];return this.autoCompleteFixForArrayNodesEnabled&&i&&this.caretPosition<=i.end&&this.caretPosition>=i.start&&(this.autocompleteString=void 0,this.stringEndPosition=void 0,this.stringStartPosition=void 0),e.prototype.arrayNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i=this.parsedFormulaTree.spans[n];if(this.autoCompleteAfterFunctionNameEnabled&&t.kind===Et.Single&&i){var o=this.formulaString.substring(i.start,i.end);this.updateAutocompleteString(n,o)}return e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.updateAutocompleteString=function(e,t){var r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)},t}(oo),By=function(){function e(){this.factoryName=bh.AutocompleteFunctionPlugin}return e.prototype.create=function(){return new Uy},e}(),Uy=function(){function e(){this.autoCompleteForCellRefEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.autoCompleteAfterFunctionNameEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:6128020_AutoCompleteAfterFunctionName")}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v;return Object(gu.__generator)(this,(function(S){switch(S.label){case 0:return[4,{kind:mg.ParseActiveCell,formulaText:e.content}];case 1:return(t=S.sent()).kind===mg.ParseActiveCell&&ge(t.result)?t.result.value.kind!==ma.Formula?[2,null]:(r=t.result.value.formula,n=new xy(r,e.caretPosition,e.content,this.autoCompleteAfterFunctionNameEnabled,this.autoCompleteForCellRefEnabled),co(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition?[2,null]:(i=n.autocompleteString.toUpperCase(),o=n.stringStartPosition,a=n.stringEndPosition,[4,{kind:mg.GetFunctionsInfo}])):[2,null];case 2:return(s=S.sent()).kind!==mg.GetFunctionsInfo?(this.logFailure("failed to get functions info"),[2,null]):(l=s.functionsInfo,u=rv(i,l,(function(e){return e.NameDataStrings})),c=u.prefixedSuggestions,d=u.notPrefixedSuggestions,null!==(f=Cv.getValue())&&null!==f.descriptionsMap||this.logFailure("failed to get short descriptions, will show function info help description"),p="("===(null===(v=e.content)||void 0===v?void 0:v.charAt(a)),m=p?"":"(",h=this.generateCompletionItems(c,f,o,a,!0,m),g=this.generateCompletionItems(d,f,o,a,!1,m),[2,{items:Object(gu.__spreadArray)(Object(gu.__spreadArray)([],h,!0),g,!0)}])}}))},e.prototype.generateCompletionItems=function(e,t,r,n,i,o){var a=[],s=e.map((function(e){var s,l=null===(s=t.descriptionsMap)||void 0===s?void 0:s.get(e.FunctionIndexInServer);return N(l)&&(a.push(e.FunctionIndexInServer),l=e.Help),{label:e.NameDataStrings,kind:Zg.Function,detail:l,textEdit:{newText:e.NameDataStrings+o,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:i}}));return a.length>0&&Ei.ULS.traceTag(508871621,ii.msoulscat_ES_EWAJS,ci.Info,"AutocompleteFunctionPlugin missing short descriptions for func IDs: ".concat(JSON.stringify(a))),s},e.prototype.logFailure=function(e){Ei.ULS.traceTag(539083013,ii.msoulscat_ES_EWAJS,ci.Warning,"AutocompleteFunctionPlugin encountered a failure with msg ".concat(e))},e}();zg(new By);var Gy=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return[4,Fy.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("formula-authoring-strings",!0)];case 2:return t.sent(),[4,e.createAndAttachPlugin(bh.AutocompleteFunctionPlugin)];case 3:return t.sent(),[4,Oy.getValue()];case 4:return t.sent(),[2]}}))}))})),Ky=function(e){function t(t,r,n,i){var o=e.call(this,n,i)||this;return o.autoCompleteForCellRefEnabled=t,o.formulaString=r,o}return Object(gu.__extends)(t,e),t.prototype.nameNode=function(t,r,n){return this.updateCaretNodeText(n,t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i=this.formula.spans[n];if(this.autoCompleteForCellRefEnabled&&t.kind===Et.Single&&i){var o=this.formulaString.substring(i.start,i.end);this.updateCaretNodeText(n,o)}return e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.updateCaretNodeText=function(e,t){var r,n=null===(r=this.formula.spans[e])||void 0===r?void 0:r.end;void 0!==n&&this.caretPosition===n&&t.length>0&&(this.caretNodeText=t)},t}(Xo),Vy=function(){function e(){this.factoryName=bh.AutocompleteLetPlugin}return e.prototype.create=function(){return new jy},e}(),jy=function(){function e(){this.autoCompleteForCellRefEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m;return Object(gu.__generator)(this,(function(h){switch(h.label){case 0:return[4,{kind:mg.ParseActiveCell,formulaText:e.content}];case 1:return(t=h.sent()).kind===mg.ParseActiveCell&&ge(t.result)?t.result.value.kind!==ma.Formula?[2,null]:(r=t.result.value.formula,n=e.caretPosition,i=new Ky(this.autoCompleteForCellRefEnabled,e.content,r,n),co(i,r),o=i.references.reverse(),a=Array.from(new Set(o)),void 0===(s=i.caretNodeText)?[2,null]:(u=(l=n)-s.length,c=rv(s,a),d=c.prefixedSuggestions,f=c.notPrefixedSuggestions,p=this.stringsToCompletionItems(d,u,l,!0),m=this.stringsToCompletionItems(f,u,l,!1),[2,{items:Object(gu.__spreadArray)(Object(gu.__spreadArray)([],p,!0),m,!0)}])):[2,null]}}))},e.prototype.stringsToCompletionItems=function(e,t,r,n){return e.map((function(e){return{label:e,kind:Zg.LetVariable,type:ev.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))},e}();zg(new Vy);var Wy=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Fy.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteLetPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),Hy=function(){function e(){}return e.MaxRow=1048575,e.MaxColumn=16383,e}();function Qy(e,t){var r=t.nameToIndex.getValue(e);if(b(r))return t.sheets[r].sheetIndex}function qy(e,t){return e.kind===_t.Sheet?e.sheet:e.kind===_t.Ident?e.name:(b(t)&&t("getSheetNameFromQualifier unexpected qualifier kind: ".concat(e.kind)),"")}function zy(e,t,r){switch(e.kind){case Et.Single:var n=Yy(e.row,t.row),i=Yy(e.col,t.col);return{FirstRow:n,FirstColumn:i,LastRow:n,LastColumn:i};case Et.Range:return{FirstRow:Yy(e.ref1.row,t.row),FirstColumn:Yy(e.ref1.col,t.col),LastRow:Yy(e.ref2.row,t.row),LastColumn:Yy(e.ref2.col,t.col)};case Et.Col:return{FirstRow:0,FirstColumn:Yy(e.col1,t.col),LastRow:Hy.MaxRow,LastColumn:Yy(e.col2,t.col)};case Et.Row:return{FirstRow:Yy(e.row1,t.row),FirstColumn:0,LastRow:Yy(e.row2,t.row),LastColumn:Hy.MaxColumn};default:b(r)&&r("getRangeFromCellRef unexpected CellRefKind: ".concat(e.kind))}}function Yy(e,t){return e.index+(e.kind===It.Rel?t:0)}var Jy=function(e){function t(t,r,n,i,o){var a=e.call(this)||this;return a.parsedFormulaTree=t,a.caretPosition=r,a.formulaText=n,a.definedNames=i,a.activeCell=o,a.dotNotationPath="",a.richValueItemPrefix="",a.dotNotationIndex=0,a.shouldAddEmptySuggestion=!1,a.onlySendNestedDotNotationPathEnabled=pe("OfficeVSO:6476056_OnlySendNestedDotNotationPath"),a.passLogFunctionToGetRangeFromCellRef=Object(ce.isChangeGateEnabled)("OfficeVSO:7251290_PassLogFunctionToGetRangeFromCellRef"),a}return Object(gu.__extends)(t,e),t.prototype.nameNode=function(t,r,n){var i,o,a,s=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end;if(s===this.caretPosition&&t.kind===Ot.IdentNamePart&&this.trySetDefinedName(t)&&(this.dotNotationIndex=s,this.childFieldRefLabel=n),t.kind===Ot.FieldRefNamePart){var l=null===(o=this.parsedFormulaTree.spans[t.lhs.label])||void 0===o?void 0:o.end;if(b(l)&&(this.caretPosition===s||this.isCaretAfterDotBeforeStartOfFieldRef(l,t.rhs)&&t.lhs.kind!==Ot.FieldRefNamePart)){var u=!1;t.lhs.kind===Ot.CellRefNamePart?(this.setCellRef(t.lhs.ref,r),u=!0):t.lhs.kind===Ot.IdentNamePart&&this.trySetDefinedName(t.lhs)&&(u=!0),u&&(this.dotNotationIndex=l,(null===(a=t.rhs)||void 0===a?void 0:a.field.kind)===At.Name&&(this.caretPosition===s?this.richValueItemPrefix=t.rhs.field.whole:this.fieldRefChainEndIndex=s))}}return e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i,o=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end;return void 0!==o&&this.caretPosition===o&&(this.setCellRef(t,r),this.dotNotationIndex=o,this.childFieldRefLabel=n,this.shouldAddEmptySuggestion=!0),e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.fieldRefNode=function(t,r,n,i){var o,a,s=null===(o=this.parsedFormulaTree.spans[i])||void 0===o?void 0:o.end,l=null===(a=this.parsedFormulaTree.spans[t.label])||void 0===a?void 0:a.end;return void 0===s||void 0===l||(this.isCaretAtEndOfFieldRefNode(s,r)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(t,i),this.dotNotationIndex=l,this.richValueItemPrefix=Xy(r)):this.isCaretAfterDotBeforeStartOfFieldRef(l,r)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(t,i),this.dotNotationIndex=l,this.fieldRefChainEndIndex=s):t.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=s,this.childFieldRefLabel=i)),e.prototype.fieldRefNode.call(this,t,r,n,i)},t.prototype.structRefNode=function(t,r,n){var i,o=e.prototype.structRefNode.call(this,t,r,n),a=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end;this.caretPosition===a&&b(t)&&r.isClosed&&o.kind===At.StructRef&&(this.definedNames.some((function(e){return 0===e.type&&b(e.name)&&e.name.toLowerCase()===t.whole.toLowerCase()}))&&(this.setNamedNodeRef(o),this.dotNotationIndex=a));return o},t.prototype.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath=function(e,t){for(var r=e;r.kind===At.FieldRef;)this.dotNotationPath="["+Xy(r.rhs)+"]."+this.dotNotationPath,r=r.lhs;r.kind===At.CellRef&&this.setCellRef(r.ref,r.qualifier),r.kind===At.StructRef&&this.setNamedNodeRef(r),r.kind===At.Name&&this.trySetDefinedName(r.parts),this.childFieldRefLabel=t},t.prototype.getRefString=function(e){var t,r,n=null===(t=this.parsedFormulaTree.spans[e])||void 0===t?void 0:t.start,i=null===(r=this.parsedFormulaTree.spans[e])||void 0===r?void 0:r.end;return b(n)&&b(i)&&n>=0&&i<this.formulaText.length?this.formulaText.substring(n,i):""},t.prototype.setCellRef=function(e,t){var r=this;e.kind!==Et.Single&&e.kind!==Et.Range||(this.cellRef=zy(e,this.activeCell,this.passLogFunctionToGetRangeFromCellRef?$y:void 0)),b(t)&&(this.sheetName=qy(t,$y)),this.trySetDotNotationPathOrigin((function(){return r.getRefString(e.label)}))},t.prototype.setNamedNodeRef=function(e){var t=this;this.namedRangeNode=e,this.trySetDotNotationPathOrigin((function(){return t.getRefString(e.label)}))},t.prototype.isCaretAfterDotBeforeStartOfFieldRef=function(e,t){var r;if(!b(t))return!1;var n=null===(r=this.parsedFormulaTree.spans[t.field.label])||void 0===r?void 0:r.start;return void 0!==n&&this.caretPosition>e&&(this.caretPosition<n||!t.isBracketed&&this.caretPosition===n)},t.prototype.isCaretAtEndOfFieldRefNode=function(e,t){var r;if(this.caretPosition===e)return!0;var n=null===(r=this.parsedFormulaTree.spans[t.field.label])||void 0===r?void 0:r.end;return!(!b(n)||this.caretPosition!==n)},t.prototype.trySetDefinedName=function(e){if(e.canDenoteNamedObject){var t=this.definedNames.find((function(t){var r;return(null===(r=t.name)||void 0===r?void 0:r.toLowerCase())===e.asWhole.toLowerCase()}));if(b(t))return this.setDefinedName(t),!0}return!1},t.prototype.setDefinedName=function(e){var t,r=e.namedRange;if(b(r)){var n=null!==(t=e.sheetName)&&void 0!==t?t:r.sheetName;b(n)&&(this.sheetName=n),this.cellRef={FirstRow:r.top-1,FirstColumn:r.left-1,LastRow:r.bottom-1,LastColumn:r.right-1},this.trySetDotNotationPathOrigin((function(){return e.name}))}},t.prototype.trySetDotNotationPathOrigin=function(e){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){var t=e();b(t)?this.dotNotationPath=t+"."+this.dotNotationPath:$y("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=e()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")},t}(oo);function Xy(e){return e.field.kind!==At.Name?"":e.field.whole}function $y(e){Ei.ULS.traceTag(523257827,ii.msoulscat_ES_EWAJS,ci.Warning,"AutocompleteRichValueVisitor failed with msg: ".concat(e))}var Zy=r(55),eC=Ho.parseFieldRefModule.isUnbracketedField,tC=(Ho.parseFieldRefModule.parseFieldRef,function(){function e(){this.factoryName=bh.AutocompleteRichValuePlugin}return e.prototype.create=function(){return new rC},e}()),rC=function(){function e(){this.dontAlwaysAddBracketsEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets")}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,T,P,E,k,O,A;return Object(gu.__generator)(this,(function(I){switch(I.label){case 0:return N(e.content)||N(e.caretPosition)?(nC("missing request arguments"),[2,null]):[4,{kind:mg.ParseActiveCell,formulaText:e.content}];case 1:return(t=I.sent()).kind===mg.ParseActiveCell&&ge(t.result)?t.result.value.kind!==ma.Formula?[2,null]:(r=t.result.value.formula,[4,{kind:mg.GetDefinedNamesInfo}]):[2,null];case 2:return(n=I.sent()).kind!==mg.GetDefinedNamesInfo?(nC("failed to get named objects info"),[2,null]):[4,{kind:mg.GetActiveCell}];case 3:return(i=I.sent()).kind!==mg.GetActiveCell?(nC("failed to get active cell"),[2,null]):(o=i.activeCell,a=new Jy(r,e.caretPosition,e.content,n.definedNamesInfo,o.range),co(a,r),l=void 0,b(a.cellRef)?(s=a.cellRef,l=o.sheet.index,[3,6]):[3,4]);case 4:return b(a.namedRangeNode)?(u={originGridCell:Se(o.range),originSheet:Se(o.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:mg.ResolveReferences,nodes:[a.namedRangeNode],locals:u}]):[3,6];case 5:(c=I.sent()).kind===mg.ResolveReferences&&(d=c.resolverResults[0]).kind===Ki.ResolvedStructRef&&ge(d.resolution)&&void 0!==d.resolution.value&&(f=d.resolution.value.range,s={FirstRow:f.row,FirstColumn:f.col,LastRow:f.row+f.rows-1,LastColumn:f.col+f.cols-1},l=d.resolution.value.sheet.index),I.label=6;case 6:return b(s)?(p=a.dotNotationPath,N(p)?(nC("failed to parse cellRef"),[2,null]):(m="",b(a.sheetName)?(m=a.sheetName,[3,9]):[3,7])):[2,null];case 7:return[4,{kind:mg.GetSheetNames}];case 8:if((h=I.sent()).kind!==mg.GetSheetNames)return nC("failed to get sheet names"),[2,null];if(!En(o.sheet.document,h.document))return nC("sheet names document is different than that of active cell"),[2,null];if(!b(l))return nC("sheet index is undefined"),[2,null];m=h.sheets[h.idToIndex[l]].sheetName,I.label=9;case 9:return g=Object(gu.__assign)(Object(gu.__assign)({},s),{SheetName:m,NamedObjectName:""}),[4,{kind:mg.GetRichValueFieldListContext,rangeToQuery:g,dotNotationPath:p,singleColumn:!1,findRange:!1}];case 10:return(v=I.sent()).kind!==mg.GetRichValueFieldListContext?(nC("failed to get field list context data"),[2,null]):N(v.result)||0===v.result.length?[2,null]:(v.result.length>1&&nC("fieldListContextRequest results length greater than 1"),S=rv(a.richValueItemPrefix,v.result[0].FieldInfoDataList.map((function(e){return e.Name})),void 0,!0),y=S.prefixedSuggestions,C=S.notPrefixedSuggestions,[4,{kind:mg.GetConfig}]);case 11:return R=I.sent(),T=this.resultsToCompletionItems(y,!0,a.dotNotationIndex,null!==(k=a.fieldRefChainEndIndex)&&void 0!==k?k:e.caretPosition,R,!!a.namedRangeNode),P=this.resultsToCompletionItems(C,!1,a.dotNotationIndex,null!==(O=a.fieldRefChainEndIndex)&&void 0!==O?O:e.caretPosition,R,!!a.namedRangeNode),E=Object(gu.__spreadArray)(Object(gu.__spreadArray)([],T,!0),P,!0),a.shouldAddEmptySuggestion&&(E=Object(gu.__spreadArray)([(_=a.dotNotationIndex,F=null!==(A=a.fieldRefChainEndIndex)&&void 0!==A?A:e.caretPosition,{label:"",kind:Zg.RichEntityEmptyCellRef,detail:"",textEdit:{newText:"",range:{start:{line:0,character:_},end:{line:0,character:F}}},isPrefixed:!0})],E,!0)),[2,{items:E}]}var _,F}))},e.getTextToCommit=function(e,t,r,n){var i=e;if(i=(i=(i=i.replace("'","''")).replace("[","'[")).replace("]","']"),r){if(n)return".[".concat(i,"]");var o=t.kind===mg.GetConfig?t.config.localeInfo:void 0;return o&&!eC(o,i)?".[".concat(i,"]"):".".concat(i)}return".[".concat(i,"]")},e.prototype.resultsToCompletionItems=function(t,r,n,i,o,a){var s=this;return t.map((function(t){return{label:t,kind:Zg.RichEntity,detail:"",textEdit:{newText:e.getTextToCommit(t,o,s.dontAlwaysAddBracketsEnabled,a),range:{start:{line:0,character:n},end:{line:0,character:i}}},isPrefixed:r}}))},e}();function nC(e){M.ULS.traceTag(529056660,Zy.LogCategory.msoulscat_ES_EWAJS,Zy.TraceLevel.Warning,"AutocompleteRichValuePlugin encountered a failure with msg ".concat(e))}zg(new tC);var iC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ay.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteRichValuePlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),oC=function(){function e(){this.factoryName=bh.AutocompleteNamedObjectsPlugin}return e.prototype.create=function(){return new aC},e}(),aC=function(){function e(){this.autoCompleteForCellRefEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.autoCompleteAfterFunctionNameEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:6128020_AutoCompleteAfterFunctionName")}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p;return Object(gu.__generator)(this,(function(m){switch(m.label){case 0:return[4,{kind:mg.ParseActiveCell,formulaText:e.content}];case 1:return(t=m.sent()).kind===mg.ParseActiveCell&&ge(t.result)?t.result.value.kind!==ma.Formula?[2,null]:(r=t.result.value.formula,[4,{kind:mg.GetDefinedNamesInfo}]):[2,null];case 2:return(n=m.sent()).kind!==mg.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(i=n.definedNamesInfo,o=new xy(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled,this.autoCompleteAfterFunctionNameEnabled),co(o,r),a=o.autocompleteString,s=o.stringStartPosition,l=o.stringEndPosition,b(a)&&b(l)&&b(s)?(u=rv(a,i,(function(e){return e.name})),c=u.prefixedSuggestions,d=u.notPrefixedSuggestions,f=this.namesToCompletionItems(c,s,l,!0),p=this.namesToCompletionItems(d,s,l,!1),[2,{items:Object(gu.__spreadArray)(Object(gu.__spreadArray)([],f,!0),p,!0)}]):[2,null])}}))},e.prototype.namesToCompletionItems=function(e,t,r,n){return e.filter((function(e){return-1!==e.type})).map((function(e){return{label:e.name,kind:1===e.type?Zg.NamedRange:Zg.Table,type:ev.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n}}))},e.prototype.logFailure=function(e){Ei.ULS.traceTag(528562134,ii.msoulscat_ES_EWAJS,ci.Warning,"AutocompleteNamedObjectPlugin encountered a failure with msg ".concat(e))},e}();zg(new oC);var sC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Fy.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteNamedObjectsPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),lC=function(e){function t(t,r,n){var i=e.call(this)||this;return i.parsedFormulaTree=t,i.caretPosition=r,i.tableNames=n,i.isWithinThisRowOp=!1,i.findContainingNode=function(e){var t=i.parsedFormulaTree.spans[e.label];if(i.isCaretInNode(e))switch(e.kind){case Dt.SpecialRef:case Dt.ColumnRef:case Dt.BadRef:i.isTighterThanCurrent(t)&&(i.containingNode=t);break;case Dt.ThisRowOpRef:var r=e.ref;i.isWithinThisRowOp=!0,b(r)?i.findContainingNode(r):i.isTighterThanCurrent(t)&&(i.containingNode=t);break;case Dt.CommaOpRef:e.refs.map(i.findContainingNode);break;case Dt.RangeOpRef:var n=e;i.findContainingNode(n.lhs),i.findContainingNode(n.rhs);break;case Dt.MissingRef:i.containingNode=void 0}},i.isTighterThanCurrent=function(e){return b(e)&&(N(i.containingNode)||e.end<i.containingNode.end||e.start>i.containingNode.start)},i}return Object(gu.__extends)(t,e),t.prototype.structRefNode=function(t,r,n){var i=this;return this.isCaretInNode(r)&&(t&&this.tableNames.forEach((function(e){e.toLocaleLowerCase()===t.whole.toLocaleLowerCase()&&(i.tableName=e)})),void 0===r.innerRef?this.containingNode=this.parsedFormulaTree.spans[r.label]:this.findContainingNode(r.innerRef)),e.prototype.structRefNode.call(this,t,r,n)},t.prototype.isCaretInNode=function(e){var t=this.parsedFormulaTree.spans[e.label];return b(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start},t}(oo),uC=function(){function e(){this.factoryName=bh.AutocompleteTableHeadersPlugin}return e.prototype.create=function(){return new cC},e}(),cC=function(){function e(){var e=this;this.getTableHeadersFromServerEnabled=pe("OfficeVSO:7396249_getTableHeadersFromServer"),this.isBehaviorFixEnabled=pe("OfficeVSO:7740479_TableHeadersAutocompleteBehaviorFix_2"),this.getCompletionItems=function(t,r,n,i,o,a){var s,l="@"===r.charAt(0);if(l||o){var u=l?n+1:n,c=l?r.substring(1):r;return e.generateHeadersCompletionItems(c,t,u,i,!0)}var d=[];if(""===r){var f=null===(s=a[Mt.ThisRow])||void 0===s?void 0:s.substring(1);d.push(e.generateThisRowOpCompletionItem(n,i,f))}return d.push.apply(d,e.generateSpecialCaseCompletionItems(n,i,r,a)),d.push.apply(d,e.generateHeadersCompletionItems(r,t,n,i)),d},this.getHeaderTextEditCallback=function(t){return function(r){var n=pC(r);return t&&e.hasSpecialChars(n)?"[".concat(n,"]"):n}},this.hasSpecialChars=function(t){try{return new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u").test(t)}catch(t){return e.logFailure("hasSpecialChars method, error: ".concat(t,".")),!0}}}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C;return Object(gu.__generator)(this,(function(R){switch(R.label){case 0:return t=e.content,r=e.caretPosition,N(t)||N(r)?[2,null]:[4,{kind:mg.ParseActiveCell,formulaText:t}];case 1:return(n=R.sent()).kind===mg.ParseActiveCell&&ge(n.result)?n.result.value.kind!==ma.Formula?[2,null]:(i=n.result.value.formula,[4,{kind:mg.GetDefinedNamesInfo}]):[2,null];case 2:return(o=R.sent()).kind!==mg.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):0===(a=o.definedNamesInfo.filter((function(e){return 0===e.type})).map((function(e){return e.name})).filter(b)).length?[2,null]:(s=new lC(i,r,a),co(s,i),l=s.tableName,u=s.containingNode,N(u)?[2,null]:N(l)?[4,{kind:mg.GetActiveCell}]:[3,5]);case 3:return(c=R.sent()).kind!==mg.GetActiveCell?(this.logFailure("Couldn't get active cell"),[2,null]):[4,{kind:mg.GetContainingTable,cell:c.activeCell}];case 4:if((d=R.sent()).kind!==mg.GetContainingTable||!ge(d.result))return this.logFailure("GetContainingTable request failed. result kind = ".concat(JSON.stringify(d))),[2,null];if(l=null===(C=d.result.value)||void 0===C?void 0:C.name,N(l))return[2,null];R.label=5;case 5:return f=u.start,p=u.end,"]"!==(m=t.charAt(p-1))&&")"!==m||p--,"["===t.charAt(f)&&f++,r!==p?[2,null]:[4,{kind:mg.GetAvailableTableHeaders,tableName:l}];case 6:return(h=R.sent()).kind!==mg.GetAvailableTableHeaders||!ge(h.result)||N(h.result.value)||this.getTableHeadersFromServerEnabled&&h.result.value.isPartial?[3,7]:(g=h.result.value.cols,[3,9]);case 7:return this.getTableHeadersFromServerEnabled?(Ei.ULS.traceTag(509682331,ii.msoulscat_ES_EWAJS,ci.Info,"AutocompleteTableHeadersPlugin getting col headers from server"),[4,{kind:mg.GetFullTableHeadersFromServer,tableName:l}]):[3,9];case 8:if((v=R.sent()).kind!==mg.GetFullTableHeadersFromServer||!b(v.result))return this.logFailure("Failed to get header names from server"),[2,null];g=v.result,R.label=9;case 9:return b(g)&&0!==g.length?(S=t.substring(f,p),[4,{kind:mg.GetConfig}]):[2,null];case 10:return(y=R.sent()).kind!==mg.GetConfig?(this.logFailure("getConfig request failed"),[2,null]):[2,{items:this.getCompletionItems(g,S,f,p,s.isWithinThisRowOp,y.config.localeInfo.specialRefNames)}]}}))},e.prototype.generateCompletionItems=function(e,t,r,n,i,o){var a=[];return e.forEach((function(e){var s="string"==typeof e,l=s?e:e.name,u=s?void 0:e.description;a.push({label:l,kind:i,type:ev.Simple,textEdit:{newText:b(o)?o(l):l,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:u,isPrefixed:n})})),a},e.prototype.generateHeadersCompletionItems=function(e,t,r,n,i){void 0===i&&(i=!1);var o=rv(e,t),a=o.prefixedSuggestions,s=o.notPrefixedSuggestions,l=this.isBehaviorFixEnabled?this.getHeaderTextEditCallback(i):void 0;return Object(gu.__spreadArray)(Object(gu.__spreadArray)([],this.generateCompletionItems(a,r,n,!0,Zg.TableHeader,l),!0),this.generateCompletionItems(s,r,n,!1,Zg.TableHeader,l),!0)},e.prototype.generateSpecialCaseCompletionItems=function(e,t,r,n){var i=rv(r,[Mt.All,Mt.Data,Mt.Headers,Mt.Totals].map((function(e){var t;return{name:null!==(t=n[e])&&void 0!==t?t:"",description:fC.getValue()[e]}})),(function(e){return e.name})),o=i.prefixedSuggestions,a=i.notPrefixedSuggestions;return Object(gu.__spreadArray)(Object(gu.__spreadArray)([],this.generateCompletionItems(o,e,t,!0,Zg.TableSpecialStructRef),!0),this.generateCompletionItems(a,e,t,!1,Zg.TableSpecialStructRef),!0)},e.prototype.generateThisRowOpCompletionItem=function(e,t,r){return{label:"@ - ".concat(r),kind:Zg.TableSpecialStructRef,type:ev.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStrings.ThisRowOpDescription,shouldRequestAutocompleteOnCommit:!0}},e.prototype.logFailure=function(e){Ei.ULS.traceTag(526508764,ii.msoulscat_ES_EWAJS,ci.Warning,"AutocompleteTableHeadersPlugin encountered a failure with msg ".concat(e))},e}();zg(new uC);var dC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return pe("OfficeVSO:7396249_getTableHeadersFromServer")?[4,Ay.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,Fy.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[4,e.createAndAttachPlugin(bh.AutocompleteTableHeadersPlugin)];case 5:return t.sent(),[4,Oy.getValue()];case 6:return t.sent(),[2]}}))}))})),fC=new Ef((function(){var e;return(e={})[Mt.All]=FormulaAuthoringStrings.SpecialRefAllDescription,e[Mt.Data]=FormulaAuthoringStrings.SpecialRefDataDescription,e[Mt.Headers]=FormulaAuthoringStrings.SpecialRefHeadersDescription,e[Mt.Totals]=FormulaAuthoringStrings.SpecialRefTotalsDescription,e[Mt.ThisRow]=FormulaAuthoringStrings.ThisRowOpDescription,e})),pC=function(e){return e.replace(/\[|\]|\'|\@|\#/g,"'$&")},mC=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.parenthesesSpan=void 0,n.checkLeft=!1,n.checkRight=!1,n.areParenthesesLeftOfCaret=!1,n.isUpdatedParenthesesCouplingLogicEnabled=Object(ce.isChangeGateEnabled)("OfficeVSO:7173684_updatedParenthesesCouplingLogic"),n}return Object(gu.__extends)(t,e),t.prototype.appNode=function(t,r,n,i){return t.kind!==At.Operator&&this.matchFormula(t,n,i),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.parenNode=function(t,r,n){var i=this.formula.spans[n];return r&&i&&this.matchParentheses(i.start,i.end-1),e.prototype.parenNode.call(this,t,r,n)},t.prototype.letNode=function(t,r,n,i,o,a){return this.matchFormula(t,o,a),e.prototype.letNode.call(this,t,r,n,i,o,a)},t.prototype.lambdaNode=function(t,r,n,i,o,a){return this.matchFormula(t,o,a),e.prototype.lambdaNode.call(this,t,r,n,i,o,a)},t.prototype.matchFormula=function(e,t,r){var n=this.formula.spans[r],i=this.formula.spans[e.label];t&&n&&i&&this.matchParentheses(i.end,n.end-1)},t.prototype.matchParentheses=function(e,t){e===this.caretPosition&&(this.checkRight=!0),t===this.caretPosition-1&&(this.checkLeft=!0),this.isUpdatedParenthesesCouplingLogicEnabled&&this.checkRight&&this.shouldUpdateLocation(e,t,this.caretPosition+1)||this.shouldUpdateLocation(e,t,this.caretPosition)?(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!1):this.isUpdatedParenthesesCouplingLogicEnabled&&this.checkLeft&&this.shouldUpdateLocation(e,t,this.caretPosition-1)&&(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!0)},t.prototype.shouldUpdateLocation=function(e,t,r){return e<r&&r<=t&&(void 0===this.parenthesesSpan||this.areParenthesesLeftOfCaret&&e<=this.parenthesesSpan.start||e>this.parenthesesSpan.start)},t}(oo),hC=function(){function e(){this.factoryName=bh.ParenthesesCouplingPlugin}return e.prototype.create=function(){return new gC},e}(),gC=function(){function e(){}return e.prototype.run=function(e){var t,r,n;return Object(gu.__generator)(this,(function(i){switch(i.label){case 0:return null!=e.selectionLength&&e.selectionLength>0?[2,null]:[4,{kind:mg.ParseActiveCell,formulaText:e.content}];case 1:return(t=i.sent()).kind===mg.ParseActiveCell&&ge(t.result)?t.result.value.kind!==ma.Formula?[2,null]:(r=t.result.value.formula,n=new mC(r,e.caretPosition),co(n,r),b(n.parenthesesSpan)?[2,this.getParenthesesHighlights(n.parenthesesSpan)]:[2,{formulaHighlights:void 0}]):[2,null]}}))},e.prototype.getParenthesesHighlights=function(e){var t=e.start,r=e.end,n={kind:Eh.Parentheses,span:{start:t,end:t+1}};return{formulaHighlights:[{kind:Eh.Parentheses,span:{start:r,end:r+1}},n]}},e}();zg(new hC);var vC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ay.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(bh.ParenthesesCouplingPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),SC={Abs:Oh.Absolute,Rel:Oh.Relative};function yC(e){switch(e.kind){case Et.Col:return function(e){return{firstRow:Oh.Relative,firstColumn:SC[e.col1.kind],secondRow:Oh.Relative,secondColumn:SC[e.col2.kind]}}(e);case Et.Row:return function(e){return{firstRow:SC[e.row1.kind],firstColumn:Oh.Relative,secondRow:SC[e.row2.kind],secondColumn:Oh.Relative}}(e);case Et.Single:return function(e){var t,r;return{firstRow:t=SC[e.row.kind],firstColumn:r=SC[e.col.kind],secondRow:t,secondColumn:r}}(e);case Et.Range:return function(e){return{firstRow:SC[e.ref1.row.kind],firstColumn:SC[e.ref1.col.kind],secondRow:SC[e.ref2.row.kind],secondColumn:SC[e.ref2.col.kind]}}(e)}}var CC=function(e){function t(t,r,n,i,o,a){var s=e.call(this)||this;return s.activeCell=t,s.parsedFormulaTree=r,s.formulaString=n,s.sheetNames=i,s.definedNameInfoList=o,s.failureCallback=a,s.structRefNodes=[],s.formulaHighlights=[],s.activeCellSheetName=void 0,s._namedObjectsMap=void 0,s}return Object(gu.__extends)(t,e),t.prototype.structRefNode=function(t,r,n){var i=e.prototype.structRefNode.call(this,t,r,n);return this.structRefNodes.push(i),i},t.prototype.nameNode=function(t,r,n){var i=e.prototype.nameNode.call(this,t,r,n);if(!this.isRefInActiveSheet(r))return i;if(i.parts.kind===Ot.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(i.parts.lhs),i;if(!b(this.namedObjectsMap))return i;var o=this.namedObjectsMap.get(t.asWhole.toLocaleLowerCase());return void 0!==o&&-1!==o.type&&this.createAndAppendNamedRefHighlight(n,o),i},t.prototype.cellRefNode=function(t,r,n){var i=e.prototype.cellRefNode.call(this,t,r,n);if(!this.isRefInActiveSheet(r))return i;var o=this.parsedFormulaTree.spans[n];if(o){var a=this.createRangeInfoFromCellRef(t),s=this.formulaSpanToHighlightingSpan(o,At.CellRef);this.formulaHighlights.push(RC(Eh.CellRef,s,a))}return i},Object.defineProperty(t.prototype,"namedObjectsMap",{get:function(){return b(this._namedObjectsMap)||b(this.definedNameInfoList)&&(this._namedObjectsMap=(e=this.definedNameInfoList,t=new Map,e.forEach((function(e){b(e.name)&&t.set(e.name.toLocaleLowerCase(),e)})),t)),this._namedObjectsMap;var e,t},enumerable:!1,configurable:!0}),t.prototype.createAndAppendNamedRefHighlight=function(e,t){var r=this.parsedFormulaTree.spans[e];if(b(r)&&b(this.sheetNames)){var n=t.sheetName;if(b(n)){var i=Qy(n,this.sheetNames);if(b(i)){if(Hn(i,this.activeCell.sheet)){var o=function(e){var t=e.namedRange;if(null!=t&&-1!==e.type){var r=0===e.type?1:0;return t.bottom&&t.top&&t.right&&t.left?{FirstRow:t.top+r-1,FirstColumn:t.left-1,LastRow:t.bottom-1,LastColumn:t.right-1}:void 0}}(t);void 0!==o&&this.formulaHighlights.push(RC(Eh.NamedRange,r,{sharedRange:o}))}}else bC("createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ".concat(t.type))}else bC("createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ".concat(t.type))}},t.prototype.createAndAppendFieldRefHighlight=function(e){switch(e.kind){case Ot.CellRefNamePart:this.createAndAppendCellRefPartHighlight(e);break;case Ot.IdentNamePart:if(!b(this.namedObjectsMap))return;var t=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());void 0!==t&&-1!==t.type&&this.createAndAppendNamedRefHighlight(e.label,t);break;case Ot.FieldRefNamePart:this.createAndAppendFieldRefHighlight(e.lhs)}},t.prototype.createAndAppendCellRefPartHighlight=function(e){var t=this.parsedFormulaTree.spans[e.label];if(b(t)){var r=this.createRangeInfoFromCellRef(e.ref),n=this.formulaSpanToHighlightingSpan(t,At.CellRef),i=RC(Eh.CellRef,n,r);this.formulaHighlights.push(i)}},t.prototype.formulaSpanToHighlightingSpan=function(e,t){var r=Object(gu.__assign)({},e);return t===At.CellRef&&function(e,t){return t.length>e.end&&t.charAt(e.end)===jr[Ur.Pound]}(e,this.formulaString)&&(r.end+=1),r},t.prototype.createRangeInfoFromCellRef=function(e){return{sharedRange:zy(e,this.activeCell.range,bC),positionKindInfo:yC(e)}},t.prototype.isRefInActiveSheet=function(e){var t;if(!b(e))return!0;if(!b(this.sheetNames))return!1;var r=function(e,t,r){return Qy(qy(e,r),t)}(e,this.sheetNames,this.failureCallback);return b(r)?Hn(r,this.activeCell.sheet):(null===(t=this.failureCallback)||void 0===t||t.call(this,"CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)},t}(oo);function RC(e,t,r){return{kind:e,span:t,rangeInfo:r}}function bC(e){Ei.ULS.traceTag(520935561,ii.msoulscat_ES_EWAJS,ci.Warning,"ColoredReferencesVisitor encountered a failure with msg ".concat(e))}var NC=function(){function e(){this.factoryName=bh.ColoredReferencesPlugin}return e.prototype.create=function(){return new TC},e}(),TC=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p;return Object(gu.__generator)(this,(function(m){switch(m.label){case 0:return t=e.content,[4,{kind:mg.ParseActiveCell,formulaText:t}];case 1:return(r=m.sent()).kind===mg.ParseActiveCell&&ge(r.result)?r.result.value.kind!==ma.Formula?[2,null]:[4,{kind:mg.GetActiveCell}]:[2,null];case 2:return(n=m.sent()).kind!==mg.GetActiveCell?(EC("failed to get active cell"),[2,null]):(i=void 0,[4,{kind:mg.GetSheetNames}]);case 3:return(o=m.sent()).kind===mg.GetSheetNames?i=o:EC("failed to get sheet names"),a=void 0,[4,{kind:mg.GetDefinedNamesInfo}];case 4:return(s=m.sent()).kind===mg.GetDefinedNamesInfo?a=s.definedNamesInfo:EC("failed to get defined names"),l=n.activeCell,u=r.result.value.formula,c=new CC(l,u,t,i,a),co(c,u),d=c.formulaHighlights,0===c.structRefNodes.length?[3,6]:(f={originGridCell:Se(l.range),originSheet:Se(l.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:mg.ResolveReferences,nodes:c.structRefNodes,locals:f}]);case 5:(p=m.sent()).kind===mg.ResolveReferences?d=d.concat(function(e,t,r){var n=[];return r.forEach((function(r){var i,o=e.spans[r.node.label];if(o)if(ge(r.resolution))if(void 0!==r.resolution.value){var a=r.resolution.value,s=Qn(a.sheet);if(b(s)&&Hn(s,t.sheet)){var l=function(e){var t=e.row,r=e.col;return{FirstRow:t,FirstColumn:r,LastRow:t+e.rows-1,LastColumn:r+e.cols-1}}(a.range),u={kind:Eh.StructRef,span:o,rangeInfo:{sharedRange:l}};n.push(u)}}else EC("failed to resolve StructRef, resolution value undefined");else EC("failed to resolve StructRef, reason: ".concat(Object(ce.isChangeGateEnabled)("OfficeVSO:7394986_fixResolverLogInColoredReferencesPlugin")?null===(i=r.resolution)||void 0===i?void 0:i.reason.kind:r.resolution.reason));else EC("failed to resolve StructRef, formulaSpan null")})),n}(u,l,p.resolverResults)):EC("failed to resolve node references"),m.label=6;case 6:return[2,{formulaHighlights:d}]}}))},e}();zg(new NC);var PC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ay.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(bh.ColoredReferencesPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))}));function EC(e){Ei.ULS.traceTag(525133647,ii.msoulscat_ES_EWAJS,ci.Warning,"ColoredReferencesPlugin encountered a failure with msg ".concat(e))}var kC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return[4,Iy.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("excelOnlineAutocomplete",!1)];case 2:return t.sent(),[2,e]}}))}))})),OC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompletePlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),AC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompletePrecisionMeasurements)];case 2:return e.sent(),[2]}}))}))})),IC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteAuthoringPrecisionMeasurements)];case 2:return e.sent(),[2]}}))}))})),_C=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteWrapperPlugin)];case 2:return e.sent(),[2]}}))}))})),FC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteRangeSuggestionPlugin)];case 2:return e.sent(),[2]}}))}))})),MC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteBinaryModelExperimentPlugin)];case 2:return e.sent(),[2]}}))}))})),DC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.AutocompleteGroundTruthMeasurements)];case 2:return e.sent(),[2]}}))}))})),wC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.ParserPerformanceMeasurements)];case 2:return e.sent(),[2]}}))}))})),LC=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,kC.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.ChatGPTPlugin)];case 2:return e.sent(),[2]}}))}))})),xC=Ho.tokenizeFormulaModule.tokenizeFormula,BC=Ho.token.DelimId,UC=(Ho.token.SepId,Ho.token.TokenKind),GC=Ho.token.TokenOperKind,KC=(Ho.token.addOperatorToken,Ho.token.appendToken,Ho.token.assignSepToken,Ho.token.atOperatorToken,Ho.token.badErrorOper,Ho.token.badNumberOper,Ho.token.cellRefA1Token),VC=Ho.token.cellRefR1C1Token,jC=(Ho.token.colSepToken,Ho.token.concatOperatorToken,Ho.token.divOperatorToken,Ho.token.dotSepToken,Ho.token.endToken,Ho.token.eqOperatorToken,Ho.token.escapeToken,Ho.token.geOperatorToken,Ho.token.gtOperatorToken,Ho.token.identOrBooleanToken,Ho.token.identToken),WC=(Ho.token.isBadErrorOper,Ho.token.isBadNumberOper,Ho.token.isNumberLikeOper,Ho.token.leOperatorToken,Ho.token.leftBraceToken,Ho.token.leftBracketToken,Ho.token.leftParenToken,Ho.token.leftSQuoteToken,Ho.token.listSepToken,Ho.token.literalToken),HC=(Ho.token.ltOperatorToken,Ho.token.mulOperatorToken,Ho.token.neOperatorToken,Ho.token.operatorToken,Ho.token.percentOperatorToken,Ho.token.poundOperatorToken,Ho.token.powOperatorToken,Ho.token.qualSepToken,Ho.token.rangeOperatorToken,Ho.token.rightBraceToken,Ho.token.rightBracketToken,Ho.token.rightParenToken,Ho.token.rightSQuoteToken,Ho.token.rowSepToken,Ho.token.spacesToken,Ho.token.specialRefToken,Ho.token.subOperatorToken,Ho.token.unexpectedToken),QC=Ho.token.singleLineCommentToken,qC=Ho.token.multiLineCommentToken,zC=function(){function e(){this.nonLiteralStore=new Map,this.literalStore=new Map}return e.prototype.get=function(e,t,r){var n,i;if(e===UC.Literal){if(void 0===r)throw new Error("Expected subkind");return null===(n=this.literalStore.get(r))||void 0===n?void 0:n.get(t)}return null===(i=this.nonLiteralStore.get(e))||void 0===i?void 0:i.get(t)},e.prototype.set=function(e,t,r,n){var i,o;if(e===UC.Literal){if(void 0===n)throw new Error("Expected subkind");(a=null!==(i=this.literalStore.get(n))&&void 0!==i?i:new Map).set(t,r),this.literalStore.set(n,a)}else{var a;(a=null!==(o=this.nonLiteralStore.get(e))&&void 0!==o?o:new Map).set(t,r),this.nonLiteralStore.set(e,a)}},e}();var YC=function(){function e(){this.store=new zC,this.counter=1}return e.prototype.getAnonymization=function(e,t,r,n){var i=this.store.get(e,r,t);if(void 0!==i)return i;var o=n(this.counter);return this.counter+=1,this.store.set(e,r,o,t),o},e.prototype.anonymizeIdent=function(e,t,r,n){var i=null!=t?t:e.start;if(void 0!==(null==r?void 0:r.localeInfo.getWorksheetFuncId(e.chars))&&function(e){return void 0!==e&&(e.kind===UC.Left&&e.value===BC.Paren)}(n))return jC(i,e.chars);var o=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"ident".concat(e)}));return jC(i,o)},e.prototype.anonymizeA1CellRef=function(e,t){if(e.refStyle!==Ft.A1)throw new Error("Expected RefStyle.A1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"A".concat(e)}));return KC(r,n,void 0,void 0)},e.prototype.anonymizeR1C1CellRef=function(e,t){if(e.refStyle!==Ft.R1C1)throw new Error("Expected RefStyle.R1C1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"R".concat(e,"C").concat(e)}));return VC(r,n,void 0,void 0)},e.prototype.anonymizeCellRef=function(e,t){return e.refStyle===Ft.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)},e.prototype.anonymizeLiteral=function(e,t){var r=null!=t?t:e.start,n=void 0;switch(e.oper.kind){case xo.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"".concat(e)}));break;case xo.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return'"s'.concat(e,'"')}));break;case GC.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"1e".concat(e,"000")}));break;case GC.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){for(var t=["a"],r="a".charCodeAt(0),n=e;n>0;){var i=e%10,o=String.fromCharCode(r+i);t.push(o),n=Math.floor(n/10)}var a=t.join("");return"#".concat(a)}));break;case xo.Boolean:case xo.Error:case xo.Missing:n=e.chars;break;default:L("error",e.oper)}var i=e.oper,o=e.hasRight;return WC(r,n,i,o)},e.prototype.anonymizeToken=function(e,t,r,n){switch(e.kind){case UC.Ident:return this.anonymizeIdent(e,t,r,n);case UC.CellRef:return this.anonymizeCellRef(e,t);case UC.Literal:return this.anonymizeLiteral(e,t);case UC.Unexpected:return function(e,t){var r=null!=t?t:e.start;return"\t"===e.chars||";"===e.chars?HC(r,e.chars):HC(r,"\t")}(e,t);case UC.SingleLineComment:return QC(t,"redacted");case UC.MultiLineComment:return qC(t,"redacted",e.isClosed);case UC.End:case UC.Left:case UC.Right:case UC.Sep:case UC.Operator:case UC.Spaces:case UC.SpecialRef:case UC.Escape:return Object(gu.__assign)(Object(gu.__assign)({},e),{start:t});default:return L("ConsistentAnonymizer.anonymizeToken",e)}},e.prototype.anonymize=function(e,t,r){for(var n=xC(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),i=[],o=0,a=0;a<n.length;a+=1){var s=n[a],l=a+1<n.length?n[a+1]:void 0,u=this.anonymizeToken(s,o,t,l);o+=u.chars.length,i.push(u)}return i.map((function(e){return e.chars})).join("")},e}();function JC(e){for(var t=0,r=function(e){var t=JSON.stringify(e),r=0,n=[];for(;t.length>0;){var i=rR(t,r,e.i),o=i[0],a=i[1];t=a,r+=1,n.push(o)}return n}(e);t<r.length;t++){var n=tR(r[t]);Ei.ULS.dnmTraceTag(537962336,ii.msoulscat_ES_EWAJS,ci.Info,n)}}function XC(e){Ei.ULS.traceTag(537962337,ii.msoulscat_ES_EWAJS,ci.Verbose,e)}var $C,ZC=function(){function e(){this.factoryName=bh.FormulaCollectionPlugin}return e.prototype.create=function(){return new eR},e}(),eR=function(){function e(){this.lastEdit=void 0,this.consistentAnonymizer=new YC,this.sheetIdAnonymization=new Map}return e.prototype.getEditEntry=function(e,t){var r={content:e,cell:t};if(void 0===this.lastEdit||!Kn(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r},e.prototype.anonymizeSheetId=function(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);var t=Object(Su.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t},e.prototype.run=function(t){var r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y;return Object(gu.__generator)(this,(function(C){switch(C.label){case 0:return[4,{kind:mg.GetActiveCell}];case 1:return(r=C.sent()).kind!==mg.GetActiveCell?(XC($C.GetActiveCell),[2,null]):(n=r.activeCell,null==t.content?(XC($C.EmptyContent),[2,null]):t.content.trimLeft().startsWith("=")?void 0===(i=this.getEditEntry(t.content,n))?[2,null]:[4,{kind:mg.GetConfig}]:[2,null]);case 2:return(o=C.sent()).kind!==mg.GetConfig?(XC($C.GetConfig),[2,null]):(a=o.config,s=na(a),l=Oe(i.cell),u=ta(l.kind,l.range),c=aa(s),d=this.consistentAnonymizer.anonymize(i.content,a,n.range),[4,{kind:mg.ParseEdit,cell:i.cell,formulaBarText:d}]);case 3:return(f=C.sent()).kind===mg.ParseEdit&&ge(f.result)?f.result.value.kind!==ma.Formula?[2,null]:(p=f.result.value.formula,m=p.isWellFormed,h=void 0,m||(g=c.checkFormulaWithDiagnostics(u,p),ge(g)&&void 0!==(v=null==g?void 0:g.value[1])&&(h=function(e,t){var r={},n={};return Object.keys(e).forEach((function(i){var o=Number(i),a=e[o];void 0!==a&&(r[i]=a);var s=t.spans[o];void 0!==s&&(n[i]=s)})),{spanDiagnostics:r,spans:n}}(v,p))),[4,{kind:mg.GetCorrelationId}]):(XC($C.ParseEdit),[2,null]);case 4:return"GetCorrelationId"!==(S=C.sent()).kind||(y=S.correlationId,JC({v:e.formulaCollectionVersion,f:d,ok:m,d:h,c:{s:this.anonymizeSheetId(i.cell.sheet.index),c:i.cell.range.col,r:i.cell.range.row},i:y})),[2,null]}}))},e.factoryName=bh.FormulaCollectionPlugin,e.formulaCollectionVersion=1,e}();function tR(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function rR(e,t,r){var n=2300-(r.toString().length+t.toString().length+2);return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,n)},e.slice(n)]}!function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}($C||($C={})),zg(new ZC);var nR=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Iy.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.FormulaCollectionPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),iR=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.parsedFormulaTree=t,o.selectionStart=r,o.selectionEnd=n,o.formula=i,o.subFormulaStart=-1,o.subFormulaEnd=-1,o.isBadSequence=!1,o.isRefNode=!1,o.letDefinitions=void 0,o.nodeLabel=-1,o}return Object(gu.__extends)(t,e),t.prototype.appNode=function(t,r,n,i){var o=e.prototype.appNode.call(this,t,r,n,i);return this.tryUpdateAppNodeAsSubFormula(t,o),o},t.prototype.literalNode=function(t,r,n){var i=e.prototype.literalNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i),i},t.prototype.arrayNode=function(t,r,n){var i=e.prototype.arrayNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i),i},t.prototype.cellRefNode=function(t,r,n){var i=e.prototype.cellRefNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i)&&(this.isRefNode=!0),i},t.prototype.fieldRefNode=function(t,r,n,i){var o=e.prototype.fieldRefNode.call(this,t,r,n,i);return this.tryUpdateNodeAsSubFormula(o),o},t.prototype.structRefNode=function(t,r,n){var i=e.prototype.structRefNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i)&&(this.isRefNode=!0),i},t.prototype.nameNode=function(t,r,n){var i=e.prototype.nameNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i)&&(this.isRefNode=!0),i},t.prototype.badSequenceNode=function(t,r,n){var i=this,o=e.prototype.badSequenceNode.call(this,t,r,n);return r.some((function(e){return e.label===i.nodeLabel}))&&(this.updateNodeAsSubFormula(o),this.isBadSequence=!0),o},t.prototype.parenNode=function(t,r,n){var i=e.prototype.parenNode.call(this,t,r,n);return r&&this.tryUpdateNodeAsSubFormula(i),i},t.prototype.letNode=function(t,r,n,i,o,a){var s=e.prototype.letNode.call(this,t,r,n,i,o,a),l=this.parsedFormulaTree.spans[a];return this.isMatchingArg(l,!0)&&this.updateLetNodeAsSubFormula(s),s},t.prototype.tryUpdateNodeAsSubFormula=function(e){return!!this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[e.label])&&(this.updateNodeAsSubFormula(e),!0)},t.prototype.tryUpdateAppNodeAsSubFormula=function(e,t){if(e.kind===At.WSF||e.kind===At.Operator){var r=this.parsedFormulaTree.spans[e.label],n=this.parsedFormulaTree.spans[t.label];this.isMatchingAppNode(r,n,e.kind,t.isClosed)&&this.updateNodeAsSubFormula(t)}else M.ULS.traceTag(509347166,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,"ValuePreviewVisitor - visitor encountered higher order function.")},t.prototype.updateLetNodeAsSubFormula=function(e){var t=this.parsedFormulaTree.spans[e.head.label],r=this.parsedFormulaTree.spans[e.label];if(this.isMatchingAppNode(t,r,At.WSF,e.isClosed))return this.subFormulaStart=r.start,this.subFormulaEnd=r.end,void(this.nodeLabel=e.label);for(var n=0;n<e.args.length;n++){var i=e.args[n],o=this.parsedFormulaTree.spans[i.label];if(!b(o))return;if(this.isMatchingArg(o,!0)){if(1===n)return;var a=n%2==0,s=e.args.length-2,l=a?Math.min(s,n+1):n-2,u=this.parsedFormulaTree.spans[e.args[l].label];if(!b(u))return;var c=this.formula.substring(r.start,u.end);this.letDefinitions=c,-1===this.nodeLabel&&this.isMatchingArg(o,!1)&&(this.subFormulaStart=o.start,this.subFormulaEnd=o.end,this.nodeLabel=i.label)}}},t.prototype.updateNodeAsSubFormula=function(e){var t=this.parsedFormulaTree.spans[e.label];this.subFormulaStart=t.start,this.subFormulaEnd=t.end,this.nodeLabel=e.label},t.prototype.isMinimalMatchingSpan=function(e){return-1===this.nodeLabel&&this.isMatchingArg(e)},t.prototype.isMatchingArg=function(e,t){return void 0===t&&(t=!1),!!b(e)&&(this.selectionStart===this.selectionEnd?this.selectionStart>=e.start&&this.selectionEnd<e.end:t?this.selectionStart>=e.start&&this.selectionEnd<=e.end:this.selectionStart===e.start&&this.selectionEnd===e.end)},t.prototype.isMatchingAppNode=function(e,t,r,n){return!!(b(e)&&b(t)&&n)&&(this.selectionStart===this.selectionEnd?r===At.WSF&&(this.selectionStart===e.end||this.selectionStart===t.end-1)||this.selectionStart>=e.start&&this.selectionStart<e.end:this.selectionStart===t.start&&this.selectionEnd===t.end)},t}(oo),oR=r(23),aR=function(){function e(e){this.mathpack=e}return e.prototype.fromEvalFormulaOutput=function(e){var t=e.value,r=e.formatted;switch(t.kind){case me.Success:return this.resultFromSuccess(t.value,r);case me.Failure:return this.resultFromFailureReason(t.reason);default:return t}},e.prototype.resultFromSuccess=function(e,t){var r;switch(e.kind){case xo.Boolean:case xo.String:case xo.Array:case xo.Blank:case xo.Number:r=this.resultFromFormatted(t);break;case xo.Error:r=this.resultFromError(e,t);break;default:return{kind:oR.ValuePreviewResultKind.Failure}}if(r.kind!==oR.ValuePreviewResultKind.Success)return r;var n=r.value;return e.kind===xo.Number&&(n=this.mathpack.toNumber(e).toString()),Object(gu.__assign)(Object(gu.__assign)({},r),{unformattedValue:n,operKind:e.kind})},e.prototype.resultFromFormatted=function(e){if(N(e))return{kind:oR.ValuePreviewResultKind.Failure};switch(e.kind){case me.Success:if(wa(e.value)){var t=e.value.units;return sR("Evaluate HashesValue: ".concat(t.kind)),{kind:oR.ValuePreviewResultKind.Failure}}return this.resultFromFormattedValue(e.value);case me.Failure:return this.resultFromFailureReason(e.reason);default:return e}},e.prototype.resultFromFormattedValue=function(e){var t=ua.render.renderValue(this.mathpack,e,Wa);if(t.kind===me.Failure)return sR("renderValue fail"),{kind:oR.ValuePreviewResultKind.Failure};if(wa(t.value)){var r=t.value.units;return sR("Render HashesValue: ".concat(r.kind)),{kind:oR.ValuePreviewResultKind.Failure}}var n=Qa(t.value);return""===n.trim()?(sR("Empty result"),{kind:oR.ValuePreviewResultKind.Failure}):{kind:oR.ValuePreviewResultKind.Success,value:n,color:e.color}},e.prototype.resultFromFailureReason=function(e){switch(e.kind){case vs.Unavailable:case vs.NotImplemented:case vs.PreviousFailure:return{kind:oR.ValuePreviewResultKind.Unavailable};default:return{kind:oR.ValuePreviewResultKind.Failure}}},e.prototype.resultFromError=function(e,t){return e.type===ze.FIELD?{kind:oR.ValuePreviewResultKind.Unavailable}:this.resultFromFormatted(t)},e}();function sR(e){M.ULS.traceTag(520680450,Zy.LogCategory.msoulscat_ES_EWAJS,Zy.TraceLevel.Warning,"ValuePreviewResultExtractor encountered a failure with msg ".concat(e))}var lR=function(e){function t(t,r,n){var i=e.call(this)||this;return i.parsedFormulaTree=t,i.start=r,i.end=n,i.isSubFormulaName=!1,i}return Object(gu.__extends)(t,e),t.prototype.nameNode=function(t,r,n){var i=this.parsedFormulaTree.spans[n];return t.kind===Ot.IdentNamePart&&i&&i.start===this.start&&i.end===this.end&&(this.isSubFormulaName=!0),e.prototype.nameNode.call(this,t,r,n)},t}(oo),uR=Rh.types.SpecialFormat,cR=function(){function e(){this.factoryName=bh.ValuePreviewPlugin}return e.prototype.create=function(){return new dR},e}(),dR=function(){function e(){this.isLocalizedErrorWorkaroundEnabled=pe("OfficeVSO:7826609_ValuePreviewLocalizedErrorUnavailable")}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m,h,g=e.text,v=e.index,S=e.length;return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return N(g)||N(v)||N(S)?(fR("missing request arguments"),[2,null]):v<0||v+S>g.length?(fR("invalid selection, ".concat(g.length,", ").concat(v,", ").concat(S)),[2,null]):[4,{kind:mg.ParseActiveCell,formulaText:g}];case 1:if((t=e.sent()).kind!==mg.ParseActiveCell||!ge(t.result))return[2,null];if((r=t.result.value).kind!==ma.Formula)return[2,null];if(i=void 0,g.startsWith("=")&&0===v&&0===S||S===g.length)n={start:0,end:g.length};else if(i=new iR(r.formula,v,v+S,g),co(i,r.formula),-1===(n=0===S?{start:i.subFormulaStart,end:i.subFormulaEnd}:{start:v,end:v+S}).start||n.end===n.start||i.isBadSequence||S>0&&!function(e,t){var r=0===t.start||Object.keys(e.spans).some((function(r){var n;return(null===(n=e.spans[Number(r)])||void 0===n?void 0:n.start)===t.start})),n=Object.keys(e.spans).some((function(r){var n;return(null===(n=e.spans[Number(r)])||void 0===n?void 0:n.end)===t.end}));return r&&n}(r.formula,n))return[2,null];return o=g.substring(n.start,n.end),b(null==i?void 0:i.letDefinitions)&&(o=(null==i?void 0:i.letDefinitions)+", "+o+")"),o?[4,{kind:mg.GetActiveCell}]:[2,null];case 2:return(a=e.sent()).kind!==mg.GetActiveCell?(fR("GetActiveCell fail"),[2,null]):[4,{kind:mg.GetConfig}];case 3:return(s=e.sent()).kind!==mg.GetConfig?(fR("GetConfig fail"),[2,null]):(l=(o.startsWith("=")?"":"=")+o,u={index:n.start,length:n.end-n.start},[4,{kind:mg.GetActiveCellFormat}]);case 4:return(c=e.sent()).kind!==mg.GetActiveCellFormat?(fR("GetActiveCellFormat failed"),[2,Object(gu.__assign)({kind:kh.Unavailable,evaluatedFormula:l},u)]):!ge(c.result)||N(c.result.value)?(fR("Empty cell format"),[2,Object(gu.__assign)({kind:kh.Unavailable,evaluatedFormula:l},u)]):(d=uR.Origin,(c.result.value.formatString===s.config.localeInfo.pictureSpecial[ui.General]||!0===(null==i?void 0:i.isRefNode)&&l.length!==g.length)&&(d=uR.Inferred),[4,{kind:mg.EvalFormula,formula:l,origin:{sheet:a.activeCell.sheet,range:{col:a.activeCell.range.col,row:a.activeCell.range.row,rows:1,cols:1}},format:{kind:d,renderBlanksAsZeros:!0}}]);case 5:return(f=e.sent()).kind!==mg.EvalFormula?[2,null]:!function(e){return e.value.kind===me.Failure&&e.value.reason.kind===ba.Unavailable&&e.value.reason.objects.some((function(e){return e.kind===zu.NameLoc}))}(f.result)||this.isLocalizedErrorWorkaroundEnabled&&!pR(s.config.localeInfo.lcid)?[3,7]:[4,{kind:mg.GetDefinedNamesInfo}];case 6:if((p=e.sent()).kind!==mg.GetDefinedNamesInfo)fR("failed to get named objects info");else if(function(e,t,r,n){var i=(r.startsWith("=")?r.slice(1):r).toLocaleLowerCase();if(e.some((function(e){var t;return(null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase())===i})))return!1;var o=r.startsWith("=")&&0===n.start?1:n.start,a=o+i.length,s=new lR(t,o,a);return co(s,t),s.isSubFormulaName}(p.definedNamesInfo,r.formula,l,n))return[2,Object(gu.__assign)({kind:kh.Success,value:s.config.localeInfo.errorNames[ze.NAME],unformattedValue:s.config.localeInfo.errorNames[ze.NAME],operKind:xo.Error,evaluatedFormula:l},u)];e.label=7;case 7:return m=new aR(s.config.mathpack),h=m.fromEvalFormulaOutput(f.result),this.isLocalizedErrorWorkaroundEnabled&&h.kind===kh.Success&&h.operKind===xo.Error&&!pR(s.config.localeInfo.lcid)?(y="Unsupported locale for error messages",M.ULS.traceTag(508904545,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,"ValuePreviewPlugin: ".concat(y)),[2,Object(gu.__assign)({kind:kh.Unavailable,evaluatedFormula:l},u)]):[2,Object(gu.__assign)(Object(gu.__assign)(Object(gu.__assign)({},h),{evaluatedFormula:l}),u)]}var y}))},e}();function fR(e){M.ULS.traceTag(521692767,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,"ValuePreviewPlugin encountered a failure with msg ".concat(e))}function pR(e){return[ni.USA,ni.British,ni.CanadianEnglish].includes(e)}zg(new cR);var mR=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Iy.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.ValuePreviewPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))}));function hR(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function gR(e){return"function"==typeof e.GetHashCode}function vR(e){return null!=e&&"function"==typeof e.Dispose}function SR(e){vR(e)&&e.Dispose()}function yR(e,t){var r,n;return(null===(r=Object.getPrototypeOf(e))||void 0===r?void 0:r.constructor)===(null===(n=Object.getPrototypeOf(t))||void 0===n?void 0:n.constructor)}class CR{constructor(e){this.iter=e}"System.Collections.Generic.IEnumerator`1.get_Current"(){return this.current}"System.Collections.IEnumerator.get_Current"(){return this.current}"System.Collections.IEnumerator.MoveNext"(){const e=this.iter.next();return this.current=e.value,!e.done}"System.Collections.IEnumerator.Reset"(){throw new Error("JS iterators cannot be reset")}Dispose(){}}function RR(e){return"function"==typeof e.GetEnumerator?e.GetEnumerator():new CR(e[Symbol.iterator]())}function bR(e){return{[Symbol.iterator](){return this},next(){const t=e["System.Collections.IEnumerator.MoveNext"]();return{done:!t,value:t?e["System.Collections.IEnumerator.get_Current"]():void 0}}}}function NR(e,t){let r=e.toString(10);for(;r.length<t;)r="0"+r;return r}function TR(e){const t=e;return"number"==typeof t.offset?t.offset:1===e.kind?0:-6e4*e.getTimezoneOffset()}class PR{static id(e){return PR.idMap.has(e)||PR.idMap.set(e,++PR.count),PR.idMap.get(e)}}function ER(e){let t=0,r=5381;const n=e.length;for(;t<n;)r=33*r^e.charCodeAt(t++);return r}function kR(e){return 2654435761*e|0}function OR(e){return 0===e.length?0:e.reduce((e,t)=>(e<<5)+e^t)}function AR(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n++)r[n]=IR(e[n]);return OR(r)}function IR(e){var t;if(null==e)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return kR(e);case"string":return ER(e);default:if(gR(e))return e.GetHashCode();if(hR(e))return AR(e);if(e instanceof Date)return function(e){return e.getTime()}(e);if((null===(t=Object.getPrototypeOf(e))||void 0===t?void 0:t.constructor)===Object){return OR(Object.values(e).map(e=>IR(e)))}return kR(PR.id(e))}}function _R(e){return null==e?0:gR(e)?e.GetHashCode():kR(PR.id(e))}function FR(e,t,r){if(null==e)return null==t;if(null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}function MR(e,t){return FR(e,t,DR)}function DR(e,t){var r;return e===t||(null==e?null==t:null!=t&&("object"==typeof e&&(function(e){return"function"==typeof e.Equals}(e)?e.Equals(t):hR(e)?hR(t)&&MR(e,t):e instanceof Date?t instanceof Date&&0===wR(e,t):(null===(r=Object.getPrototypeOf(e))||void 0===r?void 0:r.constructor)===Object&&function(e,t){const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;r.sort(),n.sort();for(let i=0;i<r.length;i++)if(r[i]!==n[i]||!DR(e[r[i]],t[n[i]]))return!1;return!0}(e,t))))}function wR(e,t){let r,n;return"offset"in e&&"offset"in t?(r=e.getTime(),n=t.getTime()):(r=e.getTime()+TR(e),n=t.getTime()+TR(t)),r===n?0:r<n?-1:1}function LR(e,t){return e===t?0:e<t?-1:1}function xR(e,t){return function(e,t,r){if(null==e)return null==t?0:1;if(null==t)return-1;if(e.length!==t.length)return e.length<t.length?-1:1;for(let n=0,i=0;n<e.length;n++)if(i=r(e[n],t[n]),0!==i)return i;return 0}(e,t,BR)}function BR(e,t){var r;return e===t?0:null==e?null==t?0:-1:null==t?1:"object"!=typeof e?e<t?-1:1:function(e){return"function"==typeof e.CompareTo}(e)?e.CompareTo(t):hR(e)?hR(t)?xR(e,t):-1:e instanceof Date?t instanceof Date?wR(e,t):-1:(null===(r=Object.getPrototypeOf(e))||void 0===r?void 0:r.constructor)===Object?function(e,t){const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return r.length<n.length?-1:1;r.sort(),n.sort();for(let i=0,o=0;i<r.length;i++){const a=r[i];if(a!==n[i])return a<n[i]?-1:1;if(o=BR(e[a],t[a]),0!==o)return o}return 0}(e,t):-1}function UR(e,t,r){return e(t,r)<0?t:r}function GR(e,t,r){return e(t,r)>0?t:r}PR.idMap=new WeakMap,PR.count=0;const KR=Symbol("curried");function VR(e,t,r){return n=>1===t?r(...e.concat([n])):VR(e.concat([n]),t-1,r)}function jR(e,t){return null==t||1===t.length?t:KR in t?t[KR]:VR([],e,t)}function WR(e,t=0){var r,n;if(null!=e&&"object"==typeof e){if("function"==typeof e.toString)return e.toString();if(Symbol.iterator in e)return function(e){let t=0,r="[";for(const n of e){if(0===t)r+=WR(n);else{if(100===t){r+="; ...";break}r+="; "+WR(n)}t++}return r+"]"}(e);{const i=null===(r=Object.getPrototypeOf(e))||void 0===r?void 0:r.constructor;return i===Object&&t<10?"{ "+Object.entries(e).map(([e,r])=>e+" = "+WR(r,t+1)).join("\n  ")+" }":null!==(n=null==i?void 0:i.name)&&void 0!==n?n:""}}return String(e)}class HR{get name(){return this.cases()[this.tag]}toJSON(){return 0===this.fields.length?this.name:[this.name].concat(this.fields)}toString(){return function(e,t){if(0===t.length)return e;{let r="",n=!0;return 1===t.length?(r=WR(t[0]),n=r.indexOf(" ")>=0):r=t.map(e=>WR(e)).join(", "),e+(n?" (":" ")+r+(n?")":"")}}(this.name,this.fields)}GetHashCode(){const e=this.fields.map(e=>IR(e));return e.splice(0,0,kR(this.tag)),OR(e)}Equals(e){return this===e||!!yR(this,e)&&(this.tag===e.tag&&MR(this.fields,e.fields))}CompareTo(e){return this===e?0:yR(this,e)?this.tag===e.tag?xR(this.fields,e.fields):this.tag<e.tag?-1:1:-1}}function QR(e){const t={},r=Object.keys(e);for(let n=0;n<r.length;n++)t[r[n]]=e[r[n]];return t}function qR(e){return"{ "+Object.entries(e).map(([e,t])=>e+" = "+WR(t)).join("\n  ")+" }"}function zR(e){return OR(Object.values(e).map(e=>IR(e)))}function YR(e,t){if(e===t)return!0;if(yR(e,t)){const r=Object.keys(e);for(let n=0;n<r.length;n++)if(!DR(e[r[n]],t[r[n]]))return!1;return!0}return!1}function JR(e,t){if(e===t)return 0;if(yR(e,t)){const r=Object.keys(e);for(let n=0;n<r.length;n++){const i=BR(e[r[n]],t[r[n]]);if(0!==i)return i}return 0}return-1}class XR{toJSON(){return QR(this)}toString(){return qR(this)}GetHashCode(){return zR(this)}Equals(e){return YR(this,e)}CompareTo(e){return JR(this,e)}}class $R{constructor(e,t){"function"==typeof t?(this.getter=e,this.setter=t):(this.getter=()=>e,this.setter=t=>{e=t})}get contents(){return this.getter()}set contents(e){this.setter(e)}}class ZR{constructor(e){this.message=e}}function eb(e){return(t=e)instanceof ZR||t instanceof Error?e:new Error(String(e));var t}function tb(e,t,r){return!!e.has(t)&&(r.contents=e.get(t),!0)}function rb(e,t){if(e.has(t))return e.get(t);throw new Error(`The given key '${t}' was not present in the dictionary.`)}var nb;!function(e){e[e.AllowHexSpecifier=512]="AllowHexSpecifier"}(nb||(nb={}));const ib=Symbol("numeric");function ob(e){return"number"==typeof e||(null==e?void 0:e[ib])}function ab(e,t){return"number"==typeof e?e*t:e[ib]().multiply(t)}function sb(e,t){return"number"==typeof e?e.toFixed(t):e[ib]().toFixed(t)}function lb(e,t){return"number"==typeof e?e.toPrecision(t):e[ib]().toPrecision(t)}function ub(e,t){return"number"==typeof e?e.toExponential(t):e[ib]().toExponential(t)}function cb(e){return"number"==typeof e?(Number(e)>>>0).toString(16):e[ib]().toHex()}var db=null;try{db=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function fb(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function pb(e){return!0===(e&&e.__isLong__)}fb.prototype.GetHashCode=function(){let e=this.unsigned?1:0;return e=(e<<5)+e^this.high,e=(e<<5)+e^this.low,e},fb.prototype.Equals=function(e){return Gb(this,e)},fb.prototype.CompareTo=function(e){return Wb(this,e)},fb.prototype.toString=function(e){return Lb(this,e)},fb.prototype.toJSON=function(){return Lb(this)},fb.prototype[ib]=function(){const e=this;return{multiply:t=>zb(e,t),toPrecision:t=>String(e)+(0).toPrecision(t).substr(1),toExponential:t=>String(e)+(0).toExponential(t).substr(1),toFixed:t=>String(e)+(0).toFixed(t).substr(1),toHex:()=>Lb(e.unsigned?e:tN(eN(e),!0),16)}},fb.prototype.__isLong__,Object.defineProperty(fb.prototype,"__isLong__",{value:!0});var mb={},hb={};function gb(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=hb[e])?n:(r=Sb(e,(0|e)<0?-1:0,!0),i&&(hb[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=mb[e])?n:(r=Sb(e,e<0?-1:0,!1),i&&(mb[e]=r),r)}function vb(e,t){if(isNaN(e))return t?kb:Eb;if(t){if(e<0)return kb;if(e>=Nb)return Fb}else{if(e<=-Tb)return Mb;if(e+1>=Tb)return _b}return e<0?Hb(vb(-e,t)):Sb(e%bb|0,e/bb|0,t)}function Sb(e,t,r){return new fb(e,t,r)}var yb=Math.pow;function Cb(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return Eb;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n=e.indexOf("-");if(n>0)throw Error("interior hyphen");if(0===n)return Hb(Cb(e.substring(1),t,r));for(var i=vb(yb(r,8)),o=Eb,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),l=parseInt(e.substring(a,a+s),r);if(s<8)o=Qb(zb(o,vb(yb(r,s))),vb(l));else o=Qb(o=zb(o,i),vb(l))}return o.unsigned=t,o}function Rb(e,t){return"number"==typeof e?vb(e,t):"string"==typeof e?Cb(e,t):Sb(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}var bb=4294967296,Nb=bb*bb,Tb=Nb/2,Pb=gb(1<<24),Eb=gb(0),kb=gb(0,!0),Ob=gb(1),Ab=gb(1,!0),Ib=gb(-1),_b=Sb(-1,2147483647,!1),Fb=Sb(-1,-1,!0),Mb=Sb(0,-2147483648,!1);function Db(e){return e.unsigned?e.low>>>0:e.low}function wb(e){return e.unsigned?(e.high>>>0)*bb+(e.low>>>0):e.high*bb+(e.low>>>0)}function Lb(e,t){if((t=t||10)<2||36<t)throw RangeError("radix");if(xb(e))return"0";if(Bb(e)){if(Gb(e,Mb)){var r=vb(t),n=Yb(e,r),i=qb(zb(n,r),e);return Lb(n,t)+Db(i).toString(t)}return"-"+Lb(Hb(e),t)}for(var o=vb(yb(t,6),e.unsigned),a=e,s="";;){var l=Yb(a,o),u=(Db(qb(a,zb(l,o)))>>>0).toString(t);if(xb(a=l))return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}}function xb(e){return 0===e.high&&0===e.low}function Bb(e){return!e.unsigned&&e.high<0}function Ub(e){return 1==(1&e.low)}function Gb(e,t){return pb(t)||(t=Rb(t)),(e.unsigned===t.unsigned||e.high>>>31!=1||t.high>>>31!=1)&&(e.high===t.high&&e.low===t.low)}function Kb(e,t){return Wb(e,t)<0}function Vb(e,t){return Wb(e,t)>0}function jb(e,t){return Wb(e,t)>=0}function Wb(e,t){if(pb(t)||(t=Rb(t)),Gb(e,t))return 0;var r=Bb(e),n=Bb(t);return r&&!n?-1:!r&&n?1:e.unsigned?t.high>>>0>e.high>>>0||t.high===e.high&&t.low>>>0>e.low>>>0?-1:1:Bb(qb(e,t))?-1:1}function Hb(e){return!e.unsigned&&Gb(e,Mb)?Mb:Qb(Jb(e),Ob)}function Qb(e,t){pb(t)||(t=Rb(t));var r=e.high>>>16,n=65535&e.high,i=e.low>>>16,o=65535&e.low,a=t.high>>>16,s=65535&t.high,l=t.low>>>16,u=0,c=0,d=0,f=0;return d+=(f+=o+(65535&t.low))>>>16,c+=(d+=i+l)>>>16,u+=(c+=n+s)>>>16,u+=r+a,Sb((d&=65535)<<16|(f&=65535),(u&=65535)<<16|(c&=65535),e.unsigned)}function qb(e,t){return pb(t)||(t=Rb(t)),Qb(e,Hb(t))}function zb(e,t){if(xb(e))return e.unsigned?kb:Eb;if(pb(t)||(t=Rb(t)),db)return Sb(db.mul(e.low,e.high,t.low,t.high),db.get_high(),e.unsigned);if(xb(t))return e.unsigned?kb:Eb;if(Gb(e,Mb))return Ub(t)?Mb:Eb;if(Gb(t,Mb))return Ub(e)?Mb:Eb;if(Bb(e))return Bb(t)?zb(Hb(e),Hb(t)):Hb(zb(Hb(e),t));if(Bb(t))return Hb(zb(e,Hb(t)));if(Kb(e,Pb)&&Kb(t,Pb))return vb(wb(e)*wb(t),e.unsigned);var r=e.high>>>16,n=65535&e.high,i=e.low>>>16,o=65535&e.low,a=t.high>>>16,s=65535&t.high,l=t.low>>>16,u=65535&t.low,c=0,d=0,f=0,p=0;return f+=(p+=o*u)>>>16,d+=(f+=i*u)>>>16,f&=65535,d+=(f+=o*l)>>>16,c+=(d+=n*u)>>>16,d&=65535,c+=(d+=i*l)>>>16,d&=65535,c+=(d+=o*s)>>>16,c+=r*u+n*l+i*s+o*a,Sb((f&=65535)<<16|(p&=65535),(c&=65535)<<16|(d&=65535),e.unsigned)}function Yb(e,t){if(pb(t)||(t=Rb(t)),xb(t))throw Error("division by zero");var r,n,i;if(db)return e.unsigned||-2147483648!==e.high||-1!==t.low||-1!==t.high?Sb((e.unsigned?db.div_u:db.div_s)(e.low,e.high,t.low,t.high),db.get_high(),e.unsigned):e;if(xb(e))return e.unsigned?kb:Eb;if(e.unsigned){if(t.unsigned||(t=function(e){return e.unsigned?e:Sb(e.low,e.high,!0)}(t)),Vb(t,e))return kb;if(Vb(t,Zb(e,1)))return Ab;i=kb}else{if(Gb(e,Mb))return Gb(t,Ob)||Gb(t,Ib)?Mb:Gb(t,Mb)?Ob:Gb(r=Xb(Yb($b(e,1),t),1),Eb)?Bb(t)?Ob:Ib:i=Qb(r,Yb(n=qb(e,zb(t,r)),t));if(Gb(t,Mb))return e.unsigned?kb:Eb;if(Bb(e))return Bb(t)?Yb(Hb(e),Hb(t)):Hb(Yb(Hb(e),t));if(Bb(t))return Hb(Yb(e,Hb(t)));i=Eb}for(n=e;jb(n,t);){r=Math.max(1,Math.floor(wb(n)/wb(t)));for(var o=Math.ceil(Math.log(r)/Math.LN2),a=o<=48?1:yb(2,o-48),s=vb(r),l=zb(s,t);Bb(l)||Vb(l,n);)l=zb(s=vb(r-=a,e.unsigned),t);xb(s)&&(s=Ob),i=Qb(i,s),n=qb(n,l)}return i}function Jb(e){return Sb(~e.low,~e.high,e.unsigned)}function Xb(e,t){return pb(t)&&(t=Db(t)),0==(t&=63)?e:t<32?Sb(e.low<<t,e.high<<t|e.low>>>32-t,e.unsigned):Sb(0,e.low<<t-32,e.unsigned)}function $b(e,t){return pb(t)&&(t=Db(t)),0==(t&=63)?e:t<32?Sb(e.low>>>t|e.high<<32-t,e.high>>t,e.unsigned):Sb(e.high>>t-32,e.high>=0?0:-1,e.unsigned)}function Zb(e,t){if(pb(t)&&(t=Db(t)),0===(t&=63))return e;var r=e.high;return t<32?Sb(e.low>>>t|r<<32-t,r>>>t,e.unsigned):Sb(32===t?r:r>>>t-32,0,e.unsigned)}function eN(e,t){return t?function(e){var t=e.high,r=e.low;return[255&r,r>>>8&255,r>>>16&255,r>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]}(e):function(e){var t=e.high,r=e.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,r>>>24,r>>>16&255,r>>>8&255,255&r]}(e)}function tN(e,t,r){return r?function(e,t){return new fb(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)}(e,t):function(e,t){return new fb(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}(e,t)}function rN(e){const t=e<0,r=(e=Math.abs(e))%36e5/6e4;return(t?"-":"+")+NR(~~(e/36e5),2)+":"+NR(r,2)}function nN(e,t){const r=e.toISOString();return"first"===t?r.substring(0,r.indexOf("T")):r.substring(r.indexOf("T")+1,r.length-1)}function iN(e,t,r){return t.replace(/(\w)\1*/g,t=>{let n=Number.NaN;switch(t.substring(0,1)){case"y":const i=r?e.getUTCFullYear():e.getFullYear();n=t.length<4?i%100:i;break;case"M":n=(r?e.getUTCMonth():e.getMonth())+1;break;case"d":n=r?e.getUTCDate():e.getDate();break;case"H":n=r?e.getUTCHours():e.getHours();break;case"h":const o=r?e.getUTCHours():e.getHours();n=o>12?o%12:o;break;case"m":n=r?e.getUTCMinutes():e.getMinutes();break;case"s":n=r?e.getUTCSeconds():e.getSeconds();break;case"f":n=r?e.getUTCMilliseconds():e.getMilliseconds()}return Number.isNaN(n)?t:n<10&&t.length>1?"0"+n:""+n})}function oN(e,t){var r,n,i;const o=new Date(e.getTime()+(null!==(r=e.offset)&&void 0!==r?r:0));if("string"!=typeof t)return o.toISOString().replace(/\.\d+/,"").replace(/[A-Z]|\.\d+/g," ")+rN(null!==(n=e.offset)&&void 0!==n?n:0);if(1!==t.length)return iN(o,t,!0);switch(t){case"D":case"d":return nN(o,"first");case"T":case"t":return nN(o,"second");case"O":case"o":return function(e,t){const r=e.toISOString();return r.substring(0,r.length-1)+rN(t)}(o,null!==(i=e.offset)&&void 0!==i?i:0);default:throw new Error("Unrecognized Date print format")}}function aN(e,t){const r=1===e.kind;if("string"!=typeof t)return r?e.toUTCString():e.toLocaleString();if(1!==t.length)return iN(e,t,r);switch(t){case"D":case"d":return r?nN(e,"first"):e.toLocaleDateString();case"T":case"t":return r?nN(e,"second"):e.toLocaleTimeString();case"O":case"o":return function(e,t){if(t)return e.toISOString();{const t=null==e.kind||2===e.kind;return NR(e.getFullYear(),4)+"-"+NR(e.getMonth()+1,2)+"-"+NR(e.getDate(),2)+"T"+NR(e.getHours(),2)+":"+NR(e.getMinutes(),2)+":"+NR(e.getSeconds(),2)+"."+NR(e.getMilliseconds(),3)+(t?rN(-6e4*e.getTimezoneOffset()):"")}}(e,r);default:throw new Error("Unrecognized Date print format")}}function sN(e,t,r){return null!=e.offset?oN(e,t):aN(e,t)}function lN(e,t){const r=new Date(e);return r.kind=0|(null==t?0:t),r}function uN(){return lN(Date.now(),2)}function cN(e,t){const r=lN(e.getTime()+t,e.kind);if(2===e.kind){const t=e.getTimezoneOffset(),n=r.getTimezoneOffset();return t!==n?lN(r.getTime()+6e4*(n-t),e.kind):r}return r}function dN(e,t){return r=e,"number"==typeof(n=t)?cN(r,-n):r.getTime()-n.getTime();var r,n}function fN(e,t=0){if(0!=(-276&t))throw new Error("RegexOptions only supports: IgnoreCase, Multiline, Singleline and ECMAScript");let r="gu";return r+=1&t?"i":"",r+=2&t?"m":"",r+=16&t?"s":"",new RegExp(e,r)}function pN(e,t,r=0){return e.lastIndex=r,e.exec(t)}const mN=/(^|[^%])%([0+\- ]*)(\*|\d+)?(?:\.(\d+))?(\w)/g,hN=/\{(\d+)(,-?\d+)?(?:\:([a-zA-Z])(\d{0,2})|\:(.+?))?\}/g;function gN(e,t){return function(e,t){return"number"==typeof e?e<t?-1:e>t?1:0:e.CompareTo(t)}(e,t)<0}function vN(e){return{input:e,cont:(t=e,e=>{mN.lastIndex=0;const r=[],n=[];let i=0,o=mN.exec(t);for(;o;){const e=o.index+(o[1]||"").length;r.push(t.substring(i,e).replace(/%%/g,"%")),n.push(o),i=mN.lastIndex,mN.lastIndex-=1,o=mN.exec(t)}return 0===r.length?e(t.replace(/%%/g,"%")):(r.push(t.substring(i).replace(/%%/g,"%")),function e(t,r,n,i="",o=-1){return(...a)=>{let s=i;const l=r.slice(),u=n.slice();for(const e of a){const[,,t,r,n,i]=u[0];let a=r;if(o>=0)a=o,o=-1;else if("*"===a){if(e<0)throw new Error("Non-negative number required");o=e;continue}s+=l[0],s+=CN(e,t,a,n,i),l.splice(0,1),u.splice(0,1)}return 0===u.length?(s+=l[0],t(s)):e(t,l,u,s,o)}}(e,r,n))})};var t}function SN(e,t){return"string"==typeof t?e(t):t.cont(e)}function yN(e){return SN(e=>e,e)}function CN(e,t,r,n,i){let o="";if(t=t||"",i=i||"",ob(e))switch("x"!==i.toLowerCase()&&(gN(e,0)?(e=ab(e,-1),o="-"):t.indexOf(" ")>=0?o=" ":t.indexOf("+")>=0&&(o="+")),n=null==n?null:parseInt(n,10),i){case"f":case"F":e=sb(e,n=null!=n?n:6);break;case"g":case"G":e=null!=n?lb(e,n):lb(e);break;case"e":case"E":e=null!=n?ub(e,n):ub(e);break;case"x":e=cb(e);break;case"X":e=cb(e).toUpperCase();break;default:e=String(e)}else e=e instanceof Date?sN(e):WR(e);if(r="number"==typeof r?r:parseInt(r,10),isNaN(r))e=o+e;else{const n=t.indexOf("0")>=0,i=t.indexOf("-")>=0,a=i||!n?" ":"0";e="0"===a?o+(e=TN(e,r-o.length,a,i)):TN(o+e,r,a,i)}return e}function RN(e,...t){return"object"==typeof e&&t.length>0&&(e=t[0],t.shift()),e.replace(hN,(e,r,n,i,o,a)=>{if(r<0||r>=t.length)throw new Error("Index must be greater or equal to zero and less than the arguments' length.");let s=t[r];if(ob(s))switch(o=null==o?null:parseInt(o,10),i){case"f":case"F":s=sb(s,o=null!=o?o:2);break;case"g":case"G":s=null!=o?lb(s,o):lb(s);break;case"e":case"E":s=null!=o?ub(s,o):ub(s);break;case"p":case"P":o=null!=o?o:2,s=sb(ab(s,100),o)+" %";break;case"d":case"D":s=null!=o?TN(String(s),o,"0"):String(s);break;case"x":case"X":s=null!=o?TN(cb(s),o,"0"):cb(s),"X"===i&&(s=s.toUpperCase());break;default:if(a){let e="";s=a.replace(/([0#,]+)(\.[0#]+)?/,(t,r,n)=>{gN(s,0)&&(s=ab(s,-1),e="-");const i=null!=n?n.length:0;if(s=sb(s,Math.max(i-1,0)),r.indexOf(",")>0){const[e,t]=s.split("."),r=e.length%3,n=Math.floor(e.length/3);let i=r>0?e.substr(0,r)+(n>0?",":""):"";for(let t=0;t<n;t++)i+=e.substr(r+3*t,3)+(t<n-1?",":"");s=t?i+"."+t:i}const o=(r=r.replace(/,/g,"")).length>0&&"0"===r[0]?r.length:0;return TN(s,o-e.length+i,"0")}),s=e+s}}else s=s instanceof Date?sN(s,a||i):WR(s);return n=parseInt((n||" ").substring(1),10),isNaN(n)||(s=TN(String(s),Math.abs(n)," ",n<0)),s})}function bN(e){return"string"!=typeof e||0===e.length}function NN(e,t){return Array.isArray(t)?t.join(e):Array.from(t).join(e)}function TN(e,t,r,n){r=r||" ",t-=e.length;for(let i=0;i<t;i++)e=n?e+r:r+e;return e}function PN(e,t,r){if(t+(r||0)>e.length)throw new Error("Invalid startIndex and/or length");return null!=r?e.substr(t,r):e.substr(t)}var EN={GetHashCode(){return OR([this.s,this.e].concat(this.c))},Equals(e){return!this.cmp(e)},CompareTo(e){return this.cmp(e)},[ib](){const e=this;return{multiply:t=>e.mul(t),toPrecision:t=>e.toPrecision(t),toExponential:t=>e.toExponential(t),toFixed:t=>e.toFixed(t),toHex:()=>(Number(e)>>>0).toString(16)}}},kN="[big.js] ",ON=kN+"Invalid ",AN=ON+"decimal places",IN=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function _N(e,t){var r,n,i;if(!IN.test(t))throw Error(ON+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),i=t.length,n=0;n<r&&n<i&&"0"==t.charAt(n);)++n;if(n==i)e.c=[e.e=0];else for(e.e=r-n-1,e.c=[],r=0;n<i;)e.c[r++]=+t.charAt(n++);return e=FN(e,DN.DP+1,DN.RM)}function FN(e,t,r,n){var i=e.c;if(void 0===r&&(r=DN.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error("[big.js] Invalid rounding mode");if(t<1)n=3===r&&(n||!!i[0])||0===t&&(1===r&&i[0]>=5||2===r&&(i[0]>5||5===i[0]&&(n||void 0!==i[1]))),i.length=1,n?(e.e=e.e-t+1,i[0]=1):i[0]=e.e=0;else if(t<i.length){const o=i.findIndex((e,r)=>r>=t&&e>0)<0;if(n=1===r&&i[t]>=5||2===r&&(i[t]>5||5===i[t]&&(n||void 0!==i[t+1]||1&i[t-1]))||3===r&&(n||!o),i.length=t--,n)for(;++i[t]>9;)i[t]=0,t--||(++e.e,i.unshift(1));for(t=i.length;!i[--t];)i.pop()}return e}function MN(e,t,r){var n=e.e,i=e.c.join(""),o=i.length;if(t)i=i.charAt(0)+(o>1?"."+i.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)i="0"+i;i="0."+i}else if(n>0)if(++n>o)for(n-=o;n--;)i+="0";else n<o&&(i=i.slice(0,n)+"."+i.slice(n));else o>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&r?"-"+i:i}EN.abs=function(){var e=new this.constructor(this);return e.s=1,e},EN.cmp=function(e){var t,r=this.constructor,n=new r(this),i=(e=new r(e),n.c),o=e.c,a=n.s,s=e.s,l=n.e,u=e.e;if(!i[0]||!o[0])return i[0]?a:o[0]?-s:0;if(a!=s)return a;if(t=a<0,l!=u)return l>u^t?1:-1;for(s=Math.max(i.length,o.length),a=0;a<s;a++)if((l=a<i.length?i[a]:0)!=(u=a<o.length?o[a]:0))return l>u^t?1:-1;return 0},EN.div=function(e){var t=this.constructor,r=new t(this),n=(e=new t(e),r.c),i=e.c,o=r.s==e.s?1:-1,a=t.DP;if(a!==~~a||a<0||a>1e6)throw Error(AN);if(!i[0])throw Error("[big.js] Division by zero");if(!n[0])return e.s=o,e.c=[e.e=0],e;var s,l,u,c,d,f=i.slice(),p=s=i.length,m=n.length,h=n.slice(0,s),g=h.length,v=e,S=v.c=[],y=0,C=a+(v.e=r.e-e.e)+1;for(v.s=o,o=C<0?0:C,f.unshift(0);g++<s;)h.push(0);do{for(u=0;u<10;u++){if(s!=(g=h.length))c=s>g?1:-1;else for(d=-1,c=0;++d<s;)if(i[d]!=h[d]){c=i[d]>h[d]?1:-1;break}if(!(c<0))break;for(l=g==s?i:f;g;){if(h[--g]<l[g]){for(d=g;d&&!h[--d];)h[d]=9;--h[d],h[g]+=10}h[g]-=l[g]}for(;!h[0];)h.shift()}S[y++]=c?u:++u,h[0]&&c?h[g]=n[p]||0:h=[n[p]]}while((p++<m||void 0!==h[0])&&o--);return S[0]||1==y||(S.shift(),v.e--,C--),y>C&&FN(v,C,t.RM,void 0!==h[0]),v},EN.eq=function(e){return 0===this.cmp(e)},EN.gt=function(e){return this.cmp(e)>0},EN.gte=function(e){return this.cmp(e)>-1},EN.lt=function(e){return this.cmp(e)<0},EN.lte=function(e){return this.cmp(e)<1},EN.minus=EN.sub=function(e){var t,r,n,i,o=this.constructor,a=new o(this),s=(e=new o(e),a.s),l=e.s;if(s!=l)return e.s=-l,a.plus(e);var u=a.c.slice(),c=a.e,d=e.c,f=e.e;if(!u[0]||!d[0])return d[0]?e.s=-l:u[0]?e=new o(a):e.s=1,e;if(s=c-f){for((i=s<0)?(s=-s,n=u):(f=c,n=d),n.reverse(),l=s;l--;)n.push(0);n.reverse()}else for(r=((i=u.length<d.length)?u:d).length,s=l=0;l<r;l++)if(u[l]!=d[l]){i=u[l]<d[l];break}if(i&&(n=u,u=d,d=n,e.s=-e.s),(l=(r=d.length)-(t=u.length))>0)for(;l--;)u[t++]=0;for(l=t;r>s;){if(u[--r]<d[r]){for(t=r;t&&!u[--t];)u[t]=9;--u[t],u[r]+=10}u[r]-=d[r]}for(;0===u[--l];)u.pop();for(;0===u[0];)u.shift(),--f;return u[0]||(e.s=1,u=[f=0]),e.c=u,e.e=f,e},EN.mod=function(e){var t,r=this.constructor,n=new r(this),i=(e=new r(e),n.s),o=e.s;if(!e.c[0])throw Error("[big.js] Division by zero");return n.s=e.s=1,t=1==e.cmp(n),n.s=i,e.s=o,t?new r(n):(i=r.DP,o=r.RM,r.DP=r.RM=0,n=n.div(e),r.DP=i,r.RM=o,this.minus(n.times(e)))},EN.plus=EN.add=function(e){var t,r,n,i=this.constructor,o=new i(this);e=new i(e);if(o.s!=e.s)return e.s=-e.s,o.minus(e);var a=o.e,s=o.c,l=e.e,u=e.c;if(!s[0]||!u[0])return u[0]||(s[0]?e=new i(o):e.s=o.s),e;if(s=s.slice(),t=a-l){for(t>0?(l=a,n=u):(t=-t,n=s),n.reverse();t--;)n.push(0);n.reverse()}for(s.length-u.length<0&&(n=u,u=s,s=n),t=u.length,r=0;t;s[t]%=10)r=(s[--t]=s[t]+u[t]+r)/10|0;for(r&&(s.unshift(r),++l),t=s.length;0===s[--t];)s.pop();return e.c=s,e.e=l,e},EN.pow=function(e){var t=this.constructor,r=new t(this),n=new t("1"),i=new t("1"),o=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(ON+"exponent");for(o&&(e=-e);1&e&&(n=n.times(r)),e>>=1;)r=r.times(r);return o?i.div(n):n},EN.prec=function(e,t){if(e!==~~e||e<1||e>1e6)throw Error(ON+"precision");return FN(new this.constructor(this),e,t)},EN.round=function(e,t){if(void 0===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(AN);return FN(new this.constructor(this),e+this.e+1,t)},EN.sqrt=function(){var e,t,r,n=this.constructor,i=new n(this),o=i.s,a=i.e,s=new n("0.5");if(!i.c[0])return new n(i);if(o<0)throw Error(kN+"No square root");0===(o=Math.sqrt(i+""))||o===1/0?((t=i.c.join("")).length+a&1||(t+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new n(((o=Math.sqrt(t))==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):e=new n(o+""),a=e.e+(n.DP+=4);do{r=e,e=s.times(r.plus(i.div(r)))}while(r.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return FN(e,(n.DP-=4)+e.e+1,n.RM)},EN.times=EN.mul=function(e){var t,r=this.constructor,n=new r(this),i=(e=new r(e),n.c),o=e.c,a=i.length,s=o.length,l=n.e,u=e.e;if(e.s=n.s==e.s?1:-1,!i[0]||!o[0])return e.c=[e.e=0],e;for(e.e=l+u,a<s&&(t=i,i=o,o=t,u=a,a=s,s=u),t=new Array(u=a+s);u--;)t[u]=0;for(l=s;l--;){for(s=0,u=a+l;u>l;)s=t[u]+o[l]*i[u-l-1]+s,t[u--]=s%10,s=s/10|0;t[u]=s}for(s?++e.e:t.shift(),l=t.length;!t[--l];)t.pop();return e.c=t,e},EN.toExponential=function(e,t){var r=this,n=r.c[0];if(void 0!==e){if(e!==~~e||e<0||e>1e6)throw Error(AN);for(r=FN(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return MN(r,!0,!!n)},EN.toFixed=function(e,t){var r=this,n=r.c[0];if(void 0!==e){if(e!==~~e||e<0||e>1e6)throw Error(AN);for(e=e+(r=FN(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return MN(r,!1,!!n)},EN.toJSON=EN.toString=function(){var e=this,t=e.constructor;return MN(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},EN.toNumber=function(){var e=Number(MN(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(kN+"Imprecise conversion");return e},EN.toPrecision=function(e,t){var r=this,n=r.constructor,i=r.c[0];if(void 0!==e){if(e!==~~e||e<1||e>1e6)throw Error(ON+"precision");for(r=FN(new n(r),e,t);r.c.length<e;)r.c.push(0)}return MN(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!i)},EN.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(kN+"valueOf disallowed");return MN(e,e.e<=t.NE||e.e>=t.PE,!0)};var DN=function e(){function t(r){var n=this;if(!(n instanceof t))return void 0===r?e():new t(r);if(r instanceof t)n.s=r.s,n.e=r.e,n.c=r.c.slice(),function(e){if(e.c.length>1&&!e.c[0]){let t=e.c.findIndex(e=>e);e.c=e.c.slice(t),e.e=e.e-t}}(n);else{if("string"!=typeof r){if(!0===t.strict)throw TypeError(ON+"number");r=0===r&&1/r<0?"-0":String(r)}_N(n,r)}n.constructor=t}return t.prototype=EN,t.DP=28,t.RM=1,t.NE=-29,t.PE=29,t.strict=!1,t}(),wN=DN;new wN(0),new wN(1),new wN(-1),new wN("79228162514264337593543950335"),new wN("-79228162514264337593543950335");class LN{constructor(e,t,r,n,i,o,a){this.fullname=e,this.generics=t,this.construct=r,this.parent=n,this.fields=i,this.cases=o,this.enumCases=a}toString(){return function e(t){const r=GN(t);return null!=r?e(r)+"[]":null==t.generics||0===t.generics.length?t.fullname:t.fullname+"["+t.generics.map(t=>e(t)).join(",")+"]"}(this)}GetHashCode(){return BN(this)}Equals(e){return UN(this,e)}}function xN(e){return null!=e.generics?e.generics:[]}function BN(e){return OR([ER(e.fullname),...xN(e).map(BN)])}function UN(e,t){return""===e.fullname?""===t.fullname&&FR(KN(e),KN(t),([e,t],[r,n])=>e===r&&UN(t,n)):e.fullname===t.fullname&&FR(xN(e),xN(t),UN)}new LN("System.Object"),new LN("Microsoft.FSharp.Core.Unit"),new LN("System.Char"),new LN("System.String"),new LN("System.Boolean"),new LN("System.SByte"),new LN("System.Byte"),new LN("System.Int16"),new LN("System.UInt16"),new LN("System.Int32"),new LN("System.UInt32"),new LN("System.Single"),new LN("System.Double"),new LN("System.Decimal");function GN(e){var t;return"[]"===e.fullname&&1===(null===(t=e.generics)||void 0===t?void 0:t.length)?e.generics[0]:void 0}function KN(e){if(null!=e.fields)return e.fields();throw new Error(e.fullname+" is not an F# record type")}class VN{constructor(e){this.value=e}toJSON(){return this.value}toString(){return String(this.value)}GetHashCode(){return IR(this.value)}Equals(e){return null!=e&&DR(this.value,e instanceof VN?e.value:e)}CompareTo(e){return null==e?1:BR(this.value,e instanceof VN?e.value:e)}}function jN(e){return null==e||e instanceof VN?new VN(e):e}function WN(e){if(null==e)throw new Error("Option has no value");return e instanceof VN?e.value:e}function HN(e,t){return null!=e?WN(e):t}function QN(e,t){return"function"==typeof e?new e(t):new Array(t)}function qN(e,t,r,n){const i=0|t;return e.fill(n,i,i+r)}function zN(e,t,r,n,i){const o=0|HN(r,0),a=0|HN((s=e=>o+e,null!=(l=n)?jN(s(WN(l))):void 0),e.length);var s,l;return 0|(r=>{for(;;){const n=r;if(n>=a)return-1;if(i.Equals(t,e[n]))return 0|n;r=n+1}})(o)}function YN(e,t,r){return zN(t,e,void 0,void 0,r)>=0}class JN extends XR{constructor(e,t){super(),this.head=e,this.tail=t}toString(){return"["+NN("; ",this)+"]"}Equals(e){const t=this;if(t===e)return!0;return((e,t)=>{e:for(;;){const r=e,n=t,i=[r.tail,n.tail];if(null!=i[0]){if(null!=i[1]){const o=i[0],a=i[1];if(DR(r.head,n.head)){e=o,t=a;continue e}return!1}return!1}return null==i[1]}})(t,e)}GetHashCode(){return 0|((e,t,r)=>{for(;;){const n=e,i=t,o=r,a=o.tail;if(null==a)return 0|i;{const s=a;if(n>18)return 0|i;e=n+1,t=(i<<1)+IR(o.head)+631*n,r=s}}})(0,0,this)}toJSON(e){return Array.from(this)}CompareTo(e){return 0|((e,t)=>{e:for(;;){const r=e,n=t,i=[r.tail,n.tail];if(null!=i[0]){if(null!=i[1]){const o=i[0],a=i[1],s=0|BR(r.head,n.head);if(0===s){e=o,t=a;continue e}return 0|s}return 1}return null!=i[1]?-1:0}})(this,e)}GetEnumerator(){return function(e){return new XN(e)}(this)}[Symbol.iterator](){return bR(this.GetEnumerator())}"System.Collections.IEnumerable.GetEnumerator"(){return RR(this)}}class XN{constructor(e){this.xs=e,this.it=this.xs,this.current=null}"System.Collections.Generic.IEnumerator`1.get_Current"(){return this.current}"System.Collections.IEnumerator.get_Current"(){return this.current}"System.Collections.IEnumerator.MoveNext"(){const e=this,t=e.it.tail;if(null!=t){const r=t;return e.current=e.it.head,e.it=r,!0}return!1}"System.Collections.IEnumerator.Reset"(){this.it=this.xs,this.current=null}Dispose(){}}function $N(){return new JN(null,void 0)}function ZN(e,t){return new JN(e,t)}function eT(e){return null==e.tail}function tT(e){return 0|((e,t)=>{for(;;){const r=e,n=t.tail;if(null==n)return 0|r;e=r+1,t=n}})(0,e)}function rT(e){if(null!=e.tail)return e.head;throw new Error("Collection was empty.\\nParameter name: list")}function nT(e){const t=e.tail;if(null!=t)return t;throw new Error("Collection was empty.\\nParameter name: list")}function iT(){return $N()}function oT(e,t){return ZN(e,t)}function aT(e){return ZN(e,$N())}function sT(e){return eT(e)}function lT(e){return rT(e)}function uT(e){return nT(e)}function cT(e){const t=0|tT(e),r=qN(new Array(t),0,t,null);return((e,t)=>{for(;;){const n=e,i=t;if(eT(i))break;r[n]=rT(i),e=n+1,t=nT(i)}})(0,e),r}function dT(e,t,r){let n=t,i=r;for(;!eT(i);)n=e(n,rT(i)),i=nT(i);return n}function fT(e){return dT((e,t)=>ZN(t,e),$N(),e)}function pT(e,t){let r=t;for(let t=e.length-1;t>=0;t--)r=ZN(e[t],r);return r}function mT(e){return pT(e,$N())}function hT(e){let t,r;if(hR(e))return mT(e);if(e instanceof JN)return e;{const n=$N();let i=n;const o=RR(e);try{for(;o["System.Collections.IEnumerator.MoveNext"]();){const e=o["System.Collections.Generic.IEnumerator`1.get_Current"]();t=i,r=new JN(e,void 0),t.tail=r,i=r}}finally{SR(o)}const a=i,s=$N();return a.tail=s,nT(n)}}function gT(e,t){return dT((e,t)=>ZN(t,e),t,fT(e))}function vT(e,t){return function(e,t){let r,n;const i=$N();let o=i;for(let i=0;i<=e-1;i++)r=o,n=new JN(t(i),void 0),r.tail=n,o=n;const a=o,s=$N();return a.tail=s,nT(i)}(e,e=>t)}function ST(){throw new Error("Enumeration has not started. Call MoveNext.")}function yT(){throw new Error("Enumeration already finished.")}class CT{constructor(e){this.f=e}toString(){let e=0,t="seq [";const r=RR(this);try{for(;e<4&&r["System.Collections.IEnumerator.MoveNext"]();)e>0&&(t+="; "),t+=WR(r["System.Collections.Generic.IEnumerator`1.get_Current"]()),e=e+1|0;return 4===e&&(t+="; ..."),t+"]"}finally{SR(r)}}GetEnumerator(){return this.f()}[Symbol.iterator](){return bR(this.GetEnumerator())}"System.Collections.IEnumerable.GetEnumerator"(){return this.f()}}class RT{constructor(e,t,r){this.current=e,this.next=t,this.dispose=r}"System.Collections.Generic.IEnumerator`1.get_Current"(){return this.current()}"System.Collections.IEnumerator.get_Current"(){return this.current()}"System.Collections.IEnumerator.MoveNext"(){return this.next()}"System.Collections.IEnumerator.Reset"(){!function(){throw new Error("Reset is not supported on this enumerator.")}()}Dispose(){this.dispose()}}function bT(e,t,r){return new RT(e,t,r)}function NT(e,t,r){let n=!1,i=void 0,o=jN(e());const a=()=>{if(null!=o){const e=WN(o);try{r(e)}finally{o=void 0}}},s=()=>{try{a()}finally{i=void 0}};return bT(()=>(n||ST(),null!=i?WN(i):yT()),()=>{if(n||(n=!0),null!=o){const e=WN(o);let r;try{r=t(e)}catch(e){throw s(),e}return null!=r?(i=r,!0):(s(),!1)}return!1},a)}function TT(e,t){null==t&&function(e){throw new Error(e)}(e)}function PT(e){return function(e){return new CT(e)}(e)}function ET(e){return TT("source",e),RR(e)}function kT(e){return PT(()=>RR(e()))}function OT(e){return PT(()=>function(e){let t=void 0,r=void 0,n=!1,i=!1,o=void 0;const a=()=>{if(i=!0,null!=r){const e=r;try{SR(e)}finally{r=void 0}}if(null!=t){const e=t;try{SR(e)}finally{t=void 0}}};return bT(()=>(n?i&&yT():ST(),null!=o?WN(o):yT()),()=>{let s;if(n||(n=!0),i)return!1;{let n=void 0;for(;null==n;){const i=[t,r];if(null!=i[0])if(null!=i[1]){const e=i[1];if(e["System.Collections.IEnumerator.MoveNext"]())o=jN(e["System.Collections.Generic.IEnumerator`1.get_Current"]()),n=!0;else try{SR(e)}finally{r=void 0}}else{const e=i[0];if(e["System.Collections.IEnumerator.MoveNext"]()){s=e["System.Collections.Generic.IEnumerator`1.get_Current"](),r=RR(s)}else a(),n=!1}else t=RR(e)}return WN(n)}},()=>{i||a()})}(e))}function AT(e,t){return PT(()=>function(e,t){let r=void 0,n=t;return bT(()=>{if(null!=r){const e=r[0];r[1];return e}return ST()},()=>{if(r=e(n),null!=r){r[0];const e=r[1];return n=e,!0}return!1},()=>{})}(e,t))}function IT(){return kT(()=>new Array(0))}function _T(e){return kT(()=>function(e,t){const r=QN(t,1);return r[0]=e,r}(e))}function FT(e){return e instanceof JN?cT(e):Array.from(e)}function MT(e,t,r){return PT(()=>NT(e,t,r))}function DT(e,t,r){return PT(()=>{let n=-1;return NT(e,e=>(n=n+1|0,t(n,e)),r)})}function wT(e,t){return OT([e,t])}function LT(e,t){return OT(AT(r=>e()?[t,r+1]:void 0,0))}function xT(e,t,r){const n=ET(r);try{let r=t;for(;n["System.Collections.IEnumerator.MoveNext"]();)r=e(r,n["System.Collections.Generic.IEnumerator`1.get_Current"]());return r}finally{SR(n)}}function BT(e,t){xT((t,r)=>{e(r)},void 0,t)}function UT(e,t){xT((t,r)=>(e(t,r),t+1|0),0,t)}function GT(e,t){return MT(()=>ET(t),t=>t["System.Collections.IEnumerator.MoveNext"]()?jN(e(t["System.Collections.Generic.IEnumerator`1.get_Current"]())):void 0,e=>{SR(e)})}Symbol.iterator;function KT(e){return kT(()=>FT(e).slice().reverse())}function VT(e,t){return kT(()=>OT(GT(e,t)))}class jT{constructor(e=!1){this._id=0,this._cancelled=e,this._listeners=new Map}get isCancelled(){return this._cancelled}cancel(){if(!this._cancelled){this._cancelled=!0;for(const[,e]of this._listeners)e()}}addListener(e){const t=this._id;return this._listeners.set(this._id++,e),t}removeListener(e){return this._listeners.delete(e)}register(e,t){const r=this,n=this.addListener(null==t?e:()=>e(t));return{Dispose(){r.removeListener(n)}}}}class WT extends Error{constructor(){super("The operation was canceled"),Object.setPrototypeOf(this,WT.prototype)}}function HT(e){return t=>{if(t.cancelToken.isCancelled)t.onCancel(new WT);else if(t.trampoline.incrementAndCheck())t.trampoline.hijack(()=>{try{e(t)}catch(e){t.onError(eb(e))}});else try{e(t)}catch(e){t.onError(eb(e))}}}function QT(e,t){return HT(r=>{e({onSuccess:e=>{try{t(e)(r)}catch(e){r.onError(eb(e))}},onError:r.onError,onCancel:r.onCancel,cancelToken:r.cancelToken,trampoline:r.trampoline})})}function qT(e){return HT(t=>t.onSuccess(e))}new class{Bind(e,t){return QT(e,t)}Combine(e,t){return this.Bind(e,()=>t)}Delay(e){return HT(t=>e()(t))}For(e,t){const r=e[Symbol.iterator]();let n=r.next();return this.While(()=>!n.done,this.Delay(()=>{const e=t(n.value);return n=r.next(),e}))}Return(e){return qT(e)}ReturnFrom(e){return e}TryFinally(e,t){return HT(r=>{e({onSuccess:e=>{t(),r.onSuccess(e)},onError:e=>{t(),r.onError(e)},onCancel:e=>{t(),r.onCancel(e)},cancelToken:r.cancelToken,trampoline:r.trampoline})})}TryWith(e,t){return HT(r=>{e({onSuccess:r.onSuccess,onCancel:r.onCancel,cancelToken:r.cancelToken,trampoline:r.trampoline,onError:e=>{try{t(e)(r)}catch(e){r.onError(eb(e))}}})})}Using(e,t){return this.TryFinally(t(e),()=>e.Dispose())}While(e,t){return e()?this.Bind(t,()=>this.While(e,t)):this.Return(void 0)}Zero(){return HT(e=>e.onSuccess(void 0))}};new jT;let zT=function(e){let t=e;return(e,r)=>r?void(t=e):t}(void 0);function YT(e){let t;if(null!=zT()){let r,n=null;r=[tb(zT().SymbolNames,e,new $R(()=>n,e=>{n=e})),n],t=r[0]?r[1]:void 0}else t=void 0;return null==t?yN(vN("?%d"))(e):t}class JT extends HR{constructor(e,...t){super(),this.tag=0|e,this.fields=t}cases(){return["Unmodified","AdHoc","Core"]}}class XT extends XR{constructor(e,t){super(),this.FromInput=e,this.ModifyStatus=t}toString(){const e=[this.FromInput,$T(this)];return e[0]?e[1]?"":"[*]":e[1]?"[+]":"[+*]"}}function $T(e){return DR(e.ModifyStatus,new JT(0))}const ZT=new XT(!0,new JT(0));class eP extends XR{constructor(e,t){super(),this.Start=0|e,this.End=0|t}}const tP=new eP(0,0);class rP extends XR{constructor(e,t,r,n){super(),this.symbol=0|e,this.value=t,this.meta=r,this.span=n}toString(){return`${YT(this.symbol)}${bN(this.value)?"":`(${this.value})`}${lP(this)}`}}function nP(e,t,r,n){return new rP(e,t,r,n)}function iP(e,t){return nP(e,t,ZT,tP)}function oP(e,t,r){return nP(e,t,r,tP)}function aP(e){return e.symbol}function sP(e){return e.value}function lP(e){return e.meta}function uP(e){return e.span}function cP(e,t){return NN(e,GT(e=>WR(e),t))}class dP extends XR{constructor(e,t,r){super(),this.Reliable=e,this.Unreliable=t,this.MinEditDist=r}toString(){const e=cP(" ",this.Unreliable),t=WR(this.Reliable);return yN(vN("(%s, %s)"))(e)(t)}}class fP extends XR{constructor(e,t){super(),this.RuleId=0|e,this.RuleIdx=0|t}toString(){const e=function(e){let t;if(null!=zT()){const r=zT();t=e>=0&&e<r.RuleStrings.length?r.RuleStrings[e]:void 0}else t=void 0;return null==t?yN(vN("?%d"))(e):t}(this.RuleId);return yN(vN("(%s, %d)"))(e)(this.RuleIdx)}}const pP=new fP(-1,-1);class mP extends XR{constructor(e,t){super(),this.Symbol=0|e,this.Source=t}toString(){return YT(this.Symbol)}}class hP extends XR{constructor(e,t){super(),this.Token=e,this.Source=t}toString(){return WR(this.Token)}}class gP extends XR{constructor(e,t,r,n,i,o,a,s){super(),this.Input=e,this.Stack=t,this.MatchedTokens=r,this.Cost=n,this.EditDistance=i,this.Backtrack=o,this.Parent=a,this.Context=s}toString(){const e=cP(" ",this.Input),t=cP(" ",this.Stack),r=cP(" ",KT(this.MatchedTokens));return yN(vN("{Input = %s, Stack = %s, Matched = %s, Cost = %f, EditDistance = %f}"))(e)(t)(r)(this.Cost)(this.EditDistance)}}class vP extends XR{constructor(e,t,r){super(),this.Tokens=e,this.EditDistance=t,this.Cost=r}}class SP{constructor(){}"Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsDebuggerAttached"(){return!1}}class yP extends SP{constructor(e){super(),this.time=e,this.start=uN()}"Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"(){return!this["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsDebuggerAttached"]()&&dN(uN(),this.start)>=this.time}}function CP(e){return new yP(e)}class RP extends HR{constructor(e,...t){super(),this.tag=0|e,this.fields=t}cases(){return["EmptyResult","IncompleteResults","Exception"]}}Symbol.toStringTag,Symbol.iterator;class bP{constructor(e){this.k=e}}function NP(e){return new bP(e)}function TP(e){return e.k}class PP extends bP{constructor(e,t,r,n){super(e),this.left=t,this.right=r,this.h=0|n}}function EP(e,t,r,n){return new PP(e,t,r,n)}function kP(e){return e.left}function OP(e){return e.right}function AP(e){return e.h}function IP(e){return function e(t,r){e:for(;;){const n=t,i=r;if(null!=n){const o=n;if(o instanceof PP){t=kP(o),r=e(OP(o),i+1);continue e}return i+1|0}return 0|i}}(e,0)}function _P(e,t,r){let n;if(null!=e){const t=e;n=t instanceof PP?AP(t):1}else n=0;let i;if(null!=r){const e=r;i=e instanceof PP?AP(e):1}else i=0;const o=0|(n<i?i:n);return 0===o?NP(t):EP(t,e,r,o+1)}function FP(e,t,r){let n,i,o,a,s;if(null!=e){const t=e;s=t instanceof PP?AP(t):1}else s=0;let l;if(null!=r){const e=r;l=e instanceof PP?AP(e):1}else l=0;if(l>s+2){const o=WN(r);if(o instanceof PP){if(n=kP(o),(null!=n?(i=n,i instanceof PP?AP(i):1):0)>s+1){const r=WN(kP(o));if(r instanceof PP)return _P(_P(e,t,kP(r)),TP(r),_P(OP(r),TP(o),OP(o)));throw new Error("internal error: Set.rebalance")}return _P(_P(e,t,kP(o)),TP(o),OP(o))}throw new Error("internal error: Set.rebalance")}if(s>l+2){const n=WN(e);if(n instanceof PP){if(o=OP(n),(null!=o?(a=o,a instanceof PP?AP(a):1):0)>l+1){const e=WN(OP(n));if(e instanceof PP)return _P(_P(kP(n),TP(n),kP(e)),TP(e),_P(OP(e),t,r));throw new Error("internal error: Set.rebalance")}return _P(kP(n),TP(n),_P(OP(n),t,r))}throw new Error("internal error: Set.rebalance")}return _P(e,t,r)}function MP(e,t,r){if(null!=r){const n=r,i=0|e.Compare(t,TP(n));if(n instanceof PP)return i<0?FP(MP(e,t,kP(n)),TP(n),OP(n)):0===i?r:FP(kP(n),TP(n),MP(e,t,OP(n)));{const i=0|e.Compare(t,TP(n));return i<0?EP(t,void 0,r,2):0===i?r:EP(t,r,void 0,2)}}return NP(t)}function DP(e,t,r){e:for(;;){const n=e,i=t,o=r;if(null!=o){const a=o,s=0|n.Compare(i,TP(a));if(a instanceof PP){if(s<0){e=n,t=i,r=kP(a);continue e}if(0===s)return!0;e=n,t=i,r=OP(a);continue e}return 0===s}return!1}}function wP(e,t){e:for(;;){const r=e,n=t;if(null!=n){const i=n;if(i instanceof PP){wP(r,kP(i)),r(TP(i)),e=r,t=OP(i);continue e}r(TP(i))}break}}function LP(e,t){e:for(;;){const r=e,n=t;if(null!=n){const i=n;if(i instanceof PP){if(r(TP(i))||LP(r,kP(i)))return!0;e=r,t=OP(i);continue e}return r(TP(i))}return!1}}class xP extends XR{constructor(e,t){super(),this.stack=e,this.started=t}}function BP(e){e:for(;;){const t=e;if(sT(t))return iT();{const r=lT(t),n=uT(t);if(null!=r){const i=r;if(i instanceof PP){e=pT([kP(i),NP(TP(i)),OP(i)],n);continue e}return t}e=n;continue e}}}function UP(e){return new xP(BP(aT(e)),!1)}function GP(e){if(e.started){const t=e.stack;if(sT(t))return function(){throw new Error("Enumeration already started")}();if(null!=lT(t)){return TP(lT(t))}throw new Error("Please report error: Set iterator, unexpected stack for current")}return function(){throw new Error("Enumeration not started")}()}function KP(e){let t=UP(e);return{"System.Collections.Generic.IEnumerator`1.get_Current":()=>GP(t),"System.Collections.IEnumerator.get_Current":()=>GP(t),"System.Collections.IEnumerator.MoveNext":()=>function(e){if(e.started){const t=e.stack;if(sT(t))return!1;if(null!=lT(t)){if(lT(t)instanceof PP)throw new Error("Please report error: Set iterator, unexpected stack for moveNext");return e.stack=BP(uT(t)),!sT(e.stack)}throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}return e.started=!0,!sT(e.stack)}(t),"System.Collections.IEnumerator.Reset"(){t=UP(e)},Dispose(){}}}function VP(e,t,r){return null==t?null==r?0:-1:null==r?1:0|function(e,t,r){e:for(;;){const n=e,i=t,o=r,a=[i,o];if(sT(a[0]))return sT(a[1])?0:-1;if(sT(a[1]))return 1;if(null!=lT(a[1]))if(null!=lT(a[0])){const s=lT(a[0]),l=lT(a[1]);if(s instanceof PP)if(null==kP(s)){if(!(l instanceof PP)){const i=0|n.Compare(TP(s),TP(l));if(0!==i)return 0|i;e=n,t=oT(OP(s),uT(a[0])),r=oT(void 0,uT(a[1]));continue e}if(null==kP(l)){const i=0|n.Compare(TP(s),TP(l));if(0!==i)return 0|i;e=n,t=oT(OP(s),uT(a[0])),r=oT(OP(l),uT(a[1]));continue e}{const a=[i,o];let s,l,u,c,d;switch(sT(a[0])?sT(a[1])?s=2:null!=lT(a[1])?(s=1,c=uT(a[1]),d=lT(a[1])):s=2:null!=lT(a[0])?(s=0,l=uT(a[0]),u=lT(a[0])):sT(a[1])?s=2:null!=lT(a[1])?(s=1,c=uT(a[1]),d=lT(a[1])):s=2,s){case 0:if(u instanceof PP){e=n,t=pT([kP(u),EP(TP(u),void 0,OP(u),0)],l),r=o;continue e}e=n,t=pT([void 0,NP(TP(u))],l),r=o;continue e;case 1:if(d instanceof PP){e=n,t=i,r=pT([kP(d),EP(TP(d),void 0,OP(d),0)],c);continue e}e=n,t=i,r=pT([void 0,NP(TP(d))],c);continue e;case 2:throw new Error("unexpected state in SetTree.compareStacks")}}}else{const a=[i,o];let s,l,u,c,d;switch(sT(a[0])?sT(a[1])?s=2:null!=lT(a[1])?(s=1,c=uT(a[1]),d=lT(a[1])):s=2:null!=lT(a[0])?(s=0,l=uT(a[0]),u=lT(a[0])):sT(a[1])?s=2:null!=lT(a[1])?(s=1,c=uT(a[1]),d=lT(a[1])):s=2,s){case 0:if(u instanceof PP){e=n,t=pT([kP(u),EP(TP(u),void 0,OP(u),0)],l),r=o;continue e}e=n,t=pT([void 0,NP(TP(u))],l),r=o;continue e;case 1:if(d instanceof PP){e=n,t=i,r=pT([kP(d),EP(TP(d),void 0,OP(d),0)],c);continue e}e=n,t=i,r=pT([void 0,NP(TP(d))],c);continue e;case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else{if(!(l instanceof PP)){const i=0|n.Compare(TP(s),TP(l));if(0!==i)return 0|i;e=n,t=uT(a[0]),r=uT(a[1]);continue e}if(null==kP(l)){const i=0|n.Compare(TP(s),TP(l));if(0!==i)return 0|i;e=n,t=oT(void 0,uT(a[0])),r=oT(OP(l),uT(a[1]));continue e}{const a=[i,o];let s,l,u,c,d;switch(sT(a[0])?sT(a[1])?s=2:null!=lT(a[1])?(s=1,c=uT(a[1]),d=lT(a[1])):s=2:null!=lT(a[0])?(s=0,l=uT(a[0]),u=lT(a[0])):sT(a[1])?s=2:null!=lT(a[1])?(s=1,c=uT(a[1]),d=lT(a[1])):s=2,s){case 0:if(u instanceof PP){e=n,t=pT([kP(u),EP(TP(u),void 0,OP(u),0)],l),r=o;continue e}e=n,t=pT([void 0,NP(TP(u))],l),r=o;continue e;case 1:if(d instanceof PP){e=n,t=i,r=pT([kP(d),EP(TP(d),void 0,OP(d),0)],c);continue e}e=n,t=i,r=pT([void 0,NP(TP(d))],c);continue e;case 2:throw new Error("unexpected state in SetTree.compareStacks")}}}}else{lT(a[1]);const s=[i,o];let l,u,c,d,f;switch(sT(s[0])?sT(s[1])?l=2:null!=lT(s[1])?(l=1,d=uT(s[1]),f=lT(s[1])):l=2:null!=lT(s[0])?(l=0,u=uT(s[0]),c=lT(s[0])):sT(s[1])?l=2:null!=lT(s[1])?(l=1,d=uT(s[1]),f=lT(s[1])):l=2,l){case 0:if(c instanceof PP){e=n,t=pT([kP(c),EP(TP(c),void 0,OP(c),0)],u),r=o;continue e}e=n,t=pT([void 0,NP(TP(c))],u),r=o;continue e;case 1:if(f instanceof PP){e=n,t=i,r=pT([kP(f),EP(TP(f),void 0,OP(f),0)],d);continue e}e=n,t=i,r=pT([void 0,NP(TP(f))],d);continue e;case 2:throw new Error("unexpected state in SetTree.compareStacks")}}else{if(null==lT(a[0])){e=n,t=uT(a[0]),r=uT(a[1]);continue e}{lT(a[0]);const s=[i,o];let l,u,c,d,f;switch(sT(s[0])?sT(s[1])?l=2:null!=lT(s[1])?(l=1,d=uT(s[1]),f=lT(s[1])):l=2:null!=lT(s[0])?(l=0,u=uT(s[0]),c=lT(s[0])):sT(s[1])?l=2:null!=lT(s[1])?(l=1,d=uT(s[1]),f=lT(s[1])):l=2,l){case 0:if(c instanceof PP){e=n,t=pT([kP(c),EP(TP(c),void 0,OP(c),0)],u),r=o;continue e}e=n,t=pT([void 0,NP(TP(c))],u),r=o;continue e;case 1:if(f instanceof PP){e=n,t=i,r=pT([kP(f),EP(TP(f),void 0,OP(f),0)],d);continue e}e=n,t=i,r=pT([void 0,NP(TP(f))],d);continue e;case 2:throw new Error("unexpected state in SetTree.compareStacks")}}}break}}(e,aT(t),aT(r))}function jP(e,t,r){let n=r;wP(e=>{t[n]=e,n=n+1|0},e)}function WP(e,t){return r=(t,r)=>MP(e,r,t),n=void 0,t.reduce(r,n);var r,n}function HP(e,t){if(hR(t))return WP(e,t);if(t instanceof JN)return function(e,t){return dT((t,r)=>MP(e,r,t),void 0,t)}(e,t);{const r=RR(t);try{return function(e,t,r){for(;;){const n=e,i=t,o=r;if(!o["System.Collections.IEnumerator.MoveNext"]())return i;e=n,t=MP(n,o["System.Collections.Generic.IEnumerator`1.get_Current"](),i),r=o}}(e,void 0,r)}finally{SR(r)}}}class QP{constructor(e,t){this.comparer=e,this.tree=t}GetHashCode(){return 0|function(e){let t,r=0;const n=RR(e);try{for(;n["System.Collections.IEnumerator.MoveNext"]();){const e=n["System.Collections.Generic.IEnumerator`1.get_Current"]();r=0|(t=0|IR(e),(r<<1)+t+631)}}finally{SR(n)}return 0|Math.abs(r)}(this)}Equals(e){return e instanceof QP&&0===VP(zP(this),YP(this),YP(e))}toString(){return"set ["+NN("; ",GT(e=>WR(e),this))+"]"}get[Symbol.toStringTag](){return"FSharpSet"}toJSON(e){return Array.from(this)}CompareTo(e){return 0|VP(zP(this),YP(this),YP(e))}"System.Collections.Generic.ICollection`1.Add2B595"(e){throw new Error("ReadOnlyCollection")}"System.Collections.Generic.ICollection`1.Clear"(){throw new Error("ReadOnlyCollection")}"System.Collections.Generic.ICollection`1.Remove2B595"(e){throw new Error("ReadOnlyCollection")}"System.Collections.Generic.ICollection`1.Contains2B595"(e){return DP(zP(this),e,YP(this))}"System.Collections.Generic.ICollection`1.CopyToZ2E171D71"(e,t){jP(YP(this),e,t)}"System.Collections.Generic.ICollection`1.get_IsReadOnly"(){return!0}"System.Collections.Generic.ICollection`1.get_Count"(){return 0|JP(this)}"System.Collections.Generic.IReadOnlyCollection`1.get_Count"(){return 0|JP(this)}GetEnumerator(){return KP(YP(this))}[Symbol.iterator](){return bR(this.GetEnumerator())}"System.Collections.IEnumerable.GetEnumerator"(){return KP(YP(this))}get size(){return 0|JP(this)}add(e){throw new Error("Set cannot be mutated")}clear(){throw new Error("Set cannot be mutated")}delete(e){throw new Error("Set cannot be mutated")}has(e){return XP(this,e)}keys(){return GT(e=>e,this)}values(){return GT(e=>e,this)}entries(){return GT(e=>[e,e],this)}forEach(e,t){const r=this;BT(t=>{e(t,t,r)},r)}}function qP(e,t){return new QP(e,t)}function zP(e){return e.comparer}function YP(e){return e.tree}function JP(e){return IP(YP(e))}function XP(e,t){return DP(zP(e),t,YP(e))}function $P(e,t){return LP(e,YP(t))}function ZP(e,t){return qP(t,HP(t,e))}class eE{constructor(e,t){const r=new $R(null);this.comparer=t,r.contents=this,this.hashMap=new Map([]),this["init@8-1"]=1;const n=RR(e);try{for(;n["System.Collections.IEnumerator.MoveNext"]();){const e=n["System.Collections.Generic.IEnumerator`1.get_Current"]();sE(r.contents,e[0],e[1])}}finally{SR(n)}}get[Symbol.toStringTag](){return"Dictionary"}toJSON(e){return Array.from(this)}"System.Collections.IEnumerable.GetEnumerator"(){return RR(this)}GetEnumerator(){return RR(OT(this.hashMap.values()))}[Symbol.iterator](){return bR(this.GetEnumerator())}"System.Collections.Generic.ICollection`1.Add2B595"(e){sE(this,e[0],e[1])}"System.Collections.Generic.ICollection`1.Clear"(){nE(this)}"System.Collections.Generic.ICollection`1.Contains2B595"(e){const t=rE(this,e[0]);let r;switch(r=null!=t&&DR(t[1],e[1])?0:1,r){case 0:return!0;case 1:return!1}}"System.Collections.Generic.ICollection`1.CopyToZ2E171D71"(e,t){UT((r,n)=>{e[t+r]=n},this)}"System.Collections.Generic.ICollection`1.get_Count"(){return 0|iE(this)}"System.Collections.Generic.ICollection`1.get_IsReadOnly"(){return!1}"System.Collections.Generic.ICollection`1.Remove2B595"(e){const t=this,r=rE(t,e[0]);return null!=r&&(DR(r[1],e[1])&&uE(t,e[0]),!0)}"System.Collections.Generic.IDictionary`2.Add5BDDA1"(e,t){sE(this,e,t)}"System.Collections.Generic.IDictionary`2.ContainsKey2B595"(e){return lE(this,e)}"System.Collections.Generic.IDictionary`2.get_Item2B595"(e){return oE(this,e)}"System.Collections.Generic.IDictionary`2.set_Item5BDDA1"(e,t){aE(this,e,t)}"System.Collections.Generic.IDictionary`2.get_Keys"(){const e=this;return FT(kT(()=>GT(e=>e[0],e)))}"System.Collections.Generic.IDictionary`2.Remove2B595"(e){return uE(this,e)}"System.Collections.Generic.IDictionary`2.TryGetValue23A0B95A"(e,t){const r=rE(this,e);if(null!=r){const e=r;return t.contents=e[1],!0}return!1}"System.Collections.Generic.IDictionary`2.get_Values"(){const e=this;return FT(kT(()=>GT(e=>e[1],e)))}get size(){return 0|iE(this)}clear(){nE(this)}delete(e){return uE(this,e)}entries(){return GT(e=>[e[0],e[1]],this)}get(e){return oE(this,e)}has(e){return lE(this,e)}keys(){return GT(e=>e[0],this)}set(e,t){return aE(this,e,t),this}values(){return GT(e=>e[1],this)}forEach(e,t){const r=this;BT(t=>{e(t[1],t[0],r)},r)}}function tE(e,t){const r=0|e.comparer.GetHashCode(t);let n,i=null;return n=[tb(e.hashMap,r,new $R(()=>i,e=>{i=e})),i],n[0]?[!0,r,n[1].findIndex(r=>e.comparer.Equals(t,r[0]))]:[!1,r,-1]}function rE(e,t){const r=tE(e,t);let n;switch(n=r[0]&&r[2]>-1?0:1,n){case 0:return rb(e.hashMap,r[1])[r[2]];case 1:return}}function nE(e){e.hashMap.clear()}function iE(e){let t=0,r=RR(e.hashMap.values());try{for(;r["System.Collections.IEnumerator.MoveNext"]();){t=t+r["System.Collections.Generic.IEnumerator`1.get_Current"]().length|0}}finally{SR(r)}return 0|t}function oE(e,t){const r=rE(e,t);if(null!=r)return r[1];throw new Error("The item was not found in collection")}function aE(e,t,r){const n=tE(e,t);let i;switch(i=n[0]&&n[2]>-1?0:1,i){case 0:rb(e.hashMap,n[1])[n[2]]=[t,r];break;case 1:if(n[0]){rb(e.hashMap,n[1]).push([t,r])}else e.hashMap.set(n[1],[[t,r]])}}function sE(e,t,r){const n=tE(e,t);let i;switch(i=n[0]&&n[2]>-1?0:1,i){case 0:{const e=RN("An item with the same key has already been added. Key: {0}",t);throw new Error(e)}case 1:if(n[0]){rb(e.hashMap,n[1]).push([t,r])}else e.hashMap.set(n[1],[[t,r]])}}function lE(e,t){const r=tE(e,t);let n;switch(n=r[0]&&r[2]>-1?0:1,n){case 0:return!0;case 1:return!1}}function uE(e,t){const r=tE(e,t);let n;switch(n=r[0]&&r[2]>-1?0:1,n){case 0:return rb(e.hashMap,r[1]).splice(r[2],1),!0;case 1:return!1}}class cE extends XR{constructor(e,t,r,n,i,o,a,s,l,u,c,d,f,p){super(),this.Rules=e,this.Terminals=t,this.DeletableTerminals=r,this.InsertableTerminals=n,this.TerminalWeights=i,this.TerminalDefaultValues=o,this.ReliableTerminals=a,this.Start=0|s,this.End=0|l,this.NumLaTable=u,this.LLTable=c,this.LLRepairTable=d,this.SymbolNames=f,this.RuleStrings=p}}const dE=ZP([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],{Compare:LR}),fE=ZP([5,9,10,3,2,1,7,4,6,8],{Compare:LR}),pE=ZP([5,9,10,3,2,1,7,4],{Compare:LR}),mE=new Map([[1,1],[2,1],[3,1],[4,1],[5,1],[6,1],[7,.5],[8,1],[9,1],[10,1]]),hE=new Map([[1,null],[2,null],[3,null],[4,":"],[5,null],[6," "],[7,null],[8,null],[9,null],[10,null]]),gE=ZP([0,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],{Compare:LR}),vE=new Map([[0,"T_EOF"],[1,"T_ParenOpen"],[2,"T_ParenClose"],[3,"T_Comma"],[4,"T_RangeOp"],[5,"T_Bang"],[6,"T_Spaces"],[7,"T_Quote"],[8,"T_Unexpected"],[9,"T_BracketClose"],[10,"T_BracketOpen"],[11,"T_Percent"],[12,"T_Add"],[13,"T_Sub"],[14,"T_Mul"],[15,"T_Div"],[16,"T_Pow"],[17,"T_Concat"],[18,"T_Eq"],[19,"T_Ne"],[20,"T_Lt"],[21,"T_Le"],[22,"T_Gt"],[23,"T_Ge"],[24,"T_BooleanLiteral"],[25,"T_StringLiteral"],[26,"T_NumberLiteral"],[27,"T_CellRef"],[28,"T_Ident"],[29,"T_Dot"],[30,"T_FAIL"],[31,"NT_AreaReference"],[32,"NT_AreaReferenceTail"],[33,"NT_AreaReferenceTop"],[34,"NT_Arg"],[35,"NT_ArgsList"],[36,"NT_ArgsListTail"],[37,"NT_BangAreaRefOrAreaReferenceTail"],[38,"NT_CellRefOrRange"],[39,"NT_ForceFail"],[40,"NT_Formula"],[41,"NT_FormulaTail"],[42,"NT_FuncIdentDotStar"],[43,"NT_FuncIdentDotStarTail"],[44,"NT_IdentNotBuiltin"],[45,"NT_IdentOrRefPrefixOrColumnRangeOrFunctionCall"],[46,"NT_InfixOp"],[47,"NT_OptionalPct"],[48,"NT_OptionalUnOp"],[49,"NT_ParenTail"],[50,"NT_Range"],[51,"NT_ReferencePrefix"],[52,"NT_ReferencePrefixTail"],[53,"NT_RelOp"],[54,"NT_SpFormula"],[55,"NT_SpacesOpt"],[56,"NT_StringLiteralOrStringPredicate"],[57,"NT_Term"],[58,"NT_TermBase"],[59,"NT_Top"],[60,"NT_UnaryNegTail"]]),SE=[mT([54,18]),aT(54),mT([40,48,55]),aT(6),iT(),mT([41,55,57]),mT([41,55,2,49,54,1]),iT(),mT([49,54,3]),iT(),mT([54,46]),aT(12),aT(13),aT(14),aT(15),aT(16),aT(17),aT(18),aT(19),aT(20),aT(21),aT(22),aT(23),aT(58),aT(24),mT([56,7]),mT([7,25]),mT([7,58,53]),mT([47,26]),mT([38,27]),mT([45,28]),iT(),aT(11),iT(),mT([32,27,4]),mT([2,35,1,42]),mT([37,44,4]),mT([52,5]),mT([9,44,10]),iT(),mT([38,27]),aT(26),mT([33,5]),aT(32),mT([5,44]),iT(),mT([31,51]),mT([32,50]),iT(),mT([33,6]),mT([27,4,27]),iT(),mT([43,29]),mT([42,28]),mT([42,26]),iT(),mT([36,34]),iT(),mT([36,34,3]),aT(54),aT(28),aT(18),aT(19),aT(20),aT(22),aT(21),aT(23),iT(),mT([60,13]),aT(12),iT(),aT(13),aT(30)],yE=new fP(30,1),CE=new fP(35,0),RE=new fP(35,2),bE=(new fP(49,1),new fP(53,1)),NE=new fP(60,0),TE=new Map([[31,1],[32,2],[33,1],[34,1],[35,1],[36,1],[37,1],[38,1],[39,1],[40,1],[41,1],[42,1],[43,1],[44,1],[45,1],[46,1],[47,1],[48,1],[49,1],[50,1],[51,1],[52,1],[53,1],[54,1],[55,1],[56,1],[57,1],[58,1],[59,1],[60,1]]),PE=new eE([[[31,aT(27)],47],[[32,mT([12,12])],48],[[32,mT([24,12])],48],[[32,mT([27,12])],48],[[32,mT([28,12])],48],[[32,mT([26,12])],48],[[32,mT([1,12])],48],[[32,mT([7,12])],48],[[32,mT([6,12])],48],[[32,mT([13,12])],48],[[32,mT([12,3])],48],[[32,mT([24,3])],48],[[32,mT([27,3])],48],[[32,mT([28,3])],48],[[32,mT([26,3])],48],[[32,mT([1,3])],48],[[32,mT([7,3])],48],[[32,mT([6,3])],48],[[32,mT([13,3])],48],[[32,mT([12,17])],48],[[32,mT([24,17])],48],[[32,mT([27,17])],48],[[32,mT([28,17])],48],[[32,mT([26,17])],48],[[32,mT([1,17])],48],[[32,mT([7,17])],48],[[32,mT([6,17])],48],[[32,mT([13,17])],48],[[32,mT([12,15])],48],[[32,mT([24,15])],48],[[32,mT([27,15])],48],[[32,mT([28,15])],48],[[32,mT([26,15])],48],[[32,mT([1,15])],48],[[32,mT([7,15])],48],[[32,mT([6,15])],48],[[32,mT([13,15])],48],[[32,aT(0)],48],[[32,mT([12,18])],48],[[32,mT([24,18])],48],[[32,mT([27,18])],48],[[32,mT([28,18])],48],[[32,mT([26,18])],48],[[32,mT([1,18])],48],[[32,mT([7,18])],48],[[32,mT([6,18])],48],[[32,mT([13,18])],48],[[32,mT([12,23])],48],[[32,mT([24,23])],48],[[32,mT([27,23])],48],[[32,mT([28,23])],48],[[32,mT([26,23])],48],[[32,mT([1,23])],48],[[32,mT([7,23])],48],[[32,mT([6,23])],48],[[32,mT([13,23])],48],[[32,mT([12,22])],48],[[32,mT([24,22])],48],[[32,mT([27,22])],48],[[32,mT([28,22])],48],[[32,mT([26,22])],48],[[32,mT([1,22])],48],[[32,mT([7,22])],48],[[32,mT([6,22])],48],[[32,mT([13,22])],48],[[32,mT([12,21])],48],[[32,mT([24,21])],48],[[32,mT([27,21])],48],[[32,mT([28,21])],48],[[32,mT([26,21])],48],[[32,mT([1,21])],48],[[32,mT([7,21])],48],[[32,mT([6,21])],48],[[32,mT([13,21])],48],[[32,mT([12,20])],48],[[32,mT([24,20])],48],[[32,mT([27,20])],48],[[32,mT([28,20])],48],[[32,mT([26,20])],48],[[32,mT([1,20])],48],[[32,mT([7,20])],48],[[32,mT([6,20])],48],[[32,mT([13,20])],48],[[32,mT([12,14])],48],[[32,mT([24,14])],48],[[32,mT([27,14])],48],[[32,mT([28,14])],48],[[32,mT([26,14])],48],[[32,mT([1,14])],48],[[32,mT([7,14])],48],[[32,mT([6,14])],48],[[32,mT([13,14])],48],[[32,mT([12,19])],48],[[32,mT([24,19])],48],[[32,mT([27,19])],48],[[32,mT([28,19])],48],[[32,mT([26,19])],48],[[32,mT([1,19])],48],[[32,mT([7,19])],48],[[32,mT([6,19])],48],[[32,mT([13,19])],48],[[32,mT([12,2])],48],[[32,mT([3,2])],48],[[32,mT([17,2])],48],[[32,mT([15,2])],48],[[32,mT([0,2])],48],[[32,mT([18,2])],48],[[32,mT([23,2])],48],[[32,mT([22,2])],48],[[32,mT([21,2])],48],[[32,mT([20,2])],48],[[32,mT([14,2])],48],[[32,mT([19,2])],48],[[32,mT([2,2])],48],[[32,mT([16,2])],48],[[32,mT([7,2])],48],[[32,mT([6,2])],48],[[32,mT([13,2])],48],[[32,mT([12,16])],48],[[32,mT([24,16])],48],[[32,mT([27,16])],48],[[32,mT([28,16])],48],[[32,mT([26,16])],48],[[32,mT([1,16])],48],[[32,mT([7,16])],48],[[32,mT([6,16])],48],[[32,mT([13,16])],48],[[32,mT([12,7])],48],[[32,mT([3,7])],48],[[32,mT([17,7])],48],[[32,mT([15,7])],48],[[32,mT([0,7])],48],[[32,mT([18,7])],48],[[32,mT([23,7])],48],[[32,mT([22,7])],48],[[32,mT([21,7])],48],[[32,mT([20,7])],48],[[32,mT([14,7])],48],[[32,mT([19,7])],48],[[32,mT([2,7])],48],[[32,mT([16,7])],48],[[32,mT([7,7])],48],[[32,mT([6,7])],48],[[32,mT([13,7])],48],[[32,mT([12,6])],48],[[32,mT([3,6])],48],[[32,mT([17,6])],48],[[32,mT([15,6])],48],[[32,mT([0,6])],48],[[32,mT([18,6])],48],[[32,mT([23,6])],48],[[32,mT([22,6])],48],[[32,mT([21,6])],48],[[32,mT([20,6])],48],[[32,mT([14,6])],48],[[32,mT([19,6])],48],[[32,mT([2,6])],48],[[32,mT([16,6])],48],[[32,mT([13,6])],48],[[32,mT([12,13])],48],[[32,mT([24,13])],48],[[32,mT([27,13])],48],[[32,mT([28,13])],48],[[32,mT([26,13])],48],[[32,mT([1,13])],48],[[32,mT([7,13])],48],[[32,mT([6,13])],48],[[32,mT([13,13])],48],[[32,mT([27,6])],49],[[32,mT([28,6])],49],[[33,aT(27)],46],[[33,aT(28)],46],[[34,aT(12)],59],[[34,aT(24)],59],[[34,aT(27)],59],[[34,aT(28)],59],[[34,aT(26)],59],[[34,aT(1)],59],[[34,aT(7)],59],[[34,aT(6)],59],[[34,aT(13)],59],[[35,aT(2)],55],[[35,aT(12)],56],[[35,aT(24)],56],[[35,aT(27)],56],[[35,aT(28)],56],[[35,aT(26)],56],[[35,aT(1)],56],[[35,aT(7)],56],[[35,aT(6)],56],[[35,aT(13)],56],[[36,aT(2)],57],[[36,aT(3)],58],[[37,aT(5)],42],[[37,aT(12)],43],[[37,aT(3)],43],[[37,aT(17)],43],[[37,aT(15)],43],[[37,aT(0)],43],[[37,aT(18)],43],[[37,aT(23)],43],[[37,aT(22)],43],[[37,aT(21)],43],[[37,aT(20)],43],[[37,aT(14)],43],[[37,aT(19)],43],[[37,aT(2)],43],[[37,aT(16)],43],[[37,aT(7)],43],[[37,aT(6)],43],[[37,aT(13)],43],[[38,aT(12)],33],[[38,aT(3)],33],[[38,aT(17)],33],[[38,aT(15)],33],[[38,aT(0)],33],[[38,aT(18)],33],[[38,aT(23)],33],[[38,aT(22)],33],[[38,aT(21)],33],[[38,aT(20)],33],[[38,aT(14)],33],[[38,aT(19)],33],[[38,aT(2)],33],[[38,aT(16)],33],[[38,aT(7)],33],[[38,aT(6)],33],[[38,aT(13)],33],[[38,aT(4)],34],[[39,aT(30)],72],[[40,aT(24)],5],[[40,aT(27)],5],[[40,aT(28)],5],[[40,aT(26)],5],[[40,aT(7)],5],[[40,aT(1)],6],[[41,aT(3)],9],[[41,aT(0)],9],[[41,aT(2)],9],[[41,aT(12)],10],[[41,aT(17)],10],[[41,aT(15)],10],[[41,aT(18)],10],[[41,aT(23)],10],[[41,aT(22)],10],[[41,aT(21)],10],[[41,aT(20)],10],[[41,aT(14)],10],[[41,aT(19)],10],[[41,aT(16)],10],[[41,aT(13)],10],[[42,aT(1)],51],[[42,aT(29)],52],[[43,aT(28)],53],[[43,aT(26)],54],[[44,aT(28)],60],[[45,aT(29)],35],[[45,aT(1)],35],[[45,aT(4)],36],[[45,aT(5)],37],[[45,aT(10)],38],[[45,aT(12)],39],[[45,aT(3)],39],[[45,aT(17)],39],[[45,aT(15)],39],[[45,aT(0)],39],[[45,aT(18)],39],[[45,aT(23)],39],[[45,aT(22)],39],[[45,aT(21)],39],[[45,aT(20)],39],[[45,aT(14)],39],[[45,aT(19)],39],[[45,aT(2)],39],[[45,aT(16)],39],[[45,aT(7)],39],[[45,aT(6)],39],[[45,aT(13)],39],[[46,aT(12)],11],[[46,aT(13)],12],[[46,aT(14)],13],[[46,aT(15)],14],[[46,aT(16)],15],[[46,aT(17)],16],[[46,aT(18)],17],[[46,aT(19)],18],[[46,aT(20)],19],[[46,aT(21)],20],[[46,aT(22)],21],[[46,aT(23)],22],[[47,aT(12)],31],[[47,aT(3)],31],[[47,aT(17)],31],[[47,aT(15)],31],[[47,aT(0)],31],[[47,aT(18)],31],[[47,aT(23)],31],[[47,aT(22)],31],[[47,aT(21)],31],[[47,aT(20)],31],[[47,aT(14)],31],[[47,aT(19)],31],[[47,aT(2)],31],[[47,aT(16)],31],[[47,aT(7)],31],[[47,aT(6)],31],[[47,aT(13)],31],[[47,aT(11)],32],[[48,aT(24)],67],[[48,aT(27)],67],[[48,aT(28)],67],[[48,aT(26)],67],[[48,aT(1)],67],[[48,aT(7)],67],[[48,aT(13)],68],[[48,aT(12)],69],[[49,aT(2)],7],[[49,aT(3)],8],[[50,aT(27)],50],[[51,aT(28)],44],[[51,aT(27)],45],[[52,aT(27)],40],[[52,aT(26)],41],[[53,aT(18)],61],[[53,aT(19)],62],[[53,aT(20)],63],[[53,aT(22)],64],[[53,aT(21)],65],[[53,aT(23)],66],[[54,aT(12)],2],[[54,aT(24)],2],[[54,aT(27)],2],[[54,aT(28)],2],[[54,aT(26)],2],[[54,aT(1)],2],[[54,aT(7)],2],[[54,aT(6)],2],[[54,aT(13)],2],[[55,aT(6)],3],[[55,aT(12)],4],[[55,aT(24)],4],[[55,aT(27)],4],[[55,aT(3)],4],[[55,aT(17)],4],[[55,aT(15)],4],[[55,aT(0)],4],[[55,aT(18)],4],[[55,aT(23)],4],[[55,aT(22)],4],[[55,aT(28)],4],[[55,aT(21)],4],[[55,aT(20)],4],[[55,aT(14)],4],[[55,aT(19)],4],[[55,aT(26)],4],[[55,aT(2)],4],[[55,aT(1)],4],[[55,aT(16)],4],[[55,aT(7)],4],[[55,aT(13)],4],[[56,aT(25)],26],[[56,aT(18)],27],[[56,aT(23)],27],[[56,aT(22)],27],[[56,aT(21)],27],[[56,aT(20)],27],[[56,aT(19)],27],[[57,aT(24)],23],[[57,aT(27)],23],[[57,aT(28)],23],[[57,aT(26)],23],[[57,aT(7)],23],[[58,aT(24)],24],[[58,aT(7)],25],[[58,aT(26)],28],[[58,aT(27)],29],[[58,aT(28)],30],[[59,aT(18)],0],[[59,aT(12)],1],[[59,aT(24)],1],[[59,aT(27)],1],[[59,aT(28)],1],[[59,aT(26)],1],[[59,aT(1)],1],[[59,aT(7)],1],[[59,aT(6)],1],[[59,aT(13)],1],[[60,aT(24)],70],[[60,aT(27)],70],[[60,aT(28)],70],[[60,aT(26)],70],[[60,aT(1)],70],[[60,aT(7)],70],[[60,aT(13)],71]],{Equals:MR,GetHashCode:AR}),EE=new eE([[[31,27],aT(47)],[[32,12],aT(48)],[[32,24],aT(48)],[[32,27],mT([48,49])],[[32,17],aT(48)],[[32,15],aT(48)],[[32,0],aT(48)],[[32,18],aT(48)],[[32,23],aT(48)],[[32,22],aT(48)],[[32,28],mT([48,49])],[[32,21],aT(48)],[[32,20],aT(48)],[[32,14],aT(48)],[[32,19],aT(48)],[[32,26],aT(48)],[[32,16],aT(48)],[[32,25],aT(48)],[[32,13],aT(48)],[[33,27],aT(46)],[[33,28],aT(46)],[[34,12],aT(59)],[[34,24],aT(59)],[[34,27],aT(59)],[[34,18],aT(59)],[[34,23],aT(59)],[[34,22],aT(59)],[[34,28],aT(59)],[[34,21],aT(59)],[[34,20],aT(59)],[[34,19],aT(59)],[[34,26],aT(59)],[[34,25],aT(59)],[[34,13],aT(59)],[[35,12],mT([55,56])],[[35,24],mT([55,56])],[[35,27],mT([55,56])],[[35,17],aT(55)],[[35,15],aT(55)],[[35,0],aT(55)],[[35,18],mT([55,56])],[[35,23],mT([55,56])],[[35,22],mT([55,56])],[[35,28],mT([55,56])],[[35,21],mT([55,56])],[[35,20],mT([55,56])],[[35,14],aT(55)],[[35,19],mT([55,56])],[[35,26],mT([55,56])],[[35,16],aT(55)],[[35,25],mT([55,56])],[[35,13],mT([55,56])],[[36,12],mT([57,58])],[[36,24],mT([57,58])],[[36,27],mT([57,58])],[[36,17],aT(57)],[[36,15],aT(57)],[[36,0],aT(57)],[[36,18],mT([57,58])],[[36,23],mT([57,58])],[[36,22],mT([57,58])],[[36,28],mT([57,58])],[[36,21],mT([57,58])],[[36,20],mT([57,58])],[[36,14],aT(57)],[[36,19],mT([57,58])],[[36,26],mT([57,58])],[[36,16],aT(57)],[[36,25],mT([57,58])],[[36,13],mT([57,58])],[[37,27],mT([42,43])],[[37,28],mT([42,43])],[[37,12],aT(43)],[[37,24],aT(43)],[[37,17],aT(43)],[[37,15],aT(43)],[[37,0],aT(43)],[[37,18],aT(43)],[[37,23],aT(43)],[[37,22],aT(43)],[[37,21],aT(43)],[[37,20],aT(43)],[[37,14],aT(43)],[[37,19],aT(43)],[[37,26],aT(43)],[[37,16],aT(43)],[[37,25],aT(43)],[[37,13],aT(43)],[[38,12],aT(33)],[[38,24],aT(33)],[[38,27],mT([33,34])],[[38,17],aT(33)],[[38,15],aT(33)],[[38,0],aT(33)],[[38,18],aT(33)],[[38,23],aT(33)],[[38,22],aT(33)],[[38,28],aT(33)],[[38,21],aT(33)],[[38,20],aT(33)],[[38,14],aT(33)],[[38,19],aT(33)],[[38,26],aT(33)],[[38,16],aT(33)],[[38,25],aT(33)],[[38,13],aT(33)],[[39,30],aT(72)],[[40,24],mT([5,6])],[[40,27],mT([5,6])],[[40,18],mT([5,6])],[[40,23],mT([5,6])],[[40,22],mT([5,6])],[[40,28],mT([5,6])],[[40,21],mT([5,6])],[[40,20],mT([5,6])],[[40,19],mT([5,6])],[[40,26],mT([5,6])],[[40,25],mT([5,6])],[[40,12],aT(6)],[[40,13],aT(6)],[[41,12],mT([9,10])],[[41,24],aT(9)],[[41,27],aT(9)],[[41,17],mT([9,10])],[[41,15],mT([9,10])],[[41,0],aT(9)],[[41,18],mT([9,10])],[[41,23],mT([9,10])],[[41,22],mT([9,10])],[[41,28],aT(9)],[[41,21],mT([9,10])],[[41,20],mT([9,10])],[[41,14],mT([9,10])],[[41,19],mT([9,10])],[[41,26],aT(9)],[[41,16],mT([9,10])],[[41,25],aT(9)],[[41,13],mT([9,10])],[[42,12],aT(51)],[[42,24],aT(51)],[[42,27],aT(51)],[[42,17],aT(51)],[[42,15],aT(51)],[[42,0],aT(51)],[[42,18],aT(51)],[[42,23],aT(51)],[[42,22],aT(51)],[[42,28],aT(51)],[[42,21],aT(51)],[[42,20],aT(51)],[[42,14],aT(51)],[[42,19],aT(51)],[[42,26],aT(51)],[[42,16],aT(51)],[[42,25],aT(51)],[[42,13],aT(51)],[[42,29],aT(52)],[[43,28],aT(53)],[[43,26],aT(54)],[[44,28],aT(60)],[[45,12],mT([35,39])],[[45,24],mT([35,39])],[[45,27],mT([35,37,39])],[[45,17],mT([35,39])],[[45,15],mT([35,39])],[[45,29],aT(35)],[[45,0],mT([35,39])],[[45,18],mT([35,39])],[[45,23],mT([35,39])],[[45,22],mT([35,39])],[[45,28],mT([35,36,38,39])],[[45,21],mT([35,39])],[[45,20],mT([35,39])],[[45,14],mT([35,39])],[[45,19],mT([35,39])],[[45,26],mT([35,37,39])],[[45,16],mT([35,39])],[[45,25],mT([35,39])],[[45,13],mT([35,39])],[[46,12],aT(11)],[[46,13],aT(12)],[[46,14],aT(13)],[[46,15],aT(14)],[[46,16],aT(15)],[[46,17],aT(16)],[[46,18],aT(17)],[[46,19],aT(18)],[[46,20],aT(19)],[[46,21],aT(20)],[[46,22],aT(21)],[[46,23],aT(22)],[[47,12],aT(31)],[[47,24],aT(31)],[[47,27],aT(31)],[[47,17],aT(31)],[[47,15],aT(31)],[[47,0],aT(31)],[[47,18],aT(31)],[[47,23],aT(31)],[[47,22],aT(31)],[[47,28],aT(31)],[[47,21],aT(31)],[[47,20],aT(31)],[[47,14],aT(31)],[[47,19],aT(31)],[[47,26],aT(31)],[[47,16],aT(31)],[[47,25],aT(31)],[[47,13],aT(31)],[[47,11],aT(32)],[[48,12],mT([67,69])],[[48,24],aT(67)],[[48,27],aT(67)],[[48,18],aT(67)],[[48,23],aT(67)],[[48,22],aT(67)],[[48,28],aT(67)],[[48,21],aT(67)],[[48,20],aT(67)],[[48,19],aT(67)],[[48,26],aT(67)],[[48,25],aT(67)],[[48,13],mT([67,68])],[[49,12],mT([7,8])],[[49,24],mT([7,8])],[[49,27],mT([7,8])],[[49,17],aT(7)],[[49,15],aT(7)],[[49,0],aT(7)],[[49,18],mT([7,8])],[[49,23],mT([7,8])],[[49,22],mT([7,8])],[[49,28],mT([7,8])],[[49,21],mT([7,8])],[[49,20],mT([7,8])],[[49,14],aT(7)],[[49,19],mT([7,8])],[[49,26],mT([7,8])],[[49,16],aT(7)],[[49,25],mT([7,8])],[[49,13],mT([7,8])],[[50,27],aT(50)],[[51,28],aT(44)],[[51,27],aT(45)],[[52,27],aT(40)],[[52,26],aT(41)],[[53,18],aT(61)],[[53,19],aT(62)],[[53,20],aT(63)],[[53,22],aT(64)],[[53,21],aT(65)],[[53,23],aT(66)],[[54,12],aT(2)],[[54,24],aT(2)],[[54,27],aT(2)],[[54,18],aT(2)],[[54,23],aT(2)],[[54,22],aT(2)],[[54,28],aT(2)],[[54,21],aT(2)],[[54,20],aT(2)],[[54,19],aT(2)],[[54,26],aT(2)],[[54,25],aT(2)],[[54,13],aT(2)],[[55,12],mT([3,4])],[[55,24],mT([3,4])],[[55,27],mT([3,4])],[[55,17],mT([3,4])],[[55,15],mT([3,4])],[[55,0],mT([3,4])],[[55,18],mT([3,4])],[[55,23],mT([3,4])],[[55,22],mT([3,4])],[[55,28],mT([3,4])],[[55,21],mT([3,4])],[[55,20],mT([3,4])],[[55,14],mT([3,4])],[[55,19],mT([3,4])],[[55,26],mT([3,4])],[[55,16],mT([3,4])],[[55,25],mT([3,4])],[[55,13],mT([3,4])],[[56,25],aT(26)],[[56,18],aT(27)],[[56,23],aT(27)],[[56,22],aT(27)],[[56,21],aT(27)],[[56,20],aT(27)],[[56,19],aT(27)],[[57,24],aT(23)],[[57,27],aT(23)],[[57,18],aT(23)],[[57,23],aT(23)],[[57,22],aT(23)],[[57,28],aT(23)],[[57,21],aT(23)],[[57,20],aT(23)],[[57,19],aT(23)],[[57,26],aT(23)],[[57,25],aT(23)],[[58,24],aT(24)],[[58,18],aT(25)],[[58,23],aT(25)],[[58,22],aT(25)],[[58,21],aT(25)],[[58,20],aT(25)],[[58,19],aT(25)],[[58,25],aT(25)],[[58,26],aT(28)],[[58,27],aT(29)],[[58,28],aT(30)],[[59,18],mT([0,1])],[[59,12],aT(1)],[[59,24],aT(1)],[[59,27],aT(1)],[[59,23],aT(1)],[[59,22],aT(1)],[[59,28],aT(1)],[[59,21],aT(1)],[[59,20],aT(1)],[[59,19],aT(1)],[[59,26],aT(1)],[[59,25],aT(1)],[[59,13],aT(1)],[[60,12],aT(70)],[[60,24],aT(70)],[[60,27],aT(70)],[[60,18],aT(70)],[[60,23],aT(70)],[[60,22],aT(70)],[[60,28],aT(70)],[[60,21],aT(70)],[[60,20],aT(70)],[[60,19],aT(70)],[[60,26],aT(70)],[[60,25],aT(70)],[[60,13],mT([70,71])]],{Equals:MR,GetHashCode:AR}),kE=new cE(SE,dE,fE,pE,mE,hE,gE,59,0,TE,PE,EE,vE,["Top -> Eq SpFormula","Top -> SpFormula","SpFormula -> SpacesOpt OptionalUnOp Formula","SpacesOpt -> Spaces","SpacesOpt -> ","Formula -> Term SpacesOpt FormulaTail","Formula -> ParenOpen SpFormula ParenTail ParenClose SpacesOpt FormulaTail","ParenTail -> ","ParenTail -> Comma SpFormula ParenTail","FormulaTail -> ","FormulaTail -> InfixOp SpFormula","InfixOp -> Add","InfixOp -> Sub","InfixOp -> Mul","InfixOp -> Div","InfixOp -> Pow","InfixOp -> Concat","InfixOp -> Eq","InfixOp -> Ne","InfixOp -> Lt","InfixOp -> Le","InfixOp -> Gt","InfixOp -> Ge","Term -> TermBase","TermBase -> BooleanLiteral","TermBase -> Quote StringLiteralOrStringPredicate","StringLiteralOrStringPredicate -> StringLiteral Quote","StringLiteralOrStringPredicate -> RelOp TermBase Quote","TermBase -> NumberLiteral OptionalPct","TermBase -> CellRef CellRefOrRange","TermBase -> Ident IdentOrRefPrefixOrColumnRangeOrFunctionCall","OptionalPct -> ","OptionalPct -> Percent","CellRefOrRange -> ","CellRefOrRange -> RangeOp CellRef AreaReferenceTail","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> FuncIdentDotStar ParenOpen ArgsList ParenClose","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> RangeOp IdentNotBuiltin BangAreaRefOrAreaReferenceTail","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> Bang ReferencePrefixTail","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> BracketOpen IdentNotBuiltin BracketClose","IdentOrRefPrefixOrColumnRangeOrFunctionCall -> ","ReferencePrefixTail -> CellRef CellRefOrRange","ReferencePrefixTail -> NumberLiteral","BangAreaRefOrAreaReferenceTail -> Bang AreaReferenceTop","BangAreaRefOrAreaReferenceTail -> AreaReferenceTail","ReferencePrefix -> IdentNotBuiltin Bang","ReferencePrefix -> ","AreaReferenceTop -> ReferencePrefix AreaReference","AreaReference -> Range AreaReferenceTail","AreaReferenceTail -> ","AreaReferenceTail -> Spaces AreaReferenceTop","Range -> CellRef RangeOp CellRef","FuncIdentDotStar -> ","FuncIdentDotStar -> Dot FuncIdentDotStarTail","FuncIdentDotStarTail -> Ident FuncIdentDotStar","FuncIdentDotStarTail -> NumberLiteral FuncIdentDotStar","ArgsList -> ","ArgsList -> Arg ArgsListTail","ArgsListTail -> ","ArgsListTail -> Comma Arg ArgsListTail","Arg -> SpFormula","IdentNotBuiltin -> Ident","RelOp -> Eq","RelOp -> Ne","RelOp -> Lt","RelOp -> Gt","RelOp -> Le","RelOp -> Ge","OptionalUnOp -> ","OptionalUnOp -> Sub UnaryNegTail","OptionalUnOp -> Add","UnaryNegTail -> ","UnaryNegTail -> Sub","ForceFail -> FAIL"]);class OE extends XR{constructor(e,t){super(),this.Value=e,this.Next=t}}class AE{constructor(){this.elts=new $R(void 0)}}function IE(){return new AE}function _E(e,t,r){!function(e,t,r,n){e:for(;;){const i=e,o=t,a=r,s=n,l=s.contents;if(null!=l){const u=l;if(!(BR(a,u.Value[1])<=0)){e=i,t=o,r=a,n=u.Next;continue e}{const e=new OE([o,a],new $R(s.contents));s.contents=e}}else s.contents=new OE([o,a],new $R(void 0));break}}(e,t,r,e.elts)}function FE(e){const t=e.elts.contents;if(null!=t){const r=t;return e.elts.contents=r.Next.contents,r.Value}throw new Error("Dequeue on empty priority queue")}function ME(e){return null!=e.elts.contents}function DE(e){e.elts=new $R(void 0)}function wE(e){let t=void 0;const r=RR(e);try{for(;r["System.Collections.IEnumerator.MoveNext"]();){const e=r["System.Collections.Generic.IEnumerator`1.get_Current"]();null!=t?BR(e,WN(t))<0&&(t=jN(e)):t=jN(e)}}finally{SR(r)}if(null==t)throw new Error("Expected non-empty sequence\\nParameter name: s");return WN(t)}class LE{constructor(){this.map=new eE([],{Equals:DR,GetHashCode:IR})}}function xE(){return new LE}function BE(e,t,r){e.map.has(t)||e.map.set(t,[]),rb(e.map,t).push(r)}function UE(e,t){let r,n=null;return r=[tb(e.map,t,new $R(()=>n,e=>{n=e})),n],r[0]?r[1]:IT()}function GE(e,t){if(null==e)return jN(t);WN(e);return e}class KE extends XR{constructor(e,t){super(),this.EditDistance=e,this.Output=t}}class VE extends XR{constructor(e,t,r,n,i,o,a){super(),this.Stack=e,this.Output=t,this.Observed=r,this.EditDistances=n,this.EditOriginalTokens=i,this.TieBreaker=0|o,this.CurrentEditDistance=a}toString(){const e=cP(" ",this.Stack),t=cP(" ",KT(this.Output)),r=cP(" ",this.Observed);return yN(vN("{Stack = %s, Observed = %s, Output = %s, Cost= %f}"))(e)(r)(t)(this.CurrentEditDistance)}}class jE{constructor(e){this.conf=e,this.queue=IE(),this.tieBreaker=0}}function WE(e,t,r,n,i){return kT(()=>wT(ME(e.queue)?((()=>{throw new Error("State queue should be empty")})(),IT()):IT(),kT(()=>{const o=QE(e,sT(r)?(()=>{throw new Error("expected non-empty observed")})():lT(r).Unreliable);return HE(e,new VE(function(e,t){return((e,t)=>{for(;;){const r=e,n=t;if(sT(n))return fT(r);e=oT(lT(n).Symbol,r),t=uT(n)}})(iT(),t)}(0,t),iT(),r,o[0],o[1],0,0),0),LT(()=>ME(e.queue)&&!i["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"](),kT(()=>{let t,r,i,o;const a=FE(e.queue),s=a[0],l=a[1][0],u=s.Observed;if(sT(u))throw new Error("unexpected empty observed segments");{const a=lT(u).Unreliable,c=lT(u).Reliable,d=uT(u),f=s.Stack;if(sT(f))throw new Error("search: empty stack");{const p=uT(f),m=0|lT(f);if(XP(e.conf.Terminals,m)){if(m===aP(c)){const r=function(e,t){const r=(e,t)=>{let n,i;const o=[t,e];if(sT(o[0]))return e;if(sT(o[1]))throw new Error("More edit tokens than output");{DR(lP(lT(o[1])).ModifyStatus,new JT(2));const e=r(uT(o[1]),uT(o[0]));return oT(null!=lT(o[0])?(n=lT(o[0]),aP(lT(o[1]))!==aP(n)||(sP(lT(o[1])),sP(n)),i=new XT(lP(n).FromInput,new JT(2)),nP(aP(n),sP(n),i,uP(n))):lT(o[1]),e)}},n=r(t.Output,t.EditOriginalTokens[t.EditOriginalTokens.length-1]),i=new $R(t),o=[iT()];return new VE(i.contents.Stack,n,i.contents.Observed,i.contents.EditDistances,o,i.contents.TieBreaker,i.contents.CurrentEditDistance)}(0,s),i=r.EditDistances[r.EditDistances.length-1],o=i+r.CurrentEditDistance;if(qE(e,o,n)&&function(e,t,r,n){return!(t>=1/0||!function(e,t,r){return null==r||t>=r}(0,t,r))&&qE(e,t,n)}(e,i,lT(u).MinEditDist,n)){if(o<l)throw new Error("real distance should not end up lower than estimated");if(o>l)return HE(e,r,o),IT();{const n=oT(c,r.Output);if(sT(d))return _T(new KE(o,fT(n)));{const i=QE(e,lT(d).Unreliable);return HE(e,(t=new $R(r),new VE(p,n,d,i[0],i[1],t.contents.TieBreaker,o)),o),IT()}}}return IT()}if(XP(e.conf.ReliableTerminals,m))return IT();{const t=function(e,t,r,n){return((e,t,r)=>{for(;;){const n=e,i=t,o=r;if(sT(o))return[cT(fT(n)),cT(fT(i))];e=oT(0,n),t=oT(iT(),i),r=uT(o)}})(aT(t),aT(r),n)}(0,XP(e.conf.InsertableTerminals,m)?s.EditDistances[0]+rb(e.conf.TerminalWeights,m):1/0,oT(void 0,s.EditOriginalTokens[0]),a),l=t[1],u=t[0];!function(e,t,r,n,i,o,a){((r,s)=>{let l;for(;;){const u=r,c=s;if(sT(c))break;{const d=lT(c),f=(l=lP(d),$T(l)&&XP(e.conf.DeletableTerminals,aP(d))),p=f?o[u-1]+rb(e.conf.TerminalWeights,aP(d)):1/0,m=a[u-1],h=XP(e.conf.InsertableTerminals,t),g=h?n[u]+rb(e.conf.TerminalWeights,t):1/0,v=oT(void 0,i[u]),S=h&&f?n[u-1]+GR(LR,rb(e.conf.TerminalWeights,aP(d)),rb(e.conf.TerminalWeights,t)):1/0,y=oT(void 0,i[u-1]),C=oT(d,i[u-1]),R=p<g?[p,m]:[g,v],b=R[1],N=R[0],T=t===aP(d)?n[u-1]<=N?[n[u-1],C]:[N,b]:S<N?[S,y]:[N,b];o[u]=T[0],a[u]=T[1],r=u+1,s=uT(c)}}})(1,r)}(e,m,a,s.EditDistances,s.EditOriginalTokens,u,l);const c=s.CurrentEditDistance+wE(u);if(qE(e,c,n)){const t=new XT(!1,new JT(2)),n=oP(m,(i=null,r=[tb(e.conf.TerminalDefaultValues,m,new $R(()=>i,e=>{i=e})),i],r[0]?r[1]:null),t);return HE(e,(o=new $R(s),new VE(p,oT(n,s.Output),o.contents.Observed,u,l,o.contents.TieBreaker,o.contents.CurrentEditDistance)),c),IT()}return IT()}}{let t,r=null;return t=[tb(e.conf.LLRepairTable,[m,aP(c)],new $R(()=>r,e=>{r=e})),r],t[0]?VT(t=>{let r;const n=function(e,t,r){for(;;){const n=e,i=t,o=r;if(sT(o))return i;e=n,t=oT(lT(o),i),r=uT(o)}}(e,p,e.conf.Rules[t]);return HE(e,(r=new $R(s),new VE(n,r.contents.Output,r.contents.Observed,r.contents.EditDistances,r.contents.EditOriginalTokens,r.contents.TieBreaker,r.contents.CurrentEditDistance)),l),IT()},t[1]):IT()}}}}))})))}function HE(e,t,r){_E(e.queue,t,[r,e.tieBreaker]),e.tieBreaker=e.tieBreaker-1|0}function QE(e,t){return((t,r,n,i,o)=>{let a;e:for(;;){const s=t,l=r,u=n,c=i,d=o;if(sT(d))return[cT(fT(u)),cT(c)];{const f=lT(d),p=!!s||(a=lP(f),!$T(a)),m=l+rb(e.conf.TerminalWeights,aP(f));t=p,r=m,n=oT(p?1/0:m,u),i=oT(iT(),c),o=uT(d);continue e}}})(!1,0,aT(0),aT(iT()),t)}function qE(e,t,r){return null==r||t<=r}class zE extends HR{constructor(e,...t){super(),this.tag=0|e,this.fields=t}cases(){return["Terminal","TaggedTerminal"]}}class YE{constructor(e,t,r,n){this.this=new $R(null);this.this;var i;this.config=e,this.maxLocalEditDist=t,this.maxGlobalEditDist=r,this.maxBacktrack=0|n,this.this.contents=this,this.tieBreaker=0,this.inSearch=!1,this.queue=IE(),this.searcher=(i=this.config,new jE(i)),this.initCallbacks=[],this.terminalMatchCallbacks=xE(),this.ruleCallbacks=xE(),this.stateTransformers=xE(),this.errorStateTransformer=[],this["init@28"]=1}}function JE(e,t,r,n,i){let o;const a=function(e,t,r){return kT(()=>wT(e.inSearch?((()=>{throw new Error("Parse called second time, without first call done")})(),IT()):IT(),kT(()=>{e.inSearch=!0,function(e){DE(e.queue),function(e){DE(e.queue)}(e.searcher)}(e);const n=new gP(t,mT([ik(e,e.config.Start,pP),ik(e,e.config.End,pP)]),iT(),0,0,void 0,void 0,void 0);return function(e,t){let r=RR(e.initCallbacks);try{for(;r["System.Collections.IEnumerator.MoveNext"]();)r["System.Collections.Generic.IEnumerator`1.get_Current"]()(t)}finally{SR(r)}}(e,n),tk(e,n),wT(LT(()=>ME(e.queue)&&!r["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"](),kT(()=>{const t=FE(e.queue)[0];return function(e){return!!DR(e.Input,iT())&&DR(e.Stack,iT())}(t)?_T(new vP(FT(GT(e=>e.Token,fT(t.MatchedTokens))),t.EditDistance,t.Cost)):(function(e,t,r){let n,i,o,a,s;if(n=t.Stack,sT(n)||(i=lT(n),o=t.Input,sT(o)||(a=lT(o),i.Symbol===aP(a)?(function(e,t,r,n,i,o){const a=new gP(n,o,oT(new hP(r,i.Source),t.MatchedTokens),t.Cost,t.EditDistance,XP(e.config.ReliableTerminals,aP(r))?void 0:GE(t.Backtrack,t),t,t.Context);(function(e,t,r,n,i){const o=RR([new zE(0,t.Symbol),new zE(1,t.Source)]);try{for(;o["System.Collections.IEnumerator.MoveNext"]();){const t=RR(UE(e.terminalMatchCallbacks,o["System.Collections.Generic.IEnumerator`1.get_Current"]()));try{for(;t["System.Collections.IEnumerator.MoveNext"]();)t["System.Collections.Generic.IEnumerator`1.get_Current"]()(r)(n)(i)}finally{SR(t)}}}finally{SR(o)}})(e,i,t,a,r),ak(e,a)}(e,t,a,uT(o),i,uT(n)),0):(s=function(e,t,r){let n,i=0;if(n=[tb(e.config.NumLaTable,t.Symbol,new $R(()=>i,e=>{i=0|e})),i],n[0]){let i,o=0;return i=[tb(e.config.LLTable,[t.Symbol,rk(e,r,n[1])],new $R(()=>o,e=>{o=0|e})),o],i[0]?i[1]:void 0}return}(e,i,t.Input),null==s||(function(e,t,r,n){const i=nk(e,t,r);(function(e,t,r,n,i){const o=RR([new zE(0,t.Symbol),new zE(1,t.Source)]);try{for(;o["System.Collections.IEnumerator.MoveNext"]();){const t=RR(UE(e.ruleCallbacks,o["System.Collections.Generic.IEnumerator`1.get_Current"]()));try{for(;t["System.Collections.IEnumerator.MoveNext"]();)t["System.Collections.Generic.IEnumerator`1.get_Current"]()(r)(n)(i)}finally{SR(t)}}}finally{SR(o)}})(e,n,t,i,r),ak(e,i)}(e,t,s,i),0))))){const n=[];let i=RR(e.errorStateTransformer);try{for(;i["System.Collections.IEnumerator.MoveNext"]();){const r=RR(i["System.Collections.Generic.IEnumerator`1.get_Current"]()(t)(e.this.contents));try{for(;r["System.Collections.IEnumerator.MoveNext"]();){const i=r["System.Collections.Generic.IEnumerator`1.get_Current"](),o=i[0];if(i[1])YN(o,n,{Equals:DR,GetHashCode:_R})||n.push(o);else{if(DR(o,t))throw new Error("transformed State is same as error state");tk(e,o)}}}finally{SR(r)}}}finally{SR(i)}0===e.errorStateTransformer.length&&n.push(t);let o=RR(n);try{for(;o["System.Collections.IEnumerator.MoveNext"]();){const t=RR(ok(e,o["System.Collections.Generic.IEnumerator`1.get_Current"](),r));try{for(;t["System.Collections.IEnumerator.MoveNext"]();)tk(e,t["System.Collections.Generic.IEnumerator`1.get_Current"]())}finally{SR(t)}}}finally{SR(o)}}}(e,t,r),IT())})),kT(()=>(e.inSearch=!1,IT())))})))}(e,hR(s=t)?mT(s):s instanceof JN?s:hT(s),i);var s;if(o=null==r?a:function(e,t){return DT(()=>ET(t),(t,r)=>t<e&&r["System.Collections.IEnumerator.MoveNext"]()?jN(r["System.Collections.Generic.IEnumerator`1.get_Current"]()):void 0,e=>{SR(e)})}(r,a),DR(n,new RP(0))){const e=FT(o);return i["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"]()?[]:e}return kT(()=>wT(GT(e=>e,o),kT(()=>{if(DR(n,new RP(2))&&i["Microsoft.ProgramSynthesis.Repair.Framework.ParseState.FrameworkCancellationToken.get_IsCancellationRequested"]())throw new Error;return IT()})))}function XE(e,t,r){return nk(e,t,r)}function $E(e,t,r){BE(e.terminalMatchCallbacks,t,jR(3,r))}function ZE(e,t,r){BE(e.stateTransformers,t,jR(2,r))}function ek(e,t){e.errorStateTransformer.push(jR(2,t))}function tk(e,t){let r;r=e.maxGlobalEditDist,(null==r||t.EditDistance<=r)&&(_E(e.queue,t,[t.Cost,e.tieBreaker]),e.tieBreaker=e.tieBreaker-1|0)}function rk(e,t,r){return((e,t,r)=>{for(;;){const n=e,i=t,o=r;if(sT(i))return n;if(o<=0)return n;if(sT(i))throw new Error("Match failure");e=oT(aP(lT(i)),n),t=uT(i),r=o-1}})(iT(),t,r)}function nk(e,t,r){const n=e.config.Rules[r],i=t.Stack;if(sT(i))throw new Error("empty stack");return new gP(t.Input,((e,t,n)=>{for(;;){const i=e,o=t,a=n;if(sT(a))return o;e=i+1,t=oT(new mP(lT(a),new fP(r,i)),o),n=uT(a)}})(0,uT(i),n),t.MatchedTokens,t.Cost,t.EditDistance,GE(t.Backtrack,t),t,t.Context)}function ik(e,t,r){return new mP(t,r)}function ok(e,t,r){return kT(()=>{let n=t,i=1;return LT(()=>i<=e.maxBacktrack&&null!=n,kT(()=>{const t=WN(n),o=function(e,t,r){e:for(;;){const n=e,i=t,o=r;if(sT(o))return i;if(XP(n.config.ReliableTerminals,aP(lT(o).Token)))return i;if(sT(o))throw new Error("Match failure");{const a=lT(o);if(DR(lP(a.Token).ModifyStatus,new JT(2)))return;e=n,t=oT(a.Token,i),r=uT(o);continue e}}}(e,t.Input,t.MatchedTokens);if(null!=o){const l=o,u=(a=t.Backtrack,s=t,null==a?s:WN(a)),c=t.Cost-u.Cost,d=t.EditDistance-u.EditDistance,f=function(e,t,r,n){const i=(t,r)=>{for(;;){const n=t,i=r;if(sT(i))return[fT(n),i];if(XP(e.config.ReliableTerminals,aP(lT(i))))return[fT(n),i];if(sT(i))throw new Error("Match failure");t=oT(lT(i),n),r=uT(i)}};return((t,o,a)=>{e:for(;;){const s=t,l=o,u=a;if(l<=0)return[fT(s),u];if(sT(u))throw new Error("not enough input");{const c=i(iT(),u),d=c[1];let f;if(sT(d))throw new Error("not enough input");f=[lT(d),uT(d)],t=oT(new dP(f[0],c[0],l===n&&(n>1||r-0<5e-324)?wE(e.config.TerminalWeights.values()):void 0),s),o=l-1,a=f[1];continue e}}})(iT(),n,t)}(e,l,d,i);let p;const m=e.maxGlobalEditDist;return p=null==m?e.maxLocalEditDist:m-u.EditDistance-d,wT(p>0?GT(e=>new gP(gT(e.Output,f[1]),u.Stack,u.MatchedTokens,u.Cost+e.EditDistance+c,u.EditDistance+e.EditDistance+d,void 0,u.Parent,u.Context),WE(e.searcher,u.Stack,f[0],p,r)):IT(),kT(()=>(n=u.Parent,i=i+1|0,IT())))}return n=void 0,IT();var a,s}))})}function ak(e,t){let r=!1;const n=t.Stack;if(!sT(n)){const i=lT(n),o=RR([new zE(0,i.Symbol),new zE(1,i.Source)]);try{for(;o["System.Collections.IEnumerator.MoveNext"]();){const n=RR(UE(e.stateTransformers,o["System.Collections.Generic.IEnumerator`1.get_Current"]()));try{for(;n["System.Collections.IEnumerator.MoveNext"]();){const i=RR(n["System.Collections.Generic.IEnumerator`1.get_Current"]()(t)(e.this.contents));try{for(;i["System.Collections.IEnumerator.MoveNext"]();){const t=i["System.Collections.Generic.IEnumerator`1.get_Current"]();r=!0,tk(e,t)}}finally{SR(i)}}}finally{SR(n)}}}finally{SR(o)}}r||tk(e,t)}const sk=new Map([["COUNT",[1,2147483647]],["IF",[2,3]],["ISNA",[1,1]],["ISERROR",[1,1]],["SUM",[1,2147483647]],["AVERAGE",[1,2147483647]],["MIN",[1,2147483647]],["MAX",[1,2147483647]],["ROW",[0,1]],["COLUMN",[0,1]],["NA",[0,0]],["NPV",[2,2147483647]],["STDEV",[1,2147483647]],["DOLLAR",[1,2]],["FIXED",[1,3]],["SIN",[1,1]],["COS",[1,1]],["TAN",[1,1]],["ATAN",[1,1]],["PI",[0,0]],["SQRT",[1,1]],["EXP",[1,1]],["LN",[1,1]],["LOG10",[1,1]],["ABS",[1,1]],["INT",[1,1]],["SIGN",[1,1]],["ROUND",[2,2]],["LOOKUP",[2,3]],["INDEX",[2,4]],["REPT",[2,2]],["MID",[3,3]],["LEN",[1,1]],["VALUE",[1,1]],["TRUE",[0,0]],["FALSE",[0,0]],["AND",[1,2147483647]],["OR",[1,2147483647]],["NOT",[1,1]],["MOD",[2,2]],["DCOUNT",[3,3]],["DSUM",[3,3]],["DAVERAGE",[3,3]],["DMIN",[3,3]],["DMAX",[3,3]],["DSTDEV",[3,3]],["VAR",[1,2147483647]],["DVAR",[3,3]],["TEXT",[2,2]],["LINEST",[1,4]],["TREND",[1,4]],["LOGEST",[1,4]],["GROWTH",[1,4]],["GOTO",[1,1]],["HALT",[0,1]],["RETURN",[0,1]],["PV",[3,5]],["FV",[3,5]],["NPER",[3,5]],["PMT",[3,5]],["RATE",[3,6]],["MIRR",[3,3]],["IRR",[1,2]],["RAND",[0,0]],["MATCH",[2,3]],["DATE",[3,3]],["TIME",[3,3]],["DAY",[1,1]],["MONTH",[1,1]],["YEAR",[1,1]],["WEEKDAY",[1,2]],["HOUR",[1,1]],["MINUTE",[1,1]],["SECOND",[1,1]],["NOW",[0,0]],["AREAS",[1,1]],["ROWS",[1,1]],["COLUMNS",[1,1]],["OFFSET",[3,5]],["ABSREF",[2,2]],["RELREF",[2,2]],["ARGUMENT",[0,3]],["SEARCH",[2,3]],["TRANSPOSE",[1,1]],["ERROR",[0,2]],["STEP",[0,0]],["TYPE",[1,1]],["ECHO",[0,1]],["SET_NAME",[1,2]],["CALLER",[0,0]],["DEREF",[1,1]],["WINDOWS",[0,2]],["SERIES",[4,5]],["DOCUMENTS",[0,2]],["ACTIVE_CELL",[0,0]],["SELECTION",[0,0]],["RESULT",[0,1]],["ATAN2",[2,2]],["ASIN",[1,1]],["ACOS",[1,1]],["CHOOSE",[2,2147483647]],["HLOOKUP",[3,4]],["VLOOKUP",[3,4]],["LINKS",[0,2]],["INPUT",[1,7]],["ISREF",[1,1]],["GET_FORMULA",[1,1]],["GET_NAME",[1,2]],["SET_VALUE",[2,2]],["LOG",[1,2]],["EXEC",[1,4]],["CHAR",[1,1]],["LOWER",[1,1]],["UPPER",[1,1]],["PROPER",[1,1]],["LEFT",[1,2]],["RIGHT",[1,2]],["EXACT",[2,2]],["TRIM",[1,1]],["REPLACE",[4,4]],["SUBSTITUTE",[3,4]],["CODE",[1,1]],["NAMES",[0,3]],["DIRECTORY",[0,1]],["FIND",[2,3]],["CELL",[1,2]],["ISERR",[1,1]],["ISTEXT",[1,1]],["ISNUMBER",[1,1]],["ISBLANK",[1,1]],["T",[1,1]],["N",[1,1]],["FOPEN",[1,2]],["FCLOSE",[1,1]],["FSIZE",[1,1]],["FREADLN",[1,1]],["FREAD",[2,2]],["FWRITELN",[2,2]],["FWRITE",[2,2]],["FPOS",[1,2]],["DATEVALUE",[1,1]],["TIMEVALUE",[1,1]],["SLN",[3,3]],["SYD",[4,4]],["DDB",[4,5]],["GET_DEF",[1,3]],["REFTEXT",[1,2]],["TEXTREF",[1,2]],["INDIRECT",[1,2]],["REGISTER",[1,2147483647]],["CALL",[1,2147483647]],["ADD_BAR",[0,1]],["ADD_MENU",[2,4]],["ADD_COMMAND",[3,5]],["ENABLE_COMMAND",[4,5]],["CHECK_COMMAND",[4,5]],["RENAME_COMMAND",[4,5]],["SHOW_BAR",[0,1]],["DELETE_MENU",[2,3]],["DELETE_COMMAND",[3,4]],["GET_CHART_ITEM",[1,3]],["DIALOG_BOX",[1,1]],["CLEAN",[1,1]],["MDETERM",[1,1]],["MINVERSE",[1,1]],["MMULT",[2,2]],["FILES",[0,2]],["IPMT",[4,6]],["PPMT",[4,6]],["COUNTA",[1,2147483647]],["CANCEL_KEY",[0,2]],["FOR",[3,4]],["WHILE",[1,1]],["BREAK",[0,0]],["NEXT",[0,0]],["INITIATE",[2,2]],["REQUEST",[2,2]],["POKE",[3,3]],["EXECUTE",[2,2]],["TERMINATE",[1,1]],["RESTART",[0,1]],["HELP",[0,1]],["GET_BAR",[0,4]],["PRODUCT",[1,2147483647]],["FACT",[1,1]],["GET_CELL",[1,2]],["GET_WORKSPACE",[1,1]],["GET_WINDOW",[1,2]],["GET_DOCUMENT",[1,2]],["DPRODUCT",[3,3]],["ISNONTEXT",[1,1]],["GET_NOTE",[0,3]],["NOTE",[0,4]],["STDEVP",[1,2147483647]],["VARP",[1,2147483647]],["DSTDEVP",[3,3]],["DVARP",[3,3]],["TRUNC",[1,2]],["ISLOGICAL",[1,1]],["DCOUNTA",[3,3]],["DELETE_BAR",[1,1]],["UNREGISTER",[1,1]],["USDOLLAR",[1,2]],["FINDB",[2,3]],["SEARCHB",[2,3]],["REPLACEB",[4,4]],["LEFTB",[1,2]],["RIGHTB",[1,2]],["MIDB",[3,3]],["LENB",[1,1]],["ROUNDUP",[2,2]],["ROUNDDOWN",[2,2]],["ASC",[1,1]],["DBCS",[1,1]],["RANK",[2,3]],["ADDRESS",[2,5]],["DAYS360",[2,3]],["TODAY",[0,0]],["VDB",[5,7]],["ELSE",[0,0]],["ELSE_IF",[1,1]],["END_IF",[0,0]],["FOR_CELL",[1,3]],["MEDIAN",[1,2147483647]],["SUMPRODUCT",[1,2147483647]],["SINH",[1,1]],["COSH",[1,1]],["TANH",[1,1]],["ASINH",[1,1]],["ACOSH",[1,1]],["ATANH",[1,1]],["DGET",[3,3]],["CREATE_OBJECT",[2,11]],["VOLATILE",[0,1]],["LAST_ERROR",[0,0]],["CUSTOM_UNDO",[0,2]],["CUSTOM_REPEAT",[0,3]],["FORMULA_CONVERT",[2,5]],["GET_LINK_INFO",[2,4]],["TEXT_BOX",[1,4]],["INFO",[1,1]],["GROUP",[0,0]],["GET_OBJECT",[1,5]],["DB",[4,5]],["PAUSE",[0,1]],["RESUME",[0,1]],["FREQUENCY",[2,2]],["ADD_TOOLBAR",[0,2]],["DELETE_TOOLBAR",[1,1]],["_UDF",[1,2147483647]],["RESET_TOOLBAR",[1,1]],["EVALUATE",[1,1]],["GET_TOOLBAR",[1,2]],["GET_TOOL",[1,3]],["SPELLING_CHECK",[1,3]],["ERROR_TYPE",[1,1]],["APP_TITLE",[0,1]],["WINDOW_TITLE",[0,1]],["SAVE_TOOLBAR",[0,2]],["ENABLE_TOOL",[3,3]],["PRESS_TOOL",[3,3]],["REGISTER_ID",[2,3]],["GET_PROJECT",[1,2]],["AVEDEV",[1,2147483647]],["BETADIST",[3,5]],["GAMMALN",[1,1]],["BETAINV",[3,5]],["BINOMDIST",[4,4]],["CHIDIST",[2,2]],["CHIINV",[2,2]],["COMBIN",[2,2]],["CONFIDENCE",[3,3]],["CRITBINOM",[3,3]],["EVEN",[1,1]],["EXPONDIST",[3,3]],["FDIST",[3,3]],["FINV",[3,3]],["FISHER",[1,1]],["FISHERINV",[1,1]],["FLOOR",[2,2]],["GAMMADIST",[4,4]],["GAMMAINV",[3,3]],["CEILING",[2,2]],["HYPGEOMDIST",[4,4]],["LOGNORMDIST",[3,3]],["LOGINV",[3,3]],["NEGBINOMDIST",[3,3]],["NORMDIST",[4,4]],["NORMSDIST",[1,1]],["NORMINV",[3,3]],["NORMSINV",[1,1]],["STANDARDIZE",[3,3]],["ODD",[1,1]],["PERMUT",[2,2]],["POISSON",[3,3]],["TDIST",[3,3]],["WEIBULL",[4,4]],["SUMXMY2",[2,2]],["SUMX2MY2",[2,2]],["SUMX2PY2",[2,2]],["CHITEST",[2,2]],["CORREL",[2,2]],["COVAR",[2,2]],["FORECAST",[3,3]],["FTEST",[2,2]],["INTERCEPT",[2,2]],["PEARSON",[2,2]],["RSQ",[2,2]],["STEYX",[2,2]],["SLOPE",[2,2]],["TTEST",[4,4]],["PROB",[3,4]],["DEVSQ",[1,2147483647]],["GEOMEAN",[1,2147483647]],["HARMEAN",[1,2147483647]],["SUMSQ",[1,2147483647]],["KURT",[1,2147483647]],["SKEW",[1,2147483647]],["ZTEST",[2,3]],["LARGE",[2,2]],["SMALL",[2,2]],["QUARTILE",[2,2]],["PERCENTILE",[2,2]],["PERCENTRANK",[2,3]],["MODE",[1,2147483647]],["TRIMMEAN",[2,2]],["TINV",[2,2]],["MOVIE_COMMAND",[3,4]],["GET_MOVIE",[2,3]],["CONCATENATE",[1,2147483647]],["POWER",[2,2]],["SPREADBASE_DATA_FIELD",[2,9]],["GET_VIEW",[1,2]],["GET_FIELD",[1,3]],["GET_ITEM",[1,4]],["RADIANS",[1,1]],["DEGREES",[1,1]],["SUBTOTAL",[2,2147483647]],["SUMIF",[2,3]],["COUNTIF",[2,2]],["COUNTBLANK",[1,1]],["SCENARIO_GET",[1,2]],["OPTIONS_LISTS",[1,1]],["ISPMT",[4,4]],["DATEDIF",[3,3]],["DATESTRING",[1,1]],["NUMBERSTRING",[2,2]],["ROMAN",[1,2]],["OPENDIALOG",[0,4]],["SAVEDIALOG",[0,5]],["VIEW_GET",[1,2]],["GETPIVOTDATA",[2,2147483647]],["HYPERLINK",[1,2]],["FURIGANA",[1,1]],["AVERAGEA",[1,2147483647]],["MAXA",[1,2147483647]],["MINA",[1,2147483647]],["STDEVPA",[1,2147483647]],["VARPA",[1,2147483647]],["STDEVA",[1,2147483647]],["VARA",[1,2147483647]],["BAHTTEXT",[1,1]],["THAIDOW",[1,1]],["THAIDIGIT",[1,1]],["THAIMOY",[1,1]],["THAINUMSOUND",[1,1]],["THAINUMSTRING",[1,1]],["THAISTRINGLENGTH",[1,1]],["ISTHAIDIGIT",[1,1]],["ROUNDBAHTDOWN",[1,1]],["ROUNDBAHTUP",[1,1]],["THAIYEAR",[1,1]],["RTD",[3,2147483647]],["CUBEVALUE",[1,2147483647]],["CUBEMEMBER",[2,3]],["CUBEMEMBERPROPERTY",[3,3]],["CUBERANKEDMEMBER",[3,4]],["HEX2BIN",[1,2]],["HEX2DEC",[1,1]],["HEX2OCT",[1,2]],["DEC2BIN",[1,2]],["DEC2HEX",[1,2]],["DEC2OCT",[1,2]],["OCT2BIN",[1,2]],["OCT2HEX",[1,2]],["OCT2DEC",[1,1]],["BIN2DEC",[1,1]],["BIN2OCT",[1,2]],["BIN2HEX",[1,2]],["IMSUB",[2,2]],["IMDIV",[2,2]],["IMPOWER",[2,2]],["IMABS",[1,1]],["IMSQRT",[1,1]],["IMLN",[1,1]],["IMLOG2",[1,1]],["IMLOG10",[1,1]],["IMSIN",[1,1]],["IMCOS",[1,1]],["IMEXP",[1,1]],["IMARGUMENT",[1,1]],["IMCONJUGATE",[1,1]],["IMAGINARY",[1,1]],["IMREAL",[1,1]],["COMPLEX",[2,3]],["IMSUM",[1,2147483647]],["IMPRODUCT",[1,2147483647]],["SERIESSUM",[4,4]],["FACTDOUBLE",[1,1]],["SQRTPI",[1,1]],["QUOTIENT",[2,2]],["DELTA",[1,2]],["GESTEP",[1,2]],["ISEVEN",[1,1]],["ISODD",[1,1]],["MROUND",[2,2]],["ERF",[1,2]],["ERFC",[1,1]],["BESSELJ",[2,2]],["BESSELK",[2,2]],["BESSELY",[2,2]],["BESSELI",[2,2]],["XIRR",[2,3]],["XNPV",[3,3]],["PRICEMAT",[5,6]],["YIELDMAT",[5,6]],["INTRATE",[4,5]],["RECEIVED",[4,5]],["DISC",[4,5]],["PRICEDISC",[4,5]],["YIELDDISC",[4,5]],["TBILLEQ",[3,3]],["TBILLPRICE",[3,3]],["TBILLYIELD",[3,3]],["PRICE",[6,7]],["YIELD",[6,7]],["DOLLARDE",[2,2]],["DOLLARFR",[2,2]],["NOMINAL",[2,2]],["EFFECT",[2,2]],["CUMPRINC",[6,6]],["CUMIPMT",[6,6]],["EDATE",[2,2]],["EOMONTH",[2,2]],["YEARFRAC",[2,3]],["COUPDAYBS",[3,4]],["COUPDAYS",[3,4]],["COUPDAYSNC",[3,4]],["COUPNCD",[3,4]],["COUPNUM",[3,4]],["COUPPCD",[3,4]],["DURATION",[5,6]],["MDURATION",[5,6]],["ODDLPRICE",[7,8]],["ODDLYIELD",[7,8]],["ODDFPRICE",[8,9]],["ODDFYIELD",[8,9]],["RANDBETWEEN",[2,2]],["WEEKNUM",[1,2]],["AMORDEGRC",[6,7]],["AMORLINC",[6,7]],["CONVERT",[3,3]],["ACCRINT",[6,8]],["ACCRINTM",[4,5]],["WORKDAY",[2,3]],["NETWORKDAYS",[2,3]],["GCD",[1,2147483647]],["MULTINOMIAL",[1,2147483647]],["LCM",[1,2147483647]],["FVSCHEDULE",[2,2]],["CUBEKPIMEMBER",[3,4]],["CUBESET",[2,5]],["CUBESETCOUNT",[1,1]],["IFERROR",[2,2]],["COUNTIFS",[2,2147483647]],["SUMIFS",[3,2147483647]],["AVERAGEIF",[2,3]],["AVERAGEIFS",[3,2147483647]],["AGGREGATE",[3,2147483647]],["BINOM_DIST",[4,4]],["BINOM_INV",[3,3]],["CONFIDENCE_NORM",[3,3]],["CONFIDENCE_T",[3,3]],["CHISQ_TEST",[2,2]],["F_TEST",[2,2]],["COVARIANCE_P",[2,2]],["COVARIANCE_S",[2,2]],["EXPON_DIST",[3,3]],["GAMMA_DIST",[4,4]],["GAMMA_INV",[3,3]],["MODE_MULT",[1,2147483647]],["MODE_SNGL",[1,2147483647]],["NORM_DIST",[4,4]],["NORM_INV",[3,3]],["PERCENTILE_EXC",[2,2]],["PERCENTILE_INC",[2,2]],["PERCENTRANK_EXC",[2,3]],["PERCENTRANK_INC",[2,3]],["POISSON_DIST",[3,3]],["QUARTILE_EXC",[2,2]],["QUARTILE_INC",[2,2]],["RANK_AVG",[2,3]],["RANK_EQ",[2,3]],["STDEV_S",[1,2147483647]],["STDEV_P",[1,2147483647]],["T_DIST",[3,3]],["T_DIST_2T",[2,2]],["T_DIST_RT",[2,2]],["T_INV",[2,2]],["T_INV_2T",[2,2]],["VAR_S",[1,2147483647]],["VAR_P",[1,2147483647]],["WEIBULL_DIST",[4,4]],["NETWORKDAYS_INTL",[2,4]],["WORKDAY_INTL",[2,4]],["ECMA_CEILING",[2,2]],["ISO_CEILING",[1,2]],["BETA_DIST",[4,6]],["BETA_INV",[3,5]],["CHISQ_DIST",[3,3]],["CHISQ_DIST_RT",[2,2]],["CHISQ_INV",[2,2]],["CHISQ_INV_RT",[2,2]],["F_DIST",[4,4]],["F_DIST_RT",[3,3]],["F_INV",[3,3]],["F_INV_RT",[3,3]],["HYPGEOM_DIST",[5,5]],["LOGNORM_DIST",[4,4]],["LOGNORM_INV",[3,3]],["NEGBINOM_DIST",[4,4]],["NORM_S_DIST",[2,2]],["NORM_S_INV",[1,1]],["T_TEST",[4,4]],["Z_TEST",[2,3]],["ERF_PRECISE",[1,1]],["ERFC_PRECISE",[1,1]],["GAMMALN_PRECISE",[1,1]],["CEILING_PRECISE",[1,2]],["FLOOR_PRECISE",[1,2]],["ACOT",[1,1]],["ACOTH",[1,1]],["COT",[1,1]],["COTH",[1,1]],["CSC",[1,1]],["CSCH",[1,1]],["SEC",[1,1]],["SECH",[1,1]],["IMTAN",[1,1]],["IMCOT",[1,1]],["IMCSC",[1,1]],["IMCSCH",[1,1]],["IMSEC",[1,1]],["IMSECH",[1,1]],["BITAND",[2,2]],["BITOR",[2,2]],["BITXOR",[2,2]],["BITLSHIFT",[2,2]],["BITRSHIFT",[2,2]],["PERMUTATIONA",[2,2]],["COMBINA",[2,2]],["XOR",[1,2147483647]],["PDURATION",[3,3]],["BASE",[2,3]],["DECIMAL",[2,2]],["DAYS",[2,2]],["BINOM_DIST_RANGE",[3,4]],["GAMMA",[1,1]],["SKEW_P",[1,2147483647]],["GAUSS",[1,1]],["PHI",[1,1]],["RRI",[3,3]],["UNICHAR",[1,1]],["UNICODE",[1,1]],["MUNIT",[1,1]],["ARABIC",[1,1]],["ISOWEEKNUM",[1,1]],["NUMBERVALUE",[1,3]],["SHEET",[0,1]],["SHEETS",[0,1]],["FORMULATEXT",[1,1]],["ISFORMULA",[1,1]],["IFNA",[2,2]],["CEILING_MATH",[1,3]],["FLOOR_MATH",[1,3]],["IMSINH",[1,1]],["IMCOSH",[1,1]],["FILTERXML",[2,2]],["WEBSERVICE",[1,1]],["ENCODEURL",[1,1]],["FORECAST_ETS",[3,6]],["FORECAST_ETS_CONFINT",[3,7]],["FORECAST_ETS_SEASONALITY",[2,4]],["FORECAST_LINEAR",[3,3]],["FORECAST_ETS_STAT",[3,6]],["MAXIFS",[3,2147483647]],["MINIFS",[3,2147483647]],["TEXTJOIN",[3,2147483647]],["CONCAT",[1,2147483647]],["IFS",[2,2147483647]],["SWITCH",[3,2147483647]],["SINGLE",[1,1]],["AVERAGE_WEIGHTED",[2,2147483647]],["ANCHORARRAY",[1,1]],["_FV",[2,3]],["FIELDVALUE",[2,2]],["FILTER",[2,3]],["SORT",[1,4]],["UNIQUE",[1,3]],["RICHSEARCH",[2,2]],["LARGEPROPERTY",[3,3]],["SMALLPROPERTY",[3,3]],["AVERAGEPROPERTY",[2,2147483647]],["FINDN",[2,5]],["TEXTSLICE",[1,3]],["TEXTBEFORE",[2,4]],["TEXTAFTER",[2,4]],["TEXTSPLIT",[2,4]],["_SORT",[1,4]],["_ONEDARRAY",[2,2]],["XMATCH",[2,4]],["XLOOKUP",[3,6]],["SORTBY",[2,2147483647]],["RANDARRAY",[0,5]],["SEQUENCE",[1,4]],["STOCKHISTORY",[2,2147483647]],["SUBARRAY",[1,5]],["VSTACK",[1,2147483647]],["HSTACK",[1,2147483647]],["CHOOSEROWS",[2,2147483647]],["CHOOSECOLS",[2,2147483647]],["LET",[3,2147483647]],["LAMBDA",[1,2147483647]],["MAKEARRAY",[3,3]],["APPLY",[1,2147483647]],["ISLAMBDA",[1,1]],["ARITY",[1,1]],["RECURSE",[0,0]],["RECORD",[3,2147483647]],["VALUETOTEXT",[1,2]],["ARRAYTOTEXT",[1,2]],["FORMATTEDNUMBER",[2,2]],["TOCOLUMN",[1,3]],["TOROW",[1,3]],["VECTORWRAP",[2,3]],["MAP",[2,2147483647]],["REDUCE",[3,3]],["SCAN",[3,3]],["BYROW",[1,2]],["BYCOL",[1,2]],["ISMISSINGARG",[1,1]],["TESTFUNCTIONBEGIN",[0,0]],["IMAGE",[1,1]],["GRF",[1,2]],["UNIT",[2,2]],["RICHERROR",[1,2]],["COUNTER",[0,0]],["BROKENRECORD",[3,2147483647]],["FORMULABYTES",[1,1]],["FORMULACODE",[1,1]],["FORMULAHTML",[1,1]],["STREAM",[0,1]],["GETRICHERRORS",[0,1]],["DBGSTAT",[1,2]],["RICHNUMBER",[1,1]],["RICHERNUMBER",[1,1]],["DBGWRITE",[2,2]],["TEST",[1,2147483647]],["AAC",[1,2147483647]],["AWC",[1,2147483647]],["LETREC",[3,2147483647]],["NESTEDRECORD",[3,2147483647]]]);class lk extends XR{constructor(e,t){super(),this.FncName=e,this.NumArgs=0|t}}class uk extends XR{constructor(e,t){super(),this.LastFncName=e,this.Arities=t}}function ck(e,t){return kT(()=>{let r;const n=WN(e.Context).Arities;if(sT(n))throw new Error("no arity info");let i;r=lT(n);const o=e.Stack;if(sT(o))throw new Error("empty stack");let a;i=lT(o);let s=[0,0];return a=[tb(sk,r.FncName.toLocaleUpperCase(),new $R(()=>s,e=>{s=e})),s],a[0]?r.NumArgs>=a[1][1]?35===i.Symbol?_T(XE(t,e,55)):36===i.Symbol?_T(XE(t,e,57)):IT():r.NumArgs<a[1][0]?35===i.Symbol?_T(XE(t,e,56)):36===i.Symbol?_T(XE(t,e,58)):IT():_T(e):_T(e)})}function dk(e,t){const r=0|e.length,n=0|t.length;let i=function(e,t,r){if(e<0)throw new Error("The input must be non-negative\\nParameter name: count");const n=QN(r,e);for(let r=0;r<=e-1;r++)n[r]=t(r);return n}(n+1,e=>e,Int32Array);for(let o=1;o<=r;o++){const r=qN(new Int32Array(n+1),0,n+1,0);r[0]=0|o;for(let a=1;a<=n;a++)r[a]=0|(e[o-1]===t[a-1]?i[a-1]:UR(LR,i[a],UR(LR,r[a-1],i[a-1]))+1);i=r}return 0|i[n]}function fk(e,t){if(0!==e.length&&0!==t.length||!(e.length>0||t.length>0)){const r=e.length>t.length?[dk(t,e),e.length]:[dk(e,t),t.length],n=0|r[1],i=0|r[0];return i>=n?0:(n-i)/n}return 0}function pk(e){const t=function(e,t){const r=pN(fN(e),t);return null!=r?r[0]:void 0}("\\$?[a-zA-Z]+\\$?\\d+",e);let r;switch(r=null!=t&&t===e?0:1,r){case 0:return!0;case 1:return!1}}const mk=new XT(!1,new JT(1));function hk(e,t,r){return kT(()=>{const r=t.Input;let n,i,o,a;switch(sT(r)||sT(uT(r))||1!==aP(lT(uT(r)))||sk.has(sP(lT(r)).toLocaleUpperCase())?n=1:(n=0,i=uT(r),o=lT(r),a=lT(uT(r))),n){case 0:{const r=function(e,t){let r=void 0,n=0;const i=RR(sk.keys());try{for(;i["System.Collections.IEnumerator.MoveNext"]();){const o=i["System.Collections.Generic.IEnumerator`1.get_Current"](),a=fk(e,o);a>=t&&a>n&&(r=o,n=a)}}finally{SR(i)}return r}(sP(o).toLocaleUpperCase(),e);return null!=r?wT(_T(new gP(oT(oP(28,r,mk),i),t.Stack,t.MatchedTokens,t.Cost,t.EditDistance,t.Backtrack,t.Parent,t.Context)),kT(()=>_T(new gP(t.Input,t.Stack,t.MatchedTokens,t.Cost+1,t.EditDistance+1,t.Backtrack,t.Parent,t.Context)))):_T(t)}case 1:{let e,n,i,o;switch(sT(r)||sT(uT(r))||1===aP(lT(uT(r)))||sk.has(sP(lT(r)))?e=1:(e=0,n=uT(r),i=lT(r),o=lT(uT(r))),e){case 0:{const e=function(e){let t=0,r=void 0;const n=RR(sk.keys());try{for(;n["System.Collections.IEnumerator.MoveNext"]();){const i=n["System.Collections.Generic.IEnumerator`1.get_Current"]();0===e.indexOf(i)&&i.length>t&&(r=i,t=0|i.length)}}finally{SR(n)}return r}(sP(i).toLocaleUpperCase());if(null!=e){const r=e;if($P(e=>0===sP(i).toLocaleUpperCase().indexOf(e),ZP(["TABLE","COLUMN"],{Compare:LR})))return _T(t);{const e=sP(i).slice(r.length,sP(i).length+1);if(pk(e)){const i=oP(27,e,mk),o=oP(1,null,mk);return _T(new gP(pT([oP(28,r,mk),o,i],n),t.Stack,t.MatchedTokens,t.Cost,t.EditDistance,t.Backtrack,t.Parent,t.Context))}return _T(t)}}{const e=function(e){if(28!==aP(e));else{const t=pN(fN("[A-Z]{1,4}[1-9][0-9]*$"),sP(e));if(null!=t){const r=t[0];return[PN(sP(e),0,sP(e).length-r.length),r]}}}(i);if(null!=e){const r=e[1];return wT(_T(new gP(pT([oP(28,e[0],mk),oP(27,r,mk)],n),t.Stack,t.MatchedTokens,t.Cost,t.EditDistance,t.Backtrack,t.Parent,t.Context)),kT(()=>_T(t)))}return _T(t)}}case 1:return _T(t)}}}})}function gk(e){return sk.has(e)}function vk(e,t){const r=e.Input;if(sT(r))return e;{const t=function(e){if(28===aP(e)&&function(e,t){const r=e.lastIndexOf(t);return r>=0&&r===e.length-t.length}(sP(e),")")){const t=0|sP(e).indexOf(")"),r=sP(e).length-t|0;return[PN(sP(e),0,t),r]}}(lT(r));if(null==t)return e;{const n=0|t[1];return new gP(gT(oT(oP(28,t[0],ZT),vT(n,oP(2,null,ZT))),uT(r)),e.Stack,e.MatchedTokens,e.Cost,e.EditDistance,e.Backtrack,e.Parent,e.Context)}}}function Sk(e,t){return kT(()=>{const r=e.Input;if(sT(r))return _T(e);return _T(gk(sP(lT(r)).toLocaleUpperCase())?XE(t,e,72):vk(e))})}function yk(e,t){return kT(()=>{const r=WN(e.Context).LastFncName;if(null!=r){return _T(gk(r.toLocaleUpperCase())?XE(t,e,35):e)}return _T(e)})}function Ck(e,t){return kT(()=>{const t=function(e){let t,r,n,i,o;switch(sT(e)||sT(uT(e))||sT(uT(uT(e)))?t=1:(t=0,r=uT(uT(uT(e))),n=lT(e),i=lT(uT(e)),o=lT(uT(uT(e)))),t){case 0:return[n,i,o,r];case 1:return}}(e.Input);if(null==t)return _T(e);{const r=t[2],n=t[1],i=t[3],o=[aP(t[0]),aP(n),aP(r)],a=MR(o,[20,6,22])?oP(19,null,mk):MR(o,[20,6,18])?oP(21,null,mk):MR(o,[22,6,18])?oP(23,null,mk):void 0;return _T(null==a?e:new gP(oT(a,i),e.Stack,e.MatchedTokens,e.Cost+.01,e.EditDistance+.01,e.Backtrack,e.Parent,e.Context))}})}function Rk(e,t){return kT(()=>{let t;const r=e.MatchedTokens;let n;switch(sT(r)||sT(uT(r))?n=1:(t=lT(r),n=12!==aP(t.Token)&&13!==aP(t.Token)||27!==aP(lT(uT(r)).Token)?1:0),n){case 0:{const t=e.Parent;if(null==t)return _T([e,!0]);{const r=t.Backtrack;if(null==r)return _T([e,!0]);{const t=r;return wT(sT(WN(t.Context).Arities)?IT():0===aP(lT(e.Input))?_T([new gP(oT(oP(2,null,mk),e.Input),t.Stack,t.MatchedTokens,t.Cost+.1,t.EditDistance+.1,t.Backtrack,t.Parent,t.Context),!1]):IT(),kT(()=>_T([new gP(e.Input,t.Stack,t.MatchedTokens,t.Cost+.01,t.EditDistance+.01,t.Backtrack,t.Parent,t.Context),!1])))}}}case 1:return _T([e,!0])}})}function bk(e,t){return kT(()=>{const t=e.MatchedTokens;let r;switch(r=sT(t)?1:18===aP(lT(t).Token)?0:1,r){case 0:{const t=e.Input;let r,n,i;switch(sT(t)?r=1:18===aP(lT(t))?(r=0,n=lT(t),i=uT(t)):r=1,r){case 0:return _T([new gP(i,e.Stack,e.MatchedTokens,e.Cost+.1,e.EditDistance+.1,e.Backtrack,e.Parent,e.Context),!1]);case 1:return _T([e,!0])}}case 1:return _T([e,!0])}})}function Nk(e,t){const r=null==t?.6:t;var n;n=e=>{!function(e){const t=new uk(void 0,iT());e.Context=t}(e)},e.initCallbacks.push(n),$E(e,new zE(1,yE),(e,t,r)=>{!function(e,t,r){let n;t.Context=(n=WN(t.Context),new uk(sP(r),n.Arities))}(0,t,r)}),$E(e,new zE(1,bE),(e,t,r)=>{!function(e,t,r){const n=WN(WN(t.Context).LastFncName)+"_"+sP(r);t.Context=new uk(n,WN(t.Context).Arities)}(0,t,r)}),$E(e,new zE(1,RE),(e,t,r)=>{!function(e,t,r){const n=new lk(WN(WN(e.Context).LastFncName),0),i=new uk(WN(t.Context).LastFncName,oT(n,WN(t.Context).Arities));t.Context=i}(e,t)}),$E(e,new zE(1,CE),(e,t,r)=>{!function(e,t,r){let n;const i=WN(t.Context).Arities;if(sT(i))throw new Error("no arity parent");n=uT(i);const o=new uk(WN(t.Context).LastFncName,n);t.Context=o}(0,t)}),function(e,t,r){BE(e.ruleCallbacks,t,jR(3,r))}(e,new zE(0,34),(e,t,r)=>{!function(e,t,r){let n;const i=WN(t.Context).Arities;if(sT(i))throw new Error("no arity info");n=[lT(i),uT(i)];const o=n[0],a=new lk(o.FncName,o.NumArgs+1),s=new uk(WN(t.Context).LastFncName,oT(a,n[1]));t.Context=s}(0,t)}),ZE(e,new zE(0,35),ck),ZE(e,new zE(0,36),ck),ZE(e,new zE(1,NE),Sk),ZE(e,new zE(0,45),yk),ZE(e,new zE(0,22),Ck),ZE(e,new zE(0,20),Ck),ZE(e,new zE(1,yE),(e,t)=>hk(r,e)),ek(e,Rk),ek(e,bk)}function Tk(e,t){return iP(e,t)}function Pk(e){let t;if(18===aP(e))return"=";if(19===aP(e))return"<>";if(20===aP(e))return"<";if(21===aP(e))return"<=";if(22===aP(e))return">";if(23===aP(e))return">=";if(12===aP(e))return"+";if(14===aP(e))return"*";if(13===aP(e))return"-";if(15===aP(e))return"/";if(16===aP(e))return"^";if(17===aP(e))return"&";if(4===aP(e))return":";if(29===aP(e))return".";if(11===aP(e))return"%";if(5===aP(e))return"!";if(1===aP(e))return"(";if(2===aP(e))return")";if(3===aP(e))return",";if(6===aP(e))return"";if(7===aP(e))return'"';if(10===aP(e))return"[";if(9===aP(e))return"]";if(bN(sP(e)))throw new Error((t=function(e){let t;if("string"!=typeof(r=sP(e))||/^\s*$/.test(r))t="";else{const r=sP(e);t=yN(vN("[%s]"))(r)}var r;const n=rb(vE,aP(e));return yN(vN("%s%s"))(n)(t)}(e),yN(vN("don't know how to nicely convert token '%s' to string"))(t)));return sP(e)}function Ek(e){const t=(e,t)=>{for(;;){const r=e,n=t;if(sT(n))throw new Error("should not happen");if(7===aP(lT(n)))return[iP(25,NN("",GT(Pk,fT(r)))),lT(n),uT(n)];if(sT(n))throw new Error("Match failure");e=oT(lT(n),r),t=uT(n)}};return cT(((e,r)=>{e:for(;;){const n=e,i=r;let o,a,s,l,u;switch(sT(i)?o=0:sT(uT(i))||sT(uT(uT(i)))?o=2:7===aP(lT(i))&&25===aP(lT(uT(i)))&&7===aP(lT(uT(uT(i))))?(o=1,a=uT(uT(uT(i))),s=lT(i),l=lT(uT(i)),u=lT(uT(uT(i)))):o=2,o){case 0:return fT(n);case 1:e=pT([u,l,s],n),r=a;continue e;case 2:{let o,a,s,l;switch(sT(i)||sT(uT(i))?o=1:7===aP(lT(i))&&25!==aP(lT(uT(i)))?(o=0,a=uT(i),s=lT(i),l=lT(uT(i))):o=1,o){case 0:{const i=t(iT(),a);e=pT([i[1],i[0],s],n),r=i[2];continue e}case 1:if(sT(i))throw new Error("Match failure");e=oT(lT(i),n),r=uT(i);continue e}}}break}})(iT(),mT(e.Tokens)))}class kk extends XR{constructor(e,t,r,n,i){super(),this.Timeout=e,this.MaxBacktrack=0|t,this.MaxGlobalEditDistance=r,this.MaxLocalEditDistance=n,this.ValidateCandidateRepairs=i}}const Ok=new kk(1e3,1,5,5,!1);function Ak(e,t){const r=null!=t?t:Ok;zT(kE,!0);const n=function(e,t,r,n){return new YE(e,t,r,n)}(kE,r.MaxGlobalEditDistance,r.MaxLocalEditDistance,r.MaxBacktrack);Nk(n,void 0);const i=FT(GT(Ek,JE(n,e,void 0,new RP(1),CP(r.Timeout))));if(r.ValidateCandidateRepairs){const e=new kk(r.Timeout,0,0,0,!1);return FT(VT(t=>Ak(t,e),i))}return i}var Ik=r(45);const _k=Ik.excelHelper.ExcelChecker,Fk=r(346),Mk=(Ik.excelHelper.refactorLiftParenExpr,Fk.EDIT_OP_ENUM,Ik.excelHelper.lexFormula),Dk=new Map([[1,"End"],[2,"Left"],[3,"Right"],[4,"Sep"],[5,"Operator"],[6,"Spaces"],[7,"Ident"],[8,"CellRef"],[9,"Literal"],[10,"SpecialRef"],[11,"Unexpected"],[12,"Escape"]]),wk=new Map([[1,"("],[2,"["],[3,"{"],[4,"'"]]),Lk=new Map([[1,")"],[2,"]"],[3,"}"],[4,"'"]]),xk=new Map([[1,","],[2,"RowSep"],[3,"ColSep"],[4,"!"],[5,"."]]),Bk=new Map([[1,"Add"],[2,"Sub"],[3,"Mul"],[4,"Div"],[5,"Pow"],[6,"Percent"],[9,"Concat"],[10,"Eq"],[11,"Ne"],[12,"Lt"],[13,"Le"],[14,"Gt"],[15,"Ge"],[16,"RangeOp"],[18,"UnionOp"],[24,"At"],[25,"Pound"]]),Uk=new Map([[1,"Number"],[2,"String"],[4,"Boolean"]]),Gk=new Map([["Eq",18],["Ident",28],["(",1],[")",2],["[",10],["]",9],[",",3],['"',7],["CellRef",27],["Ident",28],["RangeOp",4],["BooleanLiteral",24],["StringLiteral",25],["NumberLiteral",26],["Ne",19],["Le",21],["Lt",20],["Gt",22],["Ge",23],["Add",12],["Sub",13],["Mul",14],["Div",15],["Pow",16],["Concat",17],["Spaces",6],["!",5],[".",29],["Percent",11],["EOF",0],["Unexpected",8]]);function Kk(e){const t=e.flatMap(e=>function(e){const t=Dk.get(e.kind);let r=void 0,n=void 0;if("End"==t)return[];if("Left"==t)r=wk.get(e.value),n=null;else if("Right"==t)r=Lk.get(e.value),n=null;else if("Sep"==t)r=xk.get(e.value),n=null;else if("Operator"==t)r=Bk.get(e.value),n=null;else if("Spaces"==t)r="Spaces",n=null;else if("Ident"==t)r="Ident",n=e.chars;else if("CellRef"==t)r="CellRef",n=e.chars;else if("Literal"==t){const t=e.oper.kind;if(!Uk.has(t))throw"Undefined literal kind: "+e;r=Uk.get(t)+"Literal",n=e.chars}else if("SpecialRef"==t)r="SpecialRef",n=e.chars;else{if("Escape"==t)throw"Escape not yet implemented: "+e;if("Unexpected"!=t)throw"Unknown token kind: "+e;0==e.chars.trim().length?(r="Spaces",n=null):(r="Unexpected",n=null)}if("StringLiteral"==r){const e=[],t='"';let r=n;return r.startsWith(t)&&(r=r.substring(1),e.push(Tk(Gk.get(t),null))),r.endsWith(t)?(r=r.substring(0,r.length-1),e.push(Tk(Gk.get("StringLiteral"),r)),e.push(Tk(Gk.get(t),null))):e.push(Tk(Gk.get("StringLiteral"),r)),e}return void 0===r?[]:[Tk(Gk.get(r),n)]}(e));return t.push(Tk(0,null)),t}function Vk(e){return e.length>0&&0==e[e.length-1].symbol&&e.pop(),e.filter(e=>6!==e.symbol).map(Pk).join("")}function jk(e){const t=[],r=new Set;for(var n of e)r.has(n)||(t.push(n),r.add(n));return t}class Wk{constructor(e){this.validator=new _k(e),this.config=e}repairExcelFormula(e,t,r=!0){const n=e.map(e=>e.chars).join("");let i=[],o=[n];if(!r){return Hk(e).filter(e=>this.validator.validate(e,t))}function a(e,r,n,i,o){const a=r.slice(),s=[];for(const r of n){const n=i(r);if(0!=n.length)for(const r of n)e.validate(r,t)&&!o.has(r)?a.push(r):s.push(r);else s.push(r)}return[a,s]}const s=new Set;s.add(n),[i,o]=a(this.validator,i,o,e=>{const t=Mk(e);return[Ik.excelHelper.adHocPreRepair(t)]},s),[i,o]=a(this.validator,i,o,e=>Hk(Mk(e)),s),[i,o]=a(this.validator,i,o,e=>{const t=Mk(e);return Ik.excelHelper.adHocFixParens(t)},s),[i,o]=a(this.validator,[],i.concat(o),e=>{const t=Mk(e);return[Ik.excelHelper.adHocPostRepair(t)]},s);const l=Ik.excelHelper.adHocPostFilter(i);let u=[];return l.length>0?u=l:i.length>0?u=i:this.validator.validate(n,t)&&Ik.excelHelper.adHocValidRangeOps(e)&&(u=[n]),jk(u)}validate(e,t){return this.validator.validate(e,t)}getDiff(e,t){const[r,n]=Fk.levenshtein(e,t,void 0,void 0,Fk.defaultExcelTokenUpdateCostFn);return n}}function Hk(e){return jk(Ak(Kk(e),{Timeout:1e3,MaxBacktrack:1,MaxGlobalEditDistance:5,MaxLocalEditDistance:5,ValidateCandidateRepairs:!0}).map(Vk))}function Qk(e,t,r){var n,i,o,a,s=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,l=null!==(a=null===(o=t.config)||void 0===o?void 0:o.refStyle)&&void 0!==a?a:e.config.refStyle,u=e.config.mathpack,c=t.originGridCell.value;return xC(s,u,l,c,r,0,{})}var qk=function(){function e(){this.factoryName=bh.FormulaRepairShadowEvalPlugin}return e.prototype.create=function(){return new zk},e}(),zk=function(){function e(){this.canLogBuggyFormula=fe("Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled"),this.churnInfoManager=new Zk,this.consistentAnonymizer=new YC}return e.prototype.run=function(t){var r,n,i,o,a,s,l,u,c,d,f,p,m,h,g,v,S,y,C,R,b,T,P,E,k,O,A,I,_,F,M,D,w,L,x,B,U,G,K,V,j=this;return Object(gu.__generator)(this,(function(W){switch(W.label){case 0:return null===t.content||void 0===t.content?[2,null]:[4,{kind:mg.GetActiveCell}];case 1:return(r=W.sent()).kind!==mg.GetActiveCell?[2,null]:(n=r.activeCell,[4,{kind:mg.ParseActiveCell,formulaText:t.content}]);case 2:return i=W.sent(),o=tO(i),a=o[0],s=o[1],a===Xk.FAILED_REQUEST?[2,null]:(l=this.churnInfoManager.getChurnInfo(n),a===Xk.OK&&void 0===l?[2,null]:[4,{kind:mg.GetConfig}]);case 3:if((u=W.sent()).kind!==mg.GetConfig)return[2,null];if(c=u.config,d=na(c),f=Oe(n),p=ta(f.kind,f.range),m=bo(c),h=No(f,f.range,c),g=Ro(m),v=Object(Su.getNewGuid)()[0],a===Xk.OK)return S=void 0,this.canLogBuggyFormula&&(S=this.consistentAnonymizer.anonymize(t.content,c,n.range)),y=eO(g,h,s),C=function(e,t){return e.map((function(e){return void 0===t?-2:e.findIndex((function(e){return e===t}))}))}(l.normalizedRepairCandidateLists,y),nO({logKind:Yk.CORRECT_LOG,id:v,version:e.formulaRepairVersion,rootId:l.rootId,priorId:l.priorId,repairMatchVector:C,formula:S}),this.churnInfoManager.clearChurnInfo(n),[2,null];R=N(s)?void 0:function(e,t,r){var n=aa(e).checkFormulaWithDiagnostics(t,r);if(!ge(n))return;return oa(null==n?void 0:n.value[1])}(d,p,s),b=new Wk(c),T=function(e,t,r,n,i){var o=Qk(t,r,i),a=window.performance.now(),s=[],l=!1;try{s=e.repairExcelFormula(o,n)}catch(e){l=!0}finally{var u=window.performance.now();return[s,u-a,l]}}(b,d,Yo(f.kind,f.range.range),f.range,t.content),P=T[0],E=T[1],k=T[2],O=[],A=[],I=[],_=0,W.label=4;case 4:return _<P.length?(F=P[_],[4,{kind:mg.ParseActiveCell,formulaText:F}]):[3,7];case 5:M=W.sent(),D=tO(M),w=D[0],L=D[1],O.push(w===Xk.OK),A.push(F.length),x=w===Xk.OK?eO(g,h,L):void 0,I.push(x),W.label=6;case 6:return _+=1,[3,4];case 7:return B=function(e,t,r){for(var n=xC(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),i=n.length,o=0,a=0;a<n.length;a++){if(n[a].kind===UC.Ident&&a<i-1){var s=n[a+1];o+=rO(s)?1:0}}return o}(t.content,c,n.range),U=void 0,G=void 0,this.canLogBuggyFormula&&(U=this.consistentAnonymizer.anonymize(t.content,c,n.range),G=P.map((function(e){return j.consistentAnonymizer.anonymize(e,c,n.range)}))),nO({logKind:Yk.BUGGY_LOG,version:e.formulaRepairVersion,origLength:t.content.length,origNumCalls:B,diagnostics:R,wellFormed:O,repairLengths:A,repairTime:E,exceptionRaised:k,formula:U,repairs:G,id:v,rootId:null!==(V=null==l?void 0:l.rootId)&&void 0!==V?V:v,priorId:null==l?void 0:l.priorId}),void 0===l?((K=new $k(v)).priorId=v,K.normalizedRepairCandidateLists.push(I),this.churnInfoManager.setChurnInfo(n,K)):(l.priorId=v,l.normalizedRepairCandidateLists.push(I)),[2,null]}}))},e.factoryName=bh.FormulaRepairShadowEvalPlugin,e.formulaRepairVersion=2,e}();zg(new qk);var Yk,Jk=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Iy.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.FormulaRepairShadowEvalPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))}));!function(e){e.BUGGY_LOG="buggy",e.CORRECT_LOG="correct"}(Yk||(Yk={}));var Xk,$k=function(e){this.rootId=e,this.normalizedRepairCandidateLists=[]},Zk=function(){function e(){this.churnInfoByLocation=new Map}return e.prototype.getChurnInfo=function(e){var t,r=e.sheet.index;return null===(t=this.churnInfoByLocation.get(r))||void 0===t?void 0:t.getValue(e.range)},e.prototype.setChurnInfo=function(e,t){var r=e.sheet.index;if(!this.churnInfoByLocation.has(r)){var n=hc();this.churnInfoByLocation.set(r,n)}var i=this.churnInfoByLocation.get(r).setValue(e.range,t);this.churnInfoByLocation.set(r,i)},e.prototype.clearChurnInfo=function(e){var t=e.sheet.index,r=this.churnInfoByLocation.get(t);if(void 0!==r){var n=r.remove(e.range);this.churnInfoByLocation.set(t,n)}},e}();function eO(e,t,r){var n=Object(gu.__assign)(Object(gu.__assign)({},r),{spans:{}}),i=e.printFormula(t,n);return ge(i)?i.value:void 0}function tO(e){if(e.kind!==mg.ParseActiveCell||!ge(e.result))return[Xk.FAILED_REQUEST,null];if(e.result.value.kind!==ma.Formula)return[Xk.FAILED_REQUEST,null];var t=e.result.value.formula;return[t.isWellFormed?Xk.OK:Xk.BUGGY,t]}function rO(e){return void 0!==e&&(e.kind===UC.Left&&e.value===BC.Paren)}function nO(e){var t=JSON.stringify(e);Ei.ULS.dnmTraceTag(537962258,ii.msoulscat_ES_EWAJS,ci.Info,t)}!function(e){e[e.FAILED_REQUEST=0]="FAILED_REQUEST",e[e.OK=1]="OK",e[e.BUGGY=2]="BUGGY"}(Xk||(Xk={}));var iO=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(gu.__generator)(this,(function(t){switch(t.label){case 0:return[4,Iy.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("pythonIntelliSense",!1)];case 2:return t.sent(),[2,e]}}))}))})),oO=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,iO.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.PythonAutocompletePlugin)];case 2:return e.sent(),[2]}}))}))})),aO=function(){function e(){this.factoryName=bh.SyntaxErrorsPlugin}return e.prototype.create=function(){return new sO},e}(),sO=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i,o,a,s,l,u,c,d,f,p,m=e.formula;return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return N(m)?(uO("Missing request arguments"),[2,null]):[4,{kind:mg.ParseActiveCell,formulaText:m}];case 1:return(t=e.sent()).kind===mg.ParseActiveCell&&ge(t.result)?(r=t.result.value).kind!==ma.Formula?(cO("Parsed result isn't formula"),[2,null]):r.formula.isWellFormed?(cO("Formula is already well formed"),[2,null]):[4,{kind:mg.GetActiveCell}]:(uO("ParseActiveCell"),[2,null]);case 2:return(n=e.sent()).kind!==mg.GetActiveCell?(uO("GetActiveCell"),[2,null]):(i=n.activeCell,[4,{kind:mg.GetConfig}]);case 3:if((o=e.sent()).kind!==mg.GetConfig)return uO("GetConfig"),[2,null];a=o.config;try{s=new Wk(a)}catch(e){return uO("failed to create prose engine: ".concat(e)),[2,null]}l=na(a),u=Oe(i),c=Yo(u.kind,u.range.range),d=Qk(l,c,m);try{f=s.repairExcelFormula(d)}catch(e){return uO("Repair failed: ".concat(e)),[2,null]}return N(f)?(uO("Repair result in none"),[2,null]):0===f.length?(cO("No repairs found"),[2,null]):(p=function(e,t,r,n,i){var o=[];return n.forEach((function(n){var a=Qk(e,t,n),s=r.getDiff(i,a),l=lO(s,(function(e){return e.to_elem}),tv.Removed),u=lO(s,(function(e){return e.from_elem}),tv.Added);o.push({text:n,repairedFormulaParts:l,originalFormulaParts:u})})),o}(l,c,s,f,d),[2,{formula:m,repairs:p}])}}))},e}();function lO(e,t,r){return e.filter((function(e){return e.op!==r})).reduce((function(e,r){var n=t(r);return 0===e.length||e[e.length-1].type!==r.op?e.push({type:r.op,location:{start:n.start,end:n.start+n.chars.length}}):e[e.length-1].location.end=n.start+n.chars.length,e}),[])}function uO(e){M.ULS.traceTag(509441991,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Warning,"SyntaxErrorsPlugin encountered a failure with msg ".concat(e))}function cO(e){M.ULS.traceTag(509441990,Su.LogCategory.msoulscat_ES_EWAJS,Su.TraceLevel.Info,"SyntaxErrorsPlugin: ".concat(e))}zg(new aO);var dO,fO,pO,mO,hO,gO=kf((function(){return Object(gu.__awaiter)(void 0,void 0,void 0,(function(){return Object(gu.__generator)(this,(function(e){switch(e.label){case 0:return[4,Iy.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(bh.SyntaxErrorsPlugin)];case 2:return e.sent(),[4,Oy.getValue()];case 3:return e.sent(),[2]}}))}))})),vO=((dO={})[bh.ArgumentAssistancePlugin]=[Ly,void 0,void 0,"ArgumentAssistance"],dO[bh.AutocompletePlugin]=[OC,void 0,void 0,"SmartSuggestionsAutoComplete"],dO[bh.AutocompletePrecisionMeasurements]=[AC,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled"],dO[bh.AutocompleteGroundTruthMeasurements]=[DC,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled"],dO[bh.AutocompleteFunctionPlugin]=[Gy,void 0,void 0,"SimpleAutoComplete"],dO[bh.ParenthesesCouplingPlugin]=[vC,void 0,void 0,"ParenthesisCoupling"],dO[bh.ColoredReferencesPlugin]=[PC,void 0,void 0,"ColoredReferences"],dO[bh.AutocompleteLetPlugin]=[Wy,void 0,void 0,"SimpleAutoComplete"],dO[bh.AutocompleteRichValuePlugin]=[iC,void 0,void 0,"SimpleAutoComplete"],dO[bh.FormulaCollectionPlugin]=[nR,"Microsoft.Office.Excel.FormulaCollection"],dO[bh.AutocompleteNamedObjectsPlugin]=[sC,void 0,void 0,"SimpleAutoComplete"],dO[bh.ParserPerformanceMeasurements]=[wC,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],dO[bh.AutocompleteTableHeadersPlugin]=[dC,void 0,void 0,"SimpleAutoComplete"],dO[bh.ValuePreviewPlugin]=[mR,void 0,void 0,"ValuePreview"],dO[bh.SyntaxErrorsPlugin]=[gO,void 0,void 0,"SyntaxErrors"],dO[bh.AutocompleteAuthoringPrecisionMeasurements]=[IC,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled"],dO[bh.AutocompleteRangeSuggestionPlugin]=[FC,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],dO[bh.AutocompleteWrapperPlugin]=[_C,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],dO[bh.AutocompleteBinaryModelExperimentPlugin]=[MC,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],dO[bh.FormulaRepairShadowEvalPlugin]=[Jk,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],dO[bh.PythonAutocompletePlugin]=[oO,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],dO[bh.ChatGPTPlugin]=[LC,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],dO[bh.TestPlugin]=[_y,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],dO),SO=((fO={})[Th.Core]=!0,fO[Th.Python]=!1,fO[Th.SmartSuggestionsAutoComplete]=!1,fO);d();var yO=((pO={})[Th.Core]=((mO={})[bh.AutocompletePlugin]=!1,mO),pO[Th.Python]={},pO[Th.SmartSuggestionsAutoComplete]=((hO={})[bh.AutocompletePlugin]=!0,hO),pO);function CO(e,t,r){return void 0===r&&(r=[]),Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,l;return Object(gu.__generator)(this,(function(u){switch(u.label){case 0:if(ky.resolve(t),void 0===(n=vO[e]))return[2,!1];if(i=n[0],o=n[1],a=n[2],s=n[3],void 0!==o&&!fe(o)||void 0!==a&&!pe(a)||void 0!==s&&-1===r.indexOf(s))return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,i.getValue()];case 2:return u.sent(),[2,!0];case 3:return l=u.sent(),M.ULS.traceTag(523352029,ii.msoulscat_ES_EWAJS,ci.Error,'x10arch.ensurePluginAttached: Failed to ensure plugin "'.concat(bh[e],'" is attached with exception ').concat(JSON.stringify(l),".")),[3,4];case 4:return[2,!1]}}))}))}function RO(e,t,r){return void 0===r&&(r=[]),Object(gu.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a;return Object(gu.__generator)(this,(function(s){switch(s.label){case 0:n=0,i=0,l=vO,o=Object.keys(l).map((function(e){return parseInt(e,10)})),s.label=1;case 1:return i<o.length?function(e,t){var r;return null!==(r=yO[t][e])&&void 0!==r?r:SO[t]}(a=o[i],t)?[4,CO(a,e,r)]:[3,3]:[3,4];case 2:s.sent()&&(n+=1),s.label=3;case 3:return i++,[3,1];case 4:return[2,n]}var l}))}))}var bO,NO,TO=function(){function e(){this.factoryName=bh.ChatGPTPlugin}return e.prototype.create=function(){return new PO},e}(),PO=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i;return Object(gu.__generator)(this,(function(o){switch(o.label){case 0:return t=e.query,b(t)?[4,{kind:mg.CreateChatGPTSession,options:e.context}]:[2,{}];case 1:if((r=o.sent()).kind!==mg.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");return[4,{kind:mg.SendChatGPTRequest,session:r.result,request:t}];case 2:if((n=o.sent()).kind!==mg.SendChatGPTRequest)throw new Error("Inconsistent yield request response type");return[4,{kind:mg.SendChatGPTRequest,session:r.result,request:"Explain your answer"}];case 3:if((i=o.sent()).kind!==mg.SendChatGPTRequest)throw new Error("Inconsistent yield request response type");return[2,{result:n.result,details:i.result}]}}))},e}();zg(new TO),(NO=bO||(bO={})).ChatGPTPlugin=PO,NO.defaultPluginResponseWindows=gv,NO.SchedulerVersion=Kg,NO.getSchedulerFactories=YS,NO.PluginSchedulerSingleton=WS,NO.GridImportManagerSingleton=jS,NO.FormulaKind=eg,NO.SchedulerVersionCompatibility=Tg,NO.RecalcSideGrid=ag,NO.createMockAsyncGrid=fy,NO.createMockGridProvider=py,NO.createMockGridExporter=my,NO.setMockGridSheetAndNotify=hy,NO.MockTimerImmediate=gy,NO.PluginGroup=Nh,NO.PluginFactoryName=bh,NO.registerPluginFactory=zg,NO.createDynamicPluginLoader=HS,NO.DynamicPluginLoader=QS,NO.devDynamicPluginLoaderInsideInit=xS,NO.stableDynamicPluginLoaderInsideInit=xS,NO.PluginRequestKind=mg,NO.typedRequest=vg,NO.awaitPromise=Sg,NO.wrapIntoAsync=uy,NO.delay=Pg,NO.delayRequest=bg,NO.getSheetNamesRequest=Cg,NO.getRangeRequest=yg,NO.getCellRequest=Rg,NO.parseCellFormulaRequest=Eg,NO.RequestKind=hg,NO.NotificationKind=pg,NO.PluginSchedulerResultKind=Ph,NO.ArgumentAssistancePluginFactory=Dy,NO.AutocompleteFunctionPluginFactory=By,NO.AutocompleteLetPluginFactory=Vy,NO.AutocompleteRichValuePluginFactory=tC,NO.AutocompleteNamedObjectsPluginFactory=oC,NO.AutocompleteTableHeadersPluginFactory=uC,NO.ParenthesesCouplingPluginFactory=hC,NO.ColoredReferencesPluginFactory=NC,NO.ValuePreviewPluginFactory=cR,NO.ValuePreviewResultExtractor=aR,NO.spanToLSPRange=av,NO.ensurePluginAttached=CO,NO.ensureGroupAttached=RO,NO.defaultTimerInterface=$g;var EO=new WS,kO=function(){function e(){}return e.prototype.getMinimalParamArray=function(e,t){var r;if(t){for(var n=Vr(t.FunctionIndexInServer),i=n.minArgs,o=n.restTypes.length>0?Math.max(i,2):null!==(r=null==e?void 0:e.length)&&void 0!==r?r:0,a=[],s=0;s<o;s+=1){var l=this.getFunctionParamByIndex(e,t,s);b(l)&&a.push(l)}return a}},e.prototype.getFunctionParamByIndex=function(e,t,r){if(t){var n=Vr(t.FunctionIndexInServer),i=n.headTypes.length,o=t.ParamsHelp.split("!"),a=Cy(r,e.length,n,!1,!0);if(-1!==a){if(!(a>=e.length)){var s=r<i?e[a].match(/[^\[\]]+/).toString():"".concat(Ty(e[a])).concat(by(r,i,n.restTypes.length)),l=o[Cy(r,t.ParamsHelp.split("!").length,n)];return{name:s,isOptional:r>=n.minArgs,description:l,type:"TO DO"}}this.logError("Trying to add param for a signature that doesn't have rest params.")}else this.logError("Trying to get param by index that is out of bounds")}},e.prototype.hasRepeatingParams=function(e){return b(e)&&Vr(e.FunctionIndexInServer).restTypes.length>0},e.prototype.getFormulaAnonymizer=function(e){var t=this,r=new YC;return{anonymize:function(n,i){try{return b(o=n)&&"string"==typeof o?function(e){return b(e)&&"object"==typeof e&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}(e)?function(e){return b(e)&&"object"==typeof e&&"row"in e&&"col"in e&&1===e.rows&&1===e.cols}(i)?r.anonymize(n,e,i):(t.logError("getFormulaAnonymizer: Origin"),null):(t.logError("getFormulaAnonymizer: Config"),null):(t.logError("getFormulaAnonymizer: Formula"),null)}catch(e){return t.logError("getFormulaAnonymizer: ".concat(e)),null}var o}}},e.prototype.logError=function(e){Ei.ULS.traceTag(512331973,ii.msoulscat_ES_EWAJS,ci.Error,"FormulaAuthoringHelper error: ".concat(e))},e}();var OO=new(I((function(){return new kO})));r.d(t,"packageVersion",(function(){return"40.4.3"})),r.d(t,"PluginSchedulerSingletonGlobal",(function(){return EO})),r.d(t,"FormulaAuthoringHelperSingletonGlobal",(function(){return OO})),r.d(t,"common",(function(){return l})),r.d(t,"location",(function(){return z})),r.d(t,"formula",(function(){return $})),r.d(t,"value",(function(){return J})),r.d(t,"signature",(function(){return ee})),r.d(t,"util",(function(){return re})),r.d(t,"config",(function(){return ie})),r.d(t,"math",(function(){return ae})),r.d(t,"date",(function(){return le})),r.d(t,"parse",(function(){return jo})),r.d(t,"analyze",(function(){return Zo})),r.d(t,"numfmt",(function(){return sa})),r.d(t,"runtime",(function(){return cs})),r.d(t,"calc",(function(){return JS})),r.d(t,"funcs",(function(){return ZS})),r.d(t,"style",(function(){return ey})),r.d(t,"worker",(function(){return ry})),r.d(t,"x10",(function(){return bO})),r.d(t,"getTypedFeatureGate",(function(){return fe})),r.d(t,"isTypedChangeGateEnabled",(function(){return pe})),r.d(t,"commonSubpackage",(function(){return c})),r.d(t,"langSubpackage",(function(){return Ce})),r.d(t,"numfmtSubpackage",(function(){return ua})),r.d(t,"recalcSubpackage",(function(){return Kv})),r.d(t,"runtimeSubpackage",(function(){return ps})),r.d(t,"syntaxSubpackage",(function(){return Ho})),r.d(t,"x10TypesSubpackage",(function(){return Rh}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map