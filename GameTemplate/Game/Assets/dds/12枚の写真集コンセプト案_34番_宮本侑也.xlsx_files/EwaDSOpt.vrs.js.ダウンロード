'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[21],{1178:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewa-svg-icon{height:100%;width:100%}")}},1179:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1195:function(u,C,a){var c=a(10),b=a(0),f=a(722),e=a(52),d=a(40),h=a(198),l=a(62);class k{constructor(pb){this.zAh=pb}hd(){return!1}executeCommand(pb,nc){pb=nc.command;nc=null;switch(pb){case 1243860697:this.zAh.G7j();break;default:nc=h.a(pb)}return nc||l.Task.Ua(!0)}Tc(pb,nc){return 1243860697===nc.command}ld(){return!1}}Object(b.a)(k,"SheetDropdownMenuCommandHandler",null,[200]);var n=a(71),v=a(149),x=a(36);class w extends f.a{constructor(pb){super(pb)}he(){Object(n.b)("OfficeVSO:7624897_MigrateContextMenuController")?
void v.a.resolve(x.hb,{Wa:this.La}).then(()=>{d.TaskExtensions.za(e.GetServiceTaskFactory.Za(this.$.da,32,33,this.La),pb=>{this.Pd([new k(pb.result.Wfg)])},this.$.ka)}):this.$.wA(pb=>{pb.nlc().then(()=>{d.TaskExtensions.za(e.GetServiceTaskFactory.Za(this.$.da,32,33,this.La),nc=>{this.Pd([new k(nc.result.Wfg)])},this.$.ka)})})}static la(pb){f.a.ye(392,new w(pb))}}Object(b.a)(w,"SheetDropdownMenuCommandHandlerFactory",f.a,[]);var r=a(229),t=a(7),A=a(83),y=a(15),z=a(31),E=a(179),G=a(14),F=a(92),O=a(50),
M=a(248),P=a(168),B=a(113),D=a(41),I=a(425),S=a(126),J=a(16),L=a(38);class R{constructor(){this.UTe=new L.a(!0);this.vPc=0}get Gdd(){return this.vPc}get navigationButtonsDisabled(){return!!(this.Gdd&1)}get operationButtonsDisabled(){return!!(this.Gdd&2)}B1g(pb,nc){this.UTe.add(pb,nc);this.RT()}RT(){this.vPc=0;L.a.forEach(this.UTe.Mv,pb=>{this.vPc=this.Gdd|pb.value})}}Object(b.a)(R,"SheetTabBarDisabledStateManager",null,[]);var Y=a(247),Q=a(35);class W{}W.vKh="ewa-stb-uir";W.hKh="ewa-stb-navarea";
W.iKh="ewa-stb-navarea-dimensions";W.kKh="ewa-stb-navbutton";W.zV="cui-disabled";W.jKh="ewa-stb-navareaextra";W.xka="cui-img-container";W.bKh="ewa-stb-contentarea";W.ZZe="ewa-stb-left-scrollable";W.d_e="ewa-stb-right-scrollable";W.tKh="ewa-stb-tabarea";W.sKh="ewa-stb-sheettabmoveindicator";W.f_e="ewa-stb-tabs";W.m4j="tab-active";W.u4j="tab-inactive";W.t4j="tab-hover";W.uKh="ewa-stb-tabs-ghost";W.o4j="tab-anchor-text";W.dark="dark";W.light="light";W.n4j="tab-active-text";W.r4j="tab-content-container";
W.w4j="tab-text";W.mKh="ewa-stb-nsv-inactive-svg";W.lKh="ewa-stb-nsv-active-svg";W.UIh="ewa_nsv_margin";W.cKh="ewa-stb-disable-scrollbar";W.DMi="leave-size-fixed-on-tab-hover-old";W.CMi="leave-size-fixed-on-tab-hover";W.$Ze="ewa-stb-locked-sheet-svg-16px";W.dKh="ewa-stb-dropdown-menu-button";W.YEh="ewa-active-sheet-menu-item";Object(b.a)(W,"CssClassNames",null,[]);var Ga=a(764),pa=a(19),aa=a(272),Z=a(94),fa=a(200),ya=a(30),Aa=a(259),ja=a(48),za=a(297),ra=a(54),fb=a(13),Ua=a(76),Ca=a(1),Ia=a(278),
oa=a(12),Da=a(107),bb=a(358),Za=a(20),Xa=a(186),Ba=a(383),Wa=a(379),Na=a(49),ta=a(231),V=a(90);class ia extends Y.a{constructor(pb,nc,Wb=!1){super(pb);this.keb=this.rva=null;this.$=nc;this.iZ=Wb}get disabled(){return this.iZ}dispose(){this.keb=this.rva=this.$=null;super.dispose()}MT(pb){this.iZ=pb;this.domElement.setAttribute(t.a.cva,pb.toString());fb.DOMElementExtensions.toggleCssClass(this.domElement,Ga.a.zV,pb)}}Object(b.a)(ia,"SheetBarButton",Y.a,[]);var X=a(737);class la extends ia{constructor(pb,
nc,Wb,Ha=!1){super(document.createElement("a"),nc,Ha);this.Gd=$a=>{this.disabled||this.$.xd(-1935155518,$a.Wb,30,null);return!0};this.XJd=$a=>{$a="mouseover"===$a.type||"focus"===$a.type;const Nb=Ba.a(this.$)?this.keb:this.rva;oa.HelperMethods.Pog(Nb,la.Lja,la.Lja+t.a.Tsd,$a&&!Za.h(this.$).inRangePicker)};this.Ji=()=>{this.MT(!0)};this.Jg=()=>{Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)&&Za.h(this.$).cellTextEditBox.Eb||this.MT(!1)};this.rva=
Wb.Kb(this.domElement,J.a.instance.ha(509),0,la.Lja,J.a.instance.ha(510),X.a.T9c,Ha);pb.appendChild(this.domElement);this.od.la("contextmenu",$a=>{Ua.g($a)});ta.a.instance.ta(G.a.click,this.domElement,this.Gd);this.Ona=B.KeyInputManager.instance.Tu(this.domElement,this.Gd,V.a.Ai,V.a.NY);Za.h(this.$).cellTextEditBox.ao(this.Ji);Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)?Za.h(this.$).cellTextEditBox.s4b(this.Jg):Za.h(this.$).cellTextEditBox.Bm(this.Jg)}dispose(){ta.a.instance.Aa(G.a.click,
this.domElement,this.Gd);B.KeyInputManager.instance.ty(this.domElement,this.Ona);Za.h(this.$)&&Za.h(this.$).cellTextEditBox&&(Za.h(this.$).cellTextEditBox.Un(this.Ji),Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)?Za.h(this.$).cellTextEditBox.gSd(this.Jg):Za.h(this.$).cellTextEditBox.Qm(this.Jg));super.dispose()}MT(pb){const nc=la.Bgg(this.$);super.MT(pb||nc)}static Bgg(pb){return!pb.isEditMode||!pb.ua.count}}la.Lja=pa.a.Ggd;Object(b.a)(la,
"InsertSheetButton",ia,[]);class sa extends ia{constructor(pb,nc,Wb){super(document.createElement("a"),nc);this.Gd=Ha=>{this.$.xd(-684145703,Ha.Wb,0,null);return!0};this.XJd=Ha=>{oa.HelperMethods.Pog(this.ZFe,sa.Lja,sa.Lja+t.a.Tsd,("mouseover"===Ha.type||"focus"===Ha.type)&&!Za.h(this.$).inRangePicker)};this.$=nc;this.ZFe=Wb.Kb(this.domElement,J.a.instance.ha(511),0,sa.Lja,J.a.instance.ha(512),X.a.T9c);pb.appendChild(this.domElement);this.od.la("contextmenu",Ha=>{Ua.g(Ha)});this.od.la("mouseover",
this.XJd);this.od.la("mouseout",this.XJd);ta.a.instance.ta(G.a.click,this.domElement,this.Gd);this.Ona=B.KeyInputManager.instance.Tu(this.domElement,this.Gd,V.a.Ai,V.a.NY)}dispose(){ta.a.instance.Aa(G.a.click,this.domElement,this.Gd);B.KeyInputManager.instance.ty(this.domElement,this.Ona);this.ZFe=null;super.dispose()}}sa.Lja=pa.a.Ggd;Object(b.a)(sa,"InsertTemplateButton",ia,[]);class Va{constructor(pb,nc){this.sheetName=null;this.newSheetIndex=0;this.sheetName=pb;this.newSheetIndex=nc}getSheetName(){return this.sheetName}}
Object(b.a)(Va,"MacroRecorderSheetReorderedPayload",null,[139]);var nb=a(91);class ha extends Y.a{constructor(pb,nc){super(document.createElement("div"));this.VS=()=>{y.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.H5f(!1,"OnSheetsChanged")};this.S3i=()=>{this.mj()};this.R3i=()=>{this.oj()};this.$=pb;this.V4j=nc;this.cW=!1;this.cUb=0}dispose(){this.oj();super.dispose()}G7j(){this.H5f(!0,"TogglerSheetDropdownMenu")}H5f(pb,nc){y.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${nc}, toggle: ${pb}, toggleStateId: ${this.cUb}`);
pb&&(this.cUb+=1);const Wb=this.$.nc.qd("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${nc}, toggle: ${pb}, toggleStateId: ${this.cUb}, sheetCount: ${this.$.ua.count}`);pb=this.wrh();appChrome.renderSheetDropdownMenu(this.domElement,this.V4j,pb,this.cUb,this.S3i,this.R3i,()=>{Wb.stop()},Ba.a(this.$))}wrh(){const pb=this.$.ua,nc=[];for(let Ha=0;Ha<pb.count;Ha++){var Wb=Object(S.a)(Da.a,pb.getItem(Ha));0===Wb.ZC&&(Wb=this.vrh(Wb),nc.push(Wb))}return nc}vrh(pb){const nc={};nc.key=
pb.name;nc.text=pb.name;nc.onClick=this.xrh(pb);pb.active&&(nc.className=Ba.a(this.$)?"ewa-active-sheet-menu-item-present-mode":W.YEh);return nc}xrh(pb){return()=>{const nc=new nb.a(-1876836819,0,this.$.Kc,30,null);this.$.Ia.$b(nc,{[t.a.EZd]:pb.name})}}mj(){if(!this.cW){const pb=this.$.ua;pb.Lg(this.VS);pb.g2c(this.VS);pb.UZ(this.VS);pb.eja(this.VS);pb.YIa(this.VS);pb.hye(this.VS);pb.l1a(this.VS);this.cW=!0}}oj(){if(this.cW){const pb=this.$.ua;pb.ih(this.VS);pb.bSd(this.VS);pb.u9(this.VS);pb.Epa(this.VS);
pb.XTa(this.VS);pb.I4f(this.VS);pb.AOb(this.VS);this.cW=!1}}}Object(b.a)(ha,"SheetDropdownMenu",Y.a,[435,2]);var jb=a(362);class Fb extends ia{constructor(pb,nc,Wb){super(document.createElement("a"),pb,!0);this.Ig=()=>{this.MT(!1);this.$.ea.Pm(this.Ig)};this.Gd=Ha=>{this.Qog(Ha.Wb);return!0};this.onKeyDown=Ha=>13===Ha.Da.keyCode||32===Ha.Da.keyCode?(this.Qog(Ha.Wb),!0):!1;this.rva=nc.Kb(this.domElement,J.a.instance.ha(513),0,pa.a.aKh,J.a.instance.ha(513),X.a.Fji,this.disabled);this.domElement.classList.add(W.dKh);
Wb.appendChild(this.domElement);this.ECh();this.ttj()}dispose(){this.Kbk();super.dispose()}MT(pb){super.MT(pb||!this.$.ea.jna)}ECh(){const pb=this.$.ea;pb.Of?this.MT(!1):pb.nk(this.Ig)}Qog(pb){this.disabled||(y.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${jb.a[pb]}`),this.$.Ia.$b(new nb.a(1243860697,pb,this.$.Kc,30,null)))}ttj(){ta.a.instance.ta(G.a.click,this.domElement,this.Gd);B.KeyInputManager.instance.ta(G.a.yc,this.domElement,this.onKeyDown)}Kbk(){ta.a.instance.Aa(G.a.click,
this.domElement,this.Gd);B.KeyInputManager.instance.Aa(G.a.yc,this.domElement,this.onKeyDown)}}Object(b.a)(Fb,"SheetDropdownMenuAnchor",ia,[]);var Rb=a(58);const mb=(pb,nc,Wb,Ha,$a,Nb,rb,ec=null)=>{ec=pb.Pa(9,ec);ec.sheetName=nc;ec.newSheetIndex=Wb;return Rb.g(pb,"ReorderSheets",ec,Ha,$a,Nb,rb,0)};var sb=a(188),Ya=a(144),Ma=a(199),xb=a(136),qb=a(63),Ra=a(216),Jb=a(207),yb=a(181),Gb=a(137);class ub{constructor(pb){this.sheet=pb;this.altText=J.a.instance.ha(1994)}eX(){return this.sheet.active}hxd(){return this.sheet.isLockPausedInSession}Uqa(){return this.sheet.$h?
X.a.TYf:X.a.wbk}X2d(){return 16}Dva(){return null}Eva(){return W.$Ze}D4d(){return null}Ut(){return null}P3c(){return!0}}Object(b.a)(ub,"LockPausedSheetIconDataSource",null,[442]);class Ja{constructor(pb){this.sheet=pb;this.altText=J.a.instance.ha(1993)}eX(){return this.sheet.active}hxd(){return this.sheet.$h}Uqa(){return X.a.TYf}X2d(){return 16}Dva(){return null}Eva(){return W.$Ze}D4d(){return null}Ut(){return null}P3c(){return!0}}Object(b.a)(Ja,"LockedSheetIconDataSource",null,[442]);class zb{constructor(pb,
nc,Wb){this.sheet=pb;this.altText=J.a.instance.ha(1908);this.V7j=nc;this.xWj=Wb}eX(){return this.sheet.active}hxd(){return this.sheet.Pe.rC}Dva(){return this.eX()?W.lKh:W.mKh}Uqa(){return!this.eX()&&this.xWj()?X.a.USj:X.a.TSj}X2d(){return 14}Eva(){return W.UIh}D4d(){return this.sheet.Pe.prb}Ut(){return this.V7j}P3c(){return!1}}Object(b.a)(zb,"NamedSeetViewSheetIconDataSource",null,[442]);var na=a(170),Ea=a(141);class ma{constructor(pb,nc){this.GUc=this.B3=this.aEa=this.hq=null;this.itf=!1;this.qZc=
this.Uqa=this.Eva=this.Dva=null;this.VO=()=>{this.dataSource.eX()&&d.TaskExtensions.za(this.dzf,()=>{dialogControls.renderToolTip(this.dataSource.Ut(),"SheetIconTooltip",this.dataSource.D4d(),this.ET,10,!1,!1,1)},this.$.ka,3)};this.UO=()=>{this.dataSource.eX()&&this.clearToolTip()};this.$=pb;this.dataSource=nc}get od(){return this.B3||(this.B3=Ea.a.instance.He(this.ET))}get dzf(){if(this.GUc)return this.GUc;const pb=new na.a;this.$.wA(nc=>{d.TaskExtensions.za(nc.Oyf(),()=>{pb.setResult(!0)},this.$.ka,
3)});return this.GUc=pb.task}get ET(){return this.qZc}rtg(){if(this.ET&&(this.hq||this.aEa)){var pb=this.dataSource.Uqa();this.Uqa!==pb&&(this.aEa&&this.aEa.parentNode.removeChild(this.aEa),this.Xmf(),this.Uqa=pb);pb=this.dataSource.Dva();this.Dva!==pb&&(this.AAj(this.aEa,this.Dva,pb),this.Dva=pb);pb=this.dataSource.Eva();this.Eva!==pb&&(this.zAj(this.ET,this.Eva,pb),this.Eva=pb);this.dataSource.Ut()&&!this.dataSource.eX()&&this.clearToolTip()}}RXj(pb,nc,Wb){this.Uui(pb,nc,Wb);fb.DOMElementExtensions.setVisible(this.ET,
this.dataSource.hxd())}clearToolTip(){d.TaskExtensions.za(this.dzf,()=>{dialogControls.clearToolTip(this.dataSource.Ut())},this.$.ka,3)}Uui(pb,nc,Wb){this.ET&&this.itf!==pb&&(this.ET.parentNode.removeChild(this.ET),this.Eva=this.Dva=this.Uqa=this.qZc=null,this.dataSource.Ut()&&(this.od.detach("mouseover",!0),this.od.detach("mouseout",!0)));this.ET||(this.qZc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.ET,Ga.a.xka),Sys.UI.DomElement.addCssClass(this.ET,pa.a.VB),pb===this.dataSource.P3c()?
nc.appendChild(this.ET):nc.insertBefore(this.ET,Wb),this.Xmf(),this.dataSource.Ut()&&(this.od.la("mouseover",this.VO,!0),this.od.la("mouseout",this.UO,!0)),this.itf=pb)}AAj(pb,nc,Wb){pb&&(Sys.UI.DomElement.removeCssClass(pb,nc),Sys.UI.DomElement.addCssClass(pb,Wb))}zAj(pb,nc,Wb){nc&&Sys.UI.DomElement.removeCssClass(pb,nc);Wb&&Sys.UI.DomElement.addCssClass(pb,Wb)}dispose(){F.a.Ka(this.B3)}Xmf(){const pb=this.$.da.Ba(388);pb?(this.aEa=pb.sma(this.dataSource.Uqa(),this.dataSource.X2d()))?this.ET.appendChild(this.aEa):
y.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Uqa()} was not found.`):y.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(b.a)(ma,"SheetIcon",null,[2]);var Ka=a(364),cb=a(101),Fa=a(167);class wa extends cb.a{constructor(pb,nc){super(pb.domElement);this.onKeyDown=Wb=>{121===Wb.keyCode&&Wb.shiftKey&&!this.wqa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.wqa.anchor),
Ua.g(Wb))};this.Wea=Wb=>{if(!this.$.isEditMode||this.wqa.disabled)return!0;this.rename(!1,Wb.Wb);return!0};this.Lm=Wb=>this.wqa.disabled?!0:this.showContextMenu(Wb.clientPoint,Wb.Wb,Wb.tc);this.are=pb;this.$=nc;ta.a.instance.ta(G.a.dl,pb.domElement,this.Wea);Ka.a.instance.ta(pb.domElement,this.Lm);this.od.la("keydown",this.onKeyDown)}get wqa(){return this.are}dispose(){this.wqa&&(ta.a.instance.Aa(G.a.dl,this.wqa.domElement,this.Wea),Ka.a.instance.Aa(this.wqa.domElement,this.Lm),this.are=null);this.$=
null;super.dispose()}showContextMenu(pb,nc,Wb){this.wqa.activate(nc,ya.a.Ruf());nc=new nb.a(-1075099431,nc,this.$.Kc,30,null);let Ha;return!Fa.a(Ha=this.$.Ia.$b(nc,{[t.a.Yfg]:pb,[wa.KSj]:this.wqa.sheet,[t.a.Zfg]:Wb}))&&(6!==Ha.status||Ha.result)}rename(pb,nc){this.$.xd(817296323,nc,pb?19:0,null)}}wa.KSj="Sheet";Object(b.a)(wa,"SheetOpsSheetClickHelper",cb.a,[]);var ka=a(43),Oa=a(60),hb=a(100);class Pa extends ia{constructor(pb,nc,Wb,Ha,$a){super(document.createElement("li"),pb);this.ISj=100;this.JSj=
500;this.tLe=this.sLe=0;this.cRe=.5;this.cW=this.CZd=!1;this.color=this.hPc=this.UK=this.uJb=this.cQ=null;this.qoc=this.Yrf=!1;this.Jac="#BEBBB8";this.FMc=null;this.onKeyDown=Nb=>13!==Nb.Da.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.TA=Nb=>32!==Nb.Da.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.VO=()=>{this.disabled||this.A2.uS||this.mqa(!0,void 0,"OnMouseOver")};this.UO=()=>{this.disabled||this.mqa(!1,void 0,"OnMouseOut")};this.ZKb=()=>{this.A2.uS||(this.s1j(),Object(Oa.c)(this.sheet.sheetProcessedData)||
Za.h(this.$).Jpa(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.G8=()=>{this.dXe(!1);return!1};this.Gd=Nb=>{if(this.disabled)return!0;const rb=Za.h(this.$);this.sheet.active||3!==Nb.Wb||!ya.a.wQa()&&!this.LGb||rb.Eb||rb.Wi||rb.zxb();this.activateSheet(Nb.Wb);return 3!==Nb.Wb};this.onPointerDown=Nb=>{if(this.disabled)return!0;this.dXe(!0);Za.h(this.$).inRangePicker&&y.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var rb=3===Nb.Wb;if(2===Nb.Wb||rb&&this.Nza)this.mqa(!0,!rb,"OnPointerDown"),rb=l.Task.delay(rb?this.JSj:this.ISj).Xp(()=>!0),this.dGb&&(this.qoc=!0,this.A2.zAc=d.TaskExtensions.za(rb,()=>{this.qoc&&this.A2.Mbj(this,Nb)},this.ka,11));return!1};this.Mh=Nb=>{if(this.disabled||!this.dGb&&Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.qoc=!1;this.mqa(2===Nb.Wb,void 0,"OnPointerUp");this.A2.zAc&&(d.TaskExtensions.za(this.A2.zAc,()=>{this.A2.Lbj()},
this.ka,11),this.A2.zAc=null);return!1};this.ZO=()=>{this.qoc=!1;this.CZd||this.mqa(!1,void 0,"OnTouchMove");return!1};this.iKe=new wa(this,pb);this.LGb=ya.a.LGb();this.sLe=18;this.tLe=20;this.$=pb;this.D1b=Ha;this.A2=$a;this.dGb=$a.aAe();this.Grh();this.Dlh();this.Ssd=pb.nc.hh("UserAction",this.name);this.gxd=!1;fb.DOMElementExtensions.py(this.domElement,t.a.ps,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.UK);this.uqa=new Ma.a;pb=new Ja(this.sheet);this.uqa.add(new ma(this.$,
pb));this.$.ea.HRb&&(pb=new ub(this.sheet),this.uqa.add(new ma(this.$,pb)));pb=new zb(this.sheet,this.A2.iEc,()=>this.color?Pa.K_d(this.color):!1);this.uJb=new ma(this.$,pb);this.uqa.add(this.uJb);this.Nza=this.A2.Nza;this.ekb();this.Puj();this.dFe=new za.a(this.domElement,1);nc.insertBefore(this.domElement,Wb);Ba.a(this.$)&&this.mug(!0)}get avh(){return this.hPc||(this.hPc=Jb.a.aq("#F5F5F5"))}get name(){return this.cQ.innerText}set name(pb){this.cQ&&(this.cQ.innerText=pb,this.$Ic(),this.nug())}get sheet(){return this.D1b}get anchor(){return this.FMc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(pb){this.anchor.tabIndex=
pb}i6h(){return fb.DOMElementExtensions.sg(this.anchor)?this.anchor:null}dispose(){if(this.cW){M.a.instance.Aa(G.a.pointerDown,this.domElement,this.onPointerDown);B.KeyInputManager.instance.Aa(G.a.yc,this.domElement,this.onKeyDown);B.KeyInputManager.instance.Aa(G.a.jq,this.domElement,this.TA);ta.a.instance.Aa(G.a.click,this.domElement,this.Gd);M.a.instance.Aa(G.a.KX,this.domElement,this.ZKb);M.a.instance.Aa(G.a.LC,this.domElement,this.G8);if(this.dGb||Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))M.a.instance.Aa(G.a.Pg,
this.domElement,this.Mh),this.Nza&&(P.a.instance.Aa(G.a.$e,this.domElement,this.Mh),P.a.instance.Aa(G.a.Zg,this.domElement,this.ZO));this.cW=!1;this.Jac="#BEBBB8"}F.a.Rc([this.iKe,this.dFe]);this.cQ=this.UK=this.FMc=this.A2=this.dFe=this.iKe=null;if(this.uqa){for(let pb of this.uqa)pb.dispose();this.uqa=null}this.color=this.D1b=null;super.dispose()}MT(pb){pb&&this.mqa(!1,!1);super.MT(pb)}Big(pb){if(qb.a.eh.tS){this.aUe();var nc=Object(n.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(hb.d)(v.a.resolve(x.Z,
{Wa:1})):e.GetServiceTaskFactory.Za(this.$.da,322,323,1);d.TaskExtensions.za(nc,Wb=>{sb.UISurfaces.HI().then(Ha=>{const $a=Wb.result;$a.LOj(Ha);$a.show(pb);return null},Ha=>{y.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Ha}`);return null})},this.ka,3)}}qUg(){if(this.sheet.active&&this.$.zq){var pb=this.$.zq,nc=Za.h(this.$),Wb=nc.gk;if(this.sheet.Pe.rC){if(!this.uJb){const Ha=new zb(this.sheet,this.A2.iEc,()=>this.color?Pa.K_d(this.color):
!1);this.uJb=new ma(this.$,Ha);this.uqa.add(this.uJb)}Wb&&nc.Sjb(1);pb.classList.add(pa.a.p1e);pb=Pa.Bbf(t.a.uFf);nc=Pa.Bbf(t.a.uGd);"true"===pb&&"true"===nc?this.$.ea.y_d&&this.$.ea.aSb&&(this.sheet.Pe.wO?(pb=1,Ya.a.Qt(t.a.uGd,"false",Ya.a.m1),this.$.ea.aSb=!1):pb=0,Ya.a.Qt(t.a.uFf,"false",Ya.a.m1),this.$.ea.y_d=!1,this.Big(pb)):this.sheet.Pe.wO&&"true"===nc&&this.$.ea.aSb&&(Ya.a.Qt(t.a.uGd,"false",Ya.a.m1),this.$.ea.aSb=!1,this.Big(2))}else this.aUe(),Wb&&nc.Sjb(0),pb.classList.remove(pa.a.p1e)}}aUe(){const pb=
Object(n.a)({Rea:322,new:x.Z,registry:this.$.da,jR:"OfficeVSO:7629405_namedSheetViewPublic_Migration"});pb&&pb.dismiss()}ekb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.D$a()?W.m4j:W.u4j;Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.cQ.parentNode.classList.add(W.CMi):this.cQ.parentNode.classList.add(W.DMi);this.nug();this.SXj();this.uug();this.$Ic();this.qUg()}Kbj(){this.CZd=!0;this.mqa(!0,!0,"OnSheetReorderStarted")}Jbj(){this.CZd=
!1;this.mqa(!1,void 0,"OnSheetReorderEnded")}activate(pb=0,nc=!1){this.y8b()||(this.sheet.activate(),nc&&Za.h(this.$).focus(),pb={["InputMethod"]:jb.a[pb],["AppMode"]:this.$.Kc,["Location"]:"canvas"},Gb.b(this.$).Ld(xb.a.FSj,pb))}mug(pb){this.Jac=pb?"#797775":"#BEBBB8";this.cRe=pb?-.5:.5;this.hPc=pb?Jb.a.aq("#3B3A39"):Jb.a.aq("#F5F5F5");this.uug()}qLj(pb){this.dGb=pb}WId(pb){pb.i$c();this.yIe(pb)}yIe(pb){pb.$3a();this.sheet.activate()}yRg(pb){pb=new nb.a(-1876836819,pb,this.$.Kc,30,null);return this.$.Ia.$b(pb,
{[t.a.EZd]:this.sheet.name})}nug(){this.cQ.parentNode.setAttribute("sheet-title",this.cQ.innerText)}$Ic(){const pb=this.H_h();this.anchor.setAttribute(t.a.ov,pb);this.anchor.setAttribute(t.a.yba,this.sheet.active.toString())}H_h(){const pb=this.sheet.Pe.rC,nc=this.sheet.Pe.prb,Wb=this.sheet.$h,Ha=this.sheet.isLockPausedInSession;return pb&&Wb?String.format(J.a.instance.Lb(20),this.name,nc):pb&&Ha?String.format(J.a.instance.Lb(22),this.name,nc):pb?String.format(J.a.instance.Lb(19),this.name,nc):Wb?
String.format(J.a.instance.Lb(18),this.name):Ha?String.format(J.a.instance.Lb(21),this.name):this.name}activateSheet(pb=0){if(ya.a.Ruf()){if(Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.y8b())return l.Task.Ua(!1);yb.a.current.AP="ActivateSheet";this.sheet.activate();return l.Task.Ua(!0)}return this.yRg(pb)}uug(){const pb=this.sheet.tabColor;this.color=pb?Jb.a.aq(pb):this.avh;this.Yrf=Pa.K_d(this.color);this.mqa(!1,void 0,"UpdateTabColor")}mqa(pb,nc=
!1,Wb=null){if(this.sheet){Wb=this.sheet.active;var Ha=this.D$a(),$a=!!this.sheet.tabColor,Nb=Jb.a.YJ(Wb||Ha?Ra.a.white:this.color);this.UK.style.background="";Wb||Ha?($a&&(Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.JOa?this.AQj():this.zQj()),this.UK.style.height=this.sLe.toString()+"px"):(this.UK.style.filter="",this.UK.style.backgroundColor=Nb,this.UK.style.height=this.tLe.toString()+"px");this.cQ.className=Wb?W.n4j:Ha?W.dark:this.Yrf?W.light:
W.dark;for(let rb of this.uqa)rb.rtg();pb&&!$a&&(this.UK.style.backgroundColor="#E1DFDD");fb.DOMElementExtensions.toggleCssClass(this.domElement,W.t4j,pb);nc?($a||(this.UK.style.backgroundColor=this.Jac),this.domElement.style.backgroundColor=this.Jac):($a||(this.UK.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.cQ.style.fontWeight=Wb||Ha?"600":""}else y.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Wb}`)}zQj(){const pb=
this.UK.style,nc=Jb.a.YJ(Pa.lch(this.color,this.cRe));pb.background=nc}AQj(){this.UK.style.background="transparent"}Dlh(){this.FMc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=W.o4j;fb.DOMElementExtensions.py(this.anchor,t.a.gtb,null,null);this.tabIndex=-1}Grh(){this.UK=document.createElement("span");this.UK.className=W.r4j;this.cQ=document.createElement("span");this.cQ.className=W.w4j;this.cQ.dir=this.sheet.rtlName?"rtl":"ltr";this.UK.appendChild(this.cQ)}SXj(){const pb=
this.$.hN;for(let nc of this.uqa)nc.RXj(pb,this.UK,this.cQ)}D$a(){return Za.h(this.$).D$a(this.sheet)}s1j(){this.Ssd.start();this.gxd=!0}dXe(pb){this.gxd&&(this.Ssd.stop(),y.ULS.sendTraceTag(537153686,0,50,ka.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Ssd.fd,["Has been clicked"]:pb})),this.gxd=!1)}Puj(){M.a.instance.ta(G.a.pointerDown,this.domElement,this.onPointerDown);B.KeyInputManager.instance.ta(G.a.yc,this.domElement,this.onKeyDown);B.KeyInputManager.instance.ta(G.a.jq,
this.domElement,this.TA);this.od.la("mouseover",this.VO);this.od.la("mouseout",this.UO);M.a.instance.ta(G.a.KX,this.domElement,this.ZKb);M.a.instance.ta(G.a.LC,this.domElement,this.G8);if(this.dGb||Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))M.a.instance.ta(G.a.Pg,this.domElement,this.Mh),this.Nza&&(P.a.instance.ta(G.a.$e,this.domElement,this.Mh),P.a.instance.ta(G.a.Zg,this.domElement,this.ZO));ta.a.instance.ta(G.a.click,this.domElement,this.Gd);this.cW=
!0}y8b(){const pb=this.$.da.Ba(65);return pb&&pb.kna()?(pb.SBc(),this.yIe(pb),!0):!1}static Bbf(pb){let nc=Ya.a.get(pb);nc||(Ya.a.Qt(pb,"true",Ya.a.m1),nc=Ya.a.get(pb));return nc}static lch(pb,nc){if(1<nc||-1>nc)return pb;let Wb=pb.r,Ha=pb.g;pb=pb.b;0<nc?(Wb=Wb*(1-nc)+255*nc,Ha=Ha*(1-nc)+255*nc,pb=pb*(1-nc)+255*nc):(Wb*=1+nc,Ha*=1+nc,pb*=1+nc);return Ra.a.Tzb(Math.round(Wb),Math.round(Ha),Math.round(pb))}static K_d(pb){return 128>=(222*pb.r+707*pb.g+71*pb.b)/1E3}}Object(b.a)(Pa,"SheetTabButton",ia,
[]);class ca extends ia{constructor(pb,nc,Wb){super(document.createElement("a"),nc);this.Lja=pa.a.Ggd;Wb.Kb(this.domElement,J.a.instance.ha(713),0,this.Lja,J.a.instance.ha(713),X.a.T9c,!0);pb.appendChild(this.domElement);this.od.la("contextmenu",Ha=>{Ua.g(Ha)})}}Object(b.a)(ca,"WorkbookProtectionButton",ia,[]);var ba=a(55),ib=a(44),Lb=a(64);class gc extends Y.a{constructor(pb,nc,Wb=null){super(nc);this.sheetTabActivatePreviousHidden=J.a.instance.ha(722);this.sheetTabActivateNextHidden=J.a.instance.ha(724);
this.svgIconProvider=null;this.ei=[];this.FO=Array(6);this.DGd=Array(6);this.vVa=this.TDb=this.lS=this.Chb=this.KZd=this.JZd=this.wn=null;this.isRtl=!1;this.kX=this.sA=0;this.xcc=this.yAc=!1;this.ixc=this.Upa=0;this.IN=this.V5=this.Kca=this.Hcc=null;this.hjc=this.qE=0;this.qTb=null;this.hHb=-1;this.H5=null;this.pwc=0;this.bGc=-1;this.opa=0;this.ywa=new R;this.sTc=!1;this.zAc=this.mEc=this.IRb=this.Zqe=this.q1=null;this.aje=!1;this.Yqe=null;this.PE=(Ha,$a)=>{this.vRf($a.item)};this.JBa=(Ha,$a)=>{Ha=
this.$.ua.na.index;for(let Nb=0,rb=this.ei.length;Nb<rb;Nb++){const ec=this.xW(Nb);if(ec.name===$a.oldName){ec.name=$a.newName;this.Y1();Nb===Ha&&this.hga(6);break}}};this.zRf=(Ha,$a)=>{(Ha=this.fzb($a.item))&&Ha.ekb()};this.ARf=(Ha,$a)=>{$a.visible?(this.oVa(!1),this.wRf($a.item)):this.vRf($a.item)};this.A8=Ha=>{this.uS?(this.H5=Ha,this.JUb()):(this.H5&&(this.ixc+=this.H5.clientPoint.x-Ha.clientPoint.x),this.H5=Ha,Math.abs(this.ixc)>=this.rAh&&this.JUb());return!0};this.ZO=Ha=>{Ha.Da.preventDefault();
return!1};this.mag=Ha=>{this.jag(Ha,!0)};this.lag=Ha=>{this.jag(Ha,!1)};this.B8=Ha=>{if(this.uS){this.xcc=this.sBi(Ha);let $a;Ha=($a=this.xW(this.qE+1))?$a.sheet:null;this.reorderSheets(Ha,this.qE+1===this.HZd,!0)}this.XV();return!0};this.ik=(Ha,$a)=>{$a.PC&&this.v7d($a.PC);this.qDc(!1);this.Y1();$a.na&&(this.v7d($a.na),this.hga(6),this.ea.Yoa())};this.NHf=(Ha,$a)=>{this.WJc($a.item)};this.OHf=(Ha,$a)=>{this.WJc($a.item)};this.PHf=(Ha,$a)=>{this.WJc($a.item)};this.eSa=(Ha,$a)=>{this.WJc($a.item)};
this.rBa=()=>{this.J8c()};this.Td=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.J8c();this.Cbd();if(Lb.d(this.$)||Lb.e(this.$))ib.PageLoadTrackingInfo.instance.cY(t.a.EDa,["sheetTabBar"]),ib.PageLoadTrackingInfo.instance.bY(t.a.EDa,["sheetTabBar"]);this.kbd();this.Y1();this.oVa(!0);this.hga(6)};this.Cj=()=>{this.isVisible&&(this.Y1(),this.hga(6))};this.fg=()=>{Object(I.a)(la,this.lS)===Z.m(this.$.tf)&&this.kbd();for(const Ha of this.ei)Ha.qLj(!Z.m(this.$.tf))};this.yRf=(Ha,$a)=>{this.qAj($a.item,
$a.isUserOperation)};this.qLb=(Ha,$a)=>{this.wRf($a.item)};this.onKeyDown=Ha=>{switch(Ha.keyCode){case 9:var $a=this.domElement.querySelectorAll(fb.DOMElementExtensions.Er);const Nb=fb.DOMElementExtensions.nm($a);$a=fb.DOMElementExtensions.iC($a);fb.DOMElementExtensions.vDa(Ha,Nb,$a);break;case 39:case 37:fb.DOMElementExtensions.odg(Ha,this.domElement.querySelectorAll(fb.DOMElementExtensions.Er),39===Ha.keyCode?!this.isRtl:this.isRtl)}y.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${Ha.keyCode}`)};
this.onScroll=()=>{this.wn.scrollLeft!==this.Upa&&this.Z5j()};this.XO=Ha=>{if(Ha.ctrlKey||Ha.n5)return!1;this.wn.scrollLeft+=Math.floor(30*Ha.Ora);if(this.uS){const $a=this.W$e("OnMouseWheel");$a&&this.$2d(0<Ha.Ora,$a.x+$a.width/2)}return!0};this.WG=(Ha,$a)=>{if(this.ywa)this.bif("PartialInteractivity",$a.fN?3:0);else{this.XV(!1);this.lYd($a.fN);for(const Nb of this.YDe)Nb&&Nb.MT($a.fN);for(const Nb of this.ei)Nb&&Nb.MT($a.fN)}};this.zKb=(Ha,$a)=>{Ha=0;$a.Vue&&(Ha=2|($a.LSj?1:0));this.bif("ComponentRangePicker",
Ha)};this.$=pb;this.ea=this.$.ea;this.Pcc=!Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.wuf=!this.$.Iv;this.aje=!z.a.Px;this.hDi=Ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.GXi=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.FXi=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.rAh=this.$.xa.SheetTabDragStartPixelThreshold;this.WSa=this.XSa=-1;this.G$c=!1;this.svgIconProvider=
Wb;this.JD=new za.a(this.domElement,3);this.domElement.classList.add(W.vKh);this.nph();this.Tmh();this.oph();Ca.EwaSettings.rO()&&document.getElementById(t.a.wda)||this.tqh();this.qDc(!0);this.Td(null,null);pb=this.$.ua;pb.Lg(this.ik);pb.g2c(this.rBa);pb.UZ(this.PE);pb.eja(this.qLb);pb.YIa(this.JBa);pb.hye(this.yRf);pb.l1a(this.ARf);pb.mXg(this.zRf);pb.t2c(this.NHf);pb.eye(this.OHf);pb.fye(this.PHf);pb.gye(this.eSa);this.$.Ql(this.Td);this.$.dA(this.Cj);aa.a(this.$).Pi(this);this.$.da.Ja(32,this);
Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.nv(this.fg);this.lEc=this.Ze.He(this.domElement);this.lEc.la("keydown",this.onKeyDown);Na.a(this.$).Qq()&&this.WG(null,new Wa.a(!0));Na.a(this.$).yg.dba(this.WG);Za.h(this.$).Bxe(this.zKb);this.lEc.la("mousedown",Ha=>{Ha.preventDefault()});E.a.instance.ta(G.a.FE,this.domElement,this.XO);this.IZd=this.Ze.He(this.wn);this.IZd.la("scroll",this.onScroll);this.Z5j=Ia.b(()=>{this.Y1()},200,this.$.ka,ja.a.RSj,
!0);this.$.kC(t.a.YZj);this.wuf&&(this.Yqe=new ha(this.$,this.vVa.domElement));ib.PageLoadTrackingInfo.instance.d2(t.a.EDa,["sheetTabBar"])}get Lc(){return this.domElement}get sg(){return this.isVisible}get Ge(){return Aa.a.GZd}get uS(){return this.sTc}get HZd(){return this.ei.length}get iEc(){return this.Zqe}get Nza(){return this.aje}get navigationButtonsDisabled(){return!!this.ywa&&this.ywa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.ywa&&this.ywa.operationButtonsDisabled}get SXi(){return this.$.hN?
[pa.a.YZe,pa.a.b_e,pa.a.c_e,pa.a.XZe,pa.a.Rdc,pa.a.Rdc]:[pa.a.XZe,pa.a.c_e,pa.a.b_e,pa.a.YZe,pa.a.Rdc,pa.a.Rdc]}get EGd(){return this.$.hN?[null,X.a.bMe,X.a.$Le]:[null,X.a.$Le,X.a.bMe]}get oXf(){return this.$.hN?[null,X.a.cMe,X.a.aMe]:[null,X.a.aMe,X.a.cMe]}get LHb(){if(this.isRtl){if(z.a.IG)return 0;if(z.a.ng)return-1*(this.wn.scrollWidth-this.wn.clientWidth);if(z.a.Px)return this.wn.scrollWidth-this.wn.clientWidth;y.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get FPb(){if(this.isRtl){if(z.a.IG)return this.wn.scrollWidth-
this.wn.clientWidth;if(z.a.ng||z.a.Px)return 0;y.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.wn.scrollWidth-this.wn.clientWidth}get YDe(){return this.ywa?[this.lS,this.TDb]:[this.lS,this.TDb,this.vVa]}get v4j(){return this.ei.concat(this.vVa)}get Wfg(){return this.Yqe}Kb(pb,nc,Wb,Ha,$a,Nb,rb=!1){pb.removeAttribute("Href");pb.setAttribute(t.a.fe,t.a.qu);pb.className=W.kKh;pb.title=nc;pb.tabIndex=0;Nb?Wb=this.svgIconProvider.Lda(Nb,12,12,pb,
24,24):(nc=document.createElement("span"),nc.className=pa.a.cfh,nc.classList.add(Ga.a.xka),nc.tabIndex=-1,pb.appendChild(nc),Nb=document.createElement("img"),Nb.src=ra.a.dg(Wb),Nb.className=Ha,Nb.alt=$a,Nb.tabIndex=-1,nc.appendChild(Nb),Wb=Nb);rb&&pb.classList.add(Ga.a.zV);return Wb}dispose(){if(this.$){var pb=this.$.ua;pb.ih(this.ik);pb.bSd(this.rBa);pb.u9(this.PE);pb.Epa(this.qLb);pb.XTa(this.JBa);pb.I4f(this.yRf);pb.AOb(this.ARf);pb.myj(this.zRf);pb.qSd(this.NHf);pb.F4f(this.OHf);pb.G4f(this.PHf);
pb.H4f(this.eSa);this.$.Rm(this.Td);this.$.UC(this.Cj);Na.a(this.$)&&Na.a(this.$).yg.Tfa(this.WG);this.ywa&&Za.h(this.$).g4f(this.zKb);E.a.instance.Aa(G.a.FE,this.domElement,this.XO)}F.a.Rc(this.DGd);this.DGd=null;if(this.FO)for(pb=0;pb<this.FO.length;pb++){const nc=fb.DOMElementExtensions.tL(this.FO[pb],this.domElement,!1,"a");nc&&O.a.zpa(nc)}F.a.Ka(this.JD);F.a.Ka(this.lEc);F.a.Ka(this.IZd);this.IZd=this.lEc=this.TDb=this.lS=this.JD=null;this.$&&this.XV(!1);this.Kca=null;this.GXd(null,"Dispose");
this.qTb=this.IN=this.Hcc=null;this.J8c();this.Chb=this.KZd=this.JZd=this.wn=this.FO=this.$=this.ea=null;super.dispose()}Qg(pb,nc){if(!nc){y.ULS.shipAssertTag(537153760,0,0<this.ei.length,"There is no sheet tab button.");if(!this.ei.length)return!1;pb=null;for(const Wb of this.ei)if(pb=Wb.i6h())break;if(!pb)return y.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;fb.DOMElementExtensions.setFocus(pb)}return!nc}hi(pb){return fb.DOMElementExtensions.lg(this.Lc,pb)}ek(){}Gk(){}reorderSheets(pb,
nc,Wb){if(this.q1&&this.q1!==pb){const Ha=this.q1.index;this.pAj(this.q1,pb,nc);pb=pb?pb.index-1:nc?this.$.ua.count-1:0;Ha!==pb&&(this.iRi(Ha,pb,Wb),this.mDh(this.q1.name,pb))}}Rhi(pb){pb=this.qla(pb);return-1!==pb&&this.sA<=pb&&pb<=this.kX?this.ei[pb].domElement:null}ngk(pb){for(var nc=0;nc<this.FO.length;nc++){const Wb=this.FO[nc];if(Wb&&this.svgIconProvider){const Ha=Wb.parentNode;this.L3f(Wb);Ha&&(this.FO[nc]=this.svgIconProvider.Lda(pb?this.oXf[nc]:this.EGd[nc],12,12,Ha,24,24))}}for(nc=0;nc<
this.ei.length;nc++)this.ei[nc].mug(pb);this.vVa&&this.vVa.rva&&this.lug(X.a.Gji,this.vVa,pb);this.lS&&this.lS.rva&&this.lug(X.a.mhh,this.lS,pb)}lug(pb,nc,Wb){nc.keb||(nc.keb=this.svgIconProvider.Lda(pb,12,12,nc.rva.parentNode,24,24));nc.keb&&(fb.DOMElementExtensions.setVisible(nc.rva,!Wb),fb.DOMElementExtensions.setVisible(nc.keb,Wb))}Mbj(pb,nc){var Wb=Za.h(this.$);const Ha=Wb.inRangePicker,$a=oa.HelperMethods.qp(nc);if(Wb.Eb&&!Ha){const Nb=Wb.tm?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";
let rb=void 0;Ca.EwaSettings.F$a&&(rb=[Object(Xa.a)(Wb.cellTextEditBox.textBox.iEa)]);Xa.b(this.$).AEa($a.rawEvent,Nb,rb);Wb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Wb=this.Nza&&3===nc.Wb;!(2===nc.Wb&&$a.button===Sys.UI.MouseButton.leftButton||Wb)||Ha||this.uS||Na.a(this.$).Qq()||(Wb&&pb.Kbj(),this.hHb=nc.clientPoint.x,this.H5=nc,this.$4g(pb))}Lbj(){this.Y1()}aAe(){return this.$.isEditMode&&!Z.m(this.$.tf)}Y1(){const pb=oa.HelperMethods.LS(()=>{this.eek();this.eQj();this.lYd()});y.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${pb}`)}eQj(){const pb=this.kX===this.ei.length-1;fb.DOMElementExtensions.toggleCssClass(this.Chb,this.$.hN?W.d_e:W.ZZe,!!this.sA);fb.DOMElementExtensions.toggleCssClass(this.Chb,this.$.hN?W.ZZe:W.d_e,!pb)}lYd(pb=!1){const nc=!this.sA,Wb=this.kX===this.ei.length-1;this.Udg(4,this.sheetTabActivatePreviousHidden,!nc);this.Udg(5,this.sheetTabActivateNextHidden,!Wb);this.FDc(0,nc||pb);this.FDc(1,nc||pb);this.FDc(2,Wb||pb);this.FDc(3,
Wb||pb)}Udg(pb,nc,Wb){if(pb=this.FO[pb]){fb.DOMElementExtensions.setVisible(pb,Wb);var Ha=this.Gbf(pb);Ha.title="img"===pb.nodeName?pb.alt=0<this.ei.length&&Wb?nc:"":pb.title=0<this.ei.length&&Wb?nc:"";Ha.tabIndex=Wb?0:-1}}Gbf(pb){return pb.parentNode}FDc(pb,nc){if(pb=this.FO[pb])pb=this.Gbf(pb),void 0!==pb&&null!==pb&&(!this.ei.length||nc?(pb.classList.add(Ga.a.zV),pb.setAttribute(t.a.cva,"true")):(pb.classList.remove(Ga.a.zV),pb.setAttribute(t.a.cva,"false")))}oVa(pb){const nc=this.$.hN?this.ei.length-
1:0;let Wb=this.qef(this.$.hN?0:this.ei.length-1);Wb&&(Wb.borderRightWidth=pb?"1px":"0");this.sA!==this.kX&&(Wb=this.qef(nc))&&(Wb.borderRightWidth="0")}Wwe(pb,nc){this.ei||(this.ei=[]);-1===nc?this.ei.push(pb):this.ei.splice(nc,0,pb)}eac(pb,nc){let Wb=-1,Ha=null;nc||(Wb=this.w$h(pb.index),-1!==Wb&&(Ha=this.eOa(Wb)));pb=new Pa(this.$,this.wn,Ha,pb,this);this.Wwe(pb,Wb);fb.DOMElementExtensions.setVisible(pb.domElement,!0)}hga(pb){const nc=oa.HelperMethods.LS(()=>{switch(pb){case 0:this.jCc(0);break;
case 1:this.jCc(this.sA-1);break;case 2:this.jCc(this.sA+1);break;case 3:this.scrollIntoView(this.ei.length-1);break;case 4:this.sA&&1<=this.ei.length&&(this.Hue(this.sA-1),this.ZVd());break;case 5:this.kX!==this.ei.length-1&&1<=this.ei.length&&(this.Hue(this.kX+1),this.ZVd());break;case 6:this.ZVd()}});this.Pcc&&this.uS&&this.JUb();y.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${pb}, duration = ${nc}`)}Hue(pb){(pb=this.xW(pb))&&pb.activate()}qTh(pb){if(0===pb.ZC){const nc=
this.$.ua;let Wb=0;for(let Ha=0,$a=nc.count;Ha<$a;Ha++){const Nb=Object(S.a)(Da.a,nc.getItem(Ha));if(Nb===pb)return Wb;0===Nb.ZC&&Wb++}}return-1}eTh(pb){const nc=this.$.ua;for(let Wb=pb.index+1,Ha=nc.count;Wb<Ha;Wb++)if(pb=Object(S.a)(Da.a,nc.getItem(Wb)),0===pb.ZC)return pb;return null}qla(pb){for(let nc=0;nc<this.ei.length;nc++){const Wb=this.xW(nc);if(!Wb)y.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${nc}] is null even though index is not out of bounds!`);
else if(Wb.sheet===pb)return nc}return-1}fzb(pb){pb=this.qla(pb);return this.xW(pb)}iRi(pb,nc,Wb){const Ha={};Ha.a=this.$.xa.UserSessionId;Ha.b=Wb;Ha.c=this.xcc;Ha.d=pb;Ha.e=nc;Ha.f=this.$.ua.count;ba.b().Df(2,Ha,Wb)}pAj(pb,nc,Wb){const Ha=Object(S.a)(bb.a,this.$.ua);nc?(nc=nc.index,nc=pb.index<nc?nc-1:nc):nc=Wb?Ha.count-1:0;Ha.reorderSheet(pb,nc,!0)}FNj(pb){Za.h(this.$).Ch.rq(pb)}$4g(pb){if(!this.yAc){const nc=this.domElement.ownerDocument.body;M.a.instance.ta(G.a.Tk,document.documentElement,this.A8);
this.Nza&&(P.a.instance.ta(G.a.Zg,document.documentElement,this.A8),P.a.instance.ta(G.a.Zg,this.domElement,this.ZO));M.a.instance.ta(G.a.Pg,document.documentElement,this.B8);P.a.instance.ta(G.a.$e,nc,this.B8);this.yAc=!0}this.q1=pb.sheet;this.xcc=!1;this.IN=null;this.Hcc=pb;this.Kca=pb.domElement;this.GXd(fb.DOMElementExtensions.getBoundingClientRect(this.Kca),"BeginSheetTabButtonDrag")}XV(pb=!0){if(this.yAc){this.FNj(t.a.zW);const nc=this.domElement.ownerDocument.body;M.a.instance.Aa(G.a.Tk,document.documentElement,
this.A8);this.Nza&&(P.a.instance.Aa(G.a.Zg,document.documentElement,this.A8),P.a.instance.Aa(G.a.Zg,this.domElement,this.ZO));M.a.instance.Aa(G.a.Pg,document.documentElement,this.B8);P.a.instance.Aa(G.a.$e,nc,this.B8);this.sTc=this.yAc=!1}this.ixc=0;this.xcc=!1;this.q1=null;this.Kca&&(this.Kca.style.visibility="visible",this.Kca=null);this.Hcc=null;this.GXd(null,"EndSheetTabButtonDrag");this.IN&&(this.IN.parentNode&&this.IN.parentNode.removeChild(this.IN),this.IN=null);this.HCj(pb)}HCj(pb){this.m2d(pb);
this.qE=this.hHb=-1}mDh(pb,nc){const Wb=this.$.qa,Ha=Wb?Wb.va:null;this.$.userOperationManager.kd(new fa.a(557,0,($a,Nb,rb)=>mb(Ha,pb,nc,$a,Nb,rb,null),64,()=>new Va(pb,nc)),null)}xW(pb){return 0<=pb&&pb<this.ei.length?this.ei[pb]:null}xei(pb){return(pb=this.xW(pb))?pb.sheet:null}eOa(pb){return(pb=this.xW(pb))?pb.domElement:null}qef(pb){return(pb=this.eOa(pb))?pb.style:null}w$h(pb){const nc=this.$.ua;pb+=1;let Wb=-1;const Ha=this.ei?this.ei.length:0;for(;pb<nc.count;){const $a=Object(S.a)(Da.a,nc.getItem(pb));
if(0===$a.ZC){for(Wb=0;Wb<Ha&&this.xei(Wb)!==$a;Wb++);break}pb++}return-1===Wb||Wb===Ha?-1:Wb}vRf(pb){var nc=this.fzb(pb);nc&&(this.uS&&(y.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.XV()),this.wn.removeChild(nc.domElement),nc=Array.indexOf(this.ei,nc),this.ei.splice(nc,1),this.Y1(),(!this.isRtl&&
nc===this.ei.length||this.isRtl&&!nc)&&this.oVa(!0),this.Pcc&&this.uS?pb===this.q1?(this.XV(),this.hga(6)):this.JUb():this.hga(6))}wRf(pb){const nc=Object(S.a)(Da.a,pb);this.uS&&(y.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.XV());if(0===nc.ZC){this.oVa(!1);var Wb=this.qla(pb);
-1===Wb&&(y.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.eac(nc,!1),Wb=this.qla(pb));this.kif(Wb,!0)}}qAj(pb,nc){const Wb=this.fzb(pb);Wb&&(this.uS&&!nc&&(y.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.XV()),pb=this.i4j(pb,Wb),!Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&pb&&nc&&pb.Jbj())}i4j(pb,nc){var Wb=Array.indexOf(this.ei,nc);const Ha=this.qTh(Object(S.a)(Da.a,pb));if(-1===Ha||-1===Wb)return null;this.oVa(!1);({TTh:this.sA,DLi:this.kX}=gc.mAj(Wb,Ha,this.sA,this.kX));nc&&nc.domElement.parentNode===this.wn&&(this.wn.removeChild(nc.domElement),this.ei.splice(Wb,1));nc=this.eTh(pb);Wb=this.qla(nc);nc=new Pa(this.$,this.wn,this.eOa(Wb),Object(S.a)(Da.a,
pb),this);this.Wwe(nc,Wb);Wb=this.qla(pb);this.kif(Wb,!1);return nc}aEh(){const pb=this.ei?this.ei.length:0,nc=this.sA,Wb=this.kX;for(let Ha=0;Ha<pb;Ha++){const $a=this.xW(Ha),Nb=Ha>=nc;$a&&($a.tabIndex=Nb&&Ha<=Wb?0:-1)}}Pck(){const pb=this.ei?this.ei.length:0;for(let nc=0;nc<pb;nc++){const Wb=this.xW(nc);Wb&&Wb.ekb()}}kif(pb,nc){nc&&pb<=this.sA&&this.sA++;this.aEh();this.oVa(!0);this.Y1();this.Pcc&&this.uS&&this.JUb()}qDc(pb){const nc=this.$.hN;if(pb||this.isRtl!==nc)this.isRtl=nc,this.domElement.classList.remove(this.isRtl?
pa.a.a_e:pa.a.e_e),this.domElement.classList.add(this.isRtl?pa.a.e_e:pa.a.a_e),this.domElement.dir=this.isRtl?"rtl":"ltr",this.Pck();pb||this.oVa(!0);for(pb=0;pb<this.FO.length;pb++)0!==pb&&3!==pb&&4!==pb&&5!==pb&&this.Vdg(pb)}nph(){const pb=this.JZd=document.createElement("div");pb.className=W.hKh;pb.classList.add(W.iKh);this.domElement.appendChild(pb);this.yPe(pb,1,717,716);this.yPe(pb,2,719,718);this.wuf&&(this.vVa=new Fb(this.$,this,pb))}oph(){const pb=this.KZd=document.createElement("div");pb.className=
W.jKh;this.domElement.appendChild(pb);this.kbd()}tqh(){const pb=document.getElementById(t.a.GSj),nc=document.getElementById(t.a.HSj);pb&&!nc&&y.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${pb.parentNode.id}. progressBar div has child: ${!!pb.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(t.a.zZd)}`);const Wb=ya.a.Buf(this.$);if(Wb&&pb&&nc)this.domElement.appendChild(pb),this.IRb=pb.firstChild,
this.mEc=document.getElementById(t.a.zZd),nc.style.visibility="visible";else{const Ha=document.createElement("div"),$a=document.createElement("div");Ha.className=pa.a.qKh;$a.className=pa.a.oKh;Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&($a.id=t.a.yhb);$a.style.display="none";const Nb=document.createElement("div");Nb.className=pa.a.rKh;const rb=document.createElement("div");rb.className=pa.a.pKh;const ec=document.createElement("div");ec.className=pa.a.nKh;$a.appendChild(Nb);
$a.appendChild(rb);$a.appendChild(ec);Ha.appendChild($a);this.domElement.appendChild(Ha);this.IRb=$a;this.mEc=rb;y.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Wb,pb,nc)}}Vdg(pb){var nc=this.FO[pb];if(nc){const Wb=nc.parentNode;this.L3f(nc);nc=Ba.a(this.$)?this.oXf[pb]:this.EGd[pb];this.FO[pb]=this.svgIconProvider.Lda(nc,12,
12,Wb,24,24)}}L3f(pb){(null===pb||void 0===pb?0:pb.parentNode)&&pb.parentNode.removeChild(pb)}Tmh(){const pb=this.Chb=document.createElement("div");pb.className=W.bKh;this.domElement.appendChild(pb);this.yrh(pb)}yrh(pb){const nc=document.createElement("div");nc.className=W.tKh;nc.classList.add(W.cKh);this.$.printingEnabled||nc.classList.add(Q.a.i1e);pb.appendChild(nc);this.wn=document.createElement("ul");fb.DOMElementExtensions.py(this.wn,t.a.v4c,null,null);this.wn.className=Q.a.f_e;nc.appendChild(this.wn);
this.gph();this.Zqe=document.createElement("div");this.iEc.id="SheetIconTooltipContainer";nc.appendChild(this.iEc)}gph(){const pb=document.createElement("div"),nc=document.createElement("div"),Wb=ra.a.T8e(pa.a.rLh);nc.className=pa.a.gfh;nc.appendChild(Wb);pb.appendChild(nc);pb.className=W.sKh;fb.DOMElementExtensions.setVisible(pb,!1);this.wn.appendChild(pb)}Cbd(){const pb=this.$.ua;for(let nc=0,Wb=pb.count;nc<Wb;nc++){const Ha=Object(S.a)(Da.a,pb.getItem(nc));0===Ha.ZC&&(this.eac(Ha,!0),Ha.active&&
Ha.activate())}}J8c(){F.a.Rc(this.ei);this.ei=[];this.kX=this.sA=0}yPe(pb,nc,Wb,Ha){const $a=document.createElement("a");pb.appendChild($a);pb=this.EGd[nc];this.FO[nc]=this.Kb($a,J.a.instance.ha(Ha),0,this.SXi[nc],J.a.instance.ha(Wb),pb);if(5===nc||4===nc)fb.DOMElementExtensions.tL(this.FO[nc],$a,!1,"span").style.marginTop="10px";this.Vdg(nc);Wb=this.DGd[nc]=this.Ze.He($a);M.a.instance.ta(G.a.pointerDown,$a,rb=>rb.ctrlKey&&this.i3i(nc)?!0:this.BOf(nc));M.a.instance.ta(G.a.Pg,$a,()=>this.COf());P.a.instance.ta(G.a.$e,
$a,()=>this.COf());M.a.instance.ta(G.a.pointerOut,$a,()=>this.B8c());B.KeyInputManager.instance.ta(G.a.yc,$a,rb=>13!==rb.Da.keyCode&&32!==rb.Da.keyCode||this.G$c?!1:(this.G$c=!0,this.BOf(nc)));B.KeyInputManager.instance.ta(G.a.te,$a,rb=>13===rb.Da.keyCode||32===rb.Da.keyCode?(this.G$c=!1,this.B8c()):!1);const Nb=this.aAe();Ha=rb=>{"mouseup"===rb.type&&this.uS||Ua.g(rb);!$a.classList.contains(Ga.a.zV)&&Nb&&this.o9i(rb,nc)};Wb.la("mouseover",Ha);Wb.la("mouseout",Ha);Wb.la("focus",Ha);Wb.la("blur",Ha);
Nb&&Wb.la("mouseup",Ha)}sBi(pb){let nc=!1;const Wb=this.$.$f;Wb&&(nc=D.a.sS(fb.DOMElementExtensions.getBoundingClientRect(Wb),pb.clientPoint));return nc}JUb(){if(!this.IN){y.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.IN=this.Kca.cloneNode(!0);if(!this.L9f(this.IN,this.Kca,!0,"UpdateDragAndDropState"))return;this.Kca.style.visibility="hidden";this.IN.classList.add(W.uKh);this.IN.style.borderRightWidth="";this.hjc=this.H5.clientPoint.x-
this.V5.width/2;this.IN.style.left=this.hjc+"px";this.qE=this.qla(this.q1);0>this.qE&&y.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Pcc&&(this.qE=this.qla(this.q1));var pb=fb.DOMElementExtensions.getBoundingClientRect(this.wn);const nc=pb.x;pb=pb.x+pb.width;let Wb=this.H5.clientPoint.x-this.V5.width/2;Wb=Math.min(Wb,pb-this.V5.width);Wb=Math.max(Wb,nc);this.IN.style.transform="translateX("+Math.abs(Wb-this.hjc)*(this.hjc<Wb?1:-1)+"px)";const Ha=
this.H5.clientPoint.x>this.hHb;let $a=this.H5.clientPoint.x;Wb>=pb-this.V5.width?($a=pb-this.V5.width/2,this.WVd()||this.opa||(y.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.pwc=this.wn.scrollLeft,this.opa=window.requestAnimationFrame(this.mag))):Wb<=nc?($a=nc+this.V5.width/2,this.VVd()||this.opa||(y.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.pwc=this.wn.scrollLeft,this.opa=window.requestAnimationFrame(this.lag))):this.opa&&(y.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.m2d());this.H5.clientPoint.x!==this.hHb&&(this.$2d(Ha,$a),this.hHb=this.H5.clientPoint.x);this.sTc=!0}$2d(pb,nc){let Wb;for(;({Y7b:Wb}=this.sAh(nc,pb)).returnValue;)this.qTb=Wb,this.o0g(pb)}o0g(pb){if(this.qTb){var nc=(pb?1:-1)*this.V5.width;if(pb&&!this.$.hN||!pb&&this.$.hN){var Wb=
this.Kca;var Ha=this.qE+1;var $a=!0}else Wb=(Ha=this.xW(this.qE+1))?Ha.domElement:null,Ha=this.qE-1,$a=!1;if(this.L9f(this.qTb,Wb,$a,"AnimateSheetSwap")){y.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.qE} and other sheet-index ${Ha}. amount of sheets in the bar: ${this.HZd} isMovingRight: ${pb}`);0<=this.qE&&this.qE<this.ei.length&&0<=Ha&&Ha<this.ei.length?(pb=this.ei[Ha],this.ei[Ha]=this.ei[this.qE],this.ei[this.qE]=pb):(y.ULS.sendTraceTag(537153737,
0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.ei.length}, ghostIndex: ${this.qE}, swappedSheetIndex: ${Ha}`),this.XV());this.qE=Ha;var Nb=this.qTb;Nb.style.transform="translateX("+nc+"px)";window.requestAnimationFrame(()=>{Nb.style.transform="translateX(0px)"})}}}L9f(pb,nc,Wb,Ha){const $a=Nb=>Nb?`Node ID: ${Nb.id} , Node class: ${Nb.className}, Node name: ${Nb.nodeName},`:null;try{return this.wn.insertBefore(pb,nc),!0}catch(Nb){return pb=this.fzb(this.q1),y.ULS.sendTraceTag(537153736,
0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",pb?pb!==this.Hcc?"Changed":"NoChange":"Removed",Ha,$a(nc),$a(nc.parentNode),$a(this.wn),Wb,this.qE,this.HZd,Nb),this.XV(),!1}}sAh(pb,nc){var Wb=this.$.hN===nc?this.xW(this.qE-
1):this.xW(this.qE+1);if(!Wb)return{returnValue:!1,Y7b:null};Wb=Wb.domElement;const Ha=fb.DOMElementExtensions.getBoundingClientRect(Wb);return this.V5?nc?{returnValue:pb+this.V5.width/2>=Ha.x+.5*Ha.width,Y7b:Wb}:{returnValue:pb-this.V5.width/2<=Ha.x+.5*Ha.width,Y7b:Wb}:(y.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.XV(),{returnValue:!1,Y7b:Wb})}jag(pb,nc){let Wb;
Wb=nc?this.mag:this.lag;if(-1===this.bGc)this.bGc=pb,this.opa=window.requestAnimationFrame(Wb);else{pb=Math.floor((pb-this.bGc)/1E3*300);var Ha=this.FPb>this.LHb?1:-1;this.scrollLeft(Math.abs(this.wn.scrollLeft-(nc?this.pwc+pb*Ha:this.pwc-pb*Ha))*(nc?-1:1));if(pb=this.W$e("ScrollStep"))this.$2d(nc,pb.x+pb.width/2),nc&&!this.WVd()||!nc&&!this.VVd()?this.opa=window.requestAnimationFrame(Wb):(y.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.m2d())}}WVd(){const pb=this.FPb>this.LHb;return pb&&this.Upa>=this.FPb||!pb&&this.Upa<=this.FPb}VVd(){const pb=this.FPb>this.LHb;return pb&&this.Upa<=this.LHb||!pb&&this.Upa>=this.LHb}m2d(pb=!0){this.wn&&(this.Upa=this.wn.scrollLeft);window.cancelAnimationFrame(this.opa);this.opa=0;this.bGc=-1;pb&&this.Y1()}GXd(pb,nc){pb||y.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${nc}`);this.V5=pb}i3i(pb){return 2===pb?(this.hga(3),
!0):1===pb?(this.hga(0),!0):!1}BOf(pb){y.ULS.shipAssertTag(537153732,0,-1===this.XSa&&-1===this.WSa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.XSa&&(window.clearTimeout(this.XSa),this.XSa=-1);-1!==this.WSa&&(window.clearInterval(this.WSa),this.WSa=-1);this.hga(pb);this.XSa=window.setTimeout(()=>{this.I1j(pb)},this.GXi);return!0}I1j(pb){this.WSa=window.setInterval(()=>{this.hga(pb)},this.FXi)}COf(){this.B8c();
return!this.uS}B8c(){window.clearTimeout(this.XSa);window.clearInterval(this.WSa);this.WSa=this.XSa=-1;return!0}o9i(pb,nc){const Wb=this.snc(nc),Ha=5===nc;"mouseup"!==pb.type||!Ha&&4!==nc||(Wb||this.reorderSheets(null,Ha,!1),this.XV())}snc(pb){return!!fb.DOMElementExtensions.Mmd(this.FO[pb],"a").title}WJc(pb){this.v7d(pb);this.Y1()}v7d(pb){(pb=this.fzb(pb))&&pb.ekb()}ZVd(){var pb=this.$.ua;if(pb.na&&(!Lb.e(this.$)||pb.count))if(pb=this.qla(pb.na),-1===pb)y.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");
else{var nc=this.eOa(pb);pb<this.sA?this.jCc(pb):pb>this.sA&&!this.Hzd(nc)&&this.scrollIntoView(pb)}}eek(){this.sA=0;this.kX=this.ei.length-1;let pb=!1;for(let nc=0;nc<this.ei.length;nc++){const Wb=this.xW(nc);if(!Wb)break;const Ha=this.Hzd(Wb.domElement);Wb.tabIndex=Ha?0:-1;if(!pb&&Ha)this.sA=nc,pb=!0;else if(pb&&!Ha){this.kX=nc-1;break}}}jCc(pb){this.$.ua.count&&(this.ei.length||this.Cbd(),this.fcg(this.eOa(Math.max(0,Math.min(pb,this.ei.length-1)))),this.Y1())}scrollIntoView(pb){y.ULS.shipAssertTag(537153697,
0,pb>=this.sA,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.ua.count){this.ei.length||this.Cbd();var nc=this.eOa(Math.max(0,Math.min(pb,this.ei.length-1))),Wb=this.eOa(this.sA);if(!this.Hzd(nc)){nc=fb.DOMElementExtensions.getBoundingClientRect(nc);var Ha=fb.DOMElementExtensions.getBoundingClientRect(this.Chb);nc=this.isRtl?Ha.x-nc.x:nc.x+nc.width-(Ha.x+Ha.width);for(Ha=0;Wb&&Ha<nc;){const $a=fb.DOMElementExtensions.getBoundingClientRect(Wb);
Ha+=$a.width;Wb=Wb.nextSibling}Wb?this.fcg(Wb):y.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.sA}, lastVisibleSheetTabIndex = ${this.kX}, scroll to index: ${pb}`)}this.Y1()}}fcg(pb){const nc=fb.DOMElementExtensions.getBoundingClientRect(this.wn);pb=fb.DOMElementExtensions.getBoundingClientRect(pb);this.isRtl?this.scrollLeft(Math.floor(nc.x+nc.width-(pb.x+pb.width+.5))):this.scrollLeft(Math.ceil(nc.x-pb.x-.5))}scrollLeft(pb){(0>
pb&&this.WVd()||0<pb&&this.VVd())&&y.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const nc=this.wn.scrollLeft;if(this.isRtl){if(z.a.IG||z.a.ng){this.wn.scrollLeft=this.Upa=nc-pb;return}if(z.a.YI){this.wn.scrollLeft=this.Upa=nc+pb;return}y.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.wn.scrollLeft=this.Upa=nc-pb}Hzd(pb){pb=fb.DOMElementExtensions.getBoundingClientRect(pb);const nc=
fb.DOMElementExtensions.getBoundingClientRect(this.Chb);return pb&&nc?pb.x>=nc.x-1&&pb.x+pb.width<=nc.x+nc.width+1:(y.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}Iph(){const pb=this.KZd;la.Bgg(this.$)?(F.a.Ka(this.lS),this.lS=new la(pb,this.$,this,!0)):(F.a.Ka(this.lS),Z.m(this.$.tf)?this.lS=new ca(pb,this.$,this):this.lS=new la(pb,this.$,this))}IPe(pb,nc){var Wb=this.$.ua;if(!this.$.isEditMode||!Wb.count)F.a.Ka(nc),
nc=null;else if(!nc)if(Wb=this.JZd,Z.m(this.$.tf))nc=new ca(Wb,this.$,this);else switch(pb){case 0:nc=new la(Wb,this.$,this);break;case 1:nc=new sa(Wb,this.$,this);break;default:y.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return nc}kbd(){this.hDi?(this.lS=this.IPe(0,this.lS),this.TDb=this.IPe(1,this.TDb)):this.Iph()}W$e(pb){const nc=
fb.DOMElementExtensions.getBoundingClientRect(this.IN);nc||(y.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${pb}: GetBoundingClientRect returned null for the dragged sheet.`),this.XV());return nc}bif(pb,nc){this.ywa.B1g(pb,nc);this.XV(!1);this.lYd(this.navigationButtonsDisabled);for(const Wb of this.v4j)Wb&&Wb.MT(this.navigationButtonsDisabled);for(const Wb of this.YDe)Wb&&Wb.MT(this.operationButtonsDisabled)}static mAj(pb,nc,Wb,Ha){pb<Wb?(nc>Wb&&Wb--,nc>Ha&&Ha--):pb>Ha?(nc<Wb&&Wb++,nc<Ha&&
Ha++):nc<Wb&&Wb++;return{TTh:Wb,DLi:Ha}}}Object(b.a)(gc,"SheetTabBarControl",Y.a,[422,2,29]);class Gc extends r.a{constructor(pb){super();this.$=pb;this.kc()}create(){const pb=this.$.fc;if(A.a(this.$.xa,1))ib.PageLoadTrackingInfo.instance.Wfa(t.a.EDa,["sheetTabBar"]);else{var nc=document.getElementById(pb+t.a.Hcd);if(nc){ib.PageLoadTrackingInfo.instance.hqa(t.a.EDa);var Wb=e.GetServiceTaskFactory.Za(this.$.da,388,387,this.La);d.TaskExtensions.za(d.TaskExtensions.ke([Wb],this.$.ka),()=>{this.Pb(this.$.da.Ba(32)||
new gc(this.$,nc,Wb.result))},this.$.ka,3)}else ib.PageLoadTrackingInfo.instance.Wfa(t.a.EDa,["sheetTabBar"])}}static la(pb){pb.da.Ja(33,new Gc(pb))}}Object(b.a)(Gc,"SheetTabBarFactory",r.a,[]);a.d(C,"a",function(){return Kb});const Kb=()=>{c.a.Fa(pb=>{Gc.la(pb);w.la(pb)})}},1218:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(52),e=a(40),d=a(1),h=a(2),l=a(573),k=a(16),n=a(15),v=a(6),x=a(570),w=a(385),r=a(623);class t{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(u.a)(t,"ColorCellProps",
null,[]);var A=a(425),y=a(19),z=a(54),E=a(216),G=a(207),F=a(34),O=a(234),M=a(126),P=a(217),B=a(270),D=a(12),I=a(358),S=a(23),J=a(20);class L{constructor(Ia){this.qNc=null;this.$=Ia;this.grid=J.h(this.$)}get borderFormatManager(){this.qNc||(this.qNc=this.$.da.Ba(296));return this.qNc}w7h(Ia){let oa=null;switch(Ia){case 467002767:Ia={};this.$.Fk(Ia);oa=Object(M.a)(I.a,this.$.ua).sef(Ia.SheetName,!0);break;case -236759591:oa=this.x0h();break;case 1970784898:oa=this.L$e(0);break;case 1650812936:case 1378078823:oa=
this.L$e(1);break;case -400966242:oa=this.getShapeOutlineColor();break;default:n.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${Ia}'`)}return oa}x0h(){let Ia=null;this.borderFormatManager&&(Ia=this.borderFormatManager.D5);(Ia="black"===Ia?"000000":Ia)&&(Ia=F.a.S7a(Ia));return Ia}getShapeOutlineColor(){let Ia=null;if(this.grid.ga.Sa&&this.grid.ga.Sa.Fc){const oa=this.grid.ga.Sa.Fc.floatingObject;5===oa.type&&
oa.Yb&&-1!==oa.Yb.ShapeOutlineColor&&(Ia=G.a.tH(oa.Yb.ShapeOutlineColor),Ia=Ia.toUpperCase())}return Ia}L$e(Ia){let oa=null;if(this.grid.ga.Sa&&this.grid.ga.Sa.Fc){var Da=this.grid.ga.Sa.Fc.floatingObject;5===Da.type&&Da.Yb?1===Ia&&-1!==Da.Yb.ShapeFillColor?(oa=G.a.tH(Da.Yb.ShapeFillColor),oa=oa.toUpperCase()):n.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):n.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");
return oa}Da=this.grid.y5("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ga.pa.selectedRanges,1,!0);try{for(Da.$$rst();Da.$$mn();){const bb=Da.$$cu().cell;if(!bb)continue;let Za="#000000";if(0===Ia){Za=bb.color;if(d.EwaSettings.Tb()&&this.grid.Eb)return this.l6h();bb.hasRichText&&(Za=this.m6h(bb))}else if(1===Ia){const Xa=bb.backgroundColor;Za=S.a.compare(Xa,"transparent",!0)&&Xa?bb.backgroundColor:null}if(!oa)oa=Za;else if(oa!==Za){oa=null;break}}}finally{Da&&Da.dispose()}return oa}l6h(){var Ia=
null,oa=this.grid.wc,Da=this.grid.cellTextEditBox.formattedText;if(Da){Ia=Da.TextRuns;const bb=O.a.map(Ia,Za=>Za.StartIndex);Da=Da.Fonts;oa=oa.textBox.caretPosition;oa=D.HelperMethods.R3e(new P.a(bb),bb.length,oa,D.HelperMethods.SG);Ia=Da[Ia[oa].FontID].Color}return Ia?Ia.toUpperCase():null}m6h(Ia){Ia=B.a(Ia.formattedText.Fonts);if(B.e(Ia,32))(Ia=G.a.bga(G.a.tH(Ia.FontColor)))&&(Ia="#"+Ia.toUpperCase());else return null;return Ia}}Object(u.a)(L,"ColorHighlighterHelper",null,[322]);var R=a(324);class Y{constructor(Ia,
oa,Da){this.Hyc=this.USb=this.lEa=null;this.Kag="-1";this.$=Ia;this.moreColorsHelper=oa;this.themesManager=Da;this.uLe=new L(Ia);this.BE=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}obf(Ia,oa=null,Da=null,bb=null,Za=null,Xa=null,Ba=null,Wa=null,Na=null){return this.xV(null!=oa,null!=Da,null!=bb,null!=Wa,!0,Ia,oa,Da,bb,Za,Xa,Ba,Wa,Na)}Yei(Ia,oa,Da,bb){return this.xV(Ia,oa,Da,bb,!1)}pbf(Ia,oa=null,Da=null,bb=null,Za=null,Xa=null){const Ba=[];Ia=this.obf(Ia,oa,Da,bb,void 0,
void 0,void 0,Za,Xa);for(let Wa=0,Na=Ia.length;Wa<Na;Wa++)Ba.push(R.r(Ia[Wa]));return Ba}xV(Ia,oa,Da,bb,Za,Xa=null,Ba=null,Wa=null,Na=null,ta=null,V=null,ia=null,X=null,la=null){n.ULS.shipAssertTag(537154456,0,!Za||null!=Xa,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const sa=[];let Va=null,nb=3,ha=null,jb=null,Fb=null;this.bEh();if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.Hjj(la))return n.ULS.sendTraceTag(537154455,
0,50,`Theme Info not present at the time of ${la} menu opening`),sa;Ia&&(Za&&null==Ba?n.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):sa.push(this.cOa(Y.p4g,this.jXh(Y.QDe,Ba,ia,V))));Za&&null!=Xa&&this.lrf()&&this.uLe&&(jb=ha="-1",Va=this.uLe.w7h(Xa))&&(n.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${Xa} is not null .`),Va=G.a.bga(Va),nb=this.qaf(Va),ha=this.Zod(Va,nb,0,!0),jb=
this.Zod(Va,nb,1,!1));sa.push(this.cOa(Y.O5j,this.Ikd(Y.Ung,ha,this.lEa,Xa,ta,V),1341));sa.push(this.cOa(Y.c1j,this.Ikd(Y.b1j,jb,this.USb,Xa,ta,V),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.Fjj(),Za&&this.lrf()&&(Fb="-1",Va&&(Fb=this.Zod(Va,nb,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.SHb&&0<this.moreColorsHelper.SHb.count&&sa.push(this.cOa(Y.Drj,this.Ikd(Y.Crj,Fb,this.Hyc,Xa,ta,V),1349)));oa&&(Za&&null==Wa?n.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):
sa.push(this.cOa(Y.zYi,this.mXh(Y.JJe,Wa,this.W1h(Wa),ia,V))));Da&&(v.AFrameworkApplication.AO("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HighlightWhenCFExperiment",!1)&&(Za&&!Na?n.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):sa.push(this.cOa(Y.Dpi,this.PXh(Y.ukf,Na)))));bb&&(Za&&null==X?n.ULS.shipAssertTag(537154451,0,
!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):sa.push(this.cOa(Y.AWi,this.mYh(Y.KEf,X,this.O9h(X)))));return sa}Zod(Ia,oa,Da,bb){3===oa&&(oa=this.qaf(Ia));return this.BE&&0===Da&&oa===Da?this.Kag.toLowerCase():oa===Da?bb?Ia.toLowerCase():Ia:"-1"}qaf(Ia){if(!Ia)return 3;const oa=Ia.toLowerCase();if(this.BE){if(this.lEa&&this.LIi(oa,this.lEa))return 0}else if(this.lEa&&this.Rvd(oa,this.lEa))return 0;return this.USb&&this.Rvd(Ia,this.USb)?1:this.Hyc&&this.Rvd(oa,
this.Hyc)?2:3}cOa(Ia,oa,Da=null){Ia=Object(h.a)(new x.a,{Id:Ia,Title:null!=Da?k.a.instance.ha(Da):"",ControlList:[],ControlsId:Ia+".Controls"});Ia.ControlList.push(oa);return Ia}mXh(Ia,oa,Da,bb=null,Za=null){return this.A6e(Ia,oa,Da,y.a.l_e,"transparent",bb,Za)}PXh(Ia,oa){return Object(h.a)(new w.a,{Command:null!=oa?oa.toString():null,LabelText:k.a.instance.ha(1433),Id:Ia,ExternalId:this.z7a(Ia,oa),ExternalImageId:"JotNotebookColor2_20"})}jXh(Ia,oa,Da=null,bb=null){return this.A6e(Ia,oa,542,y.a.k_e,
"000000",Da,bb)}A6e(Ia,oa,Da,bb,Za,Xa=null,Ba=null){return Object(h.a)(new w.a,{Command:null!=oa?oa.toString():null,CommandPreviewId:null!=Xa?Xa.toString():null,CommandRevertId:null!=Ba?Ba.toString():null,MenuItemsStatefulData:this.y9h(Ia,oa,Za),LabelText:k.a.instance.ha(Da),Id:Ia,ExternalId:this.z7a(Ia,oa),Image16by16:z.a.dg(1),Image16by16Class:bb})}y9h(Ia,oa,Da){const bb={};Ia=this.z7a(Ia,oa);bb[Ia]={};bb[Ia].iconColor=Da;return bb}Rvd(Ia,oa){for(let Da=0;Da<oa.length;Da++)if(Ia===oa[Da].Color)return!0;
return!1}XGi(Ia,oa){Ia=G.a.aq(Ia);oa=G.a.aq(oa);return 1>=Math.abs(Ia.r-oa.r)&&1>=Math.abs(Ia.g-oa.g)&&1>=Math.abs(Ia.b-oa.b)?!0:!1}LIi(Ia,oa){for(let Da=0;Da<oa.length;Da++){const bb=oa[Da].Color;if(this.XGi(Ia,bb))return this.Kag=bb.toLowerCase(),!0}return!1}Ikd(Ia,oa,Da,bb,Za=null,Xa=null){return Object(h.a)(new r.a,{McuLayout:!0,Command:null!=bb?bb.toString():null,CommandPreviewId:null!=Za?Za.toString():null,CommandRevertId:null!=Xa?Xa.toString():null,Width:10,Id:`${Ia}.ColorPicker`,SelectedColorId:oa,
Colors:Da,Stateful:!0,ExternalId:this.z7a(Ia,bb),McuExternalId:`${this.z7a(Ia,bb)}.MCU`})}z7a(Ia,oa){return`${Ia}.${null!=oa?oa.toString():""}`}hgc(...Ia){const oa=[];for(let Da=0,bb=Ia.length;Da<bb;Da+=2)oa.push(Object(h.a)(new t,{Color:Ia[Da],DisplayColor:G.a.YJ(E.a.sG(parseInt(String("0x"+Ia[Da]),16))),Alt:Object(A.a)(String,Ia[Da+1])&&this.$?Ia[Da+1]:k.a.instance.ha(Ia[Da+1])}));return oa}mYh(Ia,oa,Da){const bb=y.a.C_e;Ia=Object(h.a)(new w.a,{Command:null!=oa?oa.toString():null,LabelText:k.a.instance.ha(Da),
Id:Ia,ExternalId:this.z7a(Ia,oa),Image16by16:z.a.dg(1),Image16by16Class:bb});Ia.ShouldTakeFocus=!1;return Ia}bEh(){this.lEa||(this.lEa=this.hgc("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,"cab9ac",1383,"e7c6b4",1384,"adcbf8",
1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,"235637",1419));this.USb||(this.USb=
this.hgc("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}Fjj(){this.moreColorsHelper.qid();if(this.moreColorsHelper.SHb){var Ia=this.moreColorsHelper.SHb;const oa=[];for(let Da of Ia)Ia=G.a.bga(Da.substr(1)),oa.push(Ia,Da);this.Hyc=this.hgc(...oa)}}Hjj(Ia){this.themesManager.Oec(Ia);if(this.themesManager.Qib&&this.themesManager.Vng&&!this.themesManager.Ozd){Ia=this.themesManager.Qib;const oa=this.themesManager.Vng,
Da=[];for(let bb=0;bb<Ia.count;bb++)Da.push(Ia.ma(bb),oa.ma(bb));this.lEa=this.hgc(...Da);return!0}return!1}O9h(Ia){switch(Ia){case -458147525:Ia=1344;break;case 1610379174:Ia=1345;break;default:Ia=1343}return Ia}W1h(Ia){switch(Ia){case 1549407384:Ia=541;break;case -1744769642:Ia=539;break;default:Ia=540}return Ia}lrf(){return d.EwaSettings.ya(580)}}Y.zYi="NoColor";Y.p4g="Automatic";Y.O5j="ThemeColors";Y.c1j="StandardColors";Y.Drj="RecentColors";Y.JJe="ClearColor";Y.Dpi="HighlightWhen";Y.ukf="HighlightWhen";
Y.QDe="AutomaticColor";Y.Ung="ThemeColorPicker";Y.b1j="StandardColorPicker";Y.AWi="MoreColors";Y.KEf="MoreColors";Y.Crj="RecentColorPicker";Object(u.a)(Y,"ColorPickerBuilder",null,[]);var Q=a(357);class W{constructor(){this.sections=null}}Object(u.a)(W,"ColorPickerButtonMenuProps",null,[]);class Ga{constructor(){this.title=null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(u.a)(Ga,"ColorPickerButtonMenuSection",null,[]);class pa{constructor(){this.id=this.label=this.color=null;this.index=
0}}Object(u.a)(pa,"ColorPickerColorProps",null,[]);class aa{constructor(){this.type=0;this.label=null}}Object(u.a)(aa,"ColorPickerSectionButtonProps",null,[]);class Z{constructor(){this.colors=null;this.isThemeColorSection=this.notifyOnColorUsed=!1}}Object(u.a)(Z,"ColorPickerSectionColorSwatchProps",null,[]);class fa{constructor(){this.row=this.index=0}}Object(u.a)(fa,"ThemeColorInfo",null,[]);class ya{constructor(Ia,oa,Da,bb){this.$=Ia;this.MC=oa;this.moreColorsHelper=Da;this.themesManager=bb;this.KIi=
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(Ia){Ia=this.MC.Gef(Ia.automaticColor,Ia.clearColor,Ia.highlightWhen,Ia.moreColors);const oa=new W;oa.sections=this.gci(Ia);return oa}showMoreColorsDialog(Ia,oa){this.moreColorsHelper.kMi(Ia,void 0,oa)}onColorUsed(Ia){Ia=E.a.sG(G.a.BI(G.a.bga(Ia),!1));this.moreColorsHelper.DVd(Ia.r,Ia.g,Ia.b,Q.a.xLc)}getThemeColor(Ia){Ia=G.a.bga(Ia);let oa;if(!({themeIndex:Ia,mEa:oa}=this.themesManager.getThemeColor(Ia)).returnValue)return n.ULS.shipAssertTag(538514630,
0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;const Da=new fa;Da.index=Ia;Da.row=oa;return Da}gci(Ia){const oa=[];for(let bb=0;bb<Ia.length;bb++){var Da=Object(M.a)(x.a,Ia[bb]);const Za=new Ga;Za.title=Da.Title;const Xa=Object(M.a)(r.a,Da.ControlList[0]);Xa?(Za.type=1,Za.colorSwatchProps=this.j2h(Xa),oa.push(Za)):(Da=Object(M.a)(w.a,Da.ControlList[0]))&&null!=this.V8e(Da.Id)?(Za.type=2,Za.buttonProps=new aa,Za.buttonProps.type=this.V8e(Da.Id),Za.buttonProps.label=
Da.LabelText,oa.push(Za)):n.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return oa}j2h(Ia){const oa=new Z,Da=Ia.Colors;oa.colors=Array(Da.length);oa.notifyOnColorUsed=this.moreColorsHelper.fhg(Ia.ExternalId);oa.isThemeColorSection=this.KIi&&!!Ia.ExternalId&&Ia.ExternalId.includes(Y.Ung);for(Ia=0;Ia<Da.length;Ia++)oa.colors[Ia]=new pa,oa.colors[Ia].id=Da[Ia].DisplayColor,oa.colors[Ia].color=Da[Ia].DisplayColor,oa.colors[Ia].label=Da[Ia].Alt,oa.colors[Ia].index=
Ia;return oa}V8e(Ia){switch(Ia){case Y.KEf:return 1;case Y.JJe:return 2;case Y.QDe:return 3;case Y.ukf:return 4}return null}}Object(u.a)(ya,"ColorPickerButtonController",null,[285]);class Aa{constructor(Ia,oa,Da){this.Uq=this.Lk=null;this.$=Ia;this.moreColorsHelper=oa;this.g9g();this.f9g();this.themesManager=Da;this.o9b=new Y(Ia,oa,Da)}g9g(){this.Lk={};this.Lk.style0=1535;this.Lk.style1=1536;this.Lk.style2=1537;this.Lk.style3=1538;this.Lk.style4=1539;this.Lk.style5=1540;this.Lk.style6=1541;this.Lk.style7=
1542;this.Lk.style8=1543;this.Lk.style9=1544;this.Lk.style10=1545;this.Lk.style11=1546;this.Lk.style12=1547;this.Lk.style13=1548;this.Lk.style14=1549;this.Lk.style15=1550;this.Lk.style16=1551;this.Lk.style17=1552;this.Lk.style18=1553;this.Lk.style19=1554;this.Lk.style20=1555;this.Lk.style21=1556;this.Lk.style22=1557;this.Lk.style23=1558;this.Lk.style24=1559;this.Lk.style25=1560;this.Lk.style26=1561;this.Lk.style27=1562;this.Lk.style28=1563;this.Lk.style29=1564;this.Lk.style30=1565;this.Lk.style31=
1566;this.Lk.style32=1567;this.Lk.style33=1568;this.Lk.style34=1569;this.Lk.style35=1570;this.Lk.style36=1571;this.Lk.style37=1572;this.Lk.style38=1573;this.Lk.style39=1574;this.Lk.style40=1575;this.Lk.style41=1576}f9g(){this.Uq={};this.Uq.style0=1507;this.Uq.style1=1508;this.Uq.style2=1509;this.Uq.style3=1510;this.Uq.style4=1511;this.Uq.style5=1512;this.Uq.style6=1513;this.Uq.style7=1514;this.Uq.style8=1515;this.Uq.style9=1516;this.Uq.style10=1517;this.Uq.style11=1518;this.Uq.style12=1519;this.Uq.style13=
1520;this.Uq.style14=1521;this.Uq.style15=1522;this.Uq.style16=1523;this.Uq.style17=1524;this.Uq.style18=1525;this.Uq.style19=1526;this.Uq.style20=1527;this.Uq.style21=1528;this.Uq.style22=1529;this.Uq.style23=1530;this.Uq.style24=1531;this.Uq.style25=1532;this.Uq.style26=1533;this.Uq.style27=1534}W8e(Ia){return R.i(this.o9b.pbf(Ia,null,null,null,null,null))}Sgc(Ia,oa=null,Da=null,bb=null,Za=null,Xa=null,Ba=null,Wa=null,Na=null){return Object(h.a)(new l.a,{MenuSectionList:this.o9b.obf(Ia,oa,Da,bb,
Za,Xa,Ba,Wa,Na),UpdateDynamically:!0})}Gef(Ia,oa,Da,bb){return this.o9b.Yei(Ia,oa,Da,bb)}k2h(Ia,oa=null,Da=null,bb=null,Za=null,Xa=null){return this.o9b.pbf(Ia,oa,Da,bb,Za,Xa)}Hic(Ia,oa=!1){return oa?this.Uq[Ia]:this.Lk[Ia]}Fmh(){return new ya(this.$,this,this.moreColorsHelper,this.themesManager)}}Object(u.a)(Aa,"PopulateDynamicHelper",null,[254]);var ja=a(71),za=a(149),ra=a(36),fb=a(100);class Ua extends b.a{constructor(Ia,oa){super();this.MC=null;this.$=oa;Ia.Ja(111,this);this.kc()}create(){if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)||d.EwaSettings.Gm()){const Ia=f.GetServiceTaskFactory.Za(this.$.da,398,397,this.La),oa=Object(ja.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?Object(fb.d)(za.a.resolve(ra.vb,{Wa:this.La})):f.GetServiceTaskFactory.Za(this.$.da,422,421,this.La);e.TaskExtensions.za(e.TaskExtensions.ke([Ia,oa],this.ka),()=>{this.Pb(this.MC||(this.MC=new Aa(this.$,Ia.result,oa.result)))},this.ka,3)}else e.TaskExtensions.za(f.GetServiceTaskFactory.Za(this.$.da,398,397,this.La),Ia=>{this.Pb(this.MC||
(this.MC=new Aa(this.$,Ia.result,null)))},this.ka,3)}}Object(u.a)(Ua,"PopulateDynamicHelperFactory",b.a,[]);a.d(C,"a",function(){return Ca});const Ca=()=>{c.a.Fa(Ia=>{new Ua(Ia.da,Ia)})}},1223:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(52),e=a(40),d=a(2),h=a(15),l=a(19),k=a(7),n=a(38),v=a(918);class x{constructor(ja,za,ra=null,fb,Ua=null,Ca=null,Ia,oa=null,Da=null){this.UBe=za;this.PDe=ra;this.IJe=Ua;this.tkf=Ca;this.JEf=oa;this.MC=ja;this.menuId=Da}kV(){let ja="";const za=this.MC.k2h(this.UBe,
this.PDe,this.IJe,this.tkf,this.JEf,this.menuId);for(const ra of za)ja+=ra;return ja}RF(){return this.MC.Sgc(this.UBe,this.PDe,this.IJe,this.tkf,void 0,void 0,void 0,this.JEf,this.menuId)}}Object(u.a)(x,"RibbonColorPicker",null,[289]);var w=a(579);class r{constructor(ja,za=""){this._id=ja;this.AD=za}get id(){return this._id}get text(){return this.AD}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(ja){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");
}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}kV(){return`<Label id="${this._id}" LabelText="${this.AD}" />`}wT(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}bRb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}uT(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");
}P8b(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}Jja(){return Object(d.a)(new w.a,{Id:this.id,LabelText:this.text})}}Object(u.a)(r,"RibbonLabel",null,[294,287,289]);var t=a(573),A=a(425),y=a(126),z=a(324);class E{constructor(ja){this.DKg=[];this.id=ja}get Vc(){return this.DKg}kV(){return z.q(this.RF())}RF(){const ja=Object(d.a)(new t.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const za of this.Vc)Object(A.a)(x,za)?ja.MenuSectionList.push(...Object(y.a)(x,
za).RF().MenuSectionList):ja.MenuSectionList.push(za.h7b());return ja}}Object(u.a)(E,"RibbonMenu",null,[290,289]);var G=a(570);class F{constructor(){this.title=null;this.aZ=[];this.Fq="Menu16";this.Aog=this.kjg=this.ljg=!0}get buttons(){return this.aZ}kV(){return z.r(this.h7b())}h7b(){const ja=Object(d.a)(new G.a,{ControlList:[]});if(1===this.buttons.length&&Object(A.a)(286,this.buttons[0]))ja.ControlList.push(this.buttons[0].g7b());else{let ra="";for(let fb=0;fb<this.buttons.length;fb++){var za=
Object(y.a)(287,this.buttons[fb]);za&&(za=za.Jja(),ja.ControlList.push(za),ra+=za.Id)}ja.ControlsId=ra+".Controls"}ja.Title=this.title;ja.DisplayMode=this.Fq;ja.ShowMenuSectionTitleIcon=this.ljg;ja.ShowMenuSectionTitleBackground=this.kjg;ja.MenuSectionTitleFocusable=this.Aog;return ja}}Object(u.a)(F,"RibbonMenuSection",null,[288,289]);class O{constructor(ja,za,ra,fb,Ua,Ca,Ia,oa,Da,bb,Za,Xa,Ba=null){this.id=ja;this.command=ra;this.dWf=fb;this.populateOnlyOnce=Ua;this.qTa=Ca;this.Cjj=Ia;this.alt=oa;
this.t5b=Da;this.width=bb;this.S_g=Za;this.fA=Xa;this.vta=new E(za);this.itb=Ba;fb&&Ia&&(ja=new F,ja.Fq="MenuLoading",za=new r(za+"LoadingLabel"),ja.buttons.push(za),this.menu.Vc.push(ja))}kV(){return this.l7g()}get menu(){return this.vta}l7g(){let ja=z.d(this.id,this.command,this.dWf,this.populateOnlyOnce,this.qTa,this.Cjj,this.alt,this.t5b,this.width);const za=ja.indexOf(" />");ja=ja.substring(0,za);ja+=` ${"AllowDefaultContent"}="${this.S_g.toString()}"`;ja+=` ${"AutoComplete"}="${this.fA?"true":
"false"}"`;this.itb&&(ja+=` ${"ArrowImgId"}="${this.itb}"`);ja=ja+">"+this.menu.kV();return ja+"</ComboBox>"}}Object(u.a)(O,"RibbonComboBox",null,[323,289]);var M=a(1036),P=a(919),B=a(16);class D extends P.a{constructor(ja,za,ra,fb,Ua,Ca,Ia,oa,Da,bb,Za,Xa=null,Ba=null){super(ja,za,ra,Ua,Ca,Ia,oa,Za,0);this.cnb=null;this.Y$=0===Da?null:B.a.instance.ha(Da);this.nVc=bb;this.fXc=fb;this.MOg=Xa;this.zn=Ba}get description(){return this.Y$}get eAb(){return this.cnb}get menuItemId(){return this.nVc}get qTa(){return this.fXc}get styles(){return this.MOg}get data(){return this.zn}kV(){return z.n(this.Jja())}nDc(ja){this.Y$=
ja}toString(){this.eAb||(this.cnb=this.kV());return this.eAb}Jja(){const ja=new M.a;this.Wec(ja);ja.MenuItemId=this.menuItemId;ja.QueryCommand=this.qTa;ja.Description=this.description;ja.Styles=this.styles;ja.Data=this.data;return ja}}Object(u.a)(D,"RibbonComboBoxItem",P.a,[306,287,289]);var I=a(578);class S extends P.a{constructor(ja,za,ra,fb,Ua,Ca,Ia,oa){super(ja,ra,fb,Ua,Ca,Ia,oa,!1,0);this.populateOnlyOnce=!1;this.ZGb=this.menuCloseCommand=this.menuOpenCommand=this.fy=null;this.vta=new E(za);
this.Blf=!0}get menu(){return this.vta}kV(){return z.o(this.Jja())}Jja(){const ja=new I.a;this.Wec(ja);ja.PopulateOnlyOnce=this.populateOnlyOnce;ja.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();ja.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();ja.PopulateQueryCommand=this.fy;ja.KeyTip=this.ZGb;ja.Menu=this.menu.RF();ja.ImageIsVisible=this.Blf;return ja}}Object(u.a)(S,"RibbonFlyoutAnchor",P.a,[324,287,289]);var J=a(1358),L=a(595),
R=a(54);class Y{constructor(){this.W6a=[];this.id=null;this.width=0;this.title=this.Uka=null}kV(){return z.p(this.g7b())}mu(ja,za,ra,fb=0,Ua=null,Ca=null,Ia=null,oa=null,Da=null,bb=null){this.Zmf(this.W6a.length,ja,za,ra,0===fb?Da:B.a.instance.ha(fb),Ua,Ca,Ia,oa,bb)}Zmf(ja,za,ra,fb,Ua,Ca=null,Ia=null,oa=null,Da=null,bb=null){(ja>this.W6a.length||0>ja)&&Error.argumentOutOfRange("Invalid Index");this.W6a.splice(ja,0,Object(d.a)(new J.a,{Id:za,Command:ra.toString(),QueryCommand:null!==fb&&void 0!==fb?
fb:null,Alt:Ua,MenuItemId:Ca,Icon:Ia,Image:oa?R.a.dg(oa):null,ImageClass:Da,LabelText:bb}))}g7b(ja=!1){let za=null,ra=null;switch(this.Uka){case "Size120by20":za=this.bub(120,20,ja);ra=this.$tb(130,30,ja);break;case "Size90by21":za=this.bub(90,21,ja);ra=this.$tb(100,33,ja);break;case "Size24by24With7Options":za=this.bub(28,28,ja);ra=this.$tb(34,38,ja);break;case "Size24by24":za=this.bub(28,28,ja);ra=this.$tb(38,38,ja);break;case "Size112by64":za=this.bub(24,24,ja),ra=this.$tb(112,64,ja)}for(ja=0;ja<
this.W6a.length;ja++)this.W6a[ja].FullIconStyle=za;return Object(d.a)(new L.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.Uka,GalleryItems:this.W6a,GalleryStyle:ra})}bub(ja,za,ra){const fb={},Ua={};Ua.width=ja;Ua.height=za;ra&&(Ua.alignSelf="center",Ua.marginBottom="4px");fb.root=Ua;return fb}$tb(ja,za,ra){const fb={},Ua={},Ca={};Ca.width=ja;Ca.height=za;Ua.root=Ca;ra&&(Ua.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});
fb.galleryButtonInExpanded=Ua;return fb}}Object(u.a)(Y,"RibbonGallery",null,[286,289]);var Q=a(1027),W=a(737);class Ga{constructor(ja=null){this.MC=ja}ur(ja=null){return new E(ja)}jd(){return new F}Kb(ja){var za=n.a.nd(Ga.U2a,ja.toString());if(za)return za;switch(ja){case 236:return this.Jn(ja,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.Jn(ja,"ContextMenu.Show.IdeasNLPane",-1336341324,744);case 238:return this.Jn(ja,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.vd(ja,
"ContextMenu.Show.ChartTaskPane",1221897806,l.a.F0e,4,983);case 287:return this.vd(ja,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.Ti(ja,"DataLabels.None.BoxWhisker",374300079,l.a.n0e,929,930,1600);case 0:return this.Ti(ja,"DataLabels.None.Column",374300079,l.a.m0e,929,930,1600);case 1:return this.Ti(ja,"DataLabels.None.Line",374300079,l.a.o0e,929,930,1600);case 2:return this.Ti(ja,"DataLabels.None.Pie",374300079,l.a.p0e,929,930,
1600);case 3:return this.Ti(ja,"DataLabels.Show.Column",-1809877936,l.a.aec,931,932,1601);case 143:return this.Ti(ja,"DataLabels.Show.Funnel",-1809877936,l.a.aec,931,934,1601);case 144:return this.Ti(ja,"DataLabels.Show.Treemap",-1809877936,l.a.Vgd,931,938,1601);case 145:return this.Ti(ja,"DataLabels.Show.Sunburst",-1809877936,l.a.Ugd,931,934,1601);case 4:return this.Ti(ja,"DataLabels.Center.Column",-1996266048,l.a.aec,933,934,1602);case 5:return this.Ti(ja,"DataLabels.Center.Line",-1996266048,l.a.h0e,
933,934,1602);case 6:return this.Ti(ja,"DataLabels.Center.Pie",-1996266048,l.a.Ugd,933,934,1602);case 7:return this.Ti(ja,"DataLabels.InsideEnd.Column",493396546,l.a.i0e,935,936,1603);case 8:return this.Ti(ja,"DataLabels.InsideEnd.Pie",493396546,l.a.j0e,935,936,1603);case 9:return this.Ti(ja,"DataLabels.InsideBase.Column",1599247052,l.a.Vgd,937,938,1604);case 10:return this.Ti(ja,"DataLabels.OutsideEnd.Column",342855531,l.a.q0e,939,940,1605);case 11:return this.Ti(ja,"DataLabels.OutsideEnd.Pie",342855531,
l.a.r0e,939,940,1605);case 140:return this.Ti(ja,"DataLabels.Left.BoxWhisker",-472675112,l.a.l0e,941,942,1606);case 12:return this.Ti(ja,"DataLabels.Left.Line",-472675112,l.a.k0e,941,942,1606);case 142:return this.Ti(ja,"DataLabels.Right.BoxWhisker",-1774499423,l.a.t0e,943,944,1607);case 13:return this.Ti(ja,"DataLabels.Right.Line",-1774499423,l.a.s0e,943,944,1607);case 138:return this.Ti(ja,"DataLabels.Above.BoxWhisker",-204160914,l.a.d0e,945,946,1608);case 14:return this.Ti(ja,"DataLabels.Above.Line",
-204160914,l.a.u0e,945,946,1608);case 139:return this.Ti(ja,"DataLabels.Below.BoxWhisker",-87783054,l.a.e0e,947,948,1609);case 15:return this.Ti(ja,"DataLabels.Below.Line",-87783054,l.a.g0e,947,948,1609);case 16:return this.Ti(ja,"DataLabels.BestFit.Pie",1650379138,l.a.f0e,949,950,1610);case 17:return this.Ti(ja,"Axes.Horizontal.None",895828731,l.a.T_e,929,951,1613);case 18:return this.Ti(ja,"Axes.Horizontal.ShowLTR",683614408,l.a.Sgd,952,953,1614);case 19:return this.Ti(ja,"Axes.Horizontal.NoLabels",
-1612014670,l.a.S_e,956,957,1615);case 20:return this.Ti(ja,"Axes.Horizontal.ShowRTL",1259259728,l.a.U_e,958,959,1616);case 21:return this.Ti(ja,"Axes.Horizontal.Default",683614408,l.a.Sgd,954,955,1617);case 22:return this.Ti(ja,"Axes.Horizontal.Thousands",-220179662,l.a.V_e,960,961,1618);case 23:return this.Ti(ja,"Axes.Horizontal.Millions",1534680966,l.a.R_e,962,963,1619);case 24:return this.Ti(ja,"Axes.Horizontal.Billions",-238895611,l.a.P_e,964,965,1620);case 25:return this.Ti(ja,"Axes.Horizontal.LogScale",
-892714755,l.a.Q_e,966,967,1621);case 26:return this.Ti(ja,"Axes.Vertical.None",2006508979,l.a.$_e,929,951,1613);case 27:return this.Ti(ja,"Axes.Vertical.Default",252405382,l.a.b0e,954,955,1617);case 28:return this.Ti(ja,"Axes.Vertical.Thousands",670842692,l.a.c0e,960,961,1618);case 29:return this.Ti(ja,"Axes.Vertical.Millions",-572426128,l.a.Y_e,962,963,1619);case 30:return this.Ti(ja,"Axes.Vertical.Billions",-806496391,l.a.W_e,964,965,1620);case 31:return this.Ti(ja,"Axes.Vertical.LogScale",-1700998151,
l.a.X_e,966,967,1621);case 32:return this.Ti(ja,"Axes.Vertical.NoLabels",2104548628,l.a.Z_e,956,957,1615);case 33:return this.Ti(ja,"Axes.Vertical.ShowRTL",1717508862,l.a.a0e,958,959,1616);case 34:return this.Ti(ja,"Gridlines.Horizontal.None",80515665,l.a.z0e,929,970,1624);case 35:return this.Ti(ja,"Gridlines.Horizontal.Major",-306129902,l.a.w0e,972,973,1625);case 36:return this.Ti(ja,"Gridlines.Horizontal.Minor",2147076534,l.a.x0e,975,976,1626);case 37:return this.Ti(ja,"Gridlines.Horizontal.MajorMinor",
-1253752845,l.a.y0e,978,979,1627);case 38:return this.Ti(ja,"Gridlines.Vertical.None",1711257557,l.a.E0e,929,971,1624);case 39:return this.Ti(ja,"Gridlines.Vertical.Major",-1772953364,l.a.B0e,972,974,1625);case 40:return this.Ti(ja,"Gridlines.Vertical.Minor",680253336,l.a.C0e,975,977,1626);case 41:return this.Ti(ja,"Gridlines.Vertical.MajorMinor",-215161981,l.a.D0e,978,980,1627);case 135:return this.vd(ja,"ContextMenu.NumberFormating",2105621672,l.a.Jgd,1,476,135!==ja);case 300:return this.vd(ja,
"ContextMenu.FormatCells",2055979337,null,1,477,300!==ja,void 0,"PaintBrushandBucket_20");case 136:return this.vd(ja,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,l.a.Jgd,1,476,136!==ja);case 42:return this.vd(ja,"ContextMenu.Cut",-1985798686,l.a.p_e,1,12);case 43:return this.vd(ja,"ContextMenu.Copy",-911352779,l.a.o_e,1,11);case 212:return this.vd(ja,"ContextMenu.InsertCopiedCells",-160032004,l.a.lhd,3,15);case 213:return this.vd(ja,"ContextMenu.InsertCutCells",-1065525230,l.a.lhd,3,
21);case 44:case 57:return this.vd(ja,"ContextMenu.Paste",237279923,l.a.Ngd,1,13,44!==ja,"Paste");case 248:return this.vd(ja,"PasteAdvancedOptionsGallery",237279923,l.a.Ngd,1,13,44!==ja,"Paste");case 45:case 120:return this.vd(ja,"ContextMenu.EditHyperlink",-1583422759,l.a.ahd,8,1140,45!==ja,"EditHyperlink");case 46:case 121:return this.vd(ja,"ContextMenu.InsertHyperlink",-1583422759,l.a.ahd,8,1141,46!==ja,"InsertHyperlink");case 47:case 122:return this.vd(ja,"ContextMenu.RemoveHyperlink",-1253126584,
l.a.dhd,8,1142,47!==ja,"RemoveHyperlink");case 48:case 123:return this.vd(ja,"ContextMenu.RemoveHyperlinks",-1253126584,l.a.dhd,8,1143,48!==ja,"RemoveHyperlinks");case 250:return this.Jn(ja,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.vd(ja,"ContextMenu.InsertCellsShiftRight",1035996630,l.a.y_e,1,165===ja||173===ja?341:342,173===ja||188===ja,"InsertCellsShiftRight");case 166:case 174:return this.vd(ja,"ContextMenu.InsertCellsShiftDown",1035996630,
l.a.x_e,1,344,166!==ja,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.vd(ja,"ContextMenu.DeleteCellsShiftLeft",1035996630,l.a.s_e,1,167===ja||175===ja?342:341,175===ja||190===ja,"DeleteCellsShiftLeft");case 168:case 176:return this.vd(ja,"ContextMenu.DeleteCellsShiftUp",1035996630,l.a.t_e,1,343,168!==ja,"DeleteCellsShiftUp");case 177:case 181:return this.vd(ja,"ContextMenu.InsertRowsSheet",-1113896058,l.a.Kgd,1,429,177!==ja,"InsertRows");case 49:case 116:return this.vd(ja,
"ContextMenu.InsertRows",-1113896058,l.a.Kgd,1,346,49!==ja,"InsertRows");case 161:case 169:return this.vd(ja,"ContextMenu.InsertRowsTable",942362098,l.a.A_e,1,421,161!==ja,"InsertRowsTable");case 50:case 117:return this.vd(ja,"ContextMenu.InsertColumns",1415868706,l.a.Gyb,1,406,50!==ja,"InsertColumns");case 288:case 289:return this.vd(ja,"ContextMenu.InsertColumns",1415868706,l.a.Gyb,1,408,288!==ja,"InsertColumns");case 178:case 182:return this.vd(ja,"ContextMenu.InsertColumnsSheet",1415868706,l.a.Gyb,
1,426,178!==ja,"InsertColumns");case 290:case 291:return this.vd(ja,"ContextMenu.InsertColumnsSheet",1415868706,l.a.Gyb,1,428,290!==ja,"InsertColumns");case 191:case 192:case 162:case 170:return this.vd(ja,"ContextMenu.InsertColumnsTable",622604322,l.a.z_e,1,162===ja||170===ja?419:420,170===ja||192===ja,"InsertColumnsTable");case 179:case 183:return this.vd(ja,"ContextMenu.DeleteRowsSheet",1554436520,l.a.Xdc,1,429,179!==ja,"DeleteRows");case 51:case 118:return this.vd(ja,"ContextMenu.DeleteRows",
1554436520,l.a.Xdc,1,410,51!==ja,"DeleteRows");case 163:case 171:return this.vd(ja,"ContextMenu.DeleteRowsTable",1405456548,l.a.Xdc,1,418,163!==ja,"DeleteRowsTable");case 180:case 184:return this.vd(ja,"ContextMenu.DeleteColumnsSheet",674605324,l.a.Wdc,1,426,180!==ja,"DeleteColumns");case 52:case 119:return this.vd(ja,"ContextMenu.DeleteColumns",674605324,l.a.Wdc,1,411,52!==ja,"DeleteColumns");case 164:case 172:return this.vd(ja,"ContextMenu.DeleteColumnsTable",284490184,l.a.Wdc,1,417,164!==ja,"DeleteColumnsTable");
case 53:case 124:return this.Jn(ja,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==ja,"OpenHyperlink");case 263:return this.vd(ja,"SheetOpsContextMenu.ShowChanges",1834994092,l.a.ehd,8,443,void 0,k.a.bXj);case 264:return this.vd(ja,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.vd(ja,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.vd(ja,"GridContextMenu.ShowChanges",1834994092,
l.a.ehd,8,443,void 0,k.a.Ohg);case 54:return this.vd(ja,"ContextMenu.InsertSheet",-1935155518,l.a.B_e,1,514);case 56:case 127:return this.vd(ja,"ContextMenu.DeleteSheet",1880294140,l.a.v_e,1,515,56!==ja,"DeleteSheet");case 55:return this.Jn(ja,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Jn(ja,"ContextMenu.ReorderSheet",-383100692,517,125!==ja,"ReorderSheet");case 158:return this.Jn(ja,"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.Jn(ja,"ContextMenu.HideSheet",
1458540255,519,112!==ja,"HideSheet");case 113:case 115:return this.Jn(ja,"ContextMenu.UnhideSheet",1129633328,520,113!==ja,"UnhideSheet");case 277:return this.vd(ja,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.vd(ja,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.vd(ja,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Jn(ja,
"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.vd(ja,"ContextMenu.PivotExpand",-1687560254,l.a.Pgd,9,1168);case 244:return this.vd(ja,"ContextMenu.PivotCollapse",1176256599,l.a.Ogd,9,1169);case 245:return this.vd(ja,"ContextMenu.PivotExpandEntireField",-1751201991,l.a.Pgd,9,1170);case 246:return this.vd(ja,"ContextMenu.PivotCollapseEntireField",-232434744,l.a.Ogd,9,1171);case 247:return this.vd(ja,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");
case 301:return this.vd(ja,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,W.a.mij);case 59:return this.vd(ja,"ContextMenu.PivotFieldListShow",2140436015,l.a.Qgd,9,1173);case 58:return this.vd(ja,"ContextMenu.PivotFieldListHide",-1006032470,l.a.Qgd,9,1174);case 258:return this.vd(ja,"ContextMenu.PivotSettingsPaneShow",1529441790,l.a.Iyb,17,636);case 257:return this.vd(ja,"ContextMenu.PivotSettingsPaneHide",1529441790,l.a.Iyb,17,637);case 259:return this.Jn(ja,"ContextMenu.PivotTableNoSubtotal",
-2016405815,638);case 260:return this.Jn(ja,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.Jn(ja,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return za=60!==ja,this.Jn(ja,za?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,za,null);case 61:case 65:return za=61!==ja,this.Jn(ja,za?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,za,null);case 62:case 66:return za=62!==ja,
this.Jn(ja,za?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,za,null);case 63:case 67:return za=63!==ja,this.Jn(ja,za?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,za,null);case 68:case 72:return za=68!==ja,this.vd(ja,za?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,l.a.Sdc,9,1093,za,null);case 69:case 73:return za=69!==ja,this.vd(ja,za?"ContextMenu.FieldWellMoveToRowLabelsDisabled":
"ContextMenu.FieldWellMoveToRowLabels",74086617,l.a.i6a,9,1094,za,null);case 70:case 74:return za=70!==ja,this.vd(ja,za?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,l.a.h6a,9,1095,za,null);case 71:case 75:return za=71!==ja,this.vd(ja,za?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,l.a.Tdc,9,1098,za,null);case 76:return this.vd(ja,"ContextMenu.FieldWellRemoveField",-1092351914,l.a.q_e,9,1099);case 77:return this.vd(ja,
"ContextMenu.FieldWellValueFieldSettings",-2141589616,l.a.O_e,9,1100);case 79:case 83:return this.vd(ja,"ContextMenu.FieldListMoveToReportFilter",359279088,l.a.Sdc,9,1082,79!==ja,null);case 80:case 84:return this.vd(ja,"ContextMenu.FieldListMoveToRowLabels",-67292059,l.a.i6a,9,1083,80!==ja,null);case 81:case 85:return this.vd(ja,"ContextMenu.FieldListMoveToColumnsLabels",745182485,l.a.h6a,9,1084,81!==ja,null);case 82:case 86:return this.vd(ja,"ContextMenu.FieldListMoveToValues",926905850,l.a.Tdc,
9,1087,82!==ja,null);case 95:case 97:return za=95!==ja,this.vd(ja,za?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,l.a.i6a,9,1096,za,null);case 96:case 98:return za=96!==ja,this.vd(ja,za?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,l.a.h6a,9,1097,za,null);case 78:return this.vd(ja,"ContextMenu.FieldListAddAsSlicer",547535945,l.a.Hgd,9,1088);case 91:case 93:return this.vd(ja,
"ContextMenu.FieldListMoveToRowChartLabels",-67292059,l.a.i6a,9,1085,91!==ja,null);case 92:case 94:return this.vd(ja,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,l.a.h6a,9,1086,92!==ja,null);case 99:return this.vd(ja,"ContextMenu.BIExploreShowCallout",1529658657,l.a.Udc,9,1193);case 100:return this.vd(ja,"ContextMenu.ContextMenuRefresh",2054778433,l.a.I_e,9,1181);case 102:return this.vd(ja,"ContextMenu.EditCell",324156914,l.a.chd,8,579);case 101:return this.vd(ja,"Contextenu.DeleteChart",
2045211913,l.a.Zgd,8,578);case 146:return this.vd(ja,"Contextenu.AltText",1804967129,l.a.$gd,8,817);case 302:return this.vd(ja,"ContextMenu.CellImageAltText",1516436924,l.a.$gd,8,817);case 147:return this.vd(ja,"ContextMenu.EditShapeText",-445658892,l.a.P0e,8,818);case 186:return this.vd(ja,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.vd(ja,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",W.a.bringForward);case 282:return this.vd(ja,"ContextMenu.BringToFront",
-1480025782,null,8,822,!1,"ContextMenu.BringToFront",W.a.bringToFront);case 283:return this.vd(ja,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",W.a.sendBackward);case 284:return this.vd(ja,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",W.a.sendToBack);case 273:return this.vd(ja,"ContextMenu.OfficeScriptsViewScript",-585097204,l.a.j_e,8,2151);case 160:return this.vd(ja,"ContextMenu.InsertComment",-1667294294,l.a.R0e,8,1146);case 221:return this.vd(ja,
"ContextMenu.DeleteComment",467845448,l.a.O0e,8,1162);case 159:return this.vd(ja,"ContextMenu.InsertReply",-1667294294,l.a.S0e,8,1145);case 226:return this.vd(ja,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20");case 227:return this.vd(ja,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.vd(ja,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.vd(ja,"ContextMenu.ShowOrHideNote",
1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Jn(ja,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.rR(ja,"Form.InsertForm",1305810481,l.a.Mgd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.rR(ja,"Form.ViewForm",330035228,l.a.Mgd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.rR(ja,"Form.EditForm",1305810481,l.a.w_e,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.rR(ja,"Form.DeleteForm",-509039657,l.a.r_e,1,"Image16by16",
1270,0,null,!1,1598);case 106:return this.rR(ja,"Form.ShareForm",1334518759,l.a.K_e,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.Jn(ja,"ContextMenu.ClearContent",-848953656,445,148!==ja);case 150:case 151:return this.vd(ja,"ContextMenu.RowHeight",2040891415,l.a.T0e,8,434,151===ja);case 152:case 153:return this.vd(ja,"ContextMenu.ColumnWidth",957527587,l.a.N0e,8,433,153===ja);case 108:case 154:return this.Jn(ja,"ContextMenu.HideRows",1051390410,432,154===ja);case 110:case 156:return this.Jn(ja,
"ContextMenu.UnhideRows",1542466017,439,156===ja);case 109:case 155:return this.Jn(ja,"ContextMenu.HideColumns",-706918724,438,155===ja);case 111:case 157:return this.Jn(ja,"ContextMenu.UnhideColumns",369708605,440,157===ja);case 216:return this.Jn(ja,"ContextMenu.ShowCard",-843616717,1786,216!==ja);case 217:return this.Jn(ja,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.vd(ja,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.vd(ja,
"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.vd(ja,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Jn(ja,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===ja);case 218:case 269:return this.Jn(ja,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===ja);case 220:case 271:return this.Jn(ja,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===
ja);case 219:case 270:return this.Jn(ja,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===ja);case 234:return this.vd(ja,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.vd(ja,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.vd(ja,"ContextMenu.FilterByValue",1803952894,null,1,222);case 223:return this.vd(ja,"ContextMenu.SortAscending",-1010737776,l.a.M_e,1,228);case 292:return this.Jn(ja,
"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.Jn(ja,"ContextMenu.PutSelectedFontColorOnTop",-764711886,231);case 294:return this.Jn(ja,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.vd(ja,"ContextMenu.SortDescending",2123420468,l.a.N_e,1,229);case 225:return this.vd(ja,"ContextMenu.SortCustom",-207540907,l.a.$dc,1,233);case 232:return this.vd(ja,"ContextMenu.ConvertToRange",323142015,l.a.n_e,1,740);case 272:return this.vd(ja,"ContextMenu.ShowOpenInAppDialogOnMobile",
213236505,l.a.chd,8,661);case 239:return this.vd(ja,"ContextMenu.IgnoreError",886009118,l.a.bhd,8,2112,239!==ja);case 240:return this.vd(ja,"ContextMenu.IgnoreErrors",886009118,l.a.bhd,8,2113,240!==ja);case 241:return this.Jn(ja,"ContextMenu.ShowError",-1779556985,2114,241!==ja);case 251:return this.vd(ja,"ContextMenu.SlicerRefresh",-231711729,l.a.H_e,0,2177,251!==ja);case 252:return this.vd(ja,"ContextMenu.SlicerClearFilter",-1909381757,l.a.u_e,0,2178,252!==ja);case 254:return this.Jn(ja,"ContextMenu.SlicerDelete",
2045211913,2181,254!==ja);case 253:return this.vd(ja,"ContextMenu.SlicerMultiSelect",2108047455,l.a.Lgd,0,2180,253!==ja);case 255:return this.vd(ja,"ContextMenu.SlicerSortAscending",-923375148,l.a.bec,8,2183,255!==ja);case 256:return this.vd(ja,"ContextMenu.SlicerSortDescending",1164937340,l.a.cec,8,2182,256!==ja);case 267:return this.vd(ja,"ContextMenu.SlicerSettingsPaneShow",522377926,l.a.Iyb,17,636);case 266:return this.vd(ja,"ContextMenu.SlicerSettingsPaneHide",522377926,l.a.Iyb,17,637);case 128:return this.Xva(ja,
-619033944,1,1438);case 129:return this.Xva(ja,-619033944,2,1440);case 130:return this.Xva(ja,-619033944,3,1442);case 131:return this.Xva(ja,-619033944,4,1443);case 132:return this.v5(ja,-1736601456,7,1447);case 133:return this.v5(ja,-1736601456,8,1449);case 134:return this.v5(ja,-1736601456,0,1450);case 196:return this.Xva(ja,-2136556471,1,1438);case 198:return this.Xva(ja,-2136556471,2,1440);case 200:return this.Xva(ja,-2136556471,3,1442);case 201:return this.Xva(ja,-2136556471,4,1443);case 204:return this.v5(ja,
1201641489,0,1447);case 205:return this.v5(ja,1201641489,1,1448);case 206:return this.v5(ja,1201641489,7,1449);case 207:return this.v5(ja,1201641489,2,1450);case 208:return this.v5(ja,1201641489,4,1451);case 209:return this.v5(ja,1201641489,3,1452);case 210:return this.v5(ja,1201641489,5,1453);case 211:return this.v5(ja,1201641489,6,1454);case 274:return this.vd(ja,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,"ShareSectionEntry_20");case 275:return this.vd(ja,"ContextMenu.ShareRange",
-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.vd(ja,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");case 299:return this.vd(ja,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 285:return this.vd(ja,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.vd(ja,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20")}return null}rR(ja,
za,ra,fb,Ua,Ca,Ia,oa,Da,bb,Za,Xa=null){za=new v.a(za,Ia,ra,null,Ua,fb,Ca,Ia,oa,Da,bb,Za,!0,Xa);return Ga.U2a[ja.toString()]=za}vd(ja,za,ra,fb,Ua,Ca,Ia=!1,oa=null,Da=null){return this.rR(ja,za,ra,Da?null:fb,Ua,"Image16by16",Ca,0,oa,Ia,0,Da)}tbd(ja,za,ra,fb,Ua,Ca=null){return new D(ja,0,-1006427574,null,ra,za,fb,0,0,Ua,!1,null,Ca)}bbd(ja,za=""){return new r(ja,za)}Jlh(ja,za,ra,fb){return new Q.a(ja,0,za,null,8,null,"None",0,0,null,!1,0,ra,fb)}bLa(ja,za,ra,fb,Ua,Ca,Ia,oa=null,Da=!1){let bb=n.a.nd(Ga.U2a,
ja);if(bb)return bb;bb=new v.a(ja,0,ra,null,3,null,"None",0,0,Ca,Ia,0);bb.uT(za);bb.label=za;bb.nDc(Da?null:za);bb.bRb(Ua,fb,oa);return Ga.U2a[ja]=bb}uRd(ja){this.Avd(ja)&&delete Ga.U2a[ja]}Avd(ja){return ja in Ga.U2a}Aw(ja,za,ra,fb){ja=new S(ja,za,0,fb,3,null,"None",0);ja.uT(ra);ja.label=ra;return ja}Aad(ja,za,ra,fb,Ua,Ca){ja=new S(ja,za,0,fb,Ua,Ca,"Image16by16",0);ja.uT(ra);ja.label=ra;return ja}brh(ja,za,ra,fb,Ua=null){return new O(ja,za,"1726517890",!0,!1,null,"PopulateNameBoxMenu",ra,!0,fb,!0,
!1,Ua)}cgf(ja){h.ULS.sendTraceTag(537153991,0,50,"RibbonControlsManager.GetXmlForControl: Generating control xml from control props");if(ja)return ja.kV();h.ULS.sendTraceTag(537153989,0,10,"RibbonControlsManager.GetXmlForControl: control is null");return null}xad(ja,za=null,ra=null,fb=null,Ua=null){return new x(this.MC,ja,null,null,za,null,ra,fb,Ua)}$D(ja,za,ra=null,fb=null){return Object(d.a)(new Y,{id:ja,width:za,Uka:ra,title:fb})}Ti(ja,za,ra,fb,Ua,Ca,Ia){return this.rR(ja,za,ra,fb,4,"Image32by32",
Ua,Ca,null,!1,Ia)}Jn(ja,za,ra,fb,Ua=!1,Ca=null){return this.rR(ja,za,ra,null,1,"None",fb,0,Ca,Ua,0)}kOe(ja,za,ra,fb,Ua,Ca){return this.rR(ja,za,ra,fb,4,"Image16by16",Ua,0,Ca.toString(),!1,0)}v5(ja,za,ra,fb){return this.kOe(ja,"OutlineDashStylePresent,"+ra,za,l.a.Vdc,fb,ra)}Xva(ja,za,ra,fb){return this.kOe(ja,"OutlineWidthPresent,"+ra,za,l.a.Zdc,fb,ra)}}Ga.U2a={};Object(u.a)(Ga,"RibbonControlsManager",null,[255]);var pa=a(100),aa=a(1),Z=a(149),fa=a(36);class ya extends b.a{constructor(ja){super();
this.Ya=null;this.$=ja;this.kc()}create(){var ja=this.$;const za=f.GetServiceTaskFactory.create(ja.da,111,this.ka,this.La);ja=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(pa.d)(Z.a.resolve(fa.p,{Wa:this.La})):f.GetServiceTaskFactory.create(ja.da,155,this.ka,this.La);e.TaskExtensions.za(e.TaskExtensions.ke([za,ja],this.ka),()=>{this.Pb(this.Ya||(this.Ya=new Ga(za.result)))},this.ka,3)}static la(ja){ja.da.Ja(102,new ya(ja))}}Object(u.a)(ya,"RibbonControlsFactory",
b.a,[]);a.d(C,"a",function(){return Aa});const Aa=()=>{c.a.Fa(ya.la)}},1227:function(u,C,a){var c=a(10);u=a(0);var b=a(170),f=a(229),e=a(40),d=a(15),h=a(34),l=a(366),k=a(362),n=a(199),v=a(357),x=a(136),w=a(382),r=a(200),t=a(216),A=a(207),y=a(33),z=a(230),E=a(246),G=a(137);class F{constructor(fa,ya,Aa,ja){this.red=fa;this.green=ya;this.blue=Aa;this.alpha=ja}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(u.a)(F,"ColorObject",null,[]);class O{constructor(fa){this.KB=
this.hr=null;this.n7c=fa}get head(){return this.hr}get q3d(){return this.KB}ESe(fa){this.head&&(fa.pre?fa.next?(fa.pre.next=fa.next,fa.next.pre=fa.pre):(this.KB=fa.pre,this.q3d.next=null):fa.next?(this.hr=fa.next,this.head.pre=null):this.KB=this.hr=null,fa.next=null,fa.pre=null)}eVg(fa){this.head?(fa.next=this.head,this.hr=fa,fa.next.pre=this.head):this.KB=this.hr=fa}Jnd(){if(!this.head)return null;const fa=new n.a;let ya=this.head;for(;ya;)if(fa.add(ya.value),ya=ya.next,fa.count>this.n7c){d.ULS.sendTraceTag(537155399,
0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return fa}}Object(u.a)(O,"CustomLinkedList",null,[]);class M{constructor(fa){this.pre=this.next=null;this.value=fa}}Object(u.a)(M,"CustomLinkedListNode",null,[]);class P{constructor(fa){this.n7c=fa;this.Tsc={};this.mbb=new O(fa);this.count=0}add(fa,ya){fa&&ya?(ya=new M(ya),this.contains(fa)?this.mbb.ESe(this.Tsc[fa]):this.count<this.n7c?this.count++:(delete this.Tsc[this.mbb.q3d.value.toString()],this.mbb.ESe(this.mbb.q3d)),
this.mbb.eVg(ya),this.Tsc[fa]=ya):d.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${fa} or Value ${ya} is null.`)}Jnd(){return this.mbb.Jnd()}contains(fa){return fa?fa in this.Tsc:!1}}Object(u.a)(P,"MRUCache",null,[]);var B=a(157),D=a(16);class I extends B.a{constructor(fa,ya,Aa,ja=null){super(!1,!1,!0);this.moreColorsHelper=null;this.ggh=(za,ra)=>{this.wLe(za,ra)};this.$=fa;this.Rri=ya;this.Otd=Aa;this.xLe=ja}fh(){const fa=D.a.instance.ha(1346),ya={};ya[I.Pzg]=this.Rri;ya[I.iyg]=I.dWb;ya[I.Izg]=
I.dWb;ya[I.$Ag]=I.dWb;ya[I.PAg]=I.dWb;ya[I.tAg]=D.a.instance.ha(2105);ya[I.Czg]=D.a.instance.ha(2089);ya[I.oyg]=D.a.instance.ha(2076);ya[I.Gzg]=D.a.instance.ha(1347);ya[I.jyg]=D.a.instance.ha(1348);this.Otd!==I.kyg&&(ya[I.lyg]=I.ALPHA,ya[I.ALPHA]=this.Otd,d.ULS.sendTraceTag(537155398,0,50,`More Colors:: Initial Alpha Value : ${this.Otd}`));this.initializeAndShow(fa,this.ggh,{[I.ozg]:I.Pyg,[I.pyg]:ya})}wLe(fa,ya){ya=ya[I.JLc];1===fa&&this.yGf(A.a.bga(ya));this.xLe&&this.xLe(1===fa,1===fa?ya:null)}yGf(fa){this.moreColorsHelper||
(this.moreColorsHelper=this.$.da.Ba(398));fa=t.a.sG(A.a.BI(fa,!1));this.moreColorsHelper.DVd(fa.r,fa.g,fa.b,v.a.xLc)}}I.Pzg="initColor";I.ozg="id";I.Pyg="ColorPickerDialog";I.pyg="bodyControls";I.JLc="selectedColorText";I.Izg="hueAriaLabel";I.$Ag="transparencyAriaLabel";I.PAg="svAriaLabel";I.dWb="Use left & right arrows keys to change values in color picker & hue slider";I.ALPHA="alpha";I.wLc="alphaValue";I.iyg="alphaAriaLabel";I.lyg="alphaSliderType";I.kyg=-1;I.fAg=100;I.tAg="redLabel";I.oyg="blueLabel";
I.Czg="greenLabel";I.Gzg="hexLabel";I.jyg="alphaLabel";Object(u.a)(I,"MoreColorsDialog",B.a,[]);var S=a(7),J=a(91),L=a(530),R=a(55);class Y extends I{constructor(fa,ya,Aa,ja,za){super(fa,ja,za);this.commandName=null;this.mof=!1;this.command=ya;this.Wd=Aa;this.Iri=za}fh(){super.fh();this.commandName=R.b().jk(this.Wd.command);d.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Wd.yf}`)}wLe(fa,ya){if(1===fa)if(fa=this.$.nc.hh("UserAction",
this.commandName),fa.start(),L.a(fa),ya)if(I.JLc in ya){var Aa=ya[I.JLc];if(fa=A.a.bga(Aa)){Aa=new J.a(this.command,this.Wd.method,this.Wd.mode,this.Wd.yf,this.Wd.tabName?this.Wd.tabName:1378078823===this.command||-400966242===this.command?S.a.wCa:S.a.bT);var ja={};ja.Color=fa;ja.UILocation=this.Wd.yf;I.wLc in ya&&(this.Iri!==ya[I.wLc]&&(this.mof=!0),ja.Alpha=(ya[I.wLc]/I.fAg).toString(),d.ULS.sendTraceTag(537155359,0,50,`Alpha Value selected from the MoreColors Dialog: ${ja.Alpha}`));this.$.Ia.$b(Aa,
ja);this.$.Wf();this.yGf(fa);ya={["Command"]:this.commandName,["Location"]:this.Wd.yf};ya.AlphaApplied=this.mof.toString();G.b(this.$).Ld(x.a.zWi,ya,null,!0)}else this.hide(),d.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Aa}, Command: ${this.commandName}`)}else this.hide(),d.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),d.ULS.sendTraceTag(537155362,0,
10,`Dictionary is null Command: ${this.commandName}`)}}Object(u.a)(Y,"MoreColorsRibbonDialog",I,[]);var Q=a(58);const W=(fa,ya,Aa,ja,za,ra,fb,Ua,Ca,Ia=null)=>{Ia=fa.Pa(9,Ia);Ia.bRed=ya;Ia.bGreen=Aa;Ia.bBlue=ja;Ia.bAlpha=za;return Q.g(fa,"SaveMRUColor",Ia,ra,fb,Ua,Ca,0)},Ga=(fa,ya,Aa,ja,za,ra=null)=>{ra=fa.Pa(1,ra);return Q.g(fa,"GetMRUColors",ra,ya,Aa,ja,za,4)};class pa{constructor(fa,ya){this.Xoe="00FFFF";this.Yoe="0000FF";this.S0f="00FFFF";this.T0f="BF7000";this.ATa=null;this.jbf=!1;this.Fke=null;
this.l6i=Aa=>{if(!z.a(Aa)){Aa=Aa.Result;this.ATa=new P(10);for(let za=Aa.length-1;0<=za;za--){var ja=Aa[za];ja=new F(ja.Red,ja.Green,ja.Blue,ja.Alpha);this.ATa.add(ja.toString(),ja)}this.aWf();d.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.k6i=()=>{d.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.KE=()=>{this.qid()};this.$=fa;this.WHb=ya;this.$.da.Ja(398,
this);this.$.ea.Of?this.qid():this.$.ea.nk(this.KE)}get SHb(){return this.Fke}get BTa(){return this.Xoe}set BTa(fa){this.Xoe=fa}get jfb(){return this.Yoe}set jfb(fa){this.Yoe=fa}get Iyc(){return this.S0f}set Iyc(fa){this.S0f=fa}get Jyc(){return this.T0f}set Jyc(fa){this.T0f=fa}IHb(fa,ya,Aa,ja=-1){return this.WHb?e.TaskExtensions.za(this.WHb,()=>{(new Y(this.$,fa,ya,Aa,ja)).fh()},this.$.ka):null}kMi(fa,ya=-1,Aa=null){this.WHb&&e.TaskExtensions.za(this.WHb,()=>{(new I(this.$,fa,ya,Aa)).fh()},this.$.ka)}nci(fa){let ya=
null;switch(fa){case "QueryRecentFillColor":ya=this.BTa;break;case "QueryRecentFontColor":ya=this.jfb;break;case "QueryRecentShapesFillColor":ya=this.Iyc;break;case "QueryRecentShapesOutlineColor":ya=this.Jyc}return ya?h.a.S7a(ya):null}dispose(){this.WHb=null;this.$&&this.$.ea.Pm(this.KE)}qid(){if(this.$.isEditMode)if(this.ATa)this.aWf();else{this.jbf&&d.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");
var fa=this.$.qa.va;this.$.userOperationManager.kd(new r.a(1009,0,(ya,Aa,ja)=>Ga(fa,E.b.call(null,ya,this.l6i),E.a.call(null,Aa,this.k6i),ja,null),80),null);this.jbf=!0}}aWf(){var fa=this.ATa.Jnd();if(fa){this.Fke=new n.a;for(let ya of fa)fa=ya,fa=new t.a(fa.red,fa.green,fa.blue),this.SHb.add(A.a.YJ(fa))}}DVd(fa,ya,Aa,ja){this.ATa||(this.ATa=new P(10));const za=new F(fa,ya,Aa,ja);this.ATa.add(za.toString(),za);this.saveMRUColor(null,fa,ya,Aa,ja)}Ffa(fa,ya,Aa){(fa||this.$.isEditMode)&&this.fhg(fa.SqmControlId)&&
(fa=t.a.sG(A.a.BI(ya,!1)))&&(this.DVd(fa.r,fa.g,fa.b,v.a.xLc),Aa={["Command"]:R.b().jk(Aa.command),["Location"]:l.a[Aa.yf],["InputMethod"]:k.a[Aa.method]},G.b(this.$).Ld(x.a.Ffa,Aa,null,!0))}fhg(fa){return!!fa&&fa.startsWith("RecentColorPicker")}saveMRUColor(fa,ya,Aa,ja,za){return w.a(this.$.userOperationManager,(ra,fb,Ua)=>W(this.$.qa.va,ya,Aa,ja,za,E.b(ra,pa.Maj()),E.a(fb,pa.Laj()),Ua,null),ra=>new r.a(1008,0,ra),fa)}static Maj(){return fa=>{y.a.Zf(fa.Errors)?d.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):
d.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static Laj(){return()=>{d.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(u.a)(pa,"MoreColorsHelper",null,[421,2]);class aa extends f.a{constructor(fa){super();this.$=fa;this.kc()}create(){const fa=new b.a;this.$.wA(Aa=>{Aa=Aa.Oyf();e.TaskExtensions.za(Aa,()=>{fa.setResult(!0)},this.$.ka)});const ya=fa.task;this.Pb(this.$.da.Ba(398)||
new pa(this.$,ya))}static la(fa){fa.da.Ja(397,new aa(fa))}}Object(u.a)(aa,"MoreColorsHelperFactory",f.a,[]);a.d(C,"a",function(){return Z});const Z=()=>{c.a.Fa(fa=>{aa.la(fa)})}},1265:function(u,C,a){u={};a.r(u);a.d(u,"ThemesManager",function(){return G});var c=a(10),b=a(0),f=a(229),e=a(119),d=a(15),h=a(781),l=a(216),k=a(207),n=a(33),v=a(230),x=a(199);class w{constructor(){this.uPg=new x.a;this.vPg=new x.a}get KWa(){return this.uPg}get Wng(){return this.vPg}get rH(){return this.P5j}YUg(P,B){this.KWa.add(P);
this.Wng.add(B)}ZUg(P,B){this.P5j={UFd:P,GEd:B}}}Object(b.a)(w,"ThemeInfoCache",null,[]);var r=a(58);const t=(P,B,D,I,S,J=null)=>{J=P.Pa(1,J);return r.g(P,"GetThemeInfoOld",J,B,D,I,S,4)},A=(P,B,D,I,S,J=null)=>{J=P.Pa(1,J);return r.g(P,"GetThemeInfo",J,B,D,I,S,4)};var y=a(1),z=a(149),E=a(36);let G=class{constructor(P){this.KWa=this.EM=null;this.mnc=!1;this.Q3d=null;this.vsc=new Set;this.Pib=this.ETc=!1;this.Zyb=0;this.yMf=B=>{this.mnc=!1;if(!B||v.a(B))d.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${B?
n.a.Ic(B.Errors):"(no result)"}]`),this.Pyd&&this.n8f();else if(this.Pyd&&(this.Zyb=0),B=B.Result){this.Gm&&null!==this.EM&&this.Dhh(B);this.EM=new w;if(this.BE){this.KWa=B.ThemeColors;this.Q3d=[];for(var D=0;10>D;D++)this.Q3d.push(h.a.RNa(l.a.sG(this.KWa[D])));for(D=0;6>D;D++)for(let I=0;10>I;I++){const S=k.a.bga(k.a.tH(this.KWa[10*D+I])),J=h.a.K9h(D,I,this.Q3d[I],this.KWa[I]);this.EM.YUg(S,J)}}this.Gm&&(this.EM.ZUg(B.MinorFont,B.MajorFont),this.Pib=!1);this.ETc=!1;this.Kfa()}else d.ULS.sendTraceTag(556656003,
0,10,"ThemesManager: The obtained ThemeInfo is null")};this.xMf=()=>{this.mnc=!1;this.Pyd&&this.n8f()};this.n8f=()=>{3>this.Zyb?(this.Zyb++,d.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.Zyb}`),this.Oec(null,!0)):(this.Zyb=0,d.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.xvc=()=>{this.EM&&(d.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),
this.Gm?this.Pib=!0:this.EM=null,this.Oec(null,!0))};this.zd=(B,D)=>{this.EM&&(d.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),D.FG&&(this.ETc=!0))};this.Cz=()=>{this.vsc.clear()};this.$=P;this.$.ea.DK(this.xvc);this.$.ea.pk(this.zd);this.$.Ia.m1a(this.Cz);this.BE=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Gm=y.EwaSettings.Gm();this.Pyd=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7396333_RetryFetchThemeInfoApi")}get Qib(){return!this.EM||
this.Pib?null:this.EM.KWa}get Vng(){return!this.EM||this.Pib?null:this.EM.Wng}get rH(){return!this.EM||this.Pib?null:this.EM.rH}get Ozd(){return this.ETc}Oec(P,B=!1){if(this.$.isEditMode||B)if(!this.EM||this.Ozd||this.Pib)P&&""!==P&&this.vsc.add(P),this.mnc||(this.mnc=!0,y.EwaSettings.isChangeGateEnabled("OfficeVSO:7629234_ChangeGetThemeInfoOperationBehavior")?A(this.$.qa.va,this.yMf,this.xMf,null,null):t(this.$.qa.va,this.yMf,this.xMf,null,null))}getThemeColor(P){let B,D=-1;B=-1;if(!this.Qib)return d.ULS.sendTraceTag(537150475,
0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,mEa:B};for(let I=0;I<this.Qib.count;I++)if(P===this.Qib.ma(I)){D=I;break}if(-1!==D)return B=Math.floor(D/10),{returnValue:!0,themeIndex:D%10,mEa:B};d.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,mEa:B}}Kfa(){for(let P of this.vsc)this.$.frame.uy(P);this.vsc.clear()}Dhh(P){const B=this.EM.rH.GEd;this.EM.rH.UFd===P.MinorFont&&B===P.MajorFont||d.ULS.sendTraceTag(512230155,
0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};G=Object(e.b)([Object(z.d)(E.vb),Object(e.c)(0,Object(E.A)())],G);Object(b.a)(G,"ThemesManager",null,[232]);class F extends f.a{constructor(P){super();this.$=P;this.kc()}create(){let P=this.$.da.Ba(422);P||(P=new G(this.$),this.$.da.Ja(422,P));this.Pb(P)}static la(P){P.da.Ja(421,new F(P))}}Object(b.a)(F,"ThemesManagerFactory",f.a,[]);var O=a(71);a.d(C,"a",function(){return M});const M=()=>{c.a.Fa(P=>{Object(O.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")||
F.la(P)})};String(u);window.___1684305477439_closurehack=u},1280:function(u,C,a){u={};a.r(u);a.d(u,"OAuthManagerWrapper",function(){return w});var c={};a.r(c);var b=a(10),f=a(0),e=a(84),d=a(229),h=a(119),l=a(2),k=a(15),n=a(882),v=a(149),x=a(36);let w=class{constructor(z){this.oAuthManager=z}dD(z,E){return this.oAuthManager?this.oAuthManager.dD(z,E).then(G=>{G.IsSuccess||k.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+G.ErrorMessage+" Error code: "+G.ErrorCode+" App name: "+
z);return Object(l.a)(new n.a,{IsSuccess:G.IsSuccess,Token:G.Token,ErrorCode:G.ErrorCode,ErrorMessage:G.ErrorMessage})}):(k.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(l.a)(new n.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}oPa(){return this.oAuthManager?this.oAuthManager.oPa():null}};w=Object(h.b)([Object(v.d)(x.db),Object(h.c)(0,Object(x.cb)())],w);Object(f.a)(w,"OAuthManagerWrapper",
null,[411]);var r=a(725);class t extends d.a{constructor(z){super();this.$=z;this.kc()}create(){this.Pb(Object(r.a)(this.$.da,349,()=>new w(e.a.instance.resolve("Common.App.OAuth.IOAuthManager"))))}static la(z){z.da.Ja(350,new t(z))}}Object(f.a)(t,"OAuthManagerWrapperFactory",d.a,[]);var A=a(71);Object(v.b)(x.cb)(()=>e.a.instance.resolve("Common.App.OAuth.IOAuthManager"));a.d(C,"a",function(){return y});const y=()=>{b.a.Fa(z=>{Object(A.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")||t.la(z)})};
String(u);String(c);window.___1684305470839_closurehack=u;window.___1684305470839_closurehack=c},1281:function(u,C,a){var c=a(10),b=a(119);u=a(0);var f=a(15),e=a(229),d=a(40),h=a(1),l=a(298),k=a(221);class n{}n.g_e="ewa-svg-icon";Object(u.a)(n,"CssClassNames",null,[]);var v=a(13),x=a(325),w=a(149),r=a(36);class t{constructor(E,G){this.oc=null;this.Ig=()=>{this.Kyf();this.$.ea.Pm(this.Ig)};this.$=E;this.Kmg={};this.Y2d={};this.oc=G;(G=this.waf("excelInitialAppSprite"))?(this.$we(G),this.$.ea.Of?this.Kyf():
E.ea.nk(this.Ig),this.$.da.Ja(388,this)):f.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.Y2d=null;this.$.ea.Pm(this.Ig)}sma(E,G,F=null,O=null){let M;(M=this.Y2d[E])||(this.Y2d[E]=M=this.Tgj(this.Kmg[E]));if(!M)return f.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${E} was not found in loaded SVG sprites.`),null;const P=M.cloneNode(!0);if(!P.style){const B=x.b(M),D=x.b(P),I={};I.iconId=E;I.isOriginalNodeStyleNull=void 0===
M.style||null===M.style;I.isOriginalNodeCurrentStyleNull=void 0===M.currentStyle||null===M.currentStyle;I.isClonedNodeCurrentStyleNull=void 0===P.currentStyle||null===P.currentStyle;I.originalNode=B.substring(0,B.indexOf(">")+1);I.clonedNode=D.substring(0,D.indexOf(">")+1);f.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(I)}`)}P.setAttribute("style",`height: ${G}px; width: ${G}px;`);O&&(E=document.createElement("title"),
this.oc?this.oc.Oh(E,O):E.textContent=O,P.insertBefore(E,P.childNodes[0]));if(F)for(const B of F)Sys.UI.DomElement.addCssClass(P,B);return P}Lda(E,G,F,O,M=0,P=0,B=null,D=null){M&&P||(P=v.DOMElementExtensions.getBoundingClientRect(O),M=P.height,P=P.width);if(B=this.sma(E,G,B,D))O.appendChild(B),(O=v.DOMElementExtensions.i0(B,"style",null))?B.setAttribute("style",O+` margin: ${(M-G)/2}px ${(P-F)/2}px;`):f.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${E}`);
return B}Kyf(){void w.a.resolve(r.x,{Wa:0}).then(E=>E("excel-uiSlice20-sprite")).then(()=>this.RUg())}RUg(){const E=this.waf("excelUiSlice20Sprite");E?this.$we(E):f.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}$we(E){for(const G of E)G.type===k.a.W2d&&(this.Kmg[G.id]=G)}Tgj(E){if(!E)return null;const G=E.viewBox;E=E.children;const F=document.createElementNS(l.a.Z2d,k.a.W2d);Sys.UI.DomElement.addCssClass(F,n.g_e);F.setAttribute("focusable","false");F.setAttribute("viewBox",
G);this.SUg(F,E);return F}SUg(E,G){for(const O of G){const M=document.createElementNS(l.a.Z2d,O.type);for(let P in O){G=P;var F=O[P];"className"===G?M.setAttribute("class",F):M.setAttribute(G,F)}E.appendChild(M)}}waf(E){return(E=window[E])?E.icons:null}}Object(u.a)(t,"SvgIconProvider",null,[424,2]);var A=a(100);class y extends e.a{constructor(E){super();this.$=E;this.kc()}create(){const E=[this.FNi()];let G=null;h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TooltipSanitizationImprovementWithSvgIconsEnabled",
!1)||(G=Object(A.d)(w.a.resolve(r.S,{Wa:0})),E.push(G));d.TaskExtensions.za(d.TaskExtensions.ke(E,this.$.ka),()=>{window.excelInitialAppSprite?this.Pb(this.$.da.Ba(388)||new t(this.$,null===G||void 0===G?void 0:G.result)):f.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}FNi(){return Object(A.d)(w.a.resolve(r.x,{Wa:this.La}).then(E=>Object(b.a)(this,void 0,void 0,function*(){return E("excel-app-intl")})))}static la(E){E.da.Ja(387,new y(E))}}Object(u.a)(y,
"SvgIconProviderFactory",e.a,[]);a.d(C,"a",function(){return z});const z=()=>{c.a.Fa(y.la)}},1309:function(u,C,a){function c(){b.a.Fa(()=>{})}u={};a.r(u);a.d(u,"IndexedDB",function(){return y});var b=a(10),f=a(119),e=a(0),d=a(15),h=a(31),l=a(170),k=a(192),n=a(40),v=a(32),x=a(1);class w{constructor(z){this.keyPath=z}}Object(e.a)(w,"KeyPathClass",null,[]);var r=a(62),t=a(149),A=a(36);let y=class extends k.a{constructor(z){super();this.xib=this.zcd=null;this.ARe=1;this.BZa=null;this.$=z}get indexedDBFactory(){this.BZa||
(window.indexedDB?this.BZa=window.indexedDB:window.webkitIndexedDB?this.BZa=window.webkitIndexedDB:window.mozIndexedDB?this.BZa=window.mozIndexedDB:window.msIndexedDB&&(this.BZa=window.msIndexedDB));return this.BZa}get initialized(){return!!this.zcd&&!!this.xib}initialize(z,E,G){this.zcd=z;this.xib=E;this.ARe=G}sf(){try{return x.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&h.a.jQa||h.a.ng&&91===h.a.kzb?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(z){return d.ULS.sendTraceTag(537157640,
0,15,`IndexedDB.IsSupported() failed. Exception: ${z.message}`),!1}}Fgb(z){return this.sf()&&this.initialized?n.TaskExtensions.u5(this.jLd(),E=>{if(void 0===E.result&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;E=E.result;this.N$b(E);const G=v.a.Bb.Ye.m;this.spd(E,!1).put(z);d.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${v.a.Bb.Ye.m-G} Millisecond.`);return!0},this.ka):(d.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),
r.Task.Ua(!1))}ldd(z){return this.sf()&&this.initialized?n.TaskExtensions.u5(this.jLd(),E=>{if(void 0===E.result&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;E=E.result;this.N$b(E);const G=v.a.Bb.Ye.m;this.spd(E,!1)["delete"](z);d.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${v.a.Bb.Ye.m-G} Millisecond.`);return!0},this.ka):(d.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),
r.Task.Ua(!1))}E7a(z){return this.sf()&&this.initialized?n.TaskExtensions.Qjh(this.jLd(),E=>void 0===E.result&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?r.Task.Ua(""):this.F6h(E.result,z),this.ka):(d.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),r.Task.Ua(""))}N$b(z){z.objectStoreNames.contains(this.xib)||z.createObjectStore(this.xib,new w("key"))}jLd(){const z=new l.a;let E;E=this.indexedDBFactory.open(this.zcd,
this.ARe);E.onsuccess=()=>{const G=E.result;d.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${G.name} success`);z.setResult(G)};E.onupgradeneeded=()=>{const G=E.result;d.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${G.name} upgrade needed`);try{this.N$b(G),d.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${G.name} upgrade done`)}catch(F){d.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${F}`),x.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?z.setResult(void 0):
z.setException(Error.create("Failed to upgrade IndexedDB"))}};E.onerror=G=>{d.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${G} failed`);z.setResult(void 0)};return z.task}spd(z,E){return z.transaction([this.xib],E?"readonly":"readwrite").objectStore(this.xib)}F6h(z,E){const G=new l.a;this.N$b(z);const F=v.a.Bb.Ye.m,O=this.spd(z,!0).get(E);O.onsuccess=M=>{(M=M.target.result)?(G.setResult(M.value),d.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${v.a.Bb.Ye.m-F} Millisecond.`)):
G.setResult("")};O.onerror=()=>{G.setException(Error.create(O.error?O.error.message:"DB error"))};return G.task}};y=Object(f.b)([Object(t.d)(A.U,{Ux:"transient"}),Object(f.c)(0,Object(A.A)())],y);Object(e.a)(y,"IndexedDB",k.a,[231]);a.d(C,"a",function(){return c});String(u);window.___1684305467960_closurehack=u},1328:function(u,C,a){u=a(0);var c=a(15),b=a(885),f=a(975),e=a(6),d=a(103),h=a(567),l=a(260),k=a(43),n=a(41),v=a(31),x=a(115),w=a(84),r=a(184);class t{get name(){return"Common.App.OAuth.OAuthPackage"}Di(y){y.register(426,
"Common.App.OAuth.IOAuthManager").Uc().dd(()=>new b.OAuthManager)}init(){const y=w.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Aak(y)}Aak(y){const z=e.AFrameworkApplication.fa.Va("FileSource");if(e.AFrameworkApplication.fa.ra("IsO365ConsumerHost")||e.AFrameworkApplication.fa.ra("IsO365CommercialHost")||"WopiTest"===z){var E=h.OAuthManagerSettings.q$b;if(E&&E.IsEnabled){var G=E.Application,F=h.OAuthManagerSettings.authority;if(void 0!==G&&null!==G&&G.length&&void 0!==F&&null!==F&&F.length){var O=
f.a[y.KM],M=v.a.lva,P=y.Iw();try{var B=new Map;void 0!==B&&null!==B?(B.set("SupportStatus",O),B.set("Browser",M),B.set("AuthStrategy",P)):B=null}catch(I){B=null}d.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",B);var D=n.a.ve();y.dD("Core",G).then(I=>{const S=Math.floor(n.a.ve()-D);O=f.a[y.KM];M=v.a.lva;P=y.Iw();c.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
S,I.IsSuccess,O,I.ErrorCode,z,M,P);B&&(B.set("SupportStatus",O),B.set("Browser",M),B.set("AuthStrategy",P));var J=Object.assign(new r.a,{durationMs:S,extendedProperties:B});if(I.IsSuccess){if(d.Health.instance.recordKpiSuccess("WacCorePFT",J),I="Bearer "+I.Token,e.AFrameworkApplication.de.U8d=I,J=E.Endpoint){var L=n.a.ve();e.AFrameworkApplication.de.Orb(J,1,null,{["Authorization"]:I},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(R=>{var Y=Math.floor(n.a.ve()-L),Q=null;R.Zh?R=
"Canceled":R.vg?R="Faulted":(Q=R.result,R=Q.succeeded?"Completed":"Failed");Y={["TaskResult"]:R,["BrowserTokenDurationMS"]:S,["BrowserValidationDurationMS"]:Y};Q&&(Y.HttpStatus=Q.Ph.data.httpStatus,Q.succeeded&&(Q=k.a(Q.Ph.data.Fe),Y.ServerValidationDurationMS=Q.ElapsedMilliseconds,Y.ServerValidationResult=Q.ValidatedToken,Y.KMSI=Q.KMSI,Y.Scopes=Q.Scopes,Y.TokenExpirationS=Math.floor(parseInt(Q.Expiration)-(new Date).getTime()/1E3)));c.ULS.sendTraceTag(520632322,3E3,"Completed"===R?50:15,x.a.toJSON(Y))})}}else d.Health.instance.recordKpiFailure("WacCorePFT",
I.ErrorCode,!1,!1,J)}).catch(I=>{var S=Math.floor(n.a.ve()-D);S=Object.assign(new r.a,{durationMs:S,extendedProperties:B});d.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+I.toString(),!1,!1,S)})}}}}dispose(){}static main(){l.a.instance.nj(new t)}static quj(){l.a.instance.nj(new t,0,!0)}}Object(u.a)(t,"OAuthPackage",null,[4,5]);a.d(C,"a",function(){return A});const A=y=>{Type.registerNamespace("Common.App.OAuth");y?t.quj():t.main()}},1492:function(u,C,a){a.r(C);u=a(1309);C=a(1328);
var c=a(1280),b=a(1178),f=a(1281),e=a(1179),d=a(1195),h=a(1227),l=a(1265),k=a(1218);a=a(1223);Object(u.a)();Object(C.a)();Object(c.a)();Object(b.a)();Object(f.a)();Object(e.a)();Object(d.a)();Object(h.a)();Object(l.a)();Object(k.a)();Object(a.a)()},885:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(1482),f=a(975),e;(function(aa){aa[aa.external=0]="external";aa[aa.msa=1]="msa";aa[aa.aad=2]="aad"})(e||(e={}));Object(u.b)("AuthorityType",e);var d=a(797);class h{constructor(aa){this.GKg=aa}initialize(){return Promise.resolve(0)}Rqc(){return Promise.resolve(0)}dD(){c.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new d.a,{IsSuccess:!0,Token:this.GKg}))}uIc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}OGc(){return!1}RBb(){return"MockAuthTokenStrategy"}}Object(u.a)(h,"MockAuthTokenStrategy",null,[444]);var l=a(993);class k{static get(aa,Z,fa){if(!fa)return aa;
let ya=0;return Promise.race([aa,new Promise(Aa=>{ya=window.setTimeout(()=>{Aa(Z)},fa)})]).then(Aa=>{window.clearTimeout(ya);return Promise.resolve(Aa)}).catch(()=>{window.clearTimeout(ya);return Promise.resolve(Z)})}}Object(u.a)(k,"PromiseWithTimeout",null,[]);var n=a(6),v=a(567);class x{constructor(aa,Z,fa,ya,Aa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=aa;this.scope=Z;this.silentLogin=fa;this.options=ya;this.correlationId=Aa}}Object(u.a)(x,
"TokenRequestParameters",null,[451]);var w=a(31),r=a(84);class t{constructor(){this.Zte=null;let aa=n.AFrameworkApplication.fa.Va(n.AFrameworkApplication.u$),Z=n.AFrameworkApplication.fa.Va(n.AFrameworkApplication.grg);this.k0a=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",aa&&""!==aa?aa:"Unspecified",Z&&""!==Z?Z:"Unspecified")}initialize(){return new Promise(aa=>{r.a.instance.qc("Common.App.WopiIdentity.IWopiIdentity").execute(Z=>{this.Zte=Z;aa(0)})})}hj(aa){const Z=
["HTTPS:","API:"];let fa=!1;const ya=aa.toLocaleUpperCase();for(const Aa of Z)if(ya.startsWith(Aa)){fa=!0;break}return fa||this.HCi(aa)?aa+"/.default":aa}HCi(aa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(aa)}Rqc(){return Promise.resolve(0)}dD(aa,Z,fa,ya,Aa,ja,za){if(w.a.Wza){Aa=v.OAuthManagerSettings.ykk;if(!Aa)return Z=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Z);
if(!Array.contains(Aa,aa))return Z=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+aa}),Promise.resolve(Z)}aa=this.hj(fa);fa=new x(fa,aa,!ya,null,n.AFrameworkApplication.userSessionId);return this.Zte.getAccessToken(fa,Z,za).then(ra=>Object.assign(new d.a,{IsSuccess:!0,Token:ra.accessToken}),ra=>Object.assign(new d.a,{IsSuccess:!1,ErrorCode:ra}))}uIc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}OGc(){return!1}RBb(){return this.k0a}}Object(u.a)(t,"ParentFrameTokenStrategy",null,[444]);var A=a(88),y=a(892),z=a(199);class E{constructor(){this.reject=this.resolve=null;this.startTime=0;this.RYf=this.$De=null}}Object(u.a)(E,"PromiseWrapper",null,[]);class G{constructor(aa=0){this.oD=0;this.jpb=!1;this.En=new z.a;this._timeout=aa}enqueue(aa){return new Promise((Z,fa)=>{this.En.add(Object.assign(new E,
{RYf:aa,resolve:Z,reject:fa}));this.process()})}process(){if(this.jpb||this.oD===this.En.count)return!1;const aa=this.En.ma(this.oD++);try{this.jpb=!0,aa.RYf().then(Z=>{this.jpb=!1;this.$9c(aa,Z,null,!0)}).catch(Z=>{this.jpb=!1;this.$9c(aa,null,Z,!1)})}catch(Z){this.jpb=!1,this.$9c(aa,null,Z,!1)}return!0}$9c(aa,Z,fa,ya){if(ya){const Aa=()=>{aa.resolve(Z);this.process()};0<this._timeout?window.setTimeout(()=>{Aa()},this._timeout):Aa()}else{const Aa=()=>{aa.reject(fa);this.process()};0<this._timeout?
window.setTimeout(()=>{Aa()},this._timeout):Aa()}}}Object(u.a)(G,"PromiseQueue",null,[]);class F{constructor(){this.correlationId=this.resolve=null}}Object(u.a)(F,"ResolveWithCorrelation",null,[]);var O=a(126),M=a(157),P=a(769),B=a(178);class D extends M.a{constructor(aa,Z,fa,ya,Aa,ja){super(!1,!1,!0);this.Xde=this.w3=null;this.EZ=aa;this.kMg=fa;this.kx=ya;this.TPg=Aa;this.UGa=ja;this.ku=document.createElement("iframe");this.ku.id="SharedAuthInteractiveFrame";this.ku.setAttribute("name","SharedAuthInteractiveFrame");
this.ku.setAttribute("title","SharedAuthInteractiveFrame");this.ku.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.ku.style.border="0";this.ku.style.height="48px";this.ku.style.width="190px";$addHandler(this.ku,"error",Object(A.a)(this,this.Hbj,"onSharedAuthFrameError"));aa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.EZ,Z,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",n.AFrameworkApplication.userType);this.ku.src=
aa;this.LFg=new Promise(za=>{this.Xde=za});this.Yde=!1}TEc(){this.w3={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.kMg,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:n.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(A.a)(this,this.$nh,"createFrame"),["resolveDialogStyles"]:this.Xde}};this.rc=5;this.initializeAndShow(CommonUIStrings.l_SignIn,Object(A.a)(this,this.wSj,"sharedAuthConsentDialogHandler"),this.w3)}QJc(aa=!1,Z=!1,fa=5){this.w3&&this.w3.bodyControls&&
(aa!==Object(O.a)(Object,this.w3.bodyControls).frameLoaded&&(Object(O.a)(Object,this.w3.bodyControls).frameLoaded=aa),Z!==Object(O.a)(Object,this.w3.bodyControls).frameLoadSuccess&&(Object(O.a)(Object,this.w3.bodyControls).frameLoadSuccess=Z),fa!==this.w3.dialogButtonsOption&&(this.w3.dialogButtonsOption=null,this.rc=fa),this.update(this.w3))}fZj(aa,Z){const fa=new P.a(B.a.ASj);fa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:n.AFrameworkApplication.isRtl,
["messageCorrelationId"]:aa,["dialogStyles"]:Z};this.kx.O9(fa,this.ku.contentWindow,this.EZ)}D5e(){this.QJc(!0,!1,6)}get Lfg(){return this.ku}get vxh(){return this.LFg.then(aa=>{this.Yde=!0;return aa})}get wxh(){return this.Yde}Hbj(){this.D5e()}$nh(){return this.ku}wSj(aa){0===aa&&(this.TPg.reject(Object.assign(new d.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.UGa(null))}}Object(u.a)(D,"SharedAuthConsentDialog",M.a,[450]);var I=a(890),S=a(103),
J=a(147),L=a(41),R=a(185),Y=a(184);class Q{constructor(){this.ku=null;this.fZb=0;this.wob=this.B0a=this.XMc=this.UGa=this.dN=this.Sse=null;this.kx=new I.a(null,null);this.k0a="SharedAuthTokenStrategy Unloaded";this.EZ=v.OAuthManagerSettings.ySj;this.Vqe=v.OAuthManagerSettings.xSj;this.Qee=v.OAuthManagerSettings.enableConsoleLogging;this.dGg=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.qOg=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",
!1);this.gQg=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Mta={};this.BIg=new G(1500)}RBb(){return this.k0a}initialize(){var {OAuthManager:aa}=a(885);if("loadFrame"in this.Mta)return this.Mta.loadFrame.$De;if(!this.EZ)return S.Health.instance.recordKpiFailure(aa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),c.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);
aa=this.sGc("loadFrame");this.fZb=L.a.ve();var Z=this.EZ+this.Vqe+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+n.AFrameworkApplication.userSessionId+"&WacUserType="+n.AFrameworkApplication.userType;this.gQg&&(Z+="&webworker=1");this.ku=document.createElement("iframe");this.cPa(this.ku);this.ku.style.cssText="height:0;width:0;display:none;";this.ku.id="SharedAuthFrame";this.ku.setAttribute("name","SharedAuthFrame");this.ku.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.ku.setAttribute("title","SharedAuthFrame");this.ku.src=Z;document.body.appendChild(this.ku);Z=L.a.ve()-this.fZb;c.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Z,this.ku.src);return aa}Rqc(aa){this.XMc=aa;const Z=new P.a(B.a.Ofg);Z.Values=this.zDe(aa);aa=this.sGc("initFrame");this.kx.O9(Z,this.ku.contentWindow,this.EZ);c.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return aa}dD(aa,Z,fa,ya,Aa,ja){const za=new P.a(B.a.BSj),ra=this.udf();za.Values=this.xqg(aa,Z,fa,ya,Aa,ja,ra);aa=this.sGc(ra);ya&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.BIg.enqueue(()=>new Promise(fb=>{this.T$j(ja,za,fb,ra)})):(this.kx.O9(za,this.ku.contentWindow,this.EZ),c.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Z));return aa}T$j(aa,Z,fa,ya){const Aa=
this.Mta[ya];Aa&&(this.B0a=Z,this.UGa=Object.assign(new F,{resolve:fa,correlationId:ya}),this.dN=new D(this.EZ,this.Vqe,aa,this.kx,Aa,fa),this.dN.TEc())}udf(){return R.a.create().toString()}xqg(aa,Z,fa,ya,Aa,ja,za){const ra={};ra.appName=aa;ra.appId=Z;ra.target=fa;ra.withPopup=ya;ra.claims=Aa;ra.promptMessage=ja;ra.messageCorrelationId=za;return ra}cPa(aa){$addHandler(aa,"load",Object(A.a)(this,this.v7i,"onIFrameLoaded"));$addHandler(aa,"error",Object(A.a)(this,this.Kuc,"onIFrameError"));this.kx.QQ(this.EZ);
this.kx.fn(B.a.Rfg);this.kx.hl(B.a.Rfg,Object(A.a)(this,this.Xaj,"onScriptLoaded"));this.kx.fn(B.a.Qfg);this.kx.hl(B.a.Qfg,Object(A.a)(this,this.Waj,"onScriptInitialized"));this.kx.fn(B.a.Mfg);this.kx.hl(B.a.Mfg,Object(A.a)(this,this.X6i,"onGetTokenResponse"));this.kx.fn(B.a.Sfg);this.kx.hl(B.a.Sfg,Object(A.a)(this,this.Q8i,"onLoginResponse"));this.kx.fn(B.a.Pfg);this.kx.hl(B.a.Pfg,Object(A.a)(this,this.S7i,"onInteractiveFlowReady"));this.kx.fn(B.a.Nfg);this.kx.hl(B.a.Nfg,Object(A.a)(this,this.o7i,
"onHideDialog"));this.kx.fn(B.a.Kfg);this.kx.hl(B.a.Kfg,Object(A.a)(this,this.l2i,"onCloseDialog"))}sGc(aa){const Z=new E;Z.startTime=L.a.ve();const fa=new Promise((ya,Aa)=>{Z.resolve=ya;Z.reject=Aa});Z.$De=fa;this.Mta[aa]=Z;return fa}v7i(){const aa=L.a.ve()-this.fZb;c.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",aa)}Kuc(aa){const {OAuthManager:Z}=a(885),fa=L.a.ve()-this.fZb,ya=Object.assign(new Y.a,{durationMs:fa});S.Health.instance.recordKpiFailure(Z.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,ya);c.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",fa,this.Qee?JSON.stringify(aa):"")}Xaj(aa){const {OAuthManager:Z}=a(885),fa=this.Mta.loadFrame;var ya=L.a.ve()-fa.startTime,Aa=aa.Values.AuthLibrary.toString();aa=aa.Values.Success.toString();c.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",aa,Aa,ya);Aa&&(this.k0a="SharedAuthTokenStrategy "+Aa);
Aa=Boolean.parse(aa);Aa||(aa=J.a.ot(),void 0!==aa&&null!==aa&&(aa.set("AuthLibrary",this.RBb()),ya=Object.assign(new Y.a,{durationMs:ya,extendedProperties:aa}),S.Health.instance.recordKpiFailure(Z.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ya)));fa.resolve(Aa?0:1)}Waj(aa){if(aa.Values.interactive&&this.B0a&&this.B0a.Values.messageCorrelationId){const fa=this.B0a.Values.messageCorrelationId.toString();if(aa.Values.interactive&&this.dN){this.dN.vxh.then(ya=>{this.kx.O9(this.B0a,this.dN.Lfg.contentWindow,
this.EZ);this.dN.fZj(fa,ya);this.dN.QJc(!0,!0);this.B0a=null});return}}aa=this.Mta.initFrame;const Z=L.a.ve()-aa.startTime;c.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Z);aa.resolve(0)}X6i(aa){if(aa.Values.messageCorrelationId&&aa.Values.messageCorrelationId.toString()){var Z=aa.Values.messageCorrelationId.toString(),fa=this.Mta[Z];if(fa){var ya=L.a.ve()-fa.startTime;c.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
ya);aa.Values.isSuccess&&aa.Values.isSuccess?fa.resolve(aa.Values.response):fa.reject(aa.Values.response);this.Nqg(Z)}else c.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else c.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}S7i(){if(this.dN.wxh)this.dN.D5e();else if(this.XMc&&this.dN){const aa=new P.a(B.a.Ofg);aa.Values=this.zDe(this.XMc,!0);
this.kx.O9(aa,this.dN.Lfg.contentWindow,this.EZ)}}o7i(){this.dN&&this.dN.L8a()}l2i(aa){aa.Values.cancelled&&aa.Values.cancelled&&aa.Values.messageCorrelationId&&this.Nqg(aa.Values.messageCorrelationId.toString());this.dN&&this.dN.hide()}zDe(aa,Z=!1){const fa={};fa.appIds=this.x_h();fa.upn=aa.loginHint;fa.authority=aa.authority;fa.authorityType=Object(b.a)(e,aa.authorityType);fa.tenantId=aa.tenantId;fa.correlationId=n.AFrameworkApplication.userSessionId;fa.enableConsoleLogging=this.Qee;fa.enablePopupFlash=
this.dGg;fa.skipUpnCheck=this.qOg;fa.interactive=Z;return fa}x_h(){const aa=[],Z=v.OAuthManagerSettings.M3c;for(let ya in Z){var fa=Z[ya];Array.contains(aa,fa)||Array.add(aa,fa)}return aa}uIc(aa,Z,fa,ya,Aa,ja){const za=new P.a(B.a.zSj),ra=this.udf();za.Values=this.xqg(aa,Z,fa,ya,Aa,ja,ra);this.Sse=za;aa=this.sGc(ra);c.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Z);this.SWj();return aa}OGc(){return!0}SWj(){this.wob||(this.wob=new y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.wob.id=16,this.wob.Kxd=!1,this.wob.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{c.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.kx.O9(this.Sse,this.ku.contentWindow,this.EZ)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),c.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Q8i(aa){if(aa.Values.messageCorrelationId&&
aa.Values.messageCorrelationId.toString()){var Z=this.Mta[aa.Values.messageCorrelationId.toString()];if(Z){var fa=L.a.ve()-Z.startTime;c.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",fa);aa.Values.isSuccess&&aa.Values.isSuccess?Z.resolve(aa.Values.response):Z.reject(aa.Values.response)}else c.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else c.ULS.sendTraceTag(555049439,3E3,10,
"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}Nqg(aa){this.UGa&&this.UGa.correlationId===aa&&(this.UGa.resolve(null),this.UGa=null)}}Object(u.a)(Q,"SharedAuthTokenStrategy",null,[444]);class W{constructor(aa){this.sXc=aa;this.k0a="UnsupportedAuthTokenStrategy Reason="+f.a[this.sXc]}initialize(){return Promise.resolve(0)}Rqc(){return Promise.resolve(0)}dD(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:f.a[this.sXc],ErrorMessage:"Unable to get a token. Reason: ["+
f.a[this.sXc]+"]"}))}uIc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}OGc(){return!1}RBb(){return this.k0a}}Object(u.a)(W,"UnsupportedAuthTokenStrategy",null,[444]);var Ga=a(741);a.d(C,"OAuthManager",function(){return pa});class pa{constructor(aa=null){this.KM=0;this.LM=null;this.RMg=0;this.Rie=!!window.location.search.match(RegExp("wdpa=1",
"gi"));const Z=L.a.ve();this.qIg=this.Iwh(aa).then(fa=>fa?this.Nri():(c.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.Iw(),Math.floor(L.a.ve()-Z)),fa=J.a.ot(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.Iw()),fa=Object.assign(new Y.a,{durationMs:Math.floor(L.a.ve()-Z),extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"StrategyPickFailed",!1,!0,fa)),Promise.resolve(1))).then(fa=>0!==
fa?Promise.resolve(fa):this.yNi())}Jwh(){if(this.Rie)this.KM=5,this.LM=new W(this.KM);else{var aa=v.OAuthManagerSettings.lWi;aa&&0<aa.length?(this.KM=1,this.LM=new h(aa)):n.AFrameworkApplication.fa.ra("IsO365ConsumerHost")||n.AFrameworkApplication.fa.ra("IsO365CommercialHost")?n.AFrameworkApplication.fa.ra("IsAnonymousUser")?(this.KM=2,this.LM=new W(this.KM)):(aa=l.a.getAuthContext().loginHint)&&aa.length?v.OAuthManagerSettings.eDb?(this.KM=1,this.LM=new t):(this.KM=1,this.LM=new Q):(this.KM=3,this.LM=
new W(this.KM)):(this.KM=4,this.LM=new W(this.KM))}}Iw(){return this.LM?this.LM.RBb()||"Unknown":"None"}Iwh(aa=null){c.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Z=L.a.ve();return n.AFrameworkApplication.fa.bnd().then(fa=>{fa?(this.Jwh(),aa&&(this.LM=aa),c.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.Gzh,
this.Iw(),Math.floor(L.a.ve()-Z))):c.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(L.a.ve()-Z));return Promise.resolve(fa)},()=>{c.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(L.a.ve()-Z));return Promise.resolve(!1)})}Nri(){c.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",
this.Iw());const aa=L.a.ve();return k.get(this.LM.initialize(),2,v.OAuthManagerSettings.LOd).then(Z=>{if(0===Z)c.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.Iw(),Math.floor(L.a.ve()-aa));else if(1===Z){c.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.Iw(),Math.floor(L.a.ve()-aa));var fa=J.a.ot();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.Iw()),fa=Object.assign(new Y.a,{durationMs:Math.floor(L.a.ve()-
aa),extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"StrategyInitFailed",!1,!0,fa))}else 2===Z&&(c.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.Iw(),Math.floor(L.a.ve()-aa)),fa=J.a.ot(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.Iw()),fa=Object.assign(new Y.a,{durationMs:Math.floor(L.a.ve()-aa),extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"StrategyInitTimedOut",
!1,!0,fa)));return Promise.resolve(Z)},()=>{c.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Iw(),Math.floor(L.a.ve()-aa));return Promise.resolve(1)})}yNi(){c.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.Iw());const aa=L.a.ve();return k.get(this.LM.Rqc(l.a.getAuthContext()),2,v.OAuthManagerSettings.LOd).then(Z=>{if(0===Z)c.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.Iw(),Math.floor(L.a.ve()-
aa));else if(1===Z){c.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Iw(),Math.floor(L.a.ve()-aa));var fa=J.a.ot();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.Iw()),fa=Object.assign(new Y.a,{durationMs:Math.floor(L.a.ve()-aa),extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"StrategyLoadFailed",!1,!0,fa))}else 2===Z&&(c.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.Iw(),Math.floor(L.a.ve()-aa)),fa=J.a.ot(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.Iw()),fa=Object.assign(new Y.a,{durationMs:Math.floor(L.a.ve()-aa),extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"StrategyLoadTimedOut",!1,!0,fa)));return Promise.resolve(Z)},()=>{c.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Iw(),Math.floor(L.a.ve()-aa));return Promise.resolve(1)})}dD(aa,Z,fa=null){return this.sIc(aa,
Z,!1,null,"",fa)}yqg(aa,Z,fa,ya,Aa=null){return this.sIc(aa,Z,!0,fa,ya,Aa)}sIc(aa,Z,fa,ya,Aa,ja,za=0){za+=1;c.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",aa,this.DUa(aa,Z),this.Iw(),za);var ra=J.a.ot();void 0!==ra&&null!==ra&&(ra.set("AuthLibrary",this.Iw()),ra.set("AppName",aa),ra.set("Target",this.DUa(aa,Z)),S.Health.instance.recordKpiUsage(pa.kpiName,0,"WacOAuthFC",ra));if(!v.OAuthManagerSettings.isEnabled||this.Rie){var fb;
return this.WCd((fb=new d.a,fb.IsSuccess=!1,fb.Token=null,fb.ErrorCode="NotEnabled",fb.ErrorMessage="OAuthManager is disabled.",fb),aa)}const Ua=v.OAuthManagerSettings.M3c[aa];if(void 0===Ua||null===Ua){c.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",aa);var Ca;return this.WCd((Ca=new d.a,Ca.IsSuccess=!1,Ca.Token=null,Ca.ErrorCode="DisallowedApp",Ca.ErrorMessage="Disallowed appName: "+aa,Ca),aa)}const Ia=L.a.ve();
let oa=Ia;const Da=this;ra=this.qIg.then(Ba=>{oa=L.a.ve();return Da.Ixi(aa,Ua,Z,fa,ya,Aa,ja,Ba)});fb=fa?0:v.OAuthManagerSettings.LOd;let bb;Ca=(bb=new d.a,bb.IsSuccess=!1,bb.Token=null,bb.ErrorCode="authTokenStrategy_timeout",bb.ErrorMessage="Auth Strategy timed out after ["+fb+"] ms when fetching token",bb);let Za=this,Xa=this;return k.get(ra,Ca,fb).then(Ba=>za<=pa.UUi&&(Ba.ErrorCode===pa.xog||Ba.ErrorCode===pa.Q2j)?(c.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",
za,Math.floor(L.a.ve()-Ia)),Za.sIc(aa,Z,fa,ya,Aa,ja,za)):Ba.ErrorCode===pa.$vf&&!fa&&(c.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",za,pa.SWe),pa.LCh&&Za.LM.OGc()&&Za.LM.uIc(aa,Ua,Z,fa,ya,Aa).then(Wa=>Promise.resolve(Za.nrc(Wa,aa,Z,Ua,Ia,oa))).catch(()=>{let Wa;const Na=(Wa=new d.a,Wa.IsSuccess=!1,Wa.Token=null,Wa.ErrorCode="authTokenStrategy_failure",Wa.ErrorMessage="LoginPopup failed, GetToken could not be called",Wa);return Promise.resolve(Za.nrc(Na,
aa,Z,Ua,Ia,oa))}),pa.SWe)?Za.sIc(aa,Z,!0,ya,Aa,ja,za):Promise.resolve(Za.nrc(Ba,aa,Z,Ua,Ia,oa))).catch(()=>{let Ba;const Wa=(Ba=new d.a,Ba.IsSuccess=!1,Ba.Token=null,Ba.ErrorCode="authTokenStrategy_failure",Ba.ErrorMessage="Auth Strategy failed with an unknown error",Ba);return Promise.resolve(Xa.nrc(Wa,aa,Z,Ua,Ia,oa))})}Ixi(aa,Z,fa,ya,Aa,ja,za,ra){return 1===ra||2===ra?this.WCd(Object.assign(new d.a,{IsSuccess:!1,Token:null,ErrorCode:1===ra?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),
aa):this.LM.dD(aa,Z,fa,ya,Aa,ja,za).then(fb=>Promise.resolve(this.jGf(fb,!0,aa))).catch(fb=>Promise.resolve(this.jGf(fb,!1,aa)))}nrc(aa,Z,fa,ya,Aa,ja){const za={},ra=L.a.ve()-ja;za.IsSuccess=aa.IsSuccess;za.ErrorCode=aa.IsSuccess?"Success":aa.ErrorCode||"";za.ErrorMessage=aa.IsSuccess?"Success":this.DUa(Z,aa.ErrorMessage||"");za.Target=this.DUa(Z,fa||"");za.TimeInMS=Math.floor(ra);za.LoadTimeInMS=Math.floor(ja-Aa);za.AuthLibrary=this.Iw();za.AppName=Z;za.AuthorityType=Object(b.a)(e,l.a.Agc());za.UserType=
this.xhi(l.a.getAuthContext());za.IsAuthSupportedInSession=f.a[this.KM];za.RequestCount=++this.RMg;za.AppId=ya;c.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(za));aa.IsSuccess||(fa=J.a.ot(),void 0!==fa&&null!==fa&&(fa.set("AppName",Z),fa.set("AuthLibrary",this.Iw()),fa.set("ErrorCode",aa.ErrorCode),fa.set("ErrorMessage",this.DUa(Z,aa.ErrorMessage)),Z=Object.assign(new Y.a,{durationMs:ra,extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"TryGetTokenFailure",!1,!0,Z)));return aa}WCd(aa,
Z){c.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Z,this.DUa(Z,aa.ErrorMessage));const fa=J.a.ot();void 0!==fa&&null!==fa&&(fa.set("AppName",Z),fa.set("AuthLibrary",this.Iw()),fa.set("ErrorCode",aa.ErrorCode),fa.set("ErrorMessage",this.DUa(Z,aa.ErrorMessage)),Z=Object.assign(new Y.a,{extendedProperties:fa}),S.Health.instance.recordKpiFailure(pa.kpiName,"FailureBeforeGetToken",!1,!0,Z));return Promise.resolve(aa)}Qqf(aa){return aa===
Ga.a.EHc}DUa(aa,Z){return this.Qqf(aa)&&Z?"REDACTED":Z}xhi(aa){return n.AFrameworkApplication.fa.ra("IsAnonymousUser")?"anonymous":!aa.loginHint||1>aa.loginHint.length?"empty":-1<aa.loginHint.indexOf("guest#")?"guest":-1<aa.loginHint.indexOf("ext#")?"external":0>aa.upn.indexOf("@")?"no-at":"supported"}oPa(){return 1===this.KM}jGf(aa,Z,fa){let ya=null,Aa=null,ja=null,za=null;aa?aa.ErrorCode||aa.ErrorMessage?(Aa=aa.ErrorCode?aa.ErrorCode:pa.P1e,ja=aa.ErrorMessage?aa.ErrorMessage:"No message"):aa.Token?
Z?ya=aa.Token:(Aa=pa.kvj,ja="A rejected promise returned a token."):(Aa=pa.P1e,ja=JSON.stringify(aa)):(Aa=pa.CYi,ja="No result came from Auth Token Strategy");aa&&aa.Telemetry&&!this.Qqf(fa)&&(za=aa.Telemetry,c.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(za)));if(Aa===pa.vWi||Aa===pa.M7j)Aa=pa.xog,ja="Auth Library Timed Out";Aa===pa.S3g&&-1<ja.indexOf(pa.MQg)&&(Aa=pa.$vf);if(Aa||ja)ya=null;return Object.assign(new d.a,{IsSuccess:!!ya,Token:ya,ErrorCode:Aa,ErrorMessage:ja,Telemetry:za})}static get SWe(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",
!1)}static get LCh(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}pa.M7j="token_renewal_error";pa.P1e="Exception";pa.CYi="NoResult";pa.kvj="RejectToken";pa.vWi="monitor_window_timeout";pa.xog="Timeout";pa.Q2j="authTokenStrategy_timeout";pa.S3g="login_required";pa.MQg="AADSTS50058";pa.$vf="Cookies Disabled";pa.kpiName="OAuthManager";pa.UUi=2;Object(u.a)(pa,"OAuthManager",null,[426])},975:function(u,C,a){a.d(C,"a",function(){return c});
u=a(0);var c;(function(b){b[b.unknown=0]="unknown";b[b.supported=1]="supported";b[b.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";b[b.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";b[b.hostUnsupported=4]="hostUnsupported";b[b.perfAutomation=5]="perfAutomation"})(c||(c={}));Object(u.b)("SupportStatus",c)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.vrs.js.map/8b9019f7e1c3f765da4377e30ba8f32d/EwaDSOpt.vrs.js.map