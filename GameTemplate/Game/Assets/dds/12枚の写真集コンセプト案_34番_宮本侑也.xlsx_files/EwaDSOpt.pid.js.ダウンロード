'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1170:function(u,C,a){a.d(C,"a",function(){return h});u=a(0);C=a(752);var c=a(1),b=a(79),f=a(91),e=a(274),d=a(16);class h extends C.a{constructor(l){super(l,h.gNi,d.a.instance.Ha(650),d.a.instance.Ha(652),d.a.instance.Ha(648),d.a.instance.Ha(649),3072,10,new e.a)}yVj(){return this.KDa()}get UX(){return"[data-unique-id=Review]"}get TX(){return"[data-unique-id=pivotOverflowButton]"}get mX(){return'[id="'+this.$.fc+
'Ribbon.Review-title"]'}get AXf(){return!1}get ribbonCommandInfo(){return new f.a(1834994092,b.a.Vb,this.$.Kc,9,null)}get zoa(){return c.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.LineageDiscoverabilityCalloutDisplayLimit",3)}ANa(){return 3}Yld(){return 86400}eza(){return this.$.ea.kbb}}h.gNi="LineageDiscoverabilityCallout";Object(u.a)(h,"LineageDiscoverabilityCallout",C.a,[262])},1210:function(u,C,a){var c=a(10);u=a(0);var b=a(15),f=a(229),e=a(52),d=a(40),h=a(2),l=a(185),k=a(746),n=a(726);
class v extends k.a{constructor(){super();this.hasMergedcells=this.tableName=this.interpretations=this.range=null;this.H_=Object.assign(new n.a,{T_:v.getTypeName(),B_:v.je()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static je(){return["AugLoop_Core_Annotation"]}}Object(u.a)(v,"ExcelRecognizedTableNew",k.a,[]);class x extends v{constructor(){super();this.requestId=null;this.H_=Object.assign(new n.a,{T_:x.getTypeName(),B_:x.je()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static je(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew",
"AugLoop_Core_Annotation"]}}Object(u.a)(x,"ExcelRangeMetadata",v,[]);k=a(1347);class w extends k.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new n.a,{T_:w.getTypeName(),B_:w.je()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static je(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(u.a)(w,"ExtendedExcelCell",k.a,[]);k=a(861);class r extends k.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=
null;this.H_=Object.assign(new n.a,{T_:r.getTypeName(),B_:r.je()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static je(){return["AugLoop_Signals_Signal"]}}Object(u.a)(r,"RangeDataSignal",k.a,[]);var t=a(1113),A=a(106);k=a(42);var y=a(1),z=a(23),E=a(20);class G extends Sys.EventArgs{constructor(za){super();this.BNb=za}}Object(u.a)(G,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var F=a(199),O=a(25),M=a(354);class P{constructor(za,ra,fb,Ua,Ca){this.PB=za;this.interpretations=
ra;this.tableName=fb;this.id=Ua;this.$if=Ca}}Object(u.a)(P,"RecognizedTable",null,[]);class B{constructor(za,ra,fb){this.classification=za;this.aggregations=ra;this.headerReferences=fb}}Object(u.a)(B,"TableField",null,[]);var D=a(1114);const I=za=>{var ra=new M.a(S(za.range),za.range.worksheetId);var fb=za.interpretations;var Ua=new F.a;if(fb&&fb.length)for(const V of fb){b:switch(V.orientation.toLowerCase()){case "columnmajor":fb=2;break b;case "rowmajor":fb=1;break b;default:b.ULS.sendTraceTag(537151256,
0,50,"Invalid value for table orientaion."),fb=0}const ia=fb;if(0===ia)b.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{fb=D.a;var Ca=S(V.location),Ia=V.confidence,oa=V.headerRowCount,Da=V.headerColumnCount;var bb=V.fields;var Za=new F.a;if(bb)for(const X of bb){bb=Za;var Xa=bb.add;c:switch(X.classification.toLowerCase()){case "dimension":var Ba=1;break c;case "measure":Ba=2;break c;default:b.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),
Ba=0}var Wa=X.aggregations;var Na=new F.a;if(Wa)for(const la of Wa)switch(la.toLowerCase()){case "sum":Na.add(0);break;case "count":Na.add(1);break;case "average":Na.add(2);break;case "min":Na.add(3);break;case "max":Na.add(4);break;case "distinctcount":Na.add(5);break;case "stddev":Na.add(6);break;case "variance":Na.add(7);break;default:b.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}Wa=Na;var ta=X.headerReferences;Na=new F.a;if(ta)for(const la of ta)ta=new O.Range(la.top,
la.left,la.top,la.left,!1,!1),Na.add(ta);Xa.call(bb,new B(Ba,Wa,Na))}fb=new fb(Ca,Ia,oa,Da,ia,Za);Ua.add(fb)}}return new P(ra,Ua,za.tableName,za.id,za.hasMergedcells)},S=za=>new O.Range(za.top,za.left,za.bottom,za.right,!1,!1);var J=a(985);class L{constructor(za,ra){this.yKc=0;this.Iz=new Map;this.Vud=!1;this.tableIntelligenceManager=za;this.augmentationLoopManager=ra;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Qcc=new J.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),
this.Qcc.start(),this.qGc=!0);this.tableIntelligenceManager.c1a("Valid",this.Adj.bind(this));this.tableIntelligenceManager.c1a("Invalid",this.a8i.bind(this));y.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.augmentationLoopManager.Kve(this.q2i.bind(this))}W7a(za,ra,fb){if(!this.Iz)return b.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let Ua=ra;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&
void 0!==fb&&this.yKc>fb&&(b.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${fb}, versionChanges: ${this.yKc}`),Ua=ra^4);return this.Iz.has(za.sheetId)?(ra=this.Iz.get(za.sheetId).filter(Ca=>Ca.table.PB.range.Nd(za.range)&&(Ua&Ca.$Ib)==Ca.$Ib),b.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${ra.length}`),ra):[]}Adj(za,ra){if(this.Iz){if(!this.Vud){y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.qGc&&(this.Qcc.stop(),b.ULS.sendTraceTag(509089223,
0,15,"Elapsed time since annotation invalidation: {0}",this.Qcc.fd),this.qGc=!1);for(const [fb,Ua]of this.Iz)Ua.every(Ca=>4===Ca.$Ib)?this.Iz.delete(fb):this.Iz.set(fb,Ua.filter(Ca=>4!==Ca.$Ib));this.Vud=!0}za=ra.BNb;this.Iz.has(za.PB.sheetId)||this.Iz.set(za.PB.sheetId,[]);this.Iz.get(za.PB.sheetId).push({table:za,$Ib:2});this.yKc=0}else b.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}a8i(za,ra){this.Vud=!1;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.qGc&&
(this.Qcc.start(),this.qGc=!0);za=ra.BNb;if(this.Iz)if(this.Iz.has(za.PB.sheetId))for(const fb of this.Iz.get(za.PB.sheetId))fb.table.id===ra.BNb.id&&(fb.$Ib=4);else b.ULS.debugAssertTag(522981602,306,!1,"No recognized tables for sheet");else b.ULS.sendTraceTag(521025314,306,10,"Recognized table is null")}q2i(){this.yKc++}}Object(u.a)(L,"TableIntelligenceQueryManager",null,[292]);class R{}Object(u.a)(R,"RecognizedTableLog",null,[]);class Y{}Object(u.a)(Y,"Interpretation",null,[]);class Q{constructor(za){this.Iz=
new Map;this.A5b=void 0;this.Hsb=new Set;this.kKb=void 0;this.tableIntelligenceManager=za}aAg(){this.kKb?b.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.kKb=this.jKb.bind(this),this.tableIntelligenceManager.c1a("Valid",this.kKb))}dRi(za){za=this.lY(za);b.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(za)}`)}jKb(za,ra){za=ra.BNb;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Hsb&&this.Iz?(this.Hsb.has(za.id)||
(this.iVg(za),this.Hsb.add(za.id)),this.A5b||(this.A5b=window.setTimeout(this.N8.bind(this),2E3))):b.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.Hsb}, recognizedTableStore = ${!!this.Iz}`))}N8(){for(const [,za]of this.Iz)b.ULS.sendTraceTag(521233110,306,15,JSON.stringify(za));window.clearTimeout(this.A5b);this.Hsb=this.A5b=void 0;this.Iz.clear();this.Iz=void 0;this.tableIntelligenceManager.Gwj(this.kKb);this.kKb=void 0}iVg(za){const ra=
za.PB.sheetId;this.Iz.has(ra)||this.Iz.set(ra,[]);this.Iz.get(ra).push(this.lY(za))}lY(za){const ra=[];for(const fb of za.interpretations){let Ua=0,Ca=0;for(const Ia of fb.fields)1===Ia.classification?Ua++:2===Ia.classification&&Ca++;ra.push({confidence:fb.confidence,headerRowCount:fb.headerRowCount,headerColumnCount:fb.headerColumnCount,orientation:fb.orientation,measureCount:Ca,dimensionCount:Ua})}return{interpretations:ra,range:{top:za.PB.range.top,bottom:za.PB.range.bottom,left:za.PB.range.left,
right:za.PB.range.right},isTable:!!za.tableName,annotationId:za.id}}}Object(u.a)(Q,"RecognizedTableLogger",null,[]);class W extends k.a{constructor(za,ra){super();this.b$a=this.rqf=!1;this.wAe={};this.instantaneousSupportInformationManager=null;this.lQd=void 0;this.bBf=!1;this.Lnc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6621453_TableIntelligenceMigrationToNewALAPI");this.L1e=(fb,Ua)=>{var Ca;1===Ua.operationType&&((Ua=Ua.QB)?(b.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Ua.requestId}`),
fb=I(Ua),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Ca=this.lQd)||void 0===Ca?void 0:Ca.dRi(fb)),({value:Ca}=this.R0d.nd(Ua.requestId)).returnValue?(this.R0d.remove(Ua.requestId),Ca(fb)):b.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Ua.requestId}`)):b.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null."))};
this.yve=(fb,Ua)=>{this.uOd("RecognizedTableUpdate",Ua)};this.augmentationLoopManager=za;this.$=ra;this.R0d=new A.a;this.$.da.Ja(20,this);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.lQd=new Q(this));this.Lnc&&this.augmentationLoopManager.register(this.augmentationLoopManager.j0().v2("TableIntelligence").t2(()=>{}).build())}pya(){this.YGc||(this.YGc=new L(this,this.augmentationLoopManager));return this.YGc}C9h(za,ra){if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&
1E4<za.range.sw)return b.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${za.range.sw} exceeds limit of ${1E4}`),4;this.pRg();if(this.MFi(za.range))return this.Ybi(za,ra);b.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}wYg(za){this.qRg();this.addHandler("RecognizedTableUpdate",za);this.Imf()}kzj(za){this.removeHandler("RecognizedTableUpdate",za)}Gad(za){return(ra,fb)=>{this.uOd(this.Zrc(za),fb)}}c1a(za,ra){var fb,Ua;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",
!1)&&(null===(Ua=null===(fb=this.$)||void 0===fb?void 0:fb.ua)||void 0===Ua?0:Ua.count)&&this.$.ua.count>y.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?b.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.ua.count}`):(this.Lnc?this.b$a||(this.augmentationLoopManager.o9("TableIntelligence",{Jv:!0,annotationType:v.getTypeName(),HO:this.Gad("New"),
nkb:this.Gad("Valid"),Qlc:this.Gad("Invalid")}),this.b$a=!0):this.wAe[za]||(this.b$a||(this.augmentationLoopManager.grb(v.getTypeName()),this.b$a=!0),this.augmentationLoopManager.Isb.Bua(za,v.getTypeName(),(Ca,Ia)=>this.uOd(this.Zrc(za),Ia)),this.wAe[za]=!0),this.mUg(za,ra),this.Imf())}Gwj(za){this.removeHandler(this.Zrc("Valid"),za)}mUg(za,ra){this.addHandler(this.Zrc(za),ra)}ytj(){y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&(this.Lnc?this.augmentationLoopManager.o9("TableIntelligence",
{annotationType:v.getTypeName(),Jv:!0,HO:this.yve}):(this.augmentationLoopManager.grb(v.getTypeName()),this.augmentationLoopManager.Bua(v.getTypeName(),this.yve)))}xtj(){this.Lnc?this.augmentationLoopManager.o9("TableIntelligence",{annotationType:x.getTypeName(),Jv:!1,HO:this.L1e}):(this.augmentationLoopManager.grb(x.getTypeName()),this.augmentationLoopManager.Bua(x.getTypeName(),this.L1e))}qRg(){var za,ra;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",
!1)&&(null===(ra=null===(za=this.$)||void 0===za?void 0:za.ua)||void 0===ra?0:ra.count)&&this.$.ua.count>y.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?b.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.ua.count}`):this.b$a||(this.ytj(),this.b$a=!0)}pRg(){this.rqf||(this.rqf=!0,this.xtj())}uOd(za,ra){1===ra.operationType&&((ra=ra.QB)?(ra=
I(ra),this.raiseEvent(za,new G(ra))):b.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}Zrc(za){return`${"RecognizedTableUpdate"}_${za}`}Ybi(za,ra){b.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const fb=za.range,Ua=E.h(this.$).sj("TableIntelligence",fb,1),Ca=[],Ia=[];let oa=0;const Da=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1),
bb=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceNumberFormatEnabled",!1);for(bb&&!this.instantaneousSupportInformationManager&&this.$.da.Gb(268,Za=>{this.instantaneousSupportInformationManager=Za});Ua.$$mn();){const Za=Ua.$$cu();if(!Za)continue;if(0===Za.Mp.type&&z.a.Sq(Za.Mp.value))continue;Za.GG&&Za.range&&Ia.push(Object(h.a)(new t.a,{worksheetId:za.sheetId,left:Za.range.left-1,top:Za.range.top-1,right:Za.range.right-1,bottom:Za.range.bottom-1}));const Xa=Za.range.top-
1,Ba=Za.range.left-1;let Wa=null,Na=null;bb&&({category:Na}=this.instantaneousSupportInformationManager.rra(Za.cell.li,!0),Za.text!=Za.Mp.value&&(Wa=Za.text,Da&&oa++));Ca.push(Object.assign(new w,{row:Xa,column:Ba,value:Za.Mp.value,type:Za.Mp.type,displayText:Wa,lok:Na}))}Da&&b.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${oa}, number of values: ${Ca.length}, range size: ${fb.height} rows by ${fb.width} columns`);if(0<Ca.length)return this.zqh(Ca,
za,Ia,ra),Ia.length?5:0;b.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}zqh(za,ra,fb,Ua){var Ca=ra.range;Ca=Object(h.a)(new t.a,{top:Ca.top,left:Ca.left,bottom:Ca.bottom,right:Ca.right,worksheetId:ra.sheetId});ra=l.a.create().toString();za=Object(h.a)(new r,{cells:za,range:Ca,mergeCellAddresses:fb,requestId:ra});this.augmentationLoopManager.eTb(za);this.R0d.add(ra,Ua)}MFi(za){const ra=E.h(this.$);if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)){const fb=ra.Yla();b.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${fb.width}, viewportHeight: ${fb.height}`)}return ra.Ca.bX(4,this.$.na)&&!!ra.jc(za.topLeft)&&!!ra.jc(za.bottomLeft)&&!!ra.jc(za.topRight)&&!!ra.jc(za.bottomRight)}Imf(){var za;!this.bBf&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.bBf=!0,null===(za=this.lQd)||void 0===za?void 0:za.aAg())}}Object(u.a)(W,"TableIntelligenceManager",k.a,[2,257]);var Ga=a(100),pa=a(149),aa=
a(36);class Z extends f.a{constructor(za){super();this.$=za;this.kc()}create(){d.TaskExtensions.za(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?Object(Ga.d)(pa.a.resolve(aa.f,{Wa:1})):e.GetServiceTaskFactory.Za(this.$.da,328,327,1),za=>{if(za=za.result){let ra=this.$.da.Ba(20);ra||(ra=new W(za,this.$),this.$.da.Ja(20,ra));this.Pb(ra)}else b.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),
this.Pb(null)},this.$.ka,3)}static la(za){za.da.Ja(404,new Z(za))}}Object(u.a)(Z,"TableIntelligenceManagerFactory",f.a,[]);class fa{constructor(za,ra){this.xAe=!1;this.tableIntelligenceManager=za;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void e.GetServiceTaskFactory.t0(ra.da,510,511,1);this.tableIntelligenceManager.c1a("Valid",()=>{this.xAe||(b.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.xAe=!0)})}}Object(u.a)(fa,"TableIntelligenceDarkActivationManager",
null,[258]);var ya=a(725);class Aa extends f.a{constructor(za){super();this.$=za;this.kc()}static la(za){za.da.Ja(481,new Aa(za))}create(){const za=e.GetServiceTaskFactory.Za(this.$.da,20,404,1);d.TaskExtensions.za(za,()=>{const ra=za.result,fb=Object(ya.a)(this.$.da,480,()=>new fa(ra,this.$));this.Pb(fb)},this.$.ka,3)}}Object(u.a)(Aa,"TableIntelligenceDarkActivationManagerFactory",f.a,[]);a.d(C,"a",function(){return ja});const ja=()=>{c.a.Fa(za=>{Z.la(za);Aa.la(za)})}},1263:function(u,C,a){u=a(0);
var c=a(229),b=a(2),f=a(15),e=a(272),d=a(259),h=a(140),l=a(1057);class k{constructor(E){this.Q5c=this.Bjd=null;this.sYa=this.isFocused=!1;this.$=E}dispose(){}get Lc(){return null}get sg(){return this.sYa}get Ge(){return d.a.xHd}Qg(E,G){G||this.isFocused||!this.Bjd||this.Bjd();return!G}hi(E){return E===document.activeElement&&this.isFocused}ek(){this.isFocused=!0}Gk(){this.isFocused&&this.Q5c&&(this.Q5c(),this.isFocused=!1)}Oti(){f.ULS.shipAssertTag(537169939,0,h.b("initializeNotificationFocusManagement"),
"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const E=Object(b.a)(new l.a,{onFirstActionableAppear:()=>{e.a(this.$).Pi(this);this.sYa=!0},onLastActionableDisappear:()=>{e.a(this.$).aB(this);this.sYa=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(E).then(G=>{this.Bjd=()=>{G.focus()};this.Q5c=()=>{G.blur()};return null})}}Object(u.a)(k,"EwaNotificationFocusManager",
null,[256,2,29]);class n extends c.a{constructor(E){super();this.$=E;this.kc()}create(){this.Pb(this.$.da.Ba(357)||new k(this.$))}static la(E){E.da.Ja(358,new n(E))}}Object(u.a)(n,"EwaNotificationFocusManagerFactory",c.a,[]);var v=a(1),x=a(1170);class w extends c.a{constructor(E){super();this.$=E;this.kc()}create(){const E=new x.a(this.$);this.Pb(this.$.da.Ba(456)||this.$.da.Ja(456,E))}static la(E){E.da.Ja(457,new w(E))}}Object(u.a)(w,"LineageDiscoverabilityCalloutFactory",c.a,[]);var r=a(722),t=
a(976);class A extends r.a{constructor(E){super(E)}dispose(){super.dispose()}he(){this.Pd([new t.a(this.$)])}static la(E){r.a.ye(378,new A(E))}}Object(u.a)(A,"ShowCalloutCommandHandlerFactory",r.a,[]);var y=a(10);a.d(C,"a",function(){return z});const z=()=>{y.a.Fa(E=>{v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices1",!1)||A.la(E)});y.a.Fa(n.la);y.a.Fa(w.la)}},1264:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(15),e=a(84),d=a(86),h=a(52),l=a(40),k=a(58);const n=(J,
L,R,Y,Q,W,Ga=null)=>{Ga=J.Pa(1,Ga);Ga.businessBarMessageType=L;return k.g(J,"EvaluateOptimizableContentV2",Ga,R,Y,Q,W,4)},v=(J,L,R,Y,Q,W,Ga=null)=>{Ga=J.Pa(1,Ga);Ga.sheetName=L;return k.g(J,"EvaluateSheetOptimizableContent",Ga,R,Y,Q,W,4)};var x=a(1),w=a(16),r=a(91),t=a(79),A=a(20),y=a(43),z=a(126);class E{constructor(J,L){this.sessionID=null;this.UTf=R=>{if(R){var Y={};if(({qt:Y}=y.d(R.data)).returnValue&&(R=Object(z.a)(Object,Y))&&"OptimizeWorkbookTaskPane"===R.Origin)if(this.sessionID!==R.SessionId)f.ULS.sendTraceTag(509748062,
0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(R.Event){case "Error_LoadBookData":this.optimizeWorkbookManager.vOj();f.ULS.sendTraceTag(509673560,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Load book data error Event.");break;case "OptimizeTriggered":this.optimizeWorkbookManager.UOj();f.ULS.sendTraceTag(509688027,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Optimize Event.");
break;case "TriggerFeedback":this.optimizeWorkbookManager.yXj();f.ULS.sendTraceTag(509748061,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Feedback Event.");break;default:f.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.optimizeWorkbookManager=J;this.sessionID=L}initialize(){window.addEventListener("message",this.UTf,!1)}dispose(){window.removeEventListener("message",
this.UTf,!1)}}Object(u.a)(E,"OptimizeWorkbookTaskPaneListener",null,[]);var G=a(7),F=a(71),O=a(100),M=a(149),P=a(36);class B extends d.a{constructor(J){super();this.businessBar=null;this.Mmb=2;this.Zob=-1;this.ZBc=!1;this.NLb=null;this.Nyf=this.mng=this.Usf=this.TTf=!1;this.l4i=L=>{this.$&&((L=L.Result)?L.HasSignificantOptimizableContent?(f.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),L.OptimizableRangesOrPercentage&&
(this.Zob=L.OptimizableRangesOrPercentage),0>=this.Zob&&0!==this.Mmb&&(f.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.Mmb=0),this.gSb()):f.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):f.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.taj=(L,R,Y)=>{(L=L.Result)?
L.HasSignificantOptimizableContent?(f.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.ZBc=!0,this.iZj(R,Y)):f.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):f.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.$=J;this.p1j();this.ZBc=!1;this.IAh=x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",
2E3);this.NLb=new E(this,this.$.ea.sessionId)}dispose(){this.J8a();this.$=this.businessBar=null;this.xUe();super.dispose()}dvi(){this.NLb&&this.NLb.initialize()}xUe(){this.NLb&&this.NLb.dispose()}J8a(){this.businessBar&&this.businessBar.qna(62)&&this.businessBar.removeEntry(62)}p1j(){e.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(J=>{J.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(L=>{L&&n(this.$.qa.va,this.Mmb,this.l4i,null,null,null);return L})})}gSb(){const J=
Object(F.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(O.d)(M.a.resolve(P.h,{Wa:1})):h.GetServiceTaskFactory.Za(this.$.da,5,4,1);l.TaskExtensions.za(J,()=>{const L=J.result;L&&(L.zh(62,null,null,this.O0h()),this.businessBar=L)},this.$.ka,3)}O0h(){switch(this.Mmb){default:return w.a.instance.ha(2239);case 1:return String.format(w.a.instance.Ha(720),this.Zob);case 2:return String.format(w.a.instance.Ha(721),this.Zob)}}nvi(){!x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1)||!this.Usf||this.TTf||this.mng||this.Nyf||(e.a.instance.qc("Common.ISystemInitiatedFeedback").execute(J=>{J.logActivity("Office_Excel_OptimizeWorkbook_InitializeClosePaneFloodgate",null)}),f.ULS.sendTraceTag(509688028,0,50,"OptimizeWorkbookManager.initiateClosePaneFeedback() - Feedback Triggered."))}eOj(J){this.Usf=J}UOj(){this.TTf=!0}vOj(){this.Nyf=!0}r$(J,L,R){if(L&&L.RequestTelemetryData&&!(L.RequestTelemetryData.EcsOperationDuration<this.IAh)&&this.businessBar&&this.businessBar.qna(62)&&!this.ZBc){var Y=
R?R:this.$.na.sheetName;if(6===J||7===J||8===J||9===J)this.evaluateSheetOptimizableContent(Y,J,L.RequestTelemetryData.EcsOperationDuration);else{const Q=()=>{A.h(this.$).Ca.Vw(Q);this.evaluateSheetOptimizableContent(Y,J,L.RequestTelemetryData.EcsOperationDuration)};A.h(this.$).Ca.rw(Q)}}}evaluateSheetOptimizableContent(J,L,R){v(this.$.qa.va,J,Y=>{this.taj(Y,L,R)},null,null,null)}iZj(J,L){const R=new r.a(-847286761,t.a.Vb,this.$.Kc,0,null),Y={CalloutName:18};Y.Target=this.businessBar.uld(62);Y.Operation=
J;Y.Duration=L;this.$.Ia.$b(R,Y)}yXj(){this.$.xd(802602464,t.a.Vb,12,{[G.a.xI]:"OptimizeWorkbookTaskPane"});this.mng=!0}}Object(u.a)(B,"OptimizeWorkbookManager",d.a,[423]);var D=a(725);class I extends b.a{constructor(J){super();this.$=J;this.kc()}create(){const J=Object(D.a)(this.$.da,465,()=>new B(this.$));this.Pb(J)}static la(J){J.da.Ja(466,new I(J))}}Object(u.a)(I,"OptimizeWorkbookManagerFactory",b.a,[]);a.d(C,"a",function(){return S});const S=()=>{c.a.Fa(J=>{I.la(J)})}},1487:function(u,C,a){a.r(C);
u=a(1263);C=a(1264);var c=a(1210);a=a(976);Object(u.a)();Object(a.b)();Object(C.a)();Object(c.a)()},752:function(u,C,a){u=a(0);var c=a(2),b=a(15),f=a(1382),e=a(902),d=a(903),h=a(170),l=a(774);class k{static gGb(B){return!!(B&1)}static Myd(B){return!!(B&2)}static Yhk(B){return!!(B&k.Bri)}}k.Bri=6;Object(u.a)(k,"EwaReactCalloutModeUtil",null,[]);class n{constructor(){this.A_=0;this.iHb=null;this.HGc=!0}}Object(u.a)(n,"EwaReactShowOrDismissCalloutMetadata",null,[]);var v=a(61),x=a(40),w=a(116),r=a(821),
t=a(149),A=a(36);class y{constructor(B,D,I){this.indexedDB=null;this.$=B;this.tN=D;this.iKa=I}Tyf(){const B=new h.a;let D=new n;x.TaskExtensions.za(this.GXe(),I=>{I.result?x.TaskExtensions.za(this.indexedDB.E7a(this.tN),S=>{if(S=S.result){S=v.a.Xi(S);if(!S){this.Q2e(B);return}if(k.gGb(this.iKa)){const J=S.NumberOfDisplays;D.A_=J?Number.parseLocale(J):0}k.Myd(this.iKa)&&(S=S.LastDisplay,D.iHb=S?new Date(Number.parseLocale(S)):null)}B.setResult(D)},this.$.ka):this.Q2e(B)},this.$.ka,3);return B.task}j$f(B){const D=
new h.a;x.TaskExtensions.za(this.GXe(),I=>{I.result||D.setResult(!1);I={};k.gGb(this.iKa)&&(I.NumberOfDisplays=B.A_.toString());k.Myd(this.iKa)&&(I.LastDisplay=w.toTimestamp(B.iHb).m.toString());I=v.a.Zc(I);x.TaskExtensions.za(this.indexedDB.Fgb(new r.a(this.tN,I)),S=>{D.setResult(S.result)},this.$.ka,3)},this.$.ka,3)}GXe(){const B=new h.a;this.indexedDB?B.setResult(!0):void t.a.resolve(A.U,{Wa:1}).then(D=>{D.sf()?(D.initialize("Callouts","EwaCallouts"),this.indexedDB=D,B.setResult(!0)):(b.ULS.sendTraceTag(573609248,
0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),B.setResult(!1))});return B.task}Q2e(B){const D=new n;D.HGc=!1;B.setResult(D)}}Object(u.a)(y,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[309]);class z{constructor(B,D,I,S,J,L){this.M7b=D;this.O7b=I;this.iKa=S;this.tN=J;this.localStorage=L;this.$=B}Tyf(){const B=new h.a,D=new n;if(k.gGb(this.iKa)){let I=0;D.HGc=({zoa:I}=this.J$j()).returnValue&&D.HGc;D.A_=I}B.setResult(D);return B.task}j$f(B){const D=
new h.a;var I=!0;if(k.gGb(this.iKa)){const S=this.p8e();S&&(I=Number.parseLocale(S),I=this.tak((I&~this.O7b|B.A_<<this.M7b).toString()))}D.setResult(I)}J$j(){var B;return(B=this.p8e())?(B=(Number.parseLocale(B)&this.O7b)>>this.M7b,b.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.tN} already appeared. Found the callout in storage.`),{returnValue:!0,zoa:B}):{returnValue:!1,zoa:0}}tak(B){try{if(!this.localStorage.sf())return!1;try{return this.localStorage.setItem("CalloutIds",
B),!0}catch(D){b.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${D.message||"Unknown"}`)}}catch(D){b.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${D.message}`)}return!1}p8e(){try{if(!this.localStorage.sf())return b.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.tN}.`),
null;const B=this.localStorage.getItem("CalloutIds");return B?B:(b.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(B){return b.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${B.message}`),null}}}Object(u.a)(z,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[309]);
var E=a(79),G=a(136),F=a(196),O=a(137),M=a(587);a.d(C,"a",function(){return P});class P extends l.a{constructor(B,D,I,S,J,L,R,Y,Q,W=!1,Ga=!1,pa=!1,aa=!1,Z=!1,fa=!0,ya=!1,Aa=null,ja=!1){super(B);this.A_=0;this.U_d=this.WKc=this.Uwg=!1;this.wPf=()=>{this.Nlc()};this.bEg=D;this.TWj=I;this.eyh=S;this.su=J;this.ru=L;this.localStorage=Q;this.aEg=R;this.$Dg=Y;this.bNi=W;this.nsd=Ga;this.hyh=pa;this.setInitialFocus=aa;this.useCoachmark=Z;this.YBc=!1;this.ZNj=fa;this.rEf=this.D9h();this.h3a=Aa;this.U_d=ja;
this.hasDynamicSizing=ya}get a5b(){return{}}set Syg(B){this.su=B}$9d(){}ANa(){return 1}Yld(){return 0}get zoa(){return 1}get AXf(){return!0}get tN(){return this.bEg}get O7b(){return this.aEg}get M7b(){return this.$Dg}show(){x.TaskExtensions.za(this.KDa(),B=>{B.result&&this.gXj()},this.$.ka)}Pzf(){O.b(this.$).Ld(G.a.RZe,this.Mff("dismiss"),void 0,!0)}GAf(){O.b(this.$).Ld(G.a.RZe,this.Mff("show"),void 0,!0)}Lxa(){const B=Object(c.a)(new f.a,{label:this.eyh,onExecute:()=>{this.$9d();this.Pzf();this.WKc=
!0;this.Nlc()}});let D=null;this.nsd||(D=Object(c.a)(new f.a,{label:this.TWj,onExecute:()=>{this.WKc=!0;this.GAf();const I=F.c({["InputMethod"]:E.a.Vb},this.a5b);this.$.Ia.$b(this.ribbonCommandInfo,I);this.Nlc()}}));return Object(c.a)(new e.a,{target:this.Mic(),content:this.ru,title:this.su,primaryButtonProps:this.nsd?B:D,secondaryButtonProps:this.nsd?null:B,showCloseIcon:this.U_d,preventLightDismiss:!this.bNi,hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(c.a)(new d.a,{onDismiss:()=>
{this.Nlc()},directionalHint:this.h3a,preventDismissOnScroll:!0,preventDismissOnResize:!this.hyh,isBeakVisible:this.ZNj,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}Nlc(){this.Uwg=!0;const B=this.$.da.Ba(418);B&&B.izj(this.wPf);(this.AXf&&this.WKc||this.U_d)&&this.Pqg(!0);this.WKc||b.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.tN} was dismissed without user interaction`);this.dismiss()}KDa(){const B=
new h.a;this.eza()?x.TaskExtensions.za(this.rEf.Tyf(),D=>{var I=this.ANa();D=D.result;if(D.HGc)if(this.A_=D.A_,k.gGb(I)&&(this.YBc||D.A_>=this.zoa))b.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.tN} already appeared. Found the callout in storage.`),this.YBc=!0,B.setResult(!1);else{if(k.Myd(I)&&D.iHb&&(I=w.getElapsedSeconds(D.iHb,new Date),(D=this.Yld())||b.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.tN} with mode RestrictedBycooldown`),
I<D)){B.setResult(!1);return}I=!this.WL&&!!this.Mic()&&!M.a(this.$);B.setResult(I)}else B.setResult(!1),b.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.tN}.`)},this.$.ka):B.setResult(!1);return B.task}eza(){return!0}Mic(){if(document.querySelector(this.UX))return this.UX;if(document.querySelector(this.TX))return this.TX;if(document.querySelector(this.mX))return this.mX;b.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.tN}`);
return null}Pqg(B=!1){this.YBc=!0;this.ANa();const D=new n;D.A_=B?this.zoa:this.A_+1;D.iHb=new Date;this.rEf.j$f(D)}gXj(){this.YBc=!0;this.Pqg();b.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.tN} callout, current number of displayes: ${this.A_}`);this.$.da.Gb(418,B=>{this.Uwg||B.uYg(this.wPf)});super.show()}D9h(){const B=this.ANa();return k.Yhk(B)?new y(this.$,this.tN,B):new z(this.$,this.M7b,this.O7b,B,this.tN,this.localStorage)}Mff(B){return{["selection"]:B,["callout"]:this.tN,
["Location"]:"floatie",["displayCount"]:this.A_}}}Object(u.a)(P,"EwaReactShowOrDismissCallout",l.a,[])},774:function(u,C,a){a.d(C,"a",function(){return e});u=a(0);var c=a(15),b=a(188),f=a(902);class e{constructor(d){this.WL=null;this.$=d}show(){const d=this.Lxa();c.ULS.shipAssertTag(537169938,0,!!d,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");b.UISurfaces.HI().then(h=>{const l=h.callout(d);this.WL=h.addNotification(l)},h=>{c.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${h}`);
return null})}dismiss(){this.WL&&b.UISurfaces.HI().then(d=>{d.removeNotification(this.WL);return this.WL=null})}QJc(d){b.UISurfaces.HI().then(h=>{h.updateNotification(this.WL,h.callout(Object.assign(new f.a,d)))},h=>{c.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${h}`);return null})}}Object(u.a)(e,"EwaReactCallout",null,[295])},976:function(u,C,a){function c(){window.__reslicingWorkaround=!0}u=a(119);var b=a(0),f=a(752),e=a(79),d=a(91),h=a(274),l=a(9),
k=a(1);const n='[id="'+l.a.elg+'"]';class v extends f.a{constructor(Ja,zb,na,Ea,ma,Ka,cb,Fa,wa,ka){super(Ja,zb,null,na,Ea,ma,Ka,cb,new h.a,Fa,!0,!0,wa,!1,!1,void 0,ka)}get UX(){return n}get TX(){return n}get mX(){return n}get ribbonCommandInfo(){return new d.a(-847286761,e.a.Vb,this.$.Kc,0,null)}eza(){return!(k.EwaSettings.isChangeGateEnabled("OfficeVSO:7270447_DisableCalloutInSpecialModes")&&(this.$.isMobileMode||this.$.ea.Gc.inEmbedView||this.$.ea.Gc.inWebPart))}}Object(b.a)(v,"ZoomTeachingCallout",
f.a,[]);var x=a(16);class w extends v{constructor(Ja){super(Ja,"AdjustZoomTeachingCallout",x.a.instance.Ha(694),null,x.a.instance.Ha(693),2,1,!1,!0,2)}}Object(b.a)(w,"AdjustZoomTeachingCallout",v,[]);class r extends f.a{constructor(Ja){super(Ja,"ConditionalFormattingManageRulesTeachingCallout",x.a.instance.Ha(643),x.a.instance.Ha(644),x.a.instance.Ha(641),x.a.instance.Ha(642),2,1,new h.a)}get UX(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get TX(){return'[data-unique-id="RibbonOverflowMenu"]'}get mX(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new d.a(-20558303,
e.a.Vb,this.$.Kc,0,null)}}Object(b.a)(r,"ConditionalFormattingManageRulesTeachingCallout",f.a,[]);var t;(function(Ja){Ja[Ja.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";Ja[Ja.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";Ja[Ja.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";Ja[Ja.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";Ja[Ja.lineageDiscoverability=4]="lineageDiscoverability";Ja[Ja.lineageTeachingCallout=5]="lineageTeachingCallout";
Ja[Ja.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";Ja[Ja.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";Ja[Ja.linkedEntityGallery=8]="linkedEntityGallery";Ja[Ja.fixedFreezePane=9]="fixedFreezePane";Ja[Ja.phoneticTeachingCallout=10]="phoneticTeachingCallout";Ja[Ja.powerQueryCallout=11]="powerQueryCallout";Ja[Ja.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";Ja[Ja.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";Ja[Ja.tableInNewWorkbook=
14]="tableInNewWorkbook";Ja[Ja.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";Ja[Ja.dataCleansing=16]="dataCleansing";Ja[Ja.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";Ja[Ja.excelBetterEntryTeachingCallout=19]="excelBetterEntryTeachingCallout";Ja[Ja.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";Ja[Ja.functionDialog=21]="functionDialog";Ja[Ja.length=22]="length"})(t||(t={}));Object(b.b)("EwaCalloutName",t);var A=
a(38);class y extends v{constructor(Ja){super(Ja,"FixedFreezePaneTeachingCallout",x.a.instance.Ha(647),x.a.instance.Ha(645),x.a.instance.Ha(646),65536,16,!0,!1,8)}ANa(){return 0}}Object(b.a)(y,"FixedFreezePaneTeachingCallout",v,[]);var z=a(1170);class E extends f.a{constructor(Ja){super(Ja,E.kNi,"",x.a.instance.Ha(651),x.a.instance.Ha(653),x.a.instance.Ha(654),4096,12,new h.a,void 0,!0);this.h3a=9}get UX(){return E.kCd}get TX(){return E.kCd}get mX(){return E.kCd}get ribbonCommandInfo(){return null}}
E.kNi="LineageTeachingCallout";E.kCd="#LineagePaneFilterButton";Object(b.a)(E,"LineageTeachingCallout",f.a,[]);var G=a(2),F=a(15),O=a(1382),M=a(103),P=a(902),B=a(903),D=a(774),I=a(7),S=a(54),J=a(23),L=a(972);class R extends L.a{constructor(Ja){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ja.paragraphs;this.image=Ja.image;this.imageWidth=Ja.imageWidth;this.imageHeight=Ja.imageHeight}}Object(b.a)(R,"TextAboveImage",L.a,[]);class Y{constructor(Ja,
zb){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ja;this.image=zb}}Object(b.a)(Y,"TextAboveImageCustomProps",null,[]);var Q=a(881);class W extends D.a{constructor(Ja){super(Ja);this.Gbg=0;this.UVa=this.target=null;this.fKc=!1;this.ru=this.su=null;this.C5c=0}vE(Ja,zb,na,Ea,ma,Ka){if(!this.Qo()){switch(Ea){case "DataTypes_PBI":this.C5c=1;break;default:this.C5c=0}this.target=Ja;this.su=String.format(x.a.instance.Ha(676),zb);this.ru=String.format(x.a.instance.Ha(677),
na);this.Gbg=Ka;this.jLj(Ea,ma)}}jLj(Ja,zb){const na=!!this.$.xa&&J.a.equals(this.$.xa.UICultureTag,"en-us",!0);this.fKc=zb&&na;zb&&!na?this.UVa="BlankCell":Ja?this.UVa=Ja:(F.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.UVa="BlankCell")}show(){F.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.ru&&!!this.su,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Qo()||(F.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}Qo(){return!!this.WL}Lxa(){const Ja=Object(G.a)(new O.a,{label:x.a.instance.Ha(682),ariaDescription:x.a.instance.Ha(683),onExecute:()=>{F.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),zb=Object(G.a)(new O.a,{label:this.fKc?x.a.instance.Ha(680):x.a.instance.Ha(678),
ariaDescription:this.fKc?x.a.instance.Ha(681):x.a.instance.Ha(679),onExecute:()=>{F.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.fKc?"Try sample data":"Learn more")+'" button');var Ka=new Map;Ka.set("Domain",this.Gbg.toString());M.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",0,"ropari",Ka);Ka=new d.a(-859308420,e.a.Vb,this.$.Kc,9,null);this.$.Ia.$b(Ka,{[e.a.Bg]:"HelpID="+this.UVa,["InputMethod"]:e.a.Vb,["ShouldCanvasTakeFocus"]:!0,
[e.a.rd]:I.a.fS});this.dismiss()}});var na=!!this.$&&!!this.$.frame&&!!this.$.frame.tE&&this.$.frame.tE.pO;switch(this.C5c){case 1:var Ea=na?129:126;break;default:Ea=na?128:123}Ea=Object(G.a)(new Q.a(S.a.current.Lo(Ea)),{alt:x.a.instance.Lb(184)});const ma=this.ru.split("\n\n");na=Object(G.a)(new Y(ma,Ea),{imageWidth:280,imageHeight:na?142:192});na=new R(na);return Object(G.a)(new P.a,{target:this.target,content:na,title:this.su,primaryButtonProps:zb,secondaryButtonProps:Ja,showCloseIcon:!0,calloutProps:Object(G.a)(new B.a,
{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(b.a)(W,"LinkedEntityBlankCellConvertTeachingCallout",D.a,[]);class Ga extends f.a{constructor(Ja){super(Ja,"LinkedEntityFirstOrganizationDataCallout",x.a.instance.Ha(672),x.a.instance.Ha(674),x.a.instance.Ha(670),x.a.instance.Ha(671),8192,13,new h.a,void 0,void 0,!0,!0);this.target=null;this.UVa=
"DataTypes_PBI"}get UX(){return this.target.toString()}get TX(){return this.target.toString()}get mX(){return'[id="'+this.$.fc+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new d.a(-859308420,e.a.Vb,this.$.Kc,9,null)}get a5b(){return{[e.a.Bg]:"HelpID="+this.UVa,["ShouldCanvasTakeFocus"]:!0,[e.a.rd]:I.a.fS}}vE(Ja){this.Qo()||(this.target=Ja,this.UVa="DataTypes_PBI")}Qo(){return!!this.WL}eza(){F.ULS.shipAssertTag(537169921,0,!!this.target,"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");
return!this.Qo()}}Object(b.a)(Ga,"LinkedEntityFirstOrganizationDataTeachingCallout",f.a,[]);class pa extends f.a{constructor(Ja){super(Ja,"LinkedEntityGalleryTeachingCallout","",x.a.instance.Ha(682),x.a.instance.Ha(684),x.a.instance.Ha(685),49152,14,new h.a,void 0,!0,!0,!0,!0);this.target=null;this.h3a=5}get zoa(){return 2}get UX(){return this.target.toString()}get TX(){this.h3a=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get mX(){return""}get ribbonCommandInfo(){return new d.a(-847286761,
e.a.Vb,this.$.Kc,0,I.a.wNb)}show(){F.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Qo()||(F.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}vE(Ja){this.Qo()||(this.target=Ja)}Qo(){return!!this.WL}eza(){F.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");
return!this.Qo()}}Object(b.a)(pa,"LinkedEntityGalleryTeachingCallout",f.a,[]);var aa=a(12);class Z extends D.a{constructor(Ja){super(Ja);this.ru=this.su=this.target=null}vE(Ja,zb,na){this.Qo()||(this.target=Ja,this.su=String.format(x.a.instance.Lb(186),zb),this.ru=String.format(x.a.instance.Lb(188),na))}show(){F.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.ru&&!!this.su,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Qo()||(F.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}Qo(){return!!this.WL}Lxa(){const Ja=Object(G.a)(new O.a,{label:x.a.instance.ha(1806),ariaDescription:x.a.instance.ha(1807),onExecute:()=>{F.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');M.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",0,"ropari",
null);aa.HelperMethods.Jf("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var zb=Object(G.a)(new Q.a(S.a.current.Lo(this.$&&this.$.frame&&this.$.frame.tE&&this.$.frame.tE.pO?130:127)),{alt:x.a.instance.Lb(189)});zb=Object(G.a)(new Y([this.ru],zb),{imageWidth:280,imageHeight:142});zb=new R(zb);return Object(G.a)(new P.a,{target:this.target,content:zb,title:this.su,primaryButtonProps:Ja,showCloseIcon:!0,calloutProps:Object(G.a)(new B.a,
{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(b.a)(Z,"LinkedEntityNoCuratedDataTeachingCallout",D.a,[]);var fa=a(173),ya=a(355);class Aa extends D.a{constructor(Ja){super(Ja);this.ru=this.su=null}vE(Ja){this.Qo()||(this.target=Ja,this.LLj())}show(){F.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.ru&&!!this.su,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Qo()||(F.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),fa.a.sendTelemetryEvent(Object(G.a)(new ya.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}Qo(){return!!this.WL}Lxa(){return Object(G.a)(new P.a,{target:this.target,title:this.su,content:this.ru,showCloseIcon:!0,calloutProps:Object(G.a)(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,
preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}LLj(){let Ja=-1,zb=0;const na=this.$.da.Ba(465);na&&(Ja=na.Zob,zb=na.Mmb);switch(zb){default:this.su=x.a.instance.Ha(722);this.ru=x.a.instance.Ha(725);break;case 1:F.ULS.debugAssertTag(512368795,0,-1!==Ja,"OptimizeWorkbookBusinessBarCallout.setCalloutTitleAndBody: Invalid range count");this.su=String.format(x.a.instance.Ha(723),Ja);this.ru=x.a.instance.Ha(726);break;case 2:F.ULS.debugAssertTag(512368794,
0,-1!==Ja,"OptimizeWorkbookBusinessBarCallout.setCalloutTitleAndBody: Invalid percentage"),this.su=String.format(x.a.instance.Ha(724),Ja),this.ru=x.a.instance.Ha(726)}}}Object(b.a)(Aa,"OptimizeWorkbookBusinessBarCallout",D.a,[]);var ja=a(144);class za extends f.a{constructor(Ja,zb,na,Ea,ma,Ka,cb,Fa=!1,wa="OverrideBrowserShortcutsTeachingCallout"){super(Ja,wa,zb,na,Ea,ma,Ka,cb,new h.a,Fa)}get UX(){return"[data-unique-id=Help]"}get TX(){return"[data-unique-id=pivotOverflowButton]"}get mX(){return'[id="'+
this.$.fc+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new d.a(-1018439626,e.a.Vb,this.$.Kc,0,I.a.U1)}eza(){return!ja.a.get(I.a.Ehb)}}Object(b.a)(za,"OverrideBrowserShortcutsTeachingCallout",f.a,[]);class ra extends za{constructor(Ja,zb,na,Ea,ma,Ka,cb,Fa=!1){super(Ja,zb,na,Ea,ma,Ka,cb,Fa,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new d.a(-901364793,e.a.Vb,this.$.Kc,0,I.a.U1)}get a5b(){return{[I.a.GLd]:!1}}}Object(b.a)(ra,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",
za,[]);var fb=a(41);class Ua extends f.a{constructor(Ja,zb,na,Ea,ma,Ka,cb,Fa,wa,ka,Oa=!1,hb=!1,Pa=!1,ca=!1,ba=!1,ib=!0,Lb=!1,gc=null,Gc=!1){super(Ja,zb,na,Ea,ma,Ka,Fa,wa,ka,Oa,hb,Pa,ca,ba,ib,Lb,gc,Gc);this.learnMoreUrl=null;this.learnMoreUrl=cb}Mej(){try{fb.a.jW(this.learnMoreUrl)}catch(Ja){}}$9d(){null!=this.learnMoreUrl&&this.Mej()}}Object(b.a)(Ua,"EwaReactShowOrLearnMoreCallout",f.a,[]);const Ca='[id="'+l.a.elg+'"]';class Ia extends Ua{constructor(Ja){super(Ja,"PhoneticTeachingCallout",x.a.instance.Ha(695),
x.a.instance.Ha(698),x.a.instance.Ha(697),x.a.instance.Ha(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new h.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get UX(){return Ca}get TX(){return Ca}get mX(){return Ca}get ribbonCommandInfo(){return new d.a(1455037301,e.a.Vb,this.$.Kc,0,null)}Pzf(){F.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}GAf(){F.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(b.a)(Ia,"PhoneticTeachingCallout",
Ua,[]);var oa=a(176);class Da extends f.a{constructor(Ja,zb,na,Ea,ma,Ka){super(Ja,zb,x.a.instance.Ha(708),x.a.instance.Ha(707),x.a.instance.Ha(703),na,Ea,ma,new h.a,!0,!1,void 0,void 0,void 0,!0,!0);this.h3a=5;this.V6c=Ka}get zoa(){return 2}get UX(){return 1===oa.a(this.$).wP?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get TX(){return"[data-unique-id=Connections_MLR"}eza(){return this.V6c}get mX(){return'[id="'+this.$.fc+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new d.a(-859308420,
e.a.Vb,this.$.Kc,9,null)}get a5b(){return{[e.a.Bg]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[e.a.rd]:I.a.fS}}v_d(){return this.KDa()}show(){this.Mic()?super.show():F.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(b.a)(Da,"PowerQueryRefreshTeachingCalloutBase",f.a,[]);class bb extends Da{constructor(Ja){super(Ja,"PowerQueryRefreshFromTableTeachingCallout",x.a.instance.Ha(705),3145728,20,k.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?
k.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"):k.EwaSettings.oFi())}}Object(b.a)(bb,"PowerQueryRefreshFromTableTeachingCallout",Da,[]);class Za extends f.a{constructor(Ja){super(Ja,"QueriesTaskPaneTeachingCallout",x.a.instance.Ha(702),x.a.instance.Ha(701),x.a.instance.Ha(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?849:699),x.a.instance.Ha(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1)?850:700),12582912,22,new h.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.h3a=5;this.V6c=k.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?k.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations"):k.EwaSettings.EFi()}get zoa(){return 2}get UX(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get TX(){return"[data-unique-id=Connections_MLR]"}get mX(){return'[id="'+this.$.fc+'Ribbon.Data.Queries"]'}v_d(){return this.KDa()}show(){this.Mic()?
super.show():F.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}eza(){return this.V6c}get ribbonCommandInfo(){return new d.a(1156885807,e.a.Vb,this.$.Kc,0,I.a.wNb)}}Object(b.a)(Za,"QueriesTaskPaneTeachingCallout",f.a,[]);var Xa=a(429),Ba=a(200),Wa=a(477),Na=a(230),ta=a(246);class V extends Da{constructor(Ja){super(Ja,"PowerQueryAuthenticatedRefreshTeachingCallout",x.a.instance.Ha(706),805306368,28,k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1))}}Object(b.a)(V,"PowerQueryAuthenticatedRefreshTeachingCallout",Da,[]);class ia{constructor(Ja){this.Jif=this.hjf=!1;this.KDa=!0;this.E6i=zb=>{if(zb&&!Na.a(zb))try{const na=zb.Result,Ea=na.QueryGroups;if(0<na.Queries.length||0<Ea.length)this.hjf=!0,this.Jif=na.PowerQueryDataSources?na.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||na.PowerQueryDataSources.includes("OData.Feed"):!1,this.dFc()}catch(na){F.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${na}.`)}};
this.Duc=()=>{F.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=Ja;this.aZf=new Za(Ja);this.nNd=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new V(Ja):new bb(Ja)}show(){this.KDa&&this.JJj()}JJj(){this.$.userOperationManager.kd(new Ba.a(587,0,(Ja,zb,na)=>Wa.d(this.$.qa.va,ta.b(Ja,this.E6i),ta.a(zb,this.Duc),na,null),80,()=>new Xa.a),null)}dFc(){this.aZf.v_d().continueWith(Ja=>{Ja.result&&this.hjf?(this.aZf.show(),this.KDa=
!1):this.nNd.v_d().continueWith(zb=>{zb.result&&(this.nNd instanceof V||this.Jif)&&this.nNd.show();this.KDa=!1})})}}Object(b.a)(ia,"PowerQueryCallout",null,[295]);class X extends D.a{constructor(Ja){super(Ja);this.kHd=this.T$c=this.ru=this.su=this.target=null}vE(Ja,zb,na){this.Qo()||(this.target=Ja,this.T$c=zb,this.kHd=na,this.su=x.a.instance.Ha(710),this.ru=x.a.instance.Ha(711))}show(){F.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.ru&&!!this.su&&!!this.T$c&&!!this.kHd,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Qo()||(F.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}Qo(){return!!this.WL}Lxa(){const Ja=Object(G.a)(new O.a,{label:x.a.instance.Ha(712),ariaDescription:x.a.instance.Ha(714),onExecute:()=>{F.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.T$c();this.dismiss()}}),zb=Object(G.a)(new O.a,{label:x.a.instance.Ha(713),ariaDescription:x.a.instance.Ha(715),onExecute:()=>{F.ULS.sendTraceTag(0,
0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.kHd();this.dismiss()}});return Object(G.a)(new P.a,{target:this.target,content:this.ru,title:this.su,primaryButtonProps:Ja,secondaryButtonProps:zb,showCloseIcon:!0,calloutProps:Object(G.a)(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(b.a)(X,"TableAIConvertToTableCallout",
D.a,[]);var la=a(180),sa=a(84);class Va{constructor(Ja){this.g9j=Ja}show(){sa.a.instance.qc("Common.ISystemInitiatedFeedback").execute(Ja=>{Ja.logActivity(this.g9j,null)})}}Object(b.a)(Va,"EwaLppCallout",null,[295]);var nb=a(47);class ha extends Va{constructor(Ja){super("ExcelTableInNewWorkbook");this.awd=this.Vza=!1;this.createTable=()=>{const zb=nb.v(new la.a(1,1,8,3,l.a.Hg,l.a.Gg),this.$),na={};na.TableRange=zb;na.HasHeader=!1;this.$.xd(71074531,e.a.Vb,9,na)};this.cQe=()=>{this.createSampleTable("0")};
this.dQe=()=>{this.createSampleTable("2")};this.eQe=()=>{this.createSampleTable("1")};this.$=Ja;(this.Vza=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.awd=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.cQe,!0),window.addEventListener("ExcelCreateSampleTableContact",this.dQe,!0),window.addEventListener("ExcelCreateSampleTableToDo",
this.eQe,!0)}dispose(){this.Vza&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.awd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.cQe,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.dQe,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.eQe,!0))}createSampleTable(Ja){const zb={};zb[e.a.rd]=Ja;this.$.xd(1371713064,e.a.Vb,9,zb)}}Object(b.a)(ha,"TableInNewWorkbookCallout",Va,[]);var jb=a(1134);class Fb extends D.a{constructor(Ja){super(Ja);
this.oFc=5E3;this.su=jb.a.Title;this.currentState=0}Xwa(Ja,zb){jb.c.get(this.currentState).includes(Ja)&&(6===Ja?window.requestAnimationFrame(()=>this.zdc(Ja,zb)):this.zdc(Ja,zb))}YUb(Ja){this.target=Ja}show(){super.dismiss();this.u7f();super.show()}dismiss(){this.Xwa(0);window.clearTimeout(this.T2f);super.dismiss()}Lxa(){return Object(G.a)(new P.a,{target:this.target,title:this.su,content:this.ru,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,preventDismissOnResize:!0,preventDismissOnScroll:!0,
preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.u7f();super.QJc({message:this.ru})}zdc(Ja,zb){const na=jb.b.get(Ja);this.ddk(this.Uzh(Ja)?`${na}${zb}`:na);this.currentState=Ja;0!=this.currentState?(this.update(),this.show()):this.dismiss()}Uzh(Ja){switch(Ja){case 5:case 6:return!0;default:return!1}}u7f(){window.clearTimeout(this.T2f);this.T2f=window.setTimeout(()=>this.dismiss(),this.oFc)}ddk(Ja){this.ru=
Ja}}Object(b.a)(Fb,"FormulaByExampleCurtainLifterCallout",D.a,[]);var Rb=a(189);class mb extends f.a{constructor(Ja){super(Ja,"DataCleansingTeachingCallout",Rb.a.ha(1952),Rb.a.ha(1953),"",Rb.a.ha(1954),16777216,24,new h.a,!0,!1,!1,!1,!0,!0,!0,5,!0);this.f2d="[id=DataCleansingTaskPane]";this.nxg=!1}vE(Ja,zb){this.Syg=String.format(x.a.instance.Lb(213),Ja);this.nxg=zb}ANa(){return k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)&&this.nxg?
0:2}Yld(){return 2592E3}get UX(){return this.f2d}get TX(){return this.f2d}get mX(){return this.f2d}get ribbonCommandInfo(){return new d.a(-1190551534,e.a.Vb,this.$.Kc,0,null)}}Object(b.a)(mb,"DataCleansingTeachingCallout",f.a,[]);var sb=a(114);class Ya extends D.a{constructor(Ja){super(Ja);this.ru=this.su=this.target=null;this.duration=0}vE(Ja,zb,na){this.Qo()||(this.target=Ja,this.su=this.o1h(zb),this.ru=x.a.instance.Ha(737),this.operation=zb,this.duration=na)}show(){F.ULS.shipAssertTag(512304648,
0,!!this.target&&!!this.ru&&!!this.su,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");if(!this.Qo()){F.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var Ja={["Operation"]:this.operation,["Duration"]:this.duration};fa.a.sendTelemetryEvent(Object(G.a)(new ya.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",
dataFields:sb.a.Yh(Ja)}));super.show()}}Qo(){return!!this.WL}Lxa(){return Object(G.a)(new P.a,{target:this.target,title:this.su,content:this.ru,showCloseIcon:!0,calloutProps:Object(G.a)(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}o1h(Ja){switch(Ja){case 0:return x.a.instance.Ha(727);case 1:return x.a.instance.Ha(728);case 2:return x.a.instance.Ha(729);
case 3:return x.a.instance.Ha(730);case 4:return x.a.instance.Ha(731);case 5:return x.a.instance.Ha(732);case 6:return x.a.instance.Ha(733);case 7:return x.a.instance.Ha(734);case 8:return x.a.instance.Ha(735);case 9:return x.a.instance.Ha(736);default:return F.ULS.debugAssertTag(512304646,0,!1,"OptimizeWorkbookSlowOperationsCallout.getCalloutTitle: Invalid operation"),""}}}Object(b.a)(Ya,"OptimizeWorkbookSlowOperationsCallout",D.a,[]);class Ma extends D.a{constructor(){super(...arguments);this.Yzg=
"ClickOnLaunch";this.tzg="ClickOnDismiss";this.RAg="Show";this.Ezg="BetterEntryPoint_InsertTab";this.gBg=500;this.Szg=280;this.Rzg=192;this.AAg="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.Kzg="[data-unique-id=Home]";this.Uzg="InsertAddinTransitionEntry";this.Lzg="Home";this.Tzg="InsertAddInFlyout";this.CAg="RibbonOverflowMenu-overflow"}vE(){}show(){this.LA(this.RAg);F.ULS.sendTraceTag(509367621,0,50,"ExcelBetterEntryTeachingCallout.Show() - Showing ExcelBetterEntryTeachingCallout callout.");
super.show()}Lxa(){let Ja=this.AAg;var zb=document.getElementById(this.Uzg),na=zb?window.getComputedStyle(zb,null):null;if(null==zb||na&&"none"===na.display)Ja=this.Kzg;zb=CommonUIStrings.l_BetterEntryPointTUI_Title;var Ea=CommonUIStrings.l_BetterEntryPointTUI_Content;na=new Q.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF8");Ea=Ea.split("\n");na=Object.assign(new Y(Ea,na),{imageWidth:this.Szg,imageHeight:this.Rzg});na=new R(na);Ea=Object.assign(new O.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,
ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,onExecute:()=>{this.Oli();this.LA(this.Yzg);this.dismiss()}});const ma=Object.assign(new O.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,onExecute:()=>{this.LA(this.tzg);this.dismiss()}});return Object.assign(new P.a,{target:Ja,content:na,title:zb,primaryButtonProps:Ea,secondaryButtonProps:ma,showCloseIcon:!0,hasDynamicSizing:!1,preventLightDismiss:!1,useTeachingStyles:!0,
calloutProps:Object.assign(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0})})}Oli(){appChrome.api.dispatch(appChrome.actions.setCurrentTab(this.Lzg));window.setTimeout(()=>{this.OBd()},this.gBg)}OBd(){const Ja=document.getElementById(this.Tzg),zb=Ja?window.getComputedStyle(Ja,null):null;if(null==Ja||zb&&"none"===zb.display){const na=document.getElementById(this.CAg);null!=na?(na.onclick=function(){window.setTimeout(()=>{const Ea=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");
null!=Ea&&(Ea.click(),F.ULS.sendTraceTag(509367620,0,50,"Launch flyout in overflow"))},500);na.onclick=function(){}},na.click()):F.ULS.sendTraceTag(509367619,0,10,"Neither ribbon nor overflow can launch flyout")}else Ja.click(),F.ULS.sendTraceTag(509367618,0,50,"Launch flyout in ribbon button")}LA(Ja){Ja={["AppTeachingUICalloutAction"]:Ja,["AppTeachingUICalloutGoal"]:this.Ezg};fa.a.sendTelemetryEvent(Object.assign(new ya.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:sb.a.Yh(Ja)}))}}
Object(b.a)(Ma,"ExcelBetterEntryTeachingCallout",D.a,[]);class xb extends f.a{constructor(Ja){super(Ja,"FunctionDialogTeachingCallout",void 0,x.a.instance.Ha(763),x.a.instance.Ha(760),x.a.instance.Ha(761),1073741824,30,new h.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}vE(Ja){this.B3c=`[id=${"CellEdit"===Ja?this.$.fc+I.a.Tfc:"InsertFunction"}]`}ANa(){return 1}get UX(){return this.B3c}get TX(){return this.B3c}get mX(){return this.B3c}get ribbonCommandInfo(){return null}}Object(b.a)(xb,"FunctionDialogTeachingCallout",
f.a,[]);class qb extends Va{constructor(Ja){super("ExcelLiveWebEntryPointCallout");this.uza=!1;this.ykg=()=>{this.$.xd(327119921,e.a.Vb,9,null)};this.$=Ja;(this.uza=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.ykg,!0)}dispose(){this.uza&&window.removeEventListener("TryCoEditInTeams",this.ykg,!0)}}Object(b.a)(qb,"ExcelLiveWebEntryPointCallout",Va,[]);class Ra{constructor(Ja){this.$=Ja;this.yx=
new A.a(!1)}aai(Ja){if(!this.yx.Fb(t[Ja]))switch(Ja){case 0:this.Flh(Ja);break;case 2:this.yx.add(t[Ja],new W(this.$));break;case 3:this.yx.add(t[Ja],new Z(this.$));break;case 6:this.yx.add(t[Ja],new Ga(this.$));break;case 1:this.yx.add(t[Ja],new r(this.$));break;case 4:this.yx.add(t[Ja],new z.a(this.$));break;case 5:this.yx.add(t[Ja],new E(this.$));break;case 7:this.yx.add(t[Ja],new w(this.$));break;case 8:this.yx.add(t[Ja],new pa(this.$));break;case 9:this.yx.add(t[Ja],new y(this.$));break;case 13:this.yx.add(t[Ja],
new Aa(this.$));break;case 10:this.yx.add(t[Ja],new Ia(this.$));break;case 11:this.yx.add(t[Ja],new ia(this.$));break;case 12:this.yx.add(t[Ja],new X(this.$));break;case 14:this.yx.add(t[Ja],new ha(this.$));break;case 15:this.yx.add(t[Ja],new Fb(this.$));break;case 16:this.yx.add(t[Ja],new mb(this.$));break;case 18:this.yx.add(t[Ja],new Ya(this.$));break;case 20:this.yx.add(t[Ja],new qb(this.$));break;case 19:this.yx.add(t[Ja],new Ma(this.$));break;case 21:this.yx.add(t[Ja],new xb(this.$));break;
default:return null}return this.yx.getItem(t[Ja])}Flh(Ja){this.yx.add(t[Ja],new ra(this.$,x.a.instance.Ha(640),x.a.instance.Ha(637),x.a.instance.Ha(638),x.a.instance.Ha(639),16,4,!0))}}Object(b.a)(Ra,"EwaCalloutFactory",null,[]);var Jb=a(63),yb=a(62),Gb=a(160);f=a(36);D=a(149);a.d(C,"b",function(){return c});a.d(C,"a",function(){return ub});let ub=class{constructor(Ja){this.$=Ja;this.GFh=new Ra(this.$)}hd(){return!1}ld(){return!1}Tc(Ja,zb,na){Ja=na.CalloutName;this.fWj=k.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&
Object(Gb.c)(this.$)&&!this.izi(Ja);return!!zb&&-847286761===zb.command&&Jb.a.eh.tS&&!this.fWj}izi(Ja){return k.EwaSettings.isChangeGateEnabled("OfficeVSO:6774891_ShowCalloutForExcelLiveOnMobile")&&this.$.Iv&&9===Ja}executeCommand(Ja,zb,na){Ja=na.CalloutName;if(zb=this.GFh.aai(Ja)){switch(Ja){case 2:zb.vE(na.Target,na.RibbonButtonLabel,na.ExampleEntities,na.BlankCellResourceId,na.HasBlankCellWalkthrough,na.ServiceDomain);break;case 3:zb.vE(na.Target,na.RibbonButtonLabel,na.ExampleEntities);break;
case 6:zb.vE(na.Target);break;case 8:zb.vE(na.Target);break;case 13:zb.vE(na.Target);break;case 15:return zb.YUb(na.Target),zb.Xwa(na.NewState,na.Reason),yb.Task.Ua(!0);case 12:zb.vE(na.Target,na.ConvertToTableCallback,na.NoThanksCallback);break;case 16:zb.vE(na.SuggestionsCount,na.WithoutCoolDown);break;case 18:zb.vE(na.Target,na.Operation,na.Duration);break;case 19:zb.vE();break;case 21:zb.vE(na.Trigger)}zb.show();return yb.Task.Ua(!0)}return yb.Task.Ua(!1)}};ub=Object(u.b)([Object(D.d)(f.qb),Object(u.c)(0,
Object(f.A)())],ub);Object(b.a)(ub,"ShowCalloutCommandHandler",null,[200])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.pid.js.map/7cb5a27968e4704759f8c16eb44b33f2/EwaDSOpt.pid.js.map