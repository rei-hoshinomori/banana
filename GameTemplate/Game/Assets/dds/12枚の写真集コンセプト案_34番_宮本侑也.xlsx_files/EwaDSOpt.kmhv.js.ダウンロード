'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[50],{1504:function(u,C,a){a.r(C);var c={};a.r(c);a.d(c,"TryOfficeThroughTellMeCommandHandler",function(){return Wc});var b={};a.r(b);a.d(b,"NamedSheetViewPublic",function(){return Le});var f={};a.r(f);a.d(f,"NamedSheetViewTeachingCallout",function(){return Ac});var e={};a.r(e);a.d(e,"SheetOptionsToggleCommandHandler",function(){return Bc});var d=a(0),h=a(562),l=a(15),k=a(88),n=a(199),v=a(849),x=a(34),w=a(145);class r{static RCh($b){return r.MFe("New",
$b)}static SCh($b){return r.MFe("Open",$b)}static vFe($b,tc){return r.Ija("LoadingMenuSection",r.pOi,$b,r.cub("lblLoading",tc))}static dub($b,tc,Xc=null,qd=null){return r.Ija("MessageMenuSection",r.VEf,tc,r.cub("lblMessage",$b,Xc,qd))}static a8g($b){return r.vFe($b,CommonUIStrings.l_VoicedLoadingText)}static b8g($b,tc){return r.dub(CommonUIStrings.l_NewCreationLocationMessage,$b.Fi,tc.ZS,tc.Rqa)}static $7g($b,tc){return r.dub(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,tc.Rqa,"\n\n"),
$b.Fi)}static xFe($b){return r.dub(CommonUIStrings.l_NewGenericErrorMessage,$b.Fi)}static Y7g($b,tc,Xc){return r.Ija("menuNewBlank",r.ooi,Xc?$b.Fi:null,r.Xtb($b.yjf,$b.zjf,$b.Ajf,null,$b.E0,$b.oDb,tc,"blank"))}static Y8g(){return r.cub("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static JFe(){return r.cub("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static Z8g($b,tc){return r.Ija("menuNewTemplates",$b,null,tc)}static W7g($b,tc){return r.Ija("menuNewMoreTemplates",r.y5e,
null,r.Xtb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,$b,tc))}static Z6g($b,tc,Xc){let qd="";Xc&&tc&&(qd=r.Ija("BrowseMoreMenuSection",r.y5e,null,r.Xtb("btnBrowseMore",tc,tc,null,null,null,$b||"1959943459",Xc)));return qd}static cub($b,tc,Xc=null,qd=null){let Cd=qd;tc&&0<tc.length&&(Cd=r.RFf.$wc(tc).trimEnd(),Cd=0<=Cd.indexOf("{0}")?String.format(Cd,qd):String.format("{0} {1}",Cd,qd));Xc=Xc&&qd?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
x.a.Sf(Xc),x.a.Sf(qd),x.a.Sf(Cd)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',x.a.Sf($b||""),r.RFf.$wc(x.a.Sf(tc||"")),Xc)}static Xtb($b,tc,Xc,qd,Cd,Xd,ge,ve){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',x.a.Sf($b||""),x.a.Sf(tc||
""),x.a.Sf(Xc||""),qd||"32by32",x.a.Sf(Cd||""),x.a.Sf(Xd||""),ge,x.a.Sf(ve||""))}static MFe($b,tc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',$b,tc)}static Ija($b,tc,Xc,qd){Xc=Xc?String.format('Title="{0}"',x.a.Sf(Xc)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
x.a.Sf($b||""),x.a.Sf(tc||""),Xc,qd)}}r.VEf="MenuMru";r.pOi="MenuLoading";r.ooi="MenuHeader";r.y5e="MenuFooter";r.RFf=w.a.Vy("\n","&#10;");Object(d.a)(r,"NewAndOpenXmlUtilities",null,[]);var t=a(6),A=a(103),y=a(128),z=a(140);class E{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(d.a)(E,"HostInformation",null,[]);var G=a(112),F=a(108),O=a(41),M=a(234),P=a(384),B=a(178),D=a(666),I=a(588),S=a(111),J=a(26),L=a(69);class R{constructor($b,tc,Xc,qd,Cd,Xd){this.s0a=this.Eo=
this.WWb=null;this.Q1b=this.hZc=!1;this.yle=0;this.YYc=this.qTc=!1;this.Y3=$b;this.Qmb=tc;this.KGa=new h.a(()=>new v.a(Xc.value,Object(k.a)(this,this.oBb,"getMoreInfoEventReceived")));this.IKg=qd;this.zta=Cd;this.UNg=Xd;this.eqb=this.NEc;this.TZb=!!t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.ra("GateTemplateRenderingByGetMoreInfoResponse");2===this.xC.NS&&(this.YYc=!0);t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)&&this.dRh()}get WQ(){switch(this.xC.NS){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}dRh(){F.a.instance.jg(new G.a(5,1,0,()=>{this.getTemplateListJson()}))}vh(){const $b=this.xC.jcb;$b.xc(J.a.newDocument,S.a.frame,Object(k.a)(this,this.newDocument,"newDocument"));$b.xc(J.a.rxc,S.a.frame,Object(k.a)(this,this.rxc,"populateNewMenu"))}newDocument($b,tc,Xc,qd,Cd){if(1===Xc)return 32;if(2===Xc&&Cd){if(t.AFrameworkApplication.fa.ra("BackstagePremiumTemplateExperienceEnabled")&&
Cd.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),t.AFrameworkApplication.Qb.processAction(J.a.Fkj,2);if(Cd.MenuItemId&&Cd.SourceControlId)return"NewDocumentHome"===Cd.SourceControlId&&y.a("NewDocumentFromHomeTab"),this.v4a(Cd.MenuItemId,Cd.SourceControlId)}return 8}v4a($b,tc){var Xc=this.jtc.hbd;if(null===Xc)return 8;var qd=t.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(t.AFrameworkApplication.eea&&qd){l.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Cd={};Cd[P.a.Hng]=$b;Cd[P.a.WQ]=this.WQ;Cd[P.a.lcid]=t.AFrameworkApplication.lcid.toString();Cd[P.a.reason]=D.a.createNew;Cd[P.a.uiCulture]=t.AFrameworkApplication.uiCulture;Cd[P.a.dataCulture]=t.AFrameworkApplication.dataCulture;t.AFrameworkApplication.cS().execute(Xd=>{Xd.sendMessage(B.a.v4a,Cd)})}else qd=(new Date).getTime(),tc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
Xc,x.a.Rf(this.toa),x.a.Rf($b),x.a.Rf(this.WQ),x.a.Rf(t.AFrameworkApplication.lcid.toString()),x.a.Rf(qd.toString()),x.a.Rf(tc),x.a.Rf(t.AFrameworkApplication.canary),t.AFrameworkApplication.ej),(Xc=t.AFrameworkApplication.fa.Va("ScenarioId"))&&""!==Xc&&(tc+="&wdscenarioid="+x.a.Rf(Xc)),tc+="&"+t.AFrameworkApplication.zic(),t.AFrameworkApplication.Eza&&(tc+="&"+t.AFrameworkApplication.Uhc()),(Xc=this.Eo?this.Eo.ZS:null)?tc+="&DestinationUrl="+x.a.Rf(Xc):l.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),
O.a.Jf(tc,"_blank",void 0,"CreateNewDocument");2!==this.xC.NS&&3!==this.xC.NS||l.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:I.a[this.xC.NS],["Template"]:$b});t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.xC.NS&&("blank"===$b?y.b("ConsumerTemplateNewBlank"):($b=[Object.assign(new L.a,{name:"TemplateId",string:$b})],y.b("ConsumerTemplateNew",null,0,!0,0,$b)));
return 32}ORi($b){let tc=Number.MAX_VALUE,Xc=Number.MIN_VALUE;const qd=window.performance;if(qd&&"undefined"!==typeof qd.getEntriesByName){for(let Xd=0;Xd<$b.length;Xd++){var Cd=qd.getEntriesByName($b[Xd]);Cd&&0<Cd.length&&(Cd=Cd[0],tc=Math.min(parseInt(String(Cd.fetchStart)),tc),Xc=Math.max(parseInt(String(Cd.responseEnd)),Xc))}Xc>tc&&l.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Xc-tc,["MinFetchStart"]:tc,["MaxResponseEnd"]:Xc})}}rxc($b,tc,
Xc,qd,Cd){if(1===Xc)return this.YYc&&(t.AFrameworkApplication.GS("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.YYc=!1),32;2!==Xc||this.qTc||(this.yle=(new Date).getTime(),l.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.NEc,["CachedNewMenuXmlExists"]:!!this.WWb,["ShouldCallGetMoreInfo"]:this.xC.supportsGetMoreInfoForPersonalStorage}));t.AFrameworkApplication.e8("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");
t.AFrameworkApplication.e8("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.xjj(Cd)}xjj($b){$b&&(this.WWb?$b.PopulationXML=this.WWb:(this.xC.supportsGetMoreInfoForPersonalStorage&&!this.Eo&&this.oYi.v0("Opened New menu",!0),$b.PopulationXML=this.oZh(this.getTemplateListJson())));return 32}ytf(){return!this.xC.supportsGetMoreInfoForPersonalStorage||!!this.Eo&&3===this.Eo.state&&!!this.Eo.Rqa&&!!this.Eo.ZS}Ayd(){return t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.X0&&!this.TZb?
!0:this.ytf()}getTemplateListJson(){if(!this.NEc&&!this.TZb&&!this.Ayd())return null;if(this.eqb&&!this.Q1b){var $b="9";t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&($b="21");const tc=t.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in tc&&($b=tc.NumberOfTemplatesInBackstage);let Xc=this.WQ;"TemplateCollectionId"in tc&&(Xc=tc.TemplateCollectionId);t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",
!1)&&(Xc="WordConsumerWAC",$b="23");$b=String.format(this.xC.s1+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",x.a.Rf(t.AFrameworkApplication.lcid.toString()),x.a.Rf(Xc),$b);Boolean.parse(tc.AppendOriginQueryParam||"false")&&($b+="&org=backstage");Boolean.parse(tc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in tc&&($b+="&templateTier="+tc.TemplateTier);$b+="&"+t.AFrameworkApplication.zic();t.AFrameworkApplication.Eza&&($b+="&"+t.AFrameworkApplication.Uhc());this.xC.AJb.Fn($b,
1,null,null,!1,2,qd=>{this.xC.eRa("CreateNewActor.GetTemplateListJson",qd.data);this.n5j(qd.data.Fe)},qd=>{this.xC.eRa("CreateNewActor.GetTemplateListJson",qd.data);this.m5j()},null,void 0,void 0,void 0,void 0,"5");this.eqb=!1}return this.s0a}n5j($b){t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.s0a=this.hSh($b):this.s0a=$b;this.eqb=!1;this.JNb();if(this.TZb){if(!this.Eo)return;if(this.Eo&&!this.Ayd()){l.ULS.sendTraceTag(508867410,
202,10,"GetMoreInfo Received but info is missing");this.Rdd();return}}this.jUe()}jUe(){if(t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.X0&&z.c()){const $b=t.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),tc=t.AFrameworkApplication.eea;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.s0a,!0,$b&&tc));3===this.xC.NS&&l.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}m5j(){this.Q1b=this.eqb=!0;this.JNb();this.Rdd();
A.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Rdd(){t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.X0&&z.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.xC.NS&&l.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}hSh($b){$b=JSON.parse($b);const tc=new n.a;tc.add("TM00002102");tc.add("TM00002101");tc.add("TM16392939");const Xc=M.a.i9d($b,qd=>tc.contains(qd.AssetId));
$b=$b.slice(0,9);$b.splice.apply($b,[2,0].concat(Xc));return JSON.stringify($b)}kgi($b){var tc=0;for(var Xc=0;Xc<$b.length;Xc++)if("ST"===$b[Xc].ImageType){tc=Xc;break}const qd=$b.length?$b[tc]:null;$b=qd?qd.Url||"":"";var Cd;let Xd=Xc=tc=!1;if(qd&&(Cd=qd.AspectRatio))Cd=parseFloat(Cd),1>Cd?tc=!0:1.5<Cd?Xc=!0:1===Cd&&(Xd=!0);else switch(l.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:$b}),this.xC.NS){case 3:tc=!0;break;case 2:Xc=!0;break;case 5:Xd=!0}return{returnValue:$b,
Rqi:tc?"95by123":Xc?"123by69":Xd?"100by100":"123by95"}}oZh($b){$b=({pEc:tc}=this.Z7g($b,this.jtc,this.jtc.$Ja||"1056925771")).returnValue;if(tc){this.WWb=$b;var tc=(new Date).getTime()-this.yle;l.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:tc})}return $b}oBb($b,tc){l.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Eo||3!==$b.state?2===$b.state&&(l.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),
this.hZc=!0,this.JNb()):(this.Eo=$b,tc||this.JNb(),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.X0&&z.c()&&z.d("setFileMenuHostInformation")&&($b=Object.assign(new E,{hostUrl:this.Eo.ZS,hostName:this.Eo.Rqa,folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,folderName:t.AFrameworkApplication.breadcrumbFolderName}),l.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation($b)),this.TZb&&this.s0a&&this.s0a.length&&
(this.Ayd()?this.jUe():this.Rdd(),l.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}Z7g($b,tc,Xc){let qd;qd=!1;const Cd=this.ytf();let Xd="";this.xC.supportsGetMoreInfoForPersonalStorage&&(this.hZc?(Xd=r.xFe(tc),this.hZc=!1,l.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Eo?Cd?Xd=r.b8g(tc,this.Eo):this.Eo.lwi?(qd=!0,this.eqb=!1,Xd=r.$7g(tc,this.Eo),l.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(qd=!0,Xd=r.xFe(tc),l.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Eo.ZS,["StorageServiceDisplayNameIsSet"]:!!this.Eo.Rqa})):(Xd=r.a8g(tc.Fi),l.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Cd&&(Xd+=r.Y7g(tc,Xc,!Xd)+({pEc:qd}=this.X8g($b,Xc)).returnValue);return{returnValue:r.RCh(Xd),pEc:qd}}X8g($b,tc){let Xc;Xc=!1;if(!this.NEc)return Xc=!0,l.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",pEc:Xc};let qd="",Cd="",Xd="MenuTemplate";if(this.Q1b)qd=r.JFe(),this.Q1b=!1,l.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if($b){try{const ge=Sys.Serialization.JavaScriptSerializer.deserialize($b,!0);qd=this.W8g(ge,tc);l.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.SFf&&"OneDrive"===this.toa&&(Cd=r.W7g(this.pYi,t.AFrameworkApplication.SFf))}catch(ge){l.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:$b}),qd=r.JFe()}Xc=!0}else Xd="MenuLoading",qd=r.Y8g(),l.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:r.Z8g(Xd,qd)+Cd,pEc:Xc}}W8g($b,tc){let Xc="";const qd=[];for(let Xd=0;Xd<$b.length;Xd++){var Cd=$b[Xd];let ge="";if(Cd){const ve=Cd.Title,Ie=Cd.AssetId;Cd=Cd.Thumbnails;Ie&&ve&&Cd&&({Rqi:Cd,returnValue:ge}=this.kgi(Cd),Xc+=r.Xtb("jbtnNewTemplate"+Xd,ve,null,
Cd,null,ge,tc,Ie))}qd[Xd]=ge}$b=new G.a(4,1,5E3,()=>{this.ORi(qd)},106);this.xC.htc.jg($b);return Xc}JNb(){this.qTc=!0;this.xC.KFf.uy(this.jtc.Czb);this.qTc=!1}get xC(){return this.Y3.value}get jtc(){return this.Qmb.value}get oYi(){return this.KGa.value}get pYi(){return this.IKg.value}get toa(){return this.zta.value}get NEc(){return this.UNg.value}}Object(d.a)(R,"CreateNewActor",null,[]);var Y=a(1381);class Q extends Y.a{constructor(){super()}Xwe(){this.VU(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);
this.VU(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.VU(2,CommonUIStrings.l_Open);this.VU(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.VU(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.VU(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Q.Oa||(Q.Oa=new Q)}static Qej($b){return Q.instance.ha($b)}}Q.Oa=null;Object(d.a)(Q,"MruActorIntlHelper",Y.a,[]);var W;(function($b){$b[$b.success=0]="success";$b[$b.failure=1]="failure";$b[$b.spinner=2]="spinner";$b[$b.none=3]="none"})(W||
(W={}));Object(d.b)("DisplayState",W);var Ga=a(43);class pa{constructor($b,tc,Xc,qd,Cd,Xd,ge,ve){this.INc=null;this.Y_c=!0;this.VWb="";this.GPg=0;this.b_a=null;this.eUc=3;this.Ta=ve;this.Y3=$b;this.Wj=tc;this.HGg=Xc;this.LDg=qd;this.KDg=Cd;this.KGa=new h.a(()=>new v.a(Xd.value,null));this.qHg=new h.a(()=>new v.a(ge.value,Object(k.a)(this,this.ZWi,"mruEventResultReceived")));this.Ta.ra("WacInTabOpenMRUIsEnabledForUiHost");this.Ta.ra("UiHostSupportsDocRebootFeatures")}ZWi($b,tc){this.b_a=$b;tc||this.J1f()}Buj(){this.QE.jcb.ef(J.a.qxc,
S.a.frame,Object(k.a)(this,this.qxc,"populateMruMenu"),96)}qxc($b,tc,Xc,qd,Cd){return 1!==Xc&&Cd?this.tjj(Cd):32}tjj($b){this.xDh();this.wDh();$b.PopulationXML=r.SCh(this.VWb+this.INc);return 32}xDh(){var $b=3;let tc=!1;if(this.VWb&&this.GPg===this.b_a.a7j)l.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),$b=this.eUc;else{l.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});
var Xc=this.QE.Jx();this.b_a=this.YWi.v0("File Open opened",!0);this.VWb&&2!==this.eUc&&3!==this.b_a.state?tc=!0:($b=this.Xdi(this.b_a),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.X0&&z.c()&&$b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson($b,!0)),this.VWb=({gYi:$b}=this.pZh(this.b_a)).returnValue);Xc=this.QE.Jx()-Xc;l.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Xc})}2!==$b&&(Xc={["DisplayState"]:W[$b]},
1!==$b&&(Xc.IsStale=tc),l.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Xc));this.eUc=$b}Xdi($b){let tc;try{tc=Ga.c($b.hGd)}catch(Xc){tc=null,l.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Xc)}return tc}wDh(){this.Y_c?(l.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.INc=({Kkk:this.Y_c}=this.gTi()).returnValue):l.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
l.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Y_c,["NotDisplayingLink"]:!this.INc})}pZh($b){let tc;1===$b.state||0===$b.state?(l.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),$b=2,tc=r.vFe(this.uma(2),this.uma(5))):3===$b.state&&$b.hGd?(tc=this.X7g($b.hGd),$b=0):(l.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),tc=r.dub(this.uma(1),this.uma(2)),$b=1);return{returnValue:tc,
gYi:$b}}X7g($b){let tc;const Xc=this.SIb.$Ja||"2155708348";if($b.length){tc=r.cub("lblRecentDocuments",this.uma(3));let qd=0;for(let Cd=0;Cd<$b.length;Cd++){const Xd=$b[Cd];"FileName"in Xd&&"DocumentUrl"in Xd&&"Path"in Xd&&(tc+=r.Xtb("MruButton"+Cd,Xd.FileName.toString(),Xd.Path.toString(),null,this.SIb.E0,this.SIb.oDb,Xc,Xd.DocumentUrl.toString()),Xd.IsPinned&&qd++)}tc=r.Ija("RecentDocumentsMenuSection",r.VEf,this.uma(2),tc);l.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",
["TotalDocuments"]:$b.length,["NumPinnedDocuments"]:qd})}else tc=r.dub(this.uma(0),this.uma(2)),l.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return tc}gTi(){let $b;$b=!0;let tc=this.s6g;var Xc=this.r6g;if(tc&&Xc||!this.QE.supportsGetMoreInfoForPersonalStorage)$b=!1;else{const qd=this.aic.v0("File Open",!1);3===qd.state&&(tc=qd.ZS,Xc=qd.Rqa,$b=!1)}Xc=Xc?String.format(this.uma(4),Xc):null;return{returnValue:r.Z6g(this.SIb.$Ja,Xc,tc),Kkk:$b}}J1f(){this.QE.KFf.uy(this.SIb.Czb)}get QE(){return this.Y3.value}get uma(){return this.Wj.value}get SIb(){return this.HGg.value}get s6g(){return this.LDg.value}get r6g(){return this.KDg.value}get aic(){return this.KGa.value}get YWi(){return this.qHg.value}}
Object(d.a)(pa,"MruRenderer",null,[]);var aa=a(249),Z=a(798);class fa{constructor($b,tc,Xc,qd,Cd,Xd,ge){this.Eo=null;this.qqe=!1;this.Tsa=this.Ibe=0;this.PKg=$b;this.q_a=tc;this.J_b=Xc;this.Qmb=qd;this.zta=Cd;this.Y3=Xd;this.KGa=new h.a(()=>new v.a(ge.value,Object(k.a)(this,this.oBb,"getMoreInfoEventReceived")))}v4a(){!this.Eo&&this.OGd.supportsGetMoreInfoForPersonalStorage?this.aic.v0("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}oBb($b){if(!this.Eo&&3===$b.state)this.Eo=$b;else if(2===
$b.state){this.qqe?l.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.aic.v0("NewDocumentFromStream",!0),this.qqe=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.Ibe=(new Date).getTime();var $b=this.yRh.hbd;if(null===$b)this.q_a(null);else{var tc=this.J_b.menuItemId,Xc=this.J_b.cF,qd=this.J_b.R2j,Cd=this.J_b.DRh;this.Tsa="streamBase64"===qd?Cd.length/1024:0;l.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.WQ,
this.Tsa);var Xd=(new Date).getTime();$b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",$b,x.a.Rf(this.toa),x.a.Rf(tc),x.a.Rf(this.WQ),x.a.Rf(t.AFrameworkApplication.lcid.toString()),x.a.Rf(Xd.toString()),x.a.Rf(Xc),x.a.Rf(t.AFrameworkApplication.canary),t.AFrameworkApplication.ej,x.a.Rf(qd));$b+="&"+t.AFrameworkApplication.zic();t.AFrameworkApplication.Eza&&($b+="&"+t.AFrameworkApplication.Uhc());(tc=this.Eo?this.Eo.ZS:null)&&
($b+="&DestinationUrl="+x.a.Rf(tc));this.OGd.AJb.Fn($b,2,Cd,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(k.a)(this,this.jYi,"newDocumentFromStreamSuccessHandler"),Object(k.a)(this,this.iYi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}jYi($b){if($b&&$b.data&&$b.data.Fe)if(({qt:tc}=Ga.d($b.data.Fe)).returnValue)if($b=tc,$b.StatusCode!==aa.a.hK&&$b.StatusCode!==aa.a.Iwb)l.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.WQ,this.Tsa,$b.StatusCode),this.q_a(null);else if($b.NewDocumentUrl&&""!==$b.NewDocumentUrl){var tc=(new Date).getTime()-this.Ibe;l.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.WQ,this.Tsa,tc);this.PKg($b.NewDocumentUrl)}else l.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.WQ,this.Tsa),this.q_a(null);else l.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.WQ,this.Tsa,{["ResponseData"]:Z.a.wjb($b.data.Fe)}),this.q_a(null);else l.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.WQ,this.Tsa),this.q_a(null)}iYi($b){$b&&$b.data&&l.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.WQ,this.Tsa,$b.data.status);this.q_a(null)}get WQ(){switch(this.OGd.NS){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get yRh(){return this.Qmb.value}get toa(){return this.zta.value}get OGd(){return this.Y3.value}get aic(){return this.KGa.value}}Object(d.a)(fa,"NewDocumentFromStreamOperation",null,[]);class ya{constructor($b,tc,Xc,qd){this.Qmb=$b;this.zta=tc;this.Y3=Xc;this.pHg=qd}create($b,tc,Xc){return new fa($b,tc,Xc,this.Qmb,this.zta,this.Y3,this.pHg)}}Object(d.a)(ya,"NewDocumentFromStreamOperationFactory",null,[872]);var Aa=a(84),ja=a(528),za=
a(62);class ra{get name(){return"Common.App.NewAndOpen.UX"}Di($b){$b.register(ya,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Uc().dd(()=>new ya(new h.a(()=>t.AFrameworkApplication.sa.Qa.Hmd()),new h.a(()=>t.AFrameworkApplication.toa),new h.a(()=>$b.ah("Common.INewAndOpenCommonHelpers")),new h.a(()=>$b.ah("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){t.AFrameworkApplication.fa.Hv(()=>{this.HDb()})}HDb(){const $b=
ja.a.dr(Aa.a.instance.qc("Common.INewAndOpenCommonHelpers")),tc=ja.a.dr(Aa.a.instance.qc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));t.AFrameworkApplication.toa&&za.Task.WAA.call(null,$b,tc).continueWith(()=>{const Xc=new R(new h.a(()=>$b.result),new h.a(()=>t.AFrameworkApplication.sa.Qa.Hmd()),new h.a(()=>tc.result),new h.a(()=>t.AFrameworkApplication.sa.Qa.Imd().$Ja||"1959943459"),new h.a(()=>t.AFrameworkApplication.toa),new h.a(()=>t.AFrameworkApplication.AEi));Xc.vh();Xc.JNb()});if(t.AFrameworkApplication.i0f){const Xc=
ja.a.dr(Aa.a.instance.qc("Common.IEventEmitter<Common.IMruResult>"));za.Task.WAA.call(null,$b,tc,Xc).continueWith(()=>{const qd=new pa(new h.a(()=>$b.result),new h.a(()=>Q.Qej),new h.a(()=>t.AFrameworkApplication.sa.Qa.Imd()),new h.a(()=>t.AFrameworkApplication.Pej),new h.a(()=>t.AFrameworkApplication.Oej),new h.a(()=>tc.result),new h.a(()=>Xc.result),t.AFrameworkApplication.fa);qd.Buj();qd.J1f()})}}dispose(){}}Object(d.a)(ra,"UXPackageManager",null,[4,5,2]);var fb=a(260),Ua=a(10),Ca=a(722),Ia=a(52),
oa=a(40),Da=a(198),bb=a(1);class Za{constructor($b){this.Ci=$b}hd(){return!1}executeCommand($b,tc,Xc){return 2!==this.Ci.Be(J.a.newDocument,2,Xc)?za.Task.Ua(!0):Da.a(tc.command)}Tc($b,tc){return 1056925771===tc.command}ld($b,tc,Xc){$b=!0;switch(tc){case "PopulateNewMenu":this.Ci&&(bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&t.AFrameworkApplication.AO("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",
!1)&&(t.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",t.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Ci.Be(J.a.rxc,2,Xc));break;default:$b=!1}return $b}}Object(d.a)(Za,"CreateNewCommandHandler",null,[200]);var Xa=a(100),Ba=a(149),Wa=a(36);class Na extends Ca.a{constructor($b){super($b)}he(){const $b=bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Xa.d)(Ba.a.resolve(Wa.p,{Wa:this.La})):Ia.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.La),tc=Ia.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.La);oa.TaskExtensions.za(oa.TaskExtensions.ke([$b,tc],this.ka),()=>{this.Pd([new Za(t.AFrameworkApplication.Qb)])},this.ka,3)}static la($b){Ca.a.ye(87,new Na($b))}}Object(d.a)(Na,"CreateNewCommandHandlerFactory",Ca.a,[]);var ta=a(521),V=a(94),ia=a(200),X=a(12),la=a(23),sa=a(246),Va=a(465);class nb{}nb.create="Create";nb.activate="Activate";nb.close="Close";nb.remove="Delete";nb.duplicate="Duplicate";Object(d.a)(nb,
"Actions",null,[]);var ha=a(33),jb=a(49);class Fb extends za.Task{constructor($b){super();this.J9d=null;this.L9d=0;this.KWb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.r_a=this.r_a()}catch(tc){this.dispose(),this.ADa(tc),this._state=3}};this.dv=$b;this.r_a=this.tLc;this.moveNext()}tLc(){this.J9d=ha.a.Od(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.KWb=jb.a(this.dv.$).lk(this.J9d).G();this.KWb.isCompleted||(this._state=2,this.KWb.Kcb(this.moveNext));
return this.byg}byg(){this.L9d=this.KWb.v0();0===this.L9d&&(this.dv.$.workbookContext.Options=X.HelperMethods.KP(!1,this.dv.$.workbookContext.Options,2048),this.dv.deleteMsFormMetaDataSheet());this._state=3;this.ZUa(!0)}dispose(){}}Object(d.a)(Fb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",za.Task,[2]);class Rb{}Rb.action="Action";Rb.aUh="FlexPane";Rb.Qfc="formId";Rb.id="id";Rb.title="Title";Rb.WVb="XlWorkbookId";Rb.ZVh="Fragment";Rb.host="Host";Rb.j8j="TopView";
Rb.accountType="auth_pvr";Object(d.a)(Rb,"Parameters",null,[]);var mb=a(58);const sb=($b,tc,Xc,qd,Cd,Xd,ge=null)=>{ge=$b.Pa(9,ge);ge.sheetName=tc;ge.confirmationChoice=!0;return mb.g($b,"DeleteSheet",ge,Xc,qd,Cd,Xd,0)};class Ya{constructor($b){this.Jo="Excel";this.$=$b;this.kW=Va.a.current}get hasMsForm(){return V.c(this.$.tf)}get Usc(){return this.$.workbookContext.MsFormId}get TVb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return la.a.contains(this.$.gA.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}hd($b,tc){switch(tc){case -105284469:return!V.k(this.$.tf)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand($b,tc){$b=oa.TaskExtensions.zk();tc=tc.command;switch(tc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:$b=this.deleteMsForm();break;default:$b=Da.a(tc)}return $b}Tc($b,
tc){if(!this.$.ea.oh.get(61))return!1;$b=!1;switch(tc.command){case -105284469:$b=V.k(this.$.tf)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:$b=this.hasMsForm}return $b}ld(){return!1}insertMsForm(){const $b=x.a.Jq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),tc={},Xc={};tc[Rb.action]=nb.create;tc[Rb.accountType]=this.accountType;Xc[Rb.action]=nb.create;Xc[Rb.WVb]=encodeURIComponent(this.TVb);Xc[Rb.host]=this.Jo;Xc[Rb.title]=encodeURIComponent($b);
this.IIb(tc,Xc);this.$.workbookContext.Options=X.HelperMethods.KP(!1,this.$.workbookContext.Options,2048)}editMsForm(){const $b={},tc={};$b[Rb.accountType]=this.accountType;tc[Rb.Qfc]=this.Usc;tc[Rb.WVb]=encodeURIComponent(this.TVb);tc[Rb.host]=this.Jo;this.IIb($b,tc)}previewMsForm(){const $b={},tc={};$b[Rb.accountType]=this.accountType;tc[Rb.Qfc]=this.Usc;tc[Rb.WVb]=encodeURIComponent(this.TVb);tc[Rb.host]=this.Jo;tc[Rb.j8j]="Preview";this.IIb($b,tc)}sendMsForm(){const $b={},tc={};$b[Rb.accountType]=
this.accountType;tc[Rb.Qfc]=this.Usc;tc[Rb.aUh]="SendForm";tc[Rb.WVb]=encodeURIComponent(this.TVb);tc[Rb.host]=this.Jo;this.IIb($b,tc)}deleteMsForm(){return new Fb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.lG(new ia.a(158,0,($b,tc,Xc)=>sb(this.$.qa.Yx,this.kW.Kzb,sa.b($b,()=>{this.Kvh()}),tc,Xc,null)))}Kvh(){const $b={},tc={};$b[Rb.action]=nb.remove;$b[Rb.accountType]=this.accountType;tc[Rb.action]=nb.remove;tc[Rb.host]=this.Jo;tc[Rb.Qfc]=encodeURIComponent(this.Usc);tc[Rb.WVb]=
encodeURIComponent(this.TVb);this.IIb($b,tc)}IIb($b,tc){const Xc=this.$.xa.MsFormBaseUrl+"/Pages/DesignPage.aspx";let qd="";var Cd="";if(tc){for(let ve in tc){var Xd=ve,ge=tc[ve];Cd+=Cd.length?"&":"";Cd+=Xd+"="+ge}$b||($b={});$b[Rb.ZVh]=encodeURIComponent(Cd)}if($b)for(let ve in $b)tc=ve,Cd=$b[ve],qd+=qd.length?"&":"?",qd+=tc+"="+Cd;window.open(Xc+qd,"_blank")}}Object(d.a)(Ya,"MsFormCommandHandler",null,[200]);class Ma extends Ca.a{constructor($b){super($b)}he(){const $b=Ia.GetServiceTaskFactory.create(this.$.da,
203,this.ka,this.La);oa.TaskExtensions.za(oa.TaskExtensions.ke([$b],this.ka),()=>{this.Pd([new Ya(this.$)])},this.ka,3)}static la($b){$b.ea.oh.get(61)&&Ca.a.ye(215,new Ma($b))}}Object(d.a)(Ma,"MsFormCommandHandlerFactory",Ca.a,[]);var xb=a(229),qb=a(71);class Ra extends xb.a{constructor($b){super();this.$=$b;this.kc()}create(){oa.TaskExtensions.za(Object(qb.b)("OfficeVSO:7624895_MigrateNewAndOpenCoreManagerToNewServiceInfra")?Object(Xa.d)(Ba.a.resolve(Wa.ab,{Wa:this.La})):Ia.GetServiceTaskFactory.create(this.$.da,
164,this.ka,this.La),()=>{this.Pb(new ra)},this.ka,3)}}Object(d.a)(Ra,"NewAndOpenUXFactory",xb.a,[]);class Jb{constructor($b,tc){this.Ci=tc;this.$=$b}executeCommand($b,tc,Xc){$b=2;switch(tc.command){case J.a.openUrlInNewTab:$b=this.Ci.Be(J.a.openUrlInNewTab,2,Xc);break;case J.a.zSa:$b=this.Ci.Be(J.a.zSa,2,Xc)}return 2!==$b?za.Task.Ua(!0):Da.a(tc.command)}Tc($b,tc){return tc.command===J.a.openUrlInNewTab||tc.command===J.a.zSa}ld($b,tc,Xc){return"PopulateMruMenu"===tc?(this.Ci.Be(J.a.qxc,2,Xc),!0):
!1}hd(){return!1}}Object(d.a)(Jb,"OpenFromMruCommandHandler",null,[200]);class yb extends Ca.a{constructor($b){super($b)}he(){const $b=bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Xa.d)(Ba.a.resolve(Wa.p,{Wa:this.La})):Ia.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La),tc=Ia.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.La);oa.TaskExtensions.za(oa.TaskExtensions.ke([$b,tc],this.ka),()=>{this.Pd([new Jb(this.$,t.AFrameworkApplication.Qb)])},
this.ka,3)}static la($b){Ca.a.ye(88,new yb($b))}}Object(d.a)(yb,"OpenFromMruCommandHandlerFactory",Ca.a,[]);var Gb=a(185),ub=a(31),Ja=a(192),zb=a(161),na=a(73),Ea=a(63),ma=a(215),Ka=a(603),cb=a(91),Fa=a(20),wa=a(262),ka=a(219),Oa=a(13);class hb extends ka.a{constructor($b,tc,Xc,qd=null){super($b,Xc,2,qd);this.LRc=null;this.onResize=()=>{const Cd=this.D7h();this.QOa.setAttribute("width",Cd.x.toString());this.QOa.setAttribute("height",Cd.y.toString());this.Odk(Cd);this.EJd()};this.nSe=tc;this.$.dA(this.onResize);
this.rkc()}get QOa(){return this.LRc}initialize(){const $b=this.$.fc+"iframeDialog_frame",tc=this.$.fc+"iframeDialog";this.zc.style.margin=X.HelperMethods.Yc(0);this.zc.style.marginBottom=X.HelperMethods.Yc(-2);const Xc=document.createElement("iframe");Xc.id=$b;Xc.frameBorder="0";Xc.scrolling="auto";Xc.src=this.S$e(tc);this.zc.appendChild(Xc);this.LRc=document.getElementById($b);this.domElement.id=tc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.UC(this.onResize);
super.dispose()}setFocus(){Oa.DOMElementExtensions.setFocus(this.QOa)}onHide(){this.QOa.contentWindow.close();Oa.DOMElementExtensions.gg(this.QOa);this.LRc=null;super.onHide()}Odk($b){const tc=this.domElement.style;tc.width=X.HelperMethods.Yc($b.x);tc.marginLeft=X.HelperMethods.Yc(-$b.x/2)}D7h(){const $b=Oa.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*$b.width),this.nSe.x),Math.min(Math.floor(.9*$b.height),this.nSe.y))}}Object(d.a)(hb,"IFrameDialog",
ka.a,[]);var Pa=a(7),ca=a(83),ba=a(16);class ib extends hb{constructor($b){super($b,new Sys.UI.Point(960,680),ba.a.instance.ha(1264));this.name=Pa.a.HWe}get Qc(){return"EmbeddingDialog"}S$e($b){const tc=new Sys.StringBuilder(this.$.xa.EmbedConfiguratorUrl);ma.a.Bl(tc,Pa.a.SFh,$b);ca.a(this.$.xa,32)&&ma.a.Bl(tc,Pa.a.KYe,"1");ca.a(this.$.xa,33)&&ma.a.Bl(tc,Pa.a.LYe,"1");ca.a(this.$.xa,34)&&ma.a.Bl(tc,Pa.a.JYe,"1");return tc.toString()}onShow(){l.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");
super.onShow()}}Object(d.a)(ib,"EmbeddingDialog",hb,[]);var Lb=a(890),gc=a(92),Gc=a(82),Kb=a(769);class pb{}pb.Jfg="FrameDialog_ShareFromEdit";pb.view="FrameDialog_View";pb.vKe="FrameDialog_CloseAndRefresh";pb.oSj="FrameDialog_ShareFromView";pb.edit="FrameDialog_Edit";pb.Lsj="FrameDialog_RefreshGrid";pb.xfh="FrameDialog_CloseMe";pb.FKe="FrameDialog_CloseMeError";pb.ready="FrameDialog_Ready";pb.Iij="FrameDialog_PleaseClose";pb.AL="GotoRange";Object(d.a)(pb,"PostMessageConstants",null,[]);var nc=a(323),
Wb=a(120),Ha=a(230);class $a{constructor(){this.AL=null;this.jNd=1461300262}}Object(d.a)($a,"SessionUpdateContext",null,[]);class Nb extends hb{constructor($b,tc,Xc){super($b,new Sys.UI.Point(Nb.hvh,Nb.Fuh),ba.a.instance.ha(tc?1269:1268));this.C4a=null;this.dTc=!1;this.Yvc=qd=>{const Cd=this.$,Xd=new $a;Xd.AL=qd.Values[pb.AL];let ge=!1;switch(qd.MessageId){case pb.Jfg:this.vw();ge=!0;Xd.jNd=1334518759;break;case pb.view:this.gra=ba.a.instance.ha(1269);this.qug(!0);break;case pb.vKe:this.vw(),ge=!0}qd=
new ia.a(140,0,(ve,Ie,Ee)=>nc.n(Cd.qa.va,sa.b(ve,this.rbj),Ie,Ee,Xd));qd.flags=ge?16:80;Cd.userOperationManager.kd(qd,this.Wd)};this.a4i=()=>{const qd=this.$;qd.xa.SurveyRedirectUrl?(this.vw(),qd.xd(1305810481,0,8,null)):(this.gra=ba.a.instance.ha(1268),this.qug(!1))};this.Gbj=()=>{const qd=this.$;this.vw();qd.xd(1334518759,0,8,null)};this.wKb=qd=>{const Cd=this.$;this.vw();qd.MessageId===pb.FKe&&Cd.ea.Tjd()};this.R$i=()=>{this.dTc=!0;this.raiseEvent(Nb.eCd)};this.rbj=(qd,Cd)=>{if(!Ha.a(qd)){qd=this.$;
if(Cd.AL){const Xd=qd.ea.ua;if(Xd.contains(Cd.AL.SheetName))this.Ruc(Cd);else{let ge=null;ge=()=>{Xd.Epa(ge);this.Ruc(Cd)};Xd.eja(ge)}}1461300262!==Cd.jNd&&qd.xd(Cd.jNd,0,8,null)}};this.MZa=tc;this.Wd=Xc}zXg($b){this.addHandler(Nb.eCd,$b)}zyj($b){this.removeHandler(Nb.eCd,$b)}get Qc(){return"FormDialog"}get Xrf(){return this.dTc}get L$a(){return this.MZa}dispose(){gc.a.Ka(this.C4a);this.C4a=null;super.dispose()}initialize(){super.initialize();const $b=Gc.a.wL(this.$.xa.FormLightBoxUrl),tc=this.C4a=
new Lb.a(this.QOa.contentWindow,$b);tc.isEnabled()&&tc.QQ($b)&&(this.xpa(pb.Jfg,this.Yvc),this.xpa(pb.view,this.Yvc),this.xpa(pb.vKe,this.Yvc),this.xpa(pb.oSj,this.Gbj),this.xpa(pb.edit,this.a4i),this.xpa(pb.Lsj,this.Yvc),this.xpa(pb.ready,this.R$i),this.xpa(pb.xfh,this.wKb),this.xpa(pb.FKe,this.wKb))}close($b){$b===this.AN&&this.Xrf&&this.C4a.send(new Kb.a(pb.Iij))||super.close($b)}S$e(){return this.$Oe(this.L$a)}$Oe($b){const tc=this.$.xa,Xc=new Sys.StringBuilder(tc.FormLightBoxUrl);ma.a.Bl(Xc,
Pa.a.HVh,this.$.ea.sessionId);ma.a.Bl(Xc,Pa.a.FVh,$b?Pa.a.GVh:Pa.a.EVh);Wb.a.Nsb(Xc,tc);return Xc.toString()}qug($b){this.dTc=!1;this.QOa.src=this.$Oe($b);this.MZa=$b}xpa($b,tc){this.C4a.fn($b);this.C4a.hl($b,tc)}Ruc($b){const tc=this.$.ea.ua.getItemByName($b.AL.SheetName);tc&&0===tc.ZC&&Fa.h(this.$).qh($b.AL,null,null,null,20,"FormDialog.OnItemInserted")}}Nb.hvh=900;Nb.Fuh=1200;Nb.eCd="lightBoxReady";Object(d.a)(Nb,"FormDialog",hb,[220]);var rb;(function($b){$b[$b.comment=10]="comment";$b[$b.range=
12]="range";$b[$b.table=13]="table";$b[$b.chart=14]="chart";$b[$b.sheet=15]="sheet"})(rb||(rb={}));Object(d.b)("NavigationType",rb);var ec=a(1019),pc=a(132),vb=a(19),ob=a(571),Tb=a(990),Rd=a(295),Jd=a(783),ld=a(54);class Yd extends Jd.a{constructor($b,tc,Xc,qd,Cd,Xd=0,ge){super($b,ba.a.instance.ha(tc),!1);this.oc=null;this.message=Xc;this.R_i=qd;this.Z8d=Cd;this.operationFlags=Xd;this.oc=ge}get Qc(){return"WebMethodConfirmationDialog"}get hD(){return 1005}get KKa(){return this.operationFlags}initialize(){let $b=
"<div class='"+pc.a.Cs+"'>\r\n\t<div class='"+pc.a.$Ye+"'>\r\n\t\t<div class='"+vb.a.nKe+"'>\r\n\t\t\t<img src='{0}' class='"+vb.a.M0e+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+pc.a.bZe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";$b=String.format($b,ld.a.dg(13),ba.a.instance.ha(25),ba.a.instance.ha(this.message));this.oc.Oh(this.zc,$b);this.addButton(0,this.R_i);this.addButton(1);super.initialize()}nI(){return this.Z8d}}Object(d.a)(Yd,"WebMethodConfirmationDialog",Jd.a,[]);class Ke extends ec.a{constructor($b,
tc){super($b,ba.a.instance.ha(1271));this.oc=this.gXa=this.MUa=this.textBox=null;this.FSf=()=>{const Xc=this.$;this.vw();const qd=new Yd(Xc,1274,1275,1276,(Cd,Xd,ge)=>{var ve=Xc.qa.va.Bc(),Ie=Xc.qa.va;ve=Ie.Pa(1,ve);return mb.g(Ie,"UnshareForm",ve,Cd,Xd,ge,null,0)},16,this.oc);qd.initialize();qd.Rg()};this.oc=tc}get Qc(){return"ShareFormDialog"}dispose(){this.gXa&&this.gXa.s9(this.FSf);gc.a.Rc([this.textBox,this.MUa,this.gXa]);this.gXa=this.MUa=this.textBox=null;super.dispose()}initialize(){let $b=
"<div class='"+pc.a.Cs+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+pc.a.Kdc+"'>\r\n\t<input type='text' id='{1}' class='"+pc.a.iL+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";$b=String.format($b,ba.a.instance.ha(1272),"sfd_input","sfd_unshare",vb.a.np,ba.a.instance.ha(1273));this.oc.Oh(this.zc,$b);this.textBox=new Rd.a(this.getElementById("sfd_input"));this.MUa=new Tb.a(this.textBox.domElement);this.gXa=ob.a.create(this.getElementById("sfd_unshare"));
this.gXa.TZ(this.FSf);this.textBox.text=ba.a.instance.ha(736);this.textBox.enabled=!1;this.textBox.readOnly=!ub.a.rh;this.addButton(1,10);super.initialize()}Q2a(){return($b,tc,Xc)=>{var qd=this.$.qa.va.Bc(),Cd=this.$.qa.va;$b=this.p7a($b);tc=this.tNa(tc);qd=Cd.Pa(1,qd);return mb.g(Cd,"ShareForm",qd,$b,tc,Xc,null,0)}}x1($b,tc,Xc){this.textBox.text=$b.Result;this.textBox.enabled=!0;Oa.DOMElementExtensions.setVisible(this.gXa.domElement,!0);super.x1($b,tc,Xc)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch($b){}super.setFocus()}}Object(d.a)(Ke,"ShareFormDialog",ec.a,[]);var Bb=a(258),Ob=a(8),ed=a(87),Sd=a(265),Pd=a(74),ic=a(641),Kc=a(154),dc=a(432),Hc=a(266),Uc=a(17),Fd=a(264),Td=a(30);class ad extends Ja.a{constructor($b,tc,Xc){super();this.XGe=this.YGe=!1;this.u6a=0;this.gla=!1;this.n1i=()=>{this.YGe=!0;this.Shg()};this.$=$b;this.Ya=tc;this.uL=Xc;Pd.a(this.$).MQd(new Kc.a(Ob.a.lsg,Ob.a.idle,ad.mch),new Bb.a(Ob.a.DKe,Ob.a.r1,null,Ob.a.mQ,Ob.a.idle))}get hLc(){return V.b(this.$.tf)}get CVd(){return this.$.isEditMode&&
(this.$.ea.cBh||this.$.mS)}hd($b,tc){switch(tc){case 353606613:case -1099009678:case 192430811:return!bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.sgg();case 783415632:return!bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.sgg();case 869186573:return this.tgg();case -1570751769:case 1986648902:return 131072!==(this.$.fW&131072);case 330035228:return!(this.O6a(!0)&&this.hLc);case -509039657:return!(this.O6a()&&this.hLc);
case 1334518759:return!(this.O6a()&&this.hLc&&this.lHe())}return!1}sgg(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.tgg()}tgg(){const $b=this.$.workbookContext.FullDocumentInfo,tc=Hc.a()&&this.$.ea.oh.get(5);return!$b.FileSharingUrl&&!tc}executeCommand($b,tc,Xc){$b=this.$.workbookContext.FullDocumentInfo;var qd=J.a.workflow,Cd=oa.TaskExtensions.zk();const Xd=tc.command;if(Xd===qd||-266099===Xd)return this.bni(tc,qd,$b);switch(Xd){case 1986648902:this.Zeg();break;case -1570751769:this.uki(tc);
break;case 869186573:tc=J.a.nSj;Cd=t.AFrameworkApplication.fa.ra("ShareMenuIsEnabled");qd=null;(bb.EwaSettings.ya(478)||Cd)&&Xc&&"CopyLink"===Xc.SourceControlId?(qd={},qd[P.a.uhb]="copy",tc=J.a.eZd):Cd&&Xc&&"ManageAccess"===Xc.SourceControlId?(qd={},qd[P.a.uhb]="manageAccess",tc=J.a.pSj):Xc&&"LinkToComment"===Xc.SourceControlId?(qd={},qd[P.a.uhb]="copy",qd[P.a.fZd]=Xc.navId,tc=J.a.eZd):Td.a.mtf()&&Xc&&"SaveAsCopyLink"===Xc.SourceControlId&&(qd={},qd[P.a.uhb]="copy",tc=J.a.eZd);Cd=this.ajg($b,qd);
y.c(tc);break;case -1099009678:Cd=this.$Dc(12,$b);break;case 192430811:Cd=this.$Dc(13,$b);break;case 353606613:Cd=this.$Dc(14,$b);break;case 783415632:Xc&&"LinkToThisSheet"===Xc.SourceControlId&&l.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");Cd=this.$Dc(15,$b);break;case -59906385:case 1197060601:this.gmi(tc,$b);break;case 1305810481:this.Dhf(!1,tc);break;case 330035228:this.Dhf(!0,tc);break;case -509039657:Xc=Object(Xa.d)(Ba.a.resolve(Wa.S,
{Wa:0}));oa.TaskExtensions.za(Xc,ge=>{this.deleteForm(ge.result)},this.$.ka,3);break;case 1334518759:tc.LEb=!0;Xc=Object(Xa.d)(Ba.a.resolve(Wa.S,{Wa:0}));oa.TaskExtensions.za(Xc,ge=>{this.shareForm(ge.result)},this.$.ka,3);break;case 710925581:Ea.a.eh.rEc("710925581")&&(Cd=oa.TaskExtensions.za(this.uL.value,ge=>{ge.result.sendMessage(B.a.conversation,{})},this.ka,3));break;case 327119921:this.eki();break;default:Cd=Da.a(Xd)}return Cd}Tc($b,tc){$b=!1;tc=tc.command;if(tc===J.a.workflow)return!0;switch(tc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:$b=
!0;break;case 353606613:case -1099009678:case 192430811:$b=bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:$b=bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return $b}ld($b,tc,Xc){if("PopulateFormMenu"===tc){tc=this.hLc?this.lHe()?ad.JPh:ad.KPh:ad.nYi;$b=this.Ya.jd();for(let qd=0;qd<tc.length;qd++)$b.buttons.push(this.Ya.Kb(tc[qd]));tc=this.Ya.ur("Forms.Flyout");
tc.Vc.push($b);Xc.MenuItems=tc.RF();return!0}return!1}bni($b,tc,Xc){return this.CVd&&$b.command===tc?(this.AVd($b,-266099),oa.TaskExtensions.rda()):oa.TaskExtensions.za(this.uL.value,qd=>{Ka.a(qd.result,B.a.workflow,null,Xc.WorkflowPostMessage)||X.HelperMethods.Jf(Xc.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ka,3)}lHe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.oh.get(26)}eki(){var $b=Gb.a.create().toString();l.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${$b}`);var tc=this.$.frame,Xc=tc.fcb,qd=this.$;const Cd=new Fd.QueryStringBuilder(t.AFrameworkApplication.fa.Va("TeamsMeetingShareEndpoint"));Cd.Kj("deeplinkId",$b);Cd.Kj("lm","deeplink");$b=Cd.Kj;var Xd={};const ge=new Fd.QueryStringBuilder(t.AFrameworkApplication.fa.Va("TeamsAppSharingUrl"));ge.Kj("auth","2");ge.Kj("flight","officeunihost");ge.Kj("source","TEAMS-ELECTRON.meetingStage.deeplink");var ve={};ve.fileType=x.a.A6(qd.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
ve.objectUrl=qd.workbookContext.FullDocumentInfo.WorkbookPath;ve.baseUrl=qd.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{qd=qd.workbookContext.WorkbookFileVersionId;let Ie=decodeURIComponent(qd);for(;qd!=Ie;)qd=Ie,Ie=decodeURIComponent(qd);0>qd.indexOf("{")||0>qd.indexOf("}")?(l.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${qd}`),qd=""):qd=qd.substring(qd.indexOf("{")+1,qd.indexOf("}")).toLowerCase()}ve.fileId=qd;ve=Ga.c(Ga.c(ve));ge.Kj("subEntityId",
ve.substring(1,ve.length-1));Xd.appSharingUrl=ge.toString();Xd.appId=t.AFrameworkApplication.fa.Va("TeamsAppId");Xd.useMeetNow=bb.EwaSettings.isChangeGateEnabled("OfficeVSO:7569119_MeetNowIsEnabled");Xd=JSON.stringify(Xd);$b.call(Cd,"appContext",Xd);Xc.call(tc,Cd.toString(),!0)}uki($b){this.CVd?this.AVd($b,1986648902):this.Zeg()}Dhf($b,tc){!$b&&this.$.xa.SurveyRedirectUrl?this.anj():($b=new Nb(this.$,$b,tc),$b.initialize(),$b.Rg())}gmi($b,tc){this.CVd&&1197060601===$b.command?this.AVd($b,-59906385):
oa.TaskExtensions.za(this.uL.value,Xc=>{Xc=Xc.result;Xc&&Ka.a(Xc,B.a.replyWithChanges,null,this.$.ea.oh.get(8))||(Xc=new Sys.StringBuilder(tc.ReplyWithChangesUrl),ma.a.Bl(Xc,dc.e,dc.d),zb.a.ntw(Xc.toString(),this.$))},this.ka,3)}AVd($b,tc){const Xc=Pd.a(this.$).Qd.activityState,qd=new cb.a(tc,$b.method,$b.mode,$b.yf,$b.tabName);jb.a(this.$).Ns(new wa.a(Ob.a.Hx,5,()=>{Xc[Sd.a.xq]=Ob.a.V9f;Xc[ic.a.Z0c]=qd;this.$.Kl.cA("SocialSharingSaveBeforeCommand");this.$.Kl.Gwe(qd.command)}))}Zeg(){const $b=this.$.xa.DocumentHostInfo;
$b.HostEmbeddedViewUrl||this.YGe?this.Shg():this.$.Ne.get(53)&&oa.TaskExtensions.za(this.uL.value,tc=>{this.uak(tc.result)||zb.a.ntw($b.FileEmbedCommandUrl,this.$)},this.ka,3)}uak($b){return $b.isEnabled()&&(this.XGe||(this.XGe=$b.hl(B.a.WGe,this.n1i)))?$b.sendMessage(B.a.mRh,null):!1}Shg(){if(ub.a.iq)zb.a.ntw(this.$.xa.EmbedConfiguratorUrl,this.$);else{const $b=new ib(this.$);$b.initialize();$b.Rg()}}deleteForm($b){const tc=this.$;$b=new Yd(tc,1277,1278,1270,(Xc,qd,Cd)=>{var Xd=tc.qa.va.Bc(),ge=
tc.qa.va;Xd=ge.Pa(9,Xd);Xd.surveyId=null;return mb.g(ge,"DeleteSurvey",Xd,Xc,qd,Cd,null,0)},0,$b);$b.initialize();$b.Rg()}shareForm($b){const tc=this.$.workbookContext.FullDocumentInfo;this.$.ea.oh.get(26)?($b=new Ke(this.$,$b),$b.initialize(),$b.Rg()):oa.TaskExtensions.za(this.uL.value,Xc=>{Ka.a(Xc.result,B.a.shareForm,{[P.a.W3j]:this.$.workbookContext.SurveyTitle},this.$.ea.oh.get(10))||zb.a.ntw(tc.ShareFormCommandUrl,this.$)},this.ka,3)}anj(){const $b=this.$;$b.xa.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]",
"gi"),"");const tc=new Sys.StringBuilder($b.xa.SurveyRedirectUrl);ma.a.Bl(tc,"startupDialog","FormEdit");const Xc=Pd.a(this.$),qd=Xc.Qd.activityState;qd[ed.a.t4]=tc.toString();qd[ed.a.iN]=ed.a.zGd;this.$.Kl.cA("SocialSharingEnvironmentChange");jb.a($b).Ns(new wa.a(Ob.a.Hx,5,()=>{const Cd=ha.a.Od(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");Xc.Qd.gs([Cd]);qd[Sd.a.xq]=Ob.a.lsg}))}O6a($b=!1){return(this.$.ea.isEditMode||$b)&&this.$.ea.oh.get(25)&&Hc.a()}pei($b){var tc=Fa.h(this.$).ga;let Xc=
!1;const qd=this.$.ua.na?na.d(this.$.ua.na):null;if(!qd)return l.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${rb[$b]}.`),null;var Cd=null;14===$b?Cd=this.Ndi(tc):12===$b?(Cd=tc.Dka,Cd=la.a.contains(Cd,"!",!0)?Cd.split("!")[1]:Cd,Fa.h(this.$).ga.pa.GL()&&(Xc=!0)):13===$b&&(tc=tc.pa.selectedRanges,tc[0]&&(tc=Fa.h(this.$).Mb.ph(tc[0])))&&(Cd=tc.Tj);if(!Cd&&15!==$b)return l.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${rb[$b]}`),
null;tc={};tc[P.a.uhb]="copy";tc[P.a.fZd]=this.W4h($b,Cd,qd);tc[P.a.qSj]="deepLinkShare";l.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${rb[$b]} and sectionNameOrId: ${Cd} and SheetId: ${qd} and isPartialTable: ${Xc}`);return tc}Ndi($b){if($b.Sa.qS&&($b=$b.Sa.Fc.floatingObject)&&0===$b.type){const tc=$b.id.split(".");if(1<tc.length)return tc[1];l.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${$b.id}`)}return null}W4h($b,
tc,Xc){let qd=$b+"_";qd=btoa(15===$b?qd+Xc:qd+(tc+"_"+Xc));qd=qd.replace(RegExp("\\+","g"),"-");qd=qd.replace(RegExp("\\/","g"),"_");return qd=qd.replace(RegExp("\\=+$","g"),"")}ajg($b,tc,Xc=!1){return oa.TaskExtensions.za(this.uL.value,qd=>{Ka.a(qd.result,B.a.sharing,tc,this.$.ea.oh.get(5))?(l.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${tc?tc[P.a.uhb]:""}`),Xc&&bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&bb.EwaSettings.isChangeGateEnabled("OfficeVSO:7750148_DeepLinkCreationSurveyFPS")&&!this.gla&&(this.u6a=window.setInterval(()=>{this.k9j()},6E4),this.gla=!0)):X.HelperMethods.Jf($b.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ka,3)}$Dc($b,tc){if(15===$b&&!bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==$b&&!bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;
const Xc=this.pei($b);if(Xc)return l.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Xc[P.a.fZd]}`),this.ajg(tc,Xc,!0);l.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${rb[$b]}`);return null}k9j(){this.gla&&window.clearInterval(this.u6a);bb.EwaSettings.isChangeGateEnabled("OfficeVSO:7750148_DeepLinkCreationSurveyFPS")&&(this.$.xd(638984051,0,0,null),l.ULS.sendTraceTag(512328542,
0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}ad.nYi=[103];ad.JPh=[107,104,105,106];ad.KPh=[104,105];ad.mch=[new Uc.a(Ob.a.DKe,554412057,0,0,1325),new Uc.a(Ob.a.idle,554412057,0,1)];Object(d.a)(ad,"SocialSharingCommandHandler",Ja.a,[200]);class Qd extends Ca.a{constructor($b){super($b)}he(){const $b=new h.a(()=>Ia.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.La));oa.TaskExtensions.za(Ia.GetServiceTaskFactory.create(this.$.da,102,this.ka,
this.La),tc=>{this.Pd([new ad(this.$,tc.result,$b)])},this.ka,3)}static la($b){Ca.a.ye(114,new Qd($b))}}Object(d.a)(Qd,"SocialSharingCommandHandlerFactory",Ca.a,[]);var Zb=a(119);let Wc=class{constructor($b){this.Ci=$b}executeCommand($b,tc,Xc){return 2!==this.Ci.Be(J.a.tryOfficeThroughTellMe,2,Xc)?za.Task.Ua(!0):Da.a(tc.command)}Tc($b,tc){return 215809929===tc.command}ld(){return!1}hd(){return!1}};Wc=Object(Zb.b)([Object(Ba.d)(Wa.wb),Object(Zb.c)(0,Object(Wa.a)())],Wc);Object(d.a)(Wc,"TryOfficeThroughTellMeCommandHandler",
null,[200]);class md extends Ca.a{constructor($b){super($b)}he(){this.Pd([new Wc(t.AFrameworkApplication.Qb)])}static la($b){Ca.a.ye(207,new md($b))}}Object(d.a)(md,"TryOfficeThroughTellMeCommandHandlerFactory",Ca.a,[]);var Nd=a(170),kd=a(275),yd=a(157),lc=a(189);class Lc{static sW(){return yd.a.$p(Lc.Sl,lc.a.Ha(444))}}Lc.Sl="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(d.a)(Lc,"NamedSheetViewTeachingDialogHtml",null,[]);var nd=a(79),Wd=a(167),$d=a(55);class se extends kd.a{constructor($b){super($b);this.stopwatch=this.Bu=null;this.yXi=tc=>{if(1===tc)this.$.Ia.$b(new cb.a(-2050946363,nd.a.Vb,2,8,null)).continueWith(Xc=>{this.Bu.setResult(!Wd.a(Xc)&&Xc.result)}),tc="Yes";else{const Xc=2===tc;this.Bu.setResult(Xc);tc=2===tc?"No":"Close";Xc&&this.Blj()}this.zQi(tc);this.hide()}}get Qc(){return"ShowNamedSheetViewTeachingDialog"}fh(){this.rc=4;this.stopwatch=this.$.nc.qd("UserAction",
this.Qc);const $b=ba.a.instance.ha(1913);this.Eg=Lc.sW();this.Bu=new Nd.a;this.initializeAndShow($b,this.yXi,{});return this.Bu.task}Mz($b){super.Mz($b);this.Hc(1,ba.a.instance.ha(1915));this.Hc(2,ba.a.instance.Ha(457))}Blj(){this.$.ea.tGd=!1}zQi($b){const tc={};tc.a=this.$.xa.UserSessionId;tc.b="NamedSheetViewTeachingDialogClose";tc.c=$b;tc.e=!0;this.stopwatch&&(this.stopwatch.stop(),tc.d=this.stopwatch.fd);$d.b().Df(53,tc,!0)}}Object(d.a)(se,"NamedSheetViewTeachingDialog",kd.a,[]);var je=a(160);
let Le=class{constructor($b){this.$=$b;Object(qb.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")||$b.da.Ja(309,this)}LVa(){return this.CVj()?(new se(this.$)).fh():za.Task.Ua(!0)}CVj(){const $b=this.$.ua.na;return this.$.ea.tcb&&this.$.ea.tGd&&!$b.Pe.rC&&this.$.ea.JN&&!Object(je.g)(this.$)}};Le=Object(Zb.b)([Object(Ba.d)(Wa.Y),Object(Zb.c)(0,Object(Wa.A)())],Le);Object(d.a)(Le,"NamedSheetViewPublic",null,[803]);class oe extends xb.a{constructor($b){super();this.$=$b;this.kc()}create(){this.Pb(this.$.da.Ba(309)||
new Le(this.$))}static la($b){$b.da.Ja(310,new oe($b))}}Object(d.a)(oe,"NamedSheetViewPublicFactory",xb.a,[]);var ue=a(2),df=a(1382),Se=a(902),bf=a(468);class Ye{constructor($b,tc,Xc,qd,Cd,Xd,ge){this.title=$b;this.body=tc;this.Mlj=Xc;this.primaryButtonAction=qd;this.secondaryButtonAction=Xd;this.vag=Cd;this.targetObject=ge}}Object(d.a)(Ye,"NamedSheetViewTeachingCalloutContent",null,[]);class gf{constructor($b){this.xse=0;this.ung=$b}get sng(){return this.xse}get lnj(){return this.sng<this.ung.count?
this.ung.ma(this.xse++):null}}Object(d.a)(gf,"NamedSheetViewTeachingCalloutList",null,[]);var nf=a(1059),oc;let Ac=oc=class{constructor($b){this.$=$b;this.stopwatch=this.B5b=this.oHc=this.B3d=null;this.tng=0}Rsi($b){this.tng=$b;const tc=Object(ue.a)(new n.a,{});oc.IBi($b)?(tc.add(new Ye(ba.a.instance.Ha(446),ba.a.instance.Ha(447),ba.a.instance.ha(1943),()=>{this.d8(2,"Continue");this.Hca(!0)},ba.a.instance.ha(1944),()=>{this.Hca();this.d8(1,"ExitGuide")},nf.a())),1===$b&&tc.add(new Ye(ba.a.instance.ha(1945),
ba.a.instance.Ha(449),ba.a.instance.ha(1943),()=>{this.d8(2,"FirstEnterTempViewContinueSecond");this.Hca(!0)},ba.a.instance.ha(1944),()=>{this.Hca();this.d8(1,"FirstEnterTempViewExitGuideSecond")},nf.a())),tc.add(new Ye(ba.a.instance.Ha(450),ba.a.instance.Ha(451),ba.a.instance.ha(1943),()=>{this.d8(2,"FirstEnterExitCalloutContinue");this.Hca(!0)},ba.a.instance.ha(1944),()=>{this.Hca();this.d8(1,"FirstEnterExitCalloutGuide")},oc.h$h())),tc.add(new Ye(ba.a.instance.ha(1946),ba.a.instance.Ha(448),ba.a.instance.ha(1947),
()=>{this.oYj();this.Hca();this.d8(1,"LearnMore")},ba.a.instance.ha(1948),()=>{this.Hca();this.d8(1,"Done")},oc.g$h()))):2===$b&&tc.add(new Ye(ba.a.instance.ha(1945),ba.a.instance.Ha(449),ba.a.instance.ha(1942),()=>{this.Hca();this.d8(1,"EnterTempViewAfterPersistedView")},null,null,nf.a()));this.B3d=new gf(tc)}oYj(){const $b=new cb.a(-859308420,nd.a.Vb,this.$.Kc,9,null);this.$.Ia.$b($b,{[nd.a.Bg]:"HelpID=SheetViews",["InputMethod"]:nd.a.Vb,[nd.a.rd]:Pa.a.fS,["ShouldCanvasTakeFocus"]:!0})}show($b){this.Rsi($b);
this.Xhb()}LOj($b){this.B5b=$b}Xhb(){var $b=this.B3d.lnj;if($b){var tc=Object(ue.a)(new df.a,{label:$b.Mlj,onExecute:$b.primaryButtonAction}),Xc=null;$b.vag&&(Xc=Object(ue.a)(new df.a,{label:$b.vag,onExecute:$b.secondaryButtonAction}));$b=Object(ue.a)(new Se.a,{target:$b.targetObject,content:$b.body,title:$b.title,showCloseIcon:!0,primaryButtonProps:tc,secondaryButtonProps:Xc,useTeachingStyles:!0});$b=this.B5b.callout($b);tc=Object(ue.a)(new bf.a,{onShow:()=>{this.d8(0)}});this.oHc=this.B5b.addNotification($b,
tc)}}dismiss(){this.Hca();this.d8(1,"DismissedByOthers")}Hca($b=!1){this.oHc&&(this.B5b.removeNotification(this.oHc),this.oHc=null);$b&&this.Xhb()}d8($b,tc=null){const Xc={};Xc.a=this.$.xa.UserSessionId;Xc.b=this.tng;Xc.c=this.B3d.sng;Xc.d=$b;Xc.e=tc;0===$b?this.stopwatch=this.$.nc.qd("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Xc.f=this.stopwatch.fd,this.stopwatch=null),2===$b&&(this.stopwatch=this.$.nc.qd("UserAction","ShowNamedSheetViewTeachingCalloutNext")));
$d.b().Df(52,Xc,!0)}static g$h(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static h$h(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static IBi($b){return 0===$b||1===$b}};Ac=oc=Object(Zb.b)([Object(Ba.d)(Wa.Z),Object(Zb.c)(0,Object(Wa.A)())],Ac);Object(d.a)(Ac,"NamedSheetViewTeachingCallout",null,[802]);class xa extends xb.a{constructor($b){super();this.$=$b;this.kc()}create(){let $b=this.$.da.Ba(322);$b||($b=new Ac(this.$),this.$.da.Ja(322,
$b));this.Pb($b)}static la($b){$b.da.Ja(323,new xa($b))}}Object(d.a)(xa,"NamedSheetViewTeachingCalloutFactory",xb.a,[]);var Cb=a(126),bc=a(382),Fc=a(107),Tc=a(383);class gd{constructor($b,tc){this.sheetName=null;this.value=!1;this.sheetName=$b;this.value=tc}getSheetName(){return this.sheetName}sya(){return this.value}}Object(d.a)(gd,"MacroRecorderSheetOptionToggledPayload",null,[139]);const td=($b,tc,Xc,qd,Cd,Xd,ge,ve=null)=>{ve=$b.Pa(9,ve);ve.sheetName=tc;ve.show=Xc;return mb.g($b,"ShowGridlines",
ve,qd,Cd,Xd,ge,0)},kb=($b,tc,Xc,qd,Cd,Xd,ge,ve=null)=>{ve=$b.Pa(9,ve);ve.sheetName=tc;ve.show=Xc;return mb.g($b,"ShowHeadings",ve,qd,Cd,Xd,ge,0)},Vb=($b,tc,Xc,qd,Cd,Xd,ge,ve=null)=>{ve=$b.Pa(9,ve);ve.sheetName=tc;ve.directionRtl=Xc;return mb.g($b,"ChangeSheetDirection",ve,qd,Cd,Xd,ge,0)};var qc;let Bc=qc=class{constructor($b){this.$=$b}hd(){return!1}executeCommand($b,tc){const Xc={};this.$.Fk(Xc);$b=tc.command;const qd=Object(Cb.a)(Fc.a,this.$.ua.getItemByName(Xc.SheetName));if(!qd)return Da.a($b);
let Cd,Xd,ge,ve,Ie;switch($b){case 705559150:case -1411193626:Cd=16;Xd=!qd.hideGridLines;ge=td;Ie=183;ve=qd.hideGridLines;break;case -2052321504:case 515737500:Cd=4;Xd=!qd.headersVisible;ge=kb;Ie=184;ve=!qd.headersVisible;break;case -1478455630:Cd=2;Xd=!qd.displayRtl;ge=Vb;Ie=185;ve=!qd.displayRtl;Fa.h(this.$).Ca.bdk(Xd);break;default:return Da.a($b)}qd.Qub(Cd,Xd);const Ee=()=>new gd(Xc.SheetName,ve),pf=this.$.qa.va;return bc.a(this.$.userOperationManager,(Xe,Ve,wf)=>ge(pf,Xc.SheetName,ve,sa.b(Xe,
Ff=>{qc.wLb(Ff,qd,Cd,Xd)}),sa.a(Ve,()=>{qc.GKb(qd,Cd,Xd)}),wf,null),Xe=>new ia.a(Ie,0,Xe,void 0,Ee),tc)}Tc($b,tc){$b=!1;switch(tc.command){case -1411193626:case 515737500:case -1478455630:$b=!0;break;case 705559150:case -2052321504:$b=Tc.a(this.$)}return $b}ld(){return!1}static wLb($b,tc,Xc,qd){ha.a.Aq($b.Errors)&&tc.Qub(Xc,!qd)}static GKb($b,tc,Xc){$b.Qub(tc,!Xc)}};Bc=qc=Object(Zb.b)([Object(Ba.d)(Wa.pb),Object(Zb.c)(0,Object(Wa.A)())],Bc);Object(d.a)(Bc,"SheetOptionsToggleCommandHandler",null,[200]);
Type.registerNamespace("Common.App.NewAndOpen.UX");fb.a.instance.nj(new ra);Ua.a.Fa(Na.la);ta.a.ij(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Ua.a.Fa($b=>{Ma.la($b)})})();(()=>{Ua.a.Fa($b=>{$b.da.Ja(165,new Ra($b))})})();Ua.a.Fa(yb.la);Ua.a.Fa(Qd.la);(()=>{Ua.a.Fa($b=>{Object(qb.b)("OfficeVSO:7624545_MigrateTryOfficeThroughTellMeCommandHandlerService")||
md.la($b)})})();(()=>{Ua.a.Fa($b=>{Object(qb.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")||(oe.la($b),xa.la($b))})})();String(b);String(f);String(c);String(e);window.___1684305534456_closurehack=b;window.___1684305534456_closurehack=f;window.___1684305534456_closurehack=c;window.___1684305534456_closurehack=e}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.kmhv.js.map/4eba1f439c057439d1a5f1092b1add57/EwaDSOpt.kmhv.js.map