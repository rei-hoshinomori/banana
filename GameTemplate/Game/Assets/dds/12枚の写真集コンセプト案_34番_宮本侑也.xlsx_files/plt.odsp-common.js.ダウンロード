(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["plt.odsp-common"],[,,,function(e,t,n){"use strict";n.d(t,"n",function(){return l}),n.d(t,"e",function(){return p}),n.d(t,"t",function(){return p});var a=n(150),i=n(61),r="KillSwitchOverrides",o="".concat(r,"_").concat("enableKillSwitches"),s="".concat(r,"_").concat("disableKillSwitches");function c(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function d(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(o,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(s,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function l(){if(u){for(var e=[],t=0,n=Object.keys(u);t<n.length;t++){var a=n[t];e.push(u[a]?a:"!".concat(a))}return e.join(",")}}var u={},f=function(){u=function(e,t,n,a){if(t)for(var r=0,o=t.split(",");r<o.length;r++){var s=o[r];e[i.normalizeUpper(s,!1)]=!0}if(n)for(var c=0,d=n.split(",");c<d.length;c++)s=d[c],e[i.normalizeUpper(s,!1)]=!1;return e}({},c(o),c(s));var e=function(){try{return location.search?location.search.substring(1):""}catch(e){return""}}(),t=Object(a.e)(e);t.enableKillSwitches,t.disableKillSwitches,t.debugKillSwitches,d(u);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0),u[i.normalizeUpper(e,!1)]=!!t,d(u)}}catch(e){}f=function(){}},p=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=m({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(f(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=m(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=m({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}();function m(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,a){var r=!1;if(e){var o=i.normalizeUpper(e,!1);o in u?r=!!u[o]:t&&(r=!!t[o])}return r}}}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.default=0]="default",e[e.shareShimmer=1]="shareShimmer",e[e.modifyPermissions=2]="modifyPermissions",e[e.permissionsList=3]="permissionsList",e[e.linkSuccess=4]="linkSuccess",e[e.grantPermissions=5]="grantPermissions",e[e.policyDetails=6]="policyDetails",e[e.error=7]="error",e[e.linkSettings=8]="linkSettings",e[e.notify=9]="notify",e[e.addPeople=10]="addPeople",e[e.linksFromTemplateList=12]="linksFromTemplateList",e[e.atMention=13]="atMention",e[e.spinner=14]="spinner",e[e.copyLinkShortcut=15]="copyLinkShortcut",e[e.permissionsPivot=16]="permissionsPivot",e[e.shareToTeams=17]="shareToTeams"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"ne",function(){return l}),n.d(t,"m",function(){return u}),n.d(t,"F",function(){return f}),n.d(t,"U",function(){return p}),n.d(t,"re",function(){return m}),n.d(t,"N",function(){return _}),n.d(t,"D",function(){return h}),n.d(t,"S",function(){return b}),n.d(t,"R",function(){return g}),n.d(t,"p",function(){return v}),n.d(t,"g",function(){return y}),n.d(t,"h",function(){return S}),n.d(t,"y",function(){return D}),n.d(t,"r",function(){return I}),n.d(t,"b",function(){return x}),n.d(t,"v",function(){return C}),n.d(t,"K",function(){return O}),n.d(t,"ae",function(){return w}),n.d(t,"O",function(){return E}),n.d(t,"w",function(){return A}),n.d(t,"ie",function(){return L}),n.d(t,"q",function(){return k}),n.d(t,"T",function(){return M}),n.d(t,"L",function(){return P}),n.d(t,"M",function(){return T}),n.d(t,"k",function(){return U}),n.d(t,"E",function(){return F}),n.d(t,"j",function(){return H}),n.d(t,"_",function(){return R}),n.d(t,"Z",function(){return N}),n.d(t,"V",function(){return B}),n.d(t,"W",function(){return j}),n.d(t,"Q",function(){return V}),n.d(t,"Y",function(){return z}),n.d(t,"oe",function(){return G}),n.d(t,"B",function(){return K}),n.d(t,"x",function(){return W}),n.d(t,"G",function(){return q}),n.d(t,"c",function(){return Q}),n.d(t,"n",function(){return Y}),n.d(t,"H",function(){return J}),n.d(t,"$",function(){return X}),n.d(t,"J",function(){return Z}),n.d(t,"X",function(){return $}),n.d(t,"a",function(){return ee}),n.d(t,"P",function(){return te}),n.d(t,"o",function(){return ne}),n.d(t,"f",function(){return ae}),n.d(t,"s",function(){return ie}),n.d(t,"t",function(){return re}),n.d(t,"te",function(){return oe}),n.d(t,"ee",function(){return se}),n.d(t,"e",function(){return ce}),n.d(t,"u",function(){return de}),n.d(t,"se",function(){return le}),n.d(t,"z",function(){return ue}),n.d(t,"ce",function(){return fe}),n.d(t,"A",function(){return pe}),n.d(t,"l",function(){return me}),n.d(t,"I",function(){return _e}),n.d(t,"i",function(){return he}),n.d(t,"d",function(){return be}),n.d(t,"C",function(){return ge});var a=n(21),i=n(29),r=n(3),o=n(98),s=window._spPageContextInfo,c=(s&&"21"===s.webTemplate&&s.listBaseTemplate,[]);function d(e){var t=c.filter(function(t){return t.flightStringId===e})[0];return t?t.flightEnabled:e}function l(){return!0}function u(){return a.e.isFeatureEnabled({ODB:1977})}function f(){return a.e.isFeatureEnabled({ODB:60345})}function p(){return a.e.isFeatureEnabled({ODC:d("ManageAccessRevampConsumer"),ODB:!1,ECS:1076813,OneDrive:void 0})}function m(){return!r.t.isActivated("227ee00d-a46d-42cd-8beb-de7befc5cff7","4/27/2021","Deactivate require signin link clientid flag")}function _(){return!a.e.isFeatureEnabled({ODC:d("ODCHideNonPremiumLinkFeatures"),ODB:!1,OneDrive:void 0})}function h(){return!r.t.isActivated("ac3be7d5-fbd4-47c9-b4f4-275d4e8ebb4c","02/21/2023","fixRequireSignIn")&&!a.e.isFeatureEnabled({ECS:1071208})}function b(){return!r.t.isActivated("a0f6091d-e62c-4e67-b0a6-72bbb134892d","02/10/2023","fixPeoplePickerOdcCustomerPromise")&&!a.e.isFeatureEnabled({ECS:1069468})}function g(){return!a.e.isFeatureEnabled({ODC:d("FamilySharingWacKS"),ODB:!1,OneDrive:void 0})}function v(){return!r.t.isActivated("da13eadb-9185-4fff-895e-e7d4e149be07","01/18/2023","external sharing in people picker")&&!a.e.isFeatureEnabled({ECS:1056503})}function y(){return!r.t.isActivated("cb7d2c6b-f7da-457b-aca2-d8b94f0ababb","01/18/2023","fixLinkSettingsOpenLog")&&!a.e.isFeatureEnabled({ECS:1064203})}function S(){return!r.t.isActivated("29f3b27d-c021-4576-a5d9-09aabcfc99fb","04/06/2023","fixCopyLinkViewState")&&!a.e.isFeatureEnabled({ECS:1081949})}function D(){return!r.t.isActivated("b94c9c2c-6f5f-4f91-b002-0bd352472576","01/05/2023","fixOnAudienceChange")&&!a.e.isFeatureEnabled({ECS:1061682})}function I(){return!r.t.isActivated("7a9df369-1b0e-4d87-ae0a-503c6d7d8bb8","04/25/2023","changeCustomerPromiseTimeOut")&&!a.e.isFeatureEnabled({ECS:1086659})}function x(){return!r.t.isActivated("fd9b2be1-792b-4b24-b915-b69e7b79c2cb","04/13/2023","fixCopyToClipboard")&&!a.e.isFeatureEnabled({ECS:1083754})}function C(){return!r.t.isActivated("03fde877-4287-4f2a-9c7f-da996bdcb7a6","04/24/2023","fixLinkSettingsOtherSettings")&&!a.e.isFeatureEnabled({ECS:1083754})}function O(){return r.t.isActivated("faddb478-21be-4f5e-8faa-df13a82e3741","04/03/23","fix Share Link Details input")||a.e.isFeatureEnabled({ECS:1081339})}function w(){return r.t.isActivated("8895d460-18ab-47d5-8973-8b22fcf4cc29","04/26/23","make suite nav fetch async and nonblocking")||a.e.isFeatureEnabled({ECS:1086974})}function E(){return!r.t.isActivated("FE17821F-BAE7-44D8-91C0-5145C4D97969","10/01/2021","Invite placeholder user")&&a.e.isFeatureEnabled({ODB:60596})}function A(){return r.t.isActivated("34f56314-e874-4fd6-ab55-d5989a76f8ae","10/12/2021","Check sharing abilities for read permissions")||a.e.isFeatureEnabled({ECS:100295})}function L(){return a.e.isFeatureEnabled({ODB:60149})}function k(){return!r.t.isActivated("dcfb2c5d-46bc-4a7f-8970-f5066f36bb16","10/12/2021","Share To Teams in web")}function M(){return!r.t.isActivated("8511183b-9de9-4797-ada1-ac052cf3ecb1","2/23/2022","Manage Access V3 in ODB")}function P(){return r.t.isActivated("2B61136D-C6A8-432B-9B67-392506BF2DB4","12/07/2021","fix NGSC userphoto")||a.e.isFeatureEnabled({ECS:112341})}function T(){return r.t.isActivated("5108f6ec-83ee-43f0-b941-7183bcf0a99f","02/09/2022","get GSI response before rendering Share component")||a.e.isFeatureEnabled({ECS:1002677})}function U(){return r.t.isActivated("45a2c5f9-21b8-4775-9e30-4e61d1f67106","02/02/2022","use new share Messenger for cross window communication")||a.e.isFeatureEnabled({ECS:1000619})}function F(){return r.t.isActivated("7D579513-ED41-46CC-A73A-20870B56E146","02/04/2022","html format copy link")||a.e.isFeatureEnabled({ECS:1000922})}function H(){return!r.t.isActivated("e6dbe5d1-55f9-439b-a975-1931c6bf9c90","02/25/2021","People picker improvements")&&!a.e.isFeatureEnabled({ECS:1005398})}function R(){return a.e.isFeatureEnabled({ODC:d("FamilySharing"),ODB:!1,OneDrive:void 0})}function N(){return r.t.isActivated("61C832C8-21D8-4A3C-AB3F-96B622EDF097","05/03/2022","sharing telemetry change")||a.e.isFeatureEnabled({ECS:1014685})}function B(){return!r.t.isActivated("2f7d46e9-cb5e-4ab7-8239-0c53e0934af9","05/06/2022","refactorCopyLinkSection")&&!a.e.isFeatureEnabled({ECS:1015255})}function j(){return r.t.isActivated("725d183a-c483-493d-9da2-9625b110c77e","04/28/2022","share site theming fix")||a.e.isFeatureEnabled({ECS:1014033})}function V(){return r.t.isActivated("0865093c-8bb2-4412-bde8-5d4fdfb6cd0b","05/16/2022","share link details action btn fix ks")||i.e.isFeatureEnabled({ECS:1016798})}function z(){return r.t.isActivated("6f92e945-60ed-4655-8ae4-8ea1fd9355ba","05/18/2022","share update select tooltip to callout ks")||i.e.isFeatureEnabled({ODC:d("SharingTooltipCalloutKS"),ECS:1017301,OneDrive:void 0})}function G(){return r.t.isActivated("6da0bda6-e708-4aea-80ef-0cf1a2b7fbd1","07/28/2022","wait for 29 sec if microservice share still did not receive context info, we mark it as expected failure")||i.e.isFeatureEnabled({ECS:1033235})}function K(){return!r.t.isActivated("6acc2587-8c04-4366-960a-8754df787145","10/03/2022","People picker 3s search with non mail security group indexing")&&!a.e.isFeatureEnabled({ECS:1044963})&&a.e.isFeatureEnabled({ODB:1596})||a.e.isFeatureEnabled({ODC:d("Enable3SonWacWord"),ODB:!1,ECS:1076914,OneDrive:void 0})}function W(){return r.t.isActivated("d6acbcb0-5618-4923-b629-0cdd43763c4a","10/31/2022","new header reformat")||i.e.isFeatureEnabled({ECS:1050305})}function q(){return!r.t.isActivated("ee93955a-86ab-4a37-8d56-90bb650597e6","11/03/2022","ask shareLink to return nav in copy link instead of adding it on the client side")&&!i.e.isFeatureEnabled({ECS:1050946})}function Q(){return!r.t.isActivated("9d1d251f-6408-4e8d-9307-3bf390882d26","11/08/2022","Enable 3s init call when launching sharedialog")&&!i.e.isFeatureEnabled({ECS:1051805})}function Y(){return!r.t.isActivated("eedcb79a-92e9-4d30-94b2-2c5aa2b4796a","11/30/2022","report ASHA customer promise")&&!i.e.isFeatureEnabled({ECS:1056502})}function J(){return r.t.isActivated("925a3ec4-31b0-4511-9c21-f4059a23084a","11/30/2022","Max height set in od-Share based on window.parent.innerHeight")||i.e.isFeatureEnabled({ECS:1056462})}function X(){return r.t.isActivated("8eadce6c-f9e5-4276-9513-09fa22db604f","12/6/2022","show edit and view permissions when requesting access")||i.e.isFeatureEnabled({ECS:1057666})}function Z(){return!r.t.isActivated("eed24e3c-2a9b-47cf-9505-3fe89cb0e1e7","12/11/2022","Default message text with document summary")&&a.e.isFeatureEnabled({ODB:1785})}function $(){return!r.t.isActivated("429328b1-73c4-4346-b204-29ce8a8d354d","12/21/2022","Enable rendering a message bar in the default, copy link, or manage access sharing dialog.")&&!r.t.isActivated("be539d36-bc68-42bf-ba3a-494ed392aa9e","09/29/2022","Disable new page sharing experience")&&(i.e.isFeatureEnabled({ODB:1556})||ve(s))}function ee(){return r.t.isActivated("4d8d94d3-0fe1-4964-ab4d-ff9c8653e4ba","12/20/2022","Add / Remove PSL users KS")||i.e.isFeatureEnabled({ECS:1066831})}function te(){return r.t.isActivated("4456afcc-746e-405e-b60e-164960cf7116","1/10/2023","Fix for manage access back button not working through shared with facepile endpoint")||i.e.isFeatureEnabled({ECS:1062499})}function ne(){return!r.t.isActivated("2a092b3f-6729-4a0a-a847-7c2e1dc366e9","1/24/2023","Contextual Sharing Feature")&&!i.e.isFeatureEnabled({ECS:1065461})&&a.e.isFeatureEnabled({ODB:1743})}function ae(){return!r.t.isActivated("d685ea9e-632d-414f-9b9c-6982bc1c6eec","01/24/2023","Disables expiration date picker based on get/delete submitOnlyLink status.")}function ie(){return!r.t.isActivated("a8176101-afe0-4540-975d-cd326db8ee52","01/23/2023","Allows file request sharelink to be edited from manage access pane.")}function re(){return r.t.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link")}function oe(){return r.t.isActivated("5a8c7e3f-c3a1-4937-b292-499cbc09620b","2/23/2023","Simplified Sharing Dialog")||i.e.isFeatureEnabled({ECS:1080753})}function se(){return a.e.isFeatureEnabled({ODB:60045})}function ce(){return!r.t.isActivated("25e8dd3e-bd83-48a1-99d8-35f34eaf9031","1/13/2023")&&!a.e.isFeatureEnabled({ODC:d("ODCFacepileFeature"),ODB:!1,OneDrive:void 0})&&i.e.isFeatureEnabled({ECS:1066859})}function de(){return r.t.isActivated("ccfe8581-04e5-4529-b8c4-d2b8512f0b1a","03/23/2023","KS for showing search directory, and filtering personas based on email to remove duplicates")||i.e.isFeatureEnabled({ECS:1078726})}function le(){return r.t.isActivated("1e2059ca-d032-4ff5-83b5-c5ff4a9e0479","03/30/2023","KS for using sharing scope instead of linkKind to determind if user is external and has CSL configured")||i.e.isFeatureEnabled({ECS:1080346})}function ue(){return r.t.isActivated("73b3928f-b12a-4790-bc02-c408f017a36c","05/04/2023","KS to remove advanced link from mobile")||i.e.isFeatureEnabled({ECS:1090411})}function fe(){return r.t.isActivated("8ed7c075-cae8-4cc5-a59b-951e92c426d3","04/11/2023","KS for using simplified header for manage access")}function pe(){return r.t.isActivated("172ad921-3f82-4520-b314-2807be4528da","4/18/2023","use new logic for isShared property")}function me(){return r.t.isActivated("faee7329-04f8-4114-a538-75aa5488e7b5","04/05/2023","KS for announcing people picker removed/added person")||i.e.isFeatureEnabled({ECS:1081649})}function _e(){return!r.t.isActivated("c675bcf5-0efe-428c-ae4d-7b3b4819af14","04/10/2023","KS for enabling floodgate survey in sharedialog")&&a.e.isFeatureEnabled({ODB:60170})}function he(){return!r.t.isActivated("12433928-0E66-4E22-855E-A4C423EAA76C","04/03/2023","KS for AI generated document summary")&&a.e.isFeatureEnabled({ODB:60643})}function be(){return r.t.isActivated("39F46712-D1A7-4A26-8871-8AE2C5AD8AA0","04/24/2023","KS for block download role selection")||i.e.isFeatureEnabled({ECS:1086470})}function ge(){return r.t.isActivated("fe932acb-261e-48de-a563-d4b079c78310","04/27/2023","KS for iOS resize fix on focus of people picker")||i.e.isFeatureEnabled({ECS:1087421})}var ve=function(e){return!(r.t.isActivated("5d592717-97ec-4339-9b65-4439dc0307b3","05/01/2023","Disable the O365 page sharing experience experiment")||!a.e.isFeatureEnabled({ODB:60600}))&&1===Object(o.n)(90174,e)}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(162),i=void 0;function r(e){if(void 0===i)for(var t in i={},a.e){var n=parseInt(t);if(!isNaN(n)){var r=a.e[n].toLowerCase();i[r]=n}}var o=e?e.toLowerCase():"";return i[o]||a.e.unknown}t.e=a.e},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(136),r=n(8),o=n(28);n.d(t,"t",function(){return o.e});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.end=function(t){return t&&t.extraData&&this.data.extraData&&(t=Object(a.e)(Object(a.e)({},t),{extraData:Object(a.e)(Object(a.e)({},this.data.extraData),t.extraData)})),e.prototype.end.call(this,t)},t}(Object(i.e)({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:r.e.String},startTimeOverride:{isPrefixingDisabled:!0,type:r.e.Number},resultCode:{isPrefixingDisabled:!0,type:r.e.String},resultType:{typeRef:o.e,isPrefixingDisabled:!0,type:r.e.Enum},error:{isPrefixingDisabled:!0,type:r.e.String},extraData:r.e.Object,extraMetrics:{isPrefixingDisabled:!0,type:r.e.Object},privacyClassification:{isPrefixingDisabled:!0,type:r.e.String}}).withData({privacyClassification:r.t.requiredService,privacyDataTypes:["productAndServicePerformance"]}))},function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a={};n.r(a),n.d(a,"requiredDiagnostic",function(){return i}),n.d(a,"optionalDiagnostic",function(){return r}),n.d(a,"requiredService",function(){return o});var i="requiredDiagnostic",r="optionalDiagnostic",o="requiredService",s=a,c={String:1,Number:2,Boolean:3,Object:4,Array:5,Enum:6}},,function(e,t,n){"use strict";n.d(t,"c",function(){return L}),n.d(t,"B",function(){return k}),n.d(t,"j",function(){return M}),n.d(t,"N",function(){return P}),n.d(t,"e",function(){return y}),n.d(t,"T",function(){return T}),n.d(t,"z",function(){return U}),n.d(t,"K",function(){return F}),n.d(t,"G",function(){return H}),n.d(t,"R",function(){return N}),n.d(t,"E",function(){return B}),n.d(t,"w",function(){return j}),n.d(t,"M",function(){return V}),n.d(t,"A",function(){return z}),n.d(t,"L",function(){return G}),n.d(t,"P",function(){return K}),n.d(t,"v",function(){return W}),n.d(t,"g",function(){return q}),n.d(t,"l",function(){return Q}),n.d(t,"d",function(){return Y}),n.d(t,"S",function(){return J}),n.d(t,"o",function(){return Z}),n.d(t,"D",function(){return $}),n.d(t,"p",function(){return ee}),n.d(t,"C",function(){return te}),n.d(t,"h",function(){return ne}),n.d(t,"r",function(){return ae}),n.d(t,"I",function(){return re}),n.d(t,"F",function(){return oe}),n.d(t,"f",function(){return se}),n.d(t,"_",function(){return ce}),n.d(t,"y",function(){return de}),n.d(t,"m",function(){return le}),n.d(t,"a",function(){return ue}),n.d(t,"i",function(){return fe}),n.d(t,"U",function(){return pe}),n.d(t,"u",function(){return me}),n.d(t,"s",function(){return _e}),n.d(t,"V",function(){return he}),n.d(t,"O",function(){return be}),n.d(t,"x",function(){return ge}),n.d(t,"H",function(){return ve}),n.d(t,"k",function(){return ye}),n.d(t,"t",function(){return Se}),n.d(t,"n",function(){return De}),n.d(t,"b",function(){return Ie});var a=n(0),i=n(176),r=n(177),o=n(56),s=n(370),c=n(205),d=n(6),l=n(31),u=n(35),f=n(1),p=n(15),m=n(263),_=n(97),h=n(5),b=/[<>&'"\\]/g,g={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"};function v(e){return g[e]}var y,S=function(){function e(){}return e.encodeText=function(e){return e?e.replace(b,v):""},e}(),D=n(23),I=n(7),x=n(89),C=n(127),O=n(49),w=n(133),E=n(70),A=n(26),L=[f.Bs,f.Zn,f.qs,f.oc,f.Gs,f.an,f.fo],k=[f.gs,f.ps,f.ys,f.Ss,f.vs,f.ss,f.hs],M=[f.cs,f.os,f.us,f.as,f.fs,f.ls,f.ds,f.is,f.bs,f._s,f.ms,f.rs],P=[f.Dn,f.Xt,f.jn,f.G,f.zn,f.xn,f.In,f.te,f.Do,f.Ba,f.Na,f.at];function T(){var e=new A.e(location.href);return e.getPath(!0).indexOf("/_layouts/15/sharedialog.aspx")>=0&&"true"===e.getQueryParameter("crossdomain")}function U(e,t){return R(e,t=t||26)}function F(e,t){return R(e,t=t||25)}function H(e,t){return R(e,t=t||20)}function R(e,t){if(!e)return"";var n=t,a=n/2;if(e.length<=n)return e;var i=e.slice(0,a),r=e.slice(e.length-a);return"".concat(i,"...").concat(r)}function N(e){return e.userRole===i.e.none&&e.defaultLinkKind===r.e.uninitialized}function B(e,t){switch(e){case"anonymous":return t?r.e.anonymousEdit:r.e.anonymousView;case"organization":return t?r.e.organizationEdit:r.e.organizationView;case"users":return r.e.flexible;default:return r.e.direct}}function j(e){switch(e){case"anonymous":return o.e.anyone;case"organization":return o.e.organization;case"users":return o.e.specificPeople;default:return o.e.existing}}function V(e){switch(e){case r.e.anonymousEdit:case r.e.anonymousView:return"anonymous";case r.e.organizationEdit:case r.e.organizationView:return"organization";case r.e.flexible:return"users";default:return"existingAccess"}}function z(e){switch(e){case o.e.anyone:return"anyone";case o.e.organization:return"organization";case o.e.specificPeople:case o.e.specificPeopleFlex:case o.e.customLabeledSpecificPeople:return"specificPeople";case o.e.existing:default:return"existingAccess"}}function G(e){switch(e){case o.e.anyone:return s.e.anyone;case o.e.organization:return s.e.organization;case o.e.specificPeople:case o.e.specificPeopleFlex:case o.e.customLabeledSpecificPeople:return s.e.specificPeople;case o.e.existing:default:return s.e.existing}}function K(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function W(e,t,n){var a=t.sharingLinkKind,i=t.audience,s=window.require?window.require.toUrl("odsp-media/images/sharedialog"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/assets/icons/sharing",c=p.l(e)?"directrecipients.svg":"peopleinchat.svg";switch(a){case r.e.organizationView:case r.e.organizationEdit:return"".concat(s,"/companyonly.svg");case r.e.anonymousView:case r.e.anonymousEdit:return"".concat(s,"/anyone.svg");case r.e.flexible:return t.audience===o.e.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(s,"/").concat(c):"".concat(s,"/specificpeople.svg");default:return i===o.e.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(s,"/").concat(c):window.require?"".concat(s,"/existingaccess.svg"):"".concat(s,"/existingaccess.svg?v2")}}function q(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case r.e.requestAccess:return"Mail";case r.e.organizationView:case r.e.organizationEdit:return"Work";case r.e.anonymousView:case r.e.anonymousEdit:return"Globe";case r.e.flexible:return e.audience===o.e.anyone?"Globe":e.audience===o.e.organization?"Work":"PeopleAdd";default:return"Link"}}function Q(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#82C7FF",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}function Y(e,t,n,a){var i=p.l(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return f.xi;case"review":return m.e[a]?f.Ci:f.Oi;default:return f.wi}case"team":switch(t){case"edit":return f.Mi;case"review":return m.e[a]?f.Pi:f.Ti;default:return f.Ui}case"recipient":switch(t){case"edit":return f.Vr;case"review":return m.e[a]?f.zr:f.Gr;default:return f.Kr}default:switch(t){case"edit":return f.Ei;case"review":return m.e[a]?f.Ai:f.Li;default:return f.ki}}}function J(e,t,n,a,i,s){var c=e.sharingLinkKind,d=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?u.n(f.Zt,t):f.$t;if(s)return f.r;switch(c){case r.e.requestAccess:var l=e.invitees[0],p=l.primaryText||l.email||l.id;return u.n(f.no,p);case r.e.organizationView:return u.n(f.Xe,t);case r.e.organizationEdit:return u.n(f.qe,t);case r.e.anonymousView:return f.R;case r.e.anonymousEdit:return f.L;case r.e.direct:return d===o.e.customLabeledSpecificPeople?e.isReview?a&&a.entityName?u.n(f.tt,a.entityName):Y(n,"review",a,i):e.isEdit?a&&a.entityName?u.n(f.et,a.entityName):Y(n,"edit",a):a&&a.entityName?u.n(f.nt,a.entityName):Y(n,"view",a):f.Et;case r.e.flexible:return d===o.e.existing?f.Et:d===o.e.anyone?e.blockDownload?e.hasPassword?f.B:f.N:e.hasPassword?e.isReview?m.e[i]?f.T:f.U:e.isEdit?f.P:f.F:e.isReview?m.e[i]?f.M:f.H:e.isEdit?f.L:f.R:d===o.e.customLabeledSpecificPeople?e.isReview?a&&a.entityName?u.n(f.tt,a.entityName):Y(n,"review",a,i):e.isEdit?a&&a.entityName?u.n(f.et,a.entityName):Y(n,"edit",a):a&&a.entityName?u.n(f.nt,a.entityName):Y(n,"view",a):e.audience===o.e.organization?e.blockDownload?u.n(f.Ze,t):e.isReview?m.e[i]?u.n(f.Ye,t):u.n(f.Je,t):e.isEdit?u.n(f.qe,t):u.n(f.Xe,t):e.blockDownload?f.Ls:e.isReview?m.e[i]?f.xr:f.Cr:e.isEdit?f.Ir:f.Or;default:return""}}function X(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function Z(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function $(e){for(var t=[],n=e.principals,a=e.invitees,i=0,r=n;i<r.length;i++){var o=r[i];t.push(X(o))}for(var s=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(X(e))},c=0,d=a;c<d.length;c++)s(d[c]);return t}function ee(e){if(!e)return 0;var t=0,n=e.length,a=0,i=!1;if(0===e.length)return 0;for(;a<n;){var r=null,o=e[a];" "===o?r=a+1<n&&" "===e[a+1]||i?"&#160;":" ":"\n"===o?(r="<br />",i=!0):('"'===o?r="&quot;&quot;&quot;":"&"===o?r="&amp;":"'"===o?r="&#39;":"<"===o?r="&lt;":">"===o?r="&gt;":"\r"===o&&(r=" "),i=!1),t+=null!==r?r.length:1,a++}return t}function te(e,t,n){var a,r;switch(e){case i.e.manageList:a="EditListPencil",r=f.re;break;case i.e.edit:a="Edit",r=t?f.ce:f.se;break;case i.e.view:a="View",r=f.be;break;case i.e.review:a="Feedback",r=f.pe;break;case i.e.owner:a="Signin",r=f.rn;break;case i.e.none:a="Delete",r=f.bt}return{name:a,title:n?r.toLowerCase():r}}function ne(e){var t=i.e.none,n=ie(),a=e.accessMap;return null==a||a.forEach(function(e){var a=re(e);n.indexOf(a)>n.indexOf(t)&&(t=a)}),t}function ae(e,t){var n=ie();return n.indexOf(e)>n.indexOf(t)}function ie(){return[i.e.none,i.e.submit,i.e.restrictedview,i.e.view,i.e.review,i.e.edit,i.e.manageList,i.e.owner]}function re(e){var t=e.role,n=e.rawPermission;if(e.isSPO);else{if(n.roles){t=i.e.view;for(var a=0,r=n.roles;a<r.length;a++)"write"===r[a]&&(t=i.e.edit)}n.link&&n.link.type&&("edit"===n.link.type?t=i.e.edit:"view"===n.link.type&&(t=i.e.view))}return t}function oe(e){return e===i.e.edit||Object(h.F)()&&e===i.e.manageList}function se(e,t){return Object(h.F)()&&p.a(e)&&(null==t?void 0:t.sharedObjectType)===_.e.list?i.e.manageList:i.e.edit}function ce(e,t){var n=y.none,a=t;if(!e||e.getTime()===new Date(0).getTime())return n;var i=new Date;i.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var r=Math.floor((e.getTime()-i.getTime())/864e5);return r<1?n=y.pastDate:r>730?n=y.overMax:r>a&&-1!==a&&(n=y.adminPolicy),n}function de(e,t){return e===o.e.anyone?t?r.e.anonymousEdit:r.e.anonymousView:e===o.e.organization?t?r.e.organizationEdit:r.e.organizationView:e===o.e.specificPeople||e===o.e.existing?r.e.direct:r.e.flexible}function le(e,t){switch(e){case y.pastDate:return f.Di;case y.adminPolicy:return u.n(f.C,t);case y.overMax:return u.n(f.Vn,730);case y.adminRequired:return f.ro;default:return""}}function ue(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function fe(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function pe(e,t,n){return p.l(e)||t===c.e.linkSettings&&p.f(e)&&n&&(!!n.entityName||!!n.audienceType)}function me(e){var t=e;if(-1===t)return null;var n=new Date;return n.setDate(n.getDate()+t),n}function _e(e){return Object(a.t)(this,void 0,void 0,function(){var t,n,i,r,o,s,l,u,f,m,_,b,g,v,y,w;return Object(a.i)(this,function(A){switch(A.label){case 0:if(t=!1,p.o(e.clientId))return[3,8];n=null,i=new I.e({name:"shareLinkCopyFromBrowser"}),r=new I.e({name:"shareLinkExecCopyCommandToClipboard"}),o=e.textField,Object(h.b)()&&!o&&((o=document.createElement("textarea")).textContent=e.linkUrl,o.style.top="0",o.style.left="0",o.style.position="absolute",o.style.opacity="0",document.body.appendChild(o));try{o.focus(),o.setSelectionRange(0,o.value.length),t=document.execCommand("copy"),r.end({resultType:I.t.Success})}catch(e){n=e,v=new O.e({code:"exeCopyCommandError",innerError:e}),r.end(Object(C.e)(Object(x.e)(e),{resultCode:v.code}))}if(!window.navigator||!window.navigator.clipboard)return[3,7];s=new I.e({name:"shareLinkClipboardWrite"}),A.label=1;case 1:return A.trys.push([1,6,,7]),!Object(h.E)()&&"write"in window.navigator.clipboard&&e.itemName?(l=(null==o?void 0:o.value)||e.linkUrl,u="text/plain",f="text/html",m=new Blob([l],{type:u}),_=new Blob(["<a href=".concat(l,">").concat(S.encodeText(e.itemName),"</a>")],{type:f}),b=[new ClipboardItem((w={},w[u]=m,w[f]=_,w))],[4,window.navigator.clipboard.write(b)]):[3,3];case 2:return A.sent(),[3,5];case 3:return[4,window.navigator.clipboard.writeText((null==o?void 0:o.value)||e.linkUrl)];case 4:A.sent(),A.label=5;case 5:return t=!0,s.end({resultType:I.t.Success}),[3,7];case 6:return g=A.sent(),n=g,v=new O.e({code:"clipboardWriteError",innerError:g}),s.end(Object(C.e)(Object(x.e)(g),{resultCode:v.code})),[3,7];case 7:Object(E.e)()&&window.sessionStorage.setItem("copiedLink",(null==o?void 0:o.value)||e.linkUrl),Object(h.b)()&&!e.textField&&document.body.removeChild(o),y={resultType:I.t.Success},t||(y=Object(C.e)(Object(x.e)(n),{resultCode:(null==n?void 0:n.code)||"copyFromBrowserError"})),y.extraData=Object(a.e)(Object(a.e)(Object(a.e)({},y.extraData),e.extraQosData),{clientId:d.e[e.extraQosData.clientId],mode:c.e[e.extraQosData.mode],isCrossDomainSharePointHosted:T()}),i.end(y),A.label=8;case 8:try{t=Object(D.n)(e.linkUrl)}catch(e){}return[2,t]}})})}function he(e,t){return!Object(h.L)()&&e&&e.toLowerCase().indexOf("/_layouts/15/userphoto.aspx")>=0&&location.href.toLowerCase().indexOf("sharedialog.aspx")<0&&(p.c(t)||p._(t))}function be(e,t){var n=e.sharingLinks,a=e.sharingPrincipals,o=t?n:n.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==r.e.direct&&(!e.expiration||t.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)}),s=!!o.length;if(!s&&a.length)for(var c=0,d=a;c<d.length;c++)if(d[c].role!==i.e.owner){s=!0;break}return{shared:s,activeLinks:o,sharingPrincipals:a}}function ge(e){var t;switch(e){case l.e.user:t="user";break;case l.e.none:t="none";break;default:t="group"}return t}function ve(e){var t=new Date(null),n=new Date(0),a=e instanceof Date&&!isNaN(e.getTime()),i=!1;if(a)try{var r=new Date(e),o=r.getFullYear&&r.getFullYear();0!==o&&1!==o||(i=!0)}catch(e){}return!e||e===t||e===n||i||!a}!function(e){e[e.none=0]="none",e[e.pastDate=1]="pastDate",e[e.adminPolicy=2]="adminPolicy",e[e.overMax=3]="overMax",e[e.adminRequired=4]="adminRequired"}(y||(y={}));var ye=function(e,t,n){if(n){var a=n.expiration,i=n.hasPassword,r=n.preventDownload,s=[];return a&&a.getTime()!==new Date(0).getTime()&&s.push({icon:"Calendar",tooltip:"".concat(u.n(f.Bt,Object(w.n)(a)))}),i&&s.push({icon:"Lock",tooltip:f.ko}),r&&s.push({icon:"Blocked2",tooltip:f.br}),n.audience!==o.e.existing&&n.isReview&&m.e[t.fileExtension]&&s.push({icon:"Feedback",tooltip:f.ja}),n.audience===o.e.anyone&&n.trackLinkUsers&&s.push({icon:"ReminderPerson",tooltip:p.a(e)?f.oo:f.co}),s}},Se=340,De=480,Ie=function(e){var t=e.clientId,n=e.companyName,a=e.currentSettings,s=e.customLabeledAudienceConfig,c=e.sharingInformation;if(!a||!c)return"";if(a.preventDownload){if(a.audience===o.e.anyone)return f.N;if(a.audience===o.e.organization)return u.n(f.Ze,n);if(a.audience===o.e.specificPeopleFlex)return f.Ls}switch(a.sharingLinkKind){case r.e.direct:return a.audience===o.e.specificPeople?c.requiresAccessApproval?f.eo:a.sharingRole?oe(a.sharingRole)?f.Cs:a.sharingRole===i.e.review?m.e[c.fileExtension]?f.ws:f.Es:f.As:a.isEdit?f.Cs:f.As:f.Et;case r.e.organizationView:return u.n(f.Xe,n);case r.e.organizationEdit:return u.n(f.qe,n);case r.e.anonymousView:return f.R;case r.e.anonymousEdit:return f.L;case r.e.flexible:return xe(t,n,a,s,c);default:return""}},xe=function(e,t,n,a,r){return n.audience===o.e.existing?f.Et:n.audience===o.e.specificPeopleFlex?n.sharingRole?n.sharingRole==i.e.manageList?f.Os:oe(n.sharingRole)?f.Cs:n.sharingRole===i.e.review?m.e[r.fileExtension]?f.ws:f.Es:f.As:n.isEdit?f.Cs:f.As:n.audience===o.e.customLabeledSpecificPeople?n.sharingRole===i.e.review?a&&a.entityName?u.n(f.tt,a.entityName):Y(e,"review",a,r.fileExtension):n.isEdit?a&&a.entityName?u.n(f.et,a.entityName):Y(e,"edit",a):a&&a.entityName?u.n(f.nt,a.entityName):Y(e,"view",a):n.audience===o.e.organization?n.sharingRole===i.e.review?m.e[r.fileExtension]?u.n(f.Ye,t):u.n(f.Je,t):n.sharingRole==i.e.manageList?u.n(f.Qe,t):n.isEdit?u.n(f.qe,t):u.n(f.Xe,t):n.audience===o.e.anyone?n.sharingRole===i.e.review?m.e[r.fileExtension]?f.M:f.H:n.sharingRole==i.e.manageList?f.k:n.isEdit?f.L:f.R:""}},function(e,t,n){"use strict";n.d(t,"t",function(){return p}),n.d(t,"e",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"a",function(){return S}),n.d(t,"n",function(){return T});var a,i=n(0),r=n(148),o=n(68),s=n(137),c=n(283),d=n(3),l=0;function u(e){return{get:function(){return new m(this.key,this.flags|e)}}}!function(e){e[e.none=0]="none",e[e.lazy=1]="lazy",e[e.local=2]="local",e[e.optional=4]="optional",e[e.bypass=8]="bypass",e[e.async=16]="async",e[e.suspensible=32]="suspensible",e[e.notAsync=-18]="notAsync",e[e.handleViral=16]="handleViral",e[e.loaderViral=8]="loaderViral"}(a||(a={}));var f={async:u(a.async|a.lazy),suspensible:u(a.suspensible),lazy:u(a.lazy),local:u(a.local),optional:u(a.optional),bypass:u(a.bypass)},p=function(){function e(e){this.id=++l,"string"==typeof e?(this.name=e,this.factory=void 0,this.loader=void 0):(this.name=e.name,this.factory=e.factory,this.loader=e.loader)}return Object.defineProperty(e.prototype,"key",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"Resource #".concat(this.id,' "').concat(this.name,'"')},e}();Object.defineProperty(p.prototype,"flags",{value:a.none}),Object.defineProperties(p.prototype,f);var m=function(){function e(e,t){this.key=e,this.flags=t}return e.prototype.toString=function(){var e=this.flags;return"".concat(this.key).concat(e&a.async?".async":e&a.suspensible?".suspensible":e&a.lazy?".lazy":"").concat(e&a.local?".local":"").concat(e&a.optional?".optional":"").concat(e&a.bypass?".bypass":"")},e}();Object.defineProperties(m.prototype,f);var _=function(){function e(e){this._value=e,this.dependencies={}}return e.prototype.create=function(){return{instance:this._value}},e}(),h=new p({name:"resources"});function b(e){return e===h}var g=new p({name:"asyncLoadBarrier"}),v=function(){function e(e){this._loader=e,this._cached=void 0}return e.prototype.load=function(){var e=this;return this._cached?this._cached:(this._cached=F(this._loader.load())).then(function(t){return e._loader=void 0,t},function(t){return e._cached=void 0,Promise.reject(t)})},e}(),y=function(){function e(e,t){this.entry=e,this.manager=t,this.instance=void 0}return e.prototype.getInstance=function(e,t){if(this.instance)return this.instance;var n=this.manager,a=this.entry.factory,i=a.create(n.resolve(a.dependencies,t)),r=this.instance=i.instance;return i.disposable&&n.scope.attach(i.disposable),r},e.prototype.promote=function(t){var n=this.entry;return new e({manager:t,loader:n.loader,factory:n.factory})},e}();function S(e,t){var n=function(n){return e.call(this,n,t)||this};return n.prototype=e.prototype,n}function D(e){return e.length<1?" Consumed directly.":Object(i.o)(Object(i.o)([],e,!0),[""],!1).reverse().join("\n  Required by ")}function I(e,t){return new Error("".concat(e," is being consumed, but is not available in the current scope.")+"\n  1) Check to ensure that the dependency on this resource (and each step up the chain) is properly declared."+"\n  2) If availability is expected, check to see if the target resource has a dependency that is only available in a child scope.".concat(D(t)))}function x(e,t){return new Error("".concat(e," is being consumed synchronously, but was exposed asynchronously and has not been loaded. Either:")+"\n  1) Ensure that the root call that is requesting this resource is a consumeAsync(). Or"+"\n  2) Ensure that the dependency on this resource is properly declared, so that it can be picked up by an earlier consumeAsync() or load() call.".concat(D(t)))}function C(e,t){return new Error("".concat(e," is being loaded, but has no factory / loader.Check to ensure that either: ")+"\n  1) ".concat(e," is defined with a 'factory' or 'loader' specified.")+"\n  2) A higher - level component calls 'expose', 'exposeFactory', or 'exposeAsync' for ".concat(e,".").concat(function(e){return e.length<2?" Loaded directly.":Object(i.o)([""],e.slice(1),!0).join("\n  Required by ")}(t)))}function O(e){return{handle:e,error:void 0}}function w(e){return{handle:void 0,error:e}}function E(e){var t=e.flags;return t&a.async?new m(e.key,t&a.notAsync):e}var A=function(){function e(t){var n;if(this._handles={},this._isLocked=!1,this._loader=void 0,t instanceof e){if(t.isDisposed)throw new Error("Parent ResourceScope has already been disposed!");n=t.options,this._parent=t,this._level=t._level+1}else n=t||{},this._parent=void 0,this._level=0;this.scope=new o.e,this.options=n}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0}),e.prototype.block=function(e){return this._expose(e)},e.prototype.isDescendantOf=function(e){return this._level>e._level},e.prototype.getHandle=function(e){for(var t=this,n=e.id;!(n in t._handles)&&t._parent;)t=t._parent;var a=t._handles;return a[n]||this.options.useFactoriesOnKeys&&(e.factory&&(a[n]=new y({factory:e.factory,manager:t}))||e.loader&&(a[n]=new y({loader:new v(e.loader),manager:t})))||void 0},e.prototype.expose=function(e,t,n){return this._expose(e,function(e){return new y({factory:t.factory,loader:t.loader,manager:e},n&&e)})},e.prototype.getLoader=function(){return this._loader?this._loader:(this.lock(),this._loader=new M(this))},e.prototype.dispose=function(){this.scope.dispose(),this._handles={},this._loader=void 0,this.consume=this.resolve=L,this.getLoader=k},e.prototype.bind=function(e){var t=this.getHandle(e);return t?this._expose(e,function(e){return t.promote(e)}):this},e.prototype.lock=function(){this._isLocked=!!this.options.lockResourcesForChildren},e.prototype.consume=function(e,t){var n=this;this.lock();var i,r=e.flags,o=e.key;if(r&a.async){var s,c=E(e),d=function(){return n.consume(c,t)};if(b(o))return function(){return s||(s=Promise.resolve(d()))};if((p=this._getValidHandle(e,a.none,[])).handle)return function(){return s||(s=F(n.getLoader().loadAsync(c,a.none,[],[]).promise).then(d,P(r)))};if(r&a.optional)return function(){return Promise.resolve(void 0)};throw(h=p.error)[0](h[1],h[2])}if(r&a.suspensible){var l,u=function(e){var t=e.flags;return t&a.suspensible?new m(e.key,t&~a.suspensible):e}(e);return{read:function(){if(b(o))return function(){return n.consume(u,t)};var i=n._getValidHandle(e,a.none,[]);if(i.handle)return i.handle.getInstance(o,t||{owner:"".concat(o," ")});var s=i.error;if(s[0]===x){var c=n._getValidHandle(new m(e.key,r|a.async),a.none,[]);if(c.handle)throw l||(l=F(n.getLoader().loadAsync(e,a.none,[],[]).promise).catch(function(){}));var d=c.error;throw d[0](d[1],d[2])}if(!(r&a.optional))throw s[0](s[1],s[2])}}}if(b(o)){var f;i=function(){return f||(f=n.scope.attach(new T(n,t||{owner:"".concat(o," ")}))),f}}else{var p,_=(p=this._getValidHandle(e,a.none,[])).handle;if(_)i=function(){return _.getInstance(o,t||{owner:"".concat(o," ")})};else if(!(r&a.optional)){var h;throw(h=p.error)[0](h[1],h[2])}}return r&a.lazy?i:i&&i()},e.prototype.isExposed=function(e){return!!b(e.key)||!!this._getValidHandle(e,a.none,[]).handle},e.prototype.resolve=function(e,t){for(var n={},a=0,i=Object.keys(e);a<i.length;a++){var r=i[a];e[r]&&(n[r]=this.consume(e[r],t))}return n},e.prototype._getValidHandle=function(e,t,n){var i=e.key,r=i.id;if(n.indexOf(i)>=0)throw new Error("".concat(i," has a circular dependency.").concat(D(n)," "));var o=this._handles[r];if(o&&o.manager)return O(o);var s=this.getHandle(i);if(!s)return w([I,e,n]);var c=e.flags|t,d=s.entry,l=d.factory;if(c&a.async&&d.loader)return O(s);if(!l)return w([x,e,n]);for(var u=n.push(i)-1,f=s.manager,p=c&a.local?this:f||d.manager,m=l.dependencies||{},_=0,h=Object.keys(m);_<h.length;_++){var g=m[h[_]];if(g&&!b(g.key)){var v=this._getValidHandle(g,c&a.handleViral,n),S=v.handle;if(S){var C=S.manager||S.entry.manager;C.isDescendantOf(p)&&(p=C)}else if(!(g.flags&a.optional)||v.error[0]===x&&this.options.errorOnOptionalAsyncOnly)return v}}return n.splice(u),f&&f===p||(s=new y(d,p),p._handles[r]=s),this._handles[r]=s,O(s)},e.prototype._expose=function(t,n){if(this.isDisposed)throw new Error("Cannot expose a resource on a ResourceScope that has been disposed.");if(b(t))throw new Error("It is invalid to expose `resourceScopeKey`");var a=t.id,i=this._isLocked?this.scope.attach(new e(this)):this,r=i._handles;if(r[a]&&this.options.noDoubleExpose)throw new Error("".concat(t," has already been exposed / consumed at this scope."));return r[a]=n?n(i):void 0,i},e}();function L(e){if(e instanceof m||e instanceof p)throw new Error("Cannot consume ".concat(e," from a disposed ResourceScope."));throw new Error("Cannot resolve resources from a disposed ResourceScope.")}function k(){throw new Error("Cannot load a resource from a ResourceScope that has been disposed.")}var M=function(){function e(e){this._handleManager=e,this._loadState={},this._root=e.consume(g.optional)}return e.prototype.loadAsync=function(e,t,n,a){if(b(e.key))return{bypass:H,promise:Promise.resolve(void 0)};var r=this._loadAsync(e,t,Object(i.o)([e],n,!0),a);return{promise:r.promise.catch(P(e.flags,!0)),bypass:r.bypass}},e.prototype.loadAllAsync=function(e,t,n,a){if(e){var i=Object.keys(e),r=i.length;if(r>0){for(var o=[];r--;){var s=e[i[r]];s&&o.push(this.loadAsync(s,t,n,a))}return{bypass:R(function(){for(var e=0,t=o;e<t.length;e++)t[e].bypass()}),promise:Object(c.e)(o.map(function(e){return e.promise}))}}}return{bypass:H,promise:Promise.resolve(void 0)}},e.prototype._loadAsync=function(e,t,n,o){var s=this,c=e.key,l=c.id,u=this._loadState,f=e.flags|t,p=u[l];if(p){if(o&&o.indexOf(c)>=0)throw new Error("".concat(c," has a circular dependency.").concat(D(o)," "));return f&a.bypass&&p.bypass(),p}if(f&a.async)return{bypass:H,promise:Promise.resolve(void 0)};var m=this._handleManager.getHandle(c);if(!m)return u[l]={bypass:H,promise:Promise.reject([C,e,n])};u[l]={bypass:H,promise:Promise.resolve(void 0)};var _=m.entry,h=_.factory;if(h)return u[l]=this.loadAllAsync(h.dependencies,f&a.loaderViral,n,o?Object(i.o)(Object(i.o)([],o,!0),[c],!1):[c]);var b=_.loader;if(!b)return u[l]={bypass:H,promise:Promise.reject([C,e,n])};var g,v=this._root,y=new r.e,S=y.resolve,I=y.reject,x=y.promise;return f&a.bypass||!v?S():v.wait().then(S).catch(I),u[l]={bypass:R(function(){d.e.isActivated("D6B556B6-1D2A-4DC3-A9A2-AC42C0A3127C","06/29/2022","Allow bypass to force-resolve existing loaders")||(f|=a.bypass,S(),g&&g())}),promise:x.then(function(){return b.load()}).then(function(e){_.factory=e;var t=e.dependencies;if(t){var r=s.loadAllAsync(t,f&a.loaderViral,n,o?Object(i.o)(Object(i.o)([],o,!0),[c],!1):[c]);return g=r.bypass,r.promise}})}},e}();function P(e,t){return function(n){if(Array.isArray(n)&&"function"==typeof n[0]){if("number"==typeof e&&e&a.optional)return;if(t)return Promise.reject(n);throw n[0](n[1],n[2])}return Promise.reject(n)}}var T=function(){function e(t,n){var a,i;t instanceof e?(i=t._handleManager,a=t._owner):t instanceof A?i=t:n=t||n;var r=new o.e;if(i){if(i.scope.isDisposed)throw new Error("Parent ResourceScope has already been disposed.");i.lock(),i.options.lockResourcesForChildren||(this._forkOnWrite=!0)}this._handleManager=i||(i=r.attach(new A(n))),this._scope=r;var s=n?n.owner:"";this._owner=a?"".concat(a," > ").concat(s," "):s}return e.prototype.consume=function(e){return this._handleManager.consume(e)},e.prototype.consumeAsync=function(e){var t=this._handleManager,n=E(e);return F(t.getLoader().loadAsync(n,a.none,[],[]).promise).then(function(){return t.consume(n)}).catch(P(n.flags))},e.prototype.load=function(e){return F(this._handleManager.getLoader().loadAllAsync(e,a.none,[],[]).promise).catch(P(a.none))},e.prototype.exposeAsync=function(e,t){this._expose(e,{loader:new v(t)})},e.prototype.exposeFactory=function(e,t){this._expose(e,{factory:t})},e.prototype.expose=function(e,t){return this._expose(e,{factory:new _(t)},t),t},e.prototype.block=function(e){this._handleManager=this._prepareWrite().block(e)},e.prototype.bind=function(e){this._handleManager=this._prepareWrite().bind(e)},e.prototype.isDefined=function(e){var t=this._handleManager;return!t.isDisposed&&!!t.getHandle(e)},e.prototype.isExposed=function(e){var t=this._handleManager;return!t.isDisposed&&t.isExposed(e)},e.prototype.injected=function(t,n){void 0===n&&(n={});var a=n.injectChildResourceScope,i={owner:n.owner||t.name},r=a?this._scope.attach(new e(this,i)):this,o=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.resources=r;var i=t.apply(this,e)||this;return a&&Object(s.e)(i,U),i};return o.prototype=t.prototype,o},e.prototype.resolve=function(e){return this._handleManager.resolve(e)},e.prototype.resolveAsync=function(e){var t=this;return this.load(e).then(function(){return t.resolve(e)})},e.prototype.resolved=function(e,t){return S(e,this.resolve(Object(i.e)(Object(i.e)({},e.dependencies||{}),t||{})))},e.prototype.resolvedAsync=function(e,t){var n=this;return this.load(Object(i.e)(Object(i.e)({},e.dependencies||{}),t||{})).then(function(){return n.resolved(e,t)})},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._expose=function(e,t,n){this._handleManager=this._prepareWrite().expose(e,t,n)},e.prototype._prepareWrite=function(){return this._forkOnWrite?(this._forkOnWrite=!1,this._scope.attach(new A(this._handleManager))):this._handleManager},e}();function U(){this.resources.dispose()}function F(e){var t=new r.e;return e.then(function(e){return t.resolve(e)},function(e){return t.reject(e)}),t.promise}function H(){}function R(e){return function(){if(e){var t=e;e=void 0,t()}}}},,,,function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"s",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"l",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"o",function(){return u}),n.d(t,"h",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"b",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"m",function(){return h}),n.d(t,"i",function(){return b}),n.d(t,"u",function(){return g}),n.d(t,"p",function(){return v}),n.d(t,"d",function(){return y}),n.d(t,"f",function(){return S}),n.d(t,"g",function(){return D}),n.d(t,"_",function(){return I});var a=n(6),i=n(5);function r(e){return h(e)||g(e)||b(e)||v(e)||y(e)||function(e){return e===a.e.officemobileIos||e===a.e.officemobileAndroid}(e)}function o(e){return e===a.e.odb||e===a.e.sharePoint||e===a.e.odc||e===a.e.consumerList||e===a.e.oneup||e===a.e.sharePointPages}function s(e){return e===a.e.consumerList}function c(e){return e===a.e.outlookWeb||e===a.e.outlookWindows||e===a.e.outlookMac||e===a.e.outlookAndroid||e===a.e.outlookiOS}function d(e){return e===a.e.odIos||e===a.e.wordIos||e===a.e.excelIos||e===a.e.visioIos||e===a.e.onenoteIos||e===a.e.powerpointIos||e===a.e.teamsIos||e===a.e.officemobileIos||e===a.e.listsIos||e===a.e.streamIos||e===a.e.loopIos||e===a.e.outlookiOS}function l(e){return e===a.e.odAndroid||e===a.e.wordAndroid||e===a.e.excelAndroid||e===a.e.visioAndroid||e===a.e.onenoteAndroid||e===a.e.powerpointAndroid||e===a.e.teamsAndroid||e===a.e.officemobileAndroid||e===a.e.streamAndroid||e===a.e.outlookAndroid}function u(e){return d(e)||l(e)}function f(e){return o(e)||e===a.e.onenoteWeb||e===a.e.outlookWeb||e===a.e.officecom||e===a.e.teams||e===a.e.sample||e===a.e.outlookGroupsWeb||e===a.e.fluid||e===a.e.odcWac||e===a.e.wac||e===a.e.businesscentral||e===a.e.listPart||e===a.e.listsHome||e===a.e.shareDemo||u(e)}function p(e){return o(e)||e===a.e.listPart||e===a.e.shareDemo}function m(e){return o(e)||e===a.e.officecom||e===a.e.wac||e===a.e.businesscentral}function _(e){return u(e)||S(e)}function h(e){return e===a.e.word||e===a.e.wordAndroid||e===a.e.wordIos}function b(e){return e===a.e.excel||e===a.e.excelAndroid||e===a.e.excelIos}function g(e){return e===a.e.powerpoint||e===a.e.powerpointAndroid||e===a.e.powerpointIos}function v(e){return e===a.e.visio||e===a.e.visioIos||e===a.e.visioAndroid}function y(e){return e===a.e.onenote||e===a.e.onenoteWeb||e===a.e.onenoteUWP||e===a.e.onenoteIos||e===a.e.onenoteAndroid}function S(e){return e===a.e.teams||e===a.e.teamsIos||e===a.e.teamsAndroid}function D(e){return e===a.e.odc||i.R()&&e===a.e.odcWac}function I(e){return e===a.e.word||e===a.e.excel||e===a.e.powerpoint||e===a.e.ngsc||e===a.e.visio||e===a.e.windowsShare}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"n",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"i",function(){return f});var a=n(0),i=(n(86),n(60),n(219),n(7)),r=(n(28),n(8),n(66),n(136),n(69),n(89));n(127);var o,s=n(1),c=n(462);function d(e){var t;switch(e){case 2:case 9:t="files";break;case 3:t="doclib";break;case 4:t="sync";break;case 12:case 41:case 42:t="list";break;default:t=void 0}return t}function l(e,t,n,i){var r=e?Object(a.e)({},e):null,d=n;switch(t){case o.generic:case o.render:r.error=d.message,r.errorCategory=c.e.generic,r.errorMessage=s.Qs,r.rawError=n,r.debugErrorMessage=i?i.toString():(d.stack?d.stack:d.toString()).substring(0,1024);break;case o.api:if(!e){var l=c.t.generic,u=null==n?void 0:n.code,f=null==n?void 0:n.status,p=s.sn,m=JSON.stringify(n||{});u?u.indexOf("-2147024809")>-1&&m&&m.indexOf("Item does not exist")>-1&&(l=c.t.invalidItem):f&&parseInt(f,10)>=500&&(l=c.t.serverFailure),r={error:l,errorCategory:c.e.getSharingInformation,errorMessage:p,debugErrorMessage:m,rawError:n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0}}}return r}function u(e){var t,n=e.customerPromise,i=e.rawErrorMessage,s=e.engagementExtraData,c=e.errorType,d=e.sharingStore;if(n){var l=i,u=Object(r.e)(l);n.end({resultType:u.resultType,errorCode:(t=u.resultCode,t&&t.split(",").join("_")),extraData:Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},null==d?void 0:d.getEngagementHelper().getEngagementExtraData()),s),u.extraData),{error:u.error,rawErrorMessage:i,errorType:c||o.generic})})}}function f(e){var t=e.customerPromise,n=e.engagementExtraData,r=e.sharingStore;t&&t.end({resultType:i.t.Success,extraData:Object(a.e)(Object(a.e)({},null==r?void 0:r.getEngagementHelper().getEngagementExtraData()),n)})}!function(e){e[e.render=0]="render",e[e.api=1]="api",e[e.generic=2]="generic"}(o||(o={}))},,,function(e,t,n){"use strict";n.d(t,"t",function(){return g});var a=n(150),i=n(3),r=n(29),o=n(230),s=i.e.isActivated("26b61085-e68c-4a13-a8de-ae84ba2d96d2","1/16/2023","Validate if window object is present or not"),c={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},d={ODB:357,ODC:null,Fallback:!1},l={ODB:342,ODC:null,Fallback:!1},u={ODB:60763,ODC:"AllowFeatureOverrides",Fallback:!1},f="FeatureOverrides",p={},m="".concat(f,"_").concat("enableFeatures"),_="".concat(f,"_").concat("disableFeatures");function h(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function b(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(m,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(_,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function g(){if(p){for(var e=[],t=0,n=Object.keys(p);t<n.length;t++){var a=n[t];e.push(p[a]?a:"!".concat(a))}return e.join(",")}}function v(e,t,n,a){if(t)for(var i=0,r=t.split(",");i<r.length;i++)e[l=r[i]]=!0;if(n)for(var o=0,s=n.split(",");o<s.length;o++)e[l=s[o]]=!1;if(a)for(var c=0,d=a.split(",");c<d.length;c++){var l;"!"===(l=d[c])[0]?e[l.slice(1)]=!1:e[l]=!0}return e}var y=function(){function e(){}return Object.defineProperty(e,"Overrides",{get:function(){return p},enumerable:!1,configurable:!0}),e.evaluateCanOverride=function(){s||"undefined"!=typeof window?e.CanOverride=r.e.isFeatureEnabled(c)||r.e.isFeatureEnabled(d)||r.e.isFeatureEnabled(l)||r.e.isFeatureEnabled(u)||!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode):e.CanOverride=!1},e.isFeatureEnabled=function(t,n){return e._isFeatureEnabled(t,n)},e._isFeatureEnabled=function(t,n){if(e.CanOverride){if(t.ODB in p)return p[t.ODB];if(t.ODC in p)return p[t.ODC]}return n?Object(o.e)(t,n):r.e.isFeatureEnabled(t)},e.AllowFeatureOverrides=c,e.SPODebugOnlyCookieRedirect=d,e.ClientDebugFeatureOverrides=u,e}();t.e=y,y.evaluateCanOverride(),y.CanOverride&&function(){p=v({},h(m),h(_),void 0);var e=location.search?location.search.substring(1):"",t=Object(a.e)(e),n=t.enableFeatures,i=t.disableFeatures,r=t.debugFlights;v(p,n,i,r),b(p);try{window.__debugSetFeature=function(e,t){void 0===t&&(t=!0),p[e]=!!t,b(p)}}catch(e){}}()},function(e,t,n){"use strict";var a=n(160);t.e=a.e},function(e,t,n){"use strict";n.d(t,"t",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"I",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"v",function(){return v}),n.d(t,"u",function(){return y}),n.d(t,"S",function(){return S}),n.d(t,"x",function(){return D}),n.d(t,"o",function(){return I}),n.d(t,"e",function(){return x}),n.d(t,"_",function(){return C}),n.d(t,"m",function(){return O}),n.d(t,"h",function(){return E}),n.d(t,"C",function(){return A}),n.d(t,"g",function(){return L}),n.d(t,"y",function(){return k}),n.d(t,"b",function(){return M}),n.d(t,"p",function(){return P}),n.d(t,"c",function(){return T}),n.d(t,"r",function(){return U}),n.d(t,"s",function(){return F}),n.d(t,"d",function(){return H}),n.d(t,"f",function(){return R}),n.d(t,"a",function(){return N}),n.d(t,"D",function(){return B}),n(0);var a=n(6),i=n(205),r=n(56),o=n(115),s=n(7),c=n(10),d=(n(67),n(5)),l=n(89),u=n(127),f=n(49),p=!1;function m(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function _(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function h(e,t){try{window.external.ShareCompleted(e)}catch(a){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function b(e){var t=!1,n=!1,a=new s.e({name:"sharingCopyToClipboardInterop"});try{var i=window.external;n=!i.CopyToClipboard,n=(t=i.CopyToClipboard(e))||void 0===t,a.end({resultType:s.t.Success})}catch(e){var r=new f.e({code:"windowExternalCopyToClipboardError",innerError:e});a.end(Object(u.e)(Object(l.e)(e),{resultCode:r.code}))}return n}function g(){var e=!1;try{e=window.external.IsSendCopyEnabled()}catch(e){}return e}function v(){try{window.external.SendCopy()}catch(e){}}function y(){var e=!1;try{e=window.external.IsSendPdfEnabled()}catch(e){}return e}function S(){try{window.external.SendPdf()}catch(e){}}function D(e,t,n){var a=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,a,n)}catch(i){var r={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:a,body:n};window.parent.postMessage(JSON.stringify(r),"*")}}function I(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function x(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(a){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function C(e,t,n,r,o,c){p?function(e,t,n,r,o,c){var d=a.e[t]||"unknown";new s.e({name:"ShareV3.".concat(i.e[n],".AfterPageLoad"),startTimeOverride:e||void 0}).end({resultType:o?s.t.Failure:s.t.Success,extraData:{clientId:d,scenario:r,isError:!!o,correlationId:c,error:o}})}(e,t,n,r,o.isStubFile?"file uploading":o.errorMessage||"unknown error",c):(w(e,t,n,r,o.errorMessage||"unknown error",c),p=!0);try{window.external.PageError(o.error,o.errorCategory,o.errorMessage,o.debugErrorMessage)}catch(e){var d={name:"share_error",error:o.error,errorCategory:o.errorCategory,errorMessage:o.errorMessage,debugErrorMessage:o.debugErrorMessage};window.parent.postMessage(JSON.stringify(d),"*")}}function O(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function w(e,t,n,r,o,c){if(e){var d=a.e[t]||"unknown";new s.e({name:"ShareV3.".concat(i.e[n],".PageLoaded"),startTimeOverride:e}).end({resultType:o?s.t.Failure:s.t.Success,extraData:{clientId:d,scenario:r,isError:!!o,correlationId:c,error:o}})}}function E(e,t,n,a,i){if(p){w(e,t,n,a,void 0,i),r=new s.e({name:"Sharing.post_share_ready_instant_load"});try{o={name:"share_instantLoadReady"},window.parent.postMessage(JSON.stringify(o),"*"),r.end({resultType:s.t.Success})}catch(e){r.end({resultType:s.t.Failure,resultCode:"post_share_ready_instant_load_failure"})}}else{w(e,t,n,a,void 0,i);try{window.external.PageFinishedLoading(),new s.e({name:"Sharing.post_webview_share_ready"}).end({resultType:s.t.Success})}catch(e){var r=new s.e({name:"Sharing.post_iframe_share_ready"});try{var o={name:"share_ready"};window.parent.postMessage(JSON.stringify(o),"*"),r.end({resultType:s.t.Success})}catch(e){r.end({resultType:s.t.Failure,resultCode:"post_share_ready_failure"})}}p=!0}}function A(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function L(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function k(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function M(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function P(e,t,n,a){var i,o=Object(c.v)(a,e,n),s=Object(c.S)(e,t,a,n),l=Object(d.Z)()?Object(c.M)(e.sharingLinkKind):Object(c.A)(e.audience),u=Object(c.P)(e.status),f=e.audience===r.e.existing?"00000000-0000-0000-0000-000000000000":e.shareId,p=!1;try{window.external.LinkSettingsCompleted(f,e.url,o,s,l),p=!0}catch(e){}var m={id:f,expirationDateTime:null===(i=e.expiration)||void 0===i?void 0:i.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:s,webUrl:e.url,scope:l,customLabeledAudience:e.audience===r.e.customLabeledSpecificPeople,status:u,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(m)),p=!0}catch(e){}if(!p){var _={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:f,linkUrl:e.url,iconUrl:o,linkDescription:s,scope:l,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===r.e.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(_),"*"),window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:m}),"*")}}function T(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function U(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function F(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}function H(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}}function R(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}}function N(){try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return o.e.none}}function B(e,t,n,a){try{window.external.SendViaOutlookWithContext(e,t,n,a)}catch(e){}}},function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(a||(a={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(i||(i={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(r||(r={}))},,function(e,t,n){"use strict";var a,i=n(35),r=n(3);!function(e){e[e.scheme=0]="scheme",e[e.authority=1]="authority",e[e.path=2]="path",e[e.query=3]="query"}(a||(a={}));var o=/[;\/?:@&=$,]/,s=/[\/?]/;function c(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n].toLowerCase());return t}var d=function(){function e(e,t){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",t&&(this._queryCaseInsensitive=!!t.queryCaseInsensitive,this._pathCaseInsensitive=!!t.pathCaseInsensitive),this._isCatchParsePathDecodeExceptionKSActive=r.t.isActivated("e759149e-00c5-412d-bc6d-d63d0bb5fe84","08/24/2022","Catch decoding errors while parsing the URI path"),this._isMailtoPathSlashFixingKSActive=r.t.isActivated("ec2e96a7-d77c-4fb3-addd-1c430d6985b3","11/22/2022","Avoid adding slash prefix for mailto schema"),this._parseURI(e)}return e.concatenate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var a="",i=0;i<t.length;i++){var r=t[i];i>0&&(r=e.ensureNoPrecedingSlash(r)),i<t.length-1&&(r=e.ensureTrailingSlash(r)),a+=r}return a},e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e},e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e},e.prototype.getScheme=function(){return this._scheme},e.prototype.setScheme=function(e){this._scheme=e},e.prototype.getAuthority=function(){return this._getAuthority(!1)},e.prototype.setAuthority=function(e){this._parseAuthority(e)},e.prototype.getUser=function(){return this._user},e.prototype.getHost=function(){return this._host},e.prototype.getPort=function(){return this._port},e.prototype.getPath=function(e){var t=this._path;return Boolean(e)&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1)),t},e.prototype.getLeftPart=function(e){var t=this._scheme+"://";return e===a.authority&&(t+=this.getAuthority()),e===a.path&&(t+=this.getPath()),e===a.query&&(t+=this.getQuery()),t},e.prototype.setPath=function(e){this._isMailtoPathSlashFixingKSActive?e&&"/"!==e[0]&&(e="/"+e):"mailto"!==this.getScheme().toLowerCase()&&e&&"/"!==e[0]&&(e="/"+e),this._parsePath(e)},e.prototype.getPathSegments=function(){return this._pathSegments},e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""},e.prototype.getQuery=function(e){return this._serializeQuery(e)},e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))},e.prototype.getQueryAsObject=function(){return this._query},e.prototype.setQueryFromObject=function(e){for(var t in this._query={},e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])},e.prototype.getQueryParameter=function(e){var t=null,n=this._query;if(this._queryCaseInsensitive)for(var a in e=e.toLowerCase(),n)n.hasOwnProperty(a)&&a.toLowerCase()===e&&(t=n[a]);else t=n[e];return t||null},e.prototype.setQueryParameter=function(e,t,n){void 0===n&&(n=!0);var a=this._decodeQueryString(t);(a||n)&&(this._query[this._decodeQueryString(e)]=a)},e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]},e.prototype.getFragment=function(){return this._fragment},e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1)),this._fragment=this._decodeQueryString(e)},e.prototype.equals=function(e){return Object(i.t)(this._scheme,e.getScheme())&&this._user===e.getUser()&&Object(i.t)(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)},e.prototype.equivalent=function(e){return Object(i.t)(this._scheme,e.getScheme())&&Object(i.t)(this._user,e.getUser())&&Object(i.t)(this._host,e.getHost())&&Object(i.t)(this._port,e.getPort())&&Object(i.t)(this.getPath(!0),e.getPath(!0))&&(t=c(this.getQueryAsObject()),n=c(e.getQueryAsObject()),a=[],r=[],o=function(e,t){return e===t},function e(t,n){if(t===n)return!0;if(null===t||null===n)return!1;if("object"!=typeof t||"object"!=typeof n)return!1;var i=Object.keys(t).sort(),s=Object.keys(n).sort();return i.length===s.length&&!!i.every(function(i,c){if(i!==s[c])return!1;if("function"==typeof t[i]||"function"==typeof n[i])return!0;if(o(t[i],n[i]))return!0;if("object"==typeof t[i]){if(-1!==a.indexOf(t[i]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(i));if(a.push(t[i]),-1!==r.indexOf(n[i]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(n,", ")+"property: ".concat(i));return r.push(n[i]),!!e(t[i],n[i])&&(a.pop(),r.pop(),!0)}return!1})}(t,n))&&Object(i.t)(this._fragment,e.getFragment());var t,n,a,r,o},e.prototype.toString=function(e){return this._getStringInternal(!0,e)},e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)},e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)},e.prototype._equalsCaseAppropriate=function(e,t,n){return n?Object(i.t)(e,t):e===t},e.prototype._getStringInternal=function(e,t){var n=this._getStringWithoutQueryAndFragmentInternal(e,t),a=this.getQuery(e);return a&&(n+="?"+a),this._fragment&&(n+="#"+(e?encodeURIComponent(this._fragment):this._fragment)),n},e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var n="";this._scheme&&(n+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var a=this._getAuthority(e,t);return a&&(n+="//"+a),this._pathEncoded&&(n+=e?this._pathEncoded:this._path),n},e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=0,a=e.split(/[;&]+/);n<a.length;n++){var i=a[n],r=i.indexOf("=");r<0&&(r=i.length),r>0&&(t[i.substr(0,r)]=i.substr(r+1))}return t},e.prototype._serializeQuery=function(e){var t="";for(var n in this._query)if(this._query.hasOwnProperty(n)){var a=n,i=this._query[n];e&&(a=encodeURIComponent(a),i=encodeURIComponent(i)),t+=null===i||""===i?a+"=&":a+"="+i+"&"}return""!==t&&(t=t.slice(0,-1)),t},e.prototype._parseURI=function(e){var t=e,n=t.indexOf("#");if(n>=0){var a=t.substring(n+1);this.setFragment(a),t=t.substring(0,n)}var i=t.search(o);if(i>=0){":"===t[i]&&(this.setScheme(t.substring(0,i)),t=t.substring(i+1));var r="";if(0===t.indexOf("//")){var c=(t=t.substring(2)).search(s);if(c>=0?(r=t.substring(0,c),t=t.substring(c)):(r=t,t=""),this.setAuthority(r),!t)return void this.setPath("")}var d=t.indexOf("?");d>=0&&(this.setQuery(t.substring(d+1)),t=t.substring(0,d)),this.setPath(t)}else this.setPath(t)},e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var n=this._host.indexOf(":");if(!(t<0&&n<0)){var a=e;t<0?this._host=a:(this._user=a.substring(0,t),this._host=a.substring(t+1)),n>=0&&(this._port=this._host.substring(n+1),this._host=this._host.substring(0,n)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host)}},e.prototype._parsePath=function(e){if(this._isCatchParsePathDecodeExceptionKSActive)this._path=decodeURIComponent(e);else try{this._path=decodeURIComponent(e)}catch(t){this._path=e}var t=this._pathSegments=[];this._pathEncoded=e;for(var n=e.split("/"),a=0;a<n.length;++a)if(this._isCatchParsePathDecodeExceptionKSActive)t[a]=decodeURIComponent(n[a]);else try{t[a]=decodeURIComponent(n[a])}catch(e){t[a]=n[a]}""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()},e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var n,a,i,r=t&&t.doNotPercentEncodeHost,o="";return e?(n=encodeURIComponent(this._user).replace("%3A",":"),a=r?this._host:encodeURIComponent(this._host),i=encodeURIComponent(this._port)):(n=this._user,a=this._host,i=this._port),""!==n&&(o=n+"@"),""!==this._host&&(o+=a),""!==this._port&&(o+=":"+i),o},e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t},e}();t.e=d},function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory"}(a||(a={})),t.e=a},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}))},function(e,t,n){"use strict";var a,i,r,o,s,c=n(230),d=!1;function l(){var e;a=window.PageContext;var t=window.Flight;i=t&&t.Ramps,r=window.FilesConfig;var n=window.Flighting,c=window._spPageContextInfo;s=null===(e=window.Flight)||void 0===e?void 0:e.ecsRolloutsEnabled,!o&&c&&(!c.ExpFeatures&&n&&n.ExpFeatures&&(c.ExpFeatures=n.ExpFeatures),u.initSPExpFeatures(c.ExpFeatures)),d=!0}var u=function(){function e(){}return e.initSPExpFeatures=function(e){o=e},e.isFeatureEnabled=function(e){d||l();var t=!!e.Fallback,n=e.ODB,u=e.ODC,f=e.ECS,p=e.OneDrive;return void 0!==n&&o&&(t=Object(c.e)(e,o)),void 0!==u&&r&&("boolean"==typeof u?t=u:(i&&i[u]||r&&r[u])&&(t=!0)),void 0!==f&&s&&s.indexOf(f)>=0&&(t=!0),void 0!==p&&a&&(t=p),t},e.On={Fallback:!0},e.Off={},e}();t.e=u},function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"r",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _});var a,i,r,o,s,c=n(98),d=n(5);function l(e){a=Object(c.t)(90076,e),i=Object(c.t)(90022,e),r=Object(c.t)(90128,e),o=Object(c.t)(90058,e),s=Object(c.t)(90167,e)}function u(){try{if(sessionStorage.getItem("simplifiedSharingDialog"))return parseInt(sessionStorage.getItem("simplifiedSharingDialog"))}catch(e){}return!s||d.te()?0:d.ee()?1:(s.logExposure(),s.variantToDisplay)}function f(){try{if(sessionStorage.getItem("externalSharingConfirmationDialog"))return parseInt(sessionStorage.getItem("externalSharingConfirmationDialog"))}catch(e){}return o&&d.p()?(o.logExposure(),o.variantToDisplay):0}function p(){return a&&d.ne()?(a.logExposure(),a.variantToDisplay):0}function m(){return i&&d.q()?(i.logExposure(),i.variantToDisplay):0}function _(){return d.j()&&r?(r.logExposure(),r.variantToDisplay):0}},function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(a||(a={})),t.e=a},,,,function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"i",function(){return d});var a=/\{(\d+)\}/g;function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(a,function(e,n){var a=t[Number(n)];return null===a?"":"".concat(a)})}function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i,r=[],o=0;i=a.exec(e);){var s=i[0],c=parseInt(s.replace(/\{|\}+/g,""),10),d=t[c];i.index>o&&r.push(e.substring(o,i.index)),o=a.lastIndex,r.push(d)}return o!==e.length&&r.push(e.substring(o,e.length)),r}function o(e,t){for(var n=e.toString();n.length<t;)n="0".concat(n);return n}function s(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t}function c(e){return e?e[0].toUpperCase()+e.substr(1):e}function d(e,t,n){if(n=Number(n),void 0===e||void 0===t||void 0===n)return"";for(var a="",i=-1,r=t.split("||"),o=0,s=r.length;o<s;o++){var c=r[o];if(c){for(var d=0,l=c.split(",");d<l.length;d++){var u=l[d];if(u)if(isNaN(Number(u))){if(-1!==u.indexOf("-")){var f=u.split("-");if(2!==f.length)continue;var p=void 0,m=void 0;if("*"===u[0]){var _=f[0].substring(1),h=f[1];if(isNaN(Number(_))||isNaN(Number(h)))continue;p=parseInt(_,10),m=parseInt(h,10);for(var b=void 0,g=p;g<=m;g++){var v="[0-9]*"+g;if(new RegExp("^".concat(v,"$")).test(n.toString())){b=!0;break}}if(b){i=o;break}}else{if(""===f[0])p=0;else{if(isNaN(Number(f[0])))continue;p=parseInt(f[0],10)}if(n>=p){if(""===f[1]){i=o;break}if(isNaN(Number(f[1])))continue;if(n<=(m=parseInt(f[1],10))){i=o;break}}}}else if(-1!==u.indexOf("*")&&(v=u.trim().replace(/\*/g,"[0-9]*"),new RegExp("^".concat(v,"$")).test(n.toString()))){i=o;break}}else if(n===parseInt(u,10)){i=o;break}}if(-1!==i)break}}if(-1!==i){var y=e.split("||");y[i]&&(a=y[i])}return a}},,,,,,function(e,t,n){"use strict";var a=n(86);t.e=a},function(e,t,n){"use strict";var a=function(){function e(){}return e.encodeURIComponent=function(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i},e.escapeUrlForCallback=function(t){var n=t.indexOf("#"),a=t.indexOf("?");if(n>0&&(-1===a||n<a)){var i=t.substr(0,n);a>0&&(i+=t.substr(a)),t=i}return e.encodeURIComponent(t,!0,!1,!0)},e.encodeRestUriStringToken=function(t){return t&&(t=(t=t.replace(/'/g,"''")).replace(/%27/g,"%27%27"),t=e.encodeURIComponent(t)),t},e}();t.e=a},function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"s",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"f",function(){return _}),n.d(t,"u",function(){return h}),n.d(t,"p",function(){return b});var a=n("react-lib"),i=a.lazy(function(){return n.ee([22],409)}),r=a.lazy(function(){return n.ee([15],410)}),o=a.lazy(function(){return n.ee([20],408)}),s=a.lazy(function(){return n.ee([26],397)}),c=a.lazy(function(){return n.ee([28],411)}),d=a.lazy(function(){return n.ee([23],386)}),l=a.lazy(function(){return n.ee(6,407)}),u=a.lazy(function(){return n.ee([16],414)}),f=a.lazy(function(){return n.ee([21],412)}),p=a.lazy(function(){return n.ee([25],415)}),m=a.lazy(function(){return n.ee([24],405)}),_=a.lazy(function(){return n.ee([27],416)}),h=a.lazy(function(){return n.ee([29],413)}),b=a.lazy(function(){return n.ee([19],417)})},,function(e,t,n){"use strict";var a=n(27),i=function(){function e(t,n){void 0===n&&(n=a.e.none),e.init(),this.dataStoreKey=t,this.defaultCachingType=n,n===a.e.none?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}return e.hasStorageType=function(t){switch(e.init(),t){case a.e.none:case a.e.sharedMemory:return!0;case a.e.session:return!!e._sessionStorage;case a.e.local:return!!e._localStorage;default:return!1}},e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}},e.testStorage=function(e){var t="BrowserStorageTest",n=!1;try{e.setItem(t,"1"),"1"===e.getItem(t)&&(n=!0),e.removeItem(t)}catch(e){}return n},e.prototype.setValue=function(e,t,n,a){void 0===a&&(a=!0),e=a?this.normalizeKey(e):e,this.dataStore[e]=t;var i=this.getStorage(n);if(i)try{var r=[],o=JSON.stringify(t,function(e,t){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t});r=null,i.setItem(this.dataStoreKey+e,o)}catch(e){}},e.prototype.getValue=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=!1),e=n?this.normalizeKey(e):e;var i=this.dataStore[e],r=this.getStorage(t);if((void 0===i||a)&&r){var o=r.getItem(this.dataStoreKey+e);if(o)try{i=JSON.parse(o),this.dataStore[e]=i}catch(e){i=void 0}}return i},e.prototype.remove=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var a=this.getStorage(t);a&&a.removeItem(this.dataStoreKey+e),delete this.dataStore[e]},e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case a.e.none:case a.e.sharedMemory:return null;case a.e.session:return e._sessionStorage;case a.e.local:return e._localStorage;default:return null}},e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""},e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,e}();t.e=i},function(e,t,n){"use strict";n.d(t,"r",function(){return h}),n.d(t,"o",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"e",function(){return v}),n.d(t,"t",function(){return y}),n.d(t,"n",function(){return S}),n.d(t,"a",function(){return D}),n.d(t,"s",function(){return I});var a=n(117),i=n(56),r=n(177),o=n(370),s=n(372),c=n(24),d=n(35),l=n("react-lib"),u=n(366),f=n(1),p=n(31),m=n(5),_=["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"];function h(e){return _.indexOf(e)>-1}function b(e){var t,n;return!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function g(e){var t,n;return!(!(null==e?void 0:e.isExternal)||"GUEST_USER"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function v(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===c.e.externalUser}).length:0}function y(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===c.e.linkedinUser}).length:0}function S(e){var t,n=e.filter(function(e){return e.entityType===c.e.externalUser}),a=n.length,i=n.map(function(e){return e.name});if(2===a){var r=(t=i.join(", ")).lastIndexOf(",");return"".concat(t.substring(0,r)," ").concat(f.A," ").concat(t.substring(r+1)," ").concat(f.Ya)}return a>2?(r=(t=i.join(", ")).lastIndexOf(","),"".concat(t.substring(0,r+1)," ").concat(f.A," ").concat(t.substring(r+1)," ").concat(f.Ya)):1===a?"".concat(i[0]," ").concat(f.Ja):""}function D(e,t){var n=e.filter(function(e){return e.entityType===c.e.group}).length,a="";return 1===n?a=f.za:n>1&&(a=d.n(f.ia,n)),t>=1e3?a+=" ".concat(f.pn):t>=25&&(a+=" ".concat(d.n(f.fn,t))),a}function I(e){var t,n,_,h=e.selectedItems,b=e.sharingLinkKind,v=e.canAddExternalPrincipal,y=e.sharingInformation,S=e.viewPolicyTipCallback,D=e.permissionsMap,I=e.setSharingByCopyIsDisabled,x=e.scope,C=l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},f.wr," "),l.createElement(u.e,{onClick:S},f.jr)),O=y.item.hasDlpPolicy||y.sharingAbilities&&y.sharingAbilities.directSharingAbilities&&y.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===a.e.documentIsProtectedByDlp,w=!1,E=!1,A=e.audience;if(y.sharingAbilities&&e.audience&&h&&h.length)switch(A){case i.e.specificPeople:case i.e.specificPeopleFlex:y.sharingAbilities.peopleSharingLinkAbilities&&y.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals&&(w=y.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.e.loopFilesExternalSharingNotSupported,E=y.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.e.blockedByWhoCanShareSettings);break;case i.e.anyone:y.sharingAbilities.anyoneLinkAbilities&&y.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals&&(w=y.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.e.loopFilesExternalSharingNotSupported,E=y.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.e.blockedByWhoCanShareSettings);break;case i.e.organization:y.sharingAbilities.organizationLinkAbilities&&y.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals&&(w=y.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.e.loopFilesExternalSharingNotSupported,E=y.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.e.blockedByWhoCanShareSettings)}for(var L=0,k=h;L<k.length;L++){var M=k[L];if(!M.isResolving&&!M.isResolved)return O&&!v?C:w&&M.isExternal?l.createElement("span",{role:"alert","aria-live":"assertive"},f.Nn):M.rawData?(t=M.rawData,n=y.customizedExternalSharingServiceUrl,void 0,0===(_=t.EntityData&&t.EntityData.BlockingSharingPolicy||0)||607===_?l.createElement("span",{role:"alert","aria-live":"assertive"},t.Description):_>=401&&_<=404?n?l.createElement("div",{role:"alert","aria-live":"assertive"},d.a(f.Vt,l.createElement("a",{href:n,target:"_blank"},f.ua))):l.createElement("span",{role:"alert","aria-live":"assertive"},f.jt):_>=200&&_<=209||_>=301&&_<=305?n?l.createElement("div",{role:"alert","aria-live":"assertive"},d.a(f.Wt,l.createElement("a",{href:n,target:"_blank"},f.ua))):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Kt):_>=600&&_<=603?n?l.createElement("div",{role:"alert","aria-live":"assertive"},d.a(f.Zo,l.createElement("a",{href:n,target:"_blank"},f.ua))):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Xo):void 0):l.createElement("span",{role:"alert","aria-live":"assertive"},f.la);if(M.isExternal&&O&&!v)return C;if(M.isExternal&&!v&&!g(M)||M.isExternal&&E)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ri);if(M.isExternal&&M.principalType===p.e.distributionList&&M.entityType===c.e.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Hi);var P=m.se()?b===r.e.organizationEdit||b===r.e.organizationView:x===o.e.organization;if(M.isExternal&&P)return I&&I(!0),l.createElement("span",{role:"alert","aria-live":"assertive"},f.Fi)}if(D&&b===r.e.direct){var T=0;for(var U in D)D[U]===s.e.none&&T++;var F="";1===T?F=f.bn:T>1&&(F=f.gn);var H=e.onShareHintClick?l.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:function(){return e.onShareHintClick()},href:"javascript:void(0)"},f.Ie):void 0;if(F)return l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},F),H)}return y.peoplePickerError?l.createElement("span",{role:"alert","aria-live":"assertive"},y.peoplePickerError):null}},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"r",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"a",function(){return u});var a=window.performance,i=void 0!==typeof a&&!!a&&"function"==typeof a.mark&&"function"==typeof a.clearMarks&&"function"==typeof a.now,r="EUPL.",o=0,s=window._perfMarks=window._perfMarks||[];function c(e,t){var n=f(e);(null==t||o<t)&&(i?a.mark(n):s.push({name:n,startTime:Date.now()}),o++)}function d(e,t){void 0===t&&(t=!0);var n=t?f(e):e;if(i){var r=a.getEntriesByName(n,"mark");return r&&r.length>0?Math.round(r[0].startTime):NaN}var o=s.filter(function(e){return e.name===n})[0];return o&&o.startTime}function l(e){var t=[];e&&(t=e.map(f)),i?a.getEntriesByType("mark").filter(function(e){return t.length>0?t.indexOf(e.name)>=0:0===e.name.lastIndexOf(r,0)}).forEach(function(e){a.clearMarks(e.name)}):s=[]}function u(){return i?a.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(r,0)}):s}function f(e){return 0===e.lastIndexOf(r,0)?e:r+e}},function(e,t,n){"use strict";var a=n(61);t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error));var r=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError,r=t.wrapErrorCode,o=i||void 0,s=o?Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"boolean"==typeof o.isExpected?{isExpected:o.isExpected}:{}),"string"==typeof o.name?{code:o.name}:{}),"string"==typeof o.code?{code:o.code}:{}),"object"==typeof o.extraData?{extraData:o.extraData}:{}):{},c=t.correlationId,d=void 0===c?s.correlationId:c,l=t.isExpected,u=void 0===l?s.isExpected:l,f=t.extraData;return n.correlationId=d,n.isExpected=!!u,n.code=r&&s.code&&t.code&&"".concat(t.code," (").concat(s.code,")")||t.code||s.code||"",n.extraData=Object(a.e)(Object(a.e)({},s.extraData||{}),f||{}),n}return Object(a.a)(t,e),t}(i)},function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.Error=2]="Error"}(a||(a={})),function(e){e[e.UnshareLink=0]="UnshareLink",e[e.ShareLink=1]="ShareLink",e[e.FetchSharingInformation=2]="FetchSharingInformation"}(i||(i={}))},function(e,t,n){"use strict";var a=n(122),i=n(11),r=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this.resources,r=void 0===n?t.resources?new i.n(t.resources):e.resources:n;this.resources=r,this._Component_scope=new a.e}return Object.defineProperty(e.prototype,"scope",{get:function(){return this._Component_scope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._Component_scope.dispose()},e.prototype.managed=function(e){return this.resources&&(e=this.resources.injected(e)),this.scope.attached(e)},e.prototype.child=function(e){var t;return t=e instanceof i.t?this.resources.consume(e):this.resources?this.resources.injected(e,{injectChildResourceScope:!0}):e,this.scope.attached(t)},e.dependencies={resources:i.i},e}();t.e=r},function(e,t,n){"use strict";var a=function(){function e(){}return e.invalidate=function(t){"undefined"!=typeof window&&(e.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir"),e.safeLeft=e.isRightToLeft?"right":"left",e.safeRight=e.isRightToLeft?"left":"right",t=t||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName,e.language=t||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us",e.cultureLCID=window._spPageContextInfo&&window._spPageContextInfo.currentCultureName||e.language)},e}();a.invalidate(),t.e=a},,function(e,t,n){"use strict";var a=function(){function e(){this.R=0,this.G=0,this.B=0,this.A=e.maxComponent}return e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)},e.equals=function(e,t){var n=!e,a=!t;return n||a?n&&a:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A},e.fromRgba=function(t,n,a,i){var r=new e;return r.R=Math.round(t),r.G=Math.round(n),r.B=Math.round(a),r.A=null!=i?Math.round(i):e.maxComponent,r},e.fromRgbaString=function(t){var n=new e;if(/^rgb.+/.test(t)){var a=t.match(/[\d.]+/g);n=e.fromRgba(Number(a[0]),Number(a[1]),Number(a[2]),4===a.length?Number(a[3])*e.maxComponent:null)}return n},e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var a=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:a.A=n(t,1,2),a.R=n(t,3,4),a.G=n(t,5,6),a.B=n(t,7,8);break;case 7:a.R=n(t,1,2),a.G=n(t,3,4),a.B=n(t,5,6);break;case 4:a.R=n(t,1,1),a.G=n(t,2,2),a.B=n(t,3,3)}else/^rgb.+/.test(t)&&(a=e.fromRgbaString(t));return a},e.toHtmlString=function(t,n){function a(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var a=n.toString(16);return n<16&&(a="0"+a),a}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?a(t.A):"")+a(t.R)+a(t.G)+a(t.B)},e.maxComponent=255,e}();t.e=a},,function(e,t,n){"use strict";var a;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(a||(a={})),t.e=a},,,function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(0),i=n(382),r=n(32),o=n("react-lib"),s={gapSpace:0},c={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},d=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-".concat(d);d++;var u=n.targetElementId?Object(a.e)(Object(a.e)({},s),{target:"#".concat(n.targetElementId)}):s;return o.createElement(i.e,{id:l,content:t,directionalHint:void 0===n.position?r.e.topCenter:n.position,calloutProps:u,tooltipProps:c,styles:n.styles},e)}function u(e,t,n,a){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!a,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}},function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return f}),n.d(t,"n",function(){return m});var a,i=n(0),r=n(66),o=n(8),s=n(61),c=function(){function e(e,t){e?(this.root=e.root,this.parent=e.current):this.root=this.parent=s.Empty,this.current=t||s.generate()}return e._getCorrelationVector=function(){var t;return"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector),t||new e},e.prototype.toString=function(){return"".concat(this.root,"#").concat(this.parent,"#").concat(this.current)},e.RootVector=e._getCorrelationVector(),e}(),d=n(274);!function(e){e[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}(a||(a={}));var l,u=0;function f(e,t,n,a){Object(d.e)(e,t);var r={};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var c=n[s],l=r[s]="number"==typeof c?{type:c}:c;l.definedInName=t.shortEventName,l.type===o.e.Number&&(l.isMetric=!0)}e.metadata=a?Object(i.e)(Object(i.e)({},a.prototype.metadata),r):r}!function(e){e[e.Consumer=0]="Consumer",e[e.ConsumerAnonymous=1]="ConsumerAnonymous",e[e.Business=2]="Business",e[e.BusinessAnonymous=3]="BusinessAnonymous",e[e.Unknown=4]="Unknown",e[e.ConsumerOnSPO=5]="ConsumerOnSPO"}(l||(l={}));var p=new WeakMap,m=function(){function e(e,t,n){this.context={},this.data={},this.context=Object(i.e)({},this.addContext({})),this.id=u++,this.enabled=this._isEnabled(),n&&(this.parentId=n.id),this.startTime=e&&e.startTimeOverride||r.e.getTime(),this.vector=new c(n?n.vector:c.RootVector),e&&this._setData(e),this._logEvent(t)}return e.enabled=function(){return this.prototype._isEnabled()},e.isTypeOf=function(e){return e.eventName?e.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!e.prototype&&e.prototype.shortEventName===this.prototype.shortEventName},e.withManager=function(e){if(!e||e===r.e)return this;var t=p.get(e);t||(t=new WeakMap,p.set(e,t));var n=t.get(this);if(n)return n;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.a)(t,e),t}(this);return a.prototype.manager=e,n=a,t.set(this,n),n},e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return Object(i.e)(Object(i.e)({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(i.a)(n,e),n.prototype.addData=function(n){var a=Object(i.e)(Object(i.e)({},n),t(n));return Object(i.e)(Object(i.e)({},a),e.prototype.addData.call(this,a))},n}(this);return n},e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return Object(i.e)(Object(i.e)({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(i.a)(n,e),n.prototype.addContext=function(n){var a=Object(i.e)(Object(i.e)({},n),t(n));return Object(i.e)(Object(i.e)({},a),e.prototype.addContext.call(this,a))},n}(this);return n},e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t)}).withData(function(t){return e.prototype.addData(t)}):this},e.prototype.addContext=function(e){return h(this.manager,e,{})},e.prototype.addData=function(e){return e},e.prototype._isEnabled=function(){return!this.samplingFeature||r.e.isFeatureEnabled(this.samplingFeature)},e.prototype._setData=function(e){var t=Object(i.e)(Object(i.e)({},this.addData(this.data)),e);!function(e,t,n,a){for(var i=0,r=Object.keys(n);i<r.length;i++){var o=r[i];o in t&&_(e,n,a,o,t[o])}}(this.manager,this.metadata,t,this.data)},e.prototype._logEvent=function(e){this.manager.logEvent(this,e)},e}();function _(e,t,n,a,i){var r=t[a];switch(typeof r){case"string":var o=e.cleanString(r,a,i);return void(void 0!==o&&(n[a]=o));case"undefined":return;case"object":return void(r&&Object.getPrototypeOf(r)===Object.prototype?n[a]=h(e,r,{}):n[a]=r);default:return void(n[a]=r)}}function h(e,t,n){for(var a=0,i=Object.keys(t);a<i.length;a++)_(e,t,n,i[a]);return n}var b=m.prototype;b.eventName="EventBase,",b.shortEventName="EventBase",b.critical=!1,b.manager=r.e},function(e,t,n){"use strict";function a(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function i(){return crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}n.r(t),n.d(t,"cryptoRandom",function(){return i}),n.d(t,"Empty",function(){return r}),n.d(t,"_guidRegEx",function(){return o}),n.d(t,"generate",function(){return s}),n.d(t,"normalizeLower",function(){return c}),n.d(t,"normalizeUpper",function(){return d}),n.d(t,"normalizeDashes",function(){return l}),n.d(t,"isValidGuid",function(){return u});var r="00000000-0000-0000-0000-000000000000",o=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function s(e){var t=[];t.push(a(8,e)),t.push(a(4,e));var n="4"+a(3,e);t.push(n);var i=a(4,e),r=parseInt(i[0],16);return r&=3,i=(r|=8).toString(16)+i.substr(1),t.push(i),t.push(a(12,e)),t.join("-")}function c(e,t){return void 0===t&&(t=!1),e?f(e.toLowerCase(),t):""}function d(e,t){return void 0===t&&(t=!1),e?f(e.toUpperCase(),t):""}function l(e,t){if(void 0===t&&(t=!1),e){var n=e.replace(/[^A-Fa-f0-9]/g,"");if(32===n.length)return f("".concat(n.slice(0,8),"-").concat(n.slice(8,12),"-").concat(n.slice(12,16),"-").concat(n.slice(16,20),"-").concat(n.slice(20)),t)}return""}function u(e){return!(!e||!o.test(c(e)))}function f(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(41),i=n(174);function r(e){a.e.log(e)}var o=function(){function e(t,n){void 0===n&&(n=r),this._id=e._uniqueId++,this._parent=t,this._onError=n,this._eventRecords=[]}return e.raise=function(e,t,n,a){return i.n(e,t,n,a)},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var a in t)this.on(e,a,t[a],n)},e.prototype.on=function(t,n,a,r){var o=this;if(n.indexOf(",")>-1)for(var s=n.split(/[ ,]+/),c=0;c<s.length;c++)this.on(t,s[c],a,r);else{var d=this._parent,l={target:t,eventName:n,parent:d,callback:a,objectCallback:null,elementCallback:null,useCapture:r},u=t.__events__=t.__events__||{};if(u[n]=u[n]||{count:0},u[n][this._id]=u[n][this._id]||[],u[n][this._id].push(l),u[n].count++,i.t(t)){var f=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!o._isDisposed){try{var i=a.apply(d,t);if(!1===i&&t[0]&&t[0].preventDefault){var r=t[0];r.preventDefault(),e.stopPropagation(r)}}catch(r){o._onError(r)}return i}};l.elementCallback=f,t.addEventListener(n,f,r)}else l.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o._isDisposed)return a.apply(d,e)};this._eventRecords.push(l)}},e.prototype.off=function(e,t,n,a){for(var i=0;i<this._eventRecords.length;i++){var r=this._eventRecords[i];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof a&&a!==r.useCapture)){var o=r.target.__events__,s=o[r.eventName],c=s?s[this._id]:null;c&&(1!==c.length&&n?(s.count--,c.splice(c.indexOf(r),1)):(s.count-=c.length,delete o[r.eventName][this._id]),s.count||delete o[r.eventName]),r.elementCallback&&r.target.removeEventListener&&r.target.removeEventListener(r.eventName,r.elementCallback,r.useCapture),this._eventRecords.splice(i--,1)}}},e.prototype.raise=function(t,n,a){return e.raise(this._parent,t,n,a)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}();t.t=o},function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(0),i=n(199),r=!n(3).e.isActivated("115330F7-9AB5-4692-80AB-7401BE3808AA","03/17/2022","Events are stored in a Circular Buffer instead of an array"),o=function(){function e(){this._handlers=[],this._buffer=r?new i.e(500):new i.t(500),this._featureEnablers=[],this._hasBufferOverflown=!1}return Object.defineProperty(e.prototype,"startDate",{get:function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.startDate.getTime()},enumerable:!1,configurable:!0}),e.prototype.getTime=function(){return(new Date).getTime()},e.prototype.cleanString=function(e){return e},e.prototype.addLogHandler=function(e){var t=this._handlers,n=this._buffer;return t.push(e),n.getAll()},e.prototype.removeLogHandler=function(e){for(var t=this._handlers,n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}},e.prototype.logEvent=function(e,t){var n,i,r=this._buffer,o=this._handlers,s=Object.freeze({data:(n=e.data,i=[],"object"!=typeof n?n:function e(t){var n=null;return t&&(n=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(a){var r=t[a];if("object"==typeof r){if(-1!==i.indexOf(r))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(a));i.push(r),n[a]=e(r),i.pop()}else n[a]=r})),n}(n)),context:Object(a.e)({},e.context),id:e.id,enabled:e.enabled,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled}),c=r.isFull;r.push(s),!this._hasBufferOverflown&&c&&(this._hasBufferOverflown=!0,0===o.length&&d(new Error("Logging buffer overflow hit before any logging handler was registered")));for(var l=0;l<o.length;l++)try{o[l](s)}catch(e){d(e)}},e.prototype.addValidationErrorLogger=function(){},e.prototype.removeValidationErrorLogger=function(){},e.prototype.logValidationError=function(){},e.prototype.isFeatureEnabled=function(e){for(var t=0,n=this._featureEnablers;t<n.length;t++)if((0,n[t])(e))return!0;return!1},e.prototype.addFeatureEnabler=function(e){this._featureEnablers.push(e)},e.prototype.removeFeatureEnabler=function(e){var t=this._featureEnablers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______()}catch(t){e=t}return e&&e.stack||void 0},e}();function s(){return new o}var c="undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||s():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||s():s();function d(e){console.error("Telemetry Manager:",e)}},function(e,t,n){"use strict";n.d(t,"e",function(){return G});var a=n(0),i=n(174);function r(e){window.setTimeout(function(){i.n(V,h,{error:e})},0)}var o,s,c,d,l,u,f,p,m,_,h="error",b="Canceled",g=1;function v(){}function y(e,t){e._value=t,e._setState(V.isPromise(t)?c:f)}function S(e,t,n,a,i,r){return{exception:e,error:t,promise:n,handler:r,id:a,parent:i}}function D(e,t,n,a){var i=null==n?void 0:n._isException;return S(i?t:null,i?null:t,e,null==n?void 0:n._errorId,n,a)}function I(e,t,n){var a=null==n?void 0:n._isException,i=null==n?void 0:n._errorId;return e instanceof V&&M(e,i,a),S(a?t:null,a?null:t,e,i,n)}function x(e,t){var n=++g;return e instanceof V&&M(e,n),S(null,t,e,n)}function C(e,t){var n=++g;return e instanceof V&&M(e,n,!0),S(t,null,e,n)}function O(e,t,n){k(e,{c:t,e:n})}function w(e,t,n,a){e._value=t,L(e,t,n,a),e._setState(m)}function E(e,t){var n,a,i=e._value,r=e._listeners;if(r)for(e._listeners=null,n=0,a=r.length;n<a;n++){var o=r[n],s=o.c,d=o.promise;if(d){try{d._setCompleteValue(s?s(i):i)}catch(e){d._setExceptionValue(e)}d._state!==c&&d._listeners&&t.push(d)}else N.prototype.done.call(e,s)}}function A(e,t){var n,a,i=e._value,r=e._listeners;if(r)for(e._listeners=null,n=0,a=r.length;n<a;n++){var o=r[n],s=o.e,d=o.promise;if(d){try{s?(s.handlesOnError||L(d,i,D,e,s),d._setCompleteValue(s(i))):d._setChainedErrorValue(i,e)}catch(e){d._setExceptionValue(e)}d._state!==c&&d._listeners&&t.push(d)}else H.prototype.done.call(e,void 0,s)}}function L(e,t,n,a,r){t instanceof Error&&t.message===b||i.n(V,h,n(e,t,a,r))}function k(e,t){var n=e._listeners;n?n.push(t):n=[t],e._listeners=n}function M(e,t,n){e._isException=n||!1,e._errorId=t}function P(e,t,n,a){e._value=t,L(e,t,n,a),e._setState(_)}function T(e,t){var n;n=V.isPromise(t)?c:p,e._value=t,e._setState(n)}function U(e,t,n){var a=new z(e);return k(e,{promise:a,c:t,e:n}),a}o={name:"created",enter:function(e){e._setState(s)},cancel:v,done:v,then:v,_completed:v,_error:v,_notify:v,_setCompleteValue:v,_setErrorValue:v},s={name:"working",enter:v,cancel:function(e){e._setState(l)},done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},c={name:"waiting",enter:function(e){var t=e._value;if(t instanceof z&&t._state!==_&&t._state!==p)k(t,{promise:e});else{var n=function(a){t._errorId?e._chainedError(a,t):(L(e,a,D,t,n),e._error(a))};n.handlesOnError=!0,t.then(e._completed.bind(e),n)}},cancel:function(e){e._setState(d)},done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},d={name:"waiting_canceled",enter:function(e){e._setState(u);var t=e._value;V.is(t)&&t.cancel()},cancel:v,done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},l={name:"canceled",enter:function(e){e._setState(u),e._cancelAction()},cancel:v,done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},u={name:"canceling",enter:function(e){var t=new Error(b);t.name=t.message,t._handled=!0,e._value=t,e._setState(m)},cancel:v,done:v,then:v,_completed:v,_error:v,_notify:v,_setCompleteValue:v,_setErrorValue:v},f={name:"complete_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(p)},cancel:v,done:function(e,t,n){return N.prototype.done.call(e,t)},then:function(e,t,n){return N.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:E,_setCompleteValue:v,_setErrorValue:v},p={name:"success",enter:function(e){e._cleanupAction()},cancel:v,done:function(e,t,n){return N.prototype.done.call(e,t)},then:function(e,t,n){return N.prototype.then.call(e,t)},_completed:v,_error:v,_notify:E,_setCompleteValue:v,_setErrorValue:v},m={name:"error_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(_)},cancel:v,done:function(e,t,n){return H.prototype.done.call(e,t,n)},then:function(e,t,n){return H.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:A,_setCompleteValue:v,_setErrorValue:v},_={name:"error",enter:function(e){e._cleanupAction()},cancel:v,done:function(e,t,n){return H.prototype.done.call(e,t,n)},then:function(e,t,n){return H.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:A,_setCompleteValue:v,_setErrorValue:v};var F,H=function(){function e(e,t){void 0===t&&(t=x),this._value=e,L(this,e,t)}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){var n=this._value;if(t)try{t.handlesOnError||L(this,n,D,this,t);var a=t(n);return void(V.is(a)&&a.done())}catch(e){n=e}n instanceof Error&&n.message===b||r(n)},e.prototype.then=function(e,t){if(!t)return this;var n,a=this._value;try{t.handlesOnError||L(this,a,D,this,t),n=new N(t(a))}catch(e){n=e===a?this:new R(e)}return n},e.prototype.catch=function(e){return this.then(void 0,e)},e}(),R=function(e){function t(t){return e.call(this,t,C)||this}return Object(a.a)(t,e),t}(H),N=function(){function e(e){if(V.isPromise(e)){var t=new z(null);return t._setCompleteValue(e),t}this._value=e}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){if(e)try{var n=e(this._value);V.is(n)&&n.done()}catch(e){r(e)}},e.prototype.then=function(t,n){var a;try{var i=t?t(this._value):this._value;a=this._isSameValue(i,this)?this:new e(i)}catch(e){a=new R(e)}return a},e.prototype.catch=function(e){return this.then(void 0)},e.prototype._isSameValue=function(e,t){return e===this._value},e}();function B(e){var t;return new V(function(n){t=window.setTimeout(n,e)},function(){t&&window.clearTimeout(t)})}function j(e){var t=e;return function(){for(var e=0,n=Object.keys(t);e<n.length;e++){var a=n[e];V.as(t[a]).cancel()}}}var V=function(){function e(e,t){this._init(e,t)}return Object.defineProperty(e,"cancel",{get:function(){return F||(F=new H(new Error(b)))},enumerable:!1,configurable:!0}),e.any=function(t){return new e(function(n,a){var i=Object.keys(t),r=i.length;0===r&&n();for(var o=t,s=function(t){var i=e.as(o[t]);i.then(function(){n({key:t,value:i})},function(o){o instanceof Error&&o.name===b?0==--r&&n(e.cancel):a({key:t,value:i})})},c=0,d=i;c<d.length;c++)s(d[c])},j(t))},e.race=function(t){return new e(function(n,a){var i=Object.keys(t),r=i.length;0===r&&n();for(var o=t,s=0,c=i;s<c.length;s++){var d=c[s];e.as(o[d]).then(n,function(t){t instanceof Error&&t.name===b?0==--r&&n(e.cancel):a(t)})}},j(t))},e.as=function(t){return e.is(t)?t:new N(t)},e.is=function(t){return e.isPromise(t)&&"function"==typeof t.cancel},e.isPromise=function(e){return!!e&&"object"==typeof e&&"function"==typeof e.then},e.isCanceled=function(e){return e instanceof Error&&e.name===b},e.all=function(t){return new e(function(n,a){for(var i=Object.keys(t),r=Array.isArray(t)?[]:{},o=Array.isArray(t)?[]:{},s=i.length,c=function(){if(0==--s){var t=Object.keys(r);0===t.length?n(o):t.every(function(t){return e.isCanceled(r[t])})?n(e.cancel):a(r)}},d=function(n){var a=t[n];void 0===a?s--:e.then(a,function(e){o[n]=e,c()},function(e){r[n]=e,c()})},l=0,u=i;l<u.length;l++)d(u[l]);0===s&&n(o)},j(t))},e.then=function(t,n,a){return e.as(t).then(n,a)},e.thenEach=function(t,n,a){for(var i=Array.isArray(t)?[]:{},r=0,o=Object.keys(t);r<o.length;r++){var s=o[r];i[s]=e.then(t[s],n,a)}return e.all(i)},e.serial=function(t){return t.reduce(function(e,t){return e.then(t)},e.wrap())},e.timeout=function(e,t){var n=B(e);return t?function(e,t){var n=function(){e.cancel()};return e.then(function(){t.cancel()}),t.then(n,n),t}(n,t):n},e.wrap=function(e){return new N(e)},e.resolve=function(t){return e.wrap(t)},e.wrapError=function(e){return new H(e)},e.reject=function(t){return e.wrapError(t)},e.prototype.cancel=function(){this._state.cancel(this),this._run()},e.prototype.done=function(e,t){this._state.done(this,e,t)},e.prototype.then=function(e,t){return this._state.then(this,e,t)},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype._init=function(e,t){this._oncancel=t,this._setState(o),this._run();try{e?e(this._completed.bind(this),this._error.bind(this)):this._setExceptionValue(new Error("No init value for Promise"))}catch(e){this._setExceptionValue(e)}},e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel()}catch(e){}},e.prototype._cleanupAction=function(){this._oncancel=void 0},e.prototype._chainedError=function(e,t){var n=this._state._error(this,e,I,t);return this._run(),n},e.prototype._completed=function(e){var t=this._state._completed(this,e);return this._run(),t},e.prototype._error=function(e){var t=this._state._error(this,e,x);return this._run(),t},e.prototype._setState=function(e){this._nextState=e},e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e),this._run()},e.prototype._setChainedErrorValue=function(e,t){var n=this._state._setErrorValue(this,e,I,t);return this._run(),n},e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,C);return this._run(),t},e.prototype._run=function(){for(;this._nextState;)this._state=this._nextState,this._nextState=void 0,this._state.enter(this)},e.prototype._isSameValue=function(e,t){return e===this._value},e}();i.e(V,h);var z=function(e){function t(t){var n=e.call(this)||this;return n._creator=t,n._initThen(),n}return Object(a.a)(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._creator&&this._creator.cancel()},t.prototype._cleanupAction=function(){this._creator=null},t.prototype._initThen=function(){this._setState(o),this._run()},t}(V),G=function(e){function t(t){var n=e.call(this)||this;return n._oncancel=t,n._initSignal(),n}return Object(a.a)(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._oncancel&&this._oncancel()},t.prototype._cleanupAction=function(){this._oncancel=void 0},t.prototype._initSignal=function(){this._setState(o),this._run()},t}(V),K=V;t.t=K},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(137),i=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),i=Object(a.e)(e,function(){delete t._disposables[n]});return this._disposables[n]=i,i},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],r=e[i];r&&Object(a.t)(r)&&r.dispose(),delete e[i]}},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(60);function r(e,t){return new this(e,i.t.Single,t)}function o(e){return new this(null,i.t.Single,e)}function s(e,t,n){var s=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(n,e),n.logData=t?r:o,n}(i.n);return Object(i.a)(s.prototype,e,t||{},n),s}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){return console.log("No session storage accessible: "+e),!1}}},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return b});var a,i,r,o=n(0),s=n(46),c=n(6),d=n(205),l=n(334),u=n(56),f=n(177),p=n(210),m=n(219),_=n(4),h="ShareV3";!function(e){e.Opening="Opening",e.Opened="Opened",e.Completed="Completed"}(a||(a={})),function(e){e.MainLinkSettingsHint="MainLinkSettingsHint",e.PeoplePickerErrorLinkSettingsHint="PeoplePickerErrorLinkSettingsHint",e.CopyLinkSettingsHint="CopyLinkSettingsHint",e.RoleSelector="RoleSelector",e.Other="Unknown"}(i||(i={})),function(e){e.People="People",e.Groups="Groups",e.Links="Links",e.Other="Unknown"}(r||(r={}));var b=function(){function e(e,t){this._manager=e,this._extraData=t,this._engagmentCounts={}}return e.prototype.setEngagementExtraData=function(e){this._extraData=Object(o.e)(Object(o.e)({},this._extraData),e)},e.prototype.getEngagementExtraData=function(){return this._extraData},e.prototype.linkSettingsOpened=function(e,t){this.log("LinkSettings.Opened",Object(o.e)(Object(o.e)({},e),{linkSettingsOpenSource:t||i.Other}))},e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)},e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)},e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)},e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)},e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)},e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)},e.prototype.manageAccessNumberOfSharingPrincipals=function(e){this.log("ManageAccess.NumberOfSharingPrincipals",e)},e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)},e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)},e.prototype.manageAccessFacePileClicked=function(e){this.log("ManageAccess.FacePileClicked",e)},e.prototype.manageAccessRemoveDirectAccess=function(e){this.log("ManageAccess.RemoveDirectAccess",e)},e.prototype.manageAccessLinkCopyButtonClicked=function(e){this.log("ManageAccess.LinkCopyClicked",e)},e.prototype.manageAccessLinkDetailsClicked=function(e){this.log("ManageAccess.LinkDetailsClicked",e)},e.prototype.manageAccessLinkInviteesToggled=function(e,t){this.log("ManageAccess.LinkInviteesToggled",Object(o.e)(Object(o.e)({},t),{isExpanded:e}))},e.prototype.manageAccessAdvancedLinkClicked=function(e){this.log("ManageAccess.AdvancedLinkClicked",e)},e.prototype.manageAccessLinkSectionShareClicked=function(e){this.log("ManageAccess.LinkSectionShareClicked",e)},e.prototype.manageAccessGrantAccessClicked=function(e){this.log("ManageAccess.DiretAccessSectionGrantAccessClicked",e)},e.prototype.manageAccessV3Opened=function(e){this.log("ManageAccessV3.Opened",e)},e.prototype.manageAccessV3NumberOfSharingPrincipals=function(e){this.log("ManageAccessV3.NumberOfSharingPrincipals",e)},e.prototype.manageAccessV3AdvancedSettingsClicked=function(e){this.log("ManageAccessV3.AdvancedSettingsClicked",e)},e.prototype.manageAccessV3UserDidSearch=function(e){this.log("ManageAccessV3.UserDidSearch",e)},e.prototype.manageAccessV3StopSharingClicked=function(e){this.log("ManageAccessV3.StopSharingClicked",e)},e.prototype.compactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.Clicked",e)},e.prototype.linkSettingsInCompactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.LinkSettingsClicked",e)},e.prototype.SharingRoleChangedFromCompactRoleSelector=function(e){this.log("SharingRoleChangedFromCompactRoleSelector",e)},e.prototype.SharingRoleChangedFromLargeRoleSelector=function(e){this.log("SharingRoleChangedFromLargeRoleSelector",e)},e.prototype.manageAccessV3NavClicked=function(e,t,n){this.log("ManageAccessV3.NavigationClicked",Object(o.e)(Object(o.e)({},n),{sectionName:e||r.Other,sectionItemCount:t}))},e.prototype.manageAccessV3ShareClicked=function(e,t){this.log("ManageAccessV3.ShareClicked",Object(o.e)(Object(o.e)({},t),{shareLocation:e}))},e.prototype.manageAccessV3PrincipalDetailsClicked=function(e,t){this.log("ManageAccessV3.PrincipalDetailsClicked",Object(o.e)(Object(o.e)({},t),{principalType:e}))},e.prototype.manageAccessV3PrincipalRemoveDirectAccess=function(e,t){this.log("ManageAccessV3.PrincipalRemoveDirectAccess",Object(o.e)(Object(o.e)({},t),{principalType:e}))},e.prototype.manageAccessV3CancelPermissionUpdate=function(e){this.log("ManageAccessV3.CancelPermissionUpdate",e)},e.prototype.shareToTeamsTeachingBubbleShown=function(e){this.log("ShareToTeamsTeachingBubble.Shown",e)},e.prototype.shareCompleted=function(e){e=Object(o.e)(Object(o.e)({},e),{compactRoleSelectorClicked:this._engagmentCounts["RoleSelectorCompact.Clicked"]>0,linkSettingsOpened:this._engagmentCounts["LinkSettings.Opened"]>0,sharingRoleChangedFromCompactRoleSelector:this._engagmentCounts.SharingRoleChangedFromCompactRoleSelector>0}),this.log("Completed",e)},e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)},e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)},e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)},e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)},e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)},e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)},e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)},e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)},e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)},e.prototype.shareErrorFileIsUploading=function(e){this.log("shareError.FileUploading",e)},e.prototype.webShareToTeamsTargetClicked=function(e){this.log("ShareToTeams.TeamsTargetClicked",e)},e.prototype.onLinkParticipantOpenDelete=function(e){this.log("ShareLinkParticipants.OpenParticipantDeletionDialog",e)},e.prototype.onLinkParticipantDelete=function(e){this.log("ShareLinkParticipants.ParticipantDeleted",e)},e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",Object(o.e)(Object(o.e)({},e),{linkedinSuggestionsCount:s.t(t)}))},e.prototype.onShareLinkDelete=function(e){this.log("ShareLink.Delete",e)},e.prototype.logShareLinkGeneration=function(e,t){this.log("ShareV3.odspShareLink",Object(o.e)(Object(o.e)({},t),{allowsAnonymousAccess:e.allowsAnonymousAccess,audience:e.audience,blockDownload:e.blockDownload,createdViaCopyLinkCommand:e.createdViaCopyLinkCommand,hasDescription:!!e.description,hasExpiration:!!e.expiration,hasPassword:e.hasPassword,numOfInvitees:e.invitees?e.invitees.length:0,isActive:e.isActive,isAddressBarLink:e.isAddressBarLink,isCreateOnlyLink:e.isCreateOnlyLink,isEdit:e.isEdit,isManageList:e.isManageList,isReview:e.isReview,isUnhealthy:e.isUnhealthy,shareId:e.shareId,sharingLinkStatus:e.status,trackLinkUsers:e.trackLinkUsers}))},e.prototype.showSensitivityLabel=function(e){this.log("showSensitivityLabel",e)},e.prototype.hoverOverSensitivityLabel=function(e){this.log("hoverOverSensitivityLabel",e)},e.prototype.logEvent=function(e,t){this.log(a[e],t)},e.prototype.log=function(e,t){void 0===this._engagmentCounts[e]?this._engagmentCounts[e]=1:this._engagmentCounts[e]++;var n=Object(o.e)(Object(o.e)({},this._extraData),t),a=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,i=location.href.toLowerCase().indexOf("www.odwebp.svc.ms")>=0,r=Object(p.e)(location.search.substring(1)),s="12"===r.p,b=!!r.migratedhosting&&"true"===r.migratedhosting.toLowerCase(),g=Object(o.e)(Object(o.e)(Object(o.e)({},n),{clientId:c.e[n.clientId],scenarioId:n.scenarioId,mode:d.e[n.mode],shareType:l.e[n.shareType],audience:u.e[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets),sharingLinkKind:f.e[n.sharingLinkKind],isShareDialogASPXHosted:a,isP12:s,isMigratedhosting:b,isMicroServiceHosted:i}),void 0===n.shareViewState?{}:{shareViewState:_.e[n.shareViewState]}),v={name:0===e.indexOf(h)?e:"".concat(h,".").concat(e),webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:g};(this._manager?m.e.withManager(this._manager):m.e).logData(v)},e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n];t.push(l.e[i])}return t},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a=n(121),i=n(29),r=n(3),o=n(113),s={ODB:r.t.isActivated("904afe8e-3cce-4ab4-ac2f-97b60197cf59","11/9/2021","Disable check for webTemplate mySite as qualification for isOdb"),ECS:108854},c=window._spPageContextInfo&&(window._spPageContextInfo.listBaseTemplate===a.t.mySiteDocumentLibrary||!i.e.isFeatureEnabled(s)&&Number(window._spPageContextInfo.webTemplate)===o.t.mySite),d=!!window.FilesConfig,l=c||d},,function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"s",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"o",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"u",function(){return m});var a=6e4,i=2*a,r=60*a,o=2*r,s=24*r,c=2*s,d=7*s,l=32*s;function u(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<s}function f(e,t){return e.getFullYear()===t.getFullYear()}function p(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}function m(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}},,,function(e,t,n){"use strict";n.d(t,"n",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"d",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"c",function(){return S}),n.d(t,"u",function(){return D}),n.d(t,"i",function(){return I}),n.d(t,"s",function(){return C}),n.d(t,"o",function(){return O});var a=n(56),i=n(205),r=n(117),o=n(29),s=n(263),c=n(176),d=n(97),l=n(5),u=n(10),f={ODB:772},p={ODB:1935};function m(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?a.e.anyone:"organizationLinkAbilities"===e?a.e.organization:"peopleSharingLinkAbilities"===e?a.e.specificPeopleFlex:void 0}function _(e,t){return e===a.e.anyone?t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===a.e.organization?t.organizationLinkAbilities:e===a.e.specificPeopleFlex||e===a.e.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function h(e,t){var n=_(e,t);return(null==n?void 0:n.canManageEditLink)?n.canManageEditLink.enabled:!!(null==n?void 0:n.canAddInternalPrincipal)&&n.canAddInternalPrincipal.enabled}function b(e,t){var n,a=_(e,t);return!!(null==a?void 0:a.canManageReadLink)&&(null===(n=null==a?void 0:a.canManageReadLink)||void 0===n?void 0:n.enabled)}function g(e,t,n){if(o.e.isFeatureEnabled(f)&&!s.e[n]){var a=_(e,t);return(null==a?void 0:a.canManageReviewLink)?a.canManageReviewLink.enabled:!!(null==a?void 0:a.supportsReviewPermission)&&a.supportsReviewPermission.enabled}return!1}function v(e){var t=e.sharingInformation,n=e.audience,r=e.mode,o=!1,s=!1,f=!1,p=!1,m=!0;Object(u.R)(t)||(o=t.sharedObjectType===d.e.list,s=function(e){var t=e.audience,n=e.sharingRole,i=_(t,e.sharingAbilities);return(null==i?void 0:i.canManageManageListLink)?i.canManageManageListLink.enabled:t===a.e.existing&&(n===c.e.manageList||n===c.e.owner)}({audience:n,sharingAbilities:t.sharingAbilities,sharingRole:t.userRole}),p=g(n,t.sharingAbilities,t.fileExtension)||S(n,t.sharingAbilities,t.fileExtension),f=h(n,t.sharingAbilities),m=l.w()||b(n,t.sharingAbilities));var v=r===i.e.addPeople||r===i.e.manageAccess||f,y=m;return(n==a.e.specificPeople&&O(n,t.sharingAbilities)||t.requiresAccessApproval&&!l.$())&&(v=y=!0),{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:s,shouldDisplay:o},review:{enabled:p,shouldDisplay:p},edit:{enabled:v,shouldDisplay:!0},view:{enabled:y,shouldDisplay:y}}}function y(e){var t=e.sharingInformation,n=e.scenarioId,a=!1,i=!1,r=!1;return Object(u.R)(t)||(a=t.sharedObjectType===d.e.list,i=function(e){var t=e.sharingRole;return t===c.e.manageList||t===c.e.owner}({sharingRole:t.userRole}),r=function(e,t){return e.sharedObjectType===d.e.list&&e.userRole===c.e.owner}(t)),{fullControl:{enabled:r,shouldDisplay:r},manageList:{enabled:i,shouldDisplay:a},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!0,shouldDisplay:!0},view:{enabled:"SharePrivateDraft"!==n,shouldDisplay:"SharePrivateDraft"!==n}}}function S(e,t,n){if(s.t===s.e[n]){var a=_(e,t);return a.canManageReviewLink?a.canManageReviewLink.enabled:!!a.supportsReviewPermission&&a.supportsReviewPermission.enabled}return!1}function D(e,t){var n=_(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled}function I(e,t){var n=[];if(o.e.isFeatureEnabled(p))for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.linkDetails&&r.linkDetails.shareId){var s=_(r.linkDetails.audience,e);s.canManageEditLink&&s.canManageEditLink.enabled||s.canManageReviewLink&&s.canManageReviewLink.enabled||s.canManageReadLink&&s.canManageReadLink.enabled||r.linkDetails.expiration&&r.linkDetails.expiration<new Date(Date.now())||n.push(r.linkDetails)}}return n}function x(e,t,n){var a;if(!e||!t)return!1;var i=_(e,t);for(var r in i)if((null===(a=i[r])||void 0===a?void 0:a.disabledReason)==n)return!0;return!1}function C(e,t){return x(e,t,r.e.sharingBlockedByVirusCheckStatus)}function O(e,t){return x(e,t,r.e.irmIsEnabled)}},,function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(0),i=n(112);function r(e,t){return function(n){var a=Object(i.t)(n,t||i.e.Small);return 0===a.indexOf("https://")||0===a.indexOf("http://")?a:a&&e?e+a:void 0}}function o(e){!e||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo=Object(a.e)(Object(a.e)({},window._spPageContextInfo),{userPhotoCdnBaseUrl:e}))}},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"n",function(){return _});var a={};n.r(a),n.d(a,"Default",function(){return s}),n.d(a,"Tenant",function(){return c}),n.d(a,"Hub",function(){return d}),n.d(a,"Site",function(){return l});var i,r=n(21),o=n(3),s=0,c=1,d=2,l=3,u=o.t.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),f="undefined"!=typeof window&&r.e.isFeatureEnabled({ODB:1737});function p(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl,a=e.isSiteListsHost;return"/"===n||""===n||!u&&a||f&&(null==e?void 0:e.isUnifiedAdminUrl)?t:t.substring(0,t.lastIndexOf(n))}function m(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}function _(e){return e&&e.webAbsoluteUrl===e.siteAbsoluteUrl}!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(i||(i={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"verbose",function(){return m}),n.d(t,"logError",function(){return _}),n.d(t,"log",function(){return h}),n.d(t,"getErrorMessage",function(){return b}),n.d(t,"isExpectedError",function(){return g});var a=n(69),i=n(8),r=n(229),o=Object(a.e)({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0},{stack:i.e.String,extraData:i.e.Object,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}},r.e).withData({privacyClassification:i.t.requiredService}),s=n(28),c=Object(a.e)({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:i.e.String},resultCode:i.e.String,resultType:{typeRef:s.e,type:i.e.Enum}},o).withData({privacyClassification:i.t.requiredDiagnostic}),d=n(314),l=n(199),u=n(200),f="Canceled",p=new l.e(50);function m(e,t){p.push({name:t,message:e})}function _(e,t,n){var a;if(!e||function(e){return e===f||(null==e?void 0:e.name)===f||(null==e?void 0:e.message)===f}(e)||"object"==typeof e&&e.isExpected)try{if("true"===sessionStorage.getItem("suppressErrorHandling"))return}catch(e){}else{for(var i,r=b(e),s=null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"";i=p.popOldest();)d.e.logData(i);n&&n.eventName?c.logData({name:n.eventName,resultCode:n.resultCode,resultType:n.resultType,extraData:t||{},message:r,stack:s}):o.logData({extraData:t||{},message:r,stack:s})}}function h(e,t,n,a){_(e,void 0,{eventName:t,resultCode:n,resultType:a})}function b(e){var t,n;return e?"object"==typeof e?null!==(n=null!==(t=e.message)&&void 0!==t?t:e.description)&&void 0!==n?n:Object(u.e)(e):e.toString():""}function g(e,t){if(!0===e.isExpected)return!0;void 0===e.message&&void 0===e.code&&console.error('Error message and code are both undefined. "error" must specify at least message or code');for(var n=function(e,t){return!(!e||!t||0!==e.localeCompare(t,void 0,{sensitivity:"base"})&&e!==t)},a=!1,i=0,r=t;i<r.length;i++){var o=r[i],s=n(o.code,e.code),c=n(o.message,e.message);if(o.code&&e.code&&o.message&&e.message?a=s&&c:o.code&&e.code?a=s:o.message&&e.message&&(a=c),a)return a}return a}},,function(e,t,n){"use strict";function a(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(7);function r(e){var t,n,o=e||void 0;return Object(a.e)(Object(a.e)({error:e&&(e.message||e.name),resultCode:o&&(t=o,n=[],"object"==typeof t.extraData&&t.extraData&&void 0!==t.extraData.status&&n.push("[".concat(t.extraData.status,"]")),"string"==typeof t.code&&n.push("".concat(t.code)),n.join(" "))||e&&e.name||"Unknown"},o?Object(a.e)({},"boolean"==typeof o.isExpected?{resultType:o.isExpected?i.t.ExpectedFailure:i.t.Failure}:{resultType:i.t.Failure}):{resultType:i.t.Success}),{extraData:Object(a.e)({stack:e&&e.stack},o?Object(a.e)(Object(a.e)(Object(a.e)({},"object"==typeof o.innerError?{innerError:r(o.innerError)}:{}),"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"object"==typeof o.extraData?Object(a.e)({},o.extraData):{}):{})})}},function(e,t,n){"use strict";var a;!function(e){e[e.button=0]="button",e[e.link=1]="link",e[e.copyLink=2]="copyLink"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"t",function(){return c});var a=n(0),i=function(e){function t(t,n){var i=this,r=n.response,o=(void 0===r?{}:r).error,s=(void 0===o?{}:o).innerError,d=(void 0===s?{}:s).stackTrace,l=void 0===d?"":d,u=n.response,f=n.request,p=n.status,m=n.code,_=void 0===m?c(u,p,function(e){return"".concat(e)})||"unhandled":m,h=Object(a.e)({innerError:t,code:_},n);return(i=e.call(this,h)||this).name="GraphError",i.response=u,i.status=p,i.serverStack=l,i.request=f,i.error=t,i}return Object(a.a)(t,e),t}(n(49).e);function r(e){var t={};if(t.errorMessage=e.message,o(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function o(e){return e instanceof i}function s(e){return function(e,t){if(o(e))return c(e.response,e.status,function(e){return function(e){return"".concat(e)}(e)})}(e)||"unhandled"}function c(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.success="success",e.error="error",e.inProgress="inProgress",e.closed="closed"}(a||(a={}))},,,function(e,t,n){"use strict";var a=n(41);function i(){}function r(e){a.e.log(e)}var o=function(){function e(e,t){void 0===t&&(t=r),this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null}return e.prototype.dispose=function(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){var n=t[e];this.clearTimeout(Number(n))}this._timeoutIds=null}if(this._immediateIds){for(var a=0,i=Object.keys(this._immediateIds);a<i.length;a++)n=i[a],this.clearImmediate(Number(n));this._immediateIds=null}if(this._intervalIds){for(var r=0,o=Object.keys(this._intervalIds);r<o.length;r++)n=o[r],this.clearInterval(Number(n));this._intervalIds=null}if(this._animationFrameIds){for(var s=0,c=Object.keys(this._animationFrameIds);s<c.length;s++)n=c[s],this.cancelAnimationFrame(Number(n));this._animationFrameIds=null}}},e.prototype.setTimeout=function(e,t){var n=this,a=0;if(!this._isDisposed){var i=this._timeoutIds||(this._timeoutIds={}),r=this._parent;a=setTimeout(function(){try{delete i[a],e.apply(r)}catch(e){n._logError(e)}},t),i[a]=!0}return a},e.prototype.clearTimeout=function(e){var t=this._timeoutIds;t&&t[e]&&(clearTimeout(e),delete t[e])},e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){var a=this._immediateIds||(this._immediateIds={}),i=this._parent,r=function(){try{delete a[n],e.apply(i)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(r):window.setTimeout(r,0),a[n]=!0}return n},e.prototype.clearImmediate=function(e){var t=this._immediateIds;t&&t[e]&&(window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e),delete t[e])},e.prototype.setInterval=function(e,t){var n=this,a=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});var i=this._parent;a=setInterval(function(){try{e.apply(i)}catch(e){n._logError(e)}},t),this._intervalIds[a]=!0}return a},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var a=this;if(void 0===n&&(n={}),this._isDisposed)return i;var r,o,s=t||0,c=n.leading,d=void 0===c||c,l=n.trailing,u=void 0===l||l,f=0,p=null,m=this._parent,_=function(t){var n=(new Date).getTime(),i=n-f,c=d?s-i:s;return i>=s&&(!t||d)?(f=n,p&&(a.clearTimeout(p),p=null),r=e.apply(m,o)):null===p&&u&&(p=a.setTimeout(_,c)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,_(!0)}},e.prototype.debounce=function(e,t,n){var a=this;if(void 0===n&&(n={}),this._isDisposed)return i;var r,o,s=t||0,c=n.leading,d=void 0!==c&&c,l=n.trailing,u=void 0===l||l,f=n.maxWait,p=void 0===f?NaN:f,m=0,_=(new Date).getTime(),h=null,b=this._parent,g=function(t){var n=(new Date).getTime(),i=!1;t&&(d&&n-m>=s&&(i=!0),m=n);var c=n-m,l=s-c,f=n-_,v=!1;return isNaN(p)||(f>=p&&h?v=!0:l=Math.min(l,p-f)),c>=s||v||i?(h&&(a.clearTimeout(h),h=null),_=n,r=e.apply(b,o)):null!==h&&t||!u||(h=a.setTimeout(g,l)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,g(!0)}},e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){var a=this._animationFrameIds||(this._animationFrameIds={}),i=this._parent,r=function(){try{delete a[n],e.apply(i)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(r):window.setTimeout(r,0),a[n]=!0}return n},e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;t&&t[e]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e),delete t[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}();t.e=o},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.unknown=0]="unknown",e[e.file=1]="file",e[e.folder=2]="folder",e[e.item=3]="item",e[e.list=4]="list",e[e.web=5]="web",e[e.max=6]="max"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"e",function(){return f});var a=n(150),i=n(69),r=n(8),o=Object(i.e)({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:r.e.Number},variant:{isPrefixingDisabled:!0,type:r.e.Number},isAATest:{isPrefixingDisabled:!0,type:r.e.Boolean},isOverride:{isPrefixingDisabled:!0,type:r.e.Boolean},isLoggedAtExposure:{isPrefixingDisabled:!0,type:r.e.Boolean},serverTime:{isPrefixingDisabled:!0,type:r.e.String}}),s="experimentLogCacheTime",c="experimentLogCache",d=function(){function e(t,n,i){var r;if(this._isAATest=!1,this._isOverride=!1,this._serverTime="",this._shouldLogVariantPropertyAccess=!1,this._loggedPropertyAccess=!1,this._loggedExposure=!1,this._variantToDisplay=0,this._experimentId=t,this._shouldLogVariantPropertyAccess=i,this._serverTime=null!==(r=null==n?void 0:n.serverTime)&&void 0!==r?r:"",window&&window.location&&window.location.search){var o=Object(a.e)(window.location.search.substr(1)).expOverrides;if(o){var s=void 0;try{s=JSON.parse(o)}catch(e){s=[]}for(var c=0,d=s;c<d.length;c++){var l=d[c];if(l&&2===l.length&&l[0]===t)return void this._setProperties(l[1],l[1],!1,!0)}}}if(!n||void 0===n.experimentData||void 0===n.experimentDataLookup||void 0===n.serverTime||this._experimentId<9e4)return this._variantToDisplay=0,void(this._variantToLog=void 0);var u=t-9e4,f=e._decodeAt(n.experimentData,u);if(0===f)this._setProperties(0,void 0,!1,!1);else if(f>=1&&f<=4)this._setProperties(f-1,f-1,!1,!1);else if(5===f){var p=e._lookup(n.experimentDataLookup,u);this._setProperties(p,p,!1,!1)}else f>=6&&f<=9?this._setProperties(0,f-6,!0,!1):10===f?this._setProperties(0,e._lookup(n.experimentDataLookup,u),!0,!1):f>=11&&f<=14?this._setProperties(f-11,f-11,!1,!0):(p=e._lookup(n.experimentDataLookup,u),this._setProperties(p,p,!1,!0));this._saveExperiments()}return Object.defineProperty(e.prototype,"variantToDisplay",{get:function(){return this._shouldLogVariantPropertyAccess&&this._logInternal(!1),this._variantToDisplay},enumerable:!1,configurable:!0}),e._decodeAt=function(t,n){if(n>Math.floor(3*t.length/2)-1)return 0;var a=Math.floor(n/3*2);switch(n%3){case 0:return e._ctoi(t[a])>>2;case 1:return(3&e._ctoi(t[a]))<<2|e._ctoi(t[a+1])>>4;case 2:return 15&e._ctoi(t[a])}return 0},e._ctoi=function(e){var t=e.charCodeAt(0);return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:43===t?62:63},e._lookup=function(e,t){var n=t.toString(36);n=Array(4-n.length).join("0")+n;for(var a=0;a<e.length;a++)for(var i=0;i<e[a].length-2;i+=3)if(e[a].substring(i,i+3)===n)return a+4;return 0},e._getItemFromSessionStorageNoThrow=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}},e._setItemInSessionStorageNoThrow=function(e,t){try{sessionStorage.setItem(e,t)}catch(e){}},e.prototype.logExposure=function(){this._logInternal(!0)},e.prototype._saveExperiments=function(){window.ODSP_EXPERIMENTS=window.ODSP_EXPERIMENTS||{},window.ODSP_EXPERIMENTS[this._experimentId]=this},e.prototype._logInternal=function(t){var n=void 0!==this._variantToLog&&(t&&!this._loggedExposure||!t&&!this._loggedPropertyAccess),a=null,i=null;if(n&&(a=e._getItemFromSessionStorageNoThrow(s),i=e._getItemFromSessionStorageNoThrow(c),n=a!==this._serverTime||!i||-1===i.indexOf(this._experimentId.toString()+t)),n&&void 0!==this._variantToLog){var r={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride,isLoggedAtExposure:t,serverTime:this._serverTime};o.logData(r),t?this._loggedExposure=!0:this._loggedPropertyAccess=!0,a===this._serverTime?e._setItemInSessionStorageNoThrow(c,(null!=i?i:"")+this._experimentId.toString()+t):(e._setItemInSessionStorageNoThrow(s,this._serverTime),e._setItemInSessionStorageNoThrow(c,this._experimentId.toString()+t))}},e.prototype._setProperties=function(e,t,n,a){this._variantToDisplay=e,this._variantToLog=t,this._isAATest=n,this._isOverride=a},e}();function l(e,t){var n=new d(e,t,!1);return n.logExposure(),n.variantToDisplay}function u(e,t){return new d(e,t,!0)}function f(e,t){return new d(e,t,!1).variantToDisplay}},,,function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=3e5,i=864e5,r="odsp-ds-",o={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}},,function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830"},,function(e,t,n){"use strict";var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(125),r=n(150),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t}(i.n),s=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?o:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return Object(a.a)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=Object(r.e)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(i.t)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("react-lib");function i(e){var t=a.useRef(e);t.current=e;var n=a.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(125),r=n(189),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.a)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.a.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.e),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return Object(a.a)(t,e),t}(o):d;return i._apiUrlType=l,i}return Object(a.a)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.t)},function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"r",function(){return u}),n.d(t,"o",function(){return f});var a=n(0),i=n(11),r=n(137),o=function(){function e(e,t){this._type=e,this.dependencies=Object(a.e)(Object(a.e)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){var t=new this._type({},e);return{instance:t,disposable:t}},e}(),s=function(){function e(e,t){this._type=e,this.dependencies=Object(a.e)(Object(a.e)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){return{instance:Object(i.a)(this._type,e)}},e}(),c=function(){function e(e){this._type=e,this.dependencies={}}return e.prototype.create=function(){var e=new this._type;return{instance:e,disposable:Object(r.t)(e)?e:void 0}},e}(),d=function(){function e(e){this._load=e}return e.prototype.load=function(){var e=this._load().then(function(e){return new l(e)});return this.load=function(){return e},e},e}(),l=function(){function e(e){this.dependencies={value:e.lazy}}return e.prototype.create=function(e){return{instance:e.value()}},e}();function u(e,t,n){return new i.t({name:e,factory:new o(t,n)})}function f(e,t,n){return new i.t({name:e,factory:new s(t,n)})}i.n.prototype.alias=function(e,t){return this.exposeFactory(e,new l(t))}},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return u});var a=n(26),i=n(7),r={Small:1,Medium:2,Large:3},o="_oat_",s={},c={},d="TryGetAlternativeUrlFailure";function l(e){if(-1===e.indexOf(o))return!0;var t=c[e];if(t)return Date.now()/1e3<t;var n=new a.e(e),r=n.getQueryParameter(o);if(r){var s=r.split("_");if(2===s.length&&(t=Number(s[0])),!t)return new i.e({name:d}).end({resultType:i.t.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:r}}),c[e]=Date.now()/1e3+86400,!0;if(t-=30,c[e]=t,Date.now()/1e3>t)return!1}var l=n.getQueryParameter("P1");if(!l)return!0;var u=Number(l);return u-=30,c[e]=Math.min(u,c[e]),!(Date.now()/1e3>u)}function u(e,t,n){var o;switch(n=n||function(e){var t,n;function a(e){return l(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var r=s&&s[e];if(r||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?r=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(r=a("_spHomePageContext"))),!r)return;return l(r)?r:void delete s[e]}catch(e){new i.e({name:d}).end({resultType:i.t.Failure,resultCode:"Unexpected",extraData:{error:e}})}}("UserPhotoAspx")||"/_layouts/15/userphoto.aspx",t){case r.Medium:o="M";break;case r.Large:o="L";break;default:o="S"}var c=new a.e(n);return c.setQueryParameter("size",o),c.setQueryParameter("accountname",e||""),c.toString()}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.invalid=-1]="invalid",e[e.teamSite=1]="teamSite",e[e.meetings=2]="meetings",e[e.centralAdmin=3]="centralAdmin",e[e.wiki=4]="wiki",e[e.documentCenter=7]="documentCenter",e[e.blog=9]="blog",e[e.tenantAdmin=16]="tenantAdmin",e[e.app=17]="app",e[e.appCatalog=18]="appCatalog",e[e.mySite=21]="mySite",e[e.subgroup=39]="subgroup",e[e.publishingPortal=52]="publishingPortal",e[e.mySiteHost=54]="mySiteHost",e[e.enterpriseWiki=56]="enterpriseWiki",e[e.group=64]="group",e[e.pointPublishingPersonal=66]="pointPublishingPersonal",e[e.sitePagePublishing=68]="sitePagePublishing",e[e.teamChannel=69]="teamChannel",e[e.projectWebAppSite=6221]="projectWebAppSite",e[e.contentCenter=6001]="contentCenter"}(a||(a={}));for(var i={},r=0,o=Object.keys(a);r<o.length;r++){var s=o[r];"string"==typeof s&&(i[s.toUpperCase()]=a[s])}t.t=a},,function(e,t,n){"use strict";var a;!function(e){e[e.none=1]="none",e[e.available=2]="available",e[e.other=3]="other"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";var a;!function(e){e[e.unavailable=-1]="unavailable",e[e.none=0]="none",e[e.disabled=1]="disabled",e[e.notShareableByLink=2]="notShareableByLink",e[e.parentListIsPrivate=3]="parentListIsPrivate",e[e.parentListIsCatalogDocLib=4]="parentListIsCatalogDocLib",e[e.notSupportedByWopi=5]="notSupportedByWopi",e[e.irmIsEnabled=6]="irmIsEnabled",e[e.documentIsProtectedByDlp=7]="documentIsProtectedByDlp",e[e.forceCheckoutEditLink=8]="forceCheckoutEditLink",e[e.anonymousEditLinkNotAllowedByTenant=9]="anonymousEditLinkNotAllowedByTenant",e[e.nonClaimsWebapp=10]="nonClaimsWebapp",e[e.accessDeniedToAnonGuest=11]="accessDeniedToAnonGuest",e[e.blockedByWhoCanShareSettings=12]="blockedByWhoCanShareSettings",e[e.blockedByExternalShareSettings=13]="blockedByExternalShareSettings",e[e.accessDeniedNotEnoughPermissions=14]="accessDeniedNotEnoughPermissions",e[e.sharingBlockedByVirusCheckStatus=40]="sharingBlockedByVirusCheckStatus",e[e.loopFilesExternalSharingNotSupported=43]="loopFilesExternalSharingNotSupported"}(a||(a={})),t.e=a},,,,function(e,t,n){"use strict";var a,i;function r(e){return Number(e)===i.DocumentLibrary}function o(e){return e===a.genericList||e===a.announcements||e===a.issueTracking||e===a.contacts||e===a.customGrid}function s(e){return Number(e)===a.promotedLinks}n.d(t,"e",function(){return a}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"i",function(){return s}),function(e){e[e.invalidType=-1]="invalidType",e[e.noListTemplate=0]="noListTemplate",e[e.genericList=100]="genericList",e[e.documentLibrary=101]="documentLibrary",e[e.survey=102]="survey",e[e.links=103]="links",e[e.announcements=104]="announcements",e[e.contacts=105]="contacts",e[e.events=106]="events",e[e.tasks=107]="tasks",e[e.pictureLibrary=109]="pictureLibrary",e[e.webTemplateCatalog=111]="webTemplateCatalog",e[e.webPartCatalog=113]="webPartCatalog",e[e.listTemplateCatalog=114]="listTemplateCatalog",e[e.xmlFormLibrary=115]="xmlFormLibrary",e[e.masterPageCatalog=116]="masterPageCatalog",e[e.webPageLibrary=119]="webPageLibrary",e[e.customGrid=120]="customGrid",e[e.solutionCatalog=121]="solutionCatalog",e[e.themeCatalog=123]="themeCatalog",e[e.designCatalog=124]="designCatalog",e[e.appDataCatalog=125]="appDataCatalog",e[e.ganttTasks=150]="ganttTasks",e[e.promotedLinks=170]="promotedLinks",e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy",e[e.meetings=200]="meetings",e[e.externalList=600]="externalList",e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary",e[e.publishingPageLibrary=850]="publishingPageLibrary",e[e.publishingAsset=851]="publishingAsset",e[e.issueTracking=1100]="issueTracking",e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary",e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary",e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary",e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList",e[e.contentCenterExplanationList=1332]="contentCenterExplanationList",e[e.corporateCatalog=330]="corporateCatalog",e[e.siteCollectionCorporateCatalog=336]="siteCollectionCorporateCatalog"}(a||(a={})),function(e){e[e.invalidType=-1]="invalidType",e[e.GenericList=0]="GenericList",e[e.DocumentLibrary=1]="DocumentLibrary"}(i||(i={})),a.mySiteDocumentLibrary,a.documentLibrary,a.pictureLibrary,a.xmlFormLibrary,a.webPageLibrary,a.publishingPageLibrary,a.publishingAsset,a.documentLibrary,a.contentCenterPrimeLibrary,t.t=a},function(e,t,n){"use strict";var a=n(0),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.attached=function(e){var t=this,n=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.attach(e.apply(this,n)||this)};return n.prototype=e.prototype,n},t}(n(68).e);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a,i=n(0),r=n(96),o=n(103),s=n(69),c=n(8),d=Object(s.e)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:c.e.String,dictionary:c.e.Object,privacyClassification:{isPrefixingDisabled:!0,type:c.e.String}}).withData({privacyClassification:c.t.requiredService}),l=n(159),u=n(47),f=n(3),p="undefined"==typeof window?self:window;!function(e){e[e.xhr=0]="xhr",e[e.fetch=1]="fetch"}(a||(a={}));var m,_=function(){function e(){var e;this._requestIdGenerator=(e=0,function(){return(e++).toString()})}return e.prototype.instrument=function(e){var t=this;if(!p.__RUMOneAPITrackerInstrumented){p.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,i=e.xhr;if("XMLHttpRequest"in p&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send,this._originalXhrOpen=XMLHttpRequest.prototype.open;var r=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.requestUrl=e[1],r._originalXhrOpen.apply(this,e)},XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=r._requestIdGenerator();return i.onRequest({request:this,id:o,type:a.xhr}),this.addEventListener("readystatechange",function(){4===e.readyState&&i.onResponse({request:e,id:o,type:a.xhr})}),r._originalXhrSend.apply(this,t)}}"fetch"in p&&void 0!==p.fetch&&(this._originalFetch=p.fetch.bind(p),p.fetch=function(e,i){return new Promise(function(r,o){var s=t._requestIdGenerator();n.onRequest({request:e,id:s,type:a.fetch}),t._originalFetch(e,i).then(function(e){n.onResponse({response:e,id:s,type:a.fetch}),r(e)},function(e){o(e)})})})}},e.prototype.undoInstrument=function(){p.__RUMOneAPITrackerInstrumented=!1,this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen),this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend),this._originalFetch&&(p.fetch=this._originalFetch)},e}(),h=n(26),b=n(22);n(315),function(e){e[e.own=0]="own",e[e.cors=1]="cors"}(m||(m={}));var g,v=function(e,t,n,a,i,r,o){this.url=e,this.duration=t,this.correlationId=n,this.status=a,this.startTime=i,this.endTime=r,this.name=o,this.clientDurationInMilliseconds=new Date(r).getTime()-new Date(i).getTime(),this.origin=e&&new h.e(e).getHost()};!function(e){e[e.Incomplete=1]="Incomplete",e[e.ReadyToUpload=2]="ReadyToUpload",e[e.Uploaded=3]="Uploaded",e[e.TimeOut=4]="TimeOut",e[e.Skipped=5]="Skipped"}(g||(g={}));var y=["EUPL","ScenarioId"],S=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,D=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/,I="4c338685-350e-4aae-a03e-fb969ab4dc98";function x(e){return null==e}var C="__default_rumone__",O={checkInterval:100,error_timeout:3e4,max_markers:200},w=function(){function e(e,t,n){void 0===n&&(n=O);var a=this;this._keyMetrics=y.slice(0),this.async=new r.e(this),this.dataStartTime=Date.now(),this._rumoneData={},this.dataState=g.Incomplete,this.controls=[],this.apis=[],this._apiBuffer={},this._loggingFunctions=[],this.euplBreakDown={},this.ttiBreakDown={},this.serverMetrics={},this.isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this.tempData={},this._settings={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this.undoAPIInstrument=function(){a._apiTracker.undoInstrument()},this._name=e,this.registerLoggingFunc(t),this._config=n,this.setPerfDataTimer(),this._platformDetection=new l.e,this._hookUnloadEvent(),this._apiTracker=new _}return e.getRUMOneLogger=function(t,n,a){void 0===t&&(t=C),void 0===a&&(a=O);var i=n||function(e,t){d.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var r=new e(t,i,a);t===C&&(e.rumOneLogger=r),e.Loggers[t]=r}catch(e){}return e.Loggers[t]},e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);return n<0&&this._loggingFunctions.push(e),function(){n>=0&&t._loggingFunctions.splice(n,1)}},Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){return this._TTIMeasurementEnabled()&&this.addExpectedKeyMetric("TTI"),this._FCIMeasurementEnabled()&&this.addExpectedKeyMetric("FCI"),this._keyMetrics},enumerable:!1,configurable:!0}),e.prototype.getPerformanceData=function(){return this._rumoneData},e.prototype.startAPIMeasurement=function(e){var t=this,n=e&&e.ignore||function(e){return!1},r=e&&e.getAPIName||function(e){},o=function(e){var n=e.id,i=e.request,r=e.type,o=new v;o.startTime=(new Date).toISOString(),o.startTimeRelative=t.now(),r===a.fetch&&(o.url="string"==typeof i?i:i.url),t._apiBuffer[n]=o};return this._apiTracker.instrument({fetch:{onRequest:o,onResponse:function(e){var a=e.response,o=e.id,s=t._apiBuffer[o];if(s&&!n(s.url)){var c=void 0,d=void 0;try{c=a.headers.get("SPClientServiceRequestDuration"),d=a.headers.get("SPSQLQueryCount")}catch(e){}var l=void 0;try{l=a.headers.get("SPRequestGuid")}catch(e){}s.name=r(s.url),s=Object(i.e)(Object(i.e)({},s),Object(i.e)(Object(i.e)(Object(i.e)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-s.startTimeRelative,status:a.status},c?{duration:Number(c)}:{}),d?{sqlRT:Number(d)}:{}),l?{correlationId:l}:{})),t.apis.push(s)}}},xhr:{onRequest:o,onResponse:function(e){var a,o,s=e.request,c=e.id,d=t._apiBuffer[c],l=s.responseURL||s.requestUrl;if(d&&!n(l)){var u=null!==(o=null===(a=s.getAllResponseHeaders())||void 0===a?void 0:a.toLowerCase())&&void 0!==o?o:"",f=u.indexOf("spclientservicerequestduration:")>=0&&s.getResponseHeader("SPClientServiceRequestDuration"),p=u.indexOf("spsqlquerycount:")>=0&&s.getResponseHeader("SPSQLQueryCount"),m=u.indexOf("sprequestguid:")>=0&&s.getResponseHeader("SPRequestGuid");d.name=r(l),d=Object(i.e)(Object(i.e)({},d),Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-d.startTimeRelative,status:s.status},f?{duration:Number(f)}:{}),p?{sqlRT:Number(p)}:{}),m?{correlationId:m}:{}),{url:l})),t.apis.push(d)}}}}),function(){t._apiTracker.undoInstrument()}},e.prototype.resetLogger=function(){this._emergencyUpload(),this._apiBuffer={},this.dataStartTime=(new Date).getTime(),this.dataState=g.Incomplete,this.isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this.controls=[],this.apis=[],this.tempData={},this._rumoneData={},this._settings={},this._keyMetrics=y.slice(0),this.clearPerfDataTimer(),this.setPerfDataTimer(),this.euplBreakDown={},this.ttiBreakDown={},this.serverMetrics={},this.clearResourceTimings(),Object(u.n)(this._getOwnMakers().map(function(e){return e.name})),e._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this._ttiPromise=void 0,this._fciPromise=void 0,this.logMessageInConsole("Reset performance Logger Done")},e.prototype.setSettings=function(e){this._settings=Object(i.e)(Object(i.e)({},this._settings),e)},e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})},e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]},e.prototype.setPerformanceDataPropertyValue=function(e,t){return e&&S.test(e)?(this._rumoneData[e]=t,!0):(console.error("key ".concat(e," does not confrim to the Regex ").concat(S)),!1)},e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)},e.prototype.ignoreExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)&&(this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=!0)},e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0},e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e},e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)},e.prototype.writeServerSideLatency=function(e,t){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=e,this._rumoneData.IISLatency=t)},e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}},e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)},e.prototype.readAPICallPerformanceData=function(){return this.apis},e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)},e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==o.e.fullPageLoad&&e!==o.e.none&&e!==o.e.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)},e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)},e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var a=t[e[n]];a&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(a))}this.isW3cTimingCollected=!0}}},e.prototype.collectW3cResourceTimings=function(t){void 0===t&&(t=void 0);var n=t||{},a=n.logSummery,r=void 0===a||a,o=n.start,s=void 0===o?0:o,c=n.end,d=void 0===c?Math.round(this.now()):c,l=n.columnNameOverride,u=void 0===l?function(e){return e}:l,f="logSummery=".concat(r,"|start=").concat(s,"|end=").concat(d,"|columnNameOverride=").concat(u),p=this._isW3cResourceTimingCollected[f];if(window.document&&!p&&performance&&performance.getEntriesByType){for(var m=performance.getEntriesByType("resource"),_=document.getElementsByTagName("iframe"),h=0;h<_.length;h++){var b=null;try{b=_[h].contentWindow.performance}catch(e){}b&&b.getEntriesByType&&m.concat(b.getEntriesByType("resource"))}var g={SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)}};g.CDN=e._isRequestFromCDN,g.ThirdParty=function(e){return!g.SharePoint(e)&&!g.CDN(e)};var v={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}};m=m.filter(function(e){return e.startTime>=s&&e.startTime<=d});var y=Object.keys(g);for(h=0;h<y.length;h++){var S=y[h],D=this.categorizeResourceRequests(m,{from:g[S],requestType:null});r&&this._logRUMOneData(u(S+"RequestCountTotal"),D.length);for(var I=Object.keys(v),x=0;x<I.length;x++){var C=I[x];r&&this._logRUMOneData(u(S+"RequestCount"+C),this.categorizeResourceRequests(D,{from:null,requestType:v[C]}).length)}if(D.length>0&&(r&&this._logRUMOneData(u(S+"RequestDownloadTime"),Math.round(D.reduce(function(e,t){return e+t.duration},0)/D.length)),"CDN"===S)){var O=JSON.stringify(D.map(function(e){return Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart),connect:Math.round(e.connectEnd-e.connectStart),domainLookup:Math.round(e.domainLookupEnd-e.domainLookupStart),redirect:Math.round(e.redirectEnd-e.redirectStart)},E(e,"workerStart")),E(e,"responseStart")),E(e,"responseEnd")),E(e,"secureConnectionStart"))}));this._logRUMOneData(u(S+"RequestNames"),O)}}this._isW3cResourceTimingCollected[f]=!0}},e.prototype.saveTempData=function(e,t){this.tempData[e]=t},e.prototype.readTempData=function(e){return this.tempData[e]},e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)},e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)},e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)},e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)},e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)},e.prototype.isRunning=function(){return!(this.dataState===g.Uploaded||this.dataState===g.TimeOut||this.dataState===g.Skipped)},e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this.euplBreakDown,e,t)},e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this.euplBreakDown,e,t,n)},e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this.euplBreakDown,e)},e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this.ttiBreakDown,e,t)},e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this.ttiBreakDown,e,t,n)},e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this.ttiBreakDown,e)},e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var a=e[n];a&&-1===t.indexOf(a)&&t.push(a)}this._rumoneData.Flights=JSON.stringify(t)}},e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,a=e.ExpFeatures;n<a.length;n++){var i=a[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t},e.prototype.collectODCClientRamps=function(e,t){for(var n=e.Ramps,a=void 0===n?{}:n,i=[],r=0,o=t;r<o.length;r++){var s=o[r];s.ODC&&"boolean"!=typeof s.ODC&&a[s.ODC]&&i.push(s.ODC)}this._rumoneData.Flights=JSON.stringify(i)},e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!x(e[n])&&(x(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])},e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e},e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})},e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t),Object(u.r)(t)},e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e},e.prototype.registerErrorHandler=function(e){},e.prototype.getMarkerTime=function(e){return Object(u.i)(e)},e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)},Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!1,configurable:!0}),e.prototype.collectPageNavigationInformation=function(){var e=null===performance||void 0===performance?void 0:performance.getEntries()[0];this._rumoneData.Redirects=e.redirectCount,this._rumoneData.Type=e.type},e._isRequestFromCDN=function(e){var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n)},e.prototype._measureTTI=function(){var e=this;if(this._rumoneData.TTISupported="PerformanceLongTaskTiming"in window,this._TTIMeasurementEnabled()&&!this._ttiPromise&&(this._ttiPromise=function(e){return Object(i.t)(this,void 0,void 0,function(){var t;return Object(i.i)(this,function(a){switch(a.label){case 0:return t=Object(i.e)({minValue:Math.round(window.performance&&performance.now?Math.round(performance.now()):Date.now()),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e),[4,n.ee(1,404)];case 1:return[2,a.sent().getFirstConsistentlyInteractive(t).then(function(e){return Object(i.e)(Object(i.e)({},e||{}),{options:t})})]}})})}(this._settings.TTISettings.TTIPolyfillSettings.options),this._ttiPromise.then(function(t){var n=t||{},a=n.tti,i=n.longTasks,r=n.options,o=a;if(x(a))a=NaN;else{var s=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;s&&(a=s(Math.round(a),e._rumoneData,"TTI"))}x(e._rumoneData.TTI)?e.addEUPLBreakdown("currentTTI",{data:JSON.stringify(a),needFlatten:!1}):e.addEUPLBreakdown("prevTTI",{data:JSON.stringify(e._rumoneData.TTI),needFlatten:!1}),e._rumoneData.TTI=a,i&&(e._rumoneData.TTILongTasks=JSON.stringify(i),f.t.isActivated(I,"02/24/2021")||(e._rumoneData.TTILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)),e._logLastRequestBeforeTTI(a,i,"TTI"),e.collectW3cResourceTimings({logSummery:!1,start:o-(a-e._rumoneData.EUPL),end:o,columnNameOverride:function(e){return"".concat(e,"OfTTI")}}),r&&e.addEUPLBreakdown("TTIOptions",{data:JSON.stringify(r),needFlatten:!1})})),this._FCIMeasurementEnabled()&&!this._fciPromise){if(f.t.isActivated("eff83b08-6883-438b-9f0e-59724a25b7e7","10/27/2021"))return void(this._rumoneData.FCI=NaN);var t=this._settings.TTISettings.TTIPolyfillSettings.getAbsoluteEUPL,a=t?t(this._rumoneData.EUPL):this.now();this._fciPromise=function(e){return Object(i.t)(this,void 0,void 0,function(){var t;return Object(i.i)(this,function(a){switch(a.label){case 0:return t={measurementStartTime:e,requiredMainThreadCPUIdleDurationInMilliseconds:1e3},[4,n.ee(1,760)];case 1:return[2,a.sent().getFirstCPUIdle(t)]}})})}(a),this._fciPromise.then(function(t){var n=t||{},a=n.fci,i=n.longTasks;if(x(a))a=NaN;else{var r=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;r&&(a=r(Math.round(a),e._rumoneData,"FCI"))}e._rumoneData.FCI=a,i&&(e._rumoneData.FCILongTasks=JSON.stringify(i),f.t.isActivated(I,"02/24/2021")||(e._rumoneData.FCILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)),e._logLastRequestBeforeTTI(a,i,"FCI")})}},e.prototype._logLastRequestBeforeTTI=function(t,n,a){var i=performance.getEntriesByType("resource");if(t&&n&&n.length>0&&i&&i.length>0){for(var r=n[n.length-1].start,o=i[0],s=0,c=i;s<c.length;s++){var d=c[s];d.responseEnd<r&&d.responseEnd>o.responseEnd&&(o=d)}var l,u;l=e._isRequestFromCDN(o)?o.name:this._processLastNetworkUrl(o.name),u=/\.aspx/i.test(o.name)?"ASPX":/\.js/i.test(o.name)?"JS":/\.css/i.test(o.name)?"CSS":/img/i.test(o.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(o.name)?"IMG":/aria\.microsoft\.com/i.test(o.name)?"Aria":/_api/i.test(o.name)?"API":"Other","TTI"===a?(this._rumoneData.TTILastRequestName=l,this._rumoneData.TTILastRequestType=u,this._rumoneData.TTILastRequestStartTime=o.startTime,this._rumoneData.TTILastRequestEndTime=o.responseEnd):(this._rumoneData.FCILastRequestName=l,this._rumoneData.FCILastRequestType=u,this._rumoneData.FCILastRequestStartTime=o.startTime,this._rumoneData.FCILastRequestEndTime=o.responseEnd)}},e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)},e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)},e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()},e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten},e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(a){if(n<e._config.max_markers){var i=a.name.substr(u.t.length)+".mark".concat(n++);t[i]=Math.round(a.startTime)}}),this.writeEUPLBreakdown(JSON.stringify(t))},e.prototype._getOwnMakers=function(){var t=this,n=e._markers,a=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return Object(u.a)().filter(function(e){return-1===a.indexOf(e.name)})},e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)},Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!1,configurable:!0}),e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n="".concat(this._name," ").concat(e)+" : "+JSON.stringify(t);console.log(n)}},e.prototype.isCollected=function(e){return!x(this.getPerformanceDataPropertyValue(e))},e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e},e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)},e.prototype.clearPerfDataTimer=function(){x(this.perfDataTimer)||(this.async.clearTimeout(this.perfDataTimer),this.perfDataTimer=null)},e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],a=0;a<e.length;a++){var i=e[a];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n},e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var a=t.filter(function(e){return"first-paint"===e.name});a&&1===a.length&&(e=a[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))},e.prototype.collectSupplementaryData=function(){this._setFCP(),this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(),this.setBrowseInfo(),this.setReferrer(),this._collectMemoryData(),this._collectPageServerData(),this._setAppInfo(),this._setTestName(),this._collectExperiments(),this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length,this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown),this._rumoneData.TTIBreakdown=JSON.stringify(this.ttiBreakDown),this._normalizeTTI()},e.prototype._normalizeTTI=function(){var e;this._rumoneData.PageTransitionType===o.e.fullPageLoad&&((null===(e=this._rumoneData.ScenarioId)||void 0===e?void 0:e.indexOf("SPPages"))>-1||!f.t.isActivated("c930d25d-de79-434f-ba7b-c2fbf0aa9204","09/01/2022")&&this._rumoneData.ScenarioId.indexOf("VivaHome")>-1)&&(this._rumoneData.TTI=this._rumoneData.FCI||this._rumoneData.TTI)},e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];a&&a._serverTime&&Date.now()-new Date(a._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)},e.prototype._setTestName=function(){var e=new h.e(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)},e.prototype.loopForDataCompleteness=function(){if(this.clearPerfDataTimer(),!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState))),this.logObjectForDebugging("Controls: ",this.controls),this.logObjectForDebugging("API Performance Data: ",this.apis),this.logObjectForDebugging("Temp Data: ",this.tempData),this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown),this.logObjectForDebugging("TTIBreakdown: ",this.ttiBreakDown),this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;this._updateState()}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()},e.prototype._updateState=function(){switch(this.dataState){case g.Incomplete:this.processControlRenderTime(),this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI(),0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=g.ReadyToUpload);break;case g.ReadyToUpload:this._uploadPerfData({emergency:!1})}},e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==g.ReadyToUpload){var e=Date.now();if(!(this.dataState===g.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t),this.dataState=g.TimeOut,this._uploadPerfData({emergency:!1})}}},e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++)x(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t]);return e},e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})},e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})},e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne(),this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData)this.dataState=g.Skipped,this.logMessageInConsole("Uploading perf data skipped as requested by the consumer");else if(n||this.dataState===g.ReadyToUpload||this.dataState===g.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var a=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",a)}),this.dataState=g.Uploaded,this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",a),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState)))}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state ".concat(this.dataState))}catch(e){t="PerformanceLogger error writing RUMOne data: ".concat(e),"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{this.isRunning()||(this._unhookUnloadEvent(),this._apiTracker.undoInstrument())}},e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)},e.prototype._FCIMeasurementEnabled=function(){var e=this._TTIPolyfillEnabled();return f.t.isActivated("CC5234AA-C7A5-4D4A-B6E5-52CC2A4E7078","11/4/2021")?e:!(!e||this._settings.TTISettings.FCIMeasurementSettings&&this._settings.TTISettings.FCIMeasurementSettings.disabled)},e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()},e.prototype.getReadableDataState=function(e){for(var t in g)if(e===Number(g[t]))return t;return"NaN"},e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++)this._logRUMOneData("Control".concat(t+1,"Id"),e[t].controlId),this._logRUMOneData("Control".concat(t+1,"RenderTime"),e[t].data.renderTime);var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}}),Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}},e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(n.data))}},e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,a=e;n<a.length;n++){var i=a[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t},e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var a=n[t];!a.ignoreForEUPL&&a.data&&a.data.renderTime&&e<a.data.renderTime&&(e=a.data.renderTime)}this._rumoneData.EUPL=e,"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}},e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile},e.prototype._collectMemoryData=function(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)},e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})},e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=[],a=0;a<this.apis.length;a++){var r=this.apis[a];if(r){e++,t+=r.duration,r.origin||(r.origin=new h.e(r.url).getHost()),r.hostType=new h.e(window.location.href).getHost()===r.origin?m.own:m.cors,r.url;var o=Object(i.r)(r,["url"]);n.push(o)}}this._rumoneData.APICallCount=e,this._rumoneData.APICallDurationSum=t,this._rumoneData.APICalls=JSON.stringify(n)},e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)},e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,a=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:a});this._rumoneData.AppInfo=i}}},e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"},e.prototype._writeBreakdown=function(e,t,n){if(t)try{var a=JSON.parse(t);for(var i in a)a.hasOwnProperty(i)&&this._addBreakdown(e,i,a[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}},e.prototype._addBreakdown=function(e,t,n,a){if(t&&!x(n)){if(x(e[t])||a){var i=this._isBreakdownValue(n)?n.data:n;e[t]=i}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||a)&&this._logRUMOneData(t,n.data)}},e.prototype._readBreakdown=function(e,t){return t?e[t]:e},e.prototype._processEUIIUrl=function(e){var t=new b.e(e||"");return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")},e.prototype._processLastNetworkUrl=function(e){var t=new b.e(e||"");if(t.authority.indexOf("lpcres")>0)return e;if(t.authority.indexOf("shell.cdn.office")>0)return e;var n=D.exec(e),a="";return n&&n.length>0&&(a="".concat(n[0])),"".concat(t.authority).concat(a)},e.rumOneLogger=void 0,e.Loggers={},e._markers={},e}();function E(e,t){var n;return t in e?((n={})[t]=Math.round(e[t]),n):{}}t.t=w},function(e,t,n){"use strict";n.d(t,"e",function(){return z});var a=n(0),i=n(67),r=n(458),o=n(188),s=n(219),c=n(7),d=n(123),l=n(49),u=n(160),f=n(171),p=n(166),m="Unknown",_="NoConnection",h=n(26),b=n(42),g=n(3),v="WWW-Authenticate",y="x-ms-diagnostics",S="X-SubStatusCode",D="X-SPO-ErrorCode",I="X-MSDAVEXT_Error",x="SPSQLQueryCount",C="x-virus-infected",O=function(){function e(e,t,n){this._request=e,this._url=t,this._webAbsoluteUrl=n&&n.webAbsoluteUrl,this._isCanaryRequest=n&&n.isCanaryRequest}return e.prototype.getSourceUrl=function(){return this._url},e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()},e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")},e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")},e.prototype.getStatus=function(){var e=-1;try{e=this._request.status}catch(e){}return"number"==typeof e?e:-1},e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")},e.prototype.getResponseType=function(){return this._request.responseType},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText},e.prototype.getErrorResponseText=function(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(C),authenticate:this.getResponseHeader(v)}:this.getResponseText()},e.prototype.parseError=function(){var e=this,t=new r.e;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,n=new r.e,a=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",a),t.addEventListener("error",i),t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){return t&&(t.removeEventListener("load",a),t.removeEventListener("error",i)),e})}(this._request.response).then(function(n){var a={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader(C),authenticate:e.getResponseHeader(v)};t.complete(a)}):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise()},e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n},e.prototype.getRedirectUrl=function(){return this._isCanaryRequest?403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl():403===this.getStatus()||401===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():void 0},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new h.e(t);n.setQueryParameter("ReturnUrl",b.e.encodeURIComponent(window.location.href)),e=n.toString()}else if(!g.e.isActivated("E01ED707-3C9F-4CD5-8ADF-8A5484D4A861","04/18/2023","Construct redirectUrl targetting Default.aspx")){var a=new u.e(this._url).authority;a&&(e="".concat(a,"/_forms/Default.aspx?ReturnUrl=").concat(encodeURIComponent(location.href)))}return e},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new h.e(t);n.setQueryParameter("Source",b.e.encodeURIComponent(window.location.href)),n.setQueryParameter("Type","list"),n.setQueryParameter("correlation",b.e.encodeURIComponent(this.getCorrelationId())),e=n.toString()}}return e},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new h.e(e);return t.setQueryParameter("ReturnUrl",window.location.href),t.toString()},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader(D),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t},e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),a=n.shift(),i=n.join(": ");e[a]=i})}return this.getResponseHeadersDictionary=function(){return e},e},e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)},e.prototype.getHeaderNumberValue=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e}(),w=n(122),E=n(65),A=function(){function e(e){var t;void 0===e&&(e={}),this._scope=new w.e,this._events=this._scope.attach(new E.t(this));var n=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||n&&new h.e(n).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),g.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?n?(this._webAbsoluteUrl=n,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1:this._alwaysGetDigest=null!==(t=e.alwaysGetDigest)&&void 0!==t&&t,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1,this._engagement=e.engagement,this._operationName=e.operationName}return e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)},e.prototype.dispose=function(){this._scope.dispose()},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0}},e.prototype.isRequestActive=function(){return!!this._currentRequest},e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,a=e.successCallback,i=e.failureCallback,r=e.uploadProgressCallback,o=e.additionalPostData,s=e.isRest,c=void 0===s||s,d=e.method,l=void 0===d?"POST":d,u=e.withCredentials,f=e.additionalHeaders,p=e.contentType,m=e.noRedirect,_=e.responseType,h=e.needsRequestDigest,b=void 0===h?this._needsRequestDigest:h,g=(new Date).toISOString(),v=new XMLHttpRequest;v.open(l,n,!0),"boolean"==typeof u&&(v.withCredentials=u),_&&(v.responseType=_),p?v.setRequestHeader("Content-Type",p):c?v.setRequestHeader("Content-Type","application/json;odata=verbose"):v.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var y=!1;if(f)for(var S in f)S&&(v.setRequestHeader(S,f[S]),"accept"===S.toLowerCase()&&(y=!0));y||v.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=v;var D=function(e){b&&e&&v.setRequestHeader("x-requestdigest",e),t._events.on(v,"readystatechange",function(){t._onReadyStateChange(v,n,a,i,m,g)}),r&&v.upload&&t._events.on(v.upload,"progress",function(e){r(e)}),v.send(o)};b?this._ensureRequestDigest(D,i):D()},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)},e.prototype._ensureRequestDigest=function(t,n){var a=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(a)?t(a.formDigestValue):this._ensureRequestDigestWorker(t,n)},e.prototype._ensureRequestDigestWorker=function(t,n){var a=this,r=new Date,o=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(o._requestCanaryForAuth=!0);var s=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof s?(e._requestDigestPromise||(e._requestDigestPromise=new i.t(function(i,c){o.getServerDataFromUrl({url:h.e.concatenate(s,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),o=JSON.parse(n).d.GetContextWebInformation;e._formDigests[a._webServerRelativeUrl]={serverTime:r.toISOString(),formDigestValue:o.FormDigestValue,formDigestTimeoutSeconds:o.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},i(e._formDigests[a._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0},failureCallback:function(a,i){t?t(void 0):n&&n(a,i),c(void 0),e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})})),e._requestDigestPromise.then(function(e){return t&&t(e),e})):n&&n(void 0,new l.e({code:"MissingWebForDigestAuth",isExpected:!1}))},e.prototype._onReadyStateChange=function(t,n,a,i,r,o){var s;if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),(s=t)&&s.isCancelled)i(void 0,new l.e({code:"RequestAborted",isExpected:!0}));else if(function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0}(t)){var c=new O(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),d=c.getStatus(),u=!r&&c.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===d){var f=c.getRedirectLoginPageUrl();try{u?window.location.href=c.getRedirectToErrorCustomPromptLocation():i(c)}catch(e){}f&&!r&&(window.location.href=f)}else{f=c.getAccessDeniedRedirectUrl();try{i(c)}catch(e){}f&&!r&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=f)}return}if(200===d||201===d||204===d)return void a(c);if(403===d)return e._requestDigestPromise=void 0,void(r?this._ensureRequestDigestWorker(void 0,function(e,t){return i(c,t)}):u?window.location.href=c.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0));401===d&&u&&(window.location.href=c.getRedirectToErrorCustomPromptLocation()),i(c)}else i(void 0,new l.e({code:_,isExpected:!0}))},e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}},e._formDigests={},e._requestDigestPromise=void 0,e}();function L(e){var t=e.options,n=t.url,r=t.authToken,o=t.telemetryHandler,s=t.useExactAuthToken,d=t.method,l=t.additionalHeaders,u=e.dataSyncClient,f=e.aadUserId,p=e.getData,m=function(){return p({url:n,telemetryHandler:o,authToken:r,useExactAuthToken:s})};return f?i.t.resolve(u).then(function(e){return e?function(e){var t=function(e,t){return function(n,i){var r=n.eventData,o=r.extraData,s={performanceEntry:o&&o.performanceEntry,httpStatus:o&&o.HttpStatus,correlationId:o&&o.CorrelationId,succeeded:r&&r.resultType===c.t.Success||!1,resultCode:r&&r.resultCode,endpoint:i},d=t&&t(n),l=e.onRequestComplete(s);return o.dataSyncQos=e.getQosInfo(),Object(a.e)(Object(a.e)({},d||{}),{eventData:Object(a.e)(Object(a.e)({},d?d.eventData:r),{extraData:Object(a.e)(Object(a.e)({},d?d.eventData.extraData:r.extraData),e.getQosInfo())}),canRetry:l&&(!d||d.canRetry)})}}(e,o);return e.getData({url:n,method:d,additionalHeaders:l},function(e,n){return p({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0,additionalHeaders:n})},m)}(e):m()}):m()}var k=n(29),M=n(21),P=n(28),T=n(89);function U(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,o=e.tokenProvider,s=e.getData,c=e.qosName,d=t.url,l=new u.e(d),f="".concat(l.authority,"/{ length: ").concat(l.path.length,", segments: ").concat(l.segments.length," }"),p=function(e,t){if(!o.getAuthToken)return i.t.resolve({authToken:void 0});var n=new r({name:"".concat(c,".getAuthToken").concat(t?".retry":""),url:f});return i.t.resolve(o.getAuthToken(e)).then(function(e){return e&&"string"!=typeof e?(n.end({resultType:P.e.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}),e):(n.end({resultType:P.e.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"}),{authToken:e})}).catch(function(e){return n.end(Object(T.e)(e)),i.t.reject(e)})},m=function(e,t){if(!o.getFormDigest)return i.t.resolve(void 0);var n=new r({name:"".concat(c,".getAuthToken").concat(t?".retry":""),url:f});return i.t.resolve(o.getFormDigest(e)).then(function(e){return n.end({resultType:P.e.Success,resultCode:e?"newDigest":"sameDigest"}),e}).catch(function(e){return n.end(Object(T.e)(e)),i.t.reject(e)})};if(!p&&!m)return s({url:d});var _={url:d,webAbsoluteUrl:n},h={url:d,webAbsoluteUrl:n};return p(_,!1).then(function(e){return e.authToken?e:m(h,!1).then(function(t){return e})}).then(function(e){return s({url:d,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){if(g.e.isActivated("CC9557F9-11DC-4B22-93B6-0D0CEB830342","05/03/2023","On failure, retry using OAuth or cookie if OAuth is unavailable")){if(e.authToken&&(r=void 0,R(t)?r={claimsChallenge:{authToken:e.authToken,claims:H(t),error:t}}:N(t)&&(r={expiration:{authToken:e.authToken,error:t}}),r))return p(Object(a.e)(Object(a.e)({},_),r),!0).then(function(n){return n.authToken&&n.authToken!==e.authToken?s({url:d,authToken:n.authToken,qosExtraData:{AuthCorrelationId:n.correlationId,AuthExpiration:n.expiresOn}}):i.t.reject(t)});if(o.getFormDigest){var n=void 0;if(R(t)?n={claimsChallenge:{claims:H(t),error:t}}:N(t)&&(n={expiration:{error:t}}),n)return m(Object(a.e)(Object(a.e)({},h),n),!0).then(function(e){return s({url:d})})}return i.t.reject(t)}var r=void 0;return R(t)||function(e){return!!e.authenticate}(t)?r={claimsChallenge:{authToken:e.authToken,claims:H(t),error:t}}:N(t)&&(r={expiration:{authToken:e.authToken,error:t}}),r?p(Object(a.e)(Object(a.e)({},_),r),!0).then(function(n){if(!n.authToken){var i=void 0;return R(t)?i={claimsChallenge:{claims:H(t),error:t}}:N(t)&&(i={expiration:{error:t}}),m(Object(a.e)(Object(a.e)({},h),i),!0).then(function(e){return n})}if(n.authToken===e.authToken)throw new Error("Failure retrieving new auth token via tokenFetcher");return n}).then(function(e){return s({url:d,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}})}).catch(function(e){return i.t.reject(e)}):i.t.reject(t)})})}var F="Bearer";function H(e){var t=e.authenticate,n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return g.e.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}function R(e){var t=e.authenticate;return!!(t&&t.slice(0,F.length)===F&&t.indexOf('error="insufficient_claims"')>-1)}function N(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var B="undefined"!=typeof window?window:void 0,j=B&&B.performance,V=g.t.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023"),z=function(){function e(e,t){var n,a,i,r,c,d,l,u,f;this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(a=this._pageContext)||void 0===a?void 0:a.tokenProvider,this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(r=this._pageContext)||void 0===r?void 0:r.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(c=null==t?void 0:t.apiEvent)&&void 0!==c?c:o.t,this._engagement=null!==(d=null==t?void 0:t.engagement)&&void 0!==d?d:s.e,this._normalizeErrors=!!e.normalizeErrors,this._getDataWithTokenProvider=null!==(l=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==l?l:U,this._getDataWithSyncClient=null!==(u=null==t?void 0:t.getDataWithSyncClient)&&void 0!==u?u:L,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null!==(f=null==t?void 0:t.noRedirect)&&void 0!==f?f:!!(null==t?void 0:t.tokenProvider)||void 0}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(t){var n=this,o=t.parseResponse,s=void 0===o?e.parseJSON:o,h=t.qosExtraData,b=t.additionalPostData,C=void 0===b?"":b,O=t.contentType,w=t.method,E=void 0===w?"POST":w,L=t.maxRetries,P=void 0===L?0:L,T=t.responseType,U=t.onUploadProgress,F=t.timeout,H=t.noTimeoutInLastRetry,R=void 0!==H&&H,N=t.webAbsoluteUrl,z=t.allowOAuth,G=void 0===z||z,K=this._pageContext,W=this._tokenProvider,q=this._getDataWithTokenProvider,Q=this._getDataWithSyncClient,Y=[];this._qosName&&Y.push(this._qosName),t.qosName&&Y.push(t.qosName);var J=Y.join("."),X=function(e){var o=e.url,b=e.telemetryHandler,w=e.authToken,L=e.useExactAuthToken,H=void 0!==L&&L,z=e.additionalHeaders,Q=!0,Y=new u.e(o),X="".concat(Y.authority,"/{ length: ").concat(Y.path.length,", segments: ").concat(Y.segments.length," }"),Z=function(e){var w=e.authToken,L=e.qosExtraData,q=t.crossSiteCollectionCall,Y=void 0!==q&&q,Z=t.noRedirect,$=void 0===Z?n._noRedirect:Z,ee=t.needsRequestDigest,te=void 0===ee||ee,ne=Object(a.e)(Object(a.e)(Object(a.e)({},t.additionalHeaders),V?{}:z),g.e.isActivated("3404B5AF-0FCD-496E-AE1A-7249248BACFE","10/5/2021","Send CollectSPPerfMetrics header for all SP data requests")?{}:{CollectSPPerfMetrics:x}),ae=!!g.e.isActivated("B11E1406-A736-464F-96CB-E2E64BF66881","05/02/2023","add allowOAuth flag to allow or skip OAuth completely (used with Acquire endpoint calls)")||G;if(ae&&w){var ie=!1;g.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","06/09/2021","check if auth token has auth header already, if yes, use exact auth token")||k.e.isFeatureEnabled({ECS:86137})||w.split(" ").length>1&&(ie=!0);var re=H||ie?w:"Bearer ".concat(w),oe=!1;for(var se in ne)se&&"authorization"===se.toLowerCase()&&(oe=!0);oe||(ne.Authorization=re),Y=!0,te=!1,$=!0}else ae&&M.e.isFeatureEnabled({ODB:60959})&&W&&(ne.Authorization="Bearer");var ce,de,le=new A(Object(a.e)(Object(a.e)({},K?Object(a.e)(Object(a.e)({webServerRelativeUrl:K.webServerRelativeUrl},g.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?{webAbsoluteUrl:Y?K.webAbsoluteUrl:N}:{webAbsoluteUrl:N||K.webAbsoluteUrl,alwaysGetDigest:Y}),{formDigest:{serverTime:K.serverTime,updateFormDigestPageLoaded:K.updateFormDigestPageLoaded,formDigestValue:K.formDigestValue,formDigestTimeoutSeconds:K.formDigestTimeoutSeconds}}):{}),{needsRequestDigest:te,engagement:n._engagement,operationName:n._qosName})),ue=B&&B.location&&new u.e(B.location.href).authority,fe=new u.e(o).authority,pe=d.e.getRUMOneLogger(),me=Date.now();return pe&&(Boolean(pe.readTempData("appDataFetchStart"))||pe.saveTempData("appDataFetchStart",me)),function(e){var t,n=e.onExecute,a=e.onCancel,o=e.timeout,s=e.canRetry,c=e.noTimeoutInLastRetry,d=0,l=Math.max(e.maxRetries,0),u=function(){var e=new i.t(n,function(){a(d>=l||!s())});return o&&(!c||d<l)?i.t.timeout(o,e):e};return t=d<l?function(e){var t,n=e.adjustRetries,a=e.async,i=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,d=e.delay,l=e.resetAttemptsOnRestart,u=e.retries,f=e.shouldRestart,p=0,m=new r.e(function(){t.cancel()});function _(e){f&&f()?(l&&(p=0),b()):m.complete(e)}function h(e){n&&(u=n(e)),p<u&&c(e)?(p++,i&&i(),"number"==typeof d&&a?a.setTimeout(b,d):b()):m.error(e)}function b(){(t=o()).then(_,h)}return b(),m.getPromise()}({canRetry:s,retries:l,callback:u,beforeRetry:function(){d++}}):u(),t}({timeout:F,onExecute:function(e,t){var i,r;i=ce=new n._apiEvent({url:X,name:J}),r=j&&j.now(),le.getServerDataFromUrl({url:o,successCallback:function(i,r){return function(d){var l=d.getResponseText();de=d.getServiceWorkerDataSourceHeader();var u,m,_,g,v=Object(f.e)(o,r),y=Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},h||{}),{needsRequestDigest:te,hasAuthToken:!!w,isCrossOrigin:!!ue&&ue!==fe,CorrelationId:d.getCorrelationId()}),L||{}),{HttpStatus:d.getStatus(),serviceWorkerDataSource:de||void 0,rawRequestDuration:v.duration,performanceEntry:JSON.stringify(v),serviceWorkerFetchInfo:d.getResponseHeader("X-ServiceWorkerFetchInfo")||void 0,SQLRT:d.getHeaderNumberValue(x),ServerDuration:d.getHeaderNumberValue("SPClientServiceRequestDuration")}),S=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(T,l)?m=s(l,d):_=l,S=!0}catch(e){u=e,g={resultType:c.t.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:y}}if(g||(g={resultType:c.t.Success,extraData:y}),b&&(g=b({response:m,eventData:g,serverData:d}).eventData),i.end(g),S)try{e(_||m)}catch(e){}else t(n._normalizeErrors?new p.e({code:"-1,parse_response",innerError:u,errorData:{status:d.getStatus()}}):void 0);le=void 0}}(i,r),failureCallback:function(e,i){return function(r,s){var d=Object(f.e)(o,i),u=Object(a.e)(Object(a.e)({},h||{}),{needsRequestDigest:te,hasAuthToken:!!w,isCrossOrigin:!!ue&&ue!==fe,rawRequestDuration:d.duration,performanceEntry:JSON.stringify(d)}),x="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(x=n._offlineDetection.offline),!r){var C=m,O=!0,E=0;s&&s instanceof l.e&&(C=s.code,O=s.isExpected,E=-1),!x||C!==_&&C!==m||(C="Offline");var A={status:E,code:C},L={resultType:O?c.t.ExpectedFailure:c.t.Failure,resultCode:C,extraData:u};return b&&(L=b({eventData:L,errorData:A}).eventData),e.end(L),void t(n._normalizeErrors?new p.e({errorData:A,innerError:s}):A)}var k=function(i){var o=void 0,s=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(y);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:y,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(I);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,h=p[2];u={source:I,code:_,message:c=void 0===h?"":h,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}if(!g.e.isActivated("653DFB77-4F5B-4F7E-BAAE-0AA791061E25","03/30/2023","Add extra error codes")){var b=e.getResponseHeader(D);if(b){var v=e.getResponseHeader("X-SPO-ErrorMessage");u={source:D,code:b,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}}if(!g.e.isActivated("32B53DE1-9D7F-48EE-BE6A-6D02852E7030","03/30/2023","Add extra error codes")){var x=e.getResponseHeader(S);x&&(u={source:S,code:x},n.order.push(u.source),n.map[u.source]=u)}return{codes:n,isExpected:t}}(r),d=s.isExpected,l=s.codes;if("object"==typeof i&&"number"==typeof i.status)o=i;else if("string"==typeof i){var f=void 0;try{f=JSON.parse(i)}catch(e){}if(f)if(f.error_description)o={code:"-1,".concat(f.error||"Unknown"),message:f.error_description},"policy_enforced"===f.error&&(d=!0);else if("string"==typeof f.error)o={message:f.error};else if(f.error&&f.error.message&&f.error.message.value){var _={source:p.t.spServiceResponse,code:f.error.code,message:"".concat(f.error.message.value),isDisplayable:!0};l.order.push(_.source),l.map[_.source]=_,o=f.error}else o=f.error||f["odata.error"]||{responseData:f}}var h=r.getStatus(),C=r.getCorrelationId(),O=r.getResponseHeader("SPGroupThrottle"),w=r.getResponseHeader(I);u=Object(a.e)(Object(a.e)({},u),{CorrelationId:C,HttpStatus:h,GroupThrottle:O,MSCorrelationVector:r.getResponseHeader("MS-CV")}),(401===h&&w||403===h||404===h||429===h||503===h||-1===h||0===h&&x)&&(Q=!1,d=!0),(o=o||{}).codes=l,o.status=h,o.retryAfter=r.getHeaderNumberValue("Retry-After"),o.authenticate=r.getResponseHeader(v),C&&(o.correlationId=C),O&&(o.groupThrottle=O);var E=o["@error.redirectUrl"],A=r.getRedirectUrl()||E;A&&(d=!0,o.redirectUrl=A);var L=JSON.stringify(o),k=l.map[p.t.spServiceResponse];k&&n._normalizeErrors&&!g.e.isActivated("B4426688-76EA-4718-8166-1A4F69314E42","04/18/2023","Simplify SPO message structure")&&(o.message=k.message);var M=l.order[0];M&&(_=l.map[M])&&(M===D&&_.message?(o.code="XSPOErrorMessage",o.message=_.message):_.code&&(o.code=_.code)),o.code||(o.code=m);var P="[".concat(h,"] ").concat(o.code),T={resultType:d?c.t.ExpectedFailure:c.t.Failure,error:L,resultCode:P,extraData:u};if(b){var U=b({eventData:T,errorData:o,serverData:r}),F=U.eventData,H=U.canRetry;F&&(T=F),!0!==H&&!1!==H||(Q=H),T.resultType===c.t.ExpectedFailure&&(d=!0)}var R=n._normalizeErrors?new p.e({errorData:o,isExpected:d}):o;R.codes&&R.codes&&(T.extraData.errorCodes=JSON.stringify(R.codes.map)),e.end(T),t(R)},M=r.getResponseType();M&&"text"!==M?r.parseError().then(k):k(r.getResponseText())}}(i,r),uploadProgressCallback:U,additionalPostData:C,method:E,additionalHeaders:ne,contentType:O,withCredentials:!w&&void 0,noRedirect:$,responseType:T,needsRequestDigest:te})},maxRetries:P,noTimeoutInLastRetry:R,canRetry:function(){return Q},onCancel:function(e){le&&(le.abort(),e&&le.dispose())}}).then(function(e){return le&&le.dispose(),e},function(e){return le&&le.dispose(),!ce.endTime&&i.t.isCanceled(e)&&ce.end({resultCode:"Canceled",resultType:c.t.ExpectedFailure}),i.t.reject(e)})};if(w)return i.t.resolve(w).then(function(e){return Z({url:o,authToken:e})});if(W)return q({apiEvent:n._apiEvent,getData:Z,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData},webAbsoluteUrl:!g.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")&&N||K&&K.webAbsoluteUrl,qosName:J,tokenProvider:W});if(K){if(K.getAuthToken)return i.t.resolve(K.getAuthToken()).then(function(e){return Z({url:o,authToken:e})});if(K.authToken)return i.t.resolve(K.authToken).then(function(e){return Z({url:o,authToken:e})})}return Z({url:o})},Z={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?Q({options:Z,aadUserId:null==K?void 0:K.aadUserId,dataSyncClient:this._dataSyncClient,getData:X}):X(Z)},e}();t.t=z},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"n",function(){return s}),n.d(t,"t",function(){return p});var a,i,r=n(22),o=n(35);!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(a||(a={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(i||(i={}));var s=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,a=e.multiGeoInfo,i=e.options,r=void 0===i?{}:i,o=r.path,s=void 0===o?void 0:o,c=r.listUrl,l=void 0===c?void 0:c,u=r.webUrl,f=void 0===u?void 0:u,p=r.mayInferListUrl,m=void 0!==p&&p;this._rawPath=s||void 0,this._rawListUrl=l||void 0,this._rawWebUrl=f||void 0,this.defaultFullWebUrl=d(t||void 0),this.defaultListUrl=d(n||void 0),this.multiGeoInfo=a,this.mayInferListUrl=m}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return c(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return c(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return c(this._getNormalizedListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return c(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return c(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return c(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=d(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=d(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?d(t):"".concat(this.defaultFullWebUrl,"/").concat(t)),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new r.e(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(o.t)(t,n)){var a=new r.e(t);e=Object(o.t)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new r.e(t);e=Object(o.t)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||Object(o.t)(t,n)||(e=Object(o.t)(new r.e(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new r.e(this.path).authority||this.listUrl&&new r.e(this.listUrl).authority||this.webUrl&&new r.e(this.webUrl).authority||this.defaultListUrl&&new r.e(this.defaultListUrl).authority||new r.e(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new r.e(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new r.e(t).path;if(void 0===a&&(void 0===this.webUrl||i&&f(u(i),u(this._getServerRelativeWebUrl())))||i&&f(u(a),u(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var o=this._getServerRelativeWebUrl();if(f(u(a),u(o))){var s=new r.e(a).segments[new r.e(o).segments.length];e="".concat(u(o)).concat(s)}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e="".concat(t).concat(n)),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new r.e(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new r.e(this.defaultFullWebUrl).path);else{var n=new r.e(t);e="".concat(n.segments.slice(0,-1).join("/"))}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new r.e(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&f(u(n),t=u(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&f(u(n),t=u(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new r.e(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl)),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(o.t)(new r.e(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(o.t)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=a.unknown;if(this._getIsCrossDomain())e=a.crossSite;else if(void 0!==this.webUrl)e=Object(o.t)(l(this.defaultFullWebUrl),l(this._getFullWebUrl()))?a.sameSite:a.crossSite;else{var t=new r.e(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(f(u(n),u(t))){var i=new r.e(l(n)),s=new r.e(l(t));e=i.segments.length-1===s.segments.length||i.segments.length-2===s.segments.length&&"Lists"===i.segments[i.segments.length-2]?a.sameSite:a.unknown}else e=a.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return i.sameGeo;var e=new r.e(this._getServerUrl()).authority;if(!e)return i.unknown;var t=this._getCurrentGeo();if(!t)return i.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(o.t)(n,t)?i.sameGeo:i.crossGeo:i.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var o=new r.e(n).authority.toUpperCase();!i&&t[o]||(e[o]=a),i&&(t[o]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var o=i[a],s=o.InstanceId,c=o.IsDefaultDataLocation;if(n(o.MySiteHostUrl,s,c),n(o.PortalUrl,s,c),n(o.RootSiteUrl,s,c),n(o.TenantAdminUrl,s,c),o.AdditionalUrls)for(var d=0,l=o.AdditionalUrls;d<l.length;d++)n(l[d],s,c)}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function c(e){return""===e?"/":e}function d(e){return"/"===e?"/":e}function l(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function u(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:"".concat(e,"/")}function f(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}var p=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?s:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:a,multiGeoInfo:i,options:e})},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return f});var a=n(67),i=n(7),r=n(129),o=n(45),s=n(27),c=n(21),d="DisableSubstrateSearch",l="https://outlook.office.com/search",u={ODB:1286},f=function(){function e(e,t){this._dataRequestor=new r.e({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation=t.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&c.e.isFeatureEnabled(u)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(d,s.e.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(d,!0,s.e.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return a.t.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){return t.end({resultType:i.t.Success}),e},function(n){return a.t.isCanceled(n)?(t.end({resultType:i.t.ExpectedFailure,resultCode:"Canceled"}),a.t.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:i.t.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){var t,n,a="".concat(l,"/api/v1/init?scenario=").concat("documentshare");this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:a,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(t=this._pageContext)||void 0===t?void 0:t.aadUserId,"@").concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadTenantId)},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.e("PeoplePicker",s.e.session))},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:Object(a.e)(Object(a.e)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:Object(a.e)(Object(a.e)({},e.extraData||{}),t.extraData||{})}:{})},e)}},function(e,t,n){"use strict";var a,i,r=n(0),o=n(60),s=n(66),c=n(136),d=n(8),l=Object(c.e)({eventName:"Beacon,",shortEventName:"Beacon"},{name:d.e.String,status:d.e.String,success:d.e.Boolean,retryCount:d.e.Number,totalRetries:d.e.Number,eventCount:d.e.Number}),u=n(41),f=n(159),p=n(184),m=function(){function e(e,t,n,a,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var r={};if(i)for(var o=0;o<i.length;++o)r[i[o].EventType]=r[i[o].EventType]+1||1;var s={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:a,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:r,Workload:e.workload||"",FarmLabel:e.farmLabel||"",FarmName:e.farmName||""};this._dataCompletenessJson=JSON.stringify(s)}return Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!1,configurable:!0}),e.prototype.send=function(){new p.e({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){})},e}(),_=n(160),h=n(191),b=function(){function e(e){this._handlerLoader=e}return e.prototype.attach=function(e){var t,n=!1;return this._getHandler().then(function(a){n||(t=a.attach(e))}),function(){n=!0,t&&t()}},e.prototype._getHandler=function(){var e=this._handlerLoader();return this._getHandler=function(){return e},e},e}(),g=n(67),v=n(3),y="AriaBeacon",S={logStartEvents:!1,Init:function(e,t,n,i){var o=this;void 0===i&&(i={});try{S.logStartEvents=!0;var c,d=x(t,i.platformDetection),f=new _.e(t.completenessCallbackEndpoint),p={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,farmName:t.farmName,callbackEndpoint:f},h={ariaLoader:function(){return g.t.resolve(n)},context:d,tenantToken:e,disableCookies:t.disableCookies,ariaLogConfiguration:{collectorUrl:t.collectorUrl},logStartEvents:S.logStartEvents,offlineDetection:i.offlineDetection,offlineCache:i.offlineCache,ariaQos:{isQosEvent:function(e){return l.isTypeOf(e)&&!!e.data&&e.data.name===y},reportQos:function(e){var t=e.result,n=e.statusCode,a=e.events;new l({name:y,retryCount:0,totalRetries:0,eventCount:a?a.length:0}).end({success:0===t,status:n+""}),""!==f.authority&&new m(p,t,n,(new Date).getTime(),a).send()}}},v=t.getAuthToken?new b(function(){return Object(r.t)(o,void 0,void 0,function(){var e;return Object(r.i)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t.getAuthToken()];case 1:return e=n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return[2,a=new I(Object(r.e)({userAuthToken:e},h))]}})})}):a=new D(h);return c=i.customManager?v.attach(i.customManager):v.attach(s.e),function(){c(),a=void 0}}catch(e){return e instanceof n.Exception&&(e=new Error("Aria error: ".concat(e.toString()))),u.e.log(e),a=void 0,function(){}}},updateContext:function(e,t){if(void 0===t&&(t={}),a){var n=x(e,t.platformDetection);a.updateContext(n)}},isInitialized:function(e){return!!a},flushTelemetry:function(){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(e){switch(e.label){case 0:return a?[4,a.flush()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}},D=(t.e=S,(i=d.t.requiredService,function(e){var t="function"==typeof i?i:function(){return i};return function(e){function n(n){var a=n.onLogEvent;return e.call(this,Object(r.e)(Object(r.e)({},n),{onLogEvent:function(e){var n=a?a(e):e;if(n.data)return Object(r.e)(Object(r.e)({},n),{data:Object(r.e)(Object(r.e)({},n.data),{privacyClassification:t(n)})})}}))||this}return Object(r.a)(n,e),n}(e)})(h.e)),I=function(e){function t(t){var n=t.context,a=void 0===n?{}:n,i=t.userAuthToken,o=t.userId,s=(t.context,Object(r.r)(t,["userAuthToken","userId","context"])),c=i&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(i),d=c&&c.puid?"Business":"Unknown",l=c&&c.app_displayname||"Unknown",u=c&&c.appid||"Unknown",f=function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""}(o,c,d),p=f?1:0,m=c&&c.tid||"Unknown";return e.call(this,Object(r.e)({context:Object(r.e)({AccountType:d,AppName:l,AppId:u,IsAuthenticated:p,SiteSubscriptionId:m,UserId:f},a)},s))||this}return Object(r.a)(t,e),t}(D);function x(e,t){void 0===t&&(t=new f.e);var n=Object(r.e)({AccountType:o.e[e.accountType],BrowserIsMobile:t.isMobile,BrowserIsPWA:t.isPWA,BrowserMajVer:t.browserMajor,BrowserMinVer:t.browserMinor,BrowserName:t.browserName,BrowserUserAgent:t.userAgent,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,OSName:t.osName,OSVersion:t.osVersion,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId||"",UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,ResourceTenantId:e.resourceTenantId,listId:e.listId,product:e.product,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:t.userAgent,ServerGU:e.sideBySideToken},e.context||{});return!v.t.isActivated("25407BCB-74C5-4CCE-BCBC-8B84FCBBB346","12/16/2022","Add __debugLoggerContext onto the window object to obtain logging context information.")&&(window.__debugLoggerContext={session:e.session,workload:e.workload,product:e.product}),n}},function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(67),r=n(286),o=n(188),s=n(28),c=n(49),d=n(26),l=n(171),u=n(92),f=n(48),p=n(86),m=n(22),_=n(167),h=n(21),b=n(3),g=window&&window.performance,v={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},y="Bearer",S=function(){function e(e,t){this._sendUrlToGetFormDigestKSActive=b.e.isActivated("2F2E0E27-606F-4542-90E2-56D10E78DC5B","03/24/2023","send url to getFormDigest"),this._sendSyncClientHeadersKs=b.t.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,s=t.apiEvent,c=void 0===s?o.e:s,d=t.cookieOrigin,l=t.isOffline,u=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=c,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=d,this._isOffline=l,this._dataSyncClient=u,this._encodingFixEnabled=!b.t.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!h.e.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._isPassAuthTokenInHeaderFeatureEnabled=h.e.isFeatureEnabled({ODB:!0,ODC:"PassAuthTokenInHeader"}),this._driveIdUrlCheckEnabled=!b.t.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var o=e.headers,h=void 0===o?{}:o,b=e.endpoint,S=e.driveUrl,I=e.driveId,x=e.apiName,C=e.disableLogging,O=void 0!==C&&C,w=e.timeout,E=e.onProgress,A=e.onUploadProgress,L=e.qosExtraData,k=e.apiVersion,M=void 0===k?"v2.0":k,P=e.needsAuthorization,T=void 0===P||P,U=e.postProcessQos,F=e.breakCache,H=e.allowCookies,R=e.hasContentType,N=void 0===R||R,B=e.useMultiPart,j=void 0!==B&&B,V=e.getErrorAsMessage,z=void 0!==V&&V,G=e.expectedErrors,K=n.path,W=n.accessToken,q=n.forceContentType,Q=void 0!==q&&q,Y=n.useExactAuthToken,J=void 0!==Y&&Y,X=n.headers;if(!b){var Z="v2.1"===M?M:void 0;b=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:Z,driveId:I}):t._urlDataSource.getVroomApiBaseUrl():void 0}if(t._driveIdUrlCheckEnabled&&S&&I&&("me"!==I?"".concat(b,"/drives/").concat(I):S)!==S)throw new c.e({code:"DriveIdAndDriveUrlMismatch"});var $=e.useAuthorizationHeaders,ee=void 0!==$&&$;t._isPassAuthTokenInHeaderFeatureEnabled&&(ee=!0);var te=Object(a.e)(Object(a.e)({},v),e.expectedErrorCodes||{}),ne=e.requestType,ae=void 0===ne?"GET":ne,ie=t._cookieOrigin,re=new m.e(K).authority?K:"".concat(b).concat(K),oe=function(n){var o,c,v="",y={};j?(v=f.e.generate(),y={"Content-Type":"multipart/form-data;boundary=".concat(v)}):y=Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&N||Q?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),z?{prefer:"rich-error-as-message"}:{}),h),t._sendSyncClientHeadersKs?{}:X),n.sessionToken&&n.sessionToken.tokenUrl&&0===K.indexOf("/drive/")?c=new d.e("".concat(n.sessionToken.tokenUrl,"/").concat(K.substring(7))):(c=new d.e(K),b&&!c.getScheme()&&(c=new d.e(b+K))),j&&(c.setQueryParameter("ump","1"),"POST"!==ae&&(h["X-HTTP-Method-Override"]=ae),ae="POST");var S,D=c.toString();if(!j&&n.sessionToken){var I=n.sessionToken,C=I.accessToken,k=I.proofToken,M=I.wlidToken,P=I.isBadger;if(M)y=Object(a.e)(Object(a.e)({},y),{Authorization:"wlid1.1 ".concat(M)});else if(ee){if(C){var T=P?"badger":"bearer",H=J?C:"".concat(T," ").concat(C);y=Object(a.e)(Object(a.e)({},y),{Authorization:H})}k&&(y=Object(a.e)(Object(a.e)({},y),{"X-PROOF_TOKEN":k}))}else C&&c.setQueryParameter("access_token",C),k&&c.setQueryParameter("prooftoken",k)}if(j){var R="";if(R+="--".concat(v,"\r\n"),R+="Content-Disposition: form-data;name=data\r\n",h)for(var B=0,V=Object.keys(h);B<V.length;B++){var W=V[B];R+="".concat(W,": ").concat(h[W],"\r\n")}R+="Content-Type: application/json\r\n";var q=n.sessionToken;C=q.accessToken,P=q.isBadger,C&&(R+="Authorization: ".concat(T=P?"badger":"bearer"," ").concat(C,"\r\n")),z&&(R+="prefer: rich-error-as-message\r\n"),R+="\r\n",R+="".concat(void 0!==e.postData?e.postData:"","\r\n"),R+="--".concat(v,"--")}if(F&&c.setQueryParameter("r",Math.random().toFixed(8)),(null===(o=n.sessionToken)||void 0===o?void 0:o.authKey)&&c.setQueryParameter("authKey",n.sessionToken.authKey),!O){var Y=new m.e(D),Z={url:"".concat(Y.authority,"/{ length: ").concat(Y.path.length,", segments: ").concat(Y.segments.length," }"),name:"".concat(t._apiName,"DataRequest.").concat(x),extraData:L};S=new t._apiEvent(Z)}var $=c.toString(),ne=g&&g.now();return r.e.start({url:$,headers:y,method:ae,json:R||e.postData||"",requestTimeoutInMS:w,withCredentials:n.useCookies,onProgress:E,onUploadProgress:A,responseType:e.responseType||void 0}).then(function(t){var n,a,i=Object(l.e)($,ne);if(S){var r=null!==(a=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"",o={resultType:s.e.Success,extraData:{rawRequestDuration:i.duration,performanceEntry:JSON.stringify(i),requestId:r.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):r.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:r.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null}};S.end(o)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var r,o=function(e,t){return U&&(e=U(e,t)),S&&S.end(e),i.t.reject(t)},d=Object(l.e)($,ne);if(e instanceof Error){var f=i.t.isCanceled(e),m=f?s.e.ExpectedFailure:s.e.Failure,h={error:e.message,resultCode:f?"Canceled":"",resultType:m,extraData:{rawRequestDuration:d.duration,performanceEntry:JSON.stringify(d)}};return o(h,e)}if(e.responseText)try{r=JSON.parse(e.responseText)}catch(e){}if(z)try{var b=t._encodingFixEnabled?JSON.parse(Object(_.e)(r.error.message)):JSON.parse(atob(r.error.message));r={error:b}}catch(e){}var g=e.status,v=e.statusText,y=(r||{}).error,D=void 0===y?{}:y,I=D.message,x=void 0===I?"":I,C=D.innerError,O=void 0===C?{}:C,w=O.stackTrace,E=void 0===w?"":w,A=O.debugMessage,k=void 0===A?"":A;return(g||!t._isOffline?i.t.resolve(!1):t._isOffline()).then(function(t){var i,l,f=t?"Offline":"",m=null!==(l=null===(i=e.getAllResponseHeaders())||void 0===i?void 0:i.toLowerCase())&&void 0!==l?l:"",_=m.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||m.indexOf("request-id")>=0&&e.getResponseHeader("request-id"),h=t||!!Object(u.t)(r,g,function(e){return te[e]}),b=new u.e(new Error(x||f),{response:r,status:g,request:e,correlationId:_,isExpected:h});G&&Object(p.isExpectedError)({code:b.code,message:x},G)&&(h=!0);var y={resultType:h?s.e.ExpectedFailure:s.e.Failure,error:x,resultCode:b.code,extraData:Object(a.e)(Object(a.e)(Object(a.e)({},L||{}),Object(u.n)(b)),{stack:E,httpStatus:g,httpStatusText:v,requestId:_,correlationId:_,MSCorrelationVector:m.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:k,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:c.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:d.duration,performanceEntry:JSON.stringify(d)})};return o(y,b)})})},se=t._sessionManagementProvider;if(T){if(W)return oe({sessionToken:W});var ce=new m.e(re).authority;if(H&&ce&&ie&&ce===ie)return se&&se.getFormDigest&&"GET"!==ae?se.getFormDigest(t._sendUrlToGetFormDigestKSActive?void 0:re).then(function(e){return oe({digestValue:e,useCookies:!0})}):oe({useCookies:!0});if(se&&se.getSessionToken){var de={apiVersion:M,endpoint:b,driveUrl:S,path:re};return i.t.resolve(se.getSessionToken(de)).then(function(e){return oe({sessionToken:e}).catch(function(t){return e&&function(e){if(e instanceof u.e){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,y.length)===y&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?se.getSessionToken(Object(a.e)(Object(a.e)({},de),{claimsChallenge:{sessionToken:e,claims:D(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?oe({sessionToken:n}):i.t.reject(t)}):i.t.reject(t)})})}if(se&&se.getToken)return se.getToken(M,re).then(function(e){return oe({sessionToken:e})})}return oe({})},o=Object(a.e)({},e);return!b.e.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,r=e.getData,o=function(){return r(n)};return i.t.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t,n){var i=Object(a.e)(Object(a.e)({},e.options),{path:t.url,accessToken:{accessToken:t.authToken},forceContentType:!0,useExactAuthToken:!0,headers:n});return r(i)},o)}(t):o()})}({dataSyncClient:this._dataSyncClient,options:o,getData:n}):n(o)},e}();function D(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return b.e.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}t.t=S},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a,i=n(160),r=n(112);function o(e,t,n){var a=Object(r.t)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))},function(e,t,n){"use strict";var a,i,r=n(0),o=n(21),s=n(128),c=n(3),d=n(155);function l(){return n.ee(7,"aria-lib")}var u={ODB:588,ODC:"EnableAriaLogging",OneDrive:!0,Fallback:!1},f={ODB:-990,ODC:"ForceEnableAria"},p=function(){function e(){}return e.Init=function(e,t,n,i,r){void 0===n&&(n=l),e&&m(t)&&(a=n().then(function(n){s.e.Init(e,t,n,{offlineDetection:i,customManager:r})},function(e){}))},e.InitCustomerPromise=function(e,t,n,a){void 0===n&&(n=l),e&&m(t)&&(i=n().then(function(n){s.e.Init(e,t,n,{offlineDetection:a,customManager:Object(d.e)()})},function(e){}))},e.UpdateContext=function(e){a&&a.then(function(){s.e.updateContext(e)}).catch(function(){}),i&&i.then(function(){s.e.updateContext(e)}).catch(function(){})},Object.defineProperty(e,"logStartEvents",{get:function(){return s.e.logStartEvents},set:function(e){s.e.logStartEvents=e},enumerable:!1,configurable:!0}),e.flushTelemetry=function(){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(e){switch(e.label){case 0:if(!a)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,s.e.flushTelemetry()];case 2:case 3:return e.sent(),[3,4];case 4:return[2]}})})},e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,a=Math.floor(t/60);return"".concat(e>0?"-":"+").concat(a>=10?a:"0".concat(a),":").concat(n>=10?n:"0".concat(n))},e}();function m(e){var t=e.version;return!(!c.t.isActivated("010437DC-D681-4308-A21E-8BD4ADE3783C","11/12/2021","Use session storage TAB test running flag to bypass client-side logging.")&&_("_isRunningTABTest"))&&("dev"!==t&&o.e.isFeatureEnabled(u)||!!o.e.isFeatureEnabled(f)||_("enableAriaUpload"))}function _(e){var t=!c.t.isActivated("6DC50D29-3FD6-465C-9E8D-80A877497A9D","10/10/2022","Ensure that a boolean value is returned and not undefined.");try{if("sessionStorage"in window&&window.sessionStorage){var n=window.sessionStorage[e],a=n&&"true"===n.toLowerCase();return t?!!a&&"undefined"!=typeof console&&!!console:a&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}t.e=p},function(e,t,n){"use strict";n.d(t,"n",function(){return h}),n.d(t,"e",function(){return g}),n.d(t,"a",function(){return v}),n.d(t,"t",function(){return y});var a,i=n(0),r=(n(249),n(304),n(305),n(306),n(301),n(239)),o=n(131),s=n(66),c=n(26),d=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi,l=["guestaccesstoken","access_token","prooftoken","tempauth","share","auth_token","auth_key","originalPath","querytext","querytemplate","selectproperties","hithighlightedproperties","refiners","sortlist","refinementfilters","collapsespecification","hiddenconstraints","querytemplatepropertiesurl","zerotermsuggestions","pageinfo","immediacyquerystring","immediacytitle","immediacyurl","k","q","InplaceSearchQuery","Default"],u=["/_api/search/","/_api/searchsetting/","/results.aspx","/osssearchresults.aspx","/peopleresults.aspx","/conversationresults.aspx","/videoresults.aspx","/sharepoint.aspx","/search.aspx","RenderListDataAsStream"],f=n(3),p=n(48),m=n(60),_=!f.t.isActivated("05CA5404-D3C3-45DE-9B8A-9025897012D1","1/31/2023","Use CloudType instead of Env from spPageContext to determine Aria environment");function h(e){void 0===e&&(e={});var t,n=e.pageContext,a=void 0===n?window._spPageContextInfo:n,i=e.spModuleLink,r=void 0===i?window._spModuleLink:i,o=a.env||"devbox",s=a.cloudType||o,c="",d="",l=o;if(_)switch(l=s,s.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":t="ppe";break;default:l="prod",t="prod"}else switch(o.toLowerCase()){case"prod":case"dprod":t="prod";break;default:t="ppe"}return r&&(c=r.buildNumber,d=r.manifestName,r.usingRedirectCookie&&(c="dev")),{version:c,manifest:d,appEnvironment:l,ariaEnvironment:t}}function b(e){return e&&e.length>36&&(e=e.replace(/[{}]/g,"")),e}function g(e){var t=function(e){var t=h(e).ariaEnvironment,n=void 0===t?"ppe":t;return n&&e.tokens[n]}(e),n=function(e){if(a)return a;var t=e.pageContext,n=void 0===t?window._spPageContextInfo:t,i=h(e),r=i.version,o=i.manifest,s=i.appEnvironment,c=n.isAnonymousGuestUser,d=n.currentUICultureName,l=n.systemUserKey,u=n.userLoginName,f=n.siteSubscriptionId,_=n.farmLabel,g=n.farmName,v=n.siteId,y=n.webTemplate,S=n.webId,D=n.ariaCollectorUrl,I=n.CorrelationId,x=n.cloudType,C=n.getAuthToken,O=n.homeTenantId,w=n.listId,E=n.SideBySideToken;return a={isAuthenticated:!c,market:d,session:e.sessionId||p.e.generate(),version:r,manifest:o,userId:l,accountType:u?m.e.Business:m.e.BusinessAnonymous,siteSubscriptionId:f,farmLabel:_,farmName:g,collectorUrl:D,environment:s,workload:e.workload,disableCookies:c,siteId:b(v),webTemplateId:y,webId:b(S),context:e.context,pageCorrelationId:I,cloudType:x,getAuthToken:C,resourceTenantId:O,listId:b(w),sideBySideToken:E,product:e.product}}(e);n&&(o.e.Init(t,n,e.ariaLoader,e.offlineDetection,e.customManager),e.initCustomerPromise&&o.e.InitCustomerPromise(t,n,e.ariaLoader,e.offlineDetection))}function v(e,t){var n;a&&(n=f.t.isActivated("822FAA33-162E-4C69-9EFA-C5212C551A18","12/16/2022","Actually persist InitContext value when updating the Aria Context.")?Object(i.e)(Object(i.e)({},a),t):function(e){return a?a=Object(i.e)(Object(i.e)({},a),e):null}(t),o.e.UpdateContext(Object(i.e)(Object(i.e)({},n),{context:Object(i.e)(Object(i.e)({},a.context),e)})))}function y(){if(a)return o.e.flushTelemetry()}s.e.cleanString=function(e,t,n){return function(e,t){void 0===t&&(t={});var n,a=t.keyDeclaration,i=t.pathsToSanitize,r=void 0===i?[]:i,o=t.keysToSanitize,s=void 0===o?[]:o;if(a&&a.isKey&&(e=e.replace(d,"<guid>")),e.indexOf("http")<0)return e;try{n=new c.e(e)}catch(t){return e}if(""===n.getAuthority())return e;for(var l=e,u=!1,f=0;f<r.length;f++)if(n.getPath().indexOf(r[f])>=0){u=!0;break}if(u)l="".concat(n.getScheme(),"://").concat(n.getAuthority()).concat(n.getPath(),"<scrubbedquerystring>...");else{for(var p=n.getQueryAsObject(),m=0;m<s.length;m++){var _=s[m];p[_]&&(p[_]="<scrubbed>")}n.setQueryFromObject(p),l=n.getDecodedStringForDisplay()}return l}(e,{key:t,keyDeclaration:n,keysToSanitize:l,pathsToSanitize:u})},r.e.init()},function(e,t,n){"use strict";n.d(t,"t",function(){return C}),n.d(t,"n",function(){return O}),n.d(t,"a",function(){return w}),n.d(t,"e",function(){return A}),n(0);var a=n(141),i=(n(175),n(52)),r=n(35),o=n(29),s=n(74);function c(e,t,n,i){return a[["RelativeDateTime_",e,n?"Future":"",i?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function d(e,t,n,a){var i=c(t,!!a&&n,a),o=c(t,!1,a,!0);return(Object(r.i)(i,o,e)||"").replace("{0}",e+"")}var l={};function u(e,t){return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(l[t]||(l[t]=new Intl.DateTimeFormat(t)),l[t].format(e)):e.toLocaleDateString(t)}var f,p,m,_,h,b,g,v,y,S,D=n(3),I=void 0,x={ODB:1469,ODC:"ChromiumDateFix"};function C(e,t){return void 0===t&&(t=!1),function(e,t,n){void 0===n&&(n=!1);var a=Date.now()-e.getTime();if(a<-5*s.n)return u(e,t);if(a<s.n)return c("LessThanAMinute",n);if(a<s.s)return c("AboutAMinute",n);if(a<s.t)return d(Math.floor(a/s.n),"XMinutes");if(a<s.o)return c("AboutAnHour",n);if(a<s.e)return d(Math.floor(a/s.t),"XHours");if(a<s.r){var i=e.toLocaleTimeString(t);return c("YesterdayAndTime",n).replace("{0}",i)}return a<s.a?d(Math.floor(a/s.e),"XDays"):u(e,t)}(e,E(i.e.language),t)}function O(e,t){if(!e)return"";g||function(){var e=f(),t=function(){if(void 0===p)try{var e=f();(new Date).toLocaleDateString(e,{timeZone:"UTC"}),p=!0}catch(e){p=!1}return p}();if(window.Intl&&window.Intl.DateTimeFormat){var n={},a={hour:"2-digit",minute:"2-digit"};m=new Intl.DateTimeFormat(e,n),_=new Intl.DateTimeFormat(e,a),t&&(n.timeZone="UTC",a.timeZone="UTC"),h=new Intl.DateTimeFormat(e,n),b=new Intl.DateTimeFormat(e,a),g=m.format,v=_.format,y=h.format,S=b.format}else g=y=function(t){return t.toLocaleDateString(e)},v=S=function(t){return t.toLocaleTimeString(e)}}();var n=s.c(new Date,e);return(t?n?S:y:n?v:g)(e)}function w(e,t){return s.l(e,E(i.e.language),t)}function E(e){if(void 0===I)try{I=o.e.isFeatureEnabled(x)}catch(e){I=!1}return I&&function(e){if(void 0===k&&function(){k={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,a=L;n<a.length;n++){var i=a[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(k[i]=!0)}}catch(e){}}(),e)return e=e.toLowerCase(),k[e]}(e)?"en":e}function A(){var e=new Date(2e3,11,22);return e.toLocaleDateString(E(i.e.language),{day:"numeric",month:"numeric",year:"numeric"}).replace(e.getDate().toString(),"DD").replace((e.getMonth()+1).toString(),"MM").replace(e.getFullYear().toString(),"YYYY")}f=function(){for(var e,t=0,n=D.t.isActivated("6f22587b-a676-47a0-b10c-3e037c3f7b14","03/11/2022","Use currentCultureName to display numbers and dates.")?[window.$Config&&window.$Config.mkt,i.e.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,i.e.cultureLCID,i.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var a=n[t];try{(new Date).toLocaleDateString(a),e=a;break}catch(e){}}return e=E(e),f=function(){return e},e};var L=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"],k=void 0},,,function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(60),r=n(66),o=n(8),s=n(28),c=n(86),d=n(200),l="GetSchemaException";function u(e,t,n){var a={resultType:e};return t&&(a.resultCode=t),n&&(a.error=n),a}var f=function(e){function t(t,n){return e.call(this,t,i.t.Start,n)||this}return Object(a.a)(t,e),t.instrumentPromise=function(e,t,n,a,i,r,o){var c,f=new this(e,o);i&&f.setTimeout(i,r);try{c=t()}catch(e){throw f.end(u(s.e.Failure,"PromiseCreationFailed",e.toString())),e}return c.then(function(e){var t;if(n)try{t=n(e)}catch(e){t=u(s.e.Failure,l,e.toString())}else t=u(s.e.Success);f.end(t)},function(e){var t;if(a)try{t=a(e)}catch(e){t=u(s.e.Failure,l,e.toString())}else t=e?u(e instanceof Error&&"Canceled"===e.name?s.e.ExpectedFailure:s.e.Failure,void 0,Object(d.e)(e)):u(s.e.Failure);f.end(t)}),c},t.prototype.setTimeout=function(e,t){var n=this;this._clearTimeout(),t||(t=u(s.e.Failure,"Timeout")),this.timeoutId=window.setTimeout(function(){n.end(t)},e)},t.prototype.verbose=function(e){if(!this.endTime&&this._isQosEvent()){var t=this.data;c.verbose(e,t.name)}},t.prototype.end=function(e){if(!this.endTime){this.endTime=e&&e.endTimeOverride||r.e.getTime();var t=Object(a.e)({duration:this.endTime-this.startTime},e);if(this._setData(t),this._logEvent(i.t.End),this._isQosEvent()){var n=this.data;n.error&&c.log(n.error,n.name,n.resultCode,n.resultType)}this._clearTimeout()}},t.prototype._clearTimeout=function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)},t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0},t}(i.n);function p(e,t,n){var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t}(f),s=Object(a.e)(Object(a.e)({},t),{duration:{isPrefixingDisabled:!0,type:o.e.Number}});return Object(i.a)(r.prototype,e,s,n),r}},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function i(e){return"function"==typeof e.dispose}function r(e,t){var n=e,i=n.dispose,r="function"==typeof i&&i.disposalChain||function(e){var t=new a(e),n=e.dispose,i=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=i,i.disposalChain=t,t}(n);return r.addCallback(t),n}},function(e,t,n){"use strict";var a=function(){function e(t,n){if(void 0===t&&(t=0),void 0===n&&(n=0),t instanceof e){var a=t;this.x=a.x,this.y=a.y}else this.x=t,this.y=n}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n},e.getCenter=function(t){return t.reduce(function(e,t){return e.add(t)},e.ORIGIN).scale(1/t.length)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},e.prototype.negate=function(){return new e(-this.x,-this.y)},e.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.unit=function(){var e=this.abs();return this.scale(e&&1/e||0)},e.prototype.toString=function(){return"[Point ".concat(this.x,", ").concat(this.y,"]")},e.ORIGIN=new e,e}();t.e=a},,function(e,t,n){"use strict";function a(e){return e}n.d(t,"e",function(){return a})},,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.ScriptLoaded="share_scriptsLoaded",e.UIReady="share_uiReady",e.Ready="share_ready",e.Error="share_error",e.Resize="share_resize",e.GrantAccessCompleted="share_grantAccessCompleted",e.Dismiss="share_dismiss",e.ReadyForRecipients="share_readyForRecipients",e.OutlookClicked="share_outlookClicked",e.SendRecipients="atMention_defaultRecipients",e.ManageAccessClicked="share_manageAccessClicked",e.ShareCompleted="share_completed",e.MakeVisible="share_makeVisible",e.Destruct="share_destruct",e.ResetMakeVisible="share_resetMakeVisible",e.InstantLoadReady="share_instantLoadReady",e.ShareContextInformation="share_postContextInformation",e.Started="share_started",e.LinkSettingCompleted="share_linkSettingsCompleted",e.GetToken="share_getToken",e.DocumentInformation="share_documentInformation",e.SharingInfoBarInformation="share_sharingInfoBarInformation",e.SharingStoreReady="share_sharingStoreReady"}(a||(a={}))},function(e,t,n){"use strict";var a;!function(e){e[e.anyone=0]="anyone",e[e.workGroup=1]="workGroup",e[e.specificPeople=2]="specificPeople",e[e.onlyYou=3]="onlyYou",e[e.existing=4]="existing",e[e.chat=5]="chat",e[e.mail=6]="mail"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0},this._resizeCallback=e,this._callbackDelayMilliseconds=20}return e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)},e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback()),this._cachedRect=n}},e}()},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){var e,t;this.promise=new Promise(function(n,a){e=n,t=a}),this.resolve=e,this.reject=t}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(124),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.noRedirect,s=t.dataRequestorType,c=void 0===s?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r,noRedirect:o})||this}return Object(a.a)(t,e),t}(i.t):s,d=e.dataSourceName,l=void 0===d?"DataSource":d;this.dataRequestor=new c({qosName:l})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_){void 0===i&&(i="POST");var h=e(),b=a&&a(),g=this.needsRequestDigest(h);return this.dataRequestor.getData({url:h,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:g,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_})},e}();t.t=r},function(e,t,n){"use strict";function a(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}n.d(t,"e",function(){return a})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(66);function i(){return window.CUSTOMERPROMISE_MANAGER=window.CUSTOMERPROMISE_MANAGER||Object(a.t)()}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("react-lib"),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.IconButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.IconButton:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var r=n(382),o=n(418);function s(e){var t=e.iconProps,n=e.onClick,i=e.ariaLabel,s=e.tooltipContent,d=e.menuProps,l=e.menuIconProps,u=e.className,f=e.directionalHint,p=e.disabled,m=e.automationId;return a.createElement(r.e,{content:s,id:s,calloutProps:c,directionalHint:f},a.createElement(o.e,{className:u||"IconButton",iconProps:t,onClick:n,ariaLabel:i,menuProps:d,menuIconProps:l,disabled:p,"data-automationid":m}))}var c={gapSpace:0,calloutMaxWidth:180}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0),i=function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,r=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(r),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(r),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),u=r.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!d&&r.indexOf("windows nt 10")>-1,isWindows7:!d&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:i})}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl"}(a||(a={}));var i=function(e,t){void 0===e&&(e=""),void 0===t&&(t=!1);var n=e.indexOf("//"),i=e.indexOf("/"),o=n>-1&&n<=i?n+"//".length:-1,s=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,o),c=s&&s.slice(o),d=e.slice(s.length),l=s?a.absolute:t&&r.test(e)?a.dataUrl:"/"===d[0]?a.serverRelative:a.relative,u=d.split("/");this.authority=s,this.domain=c,this.format=l,this.path=d,this.segments=u,this.value=e},r=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/},function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return u});var a=n(67),i=n(21),r=n(7),o=n(45),s=n(27),c={ODB:387},d="https://graph.microsoft.com",l="DisableGraph",u=function(){function e(e,t){this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.e.isFeatureEnabled(c);return this._dataStore&&(e=e&&!this._dataStore.getValue(l,s.e.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(l,!0,s.e.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return a.t.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new r.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(d).then(function(e){return t.end({resultType:r.t.Success}),e},function(n){return a.t.isCanceled(n)?(t.end({resultType:r.t.ExpectedFailure,resultCode:"Canceled"}),a.t.reject(n)):(t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:r.t.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.e("PeoplePicker",s.e.session))},e}()},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid",e[e.odcWac=37]="odcWac",e[e.outlookGroupsWeb=38]="outlookGroupsWeb",e[e.fluid=39]="fluid",e[e.modernFileExplorer=40]="modernFileExplorer",e[e.listsHome=41]="listsHome",e[e.listsIos=42]="listsIos",e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",e[e.officeFeed=44]="officeFeed",e[e.searchUx=45]="searchUx",e[e.consumerList=46]="consumerList",e[e.shareDemo=47]="shareDemo",e[e.onePlayer=48]="onePlayer",e[e.windowsShare=49]="windowsShare",e[e.streamIos=50]="streamIos",e[e.streamAndroid=51]="streamAndroid",e[e.loopIos=52]="loopIos",e[e.outlookAndroid=53]="outlookAndroid",e[e.outlookiOS=54]="outlookiOS",e[e.whiteboard=55]="whiteboard",e[e.businesscentral=56]="businesscentral",e[e.mslens=57]="mslens",e[e.pbidesktop=58]="pbidesktop",e[e.oneup=59]="oneup",e[e.sharePointPages=60]="sharePointPages",e[e.streamOnline=61]="streamOnline"}(a||(a={}))},function(e,t,n){"use strict";var a,i;function r(e,t){return a&&i===e||(a=function(e,t){var n,a=t||window._spPageContextInfo;return a&&(n=e.webThemeProvider(a)),n}(e,t),i=e),a}n.d(t,"e",function(){return r})},function(e,t,n){"use strict";var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton{font-size:.875rem;font:-apple-system-title1;margin:0;padding:0;border-radius:.25rem;min-height:2rem;height:fit-content}.od-SendButton .ms-Button-label{font:-apple-system-body}@media screen and (-ms-high-contrast:active){.od-SendButton.send:focus,.od-SendButton.send:hover{background:highlight}}"}]);var r=n("react-lib"),o=n(403),s=n(309),c=n(366),d=n(56),l=n(90),u=n(10),f=n("prop-types-lib"),p=n(14),m=function(e){function t(t,n){var a=e.call(this,t)||this;return a._buttonRef=r.createRef(),a._onSendLinkClicked=function(){a.props.onSendLinkClicked(a.props.messageText,a.props.subjectText)},a._platformDetection=n.platformDetection,a}return Object(a.a)(t,e),t.prototype.componentDidMount=function(){this._buttonRef&&this.props.shouldBeFocused&&this._buttonRef.current.focus()},t.prototype.render=function(){if(!this.props.ctaLabel)return null;var e=!1;if(this.props.currentSettings.audience===d.e.existing&&this.props.linkRecipients)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var a=n[t];if(void 0===this.props.permissionsMap[a.email]&&void 0===this.props.permissionsMap[a.userId]){e=!0;break}}var i=!!this.props.errorMessage||Object(u.R)(this.props.sharingInformation)||e||Object(u.p)(this.props.messageText)>this.props.maximumMessageLength||Object(u.p)(this.props.subjectText)>this.props.maximumSubjectLength;switch(this.props.sendButtonType){case l.e.button:return r.createElement(o.e,{className:"od-SendButton send",disabled:i,onClick:this._onSendLinkClicked,componentRef:this._buttonRef},this.props.ctaLabel);case l.e.link:return r.createElement("div",{className:"od-SendButton link"},r.createElement(c.e,{disabled:i,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel));case l.e.copyLink:var f=Object(p.A)(),m={color:f.palette.themeDarker,backgroundColor:f.palette.neutralLighter,borderColor:f.palette.neutralSecondary},_={root:{color:f.palette.themePrimary,backgroundColor:f.palette.white,borderColor:f.palette.neutralTertiary},rootHovered:m,rootFocused:m,rootDisabled:{color:f.palette.themeTertiary,backgroundColor:f.palette.white,borderColor:f.palette.neutralTertiary}};return this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==d.e.specificPeople&&(i=!1),r.createElement(s.e,{className:"od-SendButton copy",onClick:this._onSendLinkClicked,styles:_,disabled:i},this.props.ctaLabel)}},t.contextTypes={platformDetection:f.object.isRequired,sharingStore:f.object.isRequired},t}(r.Component);t.e=m},,function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return c});var a=n(0),i=n(49),r=n(3),o={unknown:"Unknown",spServiceResponse:"SPServiceResponse"},s=!r.e.isActivated("05F6D32A-E2A4-45FA-B486-30818AF5FC7E","03/17/2023","Stop process response error in GetDataError. Do it in DataRequestor instead"),c=function(e){function t(n){var i=this,r=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,c=n.errorData||o||{status:0},d=c.message,l=void 0===d?void 0:d,u=c.correlationId,f=void 0===u?void 0:u,p=c.code,m=void 0===p?void 0:p,_=Object(a.r)(c,["message","correlationId","code"]),h="object"==typeof l?l?"string"!=typeof l.value||s?JSON.stringify(l):l.value:"".concat(l):l,b=r&&r.codes||{order:[],map:{}};if(o&&o.codes)for(var g=0,v=o.codes.order;g<v.length;g++){var y=v[g];b.map[y]||(b.order.push(y),b.map[y]=o.codes.map[y])}var S=Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},"string"==typeof f?{correlationId:f}:{}),"string"==typeof m?{code:m}:{}),"string"==typeof h?{message:h}:{}),n),{extraData:Object(a.e)(Object(a.e)({},n.extraData||{}),{hasAuthChallenge:!!c.authenticate,status:c.status,infected:c.infected,groupThrottle:c.groupThrottle,statusText:c.statusText})});(i=e.call(this,S)||this).name="GetDataError",i.codes=b,i.errorData=c;for(var D=0,I=Object.keys(_);D<I.length;D++)i[y=I[D]]=_[y];return i}return Object(a.a)(t,e),t}(i.e)},function(e,t,n){"use strict";function a(e){return decodeURIComponent(escape(atob(e)))}function i(e){try{return!!btoa(atob(e)).match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/)}catch(e){return!1}}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},function(e,t,n){"use strict";function a(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=t;return t}n.d(t,"e",function(){return a})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(160);function i(e,t,n){var i,r,o=n||window;if(!(o&&o.performance&&e&&t))return{duration:-1};try{var s=performance.getEntriesByType("resource");new a.e(e).authority||(e=(o.location&&new a.e(o.location.href).authority)+e);for(var c=void 0,d=s.length-1;d>=0;d--){var l=s[d];if(l.startTime<t)break;decodeURIComponent(l.name)===decodeURIComponent(e)&&(c=l)}return c?{connectEnd:(i=c).connectEnd,connectStart:i.connectStart,decodedBodySize:i.decodedBodySize,domainLookupend:i.domainLookupend,domainLookupStart:i.domainLookupStart,duration:void 0===(r=i.duration)?-1:r,encodedBodySize:i.encodedBodySize,fetchStart:i.fetchStart,nextHopProtocol:i.nextHopProtocol,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,startTime:i.startTime,transferSize:i.transferSize,workerStart:i.workerStart}:{duration:-1}}catch(e){return{duration:-1}}}},function(e,t,n){"use strict";n.d(t,"t",function(){return b}),n.d(t,"e",function(){return g});var a,i=n(0),r=n(21),o=n(29),s=n(14),c=n(91),d=n(72),l={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},u=n(3),f="#3d3e66",p="#e9eaf6",m="#616161",_="#ebebeb",h={black:"#242424",neutralDark:"#424242",neutralPrimary:m,neutralPrimaryAlt:m,neutralSecondary:"#8a8a8a",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#d1d1d1",neutralQuaternary:_,neutralQuaternaryAlt:_,neutralLight:"#f0f0f0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",white:"#fff",themeDarker:"#323348",themeDark:f,themeDarkAlt:f,themePrimary:"#5b5fc7",themeSecondary:"#9092c1",themeTertiary:"#a5a7cf",themeLight:"#385dc2",themeLighter:p,themeLighterAlt:p,accent:"#137ad1"};function b(e,t,n){var a;return c.e.applyBatchedUpdates(function(){a=Object(s.M)(g(e,t))}),a}function g(e,t){if(u.t.isActivated("0d6cef16-2b13-4ef6-94c6-60e57e73d2a3"))return function(e,t){t&&o.e.initSPExpFeatures(t.ExpFeatures),r.e.evaluateCanOverride(),d.n||(e=S({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e));var n=e.palette;return n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=Object(i.e)(Object(i.e)({},e.palette),l)),e}(e,t);t&&o.e.initSPExpFeatures(t.ExpFeatures),r.e.evaluateCanOverride();var n=function(e){return d.n?a.noDefault:function(e){var t;if(r.e.isFeatureEnabled({ODB:1712})&&!u.t.isActivated("a7baa93c-d9fa-4e23-aa22-5f51ad9fab63")&&e){var n=null===(t=e.featureInfo)||void 0===t?void 0:t.VivaBackendFeature;return n?n.Enabled:e.isCurrentSiteAVivaBackendSite}return!1}(e)?a.vivaHomeDefault:a.spDefault}(t);return function(e,t){switch(e){case a.noDefault:return v(t);case a.vivaHomeDefault:return function(e){return y({palette:h},e)}(t);case a.spDefault:default:return function(e){return y({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}(t)}}(n,e)}function v(e){var t;return function(e){var t=e.palette,n=!t.black&&!t.neutralPrimary&&!t.white&&!t.neutralQuaternary||t.black&&t.white&&t.neutralPrimary&&t.neutralQuaternary&&0===t.black.indexOf("#000")&&0===t.white.toLowerCase().indexOf("#fff")&&0===t.neutralPrimary.indexOf("#333")&&0===t.neutralQuaternary.toLowerCase().indexOf("#d0d0d0");return!(t&&!n)}(e)&&(e.palette=(t=e.palette,Object(i.e)(Object(i.e)({},t),l))),e}function y(e,t){return v(t=S(e,t))}function S(e,t){return Object(i.e)(Object(i.e)(Object(i.e)({},e),t),{effects:Object(i.e)(Object(i.e)({},e.effects),t.effects),fonts:Object(i.e)(Object(i.e)({},e.fonts),t.fonts),palette:Object(i.e)(Object(i.e)({},e.palette),t.palette)})}!function(e){e[e.noDefault=0]="noDefault",e[e.vivaHomeDefault=1]="vivaHomeDefault",e[e.spDefault=2]="spDefault"}(a||(a={}))},,function(e,t,n){"use strict";function a(e){return!!e&&"function"==typeof e.addEventListener}function i(e){return!!e&&!!e.__events__}function r(e,t){var n=e,a=n.__declaredEvents=n.__declaredEvents||{};if("string"==typeof t)a[t]=!0;else for(var i=0;i<t.length;i++)a[t[i]]=!0}function o(e,t,n,r){var o,s=e;if(a(s)){if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(t,r,!0),c.args=n,o=s.dispatchEvent(c)}}else for(;s&&!1!==o;)if(i(s)){var d=s.__events__[t];for(var l in d)if(Object.prototype.hasOwnProperty.call(d,l))for(var u=d[l],f=0;!1!==o&&f<u.length;f++){var p=u[f];p.objectCallback&&(o=p.objectCallback.call(p.parent,n))}s=r?s.parent:null}else s=null;return o}n.d(t,"t",function(){return a}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o})},,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(a||(a={}))},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHeader{align-items:center;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:flex;justify-content:flex-start;padding:0}.od-ShareHeader.V2{display:flex;overflow:hidden;width:100%}[dir=ltr] .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:8px}[dir=rtl] .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:8px}[dir=ltr] .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:10px}[dir=rtl] .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:10px}.od-ShareHeader-notification{display:flex;align-items:center}.od-ShareHeader-notification .od-ShareHeader-linkSuccessIcon{font-size:1.5rem;color:#107c10}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:';display:flex;margin:0;font-size:1.25rem;font-weight:600;font:-apple-system-title1}.od-ShareHeader-linkSettings.IE{margin-top:0}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-left{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-left{padding-right:8px}[dir=ltr] .od-ShareHeader-buttons-left{left:0}[dir=rtl] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right{right:0}[dir=rtl] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreen{padding:0;top:0;display:flex;flex-direction:row}[dir=ltr] .od-ShareHeader-buttons-right-fullscreen{right:0}[dir=rtl] .od-ShareHeader-buttons-right-fullscreen{left:0}.od-ShareHeader-buttons-right-fullscreen.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreenV2{display:flex;flex-direction:row}[dir=ltr] .od-ShareHeader-buttons-right-fullscreenV2{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-right-fullscreenV2{padding-right:8px}.od-ShareHeader-buttons-right-fullscreenV2.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreenV2.new{padding:0}.od-ShareHeader-buttons-right-wac{padding-top:8px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right-wac{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right-wac{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right-wac{right:0}[dir=rtl] .od-ShareHeader-buttons-right-wac{left:0}.od-ShareHeader-moreOptionsIcon{font-size:1rem}.od-ShareHeader-closeButtonIcon{font-size:1rem}.od-ShareHeader-button{z-index:10}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative;background:0 0;border:none;padding:0;width:1.875rem;cursor:pointer}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:1rem;width:1.875rem;height:1.875rem}.od-ShareHeader-button:focus,.od-ShareHeader-button:hover{outline:1px solid black}.od-ShareHeader-title{align-items:flex-start;display:flex;flex-direction:column}.od-ShareHeader-filename-and-label{display:flex;flex-direction:row;align-items:center}.od-ShareHeader-viewName{font-size:1.25rem;font-weight:600;font:-apple-system-title1;margin:0 2rem 4px 0}[dir=rtl] .od-ShareHeader-viewName{margin:0 0 4px 2rem}.od-ShareHeader-viewName.new{margin:0}[dir=ltr] .od-ShareHeader-viewName.new{padding-left:16px}[dir=rtl] .od-ShareHeader-viewName.new{padding-right:16px}.od-ShareHeader-itemName{font-size:.75rem;font-weight:400;text-align:initial;width:100%;font:-apple-system-caption1;margin:0;white-space:nowrap}@media (forced-colors:active) and (prefers-color-scheme:dark){.od-ShareHeader-closeButtonIcon:focus,.od-ShareHeader-closeButtonIcon:hover{color:#fff}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-ShareHeader-closeButtonIcon:focus,.od-ShareHeader-closeButtonIcon:hover{color:#000}}.od-ShareHeader-flexBox{display:flex;justify-content:space-between;align-items:center;width:100%;margin:0}@media screen and (-ms-high-contrast:active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Share .od-ShareHeader-button:focus,.od-Share .od-ShareHeader-button:hover{background-color:highlight}.od-Share .od-ShareHeader-button:focus .od-ShareHeader-closeButtonIcon,.od-Share .od-ShareHeader-button:hover .od-ShareHeader-closeButtonIcon{forced-color-adjust:none;background-color:highlight;color:highlighttext}}@media screen and (-ms-high-contrast:active){.od-Share .od-ShareHeader-button .od-ShareHeader-closeButtonIcon:focus,.od-Share .od-ShareHeader-button .od-ShareHeader-closeButtonIcon:hover{forced-color-adjust:none;background-color:highlight;color:highlighttext}}.od-ShareHeader-header-V2{display:flex;flex-direction:row;width:100%}.od-ShareHeader-title-V2{display:flex;flex-direction:column;overflow:hidden;width:100%}.od-ShareHeader-viewName-V2{font-size:1.25rem;font-weight:600;font:-apple-system-title1;margin:0}.od-ShareHeader-viewName-V2.new{margin:0;padding-left:1rem}"}]);var r=n(418),o=n(205),s=n(4),c=n("react-lib"),d=n("prop-types-lib"),l=n(35),u=n(15),f=n(10),p=n(1),m=n(32),_=n(59),h=n(5),b=n(227),g=n(393),v=h.x(),y=function(e){function t(t,n){var a=e.call(this,t)||this;return a._closeButtonRef=Object(c.createRef)(),a._onInfoButtonClicked=function(){a._store.getEngagementHelper().linkSettingsLearnMoreClicked(a.props.engagementExtraData),window.open("https://go.microsoft.com/fwlink/?linkid=846149")},a._dismissComponent=function(e){e.stopPropagation(),e.preventDefault(),a._onDismiss()},a.state={target:null,headerAria:""},a._onDismiss=n.onDismiss,a._platformDetection=n.platformDetection,a._store=n.sharingStore,a._onManageExistingAccessClick=a._onManageExistingAccessClick.bind(a),a}return Object(a.a)(t,e),t.prototype.componentDidMount=function(){this.props.viewState===s.e.linkSuccess&&this._titleAriaText&&this._updateHeaderAria(this._titleAriaText)},t.prototype.render=function(){var e,t=this.props,n=this._platformDetection.isIE?"od-ShareHeader-linkSettings IE":"od-ShareHeader-linkSettings",a=this.props.mode===o.e.manageAccess?"od-ShareHeader-buttons-right-wac":"od-ShareHeader-buttons-right";if(this.props.fullScreenIframeMode&&(a="od-ShareHeader-buttons-right-fullscreen"),t.mode===o.e.linkSettings||t.mode===o.e.manageAccess)return c.createElement("div",{className:"od-ShareHeader-flexBox"},c.createElement("h2",{className:n},this._getViewName()),!this.props.doNotrenderHeaderButtons&&c.createElement("div",{className:a},this._renderCloseButton()));var i=t.viewState===s.e.notify,r=i?"":" od-ShareHeader-backgroundColor",d=this.props.hasBackButton?" od-ShareHeader-withBackButton":"",l=this.props.title||(null===(e=this.props.hostOptions)||void 0===e?void 0:e.customHeaderString)||this._getViewName(),u=l.split(" ").join("-");this._titleAriaText=this.props.titleAria||l;var f="od-ShareHeader"+r+d+(v?"":" V2"),p=this.props.titleIsSubLevel||v?this.props.titleIsSubLevel?c.createElement("div",{className:"od-ShareHeader-title"},c.createElement("h2",{className:"od-ShareHeader-viewName od-ShareHeader-subheading",id:"od-shareHeader-viewTitle-".concat(u)},l),this._renderItemName()):c.createElement("div",{className:"od-ShareHeader-header"},c.createElement("div",{className:"od-ShareHeader-title"},c.createElement("h1",{className:"od-ShareHeader-viewName",id:"od-shareHeader-viewTitle-".concat(u)},l)),c.createElement("div",{className:"od-ShareHeader-filename-and-label"},this._renderItemName(),this.props.viewState===s.e.default?this._renderSensitivityLabel():null)):c.createElement("div",{className:"od-ShareHeader-header-V2"},c.createElement("div",{className:"od-ShareHeader-title-V2"},c.createElement("h1",{className:"od-ShareHeader-viewName-V2",id:"od-shareHeader-viewTitle-".concat(u)},l),c.createElement("div",{className:"od-ShareHeader-filename-and-label"},this._renderItemName(this.props.sensitivityLabelInformation?35:70),this.props.viewState===s.e.default?this._renderSensitivityLabel():null)));t.viewState===s.e.linkSuccess&&(p=c.createElement("div",{className:"od-ShareHeader-notification"},c.createElement(g.e,{iconName:"CheckMark",className:"od-ShareHeader-linkSuccessIcon"}),_.e(this.state.headerAria,"polite","alert"),c.createElement("h1",{className:"od-ShareHeader-viewName new",id:"od-shareHeader-viewTitle-".concat(u)},l)));var m=i?c.createElement("div",null):c.createElement("div",{className:f},p);return c.createElement("div",{className:"od-ShareHeader-flexBox"},m,!this.props.doNotrenderHeaderButtons&&this._renderRightHeaderButtons(!1,i,t.viewState))},t.prototype._renderSensitivityLabel=function(){if(this.props.sensitivityLabelInformation){var e="",t=this.props.item;if(t){var n=t.childCount>1?" (".concat(l.n(p.nn,t.childCount),")"):"";e=f.z("".concat(t.name," ").concat(n))}return c.createElement(b.e,{sensitivityLabelInformation:this.props.sensitivityLabelInformation,engagementExtraData:this.props.engagementExtraData,getGraphToken:this.props.getGraphToken,filename:e.split(" ").join("")})}},t.prototype._renderInfoButton=function(){if(this.props.viewState!=s.e.modifyPermissions)return null;var e=c.createElement(r.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":"".concat(p.Cn,": ").concat(p.lr,". ").concat(p.Ka),iconProps:{iconName:"Info"},onClick:this._onInfoButtonClicked});return this._platformDetection.isMobile||(e=_.t(e,p.Cn,{position:m.e.bottomRightEdge})),e},t.prototype._renderMoreButton=function(){if(!(this.props.viewState!==s.e.default&&this.props.viewState!==s.e.addPeople||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:p.Bn,ariaLabel:p.Bn,onClick:this._onManageExistingAccessClick}],styles:{list:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"0.875rem"},".ms-ContextualMenu-link":{height:"2.25rem",lineHeight:"2.25rem"}}}}},t=c.createElement(r.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:p.na,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:_.t(t,p.na,{position:m.e.bottomRightEdge})}},t.prototype._renderCloseButton=function(){var e,t,n,a=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:u.h(this.props.clientId);if(this._onDismiss&&a){var i=c.createElement(r.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.Ee,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?i:_.t(i,p.Ee,{position:m.e.bottomRightEdge})}},t.prototype._renderRightHeaderButtons=function(e,t,n){var a;return a="od-ShareHeader-buttons-right-fullscreen"+(v||this.props.viewState!==s.e.default||this.props.titleIsSubLevel?"":"V2"),e&&!t&&n===s.e.default?c.createElement("div",{className:a},this._renderMoreButton()):e&&(t||n!==s.e.default)?"":c.createElement("div",{className:a},this._renderInfoButton(),this._renderMoreButton(),this._renderCloseButton())},t.prototype._renderItemName=function(e){var t=this.props,n=t.item;if(n){var a=n.childCount>1?" (".concat(l.n(p.nn,n.childCount),")"):"";return c.createElement("div",{className:"od-ShareHeader-itemNameWrapper"},!t.hideItemName&&c.createElement("p",{className:"od-ShareHeader-itemName","aria-label":n.name},f.z("".concat(n.name," ").concat(a),e)))}},t.prototype._renderContextualMenu=function(){[].push({key:"editable",name:p.Bn,onClick:this._onManageExistingAccessClick})},t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()},t.prototype._updateHeaderAria=function(e){this.setState({headerAria:e})},t.prototype._getViewName=function(){switch(this.props.viewState){case s.e.default:return p.Ao;case s.e.modifyPermissions:return p.Yn;case s.e.linksFromTemplateList:return p.Xn;case s.e.permissionsList:return p.Bn;case s.e.policyDetails:return p.mr;case s.e.grantPermissions:return p.ln;case s.e.addPeople:return p.v;default:return p.Ao}},t.prototype.focusCloseButton=function(){this._closeButtonRef.current&&(this._closeButtonRef.current.focus(),this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus())},t.contextTypes={onDismiss:d.func,platformDetection:d.object.isRequired,sharingStore:d.object.isRequired},t}(c.Component)},,,,,function(e,t,n){"use strict";var a,i=n(96),r=n(41),o=n(200);!function(e){e[e.blocked=0]="blocked",e[e.exception=-1]="exception",e[e.timeout=-2]="timeout",e[e.abort=-3]="abort"}(a||(a={}));var s=function(){function e(t){this._async=new i.e(this);var n=t.url,a=t.requestTimeoutInMS,r=void 0===a?e.DEFAULT_TIMEOUT_MS:a,o=t.json,s=t.responseType,c=void 0===s?"":s,d=t.headers,l=void 0===d?{}:d,u=t.withCredentials,f=void 0!==u&&u,p=t.needsCors,m=void 0!==p&&p,_=t.onProgress,h=t.onUploadProgress,b=t.method,g=void 0===b?o?"POST":"GET":b;this._url=n,this._requestTimeoutInMS=r,this._postData=o,this._headers=l,this._method=g,this._withCredentials=f,this._needsCors=m,this._responseType=c,this._progressCallback=_,this._uploadProgressCallback=h}return e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,a.abort,!1)},e.prototype.start=function(e,t){var n=this;this._successCallback=e,this._failureCallback=t;var i=this._method,s=this._headers;try{this._request=this._getRequest();var c=this,d=c._progressCallback,l=c._uploadProgressCallback,u=c._request,f=c._responseType;for(var p in d&&(u.onprogress=function(e){try{d(e)}catch(e){r.e.logError(e)}}),l&&(u.upload.onprogress=function(e){try{l(e)}catch(e){r.e.logError(e)}}),this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS),u.onreadystatechange=function(){if(!n._completed){var e=4;try{e=u.DONE||4}catch(e){}u.readyState===e&&n._requestEndCallback()}},u.open(i,this._url,!0),"withCredentials"in u&&(u.withCredentials=this._withCredentials),u.responseType=f,s)u.setRequestHeader(p,s[p]);u.send(this._postData)}catch(e){r.e.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:Object(o.e)(s),method:i}),this._abortRequest(),this._callFailureCallback(this._request,a.exception,!1)}},e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;return t.setRequestHeader=function(){},t.onprogress=function(){},t.ontimeout=function(){},t.onload=function(){e._requestEndCallback()},t},e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e},e.prototype._timeoutCallback=function(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,a.timeout,!0))},e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){r.e.log(e)}},e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){r.e.log(e)}},e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=a.exception;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=a.exception,r.e.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}},e.DEFAULT_TIMEOUT_MS=3e4,e}();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:0 16px;position:relative}.od-ShareHint.new{margin:0;padding:0;flex:1}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;display:none}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:flex;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:0 0;padding:10px 10px 10px 0;margin:0;opacity:0;transition:opacity .2s;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:0}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}]),Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail-status{padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{display:inline-block;font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font:-apple-system-body;word-break:break-word}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusText.accessSummaryLink{font-size:.75rem}.od-ShareHintDetail-statusText.unHealthy{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-statusText:hover{cursor:default}.od-ShareHintDetail-statusText:hover.clickable{cursor:pointer}.od-ShareHintDetail-statusText i{vertical-align:middle;padding-bottom:2px}.od-ShareHintDetail{height:100%;background-color:transparent;border:none}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover{cursor:pointer}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{text-decoration:underline}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareHintDetail-item{margin-left:4px}[dir=rtl] .od-ShareHintDetail-item{margin-right:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{margin-left:4px;font-size:.5rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}@media screen and (-ms-high-contrast:active){.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{color:highlight}}"}]);var r=n(393),o=n(56),s=n(177),c=n(176),d=n(382),l=n("react-lib"),u=n(35),f=n(1),p=n(133),m=n(10),_=n(263),h=n(5),b=n(15),g=n(52),v=n(308),y=function(e){function t(t,n){var a=e.call(this,t)||this;return a._renderStatusIcons=a._renderStatusIcons.bind(a),a}return Object(a.a)(t,e),t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings),t="od-ShareHintDetail ".concat(this.props.isClickable?"od-ShareHintDetail--clickable":""),n=e+", "+f.wo;return l.createElement(v.e,{className:t,onClick:this.props.isClickable?this.props.onClickCallback:void 0,"aria-label":n},l.createElement("div",{className:"od-ShareHintDetail-description"},l.createElement("div",{className:"od-ShareHintDetail-status"},l.createElement("span",{className:"od-ShareHintDetail-statusText ".concat(this.props.isClickable?"clickable":"")},e,this._renderStatusIcons(),this._renderChevron(this.props.isClickable)))))},t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=this.props.currentSettings.preventDownload,a=[];e&&e.getTime()!==new Date(0).getTime()&&a.push({icon:"Calendar",tooltip:"".concat(u.n(f.Bt,Object(p.n)(e)))}),t&&a.push({icon:"Lock",tooltip:f.ko}),n&&a.push({icon:"Blocked2",tooltip:f.br}),this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.isReview&&_.e[this.props.sharingInformation.fileExtension]&&a.push({icon:"Feedback",tooltip:f.ja}),this.props.currentSettings.audience===o.e.anyone&&this.props.currentSettings.trackLinkUsers&&a.push({icon:"ReminderPerson",tooltip:h.re()&&b.a(this.props.clientId)?f.oo:f.co});var i=a.map(function(e,t){var n={onRenderContent:function(){return l.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}};return l.createElement("i",{className:"od-ShareHintDetail-item"},l.createElement(d.e,{id:e.icon,tooltipProps:n},l.createElement(r.e,{iconName:e.icon,"aria-describedby":e.icon,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})))});return l.createElement("div",{className:"od-ShareHintDetail-iconsList"},i)}},t.prototype._renderChevron=function(e){if(e)return l.createElement(r.e,{iconName:g.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})},t.prototype._getLabel=function(e){var t=this.props.companyName,n=this.props.sharingInformation.addressBarLinkSettings,a=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&n)return n.linkDisabled||!Object(m.i)(a)?f.Zi:u.n(f.Xe,t);if(!e)return"";if(e.preventDownload){if(e.audience===o.e.anyone)return f.N;if(e.audience===o.e.organization)return u.n(f.Ze,t);if(e.audience===o.e.specificPeopleFlex)return f.Ls}switch(e.sharingLinkKind){case s.e.direct:return e.audience===o.e.specificPeople?this.props.sharingInformation.requiresAccessApproval?f.eo:e.sharingRole?Object(m.F)(e.sharingRole)?f.Cs:e.sharingRole===c.e.review?_.e[this.props.sharingInformation.fileExtension]?f.ws:f.Es:f.As:e.isEdit?f.Cs:f.As:f.Et;case s.e.organizationView:return u.n(f.Xe,t);case s.e.organizationEdit:return u.n(f.qe,t);case s.e.anonymousView:return f.R;case s.e.anonymousEdit:return f.L;case s.e.flexible:return this._getFlexibleLabel(e,t);default:return""}},t.prototype._getFlexibleLabel=function(e,t){return e.audience===o.e.existing?f.Et:e.audience===o.e.specificPeopleFlex?e.sharingRole?e.sharingRole==c.e.manageList?f.Os:Object(m.F)(e.sharingRole)?f.Cs:e.sharingRole===c.e.review?_.e[this.props.sharingInformation.fileExtension]?f.ws:f.Es:f.As:e.isEdit?f.Cs:f.As:e.audience===o.e.customLabeledSpecificPeople?e.sharingRole===c.e.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.n(f.tt,this.props.customLabeledAudienceConfig.entityName):Object(m.d)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.n(f.et,this.props.customLabeledAudienceConfig.entityName):Object(m.d)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.n(f.nt,this.props.customLabeledAudienceConfig.entityName):Object(m.d)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===o.e.organization?e.sharingRole===c.e.review?_.e[this.props.sharingInformation.fileExtension]?u.n(f.Ye,t):u.n(f.Je,t):e.sharingRole==c.e.manageList?u.n(f.Qe,t):e.isEdit?u.n(f.qe,t):u.n(f.Xe,t):e.audience===o.e.anyone?e.sharingRole===c.e.review?_.e[this.props.sharingInformation.fileExtension]?f.M:f.H:e.sharingRole==c.e.manageList?f.k:e.isEdit?f.L:f.R:""},t}(l.Component),S=n(221),D=n(145);function I(e){var t,n,i=e.clientId,s=e.companyName,c=e.currentSettings,d=e.onShareHintClick,p=e.sharingInformation,_=e.linkRecipients,h=e.customLabeledAudienceConfig,b=e.isAddressBarLinkHint,v=e.addressBarLink,I=l.useRef(),x=Object(l.createRef)(),C=(l.useCallback(function(e){if(e)return l.createElement("div",{ref:x},l.createElement(r.e,{iconName:g.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))},[]),l.useCallback(function(){d&&d()},[d])),O=l.useCallback(function(){var e=c.audience;return e===o.e.anyone?D.e.anyone:e===o.e.organization?D.e.workGroup:e===o.e.existing?D.e.existing:e===o.e.customLabeledSpecificPeople?D.e.chat:D.e.specificPeople},[c]),w=l.useCallback(function(e){return e===D.e.anyone?f.qi:e===D.e.workGroup?u.n(f.Ji,s):e===D.e.existing?f.Zi:e===D.e.specificPeople?f.ur:void 0},[s]),E=!!d,A="od-ShareHint ".concat(Object(m.R)(e.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"," new"),L="od-ShareHint-data ".concat(E?"od-ShareHint--clickable":"");if(t=l.createElement("div",{className:"od-ShareHint-shimmer"},l.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},l.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},l.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),l.createElement("div",{className:"od-ShareHint-text-shimmer"})),b){var k=p.addressBarLinkSettings,M=p.sharingAbilities,P=(T=k.linkDisabled||!Object(m.i)(M)?D.e.existing:D.e.workGroup)===D.e.existing?f.Zi:u.n(f.Ji,s);n=l.createElement("div",{className:L,ref:I},l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(S.e,{label:P,permissionsType:T,showLabel:!1})),l.createElement(y,{clientId:i,companyName:s,currentSettings:null,sharingInformation:p,linkRecipients:_,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:v,isClickable:E,onClickCallback:C}))}else{P=w(T=O());var T,U=c.audience===o.e.customLabeledSpecificPeople&&h&&h.iconUrl;n=d?l.createElement("div",{className:L,ref:I},l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(S.e,{label:P,permissionsType:T,iconUrl:U,showLabel:!1})),l.createElement(y,{clientId:i,companyName:s,currentSettings:c,sharingInformation:p,linkRecipients:_,customLabeledAudienceConfig:h,isClickable:E,onClickCallback:C})):l.createElement("div",Object(a.e)({className:L},{autoFocus:!0}),l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(S.e,{label:P,permissionsType:T,iconUrl:U,showLabel:!1})),l.createElement(y,{clientId:i,companyName:s,currentSettings:c,sharingInformation:p,linkRecipients:_,customLabeledAudienceConfig:h,isClickable:E}))}return l.createElement("div",{"aria-label":f.Yn,className:A},n,t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n("react-lib"),r=n(176),o=n(81),s=n(32),c=n(418),d=n(35),l=n(1),u=n(13);Object(u.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir=rtl] .od-RoleSelectorCompact-permissionButton{margin-right:8px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.simplified-share{height:100%;align-self:center;border-radius:0 4px 4px 0}[dir=ltr] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-right:0}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:flex;flex-direction:column;margin:8px}[dir=ltr] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir=rtl] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem;font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{font:-apple-system-body;height:auto!important}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem;font:-apple-system-body}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem;font:-apple-system-caption1}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem.selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem.selected .ms-ContextualMenu-link{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron{color:highlighttext;font-weight:600;forced-color-adjust:none}}.od-RoleSelectorCompact-simplifiedPermissionsButton{height:100%!important;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"!important;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:0 4px 2px 0!important;height:100%;align-self:center;padding:2px}[dir=ltr] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-right:0}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus{outline:unset}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus span.ms-Button-flexContainer{outline:1px solid;border-radius:2px}.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{height:100%;padding-left:10px;padding-right:10px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-checkmarkIcon{font-size:.75rem;max-height:unset}"}]);var f,p=n("prop-types-lib"),m=n(59),_=n(30);!function(e){e.edit="edit",e.view="view",e.review="comment",e.fullControl="full-control",e.manageList="manage-list",e.divider="divider",e.stopSharing="stop-sharing",e.linkSettings="linkSettings"}(f||(f={}));var h=function(e){function t(t,n){var a=e.call(this,t)||this;return a._linkSettingsClickedInRoleSelector=function(){a.context.sharingStore.getEngagementHelper().linkSettingsInCompactRoleSelectorClicked({clientId:a.props.clientId,scenarioId:"",mode:a.props.mode}),a.props.onLinkSettingsClicked()},a._onItemClicked=function(e,t){var n;switch(t.key){case f.fullControl:n=r.e.owner;break;case f.manageList:n=r.e.manageList;break;case f.edit:n=r.e.edit;break;case f.view:n=r.e.view;break;case f.review:n=r.e.review;break;default:n=r.e.none}a._selectedRole!==n&&a.props.onRoleChange(n,a.props.permissionId||"")},a._selectedRole=a._parseRole(t.sharingRole),a._menuOpen=!1,a._showSimplifiedDialog=1===_.i(),a}return Object(a.a)(t,e),t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole);var n,a=this.props,u=a.menuPermissionOptions,f=a.showLinkSettings,p=a.showStopSharing,_=this._getMenuItems({menuPermissionOptions:u,showLinkSettings:f,showStopSharing:p,sharingRole:this.props.sharingRole}),h=_.filter(function(e){return e.itemType!==o.e.Divider}).length,b=u.manageList.shouldDisplay,g=void 0!==b&&b;switch(this.props.sharingRole){case r.e.owner:n=l.rn;break;case r.e.edit:n=g?l.ce:l.se;break;case r.e.review:n=l.pe,this.props.showDropdownWithOfficeReview&&(n=l.ue);break;case r.e.view:case r.e.restrictedview:n=l.be;break;case r.e.manageList:n=l.re;break;case r.e.none:n="";break;default:return null}var v={directionalHint:s.e.bottomRightEdge,shouldFocusOnMount:!0,items:_,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){e._logRoleSelectorClicked(e.context.sharingStore),e._menuOpen=!0},onMenuDismissed:function(){e._menuOpen=!1},styles:t.menuItemStyles},y={iconName:"ChevronDown",className:"od-RoleSelectorCompact-permissionButton-Chevron"};if(this.props.shimmer)return i.createElement(c.e,{menuIconProps:y,iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:v,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}});var S=this._menuOpen?d.n(l.An,this.props.ariaLabel,n,h):d.n(l.Ln,this.props.ariaLabel,n,h);return m.t(i.createElement(c.e,{menuIconProps:y,iconProps:this.getRoleIconName(this.props.sharingRole),className:this._showSimplifiedDialog?"od-RoleSelectorCompact-simplifiedPermissionsButton":"od-RoleSelectorCompact-permissionButton",menuProps:v,disabled:this.props.disabled,ariaLabel:S,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),n,{position:s.e.bottomRightEdge,styles:this._showSimplifiedDialog&&{root:{height:"100%",display:"flex"}}})},t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))},t.prototype._parseRole=function(e){return e===r.e.review&&!this.props.menuPermissionOptions.review.enabled||e===r.e.owner&&!this.props.menuPermissionOptions.fullControl.enabled?r.e.edit:e===r.e.restrictedview?r.e.view:e},t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return Object(a.e)(Object(a.e)({},e),{onRenderContent:t._renderContent})})},t.prototype._getMenuItems=function(e){var t=[],n=e.menuPermissionOptions,a=e.showLinkSettings,i=e.showStopSharing,s=e.sharingRole,c=n.fullControl,u=(c.enabled,c.shouldDisplay),p=void 0!==u&&u,m=n.review,_=(m.enabled,m.shouldDisplay),h=void 0!==_&&_,b=n.edit,g=b.enabled,v=void 0===g||g,y=b.shouldDisplay,S=void 0===y||y,D=n.view,I=(D.enabled,D.shouldDisplay),x=void 0===I||I,C=n.manageList,O=C.enabled,w=void 0!==O&&O,E=C.shouldDisplay,A=void 0!==E&&E,L={key:f.edit,text:A?l.ce:l.se,disabled:!v,secondaryText:A?l.le:l.de,ariaLabel:d.n(l.uo,A?l.ce:l.se,A?l.le:l.de),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||s!==r.e.edit?"":"selected"),iconProps:{iconName:"Edit"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&s===r.e.edit},k={key:f.view,text:l.be,secondaryText:A?l.ve:l.ge,ariaLabel:d.n(l.uo,l.be,A?l.ve:l.ge),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||s!==r.e.view&&s!==r.e.restrictedview?"":"selected"),iconProps:{iconName:"View"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&(s===r.e.view||s===r.e.restrictedview)},M={key:f.fullControl,text:l.rn,secondaryText:l.on,ariaLabel:d.n(l.uo,l.rn,l.on),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||s!==r.e.owner?"":"selected"),iconProps:{iconName:"Signin"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&s===r.e.owner},P={key:f.manageList,text:l.re,disabled:!w,secondaryText:l.oe,ariaLabel:d.n(l.uo,l.re,l.oe),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||s!==r.e.manageList?"":"selected"),iconProps:{iconName:"EditListPencil"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&s===r.e.manageList},T={key:f.review,text:l.pe,secondaryText:l.me,ariaLabel:d.n(l.uo,l.pe,l.me),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||s!==r.e.review?"":"selected"),iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&s===r.e.review},U={key:f.review,text:l.ue,secondaryText:l.fe,ariaLabel:d.n(l.uo,l.ue,l.fe),className:"od-RoleSelectorCompact-menuItem ".concat(this._showSimplifiedDialog||s!==r.e.review?"":"selected"),iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:this._showSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},canCheck:this._showSimplifiedDialog,isChecked:this._showSimplifiedDialog&&s===r.e.review},F={key:f.divider,itemType:o.e.Divider},H={key:f.stopSharing,text:l.Ms,ariaLabel:l.Ms,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing",iconProps:{iconName:"Delete"}},R={key:"linkSettings",text:l.Yn,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:l.Yn};return p&&t.push(M),A&&t.push(P),S&&t.push(L),h&&(this.props.showDropdownWithOfficeReview?t.push(U):t.push(T)),x&&t.push(k),i&&t.push(F,H),a&&t.push(F,R),this._addRenderContent(t)},t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().compactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})},t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e)){case r.e.owner:t="Signin";break;case r.e.edit:t="Edit";break;case r.e.view:t="View";break;case r.e.review:t="Feedback";break;case r.e.manageList:t="EditListPencil";break;case r.e.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}},t.contextTypes={sharingStore:p.object.isRequired},t.menuItemStyles={subComponentStyles:{menuItem:{root:{height:"auto !important"},label:{margin:"0",fontSize:"0.875rem",fontWeight:"600",lineHeight:"1.3"},secondaryText:{paddingLeft:"0",fontSize:"0.75rem",lineHeight:"1.3",textAlign:"left",whiteSpace:"normal"}}}},t}(i.Component)},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(136),i=n(8),r=n(7),o=Object(a.e)({eventName:"Api,Qos,",shortEventName:"Api"},{url:i.e.String,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}},r.e).withData({privacyClassification:i.t.requiredService});t.t=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(0),i=n(42),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.o)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.e.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.a)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},function(e,t,n){"use strict";function a(e){return e?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(e).split(".")[1]):{}}function i(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}function r(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var a=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof a||n<a)}n.d(t,"n",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(60),r=n(35),o=n(3),s=n(168);function c(e,t){var n=t.Session,i=t.Version,o=t.OSName,c=t.OSVersion,d=t.Market,l=t.UserId,u=t.Manifest,f=Object(a.r)(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),p=e.getSemanticContext();if(n&&e.setContext("AppInfo.Session",n),u&&e.setContext("AppInfo.Manifest",u),i&&p.setAppVersion(i),p.setUserLanguage(d||""),l){var m=function(e){return e&&e.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,function(e,t,n,a,i,r){return"".concat(t).concat(Object(s.e)(i)).concat(r)})}(l);p.setUserId(m)}for(var _ in o&&p.setDeviceOsName(o),c&&p.setDeviceOsVersion(c),f)if(Object.prototype.hasOwnProperty.call(f,_)){if(null==f[_])continue;var h=Object(r.e)(_);e.setContext(h,f[_])}}var d=n(86),l=n(253),u=function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})},this._getAria=f(function(){return e.ariaLoader().then(function(t){return function(e,t){e.LogManager.isInitialized()||(e.LogManager.initialize(t.tenantToken,Object(a.e)(Object(a.e)({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{})),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})),e.LogManager.addCallbackListener(function(e,n,a,i){a===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})}(t,e),t})}),this._getLogger=f(function(){return t._getAria().then(function(a){var i=function(e,t,n){void 0===n&&(n={});var a=new e.Logger(t);return c(a,n),a}(a,e.tenantToken,e.context),r=e.offlineDetection;return l.e&&r?n.ee([42],767).then(function(n){return t._offlineEventQueue=n.makeOfflineAriaEventQueue(i,e.tenantToken,r),[i,a]}):Promise.resolve([i,a])})}),this._createLogHandler=f(function(){return t._getLogger().then(function(n){var a=n[0],s=function(e,t,n,a,s){return void 0===n&&(n=!0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),function(c){try{if(c.enabled&&(c.eventType!==i.t.Start||n)&&(!a||!a.isQosEvent(c))){var u=function(e,t,n){var a,s=function(e){for(var t={CorrelationVector:e.vector.toString(),WebLog_FullName:e.eventName,WebLog_EventType:i.t[e.eventType]},n=e.eventName.split(","),a=0,o=n;a<o.length;a++){var s=o[a];s&&(t["WebLog_Type_".concat(s)]=1)}var c=e.data,d=e.context;if(d)for(var l in d)if(Object.prototype.hasOwnProperty.call(d,l)){if(null==(f=d[l]))continue;t[m=Object(r.e)(l)]=f}if(c)for(var u in c)if(Object.prototype.hasOwnProperty.call(c,u)){var f;if(null==(f=c[u]))continue;var p=e.metadata[u];if(p){var m=p.isPrefixingDisabled?Object(r.e)(u):"".concat(Object(r.e)(p.definedInName),"_").concat(u),_=p.type;if(4===_){for(var h in f)if(Object.prototype.hasOwnProperty.call(f,h)){var b=f[h];if(null!=b&&""!==b){var g=void 0;if("object"==typeof b)try{g=JSON.stringify(b)}catch(e){g=b}else g=b;t["".concat(m,"_").concat(h.replace(/\./g,"_"))]=g}}}else t[m]=6===_?p.typeRef[f]:f}}return{name:e.isEventTypePrefixingDisabled?n[n.length-2]:"ev_".concat(n[n.length-2]),values:t}}(t),c=s.name,d=s.values,l=new e.EventProperties;return l.name=c,o.t.isActivated("2657d5a5-7313-42a0-ab20-287781f44d1b")||("AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"===(a=d.Name)||"SPO.DashboardWebPart.Load"===a||"AdaptiveCardExtension.CardAction"===a||"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"===a||"TeamsSiteHeader.RefreshButtonClicked"===a||"TeamsSiteHeader.CopyLinkButtonClicked.successful"===a||"TeamsSiteHeader.GoToBrowserButtonClicked"===a)&&(l.eventType="VivaAnalytics"),function(e,t,n,a){var i;try{for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i=r,t.setProperty(r,n[r]))}catch(t){var o=void 0,s=void 0;throw t instanceof e.Exception&&(o=t.ErrorCode(),s=new Error("Aria error: ".concat(t.toString()))),s&&(t.handled=!0,a&&a.logError(s,{errorCode:o,propertyKey:i})),t}}(e,l,d,n),l}(e,c,d);l.e&&(null==s?void 0:s.storeEventIfNecessary(u))||t.logEvent(u)}}catch(t){var f=void 0;t instanceof e.Exception&&(f=new Error("Aria error: ".concat(t.toString()))),t&&t.handled||d.log(f||t)}}}(n[1],a,e.logStartEvents,e.ariaQos,t._offlineEventQueue);return s})}),this._onLogEvent=e.onLogEvent}return e.prototype.attach=function(e){this._createLogHandler();var t=this.logEvent;return e.addLogHandler(t).forEach(t),function(){return e.removeLogHandler(t)}},e.prototype.updateContext=function(e){this._getLogger().then(function(t){return c(t[0],e)})},e.prototype.flush=function(){return this._getAria().then(function(e){e.LogManager.flush()})},e}();function f(e){var t=void 0;return function(){return t||(t=e()),t}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)},e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High},e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})},e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)},e.viewListItems={High:0,Low:1},e.insertListItems={High:0,Low:2},e.editListItems={High:0,Low:4},e.deleteListItems={High:0,Low:8},e.approveItems={High:0,Low:16},e.openItems={High:0,Low:32},e.viewVersions={High:0,Low:64},e.deleteVersions={High:0,Low:128},e.cancelCheckout={High:0,Low:256},e.manageLists={High:0,Low:2048},e.viewFormPages={High:0,Low:4096},e.reviewListItems={High:0,Low:16384},e.viewPages={High:0,Low:131072},e.layoutsPage={High:0,Low:135168},e.addAndCustomizePages={High:0,Low:262144},e.applyThemeAndBorder={High:0,Low:524288},e.viewUsageData={High:0,Low:2097152},e.manageSubwebs={High:0,Low:8388608},e.managePermissions={High:0,Low:33554432},e.browseDirectories={High:0,Low:67108864},e.manageWeb={High:0,Low:1073741824},e.useClientIntegration={High:16,Low:0},e.manageAlerts={High:64,Low:0},e.createAlerts={High:128,Low:0},e.enumeratePermissions={High:1073741824,Low:0},e.useRemoteAPIs={High:32,Low:0},e.fullMaskWithoutACP={High:2147483647,Low:4294705151},e.fullMask={High:2147483647,Low:4294967295},e}();t.t=a},function(e,t,n){"use strict";function a(e,t){return void 0===t&&(t=!0),e=encodeURI(e),t&&e&&(e=e.replace(/#/g,"%23")),e}n.d(t,"e",function(){return a})},,function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"n",function(){return c});var a=n(107),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],fluid:["fluid"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},r=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==a.e.File?a.e[e.itemType].toLowerCase():s(e.extension):"none"}function s(e){return e?(r||(r={},Object.keys(i).map(function(e){i[e].forEach(function(t){r[t]=e})})),r[e.toLowerCase()]||"other"):"none"}function c(e){return"word"===s(e)}},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(0),i=function(){function e(e){this._items=[],this._maxSize=e}return Object.defineProperty(e.prototype,"isFull",{get:function(){return this._items.length>=this._maxSize},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){return this._items.slice()},e.prototype.push=function(e){this._items.length>=this._maxSize&&(this._items.length=0),this._items.push(e)},e}(),r=function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e,this._buffer=new Array(e),this._length=0,this._head=-1}return e.prototype.push=function(e){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=e},e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[e]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length>=this._size},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){var e=this._head+1;return this._length<this._size?this._buffer.slice(0,e):Object(a.o)(Object(a.o)([],this._buffer.slice(e),!0),this._buffer.slice(0,e),!0)},e}()},function(e,t,n){"use strict";function a(e){var t;try{var n=[];t=JSON.stringify(e,function(e,t){return t===window?"[window]":t instanceof HTMLElement?"[HTMLElement]":"function"==typeof t?"[function]":"object"==typeof t?null===t?t:-1===n.indexOf(t)?(n.push(t),t):"[circular]":t})}catch(e){t=JSON.stringify("[object]")}return t}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";var a=n(247),i=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,r=i.isFolder,o=i.isListSharing,s=i.itemUrl,c=i.listId,d=i.listItemId,l=i.listUrl,u=i.resourceId,f=i.serverRelativeItemUrl,p=i.uniqueId,m=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:m}).method("Lists",c);if(p){if(c)return e.build().webByUrl({webUrl:m}).segment("lists").method("getbyid",c).method("GetItemByUniqueId",p);var _=r?"GetFolderById":"GetFileById",h={guid:p};return e.build().webByUrl({webUrl:m}).method(_,h).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",f):s?e.build().webByUrl({webUrl:m}).method("GetFileByUrl",a.t(s)).segment("ListItemAllFields"):c&&d?e.build().webByUrl({webUrl:m}).method("Lists",c).method("GetItemById",d):e.build().webByUrl({webUrl:m}).method("GetListItemByResourceId",u)}var b;b=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var g=e.build().webByItemUrl(b).method("Lists",n);return t.isRootFolder||(g=t.properties.ID?g.method("GetItemById",t.properties.ID):g.method("GetItemByUniqueId",t.properties.uniqueId)),g},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}();t.e=i},,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"}},function(e,t,n){"use strict";var a;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(a||(a={})),t.e=a},,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.link=1]="link",e[e.linkV2=2]="linkV2",e[e.linkInheritance=3]="linkInheritance",e[e.linkBundle=4]="linkBundle",e[e.direct=5]="direct",e[e.participant=6]="participant",e[e.linkSettings=7]="linkSettings",e[e.back=8]="back",e[e.shareDialogPasswordOnly=9]="shareDialogPasswordOnly",e[e.shareDialogExpirationOnly=10]="shareDialogExpirationOnly",e[e.shareDialogPasswordAndExpiration=11]="shareDialogPasswordAndExpiration",e[e.copyInterruptUpdate=12]="copyInterruptUpdate",e[e.copyInterruptRemove=13]="copyInterruptRemove",e[e.addressBarLinkOff=14]="addressBarLinkOff",e[e.shareDialogExternalSharing=15]="shareDialogExternalSharing"}(a||(a={}))},function(e,t,n){"use strict";var a=n(150);n.d(t,"e",function(){return a.e});var i=n(367);n.d(t,"t",function(){return i.e})},,,function(e,t,n){"use strict";var a=n(0),i=n("react-lib"),r=n(13);Object(r.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:flex;flex-direction:row;flex-wrap:nowrap}.od-Share-PeoplePickerContainer.space-between{justify-content:space-between}.od-Share-PeoplePickerContainer.normal{justify-content:normal}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-ErrorWarnings-wrapper,.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - (1.75rem + 34px));width:100%;flex-grow:1}.od-Share-PeoplePicker-flexGrow{flex-grow:1;height:100%}.od-Share-PeoplePicker-PeoplePickerIcon{font-size:1.5rem;padding-top:10px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker-PeoplePickerIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker-PeoplePickerIcon{padding-right:12px}#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-RoleSelector{align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}[dir=ltr] .od-Share-PeoplePicker.withIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker.withIcon{padding-right:12px}.od-Share-PeoplePicker .ms-Callout{width:100%}.od-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{font-size:.75rem;font:-apple-system-caption1}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker{height:100%;padding:12px 6px 12px 0}.od-Simplified-Share-PeoplePicker.smaller-padding{padding:10px 5px 10px 3px}.od-Simplified-Share-PeoplePicker .ms-Callout{width:100%}.od-Simplified-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Simplified-Share-PeoplePicker .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%}.od-Simplified-Share-PeoplePicker.isIE.initial-padding{padding-bottom:4px}.od-Simplified-Share-PeoplePicker.isIE .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%;max-width:320px}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%;height:100%;padding:0}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Simplified-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@keyframes fadein{0%{opacity:0}100%{opacity:1}}@keyframes fadeout{0%{opacity:1}100%{opacity:0}}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.875rem}.od-Simplified-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{font-size:.75rem;font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px;height:0;overflow:hidden;opacity:0;align-items:center}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{white-space:nowrap;font:-apple-system-body}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker .ms-SelectionZone{height:100%}@media screen and (min-width:400px){.ms-Suggestions,.ms-Suggestions-none{width:370px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE{width:448px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-none{width:448px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE{width:432px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-none{width:432px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px;width:100%}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container div.ms-PeoplePicker-personaContent{font:-apple-system-headline;height:auto}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button span.ms-Button-label{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir=ltr] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir=rtl] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText{color:inherit}}@media (forced-colors:active) and (prefers-color-scheme:dark){::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}}.od-RoleSelectorCompact-permissionButton:focus{outline:1px solid}.od-Share-PeoplePicker-selectedItem--error{display:flex}.od-Share-PeoplePicker-height{height:auto}"}]);var o=n(383),s=n(24),c=n(496),d=n(2),l=n(495),u=n(382),f=n(32),p=n(418),m=n(393),_=n(336),h=n(35);Object(r.t)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_780e3396{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_780e3396{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerClose_780e3396{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_780e3396{padding-left:4px}html[dir=rtl] .peoplePickerClose_780e3396{padding-right:4px}.peoplePickerClose_780e3396:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_780e3396{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var b,g="itemContent_780e3396",v="placeholderUser_780e3396",y=n(116),S=n(29),D=n(244),I=n(3),x=n(14),C={ODB:60596};function O(e){var t,n;return!I.e.isActivated("E453BAFB-1A08-4222-89F4-568CF37CA2B8","11/02/2021","Placeholder sharing")&&S.e.isFeatureEnabled(C)&&!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}!function(e){e[e.standalone=0]="standalone",e[e.pill=1]="pill"}(b||(b={}));var w=n(26),E=S.e.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||I.e.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function A(e,t,n){var a="3rem";if(t)switch(t){case d.n.size24:a="1.5rem";break;case d.n.size32:a="2rem";break;case d.n.size40:a="2.5rem";break;case d.n.extraSmall:a="1.75rem";break;default:a="3rem"}var r={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:a,height:a,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:a+"!important",height:a+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:a,height:a,maxWidth:"75px",maxHeight:"75px"},initials:{width:a,height:a,fontSize:"0.625rem",lineHeight:a}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return O(e)&&void 0!==n?Object(D.default)(r,function(e,t){void 0===t&&(t={});var n=Object(x.A)(),a=t.fontSize;return{coinProps:{styles:{initials:e===b.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=a?a:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=a?a:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:d.e.transparent,onRenderInitials:function(){return i.createElement(m.e,{iconName:"Contact",style:{fontWeight:"normal"}})}}}(n)):r}var L=function(e){return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(l.e,Object(a.e)({},e.personaProps,{presence:d.t.none,size:d.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.person.entityType===s.e.linkedinUser&&i.createElement(m.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},k=function(e){var t,n=e.item,r=e.onRemoveItem,o=e.index,s=e.selected,c=e.removeButtonAriaLabel,m=A(n,d.n.extraSmall,b.pill);return E||(m.onRenderPrimaryText=function(){return i.createElement(u.e,{content:n.email||m.text,directionalHint:f.e.topLeftEdge},m.text)}),i.createElement("div",{className:Object(_.e)("ms-PickerPersona-container",(t={"is-selected":!!s},t[v]=O(n),t)),"data-is-focusable":!0,"data-selection-index":o,key:o,role:"listitem"},i.createElement("div",{className:Object(_.e)("ms-PickerItem-content",g)},i.createElement(l.e,Object(a.e)({},m,{presence:d.t.none,size:d.n.extraSmall}))),i.createElement(p.e,{styles:{root:{flexShrink:0}},onClick:r,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=c?c:h.n(y.t,n.name),disabled:e.disabled}))},M=function(e){var t=e.item,n=e.onRemoveItem,r=e.index,o=e.selected,s=A(t,d.n.size40),c="PickerPersonaId"+Math.floor(1e4*Math.random()),u=h.n(y.t,t.name);return i.createElement("div",{className:Object(_.e)("ms-PickerPersona-container is-listbelow",{"is-selected":!!o}),"data-is-focusable":!0,"data-selection-index":r,key:r,"aria-labelledby":c,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(l.e,Object(a.e)({id:c},s,{presence:d.t.none,size:d.n.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(p.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":u})))},P=function(e){var t,n=e.item,r=e.onRemoveItem,o=e.index,s=e.selected,c=e.removeButtonAriaLabel,m=A(n,d.n.extraSmall,b.pill),S=i.useRef(null),D=i.useRef(null);return i.useEffect(function(){S.current&&D.current&&(S.current.style.animation="fadein 200ms",S.current.style.transition="height 200ms cubic-bezier(0.33,0.00,0.10,1.00)",S.current.style.height="".concat(D.current.scrollHeight,"px"),S.current.style.opacity="1")},[]),E||(m.onRenderPrimaryText=function(){return i.createElement(u.e,{content:i.createElement("div",null,i.createElement("div",null,m.text&&m.text),i.createElement("div",null,n.email&&n.email)),directionalHint:f.e.topLeftEdge},m.text)}),i.createElement("div",{className:Object(_.e)("ms-PickerPersona-container",(t={"is-selected":!!s},t[v]=O(n),t)),"data-is-focusable":!0,"data-selection-index":o,key:o,role:"listitem",ref:S},i.createElement("div",{ref:D,className:Object(_.e)("ms-PickerItem-content",g)},i.createElement(l.e,Object(a.e)({},m,{presence:d.t.none,size:d.n.extraSmall}))),i.createElement(p.e,{styles:{root:{flexShrink:0}},onClick:r,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=c?c:h.n(y.t,n.name),disabled:e.disabled}))},T=n(487),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e),0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()},t.onInputFocus=function(e){var n,a;I.t.isActivated("543f1508-f671-478a-9d8e-f38cf68393fd","04/19/2023","Respect the onEmptyResolveSuggestions prop passed to PeoplePicker")||t.props.showDefaultSuggestionOnlyByClick||e&&e.target&&e.target.value||!t.props.onEmptyResolveSuggestions||t.onEmptyInputFocus(),F()||null===(a=null===(n=t.props.inputProps)||void 0===n?void 0:n.onFocus)||void 0===a||a.call(n,e)},t}return Object(a.a)(t,e),t}(T.e);function F(){return I.t.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")}var H,R=n(67),N=n(235),B=n(45),j=n(27),V=n(168),z=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;if(n._MaxItems=200,n._Version=5,n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer(),n._data={},Date.now()<n._buffer.lastCachePrune+6048e5)for(var a=0;a<n._buffer.dataArray.length;a++){var i=n._buffer.dataArray[a],r=n._getItemKey(i);n._data[r]=i}else n.initializeBuffer(),n.setValue(t._StorageKey,n._buffer);return n}return Object(a.a)(t,e),t.clear=function(){new B.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._getItemKey(e),a=this._data[n];if(a){if(t.isCacheEntryFresh(a,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index],o=this._getItemKey(r);delete this._data[o],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[n]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var i=(this._buffer.index-a+this._MaxItems)%this._MaxItems,r=this._buffer.dataArray[i];!(r.email&&r.email.toLowerCase().indexOf(e.toLowerCase())>=0||r.name&&r.name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&r.entityType===s.e.externalUser||n.push(r)}return n},t.prototype.containsItem=function(e){var t=this._getItemKey(e);return Boolean(this._data[t])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t.prototype._getItemKey=function(e){return e.email||e.userId||Object(V.e)(JSON.stringify(e)).toString()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=j.e.local,t}(B.e),G=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new N.e({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new z,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,a,i=this,r={cached:null,promise:null};return this._mruCache&&!t.groupID&&(a=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(r.cached=a),r.promise=new R.t(function(r,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(a){a.length>0&&(a=i._removeStaleCacheResults(a,e));var t=a.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()},e.prototype.searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];z.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}(),K=n(31);!function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(H||(H={})),Object(r.t)([{rawString:".ms-Suggestions{width:260px}"}]);var W,q,Q=I.t.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),Y=U,J=T.t,X=function(e){function t(t){var n=e.call(this,t)||this;if(n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise&&(n._peoplePickerSearchPromise.cancel(),n._peoplePickerSearchPromise=void 0),!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),a=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&a&&(t.conversationId=a);var r=function(){var a=n._dataProvider.search(e.trim(),t);if(!a)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=a.cached?a.cached:[];return n._peoplePickerSearchPromise=a.promise,n._peoplePickerSearchPromise.then(function(e){return n._peoplePickerSearchPromise=void 0,e?i.concat(e):[]}).then(function(t){var a=Q?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(a,e):a})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return r().then(function(e){return n._callRumOneLoggerFromProps(),e});try{return n.props.persistCachePeopleSearch({getData:r,key:i}).then(function(e){var t=!isNaN(e.cacheStats.lastModified);return n._callRumOneLoggerFromProps(t),e.data})}catch(e){return r().then(function(e){return n._callRumOneLoggerFromProps(),e})}},n._callRumOneLoggerFromProps=function(e){void 0===e&&(e=!1),n.props.writeUserInputDataToRumoneLogger&&n.props.writeUserInputDataToRumoneLogger(e)},n._onGetMoreResults=function(e){var t;return n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked(),n.props.peoplePickerQueryParams&&((t=Object(a.e)({},n.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var a=n.props.onResolvedSuggestions(t,e);if(a instanceof Array)return a}return t}):[]},t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new G({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams)),n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults,n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)},n}return Object(a.a)(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.onRenderItem,o=t.onRenderSuggestionsItem,s=t.defaultSelectedItems,c=t.onSelectedPersonasChange,l=t.suggestionsHeaderText,u=t.suggestionsClassName,f=t.noResultsFoundText,p=t.loadingText,m=t.inputProps,_=t.onSuggestionSelected,h=t.suggestionsAvailableAlertText,g=t.enableSelectedSuggestionAlert,v=t.selectedItems,S=t.itemLimit,D=t.onInputChange,I=t.onGetMoreResults,x=t.searchForMoreIcon,C=t.searchForMoreText,O=t.ariaLabel,E=void 0===O?"":O,P=t.pickerCalloutProps,T=t.pickerOverrideStyles,U=t.theme,F=t.disabled,R=t.onGetMoreResultsClicked,N=t.removeButtonAriaLabel,B=t.onEmptyResolveSuggestions,j=t.customizeSuggestionPersonaProps,V=t.showDefaultSuggestionOnlyByClick;this._onGetMoreResultsClicked=R;var z={className:n,onRenderSuggestionsItem:o||function(e){return function(e,t){var n,a=A(e,d.n.size40,b.standalone);if(n=a,t&&(n=t(a)),n&&n.imageUrl){var r=new w.e(n.imageUrl);r.setQueryParameter("fromPeoplePicker","true"),n.imageUrl=r.toString()}return i.createElement(L,{person:e,personaProps:n})}(e,j)},onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:s,selectedItems:v,onChange:c,inputProps:m,enableSelectedSuggestionAlert:g,pickerSuggestionsProps:{suggestionsHeaderText:l,loadingText:p,noResultsFoundText:f,className:u,suggestionsAvailableAlertText:h,searchForMoreIcon:x,searchForMoreText:C||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:y.e},onItemSelected:_,itemLimit:S,onInputChange:D,onGetMoreResults:I||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:P,styles:T,theme:U,"aria-label":E,disabled:F,removeButtonAriaLabel:N,onEmptyResolveSuggestions:V&&this._canCallGraph?function(){return e.props.initRumone&&e.props.initRumone("",!0),e._onResolveSuggestions("")}:B,showDefaultSuggestionOnlyByClick:V};return this.props.peoplePickerType===H.listBelow?(z.onRenderItem=r||M,i.createElement(J,Object(a.e)({},z,{componentRef:this._resolveRef("_peoplePicker")}))):(z.onRenderItem=r||k,i.createElement(Y,Object(a.e)({},z,{componentRef:this._resolveRef("_peoplePicker")})))},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:K.e.user|K.e.securityGroup|K.e.sharePointGroup}},t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=Object(a.o)([],i,!0);for(var r=function(e){var a=o._getItemKey(e);i.some(function(e){var n=t._getItemKey(e);return a===n})||(n.push(e),i.push(e))},o=this,s=0,c=e;s<c.length;s++)r(c[s]);return n},t.prototype._getItemKey=function(e){return e.email||e.userId||Object(V.e)(JSON.stringify(e)).toString()},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?y.n:void 0},t}(o.e),Z=n(205),$=n(177),ee=n(372),te=n("prop-types-lib"),ne=n(1),ae=n(15),ie=n(23),re=n(494),oe=n(48),se=n(46),ce=n(146),de=n(5),le=n(59),ue=n(241),fe=n(10),pe=n(234),me=n(123),_e=n(30),he=n(281),be=n(74),ge=n(101);!function(e){e[e.None=0]="None",e[e.Family=1]="Family",e[e.FamilyMember=2]="FamilyMember"}(W||(W={})),I.e.isActivated("c0f33ab5-b308-47d6-9537-a4b510e6093f","09/14/2021","Fix for button label in high contrast mode cause by .ms-Button-flexContainer:hover in PeoplePicker.scss.")||((q=document.createElement("style")).innerHTML="\n  @media screen and (-ms-high-contrast: active) {\n    .ms-Button-flexContainer:hover {\n      font-size: inherit !important;\n      color: inherit !important;\n      forced-color-adjust: none;\n    }\n  }\n  ",document.head.insertAdjacentElement("beforeend",q));var ve="peoplepicker",ye=I.e.isActivated("ae5c4aaa-bb38-4467-acbe-e98893341883","02/28/2022","Show default suggestions killswitch"),Se=function(e){function t(t,n){var r=e.call(this,t)||this;return r._inputs=[],r._onItemsChange=function(e){var t=r.state.selectedItems.concat(e);r.setState({selectedItems:t},function(){r.props.onChange(t)}),e.forEach(function(e){r._onAutoResolve(e)})},r._initRumone=function(e,t){if(void 0===t&&(t=!1),!r._inputStartTime&&!t&&e.length>1||!r._inputStartTime&&t&&0===e.length){r._inputStartTime=Date.now(),r._rumoneLogger||(r._rumoneLogger=new pe.e(ve)),r._rumoneLogger.resetRumOneApiMeasurement(),r._rumoneLogger.resetRumOne();var n=me.e.getRUMOneLogger(ve),a=I.e.isActivated("882A3AE3-7D25-485F-B28D-658F339604DF")?"browser.pipe.aria.microsoft.com":"/Collector/3.0/";n.startAPIMeasurement({ignore:function(e){return e.indexOf(a)>=0},getAPIName:function(e){var t=e.toLowerCase();return-1!==t.indexOf("graph.microsoft.com/v1.0/me/people")&&-1!==t.indexOf("search")?"GraphSearch":-1!==t.indexOf("/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface.clientpeoplepickersearchuser")?"SPClientPeoplePickerSearchUser":-1!==t.indexOf("https://outlook.office.com/search/api/v1/suggestions")?"SubstrateSearch":void 0}})}},r._onInputChange=function(e){if(r._inputs.push(e),r._initRumone(e),r._hasTakenErrorFocus=!1,e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);if(t&&t[0]&&(e=t[0].substring(1,t[0].length-1)),e=e.trim())return r._createGenericPerson(e)}).filter(function(e){return e});return r._onItemsChange(t),r.props.onInputChange&&r.props.onInputChange(""),""}var n=/['"].*['"]/g.exec(e);return n&&n[0]?n[0].substring(1,n[0].length-1):(r.props.onInputChange&&r.props.onInputChange(e),e)},r._onGetMoreResults=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!1,forceResolve:!0,useSubstrate:!!r.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:r.props.sharingInformation.siteIBSegmentIDs};return de.u()?r._peoplePickerProvider.sharePointSearch(e,n):r._peoplePickerProvider.sharePointSearch(e,n).then(function(e){return e.filter(function(e){return 0===r.state.selectedItems.filter(function(t){return t.email===e.email}).length})})},r._onSuggestionSelected=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(r._store.getEngagementHelper().log("PeoplePicker.SuggestionSelected",{clientId:r.props.clientId,mode:Z.e.share,detailedGroupInfo:e.detailedGroupInfo,principalType:void 0===e.principalType?"unknown":K.e[e.principalType],entityType:void 0===e.entityType?"unknown":s.e[e.entityType],isDefaultSuggestion:!/\S/.test(r._inputs.join(""))}),de._()&&ae.g(r.props.clientId)){var a=r._store.getFamily(),i=r._store.getFamilyMembers();a&&i&&(e.userId===a.userId?r._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:W[r.state.familyType],mode:Z.e.share}):i.some(function(t){return t.userId===e.userId})&&r._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:W[r.state.familyType],mode:Z.e.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;e.principalType===K.e.distributionList&&(n.isGraphDistributionList=!0,n.useGraph=!0);var o=Object(se.o)(e),c=Object(se.i)(e);return!e.isResolved||o?r._peoplePickerProvider.resolve(e.userId,n).then(function(t){return!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails),!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails),e.entityType===s.e.linkedinUser&&(t.entityType=e.entityType),void 0===t.isExternal&&(o||c)&&(t.isExternal=!0),t}):e},r._onRenderItem=function(e){var t=r.props.permissionsMap,n=r._computeAllowExternalUsers(r.props.sharingLinkKind,r.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!n||r.props.sharingLinkKind===$.e.direct&&t&&(void 0!==t[e.item.email]&&t[e.item.email]===ee.e.none||void 0!==t[e.item.userId]&&t[e.item.userId]===ee.e.none)||!e.item.isResolved&&!e.item.isResolving,s=e.item.name;return e.removeButtonAriaLabel=h.n(ne.Zr,s),e.item.imageAlt=h.n(ne.ic,s),o?i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},r._showSimplifiedDialog?i.createElement(P,Object(a.e)({},e)):i.createElement(k,Object(a.e)({},e))):e.item.isResolving?i.createElement(re.e,{className:"od-Share-PeoplePicker-resolve-spinner"}):r._showSimplifiedDialog?i.createElement(P,Object(a.e)({},e)):i.createElement(k,Object(a.e)({},e))},r._onToggleGetMoreResults=function(e){de.u()?r.state&&(e&&!r.state.searchForMoreText||!e&&r.state.searchForMoreText)&&r.setState({searchForMoreText:r._getSearchForMoreText(e)}):r.setState({searchForMoreText:r._getSearchForMoreText(r.props.sharingInformation.isGraphAvailable||e)})},r._writeUserInputDataToRumoneLogger=function(e){if(void 0===e&&(e=!1),r._rumoneLogger){var t=r._rumoneLogger.breakdownData,n={modeName:"peoplePicker",startTime:r._inputStartTime,endTime:Date.now(),breakDownData:{customerInputs:t(r._inputs.length),isSearchFromCache:e}};r._rumoneLogger.logSharingPerformance(n)}r._inputs=[],r._inputStartTime=null},r._peoplePickerProvider=n.peoplePickerProvider,r._resize=n.resize,r._platformDetection=n.platformDetection,r._hasTakenErrorFocus=!1,r._store=n.sharingStore,r._clientId=n.clientId,r._rumoneLogger=null,r._sharingClientMessenger=n.sharingClientMessenger,r._persistentRequestCache=new he.e({id:"PeoplePickerSearch"},{pageContext:n}),r._showSimplifiedDialog=1===_e.i()&&r.props.mode===Z.e.share,r.state={selectedItems:t.defaultSelectedItems,searchForMoreText:r._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:W.None,familyResolveEventFired:!1,previousUsers:[]},r._resizeTracker=new ce.e(n.resize),r._peoplePickerControl=i.createRef(),r}return Object(a.a)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,a=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&a.push({name:n[0].name,userId:n[0].userId})}),this.setState({selectedItems:t,addedUsers:a})},t.prototype.componentDidUpdate=function(e,t){var n,a,i,r,o,s,c=this;this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var d=t.addedUsers,l=this.state.addedUsers,u=this.state.removedUsers;(null===(n=e.defaultSelectedItems)||void 0===n?void 0:n.length)!==(null===(a=this.props.defaultSelectedItems)||void 0===a?void 0:a.length)&&this.setState({previousUsers:e.defaultSelectedItems}),this._showSimplifiedDialog&&(null===(i=this._peoplePicker)||void 0===i?void 0:i.scrollHeight)&&this._peoplePicker.scrollHeight!==this.props.height&&this.props.setHeight&&((null===(r=this.state.previousUsers)||void 0===r?void 0:r.length)>this.props.defaultSelectedItems.length?this.props.setHeight(null===(o=this._peoplePicker)||void 0===o?void 0:o.scrollHeight):this.props.setHeight("auto"));var f=this._showSimplifiedDialog?200:0;this._resizeTracker?setTimeout(function(){c._resizeTracker.checkSizeChange(c._peoplePicker)},f):null!==this.props.error&&null===e.error&&(this._resize(),setTimeout(function(){c._resize()},f)),d.length>l.length?(u=d.filter(function(e){return-1===l.indexOf(e)}),this.setState({removedUsers:u})):d.length!==l.length&&u.length>0&&this.setState({removedUsers:[]});var p=this._platformDetection&&this._platformDetection.isIE;this._peoplePickerControl&&!p&&this.props.error&&!this._hasTakenErrorFocus&&(null===(s=this._peoplePickerControl.current)||void 0===s||s.focusInput(),this._hasTakenErrorFocus=!0)},t.prototype.componentDidMount=function(){var e,t=this._platformDetection&&this._platformDetection.isIE;this._peoplePickerControl&&!t&&(null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput())},t.prototype.render=function(){var e,t=this,n={placeholder:this._computePlaceholderText(),autoFocus:!0,onFocus:function(e){t._onFocus()},onBlur:function(e){t._onBlur()},"aria-label":this._computeAddAnotherAriaLabel(),"aria-description":ne.ho},r=this.props.pickerSettings,o=!!this.props.sharingInformation.enforceIBSegmentFiltering,s={principalSource:r.PrincipalSource,principalType:this._convertPrincipalType(r.PrincipalAccountType),querySettings:r.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:r.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:o,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:oe.e.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:this.props.sharingInformation.siteIBMode,useNew3Ssearch:r.useNew3Ssearch,enforceIBSegmentFiltering:o},c=this.state.selectedItems.length>0&&"smaller-padding",d=(null===(e=this._platformDetection)||void 0===e?void 0:e.isIE)&&"isIE ".concat(0===this.state.selectedItems.length&&"initial-padding"),l=this.props.renderIcon?"withIcon":"",u=this.props.error&&!this._showSimplifiedDialog?"od-Share-PeoplePicker ms-Share-PeoplePicker--error "+l:this._showSimplifiedDialog?"od-Simplified-Share-PeoplePicker ".concat(d," ").concat(c)+l:"od-Share-PeoplePicker "+l,f=ae.o(this.props.clientId)||this._platformDetection&&this._platformDetection.isMobile,p={preventDismissOnScroll:f,preventDismissOnResize:!0};this._showSimplifiedDialog&&(p.target=this.props.peoplePickerRef);var _,h=f?ne.Yt:ne.Qt,b=this.props.roleSelectorProps&&this.props.roleSelectorProps.roleSelectorAs,g=document.body,v=g?parseInt(getComputedStyle(g).fontSize,10):null;!(v&&v>16)||this._platformDetection&&this._platformDetection.isIE||(_={flexWrap:"wrap"}),this._showSimplifiedDialog&&(_=Object(a.e)(Object(a.e)({},_),{width:"100%",height:this.props.height&&this.props.height,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}));var y="od-Share-PeoplePicker-Suggestions".concat(this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":"");return this._showSimplifiedDialog&&(y="od-Share-PeoplePicker-Suggestions-Simplified-Share ".concat(this._platformDetection.isIE?"isIE":"isNotIE"," od-Share-PeoplePicker-Suggestions-condensed")),i.createElement("div",{style:_,ref:this.props.peoplePickerRef},i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",role:"presentation",className:this._showSimplifiedDialog?"od-Share-PeoplePicker-height":void 0},le.e(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement("div",{className:this._showSimplifiedDialog?"od-Share-PeoplePicker-flexGrow ".concat(this.props.renderIcon?"normal":"space-between"):"od-Share-PeoplePickerContainer ".concat(this.props.renderIcon?"normal":"space-between")},this.props.renderIcon&&i.createElement(m.e,{className:"od-Share-PeoplePicker-PeoplePickerIcon",iconName:"CirclePlus"}),i.createElement("div",{className:"od-Share-PeoplePicker-wrapper",ref:function(e){t._peoplePicker=e}},i.createElement(X,{"aria-describedby":"inputErrorMessage",componentRef:function(e){t._peoplePickerControl.current=e},className:u,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:n,loadingText:ne.Hn,noResultsFoundText:ne.ha,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:s,suggestionsClassName:y,onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store&&this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,onGetMoreResults:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:h,enableSelectedSuggestionAlert:this._platformDetection&&this._platformDetection.isIE,role:"presentation",pickerCalloutProps:p,peoplePickerImprovementsExperiment:!!_e.n(),persistCachePeopleSearch:function(e){var n=t._persistentRequestCache.getRequestKey(e.key,"POST");return t._persistentRequestCache.getDataUtilizingCache({cachingStrategy:ge.e.useCacheIfNotExpired,cacheTimeoutTime:be.e,cacheRequestKey:n,getData:e.getData,returnStatistics:!0})},writeUserInputDataToRumoneLogger:this._writeUserInputDataToRumoneLogger,initRumone:this._initRumone,showDefaultSuggestionOnlyByClick:!ye})),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(b,Object(a.e)({},this.props.roleSelectorProps)))),!this._showSimplifiedDialog&&i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))))},t.prototype._onResolvedSuggestions=function(e,t){var n=this;if(de._()&&ae.g(this.props.clientId)){var a=this._store.getFamily(),i=this._store.getFamilyMembers();if(a&&t.length>1){var r=0===ne.Jt.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),o=!1,s=W.None;r?(s=W.Family,o=!0,e=[a].concat(i,e)):(e.forEach(function(t,n){i.forEach(function(i){(!o&&t.userId===i.userId||t.email===i.email)&&(e.splice(n+1,0,a),o=!0)})}),o&&(s=W.FamilyMember)),this.setState({familyType:s}),o&&!this.state.familyResolveEventFired&&(this.setState({familyResolveEventFired:!0}),this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:Z.e.share,familySuggestionType:W[s]}))}}var c=[],d=[this._store.getCurrentUserId()],l=[];e.forEach(function(e){Object(fe.V)(e.image,n._clientId)&&(e.image=void 0),-1===d.indexOf(e.userId)&&-1===c.indexOf(e.email)&&(n.state.addedUsers.some(function(t){return t.name===e.name&&t.userId===e.userId})||l.push(e),e.userId&&d.push(e.userId),e.email&&c.push(e.email))});try{return this.props.onResolvedSuggestions(l)}catch(e){return l}},t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}},t.prototype._onRenderSuggestionsItem=function(e){var t={text:e.name||"",imageUrl:e.image||"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:e.email||"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(l.e,Object(a.e)({},t,{presence:d.t.none,size:d.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.entityType===s.e.linkedinUser&&i.createElement(m.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails),!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var a=[];t.state.selectedItems.forEach(function(t){t.email===e.email?a.push(n):a.push(t)}),t.setState({selectedItems:a},function(){t.props.onChange(a)})}).catch(function(){var n=Object(a.e)(Object(a.e)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)}),t.setState({selectedItems:i},function(){t.props.onChange(i)})})},t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++)if(t[e].isResolving)return!0;return!1},t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?ne.zi:ne.Ki},t.prototype._computePeopleAddOrRemoveMessage=function(){if(de.l()){var e=this.state,t=e.addedUsers,n=e.removedUsers,a=[];return t.length>0&&(a=a.concat(t.map(function(e){return h.n(ne.ji,e)+". "+ne.Ki}))),n.length>0&&(a=a.concat(n.map(function(e){return h.n(ne.Vi,e)}))),a.length>0?a.toString():""}var i=this.state.previousUsers,r=this.props.defaultSelectedItems;if((null==i?void 0:i.length)>(null==r?void 0:r.length)){var o=i.filter(function(e){return 0===r.filter(function(t){return e.email===t.email}).length})[0];return h.n(ne.Vi,o.name)}if(null==r?void 0:r.length){var s=r[r.length-1];return h.n(ne.ji,s.name)+". "+ne.Ki}},t.prototype._convertPrincipalType=function(e){if(!e)return K.e.none;for(var t=K.e.none,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i&&(t|=K.e.user),"DL"===i&&(t|=K.e.distributionList),"SecGroup"===i&&(t|=K.e.securityGroup),"SPGroup"===i&&(t|=K.e.sharePointGroup)}return t},t.prototype._computeAllowExternalUsers=function(e,t){var n=e===$.e.organizationView,a=e===$.e.organizationEdit;return!(n||a)&&t},t.prototype._renderError=function(){var e,t=this.props.error;if(t&&!this._isResolveInProgress())return this._peoplePickerControl&&!this._hasTakenErrorFocus&&(null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput(),this._hasTakenErrorFocus=!0),i.createElement(ue.e,{error:t,iconName:"Blocked2",backgroundColor:"#FDE7E9",className:"od-Share-PeoplePicker-error"})},t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[],a={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error)return this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(c.e,{ariaLabel:ne.Bi,styles:a},ne.Bi)),e&&n.push(i.createElement(c.e,{ariaLabel:e,styles:a},e)),t&&n.push(i.createElement(c.e,{ariaLabel:t,styles:a},t)),n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0},t.prototype._getSearchForMoreText=function(e){return e?ne.mo:void 0},t.prototype._onFocus=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendPeoplePickerFocused():ie.b(),this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!0)},t.prototype._onBlur=function(){this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!1)},t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?ne.bo:ne._o},t.contextTypes={peoplePickerProvider:te.object.isRequired,resize:te.func.isRequired,platformDetection:te.object.isRequired,sharingStore:te.object.isRequired,clientId:te.number.isRequired,sharingClientMessenger:te.object},t}(o.e),De=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.a)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){this.props.onError&&this.props.onError(e,t)},t}(i.PureComponent),Ie=n(41),xe=n(28),Ce=n(109);function Oe(e){e.onError;var t=e.componentName,n=Object(Ce.e)(function(e,n){Ie.e.logError(e,{"react.componentStack":n.componentStack,"react.component":t},{eventName:"ReactRenderError",resultCode:"",resultType:xe.e.Failure})});return i.createElement(De,Object(a.e)({},e,{onError:n}))}var we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.render=function(){return i.createElement(Oe,{componentName:"peoplePicker.peoplePickerWrapper"},i.createElement(Se,Object(a.e)({},this.props,{selectionLimit:100})))},t}(i.Component);t.e=we},function(e,t,n){"use strict";n.d(t,"e",function(){return v});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharedWith{align-items:center;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;font:-apple-system-body;margin:0}[dir=ltr] .od-SharedWith .label{padding-right:4px}[dir=rtl] .od-SharedWith .label{padding-left:4px}.od-SharedWith-Facepile{display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:flex}.od-SharedWith-List{display:flex}.od-SharedWith-List li{flex-shrink:0}.od-SharedWith-Link--simplified{display:flex}.od-SharedWith-Link--simplified li{flex-shrink:0}.od-SharedWith-Link--simplified .ms-Button-flexContainer{align-items:flex-end}.od-SharedWith-Link--simplified,.od-SharedWith-More--simplified,.od-SharedWith-Persona--simplified{position:relative}.od-SharedWith-Link--simplified .ms-Button-flexContainer,.od-SharedWith-More--simplified .ms-Button-flexContainer,.od-SharedWith-Persona--simplified .ms-Button-flexContainer{align-items:center}.od-SharedWith-Link--simplified .ms-Image,.od-SharedWith-More--simplified .ms-Image,.od-SharedWith-Persona--simplified .ms-Image{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-SharedWith-Persona--simplified .ms-Persona-initials{position:relative;top:2px;right:-2px}.od-SharedWith-More--simplified .ms-Persona-initials{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.od-SharedWith-More--simplified .ms-Persona-initials{box-sizing:unset}}.od-SharedWith-Persona{display:flex;position:relative}.od-SharedWith-Persona-measure{left:0;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}@media screen and (-ms-high-contrast:active){.od-SharedWith-Link .ms-Persona-initials{color:WindowText}}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-SharedWith-More .ms-Persona-initials{color:WindowText}}.od-SharedWith-beak{left:3%!important}.ms-Tooltip-subtext{font-size:.75rem}"}]);var r=n(31),o=n(1),s=n(35),c=n("react-lib"),d=n("react-dom-lib"),l=n(32),u=n(2),f=n(393),p=n(495),m=n(418),_=n(382),h=n(10),b=n(30),g=n("prop-types-lib");function v(e,t){var n=e.ariaLabel,a=e.label,i=e.getPhotoUrl,u=e.onClick,f=e.sharingPrincipals,p=e.sharingLinks,m=e.personaSizeInPixels,g=void 0===m?24:m,v=e.renderOverlap,S=1===b.i(),I=c.useRef(null),x=c.useRef(null),C=c.useRef(null),O=c.useRef(null),w=c.useState(!0),E=w[0],A=w[1],L=c.useState(0),k=L[0],M=L[1],P=c.useRef(0),T=c.useRef(0),U=c.useMemo(function(){var e=[],a={},d=0;if(p.length)for(var l=0,m=p;l<m.length;l++){var _=m[l];if(_.principals.length||_.invitees.length){for(var b=0,I=_.principals;b<I.length;b++)a[(U=I[b]).loginName||U.email]=U;var x=new Date(_.expiration);if(_.isActive&&(!_.expiration||x.getTime()>Date.now()))for(var C=0,O=_.invitees;C<O.length;C++)a[(U=O[C]).loginName||U.email]=U}d++}for(var w=0,E=f;w<E.length;w++)a[(U=E[w]).loginName||U.email]=U;if(P.current=D(a,r.e.user),T.current=D(a,r.e.securityGroup,r.e.sharePointGroup),d&&!S){var A=1===d?o.jo:Object(s.n)(o.Bo,d),L=A+(n?", "+n:"");e.push(c.createElement(y,{ariaLabel:L,className:"".concat(S&&v?"od-SharedWith-Link--simplified":"od-SharedWith-Link"),iconName:"Link",key:".link",onClick:u,title:A,personaSizeInPixels:g,renderOverlap:v}))}for(var k=0,M=Object.keys(a);k<M.length;k++){var U,F=M[k],H=void 0;H=(U=a[F]).imageUrl?U.imageUrl:U.type===r.e.user&&i?i(F):void 0,Object(h.V)(H,t.clientId)&&(H=void 0);var R=U.primaryText+(n?", "+n:"");e.push(c.createElement(y,{ariaLabel:R,imageUrl:H,className:"".concat(S&&v?"od-SharedWith-Persona--simplified":""),key:U.primaryText,onClick:u,text:U.primaryText,title:U.email?"".concat(U.primaryText," <").concat(U.email,">"):U.primaryText,personaSizeInPixels:g,renderOverlap:v}))}return e},[f,p]);c.useEffect(function(){return I.current=new IntersectionObserver(j,{root:O.current,threshold:1}),function(){return I.current.disconnect()}},[]),c.useEffect(function(){if(I.current&&x.current){for(var e=[],n=0;n<x.current.children.length;n++){var a=x.current.children[n];I.current.observe(a),e.push(a)}return function(){for(var n,a=0,i=e;a<i.length;a++){var r=i[a];I.current.unobserve(r)}null===(n=t.resize)||void 0===n||n.call(t)}}});var F,H,R,N=(F=P.current,H=T.current,1===(R=p.length)?1===F?1===H?o.Jo:s.n(o.Yo,H):1===H?s.n(o.Qo,F):s.n(o.qo,F,H):1===F?1===H?s.n(o.Wo,R):s.n(o.Ko,H,R):1===H?s.n(o.zo,F,R):s.n(o.Go,F,H,R)),B=c.createElement("div",{className:"od-SharedWith",ref:O},a&&c.createElement("h2",{className:"label"},a),c.createElement("div",{"aria-label":a,className:"od-SharedWith-Facepile"},!E&&c.createElement("ul",{className:"od-SharedWith-List","aria-label":N,ref:C},U.slice(0,k<U.length-1?k:void 0),k<U.length-1?c.createElement(y,{ariaLabel:n,className:"".concat(S&&v?"od-SharedWith-More--simplified":"od-SharedWith-More"),iconName:"More",key:".more",onClick:u,title:o.Vo,personaSizeInPixels:g,renderOverlap:v}):null),c.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:x,role:"presentation"},U)));return c.useEffect(function(){if((null==C?void 0:C.current)&&(null==x?void 0:x.current))if(S&&v){for(var e=0;e<C.current.children.length;e++)C.current.children[e].style.right="".concat(6*e,"px");for(e=0;e<x.current.children.length;e++)x.current.children[e].style.right="".concat(6*e,"px");for(e=0;e<x.current.children.length;e++)(t=x.current.children[e].firstChild).setAttribute("data-is-focusable","false"),t.setAttribute("tabindex","-1")}else for(e=0;e<x.current.children.length;e++){var t;(t=x.current.children[e].firstChild.firstChild).setAttribute("data-is-focusable","false"),t.setAttribute("tabindex","-1")}}),S?c.createElement(_.e,{hostClassName:"od-SharedWith-tooltip",calloutProps:{gapSpace:0,directionalHint:l.e.topLeftEdge,styles:{beak:["od-SharedWith-beak"]}},content:N},B):B;function j(e){var t=0,n=1e3;if(x.current){for(var a=0,i=e;a<i.length;a++)for(var r=i[a],o=0;o<x.current.children.length;o++)if(x.current.children[o]===r.target){r.intersectionRect.width===r.boundingClientRect.width?t=Math.max(t,o):n=Math.min(n,o);break}0===t&&1e3!==n&&(t=Math.max(0,n-1)),Object(d.unstable_batchedUpdates)(function(){M(function(e){return e!==t?t:e}),A(!1)})}}}function y(e){var t=e.ariaLabel,n=e.className,i=e.iconName,r=e.imageUrl,o=e.onClick,s=e.text,d=e.title,h=e.personaSizeInPixels,g=e.renderOverlap,v=S(h),y=h/16,D=1===b.i(),I={styles:{coin:{width:"".concat(y,"rem"),height:"".concat(y,"rem")},image:{width:"".concat(y,"rem!important"),height:"".concat(y,"rem !important")},imageArea:{width:"".concat(y,"rem"),height:"".concat(y,"rem")},initials:{width:"".concat(y,"rem"),height:"".concat(y,"rem"),fontSize:"0.625rem",lineHeight:"".concat(y,"rem")}}},x={text:s,imageUrl:r,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:v||u.n.size24,onRenderInitials:i?function(){return c.createElement(f.e,{iconName:i})}:void 0,coinProps:I,styles:{root:{height:"1.5rem",minWidth:"".concat(h,"px")},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},C=c.createElement(p.e,Object(a.e)({},x));return C=o?c.createElement(m.e,{"aria-haspopup":!0,ariaLabel:t,className:"compact",onClick:o,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}},C):c.createElement("span",{className:"od-SharedWith-noninteractivePersona",tabIndex:0,"aria-label":t,"data-is-focusable":!0,role:"img"},C),D&&g?c.createElement("li",{className:n},C):c.createElement("li",{className:n},c.createElement(_.e,{hostClassName:"od-SharedWithPersona-tooltip",calloutProps:{gapSpace:0},content:d,directionalHintForRTL:l.e.topLeftEdge},C))}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t}(),t=[],n=null,a=null,i=function(e){this.time=e.time,this.target=e.target,this.rootBounds=l(e.rootBounds),this.boundingClientRect=l(e.boundingClientRect),this.intersectionRect=l(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,a=this.intersectionRect,i=a.width*a.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0},r=function(){function r(e,t){this.THROTTLE_TIMEOUT=100,this.POLL_INTERVAL=null,this.USE_MUTATION_OBSERVER=!0;var n,a,i,r=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType&&9!=r.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),a=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},a))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}return r.prototype._setupCrossOriginUpdater=function(){return n||(n=function(e,n){a=e&&n?u(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach(function(e){e._checkForIntersections()})}),n},r.prototype._resetCrossOriginUpdater=function(){n=null,a=null},r.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},r.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},r.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},r.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},r.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},r.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},r.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var a=this._checkForIntersections,i=null,r=null;this.POLL_INTERVAL?i=n.setInterval(a,this.POLL_INTERVAL):(s(n,"resize",a,!0),s(t,"scroll",a,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(r=new n.MutationObserver(a)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),c(e,"resize",a,!0)),c(t,"scroll",a,!0),r&&r.disconnect()});var d=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=d){var l=o(t);l&&this._monitorIntersections(l.ownerDocument)}}},r.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var a=this.root&&(this.root.ownerDocument||this.root)||e,i=this._observationTargets.some(function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=a;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1});if(!i){var r=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),r(),t!=a){var s=o(t);s&&this._unmonitorIntersections(s.ownerDocument)}}}},r.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},r.prototype._checkForIntersections=function(){if(this.root||!n||a){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(a){var r=a.element,o=d(r),s=this._rootContainsTarget(r),c=a.entry,l=e&&s&&this._computeTargetAndRootIntersection(r,o,t),u=null;this._rootContainsTarget(r)?n&&!this.root||(u=t):u={top:0,bottom:0,left:0,right:0,width:0,height:0};var f=a.entry=new i({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:o,rootBounds:u,intersectionRect:l});c?e&&s?this._hasCrossedThreshold(c,f)&&this._queuedEntries.push(f):c&&c.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},r.prototype._computeTargetAndRootIntersection=function(t,i,r){if("none"!=window.getComputedStyle(t).display){for(var o,s,c,l,f,m,_,h,b=i,g=p(t),v=!1;!v&&g;){var y=null,S=1==g.nodeType?window.getComputedStyle(g):{};if("none"==S.display)return null;if(g==this.root||9==g.nodeType)if(v=!0,g==this.root||g==e)n&&!this.root?!a||0==a.width&&0==a.height?(g=null,y=null,b=null):y=a:y=r;else{var D=p(g),I=D&&d(D),x=D&&this._computeTargetAndRootIntersection(D,I,r);I&&x?(g=D,y=u(I,x)):(g=null,b=null)}else{var C=g.ownerDocument;g!=C.body&&g!=C.documentElement&&"visible"!=S.overflow&&(y=d(g))}if(y&&(o=y,s=b,c=Math.max(o.top,s.top),l=Math.min(o.bottom,s.bottom),f=Math.max(o.left,s.left),h=l-c,b=(_=(m=Math.min(o.right,s.right))-f)>=0&&h>=0&&{top:c,bottom:l,left:f,right:m,width:_,height:h}||null),!b)break;g=g&&p(g)}return b}},r.prototype._getRootRect=function(){var t;if(this.root&&!m(this.root))t=d(this.root);else{var n=m(this.root)?this.root:e,a=n.documentElement,i=n.body;t={top:0,left:0,right:a.clientWidth||i.clientWidth,width:a.clientWidth||i.clientWidth,bottom:a.clientHeight||i.clientHeight,height:a.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},r.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3],height:0,width:0};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},r.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,a=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==a)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==a||r<n!=r<a)return!0}},r.prototype._rootIsInDom=function(){return!this.root||f(e,this.root)},r.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return f(n,t)&&(!this.root||n==t.ownerDocument)},r.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},r.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},r}();window.IntersectionObserver=r,window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function s(e,t,n,a){"function"==typeof e.addEventListener?e.addEventListener(t,n,a||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n,a){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,a||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function d(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function u(e,t){var n=t.top-e.top,a=t.left-e.left;return{top:n,left:a,height:t.height,width:t.width,bottom:n+t.height,right:a+t.width}}function f(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function m(e){return e&&9===e.nodeType}}(),v.contextTypes={clientId:g.number.isRequired,resize:g.func.isRequired};var S=function(e){switch(e){default:return u.n.size24;case 28:return u.n.size28;case 48:return u.n.size48}},D=function(e,t,n){var a=0;for(var i in e)(e[i].type===t||n&&e[i].type===n)&&a++;return a}},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}"}]);var r=n("react-lib"),o=n(494),s=n(106),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.render=function(){return r.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},r.createElement("div",null,r.createElement(o.e,{type:s.t.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),r.createElement("span",{role:"alert"},this.props.message))},t}(r.Component)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(69),i=n(8),r=Object(a.e)({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:i.e.String},isIntentional:{isPrefixingDisabled:!0,type:i.e.Boolean},scenario:{isPrefixingDisabled:!0,type:i.e.String},location:{isPrefixingDisabled:!0,type:i.e.String},usageType:{isPrefixingDisabled:!0,type:i.e.String},currentPage:{isPrefixingDisabled:!0,type:i.e.String},previousPage:{isPrefixingDisabled:!0,type:i.e.String},experiment:{isPrefixingDisabled:!0,type:i.e.Object},siteId:{isPrefixingDisabled:!0,type:i.e.String},webId:{isPrefixingDisabled:!0,type:i.e.String},listId:{isPrefixingDisabled:!0,type:i.e.String},groupId:{isPrefixingDisabled:!0,type:i.e.String},docId:{isPrefixingDisabled:!0,type:i.e.String},webTemplateId:{isPrefixingDisabled:!0,type:i.e.String},listTemplateId:{isPrefixingDisabled:!0,type:i.e.String},siteType:{isPrefixingDisabled:!0,type:i.e.String},feature:{isPrefixingDisabled:!0,type:i.e.String},component:{isPrefixingDisabled:!0,type:i.e.String},extraData:i.e.Object,objectType:{isPrefixingDisabled:!0,type:i.e.String},datasource:{isPrefixingDisabled:!0,type:i.e.String},action:{isPrefixingDisabled:!0,type:i.e.String},privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}}).withData({privacyClassification:i.t.optionalDiagnostic,privacyDataTypes:["browsingHistory"]})},,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{align-items:top;display:flex;padding:0;width:100%}.od-ShareLinkDescription .od-ShareLinkDescription-label-section{width:80%;text-align:left}[dir=ltr] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-left:2%}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-right:2%}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{text-align:right}.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font-size:.75rem;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ShareLinkDescription-label{font-size:.875rem!important;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;top:2px;position:relative;margin:0;width:100%}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}"}]);var r=n(278),o=n(310),s=n(393),c=n("react-lib"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.render=function(){var e=r.e[this.props.permissionsType],t=this.props.iconUrl?c.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):c.createElement(s.e,{"aria-hidden":"true",iconName:e,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return c.createElement("div",{className:"od-ShareLinkDescription"},c.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(e),"aria-hidden":"true"},t),this._renderLabel())},t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?c.createElement(o.e,{message:e}):"";if(this.props.showLabel){var n=this.props.isSelected;t=n?null:t;var a=c.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t);return c.createElement("div",{className:"od-ShareLinkDescription-label-section"},a,n&&c.createElement("span",{className:"od-ShareLinkDescription-detailText"},this.props.detailText))}},t}(c.Component)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(13),i=n(67),r=n(163),o=n(14),s=n(143),c=n(172);Object(s.i)("body");var d=function(){function e(){}return e.initializeTheme=function(t,n,s,d){window.__loadTheme=o.M,(window.FabricConfig=window.FabricConfig||{}).fontBaseUrl="";var l=window._spModuleLink;if(l&&l.libraries&&l.libraries.length>0&&Object(a.e)(1),e._useOverrideTheme)return i.t.resolve(Object(o.A)());var u=Object(r.e)(t,n);return u?(e._themePromise=u.loadFullFormattedThemeData(s).then(function(e){var t=e||{};return Object(c.t)(t,n,d),e}),e._themePromise):i.t.resolve(Object(c.t)({},n,d))},e.overrideTheming=function(t,n){t&&Object(c.t)(t,n,!0),e._useOverrideTheme=!0,e._themePromise&&e._themePromise.cancel()},e._useOverrideTheme=!1,e}();window.FabricConfig&&window.FabricConfig.legacyTheme&&d.overrideTheming()},,function(e,t,n){"use strict";n.d(t,"e",function(){return se}),n.d(t,"t",function(){return ce});var a=n(0),i=n(13);Object(i.t)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ShareMain.wide{min-width:480px}@media (max-width:480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:16px 16px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:12px}.od-ShareMain-section.new{padding:24px;padding-top:14px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{align-self:stretch;padding-bottom:20px;height:2.25rem}.od-ShareMain-section .od-ShareMain-ShareHint.animation{animation:highlight 2s ease-in-out}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-targets-newPadding{clear:both;padding:10px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:flex!important;align-items:center;justify-content:flex-start;padding:0 16px!important;width:100%;height:44px!important;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer!important;border:none!important;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:'!important;font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast:active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-ShareMain-section-body{margin-bottom:0}}.od-ShareMain-copyLink.shareType-section{display:flex;align-items:center;justify-content:space-between}[dir=ltr] .od-ShareMain-Header-backBtnAdjust{margin-left:16px}[dir=rtl] .od-ShareMain-Header-backBtnAdjust{margin-right:16px}@keyframes highlight{from{background:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}35%{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}to{background:0 0}}"}]);var r=n(179),o=n(56),s=n(177),c=n(370),d=n(334),l=n(6),u=n(205),f=n(462);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-method{display:flex;justify-content:space-between;align-items:center}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:.375rem 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}[dir=ltr] div.od-SendLink-emailButtons-left{text-align:right}[dir=rtl] div.od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}[dir=ltr] .od-SendLink-emailButtons-roleSelector{float:right}[dir=rtl] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:4.0625rem;padding-bottom:30px;font-size:.75rem}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:.875rem;height:2rem;width:100%}@supports (font:-apple-system-footnote){.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-sendContainer{justify-content:flex-end}.od-SendLink-characterCounter{font-size:.75rem}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:flex;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;flex-grow:2;width:100%}"}]);var p=n(489),m=n(46),_=n("react-lib"),h=n("prop-types-lib"),b=n(213),g=n(164),v=n(90),y=n(1),S=n(10),D=n(494),I=n(106),x=n(15),C=n(146),O=n(77),w=n(186);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item.new{margin:0}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:3rem;margin-bottom:8px;width:3rem}.od-ShareTargets-itemImage.new{height:2rem;width:2rem;margin-bottom:0;display:flex;align-items:center;justify-content:center}.od-ShareTargets-icon{font-size:1.625rem;padding-top:.6875rem}.od-ShareTargets-icon.new{padding:0;height:24px;width:24px;font-size:24px}.od-ShareTargets-itemImage--border{border:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font:-apple-system-short-caption2;font-size:.625rem}.od-ShareTargets-target{outline:transparent;position:relative;background:0 0;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareTargets-target.new{padding:0 8px 0 0}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:.0625rem solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:.125rem solid highlight}}"}]);var E=n(115),A=n(393),L=n(382),k=n(32),M=n(30),P=n(3);function T(e,t){var i=this,r=_.useState({showCoachmark:!1,teachingBubbleCampaigns:void 0}),o=r[0],s=r[1],c=_.lazy(function(){return Object(a.t)(i,void 0,void 0,function(){return Object(a.i)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return setTimeout(t,e.delayTimeInMilliseconds)})];case 1:return t.sent(),[2,n.ee([17],753)]}})})});return _.useEffect(function(){var n=setTimeout(function(){return Object(a.t)(i,void 0,void 0,function(){return Object(a.i)(this,function(e){return Promise.all([t.loadTeachingBubbleCampaigns(),t.shouldTeachingBubbleBeShown(t.campaignKey)]).then(function(e){var t=e[0],n=e[1];s({teachingBubbleCampaigns:t,showCoachmark:n})}),[2]})})},e.delayTimeInMilliseconds);return function(){return clearTimeout(n)}},[s]),o.showCoachmark&&o.teachingBubbleCampaigns&&_.createElement(_.Suspense,{fallback:_.createElement(_.Fragment,null)},_.createElement(c,{componentRef:e.componentRef,delayTimeInMilliseconds:e.delayTimeInMilliseconds,target:e.target,teachingBubbleCampaign:o.teachingBubbleCampaigns[t.campaignKey],dismissCallback:function(){t.markTeachingBubbleAsDismissed(t.campaignKey),s({showCoachmark:!1,teachingBubbleCampaigns:void 0})},onTeachingBubbleSeen:e.onTeachingBubbleSeen,onPrimaryButtonClicked:e.onPrimaryButtonClicked}))}T.contextTypes={shouldTeachingBubbleBeShown:h.func,markTeachingBubbleAsDismissed:h.func,loadTeachingBubbleCampaigns:h.func,campaignKey:h.number};var U=n(23),F=n(70),H=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),R=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg"),N=function(e){function t(t){var n=e.call(this,t)||this;return n._shareToTeamsExperiment=M.a(),n._shareToTeamsCoachmarkTarget=_.createRef(),n._coachmarkRef=_.createRef(),n._showTeams=!1,n.state={areTargetsReady:!1},n}return Object(a.a)(t,e),t.prototype.componentDidMount=function(){var e=this;this._shareToTeamsExperiment&&this.context.canUseTeams().then(function(t){e._showTeams=t,e.setState({areTargetsReady:!0})})},t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.audience!==o.e.anyone&&this.props.currentSettings.audience!==o.e.organization;return this._shareToTeamsExperiment?(this._shareTargetsData=this.state.areTargetsReady&&this._getShareTargetsData(),e?_.createElement(L.e,{content:y.a,calloutProps:{calloutWidth:300,directionalHint:k.e.topCenter}},_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Wa},this.state.areTargetsReady&&this._renderTargets())):_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Wa},this.state.areTargetsReady&&this._renderTargets())):(this._shareTargetsData=this._getShareTargetsData(),e?_.createElement(L.e,{content:y.a,calloutProps:{calloutWidth:300,directionalHint:k.e.topCenter}},_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Wa},this._renderTargets())):_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Wa},this._renderTargets()))},t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.audience!==o.e.anyone&&this.props.currentSettings.audience!==o.e.organization,n=!P.t.isActivated("2f033097-46da-4c25-9748-ce932d169987","07/01/2021","Blocking share targets (e.g. CopyLink) by blockPeoplePickerAndSharing.")&&this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==o.e.existing,a=0,i=this._shareTargetsData;a<i.length;a++){var r,s=i[a],c=s.icon,l=c.split(":",2)[1],u=t||n||Object(S.R)(this.props.sharingInformation),f="od-ShareTargets-icon ".concat(u?"od-ShareTargets-disabled":""," new");"od-ShareTargets-itemText ms-font-xs ".concat(u?"od-ShareTargets-disabled":""),r=c.indexOf("font:")>-1?_.createElement(A.e,{iconName:l,className:f}):_.createElement("img",{src:c,className:f}),e.push(_.createElement("li",{key:s.shareType,className:"od-ShareTargets-item new"},_.createElement(L.e,{content:s.label,styles:{root:{display:"inline-block"}}},_.createElement("button",{className:"od-ShareTargets-target new","aria-label":s.label,disabled:u,onClick:s.action,id:s.id,ref:s.shareType===d.e.webShareToTeams?this._shareToTeamsCoachmarkTarget:null},s.shareType===d.e.webShareToTeams?this._renderCoachmark():_.createElement(_.Fragment,null),_.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage new"},r)))))}return e},t.prototype._renderCoachmark=function(){return _.createElement(T,{componentRef:this._coachmarkRef,delayTimeInMilliseconds:200,target:this._shareToTeamsCoachmarkTarget,onTeachingBubbleSeen:this.context.onTeachingBubbleSeen(this.context.campaignKey),onPrimaryButtonClicked:this._onClick.bind(this,d.e.webShareToTeams)})},t.prototype._getShareTargetsData=function(){var e=[],t=this._determineMailShareTarget(this.props.clientId);if(Object(F.e)()&&window.sessionStorage.setItem("outlookAvailability",t.toString()),t===E.e.available){var n=x.o(this.props.clientId)?"font:OutlookLogo":H,a="".concat(y.Po," ").concat(y.Qa);e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:d.e.outlook,action:this._onClick.bind(this,d.e.outlook),id:"od-ShareTarget-outlookButton"})}else t===E.e.other&&(a="".concat(y.Po," ").concat(y.ba),e.push({label:a,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:d.e.nonOutlook,action:this._onClick.bind(this,d.e.nonOutlook),id:"od-ShareTarget-nonOutlookButton"}));return Object(U.f)()?(a="".concat(y.Po," ").concat(y.zs),e.push({label:a,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:d.e.mobileShareToTeams,action:this._onClick.bind(this,d.e.mobileShareToTeams),id:"od-ShareTarget-mobileTeamsButton"})):this.props.fullscreenIframeMode&&this._shareToTeamsExperiment&&!this.context.platformDetection.isIE&&this._showTeams&&(n=R,a="".concat(y.Po," ").concat(y.zs),e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:d.e.webShareToTeams,action:this._onClick.bind(this,d.e.webShareToTeams),id:"od-ShareTarget-webTeamsButton"})),Object(U.d)()&&(a="".concat(y.Po," ").concat(y.$n),e.push({label:a,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:d.e.moreApps,action:this._onClick.bind(this,d.e.moreApps),id:"od-ShareTarget-moreAppsButton"})),e},t.prototype._onClick=function(e){var t;e===d.e.webShareToTeams&&(null===(t=this._coachmarkRef.current)||void 0===t||t.dismiss()),this.props.onShareTargetClicked(e)},t.prototype._determineMailShareTarget=function(e){return x.b(this.props.clientId)&&this.props.outlookAvailability===E.e.available?E.e.available:Object(U.a)()},t.contextTypes={platformDetection:h.object.isRequired,shouldTeachingBubbleBeShown:h.func,onTeachingBubbleSeen:h.func,markTeachingBubbleAsDismissed:h.func,campaignKey:h.number,canUseTeams:h.func},t}(_.Component);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SummaryBox-header-Area{display:flex;justify-content:space-between;align-items:center;min-height:24px}.od-SummaryBox-header-TextField{display:flex;font-weight:600;font-size:.625rem;align-self:center}.od-SummaryBox-summary-Main{margin:auto;padding-top:0}.od-SummaryBox-header-sparkle{height:15%;width:15%;align-self:center}[dir=ltr] .od-SummaryBox-header-sparkle{margin-right:3px}[dir=rtl] .od-SummaryBox-header-sparkle{margin-left:3px}.od-Summary-tooltipIcon{vertical-align:middle}[dir=ltr] .od-Summary-tooltipIcon{margin-left:calc(50% - 5px + 5px)}[dir=rtl] .od-Summary-tooltipIcon{margin-right:calc(50% - 5px + 5px)}.od-SummaryBox-buttonsContainer{display:flex}.od-SummaryBox-header-closeButton{height:16px;width:16px}.od-SummaryBox-header-closeButtonIcon{font-size:.625rem}.od-SummaryBox-summary-Main::-webkit-scrollbar{width:5px;height:27px}.od-SummaryBox-summary-Main::-webkit-scrollbar-thumb{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:38px}.od-SummaryBox-summary-Main::-webkit-scrollbar-track{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:38px}.od-SummaryBox-footer-CharacterCount{text-align:right;font-size:.625rem;margin-top:5px;align-self:center}"}]);var B=n(418),j=n(497),V=function(e){var t,n=e.summaryText,a=e.onSave,i=e.renderSeparator,r=Object(_.useState)(!1),o=r[0],s=r[1],c=Object(_.useState)(n),d=c[0],l=c[1],u=Object(_.useState)(!1),f=u[0],m=u[1],h="(".concat(d.length,"/").concat(500,")");return _.createElement(_.Fragment,null,!o&&_.createElement(_.Fragment,null,i&&_.createElement(j.e,null),_.createElement("div",{className:"od-SummaryBox-Entire"},_.createElement("div",{className:"od-SummaryBox-header-Area"},_.createElement("div",{className:"od-SummaryBox-header-TextField"},(t=window.require.toUrl("odsp-media/images/photostream/sparklepreviewcolor.svg"),_.createElement("img",{role:"presentation",src:t,className:"od-SummaryBox-header-sparkle"})),y.Fo,_.createElement(L.e,{content:y.Ho},_.createElement(A.e,{iconName:"Error",className:"od-Summary-tooltipIcon"}))),_.createElement(B.e,{className:"od-SummaryBox-header-closeButton",onClick:function(){s(!0),a("")},iconProps:{iconName:"Cancel",className:"od-SummaryBox-header-closeButtonIcon"},title:y.qr})),_.createElement("div",{className:"od-SummaryBox-summary-TextArea"},_.createElement(p.e,{className:"od-SummaryBox-summary-Main",borderless:!0,ariaLabel:y.To,placeholder:y.Uo,defaultValue:d,value:d,styles:{fieldGroup:{border:"none",borderRadius:"0px"}},multiline:!0,resizable:!1,onChange:function(e,t){l(t||""),m(!0)},onBlur:function(){f&&(a(d),m(!1))}}),d.length>250&&_.createElement("div",{className:"od-SummaryBox-footer-CharacterCount"},h)))))};V.propTypes={summaryText:h.string.isRequired,onSave:h.func.isRequired};var z,G=V,K=function(e){function t(t,n){var i=e.call(this,t)||this;return i._topLevelDivRef=_.createRef(),i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=Object(S.p)(e);return i.setState(Object(a.e)(Object(a.e)({},i.state),{messageLength:t})),""},i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=Object(S.p)(e);return i.setState(Object(a.e)(Object(a.e)({},i.state),{subjectLength:t})),e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength},i._onResolvedSuggestions=function(e){return i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e),e},i._onSendLinkClicked=function(e,t){if(i.props.summaryText){var n=Object(a.e)(Object(a.e)({},i.props.engagementExtraData),{summaryTextRemoved:""===i.state.summaryContent,summaryTextEdited:""!==i.state.summaryContent&&i.state.summaryContent!==i.props.summaryText,summaryTextFailed:!!i.props.summaryText&&-1!==i.props.summaryText.indexOf("Something went wrong with retrieving a summary")});i.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked.WithSummary",n)}i.props.onSendLinkClicked(e,t)},i._platformDetection=n.platformDetection,i.state={messageLength:0,summaryContent:i.props.summaryText,subjectLength:0},i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i),i._resizeTracker=new C.e(n.resize),i}return Object(a.a)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){m.s({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(S.a)(e.sharingInformation)?e.onShareHintClick:void 0,permissionsMap:e.permissionsMap}),this.setState(Object(a.e)({},this.state))},t.prototype.componentDidMount=function(){this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e){this._resizeIfNeeded(),e.summaryText!==this.props.summaryText&&this.props.showItemInsights&&this.props.summaryText&&this.updateSummaryContent(this.props.summaryText)},t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,a=m.n(n),i=m.a(n,e.groupsMemberCount),r=this._platformDetection.isIOS||x.r(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||x.n(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";r+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=_.createElement(N,{fullscreenIframeMode:this.props.fullscreenIframeMode,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this.props.onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}),s=!P.t.isActivated("c64fce8e-f4d5-4df5-904c-2fbb56e98484","02/23/2023","Allow the sending of document summary in an email through sharing dialog."),c=this.props.showSendButton?_.createElement("div",{className:r},_.createElement(g.e,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:s?""===this.props.summaryText?this.props.messageText:this.props.messageText+"\n"+this.state.summaryContent:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this._onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:v.e.button,sharingInformation:this.props.sharingInformation})):"",d=e.isLoadingDefaultRecipients?_.createElement("div",null,_.createElement(D.e,{className:"od-SendLink-spinner",label:y.Rn,size:I.e.small})):_.createElement(b.e,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:a,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:this._shouldRenderRoleSelector(),roleSelectorProps:this._getRoleSelectorProps()});return _.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},_.createElement("div",{className:"od-SendLink-email"},_.createElement("div",{className:"od-SendLink-peoplePicker"},d),_.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),_.createElement("div",{className:"od-SendLink-method"},o,c))))},t.prototype._shouldRenderRoleSelector=function(){return this.props.currentSettings.audience!==o.e.existing},t.prototype._getRoleSelectorProps=function(){var e=Object(S.R)(this.props.sharingInformation),t=Object(O.t)({sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:u.e.share}),n=Object(O.c)(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension);return{shimmer:e,menuPermissionOptions:t,sharingRole:this.props.currentSettings.sharingRole,mode:u.e.share,clientId:this.props.clientId,ariaLabel:y.kn,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings,roleSelectorAs:w.e,showDropdownWithOfficeReview:n}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData),this.props.onManageExistingAccessClick()},t.prototype.updateSummaryContent=function(e){this.setState({summaryContent:e})},t.prototype._renderTextArea=function(){var e=this;if(this.props.showTextArea){var t=this.props.showItemInsights&&!!this.props.summaryText,n=this.props.summaryText;return _.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&_.createElement(p.e,{borderless:!0,underlined:!0,placeholder:y.Ns,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),_.createElement(p.e,{borderless:!0,placeholder:y.Kn,ariaLabel:y.Wn,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}),t&&_.createElement(G,{summaryText:n,onSave:function(t){n=t,e.updateSummaryContent(t)},renderSeparator:!0}))}},t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t=e>this.props.maximumMessageLength,n="od-SendLink-characterCounter ".concat(t?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return t?_.createElement("div",{className:"od-SendLink-characterCounterWrapper"},_.createElement("span",{"aria-label":y.Ce,role:"alert",className:n},e,"/",this.props.maximumMessageLength)):_.createElement("div",{className:"od-SendLink-characterCounterWrapper"},_.createElement("span",{className:n},e,"/",this.props.maximumMessageLength))},t.contextTypes={platformDetection:h.object.isRequired,sharingStore:h.object.isRequired,resize:h.func.isRequired},t}(_.Component),W=n(214),q=n(185),Q=n(88),Y=n(4);(z||(z={})).getAttachAsCopyOptions=function(e,t,n,a){var i=[],r=function(e,t,n,a){var i=n.name.split("."),r="";if(i.length>1&&(r=i[1].toLowerCase()),Object(U.l)()){var o=function(){!function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t),Object(U.v)()}(e,a)};return x.m(t)||function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1}(r)?{key:"word",name:y.sc,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:o}:x.u(t)||function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1}(r)?{key:"powerpoint",name:y._r,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:o}:x.i(t)||function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1}(r)?{key:"excel",name:y.wt,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:o}:x.p(t)||function(e){return["vsd","vsdx"].indexOf(e)>-1}(r)?{key:"visio",name:y.rc,iconProps:{iconName:"VisioLogo"},onClick:o}:{key:"document",name:y.yt,iconProps:{iconName:"Document"},onClick:o}}}(n,e,t,a);r&&i.push(r);var o=function(e,t){if(Object(U.u)())return{key:"pdf",name:y.Ii,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){!function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t),Object(U.S)()}(e,t)}}}(n,a);return o&&i.push(o),i};var J=z,X=n(215),Z=n(309),$=n(79),ee=n(59),te=n(5),ne=n(71),ae=n(275),ie=function(e){var t={hideItemName:!e.singleComponent,doNotrenderHeaderButtons:!e.singleComponent,titleIsSubLevel:!0,sendButtonType:e.singleComponent?v.e.button:v.e.copyLink,shouldBeFocused:e.singleComponent,hostOptions:e.hostOptions};return _.createElement("div",{className:"od-ShareMain-section new"},_.createElement(r.e,Object(a.e)({},Object(Q.e)(e),{item:e.sharingInformation.item,title:y.ze,hideItemName:t.hideItemName,doNotrenderHeaderButtons:t.doNotrenderHeaderButtons,titleIsSubLevel:t.titleIsSubLevel,hostOptions:t.hostOptions})),_.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},_.createElement(q.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:function(){e.onShareHintClick(ne.t.CopyLinkSettingsHint,!0)},sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig}),_.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},_.createElement(g.e,{ctaLabel:y.Ge,currentSettings:e.currentSettings,linkRecipients:null,onSendLinkClicked:e.onSendLinkClicked,permissionsMap:null,sharingInformation:e.sharingInformation,sendButtonType:t.sendButtonType,shouldBeFocused:t.shouldBeFocused}))))},re=n(209),oe=n(43),se=500,ce=function(e){function t(t,n){var a=e.call(this,t)||this;return a._headerControl=Object(_.createRef)(),a._peoplePickerHasUnresolvedText=!1,a._onSharedWithClicked=function(){a.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(a._engagementExtraData),a.props.onShowPermissionsListClicked()},a._onConfirmationExternalSharingApply=function(){a.setState({showConfirmationDialog:!1,showShareHintAnimation:!0},function(){a.props.onAudienceChange(o.e.specificPeopleFlex,s.e.flexible,c.e.specificPeople)})},a._onConfirmationExternalSharingCancel=function(){a.setState({showConfirmationDialog:!1})},a._onSelectedPeopleChange=function(e){var t=a.props,n=void 0;Object(S.a)(t.sharingInformation)&&(n=t.onShareHintClick,te.g()&&(n=t.onShareHintClick.bind(a,ne.t.PeoplePickerErrorLinkSettingsHint)));var i=m.s({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:n,permissionsMap:t.permissionsMap,audience:t.currentSettings.audience,scope:t.currentSettings.sharingScope}),r=!1,o=!1,d=null;if(i){for(var l=t.currentSettings.sharingLinkKind,u=te.se()?l===s.e.organizationEdit||l===s.e.organizationView:t.currentSettings.sharingScope===c.e.organization,f=0,p=e;f<p.length;f++){var _=p[f];if(_.isExternal&&u){r=!0,M.t()&&(o=!0,d=_);break}}r&&a.context.sharingStore.getEngagementHelper().externalSharingCslError(a._engagementExtraData)}a.setState({peoplePickerErrorMessage:i,showConfirmationDialog:o,externalSharingPerson:d},function(){t.onSelectedPeopleChange(e)})},a._onPeoplePickerInputChange=function(e){a._peoplePickerHasUnresolvedText=""!==e},a._onShareTargetClicked=function(e,t){(a.context.sharingStore.isConsumer()&&a.props.currentSettings.audience!==o.e.specificPeople||a._isPeoplePickerValid(e)||!(a.props.currentSettings.audience===o.e.specificPeopleFlex||a.props.currentSettings.audience===o.e.specificPeople||a.props.linkRecipients.length>0))&&a.setState({showActivityIndicator:!0,shareType:e},function(){a.props.onShareTargetClicked(e,t)})},a._onCopyLinkSectionCopyButtonClicked=function(){a.context.sharingStore.getEngagementHelper().log("ShareV3.copyLinkSectionCopyButtonClicked",a.props.engagementExtraData),a._onShareTargetClicked(d.e.copy,!0)},a._onSendLinkClicked=function(e,t){a.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",a.props.engagementExtraData),a._isPeoplePickerValid(d.e.share)&&a.setState({showActivityIndicator:!0,shareType:d.e.share},function(){a.props.onSendLinkClicked(e,t)})},a._onAttachAsCopyClicked=function(){var e=a.props.clientId;if(a.context.sharingStore.getEngagementHelper().sendACopyClicked(a._engagementExtraData),x.c(e)){var t=!a.state.isAttachAsCopyContextualMenuVisible;a.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===l.e.ngsc||x.o(e))try{window.external.SendCopy()}catch(e){}},a._shareClickTime=n.shareClickTime,a._shouldRenderSharedWith=!n.sharingStore.isConsumer||!n.sharingStore.isConsumer()||te.e(),a._engagementExtraData=t.engagementExtraData,a._sharingClientMessenger=n.sharingClientMessenger,a.state={isAttachAsCopyContextualMenuVisible:!1,shareType:d.e.share,showActivityIndicator:!1,peoplePickerErrorMessage:null,showConfirmationDialog:!1,externalSharingPerson:null,showShareHintAnimation:!1},a}return Object(a.a)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():U.h(this._shareClickTime,this.props.clientId,u.e.share,this.props.scenarioId,this.props.correlationId),this._updatePeoplePickerError(this.props),x.o(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)},t.prototype.render=function(){var e=this.props,t=this.state.showActivityIndicator?this._getActivityMessage():"",n=this.props.hideShareDialogOverflowButton||this._shouldRenderSharedWith,i=this._renderFooter(),o=this.props.hasBackButton?"od-ShareMain-Header-backBtnAdjust":"";return _.createElement("div",{className:"od-ShareMain ".concat(this.state.showActivityIndicator?" blocker":"")},_.createElement("div",{className:"od-ShareMain-section new"},_.createElement("div",{className:"od-ShareMain-Header ".concat(o)},_.createElement(r.e,Object(a.e)({},Object(Q.e)(this.props),{item:e.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:Y.e.default,hideShareDialogOverflowButton:n,ref:this._headerControl,hasBackButton:this.props.hasBackButton,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus,fullScreenIframeMode:this.props.fullScreenIframeMode,sensitivityLabelInformation:this.props.sharingInformation.sensitivityLabelInformation,getGraphToken:this.props.getGraphToken}))),_.createElement("div",{className:"od-ShareMain-ShareHint ".concat(this.state.showShareHintAnimation?"animation":"")},_.createElement(q.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:e.onShareHintClick.bind(this,ne.t.MainLinkSettingsHint),sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig})),this._renderSendLink(),this.props.shouldWaitForSharingInfoBarInformation&&this._renderSharingInfoBar()),this._renderCopyLinkSection(n),this._renderSharedWith(),i,this._renderActivityIndicator(),this._renderConfirmationDialogExternalSharing(),ee.e(t,"assertive","alert",!0))},t.prototype._renderSharingInfoBar=function(){return _.createElement(_.Suspense,{fallback:_.createElement(D.e,null)},_.createElement(oe.u,{sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,parentCssClass:"ShareMain"}))},t.prototype._renderCopyLinkSection=function(e){return te.V()?_.createElement(_.Fragment,null,_.createElement(ae.e,null),_.createElement(ie,{singleComponent:!1,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked})):_.createElement("div",{className:"od-ShareMain-section new separator-top"},_.createElement(r.e,Object(a.e)({},Object(Q.e)(this.props),{item:this.props.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:Y.e.default,hideShareDialogOverflowButton:e,ref:this._headerControl,title:y.ze,doNotrenderHeaderButtons:!0,hideItemName:!0,titleIsSubLevel:!0})),_.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},_.createElement(q.e,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,onShareHintClick:this.props.onShareHintClick.bind(this,ne.t.CopyLinkSettingsHint,!0),sharingInformation:this.props.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}),_.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},_.createElement(g.e,{ctaLabel:y.Ge,currentSettings:this.props.currentSettings,errorMessage:this.state.peoplePickerErrorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:se,maximumSubjectLength:se,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked,permissionsMap:this.props.permissionsMap,sendButtonType:v.e.copyLink,sharingInformation:this.props.sharingInformation}))))},t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(x.c(t)){var n=J.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this._engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return _.createElement("div",null,_.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},_.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},_.createElement(A.e,{iconName:"Copy"})),_.createElement("span",null,y.$)));if(n.length>0)return _.createElement("div",null,_.createElement(Z.e,{className:"od-ShareMain-footer",text:y.$,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n},styles:{label:{marginLeft:"0px"}}}))}else if((t===l.e.ngsc||x.o(t))&&this._isSendCopyEnabled())return _.createElement("div",null,_.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},_.createElement("div",{className:"od-ShareMain-attachIcon"},_.createElement(A.e,{iconName:"Copy"})),_.createElement("span",null,y.$)))},t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||Object(S.R)(this.props.sharingInformation)){var e=this.props;return _.createElement(K,{fullscreenIframeMode:this.props.fullScreenIframeMode,ctaLabel:y.go,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,summaryText:e.summaryText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:se,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClick:this.props.onShareHintClick,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClick.bind(this,ne.t.RoleSelector),onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,showItemInsights:this.props.showItemInsights})}},t.prototype._renderSharedWith=function(){if(this._shouldRenderSharedWith){var e=Object(S.O)(this.props.sharingInformation,this.context.sharingStore.isConsumer()),t=e.shared,n=e.activeLinks,a=e.sharingPrincipals;return t?_.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith new separator-top"},_.createElement(W.e,{ariaLabel:y.Bn,label:y.No,getPhotoUrl:Object($.t)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:n,sharingPrincipals:a})):null}return null},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return _.createElement(X.e,{message:this._getActivityMessage(),ariaHidden:!0})},t.prototype._renderConfirmationDialogExternalSharing=function(){if(!M.t()||!this.state.showConfirmationDialog||!this.state.externalSharingPerson)return null;var e=this.state.externalSharingPerson;return _.createElement(_.Suspense,{fallback:_.createElement(D.e,null)},_.createElement(oe.t,{confirmationCode:re.e.shareDialogExternalSharing,participant:e,onApply:this._onConfirmationExternalSharingApply,onCancel:this._onConfirmationExternalSharingCancel}))},t.prototype._getActivityMessage=function(){switch(this.state.shareType){case d.e.share:return y.p;case d.e.mobileShareToTeams:case d.e.webShareToTeams:return y.f;case d.e.outlook:return y.u;case d.e.copy:case d.e.nonOutlook:case d.e.moreApps:default:return y.l}},t.prototype._isSendCopyEnabled=function(){return U.l()},t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==d.e.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===o.e.specificPeople){for(var t=!1,n=!1,a=0,i=this.props.linkRecipients;a<i.length;a++){var r=i[a];t||(t=r.isExternal&&!r.providerName),n||(n=!r.isExternal||r.isExternal&&!!r.providerName)}if(t&&n)return this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Qn)}),!1}var s=this.props.currentSettings.audience===o.e.specificPeopleFlex||this.props.currentSettings.audience===o.e.specificPeople||e===d.e.share;return this._peoplePickerHasUnresolvedText?(this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Ys)}),!1):0!==this.props.linkRecipients.length||!s||(this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Wr)}),!1)}},t.prototype._updatePeoplePickerError=function(e){var t=void 0;if(Object(S.a)(e.sharingInformation)&&(t=e.onShareHintClick,te.g()&&(t=e.onShareHintClick.bind(this,ne.t.PeoplePickerErrorLinkSettingsHint))),e.linkRecipients||e.sharingInformation.errorCategory==f.e.shareLink){var n=m.s({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:t,permissionsMap:e.permissionsMap,audience:e.currentSettings.audience,scope:e.currentSettings.sharingScope});n||e.sharingInformation.errorCategory!=f.e.shareLink||(n=_.createElement("span",null,e.sharingInformation.errorMessage)),this.setState({peoplePickerErrorMessage:n,showActivityIndicator:!n&&this.state.showActivityIndicator})}},t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})},t.contextTypes={shareClickTime:h.number,sharingStore:h.object.isRequired,sharingClientMessenger:h.object},t}(_.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n("react-lib"),i=n("prop-types-lib"),r=n(13);Object(r.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-sensitiviity-label-left-align{border-radius:2px;padding:3px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-sensitivity-label{border-radius:4px;padding:3px 6px 3px 6px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex}[dir=ltr] .od-sensitivity-label{margin-left:8px}[dir=rtl] .od-sensitivity-label{margin-right:8px}.od-sensitivity-text{font-size:.75rem;font-weight:400;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.od-sensitivity-tooltip-text{font-size:.75rem;font-weight:600;margin:0;margin-bottom:2px}.od-sensitivity-tooltip-information{font-size:.75rem;margin:0}.od-sensitivity-label-container{display:flex}"}]);var o=n(396),s=n(382),c=n(32),d=n(30),l=n(1);function u(e,t){var n=a.useState(null),i=n[0],r=n[1],u=1===d.i();return e.sensitivityLabelInformation.displayName&&t.sharingStore.getEngagementHelper().showSensitivityLabel(e.engagementExtraData),a.createElement("div",{className:"od-sensitivity-label-container"},a.createElement(s.e,{tooltipProps:{directionalHint:c.e.bottomAutoEdge,onRenderContent:function(){return t.sharingStore.getEngagementHelper().hoverOverSensitivityLabel(e.engagementExtraData),a.createElement("div",{className:"od-sensitivity-tooltip"},a.createElement("p",{className:"od-sensitivity-tooltip-text"},u&&l.So," ",e.sensitivityLabelInformation.displayName),a.createElement("p",{className:"od-sensitivity-tooltip-information"},i))},calloutProps:{hidden:null===i||0===i.length}},onTooltipToggle:function(n){return n?void(null===i&&t.sharingStore.getSensitivityLabels(e.getGraphToken).then(function(t){if(t){var n=t.filter(function(t){return t.id===e.sensitivityLabelInformation.id});0!==n.length?r(n[0].tooltip):r("")}else r("")}).catch(function(){r("")})):null},styles:{root:{display:"flex",overflow:"hidden",width:"min-content"}}},a.createElement(o.e,{tabIndex:0,className:e.filename&&0!==e.filename.length?"od-sensitivity-label":"od-sensitiviity-label-left-align"},a.createElement("p",{className:"od-sensitivity-text"},e.sensitivityLabelInformation.displayName))))}u.contextTypes={sharingStore:i.object.isRequired}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(69),i=n(8),r=Object(a.e)({eventName:"Trace,",shortEventName:"Trace"},{message:i.e.String,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}}).withData({privacyClassification:i.t.requiredService,privacyDataTypes:["browsingHistory"]})},function(e,t,n){"use strict";function a(e,t){var n,a,i=!!e.Fallback,r=e.ODB;if("boolean"==typeof r)i=r;else if(r>0){if(r>=6e4){var o=r-6e4+2e3+1;n=Math.floor(o/32),a=1<<o%32}else{if(!(r<=2e3))return!1;n=Math.floor(r/32),a=1<<r%32}i=n<t.length&&0!=(t[n]&a)}return i}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(177),i=n(176),r=n(3).t.isActivated("172ad921-3f82-4520-b314-2807be4528da","4/18/2023","use new logic for isShared property");function o(e,t){if(r){for(var n=!1,o=0,s=e;o<s.length;o++){var c=s[o];c.isActive&&c.sharingLinkKind!==a.e.direct&&(n=!0)}return n||(n=t.length>0),n}var d=e.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==a.e.direct&&(!e.expiration||t.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)});if(!(n=!!d.length)&&t.length)for(var l=0,u=t;l<u.length;l++)if(u[l].role!==i.e.owner){n=!0;break}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",SITE_TEMPLATES:"SuiteMenu_MenuItem_SiteTemplates",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LIST_SETTINGS:"SuiteMenu_ListSettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",VIVA_CONNECTIONS:"Viva_Connections_Settings",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",STREAM:"ShellStream",LISTS:"Lists",SHAREPOINT:"Sharepoint",CLIPCHAMP:"Clipchamp"}},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(123),r=n(103),o=n(287),s=n(47),c=n(98),d="ShareControl",l=function(){function e(e){void 0===e&&(e="sharedialog");var t=this;this.resetRumOneApiMeasurement=function(){t._rumone.undoAPIInstrument()},this.computeRenderTime=function(e){return e&&e.startTime&&e.endTime?e.endTime-e.startTime:0},this.checkRenderTimeRequiredDataAvailable=function(e){return!!e&&!!e.startTime&&!!e.endTime},this._rumone=i.e.getRUMOneLogger(e)}return e.prototype.logSharingPerformance=function(e,t){var n=this;if(this._rumone&&this._rumone.isRunning()){var i=this.breakdownData;this._rumone.writeScenarioId("ShareDialog.".concat(e.modeName)),this._rumone.addExpectedControl(d),this._rumone.writePageTransitionType(t||r.e.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var s=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;s&&(this._rumone.collectSPClientFlights(window._spPageContextInfo),this._evaluateExperiments(window._spPageContextInfo)),this._rumone.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(t,a,i){var r=n._regulateTime(t)-n._regulateTime(e.startTime);return n._rumone.addEUPLBreakdown("ttiAbsoluteTime_".concat(i),{data:t,needFlatten:!1}),n._rumone.addEUPLBreakdown("transactionStartTime_".concat(i),{data:e.startTime,needFlatten:!1}),n._rumone.addEUPLBreakdown(i,{data:r,needFlatten:!1}),r},options:Object(a.e)({useMutationObserver:!1,trackNetworkRequests:!1},{requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3})},FCIMeasurementSettings:{disabled:!0}}});var c=new o.e({controlId:d,startTime:e.startTime,endTime:e.endTime,renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(c);var l=e.breakDownData,u=this._getResponseEnd();l=Object(a.e)(Object(a.e)({},l),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),herf:i(location.href),isShareDialogASPXHosted:i(s),w3cResponseEnd:i(u-performance.timing.navigationStart),appStart:i(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(u)),render:i(this._regulateTime(e.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))}),this._rumone.writeEUPLBreakdown(JSON.stringify(l))}},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype.breakdownData=function(e){return{data:e,needFlatten:!0}},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&s.e?e-performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e.prototype._evaluateExperiments=function(e){e&&Object(c.n)(90089,e)},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return x});var a=n(0),i=n(24),r=n(85),o=n(21),s=n(48),c=n(149),d=n(31),l=n(67),u=n(126),f=n(110),p=n(108),m=n(130),_=n(129),h=n(92),b=n(3),g=function(){function e(t){var n;if(this._raw=t,t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var a,i,r=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,s=e.EmailMatchTypes.None;null!==(i=r.exec(t));){var c=i[0],d=c.charAt(0),l=c.charAt(c.length-1);if((s="<"===d&&">"===l?e.EmailMatchTypes.Bracketed:'"'===d&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o&&(a=i,o=s,s===e.EmailMatchTypes.Bracketed))break}var u=t;if(a){n=a[0];var f=a.index,p=f+n.length,m=f>0?t.substr(0,f).trim():"",_=p<t.length?t.substr(p):"";"'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&_&&"'"===_.charAt(0)&&(n=n.slice(1),_=_.slice(1).trim()),u=""===m?_:m,this._email=n.trim()}(u=u.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==u.charAt(u.length-2)&&(u=u.replace(/\s*"$/,"")),""!==(u=u.replace(/\//g,""))&&u!==n&&(this._name=u)}}return e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())},e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),a=[],i=0,r=n.length;i<r;i++)a.push(new e(n[i]));return a},e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1},e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),a=n.length-1;a>=0;a--)n[a]=n[a].trim(),0===n[a].length&&n.splice(a,1);return n},e.prototype.getEmail=function(){return this._email},e.prototype.getName=function(){return this._name},e.prototype.getRaw=function(){return this._raw},e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=new RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3},e}(),v=n(26),y=n(7),S={ODB:60307},D=!b.t.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!o.e.isFeatureEnabled({ECS:1026572}),I=!b.t.isActivated("29b79ab1-ae17-42fd-b4e1-39e58a904f55","04/02/2023","enable IB discovery"),x=function(e){function t(t,n){var a=this,i=C(t)?t:n.pageContext,r=null==n?void 0:n.noRedirect,o=null==n?void 0:n.tokenProvider;a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i,noRedirect:r,tokenProvider:o})||this;var s=C(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=s||new f.e({},{itemUrlHelper:new p.e({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return Object(a.a)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return l.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=Object(r.t)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===d.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return l.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return l.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:r,parseResponse:function(e){var a=JSON.parse(e),r=JSON.parse(a.d.ClientPeoplePickerResolveUser),o=[];o[0]=r,r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||o&&!o[0].DisplayText&&(o[0].DisplayText=r.Key);var s=(o=n._transformData(o,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&s.entityType===i.e.externalUser?(s.isResolved=!1,s.entityType=i.e.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=i.e.externalUser),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=i.e.group,s.principalType=d.e.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return I&&t.enforceIBSegmentFiltering?this.sharePointSearch(e,t):this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),l.t.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:r,authToken:a,parseResponse:function(a){var r=t.allowSharePointGroups,o=void 0===r||r,s=t.filterExternalUsers,c=JSON.parse(a),l=JSON.parse(c.d.ClientPeoplePickerSearchUser),u=n._transformData(l,s);return s&&(u=u.filter(function(e){return e.entityType!==i.e.externalUser})),u=u.filter(function(e){return e.principalType===d.e.sharePointGroup?o:e.principalType===d.e.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(u,e,t,i.t.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){var o;if(!r)return a.sharePointSearch(e,n);var s=D&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(o=a._pageContext)||void 0===o?void 0:o.msGraphEndpointUrl:"https://graph.microsoft.com",c=new v.e("".concat(s,"/v1.0/me/people"));if(e)if(c.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),b.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&c.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var l=t._getPersonTypeFilter(n);l&&c.setQueryParameter("$filter",l)}var u=new y.e({name:"PeoplePickerGraphSearch"});return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:c.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),t&&t.value&&0!==t.value.length)u.end({resultType:y.t.Success});else if(u.end({resultType:y.t.Failure,extraData:{error:"graph search return empty results"}}),e)return a.sharePointSearch(e,n);var r=t.value,o=[];return r.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",s=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r,c={Key:s,IsResolved:!1},l="ImplicitContact"===e.personType.subclass,u="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,p="PublicDistributionList"===e.personType.subclass,_=Object(m.e)(a._webAbsoluteUrl,r);p&&(t=i.n.PublicDistributionList),f&&(t=i.n.unified);var h={department:e.department,email:r,image:l?void 0:_,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:u?"Provider":void 0,userId:s,rawData:c,rawPersonData:c,isExternal:!u,aadObjectId:e.id,fromDataSource:i.t.graph,detailedGroupInfo:t};u?(h.entityType=i.e.regularUser,h.principalType=d.e.user,h.isResolved=!0):f?(h.entityType=i.e.group,h.principalType=d.e.securityGroup,h.isResolved=!1,h.userId=e.id):(h.principalType=p?d.e.distributionList:d.e.none,h.entityType="Group"===e.personType.class?i.e.group:i.e.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&o.push(h)}}),a._handleZeroSearchResult(o,e,n,i.t.graph)},function(t){if(u.end({resultType:y.t.Failure,extraData:{error:t}}),Object(h.i)(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(a){if(!a)return n.sharePointSearch(e,t);var r=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(r=t.siteIBSegmentIDs);var c=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],l={Authorization:"Bearer "+a},f="";if(o.e.isFeatureEnabled(S)){var p=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"],_=s.e.isValidGuid(e),g={Or:p.map(function(e){return{Term:{PeopleSubtype:e}}})},v=r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,D=_?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,I=r||_?_?r?{And:[g,v,D]}:{And:[g,D]}:{And:[g,v]}:g;f=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:_?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:I}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}else f=o.e.isFeatureEnabled(S)&&!b.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});var x=new y.e({name:"PeoplePickerSubstrateSearch"});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.e+"/api/v1/suggestions",headers:l,needsAuthorization:!1,requestType:"POST",postData:f}).then(function(a){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=a.Groups[0]?a.Groups[0].Suggestions:[];if(0===r.length){if(x.end({resultType:y.t.Failure,extraData:{error:"substrate search return empty results"}}),e)return n.sharePointSearch(e,t)}else x.end({resultType:y.t.Success});var o=[];return r.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var a=e.EmailAddresses[0]||e.QueryText||"",r=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:a;t.useNew3Ssearch&&!r&&e.Id&&e.Id.indexOf("@")&&(r=e.Id.substring(0,e.Id.indexOf("@")));var s,c={Key:r,IsResolved:!1},l="ImplicitContact"===e.PeopleSubtype,u="OrganizationUser"===e.PeopleSubtype,f="LinkedIn"===e.PeopleSubtype,p="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,_="PublicDistributionList"===e.PeopleSubtype,h=Object(m.e)(n._webAbsoluteUrl,a);_&&(s=i.n.PublicDistributionList),p&&(s=i.n.unified);var b={department:e.Department,office:e.OfficeLocation,email:a,image:l?void 0:h,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||a,name:e.DisplayName,providerName:"Provider",userId:r,rawData:c,rawPersonData:c,isExternal:!u,detailedGroupInfo:s};u?(b.entityType=i.e.regularUser,b.principalType=d.e.user,b.isResolved=!0):p?(b.entityType=i.e.group,b.principalType=d.e.securityGroup,b.isResolved=!1,b.providerName=void 0):f?b.entityType=i.e.linkedinUser:(b.principalType=_?d.e.distributionList:d.e.none,b.entityType="Group"===e.PeopleType?i.e.group:i.e.externalUser,b.isResolved=!1,b.providerName=void 0),b.userId&&o.push(b)}}),n._handleZeroSearchResult(o,e,t,i.t.substrate)},function(a){if(x.end({resultType:y.t.Failure,extraData:{error:a}}),Object(h.i)(a))switch(a.status){case 400:case 401:case 403:case 404:return n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t));return null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var r={Key:t,IsResolved:!1};e.push({email:t,entityType:i.e.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:r,rawPersonData:r,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&g.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){var t="";return e.principalType&d.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&d.e.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&d.e.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!b.t.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,r={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};r.multipleMatches.length>0&&(r.multipleMatches=n._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return e.entityType!==i.e.externalUser})));var o=r.email;r.isResolved&&(r.image=o?Object(m.e)(n._webAbsoluteUrl,o):null);var s=a.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=i.e.externalUser,r.principalType=d.e.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!b.t.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==s){r.entityType=i.e.group,r.principalType="SharePointGroup"===s?d.e.sharePointGroup:d.e.securityGroup,r.detailedGroupInfo="SharePointGroup"===s?i.n.SPGroup:i.n.securityGroup;break}default:r.entityType=i.e.regularUser,r.principalType=d.e.user}return r})},t}(c.t);function C(e){return!!e.webAbsoluteUrl}},function(e,t,n){"use strict";n.d(t,"t",function(){return p}),n.d(t,"e",function(){return m});var a,i,r,o,s,c,d,l=n(67),u=(n(85),n(113)),f=function(){function e(e){if(this._features=new Map,!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}return e.prototype._serialize=function(){var e={};return this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}}),e},e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)},e}();function p(e,t,n){var a=0;return new l.t(function(i,r){var o=setInterval(function(){if(!(a*t<=n))throw clearInterval(o),"Timed out waiting for checker "+e;a++,e()&&(clearInterval(o),i())},t)})}function m(e){if(e.featureInfo){var t=new f(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===u.t.sitePagePublishing}n(192),n(21),function(e){e[e.HEADER=0]="HEADER",e[e.NAV=1]="NAV",e[e.FOOTER=2]="FOOTER",e[e.SEARCHBOX=3]="SEARCHBOX"}(a||(a={})),function(e){e[e.LEFT=0]="LEFT",e[e.HORIZONTAL=1]="HORIZONTAL"}(i||(i={})),function(e){e[e.FULLBLEED=0]="FULLBLEED",e[e.WITHLEFTNAV=1]="WITHLEFTNAV"}(r||(r={})),function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(o||(o={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(s||(s={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.EXTENDED=1]="EXTENDED",e[e.STACKED=2]="STACKED"}(c||(c={})),function(e){e[e.Strong=0]="Strong",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.None=3]="None"}(d||(d={})),n(48)},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(67),i=n(54),r=n(45),o=n(27),s="Data",c="CacheToken",d="CacheVersion",l=function(){function e(){}return e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove(s),t.remove(c),t.remove(d)},e.getCachedTheme=function(t){var n,a=e.getThemeDataStore();try{t===a.getValue(c)&&"1.7"===a.getValue(d)&&(n=a.getValue(s))}catch(e){}return n},e.updateThemeCache=function(t,n){var a=e.getThemeDataStore();a.setValue(s,t),a.setValue(c,n||t.cacheToken),a.setValue(d,"1.7")},e.getThemeDataStore=function(){return new r.e("odTheme",o.e.local)},e}(),u=n(7),f=function(){function e(e){this._loadData=e}return e.getBackgroundUrl=function(t){return t?e._makeCssUrl(t.backgroundImageUri):"none"},e._makeCssUrl=function(t){var n="none";return t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")'),n},e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;return null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]})),n},e.prototype.loadThemeTokenMap=function(t,n){return this.loadThemeData(t,n).then(function(t){var n;if(t&&t.palette){n={};var a=t.palette;for(var r in a){var o=a[r];n[r]=o?i.e.toHtmlString(o):null}n.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return n},function(e){return null})},e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,i=null,r=u.t.Failure;return this._dataPromise=u.e.instrumentPromise({name:"ThemeProvider.LoadData"},function(){return new a.t(function(o,s){var c=null;t||(c=l.getCachedTheme(e)),c?o(c):n._loadData(t).done(function(t){t?(t.cacheToken&&l.updateThemeCache(t,e),o(t)):(i="NoData",s&&s("No model returned"))},function(e){a.t.isCanceled(e)?(i="Canceled",r=u.t.ExpectedFailure):i="ServerLoadFailure",s&&s(e)})})},null,function(e){a.t.isCanceled(e)&&(r=u.t.ExpectedFailure,i="Canceled");var t=e;if(e){var n={name:e.name||void 0,message:e.message&&e.message.value||e.message||void 0,correlationId:e.correlationId||void 0};t=JSON.stringify(n)}return{resultType:r,resultCode:i||"Other",error:t}}),this._dataPromise},e}(),p=n(113),m=n(172),_=function(){function e(e){this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo,this._getThemeDataSource=e.getThemeDataSource,this._themeProvider=new f(this._loadTheme.bind(this))}return e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):a.t.resolve()},e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},a=e.palette;for(var r in a){var o=a[r];o&&(n[r]=i.e.toHtmlString(o))}e.backgroundImageUri&&(n.backgroundImageUri=f.getBackgroundUrl(e));var s={palette:n,isInverted:e.isInverted};return Object(m.e)(s,t._pageContext)}})},e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeData(t,e):a.t.resolve(void 0)},e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),a=n===p.e.teamSite||n===p.e.group?t.groupColor:void 0,i=a?a+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||null}return e},e.prototype._loadTheme=function(e){return this._getThemeCacheToken()?(this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(function(t){return t?t.loadTheme(e):a.t.resolve()})):a.t.resolve()},e}()},,function(e,t,n){"use strict";n(249);var a,i=n(69),r=n(8),o=Object(i.e)({eventName:"PageInit,",shortEventName:"PageInit"},{screenWidth:r.e.Number,screenHeight:r.e.Number,availableScreenWidth:r.e.Number,availableScreenHeight:r.e.Number,renderWidth:r.e.Number,renderHeight:r.e.Number,browserWidth:r.e.Number,browserHeight:r.e.Number,devicePixelRatio:r.e.Number,referrer:r.e.String}),s=function(){function e(){}return e.init=function(){return a||(a=o.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0})),a},e}();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a={};n.r(a),n.d(a,"fileNotFound",function(){return o}),n.d(a,"invalidView",function(){return s}),n.d(a,"listNotFound",function(){return c}),n.d(a,"docAlreadyExists",function(){return d}),n.d(a,"queryThrottled",function(){return l}),n.d(a,"newExperieceRenderingNotSupported",function(){return u}),n.d(a,"onePageNavigationViewMismatch",function(){return f}),n.d(a,"onePageNavigationError",function(){return p}),n.d(a,"offline",function(){return m});var i,r,o=-2147024894,s=-2147024809,c=-1,d=-2130575257,l=-2147024860,u=-2,f=-3,p=-4,m=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={}));var _,h={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(_||(_={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("react-lib"),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerErrorContainer{display:flex;padding:8px 32px 8px 12px}.od-Share-PeoplePickerErrorContainer .od-Share-PeoplePickerErrorDiv{padding:0 8px;font-size:.75rem;color:#323130}.od-Simplified-Share-PeoplePickerErrorContainer{display:flex;flex-direction:row;align-items:center}.od-Simplified-Share-PeoplePickerErrorIcon{padding-right:5px;font-size:.625rem}.od-Simplified-Share-PeoplePickerErrorText{font-size:.75rem}.od-Simplified-Share-primary{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Simplified-Share-warning{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-Simplified-Share-error{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}"}]);var r=n(393),o=n(30);function s(e){return 1===o.i()?a.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-".concat(e.textColorType)},a.createElement("div",null,a.createElement(r.e,{className:e.className,iconName:e.iconName})),a.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-".concat(e.textColorType)},e.error)):a.createElement("div",{className:"od-Share-PeoplePickerErrorContainer",style:{backgroundColor:e.backgroundColor}},a.createElement(r.e,{iconName:e.iconName,className:e.className}),a.createElement("div",{className:"od-Share-PeoplePickerErrorDiv"},e.error))}},,,function(e,t,n){"use strict";n.r(t),n.d(t,"GraftOperationType",function(){return a}),n.d(t,"remove",function(){return r}),n.d(t,"optional",function(){return o}),n.d(t,"backup",function(){return s}),n.d(t,"replace",function(){return c}),n.d(t,"default",function(){return d});var a,i=n(0);function r(){return{graftOperationType:a.remove}}function o(e){return{graftOperationType:a.optional,value:e}}function s(e){return{graftOperationType:a.backup,value:e}}function c(e){return{graftOperationType:a.replace,value:e}}function d(e,t){if(!l(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!l(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],s=t[o],c=e[o];if(s!==c){var _=s;if(p(_))if(_.graftOperationType===a.replace)c=void 0,s=h=_.value;else if(_.graftOperationType===a.backup){var h=_.value;if(void 0!==e[o])continue;s=h}else{if(_.graftOperationType!==a.optional){if(m(_)){delete e[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(h=_.value))continue;s=h}var b=void 0;if(u(s))b=new Date(s.getTime());else if(f(s)){var g=c;f(g)||(g=[]),g.splice.apply(g,Object(i.o)([0,g.length],s,!1)),b=g}else if(l(s)){var v=c;l(v)||(v={}),d(v,s),b=v}else b=s;e[o]=b}}return e}function l(e){return"object"==typeof e&&!!e}function u(e){return e instanceof Date}function f(e){return Array.isArray(e)}function p(e){return l(e)&&!!e.graftOperationType}function m(e){return e.graftOperationType===a.remove}!function(e){e[e.none=0]="none",e[e.replace=1]="replace",e[e.optional=2]="optional",e[e.remove=3]="remove",e[e.backup=4]="backup"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u});var a=n(0),i=n(49),r=n(148),o="Canceled",s=function(e){function t(t){void 0===t&&(t={message:o});var n=e.call(this,Object(a.e)({code:t.code||o,isExpected:!0},t))||this;return n.name=o,n}return Object(a.a)(t,e),t}(i.e);function c(e){if(e instanceof s)return!0;if(e&&"object"==typeof e){if(e.code===o)return!0;if(e.name===o)return!0}return!1}var d=function(e){var t,n=e.catch(function(e){return t=e,Promise.reject(e)});this.subscribe=function(e){var t=e;return n.then(function(){t=void 0},function(e){if(t){var n=t;t=void 0,n(e)}}),function(){t=void 0}},this.isCanceled=function(){return!!t},this.throwIfCanceled=function(){if(t)throw new s(t)}},l=function(){var e=new r.e,t=e.reject,n=e.resolve,a=e.promise;this.cancel=function(e){return t(e||new s)},this.dispose=function(){return n()},this.token=new d(a)};function u(e,t){return Object(a.t)(this,void 0,void 0,function(){var n,i,o=this;return Object(a.i)(this,function(s){switch(s.label){case 0:return t?[3,2]:[4,e];case 1:case 3:return[2,s.sent()];case 2:return n=new r.e,i=t.subscribe(function(e){n.reject(e)}),Object(a.t)(o,void 0,void 0,function(){var t,r,o;return Object(a.i)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,3,4]),r=(t=n).resolve,[4,e];case 1:return r.apply(t,[a.sent()]),[3,4];case 2:return o=a.sent(),n.reject(o),[3,4];case 3:return i(),[7];case 4:return[2]}})}),[4,n.promise]}})})}},,function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"e",function(){return d});var a=n(193),i=n(29),r=n(3);function o(e){var t=e.lastIndexOf("/");return t>=0?e.substring(t+1):e}function s(e){return decodeURI(e)}function c(e){var t;try{t=decodeURI(e)}catch(n){t=e}return t===e?e=Object(a.e)(e,!0):(e=e.replace("#","%23"),r.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(a.e)(e,!0))),e}function d(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}},,function(e,t,n){"use strict";var a=n(66),i=n(29);a.e.addFeatureEnabler(function(e){return i.e.isFeatureEnabled(e)})},,function(e,t,n){"use strict";var a=n(65),i=n(122),r={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},o={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},s=function(){function e(e,t){this._scope=new i.e,this._events=new(this._scope.attached(a.t))(this),this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n},this._windowWidth=0,this._windowHeight=0,this._onContainerResize()}return e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},e.determineWindowSize=function(e,t){if(void 0===t&&(t=o),0===e)return"Medium";for(var n in o)if(e<t[n])return n},e.determineCssClass=function(e){return r[e]},e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden",n.width="100px",n.msOverflowStyle="scrollbar",n.overflow="scroll",t.style.width="100%",document.body.appendChild(e),e.appendChild(t);var a=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var r=a-i;return this.getScrollbarWidth=function(){return r},r},Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._scope.dispose()},e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},e.prototype._afterContainerResize=function(){},e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,a=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,r=this._formFactorSize=e.determineWindowSize(a,this._breakpoints());this._cssClass=e.determineCssClass(r);var s=this._isHamburgerVisible;this._isHamburgerVisible=a<o.Large;var c=this._showLabels;this._showLabels=this.compareSize(r,"Medium")>0,i&&r!==i&&this._events.raise("formFactorChange"),"boolean"==typeof s&&s!==this._isHamburgerVisible&&this._events.raise("hamburgerVisibilityChange"),"boolean"==typeof c&&c!==this._showLabels&&this._events.raise("showCommandLabelsChange"),this._afterContainerResize()},e.DEFAULT_BREAKPOINTS=o,e.MAC_SCROLL_BAR_WIDTH=8,e}();t.e=s},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=!n(3).t.isActivated("6d2a844a-9c33-46b3-80c2-9e47560a97b7","4/26/2022")},function(e,t,n){"use strict";t.e={Active:0,Restricted:1,RestrictedICN:2,ConditionalAccessBlocked:3,ConditionalAccessViewOnly:4}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u});var a,i=n(0),r=(n(249),n(304),n(305),n(306),n(301),n(239)),o=n(131),s=n(48),c=n(60);function d(e){var t=window.PageContext,n=t.env||"devbox",a=window.Flight,i=e.oAuthToken&&function(e){if(e){var t=e.split(".");if(3===t.length)try{return JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}}(e.oAuthToken),r=i&&i.puid||a.session,o=i&&i.puid||t.userName,d=i&&i.tid||t.siteSubscriptionId;return{isAuthenticated:!!o,market:t.mkt,session:s.e.generate(),collectorUrl:t.ariaCollectorUrl,version:a.version,manifest:a.manifest||a.name,userId:r,accountType:o?c.e.Business:c.e.BusinessAnonymous,siteSubscriptionId:d,farmLabel:t.farmLabel,environment:n,workload:e.workload,disableCookies:!t.userName,context:e.context,cloudType:t.cloudType}}function l(e,t){void 0===t&&(t={}),function(e){var t="",n=window.PageContext.env||"devbox",i=window.Flight;if(i)if(i.ramps&&!i.Ramps&&(i.Ramps=i.ramps),i.usingRedirectCookie)t=e.tokens.ppe;else switch(n.toLowerCase()){case"edog":case"dogfood":case"prodbubble":t=e.tokens.ppe;break;case"prod":case"dprod":t=e.tokens.prod}else t=e.tokens.prod;a=d(e),t&&o.e.Init(t,a)}({oAuthToken:e,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"},context:t.context})}function u(e,t){void 0===t&&(t={}),function(e){if(a){var t=d(e);o.e.UpdateContext(Object(i.e)(Object(i.e)(Object(i.e)({},a),t),{context:Object(i.e)(Object(i.e)({},a.context),e.context)}))}}({oAuthToken:e,workload:"ODB",tokens:{ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"},context:t.context})}r.e.init()},function(e,t,n){"use strict";n.d(t,"e",function(){return T});var a,i=n(0),r=n(463),o=n(108),s=n(110),c=n(149),d=n(461);!function(e){e[e.unknown=0]="unknown",e[e.prefetch=1]="prefetch",e[e.hostapp=2]="hostapp",e[e.api=3]="api"}(a||(a={}));var l=n(460),u=n(176),f=n(462),p=n(6),m=n(177),_=n(56),h=n(370),b=n(464),g=n(205),v=n(85),y=n(107),S=n(201),D=n(240),I=n(113),x=n(130),C=n(3),O=n(236),w=n(105),E=n(70),A=n(29),L=n(231),k=!C.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),M=C.t.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link"),P=C.t.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||A.e.isFeatureEnabled({ECS:1059927}),T=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new o.e({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new s.e({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new S.e({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(v.e)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return Object(i.a)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return d.e.None;default:return d.e.View;case 2:return d.e.Edit;case 6:return d.e.Review}},t.prototype.getSharingInformation=function(e,t,n,i,r,o){var s,c=this,d=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";return t&&(l+=",permissionsInformation"),n&&(l+=",sharingLinkTemplates"),r&&(l+=",addressBarLinkSettings"),s=d.oDataParameter("$Expand",l).toString(),this.getData(function(){return s},function(t){var n=JSON.parse(t),i=c._parseGetSharingInformationResponse(n,e);return i.getSharingInformationSources=a.api,i},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&N(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),o)},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this,o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return o},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,o=e;n<o.length;n++){var s=o[n];t.push(s.rawPersonData)}var c={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i,linkParameters:{}};return r._sharingContextInformation&&r._sharingContextInformation.navId&&r._sharingContextInformation.optInSendNavIdInShareLink&&!M&&(c.linkParameters.nav=r._sharingContextInformation.navId),JSON.stringify(c)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a,i=this,r=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===l.e.Organization||n.linkType===l.e.Edit||n.linkType===l.e.View)return this._shareLink(e,n);if(r){var o=n.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));a=s.segment("ShareObject").toString()}else a=this._shareUrl;return this.getData(function(){return a},function(e){var a=JSON.parse(e).d,i=[];Object(E.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],a=0;a<e.length;a++){var o=e[a];t.push(o.rawPersonData)}n.roleValue===d.e.Edit.toString()?n.roleValue=w.e:n.roleValue===d.e.View.toString()&&(n.roleValue=w.a);var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return r||(s.url=i._sharingDataSourceHelper.getFileUrl(n.items[0])),Object(E.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(s)),JSON.stringify(s)})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case u.e.none:case u.e.view:case u.e.review:case u.e.edit:case u.e.owner:t=n;break;default:t=u.e.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case u.e.none:t=0;break;case u.e.view:t=1;break;case u.e.review:t=6;break;case u.e.edit:t=2;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=this,n=e.settings,a=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(a)).segment("ShareLink").toString(),o={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&N(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(o.Prefer="DirectUrlWithShareToken")),this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?(Object(E.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),function(e){if(e.d)return U(e.d.ShareLink.sharingLinkInfo)}(t)):t.error?{error:f.t.generic,errorMessage:t.error.message}:void 0},"ShareLink",function(){var a=null;n.expiration&&(a=Object(r.e)(n.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var o=0,s=e.recipients;o<s.length;o++){var c=s[o];c.rawPersonData&&i.push(c.rawPersonData)}}var d=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){d=[];for(var l=0,u=n.inviteesToRemove;l<u.length;l++){var f=u[l];d.push({id:f.id,loginName:f.loginName,name:f.primaryText,isExternal:f.isExternal,principalType:f.type,email:f.email})}}var p={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:a,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope}}};if(t._sharingContextInformation&&t._sharingContextInformation.navId&&t._sharingContextInformation.optInSendNavIdInShareLink&&(p.request.settings.nav=t._sharingContextInformation.navId),d&&(p.request.settings.inviteesToRemove={results:d}),i&&i.length>0){p.request.peoplePickerInput=JSON.stringify(i);var m=e.emailData,_=e.emailSubject;void 0!==m&&void 0===_&&(p.request.emailData={body:e.emailData,subject:""}),void 0===m&&void 0!==_&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==m&&void 0!==_&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var h=e.settings.shareId;h&&(p.request.settings.shareId=h,p.request.emailData={body:""});var b=JSON.stringify(p);return Object(E.e)()&&window.sessionStorage.setItem("ShareLink_Payload",b),b},"POST",0!==Object.keys(o).length?o:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:f.t.generic,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?U(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:f.t.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:f.t.generic,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(O.e)(this._pageContext))return p.e.sharePoint;switch(e){case I.t.teamSite:case I.t.group:case I.t.subgroup:case I.t.sitePagePublishing:return p.e.sharePoint;case I.t.mySite:return p.e.odb;default:return p.e.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var a=[],i=0,o=e;i<o.length;i++){var s=o[i];a.push(s.rawPersonData)}var c=null;t.expiration&&(c=Object(r.e)(t.expiration));var d={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:c}};return JSON.stringify(d)})},t.prototype._getSharingLinkKind=function(e,t){var n=m.e.direct;return e===l.e.Edit?n=m.e.anonymousEdit:e===l.e.View?n=m.e.anonymousView:e===l.e.Organization&&(n=t===d.e.Edit.toString()?m.e.organizationEdit:m.e.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:f.t.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};var n=e.d,a=n.userPhotoCdnBaseUrl,r=n.permissionsInformation,o=!!r,s=!!n.sharingLinkTemplates,c=o,d=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(r.links.results,n.directUrl,a):[],u=s?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,a):[],p=d?n.addressBarLinkSettings:null,b=[];if(o){var g=r.siteAdmins.results,v=r.principals.results,S=this._parseSharingPrincipals(g,void 0,a);S.forEach(function(e){return e.isSiteAdmin=!0});var I=this._parseSharingPrincipals(v,void 0,a);b=S.concat(I)}var x=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),C=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;P||C||!n||(C=n.displayName);var O={name:C,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var w=t.properties,A=w.ItemChildCount?parseInt(w.ItemChildCount,10):0,k=w.FolderChildCount?parseInt(w.FolderChildCount,10):0,M=t.type===y.e.OneNote?0:A+k,T=this._isPolicyTipFlagSet(t.policyTip,D.e.blockSharing),U=t.name;P||U||!n.displayName||(U=n.displayName),O={name:U,childCount:M,hasDlpPolicy:T,extension:t.extension,appmap:t.appMap,itemType:t.type}}var F=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,H={anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:F,defaultSharingLink:x,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!c&&n.permissionsInformation.hasInheritedLinks,isShared:Object(L.e)(l,b),item:O,sharingLinks:l,sharingPrincipals:b,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:_.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.e.direct,sharingScope:h.e.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:u,addressBarLinkSettings:p,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation,displayName:n.displayName};if(Object(E.e)()){var R=window.sessionStorage.getItem("Get_Sharing_Information");if(R&&Object.keys(R).length>0){var N=JSON.parse(R);return Object(i.e)(Object(i.e)({},H),N)}}return H},t.prototype._parseSharingLinks=function(e,t,n){var a=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;return t=void 0!==i.Scope&&i.Scope!==h.e.uninitialized?H(i.LinkKind,i.Scope):F(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership),{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:R(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:a._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:a._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:a._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});return(i=i.sort(function(e,t){return a._getLinkRanking(t)-a._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:_.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.e.direct,sharingScope:h.e.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),i},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case _.e.anyone:t+=30;break;case _.e.organization:t+=20;break;case _.e.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case b.e.anyone:t+=30;break;case b.e.organization:t+=20;break;case b.e.specificPeople:t+=10}switch(e.role){case u.e.edit:t+=3;break;case u.e.review:t+=2;break;case u.e.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&r.Scope!==h.e.uninitialized?H(r.LinkKind,r.Scope):F(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:R(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(x.e)(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:Object(x.e)(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return S.e.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:g.e[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(x.e)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===m.e.direct&&(e=m.e.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==m.e.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=m.e.anonymousView),i!==m.e.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=m.e.organizationEdit),r!==h.e.anyone||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=h.e.organization)):(i!==m.e.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=m.e.anonymousView),i!==m.e.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=m.e.organizationEdit),r!==h.e.anyone||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=h.e.organization)),a.organizationLinkAbilities&&(i!==m.e.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=m.e.organizationView),i!==m.e.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=m.e.direct),r!==h.e.organization||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=h.e.specificPeople)),a.peopleSharingLinkAbilities&&(r!==h.e.specificPeople||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=h.e.existing));var o=void 0;return e===m.e.anonymousEdit||e===m.e.anonymousView?o=_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?o=_.e.organization:e===m.e.direct?o=_.e.specificPeople:e===m.e.flexible&&(o=_.e.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(c.t);function U(e){var t;t=void 0!==e.Scope&&e.Scope!==h.e.uninitialized?H(e.LinkKind,e.Scope):F(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:R(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function F(e,t,n){return e===m.e.anonymousEdit||e===m.e.anonymousView?_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?_.e.organization:e===m.e.direct?_.e.specificPeople:e===m.e.flexible?t?_.e.anyone:!1===n?_.e.organization:_.e.specificPeopleFlex:void 0}function H(e,t){return e===m.e.anonymousEdit||e===m.e.anonymousView?_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?_.e.organization:e===m.e.direct?_.e.specificPeople:e===m.e.flexible?t==h.e.anyone?_.e.anyone:t===h.e.organization?_.e.organization:_.e.specificPeopleFlex:void 0}function R(e){return e===m.e.anonymousEdit||e===m.e.organizationEdit||e!==m.e.anonymousView&&e!==m.e.organizationView&&null}function N(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}},,,function(e,t,n){"use strict";var a;n.d(t,"t",function(){return f}),n.d(t,"e",function(){return p});var i="ms-word",r="onenote|UsePlain",o="ms-powerpoint",s="ms-excel",c="ms-visio",d="ms-publisher",l="ms-access",u="ms-project",f=i,p={accdb:l,csv:s,doc:i,docm:i,docx:i,dot:i,dotm:i,dotx:i,odp:o,ods:s,odt:i,one:r,onepkg:r,onetoc2:r,mpp:u,notebook:r,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:d,vdw:c,vsd:c,vsdm:c,vsdx:c,vsl:c,vss:c,vssm:c,vssx:c,vst:c,vstm:c,vstx:c,xla:s,xlam:s,xll:s,xls:s,xlsb:s,xlsm:s,xlsx:s,xlt:s,xltm:s,xltx:s};(a={})[l]="Access",a[i]="Word",a[r]="OneNote",a[o]="PowerPoint",a[s]="Excel",a[c]="Visio",a[d]="Publisher",a[u]="Project"},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0);function i(e,t){return Object(a.e)(e,t)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("react-lib"),i=n(13);function r(){return a.createElement("div",{className:"separator"})}Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.separator{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}"}])},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a,i=n(145),r=((a={})[i.e.anyone]="Globe",a[i.e.onlyYou]="Lock",a[i.e.specificPeople]="PeopleAdd",a[i.e.workGroup]="Work",a[i.e.existing]="SecurityGroup",a[i.e.chat]="Chat",a[i.e.mail]="Mail",a)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return B});var a={};n.r(a),n.d(a,"localStorage",function(){return s}),n.d(a,"indexedDB",function(){return c}),n.d(a,"none",function(){return d});var i,r=n(0),o=n(67),s=0,c=1,d=2,l=a,u=n(159),f=n(61),p="undefined"==typeof window?self:window,m=n(7);!function(e){e.success="success",e.error="error"}(i||(i={}));var _="app",h="app_lastRead",b="ODSP_DB",g="ODSP_DB_TABLE",v="lastModified",y="lastRead",S="ODSP_DB_METADATA_TABLE",D="database_metadata",I="parentKey",x="reads",C=(new u.e).isFirefox,O="indexedDB is not supported",w=function(){function e(t){if(!("indexedDB"in p)||!p.indexedDB)throw new Error(O);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.i)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=a.transaction([g],"readwrite").objectStore(g).index(h).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(t){return[2,this._readInternal(g,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,h=this;return Object(r.i)(this,function(r){switch(r.label){case 0:return n={},i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=a.transaction([g],"readonly"),c=s.objectStore(g),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){h._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(r.t)(this,void 0,void 0,function(){var t;return Object(r.i)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:g,key:t,row:Object(r.e)(Object(r.e)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:g,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(r.t)(this,void 0,void 0,function(){var e,t;return Object(r.i)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(g,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=C?indexedDB.open(b,{version:4,storage:"temporary"}):indexedDB.open(b,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(g,{keyPath:"key"})).createIndex(v,v,{unique:!1}),a.createIndex(x,x,{unique:!1}),t.createObjectStore(S,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(g)).createIndex(_,_,{unique:!1}),a.createIndex(y,y,{unique:!1}),a.createIndex(h,[_,y],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(g)).createIndex("app_lastModified",[_,v],{unique:!1}),a.createIndex("app_reads",[_,x],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(g)).createIndex(I,I,{unique:!1}),a.createIndex("parentKey_app",[I,_],{unique:!1}),a.createIndex("parentKey_app_lastModified",[I,_,v],{unique:!1}),a.createIndex("parentKey_app_lastRead",[I,_,y],{unique:!1}),a.createIndex("parentKey_app_reads",[I,_,x],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(S,function(e){return e.get(D)}).then(function(t){if(t)return t.data;var n={id:f.generate(),created:Date.now(),cacheType:l.indexedDB};return e._writeInternal({tableName:S,key:D,row:{key:D,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.i)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:m.t.Success,extraData:{io:Math.round(Date.now()-o)}}),e(d.result)},d.onerror=function(e){r({resultType:m.t.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s,c=this;return Object(r.i)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return Object(r.i)(this,function(r){switch(r.label){case 0:return n=t.tableName,a=t.key,i=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([n],"readwrite"),s=r.objectStore(n);r.oncomplete=function(){},r.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(r.t)(this,void 0,void 0,function(){var t,n=this;return Object(r.i)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:I,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:g,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),E="PersistentCache",A="PersistentCache_metadata",L=function(){function e(){try{if("localStorage"in p&&p.localStorage&&(this._localStorage=p.localStorage,!this._localStorage.getItem(A))){var e={id:f.generate(),created:Date.now(),cacheType:l.localStorage};this._localStorage.setItem(A,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(r.e)(Object(r.e)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(E)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(A)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(E,"_").concat(e)},e}(),k=0,M=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return Object(r.t)(n,void 0,void 0,function(){var e;return Object(r.i)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:k++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=p.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function P(){return p.performance&&performance.now?Math.round(performance.now()):Date.now()}var T=n(28),U="_odspcache_",F="_____",H={cacheType:l.indexedDB},R=function(){function e(e){var t=e.cacheType,n=void 0===t?H.cacheType:t,a=Object(r.r)(e,["cacheType"]);if(this._config=Object(r.e)(Object(r.e)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new M,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D;return Object(r.i)(this,function(r){switch(r.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=P(),c=Date.now(),r.label=1;case 1:return r.trys.push([1,12,,13]),l=this._getCacheKey(t),u=!1,f={lastModified:NaN,lastRead:c,reads:1},p=void 0,l?(m=P(),[4,this._storage.read(l)]):[3,11];case 2:return d=r.sent(),o=Math.round(P()-m),d?(_=d.data,f={lastModified:d.lastModified,lastRead:c,reads:d.reads+1},(a=e._buffer[l])&&a.cacheStats.lastModified===d.lastModified?(a.app=d.app||this._app,a.key={original:t,encoded:d.key||l},a.cacheStats.lastRead=c,a.cacheStats.reads++,a.performance={total:Math.round(P()-s)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===_)return[3,11];if(!this._dataIsEncrypted)return[3,10];h=_,b=this._cacheSecret,g=b.CurrentKey.Key,v=b.PreviousKey.Key,y=P(),r.label=4;case 4:return r.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:g})];case 5:return p=r.sent(),[3,9];case 6:return(S=r.sent())&&S.message&&S.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:v})]:[3,8];case 7:p=r.sent(),u=void 0!==p,n({resultType:T.e.ExpectedFailure,error:S.message,extraData:{cacheResult:"hit"}}),r.label=8;case 8:return[3,9];case 9:return i=Math.round(P()-y),[3,11];case 10:p=_,r.label=11;case 11:return a=a||{key:{original:t,encoded:d&&d.key||l},app:d&&d.app||this._app,data:p,cacheStats:f,cacheType:this._cacheType,performance:{crypto:i,io:o,total:Math.round(P()-s)}},e._buffer[l]=a,u&&this.update(t,p),[3,13];case 12:throw D=r.sent(),n({resultType:T.e.Failure,error:D.message?D.message:D.toString(),extraData:{cacheResult:"miss"}}),D;case 13:return n({resultType:T.e.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(r.t)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,d=this;return Object(r.i)(this,function(r){if(this._cacheType!==l.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=P(),i=Date.now(),s={lastModified:NaN,lastRead:i,reads:1};try{c=P(),o=this._storage.rangeQuery(e).then(function(e){return n=Math.round(P()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:d._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:d._cacheType,performance:{io:n,total:Math.round(P()-a)}}})}catch(e){throw t({resultType:T.e.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:T.e.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(P()-a)}})]})})},e.prototype.update=function(e,t){return Object(r.t)(this,void 0,void 0,function(){var n,a=this;return Object(r.i)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(r.t)(this,void 0,void 0,function(){return Object(r.i)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return Object(r.i)(this,function(r){switch(r.label){case 0:n=P(),a=Date.now(),i=this._logQos({name:"PersistentCache.readAndUpdate"}),o=t().then(function(t){var i={app:d._app,key:{original:e,encoded:d._getCacheKey(e)},data:t,cacheType:l.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(P()-n)}};return d.update(e,t),i}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!s||s.cacheType!==l.none&&void 0===s.data?[4,o]:[3,7];case 6:s=r.sent(),r.label=7;case 7:return[3,9];case 8:throw c=r.sent(),i({resultType:T.e.Failure,error:c.message?c.message:c.toString()}),c;case 9:return i({resultType:T.e.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){if(e===l.localStorage)this._storage=new L;else try{this._storage=new w(this._logQos.bind(this))}catch(e){e.message===O&&(this._storage=new L,this._cacheType=l.localStorage)}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?F+e.user:""));return"".concat(U).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(U,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(F)>=0){var i=a.split(F);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s,c,d,u;return Object(r.i)(this,function(f){switch(f.label){case 0:a=this._logQos({name:"PersistentCache.update"}),f.label=1;case 1:return f.trys.push([1,9,,10]),i=this._getCacheKey(t),void 0===n?[3,6]:((o=e._buffer[i]=Object(r.e)(Object(r.e)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:P(),reads:1}),s=n,c=NaN,this._dataIsEncrypted?(d=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:d,data:n,doSerialize:this._cacheType===l.localStorage})]):[3,3]);case 2:return s=f.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}f.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return f.sent(),[3,8];case 6:return delete e._buffer[i],[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:throw u=f.sent(),a({resultType:T.e.Failure,error:u.message?u.message:u.toString()}),u;case 10:return a({resultType:T.e.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(r.t)(this,void 0,void 0,function(){var e=this;return Object(r.i)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(r.t)(e,void 0,void 0,function(){return Object(r.i)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),N=n(101),B=function(){function e(e,t){this._getDataPromises={};var n=e.id,a=e.dataSourceName,i=e.cacheType,o=void 0===i?l.indexedDB:i,s=(t.pageContext||{}).aadUserId;this._id=n,this._userId=s;var c=a||n,d=m.e.withData(function(e){return e.name&&c&&!e.name.startsWith(c)?Object(r.e)(Object(r.e)({},e),{name:"".concat(c,".").concat(e.name)}):e});this._cache=new R({cacheType:o,telemetry:{qos:d}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?N.e.useCacheAndUpdateInTheBackground:i,s=n.cacheTimeoutTime,c=void 0===s?N.a:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f=n.cacheRequestParentKey,p={key:a,user:this._userId,parentKey:f},m=function(){var e=t._getDataPromises[a];if(!e){var n=d();t._getDataPromises[a]=n,e=n.then(function(e){return t._cache.update(p,e).catch(function(){}),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})}return e.then(function(e){return u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return r===N.e.onlyCache?o.t.resolve(this._cache.read(p)).then(function(e){var t=e||{},n=t.data,a=t.cacheStats;return null==n?null:u?{data:n,cacheStats:a}:n}).catch(function(){return null}):o.t.resolve(this._cache.read(p)).then(function(e){var n=e||{},a=n.data,i=n.cacheStats;if(null==a)return m();var o=u?{data:a,cacheStats:i}:a,s=t._isCacheExpired(i.lastModified,c);switch(r){case N.e.useCacheAndNoUpdate:return o;case N.e.useCacheAndUpdateInTheBackground:return s&&m(),o;case N.e.useCacheIfNotExpired:return s?m():o;case N.e.bypassCache:default:return m()}}).catch(function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove(n)},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n("react-lib"),i=n("prop-types-lib"),r=n(13);Object(r.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Header-width{width:100%}@media screen and (max-width:352px){.Header-width{max-width:294px}}.Header-flex-row{display:flex;flex-direction:row}.Header-flex-row i{font-size:.875rem}.Header-flex-row button:hover{outline:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:4px}.Header-flex-grow{flex-grow:1}.Header-main-text{white-space:nowrap;overflow:hidden;display:flex;flex-direction:column;align-self:center}.Header-filename{margin:0;font-size:1.25rem;font-weight:600;overflow:hidden;text-overflow:ellipsis}@media screen and (max-width:511px){.Header-filename{font-size:1rem}}.Header-filename.ie{font-size:1.25rem}.Header-odc h1{font-size:1.25rem}.Header-actions{padding-left:5px;gap:5px}.Header-actions button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.Header-backButton button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=rtl] .Header-backButton button{transform:scale(-1,1)}"}]);var o=n(32),s=n(1),c=n(59),d=n(158);function l(e,t){var n=e.mainHeaderText,i=e.actions,r=e.renderBackButton,l=e.className,u=e.isFilenameTruncated,f=e.onBackButtonClicked,p=t.platformDetection,m="Header-filename ".concat(p.isMobile?"mobile ":""," ").concat(p.isIE?"ie":"");return a.createElement("div",{className:"Header-flex-row Header-width ".concat(l)},r&&a.createElement("div",{className:"Header-flex-row Header-backButton"},a.createElement(d.e,{iconProps:{iconName:"Back"},ariaLabel:s.ne,onClick:f,tooltipContent:s.ne,automationId:"Header-backButton"})),a.createElement("div",{className:"Header-main-text Header-flex-grow"},u?Object(c.t)(a.createElement("h1",{className:m},n),n,{position:o.e.bottomLeftEdge}):a.createElement("h1",{className:m,"aria-label":n},n)),a.createElement("div",{className:"Header-flex-row Header-actions"},i))}l.contextTypes={platformDetection:i.object.isRequired}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(245);function r(e){return Object(a.t)(this,void 0,void 0,function(){var t,n,r,o,s,c,d;return Object(a.i)(this,function(a){switch(a.label){case 0:return[4,Promise.all(e.map(function(e){return e.then(function(e){return{result:e}},function(e){return{error:e}})}))];case 1:for(t=a.sent(),n=[],r=[],o=!0,s=0,c=t;s<c.length;s++)"error"in(d=c[s])?(Object(i.n)(d.error)||(o=!1),r.push(d.error)):(n.push(d.result),o=!1);if(r.length>0)throw o?new i.e:r[0];return[2,n]}})})}},,,function(e,t,n){"use strict";var a=n(184),i=n(67),r=function(){function e(){}return e.start=function(e){var t=new a.e(e);return new i.t(function(e,n){t.start(e,n)},function(){t.abort(!0)})},e.startAndPostProcess=function(e,t){var n=new a.e(e);return new i.t(function(e,a){n.start(function(n,a){e(t(n,a))},a)},function(){n.abort(!0)})},e}();t.e=r},function(e,t,n){"use strict";function a(e){return e?e.endTime-e.startTime:0}function i(e){return!(!e||!e.startTime&&0!==e.startTime||!e.endTime&&0!==e.endTime||!(e.endTime>e.startTime))}n.d(t,"e",function(){return r});var r=function(e){var t=e.controlId,n=e.startTime,r=e.endTime,o=e.ignoreForEUPL,s=e.needFlatten,c=e.renderTimeCalculator,d=void 0===c?a:c,l=e.renderTimeRequiredDataChecker,u=void 0===l?i:l;this.controlId=t,this.startTime=n,this.endTime=r,this.renderTimeCalculator=d,this.renderTimeRequiredDataChecker=u,this.ignoreForEUPL=void 0===o||o,this.needFlatten=void 0!==s&&s}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(11).t)("navigation")},,,,,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(48),r=n(3),o=n(60),s=n(26),c=n(191),d=n(159),l=function(e){function t(t){var n=t.contextProvided,i=Object(a.r)(t,["contextProvided"]),r=new d.e,o=r.osName,s=r.osVersion,c=Object(a.e)({OSName:o,OSVersion:s,UserAgent:navigator.userAgent},n);return e.call(this,Object(a.e)({context:c,logStartEvents:!0},i))||this}return Object(a.a)(t,e),t}(function(e){function t(t){var n,i=t.context,r=void 0===i?{}:i,o=(void 0===n&&(n=new d.e),{BrowserIsMobile:n.isMobile,BrowserIsPWA:n.isPWA,BrowserMajVer:n.browserMajor,BrowserMinVer:n.browserMinor,BrowserName:n.browserName,BrowserUserAgent:n.userAgent,OSName:n.osName,OSVersion:n.osVersion});return e.call(this,Object(a.e)(Object(a.e)({language:window.navigator.language},t),{context:Object(a.e)(Object(a.e)({},o),r)}))||this}return Object(a.a)(t,e),t}(c.e));function u(e){var t,n=e.pageContext,c=e.customerContext,d=Object(a.r)(e,["pageContext","customerContext"]),u=n.CorrelationId,f=n.systemUserKey,p=n.userLoginName,m=n.farmName,_=n.farmLabel,h=n.siteSubscriptionId,b=n.SideBySideToken,g=n.ariaCollectorUrl,v=n.isAnonymousGuestUser;if(r.t.isActivated("0d905643-decb-4b91-8c6d-87348745d166"))t=u;else{var y=new s.e(window.location.href).getQueryParameter("sessionId");t=i.e.isValidGuid(y)?y:u}var S=Object(a.e)({UserId:f,FarmName:m,FarmLabel:_,AccountType:p?o.e[o.e.Business]:o.e[o.e.BusinessAnonymous],TenantID:h,ServerGU:b,Session:t,SessionId:t},c);return new l(Object(a.e)({contextProvided:S,disableCookies:v,ariaLogConfiguration:{collectorUrl:g}},d))}},function(e,t,n){"use strict";var a=n(69),i=n(8),r=Object(a.e)({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0},{message:i.e.String,stack:i.e.String,builtStack:i.e.String,line:i.e.Number,col:i.e.Number,url:i.e.String,privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}}).withData({privacyClassification:i.t.requiredService,privacyDataTypes:["productAndServicePerformance"]}),o=0;function s(e){var t,n,a;if(e){var i=e&&e.toString?e.toString():"InvalidMethod()",r=8===i.indexOf(" ")?9:0,o=i.indexOf(")")+1;if(0===(t=i.substring(r,o)).indexOf("function")||t.indexOf("(")<3){var s=o+50;a=s,(n=i=i.replace(/\s\s*/g," "))&&n.length>a&&(n=n.substr(0,a-3)+"..."),t=n+(s<i.length?"}":"")}}return t}function c(){var e,t=[];try{for(e=arguments.callee;e===l||e===c;)e=e?e.caller:e}catch(t){e=null}var n=0;try{for(;e&&n<10;)t.push(s(e)),e=e.caller,n++}catch(e){}return t}var d=[function(e){return"string"==typeof e&&0===e.indexOf("ResizeObserver loop limit exceeded")}];function l(e,t,n,a,i){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&(d.some(function(t){return t(e,i)})||Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,t,n,a,i]))}catch(e){}var s=i&&i.stack,l=c().join("\n");s=s?s.replace(/[ \t]{2,}/g," "):"",l=l.replace(/[ \t]{2,}/g," ");var u={message:e,url:t,line:n,col:a,stack:s,builtStack:l};o<100?r.logData(u):100===o&&r.logData({message:"Hit max error limit of ".concat(100),url:"NA",line:0,col:0,stack:"",builtStack:""}),o++}window.onerror=l},function(e,t,n){"use strict";var a=n(45),i=n(27),r=n(69),o=n(8),s=Object(r.e)({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0},{message:o.e.String,requireModules:o.e.Array,requireType:o.e.String,stack:o.e.String}),c=n(41),d=new a.e("RequireJS",i.e.session),l="error";(function(){function e(){}return e.log=function(e){s.logData(e);var t=d.getValue(l)||[];t.push(e.message),d.setValue(l,t),e&&("define"===e.requireType||"require"===e.requireType)&&e.stack&&e.requireModules&&c.e.log(e)},e.registerRequireOnError=function(){if(window.requirejs&&"function"==typeof window.requirejs){var t=window.requirejs.onError;window.requirejs.onError=function(n){e.log(n),t&&!n.isTest&&t(n)}}},e})().registerRequireOnError()},function(e,t,n){"use strict";var a=n(41),i=n(96),r=n(67),o=n(65),s=n(200),c=n(69),d=n(8),l=Object(c.e)({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise"},{message:d.e.String,extraData:d.e.String}).withData({privacyClassification:d.t.requiredService,privacyDataTypes:["productAndServicePerformance"]}),u=new(function(){function e(){this._outstandingPromiseErrors={},this._async=new i.e}return e.prototype.log=function(e){var t=this,n=e.id;e.parent?e.handler&&delete this._outstandingPromiseErrors[n]:(this._outstandingPromiseErrors[n]=e,1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={},Object.keys(e).forEach(function(t){var n=e[t],i=n.exception?n.exception:n.error;if(i instanceof Error||i&&i.stack?r.t.isCanceled(n)||a.e.log(i):l.logData({message:"Promise with no error callback",extraData:Object(s.e)(i)}),window.console&&console.log){var o="Promise with no error callback:"+n.id;console.warn?console.warn(o):console.log(o),console.log(n),i&&i.stack&&console.log(i.stack)}})},0))},e}());new o.t(u).on(r.t,"error",u.log)},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return d});var i=!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode),r=-1!==(null===(a=null===window||void 0===window?void 0:window.document)||void 0===a?void 0:a.cookie.indexOf("srr"))||i,o="/files/fabric-cdn-prod_20230223.001",s="".concat("https://res-1.cdn.office.net").concat(o),c=r?s:"",d=function(e){var t,n;if(!c){var a=null===(n=null===(t=window.require)||void 0===t?void 0:t.toUrl)||void 0===n?void 0:n.call(t,"");c=a?"".concat(function(e){var t=e.indexOf("//"),n=e.indexOf("/"),a=t>-1&&t<=n?t+"//".length:-1;if(a>-1){var i=e.indexOf("/",a);return i>-1?e.slice(0,i):e}return""}(a)).concat(o):s}return"".concat(c).concat("")}()},,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:flex;flex-direction:column;padding:10px;width:250px}"}]);var r=n(493),o=n(32),s=n(393),c=n("react-lib"),d=n("prop-types-lib"),l=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowCallout=function(){i.setState(Object(a.e)(Object(a.e)({},i.state),{isCalloutVisible:!0}))},i._onDismissCallout=function(){i.setState(Object(a.e)(Object(a.e)({},i.state),{isCalloutVisible:!1}))},i._onInfoButton=function(e){i._infoButton=e},i.state={isCalloutVisible:!1},i}return Object(a.a)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return c.createElement("div",null,c.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},c.createElement(s.e,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),t.isCalloutVisible&&c.createElement(r.e,{directionalHint:o.e.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},c.createElement("div",{className:"od-InfoButton-content"},c.createElement("span",{className:"od-InfoButton-message"},e.message))))},t.contextTypes={strings:d.object.isRequired},t}(c.Component)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(69),i=n(8),r=n(229),o=Object(a.e)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:i.e.String},privacyClassification:{isPrefixingDisabled:!0,type:i.e.String}},r.e).withData({privacyClassification:i.t.requiredService})},,function(e,t,n){"use strict";var a,i=n(67),r=n(7);!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var o=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:r.t.Success}),e},function(e){return n.end({resultType:r.t.Failure}),i.t.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:r.t.Success}),e},function(e){return n.end({resultType:r.t.Failure}),i.t.reject(e)})},e}();t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(42),i=n(113),r=function(){function e(e){this._pageContext=e.pageContext,this._listId=e.listId,this._listItemId=e.listItemId,this._webAbsoluteUrl=e.webAbsoluteUrl}return e.prototype.getAdvancedUrl=function(){var e=[this._webAbsoluteUrl];if(e.push("/_layouts/15/user.aspx"),e.push("?List="+a.e.encodeURIComponent(this._listId)),this._listId&&this._listItemId)return e.push("&obj=",a.e.encodeURIComponent(this._listId),",",a.e.encodeURIComponent(this._listItemId),",LISTITEM"),Number(this._pageContext.webTemplate)===i.t.group&&e.push("&noredirect=true"),e.join("")},e}()},,,,,,,function(e,t,n){"use strict";function a(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return H});var a,i=n(0),r=n(14),o=n(458),s=n(45),c=n(27),d=n(202),l=n(69),u=n(8),f=Object(l.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError"},{message:u.e.String,stack:u.e.String,type:u.e.String}),p=n(113),m=n(232),_=n(65),h=n(21),b=n(3),g=n(163),v=n(237),y=n(330),S=n(67),D=n(72),I=n(399),x=n(159),C=function(){function e(){}return e.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1!==(e.className?e.className.split(" "):[]).indexOf(t)},e.toggleClass=function(e,t,n){if(e.classList)n?e.classList.add(t):e.classList.remove(t);else{var a=e.className?e.className.split(" "):[],i=a.indexOf(t);n?-1===i&&a.push(t):i>-1&&a.splice(i,1),e.className=a.join(" ")}},e.loadStyles=function(t){e._platform.isUnlimitedStyleSheetsSupported?e.registerStyle(t):e.registerStyleIE(t)},e.registerStyle=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode(e)),t.appendChild(n)},e.registerStyleIE=function(t){var n=document.getElementsByTagName("head")[0],a=e._lastStyleElement?e._lastStyleElement.styleSheet.cssText:"";(!e._lastStyleElement||a.length+e._styleText.length>e.MAX_STYLE_CONTENT_SIZE)&&(e._lastStyleElement=document.createElement("style"),e._lastStyleElement.type="text/css",n.appendChild(e._lastStyleElement)),e._lastStyleElement.styleSheet.cssText+=t},e.loadStylesheet=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.head.appendChild(t)},e.setText=function(t,n){void 0===a&&(a=void 0!==e.ce("div").textContent?"textContent":"innerText"),t[a]=n},e.ce=function(e,t,n){var a=document.createElement(e);if(t)for(var i=Object.keys(t),r=0;r<i.length;r++){var o=i[r];a.setAttribute(o,t[o])}if(n)for(var s=0;s<n.length;s++)a.appendChild(n[s]);return a},e.setShadowParent=function(t,n){t[e.SHADOW_PARENT_KEY]=n},e.getParent=function(t,n){return void 0===n&&(n=!0),n&&t[e.SHADOW_PARENT_KEY]||t.parentElement},e.ct=function(e){return document.createTextNode(e)},e.createComment=function(e){return document.createComment(e)},e.clickElement=function(e){e.onclick?e.onclick(void 0):e.click&&e.click()},e.insertAfter=function(e,t){var n=t.parentNode,a=t.nextSibling;a?n.insertBefore(e,a):n.appendChild(e)},e.waitForElement=function(e,t,n){var a=document.querySelector(e);if(!a){var i=new MutationObserver(function(n,a){var i=document.querySelector(e);i&&(t(i),a.disconnect())});return i.observe(n||document.documentElement,{childList:!0,subtree:!0}),i}t(a)},e.getElementByTagAndPartialId=function(e,t,n){for(var a=[],i=e.getElementsByTagName(t),r=0;r<i.length;r++)i[r].id.indexOf(n)>=0&&a.push(i[r]);return a.length>0?a[0]:null},e.findAncestor=function(t,n,a){for(void 0===a&&(a=!0);t&&t!==document.body;){if(e.hasClass(t,n))return t;t=e.getParent(t,a)}return null},e.calculateRect=function(e,t){var n=e.getBoundingClientRect(),a=0,i=0,r=0,o=0;if(t){var s=window.getComputedStyle(e);a=parseFloat(s.marginLeft),i=parseFloat(s.marginRight),r=parseFloat(s.marginTop),o=parseFloat(s.marginBottom)}return new I.e(n.left-a,n.top-r,n.width+a+i,n.height+r+o)},e.calculateSubtreeRect=function(t){for(var n=null,a=[t];a.length>0;){t=a.shift();var i=e.calculateRect(t);i.width>0&&i.height>0&&(n=n?n.union(i):i);for(var r=0,o=t.children.length;r<o;r++)a.push(t.children[r])}return n||(n=new I.e),n},e.insertAtIndex=function(e,t,n,a){if(e&&t){n=n<0?0:n;for(var i=e.firstElementChild,r=0;r<n&&i;)a&&a!==i.tagName||r++,i=i.nextElementSibling;i?e.insertBefore(t,i):e.appendChild(t)}},e.MAX_STYLE_CONTENT_SIZE=1e4,e.SHADOW_PARENT_KEY="_OneDrive_shadowParent",e._platform=new x.e,e._lastStyleElement=null,e._styleText="",e}(),O=n(219),w=n(7),E=n(28),A=n(236),L=function(){function e(){}return e.GetLoadPromise=function(){return window.o365ShellLoadPromise},e.GetRenderPromise=function(){return window.o365ShellRenderPromise},e.GetPostRenderPromise=function(){return window.o365ShellPostRenderPromise},e}(),k=function(){function e(){var e=this;this._PostRenderSignal=new o.e,L.GetLoadPromise()&&L.GetLoadPromise().then(function(){e._signalAction(function(){})}),L.GetRenderPromise()&&L.GetRenderPromise().then(function(){e._signalAction(function(){})}),L.GetPostRenderPromise()&&L.GetPostRenderPromise().then(function(){e._signalAction(function(){})})}return Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MeControl",{get:function(){return O365Shell.MeControl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DTT",{get:function(){return O365Shell.DTT},enumerable:!1,configurable:!0}),e.prototype.SetData=function(e){O365Shell.SetData(e)},e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})},e.prototype.RenderAsync=function(e,t,n){var a=this;O365Shell.RenderAsync(e,function(){return a._signalAction(t)},function(){return a._signalAction(n)})},e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()},e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)},e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)},e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()},e.prototype.Exists=function(){return"undefined"!=typeof O365Shell},e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]},e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})},e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new o.e,t.complete()},e}(),M=function(){function e(t,n){this._cachePrefix="odSuiteNav",this._cacheDataKey="Data",this._cacheThemeDataKey="ThemeData",this._cacheDateKey="CacheDate",this._cacheVersionKey="CacheVersion",this._cacheSessionKey="CachedThisSession",this._cacheVersion=6,this._cacheExpire=24,this._cacheRenew=12,this._cache=new s.e(this._cachePrefix,c.e.local),this._dataSourceBasic=n.dataSource,this._engagementEvent=t.engagementEvent,this._qosEvents=t.qosEvents,this._capabilities=this._dataSourceBasic.getCapabilities();var a=n.require,i=void 0===a?e.require:a;this._require=i}return Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0}),e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.getO365Shell=function(){var e=this;if(!this._capabilities.supportsRealSuiteNav)return S.t.reject(new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));if(h.e.isFeatureEnabled({ODB:!0})){var t=new k;return S.t.resolve().then(L.GetLoadPromise).then(function(){return t})}var n=new o.e,a=this._qosEvents&&this._qosEvents["SuiteNavProvider.GetO365Shell"];return this._getSuiteNavShellViaBootstrapper(n),n.getPromise().then(function(){e._qosRecordSuccess(a)},function(t){e._qosRecordError(a,t)}),n.getPromise()},e.prototype.getInitialRenderNavBarData=function(){return this._dataSourceBasic.getInitialRenderNavBarData()},e.prototype.getCachedData=function(){var e;if(this._capabilities.supportsCaching&&this._isCacheValid()){var t=this._cache.getValue(this._cacheDataKey);e=t&&t.data}return e},e.prototype.getCachedThemeData=function(){var e;if(this._capabilities.supportsCaching){var t=this._cache.getValue(this._cacheThemeDataKey);t&&t.themeData&&(e=t.themeData)}return e},e.prototype.updateCachedThemeData=function(e){var t={themeData:e,cacheDate:(new Date).toISOString()};this._cache.setValue(this._cacheThemeDataKey,t)},e.prototype._requestShellCore=function(t,n,a){var i=n?t+"?odb_cb="+(new Date).toISOString():t,r=new o.e,s="SuiteNavShellCore";return this._require(i,s,function(e){a&&a();var t=new k;t.Exists()?r.complete(t):r.error(P({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:i}}))},function(t,n){e.removeHeadScriptElement(s),r.error(P({error:n||t.message,resultCode:"LoadScriptError",extraData:{shellUrl:i}}))}),r.getPromise()},e.removeHeadScriptElement=function(e){var t=document.head.querySelector("#"+e);t&&t.parentNode.removeChild(t)},e.prototype._isCacheValid=function(){var e=this._cache.getValue(this._cacheDataKey),t=this._cache.getValue(this._cacheVersionKey),n=Date.parse(this._cache.getValue(this._cacheDateKey)),a=this._capabilities.supportsRealSuiteNav,i=this._dataSourceBasic;return e&&e.data&&(!a||e.jsUrl)&&t===this._cacheVersion&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&this._isCacheNotExpired(n,this._cacheExpire)},e.prototype._qosRecordSuccess=function(e){e&&e.end({resultType:E.e.Success})},e.prototype._qosRecordError=function(e,t){e&&e.end(P({error:t}))},e.prototype._logEngagementData=function(e){this._engagementEvent&&this._engagementEvent.logData(e)},e.prototype._isCacheNotExpired=function(e,t){return!isNaN(e)&&Date.now()-e<60*t*60*1e3},e.prototype._getSuiteNavShellViaBootstrapper=function(e,t){var n=this;this._logEngagementData({name:"SuiteNavProvider.GetO365ShellByBootstrapper"});var a=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(a,t).then(function(t){e.complete(t)},function(t){t=P({error:t}),n._hasRetriedO365Shell?e.error(t):(n._logEngagementData({name:"SuiteNavProvider.O365ShellRetry"}),n._hasRetriedO365Shell=!0,n._getSuiteNavShellViaBootstrapper(e,!0))})},e.require=function(t,n,a,i){var r=function(){return void 0!==window.O365Shell};if(r())a&&a(null);else{var o=document.head.querySelector("#"+n);if(o&&o.src===t)try{Object(A.t)(r,300,3e4).then(function(){a(null)})}catch(e){i(null,"Unable to load O365Shell")}else{o&&o.src!==t&&e.removeHeadScriptElement(n);var s=document.createElement("script");s.id=n,s.src=t,a&&s.addEventListener("load",function(e){a(e)}),i&&s.addEventListener("error",function(e){i(e)}),document.head.appendChild(s)}}},e}();function P(e){var t=e.error;if(t&&t.resultCode)return t;var n=E.e.Failure;return S.t.isCanceled(t)&&(n=E.e.ExpectedFailure,e.resultCode="Canceled"),{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}var T={ODB:556,ODC:null,Fallback:!1},U={ODB:1302,ODC:null,Fallback:!1},F={ODB:1836,ODC:null,Fallback:!1},H=function(e){function t(t,n){var a=e.call(this,{engagementEvent:O.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new w.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;return a._dataSource=n.dataSource,a._cssLoaded=!1,a._isSuiteNavBootstrapperLoadingFlowEnabled=h.e.isFeatureEnabled(U),a}return Object(i.a)(t,e),t.prototype.clearCachedPromise=function(){this._modelPromise=void 0},t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})},t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new o.e,n=new w.e({name:"SuiteNavProvider.GetO365Shell"});return this._getSuiteNavShell(t),t.getPromise().then(function(){n.end({resultType:w.t.Success})},function(e){n.end(P({error:e}))}),t.getPromise()},t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i&&i.Id===m.e.MAIL)return i.Url}})},t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(a){return(t=a)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){O.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})},t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,a=this._dataSource.getSuiteNavContext();if(a&&a.isConsumer)return b.t.isActivated("0461c2e7-c91a-4038-b591-09477f3f84a6","09/27/2021","Extra SuiteNav configuration for Consumer")||e.NFD&&(a.helpNamespace&&e.NFD.UpdateHelpNamespace(a.helpNamespace),e.NFD.OnFeedbackMetadataRequested(function(e,t){return n._dataSource.setFeedbackMetadata(e,t)}),this._addFeedbackButton(e)),b.t.isActivated("F9F01D2F-A402-49F0-97B9-C03F77BEAD5B","01/24/2022","SuiteNav Settings Gear links configuration for Consumer")||a.actionsMap&&e.Navigation.OnLinkClick(function(e){var t=a.actionsMap[e.Id];t&&(e.Cancel=!t(Object(i.e)({},e)))}),this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"}),S.t.wrap(!0);O.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var r=t.actionContext,o=t.bundleLoader;return this.loadData().then(function(t){if(!t)return O.e.logData({name:"SuiteNavProvider.NoSuiteNavData"}),!1;if(!e)return O.e.logData({name:"SuiteNavProvider.NoO365Shell"}),!1;var a=n._isStreamAspx(),s=(a||h.e.isFeatureEnabled(F))&&!!e.NFD,c=s&&(a||n._shouldAddFeedbackButton(e));if(c){var d=JSON.parse(t.ClientData);n._isFeedbackButtonEnabled()&&D.e&&(d.EnableVNextFeedback=!0),d.OCVFeedbackMAXEnabled?b.t.isActivated("7897BF84-323B-4580-95D2-A14836FE65F6","09/15/2021","Stop modifying OCVFeedbackMAXEnabled")||(d.OCVFeedbackMAXEnabled=!1,t.ClientData=JSON.stringify(d)):s=c=!1}try{e.SetData(t)}catch(e){return O.e.logData({name:"SuiteNavProvider.SetDataFail"}),w.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)}),!1}return t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(i.e)(Object(i.e)({},e),r||{})))}),e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return w.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})}),s&&(e.NFD.OnFeedbackMetadataRequested(function(e,t){return n._dataSource.setFeedbackMetadata(e,t)}),c&&n._addFeedbackButton(e)),o&&o.pageRenderingIsComplete(),!0},function(e){return O.e.logData({name:"SuiteNavProvider.LoadDataError"}),!1})},t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(a){!n._cssLoaded&&a.cssUrl&&(C.loadStylesheet(a.cssUrl),n._dataSource.onCssLoad&&n._dataSource.onCssLoad(a),n._cssLoaded=!0),O.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"}),n._requestShellCore(a.jsUrl,t,R).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0,(t=P({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache?(O.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),n._clearCache(),n._getSuiteNavShell(e)):n._hasRetriedShell?e.error(t):(n._hasRetriedShell=!0,n._cssLoaded=!1,O.e.logData({name:"SuiteNavProvider.O365ShellRetry"}),n._getSuiteNavShell(e,!0))})})},t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,a,i,r,s=new o.e,c=this._capabilities.supportsCaching,d=this._dataSource,l=w.t.Failure,u=w.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new S.t(function(a,i){var r;!e&&c&&t._isCacheValid()&&(r=t._cache.getValue(t._cacheDataKey)),r&&r.data?(O.e.logData({name:"SuiteNavProvider.DataFromCache"}),d.updateDataForCurrentPage&&(r.data=d.updateDataForCurrentPage(r.data)),c&&t._isCacheOutdated()&&(O.e.logData({name:"SuiteNavProvider.RefreshCache"}),d.loadData().then(function(e){t._updateCache(e)})),t._isDataFromCache=!0,a(r)):(t._isDataFromCache=!1,e&&O.e.logData({name:"SuiteNavProvider.ForceUpdateData"}),O.e.logData({name:"SuiteNavProvider.DataFromServer"}),d.loadData().done(function(e){e?e.data?(c&&!function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}(e)&&t._updateCache(e),a(e)):(n="NoModelData",i("Model with no data returned")):(n="NoModel",i("No model returned"))},function(e){S.t.isCanceled(i)?(n="Canceled",l=w.t.ExpectedFailure):n="ServerLoadFailure",i(e)}))})},null,function(e){return S.t.isCanceled(e)&&(l=w.t.ExpectedFailure,n="Canceled"),{resultType:l,resultCode:n||"Other",error:e}});return i=window._spPageContextInfo,r={webThemeProvider:function(){return new v.e({pageContext:i,getThemeDataSource:function(){return S.t.resolve(new y.default(i))}})}},(a=Object(g.e)(r,i))?this._modelPromise=S.t.all({suiteNavModel:u,theme:a.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,a=t&&t.data,i=t&&t.hasCobranding,r=a&&a.UseSPOBehaviors,o=h.e.isFeatureEnabled(T),s=n&&n.suiteBarBackground;return!(s&&a&&r)||i&&o||(a.ThemeColors=[s,n.primaryText,s,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]),t}):this._modelPromise=u,this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)}),s.getPromise()},t.prototype._isFeedbackButtonEnabled=function(){return h.e.isFeatureEnabled({ODB:D.e?60887:1246,ODC:null,Fallback:!1})},t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(this._isFeedbackButtonEnabled()){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():p.t.invalid;t=n!==p.t.mySiteHost&&!D.t&&n!==p.t.tenantAdmin||/\/_layouts\/15\/Lists.aspx$/i.test(window.location.pathname)}return b.t.isActivated("37979f7f-d962-4d4c-b18d-d795d7c42ffd","04/27/2022","Always add feedback button for stream.aspx")&&!t&&/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname)&&(t=h.e.isFeatureEnabled({ODB:1246,ODC:null,Fallback:!1})),!t&&/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&(t=h.e.isFeatureEnabled({ODB:1246,ODC:null,Fallback:!1})),t},t.prototype._isStreamAspx=function(){return!(b.t.isActivated("37979f7f-d962-4d4c-b18d-d795d7c42ffd","04/27/2022","Always add feedback button for stream.aspx")||!/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname))},t.prototype._addFeedbackButton=function(e){var t,n="GiveFeedbackButton",a="Feedback",i=function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider(a),_.e.raise(document.body,"resize",void 0,!0)},o=function(){var t;e.FlexPane&&(e.FlexPane.OpenFlexPaneForProvider(a),_.e.raise(document.body,"resize",void 0,!0)),null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState(n,!0)};b.t.isActivated("4dcd117e-f86f-4bbe-bef1-3afc60df78f7","03/02/2022","Load Feedback icon before using it")?null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:d.e,ariaLabel:d.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:n,onShow:o,onHide:i}):e.Extensibility&&(Object(r.C)("Feedback"),e.Extensibility.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:d.e,ariaLabel:d.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:n,onShow:o,onHide:i}))},t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey),this._cache.remove(this._cacheThemeDataKey),this._cache.remove(this._cacheDateKey),this._cache.remove(this._cacheVersionKey),this._cache.remove(this._cacheSessionKey,c.e.session)},t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e),this._cache.setValue(this._cacheDateKey,new Date),this._cache.setValue(this._cacheVersionKey,this._cacheVersion),this._cache.setValue(this._cacheSessionKey,!0,c.e.session)},t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,c.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.e.hasStorageType(c.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3},t}(M);function R(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var a=n[t];N(e.b,a)}}function N(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];try{return n.apply(this,e)}catch(e){var i=e;f.logData({message:i&&i.message||"",stack:i&&i.stack||"",type:t})}})}},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(68),r=function(){function e(e){this._scope=new i.e,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(o(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var r=this._disposableMap.get(e);r||(r=new Map,this._disposableMap.set(e,r));var s=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});r.set(t,s)},e.prototype.off=function(e,t,n){var a;if(o(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var r=this._disposableMap.get(e);if(r){var s=r.get(t);s&&(s.dispose(),r.delete(t)),0===r.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function o(e){return!!e.addEventListener}var s=function(){function e(e){this._scope=new i.e,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),c="handlerRejection",d="canceled",l=0,u=function(){function e(e,t){void 0===t&&(t={});var n=this,a=new Map,o={onCommand:e.onCommand,onNotification:e.onNotification},l=e.initResources,u=e.initTimeoutMs,f=void 0===u?1e4:u,p=e.ackTimeoutMs,m=void 0===p?1e3:p,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?s:b,v=t.eventGroupType,y=void 0===v?r:v,S=this._scope=new i.e;S.attach(l);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=m,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=o.onCommand&&o.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:c,isExpected:!1,message:"Unknown error"}).code||e.name||c,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{o.onNotification&&o.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=d,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(f,"ms"));e.code="setupTimeout",a(e)},f),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=a}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:d,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++l,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(f(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(f(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e}),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function f(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function p(e){if(e.channelId&&e.origin)return e;var t=window.location.hash;if(!t)return e;for(var n={channelId:"",origin:""},i=0,r=t.slice(1).split("&");i<r.length;i++){var o=r[i].split("=",3),s=o[0],c=o[1];n.hasOwnProperty(s)&&(n[s]=decodeURIComponent(c))}return Object(a.e)(Object(a.e)({},n),e)}var m,_=function(){function e(){this._commandHandlers=[],this._notificationHandlers=[]}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}},e.prototype.dispose=function(){this._messenger.dispose()},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,n[t])(e);if(a)return a}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,n[t])(e)},e}(),h=n(7);!function(e){e.ScriptLoaded="share_scriptsLoaded",e.CopyLinkClicked="share_copyLinkClicked",e.ShareReady="share_ready",e.ShareDismiss="share_dismiss",e.ShareSendClicked="share_sendClicked",e.ShareManageAccessClicked="share_manageAccessClicked",e.ShareUIReady="share_uiReady",e.SharePageError="share_error",e.ShareCompleted="share_completed",e.ShareOutlookClicked="share_outlookClicked",e.ShareTeamsClickedWithContext="share_teamsClickedWithContext",e.ShareAddPeopleCompleted="share_addPeopleCompleted",e.ShareReadyForRecipients="share_readyForRecipients",e.GrantAccessCompleted="share_grantAccessCompleted",e.PeoplePickerFocused="share_peoplePickerFocused",e.ShareInstantLoad="share_instantLoadReady",e.ShareStarted="share_started"}(m||(m={}));var b=function(e){function t(t){var n=this,o=t.initTimeoutMs,s=void 0===o?4e4:o,c=t.overridePort,d=Object(a.r)(t,["initTimeoutMs","overridePort"]);return(n=e.call(this)||this)._isPageLoaded=!1,n._customerPromiseLogger=d.customerPromiseLogger,n._messenger=function(e,t){if(void 0===t&&(t={}),e.isRestartable)return function(e,t){void 0===t&&(t={});var n=p(e),a=n.channelId,o=n.origin,s=void 0===o?location.origin:o,c=n.host,d=void 0===c?window.parent!==window&&window.parent||window.opener:c,l=n.overridePort,f=n.receiver,m=void 0===f?window:f,_=t.channelType,h=void 0===_?MessageChannel:_,b=t.eventGroupType,g=void 0===b?r:b,v=t.messengerType,y=void 0===v?u:v,S=new i.e,D=S.attach(new g(null));return new y({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n=l?{port1:l,port2:void 0}:new h,i=n.port1,r=n.port2,o=!1;S.attach({dispose:function(){i.close()}});var c=!1,u=function(e){var t=e.data;if(c||!t||"object"!=typeof t||"identify-parent"!==t.type||t.channelId!==a);else{D.off(m,"message",u);var n=e.source,i=r;if(!l&&o){var d=new h,p=d.port1;i=d.port2,D.on(p,"message",f.bind(null,p)),p.start()}o=!0;var _={type:"initialize",channelId:a,replyTo:i};n.postMessage(_,s,i?[i]:void 0),c=!0}},f=function(n,a){var i=a.data;i&&"object"==typeof i&&"activate"===i.type?(D.dispose(),e(n)):t(new Error("Unexpected message during messenger initialization")),D.off(m,"message",u)};D.on(i,"message",f.bind(null,i)),i.start();var p={type:"initialize",channelId:a,replyTo:r};l?(o=!0,l.postMessage(p,[r])):d&&(o=!0,d.postMessage(p,s,[r]),D.on(m,"message",u))},initResources:S,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs})}(e,t);var n=p(e),a=n.channelId,o=n.origin,s=void 0===o?location.origin:o,c=n.host,d=void 0===c?window.parent!==window&&window.parent||window.opener:c,l=n.overridePort,f=n.receiver,m=void 0===f?window:f,_=t.channelType,h=void 0===_?MessageChannel:_,b=t.eventGroupType,g=void 0===b?r:b,v=t.messengerType,y=void 0===v?u:v,S=new i.e,D=S.attach(new g(null));return new y({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n=l?{port1:l,port2:void 0}:new h,i=n.port1,r=n.port2;S.attach({dispose:function(){i.close()}}),D.on(i,"message",function(n){var a=n.data;a&&"object"==typeof a&&"activate"===a.type?(D.dispose(),e(i)):t(new Error("Unexpected message during messenger initialization"))}),i.start();var o={type:"initialize",channelId:a,replyTo:r};if(l)l.postMessage(o,[r]);else if(d)d.postMessage(o,s,[r]);else{var c=function(e){var t=e.data;t&&"object"==typeof t&&"identify-parent"===t.type&&t.channelId===a&&(D.off(m,"message",c),e.source.postMessage(o,s,[r]))};D.on(m,"message",c)}},initResources:S,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}(Object(a.e)(Object(a.e)({},d),{initTimeoutMs:s,overridePort:c,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n}return Object(a.a)(t,e),t.prototype.sendScriptLoaded=function(){return this._send({command:"shareCommand",name:m.ScriptLoaded})},t.prototype.sendCopyLinkShareTargetClicked=function(){return this._send({command:"shareCommand",name:m.CopyLinkClicked})},t.prototype.sendShareReady=function(){return this._isPageLoaded?this._send({command:"shareCommand",name:m.ShareInstantLoad}):(this._isPageLoaded=!0,this._send({command:"shareCommand",name:m.ShareReady}))},t.prototype.sendShareStarted=function(){return this._send({command:"shareCommand",name:m.ShareStarted})},t.prototype.sendDismiss=function(){return this._send({command:"shareCommand",name:m.ShareDismiss})},t.prototype.sendShareSendClicked=function(){return this._send({command:"shareCommand",name:m.ShareSendClicked})},t.prototype.sendShareManageAccessClicked=function(){return this._send({command:"shareCommand",name:m.ShareManageAccessClicked})},t.prototype.sendShareUIReady=function(){return this._send({command:"shareCommand",name:m.ShareUIReady})},t.prototype.sendShareError=function(e){var t,n,a,i,r={command:"shareCommand",name:m.SharePageError,error:(null===(t=e.error)||void 0===t?void 0:t.toString())||"",errorCategory:(null===(n=e.errorCategory)||void 0===n?void 0:n.toString())||"",errorMessage:(null===(a=e.errorMessage)||void 0===a?void 0:a.toString())||"",debugErrorMessage:(null===(i=e.debugErrorMessage)||void 0===i?void 0:i.toString())||""};return this._send(r)},t.prototype.sendShareCompleted=function(){return this._send({command:"shareCommand",name:m.ShareCompleted})},t.prototype.sendOutlookClicked=function(){return this._send({command:"shareCommand",name:m.ShareOutlookClicked})},t.prototype.sendTeamsClicked=function(e,t,n){var a={command:"shareCommand",name:m.ShareTeamsClickedWithContext,sharingLink:e.url,recipients:t,numRecipients:t?t.length:0,body:n};return this._send(a)},t.prototype.sendShareAddPeopleCompleted=function(e,t){void 0===t&&(t="");var n={command:"shareCommand",name:m.ShareAddPeopleCompleted,successful:e,completionMessage:t};return this._send(n)},t.prototype.sendShareReadyForRecipients=function(){return this._send({command:"shareCommand",name:m.ShareReadyForRecipients})},t.prototype.sendGrantAccessCompleted=function(e){var t={command:"shareCommand",name:m.GrantAccessCompleted,successful:e};return this._send(t)},t.prototype.sendPeoplePickerFocused=function(){return this._send({command:"shareCommand",name:m.PeoplePickerFocused})},t.prototype.sendResize=function(e){var t=e;return t.command="shareCommand",this._send(t)},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:h.t.Failure,errorCode:"SharingClientMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1})},t}(_)},,function(e,t,n){"use strict";var a=n(0),i=n(41),r=n(96),o=function(){function e(){this._localHandlers=[]}return e.init=function(){var e=this;this._initialized||(this._initialized=!0,this._originalBeforeUnload=window.onbeforeunload,window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)})},e.registerHandler=function(e){this._handlers.push(e)},e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}},e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null},e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var n=0;n<this._handlers.length;n++)try{if(t=this._handlers[n](!0))break}catch(e){i.e.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){i.e.log(e)}}return t||void 0},e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e},e.prototype.registerHashNavDialogHandler=function(e){if(this._hashNavDialogHandler)throw Error("Registering HashNavDialogHandler when one is already set");this._hashNavDialogHandler=e},e.prototype.unregisterHashNavDialogHandler=function(){this._hashNavDialogHandler=void 0},e.prototype.allowHashNav=function(t,n){var a=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var r=0;r<e._handlers.length;r++)try{if(a=e._handlers[r](!1))break}catch(e){i.e.log(e)}a&&(e._isDialogOpen=!0,this._hashNavDialogCallback(a).then(function(){e._isDialogOpen=!1,e._allowNavs=!0,e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1,e._blockNavsAgainId=null})),t&&t()},function(){e._isDialogOpen=!1,n&&n()}))}return!a&&!e._isDialogOpen},e.prototype.blockHashNav=function(t,n){var a=this,r=null;if(this._dialogWasJustDismissed)return this._dialogWasJustDismissed=!1,!1;for(var o=0;o<e._handlers.length;o++)try{if(r=e._handlers[o](!1))break}catch(e){i.e.log(e)}return!(!r||!this._hashNavDialogHandler||(this._hashNavDialogHandler(r,function(){a._dialogWasJustDismissed=!0,t()},n),0))},e.prototype.registerHandler=function(t){this._localHandlers.push(t),e.registerHandler(t)},e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)},e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var a=n[t];e.unRegisterHandler(a)}},e._handlers=[],e._async=new r.e,e._initialized=!1,e}(),s=o;o.init();var c=n(65),d=n(150),l=n(367),u=n(122),f=n(159),p=n(3);function m(e){var t=null==e?void 0:e.event,n=!1,a="";location.href.indexOf("#")>-1?(a=location.hash.substr(1),n=!0):location.search.length&&(a=location.search.substr(1));var i=function(e){var t="";if(e&&"popstate"===e.type&&e.state){var n=e.state,a=n.useViewParamsFromState,i=n.viewParams;a&&i&&(t=function(e){return"string"==typeof e?e:Object(l.e)(e)}(i))}return t}(t),r=Object(d.e)(a),o=Object(d.e)(i),s=o,c=i;for(var u in r)if(o[u]!==r[u]){s=r,c=a;break}return{viewParams:s,viewParamsString:c,usingHashParams:n}}p.e.isActivated("A5E9FB38-28CC-4286-BC7C-F5ABDBF86D04","05/16/2022","Freeze view params on Navigation");var _=window.history,h=window.applicationCache,b=new f.e,g=!p.e.isActivated("DE394832-0B5E-447E-B070-CFB40B970AFE","3/16/2022","Enables hashNav Dialog warnings when registered"),v=!p.e.isActivated("02FA94A5-6D40-4824-8498-54B27DDC5B87","06/30/2022","Adds support for `ignoreHistory` when doing a non-hash redirect (ex: external links)"),y=p.e.isActivated("125b1224-9f61-40e6-88c7-a51f926cb844","01/04/2023","Fix navigation when event listener is disabled"),S=function(){function e(e){void 0===e&&(e={}),this._viewParamsString="",this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t,a=e.disableNavigationEventListeners,i=void 0!==a&&a,r=e.shouldReloadOnNavigate,o=e.history;this._overrideHistory=o,this._shouldReloadOnNavigate=r,this._performHashConversion=!n,this._disableNavigationEventListeners=e.disableNavigationEventListeners,this._viewParams={},this.scope=new u.e,this._prevHash=location.hash,this._supportsHistoryApi=_&&!!_.pushState&&(!h||h.status===h.UNCACHED),this.beforeUnload=new s,this.scope.attach(this.beforeUnload),this._events=this.scope.attach(new c.t(this)),this._events.declare("change"),i||this.setNavEventListeners("on"),this._updateUrlState()}return Object.defineProperty(e.prototype,"_history",{get:function(){return!p.e.isActivated("9F9AACD8-1519-4526-A4C1-9C8CEDF1B614","7/28/2020","Use hostNavigation functions from bootOptions")&&this._overrideHistory?this._overrideHistory:history},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.setNavEventListeners("off"),this.scope.dispose()},Object.defineProperty(e.prototype,"viewParams",{get:function(){return this._viewParams},enumerable:!1,configurable:!0}),e.prototype.navigateTo=function(e){var t=this;if(g||this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)})){var n="string"==typeof e?{url:e}:e,a=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:void 0,r=e.hasOwnProperty("directOpen")?e.directOpen:void 0,o=void 0,s=void 0;if(i&&"#"===i[0]?(o=i.substr(1),s=a):(o="#"===a[0]?a.substr(1):void 0,s=void 0),!p.e.isActivated("be269450-17b2-433b-8e52-301446d68521","10/19/2021","Open PWA navigations inside new tab except empty hash urls")&&void 0===n.frameId&&b.isPWA&&"#"!==a&&(n.frameId="_blank"),o)n.ignoreHistory?this._replaceState(o,!1,s):this._pushState(o,s);else{var c=void 0,d=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{(c=window.open(r?a:"",n.frameId))&&"_blank"===n.frameId&&(c.opener=null),c&&!r&&(!y&&this._disableNavigationEventListeners&&"#"===a?this.updateViewParams("",{ignoreHistory:n.ignoreHistory,clearOtherParams:!0}):c.location.href=a),d=!0}catch(e){}if(!c&&!d)try{v&&n.ignoreHistory?window.location.replace(a):window.location.href=a}catch(e){}}}},e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var n="string"==typeof e?Object(d.e)(e):e,i=Object(a.e)(Object(a.e)({},t.clearOtherParams?{}:this._viewParams),n);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)},e.prototype.updateViewParamsWithoutHistoryChange=function(e){var t={type:"popstate",state:{viewParams:e,useViewParamsFromState:!0}};this._updateUrlState(t)},e.prototype.reload=function(){window.location.reload()},e.prototype.setNavEventListeners=function(e){var t=("on"===e?this._events.on:this._events.off).bind(this._events);t(window,"hashchange",this._updateUrlState),t(window,"popstate",this._updateUrlState)},e.prototype._updateUrlState=function(e){var t=this,n=!1,a=window.document.location;if(g?!this.beforeUnload.blockHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()}):this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var i=m({event:e}),r=i.viewParams,o=i.usingHashParams,s=i.viewParamsString;s!==this._viewParamsString&&(this._viewParamsString=s||"",this._viewParams=r,n=!0),e&&this._shouldReloadOnNavigate&&this._shouldReloadOnNavigate()&&window.location.reload(),o&&this._performHashConversion&&this._supportsHistoryApi&&this._replaceState(s),n&&this._events.raise("change"),this._prevHash=a.hash}else n=!1,e&&e.preventDefault();return n},e.prototype._resetBeforeNavBlock=function(){if(this._dontBlockNextNav=!0,this._supportsHistoryApi)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)},e.prototype._pushState=function(e,t){var n=this._getViewParamsString(e);if(this._supportsHistoryApi)try{var a=this._getStateUrl(n);this._history.pushState({},"",a)}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState(),t&&this._setMaskUrl(t)},e.prototype._replaceState=function(e,t,n){var a=this._getViewParamsString(e);if(this._supportsHistoryApi)try{var i=this._getStateUrl(a,t);this._history.replaceState({},"",i)}catch(e){p.e.isActivated("EFD3C5E0-8069-451E-AF1F-24826B3D117C","8/18/2021","Fix infinite loop on nav when history replaceState fails")||(this._supportsHistoryApi=!1),this._hashNav(a)}else this._hashNav(a);this._updateUrlState(),n&&this._setMaskUrl(n)},e.prototype._setMaskUrl=function(e){if(e&&this._supportsHistoryApi){var t={useViewParamsFromState:!0,viewParams:this._viewParams};this._history.replaceState(t,"",e)}},e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:Object(l.e)(e)},e.prototype._getStateUrl=function(e,t){var n=t?"/":document.location.pathname;return"".concat(n).concat(e.length>0?"?":"").concat(e)},e.prototype._hashNav=function(e){document.location.hash=e},e}();t.e=S},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(85),r=n(192),o=n(13),s=n(42),c=n(21),d=n(72),l=n(3),u=n(26),f=n(52),p="https://shellprod.msocdn.com",m="https://shellppe.msocdn.com",_="/api/shellbootstrapper/business/oneshell",h=function(){function e(e,t){this._pageContext=t.pageContext,this._usePPEHost="true"===this._getUrlQueryParam("usePPE"),this._suiteNavContext=e.suiteNavContext,this._capabilities=e.suiteNavCapabilities?e.suiteNavCapabilities:{supportsCaching:!0,supportsRealSuiteNav:!0,showO365Text:!0,disableSecondaryUserPhotoProvider:!1,collapseO365Settings:!1,enableDelayLoading:!1}}return e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.getReactShellBootstrapperUrl=function(){return this._usePPEHost?m+_:p+_},e.prototype.getInitialRenderNavBarData=function(){return{WorkloadId:this._suiteNavContext.workloadId,CurrentMainLinkElementID:this._suiteNavContext.currentMainLinkElementID,UserID:this._parseUserID(this._pageContext.systemUserKey),UserDisplayName:this._pageContext.isSPO&&this._pageContext.isAnonymousGuestUser?void 0:this._pageContext.userDisplayName,ShellBootHost:this._usePPEHost?m:p,IsConsumer:!!this._suiteNavContext.isConsumer,Culture:s.e.escapeUrlForCallback(this._pageContext.currentUICultureName),IsRtl:f.e.isRightToLeft,AppBrandTheme:b(this._suiteNavContext),Language:this._pageContext.currentLanguage.toString()}},e.prototype.getCacheToken=function(){var e=this._pageContext.siteClientTag;return"string"==typeof e?e.substring(0,e.indexOf("$$")):""},e.prototype.getUserIdentifier=function(){return this._pageContext.systemUserKey},e.prototype._getUrlQueryParam=function(e){try{return new u.e(window.location.href).getQueryParameter(e)}catch(e){}},e.prototype._parseUserID=function(e){if(e){var t=e.lastIndexOf("|");return e.substring(t+1,e.indexOf("@",t))}return""},e}();function b(e){var t={Primary:d.n?"#0078D4":"#03787c"};return e.appBrandTheme?e.appBrandTheme:t}var g=n(149),v=n(121),y=n(113),S={ODB:60222,ODC:null,Fallback:!1},D="88d7a955-6ccc-4b35-b8ff-342a6bb08f3b",I=function(e){function t(n,a){var i=e.call(this,{dataSourceName:"SuiteNavDataSource"},a)||this;return i._suiteNavContext=n.suiteNavContext,i._suiteNavDataUpdater=n.suiteNavDataUpdater,i._suiteNavDataSourceBasic=n.suiteNavDataSourceBasic?n.suiteNavDataSourceBasic:new h(n,a),i._prefetchCache=a.prefetchCache,i._useDeadTabDetection()&&(i._signInTimeAtPageLoad=t._getSignInTime(),window.addEventListener("focus",function(){if("undefined"!=typeof MastInteraction&&MastInteraction.ShowPrompt){var e=t._getSignInTime();e&&e>i._signInTimeAtPageLoad&&(MastInteraction.SignOutPage(),MastInteraction.ShowPrompt("SwitchAccount"))}})),i}return Object(a.a)(t,e),t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()},t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()},t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()},t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()},t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()},t.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||y.t.invalid)},t.prototype.setFeedbackMetadata=function(e,t){var i,r,o=this,s=this._suiteNavContext.feedbackOptions;if(d.e&&!l.t.isActivated("94DA144E-80B8-4A87-B28A-2DE0473162EF","04/18/2023","Set feedback options")&&(e.options=Object(a.e)(Object(a.e)({},e.options),s),e.baseThemebyWorkload={baseThemeDark:"M365Dark",baseThemeLight:"M365Light"},e.colorSchemebyWorkload={colorSchemeDark:"M365Dark",colorSchemeLight:"M365Light"}),s&&s.appId){e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var u=c.e.isFeatureEnabled({ODB:d.n?60887:1246,ODC:null,Fallback:!1});if(!l.t.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost&&(u=!0),/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname)&&(l.t.isActivated("6758b12a-64ed-4d1e-86cd-bab1b01c14a8","10/22/2021","Enables screenshot UX for stream.aspx")||u||(u=!0),!l.t.isActivated("445049c8-5a35-42f6-83d3-d9aeffc41d42","07/21/2022","Set sourcePageName for Stream.aspx"))){var f=null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.webGroup,p=new URLSearchParams(document.location.search).get("action");e.options.webGroup={browser:null==f?void 0:f.browser,browserVersion:null==f?void 0:f.browserVersion,sourcePageName:"action=".concat(p),sourcePageURI:null==f?void 0:f.sourcePageURI}}/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&(u||(u=!0));var m=e.options;if(m.appId=s.appId,m.disableIncludeScreenshot=!u,m.userVoiceEnabled=s.userVoiceEnabled,m.userVoiceLink=s.userVoiceLink,m.applicationGroup||(m.applicationGroup={}),m.applicationGroup.appData||(m.applicationGroup.appData="{}"),!l.t.isActivated("1eb718d9-bafb-4222-bc8f-b374f2c0eece","04/18/2023","Set appData")&&this._suiteNavContext.getAppDataForFeedback){var _=this._suiteNavContext.getAppDataForFeedback(),h=m.applicationGroup.appData?JSON.parse(m.applicationGroup.appData):{};m.applicationGroup.appData=JSON.stringify(Object(a.e)(Object(a.e)({},h),_))}var b=m.telemetryGroup;b.audienceGroup=this._getAudienceGroup(),b.featureArea=this._getFeatureArea(null===(r=s.telemetryGroup)||void 0===r?void 0:r.featureArea),b.processSessionId=this._pageContext.CorrelationId,u&&t&&n.ee([35],741,7).then(function(e){var n=e.default||e;if(!l.t.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&o._pageContext.isSiteListsHost){var a=document.body;try{window.frames.length>0&&(a=window.frames[0].document.body)}catch(e){}n(a).then(function(e){t(e.toDataURL("image/jpeg"))})}else n(document.body).then(function(e){t(e.toDataURL("image/jpeg"))})})}return e},t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,a=s.e.escapeUrlForCallback(this._pageContext.currentUICultureName),r=Object(i.e)(this._pageContext),o=r?s.e.escapeUrlForCallback(r):"",c=function(e){var t=e.cultureName;return"".concat(e.baseUrl,"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale=").concat(t,"&v=2&msajax=1&cv=2")}({baseUrl:o,cultureName:a}),d="".concat(o,"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale=").concat(a),l=function(e){var n={suiteNavData:e.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},a=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(n):e.NavBarData,i=!(!a.HasTenantBranding||!e.TenantPrimaryColorShades&&!a.TenantLogoUrl);return a.AppBrandTheme=b(t._suiteNavContext),{data:a,jsUrl:e.JsUrl,cssUrl:e.CssUrl,hasCobranding:i,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}},u=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(t){var n=e===c?t:JSON.parse(t.d.GetSuiteNavData);return l(n)})},f=function(){return u(c).catch(function(){return u(d)})};if(this._pageContext.isSPO){var p=!1;if(this._prefetchCache){var m=this._prefetchCache.getData({url:c,body:"",qosName:"SpoSuiteLinks"});m&&(n=m.then(l,f),p=!0)}p||(n=f())}else n=u(d);return this._dataPromise=n,n.catch(function(){t._dataPromise=null}),n},t.prototype.getSuiteNavContext=function(){return this._suiteNavContext},t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&Object(o.t)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}catch(e){}},t.prototype.updateDataForCurrentPage=function(e){if(!this._suiteNavDataUpdater)return e;var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)},t.prototype._isDogfood=function(){var e=this._pageContext;return l.t.isActivated("5a7b54f2-bebb-4997-93a5-bb8a00ecbf56")?"prodbubble"===e.env&&"MSIT_SPDF_1_Content"===e.farmLabel:"spdf"===e.cloudType},t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;return this._isDogfood()?e="Dogfood":"prodbubble"===t.env?e="Microsoft":("prod"===t.env||"dprod"===t.env||!l.t.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost)&&(e="Production"),e},t.prototype._getFeatureArea=function(e){if(!l.t.isActivated("a00248de-2fc2-41a8-8671-f8fec416a811","10/22/2021","Allow apps to provide own feature area")&&e)return e;var t=this._pageContext;return!l.t.isActivated(D,"9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost?"Lists Freemium":t.listBaseTemplate===v.e.genericList?"List":t.listBaseTemplate===v.e.documentLibrary?"Libraries":t.listBaseTemplate===v.e.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":c.e.isFeatureEnabled({ODB:1120,ODC:null,Fallback:!1})&&this.getWebTemplateType()===y.t.contentCenter?"Syntex In-product Feedback":"Site"},t.prototype._useDeadTabDetection=function(){return!l.t.isActivated("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/21","Dead tab detection")&&c.e.isFeatureEnabled(S)},t._getCookieValue=function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return(null==t?void 0:t.pop())||""},t._getSignInTime=function(){var e=t._getCookieValue("SIMI");return e?Number(JSON.parse(atob(e)).st):0},t.siteSettingsPermissions=[r.e.enumeratePermissions,r.e.manageWeb,r.e.manageSubwebs,r.e.addAndCustomizePages,r.e.applyThemeAndBorder,r.e.manageAlerts,r.e.manageLists,r.e.viewUsageData],t}(g.e)},function(e,t,n){"use strict";n.r(t);var a,i=n(85),r=n(113),o=n(124),s=n(67),c=n(54),d=[.537,.349,.216,.184,.145,.082,.043,.027],l=[.537,.45,.349,.216,.184,.145,.082,.043],u=[.88,.77,.66,.55,.44,.33,.22,.11],f=[.11,.22,.33,.44,.55,.66,.77,.88],p=[.96,.84,.7,.4,.12],m=[.1,.24,.44];function _(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function h(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}function b(e,t,n){if(!e||t===a.Unshaded||!function(e){return"number"==typeof e&&e>=a.Unshaded&&e<=a.Shade8}(t))return e;var i=h,r=_;n&&(i=_,r=h);var o,s,b,g,v,y,S,D=(s=NaN,b=(o=e).R,g=o.G,v=o.B,0==(S=(y=Math.max(b,g,v))-Math.min(b,g,v))?s=0:b===y?s=(g-v)/S%6:g===y?s=(v-b)/S+2:v===y&&(s=(b-g)/S+4),(s=Math.round(60*s))<0&&(s+=360),{h:s,s:Math.round(100*(0===y?0:S/y)),v:Math.round(y/255*100)}),I=function(e){var t=e.h,n=e.s,a=e.v,i=(2-(n/=100))*(a/=100),r=n*a;return{h:t,s:100*(r=(r/=i<=1?i:2-i)||0),l:100*(i/=2)}}(D),x=t-1;return D=function(e){return 255===e.R&&255===e.G&&255===e.B}(e)?_(D,d[x]):function(e){return 0===e.R&&0===e.G&&0===e.B}(e)?h(D,l[x]):I.l/100>.8?r(D,f[x]):I.l/100<.2?i(D,u[x]):x<p.length?i(D,p[x]):r(D,m[x-p.length]),function(e){var t=e.h,n=e.s,a=e.v,i=[],r=(a/=100)*(n/=100),o=t/60,s=r*(1-Math.abs(o%2-1)),d=a-r;switch(Math.floor(o)){case 0:i=[r,s,0];break;case 1:i=[s,r,0];break;case 2:i=[0,r,s];break;case 3:i=[0,s,r];break;case 4:i=[s,0,r];break;case 5:i=[r,0,s]}return c.e.fromRgba(Math.round(255*(i[0]+d)),Math.round(255*(i[1]+d)),Math.round(255*(i[2]+d)))}(D)}!function(e){e[e.Unshaded=0]="Unshaded",e[e.Shade1=1]="Shade1",e[e.Shade2=2]="Shade2",e[e.Shade3=3]="Shade3",e[e.Shade4=4]="Shade4",e[e.Shade5=5]="Shade5",e[e.Shade6=6]="Shade6",e[e.Shade7=7]="Shade7",e[e.Shade8=8]="Shade8"}(a||(a={}));var g=function(){function e(){}return e.generateFabricColors=function(t,n){void 0===n&&(n=!1);var i={themeDarker:a.Shade8,themeDark:a.Shade7,themeDarkAlt:a.Shade6,themeLight:a.Shade3,themeLighter:a.Shade2,themeLighterAlt:a.Shade1,themePrimary:a.Unshaded,themeAccent:a.Unshaded,themeSecondary:a.Shade5,themeTertiary:a.Shade4},r=e._getDefaultThemeTokenMap(),o=c.e.fromRgba(t.R,t.G,t.B);for(var s in i){var d=i[s];r[s]=b(o,d,n)}var l=r.themeAccent;if(r.themeAccentTranslucent10=l?c.e.fromRgba(l.R,l.G,l.B,.1*c.e.maxComponent):null,n){var u="#4f4f4f",f="#484848",p={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:u,neutralQuaternaryAlt:f,cmdbarSelected:u,cmdbarSelectedHover:f,neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var m in p)p.hasOwnProperty(m)&&(r[m]=c.e.fromHtmlColor(p[m]))}return r},e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}},e}(),v=n(42),y=function(){function e(){}return e.makeWebThemeRestUrl=function(e,t,n){var a=e;a&&"/"===a[a.length-1]&&(a=a.substring(0,a.length-1)),a=v.e.escapeUrlForCallback(a);var i=v.e.escapeUrlForCallback(a)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+v.e.encodeURIComponent(t);return n&&(i+="&ThemeOverride="+v.e.encodeURIComponent(n)),i},e.processWebThemeRestResponse=function(t){var n,a=JSON.parse(t);return a&&a.d&&a.d.GetContextWebThemeData&&(n=JSON.parse(a.d.GetContextWebThemeData)),e.processRawThemeData(n)},e.processRawThemeData=function(t){if(t){var n,a=e.coerceToColor,i=e.SetColorIfMissing,r=t.Palette?t.Palette.Colors:{};n=e.convertColorsToRgba(r);var o=g.generateFabricColors(n.ContentAccent1,t.IsInverted),s=a(n.PageBackground)||a(t.IsInverted?"#1b1a19":"#ffffff"),d=a(n.BackgroundOverlay)||null,l=Math.round(.4*c.e.maxComponent);for(var u in o)i(n,u,o[u]);return i(n,"white",s),i(n,"primaryBackground",c.e.clone(s)),i(n,"primaryText",o.primaryText||a("#333")),i(n,"whiteTranslucent40",s&&c.e.fromRgba(s.R,s.G,s.B,l)),i(n,"backgroundOverlay",d),i(n,"suiteBarBackground",a(n.SuiteBarBackground)||null),i(n,"suiteBarText",a(n.SuiteBarText)||null),i(n,"suiteBarDisabledText",a(n.SuiteBarDisabledText)||null),i(n,"topBarBackground",a(n.TopBarBackground)||null),i(n,"topBarText",a(n.TopBarText)||null),i(n,"topBarHoverText",a(n.TopBarHoverText)||null),i(n,"dialogBorder",a(n.DialogBorder)||null),{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:n,version:t.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}},e.convertColorsToRgba=function(t){var n={};for(var a in t)if(t.hasOwnProperty(a)){var i=e.coerceToColor(t[a]);i&&(n[a]=i)}return n},e.coerceToColor=function(t){var n;return t?"string"==typeof t||t instanceof String?n=c.e.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=c.e.fromRgba(t.R,t.G,t.B,t.A)):n=null,n},e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)},e}(),S=n(72).n?"#0078d4":"#03787c",D=function(){function e(e){this._pageContext=e,this._dataRequestor=new o.e({qosName:"WebThemeDataSource"},{pageContext:e})}return e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),a=n!==r.t.mySite&&n!==r.t.mySiteHost?t.groupColor:S;e=t.themedCssFolderUrl||a}return e},e.prototype.loadTheme=function(e){return!e&&this._dataPromise?this._dataPromise:this.getCacheToken()?(this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme(),this._dataPromise):this._dataPromise=s.t.resolve()},e.prototype.needsRequestDigest=function(e){return!1},e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||S,t=c.e.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:g.generateFabricColors(t),version:"1"};return s.t.resolve(n)}return s.t.resolve()},e.prototype.loadServerTheme=function(){var e=this,t=Object(i.e)(this._pageContext),n=this._pageContext.currentUICultureName,a=this._pageContext.themedCssFolderUrl,r=this.getCacheToken()===a&&a||void 0,o=y.makeWebThemeRestUrl(t,n,r),s=this._dataRequestor.getData({url:o,parseResponse:function(t){return e._data=y.processWebThemeRestResponse(t),e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});return s.done(null,function(){e._dataPromise=null}),s},e}();t.default=D},function(e,t,n){"use strict";var a,i=n(0),r=n(205),o=n(56),s=n(177),c=n(334),d=n(462),l=n(176);!function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.EDIT=2]="EDIT",e[e.OWNER=3]="OWNER",e[e.REVIEW=6]="REVIEW"}(a||(a={}));var u=n(117),f=n(6),p=n(370),m=n(50),_=n(372),h=n(115),b=n(105),g=n(231),v=n(24),y=n(31),S=n(240),D=n(48),I=n(67),x=n(35),C=n(65),O=n(1),w=n(272),E=n(3),A=n(7),L=n(10),k=n(79),M=n(22),P=n(15),T=n(71),U=n(97),F=n(107),H=n(195),R=n(5),N=n(30),B=n(47),j=n(18),V=n(70),z=n(92),G=n(167),K=n(26),W=function(){function e(e,t){var n=this;this._listeners=null,this.stopSharing=function(){for(var e=n._storeContents.sharingInformation.sharingLinks,t=n._storeContents.sharingInformation.sharingPrincipals,a=0,i=e;a<i.length;a++){var r=i[a];n.unshareLink(r.sharingLinkKind,r.shareId)}n._removePrincipals(t)};var a=e.item,i=e.sharingInformation,r=e.policyTipInfo,o=e.outlookAvailability,s=e.companyName,c=e.defaultRecipients,d=e.accessChecked,l=void 0===d||d,u=e.mode,p=e.isListItem,m=e.prefetchGSI,_=e.waitSharingAPIsDuration;this._item=a,this._mode=u,this._sharingContextInformation=e.sharingContextInformation,this._clientId=this._sharingContextInformation&&Object(f.t)(this._sharingContextInformation.clientId),this._sharingProvider=t.sharingProvider,this._suiteNavProvider=t.suiteNavProvider||void 0,this._graphPeoplePickerHelper=t.graphPeoplePickerHelper,this._substratePeoplePickerHelper=t.substratePeoplePickerHelper,this._peoplePickerProvider=t.peoplePickerProvider,this._policyTipProvider=t.policyTipProvider||void 0,this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value,this._sharingService=e.sharingService,this._firstShareLinkRequest=!0,this._listeners=[],this._groupsMemberCountCache=[],this._sharingInformationInvalidated=!1,this._groupMembersCountHash={},this._isListItem=p,this._prefetchGSI=m,this._waitSharingAPIsDuration=_,this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&Object(N.e)(this._sharingContextInformation.experimentContext);var b=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"";this._telemetryExtraData={mode:this._mode,clientId:this._clientId,scenarioId:b},this._engagementHelper=new T.e(e.telemetryManager,this._telemetryExtraData),this._storeContents={sharingInformation:i,sharingLinkCreated:null,companyName:s||this._sharingContextInformation&&this._sharingContextInformation.organizationName||O.Ae,groupsMemberCount:0,policyTipInfo:r||{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:o||h.e.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1,filteredPrincipals:{},documentInformation:null,sharingInfoBarInformation:null},i&&i.userPhotoCdnBaseUrl&&Object(k.e)(i.userPhotoCdnBaseUrl),c&&0!==c.length?this._resolveDefaultRecipients(c,l,u):(this._eventGroup=new C.t(this),this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var a=t.recipientIds;n._resolveDefaultRecipients(a,l,u)}}catch(e){}})),R.M()||this._configureLinkIfShareId()}return e.prototype.getWaitSharingAPIsDuration=function(){return this._waitSharingAPIsDuration},e.prototype.getAuthToken=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.authToken},e.prototype.getScenarioId=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.scenarioId},e.prototype.isConsumer=function(){return!1},e.prototype.isConsumerLists=function(){return!!(window&&window._spPageContextInfo&&window._spPageContextInfo.isSiteListsHost)},e.prototype.isListItem=function(){return this._isListItem},e.prototype.getEngagementHelper=function(){return this._engagementHelper},e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListeners=function(){this._listeners=[]},e.prototype.getInitialLinkSettings=function(e){return null},e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation},e.prototype.shouldDisableGraphForPeopleSearch=function(){return this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||this._storeContents.sharingInformation.enforceSPOSearch)},e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled)}return!1},e.prototype.showManageAccess=function(){return!0},e.prototype.fetchSharingInformation=function(e,t){var n=this;if(this._storeContents.sharingInformation&&!this._sharingInformationInvalidated&&(!e||this._storeContents.sharingInformation.hasPermissionsInformation)&&!t)return this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:A.t.Success,duration:0},this._configureLinkIfShareId(),void this._emitChange({type:m.t.FetchSharingInformation});var a=(new Date).getTime(),i=!!this._sharingContextInformation||e;this._prefetchGSI&&this._checkPrefetchSupportExpansion(i,t)?this._raceGSI(i,t,a):this._sharingProvider.getSharingInformation(this._item,i,!0,null,t).then(function(e){n._setGSIResponse(e,a)},function(e){n._setGSIError(e,a)})},e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var a=n.totalMemberCount;t._groupMembersCountHash[e.email]=a,t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null,t._emitChange()})},e.prototype.getMembersCounts=function(){return this._groupMembersCountHash},e.prototype.shareLink=function(e){var t=this,n=new A.e({name:"shareLinkInvestigation"}),a=this._firstShareLinkRequest;this._firstShareLinkRequest=!1,Object(B.r)("sharelink.start");var l=e.settings,u=e.recipients,f=e.emailMessage,p=e.emailSubject,h=e.copyLinkCommand,b=e.allRecipientsHaveAccess,g=e.shareId,y=e.inviteesToRemove,S=e.shareType;if(e.copyLinkCommand&&P.f(this._clientId)&&this._mode===r.e.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&a)return this._getDefaultLink(),void n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:0},this._telemetryExtraData)});var D=0,I=0,C=!1,w=(u=u||[]).map(function(e){return e.entityType===v.e.externalUser?I++:D++,e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(C=!0),{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});if(w=this._dedupeRecipients(w),g&&g.length>0||l.shareId&&l.shareId.length>0)n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:1},this._telemetryExtraData)}),this._shareLink(l,w,f,p,h,a,g,y);else{if(!this.isPeopleSharingLinksEnabled()||!this._doesPSLSupportNewExternalUsers()&&C||l.audience===o.e.existing||this._storeContents.sharingInformation.requiresAccessApproval)if(l.sharingLinkKind!==s.e.direct&&l.sharingLinkKind!==s.e.flexible)n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:3,settings:l},this._telemetryExtraData)}),this._shareLink(l,w,f,p,h,a,g,y);else{var E;E=l.sharingRole?this._getRoleString(l.sharingRole):this._getRoleValue(l.isEdit);var L={items:[this._item],roleValue:E,sendEmail:void 0!==f,message:f,subject:p,requireSignIn:!0,propagateSharing:!0},k=this._storeContents.sharingInformation.directLink,M=(null==l?void 0:l.audience)==o.e.existing&&(S===c.e.copy||S===c.e.outlook||S===c.e.mobileShareToTeams||S===c.e.nonOutlook||S===c.e.moreApps||S===c.e.webShareToTeams);if(0===u.length||l.audience==o.e.existing&&(this._mode===r.e.copy||this._mode==r.e.linkSettings)||M)n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:4,useDirectLinkForShareTarget:M,recipientsLength:u.length},this._telemetryExtraData)}),this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:A.t.Success}),Object(B.r)("sharelink.existing"),this._handleSharedLink(k,h);else{for(var T=!0,U=0,F=u;U<F.length;U++){var H=F[U];this._storeContents.permissionsMap[H.email]!==_.e.hasAccess&&this._storeContents.permissionsMap[H.userId]!==_.e.hasAccess&&(T=!1)}if(T||b){n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:5,useDirectLinkForShareTarget:M,recipientsLength:u.length,allUsersArePermissioned:T,allRecipientsHaveAccess:b},this._telemetryExtraData)});var R=(new Date).getTime();Object(B.r)("sharelink.emailWithoutPermissioning.start"),this._sharingProvider.emailWithoutPermissioning(w,this._item,f,p).done(function(e){Object(B.r)("sharelink.emailWithoutPermissioning.end");var n=e.statusCode;if(0===n)t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-R,resultType:A.t.Success}),t._handleSharedLink(k,h);else{var a=d.t.generic,r=O.sn;-8===n?(a=d.t.objectNotSupported,r=O.es):-13===n?(a=d.t.invalidEmail,r=x.n(O.vn,e.invalidEmails.join(", "))):-7===n&&(a=d.t.generic,r=e.errorMessage),t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-R,resultType:A.t.Failure,error:a}),t._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},t._storeContents.sharingInformation),{error:a,errorCategory:d.e.shareLink,errorMessage:r}),t._emitChange({type:m.t.ShareLink})}})}else{var N=(new Date).getTime();Object(B.r)("sharelink.share.start"),n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:6,useDirectLinkForShareTarget:M,recipientsLength:u.length,allUsersArePermissioned:T,allRecipientsHaveAccess:b},this._telemetryExtraData)}),this._sharingProvider.share(w,L,!0).done(function(e){Object(B.r)("sharelink.share.end");var n=e.statusCode;if(0===n){var a=k;0===D&&1===I&&e.invitationLink?a=Object(i.e)(Object(i.e)({},k),{url:e.invitationLink}):0===D&&I>1&&e.invitationLink&&(a=Object(i.e)(Object(i.e)({},k),{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)})),l.audience===o.e.customLabeledSpecificPeople&&(a=Object(i.e)(Object(i.e)({},a),{audience:o.e.customLabeledSpecificPeople})),t._invokeShareStatsEvent({name:"ShareObject",resultType:A.t.Success,duration:(new Date).getTime()-N}),t._handleSharedLink(a,h)}else if(1===n)t._storeContents.accessRequestCreated=!0,t._invokeShareStatsEvent({name:"ShareObject",resultType:A.t.Success,duration:(new Date).getTime()-N}),t._handleSharedLink(k,h);else{var r=d.t.generic,s=O.sn;-8===n?(r=d.t.objectNotSupported,s=O.es):-13===n?(r=d.t.invalidEmail,s=x.n(O.vn,e.invalidEmails.join(", "))):-7===n&&(r=d.t.generic,s=e.errorMessage),t._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},t._storeContents.sharingInformation),{error:r,errorCategory:d.e.shareObject,errorMessage:s}),t._invokeShareStatsEvent({name:"ShareObject",resultType:A.t.Failure,duration:(new Date).getTime()-N,error:r}),t._emitChange({type:m.t.ShareLink})}})}}}else n.end({resultType:A.t.Success,extraData:Object(i.e)({sharingLinkPath:2,settings:l},this._telemetryExtraData)}),this._shareLink(l,w,f,p,h,a,g,y);h&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==l.audience&&this._cleanupDefaultLink()}},e.prototype.unshareLink=function(e,t){var n=this,a={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(a).then(function(e){!0===e&&(n._removeLinkByShareId(t),n.updatePermissionsInfoOnLinkChange(t,l.e.none),n._updateIsShared(),n._emitChange({type:m.t.UnshareLink}))}).then(function(){n._sharingInformationInvalidated=!0,n.fetchSharingInformation(!0)})},e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated},e.prototype.getLinksCount=function(){return this.getActiveLinks().length},e.prototype.getAllPrincipals=function(){var e=this._storeContents.sharingInformation.sharingPrincipals,t=this.getActiveLinks();this._addPrincipals(e);for(var n=0,a=t;n<a.length;n++){var i=a[n];(i.principals.length||i.invitees.length)&&(this._addPrincipals(i.principals),i.isActive&&(!i.expiration||i.expiration.getTime()>Date.now())&&this._addPrincipals(i.invitees))}return this._storeContents.filteredPrincipals},e.prototype.parsePermissions=function(){for(var e,t,n=[],a=[],r=[],o=this.getSharingInformation(),s=o.permissionsInformation.links.results,c=o.permissionsInformation.principals.results,d=o.permissionsInformation.siteAdmins.results,l=o.webUrl,u=0,f=s;u<f.length;u++)for(var p=f[u],m=void 0,_=0,h=p.linkMembers.results;_<h.length;_++){var b=h[_];m=Object(i.e)(Object(i.e)({},b),{primaryText:b.name,secondaryText:b.jobTitle,type:b.principalType,imageUrl:b.imageUrl||b.loginName?Object(k.t)(l)(b.loginName):"",role:b.role||this._getRoleFromLink(p)}),r.push(b.loginName),this._buildPrincipalAccessMap({addedIds:n,principals:a,sharingPrincipal:m,link:p})}for(var g=0,v=c;g<v.length;g++)b=v[g],m=Object(i.e)(Object(i.e)({},b.principal),{primaryText:b.principal.name,secondaryText:b.principal.jobTitle,type:b.principal.principalType,imageUrl:b.principal.loginName?Object(k.t)(l)(b.principal.loginName):"",role:b.role}),r.push(b.principal.loginName),this._buildPrincipalAccessMap({addedIds:n,principals:a,sharingPrincipal:m,link:void 0,isDirectAccess:!0});for(var y=function(o){if(-1===r.indexOf(o.principal.loginName)){var s=Object(i.e)(Object(i.e)({},o.principal),{primaryText:o.principal.name,secondaryText:o.principal.jobTitle,type:o.principal.principalType,imageUrl:o.principal.loginName?Object(k.t)(l)(o.principal.loginName):"",role:o.role});S._buildPrincipalAccessMap({addedIds:n,principals:a,sharingPrincipal:s})}else{var c=a.filter(function(e){return e.loginName===o.principal.loginName})[0];if(c){c.role=o.role;var d=null===(e=c.accessMap)||void 0===e?void 0:e.get(o.principal.id.toString());null===(t=null==c?void 0:c.accessMap)||void 0===t||t.set(o.principal.id.toString(),Object(i.e)(Object(i.e)({},d),{role:o.role}))}}},S=this,D=0,I=d;D<I.length;D++)y(I[D]);this._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},this._storeContents.sharingInformation),{sharingPrincipals:a})},e.prototype.getSensitivityLabels=function(e){var t=new A.e({name:"Sharing.sensitivityLabelGraphAPI"});return n.ee([14],742).then(function(n){return new n.SensitivityLabelsDataSource({getOAuthToken:e},{pageContext:window._spPageContextInfo}).getSensitivityLabels().then(function(e){return t.end({resultType:A.t.Success}),e}).catch(function(e){return t.end({resultType:A.t.Failure,resultCode:Object(z.a)(e),extraData:Object(z.n)(e)}),I.t.resolve(null)})})},e.prototype.getOptInSendNavIdInShareLink=function(){return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink},e.prototype.onDocumentInformation=function(e){this._storeContents.documentInformation=e,this._emitChange()},e.prototype.getDocumentInformation=function(){return this._storeContents.documentInformation},e.prototype.onReceivingSharingInfoBarInformation=function(e){e&&(this._storeContents.sharingInfoBarInformation=e),this._emitChange()},e.prototype.getSharingInfoBarInformation=function(){return this._storeContents.sharingInfoBarInformation},e.prototype._buildPrincipalAccessMap=function(e){var t,n,a,r,o=e.addedIds,s=e.principals,c=e.sharingPrincipal,d=e.link,l=e.isDirectAccess;d?(r=d.linkDetails.ShareId,a=this._getRoleFromLink(d),n=d.linkDetails.ShareId):l?(r=c.id.toString(),a=this._getRoleForPrincipal(c)||c.role,n=c.id.toString()):(r=c.id.toString(),a=this._getRoleForPrincipal(c)||c.role,n=c.loginName);var u={id:r,role:a,isSPO:!0,rawPermission:{shareId:r,scope:null===(t=null==d?void 0:d.linkDetails)||void 0===t?void 0:t.Scope}};if(-1===o.indexOf(c.id)){var f=new Map;f.set(n,u),c=Object(i.e)(Object(i.e)({},c),{accessMap:f})}else s.filter(function(e){return e.id===c.id})[0].accessMap.set(n,u);c&&(s.push(c),o.push(c.id))},e.prototype._getRoleFromLink=function(e){switch(e.linkDetails.LinkKind){case s.e.organizationEdit:case s.e.anonymousEdit:return l.e.edit;case s.e.organizationView:case s.e.anonymousView:return l.e.view;case s.e.flexible:default:return this._getRoleFromLinkDetails(e.linkDetails)}},e.prototype._getRoleForPrincipal=function(e){switch(e.sharingLinkKind){case s.e.organizationEdit:case s.e.anonymousEdit:return l.e.edit;case s.e.organizationView:case s.e.anonymousView:return l.e.view;default:return l.e.none}},e.prototype._getRoleFromLinkDetails=function(e){return e.IsManageListLink?l.e.manageList:e.IsReviewLink?l.e.review:e.IsEditLink?l.e.edit:l.e.view},e.prototype.parsePrincipals=function(){var e=this.getAllPrincipals(),t=[],n=[],a=[];for(var i in e){var r=e[i],o=r.role===l.e.owner;r.type===y.e.user?(o?t.unshift(r):t.push(r),a.push({alias:i})):r.type!==y.e.securityGroup&&r.type!==y.e.sharePointGroup||(o?n.unshift(r):n.push(r))}return this._engagementHelper.manageAccessV3NumberOfSharingPrincipals({numberOfUsers:t.length,numberOfGroups:n.length}),{users:t,groups:n}},e.prototype.getActiveLinks=function(){return this._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.isActive&&e.sharingLinkKind!==s.e.direct&&(!e.expiration||e.expiration.getTime()>Date.now())&&(1===N.i()&&R.T()?!e.isAddressBarLink&&!1===e.isUnhealthy:!(e.isAddressBarLink&&!0===e.isUnhealthy))})},e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var r=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===a.NONE){if(R.T()&&N.i()){var o=n._storeContents.sharingInformation.permissionsInformation.principals.results;n._storeContents.sharingInformation.permissionsInformation.principals.results=o.filter(function(t){return t.principal.id!==e.id}),n._storeContents.sharingInformation.sharingPrincipals=r.map(function(t){var a;if(t.id===e.id)if(t.accessMap){var i=t.id.toString();null===(a=t.accessMap)||void 0===a||a.delete(i),t.role=Object(L.h)(t),n._removePrincipalById(t.loginName)}else r.pop();return t}),n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange()}else n._storeContents.sharingInformation.sharingPrincipals=r.filter(function(t){return t.id===e.id&&n._removePrincipalById(t.loginName),t.id!==e.id});n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange()}else if(R.T()&&N.i())n._storeContents.sharingInformation.sharingPrincipals=r.map(function(r){var o,s,c,d,u,f;if(r.id===e.id){var p=void 0,m=void 0;switch((p=null===(o=r.accessMap)||void 0===o?void 0:o.get(r.loginName))?m=r.loginName:(p=null===(s=r.accessMap)||void 0===s?void 0:s.get(r.id.toString()))&&(m=r.id.toString()),t.role){case a.VIEW:r.role=l.e.view,null===(c=r.accessMap)||void 0===c||c.set(m,Object(i.e)(Object(i.e)({},p),{role:l.e.view}));break;case a.EDIT:r.role=l.e.edit,null===(d=r.accessMap)||void 0===d||d.set(m,Object(i.e)(Object(i.e)({},p),{role:l.e.edit}));break;case a.OWNER:r.role=l.e.owner,null===(u=r.accessMap)||void 0===u||u.set(m,Object(i.e)(Object(i.e)({},p),{role:l.e.owner}));break;case a.REVIEW:r.role=l.e.review,null===(f=r.accessMap)||void 0===f||f.set(m,Object(i.e)(Object(i.e)({},p),{role:l.e.review}))}}return n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange(),r}),n._storeContents.sharingInformation.permissionsInformation.principals.results.map(function(n){if(n.principal.id===e.id)switch(t.role){case a.VIEW:n.role=l.e.view;break;case a.EDIT:n.role=l.e.edit;break;case a.OWNER:n.role=l.e.owner;break;case a.REVIEW:n.role=l.e.review}return n}),n._studyEmitChangeUsage("updatePermissions1"),n._emitChange();else for(var s=0,c=r;s<c.length;s++){var d=c[s];if(d.id===e.id){switch(t.role){case a.VIEW:d.role=l.e.view;break;case a.EDIT:d.role=l.e.edit;break;case a.OWNER:d.role=l.e.owner;break;case a.REVIEW:d.role=l.e.review}n._studyEmitChangeUsage("updatePermissions1"),n._emitChange()}}})},e.prototype.grantDirectAccess=function(e,t){var n=this,a=this._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0],r=this._getRoleString(t),o={items:[this._item],roleValue:r,requireSignIn:!0,propagateSharing:!0},s=Object(i.e)(Object(i.e)({},a),{userId:a.email,name:a.loginName,email:a.email,rawData:{Key:a.email,isResolved:!1},rawPersonData:{Key:a.email,isResolved:!1},isResolved:!1});this._sharingProvider.share([s],o,!0).then(function(r){switch(r.statusCode){case 0:var o=n._storeContents.sharingInformation.sharingPrincipals;n._storeContents.addPeopleResult=m.e.CompletedSuccessfully,n._storeContents.sharingInformation.permissionsInformation.principals.results.push({role:t,principal:Object(i.e)(Object(i.e)({},a),{isActive:!0,principalType:a.type,userId:"",jobTitle:a.secondaryText,name:a.primaryText,email:a.email,id:parseInt(e)})});var s={id:e,role:t,isSPO:!0,rawPermission:{scope:void 0}};a.accessMap.set(e,s),n._storeContents.sharingInformation.sharingPrincipals=o.map(function(t){return t.id===parseInt(e)?a:t});break;case 1:n._storeContents.addPeopleResult=m.e.AccessRequestsQueued;break;default:n._storeContents.addPeopleResult=m.e.Error}n._emitChange()},function(){n._storeContents.addPeopleResult=!1,n._emitChange()})},e.prototype.updatePermissionsInfoOnLinkChange=function(e,t){this._storeContents.sharingInformation.sharingPrincipals;var n=this._storeContents.sharingInformation.permissionsInformation.links.results;switch(t){case l.e.none:this._storeContents.sharingInformation.permissionsInformation.links.results=n.filter(function(t){return t.linkDetails.ShareId!==e});break;case l.e.view:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){return t.linkDetails.ShareId===e&&(t.linkDetails.IsEditLink=!1),t});break;case l.e.edit:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){return t.linkDetails.ShareId===e&&(t.linkDetails.IsEditLink=!0),t});break;case l.e.review:this._storeContents.sharingInformation.permissionsInformation.links.results=n.map(function(t){return t.linkDetails.ShareId===e&&(t.linkDetails.IsReviewLink=!0),t})}t!==l.e.none&&this._updateAccessMap(e,t),this._updateIsShared(),this._emitChange()},e.prototype.updatePermissionById=function(e,t){var n=this.getSharingInformation().sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0];return this.updatePermissions(n,t),I.t.resolve()},e.prototype.addPeople=function(e,t,n,a){var i=this,r=this._getRoleString(t),o={items:[this._item],roleValue:r,sendEmail:n,message:a,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,o,!0).then(function(e){switch(e.statusCode){case 0:i._storeContents.addPeopleResult=m.e.CompletedSuccessfully;break;case 1:i._storeContents.addPeopleResult=m.e.AccessRequestsQueued;break;default:i._storeContents.addPeopleResult=m.e.Error}i._emitChange()},function(){i._storeContents.addPeopleResult=!1,i._emitChange()})},e.prototype.fetchSuiteNavInformation=function(){var e=this;this._suiteNavProvider?this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,a=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n,e._storeContents.outlookAvailability=a.HasEXOLicense?h.e.available:h.e.none,e._emitChange()}):(this._storeContents.outlookAvailability=h.e.none,this._emitChange())},e.prototype.getCompanyName=function(){return this._storeContents.companyName},e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability},e.prototype.navigateToOwa=function(e,t){Object(V.e)()?window.sessionStorage.setItem("OWA_sharingLinkUrl",this._getOwaUrl(e,t)):window.open(this._getOwaUrl(e,t),"_blank")},e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId},e.prototype.getContextualSharingInformation=function(){return this._sharingContextInformation&&this._sharingContextInformation.contextualSharingInformation},e.prototype.getInvitationId=function(){var e,t;return R.O()&&null!==(t=null===(e=this._sharingContextInformation)||void 0===e?void 0:e.invitationId)&&void 0!==t?t:""},e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,a=function(e){var a={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===y.e.securityGroup){var r=i._groupsMemberCountCache[e.userId];void 0!==r?n+=r:i._peoplePickerProvider.getPickerEntityInformation(a).then(function(a){var i=a.totalMemberCount;t._groupsMemberCountCache[e.userId]=i,n+=i,t._storeContents.groupsMemberCount=n,t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null,t._emitChange()})}},i=this,r=0,o=e;r<o.length;r++)a(o[r]);this._storeContents.groupsMemberCount=n,this._emitChange()},e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount},e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info)return void this._emitChange();var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,S.e.blockSharing),a=t.sharingAbilities;if(a){if((a&&a.directSharingAbilities&&a.directSharingAbilities.canAddExternalPrincipal.disabledReason)!==u.e.documentIsProtectedByDlp&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){t&&(e._storeContents.policyTipInfo.info=t,e._emitChange())})}},e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo},e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var a={item:this._item,action:e};t&&(a.justification=t),this._policyTipProvider.updatePolicy(a).then(function(e){n._storeContents.policyTipInfo.actionResult=e,n._sharingInformationInvalidated=!0,n.fetchSharingInformation(!0),n._emitChange()})}},e.prototype.checkUserAccess=function(e){var t=this,n=new A.e({name:"Sharing.checkUserAccessAPI"});if(0!==e.length){for(var a=[],r=0,o=e;r<o.length;r++){var s=o[r];a.push(s)}return this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var a=function(e){var n=t._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.loginName===e.inputEntity})[0],a=t._storeContents.sharingInformation.sharingPrincipals.filter(function(e){return e.role===l.e.owner}).length>=1;if(Object(L.r)(e.role,n.role)){var i=a&&e.role===l.e.owner?n.role:e.role,r={id:e.inputEntity,role:i,isSPO:!0,rawPermission:{shareId:e.inputEntity}};n.role=i,n.accessMap.set(r.id,r),n.hasGSIAndCheckAccessPerms=!0}},i=0,r=e;i<r.length;i++)a(r[i]);n.end({resultType:A.t.Success})}).catch(function(e){t._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},t._storeContents.sharingInformation),{error:e,errorMessage:O.Oe}),n.end({resultType:A.t.Failure,extraData:e})})}},e.prototype.checkPermissions=function(e,t){var n=this;if(0===e.length)return this._storeContents.permissionsMap={},void this._emitChange();var a=[];this._recipients=[];for(var i=0,r=e;i<r.length;i++){var o=r[i];a.push({alias:E.t.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email}),this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers,this._invitedUsers=[];for(var s=0,c=t;s<c.length;s++){var d=c[s];a.push({alias:d.email}),this._invitedUsers.push(d.email)}var l=a.map(function(e){return e.alias});this._sharingProvider.checkPermissions(a,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,a=e;t<a.length;t++){var i=a[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?_.e.hasAccess:_.e.pending:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?_.e.hasAccess:_.e.none)}n._emitChange()})},e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap},e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients},e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}},e.prototype.grantAccess=function(e,t){var n=this;void 0===t&&(t=!0);var a=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});a=this._dedupeRecipients(a);var r={items:[this._item],roleValue:this._getRoleValue(t),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(a,r,!0).done(function(e){n._storeContents=Object(i.e)(Object(i.e)({},n._storeContents),{grantAccessResult:0===e.statusCode}),n._emitChange()})},e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult},e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated},e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients},e.prototype.setAddressBarLinkCapability=function(e){var t=this;return this._sharingProvider.setAddressBarLinkCapability(this._item,e).done(function(e){e&&t.fetchSharingInformation(!0,!0)})},e.prototype._addPrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.loginName||a.email;this._storeContents.filteredPrincipals[i]||(this._storeContents.filteredPrincipals[i]=a)}},e.prototype._removePrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.loginName||a.email;this._removePrincipalById(i)}},e.prototype._removePrincipalById=function(e){this._storeContents.filteredPrincipals[e]&&delete this._storeContents.filteredPrincipals[e]},e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1},e.prototype.resetPeoplePickerError=function(){this._storeContents.sharingInformation.peoplePickerError&&(this._storeContents.sharingInformation.peoplePickerError=void 0,this._emitChange())},e.prototype.getSharingClickTime=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.clickTime},e.prototype.isPasswordModificationAllowed=function(){return!0},e.prototype.isExpirationDateModificationAllowed=function(){return!0},e.prototype.isPremiumExperienceAllowed=function(){return!0},e.prototype.isReportProblemSupported=function(){return!1},e.prototype.shouldInterruptCopyLink=function(e){return new I.t(function(e,t){e(!1)})},e.prototype.isPreventDownloadAllowed=function(){return!0},e.prototype.isBundleShare=function(){return!1},e.prototype.getSupportedAudienceOptions=function(){return[o.e.anyone,o.e.customLabeledSpecificPeople,o.e.existing,o.e.organization,o.e.specificPeople,o.e.specificPeopleFlex]},e.prototype.isOwner=function(){return this._storeContents.sharingInformation.userRole===l.e.owner},e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1},e.prototype.showAudienceLearnMore=function(){return!0},e.prototype.showEmailsInSuggestions=function(){return!1},e.prototype.getFamily=function(){return null},e.prototype.getFamilyMembers=function(){return null},e.prototype.getCurrentUserId=function(){return null},e.prototype.isShared=function(){return this.getSharingInformation().isShared},e.prototype.getSharedObjectType=function(){return this.getSharingInformation().sharedObjectType},e.prototype.getItemInformationForLogging=function(){var e,t,n=!0,a=this.getSharingInformation();return a.fileExtension?(this._itemType=Object(H.e)(a.fileExtension),e=a.fileExtension):a.sharedObjectType?this._itemType=U.e[a.sharedObjectType]:a.item&&(this._itemType=Object(H.t)(a.item),e=a.item.extension,n=a.item.itemType===F.e.File),n&&this._itemType&&"other"!==this._itemType&&(t=e),{itemType:this._itemType,extension:t}},e.prototype.getSharingInformationAPIStats=function(){return this._getSharingInformationStats},e.prototype.getShareLinkAPIStats=function(){return this._getShareLinkStats},e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;e&&(this.unshareLink(e.sharingLinkKind,e.shareId),this._storeContents.defaultLink=void 0)},e.prototype._emitChange=function(e){if(this._storeContents&&this._storeContents.sharingInformation){var t=this._storeContents.sharingInformation,n=this.getItemInformationForLogging(),a=n.itemType,i=n.extension;this._engagementHelper.setEngagementExtraData({webTemplateId:t.webTemplateId,itemUniqueId:t.itemUniqueId,itemType:a,extension:i})}for(var r=0,o=this._listeners;r<o.length;r++)(0,o[r])(e)},e.prototype._studyEmitChangeUsage=function(e){new A.e({name:"emitChangeInvestigation"}).end({resultType:A.t.Success,extraData:Object(i.e)({emitChangePath:e},this._telemetryExtraData)})},e.prototype.getPermissionsViewSettings=function(){return{groupPivotHeader:w.k,manageGroupLink:"",itemStopSharingSupported:!0,supportedGroupTypes:[y.e.securityGroup,y.e.sharePointGroup]}},e.prototype.init3s=function(){this._fetchSubstrateToken()},e.prototype._fetchGraphToken=function(){var e=this,t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n,e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1},e.prototype._fetchSubstrateToken=function(){var e=this,t=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t?this._substratePeoplePickerHelper.getSubstrateToken().then(function(n){e._substratePeoplePickerHelper.init(n),t=!!n,e._storeContents.sharingInformation.isTsAvailable=t}):this._storeContents.sharingInformation.isTsAvailable=!1},e.prototype._fetchAdditionalAuthenticationTokens=function(){this._storeContents.sharingInformation&&(this._fetchGraphToken(),this._fetchSubstrateToken())},e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;var n=new K.e(e.url);this._sharingContextInformation&&this._sharingContextInformation.navId&&this._sharingContextInformation.optInSendNavIdInShareLink&&!n.getQueryParameter("nav")&&!R.t()&&(n.setQueryParameter("nav",this._sharingContextInformation.navId),e.url=n.toString()),this._sharingInformationInvalidated=!0,this.fetchSharingInformation(!0),this._storeContents.sharingLinkCreated=e,this._updateIsShared(),this._studyEmitChangeUsage("handleSharedLink"),this._emitChange({type:m.t.ShareLink})},e.prototype._getRoleValue=function(e){return e?b.e:b.a},e.prototype._getRoleString=function(e){return e===l.e.review?"roletype:Reviewer":e===l.e.edit?b.e:e===l.e.owner?b.n:e===l.e.manageList?b.t:b.a},e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===r.e.copy){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}},e.prototype._removeLinkByShareId=function(e){var t=this;this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(n){return e===n.shareId&&(n.expiration=null,n.isActive=!1,n.shareId=D.e.Empty,n.url=null,t._removePrincipals(n.principals),t._removePrincipals(n.invitees),n.principals=[]),n})},e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){var t=e.sharingLinks,n=e.sharingPrincipals,a=Object(g.e)(t,n);this._storeContents.sharingInformation.isShared=a}},e.prototype._getOwaUrl=function(e,t){var n,a,i="https://outlook.office.com/owa/",r=null===(a=null===(n=this._storeContents)||void 0===n?void 0:n.sharingInformation)||void 0===a?void 0:a.outlookEndpointHostUrl;r&&(i="https://".concat(r,"/owa/"));var o=encodeURIComponent(t);return"".concat(i,"?body=").concat(o,"&to=").concat(e.join(";"),"&path=/mail/action/compose")},e.prototype._resolveDefaultRecipients=function(e,t,n){var a=this,o=e||[],s=I.t.resolve();if(this._storeContents.isValidatingDefaultRecipients=e.length>0,!t){o=[];for(var c=[],d=0,l=e;d<l.length;d++){var u=l[d];c.push({alias:u})}s=this._sharingProvider.checkPermissions(c,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a.hasAccess||o.push(a.inputEntity)}})}s.then(function(){if(0!==o.length){for(var e=[],t=[],s={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},c=0,d=o;c<d.length;c++){var l=d[c];e.push(a._peoplePickerProvider.resolve(l,s).then(function(e){t.push(e)}))}I.t.all(e).then(function(){a._storeContents.defaultRecipients={isConsumed:!1,recipients:t},a._storeContents.isValidatingDefaultRecipients=!1,a._studyEmitChangeUsage("resolveDefaultRecipients1"),a._emitChange()},function(){a._storeContents.defaultRecipients={isConsumed:!1,recipients:[]},a._storeContents.isValidatingDefaultRecipients=!1,a._emitChange()})}else n===r.e.atMention&&(a._storeContents=Object(i.e)(Object(i.e)({},a._storeContents),{grantAccessResult:!0}),a._studyEmitChangeUsage("resolveDefaultRecipients0"),a._emitChange())})},e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],a=0,i=t[1].split("&");a<i.length;a++){var r=i[a];-1===r.indexOf("email=")&&n.push(r)}var o=n.join("&");return"".concat(t[0],"?").concat(o)}return e},e.prototype._shareLink=function(e,t,n,a,c,u,_,h){var b=this;Object(B.r)("sharelink._shareLink.start");var g={emailData:n,emailSubject:a,items:[this._item],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:_,inviteesToRemove:h,role:e.sharingRole}};g.settings.role||(g.settings.role=e.isEdit?l.e.edit:l.e.view),e.shareId&&e.shareId.length>0&&(g.settings.shareId=e.shareId,e.fetchLinkOnly&&(g.settings.createLink=!1));var v=(new Date).getTime(),y=new A.e({name:"SharingShareLink.".concat(r.e[this._mode],".").concat(f.e[this._clientId]||"unknown")});this._getShareLinkStats={name:"ShareLinkInit",resultType:A.t.Success,duration:0},(e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===o.e.anyone&&(g.settings.sharingLinkKind=s.e.flexible,g.settings.allowAnonymousAccess=!0),e.audience===o.e.anyone?e.trackLinkUsers?(g.settings.allowAnonymousAccess=!1,g.settings.restrictShareMembership=!1,g.settings.trackLinkUsers=!0,g.settings.scope=p.e.anyone,g.settings.sharingLinkKind=s.e.flexible):(g.settings.allowAnonymousAccess=!0,g.settings.restrictShareMembership=!1,g.settings.trackLinkUsers=!1,g.settings.scope=p.e.anyone):e.audience===o.e.organization&&(g.settings.allowAnonymousAccess=!1,g.settings.restrictShareMembership=!1,g.settings.scope=p.e.organization),e.preventDownload&&(g.settings.role=l.e.restrictedview,e.sharingRole=l.e.restrictedview,g.settings.sharingLinkKind=s.e.flexible),e.audience!==o.e.specificPeopleFlex&&e.audience!==o.e.customLabeledSpecificPeople||(g.settings.restrictShareMembership=!0,g.settings.scope=p.e.specificPeople);var S=this.getDefaultRecipients();if(e.audience===o.e.customLabeledSpecificPeople&&S&&(g.recipients=S.recipients),e.isCreateOnlyLink&&(g.settings.role=l.e.submit,g.settings.description=e.description),this._sharingContextInformation&&this._sharingContextInformation.navId&&this._sharingContextInformation.optInSendNavIdInShareLink&&(!Object(G.t)(this._sharingContextInformation.navId)||this._sharingContextInformation.navId.length>1024))return this._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},this._storeContents.sharingInformation),{error:d.t.invalidItem,errorCategory:d.e.shareLink,errorMessage:O.ra}),y.end({resultType:A.t.Failure}),this._getShareLinkStats={name:"ShareLink",resultType:A.t.Failure,duration:(new Date).getTime()-v,error:d.t.invalidItem},this._invokeShareStatsEvent(this._getShareLinkStats),void this._emitChange({type:m.t.ShareLink});this._sharingProvider.shareLink(g).done(function(t){if(Object(B.r)("sharelink._shareLink.end"),t.error){var n=t.error;b._storeContents.sharingInformation=Object(i.e)(Object(i.e)({},b._storeContents.sharingInformation),{error:n,errorCategory:d.e.shareLink,debugErrorMessage:n.message&&n.message.value,errorMessage:O.sn});try{429===n.status&&(b._storeContents.sharingInformation.errorMessage=O.Lo)}catch(e){}return y.end({resultType:A.t.Failure}),b._getShareLinkStats={name:"ShareLink",resultType:A.t.Failure,duration:(new Date).getTime()-v,error:t.error},b._invokeShareStatsEvent(b._getShareLinkStats),void b._emitChange({type:m.t.ShareLink})}y.end({resultType:A.t.Success}),b._getShareLinkStats={name:"ShareLink",resultType:A.t.Success,duration:(new Date).getTime()-v},b._invokeShareStatsEvent(b._getShareLinkStats);var a=t.link;e.audience===o.e.customLabeledSpecificPeople&&(a.audience=o.e.customLabeledSpecificPeople),a.sharingLinkKind===b._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&u&&c&&0===b._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===a.shareId}).length&&(b._storeContents.defaultLink=a),_?(h&&b._removePrincipals(h),b._sharingInformationInvalidated=!0,b.fetchSharingInformation(!0),b._emitChange({type:m.t.ShareLink})):b._handleSharedLink(a,c)})},e.prototype._invokeShareStatsEvent=function(e){var t=new A.e,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var a={mode:r.e[this._mode],clientId:f.e[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:a})},e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},e.prototype._getDefaultLink=function(){var e,t,n=this,a=new A.e({name:"SharingGetDefaultLink"}),i=this._sharingContextInformation.itemUrl;if(!i&&this._sharingContextInformation.serverRelativeItemUrl){var r=new M.e(this._sharingContextInformation.webAbsoluteUrl);i="".concat(r.authority).concat(this._sharingContextInformation.serverRelativeItemUrl)}var o=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(o=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));var s=this._sharingContextInformation.uniqueId;s||(s=null===(t=null===(e=this._storeContents)||void 0===e?void 0:e.sharingInformation)||void 0===t?void 0:t.itemUniqueId);var c=this._permissions?I.t.resolve(this._permissions):s?this._sharingService.getDefaultLinkByUniqueId(s||"",o,!0):this._sharingService.getDefaultLink(i,o,!0);Object(B.r)("sharelink.getDefaultLink.start"),c.then(function(e){Object(B.r)("sharelink.getDefaultLink.end");var t=e[0],i=t.link,r=t.roles&&t.roles.indexOf("write")>=0;a.end({resultType:A.t.Success});var o=Object(L.w)(i.scope),s=Object(L.L)(o);n._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:o,expiration:t.expirationDateTime,isActive:!0,isEdit:r,principals:[],shareId:t.id,sharingLinkKind:Object(L.E)(i.scope,r),sharingScope:s,url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(e){a.end({resultType:A.t.Failure,extraData:{error:e}});var t="";try{t=JSON.stringify(e)}catch(e){}n._storeContents.sharingInformation={error:e,errorCategory:d.e.invite,errorMessage:O.sn,debugErrorMessage:t,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0},n._emitChange()})},e.prototype._dedupeRecipients=function(e){var t=[],n={};return e.forEach(function(e){n[e.userId]=e}),Object.keys(n).forEach(function(e){t.push(n[e])}),t},e.prototype._raceGSI=function(e,t,n){var a=this,i=this._sharingProvider.getSharingInformation(this._item,e,!0,null,t),r=this._prefetchGSI;I.t.race([r,i]).then(function(e){a._setGSIResponse(e,n)},function(e){a._setGSIError(e,n)})},e.prototype._checkPrefetchSupportExpansion=function(e,t){var n=window.g_expand;return!(!n||n.length<1||n.indexOf("pickerSettings")<0||n.indexOf("sharingLinkTemplates")<0||e&&n.indexOf("permissionsInformation")<0||t&&n.indexOf("addressBarLinkSettings")<0)},e.prototype._setGSIResponse=function(e,t){this._getSharingInformationStats={name:"GetSharingInformation",resultType:A.t.Success,duration:(new Date).getTime()-t,GSIsource:e.getSharingInformationSources},this._storeContents.sharingInformation&&this._storeContents.sharingInformation.error||(this._storeContents.sharingInformation=e,R.T()&&N.i()&&void 0!==this.getSharingInformation()&&this.parsePermissions(),this._fetchAdditionalAuthenticationTokens(),this.fetchPolicyTipInformation(),this._configureLinkIfShareId(),Object(k.e)(e.userPhotoCdnBaseUrl),this._emitChange({type:m.t.FetchSharingInformation}))},e.prototype._setGSIError=function(e,t){var n=Object(j.t)(null,j.e.api,e);this._getSharingInformationStats={name:"GetSharingInformation",resultType:A.t.Failure,duration:(new Date).getTime()-t,error:n.error},this._invokeShareStatsEvent(),this._storeContents.sharingInformation=n,this._emitChange({type:m.t.FetchSharingInformation})},e.prototype._updateAccessMap=function(e,t){var n=this._storeContents.sharingInformation.sharingPrincipals;this._storeContents.sharingInformation.sharingPrincipals=n.map(function(n){var a,r,o;return(null===(a=n.accessMap)||void 0===a?void 0:a.get(e))&&(null===(r=n.accessMap)||void 0===r||r.set(e,Object(i.e)(Object(i.e)({},null===(o=n.accessMap)||void 0===o?void 0:o.get(e)),{role:t}))),n})},e}();t.e=W},,,function(e,t,n){"use strict";var a;!function(e){e[e.share=0]="share",e[e.copy=1]="copy",e[e.outlook=2]="outlook",e[e.nonOutlook=3]="nonOutlook",e[e.moreApps=4]="moreApps",e[e.mobileShareToTeams=5]="mobileShareToTeams",e[e.webShareToTeams=6]="webShareToTeams"}(a||(a={})),t.e=a}].concat(Array(32),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0);function i(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}function r(e,t,n){var r="",o=!0;for(var s in t&&(e=Object(a.e)(Object(a.e)({},t),e)),e){var c,d=e[s];if(!n||"object"!=typeof d&&d||"object"==typeof d&&d&&d.uriValue||"number"==typeof d||"boolean"==typeof d)o?o=!1:r+="&",c="object"==typeof d&&d&&d.uriValue?d.uriValue:i("".concat(d)),r+="".concat(s,"=").concat(c)}return r}},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(170),i=function(){function e(){this._initialized=!1,this._ignoreSWOffline=!1}return e.prototype.onChange=function(e){var t=this;return this._ensureInitialized(),this._listeners.push(e),function(){var n=t._listeners.indexOf(e);-1!==n&&t._listeners.splice(n,1)}},e.prototype.dispose=function(){this._events.dispose()},Object.defineProperty(e.prototype,"offline",{get:function(){return this._ignoreSWOffline?!navigator.onLine:!navigator.onLine||this._swOffline()},enumerable:!1,configurable:!0}),e.prototype._ensureInitialized=function(){this._initialized||(this._initialized=!0,this._listeners=[],this._events=new a.e(window),this._events.on(window,"online",this._onStateChange.bind(this,"online")),this._events.on(window,"offline",this._onStateChange.bind(this,"offline")),this._events.on(window,"swonline",this._onStateChange.bind(this,"swonline")),this._events.on(window,"swoffline",this._onStateChange.bind(this,"swoffline")))},e.prototype._onStateChange=function(e){this._swOffline()&&"online"===e&&(this._ignoreSWOffline=!0);var t=this.offline;this._listeners&&this._listeners.forEach(function(e){try{e(t)}catch(e){}})},e.prototype._swOffline=function(){return!(!window.__swstats||void 0===window.__swstats.offline)&&window.__swstats.offline},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={none:1,pending:2,hasAccess:3}}],Array(26),[function(e,t,n){"use strict";var a=n(138),i=function(e,t){this.width=0,this.height=0,this.width=e,this.height=t},r=function(){function e(t,n,i,r){if(this.x=0,this.y=0,this.width=0,this.height=0,0===arguments.length)this.x=0,this.y=0,this.width=0,this.height=0;else if(t instanceof e){var o=t;this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height}else if(t instanceof a.e){var s=t,c=n;this.x=s.x,this.y=s.y,this.width=c.width,this.height=c.height}else if("object"==typeof t&&"number"==typeof t.left&&"number"==typeof t.top&&"number"==typeof t.width&&"number"==typeof t.height){var d=t;this.x=d.left,this.y=d.top,this.width=d.width,this.height=d.height}else this.x=t,this.y=n,this.width=i,this.height=r}return e.prototype.clip=function(t){var n=new e(this);return n.x<t.x&&(n.width-=t.x-n.x,n.x=t.x),n.getRight()>t.getRight()&&(n.width-=n.getRight()-t.getRight()),n.y<t.y&&(n.height-=t.y-n.y,n.y=t.y),n.getBottom()>t.getBottom()&&(n.height-=n.getBottom()-t.getBottom()),n},e.prototype.contains=function(e){if(e instanceof a.e){var t=e;return t.x>=this.x&&t.y>=this.y&&t.x<=this.getRight()&&t.y<=this.getBottom()}var n=e,i=n.getPoint(),r=new a.e(n.getRight(),n.getBottom());return this.contains(i)&&this.contains(r)},e.prototype.getCenter=function(){return new a.e(this.x+this.width/2,this.y+this.height/2)},e.prototype.getLeft=function(){return this.x},e.prototype.getTop=function(){return this.y},e.prototype.getRight=function(){return this.x+this.width},e.prototype.getBottom=function(){return this.y+this.height},e.prototype.getPoint=function(){return new a.e(this.x,this.y)},e.prototype.getSize=function(){return new i(this.width,this.height)},e.prototype.inflate=function(t,n){var a,i;if("object"==typeof t){var r=t;a=r.width,i=r.height}else a=t,i=n;return new e(this.x-a/2,this.y-i/2,this.width+a,this.height+i)},e.prototype.nudge=function(t){var n=new e(this);return n.x<t.x?n.x=t.x:n.getRight()>t.getRight()&&(n.x=t.getRight()-n.width),n.y<t.y?n.y=t.y:n.getBottom()>t.getBottom()&&(n.y=t.getBottom()-n.height),n},e.prototype.translate=function(t,n){var i;if(t instanceof a.e){var r=t;i=this.translate(r.x,r.y)}else{var o=t,s=n;i=new e(this.x+o,this.y+s,this.width,this.height)}return i},e.prototype.union=function(t){var n=Math.min(this.x,t.x),a=Math.min(this.y,t.y);return new e(n,a,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-a)},e.prototype.fit=function(t,n){var a=t;a=this.width&&this.height&&(n?this.width>a.width||this.height>a.height:this.width>a.width&&this.height>a.height)?this._scaleTo(t,n):this;var i=(t.width-a.width)/2,r=(t.height-a.height)/2;return new e(i+this.x,r+this.y,a.width,a.height)},e.prototype._scaleTo=function(t,n){var a=t.width/t.height,i=this.width/this.height,r=0,o=0;return(n?i:a)<(n?a:i)?(o=t.height,r=i*t.height):(r=t.width,o=t.width/i),new e(this.x,this.y,r,o)},e}();t.e=r},,,function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l});var a=n(0),i=n(136),r=n(8),o=n(28),s=n(66),c=n(155),d="Missing Perf Goal",l=function(e){function t(t){var n=e.call(this,t)||this;return(null==t?void 0:t.perfGoalInMs)&&n.setTimeout(null==t?void 0:t.perfGoalInMs,{resultType:o.e.Failure,errorCode:d}),n}return Object(a.a)(t,e),t.prototype.end=function(t){return t&&t.extraData&&this.data.extraData&&(t=Object(a.e)(Object(a.e)({},t),{extraData:Object(a.e)(Object(a.e)({},this.data.extraData),t.extraData)})),t&&t.errorCode!==d&&(t=this._assessPerf(t)),e.prototype.end.call(this,t)},t.prototype._assessPerf=function(e){if(!this.endTime){var t=e.perfGoalInMs||this.data.perfGoalInMs;t&&e.resultType!==o.e.Failure&&t<s.e.getTime()-this.startTime&&(e=Object(a.e)(Object(a.e)({},e),{resultType:o.e.Failure,errorCode:d,extraData:e.errorCode?Object(a.e)(Object(a.e)({},e.extraData),{innerErrorCode:e.errorCode}):void 0}))}return e},t}(Object(i.e)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise"},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:r.e.String},errorCode:{isPrefixingDisabled:!0,type:r.e.String},resultType:{typeRef:o.e,isPrefixingDisabled:!0,type:r.e.Enum},resultCategory:{isPrefixingDisabled:!0,type:r.e.String},extraData:r.e.Object,httpStatus:{isPrefixingDisabled:!0,type:r.e.Number},perfGoalInMs:{isPrefixingDisabled:!0,type:r.e.Number},duration:{isPrefixingDisabled:!0,type:r.e.Number},pillar:{isPrefixingDisabled:!0,type:r.e.String},veto:{isPrefixingDisabled:!0,type:r.e.String}})).withManager(Object(c.e)())},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return $e});var a=n(0),i=n(13);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:active){.od-Share{border:3px solid}}.od-Share{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';border-radius:2px;min-height:130px}.od-Share.od-SimplifiedShare{border-radius:8px}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Share.od-Share--permissionsPivot{overflow:unset!important}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"linkHovered",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:'}.od-Share .od-Share-noFocusBorder:focus{outline:0;border:none}.od-Share .ms-Button--default{outline:transparent;position:relative}.od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button--default:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{content:"";position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b;color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c;color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939;color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e;color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}.od-Share .ms-Spinner{position:absolute;top:50%;left:50%}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share .ms-Button{overflow:visible}}#od-Share-backButton-tooltip{position:relative}button.od-Share-backButton{z-index:1;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:inherit;left:inherit}button.od-Share-backButton#od-ShareToTeams-backButton{top:-40px}[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}button.od-Share-backButton.absolute{position:absolute;top:8px}[dir=ltr] button.od-Share-backButton.absolute{left:8px}[dir=rtl] button.od-Share-backButton.absolute{right:8px}button.od-Share-backButton.priorView{top:14px}[dir=ltr] button.od-Share-backButton.priorView{left:16px}[dir=rtl] button.od-Share-backButton.priorView{right:16px}.od-Share-shareMainDiv{position:relative}.od-Share-spinnerHolder{align-items:center;display:flex;height:130px;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{box-shadow:0 2px 2px 0 rgba(37,36,36,.15);border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary{box-shadow:0 2px 2px 0 rgba(98,100,167,.4)}.teams .ms-Button--primary.is-disabled{box-shadow:none;border:none}.SendLink-statusIconItem{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .SendLink-statusIconItem{margin-left:4px}[dir=rtl] .SendLink-statusIconItem{margin-right:4px}[dir=ltr] .SendLink-statusIconItem{margin-right:4px}[dir=rtl] .SendLink-statusIconItem{margin-left:4px}.SendLink-statusIconItem .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconItem .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.SendLink-statusIconTooltip{font-size:.875rem}.SendLink-statusIcon{font-size:.625rem;width:2.75px;height:2.75px}"}]);var r,o=n(176),s=n(177),c=n(334),d=n(205),l=n(56),u=n(6),f=n(462),p=n(370),m=n(226),_=n(382),h=n(393),b=n(494),g=n(106),v=n("react-lib"),y=n("prop-types-lib"),S=n(46),D=n(24),I=n(15),x=n(488),C=n(215),O=n(418),w=n(10),E=n(26),A=n(1),L=n(77),k=n(23),M=n(65),P=n(14),T=n(59);!function(e){e[e.Family=0]="Family",e[e.FamilyMember=1]="FamilyMember"}(r||(r={}));var U=n(39),F=n(71),H=n(5),R=n(30),N=n(146),B=n(48),j=n(190),V=n(88),z=n(50),G=n(97),K=n(140),W=n(402),q=n(234),Q=n(103),Y=n(4),J=n(43),X=function(e){function t(t,n){var a=e.call(this,t)||this;return a._initialLinkShown=!1,a._onLinkSettingsCancelClick=function(){a.setState({shouldCopyLinkToClipboard:!1},function(){a.props.onLinkPermissionsCancelClicked()})},a._onLinkSettingsApplyClicked=function(e){a.setState({shouldCopyLinkToClipboard:!0},function(){a.props.onLinkPermissionsApplyClicked(e)})},a._shareClickTime=n.shareClickTime,a._sharingClientMessenger=n.sharingClientMessenger,a.state={shouldCopyLinkToClipboard:!0},a}return Object(a.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.sharingInformation,n=e.viewState,i=e.clientId,r=e.companyName,o=e.currentSettings,s=e.onShareHintClick,l=e.customLabeledAudienceConfig,u=e.displayUrl;switch(n){case Y.e.linkSuccess:var f={clientId:i,companyName:r,currentSettings:o,sharingInformation:t,onShareHintClick:s,linkRecipients:null,customLabeledAudienceConfig:l};return this._initialLinkShown||(this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():k.h(this._shareClickTime,this.props.clientId,d.e.copy,this.props.scenarioId,this.props.correlationId),this._initialLinkShown=!0),v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.c,Object(a.e)({},Object(V.e)(this.props),{shareType:c.e.copy,itemName:t.item.name,linkUrl:u,sharingHintProps:f,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this.props.engagementExtraData,onRenderComplete:this.props.onShareNotificationRenderComplete,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId})));case Y.e.modifyPermissions:return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.i,Object(a.e)({},this.props,{doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,showExistingAccessOption:!0,copyLinkShortcut:!0,onSelectedPeopleChange:function(){}})));default:return v.createElement("div",{className:"od-Share-spinnerHolder"},v.createElement(b.e,{className:"od-Share-spinner",label:A.Le,type:g.t.large}))}},t.contextTypes={shareClickTime:y.number,sharingClientMessenger:y.object.isRequired},t}(v.Component),Z=n(18),$=n(70),ee=n(210),te=n(195),ne=n(167),ae=n(32);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.ShareMain{display:flex;flex-direction:column;padding:24px}@media screen and (max-width:511px){.ShareMain{padding:16px}}.ShareMain-flex-row{width:100%;display:flex;flex-direction:row;align-items:center}.ShareMain-flex-row.space-between{justify-content:space-between}.ShareMain-flex-grow{display:flex;flex-grow:1}.ShareMain-flex-grow.flex-start{justify-content:flex-start}.ShareMain-action-footer{display:flex;flex-direction:row}.ShareMain-action-footer.flex-end{justify-content:flex-end}.ShareMain-sharedWithSection{width:50%}@media screen and (max-width:375px){.ShareMain-sharedWithSection{width:40%}}@media screen and (max-width:360px){.ShareMain-sharedWithSection{width:30%}}.ShareMain-notShared i{font-size:.9375rem;height:1.625rem;width:1.625rem;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:50%;text-align:center;color:#707070;line-height:1.625rem}.ms-ContextualMenu-linkContent i{display:inline-flex}.ShareMain-button i{font-size:.875rem}.ms-Tooltip-subtext{font-size:.75rem}.ShareMain-header{padding-bottom:10px}.SimplifiedShareTargets.ie .ms-ContextualMenu-linkContent i{display:inline}"}]);var ie=n(318),re=n(35),oe=n(109),se=n(282),ce=n(489);Object(i.t)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.SendLink-flex-column{display:flex;flex-direction:column;width:100%}.SendLink-flex-row{display:flex;flex-direction:row;width:100%}.SendLink-container{display:flex;flex-direction:column}.SendLink-messageBox{position:relative;padding-top:12px}.SendLink-messageBox-textfield{width:100%}.SendLink-messageBox-textfield .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}.SendLink-field{font-size:.875rem!important;padding:10px 8px 6px 35px!important}.SendLink-fieldGroup{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"!important;border-bottom:unset!important;border-radius:4px!important;height:93px!important;overflow:hidden!important}.SendLink-fieldGroup:after{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"!important;border-width:1px!important;border-bottom:unset!important;border-radius:4px!important}.SendLink-fieldGroup:hover{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"!important;border-bottom:unset!important;border-radius:4px!important}.SendLink-fieldGroup-error{border:1px solid "},{theme:"red",defaultValue:"#e81123"},{rawString:"!important;border-bottom:unset!important;border-radius:4px!important;height:80px!important;overflow:hidden!important}.SendLink-fieldGroup-error:after{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"!important;border-width:1px!important;border-bottom:unset!important;border-radius:4px!important}.SendLink-fieldGroup-error:hover{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"!important;border-bottom:unset!important;border-radius:4px!important}.SendLink-people-picker{max-height:126px;overflow-x:hidden;overflow-y:auto;display:flex;flex-direction:column-reverse;flex-grow:1}.SendLink-permissions-button-container{display:flex}.SendLink-permissions-button:hover{background-color:transparent}.SendLink-relative{position:relative;width:100%}.SendLink-border{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:4px;box-sizing:border-box;position:relative;width:100%}.SendLink-to{font-size:.875rem;font-weight:600;padding:12px 6px 12px 12px;white-space:nowrap;display:flex}.SendLink-to .SendLink-to-icon{font-size:.75rem}[dir=ltr] .SendLink-to .SendLink-to-icon{padding-right:4px}[dir=rtl] .SendLink-to .SendLink-to-icon{padding-left:4px}[dir=ltr] .SendLink-to .SendLink-to-icon{padding-left:1px}[dir=rtl] .SendLink-to .SendLink-to-icon{padding-right:1px}.SendLink-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;padding-bottom:10px;flex-grow:1;margin-top:6px}.SendLink-label:focus-visible{outline:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}.SendLink-animation{box-sizing:border-box;border-bottom-left-radius:200px;border-bottom-right-radius:200px;border-bottom-width:2px;border-bottom-style:solid;box-sizing:border-box;-webkit-clip-path:inset(calc(100% - 2px) 0px 0px);clip-path:inset(calc(100% - 2px) 0px 0px);animation-name:animate-underline;animation-duration:.25s;width:100%;position:absolute;height:4px;z-index:1;bottom:0}@keyframes animate-underline{from{transform:scaleX(0)}to{transform:scaleX(1);transition-property:transform;transition-duration:.2s;transition-delay:cubic-bezier(0.1, 0.9, 0.2, 1)}}.SendLink-underline{box-sizing:border-box;border-bottom:1px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";border-bottom-left-radius:200px;border-bottom-right-radius:200px;box-sizing:border-box;-webkit-clip-path:inset(calc(100% - 2px) 0px 0px);clip-path:inset(calc(100% - 2px) 0px 0px);width:100%;position:absolute;height:4px;bottom:0}.SendLink-underline.focused{border-bottom:2px solid "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.SendLink-roleSelector-divider{display:flex;background-color:#d1d1d1;width:1px;margin-top:3px;margin-bottom:3px}.SendLink-primary{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.SendLink-warning{border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.SendLink-error{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-composeIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.SendLink-icon{padding-left:13px;padding-top:13px;position:absolute;top:0;left:0;bottom:unset;right:unset;font-size:.875rem}.SendLink-primary{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.SendLink-warning{border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.SendLink-error{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-max-height{max-height:126px}.SendLink-characterContainer{visibility:hidden}.SendLink-characterContainer.visible{visibility:visible}.SendLink-characterCount{margin-top:6px;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.SendLink-characterCount.error{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.SendLink-label-and-count-container{display:flex;flex-direction:row}"}]);var de=n(213),le=n(186),ue=n(241);function fe(e,t){var n=e.clientId,a=e.currentSettings,i=e.engagementExtraData,r=e.errorMessage,o=e.groupsMemberCount,s=e.linkRecipients,c=e.messageText,l=(e.summaryText,e.permissionsMap),u=e.permissionsLabel,f=e.sharingInformation,p=e.onInputChange,m=e.onRoleChange,h=e.onSelectedPeopleChange,b=e.onSendLinkMessageChange,g=e.getStatusIcons,y=(e.showItemInsights,t.sharingStore),D=t.platformDetection,I=v.useState(!1),x=I[0],C=I[1],O=v.useState(!1),E=O[0],L=O[1],k=v.useState(0),M=k[0],P=k[1],T=v.useRef(null),U=S.n(s),F=S.a(s,o),H=v.useMemo(function(){return De(a,r)},[r,a,s]),R=v.useMemo(function(){return Object(w.p)(c)},[c]);v.useEffect(function(){r&&C(!0)},[r]);var N=Object(oe.e)(function(e){return Se(e,y,i)}),B=Object(oe.e)(function(e){return ge(b,e)}),j=!E&&R>pe;return v.createElement("div",{className:"SendLink-container"},v.createElement("div",{ref:T,className:"SendLink-flex-column SendLink-relative SendLink-max-height",style:{height:D.isIE&&M,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},v.createElement("div",{className:"SendLink-flex-row SendLink-border  SendLink-max-height",style:{height:D.isIE&&M,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},v.createElement("div",{className:"SendLink-to"},v.createElement(_.e,{content:A.h},v.createElement(ie.e,{"aria-label":A.h,iconName:"Contact",className:"SendLink-to-icon"}))),v.createElement("div",{className:"SendLink-people-picker ".concat(D.isIE&&" IE"," SendLink-max-height"),style:{height:D.isIE&&M,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}},v.createElement(de.e,{clientId:n,defaultSelectedItems:s,disableGraph:y.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:0===s.length?A.h:A.g,oversharingExternalsWarning:U,oversharingGroupsWarning:F,peoplePickerRef:T,permissionsMap:l,pickerSettings:f.peoplePickerSettings,sharingInformation:f,sharingLinkKind:a.sharingLinkKind,onChange:h,onInputChange:p||null,onResolvedSuggestions:N,setPeoplePickerFocused:C,error:r,mode:d.e.share,setHeight:P,height:M})),be(a)&&v.createElement(v.Fragment,null,v.createElement("div",{className:"SendLink-roleSelector-divider"}),v.createElement("div",{className:"SendLink-permissions-button-container"},v.createElement(le.e,{ariaLabel:A.kn,menuPermissionOptions:ve(f,a),sharingRole:a.sharingRole,mode:d.e.share,clientId:n,onRoleChange:m,roleSelectorAs:le.e})))),v.createElement(Ie,{focused:x,color:H,error:!!r})),r&&v.createElement(ue.e,{className:"od-Simplified-Share-PeoplePickerErrorIcon",error:r,iconName:"Error",textColorType:H}),v.createElement("div",{className:"SendLink-messageBox"},v.createElement(ce.e,{className:"SendLink-messageBox-textfield",multiline:!0,resizable:!1,placeholder:A.qn,ariaLabel:A.qn,defaultValue:c,onGetErrorMessage:B,iconProps:he,styles:j?_e:me,onFocus:function(){L(!0)},onBlur:function(){return L(!1)}}),v.createElement(Ie,{focused:E,color:j?"error":"primary",error:j})),v.createElement("div",{className:"SendLink-label-and-count-container"},v.createElement("div",{className:"SendLink-label",tabIndex:0},ye(u,g)),v.createElement(xe,{messageLength:R})))}fe.contextTypes={sharingStore:y.object.isRequired,platformDetection:y.object.isRequired};var pe=500,me={fieldGroup:["SendLink-fieldGroup"],field:["SendLink-field"]},_e={fieldGroup:["SendLink-fieldGroup-error"],field:["SendLink-field"]},he={iconName:"Handwriting",className:"SendLink-composeIcon",styles:{root:["SendLink-icon"]}},be=function(e){return e.audience!==l.e.existing},ge=function(e,t){return e(t),""},ve=function(e,t){return Object(L.t)({sharingInformation:e,audience:t.audience,mode:d.e.share})},ye=function(e,t){return v.createElement("div",{className:"SendLink-permissionsLabelWithStatusIcons"},e,t())},Se=function(e,t,n){return t.getEngagementHelper().peoplePickerLinkedinSuggestions(n,e),e},De=function(e,t){return t?e.audience===l.e.specificPeople||e.audience===l.e.specificPeopleFlex?"error":"warning":"primary"},Ie=function(e){var t=e.focused,n=e.color,a=e.error;return v.createElement(v.Fragment,null,v.createElement("div",{className:t?"SendLink-animation SendLink-".concat(n):void 0}),v.createElement("div",{className:"SendLink-underline ".concat(t&&"focused"," ").concat(a&&"SendLink-".concat(n))}))},xe=function(e){var t=e.messageLength,n=t>pe,a="SendLink-characterCount ".concat(n?"error":"");return v.createElement("div",{className:"SendLink-characterContainer ".concat(t>pe/2&&"visible"," ")},n?v.createElement("span",{"aria-label":A.Ce,role:"alert",className:a},t,"/",pe):v.createElement("span",{className:a},t,"/",pe))},Ce=n(158);Object(i.t)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Footer-button{border-radius:4px!important;min-width:5.9375rem!important;font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif!important;padding-bottom:2px!important}.Footer-button.Footer-button-copy{font-size:.875rem;font-weight:600;margin-right:12px;white-space:nowrap}.Footer-button.Footer-button-copy.enabled{color:'},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";border-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.Footer-button.Footer-button-copy.enabled:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.Footer-button .Footer-button-icon.Footer-button-icon-hidden{visibility:hidden}.Footer-button .Footer-button-label.Footer-button-label-hidden{visibility:hidden}.Footer-button .Footer-send-button-spinner{top:15%;left:50%;right:50%}.Footer-button .Footer-copy-button-spinner{top:15%;left:45%;visibility:hidden}.Footer-button .Footer-copy-button-spinner.Footer-button-spinner-visible{visibility:visible}.Footer-button .Footer-button-text{font-size:.875rem;font-weight:600}.Footer-button .Footer-tooltip{max-width:250px;font-size:.75rem}.Footer-button .Footer-button-send-icon{font-size:1rem}.Footer-button .visible{visibility:visible}.Footer-button .invisible{visibility:hidden}.Footer-button[dir=rtl] .Footer-button-send-icon{transform:scale(-1,1);font-size:1rem}"}]);var Oe=n(309),we=n(93);function Ee(e){var t=Object(oe.e)(function(){e.onShareTargetClicked(c.e.copy),setTimeout(function(){e.setCopyToastStatus(we.e.closed)},3e3)}),n=Object(oe.e)(function(){return e.setCopyToastStatus(we.e.closed)}),a={iconName:"Link",className:"Footer-button-icon"},i="Footer-button-label",r="Footer-copy-button-spinner";e.copyLinkToastStatus===we.e.inProgress&&(a.className+=" Footer-button-icon-hidden",i+=" Footer-button-label-hidden",r+=" Footer-button-spinner-visible");var o=e.isSharingByCopyDisabled||(e.currentSettings.audience===l.e.specificPeople||e.currentSettings.audience===l.e.specificPeopleFlex)&&0===e.linkRecipients.length&&!!e.errorMessage;return v.createElement("div",null,v.createElement(Oe.e,{id:Ae,className:"Footer-button Footer-button-copy ".concat(!o&&" enabled"),iconProps:a,onClick:t,disabled:o},v.createElement("span",{className:i},A.ze),v.createElement(b.e,{className:r,size:g.e.medium})),v.createElement(v.Suspense,{fallback:null},v.createElement(J.p,{target:"#".concat(Ae),onDismiss:n,status:e.copyLinkToastStatus})))}var Ae="copy-button",Le=n(203);function ke(e,t){var n=e.engagementExtraData,a=e.createPeopleSharingLinks,i=e.currentSettings,r=e.errorMessage,o=e.isDisabled,s=e.linkRecipients,c=e.messageText,d=(e.permissionsLabel,e.permissionsMap),l=e.shareType,u=e.sharingInformation,f=e.unresolvedPeoplePickerText,p=e.showSendButtonSpinner,m=e.onSendLinkClicked,h=e.setErrorMessage,y=e.setIsDisabled,S=t.sharingStore;v.useEffect(function(){y(Pe(i,r,s,c,d,u))},[i,r,s,c,d,u]);var D=Object(oe.e)(function(){S.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",n),Te(r,a,i,s,l,f,h)?m(c):y(!0)}),I=p&&!r,x={iconName:"Send",className:"Footer-button-send-icon ".concat(I?"invisible":"visible")},C="".concat(A.Is);return v.createElement(_.e,{id:"Send-button-tooltip-description",content:C,styles:Me,delay:Le.e.long,directionalHint:ae.e.topRightEdge},v.createElement(Oe.e,{primary:!0,className:"Footer-button",iconProps:x,disabled:o,onClick:D,ariaLabel:A.go,"aria-describedby":"Send-button-tooltip-description"},v.createElement("div",{className:"Footer-button-text ".concat(I?"invisible":"visible")},A.go),v.createElement(b.e,{className:"Footer-send-button-spinner ".concat(I?"visible":"invisible"),size:g.e.medium})))}ke.contextTypes={sharingStore:y.object.isRequired};var Me={root:["Footer-tooltip"]},Pe=function(e,t,n,a,i,r){var o=!1;if(e.audience===l.e.existing&&n)for(var s=0,c=n;s<c.length;s++){var d=c[s];if(void 0===i[d.email]&&void 0===i[d.userId]){o=!0;break}}return!!t||Object(w.R)(r)||o||Object(w.p)(a)>m.e},Te=function(e,t,n,a,i,r,o){if(!e){if(i!==c.e.share&&!t&&n.audience===l.e.specificPeople){for(var s=!1,d=!1,u=0,f=a;u<f.length;u++){var p=f[u];s||(s=p.isExternal&&!p.providerName),d||(d=!p.isExternal||p.isExternal&&!!p.providerName)}if(s&&d)return o(v.createElement("span",{role:"alert","aria-live":"assertive"},A.Qn)),!1}var m=n.audience===l.e.specificPeopleFlex||n.audience===l.e.specificPeople||i===c.e.share;return r?(o(v.createElement("span",{role:"alert","aria-live":"assertive"},A.Ys)),!1):0!==a.length||!m||(n.audience===l.e.specificPeopleFlex||(n.audience,l.e.specificPeople),o(v.createElement("span",{role:"alert","aria-live":"assertive"},A.Ni)),!1)}},Ue=n(209),Fe=n(214),He=n(79),Re=n(115),Ne=R.a(),Be=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),je=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg");Object(P.H)({icons:{outlookSVG:v.createElement("img",{src:Be}),teamsSVG:v.createElement("img",{src:je})}});var Ve=n(227);function ze(e,t){var n,a=e.clientId,i=e.copyLinkToastStatus,r=e.correlationId,o=e.createPeopleSharingLinks,s=e.currentSettings,l=e.engagementExtraData,u=e.groupsMemberCount,f=e.hostOptions,p=e.item,m=e.linkRecipients,_=e.messageText,h=e.summaryText,b=e.permissionsMap,g=e.permissionsLabel,y=e.sharingInformation,S=e.outlookAvailability,D=e.fullscreenIframeMode,x=e.showSendButtonSpinner,C=e.scenarioId,O=e.renderBackButton,E=e.getGraphToken,L=e.onAudienceChange,M=e.onRoleChange,P=e.onShareTargetClicked,T=e.onSelectedPeopleChange,U=e.onSendLinkClicked,F=e.onSendLinkMessageChange,H=e.onViewPolicyTipClicked,R=e.showLinkSettings,N=e.showPermissionsList,B=e.setCopyToastStatus,j=e.showItemInsights,V=(e.generateSummary,e.getStatusIcons),z=e.returnToPreviousView,G=t.platformDetection,K=t.shareClickTime,W=t.sharingClientMessenger,q=t.sharingStore,Q=t.onDismiss,Y=v.useState([]),J=Y[0],X=Y[1],Z=v.useState(null),$=Z[0],ee=Z[1],te=v.useState(!1),ne=te[0],ie=te[1],re=v.useState(!1),ce=re[0],de=re[1],le=v.useState(!1),ue=le[0],pe=le[1],me=v.useState(!1),_e=me[0],he=me[1];v.useEffect(function(){W?W.sendShareReady():k.h(K,a,d.e.share,C,r)},[]),v.useEffect(function(){Xe(s,m,b,y,H,ee,he)},[s,m,b,y]);var be=Object(oe.e)(function(e){return qe(s,l,e,b,y,q,T,H,X,ee,de,he)}),ge=Object(oe.e)(function(e){return Je(e,ie)}),ve=Object(oe.e)(function(e){return Ze(s,m,e,P,ee)}),ye=function(e,t,n,a,i){var r=[],o=function(e,t){return I.b(e)&&t===Re.e.available?Re.e.available:Object(k.a)()}(n,a);if(o===Re.e.available){var s=I.o(n)?"font:OutlookLogo":"outlookSVG",d="".concat(A.Eo," ").concat(A.qa);r.push({key:"outlook",text:d,iconProps:{iconName:s},onClick:function(){return i(c.e.outlook)}})}else a===Re.e.other&&(d="".concat(A.Eo," ").concat(A.ba),r.push({key:"nonOutlook",text:d,iconProps:{iconName:"font:Mail"},onClick:function(){return i(c.e.nonOutlook)}}));return Object(k.f)()?(d="".concat(A.Eo," ").concat(A.zs),r.push({key:"outlook",text:d,iconProps:{iconName:"font:TeamsLogo"},onClick:function(){return i(c.e.mobileShareToTeams)}})):t&&Ne&&!e.isIE&&(s="teamsSVG",d="".concat(A.Eo," ").concat(A.zs),r.push({key:"webTeams",text:d,iconProps:{iconName:s},onClick:function(){return i(c.e.webShareToTeams)}})),Object(k.d)()&&(d="".concat(A.$n),r.push({key:"moreApps",text:d,iconProps:{iconName:"AppIconDefault"},onClick:function(){return i(c.e.moreApps)}})),{items:r,directionalHint:ae.e.bottomRightEdge,className:"SimplifiedShareTargets ".concat(e.isIE?"ie":"")}}(G,D,a,S,P),Se=null!==(n=null==f?void 0:f.showCloseButton)&&void 0!==n?n:I.h(a),De=$;ce&&(De=null);var Ie=Object(w.z)(p.name,24);return v.createElement("div",{className:"ShareMain"},v.createElement("div",{className:"ShareMain-header"},v.createElement(se.e,{mainHeaderText:Ge(Ie),renderBackButton:O,onBackButtonClicked:z,actions:Ke(Q,R,ye,Se,ue),isFilenameTruncated:Ie!==p.name}),y.sensitivityLabelInformation&&v.createElement(Ve.e,{sensitivityLabelInformation:y.sensitivityLabelInformation,getGraphToken:E,engagementExtraData:l})),We(y)&&v.createElement(fe,{clientId:a,currentSettings:s,engagementExtraData:l,errorMessage:De,groupsMemberCount:u,linkRecipients:m,messageText:_,summaryText:h,permissionsMap:b,permissionsLabel:g,sharingInformation:y,onInputChange:ge,onRoleChange:M,onSelectedPeopleChange:be,onSendLinkMessageChange:F,getStatusIcons:V,showItemInsights:j}),v.createElement("div",{className:"ShareMain-flex-row"},v.createElement("div",{className:"ShareMain-flex-grow space-between"},Ye(y,q,N)),v.createElement("div",{className:"ShareMain-action-footer flex-end"},v.createElement(Ee,{currentSettings:s,copyLinkToastStatus:i,errorMessage:$,linkRecipients:m,onShareTargetClicked:ve,setCopyToastStatus:B,isSharingByCopyDisabled:_e}),v.createElement(ke,{engagementExtraData:l,currentSettings:s,createPeopleSharingLinks:o,linkRecipients:m,errorMessage:$,messageText:_,permissionsLabel:g,permissionsMap:b,shareType:c.e.share,sharingInformation:y,unresolvedPeoplePickerText:ne,showSendButtonSpinner:x,onSendLinkClicked:U,setErrorMessage:ee,isDisabled:ue,setIsDisabled:pe}))),Qe(J,ce,L,ee,de,he))}ze.contextTypes={platformDetection:y.object.isRequired,shareClickTime:y.number,sharingClientMessenger:y.object,sharingStore:y.object.isRequired,onDismiss:y.func.isRequired};var Ge=function(e){return Object(re.n)(A.xs,e)},Ke=function(e,t,n,a,i){return v.createElement(v.Fragment,null,v.createElement(Ce.e,{iconProps:{iconName:"Settings"},ariaLabel:A.ts,onClick:function(){t()},tooltipContent:A.ts,directionalHint:ae.e.bottomAutoEdge}),n.items.length>0&&v.createElement(Ce.e,{menuIconProps:{iconName:"More"},ariaLabel:A.ea,tooltipContent:A.ea,menuProps:n,directionalHint:ae.e.bottomAutoEdge,disabled:i}),a&&v.createElement(Ce.e,{iconProps:{iconName:"Clear"},ariaLabel:A.Ee,onClick:function(t){t.stopPropagation(),t.preventDefault(),e()},tooltipContent:A.Ee,directionalHint:ae.e.bottomAutoEdge}))},We=function(e){return!e.blockPeoplePickerAndSharing||Object(w.R)(e)},qe=function(e,t,n,a,i,r,o,s,c,d,l,u){var f=S.s({selectedItems:n,sharingLinkKind:e.sharingLinkKind,canAddExternalPrincipal:i.canAddExternalPrincipal,sharingInformation:i,viewPolicyTipCallback:s,permissionsMap:a,audience:e.audience,setSharingByCopyIsDisabled:u,scope:e.sharingScope}),m=n.filter(function(e){return e.isExternal}),_=e.sharingScope===p.e.organization,h=i.canAddExternalPrincipal;_&&h&&m.length?(l(!0),c(m),r.getEngagementHelper().externalSharingCslError(t)):f||u(!1),d(f),o(n)},Qe=function(e,t,n,a,i,r){return t&&e.length?v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.t,{confirmationCode:Ue.e.shareDialogExternalSharing,participant:null,participants:e,onApply:function(){i(!1),a(null),n(l.e.specificPeopleFlex,s.e.flexible,p.e.specificPeople),r(!1)},onCancel:function(){i(!1)}})):null},Ye=function(e,t,n){var a=Object(w.O)(e,t.isConsumer()),i=a.shared,r=a.activeLinks,o=a.sharingPrincipals,s=t&&!t.isConsumer(),c=i?v.createElement("div",{className:"ShareMain-sharedWithSection"},v.createElement(Fe.e,{getPhotoUrl:Object(He.t)(e.webUrl),onClick:function(){n()},sharingLinks:r,sharingPrincipals:o,personaSizeInPixels:20,renderOverlap:!0})):v.createElement("div",{className:"ShareMain-notShared"},v.createElement(_.e,{content:A.va},v.createElement(ie.e,{"aria-label":A.va,iconName:"Lock"})));return s?c:null},Je=function(e,t){t(""!==e)},Xe=function(e,t,n,a,i,r,o){if(t.length>0||a.errorCategory==f.e.shareLink){var s=S.s({selectedItems:t,sharingLinkKind:e.sharingLinkKind,canAddExternalPrincipal:a.canAddExternalPrincipal,sharingInformation:a,viewPolicyTipCallback:i,permissionsMap:n,audience:e.audience,setSharingByCopyIsDisabled:o,scope:e.sharingScope});s||a.errorCategory!=f.e.shareLink||(s=a.error?v.createElement("span",null,a.error.message.value):v.createElement("span",null,a.errorMessage)),r(s)}else o(!1)},Ze=function(e,t,n,a,i){e.audience!==l.e.specificPeople&&e.audience!==l.e.specificPeopleFlex||0!==t.length?a(n,!0):i(v.createElement("span",{role:"alert","aria-live":"assertive"},A.Ni))},$e=function(e){function t(t,n){var i=e.call(this,t)||this;i._viewStates=[],i._shareMainControl=Object(v.createRef)(),i._topLevelDivRef=v.createRef(),i._copyLinkOnCancelClicked=function(){i._returnToPreviousView()},i._copyLinkOnApplyClicked=function(e,t){var n={currentSettings:e,linkRecipients:e.specificPeople,viewState:i.state.viewState};i.setState(n,function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData),i._onCopyLinkClicked({copyLinkShortcut:!0})})},i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})},i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})},i._onAudienceChange=function(e,t,n){i.setState({currentSettings:Object(a.e)(Object(a.e)({},i.state.currentSettings),{audience:e,sharingLinkKind:t,sharingScope:n})})},i._onRoleChange=function(e){var t=Object(w.F)(e),n=e===o.e.view,r=e===o.e.review,c=e==o.e.manageList;if(!(t||n||r||c))throw new Error("Role not implemented: "+o.e[e]);var d=i.state.currentSettings,l=r||c?s.e.flexible:Object(w.y)(d.audience,t);d.sharingRole!==e&&i._store.getEngagementHelper().SharingRoleChangedFromCompactRoleSelector({isEdit:t,isReview:r});var u=d.preventDownload;!H.d()&&d.preventDownload&&e!==o.e.view&&e!==o.e.restrictedview&&(u=!1),i.setState(Object(a.e)(Object(a.e)({},i.state),{currentSettings:Object(a.e)(Object(a.e)({},d),{sharingRole:e,isEdit:t,isReview:r,sharingLinkKind:l,preventDownload:u})}))},i._onShareTargetClicked=function(e,t){var n;switch(e){case c.e.outlook:n="outlookClicked";break;case c.e.webShareToTeams:n="webShareToTeamsClicked";break;case c.e.mobileShareToTeams:n="mobileShareToTeamsClicked";break;case c.e.nonOutlook:n="nonOutlookClicked";break;case c.e.copy:n="copyButtonClicked";break;case c.e.moreApps:n="moreAppsClicked"}if(e!==c.e.copy){var r=new W.e({scenario:Object(K.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}});if(H.n()){var o=Object(Z.n)(i.props.clientId);if(o){var s=new W.e({scenario:"".concat(o,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}});i._shareLinkCustomerPromise=[r,s]}else i._shareLinkCustomerPromise=[r]}else i._shareLinkCustomerPromise=[r]}if(i._store.getEngagementHelper().log("ShareV3.shareTargetClicked",Object(a.e)(Object(a.e)({},i._engagementExtraData),{shareType:e})),e!==c.e.share)return e===c.e.copy?(i._sharingClientMessenger?i._sharingClientMessenger.sendCopyLinkShareTargetClicked():k.t(),void i._onCopyLinkClicked({copyLinkShortcut:t})):void(e!==c.e.webShareToTeams?i.setState({shareType:e,shareTargetClicked:!0},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1,shareType:e})}):i._onRedirectTeamsClicked())},i._onLinkPermissionsApplyClicked=function(e){if(i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData),i._onSelectedPermissionsChange(e),i.props.mode===d.e.linkSettings){var t=new W.e({scenario:Object(K.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});if(H.n()){var n=Object(Z.n)(i.props.clientId);if(n){var a=new W.e({scenario:"".concat(n,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});i._shareLinkCustomerPromise=[t,a]}else i._shareLinkCustomerPromise=[t]}else i._shareLinkCustomerPromise=[t];i.setState({shareType:c.e.share,applyLinkSettingsClicked:!0},function(){var e=i.state.linkRecipients;if(I.f(i.props.clientId)){var t=i.state.currentSettings.sharingLinkKind;t!==s.e.organizationEdit&&t!==s.e.organizationView||(e=e.filter(function(e){return!e.isExternal}))}i._store.shareLink({settings:i.state.currentSettings,recipients:e,copyLinkCommand:!1})})}},i.setCopyToastStatus=function(e){i.setState({copyLinkToastStatus:e})},i._onLinkPermissionsCancelClicked=function(){i.props.mode===d.e.linkSettings&&(i._sharingClientMessenger?i._sharingClientMessenger.sendDismiss():k.i()),i._returnToPreviousView()},i._returnToPreviousView=function(){i._viewStates&&i._viewStates.length&&(i.setState({viewState:i._viewStates.pop(),showTeamsDialog:!1},function(){var e,t;null===(t=null===(e=i._shareMainControl)||void 0===e?void 0:e.current)||void 0===t||t.shouldShowActivityIndicator(!1)}),i.state.viewState===Y.e.modifyPermissions&&i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData))},i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)},i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===l.e.existing&&i._store.checkPermissions(e),i._store.resetPeoplePickerError(),i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.fetchGroupsMemberCount(e)})},i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients,a=new W.e({scenario:Object(K.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});if(H.n()){var r=Object(Z.n)(i.props.clientId);if(r){var o=new W.e({scenario:"".concat(r,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});i._shareLinkCustomerPromise=[a,o]}else i._shareLinkCustomerPromise=[a]}else i._shareLinkCustomerPromise=[a];i.setState({shareType:c.e.share,recipientsCount:n.length,externalRecipientsCount:S.e(n),linkedinRecipientsCount:S.t(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0,showSendButtonSpinner:!0},function(){i._sharingClientMessenger?i._sharingClientMessenger.sendShareSendClicked():k.y(),i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})},i._onViewPolicyTipClicked=function(){i._viewStates.push(i.state.viewState),i.state.viewState!==Y.e.policyDetails&&i.setState({viewState:Y.e.policyDetails})},i._onSendLinkMessageChange=function(e){i.state.messageText!==e&&i.setState({messageText:e})},i._onSendLinkSubjectChange=function(e){i.state.subjectText!==e&&i.setState({subjectText:e})},i._getStatusIcons=function(){var e=Object(w.k)(i.props.clientId,i.state.sharingInformation,i.state.currentSettings),t={root:["SendLink-statusIcon"]};return e.map(function(e,n){var a={onRenderContent:function(){return v.createElement("div",{className:"SendLink-statusIconTooltip"},e.tooltip)}};return v.createElement("i",{className:"SendLink-statusIconItem"},v.createElement(_.e,{id:e.icon,tooltipProps:a},v.createElement(h.e,{iconName:e.icon,"aria-describedby":e.icon,styles:t})))})},i._getLabelProps=function(){return{clientId:i.props.clientId,companyName:i.state.companyName,currentSettings:i.state.currentSettings,customLabeledAudienceConfig:i.props.customLabeledAudienceConfig,sharingInformation:i.state.sharingInformation}},i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData),i.setState({shareType:c.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:Object(a.e)(Object(a.e)({},i.state.currentSettings),{updatePassword:!0})},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})},i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData),i.setState({shareType:c.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:Object(a.e)(Object(a.e)({},i.state.currentSettings),{updatePassword:!1,password:null})},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})},i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData),i.setState({showCopyLinkInterrupt:!1}),i._shareMainControl.current.shouldShowActivityIndicator(!1)},i._enterManageAccessView=function(){i._usePermissionsPivot?i.setState({viewState:Y.e.permissionsPivot}):i.setState({viewState:Y.e.permissionsList})},i._enterShareView=function(){i._store.getEngagementHelper().manageAccessLinkSectionShareClicked(i._engagementExtraData),H.P()||i._viewStates.push(i.state.viewState),i.setState({viewState:Y.e.default})},i._enterGrantAccessView=function(){i._store.getEngagementHelper().manageAccessGrantAccessClicked(i._engagementExtraData),i.setState({viewState:Y.e.addPeople})},i._showModifyPermissions=function(e,t){i._viewStates.push(i.state.viewState),i.setState({viewState:Y.e.modifyPermissions,copyLinkShortcut:t},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData,e)})},i._showPermissionsList=function(){i._viewStates.push(i.state.viewState),i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,a=n&&!t;t?i._sharingClientMessenger?i._sharingClientMessenger.sendShareManageAccessClicked():k.s():a?n():i.setState({viewState:i._usePermissionsPivot||i._showSimplifiedDialog?Y.e.permissionsPivot:Y.e.permissionsList,showHeaderInManagedAccess:!0})},i._dismiss=n.onDismiss,i._resize=n.resize,i._store=n.sharingStore,i._shareClickTime=n.shareClickTime,i._sharingClientMessenger=n.sharingClientMessenger,i._isPeopleSharingLinksEnabled=!1,i._rumoneLogger=new q.e,i._usePermissionsPivot=H.U()||R.i()&&H.T()&&!i._store.isConsumer(),i._platformDetection=n.platformDetection,i._showSimplifiedDialog=1===R.i()&&!i.props.showItemInsights&&!i._platformDetection.isMobile&&i.props.clientId!==u.e.sharePointPages;var r=k.c(),f=t.theme;f||(f=k.r()),(f&&i.props.clientId!==u.e.wac||r)&&i._loadTheme(r?Object(w.l)():f),i._sizeConstraints={maxHeight:I.o(i.props.clientId)?"none":i.props.maxHeight||"none",maxWidth:i.props.maxWidth||"none",overflowY:i._showSimplifiedDialog?"hidden":"auto",overflowX:"hidden"};var p,m=Object(ee.e)(location.search.substring(1)),b=m.migratedhosting&&"true"===m.migratedhosting.toLowerCase();return i._engagementExtraData={isSimplifiedShareDialog:i._showSimplifiedDialog,clientId:t.clientId,scenarioId:t.scenarioId,correlationId:i._correlationId,hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?d.e.copy:d.e.share),isMigratedhosting:b,withSummary:!!i.props.summaryText,withSummaryFailed:!!i.props.summaryText&&-1!==i.props.summaryText.indexOf("Something went wrong with retrieving a summary")},H.M()?(p={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:Y.e.default,readyToCopy:!1,shareType:c.e.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",summaryText:t.summaryText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1,copyLinkToastStatus:we.e.closed,showSendButtonSpinner:!0}).viewState=Y.e.spinner:p=i._generateInitialStateFromStore(),i.state=p,i._baseProps=Object(V.e)(t),i._correlationId=i.props.correlationId||B.e.generate(),i._baseProps.correlationId=i._correlationId,i._resizeTracker=new N.e(n.resize),i._store.getEngagementHelper().log(F.a.Opening,i._engagementExtraData),H.C()||i._platformDetection.isIOS&&i._platformDetection.isMobile&&document.querySelector("[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1"),i}return Object(a.a)(t,e),t.prototype.componentWillUnmount=function(){this._store.removeListeners&&this._store.removeListeners()},t.prototype.componentDidMount=function(){var e,t=this;try{var n=this._store,i=void 0;try{i=Object(j.e)(Object(j.n)(n.getAuthToken())),this._engagementExtraData.appId=i}catch(e){}if(!this._isOpenEventLogged){var r=Object(a.e)({},this._engagementExtraData),o=this._store.getNavId();o&&(r.isNavIdBase64=Object(ne.t)(o),r.navIdLength=o.length),this._store.getEngagementHelper().log(F.a.Opened,r),this._isOpenEventLogged=!0}if(new M.t(this).on(window,"keydown",function(e){e&&e.keyCode===U.e.escape&&t._handleEscKeyPress(e)}),n.addListener(this._sharingStoreListener.bind(this)),H.M()){var s=this.props.mode===d.e.manageAccess;H.ae()&&n.fetchSuiteNavInformation(),n.fetchSharingInformation(!0,s)}else!(this.props.copyLinkShortcut&&this.state.sharingInformation&&this.state.currentSettings)||this.props.shareId||this.state.sharingInformation.error||this._copyLinkShortcutInvoked||this.state.sharingLinkCreated||(this._copyLinkShortcutInvoked=!0,this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:this.state.currentSettings,shareTargetClicked:!1}));if(H.ae()||n.fetchSuiteNavInformation(),n.fetchPolicyTipInformation(),this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===d.e.copy&&!this.props.shareId&&I.f(this.props.clientId)&&(this._copyLinkShortcutInvoked=!0,this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0}),this.setState({shareType:c.e.copy,shareTargetClicked:!0})),this._resizeIfNeeded(),this.state.sharingInformation){var l=this.props.mode,f=this.state.viewState;(this.state.viewState===Y.e.default||this.state.viewState===Y.e.linkSettings&&this.props.mode===d.e.linkSettings)&&(setTimeout(function(){t._writeShareDataToRumoneLogger({mode:l,viewState:f})},0),this._isInitialPageLoadDataLogged=!0),this.state.viewState===Y.e.linkSuccess&&this.props.mode===d.e.copy&&(this._isInitialPageLoadDataLogged=!0),null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Z.i)({customerPromise:e,engagementExtraData:t._engagementExtraData,sharingStore:t._store})})}var p=n.getSharingInformation();p.peoplePickerSettings||(p.peoplePickerSettings={}),H.B()&&(this.props.clientId===u.e.wac||this.props.clientId===u.e.word)&&Object(te.n)(p.fileExtension)&&(p.peoplePickerSettings.useNew3Ssearch=!0)}catch(e){this._setGenericErrorState(Z.e.generic,e)}},t.prototype.componentDidUpdate=function(){this._resizeIfNeeded(),this.state.sharingInformation&&this._logRumone()},t.prototype.render=function(){var e,t,n,i,r=this,o=this.props.copyLinkShortcut,c=this.state,d=c.sharingInformation,u=c.currentSettings,f=c.showActivityIndicator,p=c.sharingLinkCreated,m="od-Share ".concat(this._showSimplifiedDialog&&"od-SimplifiedShare"),_=!1;if(!H.h()&&d&&u&&o&&p&&this.state.viewState!==Y.e.error&&this.state.viewState!==Y.e.policyDetails)_=!0,n=this._renderPostCopyShortcutView();else switch(this.state.viewState){case Y.e.error:n=this._renderError(d),null===(e=this._shareLinkCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Z.a)({customerPromise:e,rawErrorMessage:d.rawError||"generic share link failure",engagementExtraData:r._engagementExtraData,errorType:d.rawError?Z.e.api:Z.e.generic,sharingStore:r._store})}),this._shareLinkCustomerPromise=void 0;break;case Y.e.default:case Y.e.shareToTeams:m+=f?" od-Share--hasActivity":"",_=!0,n=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case Y.e.modifyPermissions:_=!0,n=v.createElement(v.Fragment,null,this._renderModifyPermissions(Y.e.modifyPermissions),this._renderActivityIndicator());break;case Y.e.linkSuccess:null===(t=this._shareLinkCustomerPromise)||void 0===t||t.forEach(function(e){return Object(Z.i)({customerPromise:e,engagementExtraData:r._engagementExtraData,sharingStore:r._store})}),this._shareLinkCustomerPromise=void 0,n=this._renderNotification();break;case Y.e.permissionsList:_=!0,n=this._renderPermissionsList();break;case Y.e.permissionsPivot:_=!0,n=this._renderPermissionsPivot();break;case Y.e.policyDetails:n=v.createElement(v.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case Y.e.atMention:m="",n=this._renderAtMention();break;case Y.e.linkSettings:m+=f?" od-Share--hasActivity":"",_=!0,n=v.createElement(v.Fragment,null,this._renderModifyPermissions(Y.e.linkSettings));break;case Y.e.notify:u.sharingLinkKind=s.e.direct,u.audience=l.e.existing,this._engagementExtraData=Object(a.e)(Object(a.e)({},this._engagementExtraData),{appMap:d.item.appmap}),m="",n=v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.s,Object(a.e)({},this._baseProps,{currentSettings:u,sharingInformation:d,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})));break;case Y.e.addPeople:_=!0,n=this._renderAddPeople();break;case Y.e.spinner:default:n=v.createElement("div",{className:"od-Share-spinnerHolder"},v.createElement(b.e,{className:"od-Share-spinner",label:A.Le,size:g.e.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}i=_||m?v.createElement("div",{className:m,style:_?this._sizeConstraints:void 0},n):n;var h=I.f(this.props.clientId)?" teams":"";return v.createElement(x.e,null,v.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:h+" isFluent"},i))},t.prototype._sharingStoreListener=function(e){var t,n,i=this,r=this._store;try{if(this.state.viewState===Y.e.error)return;if(this.props.mode===d.e.copy&&e&&e.type===z.t.UnshareLink)return;H.T()&&R.i()&&r.parsePermissions&&void 0!==r.getSharingInformation()&&!r.isConsumer()&&r.parsePermissions();var o=r.getSharingInformation(),s=r.getSharingLinkCreated(),c=r.getCompanyName(),l=r.getGroupsMemberCount(),u=r.getPolicyTipInformation(),p=r.getPermissionsMap(),m=r.getDefaultRecipients();if(this._outlookAvailability=r.getOutlookAvailability(),this._isPeopleSharingLinksEnabled=r.isPeopleSharingLinksEnabled(),!o)return;o.webTemplateId&&(this._engagementExtraData.webTemplateId=o.webTemplateId),o.itemUniqueId&&(this._engagementExtraData.itemUniqueId=o.itemUniqueId),o.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),r.fetchSharingInformation(!0,!0));var _=this._store.getItemInformationForLogging(),h=_.itemType,b=_.extension;this._engagementExtraData.itemType=h,this._engagementExtraData.extension=b,this._sanitizeSharingContextInfo(o);var g=this._getSettings(o),v=Object(a.e)({},this.state);if(this.state.viewState===Y.e.spinner&&(v.viewState=this._getInitialViewState(o,g,s),v.viewState!==Y.e.spinner&&(H.h()&&this.props.mode===d.e.copy?this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():k.h(this._shareClickTime,this.props.clientId,d.e.copy,this.props.scenarioId,this.props.correlationId):this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():k.C())),(null==o?void 0:o.error)||(null==o?void 0:o.isStubFile))o&&o.error&&(o.errorCategory===f.e.shareLink||o.errorCategory===f.e.shareObject||o.errorCategory===f.e.createLink||o.errorCategory===f.e.invite)?(null===(t=this._shareLinkCustomerPromise)||void 0===t||t.forEach(function(e){return Object(Z.a)({customerPromise:e,rawErrorMessage:o.error,engagementExtraData:i._engagementExtraData,errorType:o.error?Z.e.api:Z.e.generic,sharingStore:i._store})}),this._shareLinkCustomerPromise=void 0):null===(n=this.props.shareLoadingCustomerPromise)||void 0===n||n.forEach(function(e){return Object(Z.a)({customerPromise:e,rawErrorMessage:(null==o?void 0:o.isStubFile)?new Error("Is stub file"):null==o?void 0:o.rawError,engagementExtraData:i._engagementExtraData,errorType:Z.e.api,sharingStore:i._store})}),this._flushAriaAndReportError(o),o.errorCategory===f.e.shareLink&&this.props.mode!==d.e.copy?v.viewState=Y.e.default:v.viewState=Y.e.error,H.S()&&S.r(o.error)&&o.errorCategory===f.e.invite&&(v.viewState=this.state.viewState),v.sharingInformation=o;else if((e&&e.type===z.t.ShareLink||this.props.shareId)&&s&&(this.state.shareTargetClicked||this.props.copyLinkShortcut||this.state.applyLinkSettingsClicked)){var y=this._handleCreatedShareLink({settings:g,sharingInformation:o,sharingLinkCreated:s,viewState:v.viewState});v=Object(a.e)(Object(a.e)({},v),y)}else!this.props.copyLinkShortcut||!o||this.props.shareId||o.error||this._copyLinkShortcutInvoked||(this._copyLinkShortcutInvoked=!0,this._onCopyLinkClicked({copyLinkShortcut:!0,initializedSettings:g,shareTargetClicked:!1})),v=Object(a.e)(Object(a.e)({},v),{sharingInformation:o,companyName:c,groupsMemberCount:l,currentSettings:g,policyTipInformation:u,isLoadingDefaultRecipients:r.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:p}),m&&!m.isConsumed&&(v.linkRecipients=m.recipients,this._store.consumeDefaultRecipients());if(H.J()&&!this.state.summaryText&&!v.summaryText){var D=r.getDocumentInformation();D&&D.documentSummary&&(v=Object(a.e)(Object(a.e)({},v),{summaryText:D.documentSummary}),this._engagementExtraData.withSummary=!0,this._engagementExtraData.withSummaryFailed=-1!==D.documentSummary.indexOf("Something went wrong with retrieving a summary"))}if(this.props.shouldWaitForSharingInfoBarInformation&&H.X()&&!this.state.sharingInfoBarInformation&&!v.sharingInfoBarInformation){var I=r.getSharingInfoBarInformation();I&&I.sharingInfoBarMessageTypeId&&(v=Object(a.e)(Object(a.e)({},v),{sharingInfoBarInformation:I}))}this.setState(v)}catch(e){this._setGenericErrorState(Z.e.generic,e)}},t.prototype._handleCreatedShareLink=function(e){var t=e.sharingInformation,n=e.settings,i=e.sharingLinkCreated,o=e.initialState,s=e.viewState,l=this._store.getCompanyName(),u=o||this.state,f=Object(a.e)({},u);this._modifiedSharingLinkUrl=this._getModifiedSharingLinkUrl(i,u.shareType);var p=u.shareType,m=u.currentSettings,_=m?m.isEdit:n.isEdit,h=m?m.isReview:n.isReview,b=m?m.preventDownload:n.preventDownload,g=m?m.audience:n.audience,v=L.c(g,t.sharingAbilities,t.fileExtension),y=L.l(g,t.sharingAbilities,t.fileExtension),S=Object(a.e)(Object(a.e)({},this._engagementExtraData),{shareType:p,audience:i.audience,isEdit:_,isReview:y&&h,recipientsCount:u.recipientsCount,externalRecipientsCount:u.externalRecipientsCount,linkedinRecipientsCount:u.linkedinRecipientsCount,hasMessage:!!u.hasMessage,hasSubject:!!u.hasSubject,messageLength:u.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(i),sharingLinkKind:i.sharingLinkKind,isDefaultLink:t.defaultSharingLink.sharingLinkKind===i.sharingLinkKind,linkBlocksDownload:!!b,linkWithOfficeReviewMode:v&&h,shareViewState:s,hasNavId:!!this._store.getNavId(),sharingAudienceChanged:t.defaultSharingLink.audience!==i.audience,groupRecipientCount:u.linkRecipients.filter(function(e){return e.entityType===D.e.group&&null==e.familySharingTargetType}).length});I.g(this.props.clientId)&&(S.sharedToFamilyGroup=u.linkRecipients.some(function(e){return e.familySharingTargetType===r.Family}),S.sharedToFamilyMember=u.linkRecipients.some(function(e){return e.familySharingTargetType===r.FamilyMember}));var x=this._store.getEngagementHelper();x.shareCompleted(S),x.logShareLinkGeneration(i,S);var C=Object(w.M)(i.sharingLinkKind);return this._sharingClientMessenger?this._sharingClientMessenger.sendShareCompleted():k.I(u.shareType,C),f=Object(a.e)(Object(a.e)({},f),this._handleCreatedShareLinkForShareTypes(i,o)),this.props.mode===d.e.linkSettings?k.p(i,l,this.props.customLabeledAudienceConfig,this.props.clientId):(f=Object(a.e)(Object(a.e)({},f),{viewState:u.shareType===c.e.webShareToTeams?Y.e.shareToTeams:Y.e.linkSuccess,sharingLinkCreated:i,companyName:l,showActivityIndicator:!1,sharingInformation:t,currentSettings:this._getSettings(t)}),this._showSimplifiedDialog&&this.props.mode!==d.e.copy&&p===c.e.copy&&(f=Object(a.e)(Object(a.e)({},f),{viewState:Y.e.default}))),f},t.prototype._handleCreatedShareLinkForShareTypes=function(e,t){var n,i=this,r=t||this.state,o=Object(a.e)({},r),s=r.shareType,l=this._store.getCompanyName();if(null===(n=this._shareLinkCustomerPromise)||void 0===n||n.forEach(function(e){return Object(Z.i)({customerPromise:e,engagementExtraData:i._engagementExtraData,sharingStore:i._store})}),this._shareLinkCustomerPromise=void 0,s===c.e.outlook||s===c.e.nonOutlook)I.b(this.props.clientId)?(this._store.navigateToOwa(this._getRecipientEmails(r.linkRecipients),this._modifiedSharingLinkUrl),this._sharingClientMessenger?this._sharingClientMessenger.sendOutlookClicked():k.m(),this._dismiss()):k.D(this._getRecipientEmails(this.state.linkRecipients),this.state.linkRecipients.length,this.state.messageText,this._modifiedSharingLinkUrl);else if(s===c.e.mobileShareToTeams)this._dismiss(),this._sharingClientMessenger?this._sharingClientMessenger.sendTeamsClicked(e,this._getRecipientEmails(r.linkRecipients),r.messageText):k.x(e,this._getRecipientEmails(r.linkRecipients),r.messageText);else if(s===c.e.moreApps)try{o=Object(a.e)(Object(a.e)({},o),{viewState:Y.e.linkSuccess,companyName:l,sharingLinkCreated:e,showActivityIndicator:!1}),window.external.SendLinkViaMoreApps(e.url)}catch(e){}else if(s===c.e.webShareToTeams){if(this._modifiedSharingLinkUrl){var u="https://teams.microsoft.com/share?href="+this._modifiedSharingLinkUrl+"&referrer=SharePoint.com";this._teamsUrl=u,o=Object(a.e)(Object(a.e)({},o),{showTeamsDialog:!0})}}else if(this._showSimplifiedDialog&&this.props.mode!==d.e.copy&&s===c.e.copy){o=Object(a.e)(Object(a.e)({},o),{companyName:l,sharingLinkCreated:e,showActivityIndicator:!1});var f={clientId:this.props.clientId,textField:null,linkUrl:this._modifiedSharingLinkUrl,itemName:this.state.sharingInformation.item.name,extraQosData:this._engagementExtraData};Object(w.s)(f).then(function(){i.setCopyToastStatus(we.e.success)}).catch(function(e){return console.log("Error while copying link to clipboard",e)})}return o},t.prototype._generateInitialStateFromStore=function(){var e,t,n=this,i=this._store;if(H.T()&&R.i()&&i.parsePermissions&&void 0!==i.getSharingInformation()&&!i.isConsumer()){var r=i.getSharingInformation();if(r.error||!r.permissionsInformation)return r.permissionsInformation||(r.rawError="Missing permissions information",r.errorMessage="Missing permissions information"),null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Z.a)({customerPromise:e,rawErrorMessage:r.rawError,engagementExtraData:n._engagementExtraData,errorType:Z.e.api,sharingStore:n._store})}),{viewState:Y.e.error,sharingInformation:r,companyName:"",currentSettings:void 0,shareType:c.e.share,sharingLinkCreated:void 0,readyToCopy:!1,groupsMemberCount:0,policyTipInformation:void 0,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:"",summaryText:"",subjectText:"",isLoadingDefaultRecipients:!1,isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,copyLinkToastStatus:we.e.closed,showSendButtonSpinner:!1};i.parsePermissions()}var o=i.getSharingInformation(),s=i.getSharingLinkCreated(),l=i.getCompanyName(),u=i.getGroupsMemberCount(),f=i.getPolicyTipInformation(),p=i.getPermissionsMap(),m=i.getDefaultRecipients();if(this._outlookAvailability=i.getOutlookAvailability(),this._isPeopleSharingLinksEnabled=i.isPeopleSharingLinksEnabled(),o){this._engagementExtraData.webTemplateId=o.webTemplateId,this._engagementExtraData.itemUniqueId=o.itemUniqueId;var _=this._store.getItemInformationForLogging(),h=_.itemType,b=_.extension;this._engagementExtraData.itemType=h,this._engagementExtraData.extension=b,o.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),i.fetchSharingInformation(!0,!0));var g=this._getSettings(o),v=[];m&&!m.isConsumed&&(v=m.recipients||[],this._store.consumeDefaultRecipients());var y=this._getInitialViewState(o,g,s);y!==Y.e.spinner&&(H.h()&&this.props.mode===d.e.copy?this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():k.h(this._shareClickTime,this.props.clientId,d.e.copy,this.props.scenarioId,this.props.correlationId):this._sharingClientMessenger?this._sharingClientMessenger.sendShareUIReady():k.C());var S=c.e.share;H.h()&&this.props.mode===d.e.copy&&(S=c.e.copy);var D={companyName:l,currentSettings:g,sharingInformation:o,sharingLinkCreated:s,readyToCopy:!1,shareType:S,viewState:y,groupsMemberCount:u,policyTipInformation:f,linkRecipients:v,shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:p,messageText:this.props.messageText||"",summaryText:this.props.summaryText||"",subjectText:this.props.subjectText||"",isLoadingDefaultRecipients:this._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1,copyLinkToastStatus:we.e.closed,showSendButtonSpinner:!1};if(o.error)return null===(t=this.props.shareLoadingCustomerPromise)||void 0===t||t.forEach(function(e){return Object(Z.a)({customerPromise:e,rawErrorMessage:o.rawError,engagementExtraData:n._engagementExtraData,errorType:Z.e.api,sharingStore:n._store})}),this._flushAriaAndReportError(o),Object(a.e)(Object(a.e)({},D),{viewState:Y.e.error,sharingInformation:o});var I=i.getSharingLinkCreated();if(I){var x=this._handleCreatedShareLink({settings:g,sharingInformation:o,sharingLinkCreated:I,initialState:D,viewState:y});D=Object(a.e)(Object(a.e)({},D),x)}return D}return null},t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case d.e.share:if(e&&t)return Y.e.default;break;case d.e.atMention:if(e&&t)return Y.e.atMention;break;case d.e.linkSettings:if(t)return Y.e.linkSettings;break;case d.e.manageAccess:if(t)return this._usePermissionsPivot?Y.e.permissionsPivot:Y.e.permissionsList;break;case d.e.copy:if(e&&t&&n)return Y.e.linkSuccess;break;case d.e.notify:if(e)return Y.e.notify;break;case d.e.addPeople:if(e)return Y.e.addPeople;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return Y.e.spinner},t.prototype._renderAtMention=function(){var e,t=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.e,Object(a.e)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,canGrantEditPermissions:null===(e=this.props.hostOptions)||void 0===e?void 0:e.canGrantEditPermissions,onComplete:t})))},t.prototype._renderPostCopyShortcutView=function(){var e,t,n=this,i=this.state,r=i.sharingInformation,o=i.currentSettings,s=i.companyName,c=i.sharingLinkCreated,d=i.viewState,l=i.groupsMemberCount,u=c&&c.createdViaCopyLinkCommand||this._copyLinkShortcutInvoked;return this._shareLinkCustomerPromise&&d===Y.e.linkSuccess&&(null===(e=this._shareLinkCustomerPromise)||void 0===e||e.forEach(function(e){return Object(Z.i)({customerPromise:e,engagementExtraData:n._engagementExtraData,sharingStore:n._store})}),this._shareLinkCustomerPromise=void 0),v.createElement(X,Object(a.e)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:s,currentSettings:o,item:r.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClick:this._getNotificationHintClickHandler(u),sharingInformation:r,showExistingAccessOption:this.props.showExistingAccessOption,viewState:d,groupsMemberCount:l,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,hostOptions:this.props.hostOptions,onShareNotificationRenderComplete:c&&function(){n._writeShareDataToRumoneLogger({mode:n.props.mode,viewState:n.state.viewState})},shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:null===(t=this.state.sharingInfoBarInformation)||void 0===t?void 0:t.sharingInfoBarMessageTypeId,onShowPermissionsListClicked:this._showPermissionsList}))},t.prototype._renderError=function(e){return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.n,Object(a.e)({},this._baseProps,{viewState:Y.e.error,sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()})))},t.prototype._getSettings=function(e){var t,n=this,a=null===(t=this.state)||void 0===t?void 0:t.currentSettings,i=e&&e.error,r=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,s=L.i(e.sharingAbilities,e.sharingLinkTemplates),c=!1;if(!a&&!i){var d,l=e.defaultSharingLink;r&&(d=e.sharingLinks.filter(function(e){return e.shareId===n.props.shareId&&e.isActive})[0])&&(l=d,c=!0),void 0!==s&&s.length>0&&((d=s.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0])||(d=s.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0])?(l=d,c=!0):(l=s[0],c=!0)),a=this._initializeCurrentSettings(l,e,this.props.copyLinkShortcut,c),s.length>0&&(a.shareId=l.shareId,a.fetchLinkOnly=!0,a.audience=l.audience,a.expiration=l.expiration,a.isEdit=l.isEdit,a.isReview=l.isReview,a.sharingRole=l.isEdit?Object(w.f)(this.props.clientId,e):l.isReview?o.e.review:o.e.view,a.trackLinkUsers=l.trackLinkUsers,a.preventDownload=l.blockDownload,a.sharingLinkKind=l.sharingLinkKind,this._engagementExtraData.isRedeemedUserResharing=!0,this._engagementExtraData.redeemedLinksCount=s.length)}return a},t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n].email;i&&t.push(i)}return t},t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var a=(t.getTime()-n.getTime())/864e5;return Math.floor(a)}},t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss(),e.stopImmediatePropagation()},t.prototype._initializeCurrentSettings=function(e,t,n,a){if(this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:l.e.existing,expiration:null,isEdit:!0,sharingRole:Object(w.f)(this.props.clientId,t),sharingLinkKind:s.e.direct,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:e.sharingScope};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===l.e.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=l.e.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:l.e.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:Object(w.f)(this.props.clientId,t),sharingLinkKind:s.e.flexible,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:e.sharingScope};e.audience===l.e.specificPeopleFlex&&n&&!a&&(e.audience=l.e.existing,e.sharingLinkKind=s.e.direct);var i=e.sharingLinkKind,r=i===s.e.anonymousEdit||i===s.e.organizationEdit||i===s.e.direct||i===s.e.flexible,c=e.isEdit&&2===t.defaultShareLinkPermission,d=[];return this.props.shareId&&e.principals&&(d=Object(w.D)(e)),{allowEditing:r,audience:this.props.preferCustomLabeledAudience&&e.audience===l.e.specificPeopleFlex?l.e.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:c,sharingRole:c?Object(w.f)(this.props.clientId,t):o.e.view,sharingLinkKind:e.sharingLinkKind,specificPeople:d,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}},t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var a,i,r,c,d=t.sharingAbilities,u="00000000-0000-0000-0000-000000000000"===this.props.shareId,f=u?s.e.direct:t.defaultSharingLink.sharingLinkKind,m=u?p.e.existing:t.defaultSharingLink.sharingScope,_=Object(w.U)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?l.e.customLabeledSpecificPeople:l.e.specificPeople;if(t.defaultShareLinkToExistingAccess)_=l.e.existing,f=s.e.direct;else if(null!=m)switch(m){case p.e.anyone:_=l.e.anyone;break;case p.e.organization:_=l.e.organization;break;case p.e.specificPeople:_=l.e.specificPeopleFlex;break;case p.e.existing:default:u||!t.canManagePermissions||t.blockPeoplePickerAndSharing?_=l.e.existing:this._isPeopleSharingLinksEnabled?(_!==l.e.customLabeledSpecificPeople&&(_=l.e.specificPeopleFlex),f=s.e.flexible):_=l.e.existing}else switch(f){case s.e.anonymousEdit:case s.e.anonymousView:_=l.e.anyone;break;case s.e.organizationEdit:case s.e.organizationView:_=l.e.organization;break;case s.e.direct:default:u||!t.canManagePermissions||t.blockPeoplePickerAndSharing?_=l.e.existing:this._isPeopleSharingLinksEnabled?(_!==l.e.customLabeledSpecificPeople&&(_=l.e.specificPeopleFlex),f=s.e.flexible):_=l.e.existing}_===l.e.specificPeopleFlex&&n&&(_=l.e.existing,f=s.e.direct);var h=null,b=L.a(_,d).linkExpiration;(b?b.defaultExpirationInDays:null)>0&&(h=new Date((new Date).toDateString())).setDate(h.getDate()+b.defaultExpirationInDays);var g,v=L.r(_,d),y=v&&2===t.defaultShareLinkPermission,S=y?Object(w.f)(this.props.clientId,t):o.e.view;(g=7===t.defaultShareLinkPermission)&&(S=H.d()?o.e.restrictedview:o.e.view);var D=(null===(i=null===(a=this.props)||void 0===a?void 0:a.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],I=(null===(c=null===(r=this.props)||void 0===r?void 0:r.hostOptions)||void 0===c?void 0:c.disabledAudienceOptions)||[];return _=-1===D.indexOf(_)&&-1===I.indexOf(_)?_:l.e.existing,L.o(_,d)&&(_=l.e.existing),{allowEditing:v,audience:_,expiration:h,isEdit:y,sharingRole:S,isReview:!1,preventDownload:g,sharingLinkKind:_===l.e.existing?s.e.direct:f,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}},t.prototype._loadTheme=function(e){try{var t=e;Object(P.M)(t)}catch(e){}},t.prototype._onRedirectTeamsClicked=function(){var e=this;this._store.getEngagementHelper().webShareToTeamsTargetClicked(this._engagementExtraData),this._store.getEngagementHelper().shareCompleted(this._engagementExtraData),this.setState({shareType:c.e.webShareToTeams,shareTargetClicked:!0,viewState:Y.e.shareToTeams},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:c.e.webShareToTeams}),e._viewStates.push(e.state.viewState)})},t.prototype._onCopyLinkClicked=function(e){var t;return Object(a.t)(this,void 0,void 0,function(){var n,i,r,o,s,u,f,p,m,_,h=this;return Object(a.i)(this,function(b){switch(b.label){case 0:return n=e.copyLinkShortcut,i=e.initializedSettings,r=e.shareTargetClicked,o=void 0===r||r,s=Object(a.e)(Object(a.e)({sendInvitation:!1},i),null===(t=this.state)||void 0===t?void 0:t.currentSettings),this._copyTargetClickTime=Date.now(),u=new W.e({scenario:Object(K.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}}),H.n()&&(f=Object(Z.n)(this.props.clientId))?(p=new W.e({scenario:"".concat(f,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"copyLink"}}),this._shareLinkCustomerPromise=[u,p]):this._shareLinkCustomerPromise=[u],(m=this.props.mode!==d.e.copy)?[4,this._store.shouldInterruptCopyLink(s.isEdit)]:[3,2];case 1:m=b.sent(),b.label=2;case 2:return m?(this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData),this.setState({showCopyLinkInterrupt:!0})):(_=this.state.copyLinkToastStatus,this._showSimplifiedDialog&&(_=we.e.inProgress),this.setState({shareType:c.e.copy,shareTargetClicked:o,copyLinkToastStatus:_},function(){var e=h.state.linkRecipients;h._store.isConsumer()&&s.audience!==l.e.specificPeople&&(e=[]),h._store.shareLink({settings:s,recipients:e,copyLinkCommand:n,shareType:c.e.copy})})),[2]}})})},t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:c.e.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})},t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:c.e.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})},t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:c.e.mobileShareToTeams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})},t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:c.e.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})},t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===l.e.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=Y.e.default;this.props.mode===d.e.linkSettings?n=this.state.viewState:this._viewStates&&this._viewStates.length>0&&(n=this._viewStates.pop()),this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===l.e.specificPeople,sharingScope:e.sharingScope},permissionsMap:t})},t.prototype._renderBackButtonForPriorView=function(){if(this._viewStates.length>0)return T.t(v.createElement(O.e,{className:"od-Share-backButton absolute priorView",id:"od-Share-prevView-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:A.ne}),A.ne,{tooltipId:"od-Share-backButton-tooltip",position:ae.e.bottomCenter,targetElementId:"od-Share-prevView-backButton"})},t.prototype._renderBackButtonForPolicyDetails=function(){if(this.state.viewState===Y.e.policyDetails)return T.t(v.createElement(O.e,{className:"od-Share-backButton absolute",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:A.ne}),A.ne)},t.prototype._renderShareMain=function(e,t){var n;return v.createElement("div",{className:"od-Share-shareMainDiv"},!this._showSimplifiedDialog&&this._renderBackButtonForPriorView(),this._showSimplifiedDialog?v.createElement(ze,Object(a.e)({},this._baseProps,{key:"simplified-share",companyName:this.state.companyName,copyLinkToastStatus:this.state.copyLinkToastStatus,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,currentSettings:t,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,engagementExtraData:this._engagementExtraData,groupsMemberCount:this.state.groupsMemberCount,item:e.item,linkRecipients:this.state.linkRecipients,messageText:this.state.messageText,summaryText:this.state.summaryText,permissionsMap:this.state.permissionsMap,permissionsLabel:Object(w.b)(this._getLabelProps()),sharingInformation:e,outlookAvailability:this._outlookAvailability,fullscreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,onAudienceChange:this._onAudienceChange,onRoleChange:this._onRoleChange,onShareTargetClicked:this._onShareTargetClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onSendLinkMessageChange:this._onSendLinkMessageChange,onViewPolicyTipClicked:this._onViewPolicyTipClicked,showLinkSettings:this._showModifyPermissions,showPermissionsList:this._showPermissionsList,setCopyToastStatus:this.setCopyToastStatus,showSendButtonSpinner:this.state.showSendButtonSpinner,returnToPreviousView:this._returnToPreviousView,getStatusIcons:this._getStatusIcons,renderBackButton:this._viewStates.length>0,showItemInsights:this.props.showItemInsights,generateSummary:this.props.generateSummary})):v.createElement(m.t,Object(a.e)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClick:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,summaryText:this.state.summaryText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this._onRoleChange,onAudienceChange:this._onAudienceChange,fullScreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,hasBackButton:this.props.mode===d.e.manageAccess,showItemInsights:this.props.showItemInsights,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:null===(n=this.state.sharingInfoBarInformation)||void 0===n?void 0:n.sharingInfoBarMessageTypeId})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}),this.state.showTeamsDialog&&this._renderTeamsDialog())},t.prototype._renderTeamsDialog=function(){return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.l,{url:this._teamsUrl,onDismiss:this._dismiss,height:this.props.calculatedIframeHeight,onBackButtonClicked:this._returnToPreviousView.bind(this)}))},t.prototype._renderPolicyDetails=function(){return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.d,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation}))},t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.t,{confirmationCode:t?12:13,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew}))},t.prototype._renderModifyPermissions=function(e){return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.i,Object(a.e)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this.state.copyLinkShortcut?this._copyLinkOnApplyClicked:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:this.state.copyLinkShortcut,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onShowPermissionsListClicked:this._showPermissionsList})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!this.state.currentSettings.password}))},t.prototype._renderNotification=function(){var e,t=this,n=this.state,i=n.sharingInformation,r=n.sharingLinkCreated,o={companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:i,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(r.createdViaCopyLinkCommand),linkRecipients:n.shareType===c.e.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return this._showSimplifiedDialog&&this.props.mode!==d.e.copy?v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.f,Object(a.e)({},Object(V.e)(this.props),{permissionsLabel:Object(w.b)(this._getLabelProps()),sharingHintProps:o,onSharedWithClick:this._showPermissionsList,loadFloodgateDataSource:this.context.loadFloodgateDataSource,shareType:n.shareType,getStatusIcons:this._getStatusIcons}))):v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.c,Object(a.e)({},Object(V.e)(this.props),{shareType:n.shareType,itemName:i.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:o,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,generatedFromTargetClick:n.shareTargetClicked,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:null===(e=this.state.sharingInfoBarInformation)||void 0===e?void 0:e.sharingInfoBarMessageTypeId,engagementExtraData:this._engagementExtraData,onRenderComplete:r&&function(){t._writeShareDataToRumoneLogger({mode:t.props.mode,viewState:t.state.viewState})}})))},t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,F.t.CopyLinkSettingsHint,e):null},t.prototype._renderPermissionsPivot=function(){var e=this;return this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!0),v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.o,{engagementExtraData:this._engagementExtraData,sharingInformation:this.state.sharingInformation,clientId:this.props.clientId,onDefaultShare:function(){return e._showShare()},showCloseButton:!I._(this.props.clientId),onDismiss:this._dismiss,store:this._store,companyName:this.state.companyName,onStopSharingClicked:this.props.onStopSharingClicked,pageContext:this.props.pageContext,advancedUrl:this.props.advancedUrl,mode:this.props.mode,backButtonClicked:this._returnToPreviousView,getGraphToken:this.props.getGraphToken,sensitivityLabelInformation:this.state.sharingInformation.sensitivityLabelInformation}))},t.prototype._showShare=function(){this._viewStates.push(this.state.viewState),this.setState({viewState:Y.e.default})},t.prototype._renderPermissionsList=function(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);var e=!1;return L.s(this.state.currentSettings.audience,this.state.sharingInformation.sharingAbilities)&&(e=!0),this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===G.e.list&&H.m(),H.P()&&this._viewStates.push(this.state.viewState),v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.r,Object(a.e)({},this._baseProps,{onStopSharingClicked:this.props.onStopSharingClicked,centeredManageAccessEnabled:!0,grantAccessClicked:this._enterGrantAccessView,shareButtonClicked:this._enterShareView,showHeader:!0,advancedUrl:this.props.advancedUrl,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData,isInfectedFile:e})))},t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return v.createElement(v.Suspense,{fallback:v.createElement(b.e,null)},v.createElement(J.a,Object(a.e)({},this._baseProps,{backButtonClicked:this._enterManageAccessView,centeredManageAccessEnabled:!0,onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked})))},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return v.createElement(C.e,{message:A.z})},t.prototype._resizeIfNeeded=function(){R.a()&&this.state.viewState===Y.e.shareToTeams||this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._getModifiedSharingLinkUrl=function(e,t){var n=e.url;if(t!==c.e.copy&&t!==c.e.outlook)return n;var a=this._getBase62Id(),i=new E.e(n);if(Object($.e)()||i.setQueryParameter("e",a),!this._store.getOptInSendNavIdInShareLink()){var r=this._store.getNavId();r&&i.setQueryParameter("nav",r)}if(H.O()){var o=this._store.getInvitationId();o&&i.setQueryParameter("inviteid",o)}return i.toString()},t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")},t.prototype._setGenericErrorState=function(e,t,n){var a,i=this,r=Object(Z.t)(this.state.sharingInformation,e,t,n);null===(a=this.props.shareLoadingCustomerPromise)||void 0===a||a.forEach(function(t){return Object(Z.a)({customerPromise:t,rawErrorMessage:r.rawError,engagementExtraData:i._engagementExtraData,errorType:e,sharingStore:i._store})}),this.setState({sharingInformation:r,viewState:Y.e.error}),H.ie()&&window.parent.postMessage(JSON.stringify({name:"share_resetMakeVisible"}),"*")},t.prototype._sanitizeSharingContextInfo=function(e){if(e&&(this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl=""),this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl=""),e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url=""),e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url=""),e.sharingLinks))for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")},t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||0===e.toLowerCase().indexOf("http://")||0===e.toLowerCase().indexOf("https://")},t.prototype._logRumone=function(){var e,t,n=this,a=function(){n._isInitialPageLoadDataLogged=!0;var e=n.props.mode,t=n.state.viewState;setTimeout(function(){n._writeShareDataToRumoneLogger({mode:e,viewState:t})},0)},i=this.state.viewState===Y.e.linkSuccess;if(this._showSimplifiedDialog&&this.state.copyLinkToastStatus===we.e.success&&(i=!0),(this.props.mode===d.e.share||this.props.mode===d.e.copy)&&this.state.shareTargetClicked&&i)e=n.props.mode,t=n.state.viewState,setTimeout(function(){n._writeCopyLinkTargetDataToRumoneLogger({mode:e,viewState:t,clickTime:n._copyTargetClickTime})});else if(this.state.viewState===Y.e.linkSuccess&&this.props.mode===d.e.copy)this._isInitialPageLoadDataLogged=!0;else if(!this._isInitialPageLoadDataLogged)switch(this.props.mode){case d.e.share:this.state.viewState!==Y.e.default||this.state.shareTargetClicked||a();break;case d.e.copy:this.state.viewState!==Y.e.linkSuccess||this.state.shareTargetClicked||a();break;case d.e.manageAccess:this.state.viewState!==Y.e.permissionsList&&this.state.viewState!==Y.e.permissionsPivot||a();break;case d.e.linkSettings:this.state.viewState===Y.e.linkSettings&&a();break;case d.e.atMention:this.state.linkRecipients.length>0&&a()}},t.prototype._writeShareDataToRumoneLogger=function(e){var t=e.mode,n=e.viewState,a=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart;this._writePerfData({pageTransitionType:Q.e.fullPageLoad,startTime:a,mode:this.props.mode,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})},t.prototype._writeCopyLinkTargetDataToRumoneLogger=function(e){if(this._rumoneLogger.resetRumOne()){var t=e.mode,n=e.viewState,a=e.clickTime;this._writePerfData({pageTransitionType:Q.e.onePageAppNavigation,startTime:a,mode:d.e.copy,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})}},t.prototype._writePerfData=function(e){var t=this,n=e.pageTransitionType,a=e.startTime,i=e.mode,r=e.originalMode,o=e.viewState,s=e.originalViewState,c=e.audience;if(this.props&&a&&this.props.clientId){var l=Object.keys(d.e).filter(function(e){return d.e[e]===i})[0],f=Object.keys(d.e).filter(function(e){return d.e[e]===r})[0],p=Object.keys(u.e).filter(function(e){return u.e[e]===t.props.clientId})[0],m=this._store.getSharingInformationAPIStats(),_=this._store.getShareLinkAPIStats(),h=this._store.getWaitSharingAPIsDuration?this._store.getWaitSharingAPIsDuration():null,b=this._rumoneLogger.breakdownData,g={modeName:l,startTime:a,endTime:Date.now(),breakDownData:{sharingClientId:b(p),mode:b(l),audience:b(c),originalMode:b(f),viewState:b(o),originalViewState:b(s),getSharingInformationAPIStats:m?b(m):null,shareLinkAPIStats:_?b(_):null,realUserClickTime:b(a!==performance.timing.navigationStart),beforeNavigation:b(a<performance.timing.navigationStart?performance.timing.navigationStart-a:0),isInstantSecondLoad:!!this.props.isInstantSecondLoad,isLightSpeed:!0,waitSharingAPIsDuration:h}};this._rumoneLogger.logSharingPerformance(g,n)}},t.prototype._flushAriaAndReportError=function(e){var t=this,n=Promise.resolve();this.props.flushTelemetry&&(n=this.props.flushTelemetry()),n.then(function(){setTimeout(function(){t._sharingClientMessenger?t._sharingClientMessenger.sendShareError(e):k._(t._shareClickTime,t.props.clientId,t.props.mode,t.props.scenarioId,e,t._correlationId)},0)})},t.childContextTypes={hasTeamsLicense:y.bool},t.contextTypes={resize:y.func.isRequired,onDismiss:y.func.isRequired,sharingStore:y.object.isRequired,shareClickTime:y.number,shouldTeachingBubbleBeShown:y.func,onTeachingBubbleSeen:y.func,markTeachingBubbleAsDismissed:y.func,sharingClientMessenger:y.object,loadFloodgateDataSource:y.func,platformDetection:y.object.isRequired},t}(v.Component)}],Array(51),[function(e,t,n){"use strict";var a=n(67),i=function(){function e(e){var t=this;this.resolve=function(e){t._promise._completed(e)},this.reject=function(e){t._promise._error(e)},this._promise=new a.e(e)}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.getPromise=function(){return this._promise},e.prototype.cancel=function(){this._promise.cancel()},e.prototype.complete=function(e){this._promise._completed(e)},e.prototype.error=function(e){this._promise._error(e)},e}();t.e=i},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.anonymous=1]="anonymous",e[e.msa=2]="msa",e[e.aad=3]="aad"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.t={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(35);function i(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.r)(n.getMonth()+1+"",2),s=Object(a.r)(n.getDate()+"",2),c=Object(a.r)(n.getHours()+"",2),d=Object(a.r)(n.getMinutes()+"",2),l=Object(a.r)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.r)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.r)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={anyone:0,organization:1,specificPeople:2}},function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}}],Array(19),[function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.default=0]="default",e[e.powerpoint=1]="powerpoint",e[e.stream=2]="stream"}(a||(a={}))}])]),define("plt.odsp-common",[],{});