'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1271:function(u,C,a){a.r(C);u=a(0);var c=a(15);class b{constructor(l,k,n,v,x,w){l&&(this.N=l);k&&(this.S=k);n&&(this.M=n);v&&(this.F=v);null!=x&&(this.L=x);null!=w&&(this.C=w)}}Object(u.a)(b,"SerializableExceptionEntry",null,[]);class f{constructor(l,k,n,v,x){this.T=l;this.L=k;this.S=n;this.I=v;this.V=x}}Object(u.a)(f,"SerializableLogCache",null,[]);class e{constructor(l,k,n,v,x,w,r=!1,t=null,A=null){this.T=
this.G=0;this.C=this.M=null;this.D=0;this.G=w;this.T=v;this.M=l;this.C=k;this.D=1E3*x+n;r&&(this.O=1);t&&(this.A=t);A&&(this.E=A)}Ach(){if(!this.E)return 0;let l=7,k=0;this.E.N&&(l+=6+e.Rba(this.E.N),k++);this.E.S&&(l+=6+e.Rba(this.E.S),k++);this.E.M&&(l+=6+e.Rba(this.E.M),k++);this.E.F&&(l+=6+e.Rba(this.E.F),k++);this.E.L&&(l+=6+e.Rba(this.E.L),k++);this.E.C&&(l+=6+e.Rba(this.E.C),k++);1<k&&(l+=k-1);return l}Vhh(){let l=a(1271).LogCache.BPi+e.Rba(this.G)+e.Rba(this.T)+this.M.length+e.Rba(this.C)+
e.Rba(this.D)+this.Ach();1===this.O&&(l+=6);if(this.A){l+=7;for(let k=0,n=this.A.length;k<n;++k)l+=this.A[k].length+3}return l}static Rba(l){return(""+l).length}}Object(u.a)(e,"SerializableLogEntry",null,[]);var d=a(389);a.d(C,"LogCache",function(){return h});class h{constructor(l,k,n){this.k_c=0;this.q_b=null;this.NEa=this.L2b=this.amb=0;this.lZc=l;this.i_a=k;this.Qaa=n;this.lZc=262144>l?l:262144;this.wKg=this.lZc-4*(this.i_a+25);this.reset()}reset(){this.q_b=[];this.amb=25;this.k_c=(new Date).getTime()}get count(){return this.q_b.length}get dVb(){return this.L2b}set dVb(l){this.L2b=
l}wTg(l){if(l){l.message=this.qUb(l.message,"message",l.tag);var k=l.zhd;k&&(k.name=this.qUb(k.name,"Exception.Name",l.tag),k.stack=this.qUb(k.stack,"Exception.Stack",l.tag),k.message=this.qUb(k.message,"Exception.Message",l.tag),k.file=this.qUb(k.file,"Exception.File",l.tag));if(l.Ph)for(var n=0;n<l.Ph.length;n++)l.Ph[n].length>this.i_a&&(l.Ph[n]=l.Ph[n].substr(0,this.i_a-13)+"... [trimmed]",c.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",n,d.a(l.tag)));k=k?new b(k.name,k.stack,k.message,
k.file,k.line,k.column):null;l=new e(l.message,l.category,l.level,l.timestamp-this.k_c,l.zDd,l.tag,l.eEi,l.Ph,k);k=l.Vhh();0<this.L2b&&k+this.amb>this.L2b&&(n=this.count,this.reset(),c.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",n));Array.add(this.q_b,l);this.amb+=k}}qUb(l,k,n){let v=l;l&&l.length>this.i_a&&(v=l.substr(0,this.i_a-13)+"... [trimmed]",c.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",k,d.a(n)));return v}get xAi(){return this.amb>
this.wKg}serialize(){return c.ULS.Zc(new f(this.k_c,this.q_b,this.Qaa,this.NEa,1))}get a1d(){return this.lZc}get bDd(){return this.i_a}}h.BPi=31;Object(u.a)(h,"LogCache",null,[42,43])},1515:function(u,C,a){a.r(C);u=a(647);C=a(0);var c=a(15),b=a(88),f=a(82);class e{constructor(){$addHandler(document,"securitypolicyviolation",Object(b.a)(this,this.RQf,"onSecurityPolicyViolationEventHandler"))}RQf(oa){oa=oa.rawEvent;let Da=oa.blockedURI;Da=f.a.Mfa(Da);const bb={};bb.effectiveDirective=oa.effectiveDirective;
bb.violatedDirective=oa.violatedDirective;bb.originalPolicy=oa.originalPolicy;bb.blockedURI=Da;bb.disposition=oa.disposition;c.ULS.sendTraceTag(588084128,306,15,"{0}",bb)}dispose(){$removeHandler(document,"securitypolicyviolation",Object(b.a)(this,this.RQf,"onSecurityPolicyViolationEventHandler"))}}Object(C.a)(e,"ContentSecurityPolicyListener",null,[2]);var d=a(260);class h{constructor(){this.Db=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.Db.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const oa=
this.Db.ah("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");oa&&oa.dispose()}Di(oa){this.Db=oa;this.Db.register(e,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").Uc().dd(()=>new e)}static main(){d.a.instance.nj(new h)}}Object(C.a)(h,"ContentSecurityPolicyPackage",null,[4,5]);var l=a(43);class k{constructor(){this.File=this.Message=null;this.Column=this.Line=0;this.ClientAppVersion=this.Stack=null;this.AppMode=this.AppType=0;this.DeobfuscateWithSourceMaps=!1;this.DataPlumber=
this.SessionStartInfoJson=null;this.IsShuttingDown=!1;this.ErrorName=this.Flight=null}VWd(){return l.c(this)}}Object(C.a)(k,"DiagnosticsRequest",null,[]);var n=a(6),v=a(489),x=a(470),w=a(34);class r{constructor(oa,Da,bb,Za,Xa){this.CIa=oa;this.BFa=Da;this.o3=bb;this.NMc=Za;this.YIg=Xa}qbg(oa,Da){try{this.voh().send(this.KYh(oa,Da))}catch(bb){c.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",bb.toString())}}voh(){const oa=new XMLHttpRequest;oa.open("POST",this.CIa,!0);oa.setRequestHeader("Content-Type",
"text/json; charset=utf-8");n.AFrameworkApplication.userSessionId&&oa.setRequestHeader(x.a.nKc,w.a.Pma(n.AFrameworkApplication.userSessionId));this.BFa&&oa.setRequestHeader(x.a.mBa,this.BFa);if(n.AFrameworkApplication.de){const Da=n.AFrameworkApplication.de.pQ;Da&&oa.setRequestHeader(x.a.Akb,Da)}return oa}KYh(oa,Da){if(!oa)return null;Da=Da?"<stack>"+Da+"</stack>":"";const bb=new k;bb.Message=oa.message;bb.File=oa.source;bb.Line=oa.line;bb.Column=oa.column;bb.Stack=Da;bb.ClientAppVersion=this.BFa;
bb.AppType=this.o3;bb.AppMode=this.NMc;bb.DeobfuscateWithSourceMaps=this.YIg;n.AFrameworkApplication.fa.ra("JavaScriptCrashJsonTagEnabled")&&(bb.SessionStartInfoJson=n.AFrameworkApplication.fa.appSettings.SessionStartInfoJson||"",n.AFrameworkApplication.Bf&&(bb.DataPlumber=l.c(n.AFrameworkApplication.Bf)),bb.IsShuttingDown=n.AFrameworkApplication.Wg,bb.Flight=n.AFrameworkApplication.flightId,bb.ErrorName=v.a.q9e(oa));return bb.VWd()}}Object(C.a)(r,"JavascriptErrorReporter",null,[632]);class t{build(oa,
Da,bb,Za,Xa){return new r(oa,Da,bb,Za,Xa)}}Object(C.a)(t,"JavascriptErrorReporterFactory",null,[610]);class A{Di(oa){oa.register(t,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").Uc().dd(()=>new t)}get name(){return"Common.App.Diagnostics"}init(){}dispose(){}static main(){d.a.instance.nj(new A)}}Object(C.a)(A,"DiagnosticsPackage",null,[4,5]);var y=a(54),z=a(104),E=a(229),G=a(40),F=a(170),O=a(425),M=a(42),P=a(63),B=a(46),D=a(1271);class I{constructor(oa=
null,Da=null,bb=null,Za=null,Xa=null,Ba=null,Wa=null,Na=null){this.bDd=3072;this.a1d=65536;this.Nug=6E4;this.fog=2E3;this.DSe=1E4;this.cDe=5E3;this.$Ce=!1;this.dVb=0;null!=oa&&(this.bDd=oa);null!=Da&&(this.a1d=Da);null!=bb&&(this.Nug=bb);null!=Za&&(this.fog=Za);null!=Xa&&(this.DSe=Xa);null!=Ba&&(this.cDe=Ba);null!=Wa&&(this.$Ce=Wa);null!=Na&&0<Na&&(this.dVb=Na)}}Object(C.a)(I,"UlsUploadConfiguration",null,[]);var S=a(389);class J{constructor(oa,Da,bb=null){this.yYb=0;this.TPc=!1;this.IJb=0;this.jmb=
null;this.Lqb=0;this.yh=null;this.JYd=this._disposing=!1;this.uD=this.h_c=this.XWb=this.TXb=0;this.GCc=!1;this.nYa=0;bb||(bb=new I);this.IYc=oa;this.MY=Da;this.MY.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&c.ULS.disable();this.$Pg=bb.Nug;this.wPg=bb.fog;this.FFg=bb.DSe;this.aQg=bb.cDe;this.lDg=bb.$Ce;this.qta=new D.LogCache(bb.a1d,bb.bDd,oa);this.qta.dVb=bb.dVb;this.ZTd();this.p7f();this.q7f()}p7f(){this.jmb=[];this.TPc=!1}FW(oa){1<this.Djb?256>this.jmb.length?
Array.add(this.jmb,oa):this.TPc=!0:(this.qta.wTg(oa),this.bQi(oa)&&!this.STe()?(this.a5e("LogIndicatesError in HandleTrace"),c.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",S.a(oa.tag))):this.qta.xAi&&(this.Bzb(!1,!0),c.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))}bQi(oa){return!!oa&&(1===oa.zDd||10===oa.level)}STe(){return!1}dispose(){this._disposing||(this._disposing=!0,this.AUh(),c.ULS.MYd(null),window.clearTimeout(this.nYa),
window.clearTimeout(this.TXb),window.clearTimeout(this.XWb),this.XWb=this.TXb=this.nYa=0)}AUh(){this.mode=2;this.ghf();this.GCc=!1;this.lXe();this.a5e("FlushForAppClose")}cVb(oa,Da){oa.NEa=this.IJb;return this.Oug(oa.serialize(),Da)?(this.IJb++,!0):!1}Oug(oa,Da){Da=this.lDg||!Da;this.yh&&Da||(this.yh=new XMLHttpRequest);if(0===this.yh.readyState||4===this.yh.readyState)return this.yh.open("POST",this.MY,Da),this.yh.setRequestHeader("Content-Type","application/json"),this.yh.setRequestHeader(J.kXd,
this.IYc),Da&&(this.yh.timeout=this.aQg),this.yh.send(oa),!0;c.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{["UploadId"]:this.IJb,["XhrReadyState"]:this.yh.readyState});return!1}vdj(){this.yh&&this.yh.abort()}TDc(oa,Da,bb){try{return window.setTimeout(()=>{c.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",Da,bb);oa()},Da)}catch(Za){c.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",
Za.toString());if(!this.JYd){this.JYd=!0;try{oa()}finally{this.JYd=!1}}return 0}}q7f(){try{window.clearTimeout(this.TXb)}catch(oa){c.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",oa.toString())}this.TXb=this.TDc(Object(b.a)(this,this.ghf,"handleDelayedLogs"),this.FFg,"ResetDelayedLoggingTimer")}get Djb(){return c.ULS.Djb+this.Lqb}ghf(){const oa=this.jmb.length;if(oa){var Da=this.jmb,bb=this.TPc;this.p7f();c.ULS.sendTraceTag(3731798,
100,50,"HandleDelayedLogs {0}",{["Count"]:oa,["Limit"]:256,["ExceededLimit"]:bb});this.Lqb++;for(bb=0;bb<oa;bb++)this.FW(Da[bb]);this.Lqb--}this.q7f()}ZTd(){try{window.clearTimeout(this.XWb)}catch(oa){c.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",oa.toString())}this.XWb=this.TDc(Object(b.a)(this,this.Bzb,"flushImpl"),this.$Pg,"ResetCadenceTimer")}get mode(){return this.uD}set mode(oa){const Da=this.uD;this.uD=oa;if(0===this.uD&&0!==Da)try{const bb=
this.h_c;this.h_c=0;window.clearTimeout(bb)}catch(bb){c.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",bb.toString())}else 0!==this.uD&&0===Da&&(this.h_c=this.TDc(Object(b.a)(this,this.lXe,"endThrottling"),this.wPg,"ThrottlingMode Setter"))}lXe(){this.mode=0;this.GCc&&(this.GCc=!1,this.Bzb())}dSb(oa){return 2===this.mode||1===this.mode&&!oa}a5e(oa){c.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",oa);this.Bzb(!0)}zzb(){this.Z4e(0)}Z4e(oa){this.nYa||
(this.nYa=this.TDc(Object(b.a)(this,this.Bzb,"flushImpl"),oa,"FlushAsynchronous"))}Bzb(oa,Da){this.Lqb++;try{window.clearTimeout(this.nYa)}catch(Za){c.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",Za.toString())}this.nYa=0;if(this.qta.count)if(!Da&&this.dSb(oa))c.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",oa?"sync":"async"),this.GCc=!0;else{this.mode=oa?2:1;this.ZTd();c.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",
oa?"sync":"async",this.qta.count);try{var bb=this.cVb(this.qta,oa)}catch(Za){this.vdj(),bb=!1}bb?(this.qta.reset(),this.yYb=0):(this.yYb++,this.yYb<J.LDf?this.Z4e(J.jBc):(this.qta.reset(),this.IJb++,this.yYb=0))}else this.ZTd();this.Lqb--}pCb(){}esb(){}}J.LDf=3;J.jBc=15E3;J.kXd="X-UserSessionId";Object(C.a)(J,"UploadingUlsHost",null,[19,2]);const L=oa=>{let Da=0;n.AFrameworkApplication.fa&&(Da=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.bUlsFetchRequestOption",-1),-1===
Da&&(Da=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.bUlsFetchRequestOption",0)));return Da===oa};class R{constructor(oa,Da,bb,Za){this.NEa=oa;this.S4c=Da;this.sessionId=bb;this.version=Za}}Object(C.a)(R,"UploadState",null,[]);class Y{constructor(oa){this.PJg=oa}get OKi(){return this.PJg}}Object(C.a)(Y,"FetchRequestArgs",null,[]);var Q=a(84),W=a(542);class Ga extends Sys.EventArgs{constructor(oa){super();this.Ph=oa}}Object(C.a)(Ga,"UlsLoggingEventArgs",Sys.EventArgs,
[]);var pa=a(190);class aa extends J{constructor(oa,Da,bb,Za,Xa,Ba=null){super(n.AFrameworkApplication.userSessionId,aa.nXh(aa.M0h(oa,Za),Da,bb,Ba),new I(void 0,n.AFrameworkApplication.nii(),Za.oe("BulsUploadFrequencyInMs",6E4),void 0,void 0,void 0,void 0,n.AFrameworkApplication.k7b));this.gee=!1;this.NXc=this.yqb=this.GWb=this.MH=null;this.lh=bb;this.esa=Za;(this.wqb=this.esa.Va("RemoteUlsETag"))&&aa.HYf(this.esa.Va("RemoteUlsSuppressions"));Xa&&(this.GWb=Xa,this.GWb.D2c(Object(b.a)(this,this.oRf,
"onSettingsRefreshed")))}get events(){return this.MH||(this.MH=new Sys.EventHandlerList)}esb(oa){this.events.addHandler(aa.jrg,oa)}get Hdb(){return null}get JLd(){return null}get l5c(){return this.esa.ra("BUlsExceptionLoggingIsEnabled")}dispose(){this.gee||(this.gee=!0,super.dispose(),this.GWb&&this.GWb.T4f(Object(b.a)(this,this.oRf,"onSettingsRefreshed")))}oRf(oa,Da){Da.cab(aa.p3d)&&(this.yqb=this.cff())}l1h(){return Error().stack}cff(){let oa=null;if(this.esa.Dq(aa.p3d)){oa=new pa.a;const Da=this.esa.Kw(aa.p3d);
for(let bb=0;bb<Da.length;bb++)oa.ia(Da[bb],!0)}return oa}FW(oa){this.yqb||(this.yqb=this.cff());if(this.yqb&&this.yqb.Fb(oa.tag))try{!oa.zhd&&this.l5c?oa.zhd=new W.a(Error()):oa.message+=". JsCallStack: "+this.l1h()}catch(bb){oa.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+this.l5c+" ("+bb.message+")]"}super.FW(oa);const Da=this.events.getHandler(aa.jrg);oa=new Ga(oa);Da&&Da(null,oa)}cVb(oa,Da){if(this.lh){if(!this.qWj)return!1;const bb=oa.serialize();if(0<n.AFrameworkApplication.k7b&&
bb.length>n.AFrameworkApplication.k7b)return!1;oa.NEa=this.IJb++;if(L(0)){if(this.ihg())return this.EQb(this.MY,bb),!0;this.jxe(this.MY,bb,Da&&!this.Hdb?0:3,1,Da&&n.AFrameworkApplication.Wg,oa.NEa,this.Hdb,this.JLd)}else{if(this.ihg()){if(L(1))return this.EQb(this.MY,bb),!0;window.console&&window.console.log&&window.console.log("Send shuttingDown buls from common")}this.X1c(this.MY,bb,3,1,oa.NEa,this.Hdb,this.JLd)}return!0}return L(0)?super.cVb(oa,Da):(this.aKj(this.MY,oa.serialize()),!0)}Rvc(oa){try{if(oa&&
oa.data&&oa.data.responseHeaders&&aa.QCb in oa.data.responseHeaders){var Da=oa.data.responseHeaders[aa.QCb];Da!==this.wqb&&(this.wqb=Da,aa.HYf(oa.data.responseHeaders[aa.Yrd]))}}catch(bb){c.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",bb.message,bb.stack)}}vuc(oa){const Da=oa.data;if(!Da)c.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",oa);else if(13===Da.status)c.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),
this.Oug(Da.request.get_body(),!1);else if(!Da.responseHeaders)c.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",Da.id,Da.mUa,Da.Fe,Da.httpStatus);else if(!(aa.$wi in Da.responseHeaders||(oa=Da.httpStatus,400<=oa&&499>=oa))){var bb=Da.state;bb.S4c>=J.LDf||(L(0)?window.setTimeout(()=>{this.jxe(Da.request.get_url(),Da.request.get_body(),3,bb.S4c+1,!1,bb.NEa,bb.sessionId,bb.version)},J.jBc):window.setTimeout(()=>
{this.X1c(Da.request.get_url(),Da.request.get_body(),3,bb.S4c+1,bb.NEa,bb.sessionId,bb.version)},J.jBc))}}jxe(oa,Da,bb,Za,Xa,Ba,Wa,Na){L(0)?this.lh.Fn(oa,2,Da,this.Uad(),!1,bb,Object(b.a)(this,this.Rvc,"onSuccessfulUpload"),Object(b.a)(this,this.vuc,"onFailedUpload"),new R(Ba,Za,Wa,Na),null,Xa,this.esa.oe("BulsClientRequestManagerQueueTimeInMS",3E4),void 0,"19",Wa,void 0,Na,[aa.QCb,aa.Yrd]):this.X1c(oa,Da,bb,Za,Ba,Wa,Na)}X1c(oa,Da,bb,Za,Xa,Ba,Wa){let Na;Na=L(2)||L(3)?new Y(!0):new Y(!1);this.lh.WSg(oa,
Da,this.Uad(),Na,bb,Object(b.a)(this,this.Rvc,"onSuccessfulUpload"),Object(b.a)(this,this.vuc,"onFailedUpload"),new R(Xa,Za,Ba,Wa),this.esa.oe("BulsClientRequestManagerQueueTimeInMS",3E4),Ba,Wa,[aa.QCb,aa.Yrd])}aKj(oa,Da){const bb={};bb.body=Da;bb.method="POST";bb.headers=this.Uad();if(L(2)||L(3))bb.keepalive=!0;window.fetch(oa,bb).then(()=>null,()=>{c.ULS.sendTraceTag(509149207,100,50,"exception from buls fetch");return null})}Uad(){let oa=null;this.wqb&&(oa={},oa[aa.QCb]=this.wqb);if(this.l5c){const Da=
n.AFrameworkApplication.sa;let bb=null;Da&&(bb=Da.Qa);bb&&(oa||(oa={}),oa[aa.soi]=bb.kBa,oa[aa.toi]=bb.Ii,oa[aa.yoi]=n.AFrameworkApplication.Izi?"1":"0",L(0)||(oa[aa.loi]="text/plain"))}return oa}EQb(oa,Da){this.lh.EQb(oa,Da)}ihg(){return n.AFrameworkApplication.Wg||n.AFrameworkApplication.apc}get oEj(){this.NXc||(this.NXc=this.esa.oe("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6E4));return this.NXc}get qWj(){const oa=this.lh.B$a;return oa&&(new Date).getTime()-this.lh.yLi.getTime()>=this.oEj?
!0:!oa}static M0h(oa,Da){Da=Da.Va("BulsEndpointUrl");return aa.Asf(Da)?Da:oa}static Asf(oa){return!(void 0===oa||null===oa)&&""!==oa}static nXh(oa,Da,bb,Za){oa=aa.iSg(oa,Da);oa=aa.uVg(oa,bb);oa=aa.LTg(oa,Za);return oa=aa.rVg(oa)}static iSg(oa,Da){return Da?f.a.Pl(oa,"build",n.AFrameworkApplication.buildVersion):oa}static uVg(oa,Da){if(!Da)return oa;Da=Da.pQ;return Da?oa=f.a.Pl(oa,x.a.TKc,Da):oa}static LTg(oa,Da){return aa.Asf(Da)?f.a.Pl(oa,"officeserverversion",Da):oa}static rVg(oa){return n.AFrameworkApplication.userSessionId&&
""!==n.AFrameworkApplication.userSessionId?f.a.Pl(oa,n.AFrameworkApplication.zXa,n.AFrameworkApplication.userSessionId):oa}static HYf(oa){c.ULS.T8b();if(oa){oa=oa.split(",");for(const Da of oa)oa=parseInt(Da),!isNaN(oa)&&isFinite(oa)&&c.ULS.k4b(oa)}}}aa.QCb="X-bULS-SuppressionETag";aa.Yrd="X-bULS-SuppressedTags";aa.soi="X-bULS-OfficeAppMode";aa.toi="X-bULS-OfficeAppType";aa.yoi="X-bULS-UseSourceMaps";aa.loi="Content-Type";aa.jrg="CommonUlsTraceEventKey";aa.p3d="TagCallStackInclusionList";aa.$wi="X-InvalidUlsJson";
Object(C.a)(aa,"CommonUlsHost",J,[]);var Z=a(105);class fa extends aa{constructor(oa,Da){super(oa,!1,n.AFrameworkApplication.de,Q.a.instance.ah("Common.IRefreshableAppSettings")||n.AFrameworkApplication.fa,Q.a.instance.ah("Common.IRefreshableAppSettings"),Da);this.Tak="usu";this.Qak="ufu";this.Jb=null;this.Ra=new Z.a}get $(){this.Jb||(this.Jb=0<P.a.getRegisteredEwaInstances().length?P.a.wt(document.body):null);return this.Jb}FW(oa){1===oa.zDd&&(oa.message="Assert: "+oa.message);super.FW(oa)}STe(){return!0}cVb(oa,
Da){if(n.AFrameworkApplication.Wg&&n.AFrameworkApplication.bgb)return!1;let bb=null;this.$&&(bb=this.$.nc.qd("UserAction","CommonUlsHostOverrides:UploadLogs"));Da=!n.AFrameworkApplication.bgb&&Da;oa=super.cVb(oa,Da);bb&&bb.stop();return oa}Rvc(oa){super.Rvc(oa);this.Ra.raiseEvent(this.Tak,oa)}vuc(oa){super.vuc(oa);this.Ra.raiseEvent(this.Qak,oa)}}Object(C.a)(fa,"CommonUlsHostOverrides",aa,[603,19,2]);class ya{Jmh(oa,Da){return new fa(oa,Da)}}Object(C.a)(ya,"CommonHostFactory",null,[631]);var Aa=a(1),
ja=a(64);class za extends M.a{constructor(oa){super();this.w9b=oa;Sys.Application.registerDisposableObject(this)}esb(oa){this.w9b.esb(oa)}FW(oa){this.w9b.FW(oa)}pCb(oa){this.w9b.pCb(oa)}zzb(){this.w9b.zzb()}static la(oa,Da=null){const bb=new F.a;Object(O.a)(za,n.AFrameworkApplication.kEa)||(Da=Da||new ya,B.a.bui(()=>{var Za;if(n.AFrameworkApplication.browserUlsIsEnabled){var Xa=oa+"/RemoteUls.ashx";za.$&&(Xa=za.CUg(Xa));const Ba=Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7636252_BUlsOfficeServerVersion")?
this.hef():null;Xa=Da.Jmh(Xa,Ba);Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7636258_DisposeCommonUlsHostInExcel")&&(null===(Za=n.AFrameworkApplication.kEa)||void 0===Za?void 0:Za.dispose());n.AFrameworkApplication.kEa=Xa;c.ULS.pVa(50);c.ULS.MYd(Xa);bb.setResult(new za(Xa))}else c.ULS.disable()},!n.AFrameworkApplication.aUj()));return bb.task}static CUg(oa){const Da=this.hef();return f.a.Pl(oa,"officeserverversion",Da)}static hef(){return za.$?ja.d(za.$)?za.$.workbookContext.BuildVersion:za.$.xa.BuildVersion:
null}static get $(){za.Jb||(za.Jb=0<P.a.getRegisteredEwaInstances().length?P.a.wt(document.body):null);return za.Jb}}za.Jb=null;Object(C.a)(za,"EwaUlsHost",M.a,[603,19,2]);class ra extends E.a{constructor(oa){super();this.$pa=oa;this.kc()}create(){G.TaskExtensions.za(za.la(this.$pa),oa=>{oa=oa.result;z.a.rm.Ja(135,oa);this.Pb(oa)},this.ka)}}Object(C.a)(ra,"EwaUlsHostFactory",E.a,[]);var fb=a(161),Ua=a(38);class Ca{constructor(oa){this.ome=null;this.eKi=oa}get mHd(){return this.ome||(this.ome={})}tmj(oa,
Da,bb){!oa&&Da.source&&(oa=Ua.a.er(this.mHd,Da.source)+1,this.mHd[Da.source]=oa,oa-1&oa||c.ULS.sendTraceTag(537155536,0,15,`${oa} errors seen for location=${Da.source}`));Da.source&&1!==Ua.a.er(this.mHd,Da.source,1)||(c.ULS.sendTraceTag(537155535,0,50,"JavaSctipCrashProcessor.ProcessJavascriptError: Sending request to log JavaScript crash in the server"),this.eKi.qbg(Da,bb))}}Object(C.a)(Ca,"JavaScriptCrashProcessor",null,[458]);var Ia=a(77);Type.registerNamespace("_Ewa");Object(u.a)();Type.registerNamespace("Common.App.ContentSecurityPolicy");
h.main();Type.registerNamespace("Common.App.Diagnostics");A.main();Type.registerNamespace("DiagUse");z.a.rm.Ja(43,new ra(y.a.current.cM.ServerUriBase));(()=>{try{fb.a.ngf().continueWith(oa=>{try{if(z.a.rm.Ba(42))c.ULS.sendTraceTag(537155532,0,50,"JavaScriptCrashProcessorBootstrapper: already initialized");else{const Da=oa.result,bb=Q.a.instance.resolve("Common.IJavascriptErrorReporterFactory").build(y.a.current.cM.ServerUriBase+Da.LayoutsRelativeUri+"/diagnostics.ashx",Da.BuildVersion,1,0,!0);z.a.rm.Ja(42,
new Ca(bb));c.ULS.sendTraceTag(537155533,0,50,"JavaScriptCrashProcessorBootstrapper: initialized and ready to be used")}}catch(Da){c.ULS.sendTraceTag(537155531,0,15,`JavaScriptCrashProcessorBootstrapper: An exception occured while initializing JavascriptErrorProcessor, Message: ${Da.message}, Callstack: ${Da.stack}`)}},3,null,Ia.a.current)}catch(oa){c.ULS.sendTraceTag(537155530,0,15,`JavaScriptCrashProcessorBootstrapper: an exception occured, Message: ${oa.message}, Callstack: ${oa.stack}`)}})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.tmcore.js.map/5fa75b7eea360202007d5010ded0b839/EwaDSOpt.tmcore.js.map