'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1081:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{}c.vLc="b-ring_Apc_Trans";c.syg="cdn_static_resource_ewa_image";Object(u.a)(c,"ResourceHosts",null,[])},1082:function(u,C,a){a.d(C,"a",function(){return f});u=a(0);var c=a(61),b=a(1348);class f{static Okd(e,d,h,l=null){f.ftc||(f.ftc=Array.isArray(c.a.Xi(h.xa.NetworkMeasurementUrlList))?c.a.Xi(h.xa.NetworkMeasurementUrlList):null);const k=[];
for(let n=0;n<f.ftc.length;n++){const v=f.ftc[n];let x=v.key;x||(x=v.Key);if(l&&!l.includes(x))continue;let w=v.value;w||(w=v.Value);x&&w&&k.push(new b.a(h,x,w,e,d))}return k}}f.ftc=null;Object(u.a)(f,"NetworkConnectionHelpers",null,[])},1084:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1085:function(u,C,a){a.d(C,"a",function(){return e});u=a(0);var c=a(15),b=a(41),f=a(82);a=a(735);class e extends a.a{constructor(d,h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=e.EAa;this.Eya=!0}get linkText(){return e.oCf}Ooa(d){super.Ooa(d);b.a.openWindow(4,f.a.GI(e.nCf))}ME(d){super.ME(d);e.eEd&&e.eEd(null)}static initialize(d,h,l,k){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
e.EAa=d;e.oCf=h;e.nCf=l;e.eEd=k}}e.EAa=null;e.oCf=null;e.nCf=null;e.eEd=null;Object(u.a)(e,"WacGdprNoticeBusinessBarEntry",a.a,[])},1086:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{}c.dFh="ewa-bb";c.fFh="ewa-bb-entry";c.nFh="ewa-bb-react";c.gFh="ewa-bb-entry-body";c.mFh="ewa-bb-icon";c.iFh="ewa-bb-entry-icon";c.lFh="ewa-bb-entry-title";c.kFh="ewa-bb-entry-message";c.BYe="ewa-bb-entry-button";c.jFh="ewa-bb-entry-link";c.hFh="ewa-bb-entry-close";c.CYe="ewa-bb-entry-button-holder";
c.eFh="ewa-bb-content";Object(u.a)(c,"CssClassNames",null,[])},1087:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);a=a(735);class c extends a.a{constructor(b,f){super(b,f);this.Hs=!0;this.title=c.k3;this.message=c.j3}get actionButton(){return c.VY}Km(b){super.Km(b);(b=c.$T)&&b(null)}static initialize(b,f,e,d){c.k3=b;c.j3=f;c.VY=e;c.$T=d}}c.k3=null;c.j3=null;c.VY=null;c.$T=null;Object(u.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1088:function(u,C,a){a.d(C,"a",function(){return c});
u=a(0);a=a(735);class c extends a.a{constructor(b,f){super(b,f);this.Hs=!0;this.title=c.k3;this.message=c.j3}get actionButton(){return c.VY}Km(b){super.Km(b);(b=c.$T)&&b(null)}static initialize(b,f,e,d){c.k3=b;c.j3=f;c.VY=e;c.$T=d}}c.k3=null;c.j3=null;c.VY=null;c.$T=null;Object(u.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1089:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);a=a(872);class c extends a.a{constructor(b,f,e){super(b,f,e);c.VY&&c.$T&&(this.Hs=!0);this.title=c.k3;
this.message=c.j3}get actionButton(){return c.VY}static initialize(b,f,e,d){c.k3=b;c.j3=f;c.VY=e;c.$T=d}Km(b){super.Km(b);c.$T&&c.$T(null)}}c.k3=null;c.j3=null;c.VY=null;c.$T=null;Object(u.a)(c,"DataCleansingBusinessBarEntry",a.a,[])},1090:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);a=a(735);class c extends a.a{constructor(b,f){super(b,f);this.Hs=!0;this.title=c.k3;this.message=c.j3}get actionButton(){return c.VY}Km(b){super.Km(b);(b=c.$T)&&b(null)}static initialize(b,f,e,d){c.k3=b;c.j3=
f;c.VY=e;c.$T=d}}c.k3=null;c.j3=null;c.VY=null;c.$T=null;Object(u.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1091:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);a=a(735);class c extends a.a{constructor(b,f){super(b,f);this.Hs=!0;this.title=c.FIb;this.message=c.EAa}get actionButton(){return c.Cbb}Km(b){super.Km(b);c.GAa&&c.GAa(null)}static initialize(b,f,e,d){c.FIb=b;c.EAa=f;c.Cbb=e;c.GAa=d}}c.FIb=null;c.EAa=null;c.Cbb=null;c.GAa=null;Object(u.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",
a.a,[])},1092:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);a=a(735);class c extends a.a{constructor(b,f){super(b,f);c.Cbb&&c.GAa&&(this.Hs=!0);this.title=c.FIb;this.message=c.EAa}get actionButton(){return c.Cbb}Km(b){super.Km(b);c.GAa&&c.GAa(null)}static initialize(b,f,e,d){c.FIb=b;c.EAa=f;c.Cbb=e;c.GAa=d}}c.FIb=null;c.EAa=null;c.Cbb=null;c.GAa=null;Object(u.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1094:function(u,C,a){a.d(C,"a",function(){return v});u=a(0);C=
a(229);var c=a(792),b=a(52),f=a(426),e=a(40),d=a(725),h=a(100),l=a(149),k=a(36),n=a(71);class v extends C.a{constructor(x){super();this.$=x;this.kc()}create(){const x=b.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.La),w=Object(n.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(h.d)(l.a.resolve(k.h,{Wa:this.La})):b.GetServiceTaskFactory.Za(this.$.da,5,4,this.La),r=b.GetServiceTaskFactory.Za(this.$.da,388,387,this.La),t=Object(h.d)(l.a.resolve(k.S,{Wa:this.La})),A=b.GetServiceTaskFactory.Za(this.$.da,
257,258,this.La),y=f.a(this.$);e.TaskExtensions.za(e.TaskExtensions.ke([x,A,y,w,r,t],this.ka),()=>{this.Pb(Object(d.a)(this.$.da,271,()=>new c.ConvertToLinkedEntityManager(this.$,x.result,r.result,A.result,y.result,w.result,t.result)))},this.$.ka,3)}static la(x){x.da.Ja(272,new v(x))}}Object(u.a)(v,"ConvertToLinkedEntityManagerFactory",C.a,[])},1095:function(u,C,a){a.d(C,"a",function(){return c});const c=b=>{const f=Array(b.length);for(let e=0,d=b.length;e<d;e++)f[e]=b[e].cloneNode(!0);return f}},
1096:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1100:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1102:function(u,C,a){function c(k,n){this.ID=k;this.type=n}function b(k,n){this.value=k;this.contextId=n}function f(k,n,v,x,w,r,t,A){this.type=k;this.startTime=null==v||void 0==v.value?new b(v,null):v;this.endTime=null==x||void 0==x.value?new b(x,null):x;null!=w&&void 0!=w.value||new b(w,null);null!=r&&void 0!=r.value||new b(r,null);this.operationType=A}function e(k){this.ID=k}function d(){this.Df=[];this.Gsb=[];this.F3c=0;this.duration=this.startTime=null;this.Ycc={};this.gFd=this.MFd=this.j5c=-1}
function h(k){var n;return(null!=document.body.style.msTransform?n=k.style.msTransform:null!=document.body.style.webkitTransform?n=k.style.webkitTransform:null!=document.body.style.mozTransform?n=k.style.iok:null!=document.body.style.oTransform?n=k.style.mok:null!=document.body.style.transform&&(n=k.style.transform),n)?(n=n.replace("rotate(",""),n=n.replace("deg)",""),parseFloat(n)):0}a.d(C,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,
3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,.2,1);new c(21,3,.8,0,.2,1);f.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),Hok:new b(0,null),Knk:new b(0,
null),operationType:0};u=Array(1);u[0]=new b(0,0);new e(0,[new f(5,0,0,0,null,1,1,0)]);new e(1,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,50,null,1,1,0)]);new e(2,[new f(1,3,0,167,null,0,1,1),new f(2,3,0,167,null,0,1,1)]);new e(3,[new f(3,3,0,167,null,0,1,1),new f(4,3,0,167,null,0,1,1)]);new e(4,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,167,null,1,1,0)]);new e(5,[new f(5,2,0,167,null,0,1,0)]);new e(6,[new f(1,3,0,100,null,0,1,1),new f(2,3,0,100,null,0,1,1)]);new e(7,[new f(3,3,0,100,null,0,1,1),new f(4,
3,0,100,null,0,1,1)]);new e(8,[new f(5,2,0,100,null,1,1,0)]);new e(9,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,100,null,1,1,0)]);new e(10,[new f(5,2,0,100,null,0,1,0)]);new e(11,[new f(1,3,0,267,null,0,1,1),new f(2,3,0,267,null,0,1,1)]);new e(12,[new f(3,3,0,267,null,0,1,1),new f(4,3,0,267,null,0,1,1)]);new e(13,[new f(5,2,0,267,null,1,1,0)]);new e(14,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,267,null,1,1,0)]);new e(15,[new f(5,2,0,267,null,0,1,0)]);new e(16,[new f(6,3,0,267,null,0,1,1),new f(7,3,0,267,
null,0,1,1)]);new e(17,[new f(1,3,0,750,null,0,1,1),new f(2,3,0,750,null,0,1,1)]);new e(18,[new f(3,3,0,750,null,0,1,1),new f(4,3,0,750,null,0,1,1)]);new e(19,[new f(5,2,0,750,null,1,1,0)]);new e(20,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,750,null,1,1,0)]);new e(21,[new f(6,3,0,1E3,null,0,1,1),new f(7,3,0,1E3,null,0,1,1)]);new e(22,[new f(1,3,0,367,null,0,1,1),new f(2,3,0,367,null,0,1,1)]);new e(23,[new f(3,3,0,367,null,0,1,1),new f(4,3,0,367,null,0,1,1)]);new e(24,[new f(5,2,0,367,null,1,1,0)]);new e(25,
[new f(5,2,0,0,null,0,2,0),new f(5,2,0,367,null,1,1,0)]);new e(26,[new f(5,2,0,367,null,0,1,0)]);new e(27,[new f(6,2,0,u[0],null,0,1,1),new f(7,2,0,u[0],null,0,1,1)]);new e(28,[new f(5,2,0,0,null,1,1,0),new f(5,2,0,50,null,0,1,0)]);new e(29,[new f(1,3,0,433,null,0,1,1),new f(2,3,0,433,null,0,1,1)]);new e(30,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,50,null,1,1,0),new f(2,3,0,0,null,40,1,1),new f(2,3,0,100,null,0,1,1)]);new e(31,[new f(2,0,0,0,null,32,1,1),new f(2,0,0,100,null,32,1,1),new f(2,3,101,350,
null,0,1,1),new f(3,0,0,0,null,0,2,1),new f(3,0,0,100,null,0,2,1),new f(3,3,101,350,null,0,1,1),new f(5,0,0,0,null,0,2,0),new f(5,0,0,100,null,1,1,0)]);new e(32,[new f(2,3,0,267,null,32,1,1),new f(3,3,0,267,null,0,2,1),new f(5,2,0,0,null,1,0,0),new f(5,2,0,267,null,0,2,0)]);new e(33,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,100,null,0,2,0),new f(5,2,101,267,null,1,1,0)]);new e(34,[new f(1,10,0,300,null,0,1,1),new f(2,10,0,300,null,0,1,1)]);new e(35,[new f(3,10,0,300,null,0,1,1),new f(4,10,0,300,null,
0,1,1)]);new e(36,[new f(1,8,0,750,null,0,1,1),new f(2,8,0,750,null,0,1,1)]);new e(37,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,200,null,0,2,0),new f(5,3,201,500,null,1,1,0)]);new e(38,[new f(1,2,0,0,null,0,2,1),new f(2,2,0,0,null,0,2,1),new f(1,2,0,200,null,0,2,1),new f(2,2,0,200,null,0,2,1),new f(1,3,201,267,null,0,1,1),new f(2,3,201,267,null,0,1,1)]);new e(39,[new f(1,3,0,267,null,0,1,1),new f(2,3,0,267,null,0,1,1)]);new e(40,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,267,null,1,1,0)]);new e(41,[new f(5,
2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(k){window.setTimeout(k,16)}}();d.prototype={Df:null,t0g:5,Gsb:null,F3c:0,startTime:null,duration:null,Ycc:null,j5c:-1,MFd:-1,gFd:-1};d.prototype.Start=function(){this.startTime=new Date;this.Ycc={}};d.prototype.GetRecentAnimationStats=
function(){var k,n=[],v=0;for(k=l.F3c;k<l.t0g;k++)null!=l.Gsb[k]&&(n[v]=l.Gsb[k],v++);for(k=0;k<l.F3c;k++)null!=l.Gsb[k]&&(n[v]=l.Gsb[k],v++);return n};d.prototype.GetAnimationSqmStats=function(){var k=[];return k[0]=0>l.j5c?0:l.j5c,k[1]=0>l.MFd?0:l.MFd,k[2]=0>l.gFd?0:l.gFd,k};var l=new d},1103:function(u,C,a){a.d(C,"a",function(){return b});var c=a(1104);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},1106:function(u,
C,a){a.d(C,"a",function(){return l});u=a(0);var c=a(6);C=a(192);var b=a(162),f=a(10),e=a(63),d=a(52),h=a(40);class l extends C.a{constructor(k){super();this.TO=()=>{this.rud()};this.Tea=()=>{this.rud()};this.$=k}dispose(){this.$&&b.a(this.$)&&(b.a(this.$).YTa(this.Tea),this.$.ea.r9(this.TO));this.$=null;super.dispose()}cAh(){c.AFrameworkApplication.T$a()&&!this.rud()&&(b.a(this.$).ZIa(this.Tea),this.$.ea.E4(this.TO))}rud(){return this.$.isEditMode&&(c.AFrameworkApplication.s5a||e.a.eh.Kv)?(b.a(this.$).YTa(this.Tea),
h.TaskExtensions.za(d.GetServiceTaskFactory.create(this.$.da,119,this.ka,1),k=>{k.result.initialize()},this.ka,3),!0):!1}static main(){f.a.Fa(k=>{(new l(k)).cAh()})}}Object(u.a)(l,"FileOpSliceDownloaderBootStraper",C.a,[])},1189:function(u,C,a){function c(yb,Gb){return Object(z.a)(this,void 0,void 0,function*(){if(Object(F.m)(yb.na)){const ub=yb.na.sheetProcessedData;Object(L.a)(ub);return Gb.map(Ja=>D(Ja,!0)).filter(Ja=>ub.value.PFb(Ja))}return[]})}function b(yb,Gb,ub=new Map){return yb.reduce((Ja,
zb)=>{zb=Gb(zb);const na=Ja.get(zb);na?Ja.set(zb,na+1):Ja.set(zb,1);return Ja},ub)}function f(yb){const Gb=[];yb.forEach(ub=>Gb.push(...ub));return Gb}function e(yb){return Array.from(yb).reduce((Gb,[ub,Ja])=>Object.assign(Object.assign({},Gb),{[ub]:Ja}),{})}function d(yb){return yb.reduce((Gb,ub)=>{var Ja=ub.tableRange;ub=ub.suggestions;Ja&&ub&&(Ja=D(Ja,!1).nz(!1),Gb[Ja]=h(Gb[Ja],ub));return Gb},{})}function h(yb,Gb){return Gb.reduce((ub,{type:Ja})=>{Ja in ub?ub[Ja]++:Ja&&(ub[Ja]=1);return ub},null!==
yb&&void 0!==yb?yb:{})}function l(yb){yb=f(yb.map(Gb=>Gb.suggestions.filter(k)));return b(yb,Gb=>Gb.variationsType)}function k(yb){return"NumberFormattingInconsistency"===yb.type}function n(yb,Gb,ub){return Object(z.a)(this,void 0,void 0,function*(){try{switch(null===Gb||void 0===Gb?void 0:Gb.type){case 0:return v(yb,Gb,ub);case 2:return w(yb,Gb,ub);case 1:return x(yb,Gb,ub);default:E.ULS.sendTraceTag(509617686,0,10,`applySuggestion: Unknown suggestion type ${null===Gb||void 0===Gb?void 0:Gb.type}`)}}catch(Ja){E.ULS.sendTraceTag(509617685,
0,10,`applySuggestion: ${Ja}`)}return null})}function v(yb,Gb,ub){return Object(z.a)(this,void 0,void 0,function*(){const Ja=Gb.variations.filter(Ka=>Ka.isSelected&&Ka.value!==Gb.replacementValue).map(Ka=>Ka.value),zb={["SheetName"]:yb.na.sheetName,["MatchCase"]:!1,["MatchEntireCell"]:!0,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:Ja},{dKd:na,cKd:Ea,pLd:ma}=r(Gb);Object(Z.a)(yb.userOperationManager,(Ka,cb,Fa)=>za.x(yb.qa.va,zb,Object(aa.u)(yb.na.sheetName,
null,ub),Gb.replacementValue,Object(fa.b)(Ka,na),Object(fa.a)(cb,Ea),Fa,null),Ka=>new ya.a(258,0,Ka),null);yield ma;return{result:Ja.length,successful:!0}})}function x(yb,Gb,ub){return Object(z.a)(this,void 0,void 0,function*(){if(null===ub||void 0===ub||!ub.length)return E.ULS.sendTraceTag(509617684,0,10,"applyNumberFormatInconsistencySuggestion: empty changeRanges."),Promise.resolve({result:0,successful:!1});const Ja=Object(aa.u)(yb.na.sheetName,null,ub),zb={},na=Gb.formats.find(({key:wa})=>wa===
Gb.replacementFormat).format;zb.NumberFormatOptions=Object(M.a)(new Ga.a,{NumberFormatCategory:-1,CustomFormatString:na});zb.ValidMembers=32;zb.NumberFormat=15;const Ea=Object(aa.o)(S.h(yb).ga.pa.activeCell,yb),ma=yb.qa.va.Bc({joa:!0,bna:1}),{dKd:Ka,cKd:cb,pLd:Fa}=r(Gb);Object(Z.a)(yb.userOperationManager,(wa,ka,Oa)=>Aa.l(yb.qa.va,Ja,Ea,zb,!1,null,null,!0,!1,Object(fa.b)(wa,Ka),Object(fa.a)(ka,cb),Oa,null,ma,null),wa=>new ya.a(11,0,wa),null);yield Fa;return{result:-1,successful:!0}})}function w(yb,
Gb,ub){return Object(z.a)(this,void 0,void 0,function*(){const {dKd:Ja,cKd:zb,pLd:na}=r(Gb);Object(Z.a)(yb.userOperationManager,(Ea,ma,Ka)=>{var cb=yb.qa.va,Fa=Object(aa.u)(yb.activeItemName,null,ub);a:{var wa=Gb.extraSpacesType;switch(wa){case 0:wa=1;break a;case 2:wa=2;break a;case 1:wa=4;break a;default:throw E.ULS.sendTraceTag(509617683,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${wa}`),Error.argument("illegal ExtraSpacesPaddingType");}}return ja(cb,Fa,wa,
Object(fa.b)(Ea,Ja),Object(fa.a)(ma,zb),Ka,null)},Ea=>new ya.a(253,0,Ea),null);return{result:(yield na).Result,successful:!0}})}function r(yb){const Gb=new Q.a;return{dKd(ub){if(ub&&pa.a.Zf(ub.Errors))E.ULS.sendTraceTag(509617682,0,10,`DataCleansing onOperationSuccess: Ewa result contains error messages after applying type [${yb.type}]`),Gb.setResult(null);else{var Ja=E.ULS,zb=Ja.sendTraceTag,na=yb.type;var Ea=(Ea=yb.tableName)?Ea.includes(":")?"Range":"Ctrl-T":"";zb.call(Ja,537163359,0,20,`DataCleansing onOperationSuccess: Suggestion of type [${na}] applied successfully in tableType [${Ea}]`);
Gb.setResult(ub)}},cKd(ub){E.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages for type [${yb.type}], HttpStatus [${ub.data.httpStatus}]`);Gb.setResult(null)},pLd:W.e(Gb.task)}}function t(yb){return yb.find(Gb=>Za.a.XEd(Gb,[Na.getTypeName()]))}function A(yb){return yb.filter(Gb=>Za.a.XEd(Gb,[Wa.getTypeName()]))}u=a(0);var y=a(229),z=a(119),E=a(15),G=a(42),F=a(73),O=a(354),M=a(2),P=a(25);class B{constructor(){this.bottom=this.top=this.right=this.left=
0}}Object(u.a)(B,"RangeAddress",null,[]);const D=(yb,Gb=!1)=>{yb=new P.Range(yb.top,yb.left,yb.bottom,yb.right,!1,Gb);if(Gb&&(1>yb.top||yb.top>yb.maxRows||1>yb.bottom||yb.bottom>yb.maxRows||yb.top>yb.bottom||1>yb.left||yb.left>yb.maxColumns||1>yb.right||yb.right>yb.maxColumns||yb.left>yb.right))throw E.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return yb};var I=a(873),S=a(20),J=a(789),L=a(60);const R={[0]:[45],[1]:[46]};
class Y{constructor(yb){this.$=yb;this.sessionStorage=new Map;this.doUndo=()=>Object(z.a)(this,void 0,void 0,function*(){yield Object(I.d)(this.$)});this.highlightRangesOnGrid=(Gb,ub,Ja)=>Object(z.a)(this,void 0,void 0,function*(){this.xA(Gb,ub,R[Ja])});this.openCustomNumberFormat=()=>Object(z.a)(this,void 0,void 0,function*(){return new Promise(Gb=>{Object(I.a)(this.$,ub=>{Gb(ub);E.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${ub?"OK":"Cancel"}"`)})})});
this.openFeedback=Gb=>Object(z.a)(this,void 0,void 0,function*(){Object(I.e)(this.$,Gb)});this.sendOtelEvent=Gb=>Object(z.a)(this,void 0,void 0,function*(){Object(J.b)(Gb)});this.containsHiddenCells=Gb=>c(this.$,Gb)}get grid(){return S.h(this.$)}xA(yb,Gb,ub=[45]){const Ja=this.grid.dc;Ja.Hk(ub,!1,!0);Ja.il(null,ub,!1);if(null===yb||void 0===yb?0:yb.length){const zb=O.a.qEa(F.d(this.$.na),yb.map(na=>D(na,!1)));Ja.iB(zb,ub,!0,void 0,!1);Gb&&this.UWi(yb)}Ja.update(!1)}UWi(yb){if(null===yb||void 0===
yb?0:yb.length){const Gb=this.grid;[yb]=yb.sort((ub,Ja)=>ub.top<Ja.top?-1:ub.top>Ja.top?1:0);yb=P.Range.gd(yb.top,yb.left);Gb.JL(yb)||(E.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),Gb.Lw(yb,0,"DataCleansing"))}else E.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(u.a)(Y,"HostAppCallbacks",null,[642]);var Q=a(170),W=a(100),Ga=a(802),pa=a(33),aa=a(47),Z=a(382),fa=a(246),ya=a(200),
Aa=a(58);const ja=(yb,Gb,ub,Ja,zb,na,Ea,ma=null)=>{ma=yb.Pa(9,ma);ma.ranges=Gb;ma.trimWhitespaceType=ub;return Aa.g(yb,"TrimWhitespace",ma,Ja,zb,na,Ea,0)};var za=a(323),ra;(function(yb){yb[yb.textInconsistency=0]="textInconsistency";yb[yb.numberFormatInconsistency=1]="numberFormatInconsistency";yb[yb.extraSpaces=2]="extraSpaces"})(ra||(ra={}));Object(u.b)("SuggestionType",ra);var fb=a(947);class Ua{constructor(yb){this.$=yb;this.applySuggestion=(Gb,ub=[])=>Object(z.a)(this,void 0,void 0,function*(){const Ja=
ub.map(zb=>D(zb,!1));return n(this.$,Gb,Ja)});this.onPaneLifecycleEvent=Gb=>Object(z.a)(this,void 0,void 0,function*(){fb.a(Gb)})}}Object(u.a)(Ua,"DataCleansingCallbacks",null,[641]);class Ca{constructor(){this.isInErrorState=!1;this.errorState=null;this.isInCoauthoring=this.isInViewMode=!1}}Object(u.a)(Ca,"HostState",null,[]);class Ia{constructor(){this.sheetName=this.sheetId=null;this.isProtected=this.isInNamedSheetView=!1}}Object(u.a)(Ia,"WorksheetState",null,[]);class oa{constructor(){this.annotations=
[];this.hostState=new Ca;this.worksheetState=new Ia}}Object(u.a)(oa,"DataCleansingHostState",null,[]);var Da=a(1);class bb{constructor(yb){this.$=yb;this.BTe=this.ATe=!1}get isEnabled(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)||Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)}show(yb,Gb=!1){const ub=!Gb;if(this.isEnabled&&!(Gb&&this.BTe||ub&&this.ATe)){if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7813501_CalloutOneSuggestion")){if(1>
yb){E.ULS.sendTraceTag(508913414,0,50,`DataCleansing.showCallout: suggestion count(${yb}).`);return}if(2>yb&&ub){E.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${yb}) is below threshold to show teaching callout`);return}}else if(2>yb){E.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${yb}) is below threshold to show teaching callout`);return}E.ULS.sendTraceTag(508887310,0,50,`DataCleansing.showCallout: dispatchShowCalloutCommand. coolDown:(${ub}).`);
Object(I.b)(this.$,yb,Gb);Gb?this.BTe=!0:this.ATe=!0}}}Object(u.a)(bb,"TeachingCallout",null,[]);var Za=a(745);ra=a(746);var Xa=a(726);class Ba extends ra.a{constructor(){super();this.columnIdentifier=this.tableIdentifier=this.tableRange=this.tableName=this.worksheetName=this.worksheetId=null;this.H_=Object.assign(new Xa.a,{T_:Ba.getTypeName(),B_:Ba.je()})}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static je(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Ba,"TableLintAnnotationBase",
ra.a,[]);class Wa extends Ba{constructor(){super();this.investigationTelemetry=this.suggestions=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Xa.a,{T_:Wa.getTypeName(),B_:Wa.je()})}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static je(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(u.a)(Wa,"TableLintColumnAnnotation",Ba,[]);class Na extends ra.a{constructor(){super();this.worksheetId=null;this.errorCount=this.suggestionsCount=
0;this.aggregatedAnnotations=this.unsupportedFeaturesSet=null;this.H_=Object.assign(new Xa.a,{T_:Na.getTypeName(),B_:Na.je()})}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static je(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Na,"TableLintWorksheetAggregateAnnotation",ra.a,[]);var ta=a(946),V=a(91),ia=a(79),X=a(36),la=a(71),sa=a(149),Va=a(52),nb=a(16),ha=a(189);class jb{constructor(yb){this.$=yb;this.zTe=!1}gSb(yb){return Object(z.a)(this,void 0,void 0,
function*(){if(this.zTe)E.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else{var Gb=String.format(nb.a.instance.Lb(213),yb),ub=ha.a.ha(1952),Ja=ha.a.ha(1954);this.businessBarManager||(this.businessBarManager=Object(la.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?yield sa.a.resolve(X.h,{Wa:1}):yield Va.GetServiceTaskFactory.t0(this.$.da,5,4,1));this.businessBarManager.jXj(Gb,Ja,ub,()=>{this.J8a()});this.zTe=
!0;E.ULS.sendTraceTag(509089824,0,50,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${yb} suggestions.`)}})}J8a(){this.businessBarManager&&this.businessBarManager.YF(70)&&this.businessBarManager.removeEntry(70)}}Object(u.a)(jb,"BusinessBar",null,[]);const Fb=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDisableTaskPaneWhenALSessionClose",!1);class Rb extends G.a{constructor(yb,Gb){super();this.$=yb;this.Yua=Gb;this.m5a=!1;this.KDb=-1;this.QVi=
3;this.Cea=new oa;this.uRf=(ub,Ja)=>Object(z.a)(this,void 0,void 0,function*(){-1===this.KDb&&this.vtg();this.RQi(Ja.sheetId,Ja.annotations);this.stateChanged();yield Promise.all([this.jhf(),this.mki()])});this.ik=(ub,Ja)=>Object(z.a)(this,void 0,void 0,function*(){this.vtg();this.gsg(Ja.PC);this.lmg(Ja.na);this.stateChanged();this.businessBar.J8a();yield this.jhf()});this.Xe=()=>Object(z.a)(this,void 0,void 0,function*(){this.gridView.inRangePicker||this.gridView.Wi||this.ga.gf&470||(yield this.nki())});
this.Poa=()=>{this.stateChanged()};this.GC=()=>{this.stateChanged()};this.u8=()=>{this.stateChanged()};this.DSf=(ub,[Ja,zb])=>{E.ULS.sendTraceTag(509613389,0,50,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:ta.a[Ja],["errorCode"]:zb})}`);Fb&&(this.Cea.hostState.errorState=zb,this.stateChanged())};this.K8=(ub,Ja)=>{F.m(Ja.item)&&Ja.item.$h!==this.Cea.worksheetState.isProtected&&(E.ULS.sendTraceTag(509613388,0,50,
`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Ja.item.$h}.`),this.stateChanged())};this.callbacks=new Ua(this.$);this.E0g=new Y(this.$);this.nHc=new bb(this.$);this.businessBar=new jb(this.$);Gb.VYg(this.uRf);Gb.iZg(this.DSf);void Gb.H0c();yb.rj.Lg(this.ik);yb.ea.fba(this.GC);yb.ea.E4(this.u8);this.gridView=S.h(this.$);this.ga=this.gridView.ga;this.ga.sx(this.Xe);this.lmg(this.$.na)}U2c(yb){this.addHandler(Rb.c2d,yb)}g5f(yb){this.removeHandler(Rb.c2d,yb)}dispose(){this.Yua.Gzj(this.uRf);
this.Yua.Rzj(this.DSf);this.$.rj.ih(this.ik);this.$.ea.v9(this.GC);this.$.ea.r9(this.u8);this.gsg(this.$.na);this.ga.Ww(this.Xe);super.dispose()}get state(){this.Cea.annotations=this.Yua.F_g();if(F.m(this.$.na)){const yb=this.$.na.$h,Gb=this.$.na.sheetId,ub=this.$.na.sheetName;this.Cea.worksheetState.isInNamedSheetView=this.$.na.Pe.rC;this.Cea.worksheetState.isProtected=yb;this.Cea.worksheetState.sheetId=Gb;this.Cea.worksheetState.sheetName=ub}this.Cea.hostState.isInViewMode=!this.$.ea.isEditMode;
this.Cea.hostState.isInCoauthoring=this.isInCoauthoring();return this.Cea}K2d(yb){return this.T0a(yb)}L2d(yb){return this.kSh(yb)}Zmg(yb){if(F.m(this.$.na)){var Gb=this.Yua.xhb(this.$.na.sheetId);if(t(Gb)&&(Gb=A(Gb).filter(ub=>yb.Ue(D(ub.tableRange))),0<Gb.length))return Gb=D(Gb[0].tableRange),E.ULS.sendTraceTag(509219845,0,50,`DataCleansingHostManager.getTableRange: Table range is ${Gb}, selected cell range is ${yb}.`),Gb}}o3d(){if(!F.m(this.$.na))return 0;var yb=this.Yua.xhb(this.$.na.sheetId);
if(!t(yb))return 0;yb=new Set(A(yb).map(Gb=>Gb.tableName));E.ULS.sendTraceTag(509211032,0,50,`DataCleansingHostManager.tablesWithSuggestionsCount: ${yb.size} tables with suggestions found.`);return yb.size}vtg(){if(F.m(this.$.na)){var yb=this.Yua.xhb(this.$.na.sheetId);t(yb)?this.KDb=this.T0a():this.KDb=-1}}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(Rb.c2d,this.state)}lmg(yb){F.m(yb)&&(yb.Pe.o1a(this.Poa),yb.r1a(this.K8))}gsg(yb){F.m(yb)&&(yb.Pe.Lfb(this.Poa),yb.kAc(this.K8))}e5d(){if(this.nHc.isEnabled){const yb=
this.T0a();0<yb&&(this.nHc.show(yb,!0),E.ULS.sendTraceTag(508957346,0,20,`DataCleansingHostManager:triggerCallout show callout on discoverability mode ${this.Axb}. with: ${yb} suggestions.`))}}T0a(yb){if(!F.m(this.$.na))return 0;const Gb=this.Yua.xhb(this.$.na.sheetId),ub=t(Gb);if(!ub)return 0;const Ja=this.nlh(Gb);Ja!==ub.suggestionsCount&&E.ULS.sendTraceTag(509613387,0,50,`DataCleansingHostManager.activeSheetSuggestionsCount: suggestionsCount is ${ub.suggestionsCount}, but we have ${Ja} suggestions.`);
return yb?this.olh(Gb,yb):Ja}nlh(yb){return A(yb).reduce((Gb,ub)=>{var Ja,zb;return Gb+(null!==(zb=null===(Ja=null===ub||void 0===ub?void 0:ub.suggestions)||void 0===Ja?void 0:Ja.length)&&void 0!==zb?zb:0)},0)}olh(yb,Gb){yb=A(yb).map(ub=>{var Ja;return null===(Ja=null===ub||void 0===ub?void 0:ub.suggestions)||void 0===Ja?void 0:Ja.filter(zb=>!(null===Gb||void 0===Gb||!Gb.Ue(D(zb.suggestionRange))))}).reduce((ub,Ja)=>ub+Ja.length,0);E.ULS.sendTraceTag(509219844,0,50,`DataCleansingHostManager.countSuggestionsForRange: ${yb} suggestions found for range: ${Gb}`);
return yb}kSh(yb){if(!F.m(this.$.na))return[];const Gb=this.Yua.xhb(this.$.na.sheetId);return t(Gb)?A(Gb).filter(ub=>{var Ja;return 0<(null===(Ja=null===ub||void 0===ub?void 0:ub.suggestions)||void 0===Ja?void 0:Ja.filter(zb=>!(null===yb||void 0===yb||!yb.Ue(D(zb.suggestionRange)))).length)}).map(ub=>ub.tableName):[]}RQi(yb,Gb){Gb=A(Gb);const ub=d(Gb);E.ULS.sendTraceTag(509698241,0,50,`DataCleansingHostManager.logPotentialSuggestionsInfo: ${JSON.stringify({["sheetId"]:yb,["suggestionsInfo"]:ub,["numberFormatTypes"]:Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7809228_DataCleansingLogPotentialNumberFormatTypes")?
e(l(Gb).entries()):""})}`)}hwc(yb,Gb){if(this.Axb===yb){const ub=new V.a(-1190551534,ia.a.Vb,this.$.Kc,0,null),Ja={type:yb};Gb&&(Ja.range=Gb);this.$.Ia.$b(ub,{["discoverabilityOptions"]:Ja});E.ULS.sendTraceTag(508933121,0,20,`DataCleansingHostManager:openDataCleansingTaskPane discoverability type: ${yb}. with active range: ${null!==Gb&&void 0!==Gb?Gb:"no range"}.`)}}get Axb(){return Da.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverability",0)}get Jdd(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)}get Idd(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityBusinessBar",!1)}nki(){return Object(z.a)(this,void 0,void 0,function*(){if(!this.m5a&&2===this.Axb){const [Gb]=this.ga.pa.selectedRanges;if(Gb){var yb=this.Zmg(Gb);yb&&(yb=this.K2d(yb),this.F_d(yb)&&(this.Jdd?(yb="Trigger callout",this.e5d()):this.Idd?(yb="Show business bar",yield this.d5d()):(yb="Open task pane",this.hwc(2,Gb)),this.m5a=!0,E.ULS.sendTraceTag(508933120,0,20,`DataCleansingHostManager:handleDiscoverabilityOnSelect ${yb}.`)))}}})}jhf(){return Object(z.a)(this,
void 0,void 0,function*(){const yb=this.T0a();0===yb&&this.businessBar.J8a();this.F_d(yb)&&(0===this.Axb?this.Jdd?(this.e5d(),this.m5a=!0):this.Idd&&(yield this.d5d(),this.m5a=!0):(E.ULS.sendTraceTag(508933091,0,50,`DataCleansingHostManager:handleDiscoverabilityOnSuggestionLoad show callout on load with: ${yb} suggestions.`),this.j9j(yb)))})}j9j(yb){Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)&&this.nHc.isEnabled&&this.nHc.show(yb,!1)}mki(){return Object(z.a)(this,
void 0,void 0,function*(){if(-1!==this.KDb){var yb=this.T0a();this.F_d(yb)&&3===this.Axb&&yb>=this.KDb+this.QVi&&(this.Jdd?(E.ULS.sendTraceTag(508924481,0,20,`DataCleansingHostManager:handleDiscoverabilityOnNewSuggestions show callout on load with: ${yb} suggestions.`),this.e5d()):this.Idd?yield this.d5d():this.hwc(3),this.m5a=!0)}})}d5d(){return Object(z.a)(this,void 0,void 0,function*(){const yb=this.T0a();yield this.businessBar.gSb(yb)})}kAg(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityMultipleTables",
!1)}mej(){return 1===this.o3d()}F_d(yb){return!(this.m5a||Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode)&&0<yb&&(this.kAg()||this.mej())?!0:!1}}Rb.c2d="scek";Object(u.a)(Rb,"DataCleansingHostManager",G.a,[]);class mb extends Ba{constructor(){super();this.errorCategory=this.errorType=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Xa.a,{T_:mb.getTypeName(),B_:mb.je()})}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static je(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}}Object(u.a)(mb,"TableLintErrorAnnotation",Ba,[]);class sb extends Ba{constructor(){super();this.unsupportedFeatures=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Xa.a,{T_:sb.getTypeName(),B_:sb.je()})}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static je(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(u.a)(sb,"TableLintUnsupportedFeatureAnnotation",
Ba,[]);class Ya extends ra.a{constructor(){super();this.duplications=this.tableRange=this.tableName=null;this.H_=Object.assign(new Xa.a,{T_:Ya.getTypeName(),B_:Ya.je()})}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static je(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Ya,"DuplicatedRowsAnnotation",ra.a,[]);class Ma extends ra.a{constructor(){super();this.rangesWithUnprintableChars=this.tableRange=this.tableName=this.worksheetId=null;this.H_=Object.assign(new Xa.a,
{T_:Ma.getTypeName(),B_:Ma.je()})}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static je(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Ma,"UnprintableCharactersTableAnnotation",ra.a,[]);class xb extends G.a{constructor(yb,Gb){super();this.pja=!1;this.D4j=(ub,Ja)=>{if(ub=Ja.QB)switch(Ja.operationType){case 1:case 2:this.raiseEvent("carek",ub);break;case 3:this.raiseEvent("caiek",ub);break;default:E.ULS.sendTraceTag(537163396,306,15,`TableLintManager.TableLintColumnAnnotationHandler Received unexpected OperationType:${Ja.operationType}`)}else E.ULS.sendTraceTag(537163397,
306,50,"TableLintManager.TableLintColumnAnnotationHandler TableLintColumnAnnotation is null.")};this.F4j=(ub,Ja)=>{if(Ja.QB)switch(Ja.operationType){case 1:case 2:this.raiseEvent("aarek",Ja.QB);break;case 3:break;default:E.ULS.sendTraceTag(537163394,306,15,`TableLintManager.TableLintAnnotationHandler Received unexpected OperationType:${Ja.operationType}`)}else E.ULS.sendTraceTag(537163395,306,50,"TableLintManager.TableLintWorksheetAggregateAnnotationHandler TableLintWorksheetAggregateAnnotation is null.")};
this.E4j=(ub,Ja)=>{E.ULS.sendTraceTag(537163393,306,50,`TableLintManager.TableLintColumnAnnotationStateUpdateHandler Received state update: ${ub}->${Ja}`)};this.augmentationLoopManager=yb;this.J0i=Gb}H0c(){this.pja?E.ULS.sendTraceTag(537163398,0,50,"TableLintManager.ActivateEvents: Events are already registered"):(this.Muj(),this.pja=!0)}dispose(){this.pja&&(this.dck(),this.pja=!1)}hWg(yb){this.addHandler("carek",yb)}uxj(yb){this.removeHandler("carek",yb)}IVg(yb){this.addHandler("aarek",yb)}bxj(yb){this.removeHandler("aarek",
yb)}Muj(){E.ULS.sendTraceTag(574482312,0,50,"TableLintManager.RegisterTableLintEvents: activate annotations");const yb=this.augmentationLoopManager.j0().v2("DataCleansing").t2(this.J0i).activateAnnotation({annotationType:Wa.getTypeName(),Jv:!0,AAe:this.E4j,nkb:this.D4j}).activateAnnotation({annotationType:Na.getTypeName(),Jv:!0,nkb:this.F4j}).activateAnnotation({annotationType:mb.getTypeName(),Jv:!0}).activateAnnotation({annotationType:sb.getTypeName(),Jv:!0});Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",
!1)&&yb.activateAnnotation({annotationType:Ya.getTypeName(),Jv:!0});Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&yb.activateAnnotation({annotationType:Ma.getTypeName(),Jv:!0});this.augmentationLoopManager.register(yb.build())}dck(){this.augmentationLoopManager.unregister("DataCleansing")}}Object(u.a)(xb,"TableLintManager",G.a,[2]);class qb extends G.a{constructor(yb){super();this.$=yb;this.gEc=new Map;this.v9c=new Map;this.u9c=new Map;this.Ecb=(Gb="Unknown",
ub)=>{E.ULS.sendTraceTag(520987272,0,50,`DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:ta.a[Gb],["errorCode"]:ub})}`);this.raiseEvent(qb.$5d,[Gb,ub])};this.CJf=(Gb,ub)=>{this.v9c.set(ub.id,ub);E.ULS.sendTraceTag(512354457,0,100,`DataCleansingAnnotationsManager.onColumnAnnotationReceived: Received ${ub.id}`)};this.aIf=(Gb,ub)=>{Gb=this.gEc.get(ub.worksheetId);E.ULS.sendTraceTag(512354456,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received ${JSON.stringify({["id"]:ub.id,
["sheetId"]:ub.worksheetId,["previous"]:null===Gb||void 0===Gb?void 0:Gb.id,["errorCount"]:ub.errorCount,["suggestionsCount"]:ub.suggestionsCount})}`);(null===Gb||void 0===Gb?void 0:Gb.id)===ub.id&&E.ULS.sendTraceTag(512354455,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received duplicate ${ub.id}`);this.gEc.set(ub.worksheetId,ub);Gb=this.wci(ub);Gb.forEach(Ja=>{this.v9c.delete(Ja.id)});this.u9c.set(ub.id,Gb);this.v0g(ub.worksheetId)}}VYg(yb){this.addHandler(qb.yZd,yb)}Gzj(yb){this.removeHandler(qb.yZd,
yb)}iZg(yb){this.addHandler(qb.$5d,yb)}Rzj(yb){this.removeHandler(qb.$5d,yb)}dispose(){this.EWa&&(this.EWa.uxj(this.CJf),this.EWa.bxj(this.aIf),this.EWa.dispose());super.dispose()}H0c(){return Object(z.a)(this,void 0,void 0,function*(){const yb=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?yield sa.a.resolve(X.f,{Wa:1}):yield Va.GetServiceTaskFactory.t0(this.$.da,328,327,1);yb?(this.EWa=new xb(yb,this.Ecb),this.EWa.hWg(this.CJf),this.EWa.IVg(this.aIf),
this.EWa.H0c(),E.ULS.sendTraceTag(520987274,0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):E.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}xhb(yb){var Gb;if(yb=this.gEc.get(yb)){const ub=null!==(Gb=this.u9c.get(yb.id))&&void 0!==Gb?Gb:[];return[yb,...ub]}return[]}F_g(){const yb=[];this.gEc.forEach(Gb=>{var ub;const Ja=null!==(ub=this.u9c.get(Gb.id))&&void 0!==ub?ub:[];yb.push(Gb,...Ja)});return yb}v0g(yb){yb=
{sheetId:yb,annotations:this.xhb(yb)};this.raiseEvent(qb.yZd,yb)}wci(yb){var Gb=Array.from(this.v9c.values()).filter(zb=>zb.worksheetId===yb.worksheetId);if(!Gb.length)return E.ULS.sendTraceTag(509682374,0,50,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No pending sheet annotations"),[];if(!Array.isArray(yb.aggregatedAnnotations))return E.ULS.sendTraceTag(509682373,0,20,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No aggregated annotations IDs"),Gb;const ub=new Set(yb.aggregatedAnnotations),
Ja=Gb.filter(zb=>ub.has(zb.id));Gb=Gb.filter(zb=>!ub.has(zb.id));Gb.length&&E.ULS.sendTraceTag(509682372,0,50,`DataCleansingAnnotationsManager.getRelatedPendingAnnotations: Found ${Gb.length} unrelated annotations`);return Ja}}qb.yZd="sacek";qb.$5d="ueoek";Object(u.a)(qb,"DataCleansingAnnotationsManager",G.a,[]);var Ra=a(725);a.d(C,"a",function(){return Jb});class Jb extends y.a{constructor(yb){super();this.$=yb;this.kc()}create(){const yb=Object(Ra.a)(this.$.da,494,()=>{const Gb=new qb(this.$);return new Rb(this.$,
Gb)});this.Pb(yb)}static la(yb){yb.da.Ja(495,new Jb(yb))}}Object(u.a)(Jb,"DataCleansingHostManagerFactory",y.a,[])},1190:function(u,C,a){u=a(0);var c=a(88),b=a(562),f=a(15),e=a(146);class d{constructor(X,la,sa){this.n0d=this.o0d=this.p0d=!1;this.C0d=!X&&!la;this.D0d=!X&&!sa;this.C0d||this.D0d||(this.p0d=!X,this.o0d=!la,this.n0d=!sa)}}Object(u.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends e.StandardDialog{constructor(X,la,sa,Va,nb){super();this.K3d=[];this.N3=new d(X,la,sa);this.oua=Va;
this.fta=nb;this.Te="RenameDisabledDialog";this.rc=0;this.Hc(1,CommonUIStrings.l_DialogClose);this.GQj();this.jAj()}GQj(){this.N3.C0d?this.ySb(this.oua?this.fta?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.N3.D0d?this.ySb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.tTg();this.Aua(this.K3d)}ySb(X){Array.add(this.K3d,X)}tTg(){const X=[];this.N3.p0d||Array.add(X,
CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.N3.o0d||Array.add(X,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.N3.n0d||Array.add(X,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<X.length&&Array.add(this.K3d,X)}}Object(u.a)(h,"ReactRenameDisabledDialogBase",e.StandardDialog,[]);class l extends h{constructor(X,la,sa,Va,nb){super(X,la,sa,Va,nb)}jAj(){this.XIb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(u.a)(l,"ReactRenameDisabledDialog",
h,[]);var k=a(157);class n{static get Eg(){return k.a.$p(n.Sl,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}n.Sl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(u.a)(n,"RenameDisabledDialogHtml",null,[]);class v extends k.a{constructor(X,la,sa,Va,nb){super();this.N3=new d(X,la,sa);this.oua=Va;this.fta=nb;this.Te="RenameDisabledDialog";this.rc=0;this.Hc(1,CommonUIStrings.l_DialogClose);this.Eg=n.Eg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.sY("RenameRow")}Scb(){if(this.N3.C0d){let X;X=this.oua?this.fta?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;
v.ySb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),X)}else this.N3.D0d?v.ySb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.npi()}npi(){this.N3.p0d&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.N3.o0d&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.N3.n0d&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static ySb(X,la,sa){X.style.display="none";la.innerText=sa}}Object(u.a)(v,"RenameDisabledDialog",k.a,[]);var x=a(6),w=a(34),r=a(111),t=a(26);class A{constructor(X,la){this.oHa=0;this.Na=X;this.aaa=la}initialize(X){if(!this.Na||!this.aaa)return!1;this.oHa=X;this.vh();return!0}vh(){this.Na.xc(t.a.gka,r.a.frame,Object(c.a)(this,this.gka,"commitNewDocumentTitle"))}gka(X,la,sa,Va,nb){if(1===sa)return this.Na.processAction(t.a.renameFile,
1);X=w.a.Jq(this.aaa.co);nb=(0,nb.getNewDocumentTitle)();nb.length>this.oHa&&(nb=nb.substr(0,this.oHa));if(32!==this.Na.Be(t.a.renameFile,2,nb))return this.LY(X),8;this.LY(nb);return 32}LY(X){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(X))}static Fnd(){return new A(x.AFrameworkApplication.Qb,x.AFrameworkApplication.kn)}}Object(u.a)(A,"ReactRenameUIHandler",null,[534]);var y=a(96),z=a(531),E=a(564),G=a(14),F=a(113),O=a(248),M=a(93),P=a(41),B=a(31),D=a(84);class I{constructor(X,la,
sa,Va,nb,ha,jb,Fb,Rb,mb,sb,Ya){this._initialized=!1;this._element=null;this.oHa=0;this.BYc=this.VRc=!1;this.Na=X;this.jNc=la;this.Je=sa;this.FB=Va;this.aaa=nb;this.gqe=ha;this.p1b=jb;this.eOc=Fb;this.maa=Rb;this.Lie=mb;this.LZa=sb;this.QSc=Ya}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(X,la,sa){if(!(this.Na&&this.aaa&&this.gqe&&this.p1b&&this.eOc&&la)||0>=X)return!1;this._element=la;this._element.title=sa;this._element.setAttribute(M.a.fe,M.a.qu);this._element.setAttribute("Unselectable",
"on");this.oHa=X;this.Uu();return this._initialized=!0}Uu(){this.jNc&&(this.jNc.ta(G.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.jNc.ta(G.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Je.ta(G.a.yc,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.FB.ta(G.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.FB.ta(G.a.Pg,this._element,Object(c.a)(this,this.Mh,"onPointerUp"))}onBlur(){this.isActive&&!this.VRc&&
(this.Lie||this.eOc(this._element),this.XLe(),this.Mcd(!1));return this.VRc=!1}onPaste(){f.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(X){return this.isActive?this.p8i(X):this.q8i(X)}p8i(X){let la=!1;switch(X.Da.keyCode){case Sys.UI.Key.enter:this.XLe();this.Mcd(this.LZa||this.QSc);la=!0;break;case Sys.UI.Key.tab:this.Lie&&this.eOc(this._element);break;case Sys.UI.Key.esc:this.GUd(),this.Mcd(this.LZa||this.QSc),la=!0}return la}q8i(X){let la=!1;
switch(X.Da.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.aqg(this.QSc),this.isActive&&this.p1b(this._element),la=!0}return la}onPointerDown(){this.isActive||(this.aqg(!1),this.isActive&&(this._element.focus(),this.p1b(this._element),this.BYc=!0));return!1}Mh(){return this.BYc?(this.p1b(this._element),this.BYc=!1,!0):!1}S$a(){return 32===this.Na.processAction(t.a.renameFile,1)}XLe(){const X=w.a.Jq(this.aaa.co);let la=this._element.innerText.trim();la.length>this.oHa&&(la=la.substr(0,this.oHa));
la!==X&&""!==la?32!==this.Na.Be(t.a.renameFile,2,la)?this.GUd():this.LY(la):this.GUd()}GUd(){this.LY(w.a.Jq(this.aaa.co))}LY(X){this._initialized&&(this._element.innerText=X,this.gqe())}aqg(X){this.S$a()?this.isActive||(X&&(this.VRc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(M.a.fe,M.a.w4c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,y.CuiHelper.VVe),this.maa&&
this.maa.execute(la=>{la.i_f(!0)}),X&&this._element.focus(),f.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Na.processAction(t.a.$hb,2)}Mcd(X){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(M.a.fe,M.a.qu);Sys.UI.DomElement.removeCssClass(this._element,y.CuiHelper.VVe);this.maa&&this.maa.execute(la=>{la.i_f(!1)});X&&(this._element.blur(),this._element.focus())}static gB(){z.a.gB(x.AFrameworkApplication.isRtl)}static Fnd(){return new I(x.AFrameworkApplication.Qb,
E.a.instance,F.KeyInputManager.instance,O.a.instance,x.AFrameworkApplication.kn,I.gB,P.a.DIj,P.a.Feh,D.a.instance.qc("Common.App.Header.HeaderEventSource"),B.a.zna,B.a.rh,B.a.ng)}}Object(u.a)(I,"RenameUIHandler",null,[534]);class S{static get instance(){return x.AFrameworkApplication.sa.Qa.Kv?S.Oa||(S.Oa=A.Fnd()):S.Oa||(S.Oa=I.Fnd())}}S.Oa=null;Object(u.a)(S,"RenameUIHandlerFactory",null,[]);var J=a(103),L=a(147);class R{constructor(){this.lYi=this.hYi=this.ath=null}}Object(u.a)(R,"RenameMruEntryProperties",
null,[]);var Y=a(384),Q=a(178),W=a(666),Ga;(function(X){X[X.unknown=-1]="unknown";X[X.success=0]="success";X[X.renameInvalidFileName=1]="renameInvalidFileName";X[X.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";X[X.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";X[X.permissionDenied=4]="permissionDenied";X[X.serverCommunicationFailure=5]="serverCommunicationFailure";X[X.fileNameTooLong=6]="fileNameTooLong"})(Ga||(Ga={}));Object(u.b)("CommonOperationResult",Ga);class pa{constructor(X,
la,sa,Va,nb,ha,jb,Fb,Rb,mb,sb,Ya){this.Zie=X;this.Na=la;this.oOc=sa;this.lx=Va;this.iHa=nb;this.iQg=ha;this.oua=jb;this.hte=Fb;this.JMg=Rb;this.fta=mb;this.Ta=sb;this.IMg=Ya}vh(){x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Kv||this.Ci.xc(t.a.QDb,r.a.frame,Object(c.a)(this,this.QDb,"initializeRenameUIHandler"));this.Ci.xc(t.a.$hb,r.a.frame,Object(c.a)(this,this.$hb,"showRenameDisabledDialog"));this.Ci.xc(t.a.renameFile,r.a.frame,Object(c.a)(this,this.renameFile,"renameFile"));this.Ci.ef(t.a.fileNameUpdate,
r.a.frame,Object(c.a)(this,this.Ksj,"refreshFilename"),64);this.Ci.ef(t.a.Ssc,r.a.frame,Object(c.a)(this,this.Ssc,"moveToFolderCompleteByHost"),64);this.Ci.xc(t.a.GRa,r.a.frame,Object(c.a)(this,this.GRa,"moveToFolder"));(x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||x.AFrameworkApplication.sa&&(x.AFrameworkApplication.fa.ra("PostMessageEmbedded")||x.AFrameworkApplication.fa.ra("IsJsApi"))&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&x.AFrameworkApplication.cS().execute(X=>{X.fn(Q.a.TEf);X.hl(Q.a.TEf,pa.zrj);X.fn(Q.a.zid);X.hl(Q.a.zid,pa.xrj)})}S$a(){return 0===this.IMg.ndf()?32:8}Fhk(){return this.lA?this.oua?this.lA.QUe:this.lA.jAb:!0}QDb(){return S.instance.initialize(x.AFrameworkApplication.Uec,x.AFrameworkApplication.s5a,x.AFrameworkApplication.VSd||CommonUIStrings.l_RenameFileTooltip)?32:8}$hb(){const X=this.Fhk(),la=this.iQg();f.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.iHa,la,X,this.oua);x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Qw&&x.AFrameworkApplication.fa.ra("ReactRenameDisabledDialogIsEnabled")?new l(this.iHa,!la,!X,this.oua,this.fta()):new v(this.iHa,!la,!X,this.oua,this.fta());return 32}renameFile(X,la,sa,Va,nb){if(1===sa)return this.S$a();if(!x.AFrameworkApplication.qec)return 8;if(8===this.S$a())return this.Ci.processAction(t.a.$hb,2),8;f.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");x.AFrameworkApplication.qec(nb,Object(c.a)(this,
this.lLb,"onRenameFileSuccess"),Object(c.a)(this,this.caj,"onRenameFileFailure"));x.AFrameworkApplication.$zj=!0;return 32}lLb(X,la){X?0!==X.OperationResult?this.whf(X.OperationResult):(this.UJj(la,X.NewName),this.Sck(X,Object(c.a)(x.AFrameworkApplication.sa.Qa,x.AFrameworkApplication.sa.Qa.Otg,"updateOpenInClientDocumentUrl")),x.AFrameworkApplication.fa.ra("DocumentNameInJewelInfoMenuIsEnabled")&&x.AFrameworkApplication.sa.updateCommandUI(),this.JMg.nsg()):this.whf(5)}UJj(X,la){const sa={};sa[Y.a.CRh]=
la;X.sendMessage(Q.a.zid,sa)}Sck(X,la){this.fdk(X);x.AFrameworkApplication.Nbc=X.DirectInvokeDavUrl;la=la(X.EditDocInClientUrl);const sa=new R;sa.lYi=this.lx.co;sa.ath=la;sa.hYi=X.EditDocInClientUrl;this.Ci.Be(t.a.renameMostRecentlyUsedFileEntry,2,sa)}whf(X){switch(X){case 1:X=new e.StandardDialog,X.rc=0,X.BT(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.a8f()}}fdk(X){this.lx.co=pa.Z0g(this.lx.co,X.NewName);X.BreadcrumbFolderName&&(this.lx.breadcrumbFolderName=
X.BreadcrumbFolderName);X.BreadcrumbFolderUrl&&(this.lx.breadcrumbFolderUrl=X.BreadcrumbFolderUrl);this.hte(X.NewName)}caj(X){const la=new e.StandardDialog;la.rc=0;switch(X){case 1:f.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");la.Eqa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:f.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");la.Eqa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:f.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:X}),la.Eqa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}x.AFrameworkApplication.cS().execute(sa=>{sa.sendMessage(Q.a.BRh,{["FailureMessage"]:Ga[X]})});this.a8f()}Ksj(X,la,sa){if(1===sa)return this.S$a();if(!x.AFrameworkApplication.AMa)return 8;x.AFrameworkApplication.AMa(Object(c.a)(this,this.vvc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.uvc,"onRefreshFilenameFailure"),
!1);return 32}GRa(X,la,sa,Va,nb){if(1===sa)return x.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?32:8;if(2===sa){const ha={};X=x.AFrameworkApplication.eea;la=x.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");X=(!X||X&&la)&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ha[Y.a.E3j]=X;nb&&nb.MoveButtonClickedTime&&(ha[Y.a.IWi]=nb.MoveButtonClickedTime.getTime());x.AFrameworkApplication.cS().execute(jb=>{jb.sendMessage(Q.a.GRa,
ha)});if(nb&&nb.MoveButtonClickedTime){if(X=L.a.ot())nb=(new Date).getTime()-nb.MoveButtonClickedTime.getTime(),X.set("MovePostDuration",nb.toString());J.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",X)}return 32}return 8}Ssc(X,la,sa,Va,nb){if(1===sa)return x.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?this.S$a():8;if(2===sa){if(!x.AFrameworkApplication.cbg)return J.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!nb)return J.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(nb[Y.a.lAi])if(nb[Y.a.Lug])if(X=nb[Y.a.Lug].toLowerCase(),la=x.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"),sa=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),la&&x.AFrameworkApplication.eea&&sa){const ha={};ha[Y.a.zTa]="1";ha[Y.a.documentUrl]=X;ha[Y.a.reason]=W.a.saveAs;J.Health.instance.recordKpiSuccess("MoveToFolder",null);x.AFrameworkApplication.cS().execute(jb=>
{jb.sendMessage(Q.a.O_,ha)})}else if(!x.AFrameworkApplication.eea&&sa)J.Health.instance.recordKpiSuccess("MoveToFolder",null),P.a.Jf(X,P.a.QY(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return J.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else J.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else x.AFrameworkApplication.AMa(Object(c.a)(this,this.vvc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.uvc,"onRefreshFilenameFailure"),
!1),x.AFrameworkApplication.cbg(),J.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}sWj(X,la){return X&&la?X!==this.lx.breadcrumbFolderName||la!==this.lx.breadcrumbFolderUrl:!1}vvc(X,la){X&&(X.NewName!==w.a.Jq(this.lx.co)||this.sWj(X.BreadcrumbFolderName,X.BreadcrumbFolderUrl))&&this.lLb(X,la)}uvc(){}a8f(){this.hte(w.a.Jq(this.lx.co))}get Ci(){return this.Na.value}get lA(){return this.oOc.value}static get instance(){return pa.Oa||(pa.Oa=pa.Tla())}static Tla(){return new pa(x.AFrameworkApplication.T$a,
new b.a(()=>x.AFrameworkApplication.Qb),new b.a(()=>x.AFrameworkApplication.lA),x.AFrameworkApplication.kn,x.AFrameworkApplication.limitedEdit,()=>x.AFrameworkApplication.userCanRename,x.AFrameworkApplication.pAc,Object(c.a)(S.instance,S.instance.LY,"updateTitle"),D.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.fa,D.a.instance.resolve("Common.IRenameProps"))}static Z0g(X,la){X=w.a.A6(X);return la+X}static zrj(X){const la=
X.Values[Y.a.qEi];f.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",la);la?x.AFrameworkApplication.Qb.Be(t.a.Ssc,2,X.Values):J.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static xrj(X){x.AFrameworkApplication.Qb.Be(t.a.renameFile,2,X.Values.NewName)}}pa.Oa=null;Object(u.a)(pa,"RenameActor",null,[]);a(581);class aa{}Object(u.a)(aa,"ActivityEventName",null,[]);class Z{}Z.compatMode="CompatMode";Z.noSelection="NoSelection";
Object(u.a)(Z,"ActivityEventReason",null,[]);var fa=a(664);class ya{constructor(X,la){this.Na=X;this.OYa=la}vh(){this.Na.xc(t.a.Vig,r.a.frame,Object(c.a)(this,this.YYj,"showRenameDialogAction"))}YYj(X,la,sa){X=32;if(1===sa)return fa.SessionStatusManager.instance.A8a||x.AFrameworkApplication.w7?8:32;2===sa&&(32!==this.Na.processAction(t.a.renameFile,1)?(this.Na.processAction(t.a.$hb,2),X=8):32===this.Na.processAction(t.a.xSb,1)?this.Na.processAction(t.a.xSb,2):this.OYa.value.create().TEc());return X}}
Object(u.a)(ya,"RenameDialogActor",null,[520]);class Aa{constructor(X,la,sa){this.dialog=null;this.Na=X;this.lx=la;this.Ssa=sa}Dci(){const X={};X.nameInputProps={["type"]:"AppInputProps",["id"]:Aa.r5a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:w.a.Jq(this.lx.co),["maxLength"]:this.Ssa};return X}TEc(){const X={["id"]:"RenameDialog",["bodyControls"]:this.Dci()};this.dialog=new k.a(!1,!1,!0);this.dialog.rc=1;this.dialog.Te="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,
Object(c.a)(this,this.TSd,"renameDialogHandler"),X)}TSd(X,la){la&&1===X&&la[Aa.r5a]&&(X=w.a.Jq(this.lx.co),la=(la[Aa.r5a]||"").trim(),la!==X&&""!==la&&this.Na.Be(t.a.renameFile,2,la))}}Aa.r5a="txtDocumentName";Object(u.a)(Aa,"ReactRenameDialog",null,[535]);class ja{static get Eg(){return k.a.$p(ja.Sl,CommonUIStrings.l_RenameDialogLabel)}}ja.Sl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(ja,"RenameDialogHtml",null,[]);class za extends k.a{constructor(X,la,sa){super();this.Na=X;this.lx=la;this.Ssa=sa;this.Te="RenameDialog";this.Eg=ja.Eg}TEc(){var X={["txtDocumentName"]:w.a.Jq(this.lx.co)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.TSd,"renameDialogHandler"),X);X=document.getElementById(za.r5a);0<this.Ssa&&(X.maxLength=this.Ssa);X.focus()}TSd(X,la){1===X&&(X=w.a.Jq(this.lx.co),la=(la[za.r5a]||"").trim(),la!==X&&""!==la&&this.Na.Be(t.a.renameFile,
2,la))}}za.r5a="txtDocumentName";Object(u.a)(za,"RenameDialog",k.a,[535]);class ra{constructor(X){this.aaa=null;this.Ssa=0;this.Na=X;this._initialized=!1}initialize(X,la){this.aaa=X;this.Ssa=la;this._initialized=!0}create(){return this._initialized?x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Qw&&x.AFrameworkApplication.fa.ra("ReactRenameDialogIsEnabled")?new Aa(this.Na,this.aaa,this.Ssa):new za(this.Na,this.aaa,this.Ssa):null}}Object(u.a)(ra,"RenameDialogFactory",null,[519]);var fb=
a(273),Ua=a(128),Ca=a(140),Ia=a(112),oa=a(108);class Da{constructor(X,la){this.Na=X;this.Dc=la}vh(){this.Na.xc(t.a.xSb,r.a.frame,Object(c.a)(this,this.ZYj,"showRenameFlyoutAction"))}Iah(){return Ca.d("setDocumentTitleFlyoutOpened")&&x.AFrameworkApplication.sa.Qa.Kv}ZYj(X,la,sa){if(1===sa)return this.Iah()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}FUg(){Da.DHi&&x.AFrameworkApplication.C$a&&oa.a.instance.jg(new Ia.a(5,1,5E3,()=>{32===this.Na.processAction(t.a.xSb,
1)&&this.Dc&&this.Dc.Ni.name===fb.AFrame.Q5&&(Ua.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Na.processAction(t.a.xSb,2))}))}static get DHi(){Da.PZb&&null!=Da.PZb||(x.AFrameworkApplication.e8("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Da.PZb=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Da.PZb}}Da.PZb=null;Object(u.a)(Da,"RenameFlyoutActor",null,
[518]);class bb{constructor(X,la,sa,Va,nb){this.oOc=nb;this.$ie=sa;this.Zie=Va;this.mQg=X;this.fta=la}get lA(){return this.oOc.value}ndf(){if(!this.Zie())return 5;if(this.fta())return 1;if(this.lA){if(this.$ie&&!this.lA.QUe)return 3;if(!this.$ie&&!this.lA.jAb)return 4}return this.mQg()?0:2}}Object(u.a)(bb,"RenameProps",null,[517]);a(199);var Za=a(106);class Xa{constructor(X,la,sa,Va,nb,ha){this.zy=!1;this.mUc=new Za.a;this.VYa=la;this.QM=sa;this.rEg=Va;this.Ta=nb;this.Pre=ha}enable(){this.zy||(this.nsg(),
this.Z1d(),this.zy=!0)}generateKey(X,la,sa){return String.format("{0}/{1}/{2}",sa,X,la)}v8h(){const X=w.a.Jq(this.VYa().co);return this.generateKey(this.VYa().breadcrumbFolderName,this.VYa().breadcrumbFolderUrl,X)}w8h(X,la,sa){return X&&la?this.generateKey(X,la,sa):sa}Axh(X,la,sa){return X&&X!==this.VYa().breadcrumbFolderName||la&&la!==this.VYa().breadcrumbFolderUrl?!0:sa!==w.a.Jq(this.VYa().co)}nsg(){const X=this.v8h();this.mUc.ia(X,new Date)}yMd(X){this.RUj(X)&&this.wue(X)}RUj(X){const la=this.rEg();
return la?this.Pre&&this.Pre.vFb||!la.yqf||!x.AFrameworkApplication.AMa?(this.xlg(X),this.zy=!1):!0:!1}ORf(X,la,sa,Va){const nb=this.Axh(X,la,sa);X=this.w8h(X,la,sa);la=this.mUc.nd(X).returnValue;nb&&!la&&(this.xhf(Va),f.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.hDd));nb||this.mUc.ia(X,this.QM())}}Object(u.a)(Xa,"ARenamedFileChecker",null,[491]);class Ba extends Xa{constructor(X,la,sa,Va,nb,ha,jb,Fb){super(X,la,sa,Va,nb,ha);this.$oe=nb;this.HMg=jb;this.aIg=Fb}get hDd(){return"RenamedFileCheckerUsingSettingsRefresh"}Z1d(){this.$oe.D2c(Object(c.a)(this,
this.iif,"handleSettingsRefresh"))}iif(X,la){la&&la.EJb&&la.T_i&&(la.cab("BreadcrumbDocName")||la.cab("BreadcrumbFolderName")||la.cab("BreadcrumbFolderUrl")||la.cab("DirectInvokeDAVUrl")||la.cab("EditDocInClientUrl"))&&(f.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.hDd),this.yMd(la))}xlg(){this.$oe.T4f(Object(c.a)(this,this.iif,"handleSettingsRefresh"))}wue(X){if(X&&X.EJb){const la=X.EJb;this.ORf(la.Va("BreadcrumbFolderName"),la.Va("BreadcrumbFolderUrl"),la.Va("BreadcrumbDocName"),
X)}}xhf(X){const la={OperationResult:0,classId:1};X=X.EJb;la.BreadcrumbFolderName=X.Va("BreadcrumbFolderName");la.BreadcrumbFolderUrl=X.Va("BreadcrumbFolderUrl");la.DirectInvokeDavUrl=X.Va("DirectInvokeDAVUrl");la.EditDocInClientUrl=X.Va("EditDocInClientUrl");X=X.Va("BreadcrumbDocName");la.NewName=x.AFrameworkApplication.Bwa?X:w.a.Jq(X);this.aIg.execute(sa=>{this.yxi(la,sa)})}yxi(X,la){this.HMg().lLb(X,la)}}Object(u.a)(Ba,"RenamedFileCheckerUsingSettingsRefresh",Xa,[]);class Wa extends Xa{constructor(X,
la,sa,Va,nb,ha,jb,Fb,Rb,mb){super(X,sa,Va,nb,ha,Rb);this.Gpb=this.W2b=null;this.QLg=la;this.Na=jb;this.Ce=Fb;mb&&mb.execute(sb=>{this.dvj(sb)})}get hDd(){return"RenamedFileCheckerUsingTask"}dvj(X){this.W2b=X;this.W2b.Fye(Object(c.a)(this,this.nCb,"handleVisibilityChange"))}nCb(X,la){!this.zy||0!==la.newState&&1!==la.newState||this.Gpb||(this.Z1d(),this.yMd(this.Gpb))}Z1d(){this.Gpb=new Ia.a(3,2,this.QLg(),Object(c.a)(this,this.yMd,"performRenameFileCheckTick"),89);this.Ce.jg(this.Gpb)}xlg(X){this.Ce.Zp(X)}wue(X){this.W2b&&
2===this.W2b.vnk?this.iwj(X):x.AFrameworkApplication.AMa(Object(c.a)(this,this.vvc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.uvc,"onRefreshFilenameFailure"),!0)}iwj(X){this.Ce.Zp(X);this.Gpb=null}vvc(X){X&&this.ORf(X.BreadcrumbFolderName,X.BreadcrumbFolderUrl,X.NewName,null)}xhf(){this.Na.processAction(t.a.fileNameUpdate,2)}uvc(){}}Object(u.a)(Wa,"RenamedFileCheckerUsingTask",Xa,[]);var Na=a(102);class ta{constructor(){this.Ta=this.Db=null}get name(){return"Common.App.RenameFile"}Di(X){this.Db=
X;this.Ta=x.AFrameworkApplication.fa;this.Db.register(ya,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").dd(()=>new ya(x.AFrameworkApplication.Qb,this.Db.zUd("Common.App.Rename.IRenameDialogFactory"))).Uc();this.Db.register(ra,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").dd(()=>new ra(x.AFrameworkApplication.Qb)).Uc();this.Db.register(491,"Common.App.Rename.IRenamedFileChecker").dd(()=>this.Oqh()).Uc();this.Db.register(Da,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").dd(()=>new Da(x.AFrameworkApplication.Qb,Na.FocusManager.instance())).Uc()}Oqh(){if(this.Ta.ra("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const X=this.Db.ah("Common.IRefreshableAppSettings");if(X&&X.Btf)return new Ba(()=>X.oe("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>x.AFrameworkApplication.kn,()=>new Date,()=>x.AFrameworkApplication.lA,X,this.Db.ah("Common.ISessionStatus"),()=>pa.instance,this.Db.qc("Postmessage.IHostPostmessenger"))}return new Wa(()=>
this.Ta.oe("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ta.oe("RenamedFileCheckerPingIntervalInMs",12E4),()=>x.AFrameworkApplication.kn,()=>new Date,()=>x.AFrameworkApplication.lA,x.AFrameworkApplication.fa,x.AFrameworkApplication.Qb,x.AFrameworkApplication.Mi,this.Db.ah("Common.ISessionStatus"),this.Db.qc("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ta.Hv(Object(c.a)(this,this.DC,"onFullAppSettingsReady"))}DC(){const X=x.AFrameworkApplication.sa.Qa.Kv;x.AFrameworkApplication.T$a()&&
S.instance.initialize(x.AFrameworkApplication.Uec,X?null:x.AFrameworkApplication.s5a,X?null:x.AFrameworkApplication.VSd||CommonUIStrings.l_RenameFileTooltip)&&(this.Db.register(bb,"Common.App.Rename.RenameProps").as("Common.IRenameProps").dd(()=>new bb(()=>x.AFrameworkApplication.userCanRename,()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.pAc,x.AFrameworkApplication.T$a,new b.a(()=>x.AFrameworkApplication.lA))).Uc(),pa.instance.vh(),this.Ta.ra("RenameDialogIsEnabled")&&
(this.Db.resolve("Common.App.Rename.RenameDialogFactory").initialize(x.AFrameworkApplication.kn,x.AFrameworkApplication.Uec),this.Db.resolve("Common.App.Rename.IRenameDialogActor").vh()),this.Db.resolve("Common.App.Rename.IRenameFlyoutActor").vh(),x.AFrameworkApplication.pAc&&this.Db.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Db.resolve("Common.App.Rename.IRenameFlyoutActor").FUg())}dispose(){}}Object(u.a)(ta,"PackageManager",null,[4,5]);var V=a(260);a.d(C,"a",function(){return ia});
const ia=()=>{Type.registerNamespace("Common.App.Rename");V.a.instance.nj(new ta,7)}},1192:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(90),f=a(113),e=a(14),d=a(92),h=a(57),l=a(34),k=a(31),n=a(13),v=a(247),x=a(1086),w=a(7),r=a(272),t=a(1087),A=a(735),y=a(989),z=a(872);class E extends z.a{constructor(Ra,Jb,yb){super(Ra,Jb,yb)}ME(Ra){super.ME(Ra)}}Object(u.a)(E,"EditAttemptReadOnlyBusinessBarEntry",z.a,[]);var G=a(49);class F extends A.a{constructor(Ra,Jb,yb,Gb){super(Ra,Jb);this.error=yb;this.options=
Gb;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Hs=!(Gb&4)}Km(Ra){super.Km(Ra);this.error.Appearance&=-33;G.a(this.businessBar.$).Wu([this.error])}}Object(u.a)(F,"ErrorBusinessBarEntry",A.a,[]);var O=a(91);class M extends F{constructor(Ra,Jb,yb,Gb,ub){super(Ra,Jb,yb,Gb);this.command=ub;this.GW=!0}vX(Ra){super.vX(Ra);this.businessBar.$.Ia.$b(new O.a(this.command,Ra,this.businessBar.$.Kc,10,null))}}Object(u.a)(M,"ErrorAndCommandBusinessBarEntry",
F,[]);var P=a(16);class B{constructor(Ra,Jb,yb,Gb,ub,Ja,zb,na,Ea,ma){this.pK=this.J$=this.rQ=0;this.SDg=Ra;this.c7j=Jb;this.qK=yb;this.cIg=zb;this.knb=l.a.rv(Ea);this.iGg=Ea;this.ybe=na;this.dIg=ma;0!==Gb&&(this.rQ=Gb);0!==ub&&(this.J$=ub);0!==Ja&&(this.pK=Ja)}get title(){return B.ha(this.c7j)}get message(){return B.ha(this.qK)}get messageId(){return this.qK}get iconName(){return this.dIg}get T2a(){return this.SDg}get actionButton(){return B.ha(this.rQ)}get uJa(){return B.ha(this.J$)}get link(){return B.ha(this.pK)}get vl(){return this.cIg}get businessBarType(){return this.ybe}get hash(){return this.knb}get alt(){const {BusinessBarControl:Ra}=
a(1192);switch(this.vl){case Ra.Yka:return B.ha(26);case Ra.Vz:return B.ha(25);case Ra.kj:return B.ha(24);default:return B.ha(0)}}get lMa(){return this.iGg}set businessBarType(Ra){this.ybe=Ra}static ha(Ra){return P.a.instance.ha(Ra)}}Object(u.a)(B,"EwaBusinessBarEntry",null,[]);class D extends B{constructor(Ra,Jb,yb,Gb,ub,Ja,zb,na){super(Ra,0,Jb,yb,Gb,ub,Ja,zb,na)}get title(){return""}}Object(u.a)(D,"EwaNoTitleBusinessBarEntry",B,[]);var I=a(76);class S extends A.a{constructor(Ra,Jb){super(Ra,Jb);
this.GW=this.Hs=!0}Km(Ra){super.Km(Ra);this.set_visible(!1);this.businessBar.$.CJ();this.businessBar.$.Ia.$b(new O.a(1038998010,Ra,this.businessBar.$.Kc,10,null))}vX(Ra){super.vX(Ra);this.businessBar.$.Ia.$b(new O.a(-722953877,Ra,this.businessBar.$.Kc,10,null))}ME(Ra){this.businessBar.removeEntry(55);I.g(Ra)}}Object(u.a)(S,"ExternalLinksEnableContentBusinessBarEntry",A.a,[]);class J extends A.a{constructor(Ra,Jb){super(Ra,Jb);this.Hs=!0;this.GW=!1}Km(Ra){super.Km(Ra);this.businessBar.$.Ia.$b(new O.a(-722953877,
Ra,this.businessBar.$.Kc,10,null))}ME(Ra){this.businessBar.removeEntry(5);I.g(Ra)}}Object(u.a)(J,"ExternalLinksShowErrorBusinessBarEntry",A.a,[]);var L=a(12);class R extends A.a{constructor(Ra,Jb,yb){super(Ra,Jb);this.UCb=yb;this.Hs=!0}Km(Ra){super.Km(Ra);L.HelperMethods.XS(this.businessBar.$.jF,this.UCb,this.businessBar.$.lQ)}}Object(u.a)(R,"HelpButtonBusinessBarEntry",A.a,[]);class Y extends A.a{constructor(Ra,Jb,yb){super(Ra,Jb);this.UCb=yb;this.Eya=!0}Ooa(Ra){super.Ooa(Ra);L.HelperMethods.XS(this.businessBar.$.jF,
this.UCb,this.businessBar.$.lQ)}}Object(u.a)(Y,"HelpTextBusinessBarEntry",A.a,[]);var Q=a(79);class W extends A.a{constructor(Ra,Jb,yb,Gb){super(Ra,Jb);this.UCb=yb;this.command=Gb;this.Eya=!0;this.Hs=1461300262!==Gb}Km(Ra){super.Km(Ra);this.businessBar.$.Ia.$b(new O.a(this.command,Ra,this.businessBar.$.Kc,10,null))}Ooa(Ra){super.Ooa(Ra);const Jb=new O.a(-859308420,Ra,this.businessBar.$.Kc,12,null);this.businessBar.$.Ia.$b(Jb,{[Q.a.Bg]:"HelpID="+this.UCb,["InputMethod"]:Ra,[Q.a.rd]:w.a.fS,[w.a.$qa]:!0})}}
Object(u.a)(W,"HelpTextTaskPaneAndCommandBusinessBarEntry",A.a,[]);class Ga extends A.a{constructor(Ra,Jb){super(Ra,Jb);this.GW=this.Hs=!0}Km(Ra){super.Km(Ra);this.set_visible(!1);this.businessBar.$.CJ();this.businessBar.$.Ia.$b(new O.a(-1081442996,Ra,this.businessBar.$.Kc,10,null))}vX(Ra){super.vX(Ra);this.businessBar.$.Ia.$b(new O.a(1702917262,Ra,this.businessBar.$.Kc,10,null))}ME(Ra){this.businessBar.removeEntry(59);I.g(Ra)}}Object(u.a)(Ga,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
A.a,[]);var pa=a(1090);class aa extends A.a{constructor(Ra,Jb){super(Ra,Jb);(this.policyManager=Ra.$.da.Ba(274))?(this.message=this.policyManager.kxc,this.title=this.policyManager.title,this.Eya=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Ooa(Ra){super.Ooa(Ra);(Ra=this.policyManager.H8i)&&Ra(null)}}Object(u.a)(aa,"PolicyBusinessBarEntry",A.a,[]);var Z=a(1088),fa=
a(1092),ya=a(1091);a(427);var Aa=a(128),ja=a(26);class za extends A.a{constructor(Ra,Jb){super(Ra,Jb);this.Hs=!0;this.title=""}Km(Ra){super.Km(Ra);Aa.c(ja.a.fYi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(u.a)(za,"UnsupportedBrowserBusinessBarEntry",A.a,[]);var ra=a(1085),fb=a(88),Ua=a(892),Ca=a(945),Ia=a(1253);class oa{constructor(){this.KMc=new Ia.a;this.IMc=new Ia.a;this.HMc=new Ia.a;this.O6g(this.KMc);this.N6g(this.IMc);this.M6g(this.HMc);this.QRc=new Ia.a;
this.PRc=new Ia.a;this.ORc=new Ia.a;this.m9g(this.QRc);this.l9g(this.PRc);this.k9g(this.ORc);this.bOc=new Ia.a;this.g7g(this.bOc);this.RIa(this.bOc);this.RIa(this.HMc);this.RIa(this.IMc);this.RIa(this.KMc);this.RIa(this.PRc);this.RIa(this.QRc);this.RIa(this.ORc)}pfi(Ra,Jb){switch(Ra){case 1:return this.Kii(Jb);case 2:return this.t_h(Jb)}return Ca.a.H_d?this.bOc:null}O6g(Ra){Ra.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);Ra.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
Ra.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}N6g(Ra){Ra.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Ra.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ra.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}M6g(Ra){Ra.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);Ra.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ra.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}m9g(Ra){Ra.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);Ra.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ra.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Ra.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Ra.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);Ra.add("OverlayBig","Get the Word app");Ra.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Ra.add("OverlaySmallSplit1",
"Discover Word");Ra.add("OverlaySmallSplit2","designed for the iPad.");Ra.add("SkipButton","Skip for now")}g7g(Ra){Ra.add("Headline","Get the Office Online extension for Chrome");Ra.add("UseAppButton","Get the extension");Ra.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}l9g(Ra){Ra.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Ra.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ra.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
Ra.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Ra.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);Ra.add("OverlayBig","Get the PowerPoint app");Ra.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Ra.add("OverlaySmallSplit1","Discover PowerPoint");Ra.add("OverlaySmallSplit2","designed for the iPad.");Ra.add("SkipButton","Skip for now")}k9g(Ra){Ra.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
Ra.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ra.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Ra.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Ra.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}RIa(Ra){Ra.add("Corporation","Microsoft Corporation")}Kii(Ra){switch(Ra){case 3:return this.QRc;case 2:return this.PRc;case 1:return this.ORc}return null}t_h(Ra){switch(Ra){case 3:return this.KMc;case 2:return this.IMc;
case 1:return this.HMc}return null}static get instance(){oa.Oa||(oa.Oa=new oa);return oa.Oa}}oa.Oa=null;Object(u.a)(oa,"WildFireStringFactory",null,[]);var Da=a(6),bb=a(41);class Za{constructor(Ra,Jb,yb,Gb,ub=null,Ja=null){this.kWc=null;this._id=Ra;this.TWc=Jb;this.wHg=ub;this.Enb=Gb;this.Rpb=Ja;this.yFa=null;this.D0a=yb;this.rqb=oa.instance.pfi(Jb,Ra)}xOe(){this.yFa=new Ua.a(this.title,this.message,null);this.yFa.addButton(this.aGe,Object(fb.a)(this,this.OIf,"onButtonOneClick"),"");this.D0a&&this.yFa.yUg(this.cGe,
Object(fb.a)(this,this.RIf,"onButtonTwoClick"));this.yFa.Yba=Object(fb.a)(this,this.YTe,"dismissBar");this.yFa.image=3;this.yFa.id=16;this.yFa.closeable=!0}get title(){return this.rqb.ma("Headline")}get message(){return this.rqb.ma("CallToAction")}get yhk(){return this.D0a}get aGe(){return this.D0a?this.rqb.ma("InstallButton"):this.rqb.ma("UseAppButton")}get cGe(){return this.D0a?this.rqb.ma("OpenAppButton"):""}OIf(){this.D0a?this.awi():this.ohk()}RIf(){this.D0a&&this.qej()}get openUrl(){this.kWc||
(this.kWc=this.wHg());return this.kWc}awi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Enb&&this.Rpb&&this.Rpb();Ca.a.s1f(this._id,this.TWc)}qej(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Enb&&this.Rpb&&this.Rpb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Ca.a.XAe(this._id),this.openUrl,0,!1))}ohk(){Ca.a.H_d?this.r9g():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Ca.a.LYd("BizBarClicked"),
1!==this.TWc&&2!==this.TWc||Ca.a.Xeh(this.openUrl,this.Enb,this._id,this.Rpb))}r9g(){this.Enb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");bb.a.jW(Da.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}dyh(){this.Enb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Ca.a.LYd(Ca.a.Kdh)}YTe(){Ca.a.H_d?this.dyh():(Ca.a.LYd(Ca.a.Y7e(this._id)),
c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Fsh(){const Ra=Da.AFrameworkApplication.sa.Qa,Jb=new Za(Ra.Ii,Ca.a.agf(),8<k.a.iDb,1===Ra.kBa,()=>Ra.Cx,Ra.kGj());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Jb}}Object(u.a)(Za,"WildFireBusinessBar",null,[]);class Xa extends A.a{constructor(Ra,Jb){super(Ra,Jb);this.hFa=Za.Fsh();this.Hs=!0;this.GW=this.hFa.yhk;this.title=this.hFa.title;this.message=this.hFa.message}get actionButton(){return this.hFa.aGe}get uJa(){return this.hFa.cGe}Km(Ra){super.Km(Ra);
this.hFa.OIf(null)}vX(Ra){super.vX(Ra);this.hFa.RIf(null)}ME(Ra){super.ME(Ra);this.hFa.YTe(null)}}Object(u.a)(Xa,"WildFireMobileAppBusinessBarEntry",A.a,[]);var Ba=a(259),Wa=a(23),Na=a(193),ta=a(175),V=a(44),ia=a(2),X=a(185),la=a(1093),sa=a(69),Va=a(136);class nb extends A.a{constructor(Ra,Jb,yb,Gb){super(Ra,Jb);this.officeScriptsCommandManager=yb.da.Ba(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=X.a.create();this.$=yb;this.title=P.a.instance.ha(2282);this.message=
"";this.i2d=P.a.instance.ha(2278);this.wwg=P.a.instance.ha(2279);this.uwg=P.a.instance.ha(2280);this.OMe=P.a.instance.ha(2281);this.update(Gb)}update(Ra){this.scriptLink=Ra.scriptLink;this.runStatus=Ra.runStatus;this.buttonText=Ra.buttonText||"";this.UOi(Ra.clickId);this.BCj();"preparing"===this.runStatus?(this.fqa(0),this.message=String.format(P.a.instance.Lb(208),this.buttonText),this.Hs=!0,this.vua=this.i2d,this.rvb=this.Tia=this.ldb):"running"===this.runStatus?(this.fqa(0),this.message=String.format(P.a.instance.Lb(207),
this.buttonText),this.Hs=!0,this.vua=this.i2d,this.rvb=this.Tia=this.ldb):"succeeded"===this.runStatus?(this.fqa(0),this.message=String.format(P.a.instance.Lb(210),this.buttonText),"true"===Ra.hasLogs?(this.Hs=!0,this.vua=this.uwg,this.Tia=this.SSf,this.GW=!0,this.w3c=this.wwg,this.x3c=this.TSf):(this.Hs=!0,this.vua=this.wwg,this.Tia=this.TSf)):"runFailed"===this.runStatus?(this.fqa(1),this.message=String.format(P.a.instance.Lb(209),this.buttonText),this.W8a=qb.Yka,"true"===Ra.hasLogs?(this.Hs=!0,
this.vua=this.uwg,this.Tia=this.SSf,"false"===Ra.isOwner&&(this.GW=!0,this.w3c=this.OMe,this.x3c=this.VJf)):"false"===Ra.isOwner&&(this.Hs=!0,this.vua=this.OMe,this.Tia=this.VJf)):"fetchFailed"===this.runStatus?(this.fqa(1),this.W8a=qb.Yka,this.message=P.a.instance.ha(2284)):"canceled"===this.runStatus?(this.fqa(0),this.W8a=qb.Vz,this.message=String.format(P.a.instance.Lb(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.fqa(5),this.W8a=qb.Vz,this.message=String.format(P.a.instance.Lb(211),
this.buttonText),this.Hs=!0,this.vua=this.i2d,this.rvb=this.Tia=this.ldb):"initializing"===this.runStatus&&(this.fqa(0),this.W8a=qb.kj,this.message=P.a.instance.ha(2283))}get vl(){return this.W8a}get actionButton(){return this.vua}get uJa(){return this.w3c}Km(Ra){super.Km(Ra);this.Tia&&this.Tia()}vX(Ra){super.vX(Ra);this.uJa&&this.x3c()}ME(Ra){super.ME(Ra);this.rvb&&this.rvb()}BCj(){this.message="";this.W8a=qb.kj;this.Hs=!1;this.vua="";this.Tia=void 0;this.GW=!1;this.w3c="";this.x3c=void 0;this.hideCloseButton=
!1;this.rvb=void 0}ldb(){const Ra=X.a.create().toString();this.officeScriptsCommandManager.Uji(Ra);this.brc(-2186799,Ra)}SSf(){const Ra=X.a.create().toString();this.officeScriptsCommandManager.Tji(Ra);this.brc(1036446140,Ra)}TSf(){const Ra=X.a.create();if(this.scriptLink){const Jb=new la.b(this.scriptLink);this.officeScriptsCommandManager.jif(this.id.toString(),JSON.stringify(Jb),Ra)}this.brc(-585097204,Ra.toString())}VJf(){const Ra=X.a.create().toString();this.officeScriptsCommandManager.Sji(Ra);
this.brc(-639858579,Ra)}UOi(Ra){const Jb=[];Jb.push(Object(ia.a)(new sa.a,{name:"id",string:this.id.toString()}));Jb.push(Object(ia.a)(new sa.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Jb.push(Object(ia.a)(new sa.a,{name:"runStatus",string:this.runStatus}));Jb.push(Object(ia.a)(new sa.a,{name:"clickId",string:Ra}));Jb.push(Object(ia.a)(new sa.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));Aa.a(Va.a.B_i,void 0,void 0,Jb)}brc(Ra,Jb){const yb=[];yb.push(Object(ia.a)(new sa.a,
{name:"id",string:this.id.toString()}));yb.push(Object(ia.a)(new sa.a,{name:"hasScriptLink",bool:!!this.scriptLink}));yb.push(Object(ia.a)(new sa.a,{name:"runStatus",string:this.runStatus}));yb.push(Object(ia.a)(new sa.a,{name:"clickId",string:Jb}));Aa.d(Ra,void 0,void 0,void 0,void 0,void 0,yb)}}Object(u.a)(nb,"OfficeScriptsRunStatusBusinessBarEntry",A.a,[]);var ha=a(51),jb=a(1);class Fb extends z.a{constructor(Ra,Jb,yb,Gb,ub,Ja){super(Ra,Jb,yb);ha.a.instance.create(()=>{this.showCallout(Jb,Gb)},
ub,Ja,!0,!0)}showCallout(Ra,Jb){if(this.businessBar&&this.businessBar.qna(Ra.T2a)&&this.Vze()){Ra=new O.a(-847286761,0,this.businessBar.$.Kc,0,null);var yb={};yb.CalloutName=Jb;jb.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?yb.Target=this.pL():yb.Target=jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.rQ.domElement;this.businessBar.$.Ia.$b(Ra,yb)}}Vze(){return!0}}
Object(u.a)(Fb,"CalloutBusinessBarEntry",z.a,[]);class Rb extends Fb{constructor(Ra,Jb,yb,Gb,ub,Ja){super(Ra,Jb,yb,Gb,ub,Ja)}Vze(){if(!jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Ra=this.businessBar.$.da.Ba(465);return Ra&&Ra.ZBc?!1:!0}}Object(u.a)(Rb,"OptimizeWorkbookCalloutBusinessBarEntry",Fb,[]);var mb=a(19);class sb extends A.a{constructor(Ra,Jb,yb){super(Ra,Jb);this.update(yb)}update(Ra){this.title=
Ra.title?Ra.title:"";this.message=Ra.message?Ra.message:"";this.fqa(this.Akh(Ra.businessBarType));this.hideCloseButton=!!Ra.hideCloseButton}Akh(Ra){switch(Ra){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(u.a)(sb,"MsFormsDataSyncStatusBusinessBarEntry",A.a,[]);class Ya extends A.a{constructor(Ra,Jb,yb,Gb){super(Ra,Jb);this.GW=this.Hs=!0;this.Nlj=yb;this.b0g=Gb}Km(Ra){super.Km(Ra);this.businessBar.$.Ia.$b(new O.a(this.Nlj,
Ra,this.businessBar.$.Kc,10,null))}vX(Ra){super.Km(Ra);this.businessBar.$.Ia.$b(new O.a(this.b0g,Ra,this.businessBar.$.Kc,10,null))}}Object(u.a)(Ya,"DualCommandActionsBusinessBarEntry",A.a,[]);class Ma extends A.a{constructor(Ra,Jb,yb,Gb){super(Ra,Jb);this.host=yb.xa.HostName;this.Mpi="OneDriveWOPI"===this.host||"Open From URL"===this.host;"Open From URL"===this.host?appChrome.renderSaveACopyToOneDriveCallout(Gb,!1):(this.YGi=jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",
!1)||jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",!1)||jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.Mpi&&appChrome.renderSaveACopyToOneDriveCallout(Gb,!1)}}Object(u.a)(Ma,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",A.a,[]);var xb=a(1089);a.d(C,"BusinessBarControl",function(){return qb});class qb extends v.a{constructor(Ra,Jb){super(Jb);this.t5e=n.DOMElementExtensions.Er+",div";this.AV=Array(71);
this.Bn=!1;this.yX=yb=>{if(yb.Da.keyCode===b.a.Tz){var Gb=this.Lc.querySelectorAll(this.t5e);const ub=n.DOMElementExtensions.nm(Gb);Gb=n.DOMElementExtensions.iC(Gb);return n.DOMElementExtensions.vDa(yb.Da,ub,Gb)}return!1};this.Jb=Ra;this.set_visible(!1);this.addCssClass(x.a.dFh);jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(x.a.nFh);f.KeyInputManager.instance.ta(e.a.yc,this.Lc,this.yX);r.a(Ra).Pi(this)}get Ge(){return Ba.a.r6c}get Lc(){return this.domElement}get sg(){return this.get_visible()}get $(){return this.Jb}Qg(Ra,
Jb){jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Jb||n.DOMElementExtensions.setFocus(n.DOMElementExtensions.nm(this.Lc.querySelectorAll(this.t5e))):Jb||n.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Jb}hi(Ra){return n.DOMElementExtensions.lg(this.Lc,Ra)}ek(){}Gk(){}dispose(){this.Bn||(f.KeyInputManager.instance.Aa(e.a.yc,this.Lc,this.yX),d.a.Rc(this.AV),this.AV=Array(71),this.Jb=null,super.dispose(),this.Bn=!0)}qna(Ra){if(!this.get_visible())return!1;
Ra=this.AV[Ra];return!!Ra&&Ra.isVisible}uld(Ra){return this.qna(Ra)?this.AV[Ra].pL():null}YF(Ra){return!!this.AV[Ra]}KUb(Ra,Jb){if(Ra=this.AV[Ra])Ra.update(Jb),Ra.gdk()}CD(Ra,Jb,yb=null,Gb=null){let ub=!1;if(this.YF(Ra))yb=this.AV[Ra].get_visible();else{this.set_visible(!0);const Ja=qb.igf()[Ra];this.AV[Ra]=this.x5(Ra,Jb,yb,Gb);yb=!1;ub=!0;Gb="";let zb=0;Jb&&(Gb=Jb.MessageIdName,zb=Jb.MessageId);const na=Ja.lMa,Ea=V.PageLoadTrackingInfo.instance.lya(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Ra}, time from app interactive: ${Ea}`);
jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===Ja.businessBarType||ta.a(this.$).nTd(Ja.hash,Gb,zb,h.a.EIc,!0,1,Jb,na)}yb||!y.BusinessBarManager.ajc().includes(Ra)&&!ub||(this.AV[Ra].set_visible(!0),this.$.CJ())}removeEntry(Ra){return this.Zvj(Ra)}pRd(){d.a.Rc(this.AV);this.AV=Array(71);this.set_visible(!1)}Zvj(Ra){if(!this.YF(Ra))return!1;d.a.Ka(this.AV[Ra]);this.AV[Ra]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.CJ();return!0}x5(Ra,
Jb,yb=null,Gb=null){const ub=qb.igf()[Ra],Ja=!!(this.$.$d&64);switch(Ra){case 23:Ra=new Ma(this,ub,this.Jb,this.Lc);break;case 2:case 4:case 25:case 26:case 36:case 35:Ra=new A.a(this,ub);break;case 12:case 29:case 30:case 31:case 32:case 57:Ra=Ja?new z.a(this,ub,-8805455):new A.a(this,ub);break;case 34:Ra=Ja?new Ya(this,ub,-8805455,-104572626):new A.a(this,ub);break;case 22:Ra=new E(this,ub,-8805455);break;case 46:case 45:Ra=Ja?new M(this,ub,Jb,0,-8805455):new F(this,ub,Jb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Ra=
new F(this,ub,Jb,0);break;case 19:Ra=new A.a(this,ub);break;case 47:Ra=new F(this,ub,Jb,0);break;case 6:case 14:Ra=new R(this,ub,Jb.HelpTopicId);break;case 67:case 65:Ra=new Y(this,ub,Jb.HelpTopicId);break;case 37:Ra=new Y(this,ub,w.a.Ith);break;case 38:Ra=new A.a(this,ub);break;case 68:Ra=new E(this,ub,924877417);break;case 16:Ra=new A.a(this,ub);Ra.title=l.a.ki(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Ra.message=l.a.ki(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:Ra=new z.a(this,ub,-1762562205);Ra.hideCloseButton=!0;break;case 20:Ra=new Xa(this,ub);break;case 21:case 56:Ra=new A.a(this,ub);break;case 28:Ra=new A.a(this,ub);break;case 24:Ra=new za(this,ub);break;case 27:Ra=new aa(this,ub);break;case 39:Ra=new ra.a(this,ub);break;case 40:Ra=new t.a(this,ub);break;case 41:Ra=new Z.a(this,ub);break;case 42:Ra=new pa.a(this,ub);break;case 48:Ra=new A.a(this,ub);break;case 49:Ra=new A.a(this,ub);break;case 50:Ra=new A.a(this,ub);break;case 51:Ra=new A.a(this,
ub);break;case 52:Ra=new A.a(this,ub);break;case 53:Ra=new ya.a(this,ub);break;case 54:Ra=new fa.a(this,ub);break;case 55:Ra=new S(this,ub);break;case 5:Ra=new J(this,ub);break;case 58:Ra=new z.a(this,ub,-1753056834);Jb?(Jb=Jb.Directive,Wa.a.Sq(Jb)||"&nbsp;"===Jb||(Ra.message=Jb)):yb&&(Ra.message=yb);break;case 59:Ra=new Ga(this,ub);break;case 60:Ra=new A.a(this,ub);break;case 63:Ra=new Y(this,ub,w.a.CZi);break;case 61:Ra=new W(this,ub,w.a.G4g,-8805455);break;case 66:Ra=new W(this,ub,w.a.hrj,1461300262);
break;case 62:Ra=new Rb(this,ub,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Ra.message=yb;break;case 70:Ra=new xb.a(this,ub,-1190551534);break;case 64:Ra=new nb(this,ub,this.$,Gb);break;case 69:Ra=new sb(this,ub,Gb);break;default:Ra=new F(this,ub,Jb,7)}Ra.xOe();return Ra}static igf(){let Ra;Ra=Na.a.una()?261:260;return qb.QFe||(qb.QFe=[new B(0,276,277,278,0,0,qb.Yka,1,"BB_UnableToRefreshLock"),new B(1,276,277,278,0,0,qb.Yka,1,"BB_UnableToRefreshLockExpected"),new B(2,
268,269,0,0,0,qb.Vz,5,"BB_WorkbookAlmostTooLarge"),new B(3,270,271,272,0,0,qb.Yka,1,"BB_WorkbookTooLarge"),new B(4,259,Ra,0,0,0,qb.Vz,5,"BB_ExternalWorkbookLinksDisabled"),new B(5,263,262,264,0,0,qb.Yka,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new B(6,265,266,267,0,0,qb.kj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new B(7,251,252,253,0,0,qb.kj,5,"BB_UnsupportedFeatures"),new B(8,0,0,0,0,0,qb.kj,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new B(9,0,0,0,0,0,qb.kj,0,"BB_CollabDataStringsLocaleMismatch"),
new B(10,0,0,0,0,0,qb.kj,0,"BB_CollabDataLocaleMismatch"),new B(11,279,280,281,0,0,qb.Yka,1,"BB_LastGenericStatusError"),new B(12,282,283,284,0,0,qb.Vz,5,"BB_ScratchPadWarning"),new B(13,285,286,287,0,0,qb.Yka,1,"BB_AuthenticationLost"),new B(14,288,289,290,0,0,qb.Vz,5,"BB_OdfCompatibilityIssues"),new B(15,0,575,0,0,0,qb.Vz,5,"BB_PivotChartInteractivityMissingWarning"),new B(16,0,0,0,0,0,qb.kj,2,"BB_WorkbookIsIrmProtected"),new B(17,0,0,0,0,0,qb.kj,0,"BB_BIFeatureNotAvailable"),new B(18,291,292,287,
0,0,qb.Vz,5,"BB_AnonymousCreateMode"),new B(19,254,255,0,0,0,qb.Vz,5,"BB_UnsupportedInteractiveReportEditing"),new B(20,0,0,0,0,0,qb.kj,0,"BB_MobileAppCampaignBizBar"),new B(21,297,298,0,0,0,qb.kj,0,"BB_TransientServerCommunicationFailures"),new B(22,1643,1654,1655,0,0,qb.kj,5,"BB_EditAttemptInReadOnly"),new B(23,1643,1654,0,0,0,qb.kj,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new B(24,0,L.HelperMethods.zck(),1632,0,0,qb.kj,3,"BB_UnsupportedBrowser"),new B(25,300,301,0,0,0,qb.kj,2,"BB_ReadOnlyPermissions"),
new B(26,302,303,0,0,0,qb.kj,2,"BB_DocumentIsIrmProtectedWarning"),new B(27,0,0,0,0,0,qb.Vz,5,"BB_PolicyWarningMessage"),new B(28,1285,299,0,0,0,qb.kj,0,"BB_WorkingOnIt"),new B(29,1643,1641,1642,0,0,qb.kj,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new B(30,1656,1657,1658,0,0,qb.kj,5,"BB_WorkbookIsReadOnlyRecommended"),new B(31,1643,1659,1660,0,0,qb.kj,5,"BB_WorkbookHasPasswordToModify"),new B(32,1643,1661,1664,0,0,qb.kj,3,"BB_LegacySharedWorkbookEditWarning"),new B(33,1651,1662,253,0,0,qb.kj,
5,"BB_LegacyConnectionsWarning"),new B(34,1643,1960,1961,1962,0,qb.kj,0,"BB_TooManyLoadBlockingFloatingObjects"),new B(35,1652,1653,0,0,0,qb.kj,2,"BB_GroupedSlicers"),new B(36,313,314,0,0,0,qb.Vz,5,"BB_ThirdPartyAddinDisabled"),new B(37,1789,1790,0,0,1791,qb.kj,5,"BB_FinanceLinkedEntityDisclaimerBar"),new B(38,1818,1819,0,0,0,qb.Vz,5,"BB_WolframDeprecationAlertBar"),new B(39,0,0,0,0,0,qb.kj,0,"BB_WacGdprNotice"),new B(40,0,0,0,0,0,qb.kj,0,"BB_AutomaticSensitivityLabel"),new B(41,0,0,0,0,0,qb.kj,0,
"BB_RecommendedSensitivityLabel"),new B(42,0,0,0,0,0,qb.kj,0,"BB_MandatorySensitivityLabel"),new B(43,315,316,317,0,0,qb.kj,0,"BB_LocalStorageDisabled"),new B(44,632,633,0,0,0,qb.kj,0,"BB_AutoRefreshDisabled"),new B(45,1014,1012,1016,1314,0,qb.kj,4,"BB_CorruptedFileRepaired"),new B(46,1015,1013,1016,1314,0,qb.kj,5,"CorruptedOdsFileRepaired"),new B(47,273,274,275,0,0,qb.Vz,5,"BB_MinorVersionLimitReached"),new B(48,304,305,0,0,0,qb.Vz,5,"BB_SensitivityApplicationGenericError"),new B(49,306,308,0,0,
0,qb.Vz,5,"BB_SensitivityApplicationTooLargeFileError"),new B(50,307,308,0,0,0,qb.Vz,5,"BB_SensitivityApplicationLabelNotSupportedError"),new B(51,309,310,0,0,0,qb.Vz,5,"BB_SensitivityApplicationLabelDisabledError"),new B(52,311,312,0,0,0,qb.Vz,5,"BB_SensitivityApplicationMandatoryConflictError"),new B(53,0,0,0,0,0,qb.Vz,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new B(54,0,0,0,0,0,qb.Vz,5,"BB_SensitivityApplicationSetLabelError"),new B(55,2119,2120,2121,2124,0,qb.kj,5,"BB_ExternalWorkbookLinksPromptEnableContent",
"Warning_MessageBar_16"),new B(56,297,298,0,0,0,qb.kj,0,"BB_NetworkDown"),new B(57,318,319,320,0,0,qb.kj,2,"BB_DefaultToViewDueToCogs"),new B(58,1815,1816,1817,0,0,qb.kj,1,"BB_RefreshLinkedEntityErrorBar"),new B(59,1792,1793,1794,1795,0,qb.kj,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new D(60,250,0,0,0,qb.kj,5,"BB_CanvasHealth"),new B(61,1017,1018,1314,0,1019,qb.kj,5,"BB_MismatchedFileFormatConverted"),new B(62,2238,0,2240,0,0,qb.kj,5,"BB_OptimizeWorkbook"),new B(63,321,322,0,0,323,qb.kj,0,"BB_NovModePostDepreciation"),
new B(64,0,0,0,0,0,qb.kj,0,"BB_OfficeScriptsRunning"),new B(65,2214,2215,0,0,2217,qb.kj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new B(66,324,325,0,0,326,qb.kj,5,"BB_ReadOnlyPivotTable"),new B(67,2214,2216,0,0,2217,qb.kj,0,"BB_PowerQueryRefreshHostNotSupported"),new B(68,1057,k.a.coc?1059:1058,1056,0,0,qb.kj,4,"BB_RefreshPageAfterEnablingTheExtension"),new B(69,0,0,0,0,0,qb.kj,0,"BB_MsFormsDataSyncStatus"),new B(70,0,0,0,0,0,qb.Vz,5,"BB_DataCleansingSuggestions")])}}qb.Yka=mb.a.vIh;qb.Vz=mb.a.xIh;
qb.kj=mb.a.wIh;qb.QFe=null;Object(u.a)(qb,"BusinessBarControl",v.a,[29])},1203:function(u,C,a){u={};a.r(u);a.d(u,"CalcManager",function(){return Za});var c=a(0),b=a(15),f=a(229),e=a(119),d=a(9),h=a(115);a(172);var l=a(199),k=a(126),n=a(190),v=a(100),x=a(73);class w{}w.local="Local";w.S5j="Thread";Object(c.a)(w,"RecalcServiceCreateMode",null,[]);var r=a(187);class t{constructor(V){this.xce=null;this.init(V)}get Zba(){return this.xce}init(V){this.xce=new n.a;if(void 0!==V&&null!==V&&void 0!==V.HeadersList&&
null!==V.HeadersList&&0<V.HeadersList.length)for(const ia of V.HeadersList)this.Zba.ia(ia.Index,ia.Name)}}Object(c.a)(t,"ColHeadersListData",null,[]);var A=a(1),y=a(30),z=a(107),E=a(23),G=a(20),F=a(177);class O{constructor(V,ia){this.uGe=V;this.sheetName=ia;this.LQb=!1}}Object(c.a)(O,"CalcBlockInformation",null,[]);class M{constructor(V,ia,X,la,sa){this.type=V;this.fullName=ia;this.range=X;this.sheetId=la;this.attributes=sa;this.$F=null}}Object(c.a)(M,"CalcNamedObject",null,[]);class P{get Xk(){return this.cre}constructor(V){this.bvg=
V;this.cre=[];this.t6d=[];this.e3a={};this.BZd=new Map}Heg(V,ia){this.cre[V]=ia;this.bvg&&ia.W9&&this.BZd.set(ia.W9.sheetName,V)}getSheetIndex(V){if(this.bvg){if(this.BZd.has(V))return this.BZd.get(V)}else for(let ia=1;ia<this.Xk.length;ia++)if(E.a.equals(this.Xk[ia].W9.sheetName,V,!1))return ia;return-1}}Object(c.a)(P,"GridCache",null,[]);var B=a(712),D=a(563);class I{constructor(V){this.W9=V;this.n8=new B.a(D.a.Ah());this.ctc=!1}}Object(c.a)(I,"SheetInformation",null,[]);var S=a(984),J;(function(V){V[V.initialization=
0]="initialization";V[V.contentReady=1]="contentReady";V[V.cellEdit=2]="cellEdit"})(J||(J={}));Object(c.b)("UpdateDataTrigger",J);class L{constructor(V){this.hQd=null;this.FCd=this.gQd=this.uKd=!1;this.cOd=0;this.VNd=this.XNd=this.YNd=this.WNd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.qq=this.errorTypeNames=null;this.Ft=this.currentStateId=-1;this.yka="";this.xca=null;this.getNameLoc=(ia,X)=>this.Qnc()?this.If.ma(this.currentStateId).Xk[0].n8.Fb(X)?
(ia=excelOnlineCalc.location.nameLoc(ia,X),excelOnlineCalc.util.success(ia)):excelOnlineCalc.util.success(null):(ia=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ia));this.getContainingTable=ia=>{if(!this.Qnc())return ia=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ia);const X=ia.range.col,la=ia.range.row;var sa=this.If.ma(this.currentStateId).Xk[0].n8,Va=null;for(let nb of sa)if(sa=nb.value,2===sa.type&&E.a.equals(ia.sheet.index.toString(),sa.sheetId,!0)){const ha=
sa.range;X>=ha.left-1&&X<=ha.right-1&&la<=ha.bottom-1&&la>=ha.top-1&&(Va=excelOnlineCalc.location.nameScope(this.documentLoc,sa.sheetId),Va=excelOnlineCalc.location.nameLoc(Va,sa.fullName))}return Va?excelOnlineCalc.util.success(Va):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ia,X)=>{if(!this.Qnc()){var la=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(la)}la=ia.name;var sa=this.If.ma(this.currentStateId).Xk[0].n8;if(sa.Fb(la)){sa=sa.ma(la);const nb=sa.range;
if(2!==sa.type)return excelOnlineCalc.util.failure(this.$ad(5));const ha=sa.$F?sa.$F.Zba:null;if(!ha)return excelOnlineCalc.util.success(null);for(var Va of ha)if(E.a.equals(Va.value,X,!0))return ia=excelOnlineCalc.location.documentLoc(ia.scope.document.path,ia.scope.document.name),ia=excelOnlineCalc.location.sheetIndex(ia,sa.sheetId),Va=excelOnlineCalc.location.gridRange(nb.top-1,Va.key,nb.bottom-nb.top+1,1),Va=excelOnlineCalc.location.sheetGridRange(ia,Va),la=excelOnlineCalc.location.structRefColumnLoc(la,
Va,!!(sa.attributes&16),!!(sa.attributes&8)),excelOnlineCalc.util.success(la);return nb.right-nb.left+1!==ha.count?(la=excelOnlineCalc.util.unavailable([17,ia,X]),excelOnlineCalc.util.failure(la)):excelOnlineCalc.util.failure(this.$ad(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ia,X)=>{if(!this.Qnc())return X=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(X);var la=this.If.ma(this.currentStateId).Xk[0].n8;if(la.Fb(ia.name)){var sa=la.ma(ia.name);
if(2!==sa.type)return excelOnlineCalc.util.failure(this.$ad(5));la=!!(sa.attributes&16);const Va=!!(sa.attributes&8),nb=la?1:0,ha=Va?1:0;ia=excelOnlineCalc.location.documentLoc(ia.scope.document.path,ia.scope.document.name);ia=excelOnlineCalc.location.sheetIndex(ia,sa.sheetId);sa=sa.range;let jb={};if(1===X)jb=excelOnlineCalc.location.gridRange(sa.top-nb-1,sa.left-1,sa.bottom+ha-sa.top+nb+1,sa.right-sa.left+1);else if(2===X)jb=excelOnlineCalc.location.gridRange(sa.top-1,sa.left-1,sa.bottom-sa.top+
1,sa.right-sa.left+1);else if(3===X)if(la)jb=excelOnlineCalc.location.gridRange(sa.top-2,sa.left-1,1,sa.right-sa.left+1);else return excelOnlineCalc.util.success(null);else if(4===X)if(Va)jb=excelOnlineCalc.location.gridRange(sa.bottom,sa.left-1,1,sa.right-sa.left+1);else return excelOnlineCalc.util.success(null);X=excelOnlineCalc.location.sheetGridRange(ia,jb);return excelOnlineCalc.util.success(X)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ia,X)=>{if((E.a.equals(ia,this.documentLoc.path,
!0)||!ia)&&E.a.equals(X,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);ia=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ia,X)]);return excelOnlineCalc.util.failure(ia)};this.getSheetIndex=(ia,X)=>{if(!this.If.Fb(this.currentStateId)||!this.If.ma(this.currentStateId).Xk)return X=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(X);ia=this.If.ma(this.currentStateId).Xk;for(let la=1;la<ia.length;la++)if(E.a.equals(ia[la].W9.sheetName,
X,!0))return excelOnlineCalc.util.success(ia[la].W9.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(ia,X)=>{if(!this.If.Fb(this.currentStateId)||!this.If.ma(this.currentStateId).Xk)return X=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(X);ia=this.If.ma(this.currentStateId).Xk;for(let la=1;la<ia.length;la++)if(E.a.equals(ia[la].W9.sheetId,X,!0))return excelOnlineCalc.util.success(ia[la].W9.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=
()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.NOf=()=>{this.setNumberFormats()};this.Td=()=>{b.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.If=new n.a;this.currentStateId=this.Ft=-1;this.yka="";this.M4a=null;this.gQd=!1;this.qq&&this.clearCache()};this.Fd=V;
this.If=new n.a;this.M4a=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Fd.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.sra();this.Zwd=y.a.Zwd();this.G7=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1);this.EEi=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NoCompareCalcModelExpFF1",!1);this.FEi=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NoCompareCalcModelExpFF2",!1);this.Kwd=A.EwaSettings.isChangeGateEnabled("OfficeVSO:7717008_CalcBlocksExtendedTelemetry");
this.JBi=A.EwaSettings.isChangeGateEnabled("OfficeVSO:7737506_fixCalcUsedRangeForFreezePanes")}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.wSd(this.NOf);this.Fd&&this.Fd.Rm(this.Td);this.close()}IUb(V){if(!this.qq)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Fd.da.Ba(268),!this.instantaneousSupportInformationManager))return b.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),
!1;2!==V&&(this.currentStateId=this.Fd.ea.PQa,this.currentStateId===d.a.Oe&&(this.currentStateId=this.Fd.ea.We));if(1===V&&this.currentStateId<this.Ft)return b.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Ft} - ignoring update`),!1;this.wMj();0!==V&&this.gQd||(this.dRj(),this.cOj(),this.SOj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.tye(this.NOf),this.Fd.Ql(this.Td),this.gQd=!0);this.Hrj();
let ia=!1;0===V&&(ia=this.Tti());if(0!==V||ia)this.mQj()?(this.QQj(V),this.PQj(),this.Ft=this.currentStateId,this.Xdh()):b.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==V&&this.resumeRecalc();return!0}evalFormula(V,ia,X,la){if(!this.qq)return b.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ia=excelOnlineCalc.calc.sheetCellLocation(null!==X&&void 0!==
X?X:x.d(this.Fd.ua.na),ia.top-1,ia.left-1);V=this.qq.evalFormula(this.Fd.ea.We,V,ia,la);this.resumeRecalc();return V}A$g(V,ia,X,la=null){const sa=x.d(this.Fd.ua.na);let Va=V.cell.TI-1,nb=V.cell.RI-1;var ha=Va,jb=nb;let Fb=null;la&&(Fb=excelOnlineCalc.calc.cellLocation(Va,nb),Va=la.top-1,nb=la.left-1,ha=la.bottom-1,jb=la.right-1);X=this.rKc(V,X,"SetCell");0>X||(jb=L.z5("CalculateFormula.cell",sa,Va,nb,ha,jb),ha=[],la=this.Xic(sa),ia=excelOnlineCalc.calc.inferredRangeFormulaEdit(jb,ia,Fb,la),ha.push(ia),
V=(ia=this.gqd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",sa,Va,nb,E.a.vAe(V.cell.text),X,ia.top-1,ia.left-1,ia.bottom-1,ia.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",sa,Va,nb,E.a.vAe(V.cell.text),X,"","","",""),b.ULS.sendTraceTag(537170180,0,50,V),this.qq.editRangeFormulas(X,ha),this.resumeRecalc())}B$g(V,ia){const X=
[];var la=x.d(this.Fd.ua.na),sa=this.Xic(la);ia=this.rKc(V[0].Bca,ia,"SetCellBatched");if(0>ia)return!1;for(var Va of V){var nb=Va.Bca.cell.TI-1,ha=Va.Bca.cell.RI-1;nb=L.z5("CalculateFormulaBatched.cell",la,nb,ha,nb,ha);nb=excelOnlineCalc.calc.inferredRangeFormulaEdit(nb,Va.editText,null,sa);X.push(nb)}sa=this.gqd();Va=V[0].Bca.cell.TI-1;nb=V[0].Bca.cell.RI-1;ha=V[V.length-1].Bca.cell.TI-1;V=V[V.length-1].Bca.cell.RI-1;la=sa?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",
la,Va,nb,ha,V,ia,sa.top-1,sa.left-1,sa.bottom-1,sa.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",la,Va,nb,ha,V,ia,"","","","");b.ULS.sendTraceTag(508932947,0,50,la);this.qq.editRangeFormulas(ia,X);this.resumeRecalc();return!0}Y5a(V,ia,X,la,sa){if(!this.qq)return b.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");
if(!X||!ia)return b.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!X}, outputColumnRange null: ${!ia}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");b.ULS.shipAssertTag(537170178,0,X.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");const Va=x.d(this.Fd.ua.na),nb=this.Xic(Va);let ha=null;if(V){ha=[];for(const Rb of V)if(Rb.column!==X.left){V=Rb.row-1;var jb=Rb.column-1;V=
L.z5("EvalFormulaRangeOnClone.cell",Va,V,jb,V,jb);jb=A.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?R(Rb.Mp,Rb.formulaBarText,Rb.li):excelOnlineCalc.calc.valueCellData(Rb.text,Rb.text,Rb.li,null);ha.push(excelOnlineCalc.calc.rangeWrite(V,jb))}}X=excelOnlineCalc.calc.cellLocation(X.top-1,X.left-1);ia=L.z5("EvalFormulaRangeOnClone.outputColumnRange",Va,ia.top-1,ia.left-1,ia.bottom-1,ia.right-1);let Fb;sa?this.G7&&(la=[excelOnlineCalc.calc.inferredRangeFormulaEdit(ia,la,
X,nb)],Fb=this.qq.evalOnClonedModel(ha,la,sa)):(sa=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ia,la,X,nb)],Fb=this.qq.evalOnClonedModel(ha,sa));this.resumeRecalc();return Fb}EQe(V){let ia=null;try{if(V)if(this.yka=G.h(this.Fd).Ca.Gxa(V),this.currentStateId=V.vWa,this.currentStateId<this.Ft||this.currentStateId===d.a.Oe)b.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.yka} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Ft}`);
else{if(this.Zti(),this.JBi&&1===V.vx.PaneType&&this.Ugk(V.na),!this.C5g())if(ia=this.Fd.nc.qd("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.yka} StateId:${this.currentStateId}`),this.M4a=this.$7a(V.na.sheetName))if(G.h(this.Fd).Ca.Sm.t5a(V.Md)){var X=V.eg;if(X){var la=X.getCalcBlockModel();if(la)if(this.u5g(la)){this.If.ma(this.currentStateId).e3a[this.yka]=new O(la,V.na.sheetName);var sa=V.De;sa?this.FTg(sa.NamedObjects):b.ULS.sendTraceTag(537170144,0,15,
"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else this.Kwd&&b.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else b.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else b.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.yka}`)}else this.Kwd&&
b.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const Va=!!(this.Fd.$d&32),nb=this.If.Fb(this.currentStateId)&&this.If.ma(this.currentStateId).Xk?this.If.ma(this.currentStateId).Xk.length:0;b.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${nb}, scratchPad:${Va}, sheetNameLength:${V.na.sheetName?V.na.sheetName.length:
-1} Hash:${V.na.hash}`)}}else b.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ia&&ia.stop()}}Kic(V){var ia;if(!this.If.Fb(this.currentStateId))return b.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const X=null===(ia=this.If.ma(this.currentStateId))||void 0===ia?void 0:ia.Xk;if(!X||!X[0])return null;ia=X[0].n8;if(!ia||!ia.Fb(V.name))return b.ULS.sendTraceTag(509646789,
0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==ia}`),null;V=ia.ma(V.name);if(!V||!V.$F)return null;ia=new l.a;for(let la of V.$F.Zba)ia.add(la.value);return ia}C$g(V,ia,X){var la=G.h(this.Fd),sa=la.jc(ia);sa=this.rKc(sa,null,"CopyPaste");X=this.rKc(la.jc(V),X,"CopyPaste");if(0>sa||0>X||sa!==X)b.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${X}, targetRevision:${sa}.`);
else{X=[];la=x.d(this.Fd.ua.na);var Va=this.Xic(la);V=L.z5("CalculateFormulaForCopyPaste.srcRange",la,V.top-1,V.left-1,V.bottom-1,V.right-1);ia=L.z5("CalculateFormulaForCopyPaste.targetRange",la,ia.top-1,ia.left-1,ia.bottom-1,ia.right-1);ia=excelOnlineCalc.calc.copyPasteRangePasteEdit(ia,V,Va);X.push(ia);ia=Va?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",la,sa,Va.row,Va.column,Va.lastRow,Va.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
la,sa,"","","","");b.ULS.sendTraceTag(537170142,0,50,ia);this.qq.editRangePaste(sa,X);this.resumeRecalc()}}Xic(V){const ia=this.gqd();let X=null;ia?X=L.z5("GetViewport.viewport",V,ia.top-1,ia.left-1,ia.bottom-1,ia.right-1):b.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return X}gqd(){const V=G.h(this.Fd);let ia=V.hk;if(G.h(this.Fd).Cb.jj){ia=V.og(1).hk;if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!ia)return b.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ia.pga(1,1);ia.pga(3,1)}return ia}rKc(V,ia,X){let la;if(!this.qq||!V)return b.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.qq}, modifiedCell is null:${!V}, operation:${X}`),-1;const sa=V.cell.TI-1,Va=V.cell.RI-1;if(V.cell.Mw){if(la=V.cell.Mw.Q6b,la===d.a.Oe)return b.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${V.cell.Mw.Md}, operation:${X}`),
-1}else return b.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${V.cell.TI},${V.cell.RI}), operation:${X}`),-1;if(la<this.Ft)return b.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${sa},${Va}) - blockRevision:${la} < lastUpdatedStateId:${this.Ft}, operation:${X}`),-1;if(la<this.currentStateId)return b.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${sa},${Va}) - blockRevision:${la} < currentStateId:${this.currentStateId}, operation:${X}`),
-1;ia&&!this.uKd&&(this.qq.setOnRecalcResults(ia),this.uKd=!0);return this.ock()&&!this.IUb(2)?(b.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${X}`),-1):la}getFormulaBarText(V,ia,X){return ia&&ia.startsWith("'")?ia:V.cell.formulaBarText||X.toString()}Bqh(V,ia,X){let la=null;A.EwaSettings.isChangeGateEnabled("OfficeVSO:7616924_fixSheetIdSentToCalcts")&&(this.M4a=this.$7a(X));if(this.fHe()&&this.If.ma(this.Ft).e3a){const ha=this.If.ma(this.Ft).e3a[V];
if(null===ha||void 0===ha?0:ha.LQb)la=ha.uGe}X=this.Qyi(la,ia,X);const {h_i:sa,numberOfNonEmptyCells:Va,f_i:nb}=this.uhh(la,ia,X);b.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${V} StateId:${this.currentStateId} number of formulas ${sa}, number of non-empty cells ${Va}, number of cells ${nb}`)}Qyi(V,ia,X){let la=!1;const sa=L.n8e(ia);if(V){const Va=L.n8e(V);E.a.equals(Va,sa,!1)&&(la=!0)}this.EEi&&(la=!1);la?this.iUg(V,this.Ft,X):this.kUg(ia,
X);return la}fHe(){let V=!1;this.qq&&-1!==this.Ft&&(V=this.qq.stateIdAvailable(this.Ft));return V&&this.If.Fb(this.Ft)&&this.Ft<this.currentStateId}uhh(V,ia,X){let la=0,sa=0,Va=0,nb,ha;for(ia.reset();nb=ia.getNextCell();)Va++,(nb.value||nb.formula)&&sa++,F.f(nb.formula)&&la++,(ha=X?V.getCell(nb.row,nb.col):null)?this.qhh(ia,nb,ha):this.jUg(ia,nb);if(X)for(V.reset();ha=V.getNextCell();)(nb=ia.getCell(ha.row,ha.col))||this.Fwe(V,ha);return{h_i:la,numberOfNonEmptyCells:sa,f_i:Va}}SOj(){this.qq.setOnUpdateRequest(()=>
{})}ROj(){this.qq.setOnUnresponsive((V,ia,X,la)=>{this.kdj(V,ia,X,la)})}kdj(V,ia,X,la){b.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${V}, waitTime:${ia}, timeoutCount:${X}, hasBeenClosed:${la}.`);la&&(this.iDj(),this.sra())}iDj(){this.Td(null,null);this.FCd=this.uKd=!1;this.cOd=0;this.VNd=this.XNd=this.YNd=this.WNd=-1}close(){this.qq.close()}clearCache(){this.qq.clearCache()}resumeRecalc(){this.qq.resumeRecalc()}cOj(){this.qq.setA1ReferenceStyle(!0)}Hrj(){if(this.instantaneousSupportInformationManager){var V=
this.instantaneousSupportInformationManager.ewi;const X=this.instantaneousSupportInformationManager.hwi,la=this.instantaneousSupportInformationManager.gwi,sa=this.instantaneousSupportInformationManager.fwi;var ia=!1;V!==this.WNd&&(ia=!0,this.WNd=V);X!==this.YNd&&(ia=!0,this.YNd=X);la!==this.XNd&&(ia=!0,this.XNd=la);sa!==this.VNd&&(ia=!0,this.VNd=sa);const Va=[];A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ia=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),Va.push(ia),ia=!0);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ia=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Va.push(ia),ia=!0);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ia=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Va.push(ia),ia=!0);ia&&(V=excelOnlineCalc.calc.recalcServiceConfig(null,V,null,X,null,null,null,la,Va,sa),this.qq.reconfigure(V))}}QQj(V){let ia=
null;if(this.If.Fb(this.currentStateId))try{this.xca=[],ia=this.Fd.nc.qd("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${J[V]}`),h.a.forEach(this.If.ma(this.currentStateId).e3a,(X,la)=>{la.LQb||(this.Bqh(X,la.uGe,la.sheetName),la.LQb=!0)},null),this.qq.updateRanges(this.currentStateId,this.xca)}finally{ia&&ia.stop()}else b.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}PQj(){const V=
[],ia=this.fHe();var X=ia&&this.If.ma(this.Ft).Xk&&this.If.ma(this.Ft).Xk[0]&&this.If.ma(this.Ft).Xk[0].ctc?this.If.ma(this.Ft).Xk[0].n8:null;this.hMe(X,this.If.ma(this.currentStateId).Xk[0].n8,null,this.Ft,V);this.If.ma(this.currentStateId).Xk[0].ctc=!0;for(let la=1;la<this.If.ma(this.currentStateId).Xk.length;la++)X=-1,ia&&this.If.ma(this.Ft).Xk&&(X=this.ipd(this.If.ma(this.currentStateId).Xk[la].W9.sheetName,this.Ft)),X=-1!==X&&this.If.ma(this.Ft).Xk[X].ctc?this.If.ma(this.Ft).Xk[X].n8:null,this.hMe(X,
this.If.ma(this.currentStateId).Xk[la].n8,this.If.ma(this.currentStateId).Xk[la].W9.sheetId,this.Ft,V),this.If.ma(this.currentStateId).Xk[la].ctc=!0;this.qq.updateNamedObjects(this.currentStateId,V)}hMe(V,ia,X,la,sa){if(void 0!==X&&null!==X){var Va=excelOnlineCalc.calc.undefinedNamesWrite(X);sa.push(Va)}if(V){var nb=!1;Va=[];var ha=[];if(ia)for(let Fb of ia){const Rb=Fb.value;if(V.Fb(Fb.key)){var jb=V.ma(Fb.key);L.yYi(jb,Rb)?nb=!0:(jb=excelOnlineCalc.calc.namedObject(Fb.key,null),Va.push(jb),L.F1c(Fb.key,
Rb,ha))}else L.F1c(Fb.key,Rb,ha)}for(let Fb of V)ia&&ia.Fb(Fb.key)||(V=excelOnlineCalc.calc.namedObject(Fb.key,null),Va.push(V));nb&&(ia=excelOnlineCalc.calc.namedObjectsPromote(X,la),sa.push(ia));0<Va.length&&(ia=excelOnlineCalc.calc.namedObjectsWrite(X,Va),sa.push(ia));0<ha.length&&(X=excelOnlineCalc.calc.namedObjectsWrite(X,ha),sa.push(X))}else if(ia){la=[];for(ha of ia)L.F1c(ha.key,ha.value,la);0<la.length&&(X=excelOnlineCalc.calc.namedObjectsWrite(X,la),sa.push(X))}}C5g(){const V=this.If.ma(this.currentStateId).e3a[this.yka];
return V?(this.Kwd?b.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.yka} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Ft}. sentToRecalcEngine: ${null===V||void 0===V?void 0:V.LQb}`):b.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.yka} StateId:${this.currentStateId} previously handled`),this.FEi?!1:!0):!1}u5g(V){return 1===V.getColumnNumbers().length&&V.getColumnNumbers()[0]===
L.hFd+1?!1:!0}Tti(){let V=!1;G.h(this.Fd).Ca.Izb(ia=>{ia.state&1&&this.Fd.ea.We===ia.Ke.Revision&&(this.EQe(ia),V=!0)});return V}wOe(V,ia){var X=V.getRowNumbers(),la=V.getColumnNumbers();V=X[0]-1;X=X[X.length-1]-1;const sa=la[0]-1;la=la[la.length-1]-1;ia=this.$7a(ia);if(!ia){const Va=this.If.Fb(this.currentStateId)&&this.If.ma(this.currentStateId).Xk?this.If.ma(this.currentStateId).Xk.length:0;b.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Va}`)}return L.z5("CreateBlockRangeLocation",
ia,V,sa,X,la)}iUg(V,ia,X){if(X=this.wOe(V,X)){var la=L.T$b(V.getRowNumbers());V=L.T$b(V.getColumnNumbers());ia=excelOnlineCalc.calc.rangePromote(X,ia,la,V);this.xca[this.xca.length]=ia}}kUg(V,ia){if(ia=this.wOe(V,ia)){var X=L.T$b(V.getRowNumbers());V=L.T$b(V.getColumnNumbers());V=excelOnlineCalc.calc.rangeWrite(ia,null,X,V);this.xca[this.xca.length]=V}}qhh(V,ia,X){let la=null,sa=0,Va=0;switch(ia.valueType){case 2:la=this.bqd(ia);var nb=this.bqd(X);nb=E.a.equals(nb,la,!1);break;case 1:null===ia.value&&
null===X.value?nb=!0:(sa=parseFloat(ia.value),nb=parseFloat(X.value)===sa);break;default:null===ia.value&&null===X.value?nb=!0:(Va=parseFloat(ia.value),nb=Va===parseFloat(X.value))}nb&&ia.valueType===X.valueType&&ia.ifmt===X.ifmt&&ia.formulaType===X.formulaType&&E.a.equals(X.formula,ia.formula,!1)||(void 0!==ia.formula&&null!==ia.formula||void 0!==ia.value&&null!==ia.value||void 0!==ia.text&&null!==ia.text||0!==ia.valueType?this.e4b(V,ia,la,sa,Va):this.Fwe(V,ia))}FTg(V){if(this.Fd.Zb&&this.Fd.Zb.items)for(let Va=
0;Va<this.Fd.Zb.count;Va++){var ia=this.Fd.Zb.items[Va];if(2!==ia.type&&3!==ia.type)continue;var X=0,la=ia.name,sa=la.lastIndexOf("!");if(0<sa){X=la.substr(0,sa);"'"===X.charAt(0)&&(X=X.substr(1,X.length-2));X=this.ipd(X,this.currentStateId);if(-1===X){la=this.If.Fb(this.currentStateId)&&this.If.ma(this.currentStateId).Xk?this.If.ma(this.currentStateId).Xk.length:0;b.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${la}`);continue}la=
la.substr(sa+1)}sa=this.If.ma(this.currentStateId).Xk[X].n8;let nb=ia.usedRange;2===ia.type&&(nb=r.a(ia));if(sa.Fb(la)){if(X=sa.ma(la),X.range=nb,X.attributes=ia.attributes,2===X.type)if(la=ia.WP,!X.$F)X.$F=new t(la);else if(la)for(const ha of la.HeadersList)X.$F.Zba.ia(ha.Index,ha.Name)}else if(X=this.$7a(ia.sheetName)){X=new M(ia.type,ia.name,nb,X,ia.attributes);if(2===X.type)if(ia.WP)X.$F=new t(ia.WP);else if(ia=L.ZSh(ia.name,V))X.$F=new t(ia.ColHeadersList);sa.ia(la,X)}else la=this.If.Fb(this.currentStateId)&&
this.If.ma(this.currentStateId).Xk?this.If.ma(this.currentStateId).Xk.length:0,b.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${la}`)}}e4b(V,ia,X,la,sa){var Va=V.getRowNumbers()[ia.row]-1;V=V.getColumnNumbers()[ia.col]-1;Va=L.z5("AddRangeUpdateCommand",this.M4a,Va,V,Va,V);V=null;let nb=ia.formula||ia.text;const ha=excelOnlineCalc.calc.blankValue;let jb=null;void 0!==ia.text&&null!==ia.text||void 0!==ia.value&&null!==ia.value||
(X="",jb="This cell contains blanks only",0===ia.formulaType&&(nb=""));switch(ia.valueType){case 2:null!==X&&(0===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData(nb,X,ia.ifmt,jb)),1===ia.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(nb,X,ia.ifmt,jb)),2===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",ha,0,"This cell is a part of an array")));break;case 1:isNaN(la)?b.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ia.row},${ia.col}) invalid numeric value`):
(0===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData(nb,la,ia.ifmt,null)),1===ia.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(nb,la,ia.ifmt,null)),2===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",ha,0,"This cell is a part of an array")));break;case 3:isNaN(sa)?b.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ia.row},${ia.col}) invalid boolean value`):(X=1===sa?!0:!1,0===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData(nb,X,ia.ifmt,
null)),1===ia.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(nb,X,ia.ifmt,null)),2===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",ha,0,"This cell is a part of an array")));break;case 4:isNaN(sa)?b.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ia.row},${ia.col}) invalid error value`):(X=excelOnlineCalc.calc.errorValue(sa),0===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData(nb,X,ia.ifmt,null)),1===ia.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(nb,
X,ia.ifmt,null)),2===ia.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",ha,0,"This cell is a part of an array")));break;default:V=excelOnlineCalc.calc.valueCellData("",ha,ia.ifmt,null)}V&&(ia=excelOnlineCalc.calc.rangeWrite(Va,V,null,null),this.xca[this.xca.length]=ia)}jUg(V,ia){switch(ia.valueType){case 2:this.e4b(V,ia,this.bqd(ia),null,0);break;case 1:this.e4b(V,ia,null,parseFloat(ia.value),0);break;default:this.e4b(V,ia,null,null,parseFloat(ia.value))}}Fwe(V,ia){var X=V.getRowNumbers()[ia.row]-
1;V=V.getColumnNumbers()[ia.col]-1;X=L.z5("AddRangeUpdateCommandEmptyCell",this.M4a,X,V,X,V);ia=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ia.ifmt,null);ia=excelOnlineCalc.calc.rangeWrite(X,ia,null,null);this.xca[this.xca.length]=ia}$7a(V){V=this.ipd(V,this.currentStateId);return 0<V?this.If.ma(this.currentStateId).Xk[V].W9.sheetId:null}ipd(V,ia){if(!this.If.Fb(ia))return b.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ia} does not exist in GridCache`),
-1;const X=this.If.ma(ia);return X.Xk?X.getSheetIndex(V):(b.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ia}`),-1)}mQj(){if(!this.If.Fb(this.currentStateId)||!this.If.ma(this.currentStateId).Xk.length)return b.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const V=[];for(let ia=1;ia<this.If.ma(this.currentStateId).Xk.length;ia++){const X=
this.If.ma(this.currentStateId).Xk[ia];X&&V.push(X.W9)}this.qq.updateSheetNames(this.currentStateId,V);this.qq.updateUnusedCells(this.currentStateId,this.If.ma(this.currentStateId).t6d);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var V=[];for(const ia of this.instantaneousSupportInformationManager.iBa){const X=excelOnlineCalc.calc.numberFormat(ia.IfmtIndex,ia.FormatString,ia.Builtin);V.push(X)}this.qq.setNumberFormats(V,!0)}}wMj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.uf){var V=this.Xti();if(!this.FCd||V)this.S$b(),this.instantaneousSupportInformationManager.uf.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.uf.TrueValueString),this.instantaneousSupportInformationManager.uf.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.uf.FalseValueString),V=S.CalcHelper.sPe(this.instantaneousSupportInformationManager,V),this.qq.setLocale(V),this.FCd=!0}}dRj(){var V=null;if(void 0!==
this.Fd.workbookContext.TimeZoneInformation&&null!==this.Fd.workbookContext.TimeZoneInformation){V=null;this.Fd.workbookContext.TimeZoneInformation.StandardDate.Month&&(V=excelOnlineCalc.date.dateTime(this.Fd.workbookContext.TimeZoneInformation.StandardDate.Year,this.Fd.workbookContext.TimeZoneInformation.StandardDate.Month,this.Fd.workbookContext.TimeZoneInformation.StandardDate.Day,this.Fd.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Fd.workbookContext.TimeZoneInformation.StandardDate.Minute,
this.Fd.workbookContext.TimeZoneInformation.StandardDate.Second,this.Fd.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Fd.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ia=null;this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ia=excelOnlineCalc.date.dateTime(this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Day,
this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Fd.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Fd.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));V=excelOnlineCalc.date.tzData(this.Fd.workbookContext.TimeZoneInformation.Bias,V,this.Fd.workbookContext.TimeZoneInformation.StandardBias,ia,this.Fd.workbookContext.TimeZoneInformation.DaylightBias)}else b.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");V=excelOnlineCalc.calc.workbookProps(this.Fd.workbookContext.F1904,this.Fd.workbookContext.FDateCompatibility,V);this.qq.setWorkbookProps(V)}sra(){const V=A.EwaSettings.ya(570)?w.local:w.S5j,[ia,X]=y.a.rS(this.Fd)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.hQd=v.d(excelOnlineCalc.calc.createRecalcService(V,ia,X));this.hQd.continueWith(la=>
{la.exception?b.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${la.exception.toString()}`):(b.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.qq=this.hQd.result)?this.IUb(0)?this.ROj():b.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):b.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Xti(){const V=
this.instantaneousSupportInformationManager.Qla;if(!V||this.cOd===V.length)return null;this.cOd=V.length;return S.CalcHelper.dPe(V)}S$b(){this.errorTypeNames=S.CalcHelper.S$b()}Zti(){if(!(this.If.Fb(this.currentStateId)&&0<this.If.ma(this.currentStateId).Xk.length)){this.If.ia(this.currentStateId,new P(this.Zwd));this.If.ma(this.currentStateId).Heg(0,new I(null));var V=this.Fd.ua;for(let la=0;la<V.count;la++){var ia=Object(k.a)(z.a,V.getItem(la));if(ia){void 0!==ia.sheetId&&null!==ia.sheetId&&void 0!==
ia.name&&null!==ia.name&&ia.sheetId.length&&ia.sheetName.length||b.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${la} Id:${ia.sheetId} Hash:${ia.hash} NameLength:${ia.name?ia.name.length:-1}`);var X=void 0;X=excelOnlineCalc.calc.sheetName(ia.sheetId,ia.name);this.If.ma(this.currentStateId).Heg(la+1,new I(X));X=ia.usedRange.fQ();X=excelOnlineCalc.calc.rangeLocation(0,0,X.LastRow,X.LastColumn);ia=excelOnlineCalc.calc.unusedCellsUpdate(ia.sheetId,
X);this.If.ma(this.currentStateId).t6d.push(ia)}else b.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${la}`)}}}Ugk(V){if(V instanceof z.a){var ia=V.usedRange.fQ();ia=excelOnlineCalc.calc.rangeLocation(0,0,ia.LastRow,ia.LastColumn);ia=excelOnlineCalc.calc.unusedCellsUpdate(V.sheetId,ia);this.If.ma(this.currentStateId).t6d[V.index]=ia}}Xdh(){for(let V of this.If)V.key<this.Ft&&this.If.remove(V.key)}bqd(V){V=
V.value||V.text;if(void 0===V||null===V)V="";return V}ock(){if(!this.If.Fb(this.currentStateId))return!1;let V=!1;h.a.forEach(this.If.ma(this.currentStateId).e3a,(ia,X)=>{X.LQb||(V=!0)},null);return V}$ad(V){const ia={};ia.reason=V;ia.kind=1;return ia}Qnc(){return this.If.Fb(this.currentStateId)&&this.If.ma(this.currentStateId).Xk&&this.If.ma(this.currentStateId).Xk[0]&&this.If.ma(this.currentStateId).Xk[0].n8?!0:!1}static Gmh(V){const ia=[];if(null===V||void 0===V?0:V.Zba)for(let X of V.Zba)V=excelOnlineCalc.calc.columnData(X.key,
X.value),ia.push(V);return ia}static yYi(V,ia){if(V.type!==ia.type||V.attributes!==ia.attributes||!E.a.equals(V.fullName,ia.fullName,!1)||!V.range.equals(ia.range))return!1;if(!V.$F&&!ia.$F)return!0;if(!V.$F||!ia.$F||V.$F.Zba.count!==ia.$F.Zba.count)return!1;for(let X of V.$F.Zba){let la;if(!(X.value&&({value:la}=ia.$F.Zba.nd(X.key)).returnValue&&la&&E.a.equals(X.value,la,!1)))return!1}return!0}static F1c(V,ia,X){var la=L.z5("NamedObject",ia.sheetId,ia.range.top-1,ia.range.left-1,ia.range.bottom-
1,ia.range.right-1);if(2===ia.type){const sa=!!(ia.attributes&16),Va=!!(ia.attributes&8);ia=L.Gmh(ia.$F);la=excelOnlineCalc.calc.namedTableData(la,sa,Va,ia);V=excelOnlineCalc.calc.namedObject(V,la)}else la=excelOnlineCalc.calc.namedRangeData(la),V=excelOnlineCalc.calc.namedObject(V,la);X.push(V)}static n8e(V){const ia=Sys.Serialization.JavaScriptSerializer.serialize(V.getRowNumbers());V=Sys.Serialization.JavaScriptSerializer.serialize(V.getColumnNumbers());return ia+V}static T$b(V){let ia=null;if(1<
V.length)for(let X=1;X<V.length;X++){let la=0;for(;V[X-1]+1+la<V[X];)ia=ia||[],ia.push(V[X-1]+la),la++}return ia}static ZSh(V,ia){if(!ia)return null;for(let X=0,la=ia.length;X<la;++X)if(E.a.equals(V,ia[X].Name,!1))return ia[X];return null}static z5(V,ia,X,la,sa,Va){const nb=(ha,jb,Fb,Rb)=>{(0>Fb||Fb>=Rb)&&b.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${ha} invalid ${jb}:${Fb}`)};void 0!==ia&&null!==ia||b.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${V} sheetId is null`);
nb(V,"top",X,L.KDf);nb(V,"left",la,L.hFd);nb(V,"bottom",sa,L.KDf);nb(V,"right",Va,L.hFd);return excelOnlineCalc.calc.sheetRangeLocation(ia,X,la,sa,Va)}}L.KDf=1048576;L.hFd=16384;Object(c.a)(L,"CalcAsyncEngine",null,[2]);const R=(V,ia,X)=>{switch(V.type){case 2:return excelOnlineCalc.calc.valueCellData(ia,V.value,X,null);case 1:return excelOnlineCalc.calc.valueCellData(ia,parseFloat(V.value),X,null);case 3:return excelOnlineCalc.calc.valueCellData(ia,1===parseFloat(V.value),X,null);case 4:return excelOnlineCalc.calc.valueCellData(ia,
excelOnlineCalc.calc.errorValue(parseFloat(V.value)),X,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,X,null)}};class Y{constructor(){this.EL=this.FL=this.DG=this.EG=this.W0=!1}}Object(c.a)(Y,"AbsoluteRelativeReferenceInfo",null,[]);var Q=a(25);class W{}W.FWf="#";Object(c.a)(W,"Operators",null,[]);var Ga=a(1097);class pa{}pa.sheet="Sheet";pa.sheetRange="SheetRange";pa.document="Document";pa.Aqi="Ident";Object(c.a)(pa,"TraverseFormulaQualifierTypes",null,
[]);var aa=a(1098),Z=a(948),fa=a(839),ya=a(47),Aa=a(62),ja=a(77),za=a(296),ra=a(42);class fb extends Sys.EventArgs{constructor(V){super();this.el=V}}Object(c.a)(fb,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var Ua=a(149),Ca=a(36),Ia=a(278);class oa{constructor(V,ia){this.$Kf=(X,la)=>{X=this.gridView.ga.pa.activeCell;const sa=this.gridView.jc(X);null!=sa&&this.vkj(X,la.text,sa.cell.li,sa.cell.Mw.Q6b,this.gridView.$.activeItemName)};this.KBa=()=>{this.kAa=Object(za.a)({message:"PrefetchNotStarted"})};
this.calcManager=V;this.gridView=ia;this.kAa=Object(za.a)({message:"Ctor"});V=A.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.vkj=Ia.a((X,la,sa,Va,nb)=>this.prefetch({text:la,range:X,ifmt:sa,stateId:Va,sheetName:nb}),V);this.gridView.wc.ao(this.KBa);this.gridView.Rh.Qxe(this.$Kf)}dispose(){this.gridView.Rh.s4f(this.$Kf);this.gridView.wc.Un(this.KBa);this.UJe()}w8e(V){if(Object(za.b)(this.kAa))return Object(za.a)(this.kAa.reason.message);if(oa.l2g(V,
this.kAa.value.key)){for(const ia of this.kAa.value.results.results)if(Object(za.c)(ia)&&oa.vGi(V,ia))return ia;return Object(za.a)("RangeNotFoundInPrefetchResult")}return Object(za.a)("ResultUnavailable")}UJe(){this.kAa=Object(za.a)({message:"PrefetchResultCleared"})}prefetch(V){this.kAa=Object(za.a)({message:"EvalInProgress",key:V});this.calcManager.Y5a([],V.range,V.range,V.text,!0).then(ia=>{this.kAa=Object(za.d)({key:V,results:ia})}).catch(ia=>{b.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${ia}`)})}static l2g(V,
ia){return V.text===ia.text&&V.range.toString()===ia.range.toString()&&V.ifmt===ia.ifmt&&V.stateId===ia.stateId&&V.sheetName===ia.sheetName}static vGi(V,ia){return V.range.top-1===ia.value.cell.row&&V.range.left-1===ia.value.cell.col}}Object(c.a)(oa,"SetCellEstimationPrefetcher",null,[591,2]);var Da=a(92),bb;let Za=bb=class extends ra.a{constructor(V){super();this.kt=null;this.Vwg=!1;this.CUd=this.instantaneousSupportInformationManager=this.iMb=null;this.QHd=new Map;this.wme=null;this.Xuc=ia=>{b.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");ia.wSd(this.Xuc);ia.Qla.length?this.Buc(ia,Sys.EventArgs.Empty):(b.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ia.Zxe(this.Buc))};this.Buc=ia=>{b.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ia.jSd(this.Buc);this.V$j(ia)};this.onContentReady=()=>{this.kt&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Klc||
Aa.Task.delay(0).continueWith(()=>{this.kt.IUb(1)},0,null,ja.a.current))};this.IIf=(ia,X)=>{this.kt&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Klc||this.kt.EQe(X.Jd.block))};b.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.vmc=!1;this.Jb=V;this.iu=G.h(V);this.MNc=null;this.gridView.jt(this.onContentReady);this.gridView.Ca.f2c(this.IIf);this.$.da.Gb(268,ia=>{ia.uf?(b.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
this.Xuc(ia,Sys.EventArgs.Empty)):(b.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ia.tye(this.Xuc))});if(this.G7=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1))this.Pqe=new oa(this,this.iu)}yWg(V){this.addHandler(bb.WVe,V)}uGf(V){this.raiseEvent(bb.WVe,new fb(V))}get gDc(){return this.Pqe}get d_(){return this.MNc}get gridView(){return this.iu}get $(){return this.Jb}get TG(){return this.wme}get localeInfo(){return this.d_?
this.d_.config.localeInfo:null}get config(){return this.d_.config}dispose(){b.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Gb(268,V=>{V.wSd(this.Xuc);V.jSd(this.Buc)});this.gridView&&(this.gridView.Rv(this.onContentReady),this.gridView.Ca&&this.gridView.Ca.Z3f(this.IIf),this.iu=null);this.MNc=null;this.vmc=!1;this.G7&&(Da.a.Ka(this.gDc),this.Pqe=null)}D$g(V,ia,X,la=null){this.kt&&this.kt.A$g(V,ia,X,la)}E$g(V,ia){return this.kt?this.kt.B$g(V,ia):!1}evalFormula(V,ia,X,la){return this.kt?
this.kt.evalFormula(V,ia,X,la):Promise.reject("calc engine not initialized")}Y5a(V,ia,X,la,sa){return this.kt?this.kt.Y5a(V,ia,X,la,sa):Promise.reject("CalcEngine is null")}Kic(V){if(!V)return b.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.kt)return null;b.ULS.shipAssertTag(537170059,0,2===V.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.kt.Kic(V)}N_g(V,ia){if(!ia||2!==V.type)return!1;V=r.a(V);return V.right-V.left+1===
ia.count}J2e(V,ia){if(!this.iMb)return this.Vwg||b.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var X=this.awb(Q.Range.gd(1,1));X=this.iMb.parseFormula(excelOnlineCalc.parse.parseLocals(1,X.range),V);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(X))return b.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let la;const sa=null!==ia&&void 0!==ia?ia:this.gridView.ga.pa.activeCell,Va=
excelOnlineCalc.location.gridCell(sa.top-1,sa.left-1),nb=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ha=excelOnlineCalc.location.sheetIndex(nb,this.$.ua.na.sheetId),jb=this.Yqh(Va,ha);this.CUd||(this.CUd=excelOnlineCalc.util.createResolver(this.Xqh()));la=excelOnlineCalc.parse.parseResultHelper.extractReferences(X,this.d_.config.localeInfo,A.EwaSettings.ya(512),jb,this.CUd);A.EwaSettings.ya(101)&&this.Ofk(la,V);return la}catch(la){return b.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${la.message}`),null}}extractLetVariables(V,ia){if(!this.iMb)return this.Vwg||b.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const X=this.awb(Q.Range.gd(1,1));V=this.iMb.parseFormula(excelOnlineCalc.parse.parseLocals(1,X.range),V);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(V))return b.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(V,
ia,this.d_.config.localeInfo)}catch(la){return b.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${la.message}`),null}}extractReferences(V,ia,X,la,sa){if(!ia)return b.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!X)return b.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;sa=this.J2e(V,sa);if(!sa)return b.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),
null;try{return this.Sph(sa,ia,X,V,la)}catch(Va){return b.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${Va.message}`),null}}awb(V,ia=!0){return V&&this.d_?this.d_.urh(this.d_.fth(),V.top-1,V.left-1,ia):null}Wqf(V,ia){V=this.SNa(V);if(!Object(za.c)(V))return null;ia=this.TG.parseEdit(ia,V.value);return excelOnlineCalc.util.isSuccess(ia)?ia.value.kind===Z.a.formula:null}GIi(V){V=this.SNa(V);return Object(za.c)(V)?"Text"===V.value.valueType:null}Hpf(V){V=this.SNa(V);return Object(za.c)(V)?
"Date"===V.value.valueType&&!V.value.hasTime:null}SNa(V){if(null==this.TG)return Object(za.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(za.a)("Instantaneous manager is null");if(this.QHd.has(V))return Object(za.d)(this.QHd.get(V));if("number"===typeof V){var ia=this.cod(V);if(null==ia)return Object(za.a)(`Invalid ifmt=${V}`);var X=ia.FormatString;ia=ia.Builtin}else X=V,ia=!1;X=this.TG.createFormat(X,ia);return excelOnlineCalc.util.isSuccess(X)?
(this.QHd.set(V,X.value),Object(za.d)(X.value)):Object(za.a)("Could not create number format")}getWorksheetFuncId(V){return this.localeInfo.getWorksheetFuncId(V)}Sph(V,ia,X,la,sa){const Va={Items:[]};for(let Fb=0;Fb<V.length;Fb++){var nb=V[Fb];const Rb={};Rb.Start=nb.span.start;Rb.End=nb.span.end;if(sa||nb.kind!==Ga.a.func)if(sa||nb.kind!==Ga.a.tNi){if(!this.Rzh(nb,ia,X))continue;var ha=new Y;const mb=this.aci(nb,ia,ha,la);if(A.EwaSettings.ya(512)){var jb=this.T8h(nb);const sb=this.S8h(nb);if(mb||
sb&&0<=jb){let Ya={};Ya.Span=Rb;Ya.LetNumber=jb;Ya.LetName=sb;Ya.Range=mb;Ya.IsRangeRef=ha.W0;Ya.IsAbsoluteFirstRow=ha.EG;Ya.IsAbsoluteFirstColumn=ha.DG;Ya.IsAbsoluteSecondRow=ha.FL;Ya.IsAbsoluteSecondColumn=ha.EL;Ya.IsStructRef=nb.kind===Ga.a.x2d;Va.Items.push(Ya)}}else mb&&(jb={},jb.Span=Rb,jb.Range=mb,jb.IsRangeRef=ha.W0,jb.IsAbsoluteFirstRow=ha.EG,jb.IsAbsoluteFirstColumn=ha.DG,jb.IsAbsoluteSecondRow=ha.FL,jb.IsAbsoluteSecondColumn=ha.EL,jb.IsStructRef=nb.kind===Ga.a.x2d,Va.Items.push(jb))}else nb=
nb.ref.value.oper.kind,ha={},ha.Span=Rb,ha.IsString=2===nb,ha.IsBoolean=4===nb,ha.IsNumber=1===nb,Va.Items.push(ha);else Rb.End=nb.span.start+nb.ref.name.length,nb={},nb.Span=Rb,nb.IsFunction=!0,nb.FunctionId=this.getWorksheetFuncId(la.substring(Rb.Start,Rb.End)),Va.Items.push(nb)}Va.Items.sort((Fb,Rb)=>Fb.Span.Start-Rb.Span.Start);return Va}T8h(V){return V.kind===Ga.a.lyf?V.ref.number:-1}S8h(V){return V.kind===Ga.a.lyf?V.ref.name:null}aci(V,ia,X,la){if(V.kind===Ga.a.range)return X.W0=!0,this.pNe(V,
ia,X,la);if(V.kind===Ga.a.namedRange){X=V.ref;(V=this.$.Zb.getItemByName(X.name))||(V=this.$.Zb.getItemByName(ia+"!"+X.name));if(!(V&&V.sheetName&&V.usedRange&&E.a.equals(V.sheetName,ia,!0)))return null;ia=2===V.type?r.a(V):V.usedRange;return ya.m(ia,V)}if(V.kind===Ga.a.x2d){let sa=V.ref,Va;sa.name?(Va=this.$.Zb.getItemByName(sa.name))||(Va=this.$.Zb.getItemByName(ia+"!"+sa.name)):Va=this.gridView.Mb.ph(this.gridView.ga.pa.activeCell);if(!(Va&&Va.sheetName&&Va.usedRange&&E.a.equals(Va.sheetName,ia,
!0)))return null;X.W0=!1;return this.pNe(V,ia,X,la)}return null}pNe(V,ia,X,la){V=V.ref;if(V.type){if(V.type===aa.a.column){var sa=V.startIndex;V=V.endIndex;X.DG=sa.kind===fa.a.abs;X.EL=V.kind===fa.a.abs;return this.createRange(0,sa.index,d.a.Hg,V.index,ia)}if(V.type===aa.a.row)return sa=V.endIndex,X.EG=V.startIndex.kind===fa.a.abs,X.FL=sa.kind===fa.a.abs,this.createRange(V.startIndex.index,0,V.endIndex.index,d.a.Gg,ia);if(V.type===aa.a.cell){sa=V.row;var Va=V.col;X.EG=X.FL=sa.kind===fa.a.abs;X.DG=
X.EL=Va.kind===fa.a.abs;return this.j8b(V.span.end,la)&&(X=Q.Range.gd(sa.index+1,Va.index+1),X=this.gridView.Mb.Eef(X))?ya.n(X,ia):this.createRange(sa.index,Va.index,sa.index,Va.index,ia)}if(V.type===aa.a.range){sa=V.top;Va=V.left;la=V.bottom;V=V.right;const nb=Math.min(sa.index,la.index),ha=Math.min(Va.index,V.index),jb=Math.max(sa.index,la.index),Fb=Math.max(Va.index,V.index);X.EG=sa.kind===fa.a.abs;X.FL=la.kind===fa.a.abs;X.DG=Va.kind===fa.a.abs;X.EL=V.kind===fa.a.abs;return this.createRange(nb,
ha,jb,Fb,ia)}b.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${V.type}'`);return null}b.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}j8b(V,ia){return ia.length>=V&&0<V&&ia.charAt(V-1)===W.FWf}v$g(V,ia,X){this.kt&&this.kt.C$g(V,ia,X)}cod(V){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.iBa&&this.instantaneousSupportInformationManager.iBa[V]&&
this.TG?this.instantaneousSupportInformationManager.iBa[V]:null}toXLNumber(V){if(!this.TG)return null;V=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.TG,V);return excelOnlineCalc.util.isSuccess(V)?V.value:null}Ofk(V,ia){if(V)for(const X of V)X.ref.type&&X.ref.type===aa.a.cell&&(V=X.ref,bb.lkj(V,ia)&&(V.span.end+=1,X.span.end+=1))}createRange(V,ia,X,la,sa){const Va={};Va.FirstRow=V;Va.FirstColumn=ia;Va.LastRow=X;Va.LastColumn=la;Va.SheetName=sa;return Va}Rzh(V,ia,X){var la=V.ref.qualifier;
if(!la)return!0;switch(V.ref.qualifier.type){case pa.sheet:return V=la.document,E.a.equals(la.sheet,ia,!0)&&(!V||E.a.equals(V.document,X,!0));case pa.sheetRange:return ia=this.$.ua.getItemByName(ia),X=this.$.ua.getItemByName(la.sheet1),la=this.$.ua.getItemByName(la.sheet2),!!ia&&!!X&&!!la&&(X.index<=ia.index&&ia.index<=la.index||la.index<=ia.index&&ia.index<=X.index);case pa.document:return E.a.equals(la.document,X,!0);case pa.Aqi:return la=la.name,E.a.equals(la,ia,!0)||E.a.equals(la,X,!0);default:return b.ULS.sendTraceTag(537170009,
0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${la.type}'`),!1}}V$j(V){this.instantaneousSupportInformationManager=V;V.iBa.length&&V.Qla.length?(this.MNc=new S.CalcHelper(this.gridView.$),this.iMb=this.d_.createParser(),this.wme=this.d_.createNumberFormatter(),this.vmc=!0,b.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.kt||(b.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.kt=new L(this.$))):b.ULS.sendTraceTag(537170008,
0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${V.iBa.length}, functions info count = ${V.Qla.length}`)}Yqh(V,ia){const X={allowUnqualifiedCell:!0,wrapCellReferences:!0};X.config=this.d_.config;X.originGridCell=excelOnlineCalc.util.success(V);X.originSheet=excelOnlineCalc.util.success(ia);return X}Xqh(){const V={};V.config=this.d_.config;V.getNameLoc=this.kt.getNameLoc;V.getContainingTable=
this.kt.getContainingTable;V.getStructRefColumn=this.kt.getStructRefColumn;V.getStructRefSpecialRef=this.kt.getStructRefSpecialRef;V.getDocumentLoc=this.kt.getDocumentLoc;V.getSheetIndex=this.kt.getSheetIndex;V.getSheetName=this.kt.getSheetName;V.getUserDefinedFuncLoc=this.kt.getUserDefinedFuncLoc;V.getSheetRangeIndexes=this.kt.getSheetRangeIndexes;return V}static lkj(V,ia){return ia.length>V.span.end&&ia.charAt(V.span.end)===W.FWf}};Za.WVe="ECRC";Za=bb=Object(e.b)([Object(Ua.d)(Ca.i),Object(e.c)(0,
Object(Ca.A)()),Object(e.c)(1,Object(Ca.B)())],Za);Object(c.a)(Za,"CalcManager",ra.a,[565,2]);var Xa=a(40),Ba=a(54);class Wa extends f.a{constructor(V){super();this.$=V;this.kc()}create(){if(this.$){b.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var V=78;var ia="Current"}else V=81,ia="Stable";b.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ia} JS was loaded`);
Xa.TaskExtensions.za(Ba.a.loadScript(V,4,this.La,void 0,void 0,265),()=>{b.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let X=this.$.da.Ba(266,!1);X||(b.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),X=new Za(this.$),this.$.da.Ja(266,X));this.Pb(X)},this.ka,3)}else b.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static la(V){V&&
V.da&&V.da.Ja(265,new Wa(V))}}Object(c.a)(Wa,"CalcManagerFactory",f.a,[]);var Na=a(10);a.d(C,"a",function(){return ta});const ta=()=>{Na.a.Fa(V=>{A.EwaSettings.qC()||Wa.la(V)})};String(u);window.___1684305449233_closurehack=u},1204:function(u,C,a){u={};a.r(u);a.d(u,"SharedUIControlsFactory",function(){return Ra});var c=a(10),b=a(71),f=a(0),e=a(229),d=a(119),h=a(15),l=a(205),k=a(86),n=a(40),v=a(51),x=a(48),w=a(1),r=a(663),t=a(32),A=a(130);class y{constructor(){this.startTime=t.a.Bb.Cc;this.Ny=new r.a}b$e(){return A.a(t.a.Bb,
this.startTime)}}Object(f.a)(y,"OngoingAction",null,[]);class z extends k.a{constructor(ub,Ja,zb,na,Ea=null){super();this.ySa=this.ysb=null;this.w6c=0;this.gwc=null;this.Faj=()=>{const ma=this.ySa.b$e();h.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.goa}>.OnRunningLong: Operation running for more than ${ma}ms`);this.gwc=v.a.instance.create(this.N8,Math.max(this.eGe-ma,0),x.a.xue)};this.N8=()=>{h.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.goa}>.OnTimeout: Operation running for more than ${this.ySa.b$e()}ms, timing out. Has pending actions: ${this.y9a}`);
this.w6c++;this.w6c>this.dGe&&h.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.goa}>.OnTimeout: passed the allowed bypassed count`);this.ySa.Ny.cancel();this.j4e()};this.tJ=()=>{this.y9a&&h.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.goa}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.iPa}, AggregatedActionParams not null: ${this.y9a}`);this.Rud()};this.gRg=ub;this.hRg=Ja;this.documentVisibilityObserver=zb;this.goa=na;this.BM=Ea;zb&&this.documentVisibilityObserver.Lua(this.tJ);
this.v6c=!!zb&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.dGe=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);Ja=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.eGe=ub.h7e(Ja);ub=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.E9g=Math.max(this.eGe-Ja,
0)+ub}get iPa(){return!!this.ySa}get y9a(){return!!this.ysb}sVf(ub){h.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.goa}>.PerformThrottledAction: Start. IsActionOngoing: ${this.iPa}, AggregatedActionParams not null: ${this.y9a}`);this.ysb=this.hRg.Oze(ub,this.ysb);this.Rud()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.MCa(this.tJ);this.QHe();super.dispose()}ceg(ub){this.v6c?(this.ySa=ub?new y:null,ub?this.startTimer():this.QHe()):this.ySa=ub?{}:null}j4e(ub=
null){this.v6c&&ub&&ub.kO?h.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.goa}>.FinishedCallback: timedout, skipping`):(h.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.goa}>.FinishedCallback: Start. IsActionOngoing: ${this.iPa}, AggregatedActionParams not null: ${this.y9a}`),this.ceg(!1),this.Rud())}Rud(){if(!this.dSb()){var ub=this.ysb;this.ysb=null;this.ceg(!0);h.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.goa}>.InternalPerformAction: Calling PerformAction.`);
var Ja=this.v6c?this.ySa.Ny.token:l.a.none;n.TaskExtensions.za(this.gRg.pVf(ub),()=>{this.j4e(Ja)},Ja,0,this.BM)}}dSb(){return!this.y9a||this.iPa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.ui?(h.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.goa}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}QHe(){this.gwc&&this.gwc.cancel()}startTimer(){this.w6c<=this.dGe&&(this.gwc=v.a.instance.create(this.Faj,this.E9g,x.a.xue))}}Object(f.a)(z,"ActionAggregator",
k.a,[647,2]);var E=a(31),G=a(90),F=a(113),O=a(14),M=a(50),P=a(42),B=a(19),D=a(7),I=a(141),S=a(16),J=a(20),L=a(62);class R extends P.a{constructor(ub){super();this.Tx=this.firstElement=null;this.HPa=!1;this.$t=null;this.iTj=E.a.ng;this.FNf=Ja=>{const zb=Ja.Da.keyCode;return zb===G.a.Ai?this.h4i():zb===G.a.Tz&&Ja.Da.shiftKey?this.LPh(this.firstElement):!1};this.eTf=Ja=>{if(!this.HPa||Ja.Da.keyCode!==G.a.zH)return!1;R.pkf();L.Task.delay(1).Xp(()=>{this.Tx.focus();return!0},0,this.ka);return!0};this.Wdj=
()=>{document.activeElement&&document.activeElement.id===this.Tx.id||(R.pkf(),L.Task.delay(1).Xp(()=>{this.Tx.focus();return!0},0,this.ka))};this.xLf=()=>{this.Apg(this.Tx)};this.ENf=Ja=>{Ja.stopPropagation();Ja.preventDefault();this.HPa&&(this.HPa=!1)};this.$=ub;(ub=this.$.ea.Gc)&&h.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${ub.Nva}; InWebPart = '${ub.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${ub.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);ub&&(ub.inWebPart||
ub.inEmbedView)?h.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${ub.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${ub.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Onh(),this.Loh(),F.KeyInputManager.instance.ta(O.a.yc,this.$.domElement,this.eTf));this.$.da.Ja(238,this)}uXg(ub){this.addHandler("KBIS",ub)}uyj(ub){this.removeHandler("KBIS",ub)}dispose(){this.firstElement&&
M.a.removeHandler(this.firstElement,O.a.focus,this.xLf);this.$t&&this.$t.detach("focus");this.Tx&&(M.a.removeHandler(this.Tx,O.a.focus,this.ENf),M.a.removeHandler(this.Tx,O.a.blur,R.onBlur),F.KeyInputManager.instance.Aa(O.a.yc,this.Tx,this.FNf));F.KeyInputManager.instance.Aa(O.a.yc,this.$.domElement,this.eTf);this.$t=this.Tx=this.firstElement=this.$=null;super.dispose()}Onh(){this.iTj?(this.firstElement=document.documentElement,this.$t=I.a.instance.sI(document.parentWindow),this.$t.la("focus",this.Wdj)):
(this.firstElement=R.XOe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),M.a.addHandler(this.firstElement,O.a.focus,this.xLf))}Loh(){this.Tx=R.XOe();this.Tx.id=D.a.FWe;this.Tx.setAttribute(D.a.ov,S.a.instance.ha(863));document.body.appendChild(this.Tx);M.a.addHandler(this.Tx,O.a.focus,this.ENf);M.a.addHandler(this.Tx,O.a.blur,R.onBlur);F.KeyInputManager.instance.ta(O.a.yc,this.Tx,this.FNf)}LPh(ub){this.Apg(ub);return!1}h4i(){this.HPa=!0;J.h(this.$).focus();J.h(this.$).ga.yhf();
this.raiseEvent("KBIS");return!0}Apg(ub){this.HPa?this.HPa=!1:(this.HPa=!0,ub&&ub.focus())}static XOe(){const ub=document.createElement("div");ub.tabIndex=0;return ub}static pkf(){document.body.classList.add(B.a.fZe)}static onBlur(){document.body.classList.remove(B.a.fZe)}}Object(f.a)(R,"EmbedViewFocusControl",P.a,[646,2]);var Y=a(6),Q=a(67),W=a(532),Ga=a(25),pa=a(47),aa=a(382),Z=a(200),fa=a(323),ya=a(120),Aa=a(33),ja=a(230),za=a(246),ra=a(58);const fb=(ub,Ja,zb,na,Ea,ma,Ka,cb,Fa,wa,ka=null)=>{ka=
ub.Pa(1,ka);ka.selectedRange=Ja;ka.richValueKeyPath=zb;ka.singleColumn=na;ka.searchForRange=Ea;ka.calculateMajorityDataType=ma;return ra.g(ub,"GetRichValueFieldListContextList",ka,Ka,cb,Fa,wa,4)};var Ua=a(30);class Ca extends P.a{constructor(ub,Ja){super();this.wPb=this.Gmd=this.QAb=this.BQ=null;this.j_b=!1;this.mde=null;this.iPd=!1;this.N5i=(zb,na,Ea)=>{h.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Ea);this.wPb&&this.wPb.stop();this.BQ=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};
this.O5i=zb=>{ja.a(zb)||(this.wPb&&this.wPb.stop(),this.j_b=!1,(this.BQ=zb.Result)&&0<this.BQ.length&&h.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.BQ.length} rich value field list context for autocomplete`),this.IZa=!0,this.myc())};this.IZa=!1;this.Jb=ub;this.PYb=-1;this.tableManager=Ja;this.iPd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ua.a.nO(ub)}u4b(ub){this.addHandler("FieldInfoListContextLoaded",ub)}Rzc(ub){this.removeHandler("FieldInfoListContextLoaded",
ub)}TWg(ub){this.addHandler("GetFieldInfoListContextOperationFailed",ub)}ayj(ub){this.removeHandler("GetFieldInfoListContextOperationFailed",ub)}get d$a(){return this.IZa}get mOi(){return this.j_b}get f6e(){return this.PYb}get Zbd(){return this.mde}get $(){return this.Jb}get El(){return this.BQ}get w5h(){return!!this.QAb}dispose(){this.Jb=null;this.hgb();super.dispose()}n0(ub,Ja,zb,na=null){if(ub){this.g7c();this.T7b();var Ea=null,ma=!1;if(!na&&({Mdb:ma,El:Ea}=this.K$j(ub,Ja,zb)).returnValue)if(this.iPd||
this.adg(Ea),this.j_b=!0,this.BQ=Ea,this.iPd){if(!ma){this.IZa=!0;this.myc();return}}else if(this.BQ&&0<this.BQ.length&&(this.IZa=!0,this.myc()),!ma)return;this.utg(ub,na,Ja,zb,!1)}}utg(ub,Ja,zb,na,Ea){if(this.$.ea.Ec){this.$.nc&&(this.wPb=this.$.nc.qd("WebServiceCall","GetRichValueFieldInfoListContext"));this.QAb=null;var ma=this.$.qa.va.Bc();this.QAb=fb(this.$.qa.va,ub,Ja,zb,na,Ea,this.O5i,this.N5i,null,ma)}else this.BQ=null}hgb(){this.BQ=null;this.IZa=!1;this.g7c();this.T7b();this.QAb=null;this.PYb=
-1}g7c(){Ca.Jub(this.QAb)}T7b(){Ca.Jub(this.Gmd)}myc(){this.raiseEvent("FieldInfoListContextLoaded")}Lq(ub){ub=pa.E(ub);--ub.left;--ub.right;return this.tableManager.Lq(ub)}BNa(ub){ub.FirstColumn=ub.FirstColumn;ub.LastColumn=ub.LastColumn;ub.FirstRow=ub.FirstRow;ub.LastRow=ub.LastRow;this.T7b();this.Gmd=null;return aa.a(this.$.userOperationManager,(Ja,zb,na)=>fa.i(this.$.qa.va,ub,za.b(Ja,Ea=>{this.X5i(Ea)}),za.a(zb,zb,Ea=>{this.W5i(Ea)}),na,null),Ja=>new Z.a(264,0,Ja,80),null)}W5i(ub){ub=ya.a.lf(ub.data);
h.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${Aa.a.Ic(ub)}`)}X5i(ub){if(ja.a(ub))-315732528!==ub.Errors[0].MessageId&&h.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${Aa.a.Ic(ub.Errors)}`);else if(ub&&ub.Result){ub=ub.Result;var Ja=ub.HasHeaderRow;Ja=new W.AutofilterRange(ub.TableRange.FirstRow+(Ja?1:0)+1,ub.TableRange.FirstColumn+1,ub.TableRange.LastRow+
1,ub.TableRange.LastColumn+1,null,null,null,0,Ja);this.PYb=ub.TableRange.FirstColumn;(ub=this.FYf(!1,!0,Ja))||h.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.adg(ub)}else h.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}K$j(ub,Ja,zb){let na,Ea;Ea=null;na=!1;if(ub.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,Mdb:na,BNa:!1,El:Ea};let ma;this.PYb=-1;
if(zb){ma=this.Lq(ub);if(!ma||!ma.Jma)return{returnValue:!1,Mdb:na,BNa:!1,El:Ea};var Ka=J.h(this.$).Mb.Edf(ma);this.mde=ma;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Ka&&0<Ka.count)return--ub.FirstColumn,--ub.LastColumn,this.Gmd=this.BNa(ub),{returnValue:!0,Mdb:na,BNa:!0,El:Ea};ma.top+=1;ma.right=pa.E(ub).right-1}else ma=new W.AutofilterRange(ub.FirstRow+1,ub.FirstColumn+1,ub.LastRow+1,ub.LastColumn+1,null,null,null,0,
!1);if(ma.top>ma.bottom||ma.left>ma.right)return{returnValue:!0,Mdb:na,BNa:!1,El:Ea};ub=J.h(this.$);var cb=ub.Cb.width,Fa=ub.Cb.height;Ka=ub.view.visibleArea;cb=new Q.a(Ka.x-cb,Ka.y-Fa,Ka.width+cb,Ka.height+Fa);Fa=ub.Vg(ma);if(!Ka||!Fa||!ub.yoc(ma))return{returnValue:!1,Mdb:na,BNa:!1,El:Ea};cb.contains(Fa)||(na=!0);Ea=this.FYf(Ja,zb,ma);return{returnValue:!0,Mdb:na,BNa:!1,El:Ea}}adg(ub){ub&&h.ULS.sendTraceTag(25264348,0,50,`Retrieved ${ub.length} rich value field contexts from block cache`);this.j_b=
!0;(this.BQ=ub)&&0<this.BQ.length&&(this.IZa=!0,this.myc())}FYf(ub,Ja,zb){let na;na=null;const Ea=zb.clone();if(Ja)for(let ma=zb.right,Ka=0;ma>=zb.left;--ma){if(Ea.left=ma,Ea.right=ma,Ja=this.q$e(Ea,!0,zb.left)){na||(na=[]);na[Ka]=Ja;if(ub)break;++Ka}}else if(ub=this.q$e(Ea,!1))na=[],na[0]=ub;return na}q$e(ub,Ja,zb=0){var na=null;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Ea=J.h(this.$).Mb.gdi(ub);if(Ea&&0<Ea.count){var ma=Array(Ea.count);na=0;
for(var Ka of Ea.values)Ea={},Ea.Name=Ka,ma[na]=Ea,++na;Ka="";Ea=-1;0<ub.top&&Ja&&(ub=new Ga.Range(ub.top-1,ub.left,ub.top-1,ub.left,!1,!1),null!=J.h(this.$).jc(ub)&&null!=J.h(this.$).jc(ub).originalText&&(Ka=J.h(this.$).jc(ub).originalText),Ea=ub.left-zb);na={};na.ColumnName=Ka;na.ColumnIndex=Ea;na.FieldInfoDataList=ma}}else if((Ka=J.h(this.$).Mb.Edf(ub))&&0<Ka.count){ma=Array(Ka.count);na=0;for(Ea of Ka)Ka={},Ka.Name=Ea,ma[na]=Ka,++na;Ka="";Ea=-1;0<ub.top&&Ja&&(ub=new Ga.Range(ub.top-1,ub.left,
ub.top-1,ub.left,!1,!1),Ka=J.h(this.$).jc(ub).originalText,Ea=ub.left-zb);na={};na.ColumnName=Ka;na.ColumnIndex=Ea;na.FieldInfoDataList=ma}return na}static Jub(ub){ub&&Y.AFrameworkApplication.de.cw(ub.pv)}}Object(f.a)(Ca,"FieldInfoManager",P.a,[464,2]);class Ia extends Ca{constructor(ub,Ja,zb,na){super(ub,Ja);this.F5a=null;this.rLf=()=>{this.Rzc(this.rLf);if(this.El&&this.El.length&&this.contextMenuManager){var Ea=this.contextMenuManager.Sld("autoFilterRichFieldList"),ma=window.document.getElementById(this.F5a);
Ea.D2(null,ma,this,null,!0)}};this.tDg=zb;this.contextMenuManager=na}get lI(){return this.tDg}H5h(ub,Ja){this.F5a=Ja;h.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${ub.FirstRow}, ${ub.FirstColumn}, ${ub.LastRow}, ${ub.LastColumn})`);this.utg(ub,null,!0,!1,!0)}}Object(f.a)(Ia,"FilterInfoManager",Ca,[554,464,2]);var oa=a(874),Da=a(1101),bb=a(34),Za=a(92),Xa=a(9);class Ba{}Ba.JJh="ewa-sharedUi-launchButton";
Ba.MJh="ewa-sharedUi-launchButtonWithText";Ba.KJh="ewa-sharedUi-launchButtonClick";Ba.NJh="ewa-sharedUi-launchButtonWithTextClick";Ba.LJh="ewa-sharedUi-launchButtonText";Object(f.a)(Ba,"CssClassNames",null,[]);var Wa=a(73);a(526);var Na=a(248),ta=a(231);P=a(247);var V=a(297),ia=a(76),X=a(12),la=a(263),sa=a(37);class Va extends P.a{constructor(ub,Ja,zb,na,Ea,ma,Ka,cb,Fa){super(document.createElement("div"));this.sxf=null;this.Q0d=!1;this.oc=this.KTb=this.TVa=null;this.VO=()=>{this.raiseEvent("OnObjectButtonMouseOver")};
this.UO=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.IZj=()=>{this.Iue()};this.Gd=wa=>{this.raiseEvent(this.AMb,wa);this.ZSa();return!0};this.N3i=wa=>{100<A.a(t.a.Bb,this.sxf)&&this.ard(new Sys.UI.Point(Math.round(wa.clientX),Math.round(wa.clientY)))};this.PO=wa=>{ia.g(wa.Da,!1);return!1};this.N_=this.Ze.dLa();this.set_visible(!1);this.bpc=Ea;this.AMb=ma;this.qtc=ub;this.W8b=Ja;this.oc=Fa;this.bpc&&(this.TVa=v.a.instance.create(this.IZj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));ub&&this.domElement.classList.add(ub);
this.kub=document.createElement("div");this.domElement.appendChild(this.kub);zb&&this.kub.classList.add(zb);this.y6d(na);Ka&&(this.KTb=document.createElement("div"),this.domElement.appendChild(this.KTb),this.KTb.classList.add(cb),this.KTb.innerText=Ka,this.domElement.style.padding="3px",Na.a.instance.ta(O.a.pointerDown,this.domElement,this.PO));this.K2a=new V.a(this.domElement,7);ta.a.instance.ta(O.a.click,this.domElement,this.Gd);w.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&
Na.a.instance.ta(O.a.pointerDown,this.domElement,this.PO);ub=wa=>{ia.g(wa)};this.od.la("mouseup",ub);this.od.la("click",ub);this.od.la("dblclick",ub)}TZ(ub){this.addHandler(this.AMb,ub)}s9(ub){this.get_events().removeHandler(this.AMb,ub)}NXg(ub){this.addHandler("OnObjectButtonMouseOver",ub)}Lyj(ub){this.get_events().removeHandler("OnObjectButtonMouseOver",ub)}MXg(ub){this.addHandler("OnObjectButtonMouseOut",ub)}Kyj(ub){this.get_events().removeHandler("OnObjectButtonMouseOut",ub)}y6d(ub){ub&&this.oc.Oh(this.kub,
ub)}idk(ub,Ja,zb){this.oc.PD(this.kub);ub?ub.Lda(Ja,16,16,this.kub,16,16,void 0,zb):h.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}jdk(ub,Ja){ub&&(this.KTb.innerText=ub);this.domElement.title=Ja}dispose(){this.get_isInitialized()&&(this.hide(),this.od.eE(),Za.a.Rc([this.N_,this.K2a]),ta.a.instance.Aa(O.a.click,this.domElement,this.Gd),Na.a.instance.Aa(O.a.pointerDown,this.domElement,this.PO),this.TVa&&this.TVa.dispose(),super.dispose())}egb(){this.W8b&&
this.domElement.classList.remove(this.W8b);this.qtc&&this.domElement.classList.add(this.qtc)}ZSa(){this.qtc&&this.domElement.classList.remove(this.qtc);this.W8b&&this.domElement.classList.add(this.W8b);this.S5a()}S5a(){this.bpc&&(this.TVa.cancel(),this.ulg(),this.setOpacity(1));this.set_visible(!0)}dm(ub,Ja,zb,na,Ea=!1){ub=sa.a(na).ri(ub);Ja=sa.a(na).ri(Ja);sa.a(na).HDc(this.domElement);this.domElement.style.top=X.HelperMethods.Yc(Ja);this.domElement.style.left=this.domElement.style.right="";Ja=ub;
Ea&&(Ja=ub-this.domElement.offsetWidth);la.c(this.domElement.style,zb,X.HelperMethods.Yc(Ja));this.set_visible(!0);this.setOpacity(1);this.bpc&&(this.Q0d=!1,this.A1j(),this.TVa.Zq())}hide(){this.egb();this.set_visible(!1);this.bpc&&(this.ulg(),this.TVa.cancel())}edc(){this.od.la("mouseover",this.VO,!0);this.od.la("mouseout",this.UO,!0)}A1j(){this.N_.zj("mousemove")||this.N_.la("mousemove",this.N3i)}ulg(){this.N_.zj("mousemove")&&this.N_.detach("mousemove")}ard(ub){if(this.domElement.parentNode){var Ja=
Sys.UI.DomElement.getBounds(this.domElement);const zb=new Sys.UI.Point(Math.round(Ja.x+Ja.width),Math.round(Ja.y+Ja.height));Ja=Math.abs(zb.x-ub.x);ub=Math.abs(zb.y-ub.y);ub=Ja>ub?Ja:ub;this.Q0d?this.setOpacity(Va.L$g(ub)):100>=ub&&this.Iue()}}Iue(){this.Q0d=!0;this.TVa.cancel()}setOpacity(ub){E.a.setOpacity(this.domElement,ub);this.sxf=t.a.Bb.Cc}static L$g(ub){return 100>=ub?1:250<=ub?0:.01*(100-(ub-100)/150*100)}}Object(f.a)(Va,"OnObjectButton",P.a,[658,145,2]);var nb=a(799);const ha=Ba.LJh;class jb extends k.a{constructor(ub,
Ja,zb,na,Ea,ma,Ka,cb,Fa=""){super();this.Yya=null;this.Tkf=!1;this.oc=this.Nsc=this.Osc=null;this.buttons={};this.oYe={};this.$=ub;this.svgIconProvider=Ja;this.e2i=zb;this.ttd=na;this.std=Ea;this.altText=ma;this.AMb=Ka;this.oc=cb;this.buttonText=Fa}get Gs(){return sa.a(this.$).nJa(Xa.a.M9i)}get Sub(){return Xa.a.L9i}get buttonWidth(){return sa.a(this.$).nJa(Xa.a.N9i)}dispose(){this.Myh();this.$=null;super.dispose()}getButton(ub,Ja=!0){return this.Ixa(ub,Ja)}Ixa(ub,Ja=!0){const zb=ub.toString();zb in
this.buttons||this.Noh(ub,Ja);return this.buttons[zb]}dm(ub,Ja,zb,na,Ea=!0,ma=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&Wa.i(this.$.na)){var Ka=J.h(this.$).pT.domElement;const cb=ub+this.buttonWidth-Ka.scrollWidth;Ka=Ja+this.buttonWidth-Ka.scrollHeight;ub=0<cb?ub-cb:ub;Ja=0<Ka?Ja-Ka:Ja}this.Ixa(na,Ea).dm(ub,Ja,zb,this.$,ma)}hide(){const ub=this.buttons;for(let Ja in ub)ub[Ja].hide()}edc(ub,Ja){!this.Tkf&&(Ja=this.buttons[Ja.toString()])&&(this.Osc=(zb,na)=>{ub(na,!0)},Ja.NXg(this.Osc),this.Nsc=
(zb,na)=>{ub(na,!1)},Ja.MXg(this.Nsc),this.Tkf=!0,Ja.edc())}Noh(ub,Ja){this.Yya=String.format(this.ttd===B.a.Udc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',bb.a.ki(this.ttd),bb.a.ki(this.std),"{0}");var zb=String.format(this.Yya,bb.a.ki(this.altText));Ja=new Va(""===this.buttonText?Ba.JJh:Ba.MJh,""===this.buttonText?Ba.KJh:Ba.NJh,B.a.VB,zb,Ja,this.AMb,this.buttonText,ha,this.oc);
zb=(na,Ea)=>{this.e2i(Ea,ub)};Ja.TZ(zb);this.buttons[ub.toString()]=Ja;this.oYe[ub.toString()]=zb;zb=J.h(this.$).og(ub);zb.domElement.insertBefore(Ja.domElement,zb.domElement.firstChild)}Myh(){for(const ub of nb.a(this.buttons)){const Ja=this.buttons[ub];Ja.s9(this.oYe[ub]);Za.a.Ka(Ja);delete this.buttons[ub];this.Osc&&Ja.Lyj(this.Osc);this.Nsc&&Ja.Kyj(this.Nsc)}}domElement(ub){return this.Ixa(ub).domElement}S5a(ub){this.Ixa(ub).S5a()}aVb(ub,Ja,zb=!0){this.Yya=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
bb.a.ki(this.ttd),bb.a.ki(this.std),"{0}");ub=String.format(this.Yya,bb.a.ki(ub));this.Ixa(Ja,zb).y6d(ub)}rXa(ub,Ja,zb){this.Ixa(zb,!1).jdk(ub,Ja)}rtg(){this.Yya=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",bb.a.ki(this.std),"{1}");const ub=String.format(this.Yya,void 0,bb.a.ki(void 0));this.Ixa(void 0,!1).y6d(ub)}zJc(ub,Ja,zb){this.Ixa(zb,!1).idk(this.svgIconProvider,ub,Ja)}}Object(f.a)(jb,"OnObjectLaunchButton",k.a,[644,2]);
k=a(101);class Fb extends k.a{constructor(ub,Ja){super(ub);this.$Hb=null;this.wyh=()=>{this.display()};this.Dri=Math.max(1,Ja)}dispose(){Za.a.Ka(this.$Hb);this.$Hb=null;super.dispose()}iWa(){Za.a.Ka(this.$Hb);this.$Hb=v.a.instance.create(this.wyh,this.Dri,x.a.qOi)}oWa(){Za.a.Ka(this.$Hb);this.hide()}}Object(f.a)(Fb,"LoadingIndicatorBehavior",k.a,[620,2]);class Rb extends Fb{constructor(ub,Ja,zb,na){super(ub,Ja);this.ZHb=null;this.OFg=zb;this.Koi=na;this.vTg()}dispose(){this.ZHb=null;super.dispose()}display(){this.OFg(this.ZHb)}hide(){this.Koi(this.ZHb)}vTg(){this.ZHb=
document.createElement("div");this.domElement.appendChild(this.ZHb)}}Object(f.a)(Rb,"ShimmerLoadingIndicatorBehavior",Fb,[]);var mb=a(75),sb=a(54),Ya=a(13);class Ma extends Fb{constructor(ub,Ja,zb,na=null,Ea=null,ma=0){super(ub,Ja);this.T8a=this.$Qa=null;this.T8a=zb;this.dlc=na||sb.a.current.Lo(105);this.nzf=ma;this.dcd=Ea;this.uTg()}dispose(){this.$Qa=null;super.dispose()}display(){Ya.DOMElementExtensions.setVisible(this.$Qa,!0)}hide(){Ya.DOMElementExtensions.setVisible(this.$Qa,!1)}uTg(){this.$Qa=
document.createElement("div");this.$Qa.classList.add(mb.a.sIh);const ub=document.createElement("div");ub.classList.add(mb.a.tIh);this.dcd&&""!=this.dcd&&ub.classList.add(this.dcd);const Ja=0===this.nzf?"":S.a.instance.ha(this.nzf),zb=String.format('<div class="'+mb.a.uIh+'">{0}</div>',Ja);this.dlc?this.T8a.Oh(ub,`<img src="${this.dlc}" alt="${Ja}" title="${Ja}"/>`+zb):this.T8a.Oh(ub,zb);this.$Qa.appendChild(ub);this.domElement.appendChild(this.$Qa)}}Object(f.a)(Ma,"SpinnerLoadingIndicatorBehavior",
Fb,[]);var xb=a(149),qb=a(36);Object(xb.b)(qb.mb)(ub=>Object(d.a)(void 0,void 0,void 0,function*(){const Ja=yield xb.a.resolve(qb.S,{Wa:ub.Wa});return new Ra(Ja)}));class Ra{constructor(ub){this.T8a=ub}fbd(ub,Ja,zb){return new oa.a(ub,Ja,zb)}Z$b(ub,Ja,zb,na,Ea,ma,Ka,cb,Fa,wa){return new Da.a(ub,Ja,zb,na,Ea,ma,Ka,cb,Fa,wa)}Gwb(ub,Ja,zb,na,Ea=0){return new Ma(ub,Ja,this.T8a,zb,na,Ea)}mod(ub){return ub.da.Ba(238)||new R(ub)}w4a(ub,Ja,zb,na,Ea,ma,Ka,cb=""){return new jb(ub,Ja,zb,na,Ea,ma,Ka,this.T8a,
cb)}Had(ub,Ja){return new Ca(ub,Ja)}Jnh(ub,Ja,zb,na){return new Ia(ub,Ja,zb,na)}aOe(ub,Ja,zb,na){return new z(ub,Ja,zb,na)}}Object(f.a)(Ra,"SharedUIControlsFactory",null,[564]);var Jb=a(100);class yb extends e.a{constructor(ub){super();this.$=ub;this.kc()}create(){const ub=Object(Jb.d)(xb.a.resolve(qb.S,{Wa:this.La}));n.TaskExtensions.za(ub,()=>{this.Pb(this.$.da.Ba(12)||new Ra(ub.result))},this.ka,3)}static la(ub){ub.da.Ja(477,new yb(ub))}}Object(f.a)(yb,"SharedUIControlsFactoryServiceFactory",e.a,
[]);a.d(C,"a",function(){return Gb});const Gb=()=>{c.a.Fa(ub=>{Object(b.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")||yb.la(ub)})};String(u);window.___1684305474822_closurehack=u},1212:function(u,C,a){u=a(0);var c=a(6),b=a(229),f=a(15),e=a(88),d=a(57),h=a(204);class l{constructor(){this.Lqe=this.HYc=!1;const sa=c.AFrameworkApplication.accessTokenTtl;0>=sa||(this.accessTokenTtl=sa,f.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Fja}),h.a.instance.Q2c(Object(e.a)(this,this.pSa,"onSessionExpiredDetected")),h.a.instance.O2c(Object(e.a)(this,this.fRf,"onSessionExpiringDetected")))}pSa(){h.a.instance.JSd(Object(e.a)(this,this.pSa,"onSessionExpiredDetected"));f.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.tmi()}fRf(){h.a.instance.ISd(Object(e.a)(this,this.fRf,"onSessionExpiringDetected"));this.Lqe||this.HYc||(f.ULS.sendTraceTag(20492680,
217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Lqe=!0,this.dZj())}tmi(){this.HYc||(c.AFrameworkApplication.Sv(d.a.TCc),this.HYc=!0,this.cZj())}}Object(u.a)(l,"ASessionExpirationManager",null,[]);var k=a(92),n=a(42),v=a(33),x=a(16),w=a(49),r=a(262),t=a(8),A=a(87),y=a(265),z=a(74);class E extends l{constructor(sa){super();this.Ra=new n.a;this.mG=this.Gqb=!1;this.$=sa}Eye(sa){this.Ra.addHandler("SessionExpired",sa)}dsb(sa){this.Ra.addHandler("TokenRefreshed",sa)}cAc(sa){this.Ra.removeHandler("TokenRefreshed",
sa)}get accessTokenExpiringMessage(){const sa=(new Date(this.accessTokenTtl)).format(this.$.xa.ShortTimeFormat);return String.format(x.a.instance.Lb(78),sa)}get tokenExpired(){return this.Gqb}get Hhb(){return!1}get fea(){return!1}get KQd(){return!1}get S7(){return!1}bkc(){return h.a.instance.wS(c.AFrameworkApplication.accessTokenTtl)}dispose(){k.a.Ka(this.Ra);this.$=null}dZj(){this.$.isEditMode&&this.vjc(!1)}cZj(){this.Gqb=!0;this.vjc(!0);this.Ra.raiseEvent("SessionExpired")}vjc(sa){f.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${sa}, GotDeploymentOrTimedOutError ${this.$.ea.x0}`);const Va=this.$.Ob.Yp;sa&&Va&&Va.isVisible&&1299163859===Va.error.MessageId&&this.$.Ob.Yp.vw();const nb=this.Od(sa);w.a(this.$).Ns(new r.a(t.a.Hx,5,()=>{const ha=z.a(this.$),jb=ha.Qd.activityState;jb[A.a.t4]=this.$.aub(this.$.isEditMode);jb[A.a.iN]=A.a.gcb;jb[y.a.xq]=t.a.accessTokenExpiringWarning;ha.Qd.gs([nb])}))}Od(sa){return sa?v.a.kQe():this.srh()}srh(){const sa=
v.a.Od(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");sa.Description=this.accessTokenExpiringMessage;return sa}}Object(u.a)(E,"EwaAccessTokenExpirationManager",l,[585,586,2]);var G=a(2),F=a(185),O=a(82),M=a(663),P=a(32);class B{constructor(sa,Va){this.MNb=!1;this.correlationID=sa;this.Mbd=Va;this.WHc=!1;this.creationTime=P.a.Bb.Cc}}Object(u.a)(B,"RefreshAccessTokenContext",null,[]);var D=a(61),I=a(58),S=a(171),J=a(48),L=a(116),R=a(130),Y=a(1),Q=a(23),W=a(158),Ga=a(39),pa=a(125);class aa{}Object(u.a)(aa,
"Error",null,[]);class Z{}Object(u.a)(Z,"NamedResult",null,[]);class fa extends Z{}Object(u.a)(fa,"ErrorInfo",Z,[]);class ya{constructor(sa,Va){this.D2b=sa;this.LH=Va}get tokens(){return this.D2b}get errors(){return this.LH}}Object(u.a)(ya,"TokenRefreshArgs",null,[588]);class Aa{constructor(sa,Va){this.documentVisibilityObserver=null;this.Ra=new n.a;this.Ny=null;this.vib=this.Epb=!1;this.Wyc=null;this.VNb=!1;this.HDd=!0;this.Tje=this.qje=this.mG=this.Gqb=!1;this.gU=null;this.Uhf=()=>{if(this.$.ea.Ec)this.qif(!1);
else if(this.HDd){this.HDd=!1;const nb=z.a(this.$);f.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${nb.Ei?nb.Ei.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.uog()}]`)}};this.zd=(nb,ha)=>{this.context&&(nb=this.$.ea,ha.FG&&this.context.MNb&&!this.context.WHc?(this.context.WHc=!0,ha={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},ha.IsUserActive=
nb.zf.Tq,ha.RefreshAccessTokenCorrelationID=this.context.correlationID,ha=D.a.Zc(ha),f.ULS.sendTraceTag(537170708,0,50,ha)):!this.Epb||nb.Ec||this.context.Mbd||(ha={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Ny&&(this.Ny.cancel(),ha.Aborted=!0,ha.ResetStopRefreshRetriesUntilTokenExpired=!0,this.vib=!1),ha.TimeUntilTokenExpirationInMin=this.uog(),ha.RefreshAccessTokenCorrelationID=this.context.correlationID,ha=D.a.Zc(ha),f.ULS.sendTraceTag(572019856,
0,50,ha)))};this.EBa=()=>{if(this.context&&this.context.MNb&&!this.context.WHc){var nb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};nb.CreatedForExpired=this.context.Mbd;nb.RefreshAccessTokenCorrelationID=this.context.correlationID;nb.OpenWorkbookErrors=v.a.Ic(this.$.ea.XG);nb.ExecutionContextErrors=v.a.Ic(z.a(this.$).Qd.errors);nb.accesstokenTTL=c.AFrameworkApplication.accessTokenTtl;nb=D.a.Zc(nb);f.ULS.sendTraceTag(537170707,0,15,nb)}};this.pif=()=>{this.vib=!1;this.qif(!0)};
this.XKd=()=>{this.VNb&&(this.$.ea.zf.OCa(this.XKd),this.VNb=!1);this.Tkg()};this.$=sa;this.x4d=Va;this.IQd=sa.nc.hh("WebServiceCall","refreshToken");h.a.instance.Q2c(this.pif);h.a.instance.O2c(this.Uhf);Va=this.$.ea;Va.pk(this.zd);Va.G4b(this.EBa);this.TVi=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.dgg=this.$.xa.ShortAccessTokenExpirationPromptSeconds;this.x1f=this.$.xa.RefreshAccessTokenDurationLimitInSec;this.zug(sa.ea.qUf,c.AFrameworkApplication.accessTokenTtl);sa=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.accessTokenTtl,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Fja,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.n9d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.p9d});f.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${sa}`);this.$.da.Gb(291,nb=>{this.documentVisibilityObserver=nb})}Eye(sa){this.Ra.addHandler("SessionExpired",sa)}dsb(sa){this.Ra.addHandler("TokenRefreshed",sa)}cAc(sa){this.Ra.removeHandler("TokenRefreshed",sa)}get tokenExpired(){return this.Gqb}get fea(){return this.qje}get S7(){return this.Tje}get context(){return this.gU}get Hhb(){return this.S7?
!1:this.$.ea.zf.Tq?1>pa.a.q8:6>pa.a.r8}get KQd(){return this.Epb}bkc(){return h.a.instance.wS(c.AFrameworkApplication.accessTokenTtl)}dispose(){h.a.instance.JSd(this.pif);h.a.instance.ISd(this.Uhf);const sa=this.$.ea;sa&&(sa.Kk(this.zd),sa.eAc(this.EBa));k.a.Ka(this.Ra);this.documentVisibilityObserver=this.$=null}uog(){return this.bkc()?0:(c.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}zug(sa,Va){if(0<Va&&!this.bkc()){const nb=c.AFrameworkApplication.fa.oe("AccessTokenExpirationPromptSeconds",
c.AFrameworkApplication.KZ),ha=(Va-sa.getTime())/6E4;f.ULS.shipAssertTag(537170713,0,0<=ha,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${Va}] creationTime [${sa.getTime()}] tokenLifetimeInMin [${ha}]`);ha<this.TVi?(f.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.dgg}] tokenLifetimeInMin [${ha}]`),c.AFrameworkApplication.KZ=
this.dgg):c.AFrameworkApplication.KZ!==nb&&(f.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${nb}] tokenLifetimeInMin [${ha}]`),c.AFrameworkApplication.KZ=nb)}}Mlh(sa){return!this.context||this.context.MNb||this.context.Mbd!==sa?(sa=new B(F.a.create().toString(),sa),this.context&&!this.context.WHc&&f.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${sa.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.MNb}] `),
this.gU=sa,!0):!1}ICj(sa){sa&&this.mG&&!this.fea&&this.$.ea.zf.Tq&&!this.S7&&(this.mG=!1)}qif(sa){this.ICj(sa);if(!(this.Epb||this.vib&&!sa||this.mG)&&this.Hhb){this.Epb=!0;var Va=this.context?this.context.creationTime:null,nb=this.Mlh(sa);this.HDd=!0;var ha=this.$.ea,jb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};jb.newContextCreated=nb;jb.IsUserActive=ha.zf.Tq;jb.IsSessionActive=ha.Ec;jb.ContainsChangesWorkbookOperations=this.$.userOperationManager.SKa();jb.isSessionExpired=
sa;jb.stopRefreshRetriesUntilTokenExpired=this.vib;jb.FailedToRefreshExpiredToken=this.mG;jb.numOfFailuresWhileUserIsActive=pa.a.q8;jb.numOfFailuresWhileUserIsInActive=pa.a.r8;jb.numOfFailuresWhileOffline=pa.a.hBa;jb.RefreshAccessTokenCorrelationID=this.context.correlationID;nb&&Va&&(jb.TimeInMinFromPreviosContextCreation=Math.round(R.b(P.a.Bb,Va)/60));Va=D.a.Zc(jb);f.ULS.sendTraceTag(40416199,0,50,Va);this.IQd.start();this.qje=ha.zf.Tq;this.Ny=new M.a;this.eNi(sa);var Fb=this.x4d.Usj(!sa,this.Ny?
this.Ny.token:null);Fb.continueWith(()=>{this.keh();const Rb=this.x4d.Pmj(Fb);this.IQd.stop();const mb=this.bkc();if(!Rb||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&mb){const sb=Fb.result.errors;Rb&&mb&&this.TSg(sb);this.ami(sb,sa)}else this.vib=!1,this.cmi(Fb.result.tokens,sa);this.Epb=!1},8)}}TSg(sa){const Va=[Object(G.a)(new aa,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];sa.add(Object(G.a)(new fa,{Name:"ExpiredTokenAfterSuccessfulRefresh",
Errors:Va}))}eNi(sa){sa&&(this.$.ea.zf.Tq?this.Tkg():(this.$.ea.zf.gja(this.XKd),this.VNb=!0))}Tkg(){this.Wyc=S.AsyncMethodContext.vr(()=>{this.Tsj()},1E3*this.x1f,J.a.Asj,this.Wyc)}keh(){this.Wyc&&this.Wyc.cancel();this.VNb&&(this.$.ea.zf.OCa(this.XKd),this.VNb=!1);this.Ny=null}Tsj(){f.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.x1f}]`);this.Ny.cancel()}ami(sa,Va){this.vib=!0;Va&&(this.mG||(this.Gqb=this.mG=
!0),this.x4d.SFb(sa)&&(this.Tje=!0));const nb=!Va||this.Hhb&&!pa.a.FEc?40380379:39982555;Va=this.LOe(Va);Va.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Va.FailedToRefreshExpiredToken=this.mG;Va.LastErrorIsPermanent=this.S7;if(0<sa.count){var ha=sa.ma(0);Va.errorName=ha.Name;0<ha.Errors.length&&(Va.ErrorId=ha.Errors[0].Id,ha=ha.Errors[0].Details,Va.ErrorDetails=this.Pzh(ha.toString())?"PiiScrubbed":ha)}Va=D.a.Zc(Va);f.ULS.sendTraceTag(nb,0,15,Va);this.Ra.raiseEvent("TokenRefreshed",
new ya(null,sa))}Pzh(sa){return Q.a.contains(sa,"makes the internet safe for businesses",!0)}LOe(sa){const Va={},nb=this.$.ea;Va.Name="";Va.IsUserActive=nb.zf.Tq;Va.IsSessionActive=nb.Ec;Va.GotDeploymentOrTimedOutError=nb.x0;Va.TimeInSecFromLastStatefulSuccessfulRequest=nb.GY;Va.TimeFromLastUserActivityInMs=nb.zf.Uib;Va.calledFromSessionExpiredFlow=sa;Va.RefreshTokenDurationInMS=this.IQd.fd;Va.numOfFailuresWhileUserIsActive=pa.a.q8;Va.numOfFailuresWhileUserIsInActive=pa.a.r8;Va.numOfFailuresWhileOffline=
pa.a.hBa;Va.RefreshAccessTokenCorrelationID=this.context.correlationID;Va.accessTokenTTL=c.AFrameworkApplication.accessTokenTtl;Va.ContainsChangesWorkbookOperations=this.$.userOperationManager.SKa();Va.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.ui.toString():"Unknown";Va.TimeFromFirstOpenInHr=Math.floor(R.b(P.a.Bb,L.toUtc(nb.qUf))/3600);return Va}cmi(sa,Va){this.mG=!1;this.Ogk();this.zug(new Date,c.AFrameworkApplication.accessTokenTtl);const nb=this.$.ea,ha=!Va&&
nb.zf.Tq,jb=!this.$.isEditMode&&nb.ffb;Va=this.LOe(Va);Va.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Va.shouldTriggerSilentReloadAfterExpiring=ha;Va.WopiTokenTaskItemPriority=c.AFrameworkApplication.p9d;Va.isDirtyViewSession=jb;Va=D.a.Zc(Va);f.ULS.sendTraceTag(39982556,0,15,Va);this.Ra.raiseEvent("TokenRefreshed",new ya(sa,null));jb?nb.zf.Tq&&(f.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
nb.Tjd()):nb.zf.Tq?ha&&(sa=z.a(this.$).Qd.activityState,sa[pa.a.rjb]=!0,sa[W.a.PZ]=!0,sa[Ga.a.dt]=this.$.isEditMode,w.a(this.$).Ns(new r.a(t.a.eqa,2,null))):nb.Ec&&I.j(this.$.qa.va,!0,!1,!1,null,null,null,null,null)}Ogk(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=O.a.SU(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.PQ,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=
O.a.SU(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.LZ,c.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.ewc()):f.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.xa.AccessToken=c.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=c.AFrameworkApplication.accessTokenTtl;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&
(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=O.a.SU(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.PQ,c.AFrameworkApplication.accessToken),this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=O.a.SU(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.LZ,c.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=O.a.SU(this.$.xa.EmbedConfiguratorUrl,
c.AFrameworkApplication.PQ,c.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=O.a.SU(this.$.xa.EmbedConfiguratorUrl,c.AFrameworkApplication.LZ,c.AFrameworkApplication.accessTokenTtl.toString()));this.context.MNb=!0}}Object(u.a)(Aa,"EwaAccessTokenExpirationRefreshManager",null,[585,586,2]);var ja=a(199),za=a(170),ra=a(126),fb=a(425);class Ua{}Ua.E3b="ActivityDuration";Ua.error="Error";Ua.cgd="Errors";Ua.failed="Failed";Ua.FTh="FirstActivity";Ua.initialized="Initialized";Ua.oLi="LastActivity";
Ua.p8f="RetryOverride";Ua.eCj="RequestGroups";Ua.requests="Requests";Ua.U7f="Responses";Ua.UCc="SessionDuration";Ua.status="Status";Ua.success="Success";Ua.successful="Successful";Ua.tokens="Tokens";Object(u.a)(Ua,"SessionExpirationStrings",null,[]);var Ca=a(112);class Ia{constructor(sa){this.Pp={};this.$Y={};this.XLg={};this.dAf=15;this.lje=!1;this.ENg=new Date;this.$Zb=new Date;this.Ce=sa;this.r2b=new Ca.a(2,2,6E4*this.dAf,Object(e.a)(this,this.Fxg,"writeMeasures"),135,"SL",!1);this.Ce.jg(this.r2b);
this.oui()}Fxg(){f.ULS.sendTraceTag(41964821,217,50,f.ULS.Zc({["Aggregate"]:this.$Y,["Current"]:this.Pp}))}oui(){this.$Y[Ua.eCj]=0;this.$Y[Ua.requests]=0;this.$Y[Ua.U7f]=0;this.$Y[Ua.status]=Ua.initialized;this.$Y[Ua.FTh]=new Date;this.$Y[Ua.UCc]=0;this.$Y[Ua.E3b]=0;this.$Y[Ua.UCc]=0;this.Pp[Ua.UCc]=0;this.$Y[Ua.E3b]=0;this.Pp[Ua.E3b]=0}Jtd(sa,Va){var nb=sa[Va];nb=nb?nb:0;nb++;sa[Va]=nb;this.bYd(sa)}bYd(sa){const Va=new Date;sa[Ua.E3b]=+Va-+this.$Zb;this.$Zb=Va;sa[Ua.UCc]=+this.$Zb-+this.ENg;sa[Ua.oLi]=
this.$Zb}y2(sa,Va){this.Pp[sa]=Va;this.bYd(this.Pp)}CXd(sa,Va){this.Pp[sa]=Va;this.bYd(this.Pp)}incrementCounter(sa){this.Jtd(this.Pp,sa);this.Jtd(this.$Y,sa);this.Jtd(this.XLg,sa)}flush(){this.lje||(this.$Y[Ua.status]=this.Pp[Ua.status],this.Fxg(this.r2b),this.Ce.Lpa(this.r2b,6E4*this.dAf))}stop(){f.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.lje=!0;this.Ce.Zp(this.r2b)}}Object(u.a)(Ia,"SessionLogger",null,[622]);var oa=a(103),Da=a(664),bb=a(586),
Za=a(384),Xa=a(178),Ba=a(985),Wa=a(184),Na=a(148);class ta{constructor(sa,Va,nb,ha=null,jb=!1,Fb=null,Rb=!1,mb=!1){this.Haa=0;this.l4=this.Jj=null;this.D2b=new ja.a;this.LH=new ja.a;this.ql=null;this.SZa=!1;this.Iqb=this.Jqb=null;this.Ce=sa;this.koe=Va;this.koe.execute(sb=>{sb.hl(Xa.a.Msd,Object(e.a)(this,this.q7i,"onHostResponseReceived"))});this.$H=nb;this.Nse=new Ba.a("WebServiceCall","TokenRefresh");this.Yk=ha||new Ia(sa);this.zNg=jb;this.HU=Fb?Fb:Da.SessionStatusManager.instance;this.Ree=Rb;
this.sYb=mb}q7i(sa){if(sa.MessageId!==Xa.a.Msd)Na.a(39408099,306,15,"Unexpected message.");else{var Va=new ja.a,nb=new ja.a;this.Yk.incrementCounter(Ua.U7f);var ha=sa.Values[Za.a.Kbg];if(!ha||0>=ha.length)Na.a(40122317,306,15,"Found no tokens in the dictionary"),ha=sa.Values;Na.a(40122318,306,100,"The Tokens array contains {0} tokens",ha.length);this.Yk.y2("Correlation",sa.CorrelationId);var jb="";for(let mb=0;mb<ha.length;mb++){this.Yk.CXd(Ua.tokens,ha.length);var Fb=ha[mb],Rb=Fb;if(!Rb||!Rb.Name)continue;
this.Yk.incrementCounter(Rb.Name);const sb=Fb;if(sb&&sb.Value)Na.a(39408128,306,100,"Received token with name: {0}",sb.Name),Va.add(sb),this.D2b.add(sb),this.sYb||this.Yk.y2(Ua.status,Ua.success),this.Ree&&this.HU&&this.HU.gDj();else if(Fb=this.Hdi(Fb),Na.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Rb.Name,JSON.stringify(Fb),this.l4),nb.add(Fb),this.sYb||(this.LH.add(Fb),jb=JSON.stringify(Fb),this.Yk.y2(Ua.error,JSON.stringify(Fb)),this.Yk.y2(Ua.status,
Ua.failed)),this.Ree)for(const Ya of Fb.Errors)Rb=this.b5h(Ya),this.HU&&this.HU.kVg(Rb)}this.sYb?(0<nb.count?this.Iqb?this.Iqb(new ya(Va,nb)):Na.a(512267295,306,15,"Received errors but the promise has completed"):this.Jqb?this.Jqb(new ya(Va,nb)):Na.a(512267294,306,15,"Received valid tokens but the promise has completed"),Na.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Va.count,nb.count,sa.CorrelationId,this.l4)):(0<nb.count&&""!==jb?(ha=
Object.assign(new Wa.a,{extendedProperties:new Map}),ha.extendedProperties.set("Errors",jb),ha.extendedProperties.set("RetryCount",this.Haa.toString()),ha.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),ha.extendedProperties.set("IsTokenExpiring",this.SZa.toString()),oa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ha)):oa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Na.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
Va.count,nb.count,sa.CorrelationId,this.l4),0<nb.count&&!this.SFb(nb)?(sa=this.$H.Adf(nb),sa!==this.$H.sgb&&(this.Yk.CXd(Ua.p8f,sa),this.Ce.Lpa(this.Jj,sa))):(this.Yk.flush(),this.Jj&&(Na.a(39408131,306,100,"Deleting task {0} from task manager",this.Jj.name),this.Ce.Zp(this.Jj)),this.ql&&!this.ql.task.isCompleted?this.ql.setResult(new ya(Va,nb)):Na.a(512267293,306,15,"Received results but the task has completed")))}}Hdi(sa){if(!sa)return null;const Va=Object.assign(new fa,{Name:sa.Name,Errors:[]});
for(const nb of sa.Errors)sa=new aa,sa.Id=nb.Id,sa.Details=bb.a.Y7a(nb.Details,500),Va.Errors.push(sa);return Va}requestTokensOnce(){this.c7f()}c7f(){c.AFrameworkApplication.e8("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Haa>=this.$H.FDf?(Na.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.l4),this.POe(this.ql,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(oa.Health.instance.recordKpiUsage("WACTokenRefresh",
1,"wwrelfc",null),this.Tag())}Tag(){const sa={};sa[Za.a.Kbg]=this.$H.tokens;const Va=F.a.create().toString();Na.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.$H.tokens),this.Haa+1,Va,this.l4);this.koe.execute(nb=>{nb.sendMessage(Xa.a.SAe,sa,Va)});this.Haa++;this.Yk.incrementCounter(Ua.requests)}POe(sa,Va,nb){const ha=new ja.a;for(let jb=0;jb<this.$H.tokens.length;jb++){const Fb=Object.assign(new fa,{Name:this.$H.tokens[jb],Errors:[Object.assign(new aa,
{Id:Va,Details:nb})]});ha.add(Fb);this.LH.add(Fb)}this.Ce.Zp(this.Jj);this.Yk.y2(Ua.cgd,JSON.stringify(this.LH));this.Yk.y2(Ua.status,Ua.failed);sa&&!sa.task.isCompleted&&sa.setResult(new ya(new ja.a,this.LH))}Usj(sa,Va=null){this.Nse.start();this.SZa=sa;this.l4=F.a.create().toString();Na.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.l4,this.SZa);this.Haa=0;this.LH.clear();this.D2b.clear();const nb=new za.a;this.ql=nb;Va&&Va.R(()=>{const ha=!!nb&&!nb.task.isCompleted;
Na.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.l4,this.SZa,ha);ha&&this.POe(nb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.sYb?this.d7f(this.$H.FDf).then(ha=>{this.ql&&!this.ql.task.isCompleted&&this.ql.setResult(ha);this.Iqb=this.Jqb=null;this.Yk.y2(Ua.cgd,JSON.stringify(this.LH));this.Yk.y2(Ua.status,Ua.success);this.Yk.flush()}).catch(ha=>{this.ql&&!this.ql.task.isCompleted&&this.ql.setResult(Object(ra.a)(588,
ha));this.Iqb=this.Jqb=null;this.Yk.y2(Ua.cgd,JSON.stringify(this.LH));this.Yk.y2(Ua.status,Ua.failed);this.Yk.flush()}):(this.Jj=new Ca.a(this.$H.priority,2,this.$H.sgb,Object(e.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Xa.a.SAe,!0),this.zNg&&this.c7f(),this.Ce.jg(this.Jj));return this.ql.task}d7f(sa){const Va=this,nb=new Promise((mb,sb)=>{Va.Jqb=mb;Va.Iqb=sb;oa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);Va.Tag()}),ha=this,jb=new Promise((mb,sb)=>{window.setTimeout(()=>
{sb(ha.VOe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},ha.$H.sgb)});let Fb=sa;const Rb=this;return new Promise((mb,sb)=>{Fb--;Promise.race([nb,jb]).then(Ya=>{oa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);mb(Ya)}).catch(Ya=>{var Ma=Rb.$H.sgb;if(Object(fb.a)(588,Ya)&&(Ya=Object(ra.a)(588,Ya),0<Ya.errors.count)){Rb.CPi(Ya.errors);Rb.gs(Ya.errors);if(Rb.SFb(Ya.errors)){sb(Ya);return}const xb=Rb.$H.Adf(Ya.errors);xb!==Rb.$H.sgb?(Rb.Yk.CXd(Ua.p8f,
xb),Ma=xb):Rb.PIi(Ya.errors)&&(Ma=0)}Fb?window.setTimeout(()=>{Rb.d7f(Fb).then(mb).catch(sb)},Ma):(Ma=Rb.VOe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Rb.gs(Ma.errors),sb(Ma),Na.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Rb.l4))})})}gs(sa){for(let Va of sa)this.LH.add(Va)}PIi(sa){if(!sa.count)return!1;sa=sa.ma(sa.count-1);return sa.Errors.length?"TIMEOUT"==sa.Errors[0].Id:!1}VOe(sa,Va){const nb=
new ja.a;for(let ha=0;ha<this.$H.tokens.length;ha++){const jb=this.Cnh(this.$H.tokens[ha],sa,Va);nb.add(jb)}return new ya(new ja.a,nb)}Cnh(sa,Va,nb){return Object.assign(new fa,{Name:sa,Errors:[Object.assign(new aa,{Id:Va,Details:nb})]})}CPi(sa){if(sa.count){sa=sa.ma(sa.count-1);sa=JSON.stringify(sa);var Va=Object.assign(new Wa.a,{extendedProperties:new Map});Va.extendedProperties.set("Errors",sa);Va.extendedProperties.set("RetryCount",this.Haa.toString());Va.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());Va.extendedProperties.set("IsTokenExpiring",this.SZa.toString());oa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Va);this.Yk.y2(Ua.error,sa);this.Yk.y2(Ua.status,Ua.failed)}}Pmj(sa){this.Nse.stop();const Va=this.tni(sa.result.errors);f.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!Va,this.l4,this.SZa,this.Haa,this.LH.count,0<sa.result.errors.count?sa.result.errors.ma(0).Name:"",0<sa.result.errors.count&&0<sa.result.errors.ma(0).Errors.length?sa.result.errors.ma(0).Errors[0].Id:"",0<sa.result.errors.count&&0<sa.result.errors.ma(0).Errors.length?sa.result.errors.ma(0).Errors[0].Details:"");return Va?!1:this.Omj(sa.result.tokens)}SFb(sa){return this.$H.SFb(sa)}Omj(sa){for(let Va=0;Va<sa.count;Va++){const nb=sa.ma(Va);if(nb.Name===Za.a.accessToken){const ha=(new Date).getTime();
nb.Expiry>c.AFrameworkApplication.accessTokenTtl?(f.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:nb.Expiry,["NowGetTime"]:ha,["BootTime"]:c.AFrameworkApplication.Fja},"PreviousAccessTokenTtl",c.AFrameworkApplication.accessTokenTtl),c.AFrameworkApplication.accessToken=nb.Value,c.AFrameworkApplication.accessTokenTtl=Math.floor(nb.Expiry),c.AFrameworkApplication.o9d=ha,c.AFrameworkApplication.K0a=Math.floor(nb.Expiry)):f.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:nb.Expiry,["NowGetTime"]:ha,["BootTime"]:c.AFrameworkApplication.Fja},"PreviousAccessTokenTtl",c.AFrameworkApplication.accessTokenTtl)}}return!0}tni(sa){let Va=!1;for(let nb=0;nb<sa.count;nb++){Va=!0;const ha=sa.ma(nb);f.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",ha.Name,JSON.stringify(ha.Errors),this.l4)}return Va}b5h(sa){let Va=d.a.TCc;sa=parseInt(sa.Id);if(isNaN(sa))Va=d.a.hlk;else{switch(sa){case 401:Va=d.a.klk;break;case 403:Va=
d.a.flk;break;case 500:Va=d.a.glk;break;case 503:Va=d.a.jlk}Va===d.a.TCc&&(Va=500<sa?d.a.ilk:d.a.elk)}return Va}}Object(u.a)(ta,"TokenRefreshManager",null,[589]);class V{constructor(){this.sgb=c.AFrameworkApplication.nlk;this.FDf=c.AFrameworkApplication.llk;this.tokens=c.AFrameworkApplication.Iii();this.priority=c.AFrameworkApplication.p9d;this.upe=this.DPj();this.e0c=c.AFrameworkApplication.Hii()}SFb(sa){sa=JSON.stringify(sa);if(this.e0c&&0<this.e0c.length)for(const Va of this.e0c)if(0<Va.length&&
0<=sa.indexOf(Va))return!0;return!1}Adf(sa){try{if(sa)for(let Va of sa)if(Va.Errors)for(const nb of Va.Errors)if(nb.Id in this.upe)return Number.parseInvariant(this.upe[nb.Id].toString())}catch(Va){f.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Va.toString())}return this.sgb}DPj(){const sa={};try{if(!c.AFrameworkApplication.gjc()||0>=c.AFrameworkApplication.gjc().length||""===c.AFrameworkApplication.gjc()[0])return sa;for(const Va of c.AFrameworkApplication.gjc())0<
Va.length&&(sa[Va]=c.AFrameworkApplication.mlk)}catch(Va){f.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Va.toString())}return sa}}Object(u.a)(V,"TokenRefreshPolicy",null,[590]);class ia extends b.a{constructor(sa){super();this.$=sa;this.kc()}create(){c.AFrameworkApplication.GS("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.ra("RefreshAccessTokenSilently")?this.Pb(this.Hnh()):
this.Pb(this.$.da.Ba(38)||this.$.da.Ja(38,new E(this.$)))}Hnh(){var sa=this.$.da.Ba(38);if(sa)return sa;sa=new ta(c.AFrameworkApplication.Mi,c.AFrameworkApplication.cS(),new V);return this.$.da.Ja(38,new Aa(this.$,sa))}static la(sa){sa.da.Ja(39,new ia(sa))}}Object(u.a)(ia,"AccessTokenExpirationManagerFactory",b.a,[]);var X=a(10);a.d(C,"a",function(){return la});const la=()=>{X.a.Fa(ia.la)}},1220:function(u,C,a){u=a(0);var c=a(229),b=a(30),f=a(2),e=a(15),d=a(6),h=a(1370),l=a(188);class k{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(u.a)(k,"TaskPaneGroupAppProps",null,[]);var n=a(31),v=a(1),x=a(42),w=a(221),r=a(19),t=a(7),A=a(272);class y{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(u.a)(y,"ExcelLegacyTaskPaneWacInfraProps",null,
[]);var z=a(303),E=a(259),G=a(21),F=a(13),O=a(18),M=a(141),P=a(12),B=a(20);class D{constructor(Ma){this.width=Ma}}Object(u.a)(D,"ActiveTaskPaneData",null,[]);var I=a(62);class S extends x.a{constructor(Ma,xb){super();this.isVisible=!1;this.x3d=this.Kga=-1;this.ASe=40;this.si=this.$P=this.animationManager=this.WOc=null;this.rJd=()=>{this.s7f()};this.jHc=new Set;this.jHc.add("FieldListTaskPane");this.jHc.add("PivotTableSettingsTaskPane");this.jHc.add("SlicerSettingsTaskPane");this.Jb=xb;A.a(this.$).Pi(this);
this.oB=Ma;this.Wbb=this.V7g();b.a.fk()||d.AFrameworkApplication.sa.Qa.Pf||(this.oB.style.bottom=this.$.$d&4?P.HelperMethods.Yc(this.$.Gga):"0");this.Dec={};this.CTb={};this.dae={};this.u3d=M.a.instance.He(this.Lc);this.u3d.la("focusin",this.rJd);this.cvi()}get $(){return this.Jb}get Wia(){return this.dae}get GN(){return this.WOc}get isCollapsed(){return!this.GN}dispose(){A.a(this.$).aB(this);const Ma=this.Dec;for(let xb in Ma)({key:xb,value:Ma[xb]}).value();this.CTb=this.dae=this.Dec=null;this.u3d.eE();
this.Wbb=this.oB=this.u3d=null;super.dispose()}Bxa(Ma,xb,qb,Ra,Jb,yb,Gb,ub,Ja=S.QMi,zb=S.PMi,na=null,Ea=null,ma=!1){const Ka=Object(f.a)(new y,{getContent:()=>Ma});Ka.isSharedRuntime=ma;return Object(f.a)(new h.a,{hideHeader:v.EwaSettings.isChangeGateEnabled("OfficeVSO:7858326_TaskPaneReactHeader")?!1:!0,contentProps:Ka,title:xb,width:qb,location:2,onOpen:Jb,onClose:yb,onShow:Gb,onHide:ub,iconUrl:na,iconId:Ea,enableResize:Ra,minResizeWidth:Ja,maxResizeWidth:zb})}T8(Ma,xb){l.UISurfaces.dk().then(qb=>
{Ma in this.Wia?qb.setSelectedTaskPane(Ma):qb.showTaskPane(Ma,xb);return null})}fac(Ma,xb){l.UISurfaces.dk().then(qb=>{qb.initializeHiddenSharedRuntimeTaskPane(Ma,xb);const Ra=this.$.domElement;Ra.addEventListener("scroll",function yb(){0!=Ra.scrollLeft&&(Ra.scrollLeft=0,Ra.removeEventListener("scroll",yb))})})}updateTaskPane(Ma,xb){l.UISurfaces.dk().then(qb=>{qb.updateTaskPane(Ma,xb);return null})}setSelectedTaskPane(Ma){l.UISurfaces.dk().then(xb=>{xb.setSelectedTaskPane(Ma);return null})}hideTaskPane(Ma){l.UISurfaces.dk().then(xb=>
{xb.hideTaskPane(Ma,S.Z4j);return null})}get Lc(){return this.oB}get sg(){return this.isVisible}get Ge(){return E.a.hHc}Qg(Ma,xb){return xb?!1:(this.Eag(),!0)}hi(Ma){return F.DOMElementExtensions.lg(this.Lc,Ma)}ek(){this.$.frame.vf.Wk(this.Ge)}Gk(){}V7g(){const Ma=document.createElement(w.a.div);Ma.style.height="0px";Ma.style.width="0px";Ma.tabIndex=-1;return Ma}FZh(){var Ma=F.DOMElementExtensions.getElementById(this.oB,"tabStripFocusZone");if(Ma){Ma=Ma.getElementsByTagName("button");for(let xb=0;xb<
Ma.length;xb++)if(Boolean.parse(Ma[xb].getAttribute("aria-selected")))return Ma[xb].getAttribute("aria-controls")}return null}Xhh(Ma){return(Ma=window.getComputedStyle(Ma,null).getPropertyValue("transition-duration"))?parseInt(Ma.endsWith("ms")?parseFloat(Ma):1E3*parseFloat(Ma),10):0}Ctj(){const Ma=document.getElementById("tabbedTaskPaneContainer");Ma&&Ma.addEventListener("transitionend",()=>this.gKa(-1))}cvi(){l.UISurfaces.dk().then(Ma=>{let xb=new k;xb.middleContainer=this.Wbb;xb.onOpen=(qb,Ra)=>
{this.isVisible=!0;-1===this.Kga&&(this.Kga=this.Xhh(Ra));b.a.fk()||(this.Wia[qb]=new D(F.DOMElementExtensions.mR(F.DOMElementExtensions.getElementById(Ra,S.kng))))};xb.onClose=qb=>{this.isVisible=0<Ma.selectors.getTabbedTaskPaneCount();e.ULS.sendTraceTag(537014371,0,50,`Closing of ${qb} TaskPane`);if(!this.isVisible)this.m5e(),b.a.fk()||d.AFrameworkApplication.sa.Qa.Pf||window.requestAnimationFrame(()=>{this.d5b(this.Wbb)});else if(!b.a.fk()&&this.GN&&this.GN!==qb){const Ra=1<Ma.selectors.getTabbedTaskPaneCount()?
this.Jic():0,Jb=1===Ma.selectors.getTabbedTaskPaneCount()?-1*this.Jic():0;this.rze(qb,this.GN,Ra,Jb)}b.a.fk()?this.gKa(this.Kga):(d.AFrameworkApplication.sa.Qa.Pf&&0>=this.Kga&&this.gKa(this.Kga),delete this.Wia[qb]);delete this.CTb[qb]};xb.onShow=(qb,Ra)=>{null!=this.Li&&(this.Li.stop(),this.Li=null);this.WOc=qb;this.s7f();1!==Ra&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.MFj()},0)});b.a.fk()?window.requestAnimationFrame(()=>{this.gKa(this.Kga)}):d.AFrameworkApplication.sa.Qa.Pf&&
0>=this.Kga?window.requestAnimationFrame(()=>{this.gKa(this.Kga)}):window.requestAnimationFrame(()=>{this.iHj(this.Wbb,this.Kga)})};xb.onHide=(qb,Ra,Jb)=>{const yb=this.FZh();yb!==qb&&(this.Li=this.$.nc.qd("UserAction","TaskPaneToggle"),e.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${qb} to ${yb}`));Jb?b.a.fk()||this.d5b(this.Wbb):!b.a.fk()&&yb&&(qb=1===Object.keys(this.Wia).length?this.Jic():0,this.rze(this.GN,yb,this.Jic(),qb));this.WOc=null;Jb&&1!==Ra&&this.m5e();b.a.fk()&&window.requestAnimationFrame(()=>
{this.gKa(this.Kga)})};xb.setFocusCallback=(qb,Ra)=>{Ra&&(this.CTb[qb]=Ra)};xb.onResizeStart=()=>{b.a.fk()||this.i3c(P.HelperMethods.Yc(0))};xb.onResizeEnd=()=>{b.a.fk()?this.gKa():(this.d5b(this.Wbb),this.Wia[this.GN]=this.Fpd(this.GN));e.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.GN} TaskPane`)};Ma.renderTaskPaneGroups(null,this.oB,xb);d.AFrameworkApplication.sa.Qa.Pf&&!b.a.fk()&&this.Ctj();return null})}d5b(Ma){this.i3c(this.$.isChromeRtl?Ma.style.left:Ma.style.right)}i3c(Ma){e.ULS.sendTraceTag(537014368,
0,50,`Grid adjust is triggered for taskPane ${this.GN}`);this.$.FCj(Ma)}gKa(Ma=0){-1<Ma?I.Task.delay(Ma+this.ASe).continueWith(()=>{this.$.sCa(z.a.p0("ResetContentAreaMargin"))}):this.$.sCa(z.a.p0("ResetContentAreaMargin"))}rze(Ma,xb,qb,Ra){xb=xb.endsWith(S.v3d)?xb.substring(0,xb.length-S.v3d.length):xb;xb=this.$ff(xb);Ra=xb+Ra;Ma=this.$ff(Ma);Ra<Ma&&this.i3c(P.HelperMethods.Yc(xb+qb))}iHj(Ma,xb){window.setTimeout(()=>{this.d5b(Ma)},xb+this.ASe)}Jic(){return-1!==this.x3d?this.x3d:this.x3d=F.DOMElementExtensions.mR(F.DOMElementExtensions.getElementById(this.oB,
"tabStripFocusZone"))}Fpd(Ma){return F.DOMElementExtensions.mR(F.DOMElementExtensions.getElementById(F.DOMElementExtensions.getElementById(this.oB,Ma+S.v3d),S.kng))}$ff(Ma){if(Ma in this.Wia){const xb=this.Wia[Ma].width;return 0<xb?xb:this.Fpd(Ma)}return Ma?this.Fpd(Ma):0}m5e(){B.h(this.$).setFocus()}MFj(){if(this.CTb[this.GN]){const Ma=this.CTb[this.GN];Ma&&Ma(null,null)}else this.jHc.has(this.GN)||this.Eag()}Eag(){l.UISurfaces.dk().then(Ma=>{1<Ma.selectors.getTabbedTaskPaneCount()?Ma.focusTabbedTaskPaneArea():
(Ma=F.DOMElementExtensions.getElementById(this.Lc,"AgaveTaskpaneCloseButtonId"))?Ma.focus():(Ma=F.DOMElementExtensions.nm(this.Lc.querySelectorAll("button")))&&Ma.focus();return null})}s7f(){this.$.domElement.scrollLeft=0;n.a.jQa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}LF(Ma){this.addHandler(S.xkb,Ma)}eH(Ma){this.removeHandler(S.xkb,Ma)}get YP(){return this.oB}get gF(){e.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");
return null}qwb(Ma,xb,qb,Ra,Jb){let yb=Ma.Ba(xb);yb||(yb=O.a(G.a,qb,Ma,xb),yb.SetScriptLoadFlavor(Jb));Ra&&yb.d2c(Ra);const Gb=""+xb;let ub=null;const Ja=()=>{yb.create();ub()};this.Dec[Gb]=ub=()=>{yb.Qzc(Ja);delete this.Dec[Gb]};yb.t4b(Ja)}initialize(){e.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}pig(){}kS(){e.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}JJ(){e.ULS.shipAssertTag(537151109,
11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}axe(){e.ULS.shipAssertTag(537151108,11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}R6f(){e.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}d8a(){e.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}vld(){e.ULS.shipAssertTag(537151105,11,!1,
"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}fla(){e.ULS.shipAssertTag(537151104,11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}fD(){e.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){e.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}RXd(){e.ULS.shipAssertTag(537151069,
11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(Ma){const xb=S.S8g(Ma.fc,Ma.isChromeRtl);S.y3g(Ma,xb);return new S(xb,Ma)}static S8g(Ma,xb){const qb=document.createElement("div");qb.id=Ma+t.a.iHc;b.a.fk()?qb.classList.add(r.a.vkk):(qb.classList.add(xb?r.a.xkk:r.a.wkk),d.AFrameworkApplication.sa.Qa.Pf&&qb.classList.add(r.a.DCa));return qb}static y3g(Ma,xb){Ma.isMobileMode&&xb.setAttribute("aria-hidden","true");if(d.AFrameworkApplication.sa.Qa.Pf){let qb;
(qb=document.getElementById("FarPaneRegion"))?qb.appendChild(xb):e.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else v.EwaSettings.isChangeGateEnabled("OfficeVSO:7643983_GridLayoutRemoval")||b.a.fk()&&xb.classList.add(r.a.NFh),document.getElementById(Ma.fc+t.a.I3a).insertBefore(xb,Ma.VDa)}}S.QMi=300;S.PMi=950;S.Z4j=2;S.v3d="-panel";S.kng="ExcelTaskPaneContentWrapper";S.Gjg="rtpSizeChanged";S.oLe="rtpCollapsed";
S.wUf="rtpAdded";S.xkb="rtpVisibility";Object(u.a)(S,"ReactTaskPaneManager",x.a,[486,29,2]);var J=a(102),L=a(168),R=a(14),Y=a(248),Q=a(113),W=a(92),Ga=a(425),pa=a(231),aa=a(88),Z=a(126),fa=a(101),ya=a(764),Aa=a(568),ja=a(54),za=a(16);class ra extends Sys.EventArgs{constructor(){super()}}Object(u.a)(ra,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var fb=a(50),Ua=a(90),Ca=a(247);const Ia=ya.a.KIh,oa=ya.a.MIh,Da=`<span class='${r.a.a9b} ${ya.a.NIh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;
class bb extends Ca.a{constructor(Ma){super(document.createElement("a"));this.Ra=new x.a;this.oc=this.sse=null;this.Gd=()=>{this.enabled&&this.Ra.raiseEvent("tpButtonClicked",null,this);return!0};this.oc=Ma}VVg(Ma){this.Ra.addHandler("tpButtonClicked",Ma)}a4f(Ma){this.Ra.removeHandler("tpButtonClicked",Ma)}get V2a(){return this.domElement}get taskPane(){return this.sse}get enabled(){return super.enabled}set enabled(Ma){Ma!==super.enabled&&(this.domElement.classList.toggle(ya.a.zV),this.domElement.classList.toggle(oa),
this.domElement.tabIndex=Ma?0:-1,super.enabled=Ma)}get hq(){return this.domElement.firstChild.firstChild}dispose(){W.a.Rc([this.Ra]);this.Ra=null;this.domElement&&fb.a.zpa(this.domElement);super.dispose()}bvi(Ma){const xb=6===Ma.yi;var qb=xb&&!Ma.vl;qb=String.format(Da,Ma.iS,Ma.vl,qb?ja.a.current.Lo(103):ja.a.dg(10),ya.a.xka,qb?String.format('style="width:24px;{0}:0px"',"left"):"");this.oc.Oh(this.domElement,qb);this.domElement.classList.add(Ia);this.domElement.classList.add(oa);this.domElement.title=
Ma.iS;this.domElement.tabIndex=0;F.DOMElementExtensions.py(this.domElement,t.a.qu,null,null);this.sse=Ma;xb&&(Ma=this.taskPane,null===Ma||void 0===Ma?void 0:Ma.Ssg());pa.a.instance.ta(R.a.click,this.domElement,this.Gd);Q.KeyInputManager.instance.Tu(this.domElement,this.Gd,Ua.a.Ai)}}Object(u.a)(bb,"TaskPaneButton",Ca.a,[550]);class Za extends fa.a{constructor(Ma,xb,qb,Ra){super(Ma);this.animationManager=this.W7=this.wf=null;this.XM=this.sYa=!1;this.nde=0;this.Jb=null;this.YSc=!1;this.oc=null;this.UA=
()=>{this.MCi||(this.fD(),this.$.Wf())};this.CId=(Jb,yb)=>{this.onButtonClick(Jb,yb)};this.t8=()=>{this.bJc()};this.$=xb;this.oc=Ra;A.a(this.$).Pi(this);this.$.Zb.Lg(this.t8);this.configuration=qb;this.baseName=P.HelperMethods.dya(this.domElement,this.configuration.nng||this.configuration.O2);this.Cec={};this.Hib=[];this.lv=[];this.mub={};this.tse=document.getElementById(this.baseName+this.configuration.t3d);this.YP||e.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+
this.configuration.t3d} not found`);this.ePg=document.getElementById(this.baseName+this.configuration.O2);this.oB||e.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.O2} not found`);this.fPg=document.getElementById(this.baseName+this.configuration.A4d);this.$P||e.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.A4d} not found`);Ma=String.format(Za.$4j,this.baseName+this.configuration.cpg,
this.baseName+Za.BTb);this.oc.Oh(this.$P,Ma);this.Abe=document.getElementById(this.baseName+Za.BTb);this.VFe||e.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Za.BTb} not found`);(this.lub=document.getElementById(this.baseName+Za.BTb))||e.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Za.BTb} not found`);this.vEg=this.lPe(this.configuration.mLe,this.jLe);this.uEg=this.DOe(this.configuration.kLe,za.a.instance.ha(1297),
this.Rii,this.P3a,!0);this.tGg=this.lPe(this.configuration.q2e,this.MPh);this.sGg=this.DOe(this.configuration.o2e,za.a.instance.ha(1296),this.Sii,this.DMa,!1);F.DOMElementExtensions.setVisible(this.DMa,!1);pa.a.instance.ta(R.a.click,this.O3a,Object(aa.a)(this,this.cuc,"onCollapseIconClicked"));pa.a.instance.ta(R.a.click,this.CMa,Object(aa.a)(this,this.uuc,"onExpandIconClicked"));pa.a.instance.ta(R.a.click,this.P3a,Object(aa.a)(this,this.cuc,"onCollapseIconClicked"));pa.a.instance.ta(R.a.click,this.DMa,
Object(aa.a)(this,this.uuc,"onExpandIconClicked"));Q.KeyInputManager.instance.ta(R.a.yc,this.O3a,Object(aa.a)(this,this.AJf,"onCollapseIconKeyDown"));Q.KeyInputManager.instance.ta(R.a.yc,this.CMa,Object(aa.a)(this,this.iLf,"onExpandIconKeyDown"))}LF(Ma){this.addHandler(Za.xkb,Ma);Ma(this,new ra(this.isVisible,F.DOMElementExtensions.isVisible(this.$P)))}eH(Ma){this.removeHandler(Za.xkb,Ma)}get $P(){return this.fPg}get Lc(){return this.$P}get sg(){return this.sYa}set sg(Ma){this.sYa=Ma}get oB(){return this.ePg}get Ge(){return E.a.FZi}get YP(){return this.tse}get gF(){return this.lv}get si(){return this.wf}get GN(){return null}get Wia(){return null}get isCollapsed(){return this.XM}get bcd(){return this.nde}get $(){return this.Jb}set $(Ma){this.Jb=
Ma}get VFe(){return this.Abe}get O3a(){return this.uEg}get CMa(){return this.sGg}get P3a(){return this.vEg}get DMa(){return this.tGg}get MCi(){return this.YSc}get Sii(){return this.configuration.lLe}get Rii(){return this.configuration.p2e}qwb(Ma,xb,qb,Ra,Jb){let yb=Ma.Ba(xb);yb||(yb=O.a(G.a,qb,Ma,xb),yb.SetScriptLoadFlavor(Jb));Ra&&yb.d2c(Ra);const Gb=""+xb;Gb in this.Cec||yb.O4b((zb,na)=>{this.H8(na)});let ub=null;const Ja=()=>{yb.create();ub()};this.Cec[Gb]=ub=()=>{yb.Qzc(Ja);delete this.Cec[Gb]};
yb.t4b(Ja)}dispose(){if(this.lv)for(let xb=0,qb=this.lv.length;xb<qb;xb++)this.lv[xb].a4f(this.CId),this.lv[xb].dispose();const Ma=this.Cec;for(let xb in Ma)({key:xb,value:Ma[xb]}).value();this.$.ea&&this.$.Zb&&this.$.Zb.ih(this.t8);this.lub=this.Abe=this.tse=this.wf=this.mub=this.Hib=this.lv=null;pa.a.instance.Aa(R.a.click,this.O3a,Object(aa.a)(this,this.cuc,"onCollapseIconClicked"));pa.a.instance.Aa(R.a.click,this.CMa,Object(aa.a)(this,this.uuc,"onExpandIconClicked"));pa.a.instance.Aa(R.a.click,
this.P3a,Object(aa.a)(this,this.cuc,"onCollapseIconClicked"));pa.a.instance.Aa(R.a.click,this.DMa,Object(aa.a)(this,this.uuc,"onExpandIconClicked"));Q.KeyInputManager.instance.Aa(R.a.yc,this.O3a,Object(aa.a)(this,this.AJf,"onCollapseIconKeyDown"));Q.KeyInputManager.instance.Aa(R.a.yc,this.CMa,Object(aa.a)(this,this.iLf,"onExpandIconKeyDown"));super.dispose()}Qg(Ma,xb){if(xb)return!1;this.wf&&!this.isCollapsed?(Ma=this.si.taskPane,Ma.sg&&Ma.Qg(!0,!1)||F.DOMElementExtensions.setFocus(this.si.V2a)):
F.DOMElementExtensions.setFocus(this.CMa);return!0}hi(Ma){return this.isVisible?F.DOMElementExtensions.lg(this.domElement,Ma)||F.DOMElementExtensions.lg(this.domElement,F.DOMElementExtensions.cBb(Ma)):!1}ek(){}Gk(){this.wf&&this.wf.taskPane.Gk()}setFocusOnToolbarFirstElement(){this.isCollapsed?F.DOMElementExtensions.setFocus(this.CMa):F.DOMElementExtensions.setFocus(this.O3a)}RXd(){for(let Ma=this.lv.length-1;0<=Ma;Ma--)if(this.lv[Ma].isVisible){F.DOMElementExtensions.setFocus(this.lv[Ma].V2a);return}this.setFocusOnToolbarFirstElement()}d8a(Ma){const xb=
[];for(let qb=this.lv.length-1;0<=qb;qb--)this.lv[qb].taskPane.yi===Ma&&xb.push(this.lv[qb].taskPane);return xb}vld(Ma){const xb=[];for(let qb=0;qb<this.lv.length;qb++)this.lv[qb].taskPane.yi===Ma&&xb.push(this.lv[qb]);return xb}axe(Ma){if(Ma){let xb;const qb=Object(Z.a)(457,Ma);qb?(xb=new bb(this.oc),xb.domElement.id=this.baseName+"bt_"+Ma.yi.toString()+"_"+Ma.Nf.InstanceId,this.lub.appendChild(xb.domElement),this.mub["6"]=xb,qb.button=xb):xb=this.mub[Ma.yi.toString()];xb.bvi(Ma);xb.VVg(this.CId);
xb.isVisible=Ma.Jr();xb.enabled=Ma.Mu();this.Hib.push(Ma);this.lv.push(xb);Za.RWi(Ma,this.YP);this.GDh(xb);this.bJc()}}JJ(Ma,xb){let qb;for(const Ra of this.lv)qb=Ra.taskPane,qb.yi===Ma.yi&&qb==Ma&&this.s8b(Ra,xb)}Bxa(){e.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}T8(){e.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}fac(){e.ULS.shipAssertTag(512291712,11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){e.ULS.shipAssertTag(512291683,
11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){e.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){e.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}pig(Ma,xb){Ma?(this.YSc=!0,this.HYd(!1)):(this.YSc=!1,this.HYd(!0),xb&&(this.fD(),this.$.Wf()))}kS(Ma){if(!this.Hib.includes(Ma)){let qb=null;qb=()=>{this.Lwj(Ma);Ma.$X(qb)};
Ma.YU(qb);this.axe(Ma);var xb=Object(Z.a)(540,Ma);xb&&(xb.LF(this.UA),this.UA(xb,Sys.EventArgs.Empty));if(xb=Object(Z.a)(157,Ma))xb.LF(this.UA),this.UA(xb,Sys.EventArgs.Empty);if(xb=Object(Z.a)(541,Ma))xb.LF(this.UA),this.UA(xb,Sys.EventArgs.Empty);this.raiseEvent(Za.wUf,null,Ma);this.fD()}}s8b(Ma,xb){if(Ma.taskPane.Mu()&&Ma.taskPane.Jr()){if(this.wf){this.wf.domElement.classList.remove(Za.irb);this.wf.taskPane.isVisible=!1;if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const qb=
Object(Z.a)(457,this.wf.taskPane);qb&&qb.mk.PRd(qb.Nf.InstanceId)}this.W7=this.wf}this.wf=Ma;this.wf.taskPane.isVisible=!0;this.wf.domElement.classList.add(Za.irb);xb&&this.fla(!1,!1);this.dkb()}}onButtonClick(Ma){let xb=!1;if(this.wf!==Ma){xb=!0;const qb=Ma.taskPane.Lc;this.animationManager.flj(qb);if(this.wf){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Ra=Object(Z.a)(457,this.wf.taskPane);Ra&&Ra.mk.PRd(Ra.Nf.InstanceId)}this.wf.taskPane.isVisible=!1;this.wf.domElement.classList.remove(Za.irb)}this.W7=
this.wf;this.wf=Ma;this.wf.domElement.classList.add(Za.irb);this.wf.taskPane.isVisible=!0;this.dkb();this.animationManager.FPh(qb)}this.fla(!(this.isCollapsed||xb),!1)}dkb(){const Ma=this.bcd;let xb=0;this.wf&&(xb=this.wf.taskPane.dx?this.wf.taskPane.dx:this.wf.taskPane.Wq);xb!==Ma&&(this.nde=xb,this.isCollapsed||(this.animationManager&&this.wf?this.animationManager.y5b(this.oB,Ma,xb,this.si.taskPane):this.oB.style.width=P.HelperMethods.Yc(xb)),this.fUa(),this.raiseEvent(Za.Gjg,null,this))}EN(Ma){const xb=
new bb(this.oc);xb.isVisible=!1;xb.domElement.id=this.baseName+"bt_"+Ma.toString();this.lub.appendChild(xb.domElement);this.mub[Ma.toString()]=xb}bJc(){if(void 0!==this.lv&&null!==this.lv){void 0===this.wf||null===this.wf||this.wf.taskPane.Mu()||(this.wf.domElement.classList.remove(Za.irb),this.wf.taskPane.isVisible=!1,this.wf.taskPane.Jr()&&(this.W7=this.wf),this.wf=null);var Ma=null;for(let xb=0;xb<this.lv.length;xb++)if(this.Hib[xb].Jr()){const qb=this.Hib[xb].Mu();(this.lv[xb].enabled=qb)&&!Ma&&
(Ma=this.lv[xb])}void 0!==this.wf&&null!==this.wf||!Ma||(void 0!==this.W7&&null!==this.W7&&this.W7.taskPane.Mu()&&this.W7.taskPane.Jr()?this.s8b(this.W7,!1):this.s8b(Ma,!1));void 0!==Aa.a(this.$)&&null!==Aa.a(this.$)&&Aa.a(this.$).isVisible&&void 0!==this.wf&&null!==this.wf&&1!==this.wf.taskPane.yi&&(Aa.a(this.$).isVisible=!1);void 0!==this.wf&&null!==this.wf&&7!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(52),null===Ma||void 0===Ma?0:Ma.isVisible)&&(Ma.isVisible=!1);void 0!==this.wf&&null!==this.wf&&
8!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(233))&&(Ma.isVisible=!1);void 0!==this.wf&&null!==this.wf&&9!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(248))&&(Ma.isVisible=!1);v.EwaSettings.ya(264)&&void 0!==this.wf&&null!==this.wf&&12!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(302))&&(Ma.isVisible=!1);v.EwaSettings.ya(418)&&void 0!==this.wf&&null!==this.wf&&15!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(365))&&(Ma.isVisible=!1);b.a.rAd(this.$)&&void 0!==this.wf&&null!==this.wf&&13!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(334))&&
(Ma.isVisible=!1);void 0!==this.wf&&null!==this.wf&&14!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(346))&&(Ma.isVisible=!1);void 0!==this.wf&&null!==this.wf&&16!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(371))&&(Ma.isVisible=!1);void 0!==this.wf&&null!==this.wf&&17!==this.wf.taskPane.yi&&(Ma=this.$.da.Ba(408))&&(Ma.isVisible=!1);this.dkb()}}qSh(Ma,xb){F.DOMElementExtensions.setVisible(this.P3a,!Ma);F.DOMElementExtensions.setVisible(this.DMa,Ma);Ma&&this.raiseEvent(Za.oLe,null,this);this.dkb();xb&&F.DOMElementExtensions.setFocus(Ma?
this.CMa:this.O3a)}Gjc(Ma,xb){this.$.xd(Ma,xb,26,null)}H8(Ma){Ma.IP&&this.kS(Ma.IP)}Lwj(Ma){if(Ma){const xb=this.lv.length;let qb=!1;for(let Ra=0;Ra<xb;Ra++){const Jb=this.lv[Ra];if(Jb.taskPane===Ma){this.lub.removeChild(Jb.V2a);delete this.mub[Ma.yi.toString()];Array.remove(this.Hib,Ma);Array.remove(this.lv,Jb);Jb.a4f(this.CId);Jb.taskPane.Lc.parentNode.removeChild(Jb.taskPane.Lc);this.wf&&this.wf.taskPane===Jb.taskPane&&(this.wf=null);this.W7&&this.W7.taskPane===Jb.taskPane&&(this.W7=null);qb=!0;
break}}qb&&this.bJc()}}GDh(Ma){const xb=Ma.taskPane.yi,qb=!!this.wf&&1===this.wf.taskPane.yi;(1===xb||!qb&&2===xb)&&this.s8b(Ma,!1)}static RWi(Ma,xb){const qb=Ma.Lc;qb.parentNode&&qb.parentNode.removeChild(qb);xb.appendChild(qb);Ma.isVisible=!1}DOe(Ma,xb,qb,Ra,Jb){const yb=document.createElement("a");yb.setAttribute(t.a.dV,Jb?t.a.$k:t.a.ns);yb.setAttribute(t.a.fe,t.a.qu);yb.tabIndex=0;yb.classList.add(r.a.VB);yb.classList.add(Ma);yb.classList.add(ya.a.JIh);Ma=String.format(Za.Idh,xb,qb,ja.a.dg(10));
this.oc.Oh(yb,Ma);Ra.appendChild(yb);return yb}}Za.xkb="tpVisibility";Za.$4j=`<div id='{0}' class='${ya.a.PIh}'><div id='{1}' class='${ya.a.OIh}'></div></div>`;Za.Idh="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Za.BTb="novTaskpaneButtonGroup";Za.irb=ya.a.LIh;Za.Gjg="tpSizeChanged";Za.oLe="tpCollapsed";Za.wUf="tpAdded";Object(u.a)(Za,"TaskPaneControl",fa.a,[486,29,2]);var Xa=a(53),Ba=a(456),Wa=a(738);class Na{constructor(){this.p2e=this.lLe=this.o2e=this.kLe=this.q2e=this.mLe=this.cpg=this.A4d=
this.t3d=this.O2=this.nng=null}}Object(u.a)(Na,"Configuration",null,[]);a(437);fa=a(306);class ta extends fa.a{constructor(Ma){super(5,Ma)}}Object(u.a)(ta,"ResizeAnimationEvent",fa.a,[]);var V=a(482),ia=a(601),X=a(104);class la{constructor(Ma,xb){this.ong=null;this.$=xb;this.taskPane=Ma}vPh(){this.ong=F.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.fc+t.a.KHd);const Ma=la.Dbd(this.taskPane),xb=la.Dbd(this.ong),qb=ia.a(X.a.rm);qb.animate(Ma,t.a.eEc);qb.animate(xb,t.a.eEc)}flj(Ma){Ma.style.opacity=
"0"}FPh(Ma){ia.a(X.a.rm).animate(la.Dbd(Ma),t.a.eEc)}y5b(Ma,xb,qb,Ra){xb||(Ra.isVisible=!0);this.$.fUa(qb);ia.a(X.a.rm).animate(la.Vqh(Ma,xb,qb),t.a.eEc,null,null,()=>{this.$.UCa();qb||1===Ra.yi||(Ra.isVisible=!1);Ra.zX(qb<xb)})}static Vqh(Ma,xb,qb){Ma=new ta(Ma);Ma.p0g(xb,qb);return Ma}static Dbd(Ma){Ma=new V.a(Ma);Ma.nN(0,1);return Ma}}Object(u.a)(la,"TaskPaneAnimationManager",null,[511]);const sa=`<div id="{0}" class="${ya.a.TIh}" runat="server"></div></div><div id="{1}" class="${ya.a.SIh} ${ya.a.Eu}" runat="server"></div>`,
Va=`<button type="button" id="{0}" class="${ya.a.QIh}"></button><span><div id="{1}" class="${ya.a.RIh}"></div></span>`,nb=ya.a.DIh;class ha extends Za{constructor(Ma,xb,qb,Ra){super(Ma,qb,ha.Pmh(),Ra);this.Fwc=null;this.Lzd=!1;this.HT=null;this.c$i=Jb=>{var yb=!1;if(9===Jb.Da.keyCode){yb=this.si.taskPane.EW(Jb,this.$P);if(!yb){yb=this.$.da.Ba(52);var Gb=this.domElement.querySelectorAll(this.si.taskPane===yb?yb.Er:Ba.a.agj);yb=F.DOMElementExtensions.nm(Gb);Gb=F.DOMElementExtensions.iC(Gb);yb=F.DOMElementExtensions.vDa(Jb.Da,
yb,Gb)}return yb}Gb=J.FocusManager.instance().Ni;if(null===Gb||void 0===Gb?0:Gb.yO)return yb;27===Jb.Da.keyCode&&this.si.taskPane.Dh(!1);return yb};this.Td=()=>{this.$P.style.bottom=this.oB.style.bottom=this.$.$d&4&&!d.AFrameworkApplication.sa.Qa.Pf?P.HelperMethods.Yc(this.$.Gga):"0";this.fD()};this.$Pf=Jb=>{Object(Ga.a)(457,this.si.taskPane)&&(this.si.taskPane.pJa.firstChild.style[t.a.pointerEvents]="none");this.Lzd=!0;this.HT=this.qBb(Jb.clientPoint);L.a.instance.ta(R.a.Zg,this.domElement.ownerDocument.body,
this.yvc);L.a.instance.ta(R.a.$e,this.domElement.ownerDocument.body,this.zvc);Y.a.instance.ta(R.a.Tk,this.domElement.ownerDocument.body,this.yvc);Y.a.instance.ta(R.a.Pg,this.domElement.ownerDocument.body,this.zvc);return!0};this.zvc=()=>{Object(Ga.a)(457,this.si.taskPane)&&(this.si.taskPane.pJa.firstChild.style[t.a.pointerEvents]="");this.Lzd=!1;L.a.instance.Aa(R.a.Zg,this.domElement.ownerDocument.body,this.yvc);L.a.instance.Aa(R.a.$e,this.domElement.ownerDocument.body,this.zvc);Y.a.instance.Aa(R.a.Tk,
this.domElement.ownerDocument.body,this.yvc);Y.a.instance.Aa(R.a.Pg,this.domElement.ownerDocument.body,this.zvc);return!0};this.yvc=Jb=>{this.Lzd&&(Jb=this.qBb(Jb.clientPoint),Jb=Wa.a.fF(Jb,this.HT),this.sAe(Jb.x));return!0};this.laj=Jb=>{void 0!==Jb.Da&&null!==Jb.Da&&(9===Jb.Da.keyCode?Jb.Da.shiftKey?(Jb=Object(Ga.a)(29,this.si.taskPane)?this.si.taskPane:null)&&Jb.Qg(!1,!1):this.setFocusOnToolbarFirstElement():37!==Jb.Da.keyCode&&39!==Jb.Da.keyCode||this.sAe(37===Jb.Da.keyCode?-20:20));return!0};
this.$.domElement.classList.add(nb);this.lng=xb;this.initialize();Q.KeyInputManager.instance.ta(R.a.yc,this.domElement,this.c$i);this.DTb=F.DOMElementExtensions.getElementById(xb.parentNode,this.$.fc+t.a.xtc);this.lHc=F.DOMElementExtensions.getElementById(xb.parentNode,this.$.fc+t.a.FGf);this.DTb.title=za.a.instance.ha(2233);L.a.instance.ta(R.a.Yf,this.lHc,this.$Pf);Y.a.instance.ta(R.a.pointerDown,this.lHc,this.$Pf);Q.KeyInputManager.instance.ta(R.a.yc,this.DTb,this.laj)}get Ge(){return E.a.hHc}get jLe(){return this.$P}get MPh(){return this.jLe}dkb(){super.dkb();
this.DTb&&(this.si&&this.si.taskPane.isResizable?(this.DTb.style.display="block",this.lHc.style.display="block"):(this.DTb.style.display="none",this.lHc.style.display="none"))}get XHc(){const Ma=this.$P;return Ma&&F.DOMElementExtensions.isVisible(Ma)?Ba.a.XHc:0}R6f(Ma){Ma&&(this.animationManager=Ma);this.YBj();this.animationManager=Ma||new la(this.oB,this.$);this.animationManager.vPh()}dispose(){this.Fwc&&this.Fwc.eH(this.UA);Aa.a(this.$)&&Aa.a(this.$).eH(this.UA);const Ma=this.$.da.Ba(52);Ma&&Ma.eH(this.UA);
this.$.Rm(this.Td);W.a.Rc([this.Fwc]);this.Fwc=null;super.dispose()}initialize(){this.R6f(null);this.EN(0);this.EN(1);this.EN(2);this.EN(7);this.EN(8);this.EN(9);this.EN(10);this.EN(17);v.EwaSettings.ya(264)&&this.EN(12);v.EwaSettings.ya(418)&&this.EN(15);v.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.EN(13):b.a.rAd(this.$)&&this.EN(13);this.EN(14);this.EN(16);v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.EN(18);this.fD()}fD(){var Ma=0;let xb=0;for(let qb=this.gF.length-1;0<=qb;qb--){const Ra=this.gF[qb].taskPane.Jr(),Jb=this.gF[qb].taskPane;if(this.gF[qb].isVisible=Ra)xb++,(1!==Jb.yi&&(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Jb.yi)&&14!==Jb.yi&&16!==Jb.yi||Jb.Mu())&&Ma++}Ma=0<Ma;F.DOMElementExtensions.setVisible(this.$P,Ma);this.HYd(Ma);F.DOMElementExtensions.setVisible(this.DMa,Ma&&this.isCollapsed);F.DOMElementExtensions.setVisible(this.P3a,
Ma&&!this.isCollapsed);F.DOMElementExtensions.setVisible(this.VFe,1<xb);this.bJc()}fla(Ma,xb){if(this.isCollapsed!==Ma){Ma||(this.lng.style.display=d.AFrameworkApplication.sa.Qa.Pf?"flex":"block");var qb=this.bcd;this.XM=!this.isCollapsed;var Ra=Ma?qb:0;qb=Ma?0:qb;this.si&&(this.animationManager.y5b(this.oB,Ra,qb,this.si.taskPane),this.fUa());Ma&&(this.lng.style.display="none");this.qSh(Ma,xb)}}HYd(Ma){const xb=this.isVisible!==Ma;this.sg=Ma;F.DOMElementExtensions.setVisible(this.domElement,Ma);xb&&
(d.AFrameworkApplication.sa.Qa.Pf&&F.DOMElementExtensions.toggleCssClass(this.domElement,ya.a.rIh,Ma),this.fUa(),this.raiseEvent(Za.xkb,new ra(Ma,Ma),this))}cuc(Ma){if(Ma.tc===this.P3a&&3!==Ma.Wb)return!1;this.Gjc(296943390,Ma.Wb);this.fla(!0,!0);return!0}uuc(Ma){if(Ma.tc===this.DMa&&3!==Ma.Wb)return!1;this.Gjc(-625072140,Ma.Wb);this.fla(!1,!0);return!0}AJf(Ma){return 13===Ma.Da.keyCode?(this.Gjc(296943390,Ma.Wb),this.fla(!0,!0),!0):!1}iLf(Ma){return 13===Ma.Da.keyCode?(this.Gjc(-625072140,Ma.Wb),
this.fla(!1,!0),!0):!1}fUa(){let Ma=0;this.$.$d&262144&&(Ma+=this.XHc,F.DOMElementExtensions.isVisible(this.oB)&&!this.isCollapsed&&(Ma+=this.bcd));this.$.fUa(Ma)}lPe(Ma,xb){const qb=document.createElement("div");qb.classList.add(Ma);xb.insertBefore(qb,xb.firstChild);return qb}YBj(){const Ma=this.domElement;let xb=document.getElementById(this.$.fc+t.a.I3a);d.AFrameworkApplication.sa.Qa.Pf&&(xb=document.getElementById("FarPaneRegion"));Ma.parentNode&&Ma.parentNode!==xb&&Ma.parentNode.removeChild(Ma);
xb.appendChild(Ma);this.Qmi()}Qmi(){const Ma=this.oB,xb=this.$P,qb=this.$.ea;Ma.style.right="0";d.AFrameworkApplication.sa.Qa.Pf||(Ma.style.marginRight=P.HelperMethods.Yc(Ba.a.XHc));Ma.style.bottom=this.$.$d&4&&!d.AFrameworkApplication.sa.Qa.Pf?P.HelperMethods.Yc(this.$.Gga):"0";this.YP.style.bottom="0";xb.style.right="0";this.$.Ql(this.Td);qb.bJ&&this.Td(null,null)}qBb(Ma){const xb=new Xa.a(0,0);return Wa.a.aw(xb,this.oB,Ma,!1)}sAe(Ma){const xb=this.oB.offsetWidth;Ma=xb-Ma;Ma<this.si.taskPane.Wq?
Ma=this.si.taskPane.Wq:950<Ma&&(Ma=950);this.si.taskPane.dx=Ma;const qb=new la(this.oB,this.$);qb.y5b(this.oB,xb,Ma,this.si.taskPane);Object(Ga.a)(457,this.si.taskPane)||qb.y5b(this.si.taskPane.Lc,xb,Ma,this.si.taskPane);this.$.fUa(this.$P.offsetWidth+Ma);this.$.sCa(z.a.p0("AnimateTaskpaneResize"))}static la(Ma,xb){let qb=null;Ma.nc&&(qb=Ma.nc.hh("ComponentAttach","AttachTaskPanePickerControl"),qb.start());const Ra=ha.U8g(Ma.fc),Jb=ha.T8g(Ma.fc,xb),yb=ha.V8g(Ma.fc);Ra.appendChild(yb);Ra.appendChild(Jb);
ha.z3g(Ma,Ra);Ma=new ha(Ra,Jb,Ma,xb);qb&&qb.stop();return Ma}static U8g(Ma){const xb=document.createElement("div");xb.id=Ma+t.a.iHc;return xb}static T8g(Ma,xb){const qb=document.createElement("div");qb.id=Ma+t.a.EGf;qb.className=ya.a.EIh;let Ra=String.format(sa,Ma+t.a.DZi,Ma+t.a.uX);Ra+=String.format(Va,Ma+t.a.xtc,Ma+t.a.FGf);xb.Oh(qb,Ra);d.AFrameworkApplication.sa.Qa.Pf&&F.DOMElementExtensions.toggleCssClass(qb,ya.a.DCa,!0);return qb}static V8g(Ma){const xb=document.createElement("div");xb.id=Ma+
t.a.KHd;xb.className=ya.a.CKh;xb.style.zIndex="100";d.AFrameworkApplication.sa.Qa.Pf&&F.DOMElementExtensions.toggleCssClass(xb,ya.a.DCa,!0);return xb}static z3g(Ma,xb){(d.AFrameworkApplication.sa.Qa.Pf?document.getElementById("FarPaneRegion"):document.getElementById(Ma.fc+t.a.I3a)).appendChild(xb)}static Pmh(){const Ma=new Na;Ma.nng=t.a.iHc;Ma.O2=t.a.EGf;Ma.t3d=t.a.uX;Ma.A4d=t.a.KHd;Ma.cpg=t.a.EZi;Ma.mLe=ya.a.GIh;Ma.q2e=ya.a.IIh;Ma.kLe=ya.a.FIh;Ma.o2e=ya.a.HIh;Ma.lLe=ya.a.U0e;Ma.p2e=ya.a.V0e;return Ma}}
Object(u.a)(ha,"TaskPanePickerControl",Za,[]);var jb=a(40),Fb=a(725),Rb=a(100),mb=a(149),sb=a(36);a.d(C,"a",function(){return Ya});class Ya extends c.a{constructor(Ma){super();this.$=Ma;this.kc()}create(){if(b.a.Sd())this.W1f(()=>S.la(this.$));else{const Ma=Object(Rb.d)(mb.a.resolve(sb.S,{Wa:this.La}));jb.TaskExtensions.za(Ma,()=>{this.W1f(()=>ha.la(this.$,Ma.result))},this.ka,3)}}static la(Ma){Ma.da.Ja(50,new Ya(Ma))}W1f(Ma){Ma=Object(Fb.a)(this.$.da,183,Ma);this.Pb(Ma)}}Object(u.a)(Ya,"TaskPaneManagerFactory",
c.a,[])},1224:function(u,C,a){function c(Aa){const ja=new h.StandardDialog;ja.rc=4;Aa=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,Aa)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;ja.BT(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,Aa,J)}u=a(0);var b=a(15),f=a(229),e=a(1357),d=a(6),h=a(146),l=a(88),k=a(907);class n{}n.j6j=864E5;n.xZg=3;n.V_i=144E5;Object(u.a)(n,"AddinConstantsNum",
null,[]);var v=a(741),x=a(822),w=a(856);class r{constructor(Aa,ja,za,ra=null){this.fa=ra?ra:d.AFrameworkApplication.fa;this.hSc=2;this.j9a=Aa;this.jQg=ja;this.nc=za}get Wya(){return this.hSc}get Ghk(){return this.jQg}PUd(Aa){if(this.fa.ra("AgaveSupportsLiveIdSpoofing")){var ja=(new Date).getTime();this.j9a(Aa,this.Wya,{["ak0"]:ja})}else if(w.a.mVj(Aa)){ja=String.format(d.AFrameworkApplication.sa.Qa.s1+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",d.AFrameworkApplication.sa.Qa.Ii,
this.Ghk,d.AFrameworkApplication.ej);const za=d.AFrameworkApplication.de;let ra=null;this.nc&&(ra=this.nc.qd("ComponentAttach",x.a[Aa]+k.a[this.Wya]));za.Fn(ja,1,null,null,!0,4,fb=>{this.Pdj(Aa,fb.data.Fe);ra&&ra.stop()},fb=>{b.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",fb.data.httpStatus);ra&&ra.stop()},null)}else w.a.wif(Aa)?(ja=w.a.p7e(Aa),this.j9a(Aa,this.Wya,{["ak0"]:ja})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.j9a(Aa,this.Wya,null)}Pdj(Aa,ja){if(ja&&""!==ja&&(ja=Sys.Net.XMLDOM(ja))){w.a.zjb(v.a.gze,((new Date).getTime()+n.V_i).toString(),Aa);let za=ja.getElementsByTagName("update");za&&za.length||(za=ja.getElementsByTagName("o:update"));za&&0<za.length&&(ja=Date.parse(za[0].firstChild.nodeValue),(w.a.p7e(Aa)<ja||w.a.wif(Aa))&&this.j9a(Aa,this.Wya,{["ak0"]:ja}))}}}Object(u.a)(r,"AddinCommandsAnonymousAPIInitializer",null,[121]);class t{constructor(Aa,ja,za){this.hSc=za;this.j9a=Aa;this.gi=ja}get Wya(){return this.hSc}PUd(Aa){let ja=
null;this.gi&&(ja=this.gi.qd("ComponentAttach",x.a[Aa]+k.a[this.Wya]));if(null==this.u_d(Aa)?0:this.u_d(Aa)){const za=(new Date).getTime()-n.xZg*n.j6j;this.j9a(Aa,this.Wya,{["ak0"]:za})}ja&&ja.stop()}}Object(u.a)(t,"AddinCommandsInitializerBase",null,[121]);class A extends t{constructor(Aa,ja){super(Aa,ja,5)}u_d(){return!0}}Object(u.a)(A,"AddinCommandsInitializer",t,[]);class y extends t{constructor(Aa,ja){super(Aa,ja,1)}u_d(Aa){try{const ja=v.a.z$e()+Aa;return Boolean.parse(this.a1h(ja)||"false")}catch(ja){b.ULS.sendTraceTag(17306844,
220,50,"LocalStorage is not allowed, {0}.",ja.toString())}return null}a1h(Aa){const ja=localStorage;return void 0!==ja&&null!==ja?ja.getItem(Aa):null}}Object(u.a)(y,"AddinCommandsLocalCacheInitializer",t,[]);var z=a(569),E=a(84),G=a(26);class F{constructor(Aa,ja=null){this.nc=Aa;this.fa=ja?ja:d.AFrameworkApplication.fa}get appUILocale(){return z.a.sL(d.AFrameworkApplication.lcid).name}jti(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var Aa={};Aa[v.a.OAh]="TeachingCallout";this.xOd(G.a.sjb,Aa)}const ja=this.pld();if(ja)if(this.fa.ra("OcpsIsEnabled"))E.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(za=>{za.isFeatureEnabled("ConnectedServices",!0).then(ra=>{for(let fb of ja){if(!ra&&0===fb.key)continue;
const Ua=this.O6e(fb.value);Ua&&Ua.PUd(fb.key)}return null})});else for(let za of ja)(Aa=this.O6e(za.value))&&Aa.PUd(za.key)}QUd(Aa,ja,za){za&&za[v.a.gJa]?(za[v.a.TQ]=Aa,za[v.a.mN]=ja,this.xOd(G.a.Mpa,za),w.a.zjb(v.a.gJa,za[v.a.gJa].toString(),Aa)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===Aa&&(za={},za[v.a.TQ]=Aa,za[v.a.mN]=ja,this.xOd(G.a.$G,za))}O6e(Aa){let ja=null;switch(Aa){case 1:ja=new y(Object(l.a)(this,this.QUd,"retrieveAddinFlagCompleted"),
this.nc);break;case 2:ja=new r(Object(l.a)(this,this.QUd,"retrieveAddinFlagCompleted"),this.appUILocale,this.nc,this.fa);break;case 5:ja=new A(Object(l.a)(this,this.QUd,"retrieveAddinFlagCompleted"),this.nc)}return ja}}Object(u.a)(F,"AddinCommandsInitializerHost",null,[]);var O=a(170),M=a(274),P=a(820),B=a(279),D=a(157),I=a(357),S=a(1);let J;class L extends h.StandardDialog{constructor(Aa,ja){super();this.hce=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.dfe=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.efe=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.Yob=!1;this.Gtb=()=>{this.hide();this.Yob&&c(this.zha)};this.Q1i=()=>{P.a.instance.getItem("optedIntoAddinDeveloperMode")?(P.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.Yob=!1):(P.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Yob=!0)};this.zha=Aa;J=ja}showDialog(Aa,ja){try{this.Te=void 0===this.Te||null===this.Te?B.a.qNb(I.a.i3).toString():this.Te,this.show({["type"]:"StandardDialogProps",["id"]:this.Te,
["dialogIcon"]:3,["headerText"]:Aa,["titleText"]:ja,["resultHandler"]:this.Gtb,["messageAreaLink"]:this.Jqh(),["permanentDismissCheckbox"]:this.Fqh(),["renderMicrosoftLogoInHeader"]:!1})}catch(za){this.HLc(Aa,ja)}}Jqh(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.dfe,["handler"]:{["href"]:this.efe,["target"]:"_blank"},["onExecute"]:null}}Fqh(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.hce,["onExecute"]:this.Q1i}}HLc(Aa,ja){const za=
new D.a(!1,!1,!1);za.rc=1;za.Te=B.a.qNb(I.a.i3).toString();za.Eg=String.format(this.sW(),ja,this.efe,this.dfe,this.hce);za.initializeAndShow(Aa,this.nAg,{optInCheckbox:!1})}nAg(Aa,ja){1==Aa&&ja.optInCheckbox&&(P.a.instance.getItem("optedIntoAddinDeveloperMode")?(P.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.Yob=!1):(P.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Yob=!0,c(this.zha)))}sW(){return S.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?
"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(u.a)(L,"AppsForOfficeDeveloperModeOptInDialog",h.StandardDialog,[]);var R=a(52),Y=a(40),Q=a(91),W=a(18),Ga=a(386);class pa extends F{constructor(Aa){super(Aa.nc);
this.zha=this.WXb=null;this.kHa=new M.a;this.f2f=ja=>{1===ja&&this.zha&&this.e2f()};this.$=Aa;e.a.dDb=e.a.O1e}get appUILocale(){return this.$.xa.UICultureTag}Bqg(){this.jti();this.nak()}pld(){const Aa=new Ga.a;this.$.ea.oh.get(27)&&(Aa.ia(0,2),""!==d.AFrameworkApplication.fa.Va("HostInstallAddIns")&&Aa.ia(16,5));this.$.ea.oh.get(33)&&Aa.ia(1,1);S.EwaSettings.ya(52)&&Aa.ia(8,1);this.$.Ne.get(35)&&Aa.ia(10,5);return Aa}xOd(Aa,ja){this.ADh(()=>{const za=new Q.a(Aa,0,this.$.Kc,0,null);this.$.Ia.$b(za,
ja)})}ADh(Aa){(ja=>{ja=this.$.da.Ba(ja);return!!ja&&W.d(ja)})(198)?(new O.a,this.$.da.Gb(198,ja=>{Aa(ja)})):Aa(null)}nak(){this.zha=d.AFrameworkApplication.fa.Va("DevAddinManifestFileUrl");this.WXb=d.AFrameworkApplication.fa.Va("DevAddinManifestGuid");var Aa=d.AFrameworkApplication.fa.Va("IsDevAddinTest");if(this.zha&&this.WXb&&Aa){Aa="true"===Aa;var ja=this.kHa.getItem("optedIntoAddinDeveloperMode");const za=this.kHa.getItem(this.WXb);ja||Aa&&d.AFrameworkApplication.fa.ra("SuppressDeveloperAddinDialogs")?
za||Aa&&d.AFrameworkApplication.fa.ra("SuppressDeveloperAddinDialogs")?this.e2f():(Aa=new h.StandardDialog,Aa.rc=4,ja=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.zha)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,Aa.BT(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ja,this.f2f)):(Aa=new L(this.zha,this.f2f),Aa.rc=0,Aa.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}e2f(){const Aa=R.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);Y.TaskExtensions.za(Aa,()=>{Aa.result.Lf.validateAndCacheNewDevAddinManifest(this.zha);this.kHa.setItem(this.WXb,"true")},this.$.ka,3)}}Object(u.a)(pa,"AddinCommandsInitService",F,[494]);var aa=a(725);class Z extends f.a{constructor(Aa){super();this.addinCommandsInitService=null;this.zd=()=>{b.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.Ec}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.$d&
16384)}] `);this.addinCommandsInitService.Bqg();this.$.ea.Kk(this.zd)};this.$=Aa;this.kc()}create(){this.$.da.Gb(53,()=>{this.Pb(Object(aa.a)(this.$.da,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new pa(this.$))));this.$.ea.Ec?(b.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.$d&16384)}] `),this.addinCommandsInitService.Bqg()):this.$.ea.pk(this.zd)})}static la(Aa){Aa.da.Ja(201,
new Z(Aa))}}Object(u.a)(Z,"AddinCommandsInitServiceFactory",f.a,[]);var fa=a(10);a.d(C,"a",function(){return ya});const ya=()=>{fa.a.Fa(Z.la)}},1236:function(u,C,a){u=a(0);var c=a(15),b=a(88),f;(function(P){P[P.generalException=0]="generalException";P[P.invalidArgument=1]="invalidArgument";P[P.notAllowed=2]="notAllowed";P[P.apiNotAvailable=3]="apiNotAvailable";P[P.unresolvedPendingRequest=4]="unresolvedPendingRequest";P[P.timeout=5]="timeout";P[P.adalTimeout=6]="adalTimeout";P[P.userNotSignedIn=7]=
"userNotSignedIn";P[P.userAborted=8]="userAborted";P[P.silentSignInFailed=9]="silentSignInFailed";P[P.invalidResourceUrl=10]="invalidResourceUrl";P[P.invalidGrant=11]="invalidGrant";P[P.connectionLost=12]="connectionLost";P[P.clientError=13]="clientError";P[P.serverError=14]="serverError"})(f||(f={}));Object(u.b)("ErrorCodes",f);a(1369);class e{constructor(P,B){this.requestCallback=this.requestParameters=null;this.requestParameters=P;this.requestCallback=B}}Object(u.a)(e,"OutstandingRequest",null,
[]);class d{}d.GYi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.BYi="AADSTS65001";d.RYi="AADSTS70011";d.userAborted="13002";d.Sjj="Popup Window is null";d.Rjj="Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.O7j="tokenRevoked";Object(u.a)(d,"WopiHostErrorType",null,[]);var h=a(6),l=a(567),k=a(583),n=a(43),v=a(1368);class x{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(x,"WopiIdentityInfo",
null,[618]);class w{constructor(P,B,D){this.expiration=this.authority=this.accessToken=null;this.accessToken=P;this.authority=B;this.expiration=D}}Object(u.a)(w,"WopiIdentityToken",null,[617]);var r=a(31),t=a(173),A=a(384),y=a(178),z=a(69),E=a(355);class G{constructor(P){this._initialized=!1;this.Ddb={};this.rGc={};this.SP=h.AFrameworkApplication.sa.hF;this.Ksd=P}Q5a(P){this._initialized||(P.fn(y.a.vWf),P.hl(y.a.vWf,Object(b.a)(this,this.U$i,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(P,
B,D=null){this.gRa(P,B);return new Promise((I,S)=>{if(this.jvd(B))if(B in this.Ddb)S("unresolvedPendingRequest");else{var J=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,n.c({["error"]:"Request timeout.",["callerId"]:B}));S("timeout")},12E4);this.Ykd(P,B,D,(L,R)=>{window.clearTimeout(J);L?I(L):(c.ULS.sendTraceTag(37856033,369,15,n.c({["error"]:f[R]})),S(R))})}else c.ULS.sendTraceTag(37856034,344,10,n.c({["error"]:"Caller is not allowed."})),S("notAllowed")})}getPrimaryIdentityInfo(P){return new Promise((B,
D)=>{this.jvd(P)?this.obi((I,S)=>{I?B(I):(c.ULS.sendTraceTag(37856064,369,10,n.c({["error"]:S.toString()})),D(S))}):(c.ULS.sendTraceTag(37856065,344,10,n.c({["error"]:"Caller is not allowed."})),D("notAllowed"))})}getAuthContext(P){return new Promise((B,D)=>{const I=this.getAuthContextSync(P);I?B(I):D("notAllowed")})}getAuthContextSync(P){if(this.jvd(P)){const B=new v.a;B.upn=h.AFrameworkApplication.fa.Va("UserPrincipalName");B.userId=h.AFrameworkApplication.fa.Va("LoggableUserId");B.authority=h.AFrameworkApplication.fa.Va("HostAuthAuthority");
B.tenantId=h.AFrameworkApplication.fa.Va("TenantId");B.isAnonymous=h.AFrameworkApplication.fa.ra("IsAnonymousUser");B.supportsAuthToken=this.Ypi(P);P=h.AFrameworkApplication.fa.Va("HostAuthType");B.authorityType="aad"===P.toLowerCase()?2:"msa"===P.toLowerCase()?1:0;return B}c.ULS.sendTraceTag(40751647,344,10,n.c({["error"]:"Caller is not allowed."}));return null}Ypi(P){const B=l.OAuthManagerSettings.eDb;return r.a.Wza?B&&l.OAuthManagerSettings.vng?Array.contains(l.OAuthManagerSettings.vng,P.toLowerCase()):
!1:B}Ykd(P,B,D,I){var S=[];Array.add(S,Object.assign(new z.a,{name:"CallerId",string:B}));Array.add(S,Object.assign(new z.a,{name:A.a.F1d,string:P.correlationId}));t.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:S}));S=k.a.create().toString();const J="getAccessToken_"+S,L=this.SP.qd("ComponentAttach",J);this.rGc[J]=L;const R={};R[A.a.G1d]=S;R[A.a.U0j]=P.resource;R[A.a.V0j]=P.scope;R[A.a.vkg]=h.AFrameworkApplication.fa.Va("HostAuthType");
R[A.a.Y0j]=h.AFrameworkApplication.fa.Va("UserPrincipalName");R[A.a.W0j]=P.silentLogin;R[A.a.R0j]=P.options;R[A.a.F1d]=P.correlationId;R[A.a.S0j]=B;D&&(R[A.a.addinName]=D.AddinName,R[A.a.Q0j]=D.AddinTrustId);this.Ksd.execute(Y=>{this.Q5a(Y);Y.sendMessage(y.a.getAuthToken,R)});this.Ddb[S]=new e(P,I)}obi(P){const B=h.AFrameworkApplication.fa.Va("UserName"),D=h.AFrameworkApplication.fa.Va("UserPrincipalName"),I=h.AFrameworkApplication.fa.Va("LoggableUserIdSpace"),S=new x;S.email=D;S.displayName=B;switch(I){case "OrgIdPuid":S.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":S.authority="MicrosoftAccount";break;default:S.authority=I}P(S,null)}U$i(P){let B=null;try{let I=P.Values[A.a.G1d];const S=P.Values[A.a.P0j],J=P.Values[A.a.vkg],L=P.Values[A.a.X0j];let R=null,Y=null;const Q=this.Ddb[I];if("undefined"!==typeof Q&&Q){var D=[];Array.add(D,Object.assign(new z.a,{name:A.a.F1d,string:Q.requestParameters.correlationId}));t.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:D}));B=Q.requestCallback;delete this.Ddb[I];"undefined"!==typeof S&&S&&S.length?Y=new w(S,J,L):R=f[this.OTi(P)];D="getAccessToken_"+I;D in this.rGc&&(this.rGc[D].stop(),delete this.rGc[D]);B(Y,R)}else c.ULS.sendTraceTag(37856066,344,10,n.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:I}))}catch(I){P=P.Values[A.a.G1d],P in this.Ddb&&delete this.Ddb[P],this.crc(),c.ULS.sendTraceTag(37856067,344,10,n.c({["error"]:I.message,["stack"]:I.stack})),B&&B(null,"generalException")}}jvd(P){var B=
h.AFrameworkApplication.Gii();P=P.toLowerCase();for(const D of B)if(P===D.toLowerCase())return!0;B=l.OAuthManagerSettings.M3c;for(let D in B)if(P===B[D].toLowerCase())return!0;return!1}OTi(P){P=P.Values[A.a.T0j];this.crc();c.ULS.sendTraceTag(39068821,344,15,n.c({["error"]:P}));return P?-1<P.indexOf(d.GYi)?9:-1<P.indexOf(d.Sjj)||-1<P.indexOf(d.Rjj)?12:-1<P.indexOf(d.invalidResourceUrl)?10:-1<P.indexOf(d.userAborted)?8:-1<P.indexOf(d.RYi)||-1<P.indexOf(d.BYi)||P===d.O7j?11:-1<P.indexOf(d.adalTimeout)?
6:0:13}gRa(P,B){P=this.zsj(P.resource);c.ULS.sendTraceTag(39921882,344,50,n.c({["callerId"]:B,["resource"]:P}))}crc(){c.ULS.sendTraceTag(39068822,344,50,n.c({["userAgent"]:window.navigator.userAgent}))}zsj(P){return(P?P:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(u.a)(G,"WopiIdentityManager",null,[579]);var F=a(260);class O{constructor(){this.Db=null}get name(){return"Common.App.WopiIdentity"}Di(P){this.Db=P;P.register(G,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Uc().dd(()=>
new G(P.qc("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.Hv(Object(b.a)(this,this.DC,"onFullAppSettingsReady"))}DC(){try{this.Db.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(P){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+P)}}dispose(){}static main(){F.a.instance.nj(new O)}}Object(u.a)(O,"WopiIdentityPackage",null,[4,5]);a.d(C,"a",function(){return M});const M=()=>{Type.registerNamespace("Common.App.WopiIdentity");
O.main()}},1245:function(u,C,a){u=a(0);var c=a(88),b=a(15),f=a(140),e=a(41);class d{constructor(z){this.tia=this.nia=this.xia=this.wia=null;this.vge=this.eee=this.wge=this.Vje=this.Ay=this.YM=!1;this.BXc=this.lke=null;this.cke=0;this.Ta=this.ike=null;this.C3=z;this.vy=3;this.HZa=!0}initialize(z,E,G){this.wia=this.Uod(z,E);this.xia=CommonUIStrings.l_SavingStatus;this.nia=CommonUIStrings.l_ReadOnlyStatus;this.tia=CommonUIStrings.l_ReviewModeStatus;this.C3&&this.C3.execute(F=>{F.z2c(Object(c.a)(this,
this.$Ub,"updateToSavingStatus"))});this.Ay=!0;this.Ta=G;this.eee=this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}aha(z,E){this.YM=z;this.vy=E;this.QT(this.HZa)}QT(z){!this.HZa&&z&&(this.ike=new Date);this.HZa=z;this.vge=!1;z=null;3===this.vy&&(z=this.HZa?this.wia:this.xia);this.pyh(z)}Uod(z,E){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):E&&E.length?String.format(CommonUIStrings.l_SavedToStatus,E):
CommonUIStrings.l_SavedStatus}$Ub(){this.QT(!1)}G9h(){switch(this.vy){case 1:return this.nia;case 2:return this.tia;default:return null}}getMode(){if(3!==this.vy)switch(this.vy){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.vge?"FailedToSave":this.HZa?"Saved":"Saving"}JAi(z){return this.Vje===this.YM&&this.cke===this.vy&&this.lke===z}Pdd(z){appChrome.getHeaderApi().then(E=>{E.updateDocumentTitleStatus(this.YM,z,this.G9h(),this.ike,this.HZa,this.eee?E.getHeaderSaveStatusIconProps(this.getMode()):
null);this.wge=!0;return null});this.BXc=null}pyh(z){this.Ay&&f.c()&&!this.JAi(z)&&(!this.wge&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Pdd(z):e.a.KTd()?(this.BXc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.BXc=window.requestIdleCallback(()=>{this.Pdd(z)})):window.requestAnimationFrame(()=>{this.Pdd(z)}),this.Vje=this.YM,this.lke=z,this.cke=this.vy)}}Object(u.a)(d,"ReactSaveStatusUIHandler",
null,[512]);var h=a(178);class l{constructor(z,E){this.Dt=null;this.wia=CommonUIStrings.l_SavedStatus;this.xia=CommonUIStrings.l_SavingStatus;this.nia=CommonUIStrings.l_ReadOnlyStatus;this.tia=CommonUIStrings.l_ReviewModeStatus;this.dZb=E;this.C3=z;this.vy=3;this.Uta=!0}Uu(){this.C3&&this.C3.execute(z=>{z.z2c(Object(c.a)(this,this.$Ub,"updateToSavingStatus"))});this.dZb.execute(z=>{this.Dt=z})}aha(z,E){this.vy=E;3===E?this.QT(this.Uta):2===E?this.N5d(this.tia):this.N5d(this.nia)}$Ub(){this.QT(!1)}QT(z){this.Uta=
z;this.N5d(this.Uta?this.wia:this.xia)}N5d(z){this.Dt&&this.Dt.sendMessage(h.a.Iak,this.Uih(z))}Uih(z){const E={};E.StatusText=z;return E}}Object(u.a)(l,"SaveStatusPostMessageHandler",null,[512]);var k=a(96),n=a(133),v=a(59);class x{constructor(z,E,G,F){this.tia=this.nia=this.xia=this.wia=null;this.nHa=0;this.CF=this.pYc=this.zFa=this.OMc=this.oIa=null;this.ue=z;this.maa=E;this.C3=G;this.Vj=F;this.mie=!0;this.YM=!1;this.vy=3;this.Uta=!0}initialize(z,E){if(!this.ue)return!1;this.wia=this.Uod(z,E);
this.xia=CommonUIStrings.l_SavingStatus;this.nia=CommonUIStrings.l_ReadOnlyStatus;this.tia=CommonUIStrings.l_ReviewModeStatus;this.Uu();return!0}Uod(z,E){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):E&&E.length?String.format(CommonUIStrings.l_SavedToStatus,E):CommonUIStrings.l_SavedStatus}Uu(){this.maa&&this.maa.execute(z=>{z.jYg(Object(c.a)(this,this.sQe,"createStatusAndModeElements"));z.cYg(Object(c.a)(this,this.UXj,"showHideSaveStatusElement"));z.i8j&&
this.sQe(null,null)});this.C3&&this.C3.execute(z=>{z.z2c(Object(c.a)(this,this.$Ub,"updateToSavingStatus"))})}gx(){this.CF&&this.ue&&this.ue.xH(this.CF)}UXj(z,E){this.aha("true"===E,this.vy)}aha(z,E){this.YM=z;this.vy=E;this.OMc&&(this.OMc.style.display=this.YM||3===this.vy||!this.oIa?"none":"");this.zFa&&(this.zFa.style.display=this.YM||3===this.vy?"none":"",this.zFa.innerText=1===this.vy?this.nia:this.tia,this.zFa.title=1===this.vy?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.pYc&&(this.pYc.style.display=this.YM||1===this.vy||!this.oIa&&!this.zFa?"none":"");this.CF&&(this.CF.style.display=this.YM||1===this.vy?"none":"",this.QT(this.Uta),this.CF.title=CommonUIStrings.l_SaveStatusTooltip)}sQe(z,E){z=document.getElementById(k.CuiHelper.Djf);E&&E.clk||!z||""===this.wia||""===this.xia||""===this.nia||""===this.tia||(this.oIa=document.getElementById(k.CuiHelper.a7b),this.OMc=k.CuiHelper.Yva(z,"BreadcrumbAppModeDash","-",null,!1),this.zFa=k.CuiHelper.Yva(z,"BreadcrumbAppModeStatus",
1===this.vy?this.nia:this.tia,null,!1),this.atg(this.zFa),this.pYc=k.CuiHelper.Yva(z,"BreadcrumbSaveStatusDash","-",null,!1),this.CF=k.CuiHelper.Yva(z,"BreadcrumbSaveStatus",this.wia,null,!1),this.atg(this.CF),this.aha(this.YM,this.vy))}$Ub(){this.QT(!1)}QT(z){this.Uta=z;this.bgk(this.Uta?this.wia:this.xia)}bgk(z){!this.CF||3!==this.vy&&2!==this.vy||(this.mie&&!this.Uta?(this.nHa=this.CF.offsetWidth<this.nHa?this.nHa:this.CF.offsetWidth,this.Rck(this.xia),this.mie=!1):this.CF.innerText=z)}atg(z){z.style.direction=
this.Vj?"rtl":"ltr";z.style.width="auto";z.style.textAlign=this.Vj?"right":"left";z.style.display=this.YM?"none":"";z.setAttribute("Unselectable","on")}Rck(z){this.CF&&(this.CF.style.width="",this.CF.innerText=z,this.nHa=this.CF.offsetWidth<this.nHa?this.nHa:this.CF.offsetWidth,z=n.a.uA(this.CF),this.CF.style.width=this.nHa-v.a.UE(z.paddingLeft)-v.a.UE(z.paddingRight)+1+"px")}}Object(u.a)(x,"SaveStatusUIHandler",null,[512]);var w=a(6),r=a(99);class t{constructor(){this.qYc=this.nXc=this.Tpb=this.Db=
null}get name(){return"Common.App.SaveStatus"}Di(z){this.Db=z;w.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&w.AFrameworkApplication.hideHeaderEmbedded?this.Db.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Uc().dd(()=>new l(this.Db.qc("Common.App.HostNotification.EditNotificationEventSource"),this.Db.qc("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.sa.Qa.Quf||(w.AFrameworkApplication.sa.Qa.Kv?this.Db.register(d,
"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Uc().dd(()=>new d(this.Db.qc("Common.App.HostNotification.EditNotificationEventSource"))):this.Db.register(x,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Uc().dd(()=>new x(r.EventHandlerManager.instance,this.Db.qc("Common.App.Header.HeaderEventSource"),this.Db.qc("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.fa.Hv(Object(c.a)(this,
this.DC,"onFullAppSettingsReady"))}DC(){const z=w.AFrameworkApplication.fa,E=!!w.AFrameworkApplication.sa.Qa&&4===w.AFrameworkApplication.sa.Qa.Ii;if(z.ra("WordEditorAutoSaveImprovementIsEnabled")||z.ra("PptEditorSaveStatusInHeaderEnabled")||E&&z.ra("SimplifiedReactRibbonUxIsEnabled")||z.ra("ExcelSaveStatusInHeaderEnabled")||z.ra("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&w.AFrameworkApplication.hideHeaderEmbedded?(this.qYc=this.Db.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&
this.qYc.Uu():w.AFrameworkApplication.sa.Qa.Quf||w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.sa.Qa.Kv?(this.nXc=this.Db.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.nXc.initialize(z.ra("IsSkyDrive"),z.Va("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.fa):(this.Tpb=this.Db.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.Tpb.initialize(z.ra("IsSkyDrive"),z.Va("HostNameToIncludeInSavedStatus")))}dispose(){this.Tpb&&this.Tpb.gx()}}Object(u.a)(t,
"PackageManager",null,[4,5]);var A=a(260);a.d(C,"a",function(){return y});const y=()=>{Type.registerNamespace("Common.App.SaveStatus");A.a.instance.nj(new t)}},1254:function(u,C,a){var c=a(10);u=a(0);var b=a(15),f=a(229),e=a(92),d=a(6),h=a(199),l=a(9),k=a(42),n=a(932),v=a(233),x=a(58),w=a(477);class r extends Sys.EventArgs{constructor(){super()}}Object(u.a)(r,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var t=a(51),A=a(48);a(38);var y=a(33),z=a(1),E=a(631);a(23);var G=a(246),F=a(20);a(177);class O{constructor(S){this.data=
S}}Object(u.a)(O,"NumberFormatDataHolder",null,[]);var M=a(190);class P extends k.a{constructor(S,J){super();this.vBd=l.a.Oe;this.N6c=null;this.Bkb=this.aqc=!1;this.KHf=(L,R)=>{var Y;(L=F.h(this.$))&&(R=null!==(Y=null===R||void 0===R?void 0:R.cell)&&void 0!==Y?Y:L.jc(null))&&this.rra(R.cell.li,!0)};this.x5i=L=>{this.isActive()&&(y.a.Aq(L.Errors)||!L.Result?(L=L.Errors?L.Errors.map(R=>JSON.stringify(R)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${L}`)):
(L=L.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${L.Index}, category = ${L.Category}`),this.NOj(L.Index,L.Category),this.raiseEvent(P.D7c,new n.a(L.Index,L.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.W7b();this.isActive()&&this.ea.Gc.allowEdits&&(this.Bkb||this.so&&!(this.ea.PQa>this.vBd)?this.VKc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),
this.Gnd=w.a(this.$.qa.va,this.so?this.so.Digest:"",this.f6i,this.e6i,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.U$e())};this.iMf=L=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`);this.INa=null};this.y1=()=>{this.Bkb=!1;this.ea.YE(this.y1);this.HUa(this.aqc?P.MZd:P.nHd)};this.zd=(L,R)=>{b.ULS.sendTraceTag(537155715,
0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");v.a(R)&&this.HUa(P.MZd)};this.fg=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.zHd(0===this.$.workbookContext.CalcMode)};this.Td=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.HUa(P.MZd);z.EwaSettings.ya(269)&&3!==this.$.workbookContext.CalcMode&&this.zHd(0===
this.$.workbookContext.CalcMode)};this.Y5i=(L,R,Y)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.INa=null;this.isActive()?L.StateId===l.a.Oe?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.VKc()):!L.Result||this.nZ&&this.nZ.length?this.HUa(P.nHd):this.TPf(L,R,Y):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};
this.TPf=L=>{this.nZ=L.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.nZ?this.nZ.length:-1} functions.`);L=!1;if(this.nZ){for(const R of this.nZ)R&&(this.h6e[R.NameUI.toLocaleUpperCase()]=R.FunctionIndex.toString(),R.NameUI!==R.NameDataStrings&&(this.h6e[R.NameDataStrings.toLocaleUpperCase()]=R.FunctionIndex.toString(),L=!0),this.LWh.ia(R.FunctionIndex,R.NameUI));this.raiseEvent(P.xkd,Sys.EventArgs.Empty,
this)}L&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.f6i=L=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.aqc=!1,this.vBd=L.StateId,this.vBd===l.a.Oe)this.aqc=!0,this.VKc();else{if(L.Result){var R=this.so;this.so=L.Result;b.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.so.Digest}.`);L=[];if(R)L=P.J9h(R.NumberFormats,
this.so.NumberFormats);else for(R=0;R<this.so.NumberFormats.length;R++)this.Btc.ia(R,this.so.NumberFormats[R].NumberFormatCategory);for(const Y of L)this.Btc.ia(Y,this.so.NumberFormats[Y].NumberFormatCategory);this.raiseEvent(P.THd,new r(L),this);this.raiseEvent(P.pzf)}this.HUa(P.nHd)}};this.e6i=L=>{this.isActive()&&(10===L.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`),
this.aqc=!0,this.VKc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=S;this.$=J;this.so=this.INa=this.Gnd=this.LNb=null;this.Btc=new M.a;this.tAb=new M.a;this.nZ=[];this.LWh=new M.a;this.h6e={};this.ea.pk(this.zd);this.$.Ql(this.Td);F.h(this.$).ga.D4(this.KHf);z.EwaSettings.ya(269)&&this.ea.nv(this.fg);this.HUa(P.Elf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}tye(S){this.addHandler(P.THd,S)}wSd(S){this.removeHandler(P.THd,
S)}ZVg(S){this.addHandler(P.D7c,S)}mxj(S){this.removeHandler(P.D7c,S)}Zxe(S){this.addHandler(P.xkd,S)}jSd(S){this.removeHandler(P.xkd,S)}DXg(S){this.addHandler(P.pzf,S)}get uf(){return this.so?this.so.LocaleInformation:null}get iBa(){return this.so?this.so.NumberFormats:[]}get Qla(){this.nZ&&this.nZ.length||this.U$e();return this.nZ}get ewi(){return this.so&&void 0!==this.so.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.so.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.so.InstantaneousCalcWebWorkerPrecisionSamplingRate:
P.Huh}get hwi(){return this.so&&void 0!==this.so.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.so.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.so.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:P.Luh}get gwi(){return this.so&&void 0!==this.so.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.so.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.so.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:P.Kuh}get fwi(){return this.so&&
void 0!==this.so.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.so.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.so.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:P.Juh}get Kud(){return this.so?this.so.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:P.Iuh}get Klc(){return null!==this.N6c?this.N6c:this.so?this.so.InstantaneousCalcManualMode:!1}M$j(S){let J;if(!S)return{returnValue:!0,category:"General"};J="";if(!({category:S}=this.rra(S,!1)).returnValue)return{returnValue:!1,
category:J};J=this.kkh(S);return{returnValue:!0,category:J}}kkh(S){let J="";switch(S){case 0:J="General";break;case 1:J="Number";break;case 2:J="Currency";break;case 3:J="Accounting";break;case 4:J="Date";break;case 5:J="Time";break;case 6:J="Percentage";break;case 7:J="Fraction";break;case 8:J="Scientific";break;case 9:J="Text";break;case 10:J="Special";break;case 11:J="Custom"}return J}rra(S,J){let L,R=({value:L}=this.Btc.nd(S,0)).returnValue;!R&&0<S&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,
`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${S}`),this.v1h(S),J&&(L=this.u1h(S),R=!0),E.a(S,this.$.jF)&&(L=6));return{returnValue:R,category:L}}$Bi(S){let J=0;if(({category:J}=this.rra(S,!0)).returnValue)return 6===J;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${S}`);return!1}kVh(S){b.ULS.sendTraceTag(537155730,0,
50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.INa=x.o(this.$.qa.va,{FilterType:0},G.b(this.TPf,S),this.iMf,null,null,null)}C5e(){this.HUa(P.Elf)}zHd(S){this.N6c=S}v1h(S){if(this.tAb&&this.$){var J;if(!({value:J}=this.tAb.nd(S)).returnValue||J.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${S}`),(J=w.c(this.$.qa.va,S,this.x5i,null,null,null))&&this.tAb.ia(S,J)}else b.ULS.sendTraceTag(537155729,
0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}u1h(S){return 1<=S&&8>=S?1:9<=S&&12>=S?2:13===S||14===S?6:15===S?8:17===S|18===S?7:19===S?4:16===S||20<=S&&29>=S||31===S?11:30===S?9:32<=S&&35>=S?3:0}isActive(){const S=void 0===this.ea||null===this.ea,J=!S&&this.ea.Ec;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${J} - sessionStateManager IsNullOrUndefined: ${S}`);
return J}NOj(S,J){this.Btc.ia(S,J)}dispose(){e.a.Ka(this.LNb);this.LNb=null;this.W7b();for(let S of this.tAb){const J=S.value;J&&!J.isCompleted&&d.AFrameworkApplication.de.cw(J.pv)}this.tAb=null;this.ea&&(this.ea.Kk(this.zd),this.Bkb&&this.ea.YE(this.y1),this.Bkb=!1,this.ea.Xw(this.fg));this.ea=null;this.$&&F.h(this.$)&&F.h(this.$).ga&&(F.h(this.$).ga.Pfa(this.KHf),this.$.Rm(this.Td));this.$=null;super.dispose()}isFeatureEnabled(S){try{switch(S){case "LocaleLongDateFormat":return z.EwaSettings.ya(184);
case "GetLocaleDayNames":return z.EwaSettings.ya(185);case "CalculateTextWidthIgnoreLetterSpacing":return z.EwaSettings.ya(255);case "OfficeVSO:3657744_CalcFixForDateFormat":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return z.EwaSettings.ya(101);default:return S.startsWith("OfficeVSO:")?z.EwaSettings.isChangeGateEnabled(S):!1}}catch(J){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${S}): feature parsing failed, returning false. Exception: ${J.toString()}.`),!1}}HUa(S){this.isActive()&&
this.ea.Gc.allowEdits?(e.a.Ka(this.LNb),this.LNb=null,this.LNb=t.a.instance.create(this.refresh,S,A.a.iwi)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.Gc&&null!==this.ea.Gc?this.ea.Gc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}U$e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.INa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.nZ&&this.nZ.length||(this.INa=x.o(this.$.qa.va,{FilterType:0},this.Y5i,this.iMf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}VKc(){this.Bkb||(this.Bkb=!0,this.ea.DD(this.y1))}W7b(){this.cw(this.Gnd);this.cw(this.INa);this.INa=this.Gnd=null}cw(S){S&&
!S.isCompleted&&this.$.qa.va.xjb(S.pv)}static J9h(S,J){if(!S||!S.length)return[];if(!J||!J.length){J=Array(S.length);for(var L=0;L<S.length;++L)J[L]=S[L].IfmtIndex;return J}L=new M.a;for(const R of S)L.ia(R.IfmtIndex,new O(R));S=new h.a;for(const R of J){let Y;({value:Y}=L.nd(R.IfmtIndex)).returnValue&&Y.data.FormatString===R.FormatString||S.add(R.IfmtIndex)}return S.toArray()}}P.THd="isim0";P.D7c="isim1";P.xkd="isim2";P.pzf="isim3";P.Elf=100;P.MZd=1E3;P.nHd=3E5;P.Huh=.001;P.Luh=.1;P.Kuh=.2;P.Juh=
.001;P.Iuh=50;Object(u.a)(P,"InstantaneousSupportInformationManager",k.a,[583,2]);var B=a(725);class D extends f.a{constructor(S){super();this.$=S;this.kc()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var S=Object(B.a)(this.$.da,268,()=>new P(this.$.ea,this.$));this.Pb(S)}}static la(S){if(!S)throw Error.argumentNull("ewaControl");S.da.Ja(246,new D(S))}}Object(u.a)(D,"InstantaneousSupportInformationManagerFactory",
f.a,[]);a.d(C,"a",function(){return I});const I=()=>{c.a.Fa(D.la)}},1255:function(u,C,a){u=a(0);var c=a(15),b=a(88),f=a(112),e=a(111),d=a(26);class h{constructor(G,F,O){this.fIa=null;this.Ce=G;this.Na=F;this.Ife=O.create()}y2f(){this.fIa?c.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(c.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.fIa=new f.a(2,1,3E4,Object(b.a)(this,this.lSb,"showFloatPane"),67),this.Ce.jg(this.fIa))}lSb(){this.fIa=
null;c.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Ife.display()}ITa(){this.Na.xc(d.a.lSb,e.a.frame,Object(b.a)(this,this.FXj,"showFloatPaneHandler"))}FXj(G,F,O,M,P){return G!==d.a.lSb?2:1===O?32:2===O&&P?(c.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.y2f():(this.fIa?(c.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Ce.Zp(this.fIa)):(c.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.Ife.remove(null)),this.fIa=null),32):8}}Object(u.a)(h,"FloatPaneActor",null,[645]);var l=a(131),k=a(165),n=a(14),v=a(50),x=a(93);class w{constructor(G,F,O,M,P){this.AUc=this.onb=this.U0b=this.pia=this.IQ=this.Wr=this.xNc=this.ZM=this.dpb=this.mob=this.nob=this.zQc=null;this.Ce=F;this.Ta=G;this.pj=O;this.Db=P;this.o3=M}s4a(){this.ZM=document.createElement("div");this.ZM.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.ZM.style.width=
this.IQ.width+"px";(this.AUc=this.N$h(this.o3))?(this.pia=document.createElement("a"),this.pia.setAttribute(x.a.fe,x.a.ps),this.pj.ta(n.a.click,this.pia,Object(b.a)(this,this.PPf,"onRedirectClick")),this.pia.href=this.AUc,this.pia.target="_blank",this.pia.appendChild(this.IQ),this.ZM.appendChild(this.pia)):this.ZM.appendChild(this.IQ);this.Wr=document.createElement("a");this.Wr.setAttribute(x.a.fe,x.a.qu);this.Wr.className="StandardButton WACFloatPaneCloseButton";this.Wr.title=CommonUIStrings.l_Close;
this.Wr.tabIndex=-1;this.xNc=k.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.xNc.setAttribute(x.a.fe,x.a.ps);this.Wr.appendChild(this.xNc);this.pj.ta(n.a.click,this.Wr,Object(b.a)(this,this.onClose,"onClose"));this.ZM.appendChild(this.Wr);this.dpb.appendChild(this.ZM)}I7h(G){const F=this.Ta.ra("O365PromotionHasStarted");switch(G){case 2:return l.a.Lva(String.format("adppt{0}.png",F?"sale":""));case 1:return l.a.Lva(String.format("adxls{0}.png",
F?"sale":""));case 3:return l.a.Lva(String.format("addoc{0}.png",F?"sale":""))}return null}N$h(G){const F=this.Ta.Va("O365AdPaneRedirectedURL");switch(G){case 1:return String.format(F,"Excel");case 2:return String.format(F,"PowerPoint");case 3:return String.format(F,"Word")}return null}hide(G=null){this.onb=null;this.ZM&&!this.U0b&&(G?c.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):c.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.ZM.className=
String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.ZM.style.height="0px",this.U0b=new f.a(2,1,1E3,Object(b.a)(this,this.remove,"remove"),67),this.Ce.jg(this.U0b))}remove(){this.ZM&&this.dpb&&(this.pia&&this.pj.Aa(n.a.click,this.pia,Object(b.a)(this,this.PPf,"onRedirectClick")),this.pj.Aa(n.a.click,this.Wr,Object(b.a)(this,this.onClose,"onClose")),this.dpb.removeChild(this.ZM),this.ZM=null);this.U0b=null}display(){if(this.zQc=this.Db.ah("Common.IFloatPaneContainer"))if(this.dpb=this.zQc.container){var G=
this.I7h(this.o3);G?(c.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",G),this.IQ=document.createElement("img"),this.IQ.className="WACFloatPaneImage",this.nob=Object(b.a)(this,this.L8i,"onLoadImageFinish"),v.a.addHandler(this.IQ,n.a.load,this.nob),this.mob=Object(b.a)(this,this.K8i,"onLoadImageError"),v.a.addHandler(this.IQ,n.a.error,this.mob),this.IQ.src=G):c.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else c.ULS.sendTraceTag(23674906,
207,15,"The container is empty, so the float pane can't be shown.");else c.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}L8i(){const G=this.Ta.oe("O365AdPaneShowingDuration",60);this.s4a();this.ZM.style.display="block";this.ZM.style.height=this.IQ.height+"px";this.onb=new f.a(2,1,1E3*G,Object(b.a)(this,this.hide,"hide"),67);this.Ce.jg(this.onb);this.p3f()}K8i(){c.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.p3f();this.IQ=null}p3f(){this.nob&&this.IQ&&v.a.removeHandler(this.IQ,n.a.load,this.nob);this.nob=null;this.mob&&this.IQ&&v.a.removeHandler(this.IQ,n.a.error,this.mob);this.mob=null}PPf(){c.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.onb&&this.Ce.Zp(this.onb);this.hide();return!0}dispose(){this.hide()}}Object(u.a)(w,"FloatPane",null,[621]);class r{constructor(G,F,O,M,P){this.Ce=F;this.Ta=G;this.pj=O;this.Db=P;this.o3=
M}create(){return new w(this.Ta,this.Ce,this.pj,this.o3,this.Db)}}Object(u.a)(r,"FloatPaneFactory",null,[584]);var t=a(6),A=a(231),y=a(260);class z{constructor(){this.Db=null}get name(){return"Common.App.FloatPane"}get Hqf(){return t.AFrameworkApplication.fa.ra("O365AdvertisementIsEnabled")&&t.AFrameworkApplication.fa.ra("IsShowAdvertisementPaneEnabled")}init(){this.Hqf&&(c.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Db.resolve("Common.App.FloatPane.IFloatPaneActor").y2f(),
c.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Db.resolve("Common.App.FloatPane.IFloatPaneActor").ITa())}Di(G){this.Db=G;this.Hqf&&(this.Db.register(r,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").dd(()=>new r(t.AFrameworkApplication.fa,t.AFrameworkApplication.Mi,A.a.instance,t.AFrameworkApplication.sa.Qa.Ii,this.Db)).Uc(),this.Db.register(h,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").dd(()=>
new h(t.AFrameworkApplication.Mi,t.AFrameworkApplication.Qb,this.Db.resolve("Common.App.FloatPane.IFloatPaneFactory"))).Uc())}dispose(){}static main(){y.a.instance.nj(new z)}}Object(u.a)(z,"FloatPanePackage",null,[4,5]);a.d(C,"a",function(){return E});const E=()=>{Type.registerNamespace("Common.App.FloatPane");z.main()}},1256:function(u,C,a){var c=a(10);u=a(0);var b=a(15),f=a(234),e=a(6),d=a(92),h=a(34),l=a(38),k=a(42),n=a(16),v=a(30);class x extends k.a{constructor(ya,Aa,ja){super();this.value=null;
this.ZAd=ya;this.zy=Aa;this.nKg=ja}zWg(ya){this.addHandler("EnabledStateChanged",ya)}get isEnabled(){return this.zy}set isEnabled(ya){ya!==this.zy&&(this.zy=ya,v.a.vp()&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.ZAd.replace(" ","")+"Button",ya)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get Fi(){return this.value?String.format(n.a.instance.Lb(79),this.ZAd,this.value):this.ZAd}get vrc(){return this.nKg}}Object(u.a)(x,"StatusBarAggregateControl",
k.a,[523]);class w extends k.a{constructor(){super();this.controls=new l.a(!1);this.qae=null;this.CZf=()=>{this.raiseEvent("AggregatesChanged")};this.x4(0,415,"Average",!0);this.x4(1,416,"Count",!0);this.x4(2,417,"NumericalCount",!1);this.x4(3,418,"Minimum",!1);this.x4(4,419,"Maximum",!1);this.x4(5,420,"Sum",!0)}JVg(ya){this.addHandler("AggregatesChanged",ya)}cxj(ya){this.removeHandler("AggregatesChanged",ya)}get J1a(){return this.qae||w.JWe}set J1a(ya){ya=ya||w.JWe;ya!==this.J1a&&(this.rDa(0,ya.Average),
this.rDa(1,ya.Count),this.rDa(2,ya.NumericalCount),this.rDa(3,ya.Minimum),this.rDa(4,ya.Maximum),this.rDa(5,ya.Sum),this.qae=ya,this.CZf())}dispose(){d.a.Rc(this.controls.values);this.controls.clear();super.dispose()}Oxa(ya){return this.controls.getItem(ya)}xSg(ya,...Aa){ya=this.Oxa(ya.toString());for(const ja of Aa)this.controls.add(ja,ya)}x4(ya,Aa,ja,za){Aa=new x(n.a.instance.Ha(Aa),za,ja);Aa.zWg(this.CZf);this.controls.add(ya.toString(),Aa)}rDa(ya,Aa){this.Oxa(ya.toString()).value=Aa}static get JWe(){w.Lsa||
(w.Lsa={},w.Lsa.Average=w.Lsa.Count=w.Lsa.NumericalCount=w.Lsa.Minimum=w.Lsa.Sum=null);return w.Lsa}}w.Lsa=null;Object(u.a)(w,"StatusBarAggregateControlCollection",k.a,[]);var r=a(327),t=a(47),A=a(233),y=a(171),z=a(48),E=a(5),G=a(32),F=a(130),O=a(1),M=a(198),P=a(20),B=a(58);const D=(ya,Aa,ja,za,ra,fb,Ua,Ca=null)=>{Ca=ya.Pa(1,Ca);Ca.activeCell=Aa;Ca.selectedRanges=ja;return B.g(ya,"GetStatusBarAggregates",Ca,za,ra,fb,Ua,0)};var I=a(55),S=a(62),J=a(230),L=a(149),R=a(36),Y=a(166),Q=a(356),W=a(80),Ga=
a(60);const pa=O.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PauseBeforeCalcRequest",10),aa=[{K1a:0,name:"Average",RWa:-1015637685,L1a:1,N6a:!0},{K1a:1,name:"Count",RWa:1957769939,L1a:3,N6a:!1},{K1a:2,name:"NumericalCount",RWa:-1292677035,L1a:2,N6a:!1},{K1a:3,name:"Minimum",RWa:405783320,L1a:5,N6a:!0},{K1a:4,name:"Maximum",RWa:1210824414,L1a:4,N6a:!0},{K1a:5,name:"Sum",RWa:1265371067,L1a:9,N6a:!0}];class Z{constructor(ya,Aa=null,ja=null){this.vgc=this.YIc=this.ZIc=this.XIc=null;this.Qua=
new w;this.$ab=new l.a(!0);this.Jng=0;this.Tqg=za=>{const ra=this.ga.pa.activeCell.clone(),fb=t.d(this.ga.pa.selectedRanges);var Ua=this.$.na;const Ca=null===Ua||void 0===Ua?void 0:Ua.sheetId,Ia=null===Ua||void 0===Ua?void 0:Ua.hash,oa=this.$.ea.We,Da=this.$.ea.PQa;Ua=this.$.listSeparator;const bb=t.i(t.H(fb),Ua,this.$,!1),Za=`=${this.calcManager.config.localeInfo.getWorksheetFuncName(485)}({0}${Ua}5${Ua}{1})`;Promise.all(aa.map(Xa=>this.calcManager.evalFormula(String.format(Za,Xa.L1a,bb),ra,void 0,
Xa.N6a?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(Xa=>{var Ba;const Wa=this.ga.pa.selectedRanges,Na=this.ga.pa.activeCell,ta=null===(Ba=this.$.na)||void 0===Ba?void 0:Ba.sheetId;if(t.R(fb,Wa)&&ra.equals(Na)&&Ca===ta){Ba=[];for(var [,V]of Xa.entries()){if(void 0===(null===V||void 0===V?void 0:V.formatted)||!excelOnlineCalc.util.isSuccess(V.formatted)||!excelOnlineCalc.util.isSuccess(V.value)){this.cCc();return}Xa=this.calcManager.TG.renderValue(V.formatted.value,
excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(Xa)){this.cCc();return}Xa=excelOnlineCalc.numfmt.renderedValueToString(Xa.value);Ba.push(Xa)}V={};for(var ia of aa)V[ia.name]="";ia=Ba[1];Xa=Ba[2];if(1<+ia&&(V.Count=ia,0<+Xa))for(const [X,la]of aa.entries())V[la.name]=Ba[X];this.zRb(V);this.q5j(V,ia,oa,Da,fb,ra,Ca,Ia,za)}}).catch(Xa=>{b.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(Xa)}`);this.cCc()})};this.Dd=()=>
{this.osg()};this.Uf=(za,ra)=>{za=ra.Jd.hash;ra=ra.Jd.block;const fb=ra.Nca;if(ra.state&4&&fb&&fb!==this.$ab.getItem(za)){this.$ab.add(za,fb);var Ua=(za=ra.eg)?P.g(za.getRowNumbers(),za.getColumnNumbers()):null;f.a.any(this.ga.pa.selectedRanges,Ca=>Ca.Nd(Ua))&&this.osg()}};this.Sn=(za,ra)=>{this.$ab.remove(ra.Jd.hash)};this.Td=()=>{this.$.da.Gb(29,za=>{this.statusBarManager=za;za.BK(this);b.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};
this.zd=(za,ra)=>{!za.Ec&&A.b(ra)&&this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null,b.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.a6j=()=>{let za;({I7b:za}=this.U$j(this.ga.pa.selectedRanges)).returnValue?this.zRb(za):this.S6f()};this.S6f=()=>{var za;const ra=t.d(this.ga.pa.selectedRanges),fb=this.ga.pa.activeCell.clone(),Ua=null===(za=this.$.na)||void 0===za?void 0:za.sheetId;this.UCf(fb,ra,Ca=>
{var Ia;const oa=this.ga.pa.selectedRanges,Da=this.ga.pa.activeCell,bb=null===(Ia=this.$.na)||void 0===Ia?void 0:Ia.sheetId;t.R(ra,oa)&&fb.equals(Da)&&Ua===bb&&this.zRb(Ca.Result)})};this.epf=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StatusBarAggregatesCSE",!1);this.wqf=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AggregatesDebugErrorMessageForFF",!1);this.$=ya;this.gridView=P.h(this.$);this.k5=Aa||e.AFrameworkApplication.de;this.ii=ja||G.a.Bb;this.$.ea.pk(this.zd);
this.$.Ql(this.Td);this.ga.gp(this.Dd);this.ga.add_activeCellChanged(this.Dd);this.Ca.mv(this.Uf);this.Ca.gI(this.Sn);for(const za of aa)this.OQj(za.K1a,za.name,za.RWa);(this.statusBarManager=this.$.da.Ba(29))&&this.statusBarManager.BK(this);this.epf&&((O.EwaSettings.qC()?za=>L.a.resolve(R.i,{Wa:1}).then(ra=>setTimeout(()=>za(ra),0)):za=>this.$.da.Gb(266,za))(za=>{this.calcManager=za}),this.$.da.Gb(268,za=>{this.instantaneousSupportInformationManager=za}))}qr(ya){this.Qua.JVg(ya)}Rr(ya){this.Qua.cxj(ya)}get J1a(){return this.Qua.J1a}zRb(ya){this.Qua.J1a=
ya}get Ca(){return this.gridView.Ca}get ga(){return this.gridView.ga}dispose(){this.$&&(this.$.ea.Kk(this.zd),this.$.Rm(this.Td),this.ga.Gp(this.Dd),this.ga.remove_activeCellChanged(this.Dd),this.Ca.Lt(this.Uf),this.Ca.BJ(this.Sn),this.FHe());this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null);d.a.Rc([this.XIc,this.ZIc,this.YIc,this.Qua]);this.$=this.Qua=this.YIc=this.ZIc=this.XIc=null;this.$ab&&(this.$ab.clear(),this.$ab=null)}ut(ya,Aa){return this.Oxa(ya)&&this.Xcf(ya,
Aa)?!0:!1}Xcf(ya,Aa){const ja=this.Oxa(ya);if(!ja)return!1;let za=ja.Fi;if(ya.endsWith("Label"))Aa.Visible=ja.isVisible,v.a.vp()?Aa.LabelText=za:Aa.Value=za;else if(ya.endsWith("Button"))Aa.LabelText=za,Aa.On=ja.isEnabled;else return!1;return!0}ro(){return!0}hd(){return!1}executeCommand(ya,Aa){ya=this.Oxa(Aa.command);if(!ya)return M.a(Aa.command);ya.isEnabled=!ya.isEnabled;this.pPi(ya.vrc,ya.isEnabled);return S.Task.Ua(!0)}Tc(ya,Aa){return!!this.Oxa(Aa.command)}ld(){return!1}UCf(ya,Aa,ja){const za=
this.$;this.FHe();this.$.ea.Ec&&(this.vgc=D(za.qa.va,t.o(ya,za),t.r(Aa,za),ja,null,null,null))}U$j(ya){let Aa;return{returnValue:({I7b:Aa}=Z.Sqg(ya)).returnValue||this.X1g(ya)&&this.U1g(ya),I7b:Aa}}q5j(ya,Aa,ja,za,ra,fb,Ua,Ca,Ia){const oa=this.wqf;if(Ia||!(this.Jng>(oa?1E3:20)||Math.random()>(oa?1:.05)))this.Jng++,this.UCf(fb,ra,Da=>{var bb,Za,Xa,Ba;if(!J.a(Da)){var Wa=this.ga.pa.selectedRanges,Na=this.ga.pa.activeCell,ta=null===(bb=this.$.na)||void 0===bb?void 0:bb.sheetId;bb=Da.StateId;if(t.R(ra,
Wa)&&fb.equals(Na)&&Ua===ta&&ja===this.$.ea.We&&za===this.$.ea.PQa&&ja===bb){var V=Da.Result;bb={};const sa={};ta=!0;for(var ia of aa){var X=V[ia.name],la=ya[ia.name];const Va=X===la;bb[ia.name]=Va;sa[ia.name]=[X.length,la.length];ta&&(ta=Va)}({category:Na}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.M$j(null!==(Ba=null===(Xa=null===(Za=this.gridView.jc(Na))||void 0===Za?void 0:Za.cell)||void 0===Xa?void 0:Xa.li)&&void 0!==Ba?Ba:0):{category:"uninitialized"});
Za=Wa.length;Wa=t.b(Wa);Xa=this.gridView.Xif()||this.gridView.Wif();ia=this.gridView.Cb;Ba=ia.bMb;X=this.gridView.Nj("StatusBarAggregates");ia=W.b(fb,ia.yj,ia.$j,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(Ga.c)(X)?X.value:null);ia=ia.X+"_"+ia.Y+"_"+ia.PaneType;V=V.Count;X=ya.Count;la=this.gridView.Mb.L$h(ra);Da=`StatusBarAggregateManager.testCalcResult: allCorrect: ${ta}, ${JSON.stringify(bb)}, numberFormatCategory: ${Na}, resLength(server,calc): ${JSON.stringify(sa)}, stateId: ${ja}, latestSuccessfulStateId: ${za}, prevSheetId: ${Ua}, prevSheetHash: ${Ca}, numOfRanges: ${Za}, numOfCells: ${Wa}, prevActiveCell: ${fb}, prevSelectedRanges: ${ra.join(";")}, sheetHasHidden: ${Xa}, panesState: ${Ba}, blockPositionString: ${ia}, ReportCalcState: ${Da.ReportCalcState}, CalcComplete: ${Da.CalcComplete}, serverCount: ${V}, calcCount: ${X}, calcCountUnfiltered: ${Aa}, enumeratorCount: ${la}, forceTestResult: ${Ia}`;
b.ULS.sendTraceTag(520426510,0,50,Da);X!==V&&!Ia&&this.wqf&&(Da={Appearance:1,Caption:null,Description:"We need your help!\nYou encountered an error we are having a hard time reproducing.\nPlease save a copy of your workbook at its current state and send it to issolomo@microsoft.com.\nThank you!",Directive:null,MessageId:0,MessageIdName:"StatusBarAggregatesDebugErrorMessageForFF"},Da.MessageIdHash=h.a.rv(Da.MessageIdName),Da.Severity=0,Da.Type=0,O.EwaSettings.wz()?new Q.a(this.$,Da):(new Y.ErrorDialog(this.$,
Da)).Rg());ta||Ia||window.setTimeout(()=>{this.Tqg(!0)},100)}}})}X1g(ya){const Aa=this.gridView.hk,ja=this.gridView.wq;return!!Aa&&f.a.all(ya,za=>Aa.contains(za))&&f.a.all(ya,za=>!ja.PFb(za))}U1g(ya){if(500<t.b(ya))return!1;const Aa=this.ii.Ye;ya=this.gridView.y5("StatusBarAggregateManager.AreAllCellsEmpty",ya);try{for(let ja=0;ya.$$mn();ja++)if(ya.$$cu().cK||!(ja%25)&&100<F.c(this.ii,Aa))return!1}finally{ya&&ya.dispose()}return!0}Oxa(ya){return this.Qua.Oxa(ya)}OQj(ya,Aa,ja){this.Qua.xSg(ya,"Query"+
Aa+"Label","Query"+Aa+"Button",ja.toString())}osg(){var ya;if(this.$.$d&4&&!this.gridView.Eb&&!this.gridView.Wi){var Aa;({I7b:Aa}=Z.Sqg(this.ga.pa.selectedRanges)).returnValue?this.zRb(Aa):(this.zRb(null),this.epf?(null===(ya=this.calcManager)||void 0===ya?0:ya.vmc)?this.kHj():this.cCc():this.XIc=y.AsyncMethodContext.vr(this.a6j,500,z.a.h2j,this.XIc))}}kHj(){this.YIc=y.AsyncMethodContext.vr(()=>this.Tqg(!1),pa,z.a.i2j,this.YIc)}cCc(){this.ZIc=y.AsyncMethodContext.vr(this.S6f,500,z.a.g2j,this.ZIc)}FHe(){this.vgc&&
(this.k5.cw(this.vgc.pv),this.vgc=null)}pPi(ya,Aa){const ja={};ja.a=this.$.xa.UserSessionId;ja.b=ya;ja.c=Aa;I.b().Df(29,ja)}static initData(){const ya=r.a.Yaa;for(const Aa of aa)ya(Aa.RWa,E.a.jh,0,0)}static la(ya){Z.initData();const Aa=new Z(ya);ya.Ia.w4(Aa);ya.da.Ja(27,Aa)}static Sqg(ya){return{returnValue:1===ya.length&&ya[0].isSingle,I7b:null}}}Object(u.a)(Z,"StatusBarAggregateManager",null,[468,2,196,197,200]);a.d(C,"a",function(){return fa});const fa=()=>{c.a.Fa(ya=>{ya.da.Gb(29,()=>{Z.la(ya)})})}},
1266:function(u,C,a){u=a(0);var c=a(15),b=a(229),f=a(37),e=a(92),d=a(31),h=a(84),l=a(554),k=a(9),n=a(53),v=a(7),x=a(176),w=a(73),r=a(303),t=a(136),A=a(47),y=a(30),z=a(13),E=a(12),G=a(109),F=a(20),O=a(319),M=a(137),P=a(383);class B{constructor(Q){this.l9a=this.vlc=0;this.m8b=null;this.Gqf=!1;this.$=Q;this.Gqf=Q.Apc}vCi(){return F.h(this.$).Eb?(c.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Ob.xz?(c.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}q5i(Q){this.m8b=new Sys.UI.Point(Math.round(Q.Cxa.center.x),Math.round(Q.Cxa.center.y));this.vlc=f.a(this.$).zoom;this.l9a=Q.Cxa.scale;let W={["InitialZoom"]:this.vlc,["Location"]:"canvas",["InputMethod"]:Q.Wb};M.b(this.$).Ld(t.a.gij,W);c.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.m8b.x},${this.m8b.y}), initial zoom ${this.vlc}, initial scale ${this.l9a}`);
this.Kbb(Q,"onGestureStart");return!0}p5i(Q){if(!this.l9a)return c.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.Kbb(Q,"OnGestureEvent"),!0;if(!isFinite(this.l9a))return c.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.l9a}`),this.Kbb(Q,"OnGestureEvent"),!0;const W=Q.Cxa.scale/this.l9a*this.vlc;f.a(this.$).Txg(W,this.m8b);c.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${W}. Current scale ${Q.Cxa.scale}`);this.Kbb(Q,"OnGestureEvent");return!0}o5i(Q){f.a(this.$).Uxg();c.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.Kbb(Q,"OnGestureEnd")}n5i(Q){c.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.Kbb(Q,"OnGestureCancel")}Kbb(Q,W){var Ga,pa,aa;this.Gqf&&(c.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${W},        eventArgs non-null: ${isNullOrUndefined(Q)}, gestureData non-null: ${isNullOrUndefined(null===
Q||void 0===Q?void 0:Q.Cxa)},        srcEvent non-null: ${isNullOrUndefined(null===(Ga=null===Q||void 0===Q?void 0:Q.Cxa)||void 0===Ga?void 0:Ga.srcEvent)}`),null===(aa=null===(pa=null===Q||void 0===Q?void 0:Q.Cxa)||void 0===pa?void 0:pa.srcEvent)||void 0===aa?void 0:aa.preventDefault())}}Object(u.a)(B,"PinchToZoomAdapter",null,[510]);var D=a(42);class I extends D.a{constructor(){super()}cze(Q){this.addHandler("ZCIEK",Q)}l5f(Q){this.removeHandler("ZCIEK",Q)}Y2c(Q){this.addHandler("ZCUIK",Q)}SSd(Q){this.removeHandler("ZCUIK",
Q)}Lpj(){this.raiseEvent("ZCIEK")}Kpj(){this.raiseEvent("ZCUIK")}Mpj(){this.raiseEvent("ZCEK")}}Object(u.a)(I,"ZoomEventManager",D.a,[509]);var S=a(23),J=a(89);class L extends D.a{constructor(Q){super();this.statusBarManager=null;this.Y5e=!1;this.$=Q;this.$.da.Gb(29,W=>{this.statusBarManager=W;W.BK(this)})}qr(Q){this.addHandler("Zoom",Q)}Rr(Q){this.removeHandler("Zoom",Q)}RA(){this.ro("QueryZoomStatus")&&this.raiseEvent("Zoom")}ut(Q,W){return"QueryZoomStatus"!==Q?!1:this.Yli(W)}ro(){return f.a(this.$).ZT()}dispose(){this.statusBarManager&&
(this.statusBarManager.cH(this),this.statusBarManager=null);this.$=null;super.dispose()}egf(Q){Q=this.fii(Q);if(!Q)return null;Q=Q.getElementsByClassName("cui-ctl-mediumlabel");return 1!==Q.length?(c.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):Q[0]}Yli(Q){if(!this.$)return!1;const W=f.a(this.$).YVb;let Ga=!1;if(y.a.vp())S.a.equals(appChrome.selectors.getControlLabel(J.a.zoomStatusBarMenuOpen),W,!1)||(Ga=!0);else{const pa=this.egf("HandleQueryZoomStatusCommand");
pa?S.a.equals(Q.LabelText.toString(),W,!1)||(pa.innerText="",Ga=!0):Ga=!0}Ga&&this.mOj(Q,W);return!0}mOj(Q,W){Q.LabelText=W;y.a.vp()&&(Q.Visible=!0)}fii(Q){var W=z.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!W)return W=(W=this.$.ea.Gc)?W.inEmbedView:!1,d.a.iq||W||c.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${Q}`),null;this.Y5e||(this.Y5e=!0,c.ULS.sendTraceTag(537149762,
0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${Q}`));return W}}Object(u.a)(L,"ZoomStatusBarManager",D.a,[2,196,197]);class R extends l.a{constructor(Q){super(Q);this.zoomEventManager=this.iAa=this.uHb=null;this.zHb=-1;this.Fqf=!1;this.Dd=()=>{this.zHb=-1};c.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Gkb=new L(Q);this.hij()&&(c.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.h3g());this.hvj()}dispose(){this.Gkb&&
(e.a.Ka(this.Gkb),this.Gkb=null);this.zoomEventManager&&(this.$.da.LV(419),this.zoomEventManager=null);this.Fqf&&this.Xwh();super.dispose()}ZT(){return!0}Txg(Q,W){Q=this.SMa(Q);if(F.h(this.$).rtl){const Ga=Math.round(z.DOMElementExtensions.getBounds(this.$.$f).width*f.a(this.$).zoom);this.uHb=new Sys.UI.Point(Ga-W.x,W.y)}else this.uHb=W;this.lVa(Q,!1,"ZoomWithPinch")}qLc(){return!0}pLc(Q,W){var Ga=d.a.isMac?.07:.15;Q=this.zoom+(Q?Ga:-Ga);Q=this.SMa(Q);F.h(this.$).rtl?(Ga=Math.round(z.DOMElementExtensions.getBounds(this.$.$f).width*
f.a(this.$).zoom),this.iAa=new Sys.UI.Point(Ga-W.x,W.y)):this.iAa=W;W=this.zoom;this.lVa(Q,!0,"ZoomWithMouse");W={["InitialZoom"]:W,["FinalZoom"]:Q,["Location"]:"canvas"};M.b(this.$).Ld(t.a.tmk,W)}Uxg(){this.uHb=null}rLc(Q,W){this.lVa(this.SMa(Q),!1,W?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Vxg(Q){isNaN(Q)?c.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.lVa(this.SMa(Q),!1,"ZoomToLevelInExcelLive")}sLc(Q,W){this.lVa(this.SMa(Q),
!0,W?"ZoomWithShortcuts":"ZoomWithButtons")}Rdf(Q,W){const Ga=F.h(this.$).rtl,[pa,aa]=this.qod(Ga),[Z,fa]=this.fqd(Q,aa);return this.iAa?(Q=this.Ynd(this.iAa,Q,W,aa,pa,"ZoomWithMouse"),this.iAa=null,Q):this.uHb?this.Ynd(this.uHb,Q,W,aa,pa,"ZoomWithPinch"):F.h(this.$).ga.Sa.qS?this.smk(Q,W,aa,pa,Z,fa,F.h(this.$).rtl):this.umk(Q,W,aa,pa,Z,fa,F.h(this.$).rtl)}kag(Q,W,Ga){if(Q){c.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${Q.x} ${Q.y}) (new top-left) from zoom:${W} to zoom:${Ga}`);Q=new n.a(Q.x,Q.y);
Ga=F.h(this.$).rtl;[,Ga]=this.qod(Ga);const [pa,aa]=this.fqd(W,Ga);F.h(this.$).Eze(Q,pa,aa,"ApplicationZoom")}else c.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${W} to zoom:${Ga}`)}zoomFitToScreen(){const Q=this.zoom;var W=F.h(this.$).rtl;const [Ga,pa]=this.qod(W),[aa,Z]=this.fqd(Q,pa);var fa=F.h(this.$).ga.Sa.qS;(W=fa?this.D$e(this.FSa,aa,Z,!1):this.$df(this.FSa,pa,Ga,aa,Z,W,!1))?(W=Math.min(aa/(W.width+100),Z/(W.height+100)),W=this.$Th(W),this.lVa(W,!0,"ZoomWithFitToScreen"),fa?
F.h(this.$).ga.Sa.Ava(F.h(this.$).ga.Sa.Fc,!1):(fa=A.v(F.h(this.$).ga.pa.activeRange,this.$),F.h(this.$).qh(fa,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.zHb=Q,this.Fqf||this.e3g()):c.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${fa}`)}zoomFitToScreenUndo(){this.lVa(this.zHb,!1,"ZoomWithFitToScreen")}B_d(){return-1!==this.zHb}e3g(){const Q=F.h(this.$);Q&&(Q.ga.gp(this.Dd),Q.KF(this.Dd))}Xwh(){const Q=F.h(this.$);Q&&
(Q.ga.Gp(this.Dd),Q.dH(this.Dd))}$Th(Q){Q=Math.min(Q,k.a.fVi);Q=Math.max(Q,k.a.VVi);return Math.round(100*Q)/100}lVa(Q,W,Ga){if(this.nLc()){var pa=F.h(this.$).view.visibleArea.toString();Q=this.SMa(Q);var aa=w.d(this.$.ua.na);aa||(aa=l.a.hGf);F.h(this.$).Bh.I2(5,O.a.mLc,Ga);F.h(this.$).Bh.loa(O.a.mLc,this.$.ea.We);c.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${Q} to sheet ${aa} origin ${Ga} prevZoom ${this.zoom}`);this.gRj(aa,Q);this.zoomEventManager.Mpj();this.u9j(Ga);
this.G9j(W);this.zHb=-1;P.b(this.$,Ga);Q=F.h(this.$).view.visibleArea.toString();c.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${pa}, NewGridVisibleArea: ${Q}, IsShyRibbonActive: ${this.$.Y0}`)}}G2h(Q){return(Q=E.HelperMethods.oE(this.$.$f,this.$.domElement,Q))?Q:new Sys.UI.Point(0,0)}qod(Q){const W=this.G2h(Q);Q=this.t7h(W,Q);return[W,Q]}fqd(Q,W){const Ga=z.DOMElementExtensions.getBounds(this.$.$f);return[Math.round((Ga.width-W.x)*Q),Math.round((Ga.height-W.y)*
Q)]}t7h(Q,W){W=E.HelperMethods.oE(F.h(this.$).domElement,this.$.domElement,W);return W?(Q=new Sys.UI.Point(Math.round(W.x-Q.x),Math.round(W.y-Q.y)),Q):new Sys.UI.Point(0,0)}umk(Q,W,Ga,pa,aa,Z,fa){return(fa=this.$df(Q,Ga,pa,aa,Z,fa))?this.Icf(fa,Q,W,Ga,pa,aa,Z):null}$df(Q,W,Ga,pa,aa,Z,fa=!0){var ya=A.G(F.h(this.$).ga.pa.selectedRanges);if(fa&&(ya=ya.Ue(A.G(F.h(this.$).Zic())),!ya))return c.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;const Aa=F.h(this.$).jc(ya.topLeft);ya=F.h(this.$).jc(ya.bottomRight);if(!Aa||!ya)return c.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;Q=Aa.cell.TI===ya.cell.TI&&Aa.cell.RI===ya.cell.RI?this.z1h(Q,ya,W,Ga,pa,Z):this.Qgi(Q,Aa,ya,W,Ga,pa,Z);return Q?fa?this.J4e(Q,pa,aa):Q:(c.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}J4e(Q,W,Ga){if(0>
Q.x||Q.x>W)Q.x=0;if(0>Q.y||Q.y>Ga)Q.y=0;Q.x+Q.width>W&&(Q.width=W-Q.x);Q.y+Q.height>Ga&&(Q.height=Ga-Q.y);return Q}Qgi(Q,W,Ga,pa,aa,Z,fa){W=F.h(this.$).getCellBounds(W.cell);if(!W)return null;const ya=F.h(this.$).getCellBounds(Ga.cell);if(!ya)return null;let Aa=aa.x;fa&&(Aa=0,W.x=Math.round(Z/Q)-W.x-Math.round(W.width),ya.x=Math.round(Z/Q)-ya.x-Math.round(ya.width));Q=new Sys.UI.Bounds(Math.round((W.x-pa.x)*Q)-Aa,Math.round((W.y-pa.y)*Q-aa.y),Math.round((ya.x+ya.width-W.x)*Q),Math.round((ya.y+ya.height-
W.y)*Q));Ga=Ga.cell.getRange();c.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Ga.top}, b:${Ga.bottom}, r:${Ga.right}, l:${Ga.left}) in bounds (${Q.x}, ${Q.y}, ${Q.width}, ${Q.height})`);return Q}z1h(Q,W,Ga,pa,aa,Z){const fa=F.h(this.$).getCellBounds(W.cell);if(!fa)return null;let ya=pa.x;Z&&(ya=0,fa.x=Math.round(aa/Q)-fa.x-Math.round(fa.width));Q=new Sys.UI.Bounds(Math.round((fa.x-Ga.x)*Q)-ya,Math.round((fa.y-
Ga.y)*Q-pa.y),Math.round(fa.width*Q),Math.round(fa.height*Q));W=W.cell.getRange();c.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${W.top}, l:${W.left}) in bounds (${Q.x}, ${Q.y}, ${Q.width}, ${Q.height})`);return Q}smk(Q,W,Ga,pa,aa,Z){const fa=this.D$e(Q,aa,Z);return fa?this.Icf(fa,Q,W,Ga,pa,aa,Z):null}Icf(Q,W,Ga,pa,aa,Z,fa){Q=new Sys.UI.Point(this.mdf(Z,Q.x,Q.width),this.mdf(fa,Q.y,Q.height));return this.Ynd(Q,W,Ga,pa,aa)}mdf(Q,
W,Ga){return Q===Ga?(c.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),Q/2):Q*W/(Q-Ga)}D$e(Q,W,Ga,pa=!0){const aa=F.h(this.$).ga.Sa.Fc.domElement;var Z=E.HelperMethods.oE(aa,F.h(this.$).domElement,F.h(this.$).rtl);if(!Z)return c.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const fa=F.h(this.$).WBb();Z=new Sys.UI.Point(Math.round((Z.x-fa.topLeft.x)*
Q),Math.round((Z.y-fa.topLeft.y)*Q));Q=new Sys.UI.Bounds(Z.x,Z.y,Math.round(aa.offsetWidth*Q),Math.round(aa.offsetHeight*Q));return pa?this.J4e(Q,W,Ga):Q}DGf(){this.Gkb.RA()}AZi(Q){"ZoomToLevelInExcelLive"===Q?this.zoomEventManager.Lpj():this.zoomEventManager.Kpj()}hvj(){this.zoomEventManager=this.$.da.Ja(419,new I)}Ynd(Q,W,Ga,pa,aa,Z=""){var fa=F.h(this.$).rtl?0:aa.x;aa="ZoomWithPinch"===Z||"ZoomWithMouse"===Z?new Sys.UI.Point(Q.x-fa-Math.round(pa.x*W),Q.y-aa.y-Math.round(pa.y*W)):Q;aa=new Sys.UI.Point(Math.round(aa.x/
W),Math.round(aa.y/W));c.ULS.shipAssertTag(537149770,0,!!W,"Original zoom level must be different than 0");fa=Ga/W;aa=new Sys.UI.Point(Math.round(aa.x*(1-1/fa)),Math.round(aa.y*(1-1/fa)));"ZoomWithMouse"===Z||"ZoomWithPinch"===Z?(aa.x+=Math.round((pa.x-F.h(this.$).Rs)*(fa-1)),aa.y+=Math.round((pa.y-F.h(this.$).QK)*(fa-1))):(fa=Math.round(pa.x*(Ga-W)),0<fa&&aa.x>fa&&(aa.x+=fa),W=Math.round(pa.y*(Ga-W)),0<W&&aa.y>W&&(aa.y+=W));"ZoomWithMouse"===Z&&(Q.x||(aa.x=0),Q.y||(aa.y=0));Q=F.h(this.$).WBb();return new Sys.UI.Point(aa.x+
Q.topLeft.x,aa.y+Q.topLeft.y)}h3g(){const Q=[];h.a.instance.qc("Common.IGestureInputManager").execute(W=>{0===W.R6h()&&W.Gtj(document.body,new B(this.$),Q)})}hij(){return this.nLc()&&(d.a.rp&&d.a.xPa(67)||this.$.Apc)}gRj(Q,W){P.a(this.$)?this.setZoomLevel(Q,W,this.E9d,k.a.JNd):this.setZoomLevel(Q,W,this.zoomPerSheetId,this.Nsf?-1:this.FSa)}setZoomLevel(Q,W,Ga,pa){Ga.remove(Q);W!==pa&&Ga.add(Q,W)}u9j(Q){this.Ceg();this.$.sCa(r.a.p0("TriggerImmediateZoomOperations"));this.ahk();this.AZi(Q)}ahk(){this.AGi()?
this.$.Wf():this.Gkb.RA();const Q=this.Gkb.egf("UpdateZoomStatusBar");Q&&(Q.innerText=this.YVb)}AGi(){const Q=x.a(this.$);return Q?Q.pq.Lz===(y.a.dQa(this.$)?v.a.Ayc:this.$.fc+v.a.J8f):!1}G9j(Q){F.h(this.$).rmk(Q);this.f_g()}f_g(){const Q=G.a(this.$);if(Q)for(const W of F.h(this.$).Ca.lz()){if(!W){c.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!W.Ok)continue;const Ga=W.gj;if(Ga)for(let pa=0;pa<Ga.count;pa++)if(2===Ga.Mg(pa).type){const aa=
Q.Es(Ga.Mg(pa).Jh());aa?(aa.Vga(!1),c.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):c.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else c.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(u.a)(R,"ZoomManager",l.a,[]);a.d(C,"a",function(){return Y});class Y extends b.a{constructor(Q){super();this.$=Q;
this.kc()}create(){const Q=new R(this.$);this.chk(Q);this.$.da.Ja(368,Q);this.Pb(Q)}chk(Q){const W=f.a(this.$);if(W){var Ga=W.kqd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");Q.RYd(Ga);Q.XBc(W.TIc)}else c.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(Q){Q.da.Ja(369,new Y(Q))}}Object(u.a)(Y,"ZoomManagerFactory",b.a,
[])},1272:function(u,C,a){u=a(0);var c=a(993),b=a(6);class f{}Object(u.a)(f,"LokiTokenResult",null,[]);class e{constructor(v){this.R_b=v}Ond(){const v=this.i9h();return v?e.Rxd?new Promise((x,w)=>{this.R_b.continueWith(()=>{this.R_b.Zh||this.R_b.vg?w(Error.create("Error downloading auth library")):this.R_b.result.dD("Loki",v).then(r=>{r=b.AFrameworkApplication.fa.ra("ForceLokiFallbackToACLPTokenIsEnabled")?this.l9h():r.IsSuccess&&r.Token?Object.assign(new f,{isSuccess:!0,token:r.Token,errorMessage:null}):
Object.assign(new f,{isSuccess:!1,token:null,errorMessage:JSON.stringify(r)});x(r);return r})})}):Promise.resolve(Object.assign(new f,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new f,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",c.a.O7e())}))}l9h(){const v=b.AFrameworkApplication.fa.Va("LokiUserDataSignature")||"";return Object.assign(new f,{isSuccess:!0,
token:v,errorMessage:null})}i9h(){let v=null;const x=c.a.Agc();2===x?v=b.AFrameworkApplication.fa.Va("LokiAADAppId"):1===x&&(v=b.AFrameworkApplication.fa.Va("LokiMSAAppId"));return v}static get Rxd(){return b.AFrameworkApplication.fa.ra("IsO365CommercialHost")||b.AFrameworkApplication.fa.ra("IsO365ConsumerHost")}}Object(u.a)(e,"LokiTokenManager",null,[516]);var d=a(260),h=a(84),l=a(528);class k{get name(){return"Common.App.LivePersonaUtils"}init(){h.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Di(v){v.register(e,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").Uc().dd(()=>new e(l.a.dr(v.qc("Common.App.OAuth.IOAuthManager"))))}static main(){d.a.instance.nj(new k)}}Object(u.a)(k,"LivePersonaUtilsPackage",null,[4,5]);a.d(C,"a",function(){return n});const n=()=>{Type.registerNamespace("Common.App.LivePersonaUtils");k.main()}},1273:function(u,C,a){u=a(0);var c=a(578),b=a(573),f=a(570),e=a(1031);class d{uqh(F,O){if(F&&!(1>F.length)&&O){var M=Object.assign(new f.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.Tnh(F,M.ControlList);O.push(M)}}Tnh(F,O){const M=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(O,M);O=Object.assign(new f.a,{Title:"",ControlList:[]});Array.add(M.Menu.MenuSectionList,O);this.Yph(F,O.ControlList)}Yph(F,O){for(let M=0;M<F.length;M++){const P=Object.assign(new e.a,{ExternalId:String.format("CoauthorPersona_{0}",
M),Command:"336231556",DisplayName:F[M].userName,LabelText:F[M].userName,ImageBackColor:F[M].color,PersonaId:F[M].email,IsAnonymous:F[M].isAnonymous});Array.add(O,P)}}}Object(u.a)(d,"PresenceContextMenuSectionBuilder",null,[587]);var h=a(88),l=a(6),k=a(191),n=a(572),v=a(112),x=a(146),w=a(92),r=a(84),t=a(111),A=a(26);class y{constructor(F,O,M,P){this.xbe=this.r3=this.Jj=this.sF=this.M$=null;this.T1b=F;this.WNg=P;this.T1b.pPa&&(this.Jj=new v.a(3,2,5E3,Object(h.a)(this,this.T3g,"authenticationCheckTask"),
2),l.AFrameworkApplication.Mi.jg(this.Jj),this.vh(O,M));this.T1b.Rrb(()=>{this.tIf()});this.T1b.i1a(()=>{this.uIf()})}get businessBar(){return this.r3||(this.r3=r.a.instance.ah("CommonUI.IBusinessBar"))}get RFe(){return this.xbe||(this.xbe=r.a.instance.ah("CommonUI.IBusinessBarEntryFactory"))}vh(F,O){const M=l.AFrameworkApplication.Qb;M.ef(A.a.authenticationLost,t.a.frame,F,96);M.ef(A.a.CDe,t.a.frame,O,96);M.xc(A.a.NHe,t.a.frame,k.ActionManager.bed);M.xc(A.a.OHe,t.a.frame,k.ActionManager.bed);M.xc(A.a.QBd,
t.a.frame,k.ActionManager.bed)}tIf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.Qb.processAction(A.a.authenticationLost,2)}uIf(){this.e5j();l.AFrameworkApplication.Qb.processAction(A.a.CDe,2)}T3g(){this.T1b.authenticationCheck()}e5j(){this.sF&&(this.sF.hide(),this.sF.dispose(),this.sF=null);this.M$&&this.businessBar&&(l.AFrameworkApplication.Wg||this.businessBar.removeEntry(this.M$),this.M$.dispose(),this.M$=null)}showDialog(F){w.a.Ka(this.sF);this.sF=new x.StandardDialog;
this.WNg||(this.sF.Iu=!1,this.sF.rc=0);this.sF.Hc(1,CommonUIStrings.l_SignIn);this.sF.BT(CommonUIStrings.l_DefaultDialogTitle,F,Object(h.a)(this,this.yv,"dialogHandler"))}yv(F){1===F?(n.a.Y8(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.Qb.processAction(A.a.QBd,2)):(this.gSb(),l.AFrameworkApplication.Qb.processAction(A.a.OHe,2))}gSb(){this.businessBar&&this.RFe&&(this.M$=this.RFe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,
null),this.M$.closeable=!0,this.M$.addButton(CommonUIStrings.l_SignIn,y.n9g,""),this.M$.Yba=Object(h.a)(this,this.p9g,"businessBarEntryCloseHandler"),this.businessBar.CD(this.M$,!1))}p9g(){this.Xxh();l.AFrameworkApplication.Qb.processAction(A.a.NHe,2)}Xxh(){this.Jj&&(l.AFrameworkApplication.Mi.Zp(this.Jj),this.Jj=null)}dispose(){this.Jj=this.sF=this.M$=null}static n9g(){n.a.Y8();l.AFrameworkApplication.Qb.processAction(A.a.QBd,2)}}Object(u.a)(y,"SignOutResponseUI",null,[2]);var z=a(260);class E{get name(){return"Common.App.UI"}Di(F){F.register(d,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Uc()}init(){}dispose(){w.a.Ka(E.f4);E.f4=null}static main(){z.a.instance.nj(new E)}}E.f4=null;Object(u.a)(E,"CommonAppUIPackage",null,[4,5]);a.d(C,"a",function(){return G});const G=()=>{Type.registerNamespace("CAUI");E.main()}},1283:function(u,C,a){u=a(0);var c=a(92),b=a(229),f=a(52),e=a(40),d=a(235),h=a(15),l=a(34),k=a(6),n=a(86),v=a(388),x=a(79),w=a(382),r=a(200),t=a(91),A=a(230),y=a(1),z=a(23),
E=a(246);class G{constructor(L){this.$=L}get yqf(){return this.$.workbookContext.FileCoauthorable}get vFb(){return!1}get jAb(){return this.$.ea.amIAlone}get QUe(){if(this.jAb)return!0;for(const L of this.$.ea.to)if(!L.SupportsRename)return!1;return!0}}Object(u.a)(G,"EwaCoauthManager",null,[514]);var F=a(58),O=a(74),M=a(26);class P extends n.a{constructor(L,R){super();this.Ifa=this.USd=this.m5f=this.Tcd=null;this.Gma=()=>{var Y=this.$.ea.Pn;if(Y&&Y.WorkbookFileName){var Q=l.a.Jq(Y.WorkbookFileName),
W=!!z.a.compare(this.$.workbookContext.WorkbookFileName,Y.WorkbookFileName,!1),Ga=y.EwaSettings.ya(465)&&!!Y.BreadcrumbFolderUrl&&!!z.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Y.BreadcrumbFolderUrl,!1);if(W||Ga)this.Ifa={},this.Ifa.NewFileName=Q,this.Ifa.EditDocInClientUrl=Y.EditDocInClientUrl,this.Ifa.DirectInvokeDAVUrl=Y.DirectInvokeDAVUrl,this.Ifa.DownloadACopyUrl=Y.DownloadACopyUrl,y.EwaSettings.ya(465)&&Y.BreadcrumbFolderUrl&&(this.Ifa.BreadcrumbFolderName=Y.BreadcrumbFolderName,
this.Ifa.BreadcrumbFolderUrl=Y.BreadcrumbFolderUrl),Y=k.AFrameworkApplication.Qb.Be(M.a.fileNameUpdate,2,Q),this.Ifa=null,h.ULS.shipAssertTag(537154064,0,32===Y,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.p4i=(Y,Q,W)=>{this.m5f=Q;this.USd=W;this.$.Ia.$b(new t.a(1897077126,x.a.Vb,2,3,null),{["newFileName"]:Y})};this.o4i=Y=>{this.Ifa&&Y(this.odf(this.Ifa),this.Dt)};this.lLb=Y=>{A.a(Y)||!Y.Result?(Y=P.JYh(Y),O.a(this.$).Qd.jN([-414480287,650565124,-782844485,
1223808266,-62451516,1636785843]),this.USd(Y)):this.m5f(this.odf(Y.Result),this.Dt)};this.baj=()=>{this.USd(5)};this.$=L;this.Dt=R;this.$.ea.nv(this.Gma)}initialize(){k.AFrameworkApplication.qec=this.p4i;k.AFrameworkApplication.AMa=this.o4i;this.Tcd=k.AFrameworkApplication.lA;k.AFrameworkApplication.lA=new G(this.$)}dispose(){k.AFrameworkApplication.qec=null;k.AFrameworkApplication.AMa=null;this.$.ea.Xw(this.Gma);k.AFrameworkApplication.lA=this.Tcd;this.$=this.Tcd=null;super.dispose()}renameFile(L,
R){const Y=L.newFileName;if(Y&&(L=l.a.Jq(this.$.workbookContext.WorkbookFileName),!y.EwaSettings.isChangeGateEnabled("OfficeVSO:7439298_CompareNewFileNameForRenameOperation")||z.a.compare(L,Y,!1))){const Q=this.$.qa.va.Bc();w.a(this.$.userOperationManager,(W,Ga,pa)=>{var aa=this.$.qa.va;W=E.b(W,this.lLb);Ga=E.a(Ga,this.baj);const Z=aa.Pa(9,Q);Z.newFileName=Y;return F.g(aa,"RenameFile",Z,W,Ga,pa,null,0)},W=>new r.a(134,0,W),R)}}Uzi(){return 32===k.AFrameworkApplication.Qb.processAction(M.a.gka,1)}odf(L){var R=
this.$.workbookContext;k.AFrameworkApplication.Q_=L.DownloadACopyUrl;const Y=y.EwaSettings.ya(465)&&!!L.BreadcrumbFolderUrl;Y&&(k.AFrameworkApplication.kn.breadcrumbFolderName=L.BreadcrumbFolderName,k.AFrameworkApplication.kn.breadcrumbFolderUrl=L.BreadcrumbFolderUrl,R.FullDocumentInfo.BreadcrumbFolderUrl=L.BreadcrumbFolderUrl,R.FullDocumentInfo.BreadcrumbFolderName=L.BreadcrumbFolderName);R.FullDocumentInfo.BreadcrumbDocName=L.NewFileName;v.d(R,L.NewFileName);R={};R.NewName=L.NewFileName;R.DirectInvokeDavUrl=
L.DirectInvokeDAVUrl;R.EditDocInClientUrl=L.EditDocInClientUrl;Y&&(R.BreadcrumbFolderName=L.BreadcrumbFolderName,R.BreadcrumbFolderUrl=L.BreadcrumbFolderUrl);R.OperationResult=0;return R}static JYh(L){switch(L.Errors[0].MessageId){case -414480287:L=2;break;case 650565124:L=1;break;case 1636785843:L=6;break;case -782844485:L=4;break;default:L=5}return L}}Object(u.a)(P,"RenameFileManager",n.a,[489,2]);var B=a(55),D=a(100),I=a(149),S=a(36);a.d(C,"a",function(){return J});class J extends b.a{constructor(L){super();
this.y_=this.renameFileManager=null;this.$=L;this.kc()}create(){if(!this.y_){const L=d.a.A4a(B.b(),this.ka,"Task","IRenameFileManager");this.y_=L.task;const R=f.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.La),Y=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(D.d)(I.a.resolve(S.p,{Wa:this.La})):f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La);e.TaskExtensions.za(e.TaskExtensions.ke([Y,R],this.ka),()=>{const Q=new P(this.$,R.result);
this.$.da.Ja(120,Q);L.setResult(Q)},this.ka,3)}this.y_.continueWith(L=>{this.Pb(L.result)})}dispose(){c.a.Ka(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static la(L){L.da.Ja(119,new J(L))}}Object(u.a)(J,"RenameFileManagerServiceFactory",b.a,[])},1286:function(u,C,a){u=a(0);var c=a(2),b=a(15),f=a(31),e=a(92),d=a(14),h=a(126),l=a(425),k=a(86),n=a(9),v=a(70),x=a(466);class w{constructor(pa,aa){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=
this.convertToDomainName=this.cardViewManager=null;this.$=aa;this.parentElement=pa}kmh(){const pa=this.lmh();x.a(this.$,243,242,0,aa=>{this.cardViewManager=aa;aa.Xhg(this.parentElement,2,pa)})}Xjf(){this.cardViewManager&&this.cardViewManager.HOa(-1,-1,this.parentElement)}lmh(){const pa={layoutId:"AutoDetectTooltip"};pa.description=this.longDescription;pa.convertToDomainName=this.convertToDomainName;pa.longDescription=this.longDescription;pa.urlValue=this.urlValue;pa.imageAltText=this.imageAltText;
pa.helpText=this.helpText;pa.helpId=this.helpId;return pa}}Object(u.a)(w,"AutoDetectCardManager",null,[]);var r=a(35),t=a(217),A=a(34),y=a(231),z=a(19),E=a(54);class G extends k.a{constructor(pa,aa,Z){super();this.Gd=fa=>{if(fa.tc.id===this.VLa.firstChild.id){fa=this.FDe;const ya={};ya.Id=fa.ytb;this.convertToLinkedEntityManager.P$c(ya,!0,fa);this.VLa.removeChild(this.VLa.firstChild);return!0}return!1};this.FDe=pa;this.convertToLinkedEntityManager=aa;this.VLa=document.createElement("div");this.VLa.className=
"clip16x16";this.Yya=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',A.a.ki("autodetectid"+this.FDe.left),z.a.Wgd,E.a.dg(11));Z.Oh(this.VLa,this.Yya);pa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");y.a.instance.ta(d.a.click,pa,this.Gd)}get domElement(){return this.VLa}dispose(){if(this.VLa){const pa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");y.a.instance.Aa(d.a.click,pa,this.Gd)}super.dispose()}static get t9g(){return"clip16x16"}}
Object(u.a)(G,"AutoDetectColumnHeaderButton",k.a,[]);var F=a(1),O=a(1095),M=a(12),P=a(20),B=a(190);class D extends k.a{constructor(pa,aa,Z){super();this.oc=null;this.$=pa;this.gridView=P.h(pa);this.convertToLinkedEntityManager=aa;this.oc=Z;this.y9c=new B.a}dispose(){super.dispose()}tyh(pa){for(let aa of this.gridView.cka)for(let Z of aa){const fa=Z,ya=fa.Ju,Aa=O.a(fa.R6);this.uSg(pa,Aa,ya);fa.YXd(Aa)}}uSg(pa,aa,Z){if(aa.length){var fa=Z.length;Z[fa-1]<pa.left||(Z=M.HelperMethods.Jy(new t.a(Z),0,fa,
pa.left,M.HelperMethods.SG),0>Z||!(aa=aa[Z]))||(this.gridView.rtl?aa.classList.add(r.a.xMh):aa.classList.add(r.a.wMh),this.y9c.Fb(pa.left)||this.y9c.add(pa.left,new G(pa,this.convertToLinkedEntityManager,this.oc)),pa=this.y9c.ma(pa.left).domElement,!aa.getElementsByClassName(G.t9g).length&&this.r0j(aa)&&aa.appendChild(pa))}}r0j(pa){const aa=parseInt(pa.style.width,10);var Z=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";Z=D.Xnh(Z);pa=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.oc.zdi(pa.firstChild.innerHTML),
Z,!0,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<aa-(aa/2+pa/2)?!0:!1}static Xnh(pa){return`${"normal"} ${"normal"} ${pa} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(u.a)(D,"AutoDetectColumnHeaderManager",k.a,[]);var I=a(433),S=a(25),J=a(73),L=a(151),R=a(13),Y=a(16),Q=a(128),W=a(69);a.d(C,"a",function(){return Ga});class Ga extends k.a{constructor(pa,aa,Z,fa,ya){super();this.isMac=f.a.isMac;this.Q0a=
-1;this.rac=null;this.ewa=-1;this.zO=this.Mpc=this.I0d=this.d1=this.GDe=!1;this.eV=null;this.Xe=()=>{this.iza&&this.gridView&&this.yY()};this.Xc=()=>{this.Nx()};this.Gd=()=>{this.ZKa();P.h(this.$).Qg(!0,!1)};this.bfa=(ja,za)=>{za?(this.vsg(this.rac),this.aib()):(ja=[29],this.gridView.dc.Hk(ja),this.gridView.dc.il(null,ja),this.eV&&this.eV.Xjf())};this.Cj=()=>{this.A$a()&&this.Oi.hide();1===this.gridView.ga.gf&&this.yY()};this.Zx=()=>{const ja=this.gridView.ga.gf;this.gridView.ga.pa.activeCell&&1===
ja&&this.yY()};this.onKeyUp=ja=>this.HHb?this.d1?!1:17===ja.Da.keyCode&&this.I0d?(this.zO?(this.aib(),this.$fa()):this.jRb(),!0):!1:this.d1=!1;this.onKeyDown=ja=>{if(!this.HHb)return this.d1=!1;this.I0d=!1;this.d1=ja.ctrlKey;switch(ja.Da.keyCode){case 27:return this.zO?(this.bfa(null,!1),this.$fa()):this.eV&&(this.eV.Xjf(),this.jRb()),!0;case 13:if(this.zO)return this.zO=!1,this.ZKa(),!0;break;case 17:return this.I0d=!0}return!1};const {AutoDetectActionButton:Aa}=a(1386);this.$=pa;this.ztb=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",
!1);aa||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=fa;fa.EMb();this.Oi=new Aa(pa,aa,this.Gd,Z,"");this.X3g=new D(this.$,fa,ya);this.gridView=P.h(this.$);this.gridView.ga.sx(this.Xe);this.gridView.wc.j1a(this.Xe);this.gridView.jt(this.Zx);pa.Xj(this.Xc);pa.dA(this.Cj);this.gridBlockManager=Object(h.a)(531,this.gridView.Ca);this.yp=pa.frame.Xu;this.yY()}get Lc(){return this.Oi.domElement(1)}get HHb(){const pa=
this.Oi.domElement(Ga.bha);return pa?R.DOMElementExtensions.isVisible(pa):!1}get iza(){return this.$.isEditMode&&F.EwaSettings.ya(128)&&F.EwaSettings.ya(131)&&(new L.a(this.$.ua)).$h?!1:-1!==this.ewa}dispose(){this.gridView&&this.gridView.ga.Ww(this.Xe);if(this.$){const pa=this.$;pa.Ll(this.Xc);pa.UC(this.Cj);P.h(pa).Rv(this.Zx)}e.a.Ka(this.Oi);this.yp=this.$=this.gridView=this.Oi=null;super.dispose()}Nx(){this.bfa(null,!1);this.Q0a=-1;this.Oi.hide();this.ibk();this.zO=!1}$fa(){this.Oi.getButton(Ga.bha).egb();
this.zO=!1}jRb(){this.Oi.getButton(Ga.bha).ZSa();this.vsg(this.rac);this.zO=!0;this.$.da.Gb(211,pa=>{pa.tpa(Y.a.instance.ha(1751))})}onAutoDetectUIShown(){if(this.iza&&-1!==this.Q0a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}Y3g(pa){var aa=new S.Range(1===pa.top?1:pa.top-1,pa.left,pa.bottom,pa.right,!0,!1);aa=this.gridView.getRangeInformation(aa);for(const Z of aa)if(Object(l.a)(I.AutoDetectRange,Z)&&this.zmc(pa,!1,Z))return!0;return!1}ZKa(){if(this.iza&&-1!==this.Q0a){this.Oi.getButton(Ga.bha).ZSa();
var pa={};pa.Id=this.ewa;pa.StringId=null;this.convertToLinkedEntityManager.P$c(pa,!0,this.rac);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");pa=[Object(c.a)(new W.a,{name:"Domain",int64:this.ewa})];Q.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,pa);this.ewa=-1}}P0h(){let pa=Y.a.instance.ha(1747);if(-1!==this.ewa){pa+=" ";try{pa+=this.convertToLinkedEntityManager.dHb(this.ewa.toString())}catch(aa){b.ULS.sendTraceTag(537166982,0,10,
`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.ewa}`)}}pa+=" ";return pa=this.ztb?pa+Y.a.instance.ha(1750):pa+Y.a.instance.ha(this.isMac?1749:1748)}aib(){this.ztb&&(this.eV||(this.eV=new w(this.Lc,this.$),this.eV.convertToDomainName=Y.a.instance.ha(1752),this.eV.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.eV.imageAltText=Y.a.instance.ha(1754),this.eV.helpId="HID_DataTypes_Wolfram",this.eV.helpText=
Y.a.instance.ha(1753)),this.eV.longDescription=this.convertToLinkedEntityManager.F4d(this.Q0a.toString()),this.eV.kmh())}zmc(pa,aa,Z){if((new S.Range(Z.top,Z.left,Z.bottom===n.a.Hg?Z.bottom:Z.bottom+1,Z.right,!0,!1)).Nd(pa)){if(aa){if(Z&&Z.ytb!==this.Q0a){this.Q0a=Z.ytb;pa=Z.ytb.toString();aa=this.ztb?"":this.convertToLinkedEntityManager.F4d(pa);const fa=this.convertToLinkedEntityManager.pqi(pa);this.Oi.ekb(this.convertToLinkedEntityManager.dHb(pa),aa,fa,Ga.bha)}this.ewa=Z.ytb;this.rac=Z}return!0}return!1}yY(){if(this.convertToLinkedEntityManager){var pa=
this.gridView.ga.gf;if(this.gridBlockManager&&this.gridBlockManager.vrd){var aa=this.gridView.ga.pa.activeCell,Z=!this.gridBlockManager.Fr(aa),fa=this.gridView.getRangeInformation(this.gridView.hk);for(const ya of fa)if(Object(l.a)(I.AutoDetectRange,ya))switch(fa=ya,fa.Sdh){case 3:if(this.zmc(aa,!0,fa)){if(1!==pa||Z){this.Nx();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.YQd();this.Oi.B2(aa,this.bfa);this.GDe||(this.GDe=!0,
this.onAutoDetectUIShown());return}break;case 2:case 1:(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.X3g.tyh(fa);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Nx()}}vsg(pa){const aa=[29];this.gridView.dc.il(pa,aa);this.gridView.dc.Ur(aa)}A$a(){return this.$.ea.isNamedObjectViewMode&&
J.f(this.$.na)}YQd(){this.ztb&&!this.Mpc&&this.yp&&(this.yp.Jt(d.a.yc,this.$.domElement,this.onKeyDown,!0),this.yp.Jt(d.a.te,this.$.domElement,this.onKeyUp,!0),this.Mpc=!0)}ibk(){this.ztb&&this.Mpc&&this.yp&&(this.yp.Vt(d.a.yc,this.$.domElement,this.onKeyDown,!0),this.yp.Vt(d.a.te,this.$.domElement,this.onKeyUp,!0),this.Mpc=!1)}static get bha(){return 1}static W2h(pa){return Y.a.instance.ha(1808)+v.a.space+pa}}Object(u.a)(Ga,"AutoDetectManager",k.a,[])},1290:function(u,C,a){var c=a(10);u=a(0);var b=
a(229),f=a(15),e=a(42),d=a(1);class h extends e.a{constructor(){super()}k5d(v,x){f.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${v}, TriggerType: ${x}`);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(x){case 0:this.raiseEvent("pssort",void 0,v);break;case 1:this.raiseEvent("psfilter",void 0,v);break;case 2:this.raiseEvent("pscrttbl",void 0,v)}}}
Object(u.a)(h,"ProactiveSuggestionManager",e.a,[482]);var l=a(725);class k extends b.a{constructor(v){super();this.$=v;this.kc()}create(){let v=Object(l.a)(this.$.da,476,()=>new h);this.Pb(v)}static la(v){v.da.Ja(475,new k(v))}}Object(u.a)(k,"ProactiveSuggestionManagerFactory",b.a,[]);a.d(C,"a",function(){return n});const n=()=>{c.a.Fa(v=>{k.la(v)})}},1291:function(u,C,a){var c=a(10);u=a(0);var b=a(84),f=a(229),e=a(233),d=a(33),h=a(20);class l{constructor(x,w){this.dqe=this.zSc=!1;this.MBa=(r,t)=>
{(null===t||void 0===t?0:t.wI)&&d.a.q2g([t.wI])&&(this.cQb=!0)};this.Tn=()=>{this.cQb=!1};this.zd=(r,t)=>{e.b(t)&&this.aha(!0);this.cQb=!1};this.Td=()=>{this.mS=this.$.mS;this.aha()};this.vQf=()=>{this.QT()};this.zPf=()=>{this.mS=this.$.mS};this.DId=()=>{h.h(this.$).Ca.Vw(this.DId);this.mS=this.$.mS};this.s$f=w;this.$=x;this.$.userOperationManager.ks(this.zPf);this.$.Ql(this.Td);this.$.ea.LYg(this.vQf);this.$.ea.pk(this.zd);this.$.F4b(this.MBa);this.$.ea.DK(this.Tn);this.aha()}get zLi(){return this.$.ea?
this.$.ea.Exf:!1}get mS(){return this.zSc}set mS(x){x?this.zSc=!0:h.h(this.$)&&h.h(this.$).Ca&&(h.h(this.$).Ca.g7()?this.zSc=!1:h.h(this.$).Ca.rw(this.DId));this.QT()}get cQb(){return this.dqe}set cQb(x){this.dqe=x;this.QT()}dispose(){this.$&&(this.$.Rm(this.Td),this.$.dAc(this.MBa),this.$.userOperationManager&&this.$.userOperationManager.Uo(this.zPf),this.$.ea&&(this.$.ea.xzj(this.vQf),this.$.ea.Kk(this.zd),this.$.ea.rP(this.Tn)),h.h(this.$)&&h.h(this.$).Ca&&h.h(this.$).Ca.Vw(this.DId))}aha(x=!1){x=
!this.$.isEditMode||x;this.s$f.aha(x,this.$.isEditMode?3:1);this.QT()}QT(){this.$.isEditMode&&this.s$f.QT(!this.mS&&!this.zLi&&!this.cQb)}}Object(u.a)(l,"SaveStatusManager",null,[2]);var k=a(725);class n extends f.a{constructor(x){super();this.Fd=x;this.kc()}create(){const x=b.a.instance;x.qc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(w=>{const r=new l(this.Fd,w);x.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Uc().dd(()=>r);w=Object(k.a)(this.Fd.da,300,
()=>x.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.Pb(w)})}static la(x){x.da.Ja(299,new n(x))}}Object(u.a)(n,"SaveStatusFactory",f.a,[]);a.d(C,"a",function(){return v});const v=()=>{c.a.Fa(n.la)}},1292:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(40),e=a(20),d=a(15),h=a(35),l=a(217),k=a(25),n=a(73),v=a(1095),x=a(12),w=a(168),r=a(14),t=a(179),A=a(231),y=a(161),z=a(70),E=a(95),G=a(151);class F{constructor(J,L,R){this.NQa=1;this.Taa=[];this.active=!1;this.oc=
null;this.onPointerDown=Y=>{y.a.slim(Y.Da.rawEvent);return!1};this.dy=()=>{const Y=this.gridView.Spd();if(!(0>=Y||Y===this.NQa||this.gridView.Tr)){var Q=!1,W=[],Ga=[];for(var pa=this.Taa.length-1;0<=pa;pa--){var aa=this.Taa[pa];if(this.Rpd(aa)>Y||aa.bottom<Y)W.push(aa),this.Taa.splice(pa,1),Q=!0}for(pa=this.tableManager.rangeList.length-1;0<=pa;pa--){aa=this.tableManager.rangeList[pa];const Z=this.Rpd(aa);Z<=Y&&aa.bottom>=Y&&!(Z<=this.NQa&&aa.bottom>=this.NQa)&&aa.Jma&&(Ga.push(aa),Q=!0)}if(Q){aa=
this.gridView.Bwc;for(let Z of aa)for(let fa of Z)for(let ya of fa)this.rnc?this.qdh(ya,W,Ga):this.rdh(ya,W,Ga,Q)}else d.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.NQa=Y}};this.SMf=(Y,Q)=>{Q.isRow||Q.X2c(this.ekc)};this.TMf=(Y,Q)=>{Q.isRow||(this.tableManager.rangeList.length||this.deactivate(),Q.PSd(this.ekc))};this.ekc=(Y,Q)=>{if(this.xe())this.activate();else if(Y=this.active,this.deactivate(),!Y){d.ULS.sendTraceTag(537157652,
0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Q=Q.Nq)&&this.ckg(Q.R6,Q)};this.APf=(Y,Q)=>{!this.gridView.Tr&&(this.xe()?this.activate():(Y=this.active,this.deactivate(),Y||d.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Q=Q.Nq)&&(Y=v.a(Q.R6),this.ckg(Y,Q)&&Q.YXd(Y))};this.Ee=()=>{this.gridView.Cb.HW?this.deactivate():this.activate()};this.tableManager=J;this.gridView=
L;this.$=L.$;this.oc=R;J.H2c(this.APf);L.XWg(this.SMf);L.YWg(this.TMf);this.$.ua.Lg(this.Ee);this.$.Zb.Lg(this.Ee);this.$Be(Y=>{Y.X2c(this.ekc)});this.xe()&&(this.activate(),this.dy(this,null));this.$.da.Ja(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.DSd(this.APf),this.gridView.cyj(this.SMf),this.gridView.dyj(this.TMf),this.$.ua.ih(this.Ee),this.$.Zb.ih(this.Ee),this.$Be(J=>{J.PSd(this.ekc)}));this.gridView=this.tableManager=this.Taa=null}get rnc(){return this.gridView.zE}QHc(J,
L,R){if(!n.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.Cb.wEa)return L&&d.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const Y=R.Gff();var Q=Y.length;if(Y[Q-1]<J.left)return!1;var W=x.HelperMethods.Jy(new l.a(Y),0,Q,J.left,x.HelperMethods.SG);if(0>W)return!1;const Ga=J.i4d,pa=J.JDe;Q=Math.min(Ga.length+W,Q);let aa=0;if(!pa)return d.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),
!1;for(;W<Q;W++){const Z=Y[W];L?(R.updateCellText(W,Ga[aa]),R.updateCellAlignment(W,!0),R.activateCellAutoFilter(W,pa[aa]),this.qwe(J,aa,Z)):(R.updateCellText(W,k.Range.nR(Z)),R.updateCellAlignment(W,!1),R.deactivateCellAutoFilter(W),this.zVe(Z));L&&R.LNj();aa++}R.Tm("HeaderSnappingFeature::toggleHeaderSnapping");J.QDa=L;return!0}RHc(J,L,R,Y){if(!n.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.Cb.wEa)return!0;if(!R.length)return!1;var Q=Y.length;if(Y[Q-1]<J.left)return!1;var W=x.HelperMethods.Jy(new l.a(Y),
0,Q,J.left,x.HelperMethods.SG);if(0>W)return!1;const Ga=J.i4d,pa=!!J.W2a&&0<J.W2a.length,aa=!!J.menuModel&&0<J.menuModel.length;for(let ya=W,Aa=0,ja=Math.min(Ga.length+W,Q);ya<ja;ya++,Aa++)if(Q=R[ya]){var Z=null;(W=Q.getElementsByClassName(h.a.mhd))&&(Z=W[0]);if(Z&&Z.innerText){if(W=Q.getElementsByClassName(h.a.Kze))for(var fa=W.length-1;0<=fa;fa--)Q.removeChild(W[fa]);W=Y[ya];L?(Z.innerText=Ga[Aa],Q.classList.add(h.a.g1e),pa&&J.W2a[Aa]&&(Z=document.createElement("div"),this.oc.Oh(Z,J.W2a[Aa]),fa=
J.W2a[Aa].split(z.a.D0g),3===fa.length?(fa=E.a.Mf(fa[1]),this.Hve(Z.firstChild,fa),w.a.instance.ta(r.a.Yf,Z.firstChild,this.onPointerDown),t.a.instance.ta(r.a.nq,Z.firstChild,this.onPointerDown)):(fa=new G.a(this.$.ua),(fa.xe(2048)||fa.xe(4096))&&d.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.Hve(Z.firstChild,null)),aa&&J.menuModel[Aa]&&this.qwe(J,Aa,W),Q.appendChild(Z.firstChild))):
(Q.classList.remove(h.a.g1e),Z.textContent=k.Range.nR(W),this.zVe(W))}}J.QDa=L;return!0}Hve(J,L){A.a.instance.ta(r.a.click,J,R=>{L&&y.a.hrc(R.Da.rawEvent,966232027,L,this.$.get_id());return!0})}qwe(J,L,R){this.$.da.Gb(8,Y=>{Y.Yec.l7i(J,L,R)})}zVe(J){this.$.da.Gb(8,L=>{L.Yec.m7i(J)})}rdh(J,L,R,Y){const Q=J.Ju,W=v.a(J.R6);let Ga;for(let pa=L.length-1;0<=pa;pa--)Ga=L[pa],this.RHc(Ga,!1,W,Q)&&L.splice(pa,1);for(L=R.length-1;0<=L;L--)Ga=R[L],this.RHc(Ga,!0,W,Q)&&this.Taa.push(Ga);Y&&J.YXd(W)}qdh(J,L,R){if(J.sah()){for(var Y=
L.length-1;0<=Y;Y--)this.QHc(L[Y],!1,J)&&(d.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),L.splice(Y,1));for(L=R.length-1;0<=L;L--)Y=R[L],this.QHc(Y,!0,J)&&(d.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.Taa.push(Y))}else d.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}ckg(J,L){const R=this.rnc?L.Gff():
L.Ju;var Y=R[0];const Q=R[R.length-1],W=this.Zgi(Y,Q);let Ga=!1;for(let pa=this.Taa.length-1;0<=pa;pa--){const aa=this.Taa[pa];Q>=aa.left&&Y<=aa.right&&(this.rnc?this.QHc(aa,!1,L):this.RHc(aa,!1,J,R),this.Taa.splice(pa,1),Ga=!0)}for(let pa=0,aa=W.length;pa<aa;pa++)if(Y=W[pa],this.rnc?this.QHc(Y,!0,L):this.RHc(Y,!0,J,R))this.Taa.push(W[pa]),Ga=!0;return Ga}activate(){this.xe()&&!this.active&&(this.gridView.view.ls(this.dy),this.active=!0)}deactivate(){this.active&&(this.gridView.view.oq(this.dy),this.active=
!1)}xe(){return n.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.Cb.oQ&&0<this.tableManager.rangeList.length}$Be(J){const L=this.gridView.Bwc;for(let R of L)for(let Y of R)for(let Q of Y)J(Q)}Zgi(J,L){const R=[];if(!this.active)return R;this.NQa=this.gridView.Spd();for(let Y=this.tableManager.rangeList.length-1;0<=Y;Y--){const Q=this.tableManager.rangeList[Y];Q.bottom>=this.NQa&&this.Rpd(Q)<=this.NQa&&Q.left>=J&&Q.right<=L&&Q.Jma&&R.push(Q)}return R}Rpd(J){const L=this.gridView.Mb.ph(J);
return L&&this.tableManager.crf(J,L.usedRange.topLeft)?J.top+1:J.top}}Object(u.a)(F,"HeaderSnappingFeature",null,[2]);var O=a(1),M=a(100),P=a(149),B=a(36),D=a(52);class I extends b.a{constructor(J){super();this.$=J;this.kc()}create(){const J=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?Object(M.d)(P.a.resolve(B.ub,{Wa:this.La})):D.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.La),L=Object(M.d)(P.a.resolve(B.S,{Wa:this.La}));f.TaskExtensions.za(f.TaskExtensions.ke([L],
this.ka),()=>{f.TaskExtensions.za(f.TaskExtensions.ke([J],this.ka),()=>{this.Pb(this.$.da.Ba(68)||new F(J.result,e.h(this.$),L.result))},this.ka,11)},this.ka,3)}static la(J){J.da.Ja(67,new I(J))}}Object(u.a)(I,"HeaderSnappingFactory",b.a,[]);a.d(C,"a",function(){return S});const S=()=>{c.a.Fa(I.la)}},1293:function(u,C,a){u=a(0);var c=a(15),b=a(88),f=a(1387),e=a(1105),d=a(6),h=a(14),l=a(112),k=a(178);class n{constructor(y,z,E,G,F){this.fRc=this.zHa=null;this.uZa=this.gMc=!1;this.Ce=z;this.N_b=y;this.Ysa=
E;this.FQ=G;this.bWc=F;this.l2f(null)}l2f(){const y=document.getElementById(d.AFrameworkApplication.Psb);!this.uZa&&this.FQ&&y&&(this.FQ.ta(h.a.WAa,y,Object(b.a)(this,this.XFd,"mouseActivityHandler"),null),this.uZa=!0);this.bWc(()=>{this.dispose()})}XFd(){this.uZa&&(this.FQ.Aa(h.a.WAa,document.getElementById(d.AFrameworkApplication.Psb),Object(b.a)(this,this.XFd,"mouseActivityHandler")),this.uZa=!1);this.Zue();return!1}Zue(){this.gMc=!0;this.fRc||(this.fRc=new l.a(3,2,this.N_b,Object(b.a)(this,this.l2f,
"registerHandlerTask"),112),this.Ce.jg(this.fRc));this.zHa||(this.CQb(null),this.zHa=new l.a(3,2,this.N_b,Object(b.a)(this,this.CQb,"sendPostMessageIfNecessary"),111),this.Ce.jg(this.zHa))}CQb(){this.gMc&&(this.Ysa.CWR(()=>this.Ysa.result.sendMessage(k.a.Chk,null)),c.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.gMc=!1)}dispose(){this.uZa&&(this.FQ.Aa(h.a.WAa,document.getElementById(d.AFrameworkApplication.Psb),Object(b.a)(this,this.XFd,
"mouseActivityHandler")),this.uZa=!1)}}Object(u.a)(n,"UserActivityHostNotificationManager",null,[582,2]);var v=a(179),x=a(260),w=a(108),r=a(528);class t{constructor(){this.Db=null}get name(){return"Common.App.EditNotification"}init(){d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.Hv(Object(b.a)(this,this.DC,"onFullAppSettingsReady"))}DC(){t.editNotificationIsEnabled&&0<t.Wed&&(this.Db.register(f.a,"Common.App.HostNotification.EditNotificationEventSource").Uc(),this.Db.register(n,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").Uc().dd(()=>
new n(6E4,w.a.instance,r.a.dr(this.Db.qc("Postmessage.IHostPostmessenger")),v.a.instance,d.AFrameworkApplication.zib)),this.Db.register(e.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").Uc().dd(()=>new e.a(t.Wed,w.a.instance,r.a.dr(this.Db.qc("Postmessage.IHostPostmessenger")),this.Db.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Db.ah("Common.Interface.IUserActivityHostNotificationManager"),t.editNotificationPostMessageIsEnabled,
t.ZAh)),this.Db.resolve("Common.Interface.IEditNotificationManager"),c.ULS.shipAssertTag(38086291,209,0<t.Wed,"EditNotification Interval is less than or equal to 0."))}Di(y){this.Db=y}dispose(){}static get Wed(){return d.AFrameworkApplication.fa?parseInt(d.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get ZAh(){return d.AFrameworkApplication.fa?parseInt(d.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get editNotificationIsEnabled(){return!!d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.ra("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.ra("EditNotificationPostMessageIsEnabled")}static main(){x.a.instance.nj(new t)}}Object(u.a)(t,"CommonHostNotificationPackage",null,[4,5]);a.d(C,"a",function(){return A});const A=()=>{Type.registerNamespace("Common.App.HostNotification");t.main()}},
1294:function(u,C,a){u=a(0);var c=a(88),b=a(111),f=a(929),e=a(744),d=a(26);class h{constructor(x,w){this.Fmb=null;this.Na=x;this.Ta=w}vh(){(this.Fmb=this.Ta.Va("StatusBarEnvironmentNameToUse"))&&""!==this.Fmb&&this.Na.ef(d.a.fZf,b.a.frame,Object(c.a)(this,this.$dk,"updateEnvironmentName"),96)}$dk(x,w,r,t,A){if(1===r)return 32;A[f.a.Value]=this.Fmb;A[e.a.Fi]=this.Fmb;A[f.a.Visible]=!0;return 32}}Object(u.a)(h,"DisplayEnvironmentName",null,[]);var l=a(6),k=a(260);class n{constructor(){this.Db=null}get name(){return"Common.App.DisplayEnvironmentName"}Di(x){this.Db=
x;this.Db.register(h,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Uc().dd(()=>new h(l.AFrameworkApplication.Qb,l.AFrameworkApplication.fa))}init(){this.Db.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").vh()}dispose(){}static main(){k.a.instance.nj(new n)}}Object(u.a)(n,"DisplayEnvironmentNamePackage",null,[4,5]);a.d(C,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.DisplayEnvironmentName");n.main()}},1295:function(u,C,a){var c=a(10);u=
a(0);var b=a(229),f=a(15),e=a(34),d=a(94),h=a(200),l=a(58),k=a(12),n=a(246),v=a(465),x=a(20),w=a(114),r=a(128),t=a(55);class A{constructor(G){this.kW=null;this.XAf=new Set;this.Tuf=!1;this.h1=(F,O)=>{if(!this.XAf.has(F)){var M=[];if(O){const P=x.h(this.$).Mb.ph(O,!1);if(!P){1!==O.top||1!==O.left||this.Tuf||(M.push(w.a.ug("IsTableOnA1","false",1)),r.a("MsFormsTableUsage",void 0,void 0,M),this.Tuf=!0);return}if(1!==P.usedRange.top||1!==P.usedRange.left)return}O=t.b().jk(F);M.push(w.a.ug("Command",O,
2));r.a("MsFormsTableUsage",void 0,void 0,M);this.XAf.add(F)}};this.X6d=(F,O)=>{if(!this.$.ea.oh.get(61)||d.k(this.$.tf))d.k(this.$.tf)&&O&&O.item.name===this.kW.oL&&this.MDe();else if(this.$.ua.fl(this.kW.Kzb)){const M={};M.SheetName=this.kW.Kzb;M.NamedObjectName=this.kW.Kzb;M.FirstColumn=0;M.FirstRow=0;M.LastColumn=0;M.LastRow=2;const P=D=>{if(!d.k(this.$.tf)){if(null===D||void 0===D?0:D.Result)this.$.workbookContext.MsFormId=D.Result[0][0],this.kW.oL=D.Result[1][0],D=D.Result[2][0],this.uM(!!this.$.workbookContext.MsFormId&&
this.uJi(D),1024),this.MDe();d.c(this.$.tf)&&(O?f.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${e.a.rv(this.$.workbookContext.MsFormId).toString()}`):f.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${e.a.rv(this.$.workbookContext.MsFormId).toString()}`));d.c(this.$.tf)&&!O&&f.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${e.a.rv(this.$.workbookContext.MsFormId).toString()}`);!d.c(this.$.tf)&&
O||this.uM(!0,2048)}},B=this.$.qa.va.Bc();this.$.userOperationManager.lG(new h.a(159,0,(D,I,S)=>l.r(this.$.qa.Yx,M,!1,n.b(D,P),I,S,null,B),16))}else O||this.uM(!0,2048)};this.k9i=(F,O)=>{O&&O.item.name===this.kW.Kzb&&(this.uM(!1,1024),this.uM(!0,2048))};this.$=G}W$j(){this.kW=v.a.current;this.X6d(null,null);this.$.ua.eja(this.X6d);this.$.ua.UZ(this.k9i)}dispose(){this.$.ua.Epa(this.X6d)}uJi(G){if(!G)return!0;const F=RegExp("-","g"),O=this.$.workbookContext.MsFormDocUrl.toLowerCase();return O.includes(G.toLowerCase())||
O.includes(G.toLowerCase().replace(F,""))?!0:!1}MDe(){d.c(this.$.tf)&&this.kW.oL&&this.$.ua.na&&this.$.ua.na.name!==this.kW.oL&&this.$.ua.fl(this.kW.oL)&&this.$.ua.getItemByName(this.kW.oL).activate()}uM(G,F){this.$.workbookContext.Options=k.HelperMethods.KP(G,this.$.workbookContext.Options,F)}}Object(u.a)(A,"MsFormInfoUpdatingService",null,[580,2]);var y=a(725);class z extends b.a{constructor(G){super();this.msFormInfoUpdatingService=null;this.$=G;this.kc()}create(){this.Pb(Object(y.a)(this.$.da,
237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new A(this.$))));this.msFormInfoUpdatingService.W$j()}static la(G){G.da.Ja(236,new z(G))}}Object(u.a)(z,"MsFormInfoUpdatingServiceFactory",b.a,[]);a.d(C,"a",function(){return E});const E=()=>{c.a.Fa(z.la)}},1320:function(u,C,a){u=a(0);var c=a(229),b=a(989);class f extends c.a{constructor(l){super();this.$=l;this.kc()}create(){this.Pb(this.$.da.Ba(5)||new b.BusinessBarManager(this.$,!this.$.F0))}static la(l){l.da.Ja(4,new f(l))}}
Object(u.a)(f,"BusinessBarManagerFactory",c.a,[]);var e=a(10),d=a(71);a.d(C,"a",function(){return h});const h=()=>{Object(d.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")||e.a.Fa(f.la)};String(b);window.___1684305449194_closurehack=b},1321:function(u,C,a){u=a(0);var c=a(825),b=a(229);class f extends b.a{constructor(){super();this.kc()}create(){this.Pb(new c.a)}}Object(u.a)(f,"CommonUIJsServiceFactory",b.a,[]);var e=a(10);a.d(C,"a",function(){return d});const d=()=>{e.a.Fa(h=>{h.da.Ja(203,
new f)})}},1322:function(u,C,a){u=a(0);var c=a(159),b=a(617);class f extends b.a{constructor(){super()}dispose(){c.WacAirSpace.kvd()&&c.WacAirSpace.PHc()}animate(h,l,k,n,v){l&&c.WacAirSpace.sM(h.element,l);c.WacAirSpace.animate(h,n,v);k&&c.WacAirSpace.Cvj(h.element,k)}}Object(u.a)(f,"AnimationManager",b.a,[2]);var e=a(104);a.d(C,"a",function(){return d});const d=()=>{e.a.rm.Ja(141,new f)}},1331:function(u,C,a){u=a(0);var c=a(229),b=a(52),f=a(40),e=a(1),d=a(15);class h{constructor(k){this.RVa=!0;h.Pof()?
h.Tyi()?this.RVa=!1:h.$of()?(d.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!k}`),this.RVa=k):this.RVa=!1:this.RVa=!0}s$a(){return!this.RVa}static $of(){return h.Pof()&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",!1)}static Pof(){return e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)}static Tyi(){return e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",
!1)}}Object(u.a)(h,"LineageCatchUpExperimentManager",null,[593]);a.d(C,"a",function(){return l});class l extends c.a{constructor(k){super();this.$=k;this.kc()}create(){h.$of()?f.TaskExtensions.za(b.GetServiceTaskFactory.Za(this.$.da,456,457,this.La),k=>{f.TaskExtensions.za(k.result.yVj(),n=>{this.ROe(n.result)},this.$.ka,3)},this.$.ka,3):this.ROe(!0)}ROe(k){this.Pb(this.$.da.Ba(458)||this.$.da.Ja(458,new h(k)))}static la(k){k.da.Ja(459,new l(k))}}Object(u.a)(l,"LineageCatchUpExperimentManagerFactory",
c.a,[])},1332:function(u,C,a){u=a(0);var c=a(229),b=a(52),f=a(40),e=a(15),d=a(7),h=a(79),l=a(58),k=a(91),n=a(1);class v{constructor(r,t){this.Dyd=!1;this.fg=()=>{this.Spg()};this.$=r;this.$.ea.kbb&&!v.DCb&&(t&&!t.RVa||this.Djk(),v.Cif?e.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):t&&!t.RVa||this.Ljk());e.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.HRd();
this.$=null;e.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){v.DCb||(v.DCb=!0,e.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.HRd()}Ljk(){this.$.isAnonymousUser()||l.i(this.$.qa.va,r=>{this.$?(r=r.Result,e.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${r}.`),v.Cif=!0,r&&this.Hpg(0)):e.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},
()=>{e.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}Djk(){this.Spg()||(this.$.ea.nv(this.fg),this.Dyd=!0)}Spg(){return this.$.ea&&this.$.ea.Pn&&this.$.ea.Pn.ShouldTriggerLineageCalloutOnMerge?(e.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.Hpg(1),!0):!1}Hpg(r){v.DCb?e.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):
(v.DCb=!0,e.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${r}.`),this.HRd(),n.EwaSettings.ya(418)&&(r=new k.a(-847286761,h.a.Vb,this.$.Kc,0,d.a.U1),this.$.Ia.$b(r,{["CalloutName"]:4})))}HRd(){this.Dyd&&(this.Dyd=!1,this.$.ea.Xw(this.fg))}}v.DCb=!1;v.Cif=!1;Object(u.a)(v,"LineageTeachingCalloutTriggerManager",null,[592,2]);var x=a(725);a.d(C,"a",function(){return w});class w extends c.a{constructor(r){super();this.$=r;this.kc()}create(){f.TaskExtensions.za(b.GetServiceTaskFactory.Za(this.$.da,
458,459,this.La),r=>{const t=r.result;r=Object(x.a)(this.$.da,403,()=>new v(this.$,t));this.Pb(r)},this.$.ka,3)}static la(r){r.da.Ja(402,new w(r))}}Object(u.a)(w,"LineageTeachingCalloutTriggerManagerFactory",c.a,[])},1333:function(u,C,a){u=a(0);var c=a(229),b=a(15),f=a(247),e=a(7),d=a(272),h=a(30),l=a(259),k=a(13),n=a(20),v=a(732);const x=a(19).a.fMh;class w extends f.a{constructor(O,M,P){super(O);this.dx=0;this.Zt=!1;this.Xc=()=>{this.Dh(!1)};this.$=M;this.taskPaneManager=P;d.a(M).Pi(this);this.$.Xj(this.Xc);
h.a.Sd()&&(this.isVisible=!1)}YU(O){this.get_events().addHandler("EnrichmentTaskPaneRemoved",O)}$X(O){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",O)}LF(O){this.addHandler("EnrichmentTaskPaneVilibilityChanged",O)}eH(O){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",O)}VXg(O){this.addHandler("EnrichmentTaskPaneOnFocus",O)}Qyj(O){this.removeHandler("EnrichmentTaskPaneOnFocus",O)}get isVisible(){return super.isVisible}set isVisible(O){super.isVisible=O;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get sg(){return this.isVisible}get Ge(){return l.a.qDh}get yi(){return 10}get vl(){return x}get iS(){return this.titleText}get titleText(){return"Enrichment"}get Wq(){return 300}get isResizable(){return!1}get Lc(){return this.domElement}get height(){return this.taskPaneManager.YP.offsetHeight}get pB(){return this.taskPaneManager.Bxa(this.Lc,
this.titleText,this.Wq,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Wq)}Jr(){return this.Zt}Mu(){return this.Zt}zX(){}dispose(){this.$&&this.$.Ll(this.Xc);this.taskPaneManager=this.$=null;super.dispose()}Qg(O,M){M||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!M}hi(O){return k.DOMElementExtensions.lg(this.Lc,O)}ek(){}Gk(){}Dh(O){this.Zt=O;const M=this.taskPaneManager;this.isVisible=O;h.a.Sd()?O?this.taskPaneManager.T8("EnrichmentTaskPane",
this.pB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(O&&0<M.gF.length&&(!M.si||10!==M.si.taskPane.yi||M.isCollapsed)&&M.JJ(this,!0),M.fD());O||(n.h(this.$).Qg(!0,!1),this.$.Wf())}EW(){return!1}static la(O,M){var P=O.fc;let B=document.getElementById(P+e.a.sXe);B||(B=v.a("div",O.fc+e.a.sXe,"cui-taskpane"),h.a.Sd()||(P=document.getElementById(P+e.a.uX),void 0!==P&&null!==P?P.appendChild(B):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${O.wE}`)));
P=O.da;return P.Ba(257)||P.Ja(257,new w(B,O,M))}}Object(u.a)(w,"EnrichmentTaskPane",f.a,[501,2,483,29]);var r=a(52),t=a(426),A=a(40),y=a(100),z=a(1),E=a(149),G=a(36);a.d(C,"a",function(){return F});class F extends c.a{constructor(O){super();this.Uh=this.aj=null;this.$=O;this.kc()}get TE(){this.aj||(this.aj=A.TaskExtensions.za(t.a(this.$),O=>{this.Uh=w.la(this.$,O.result)},this.ka,3));return this.aj}create(){const O=r.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.La),M=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",
!1)?Object(y.d)(E.a.resolve(G.p,{Wa:this.La})):r.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La);A.TaskExtensions.za(A.TaskExtensions.ts(A.TaskExtensions.ke([O,M],this.ka),()=>this.TE,this.ka),()=>{this.Pb(this.Uh)},this.ka,3)}dispose(){this.Uh=this.aj=this.$=null;super.dispose()}static la(O){O.da.Ja(258,new F(O))}}Object(u.a)(F,"EnrichmentTaskPaneFactory",c.a,[])},1348:function(u,C,a){u=a(0);var c=a(15),b=a(264);class f{constructor(h,l){this.testName=null;this.startTimeMs=0;this.isSuccess=
!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=h;this.caller=l;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(u.a)(f,"NetworkTestResult",null,[]);var e=a(594);a.d(C,"a",function(){return d});class d{constructor(h,l,k,n,v){this.url="";this.g9a=!1;this.Xib=-1;this.testIteration=
0;this.baseUrl=k;this.KJf=n;this.Gsd=l;this.result=new f(l,v)}runTest(){try{if(this.g9a)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.Gsd} is already mid way, not starting a new one.`),!1;this.reset();this.g9a=!0;this.result.startTimeMs=Date.now();const h=new b.QueryStringBuilder(this.baseUrl);h.C4("tid",this.result.startTimeMs.toString());this.url=h.toString();this.oJj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(h){return this.hzb("Exeption: "+
h.message),!1}}reset(){this.url="";this.result.reset();this.g9a=!1;this.Xib=-1}clearTimeout(){-1!==this.Xib&&(window.clearTimeout(this.Xib),this.Xib=-1)}oJj(){try{const h=new XMLHttpRequest;h.onreadystatechange=()=>{4===h.readyState&&(200===h.status?this.tTh():this.hzb(`Error when downloading resource. status code: ${h.status}, status text: ${h.statusText}`,h.status.toString()))};h.onerror=()=>{this.hzb(`Client error when attempting to download resource. status code: ${h.status}, response: ${h.statusText}`)};
this.Xib=window.setTimeout(()=>{this.Xib=-1;this.hzb("Request timeout")},1E4);h.open("GET",this.url,!0);h.send(null)}catch(h){this.hzb("Exeption: "+h.message)}}tTh(){this.g9a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=e.a(this.url),this.result.isSuccess=!0,this.A9b())}hzb(h,l=null){this.g9a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=l,this.A9b())}A9b(){this.g9a=
!1;this.KJf&&this.KJf(this.result,this.Gsd)}}Object(u.a)(d,"NetworkTestReq",null,[])},1386:function(u,C,a){a.r(C);a.d(C,"AutoDetectActionButton",function(){return d});u=a(0);C=a(86);var c=a(1286),b=a(54),f=a(16),e=a(20);class d extends C.a{constructor(h,l,k,n,v){super();this.$=h;this.Cq=n.w4a(h,l,k,"",b.a.dg(11),v,"AutoDetectPointerDown",f.a.instance.ha(1808)+"...")}get Gs(){return this.Cq.Gs}dispose(){this.Cq.dispose();this.$=null;super.dispose()}domElement(h){return this.Cq.domElement(h)}getButton(h){return this.Cq.getButton(h,
!1)}ekb(h,l,k,n){this.Cq.rXa(c.a.W2h(h),l,n);this.Cq.zJc(k,l,n)}B2(h,l){const k=e.h(this.$),n=k.Cb.ti(h);h=k.Vg(h,n);const v=k.og(n).am;if(h&&0<=h.x&&0<=h.y&&v.width>h.width+160){let x=h.bottomRight.x+this.Gs,w=h.topLeft.y+this.Gs,r=!1;x+160>v.bottomRight.x&&(x=h.topLeft.x-this.Gs,r=!0);if(w<v.topLeft.y+this.Gs){if(k.Cb.wEa){this.hide();return}w=v.topLeft.y+this.Gs}this.Cq.edc(l,n);this.dm(x,w,k.rtl,n,r)}else this.hide()}dm(h,l,k,n,v){this.Cq.dm(h,l,k,n,!1,v)}hide(){this.Cq.hide()}}Object(u.a)(d,
"AutoDetectActionButton",C.a,[])},1502:function(u,C,a){a.r(C);var c={};a.r(c);a.d(c,"UnifiedConsentAdapter",function(){return Bd});var b={};a.r(b);a.d(b,"ExtendedTooltipsManager",function(){return qe});var f=a(0),e=a(15),d=a(6),h=a(131),l=a(405);class k extends l.a{constructor(Yb){super(Yb)}get v$b(){return!1}createElement(){const Yb=document.createElement("link");Yb.setAttribute("rel","stylesheet");Yb.setAttribute("type","text/css");Yb.setAttribute("href",this.Yw);return Yb}Vad(){return null}lzc(){this.element.setAttribute("href",
"");this.element.setAttribute("href",this.eB.Yw)}}Object(f.a)(k,"CssResource",l.a,[]);var n=a(467),v=a(267),x=a(34),w=a(62);class r{constructor(){this.v0b=this.IYb=null}KNi(){this.IYb||(e.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.IYb=w.Task.WAA(r.RNi(),r.GNi()),this.IYb.continueWith(Yb=>{e.ULS.sendTraceTag(21030599,324,10,"{0}",x.a.Amd(Yb.exception))},5));return this.IYb}MNi(){if(!this.v0b)try{e.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),
this.v0b=w.Task.WAA(r.ufd(v.a.create(d.AFrameworkApplication.fa.Va("DimeUrl"),null,null))),this.v0b.continueWith(Yb=>{e.ULS.sendTraceTag(39978391,324,10,"{0}",x.a.Amd(Yb.exception))},5)}catch(Yb){e.ULS.sendTraceTag(594874951,324,10,"{0}",x.a.Amd(Yb))}return this.v0b}static RNi(){var Yb=r.Sic("inproductmessaging.js");Yb=v.a.create(Yb,null,null);return r.ufd(Yb)}static GNi(){var Yb=r.Sic("inproductmessaging.css");Yb=new k(Yb);return r.ufd(Yb)}static Sic(Yb){return h.a.Fvb(String.format("ipm/{0}",Yb))}static ufd(Yb){n.a.Uwa(Yb);
return Yb.nbb}}Object(f.a)(r,"DependencyDownloader",null,[614]);class t{}t.Cfj="inProductMessagingOverlayDiv";t.Fij="PlayButtonImage";t.PAj="ReplayButtonImage";Object(f.a)(t,"Constants",null,[]);class A{constructor(){this.ore=this.Ole=this.Yae=!0;this.QAj=this.Gij=null;this.hXi=!1;this.locale=null;this.hrg={}}get NDe(){return this.Yae}set NDe(Yb){this.Yae=Yb}get GEf(){return this.Ole}set GEf(Yb){this.Ole=Yb}get tig(){return this.ore}set tig(Yb){(this.ore=Yb)&&this.jPj()}jPj(){this.ixe(t.Fij,this.Gij);
this.ixe(t.PAj,this.QAj)}ixe(Yb,Nc){Nc&&(this.hrg[Yb]=Nc)}}Object(f.a)(A,"FirstRunExperienceUISettings",null,[613]);class y{constructor(){this.completed=this.svj=!1}}Object(f.a)(y,"FirstRunExperienceViewData",null,[612]);var z=a(88),E=a(191),G=a(111),F=a(26);class O{constructor(Yb,Nc,ud){this.Na=Yb;this.Kf=Nc;this.nZb=ud}vh(){this.Na.ef(F.a.STh,G.a.frame,Object(z.a)(this,this.QTh,"firstRunExperienceHandler"),64);this.Na.xc(F.a.B4e,G.a.frame,Object(z.a)(this,this.cri,"inProductMessagingTabHandler"));
this.Na.xc(F.a.A4e,G.a.frame,Object(z.a)(this,this.bri,"inProductMessagingShiftTabHandler"));this.Na.xc(F.a.Exh,G.a.frame,Object(z.a)(this,this.Fxh,"dimeLaunchHandler"));this.Na.xc(F.a.h6f,G.a.frame,E.ActionManager.Ug);this.Na.xc(F.a.oBj,G.a.frame,E.ActionManager.Ug);this.Na.xc(F.a.pBj,G.a.frame,E.ActionManager.Ug);this.Kf&&this.Kf.updateCommandUI()}QTh(Yb,Nc,ud,Mb,rc){2===ud&&this.nZb.eMi(rc);return 32}Fxh(Yb,Nc,ud,Mb,rc){2===ud&&this.nZb.bMi(rc);return 32}cri(Yb,Nc,ud){return 2===ud?this.nZb.bGd():
32}bri(Yb,Nc,ud){return 2===ud?this.nZb.ZFd():32}}Object(f.a)(O,"InProductMessagingActor",null,[]);var M=a(126);class P{constructor(){this.K2f=this.J7f=this.ing=this.xqc=this.instance=null}}Object(f.a)(P,"DimeExperienceUISettings",null,[]);var B=a(140),D=a(473);class I{constructor(Yb,Nc,ud,Mb,rc){this.Xfc=!1;this.xxb=null;this.Na=Yb;this.rIa=Nc;this.Z0b=ud;this.o3=Mb;this.NMc=rc}Yti(Yb){B.b("getHeaderApi")?Yb.isFeatureEnabled("MsoPremiumBadge",!0).then(Nc=>{const ud=Yb.isFreemiumUpsellEnabled();ud&&
(appChrome.getHeaderApi().then(Mb=>{Mb.updatePremiumStatus(Nc,ud);return null}),Yb.JTa("MsoPremiumBadge",Mb=>{appChrome.getHeaderApi().then(rc=>{rc.updatePremiumStatus(Mb.isEnabled,ud);return null})}));return null}):e.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}eMi(Yb){this.Z0b.KNi().continueWith(()=>{this.rIa.wZj(Yb)})}bMi(Yb){let Nc="gopremium",ud=null,Mb=()=>{};Yb?(Yb.experience&&""!==Object(M.a)(String,Yb.experience)&&(Nc=Object(M.a)(String,Yb.experience)),Yb.onTaskComplete&&
(Mb=Yb.onTaskComplete),Yb.campaignId&&""!==Object(M.a)(String,Yb.campaignId)&&(ud=Object(M.a)(String,Yb.campaignId))):e.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Uxf(Nc,Mb,ud)}Uxf(Yb,Nc,ud=null){if(this.Xfc&&this.xxb){const Mb={};Mb.experience=Yb||"gopremium";Mb.campaignId=ud||D.b(this.o3,this.NMc,Object(M.a)(String,Mb.experience),!0);this.Na.processAction(F.a.h6f,2);e.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Mb.experience);
try{const rc=Object.assign(new P,{instance:this.xxb,xqc:Mb,ing:Nc||(()=>{}),J7f:id=>{e.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+id.status)},K2f:()=>{e.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.Xfc=!1;this.xxb=null}});this.rIa.MXj(rc)}catch(rc){e.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+rc.message),this.Xfc=!1,this.xxb=null,this.Na.Be(F.a.Yfc,2,{["experience"]:Mb.experience})}}else e.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),
this.Na.Be(F.a.Yfc,2,{["experience"]:Yb})}Pyf(){this.Z0b.MNi().continueWith(()=>{try{var Yb=x.a.kl(d.AFrameworkApplication.uiCulture);const Mb=D.c(this.o3);if(Mb){var Nc={};Nc.partnerId=Mb;Nc.language=Yb;Nc.sessionId=d.AFrameworkApplication.userSessionId;Nc.authHint=d.AFrameworkApplication.fa.Va("UserPrincipalName");var ud=d.AFrameworkApplication.fa.Va("Puid")||"";""!==ud&&(Yb={},Yb.puid=ud,Nc.userInfo=Yb);this.xxb=new Dime(Nc);this.Xfc=!0;e.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else e.ULS.sendTraceTag(51675409,
324,15,"App not supported")}catch(Mb){e.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Mb.message)}},3)}bGd(){return this.rIa.bGd()}ZFd(){return this.rIa.ZFd()}}Object(f.a)(I,"InProductMessagingUIManager",null,[611]);class S{constructor(){this.Rse=0;this.e_a=Array(5);this.e_a[0]=10;this.e_a[1]=15;this.e_a[2]=50;this.e_a[3]=100;this.e_a[4]=200}Init(Yb){this.Rse=Yb}SendTrace(Yb,Nc){e.ULS.sendTraceTag(34182235,this.Rse,this.e_a[Yb],"{0}",Nc)}}Object(f.a)(S,"DefaultNetworkingManager",
null,[624]);var J=a(273),L=a(326),R=a(102);class Y{constructor(Yb){this.Dc=Yb}wZj(Yb){Yb&&(InProductMessaging.Networking.NetworkingMgr=new S,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(Yb.tig,Yb.GEf,Yb.NDe,Yb.hXi,Yb.locale,Object(z.a)(this,this.F3i,"onDismissFirstRunExperience"),Yb.hrg),this.hVa(t.Cfj,!0))}MXj(Yb){if(Yb&&Yb.instance&&Yb.xqc){let Nc=document.getElementById("wacDimeContainer");Nc||(Nc=document.createElement("div"),Nc.id="wacDimeContainer",document.body.appendChild(Nc));
d.AFrameworkApplication.fa.ra("DimeFocusManagerIsEnabled")&&this.hVa("wacDimeContainer",!1);Yb.xqc.parentElementId="wacDimeContainer";Yb.instance.launch(Yb.xqc,Yb.ing).then(ud=>{this.hOb();document.body.removeChild(Nc);Yb.J7f(ud)}).catch(ud=>{this.hOb();document.body.removeChild(Nc);Yb.K2f(ud)})}else throw Error.argument("DimeExperienceUISettings");}hVa(Yb,Nc){if(this.Dc&&Yb&&(Yb=document.getElementById(Yb),this.Qti(Yb),Yb=this.Dc.YN("InProductMessagingFocusId"))){const ud=this.Dc.Ni;ud&&"InProductMessagingFocusId"===
ud.name||this.Dc.aT("InProductMessagingFocusId",!1);Nc&&this.M0f(Yb.scope)}}Qti(Yb){var Nc=this.Dc.hj("InProductMessagingFocusId");Nc.parent=J.AFrame.bV;const ud=new L.DOMFocusListing(()=>Yb);ud.xfb=!1;ud.fp(3);ud.fp(2);ud.fp(4);Nc=this.Dc.pva(()=>Yb,Nc,ud);Nc.aOb();Nc.i1=!0;Nc.QKa=!0}M0f(Yb){Yb.ml(R.FocusManager.instance().j4);Yb.ml(R.FocusManager.instance().k4);Yb.bindAction(R.FocusManager.instance().j4,F.a.B4e);Yb.bindAction(R.FocusManager.instance().k4,F.a.A4e)}hOb(){this.Dc&&(this.Dc.a9("InProductMessagingFocusId"),
this.Dc.TTa("InProductMessagingFocusId"))}F3i(Yb,Nc){this.hOb();Yb=Object.assign(new y,{completed:Yb,svj:Nc});d.AFrameworkApplication.Qb.Be(F.a.PTh,2,Yb)}bGd(){const Yb=document.activeElement,Nc=this.Dc.WR();return Yb&&Nc&&Nc.Qf&&Yb===Nc.Qf.Tx?(Nc.Qf.xm(Yb),Nc.YAa()?32:8):4}ZFd(){const Yb=document.activeElement,Nc=this.Dc.WR();return Yb&&Nc&&Nc.Qf&&Yb===Nc.Qf.firstElement?(Nc.Qf.xm(Yb),Nc.FRa()?32:8):4}}Object(f.a)(Y,"InProductMessagingUIWrapper",null,[598]);var Q=a(142),W=a(260),Ga=a(31);class pa{constructor(){this.Db=
null}get name(){return"Common.App.InProductMessaging"}Di(Yb){Yb.register(r,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Uc().dd(()=>new r);Yb.register(Y,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Uc().dd(()=>new Y(R.FocusManager.instance()));Yb.register(I,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Uc().dd(()=>new I(d.AFrameworkApplication.Qb,
Yb.resolve("Common.IInProductMessagingUIWrapper"),Yb.resolve("Common.App.InProductMessaging.IDependencyDownloader"),d.AFrameworkApplication.sa.Qa.Ii,d.AFrameworkApplication.sa.Qa.kBa));Yb.register(O,"Common.App.InProductMessaging.InProductMessagingActor").Uc().dd(()=>new O(d.AFrameworkApplication.Qb,d.AFrameworkApplication.sa,Yb.resolve("Common.IInProductMessagingUIManager")));Yb.register(A,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Uc().dd(()=>
new A);Yb.register(y,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Uc().dd(()=>new y);this.Db=Yb}init(){this.Db.resolve("Common.App.InProductMessaging.InProductMessagingActor").vh();d.AFrameworkApplication.fa.Hv(()=>{d.AFrameworkApplication.sa.Qa.Kv&&Q.a.get_instance().wj(15,()=>{this.Db.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Yb=>{this.Db.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Yti(Yb)})});
d.AFrameworkApplication.fa.ra("FreemiumUpsellShowDialogIsEnabled")&&D.a()&&!Ga.a.Bza&&1!==d.AFrameworkApplication.sa.Qa.Ii&&this.Db.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Yb=>{Yb.isFeatureEnabled("MsoPremiumBadge",!0).then(Nc=>{!Nc&&Yb.isFreemiumUpsellEnabled()&&this.Db.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Pyf();return null})})})}dispose(){}static main(){W.a.instance.nj(new pa)}}Object(f.a)(pa,"InProductMessagingPackage",null,[4,
5]);var aa=a(199),Z=a(43);class fa{constructor(Yb,Nc,ud,Mb=null,rc=null){this.ox=Yb;this.NGa=Nc;this.dnb=ud;this.joe=Mb;this.qpb=rc}nec(Yb){const Nc=new Sys.StringBuilder(this.ox.HPb);Nc.append("RoamingServiceHandler.ashx?action=");Nc.append("getFirstRunExperienceSettings");Nc.append("&");Nc.append(this.Eod(Yb));Nc.append("&");Nc.append(d.AFrameworkApplication.ej);d.AFrameworkApplication.de.Fn(Nc.toString(),1,null,null,!0,2,Object(z.a)(this,this.I6,"getRequestSuccessCallback"),Object(z.a)(this,this.ZN,
"getRequestFailureCallback"),null)}p6a(Yb){var Nc=new Sys.StringBuilder(this.ox.HPb);Nc.append("RoamingServiceHandler.ashx?action=");Nc.append("saveFirstRunExperienceSettings");Nc.append("&");Nc.append(d.AFrameworkApplication.ej);Nc=Nc.toString();Yb=Z.c(Yb);d.AFrameworkApplication.de.Fn(Nc,2,Yb,null,!0,4,Object(z.a)(this,this.kkj,"postRequestSuccessCallback"),Object(z.a)(this,this.gP,"postRequestFailureCallback"),null)}I6(Yb){let Nc=!1,ud=null;try{if(0<Yb.data.Fe.length){const Mb=Object(M.a)(Object,
Z.a(Yb.data.Fe)),rc=Mb?Mb[this.ox.N3c]:null;rc&&(ud=Object(M.a)(Object,Z.a(rc.toString())))}Nc=!0}catch(Mb){this.ZN(null)}Nc&&this.NGa&&this.NGa(Yb.data,ud)}ZN(Yb){this.dnb&&this.dnb(Yb?Yb.data:null)}kkj(Yb){this.joe&&this.joe(Yb?Yb.data:null)}gP(Yb){this.qpb&&this.qpb(Yb?Yb.data:null)}Eod(Yb){const Nc=new Sys.StringBuilder("requestedsettings=");for(let ud=0;ud<Yb.count;ud++)Nc.append(Yb.ma(ud)),ud<Yb.count-1&&Nc.append(";");return Nc.toString()}}Object(f.a)(fa,"FirstRunExperienceRequestHandler",
null,[]);var ya=a(239),Aa=a(84);class ja{constructor(){this.Xmb=this.JYb=this.ox=null}c0d(Yb){Yb?(this.ox=Yb,this.dEi()&&(e.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Yb=new aa.a,Yb.add(this.ox.N3c),this.JYb=new fa(this.ox,Object(z.a)(this,this.I6,"getRequestSuccessCallback"),Object(z.a)(this,this.ZN,"getRequestFailureCallback"),null,Object(z.a)(this,this.gP,"postRequestFailureCallback")),this.JYb.nec(Yb)),(this.ox.qab||d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.d0d()):e.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}dEi(){try{if(this.ox.qab)return!0;if(!d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||d.AFrameworkApplication.fa.ra("IsAnonymousUser"))return!1;if(this.ox.yAi||this.ox.uab||d.AFrameworkApplication.fa.ra("IsO365ConsumerHost"))return!0;const Yb=d.AFrameworkApplication.fa.Va("FlightId");return-1!==(Yb?Yb.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Yb){e.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",Yb?Yb.toString():null)}return!1}e$f(Yb){const Nc={},ud={};ud.FREDisplayedDate=(new Date).toUTCString();ud.VersionDisplayed=Yb;ud.RemindMeLater=!1;Nc[this.ox.N3c]=Z.c(ud);e.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.JYb&&this.JYb.p6a(Nc)}I6(Yb,Nc){Yb=Yb?+Yb.q5-+Yb.CG:-1;Yb>this.ox.R8f?e.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
Yb,this.ox.R8f):Nc?this.AWj(Nc)?(e.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.ox.yEf),this.d0d()):(this.Qdd(!1),e.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(e.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.d0d())}ZN(Yb){this.Qdd(!1);
e.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Yb?Yb.httpStatus:-1)}gP(Yb){e.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Yb?Yb.httpStatus:-1)}d0d(){this.Qdd(!0);var Yb=Aa.a.instance.ah("Common.ISystemInitiatedFeedback");Yb?this.iig(Yb):(e.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((Yb=Aa.a.instance.qc("Common.ISystemInitiatedFeedback"))?Yb.execute(Nc=>{this.iig(Nc)}):e.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}iig(Yb){if(Yb){var Nc=this.ox.cUh;Nc&&(d.AFrameworkApplication.yAa(Nc),d.AFrameworkApplication.AO(Nc));e.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Nc);Yb.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Xmb=Object(z.a)(this,this.I4i,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.Xmb,!0),window.addEventListener("FRELaunchedEvent",this.Xmb,!0)):(e.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.e$f(this.ox.currentVersion))}else e.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}I4i(Yb){if(Yb){var Nc=Yb.detail;Yb=Yb.type;var ud=this.ox&&this.ox.campaignId?this.ox.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Yb||ud&&Nc&&Nc.id&&-1!==Nc.id.indexOf(ud))Nc.success&&
(e.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.e$f(this.ox.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Xmb,!0),window.removeEventListener("FRELaunchedEvent",this.Xmb,!0))}}AWj(Yb){if("RemindMeLater"in Yb&&"FREDisplayedDate"in Yb){if("true"===Yb.RemindMeLater.toString()&&(+new Date-+new Date(Yb.FREDisplayedDate.toString()))/36E5>this.ox.yEf)return!0}else if(d.AFrameworkApplication.fa.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in Yb&&Yb.VersionDisplayed<this.ox.currentVersion)return e.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Qdd(Yb){d.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&ya.a.dispatch("FREDecisionEvent",{["show"]:Yb})}}Object(f.a)(ja,"FirstRunExperienceLauncher",null,[568]);class za{constructor(){this.Db=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Di(Yb){this.Db=
Yb;this.Db.register(568,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Uc().dd(()=>new ja)}init(){}dispose(){}static main(){W.a.instance.nj(new za)}}Object(f.a)(za,"FirstRunExperienceLauncherPackage",null,[4,5]);var ra=a(10),fb=a(229),Ua=a(1);class Ca{constructor(Yb){this.$=Yb}get N3c(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get yAi(){return this.isEnabled()&&Ua.EwaSettings.ya(295)}get uab(){return this.isEnabled()&&
Ua.EwaSettings.ya(297)}get qab(){return Ua.EwaSettings.ya(296)}get cUh(){return null}get yEf(){return 24}get R8f(){return 4E3}get HPb(){return this.$.xa.WebServiceBase||""}isEnabled(){if(d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.ra("IsAnonymousUser"):1)return!1;const Yb=d.AFrameworkApplication.Nc?Object(M.a)(String,d.AFrameworkApplication.Nc.AudienceGroup):"";return"Unknown"!==Yb&&"Automation"!==Yb}}Object(f.a)(Ca,"FirstRunExperienceLauncherSettings",null,[597]);class Ia{constructor(Yb,
Nc){this.C4e=Yb;this.RTh=Nc}c0d(){this.C4e&&this.C4e.c0d(this.RTh)}}Object(f.a)(Ia,"FirstRunExperienceManager",null,[596]);var oa=a(725);class Da extends fb.a{constructor(Yb){super();this.$=Yb;this.kc()}create(){const Yb=Object(oa.a)(this.$.da,311,()=>this.Qnh());this.Pb(Yb)}Qnh(){var Yb=new Ca(this.$);Yb=new Ia(Aa.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Yb);Yb.c0d();return Yb}static la(Yb){Yb.da.Ja(312,new Da(Yb))}}Object(f.a)(Da,"FirstRunExperienceManagerFactory",
fb.a,[]);var bb=a(63);class Za extends fb.a{constructor(Yb){super();this.Dtd=null;this.$=Yb;this.kc()}create(){const Yb=Object(oa.a)(this.$.da,361,()=>this.Boh());this.Pb(Yb)}Boh(){this.Dtd=Aa.a.instance.ah("Common.IInProductMessagingUIManager");bb.a.eh.Kv?Q.a.get_instance().wj(16,()=>{this.Qmf()}):this.Qmf();return this.Dtd}Qmf(){Aa.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Yb=>{Yb.isFeatureEnabled("MsoPremiumBadge",!0).then(Nc=>{!Nc&&Yb.isFreemiumUpsellEnabled()&&
this.Dtd.Pyf();return null})})}static la(Yb){Yb.da.Ja(362,new Za(Yb))}}Object(f.a)(Za,"InProductMessagingManagerFactory",fb.a,[]);var Xa=a(51),Ba=a(425),Wa=a(86),Na=a(540),ta=a(20),V=a(589);class ia extends Na.a{constructor(Yb){super(1);this.Tha=!1;this.YIf=()=>{this.refresh()};this.ZIf=()=>{this.refresh()};this.gridView=ta.h(Yb);this.gridView.wc.ao(this.ZIf);this.gridView.wc.Bm(this.YIf);this.refresh()}get nJ(){return this.Asc(this.Tha)}WYd(Yb){this.Tha!==Yb&&(this.Tha=Yb,this.oNb())}get name(){return V.a.cellEdit}dispose(){this.gridView.wc.Un(this.ZIf);
this.gridView.wc.Qm(this.YIf);this.gridView=null;super.dispose()}oNb(){this.tPd(this.Tha)}refresh(){this.WYd(!this.gridView.Eb)}}Object(f.a)(ia,"CellEditSafeStatePublisher",Na.a,[]);var X=a(42),la=a(129);class sa{constructor(Yb,Nc){this.handler=null;this.publisher=Yb;this.nJ=Nc}}Object(f.a)(sa,"SafeStatePublisherState",null,[]);var Va=a(628);const nb=Yb=>Yb?`${Yb.Current} / ${Yb.Pending} @${Yb.SuspensionStartTimestamp}`:null,ha=Yb=>(null===Yb||void 0===Yb?void 0:Yb.SuspensionStartTimestamp)&&Yb.Pending>
Yb.Current;class jb extends X.a{constructor(Yb,Nc){super();this.Bxf=null;this.Wab=!1;this.XKb=(ud,Mb)=>{3===Mb.jEf&&this.Wab&&e.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.Wab=!0;this.Qeb()};this.BUa=new aa.a;this.UAa=Yb;this.fpa=Nc;this.GEb=Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.V$a=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");
this.GEb&&(this.fpa.n1a(this.zBa.bind(this)),this.V$a?this.UAa.pye(this.XKb):this.UAa.JXg(this.dOf.bind(this)))}get mck(){return la.f(la.c(this.BUa.toArray(),Yb=>0!=Yb.nJ),Yb=>Yb.publisher.name)}M4b(Yb){this.addHandler(jb.AUa,Yb)}hAc(Yb){this.removeHandler(jb.AUa,Yb)}HCa(Yb,Nc){const ud=new sa(Yb,Nc);this.BUa.add(ud);Nc=(Mb,rc)=>{ud.nJ=rc.nJ;this.Qeb()};Yb.M4b(Nc);ud.handler=Nc;this.Qeb()}k6d(Yb){let Nc=null;for(let ud of this.BUa)if(ud.publisher===Yb){this.isg(ud);Nc=ud;break}Nc&&(this.BUa.remove(Nc),
this.Qeb())}dispose(){for(let Yb of this.BUa)this.isg(Yb);this.BUa.clear();this.GEb&&(this.fpa.Kfb(this.zBa.bind(this)),this.V$a?this.UAa.O4f(this.XKb):this.UAa.Iyj(this.dOf.bind(this)));super.dispose()}wgc(){let Yb=rb.wgc(this.BUa.toArray().map(Nc=>Nc.nJ));return this.Wab&&1===Yb?2:Yb}isg(Yb){Yb.publisher.hAc(Yb.handler)}Qeb(){const Yb=this.wgc();Yb!==this.Bxf&&(this.raiseEvent(jb.AUa,new Va.a(Yb)),this.Bxf=Yb)}dOf(){this.Wab&&e.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");
this.Wab=!0;this.Qeb()}zBa(Yb,Nc){Yb=Nc.Gea;(Nc=!ha(Yb))||(Nc=this.vLi,Nc=(null===Yb||void 0===Yb?void 0:Yb.SuspensionStartTimestamp)!==(null===Nc||void 0===Nc?void 0:Nc.SuspensionStartTimestamp));Nc&&(this.Wab=!1);this.vLi=Yb;this.Qeb()}}jb.AUa="SSC";Object(f.a)(jb,"ClientStateMonitor",X.a,[]);var Fb=a(8),Rb=a(74);class mb extends Na.a{constructor(Yb,Nc=null){super(1);this.Tha=!1;this.QO=()=>{this.refresh()};this.fKf=()=>{this.refresh()};this.$=Yb;this.dhe=Nc||Rb.a(Yb).TR(Fb.a.idle);Rb.a(Yb).i2c(this.fKf);
this.Y8a.qr(this.QO);this.refresh()}get nJ(){return this.Asc(this.Tha)}WYd(Yb){Yb!==this.Tha&&(this.Tha=Yb,this.oNb())}get name(){return V.a.Y8a}get Y8a(){return this.dhe}dispose(){Rb.a(this.$).Ozc(this.fKf);this.Y8a.Rr(this.QO);this.dhe=null;super.dispose()}oNb(){this.tPd(this.Tha)}refresh(){this.WYd(1===this.Y8a.Bv||Rb.a(this.$).Ei===this.Y8a)}}Object(f.a)(mb,"IdleActivitySafeStatePublisher",Na.a,[]);var sb=a(327),Ya=a(5),Ma=a(23);class xb extends Wa.a{constructor(){super()}hd(){return!1}executeCommand(){return w.Task.Ua(!0)}Tc(Yb,
Nc){return 1905775613===Nc.command}ld(){return!1}}Object(f.a)(xb,"ToggleMergeSuspensionSafeState",Wa.a,[200]);class qb extends X.a{constructor(Yb,Nc){super();this.statusBarManager=null;this.bHd=!1;this.zBa=(ud,Mb)=>{ud=`${Mb.Gea.Current===Mb.Gea.Pending?"\u26ad":"\u26ae"}${Mb.Gea.Current}`;Ma.a.equals(this.itc,ud,!1)||(this.itc=ud,this.RA())};this.oSa=(ud,Mb)=>{ud=0==Mb.nJ;this.bHd!==ud&&(this.bHd=ud,this.RA())};this.mergeSuspensionManager=Nc;this.mergeSuspensionManager.fpa.n1a(this.zBa);this.itc=
"";sb.a.Yaa(1905775613,Ya.a.Pc,0,1);this.Ia=Yb.Ia;this.aUb=new xb;Yb.da.Gb(29,ud=>{this.mergeSuspensionManager&&(this.statusBarManager=ud,ud.BK(this),this.mergeSuspensionManager.Uja.M4b(this.oSa))});this.Ia.w4(this.aUb)}qr(Yb){this.addHandler(qb.DFd,Yb)}Rr(Yb){this.removeHandler(qb.DFd,Yb)}RA(){this.raiseEvent(qb.DFd)}ro(Yb){return Yb===qb.Dnj&&!!this.mergeSuspensionManager}ut(Yb,Nc){if(!this.ro(Yb))return!1;this.mergeSuspensionManager&&(Nc.LabelText=this.itc,Nc.On=this.bHd);return!0}dispose(){this.aUb&&
(this.Ia.Afb(this.aUb),this.aUb.dispose(),this.aUb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.fpa.Kfb(this.zBa),this.mergeSuspensionManager.Uja.hAc(this.oSa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null);this.itc=null;super.dispose()}}qb.DFd="MSMSC";qb.Dnj="QueryMergeSuspensionStatus";Object(f.a)(qb,"MergeSuspensionIndicatorManager",X.a,[196,197,2]);var Ra=a(2),Jb=a(915);class yb extends Sys.EventArgs{constructor(Yb){super();
this.Jza=Yb}}Object(f.a)(yb,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Gb{}Object(f.a)(Gb,"SuspensionState",null,[]);class ub extends Gb{constructor(Yb){super();this.bAe=!1;this.bAe=Yb}}Object(f.a)(ub,"ReadyForPendingMergeState",Gb,[]);const Ja=new Gb,zb=new Gb,na=new ub(!1),Ea=new ub(!0);var ma=a(916);class Ka extends ma.a{constructor(Yb,Nc,ud){super(Yb);this.Y_g=Nc;this.h_j=ud}}Object(f.a)(Ka,"ReadyForPendingMergesUpdatedEventArgs",ma.a,[]);class cb extends X.a{constructor(Yb,
Nc,ud){super();this.zBa=(Mb,rc)=>{Mb=this.getState();const id=this.n1;this.n1=rc.Gea;rc=this.getState();this.NQi(Mb,rc,id);this.raiseEvent(cb.yFd);this.l4e(Mb,rc)};this.oSa=(Mb,rc)=>{Mb=this.getState();this.nJ=rc.nJ;rc=this.getState();this.l4e(Mb,rc)};this.XKb=(Mb,rc)=>{this.V$a&&4===rc.jEf&&(e.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",nb(this.n1),nb(rc.n1)),this.g_f(this.getState(),
!0))};this.GEb=Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.V$a=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");this.Uja=Yb;this.Uja.M4b(this.oSa);this.fpa=Nc;this.fpa.n1a(this.zBa);this.V$a&&(this.UAa=ud,this.UAa.pye(this.XKb));this.n1=Object(Ra.a)(new Jb.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.nJ=this.nsi()}nsi(){return Object(Ba.a)(jb,this.Uja)?Object(M.a)(jb,this.Uja).wgc():1}R4b(Yb){this.addHandler(cb.v4d,
Yb)}lAc(Yb){this.removeHandler(cb.v4d,Yb)}vYg(Yb){this.addHandler(cb.dQd,Yb)}jzj(Yb){this.removeHandler(cb.dQd,Yb)}IXg(Yb){this.addHandler(cb.yFd,Yb)}Hyj(Yb){this.removeHandler(cb.yFd,Yb)}Bpj(){this.qPd(this.getState()===zb)}dispose(){this.Uja.hAc(this.oSa);this.Uja=null;this.fpa.Kfb(this.zBa);this.fpa=null;this.V$a&&(this.UAa.O4f(this.XKb),this.UAa=null);super.dispose()}Tnd(){return Object(Ra.a)(new Jb.a,{Current:this.n1.Current,Pending:this.n1.Pending,SuspensionStartTimestamp:this.n1.SuspensionStartTimestamp})}getState(){return ha(this.n1)?
0==this.nJ?Ea:this.GEb&&1==this.nJ?na:zb:Ja}l4e(Yb,Nc){Yb!==Nc&&(Nc===zb?this.qPd(!0):Yb===zb&&this.qPd(!1));this.g_f(Nc)}g_f(Yb,Nc=!1){Yb instanceof ub&&this.raiseEvent(cb.dQd,new Ka(this.n1,Yb.bAe||!this.GEb,Nc))}NQi(Yb,Nc,ud){Yb===Ja&&Nc!==Ja?(Yb=Nc===zb,Nc=Nc===na,e.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${Nc} publisher: ${Nc||Yb?this.Uja.mck.join(","):""} counter: ${nb(this.n1)} isBlockingAllMerges: ${Yb}`)):
Yb!==Ja&&Nc===Ja&&e.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${nb(ud)}`)}qPd(Yb){this.raiseEvent(cb.v4d,new yb(Yb))}}cb.v4d="TPMBBC";cb.dQd="RFPMU";cb.yFd="MCC";Object(f.a)(cb,"MergeSuspensionStateHandler",X.a,[]);class Fa extends X.a{constructor(Yb){super();this.T3=null;this.eqc=0;this.VIb=(Nc,ud)=>{(null===ud||void 0===ud?0:ud.Gea)&&this.hSa(ud.Gea,Fa.g9d)};this.YCc=()=>{this.y7f();this.WZf(this.T3,Fa.MCj)};this.iJd=
(Nc,ud)=>{ud.committed&&this.T3.SuspensionStartTimestamp&&e.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${nb(this.T3)}`)};this.y7f();this.$=Yb;this.$.ea.pk(this.YCc);this.$.ea.DK(this.YCc);ta.h(this.$).wc.Bm(this.iJd);this.$.da.Gb(292,Nc=>{Nc.n1a(this.VIb);e.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}n1a(Yb){this.addHandler("MCU",Yb)}Kfb(Yb){this.removeHandler("MCU",Yb)}get n1(){return this.T3}hSa(Yb,Nc=""){const ud=this.T3.Current<
Yb.Current||this.T3.Pending<Yb.Pending;if(Yb.SuspensionStartTimestamp&&this.eqc!==Yb.SuspensionStartTimestamp){if(this.eqc>Yb.SuspensionStartTimestamp){ud&&e.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${Nc}. S: ${Fa.UIb(Yb)}, C: ${Fa.UIb(this.T3)}`);return}ud||e.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Fa.UIb(Yb)}, C: ${Fa.UIb(this.T3)}`)}else if(!ud)return;
this.T3=Yb;this.WZf(Yb,Nc)}dispose(){this.$.ea.Kk(this.YCc);this.$.ea.rP(this.YCc);ta.h(this.$).wc.Qm(this.iJd);const Yb=this.$.da.Ba(292);Yb&&Yb.Kfb(this.VIb);super.dispose()}WZf(Yb,Nc=""){ha(Yb)&&Yb.SuspensionStartTimestamp>this.eqc&&(e.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${nb(Yb)}, Origin: ${Nc}`),this.eqc=Yb.SuspensionStartTimestamp);this.raiseEvent("MCU",new ma.a(Yb))}y7f(){e.ULS.sendTraceTag(588276808,0,50,
`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Fa.UIb(this.T3)}`);this.T3=Object(Ra.a)(new Jb.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static UIb(Yb){return Yb?`(${Yb.Current}/${Yb.Pending} @${Yb.SuspensionStartTimestamp})`:"null"}}Fa.g9d="PMM.RTC";Fa.Mcc="PMM.EwaResult";Fa.MCj="PMM.resetMergeCounter";Object(f.a)(Fa,"PendingMergeMonitor",X.a,[]);class wa{}Object(f.a)(wa,"ClientRevisions",null,[]);var ka=a(48),Oa=a(58);const hb=(Yb,Nc,ud,Mb,rc,id,Gd,de=null)=>{de=Yb.Pa(1,
de);de.viewportState=Nc;de.allowViewAdjustment=ud;return Oa.g(Yb,"DoPendingMerge",de,Mb,rc,id,Gd,0)},Pa=(Yb,Nc,ud,Mb,rc,id,Gd=null)=>{Gd=Yb.Pa(1,Gd);Gd.suspensionStartTimestamp=Nc;return Oa.g(Yb,"KeepBlockingPendingMerges",Gd,ud,Mb,rc,id,0)};class ca extends X.a{constructor(Yb,Nc,ud,Mb){super();this.QLa=null;this.XGb=0;this.YGb=this.Jab=null;this.NPf=(rc,id)=>{this.QLa.H3g(id.Gea,id.Y_g,id.h_j)};this.ALb=(rc,id)=>{id.Jza?this.v1j():this.mGc()};this.cOf=()=>{this.XGb=0};this.ebg=()=>{const rc=this.l8.Tnd();
Pa(this.va,null!=rc.SuspensionStartTimestamp?rc.SuspensionStartTimestamp:0,null,()=>{this.l8i(rc)},null,null,this.va.Bc())};this.fFa=(rc,id)=>{if(id){id.zsb.MergeCount=this.l8.Tnd();let Gd;({min:rc,max:Gd}=ta.h(this.$).PVi());Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?id.zsb.ClientRevisions=Object(Ra.a)(new wa,{Min:rc,Max:Gd,MaxFromBlockCache:ta.h(this.$).Ca.HDf}):id.zsb.ClientRevisions=Object(Ra.a)(new wa,{Min:rc,Max:Gd})}};this.$=Yb;this.h2a=ud;this.l8=Nc;this.l8.vYg(this.NPf);
this.l8.R4b(this.ALb);this.l8.IXg(this.cOf);this.$.qa.hja(this.fFa);this.va=this.$.qa.va;this.PTd=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;this.QKi=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.QLa=Mb;e.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.qa.Fpa(this.fFa);this.mGc();this.l8.jzj(this.NPf);this.l8.lAc(this.ALb);this.l8.Hyj(this.cOf);this.l8=null;super.dispose()}v1j(){this.mGc();if(this.yTe()){const Yb=this.l8.Tnd();e.ULS.sendTraceTag(537155414,
0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${nb(Yb)} fail count: ${this.XGb}`)}else this.YGb=this.h2a.create(this.ebg,this.PTd,ka.a.YGb),this.Jab=this.h2a.ZD(this.ebg,this.QKi,ka.a.Jab)}mGc(){this.Jab&&(this.YGb.cancel(),this.Jab.cancel(),this.Jab=this.YGb=null)}l8i(Yb){let Nc;Nc=" fail count: "+this.XGb;this.XGb++;this.yTe()&&this.mGc();e.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${nb(Yb)}${Nc}`)}yTe(){return this.XGb>
ca.DUi}}ca.DUi=5;Object(f.a)(ca,"RequestController",X.a,[]);var ba=a(170),ib=a(205),Lb=a(32),gc=a(246);class Gc extends Sys.EventArgs{constructor(Yb,Nc){super();this.jEf=Yb;this.n1=Nc}}Object(f.a)(Gc,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class Kb extends X.a{get iPa(){return 0<this.cLd}constructor(Yb,Nc,ud=null,Mb=null,rc=null){super();this.dqc=null;this.cLd=0;this.documentVisibilityObserver=null;this.Qwf=!1;this.ysc=null;this.va=Yb;this.PTd=Nc.xa.MergeSuspensionRequestThrottlingTimeInMs;const id=
Nc.xa.GetRangeContentPrefetchDelayForMergeInMs;this.Kz=()=>{Nc.M$f(id)};this.ii=ud||Lb.a.Bb;this.qvg=0;this.BM=Mb;this.jDa=rc;Nc.da.Gb(291,Gd=>{this.documentVisibilityObserver=Gd})}JXg(Yb){this.addHandler(Kb.EFd,Yb)}Iyj(Yb){this.removeHandler(Kb.EFd,Yb)}pye(Yb){this.addHandler(Kb.zFd,Yb)}O4f(Yb){this.removeHandler(Kb.zFd,Yb)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.ui}H3g(Yb,Nc,ud=!1){this.dSb(Yb,Nc,ud)?(new ba.a).setResult(!0):(Nc=this.Dhj(Yb,
Nc),this.dqc=Yb,this.cLd++,Nc.continueWith(()=>{this.J3i()},0,ib.a.none,this.BM))}Dhj(Yb,Nc){this.qvg=this.ii.eha;this.Qwf=Nc;e.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${Yb.Current} / ${Yb.Pending} @${Yb.SuspensionStartTimestamp}. allowSelectionAdjustment: ${Nc}`);this.isDocumentHidden||this.Kz();return this.wJj(Nc,Yb)}dSb(Yb,Nc,ud=!1){if(this.jDa&&!Nc&&!this.jDa.aIi())return e.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),
!0;if(!this.dqc||Yb.SuspensionStartTimestamp>this.dqc.SuspensionStartTimestamp)return this.iPa&&e.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${Yb.Current} / ${Yb.Pending} @${Yb.SuspensionStartTimestamp}`),!1;if(this.iPa)return!0;if(ud)return!1;ud=this.dqc;const Mb=this.ii.eha-this.qvg<this.PTd;Nc=this.Qwf===Nc;return(Yb||ud?Yb&&ud?Yb.Current===ud.Current&&Yb.Pending===ud.Pending&&Yb.SuspensionStartTimestamp===
ud.SuspensionStartTimestamp:!1:!0)&&Mb&&Nc}wJj(Yb,Nc){const ud=this.va.Bc(),Mb=()=>{e.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${Nc.Current} / ${Nc.Pending} @${Nc.SuspensionStartTimestamp}`)};return this.jDa?this.jDa.TFj(this.t4h(Yb,Mb,ud)):this.OGe(null,!0,void 0,Mb,ud)}t4h(Yb,Nc,ud){return(Mb,rc,id)=>{let Gd=void 0;e.ULS.shipAssertTag(523317955,0,null!=Mb||Yb,"!allowSelectionAdjustment requires a non-null initialViewportState.");Gd=this.K3i.bind(this);
rc&&(Gd=gc.b.call(null,de=>{const ae=de.Result;let Ae=null===ae||void 0===ae?void 0:ae.AdjustedViewportState;3===(null===ae||void 0===ae?void 0:ae.MergeResultState)&&(Ae=void 0);rc(Ae,de.StateId)},Gd));id&&(Nc=gc.a.call(null,id,Nc));return this.OGe(Mb,Yb,Gd,Nc,ud)}}OGe(Yb,Nc,ud,Mb,rc){return hb(this.va,Yb,Nc,ud,Mb,null,null,rc)}K3i(Yb){var Nc=Yb.Result;void 0!=Nc&&(Nc=Nc.MergeResultState,Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout")&&2!==Nc?this.ysc=[Nc,Yb.MergeCount]:
3===Nc&&(e.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.$oj()))}$oj(){this.raiseEvent(Kb.EFd,new Sys.EventArgs)}Zoj(Yb,Nc){this.raiseEvent(Kb.zFd,new Gc(Yb,Nc))}J3i(){this.cLd--;if(this.ysc){const Yb=this.ysc;this.ysc=null;this.Zoj(...Yb)}}}Kb.EFd="MWA";Kb.zFd="MDO";Object(f.a)(Kb,"DoPendingMergeSender",X.a,[639,640]);class pb{constructor(Yb=!1){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=
this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.$qi=Yb}get reportName(){return this.$qi?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(f.a)(pb,"SelectionAdjustSessionEndsReport",null,[279]);var nc=a(47);class Wb{constructor(Yb,Nc,ud,Mb,rc,id){this.Jb=Yb;this.DH=Nc;this.Kaa=ud;this.E1b=Mb;this.bae=rc;this.WM=id}get activeCell(){return this.DH}get selectedRanges(){return this.Kaa}get Hr(){let Yb=!1;if(null===this.WM||
void 0===this.WM)Yb=!0;else if(this.WM>=this.selectedRanges.length||!this.selectedRanges[this.WM].contains(this.activeCell))e.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.WM}, selectedRangesLength: ${this.selectedRanges.length}`),Yb=!0;Yb&&(this.WM=this.H$g());return this.WM}get activeRange(){return 0>this.Hr?this.activeCell:this.selectedRanges[this.Hr]}get sheetName(){return this.E1b}get activeItemName(){return this.bae}get Vzg(){return 1===
this.selectedRanges.length}Bwg(Yb){let Nc=this.selectedRanges.map(ud=>this.F$j(ud,this.bae));for(let ud of Nc)if(ud)for(let Mb of ud)if(Mb.Ok&&Mb.Ke.Revision<Yb)return!1;return!0}j7j(){var Yb;return{SheetName:this.sheetName,ActiveCell:null===(Yb=this.activeCell)||void 0===Yb?void 0:Yb.toString(),TopLeft:void 0,SelectedRanges:nc.r(this.selectedRanges,this.Jb)}}toString(){var Yb,Nc;return`active cell: ${null!==(Nc=null===(Yb=this.activeCell)||void 0===Yb?void 0:Yb.toString())&&void 0!==Nc?Nc:"null"} selection: ${la.f(this.selectedRanges,
ud=>{var Mb;return null!==(Mb=null===ud||void 0===ud?void 0:ud.toString())&&void 0!==Mb?Mb:"null"}).join(",")}`}equals(Yb){return Yb?this.activeCell.equals(Yb.activeCell)&&nc.R(this.selectedRanges,Yb.selectedRanges)&&this.sheetName===Yb.sheetName:!1}H$g(){for(let [Yb,Nc]of this.selectedRanges.entries())if(null===Nc||void 0===Nc?0:Nc.contains(this.activeCell))return Yb;return-1}F$j(Yb,Nc){var ud;const Mb=ta.h(this.Jb).Ca.qNa(Yb,Nc);Mb||e.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==
(ud=null===Yb||void 0===Yb?void 0:Yb.toString())&&void 0!==ud?ud:"null"} ; activeItemNameIsDefined: ${!!Nc}`);return Mb}}Object(f.a)(Wb,"SelectionState",null,[]);var Ha=a(220),$a=a(759);class Nb{constructor(Yb){this.gGc=0;this.iI=this.zG=null;this.rae=new pb;this.sae=new pb(!0);this.eJ=0;this.t5j=!1;this.UVi=1E4;this.Td=()=>{this.iQe()};this.Bj=()=>{this.R4c(!0,!1)};this.Hcb=()=>{this.R4c(!1,!1)};this.$=Yb;this.gridView=ta.h(this.$);this.gridView.Ca.rw(this.Bj);this.gridView.Ca.mv(this.Hcb);this.gridView.Ca.uxe(this.Hcb);
this.gridView.Ca.bba(this.Hcb);this.$.Ql(this.Td);this.iQe()}TFj(Yb){let Nc=null,ud=null,Mb=()=>{this.h0i()};this.kof()?(this.VQ.parallel++,e.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.iI}`)):(Nc=(rc,id)=>{this.i0i(rc,id)},ud=this.pPj());return null===Yb||void 0===Yb?void 0:Yb(ud,Nc,Mb)}aIi(){return!this.kof()&&this.ida().Vzg}pPj(){var Yb;e.ULS.shipAssertTag(525135961,0,0===this.eJ,
"SelectionAdjustManager.setPreRequestState: unexpected state");this.iI&&(this.VQ.errors++,e.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.iI.toString()}`));this.iI=null;this.zG=this.ida();let Nc=null;const ud=null===(Yb=this.zG)||void 0===Yb?void 0:Yb.j7j();ud&&(Nc={ActiveSheetName:this.zG.sheetName,SheetViewportStateChanges:[ud]});this.eJ=1;return Nc}h0i(){e.ULS.shipAssertTag(525135960,0,1===this.eJ,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");
this.VQ.errors++;this.eJ=2;this.ys()}i0i(Yb,Nc){try{e.ULS.shipAssertTag(525135959,0,1===this.eJ,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.gGc=Nc,Nc=2,this.zG?Yb?(this.iI=this.VSj(Yb))?(Nc=7,this.zG.equals(this.iI)?this.zG.equals(this.ida())?(this.VQ.adjustedDidntChange++,Nc=4):(this.VQ.adjustedDidntChangeWithDivergence++,Nc=5):this.zG.sheetName!=this.iI.sheetName?(this.VQ.differentSheetAdjust++,Nc=10):this.zG.equals(this.ida())||(this.VQ.divergenceOnResponse++,Nc=6,
this.c6f())):this.VQ.errors++:(this.VQ.errors++,e.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.zG.toString()}`)):(this.VQ.errors++,e.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===Yb||void 0===Yb?void 0:Yb.ActiveCell}`)),this.eJ=Nc}catch(ud){this.eJ=12,e.ULS.sendTraceTag(525135958,0,10,
`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${ud}`)}finally{7!=this.eJ?this.ys():this.R4c(!1,!0)}}dispose(){this.gridView.Ca.Vw(this.Bj);this.gridView.Ca.Lt(this.Hcb);this.gridView.Ca.$3f(this.Hcb);this.gridView.Ca.VTa(this.Hcb);this.$.Rm(this.Td)}kof(){return 1===this.eJ||7===this.eJ}VSj(Yb){let Nc;if(!({range:Nc}=nc.ab(Yb.ActiveCell,this.$.ua)).returnValue)return e.ULS.sendTraceTag(537155411,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${Yb.ActiveCell}`),
null;let ud=[];const Mb=this.$.na,rc=!!Mb&&2===Mb.lH;if(Yb.SelectedRanges)ud=nc.g(Yb.SelectedRanges.Ranges);else if(!rc)return e.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Mb}`),null;return new Wb(this.$,Nc,ud,Yb.SheetName,this.zG.activeItemName,this.zG.Hr)}ida(){const Yb=this.$.na;if((null===Yb||void 0===Yb?0:Yb.activeCell)&&Yb.selectedRanges&&Yb.sheetName)return new Wb(this.$,Yb.activeCell,Yb.selectedRanges,
Yb.sheetName,this.$.activeItemName,Yb.Hr);e.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!Yb}, activeCell null: ${!(null===Yb||void 0===Yb?0:Yb.activeCell)}, selectedRanges null: ${!(null===Yb||void 0===Yb?0:Yb.selectedRanges)}, sheetName null: ${!(null===Yb||void 0===Yb?0:Yb.sheetName)}`);return null}iQe(){this.$.da.Gb(276,()=>{const Yb=Ha.a(this.$);Yb.TU(this.rae);Yb.TU(this.sae)})}R4c(Yb,Nc){var ud;if(this.bGi(Yb))if(8===this.eJ)e.ULS.sendTraceTag(523106438,
0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{Nc&&e.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{e.ULS.shipAssertTag(525135956,0,7===this.eJ,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.zG.equals(this.ida())?(null===(ud=this.gridView)||void 0===ud?0:ud.Eb)?(this.VQ.editBoxDivergence++,this.eJ=11):(Yb=0,Yb=this.iI.Hr,-1==Yb?(this.VQ.errors++,e.ULS.sendTraceTag(522826912,
0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.VQ.adjusted++,this.eJ=8,this.gridView.ga.jH(this.iI.selectedRanges,Yb,this.iI.activeCell,0,void 0,"SelectionAdjust"))):(this.VQ.divergenceOnViewportReady++,this.c6f(),this.eJ=9)}catch(Mb){this.eJ=12,e.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Mb}`)}finally{this.ys()}}}bGi(Yb){if(!this.iI)return!1;if(!this.zG)return e.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.iI.toString()}`),
!1;if(ta.h(this.$).Ca.HDf<this.gGc)return!1;if(Yb||this.t5j)e.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.zG.Bwg(this.gGc)||!this.iI.Bwg(this.gGc))return!1;return!0}ys(){this.zG=this.iI=null;this.eJ=0}c6f(){const Yb=this.ida();e.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.zG.toString()} current: ${Yb?Yb.toString():""} adjusted: ${this.iI.toString()} sheetSameBetweenInitialAndAdjusted: ${this.zG.sheetName===
this.iI.sheetName} sheetSameBetweenInitialAndCurrent: ${this.zG.sheetName===(Yb?Yb.sheetName:null)}`)}get VQ(){return $a.a.xE(this.UVi)?this.sae:this.rae}}Object(f.a)(Nb,"SelectionAdjustManager",null,[623,2]);class rb extends Wa.a{constructor(Yb,Nc,ud=null){super();this.TFa=this.jlc=this.Z8a=this.r3a=null;this.$=Yb;this.x_a=new Fa(Yb);this.jDa=new Nb(this.$);this.QLa=new Kb(this.$.qa.va,this.$,void 0,void 0,this.jDa);this.Jsi(Yb,ud);this.cia=new cb(this.TFa,this.x_a,this.QLa);this.ITd=new ca(Yb,this.cia,
Nc,this.QLa);Ua.EwaSettings.ya(230)&&(this.jlc=new qb(Yb,this));e.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}R4b(Yb){this.cia.R4b(Yb)}lAc(Yb){this.cia&&this.cia.lAc(Yb)}get Uja(){return this.TFa}get fpa(){return this.x_a}get l8(){return this.cia}HCa(Yb,Nc){this.TFa.HCa(Yb,Nc)}k6d(Yb){this.TFa.k6d(Yb)}hSa(Yb,Nc=""){this.x_a.hSa(Yb,Nc)}dispose(){this.jlc&&(this.jlc.dispose(),this.jlc=null);this.jDa&&this.jDa.dispose();this.QLa.dispose();this.ITd&&(this.ITd.dispose(),this.ITd=
null);this.cia&&(this.cia.dispose(),this.cia=null);this.x_a.dispose();this.x_a=null;this.TFa.dispose();this.TFa=null;this.r3a&&(this.r3a.dispose(),this.r3a=null);this.Z8a&&(this.Z8a.dispose(),this.Z8a=null);this.$=null;super.dispose()}oNb(){this.cia.Bpj()}static wgc(Yb){let Nc=0;for(let ud of Yb){if(2==ud)return 2;1==ud&&(Nc=1)}return Nc}Jsi(Yb,Nc){this.TFa=new jb(this.QLa,this.x_a);Nc?Object(Ba.a)(mb,Nc)?this.HCa(Nc,Object(M.a)(mb,Nc).nJ):Object(Ba.a)(ia,Nc)?this.HCa(Nc,Object(M.a)(ia,Nc).nJ):this.HCa(Nc,
0):(this.r3a=new ia(Yb),this.Z8a=new mb(Yb),this.HCa(this.r3a,this.r3a.nJ),this.HCa(this.Z8a,this.Z8a.nJ))}}Object(f.a)(rb,"MergeSuspensionManager",Wa.a,[595,2]);class ec extends fb.a{constructor(Yb){super();this.Fd=Yb;this.kc()}create(){e.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Pb(this.Fd.da.Ba(343)||this.Fd.da.Ja(343,new rb(this.Fd,Xa.a.instance)))}static la(Yb){e.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");Yb.da.Ja(344,new ec(Yb))}}Object(f.a)(ec,
"MergeSuspensionFactory",fb.a,[]);var pc=a(92),vb=a(103),ob=a(61),Tb=a(16);class Rd{}Rd.uNi=3;Rd.connected=0;Object(f.a)(Rd,"ConnectionStateConstants",null,[]);var Jd=a(116),ld=a(130),Yd=a(49);class Ke{constructor(Yb,Nc,ud){var Mb;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=
this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.JIf=(rc,id)=>{this.blockedOperationsCount++;rc=`${id.componentName}_${id.actionName}_${id.details})`;this.blockedActions[rc]=this.blockedActions[rc]?this.blockedActions[rc]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.ZKd=rc=>{this.durationUntilUserInactive=Jd.getElapsedSeconds(this.startTime,Lb.a.Bb.Cc);rc.QSd(this.ZKd)};this.xX=()=>{this.hasTabbedOut=
!0};this.hfa=(rc,id)=>{id.SUf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=ld.a(Lb.a.Bb,this.startTime),this.toastRaiser=id.toastRaiser,this.isToastShown=!0)};this.startTime=Yb;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=ud;if(null===(Mb=Nc.ea)||void 0===Mb?0:Mb.zf)this.wasUserActiveOnPIStart=Nc.ea.zf.Tq;this.mj(Nc);this.isDialogShown=0<Nc.Ob.WS;Yb=Nc.da.Ba(183);this.isTaskPaneShown=!!Yb&&Yb.isVisible&&!Yb.isCollapsed;this.isTaskPaneCollapsed=!!Yb&&
Yb.isVisible&&Yb.isCollapsed}Wcg(){this.durationMs=ld.a(Lb.a.Bb,this.startTime)}iKd(Yb){var Nc;this.Wcg();Yd.a(Yb).EOb(this.JIf);Yd.a(Yb).yg.fAc(this.hfa);Yb.da.Gb(291,ud=>{ud.Gfb(this.xX)});if(null===(Nc=Yb.ea)||void 0===Nc?0:Nc.zf)Yb.ea.zf.QSd(this.ZKd),this.wasUserActiveOnPIEnd=Yb.ea.zf.Tq}mj(Yb){Yd.a(Yb).H4b(this.JIf);this.isToastShown?this.toastRaiser="Immediate":Yd.a(Yb).yg.E2c(this.hfa);Yb.da.Gb(291,Nc=>{this.hasTabbedOut=Nc.ui;Nc.WIa(this.xX)});this.wasUserActiveOnPIStart&&Yb.ea.zf.$ye(this.ZKd)}}
Object(f.a)(Ke,"PartialInteractivityData",null,[]);var Bb=a(1083);class Ob extends Ke{constructor(Yb,Nc,ud,Mb,rc,id){super(Yb,Nc,Mb);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=ud;this.disconnectionSource=Enum.toString(Bb.a,
rc);this.triggeringRequest=id}D2i(Yb,Nc){this.swappedByOffline=Nc;this.iKd(Yb)}WMj(Yb){this.errorDataDuringConnectivityIssuesMode=Yb}Vrj(Yb){10>this.failedRequests.length&&(Yb=Yb+"_"+Jd.getElapsedSeconds(this.startTime,Lb.a.Bb.Cc).toString(),this.failedRequests.push(Yb))}}Object(f.a)(Ob,"ConnectivityIssuesData",Ke,[]);var ed=a(175),Sd=a(138),Pd=a(121);class ic{}ic.KAh="DuringWork";ic.connectivityIssues="ConnectivityIssues";ic.offline="Offline";Object(f.a)(ic,"UnavailabilityTypes",null,[]);var Kc=
a(55);class dc{constructor(Yb){this.Zpc=this.data=null;this.Yhd=0;this.MMe=null;this.UJf=(Nc,ud)=>{ud.fN?(this.data=new Ob(Lb.a.Bb.Cc,this.$,5===ud.Vqa,0!==ud.Vqa,this.$.Af.disconnectionSource,this.MMe),this.Zpc=this.$.Af.Jxf,this.Yhd=1,this.$.qa.Af.vZg(this.tn),ed.a(this.$).j2c(this.c$f)):(this.data.D2i(this.$,5===ud.Vqa),this.$.qa.Af.j5f(this.tn),this.data.lastFailedRequestToOnlineTimeGapSec=Jd.getElapsedSeconds(this.Zpc,Lb.a.Bb.Cc),Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
Kc.b().IQb(557682689,0,50,ic.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",ob.a.Zc(this.data)):e.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${ob.a.Zc(this.data)}`),this.data&&this.data.isToastShown&&vb.Health.instance.recordQosError(Sd.a.Reh,[Pd.a.Hqc],!0,!1,!1,!1,null),ed.a(this.$).hSd(this.c$f),this.data=null)};this.c$f=
(Nc,ud)=>{this.data.WMj(ud.DR)};this.tn=(Nc,ud)=>{this.data.Vrj(ud.context.methodName);Nc=Lb.a.Bb.Cc;ud=Jd.getElapsedSeconds(this.Zpc,Nc);this.Zpc=Nc;ud>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=ud);this.Yhd++;this.data.averageDurationBetweenFailedRequestsSec=this.r$g(ud)};this.RJf=(Nc,ud)=>{this.MMe=ud.b$j};this.$=Yb;Yd.a(this.$).yg.Exe(this.UJf);this.$.Af.Dxe(this.RJf)}dispose(){this.$&&(Yd.a(this.$).yg.j4f(this.UJf),this.$.Af&&this.$.Af.i4f(this.RJf));
this.data&&this.$.qa.Af.j5f(this.tn);this.$=null}r$g(Yb){const Nc=this.Yhd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Nc-1)+Yb)/Nc}}Object(f.a)(dc,"ConnectivityIssuesTelemetryManager",null,[2]);var Hc=a(894),Uc=a(9),Fd=a(1082),Td=a(1081);class ad{constructor(Yb){this.d9f=null;this.jBd=this.NFd=this.WJb=this.XJb=0;this.m_d=!1;this.b$c=this.aWa=this.GFc=this.icb=null;this.q$c=0;this.rJj=()=>{if(12E4>this.$.ea.zf.Uib)for(let Nc of this.GFc)Nc.runTest();else this.j2d("UserInactive")};
this.NBj=Nc=>{Nc=Sys.Serialization.JavaScriptSerializer.serialize(Nc);e.ULS.sendTraceTag(388821830,0,50,Nc)};this.cBj=Nc=>{if(Nc){var ud=this.b$c[Nc.testIteration.toString()];ud?ud.push(Nc):(ud=[Nc],this.b$c[Nc.testIteration.toString()]=ud);if(ud.length===this.d9f.length){ud=Sys.Serialization.JavaScriptSerializer.serialize(ud);if(this.$&&this.$.Af){if(Nc.EstimatedLatency=this.$.Af.SDe,this.$.Af.SDe>this.$.gA.ExcelRountripThresholdMs){e.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${ud}, consequtive slow ping iteration #: ${this.q$c++}`);
return}}else e.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");e.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${ud}`);this.q$c=1}}};this.Th=(Nc,ud)=>{Nc=ud.context.methodName;if(Nc===Uc.a.FBb||Nc===Uc.a.jya)this.WJb++,Nc=Date.now(),this.EUj(Nc)&&(this.WJb=0,this.jBd=Nc,this.O1j())};this.gfa=()=>{this.M1d("OnThrottledUserActivity")};this.xX=()=>{this.j2d("OnDocumentHidden")};this.tJ=()=>{this.M1d("OnDocumentUnhidden")};
this.$=Yb;if(this.n_d=this.idh())this.d9f=[Td.a.vLc],this.q$c=1,this.b$c={},this.$.ea.zf.gja(this.gfa),this.$.da.Gb(291,Nc=>{Nc.WIa(this.xX);Nc.Lua(this.tJ)})}dispose(){this.$&&(this.m_d&&this.$.qa&&0<this.icb.count&&this.$.qa.Mt(this.Th),this.n_d&&(this.j2d("Dispose"),this.$.ea.zf.OCa(this.gfa)))}msi(){Ua.EwaSettings.ya(199)&&this.Gkj();this.n_d&&this.Hkj()}Ksi(){this.WJb=this.XJb;this.jBd=0;var Yb={};if(!this.icb){this.icb=new aa.a;const Nc=Fd.a.Okd(this.NBj,"InitSampleMeasurement",this.$);for(const ud of Nc)Yb[ud.Gsd]=
ud.baseUrl,this.icb.add(ud)}Yb=Sys.Serialization.JavaScriptSerializer.serialize(Yb);e.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.XJb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.WJb}, testParams: ${Yb} `);0<this.icb.count&&this.$.qa.ms(this.Th)}O1j(){for(let Yb of this.icb)Yb.runTest()}M1d(Yb){this.aWa&&this.aWa.Po||(e.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${Yb}`),
this.aWa=Xa.a.instance.ZD(this.rJj,5E3,ka.a.M_j),this.aWa.PW())}j2d(Yb){this.aWa&&this.aWa.Po&&(e.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${Yb}`),this.aWa.cancel())}EUj(Yb){return this.WJb>=this.XJb&&Yb-this.jBd>this.NFd}idh(){return ad.T8f(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}Gkj(){this.XJb=this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;this.NFd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const Yb=this.$.xa.NetworkMeasurementsSamplePercentage;
0<this.XJb&&0<this.NFd&&(this.m_d=ad.T8f(Yb))&&this.Ksi()}Hkj(){if(!this.GFc){this.GFc=new aa.a;const Yb=Fd.a.Okd(this.cBj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Td.a.vLc]);for(const Nc of Yb)this.GFc.add(Nc);this.$.ea.zf.Tq&&this.M1d("PrepareAndInitSlowNetworkTests")}}static T8f(Yb){return 100*Math.random()<Yb}}Object(f.a)(ad,"NetworkMeasurement",null,[2]);var Qd=a(40),Zb=a(141),Wc=a(821);class md{constructor(Yb){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=
null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Yb}get count(){return this._count}get DV(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}Jdk(){this.DV&&this.DV.Wcg()}VTg(Yb){this.allOfflinePartialInteractivitiesDataInSession.push(Yb);this._count++}}Object(f.a)(md,"OfflinePartialInteractivitiesDataForLog",null,[]);class Nd extends Ke{constructor(Yb,Nc,ud){super(Yb,Nc,ud);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=
null;this.timeFromLastOffline=-1;this.type=5}HQj(Yb){this.timeFromLastOffline=Yb}XMj(Yb){this._errorDataDuringOfflineMode=Yb}}Object(f.a)(Nd,"OfflinePartialInteractivityData",Ke,[]);class kd{constructor(Yb,Nc){this.QRa=this.DV=null;this.dOd=-1;this.Azb=null;this.Dxf=w.Task.delay(0);this.ddb=(ud,Mb)=>{Mb.fN?this.Q9i(Mb.Vqa):this.R9i()};this.hfa=(ud,Mb)=>{5===Mb.SUf&&this.F6a()};this.d$f=(ud,Mb)=>{this.DV.XMj(Mb.DR)};this.F6a=()=>{this.QRa.Jdk();this.LGj(kd.dMd,Sys.Serialization.JavaScriptSerializer.serialize(this.QRa))};
this.DBj=ud=>{if(ud=ud.result)this.Twg=!0,e.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${ud}`)};this.Qvj=()=>{this.Twg&&(this.$?Qd.TaskExtensions.za(this.indexedDB.ldd(kd.dMd),()=>{e.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ka):e.ULS.sendTraceTag(537155203,
0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.VRa=()=>{if(this.QRa&&0<this.QRa.count){const ud=Sys.Serialization.JavaScriptSerializer.serialize(this.QRa);e.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${ud}`)}};this.$=Yb;this.indexedDB=Nc;this.Twg=!1;this.indexedDB.sf()&&(this.indexedDB.initialize(kd.EDb,kd.FDb),this.YAj(),this.QRa=
new md(this.$.xa.UserSessionId),Yd.a(this.$).yg.y2c(this.ddb));this.xn=Zb.a.instance.sI();this.xn.la("beforeunload",this.VRa)}dispose(){this.$&&Yd.a(this.$)&&Yd.a(this.$).yg.xSd(this.ddb);pc.a.Ka(this.Azb);this.$=this.Azb=null}Q9i(Yb){this.DV=new Nd(Lb.a.Bb.Cc,this.$,0!==Yb);this.DV.HQj(-1!==this.dOd?window.performance.now()-this.dOd:-1);this.QRa.VTg(this.DV);Yd.a(this.$).yg.E2c(this.hfa);this.F6a();this.Azb=Xa.a.instance.ZD(this.F6a,kd.yUh,ka.a.F6a);ed.a(this.$).j2c(this.d$f)}R9i(){this.DV.iKd(this.$);
this.F6a();pc.a.Ka(this.Azb);this.Azb=null;this.dOd=window.performance.now();Yd.a(this.$).yg.fAc(this.hfa);ed.a(this.$).hSd(this.d$f);this.dBj()}LGj(Yb,Nc){this.$?this.Dxf=Qd.TaskExtensions.za(this.Dxf,()=>{this.indexedDB.Fgb(new Wc.a(Yb,Nc))},this.$.ka):e.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}YAj(){const Yb=this.$.ka;Qd.TaskExtensions.za(Qd.TaskExtensions.za(this.indexedDB.E7a(kd.dMd),this.DBj,
Yb),this.Qvj,Yb)}dBj(){if(this.DV){const Yb=Sys.Serialization.JavaScriptSerializer.serialize(this.DV);Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Kc.b().IQb(560791645,0,50,ic.offline,this.DV.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Yb):e.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${Yb}`)}this.DV&&
this.DV.isToastShown&&vb.Health.instance.recordQosError(Sd.a.Ohk,[Pd.a.Hqc],!0,!1,!1,!1,null)}}kd.EDb="NetworkAvailability";kd.FDb="NetworkAvailabilityData";kd.dMd="partialInteractivityData";kd.yUh=3E3;Object(f.a)(kd,"OfflineModeTelemetryManager",null,[2]);var yd=a(1348);const lc=Yb=>{Yb.isSuccess||(Yb=Sys.Serialization.JavaScriptSerializer.serialize(Yb),e.ULS.sendTraceTag(509669840,0,10,Yb))};class Lc{constructor(Yb,Nc){this.roa=this.MGd=this.AHf=null;this.$=Yb;Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
Ga.a.ng||(this.AHf=new kd(Yb,Nc));Ua.EwaSettings.ya(199)&&(this.MGd=new ad(this.$),this.MGd.msi());Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Ga.a.ng||(this.roa=new Hc.NetworkConnectionHealthChecker(this.$));this.Lih=new dc(this.$);Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(Yb=this.$,Nc=Ua.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==Nc&&(new yd.a(Yb,"1CDN",Nc,lc,"runOneCdnNetworkTest")).runTest())}dispose(){pc.a.Ka(this.AHf);
pc.a.Ka(this.MGd);pc.a.Ka(this.roa);pc.a.Ka(this.Lih);this.$=null}}Object(f.a)(Lc,"NetworkConnectionTelemetryManager",null,[2]);class nd extends Ke{constructor(Yb,Nc,ud,Mb){super(Yb,Nc,ud);this.wasInteruptedByOfflineMode=!1;this.type=Mb;this.wasInteruptedByOfflineMode=!1}ddb(){this.wasInteruptedByOfflineMode=!0}}Object(f.a)(nd,"SilentReopenData",Ke,[]);class Wd{constructor(Yb){this.d$=null;this.JRf=(Nc,ud)=>{this.HRf(ud,3)};this.XNf=(Nc,ud)=>{this.HRf(ud,2)};this.$=Yb;this.yg=Yd.a(this.$).yg;this.yg.mye(this.XNf);
this.yg.$Yg(this.JRf)}dispose(){this.yg.M4f(this.XNf);this.yg.Jzj(this.JRf);this.d$=this.yg=this.$=null}HRf(Yb,Nc){Yb.fN?this.d$=new nd(Lb.a.Bb.Cc,this.$,0!==Yb.Vqa,Nc):(5===Yb.Vqa&&(this.d$.wasInteruptedByOfflineMode=!0),3!==Yb.Vqa&&2!==Yb.Vqa||e.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.d$.iKd(this.$),2===Nc?Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
Kc.b().JQb(571289604,0,50,ic.offline,this.d$.durationMs,this.d$):e.ULS.sendTraceTag(571289604,0,50,ob.a.Zc(this.d$)):Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Kc.b().JQb(542782150,0,50,ic.KAh,this.d$.durationMs,this.d$):e.ULS.sendTraceTag(542782150,0,50,ob.a.Zc(this.d$)),this.d$=null)}}Object(f.a)(Wd,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);class $d extends X.a{constructor(Yb,Nc,ud=!0){super();this.E2=this.P9b=this.RRa=this.Gqa=
this.WVa=null;this.FFf=0;this.hzc=this.ufb=this.vfb=!1;this.HFf=this.documentVisibilityObserver=null;this.cta=!1;this.Ftd=this.m$=0;this.bGb=!1;this.Bjg=0;this.f_d=!1;this.T2=null;this.GOf=()=>{e.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.Jsc(1,!1)};this.tJ=()=>{this.nna||this.oIb?window.setTimeout(()=>{this.u4d()},this.FFf):this.u4d();this.documentVisibilityObserver.MCa(this.tJ);this.bGb=!1};this.Jg=()=>{e.ULS.sendTraceTag(537155218,0,
50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.oIb}, IsInDuringWorkSilentReopenMode:${this.xrc&&!this.cta}`);this.oIb&&this.Fue();this.xrc&&!this.cta&&this.Cue();ta.h(this.$).cellTextEditBox.Qm(this.Jg);this.vfb=this.ufb=!1};this.HOf=()=>{e.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.Jsc(1,!0);this.ufb&&!this.vfb&&ta.h(this.$).cellTextEditBox.Qm(this.Jg);this.ufb=!1};this.gfa=(Mb,rc)=>{this.Ftd=
this.m$;this.m$=rc.IHc};this.IRf=()=>{this.$&&(this.hzc||(Rb.a(this.$).TR(Fb.a.ASa).EWg(this.QOf),this.$.Ql(this.Td),this.hzc=!0),this.cta=this.Iyi(),this.Jsc(2,!1))};this.QOf=()=>{var Mb=Rb.a(this.$).Ei;const rc=Mb.$1g();Mb=la.f(Mb.au.Qd.errors,id=>id.MessageIdName);e.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${rc}, IsB2W:${this.cta}, Errors: ${ob.a.Zc(Mb)}`);rc&&(this.WVa?(this.cta=!1,this.JRe(),this.LIc()):this.Gqa&&
(this.KRe(),this.LIc()))};this.Td=()=>{this.$?(e.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.cta=!1,this.E2&&this.E2.Po&&(pc.a.Ka(this.E2),this.E2=null),this.T2&&this.T2.Po&&(pc.a.Ka(this.T2),this.T2=null),this.Jsc(2,!0),this.LIc()):e.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.SJf=()=>{this.HEf(!0)};this.TJf=()=>{this.HEf(!1)};this.w1b=Rd.uNi;this.m$c=Rd.connected;
this.$=Yb;this.Af=Yb.qa.Af;ud&&(this.HFf=new Lc(Yb,Nc));this.$.da.Gb(291,Mb=>{this.documentVisibilityObserver=Mb});this.FFf=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;this.Af.sye(this.GOf);this.Af.asb(this.HOf);this.Af.Dxe(this.SJf);this.Af.mWg(this.TJf);new Wd(this.$,this);this.fBf=this.$.xa.LongInactivityTimePeriodSeconds;this.$.ea.P4b(this.IRf);this.$.ea.zf.gja(this.gfa);this.Bjg=this.$.xa.SilentReopenDuringWorkDelayMs}get RAi(){return this.cta}get oIb(){return!(this.w1b&1)}get xrc(){return!(this.w1b&
2)}get nna(){return!!(this.m$c&2)}dispose(){this.Af&&(this.Af.R4f(this.GOf),this.Af.DOb(this.HOf),this.Af.i4f(this.SJf),this.Af.zxj(this.TJf));this.bGb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.MCa(this.tJ),this.bGb=!1);this.$&&(this.hzc&&this.LIc(),this.$.ea&&(this.$.ea.MSd(this.IRf),this.$.ea.zf&&this.$.ea.zf.OCa(this.gfa)));this.T2&&(this.T2.dispose(),this.T2=null);pc.a.Ka(this.HFf);this.$=null;super.dispose()}XTi(){this.f_d=!0}Cue(){this.Gqa||(this.Gqa=Yd.a(this.$).yg.IIa(3,
"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}Iyi(){if(this.f_d)return this.f_d=!1,!0;const Yb=this.m$>this.fBf||this.Ftd>this.fBf&&10>this.m$;e.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.m$}, Time gap between last two activities: ${this.Ftd}. return value:${Yb}`);return Yb}RBj(){this.T2=Xa.a.instance.create(()=>{vb.Health.instance.recordQosError(Sd.a.R_j,[Pd.a.Hqc],
!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}vRg(){this.Gqa||this.E2?e.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.E2=Xa.a.instance.create(()=>{this.$?this.Gqa?e.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):
ta.h(this.$).Eb?(this.ufb||(ta.h(this.$).cellTextEditBox.Bm(this.Jg),e.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.vfb=!0,e.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.Cue():e.ULS.sendTraceTag(537155222,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.Bjg,ka.a.LZj,void 0,!0)}HEf(Yb){this.m$c=this.vGe(2,Yb,!0);this.wze()}Jsc(Yb,Nc){this.w1b=this.vGe(Yb,Nc,!1);this.wze()}vGe(Yb,Nc,ud){ud=ud?this.m$c:this.w1b;return Nc?ud|Yb:ud&~Yb}u4d(){const Yb=!!this.RRa,Nc=!!this.WVa,ud=!!this.Gqa,Mb=!!this.P9b;this.oIb&&!Yb?this.uRg():!this.oIb&&Yb&&this.guh();!this.xrc||Nc||ud?this.xrc||(Nc?this.JRe():(ud||this.E2&&this.E2.Po)&&this.KRe()):this.cta?this.tRg():
this.E2||this.vRg();this.nna&&!Mb?this.Mog(!0):!this.nna&&Mb&&this.Mog(!1)}uRg(){this.$?this.RRa?e.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):ta.h(this.$).Eb?(this.vfb||(ta.h(this.$).cellTextEditBox.Bm(this.Jg),e.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.ufb=!0,e.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Fue():e.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}Fue(){this.RRa||(this.RRa=Yd.a(this.$).yg.IIa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}guh(){this.RRa&&(pc.a.Ka(this.RRa),this.RRa=
null)}JRe(){this.WVa&&(pc.a.Ka(this.WVa),this.WVa=null);this.T2&&this.T2.Po&&this.T2.cancel();this.T2=null}KRe(){this.Gqa&&(pc.a.Ka(this.Gqa),this.Gqa=null);this.E2&&(pc.a.Ka(this.E2),this.E2=null);this.vfb&&!this.ufb&&ta.h(this.$).cellTextEditBox.Qm(this.Jg);this.vfb=!1}tRg(){this.WVa||(this.WVa=Yd.a(this.$).yg.IIa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",void 0,Tb.a.instance.ha(2190)));this.RBj()}Mog(Yb){Yb?(this.P9b=Yd.a(this.$).yg.IIa(4,"NetworkConnectionStateManager.ConnectivityIssues"),
this.Enj()):(pc.a.Ka(this.P9b),this.P9b=null)}Enj(){if(this.$&&this.$.qa){const Yb=this.$.qa.va.Bc();Oa.I(this.$.qa.va,null,null,null,Yb)}}LIc(){Rb.a(this.$).TR(Fb.a.ASa).Rr(this.QOf);this.$.Rm(this.Td);this.hzc=!1}wze(){this.documentVisibilityObserver||e.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.ui?this.bGb||
(this.documentVisibilityObserver.Lua(this.tJ),this.bGb=!0,e.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.u4d()}}Object(f.a)($d,"NetworkConnectionStateManager",X.a,[594,2]);var se=a(36),je=a(149);class Le extends fb.a{constructor(Yb){super();this.$=Yb;this.kc()}create(){void je.a.resolve(se.U,{Wa:this.La}).then(Yb=>{let Nc=Object(oa.a)(this.$.da,
400,()=>new $d(this.$,Yb));this.Pb(Nc)})}static la(Yb){Yb.da.Ja(401,new Le(Yb))}}Object(f.a)(Le,"NetworkConnectionStateManagerFactory",fb.a,[]);var oe=a(1084),ue=a(1320),df=a(1331),Se=a(1332),bf=a(1094),Ye=a(1333),gf=a(1220),nf=a(1189),oc=a(1290),Ac=a(1190),xa=a(1283),Cb=a(1266),bc=a(1096),Fc=a(1321),Tc=a(1272),gd=a(1245),td=a(1291),kb=a(1254),Vb=a(1203),qc=a(1100),Bc=a(1204),$b=a(1273),tc=a(1292),Xc=a(1322);a(1102);var qd=a(1212),Cd=a(1103),Xd=a(1236),ge=a(1293),ve=a(1255),Ie=a(1294),Ee=a(1106),
pf=a(1295),Xe=a(1256),Ve=a(1224),wf=a(114),Ff=a(112),db=a(173),U=a(282);class Ta{constructor(Yb){this.lRa=this.uEd=this.pRa=this.Jrc=0;this.nEd=this.sCf=null;Yb?(this.Trc=Yb,this.fxb=Date.now,this.Vph(),this.ruj()):e.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}cPj(){this.sCf="Office.Excel.Online.Data.Activity.PenMinutes"}ruj(){window.document.body.addEventListener("pointerenter",Object(z.a)(this,this.tvc,"onPointerEnter"));window.document.body.addEventListener("pointerleave",
Object(z.a)(this,this.efa,"onPointerLeave"));Aa.a.instance.qc("Common.App.VisibilityManagement.IVisibilityManager").execute(Yb=>{Yb.Fye(Object(z.a)(this,this.nCb,"handleVisibilityChange"))})}tvc(Yb){"pen"!==Yb.pointerType||this.pRa||(this.pRa=Math.floor(this.fxb()/1E3),this.pRa<=this.Jrc&&(this.pRa=this.Jrc),this.uEd=0)}efa(){this.Zhf()}Zhf(){const Yb=Math.ceil(this.fxb()/1E3);this.pRa&&Yb>this.Jrc&&(this.uEd=Yb,this.lRa+=this.uEd-this.pRa);this.Jrc=Yb;this.pRa=0}nCb(Yb,Nc){0!==Nc.newState&&this.Zhf()}Vph(){this.nEd=
new Ff.a(4,2,6E4,Object(z.a)(this,this.MQi,"logPenUsage"));this.Trc.jg(this.nEd)}MQi(){0<this.lRa&&this.kbg(this.lRa);this.lRa=0}kbg(Yb){const Nc=new U.a;Nc.name=this.sCf;const ud=[];(Yb=wf.a.ug("PenInputSec",Yb.toString(),3))&&Array.add(ud,Yb);Nc.dataFields=ud;db.a.sendActivityEvent(Nc)}dispose(){0<this.lRa&&this.kbg(this.lRa);this.Trc.Zp(this.nEd)}}Object(f.a)(Ta,"PenMinutesManager",null,[521]);class wb{constructor(){this.EWc=this.Db=null}get name(){return"Common.App.PenMinutesManager"}Di(Yb){this.Db=
Yb;const Nc=d.AFrameworkApplication.Mi;this.Db.register(521,"Common.App.PenMinutesManager.IPenMinutesManager").Uc().dd(()=>new Ta(Nc))}init(){this.EWc=this.Db.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.EWc&&this.EWc.dispose()}static main(){W.a.instance.nj(new wb)}}Object(f.a)(wb,"PenMinutesManagerPackage",null,[4,5]);class Qb extends fb.a{constructor(Yb){super();this.$=Yb;this.kc()}static la(Yb){Yb.da.Ja(514,new Qb(Yb))}create(){this.Pb(Object(oa.a)(this.$.da,513,()=>
{Type.registerNamespace("Common.App.PenMinutesManager");wb.main();const Yb=Aa.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");Yb.cPj();return Yb}))}}Object(f.a)(Qb,"PenMinutesFactory",fb.a,[]);var sc=a(119);class Vc{static Z0h(Yb){try{return caches.open(Vc.Ebe).then(Nc=>Nc.match(Yb))}catch(Nc){return Promise.reject(null)}}static Kxa(Yb,Nc){try{return Vc.Z0h(Yb).then(ud=>ud&&Number.parseInvariant(ud.headers.get("cachedTime"))>Date.now()-Nc?Promise.resolve(ud.text().toLocaleString()):
Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(ud){return Promise.reject(null)}}static store(Yb,Nc){try{return caches.open(Vc.Ebe).then(ud=>{ud.put(Yb,Nc).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(ud){return Promise.resolve(!0)}}static G2j(Yb,Nc){const ud={};ud.body=Nc;const Mb={};Mb.cachedTime=Date.now().toString();ud.headers=Mb;Nc=new Response(Nc,ud);Vc.store(Yb,Nc).then(()=>!0)}}Vc.Ebe="ConsentState";Object(f.a)(Vc,"CacheManager",null,
[]);class Ld{constructor(){this.message=null;this.Sya=0}}Object(f.a)(Ld,"HttpRequstToPromiseRejectData",null,[]);var le=a(69),Ce=a(355);class Oe{constructor(Yb){this.zZ=Yb}rX(Yb,Nc,ud,Mb,rc,id){db.a.sendTelemetryEvent(Object.assign(new Ce.a,{name:"Office.Online."+Yb,dataFields:[Object.assign(new le.a,{name:"EventMessage",string:Nc}),Object.assign(new le.a,{name:"FormFactor",string:this.zZ.formFactor}),Object.assign(new le.a,{name:"CorrelationId",string:this.zZ.correlationId}),Object.assign(new le.a,
{name:"AccountType",string:this.zZ.accountType}),Object.assign(new le.a,{name:"OSVersion",string:this.zZ.osVersion}),Object.assign(new le.a,{name:"AppId",string:this.zZ.appId}),Object.assign(new le.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new le.a,{name:"ConsentLanguage",string:this.zZ.consentLanguage}),Object.assign(new le.a,{name:"EventCode",string:ud}),Object.assign(new le.a,{name:"Region",string:this.zZ.region}),Object.assign(new le.a,{name:"ModelType",string:Mb}),Object.assign(new le.a,
{name:"ModelId",string:rc}),Object.assign(new le.a,{name:"Platform",string:this.zZ.os}),Object.assign(new le.a,{name:"ReConsentReason",string:""}),Object.assign(new le.a,{name:"ConsentType",string:id})]}))}}Object(f.a)(Oe,"TelemetryLogger",null,[]);var ef=a(249);class uf{constructor(Yb,Nc,ud){this.PEg="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Ta=Yb;this.lh=Nc;this.qua=ud;this.NQ=new Oe(ud)}swb(Yb,Nc){return new Promise((ud,Mb)=>{const rc=this.Ta.oe("UCNoticeCheckinCallTimeoutMs",
5E3);let id=this.Ta.Va("UCNoticeCheckinStateUrl");id&&id.length||(id=this.PEg);this.lh.$aa(id,1,null,this.ond(Yb),null,!1,0,Gd=>{try{if(void 0===Gd||null===Gd||void 0===Gd.data||null===Gd.data||void 0===Gd.data.Fe||null===Gd.data.Fe){this.NQ.rX("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);let ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");
Mb(this.H6(ae,Gd))}else if(Gd.data.httpStatus!==ef.a.hK){this.NQ.rX("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",Gd.data.httpStatus.toString(),null,null,null);let ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Gd.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Mb(this.H6(ae,Gd))}else{var de=Nc(Gd.data.Fe);if(de)ud(de);else{this.NQ.rX("UnifiedConsent.ConsentGetFailed",
"CheckInApi : Consent values are empty","712",null,null,null);let ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");Mb(this.H6(ae,Gd))}}}catch(ae){this.NQ.rX("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ae,"UnifiedConsent.ConsentGetFailed"),Mb(this.H6(de,
Gd))}},Gd=>{this.NQ.rX("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Gd.data.httpStatus.toString(),null,null,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",Gd.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Mb(this.H6(de,Gd))},null,void 0,void 0,2500,rc)})}H6(Yb,Nc){const ud=new Ld;ud.message=Yb;ud.Sya=Nc&&Nc.data?Nc.data.httpStatus:-1;return ud}ond(Yb){const Nc={};Nc["Accept-Language"]=
this.qua.consentLanguage;Nc.consentsurface="AppStart";Nc.platform="Web";Nc.formfactor=Ga.a.S0?"Mobile":"Desktop";Nc["x-Cid"]=this.qua.correlationId;Nc.Authorization="Bearer "+Yb;return Nc}}Object(f.a)(uf,"HttpRequestToPromiseUtility",null,[]);class Ab{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=
!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(f.a)(Ab,"WebSdkAdapterProps",null,[]);var cc=a(185);class uc{constructor(Yb,Nc,ud,Mb){this.$ge=this.tha=this.V3=this.uZ=null;this.kYa=Mb;this.Ta=Yb;this.qDg=ud;this.lh=Nc;this.qua=this.getDimensions();this.NQ=new Oe(this.qua)}Uhg(){"MSA"===(this.Ta.Va("HostAuthType")||"").toUpperCase()&&Vc.Kxa(this.qua.userId,this.Ta.oe("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.NQ.rX(uc.eHa,"CacheFound","701",this.uZ,this.V3,this.tha);return{}}).catch(()=>
{this.qDg.execute(Yb=>{Yb.dD("Consent",uc.YOg).then(Nc=>{Nc.IsSuccess?(this.NQ.rX(uc.eHa,"CheckInTokenSuccess","702",this.uZ,this.V3,this.tha),this.F2h(Nc.Token).then(ud=>{this.I9h(ud);this.uZ&&""!==this.uZ&&Yb.dD("Consent",uc.$Og).then(Mb=>{Mb.IsSuccess?(this.NQ.rX(uc.eHa,"WebTokenSuccess","703",this.uZ,this.V3,this.tha),this.sYj(Mb,this.uZ)):this.NQ.rX(uc.eHa,"WebTokenFailed : "+Mb.ErrorMessage,Mb.ErrorCode,this.uZ,this.V3,this.tha);return{}});return{}})):this.NQ.rX(uc.eHa,"CheckInTokenFailed : "+
Nc.ErrorMessage,Nc.ErrorCode,this.uZ,this.V3,this.tha);return{}})})})}F2h(Yb){this.$ge=new uf(this.Ta,this.lh,this.qua);return this.$ge.swb(Yb,Object(z.a)(this,this.zgj,"parseConsentCheckinState")).then(Nc=>Promise.resolve(Nc),Nc=>Promise.reject("Error while getting result"+Nc))}zgj(Yb){if(void 0===Yb||null===Yb)return this.NQ.rX(uc.eHa,"Checkin response undefined or null","705",this.uZ,this.V3,this.tha),null;try{let Nc;({qt:Nc}=Z.d(Yb));return Nc}catch(Nc){this.NQ.rX(uc.eHa,"Checkin response parse error : "+
Nc.message,"706",this.uZ,this.V3,this.tha)}return null}I9h(Yb){for(const Nc of Yb.consentValues)if(Nc.needConsent&&!Nc.maxPromptsReached){this.V3=Nc.id;this.tha=Nc.consentType;this.uZ=Nc.modelType;return}Vc.G2j(this.qua.userId,Z.c(Yb))}sYj(Yb,Nc){if(B.a("showConsentNotice")){const ud=document.createElement("div");document.body.appendChild(ud);appChrome.api.showConsentNotice(this.j4h(Yb.Token,Nc),ud)}else this.NQ.rX(uc.RJg,"1JS : ShowConsentNotice API not found","704",this.uZ,this.V3,this.tha)}j4h(Yb,
Nc){const ud=this.qua;ud.token=Yb;ud.modelType=Nc;return ud}getDimensions(){const Yb=this.Xtd(this.Ta.Va("SessionStartInfoJson"));return Object.assign(new Ab,{emailId:this.Ta.Va("UserPrincipalName"),userId:this.Ta.Va("LoggableUserId"),accountType:"AAD"===(this.Ta.Va("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ta.Va("OfficeApplicationId"),appVersion:this.Ta.Va("appVersion"),appName:"Application"in Yb?Yb.Application:"",appEnv:this.kYa,consentLanguage:this.Ta.Va("UICulture")||"en-US",formFactor:Ga.a.S0?
"Mobile":"Desktop",os:"Os"in Yb?Yb.Os:"",osVersion:"OsVersion"in Yb?Yb.OsVersion:"",region:this.Ta.Va("region"),correlationId:cc.a.create().toString(),isDarkMode:this.Ta.ra("DarkModeIsOn"),useCache:!0})}Xtd(Yb){let Nc={};try{Nc=Z.b(Yb)}catch(ud){}return Nc}}uc.$Og="https://consentservice.microsoft.com/web";uc.YOg="https://consentservice.microsoft.com/checkin";uc.RJg="UnifiedConsent.ConsentGetFailed";uc.eHa="UnifiedConsent.AuthTokenStatus";Object(f.a)(uc,"ConsentNoticeManager",null,[522]);class $c{constructor(){this.Db=
null}get name(){return"Common.App.ConsentNoticeDialog"}Di(Yb){this.Db=Yb;Yb.register(uc,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").Uc().dd(()=>new uc(d.AFrameworkApplication.fa,d.AFrameworkApplication.de,Yb.qc("Common.App.OAuth.IOAuthManager"),d.AFrameworkApplication.mMa))}init(){this.Db.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){W.a.instance.nj(new $c)}}Object(f.a)($c,"ConsentNoticeDialogPackage",
null,[4,5]);let Bd=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");$c.main();Aa.a.instance.qc("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(Yb=>Yb.Uhg())}};Bd=Object(sc.b)([Object(je.d)(se.xb)],Bd);Object(f.a)(Bd,"UnifiedConsentAdapter",null,[]);var ee=a(128);let qe=class{constructor(Yb){this.shortcutKeyManager=Yb.shortcutKeyManager;this.isMac=Ga.a.isMac}ONj(){const Yb=this.nhh.concat(this.gWi).map(Nc=>appChrome.actions.setControlCustomTooltip(Nc.commandId,
this.Qic(Nc)));appChrome.api.dispatch(Yb)}fkb(Yb,Nc){this.gbk&&(this.eN[0].title=this.eN[2].title=this.w7d(Yb),this.eN[1].title=this.Ztg(Nc),this.eN[1].shortcut=this.isMac?this.shortcutKeyManager.qm(192):this.shortcutKeyManager.qm(154));Yb=this.Qic(this.eN[1]);Nc=this.Qic(this.eN[2]);Yb=[appChrome.actions.setControlCustomTooltip(this.eN[0].commandId,this.Qic(this.eN[0])),appChrome.actions.setControlCustomTooltip(this.eN[1].commandId,Yb),appChrome.actions.setControlCustomTooltip(this.eN[2].commandId,
Nc)];appChrome.api.dispatch(Yb)}IPi(Yb,Nc){this.CHi(Yb)&&ee.b(Nc)}CHi(Yb){return-1502853784===Yb||-111689794===Yb||-287251124===Yb||-1925065947===Yb||1764140053===Yb||-1590502662===Yb||-600086683===Yb||963349338===Yb||862890474===Yb||1220954656===Yb||1891435765===Yb||1896159024===Yb||-1554384558===Yb||-1985798686===Yb||-911352779===Yb||237279923===Yb||996232352===Yb?!0:!1}get gWi(){this.VH||(this.VH=[],this.VH.push(this.tj("Paste_MLR",Tb.a.instance.Ha(513),Tb.a.instance.Ha(767),this.shortcutKeyManager.qm(176))),
this.VH.push(this.tj("Cut",Tb.a.instance.Ha(511),Tb.a.instance.Ha(768),this.shortcutKeyManager.qm(172))),this.VH.push(this.tj("Copy",Tb.a.instance.Ha(512),Tb.a.instance.Ha(769),this.shortcutKeyManager.qm(174))),this.VH.push(this.tj("AlignTop_MLR",Tb.a.instance.Ha(791),Tb.a.instance.Ha(792))),this.VH.push(this.tj("AlignMiddle_MLR",Tb.a.instance.Ha(793),Tb.a.instance.Ha(794))),this.VH.push(this.tj("AlignBottom_MLR",Tb.a.instance.Ha(795),Tb.a.instance.Ha(796))),this.VH.push(this.tj("AlignLeft_MLR",Tb.a.instance.Ha(797),
Tb.a.instance.Ha(799))),this.VH.push(this.tj("AlignCenter_MLR",Tb.a.instance.Ha(800),Tb.a.instance.Ha(801))),this.VH.push(this.tj("AlignRight_MLR",Tb.a.instance.Ha(802),Tb.a.instance.Ha(803))),this.VH.push(this.tj("IncreaseIndent",Tb.a.instance.Ha(804),Tb.a.instance.Ha(805))),this.VH.push(this.tj("DecreaseIndent",Tb.a.instance.Ha(806),Tb.a.instance.Ha(807))),this.VH.push(this.tj("Wrap",Tb.a.instance.Ha(808),Tb.a.instance.Ha(809))),this.VH.push(this.tj("Merge",Tb.a.instance.Ha(810),Tb.a.instance.Ha(811))),
this.VH.push(this.tj("NumberFormatPercentage_MLR",Tb.a.instance.ha(453),Tb.a.instance.Ha(814),this.shortcutKeyManager.qm(404))),this.VH.push(this.tj("NumberFormatComma_MLR",Tb.a.instance.Ha(815),Tb.a.instance.Ha(816))));return this.VH}get nhh(){this.Yo||(this.Yo=[],this.Yo.push(this.tj("UndoRedo",Tb.a.instance.Ha(83),"",this.isMac?this.shortcutKeyManager.qm(191):this.shortcutKeyManager.qm(153))),this.Yo.push(this.tj("FormatPainter",Tb.a.instance.ha(14),Tb.a.instance.Ha(770))),this.Yo.push(this.tj("FontName_New",
Tb.a.instance.Ha(771),Tb.a.instance.Ha(772))),this.Yo.push(this.tj("FontSize",Tb.a.instance.Ha(773),Tb.a.instance.Ha(774))),this.Yo.push(this.tj("Bold",Tb.a.instance.ha(1333),Tb.a.instance.Ha(775),this.isMac?this.shortcutKeyManager.qm(180):this.shortcutKeyManager.qm(179))),this.Yo.push(this.tj("Italic",Tb.a.instance.ha(1334),Tb.a.instance.Ha(776),this.isMac?this.shortcutKeyManager.qm(184):this.shortcutKeyManager.qm(183))),this.Yo.push(this.tj("BordersSplitButtonCompactMenu",Tb.a.instance.Ha(777),
Tb.a.instance.Ha(779),this.isMac?this.shortcutKeyManager.qm(190):this.shortcutKeyManager.qm(189))),this.Yo.push(this.tj("FillColor",Tb.a.instance.ha(537),Tb.a.instance.Ha(780))),this.Yo.push(this.tj("FontColor",Tb.a.instance.Ha(781),Tb.a.instance.Ha(782))),this.Yo.push(this.tj("GrowFontSize",Tb.a.instance.Ha(783),Tb.a.instance.Ha(784),this.shortcutKeyManager.qm(187))),this.Yo.push(this.tj("ShrinkFontSize",Tb.a.instance.Ha(785),Tb.a.instance.Ha(786),this.shortcutKeyManager.qm(188))),this.Yo.push(this.tj("Underline",
Tb.a.instance.ha(1335),Tb.a.instance.Ha(787),this.isMac?this.shortcutKeyManager.qm(182):this.shortcutKeyManager.qm(181))),this.Yo.push(this.tj("Strikethrough",Tb.a.instance.ha(1336),Tb.a.instance.Ha(788),this.isMac?this.shortcutKeyManager.qm(186):this.shortcutKeyManager.qm(185))),this.Yo.push(this.tj("DoubleUnderline",Tb.a.instance.Ha(789),Tb.a.instance.Ha(790))),this.Yo.push(this.tj("NumberFormatNew",Tb.a.instance.Ha(812),Tb.a.instance.Ha(813))),this.Yo.push(this.tj("NumberFormatAccountingNew",Tb.a.instance.ha(449),
Tb.a.instance.Ha(817))),this.Yo.push(this.tj("IncreaseDecimal",Tb.a.instance.Ha(818),Tb.a.instance.Ha(819))),this.Yo.push(this.tj("DecreaseDecimal",Tb.a.instance.Ha(820),Tb.a.instance.Ha(821))),this.Yo.push(this.tj("ConditionalFormatting",Tb.a.instance.Ha(822),Tb.a.instance.Ha(823))),this.Yo.push(this.tj("CellStylesGallery",Tb.a.instance.Ha(824),Tb.a.instance.Ha(825))),this.Yo.push(this.tj("FormatAsTableAlt",Tb.a.instance.Ha(826),Tb.a.instance.Ha(827))),this.Yo.push(this.tj("Format",Tb.a.instance.Ha(828),
Tb.a.instance.Ha(829))),this.Yo.push(this.tj("AutoSum",Tb.a.instance.Ha(830),Tb.a.instance.Ha(831),this.shortcutKeyManager.qm(259))),this.Yo.push(this.tj("SortAndFilter",Tb.a.instance.Ha(832),Tb.a.instance.Ha(833))),this.Yo.push(this.tj("FindAndSelect",Tb.a.instance.Ha(834),Tb.a.instance.Ha(835),this.shortcutKeyManager.qm(85))),this.Yo.push(this.tj("AnalyzeData",Tb.a.instance.Ha(836),Tb.a.instance.Ha(837))),this.Yo.push(this.tj("Sensitivity",Tb.a.instance.Ha(838),Tb.a.instance.Ha(839))),this.Yo.push(this.tj("InsertCells",
Tb.a.instance.ha(345),Tb.a.instance.Ha(840),this.shortcutKeyManager.qm(409))),this.Yo.push(this.tj("DeleteCells",Tb.a.instance.ha(409),Tb.a.instance.Ha(841),this.shortcutKeyManager.qm(407))),this.Yo.push(this.tj("ClearCells",Tb.a.instance.Ha(842),Tb.a.instance.Ha(843))));return this.Yo}get gbk(){this.eN||(this.eN=[],this.eN.push(this.tj("Undo",this.w7d(2),Tb.a.instance.Ha(765),this.isMac?this.shortcutKeyManager.qm(191):this.shortcutKeyManager.qm(153))),this.eN.push(this.tj("Redo",this.Ztg(2),Tb.a.instance.Ha(766),
this.isMac?this.shortcutKeyManager.qm(192):this.shortcutKeyManager.qm(154))),this.eN.push(this.tj("UndoRedo",this.w7d(2),"",this.isMac?this.shortcutKeyManager.qm(191):this.shortcutKeyManager.qm(153))));return this.eN}tj(Yb,Nc,ud,Mb){return{commandId:Yb,title:Nc,description:ud,shortcut:Mb,Wni:Mb?!0:!1}}Qic(Yb){let Nc;Nc=Yb.title;Yb.Wni&&(Nc+=" "+Yb.shortcut);"UndoRedo"!==Yb.commandId&&(Nc+="\n\n"+Yb.description);return Nc}w7d(Yb){switch(Yb){case 1:case 0:return Yb=Tb.a.instance.Ha(81);case 3:return Yb=
Tb.a.instance.Ha(84);case 2:return Yb=Tb.a.instance.Ha(83);case 4:return Yb=Tb.a.instance.Ha(82);default:return Yb=Tb.a.instance.Ha(81)}}Ztg(Yb){switch(Yb){case 1:case 0:return Yb=Tb.a.instance.Ha(78);case 2:return Yb=Tb.a.instance.Ha(80);case 4:return Yb=Tb.a.instance.Ha(79);default:return Yb=Tb.a.instance.Ha(78)}}};qe=Object(sc.b)([Object(je.d)(se.C),Object(sc.c)(0,Object(se.A)())],qe);Object(f.a)(qe,"ExtendedTooltipsManager",null,[]);Type.registerNamespace("Common.App.InProductMessaging");pa.main();
Type.registerNamespace("Common.App.FirstRunExperienceLauncher");za.main();(()=>{ra.a.Fa(()=>{ra.a.Fa(Da.la)})})();(()=>{ra.a.Fa(()=>{ra.a.Fa(Za.la)})})();ra.a.Fa(ec.la);ra.a.Fa(Le.la);(()=>{ra.a.Fa(Yb=>{Qb.la(Yb)})})();Object(oe.a)();Object(ue.a)();(()=>{ra.a.Fa(Yb=>{df.a.la(Yb);Se.a.la(Yb)})})();(()=>{ra.a.Fa(Yb=>{Ye.a.la(Yb);bf.a.la(Yb)})})();(()=>{ra.a.Fa(Yb=>{gf.a.la(Yb)})})();(()=>{ra.a.Fa(Yb=>{nf.a.la(Yb)})})();Object(oc.a)();Object(Ac.a)();(()=>{ra.a.Fa(Yb=>{xa.a.la(Yb)})})();(()=>{ra.a.Fa(Yb=>
{Cb.a.la(Yb)})})();Object(bc.a)();Object(Fc.a)();Object(Tc.a)();Object(gd.a)();Object(td.a)();Object(kb.a)();Object(Vb.a)();Object(qc.a)();Object(Bc.a)();Object(tc.a)();Object($b.a)();Object(Xc.a)();Object(qd.a)();Object(Cd.a)();Object(Xd.a)();Object(ge.a)();Object(ve.a)();Object(Ie.a)();Ee.a.main();Object(pf.a)();Object(Xe.a)();Object(Ve.a)();String(c);String(b);window.___1684305534491_closurehack=c;window.___1684305534491_closurehack=b},735:function(u,C,a){a.d(C,"a",function(){return M});u=a(0);
var c=a(2),b=a(15),f=a(92),e=a(231),d=a(14),h=a(113),l=a(188),k=a(6),n=a(90);C=a(247);var v=a(1086),x=a(19),w=a(7),r=a(333),t=a(54),A=a(13),y=a(76),z=a(16),E=a(20),G=a(95),F=a(944),O=a(1);class M extends C.a{constructor(P,B){super(document.createElement("div"));this.wyf=this.kAe=this.yue=this.c9b=this.sea=this.J$=this.rQ=this.jA=null;this.Eya=this.GW=this.Hs=this.hideCloseButton=!1;this.j2i=D=>{this.ME(D)};this.p2i=D=>{13===D.keyCode&&this.ME(D)};this.jId=D=>{this.Km(D.Wb);return!0};this.oId=D=>{this.vX(D.Wb);
return!0};this.Vuc=D=>{this.Ooa(D.Wb?D.Wb:0);return!0};this.k2i=D=>{this.ME(D.Da);return!0};this.vAg=(D=null)=>{this.Km(D.inputMethod?D.inputMethod:0);return!0};this.wAg=(D=null)=>{this.vX(D.inputMethod?D.inputMethod:0);return!0};this.r3=P;this.Du=B;this.i5c=B.T2a.toString();this.title=B.title;this.message=B.message;this.set_visibilityMode(1)}get q9g(){return this.Du.T2a}get businessBar(){return this.r3}get actionButton(){return this.Du?this.Du.actionButton:""}get uJa(){return this.Du?this.Du.uJa:
""}get linkText(){return this.Du?this.Du.link:""}get vl(){return this.Du?this.Du.vl:""}get alt(){return this.Du?this.Du.alt:""}fqa(P){this.Du.businessBarType=P}dispose(){f.a.Rc([this.c9b,this.rQ,this.J$]);this.Hs&&this.rQ&&(e.a.instance.Aa(d.a.click,this.rQ.domElement,this.jId),h.KeyInputManager.instance.ty(this.domElement,this.yue));this.GW&&this.J$&&(e.a.instance.Aa(d.a.click,this.J$.domElement,this.oId),h.KeyInputManager.instance.ty(this.domElement,this.kAe));this.Eya&&this.sea&&(e.a.instance.Aa(d.a.click,
this.sea,this.Vuc),h.KeyInputManager.instance.ty(this.domElement,this.wyf));this.sea=this.jA=this.r3=this.J$=this.rQ=null;super.dispose()}update(){}gdk(){this.PPe(!0)}xOe(){this.PPe(!1)}Dqh(){const P=this.businessBar.$.nc.hh("DOMUpdate","ReactBusinessBar");P.start();this.message=G.a.Mf(this.message);this.title=G.a.Mf(this.title);l.UISurfaces.Und().then(B=>{B.initializeMessageBarInStore();let D=Object(c.a)(new F.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.Du.businessBarType,
dismissButtonAriaLabel:z.a.instance.ha(10)});this.hideCloseButton||(D.onDismiss=this.k2i);this.Eya&&(D.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Vuc});this.Hs&&(D.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.vAg});this.GW&&(D.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.uJa,["onExecute"]:this.wAg});O.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.Du.iconName&&
(D.messageBarIconProps={["iconName"]:this.Du.iconName});O.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?B.createNewMessageBarWithCallback(this.domElement,D,()=>{P.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.Du.lMa} in: ${P.fd} milliSeconds.`)}):B.createNewMessageBar(this.domElement,D);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.Du.lMa} could not be initialized`);return null});if(k.AFrameworkApplication.fa.ra("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),
this.domElement.classList.add("WACBusinessBarEntry");else{let B="1px solid ";switch(this.Du.businessBarType){case 1:case 2:case 3:B+="#F1707B";break;case 4:B+="#92C353";break;case 5:B+="#FCE100";break;case 0:B+="#C8C6C4";break;default:B+="#C8C6C4"}this.domElement.style.border=B}this.domElement.classList.add("ReactBusinessBarEntry");O.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")||(this.domElement.tabIndex=0);this.businessBar.domElement.appendChild(this.domElement)}Lph(P){P||
(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var B=this.businessBar.$.fc;P=B+"ewaBusinessBarEntryBody"+this.i5c;const D=B+"ewaBusinessBarEntryTitle"+this.i5c;var I=B+"ewaBusinessBarEntryIcon"+this.i5c;this.domElement.className=v.a.fFh;A.DOMElementExtensions.PD(this.domElement);B=document.createElement("div");B.className=v.a.gFh;B.id=P;var S=document.createElement("div");S.className=v.a.eFh;var J=document.createElement("a");J.className=v.a.mFh;J.title=this.alt;
var L=document.createElement("span");L.classList.add(x.a.a9b);L.classList.add(v.a.iFh);L.id=I;this.vl.length&&(I=document.createElement("img"),I.classList.add(this.vl),I.src=t.a.dg(0),L.appendChild(I));J.appendChild(L);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.lFh);J.id=D;J.innerText=G.a.Mf(this.title);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.kFh);J.id="message";J.innerText=G.a.Mf(this.message);S.appendChild(J);J=document.createElement("a");
J.id="link";J.href="#";J.className=v.a.jFh;J.innerText=G.a.Mf(this.linkText);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.CYe);L=document.createElement("button");L.type="button";L.id="action";L.className=v.a.BYe;L.innerText=G.a.Mf(this.actionButton);J.appendChild(L);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.CYe);L=document.createElement("button");L.type="button";L.id="altAction";L.className=v.a.BYe;L.innerText=G.a.Mf(this.uJa);J.appendChild(L);
S.appendChild(J);B.appendChild(S);S=document.createElement("a");S.className=v.a.hFh;S.tabIndex=0;S.setAttribute("role","button");J=document.createElement("span");J.id="close";J.classList.add(x.a.VB);L=document.createElement("img");L.classList.add(x.a.Xgd);L.src=t.a.dg(13);L.alt=z.a.instance.ha(793);L.title=z.a.instance.ha(793);L.setAttribute("role","button");J.appendChild(L);S.appendChild(J);B.appendChild(S);this.domElement.appendChild(B);A.DOMElementExtensions.py(this.domElement,w.a.rja,D,P);this.sea=
$get("link",this.domElement);A.DOMElementExtensions.setVisible(this.sea,this.Eya);this.Eya&&(e.a.instance.ta(d.a.click,this.sea,this.Vuc),this.wyf=h.KeyInputManager.instance.Tu(this.sea,this.Vuc,n.a.Ai,n.a.NY));this.rQ=new r.a(A.DOMElementExtensions.getElementById(this.domElement,"action"));this.rQ.isVisible=this.Hs;this.J$=new r.a(A.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.J$.isVisible=this.GW;this.Hs&&(e.a.instance.ta(d.a.click,this.rQ.domElement,this.jId),this.yue=
h.KeyInputManager.instance.Tu(this.rQ.domElement,this.jId,n.a.Ai,n.a.NY),this.GW&&(e.a.instance.ta(d.a.click,this.J$.domElement,this.oId),this.kAe=h.KeyInputManager.instance.Tu(this.rQ.domElement,this.oId,n.a.Ai,n.a.NY)));this.jA=$get("close",this.domElement);this.c9b=this.Ze.He(this.jA);this.c9b.la("click",this.j2i);this.c9b.la("keydown",this.p2i);A.DOMElementExtensions.setVisible(this.jA,!this.hideCloseButton)}PPe(P){O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.Dqh():this.Lph(P)}Km(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.Du.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.Du.lMa}`);E.h(this.businessBar.$).Jp(!0)}vX(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.Du.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.Du.lMa}`);E.h(this.businessBar.$).Jp(!0)}Ooa(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.Du.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.Du.lMa}`);E.h(this.businessBar.$).Jp(!0)}ME(P){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.Du.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.Du.lMa}`);this.set_visible(!1);this.businessBar.removeEntry(this.q9g);y.g(P)}pL(){return O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.rQ.domElement}}Object(u.a)(M,"BusinessBarEntry",C.a,[])},792:function(u,C,a){a.r(C);var c=a(0),b=a(15),f=a(92),e=a(234),d=a(6),h=a(34),l=a(828),k=a(142),n=a(84),v=a(42),x=a(19),w=a(7),r=
a(176),t=a(1286),A=a(1270),y=a(185),z=a(569),E=a(357),G=a(58);const F=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"GetRichDataClassificationLabels",pc,$a,Nb,rb,ec,4)},O=(Ha,$a,Nb,rb,ec,pc,vb,ob,Tb=null)=>{Tb=Ha.Pa(1,Tb);Tb.selectedRanges=$a;Tb.domainId=Nb;Tb.autodetect=rb;return G.g(Ha,"ConvertToLinkedEntity",Tb,ec,pc,vb,ob,4)},M=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"OnAutoDetectUIShown",pc,$a,Nb,rb,ec,4)},P=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"GetLinkedEntityMetadata",
pc,$a,Nb,rb,ec,4)},B=(Ha,$a,Nb,rb,ec,pc,vb=null)=>{vb=Ha.Pa(1,vb);vb.selectedRanges=$a;return G.g(Ha,"ConvertLinkedEntityToText",vb,Nb,rb,ec,pc,4)},D=(Ha,$a,Nb,rb,ec,pc,vb=null)=>{vb=Ha.Pa(1,vb);vb.selectedRanges=$a;return G.g(Ha,"RefreshLinkedEntitiesInRange",vb,Nb,rb,ec,pc,4)},I=(Ha,$a,Nb,rb,ec,pc,vb,ob,Tb,Rd,Jd=null)=>{Jd=Ha.Pa(1,Jd);Jd.selectedRanges=$a;Jd.isChangeObject=Nb;Jd.isFloodgateEnabled=rb;Jd.isStarterData=ec;Jd.starterDataDomainId=pc;return G.g(Ha,"GetDataSelectorPaneData",Jd,vb,ob,
Tb,Rd,4)},S=(Ha,$a,Nb,rb,ec,pc,vb,ob=null)=>{ob=Ha.Pa(9,ob);ob.activeCell=$a;ob.selectionIndex=Nb;return G.g(Ha,"SelectLinkedEntityForDisambiguation",ob,rb,ec,pc,vb,4)},J=(Ha,$a,Nb,rb,ec,pc,vb,ob,Tb,Rd,Jd,ld=null)=>{ld=Ha.Pa(1,ld);ld.searchCell=$a;ld.searchQuery=Nb;ld.isFloodgateEnabled=rb;ld.isStarterData=ec;ld.starterDataDomainId=pc;ld.starterDataDomainIdString=vb;return G.g(Ha,"LinkedEntitySearch",ld,ob,Tb,Rd,Jd,4)},L=(Ha,$a,Nb,rb,ec,pc,vb,ob,Tb=null)=>{Tb=Ha.Pa(1,Tb);Tb.cell=$a;Tb.starterDataDomainId=
Nb;Tb.starterDataDomainIdString=rb;return G.g(Ha,"InsertStarterDataTable",Tb,ec,pc,vb,ob,4)},R=(Ha,$a,Nb,rb,ec,pc,vb,ob=null)=>{ob=Ha.Pa(1,ob);ob.activeCell=$a;ob.isBackward=Nb;return G.g(Ha,"MoveToNextAmbiguousLinkedEntity",ob,rb,ec,pc,vb,4)},Y=(Ha,$a,Nb,rb,ec,pc,vb=null)=>{vb=Ha.Pa(9,vb);vb.activeCell=$a;return G.g(Ha,"CancelSearchLinkedEntity",vb,Nb,rb,ec,pc,4)},Q=(Ha,$a,Nb,rb,ec,pc,vb,ob=null)=>{ob=Ha.Pa(1,ob);ob.selectedRanges=$a;ob.letyDomainId=Nb;return G.g(Ha,"GetDataTypeSelectorData",ob,
rb,ec,pc,vb,4)},W=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"GetErrorMessageForLinkedDataTypeRefresh",pc,$a,Nb,rb,ec,4)},Ga=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"GetHasUntrustedImageUrls",pc,$a,Nb,rb,ec,4)},pa=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"LinkedEntitiesEnableUntrustedImages",pc,$a,Nb,rb,ec,0)},aa=(Ha,$a,Nb,rb,ec,pc=null)=>{pc=Ha.Pa(1,pc);return G.g(Ha,"LinkedEntityTryAutoRefresh",pc,$a,Nb,rb,ec,0)};var Z=a(88),fa=a(732),ya=a(825);class Aa{}
Aa.jqi="EnrichmentContentFrame";Aa.width=320;Object(c.a)(Aa,"EnrichmentConstants",null,[]);class ja{constructor(Ha){this.messageType=0;this.messageType=Ha}}Object(c.a)(ja,"EnrichmentResponseMessage",null,[]);class za extends ja{constructor(Ha,$a){super(Ha);this.messageContent=null;this.messageContent=$a}}Object(c.a)(za,"EnrichmentResponseMessageWithContent",ja,[]);class ra extends za{constructor(Ha,$a,Nb){super(Ha,$a);this.telemetryJson=null;this.telemetryJson=Nb}}Object(c.a)(ra,"EnrichmentResponseMessageWithContentAndTelemetryData",
za,[]);var fb=a(273),Ua=a(14),Ca=a(102),Ia=a(50),oa=a(90),Da=a(113),bb=a(43),Za=a(82),Xa=a(31),Ba=a(111),Wa=a(723),Na=a(26);class ta{constructor(Ha,$a,Nb,rb,ec){this.Wr=this.Zk=this.the=this.rhe=this.mx=this.gw=null;this.Ay=!1;this.pj=Ha;this.Je=$a;this.AQ=Nb;this.Dc=rb;this.Na=ec;this.Nsa=Da.KeyInputManager.sm(oa.a.Ira,0)}get NRb(){return!0}get pyb(){return d.AFrameworkApplication.fa.Va("EnrichmentPaneUrl")}dispose(){this.NRb&&this.Wr&&(this.pj.Aa(Ua.a.click,this.Wr,Object(Z.a)(this,this.$l,"onClosePaneClick")),
this.Je.Aa(Ua.a.te,this.Wr,Object(Z.a)(this,this.xNf,"onKeyHide")));this.Wr=null;this.mx&&(this.Qbk(),this.mx.parentNode.removeChild(this.mx),this.mx=null);this.Dc.hj("EnrichmentPaneId").ml(this.Nsa)}show(Ha,$a,Nb){this.gw=Ha;this.Ay||(this.Zk=this.s4a(),this.Ppa.appendChild(this.Zk),this.Utj(),this.Na.xc(Na.a.AKe,Ba.a.frame,Object(Z.a)(this,this.yki,"handleEscapeKeyAction")),this.uVa(),this.Ay=!0);this.mx.src=this.pyb&&this.pyb.length?this.pyb+"?culture="+$a.market+"&appName="+$a.applicationName+
"&themeId="+$a.themeId+"&featuresBitMask="+$a.featuresBitMask:ta.KGf;this.rhe=$a;this.the=Nb;this.Xhb()}sJc(Ha,$a){Ha=new ra(2,Ha,$a);this.txc(Ha)}uVa(){const Ha=this.Dc.hj("EnrichmentPaneId");Ha.parent=fb.AFrame.tRa;this.pj.Irb("EnrichmentPaneId",this.Zk);Ha.bindAction(this.Nsa,Na.a.AKe)}kdg(){if(this.mx){Ca.FocusManager.qra(this.mx.contentWindow);const Ha=new ra(4,null,null);this.txc(Ha)}}$l(){this.e9b();return!0}xNf(Ha){Ha=Ha.Da.keyCode;return Ha===Sys.UI.Key.enter||Ha===Sys.UI.Key.space?(this.e9b(),
!0):!1}e9b(){this.hide();if(this.gw)this.gw.onPaneClosed()}s4a(){const Ha=fa.a("div","EnrichmentPaneId","EnrichmentPane");this.NRb&&Ha.appendChild(this.Sad());this.cui(Ha);return Ha}Sad(){const Ha=fa.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),$a=fa.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");$a.innerText=CommonUIStrings.l_EnrichmentPaneTitle;$a.title=CommonUIStrings.l_EnrichmentPaneTitle;const Nb=ya.a.Kb("CloseEnrichmentPane","EnrichmentPaneCloseButton",
CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.pj.ta(Ua.a.click,Nb,Object(Z.a)(this,this.$l,"onClosePaneClick"));this.Je.ta(Ua.a.te,Nb,Object(Z.a)(this,this.xNf,"onKeyHide"));Ha.appendChild($a);Ha.appendChild(Nb);this.Wr=Nb;return Ha}cui(Ha){this.mx=fa.b("iframe","","EnrichmentFrame");Ha.appendChild(this.mx);this.mx.id=Aa.jqi;this.mx.setAttribute("role","presentation")}Utj(){Ia.a.addHandler(this.mx,"load",Object(Z.a)(this,this.aNf,"onIFrameLoad"));Ia.a.addHandler(this.mx,"error",Object(Z.a)(this,
this.Kuc,"onIFrameError"));$addHandler(window,"message",Object(Z.a)(this,this.bNf,"onIFrameMessage"))}Qbk(){Ia.a.removeHandler(this.mx,"load",Object(Z.a)(this,this.aNf,"onIFrameLoad"));Ia.a.removeHandler(this.mx,"error",Object(Z.a)(this,this.Kuc,"onIFrameError"));$removeHandler(window,"message",Object(Z.a)(this,this.bNf,"onIFrameMessage"))}huh(){this.mx.src=ta.KGf}hide(){this.ykc();this.huh()}yki(Ha,$a,Nb){if(1!==Nb&&(this.hide(),this.gw))this.gw.onPaneClosed();return 32}aNf(){}Kuc(){}bNf(Ha){Ha=
Ha.rawEvent;if(!this.mx||-1!==this.mx.src.indexOf(Ha.origin)){try{var $a=bb.a(Ha.data)}catch(Nb){return}if(!Wa.c($a.messageType)){Ha=window.g_badCastCallback;window.g_badCastCallback=null;switch($a.messageType){case 2:this.txc(new ra(1,bb.c(this.rhe),this.the));break;case 1:this.txc(new za(0,this.m_h()));break;case 3:this.gw&&this.gw.selectEntity($a.messageContent);break;case 5:this.gw&&this.gw.jJb($a.messageContent);break;case 8:this.gw&&($a=bb.a($a.messageContent),0<$a.DomainId?this.gw.dWd($a.Query,
$a.TelemetryJson,$a.DomainId,$a.DomainIdString):this.gw.searchEntity($a.Query,$a.TelemetryJson));break;case 6:this.gw&&this.gw.cancelSearch();break;case 11:$a=bb.a($a.messageContent);$a=ta.Y$b("keydown","f6",oa.a.jWb,!0,!1,$a,!0,!1);this.mx&&this.mx.dispatchEvent($a);break;case 12:if(bb.a($a.messageContent).keyCode===oa.a.zH&&($a=ta.Y$b("keydown","esc",oa.a.zH,!0,!1,!1,!1,!1),this.mx&&(this.mx.dispatchEvent($a),this.hide(),this.gw)))this.gw.onPaneClosed();break;case 13:this.gw&&this.gw.selectDataType($a.messageContent);
break;case 14:this.gw&&this.gw.showHelpArticle($a.messageContent);break;case 15:this.gw&&this.gw.showSurveyDialog($a.messageContent);break;case 16:this.gw&&($a=bb.a($a.messageContent),this.gw.insertTable($a.DomainId,$a.DomainIdString))}window.g_badCastCallback=Ha}}}m_h(){return bb.c([2,1,3,5,8,6])}txc(Ha){Ha=bb.c(Ha);this.mx.contentWindow.postMessage(Ha,Za.a.wL(this.pyb))}static Y$b(Ha,$a,Nb,rb,ec,pc,vb,ob){Xa.a.Px?(pc=String.format("{0} {1} {2}",pc?"Shift":"",vb?"Control":"",ob?"Alt":""),pc.trim(),
Nb=document.createEvent("KeyboardEvent"),Nb.initKeyboardEvent(Ha,rb,ec,window.self,$a,0,pc,!1,"en-US")):($a={},$a.keyCode=Nb,$a.ctrlKey=vb,$a.shiftKey=pc,$a.altKey=ob,$a.bubbles=rb,$a.cancelable=ec,Nb=new KeyboardEvent(Ha,$a));return Nb}}ta.KGf="about:blank";Object(c.a)(ta,"EnrichmentPane",null,[552,2]);class V extends ta{constructor(Ha){super(d.AFrameworkApplication.sa.Pz,d.AFrameworkApplication.sa.Xu,d.AFrameworkApplication.sa.Nga,d.AFrameworkApplication.sa.vf,d.AFrameworkApplication.Qb);this.taskPane=
Ha;this.taskPane.VXg(this.kdg)}get Ppa(){return this.taskPane.Lc}Xhb(){this.taskPane.isVisible||this.taskPane.Dh(!0)}ykc(){this.taskPane.Dh(!1)}dispose(){this.taskPane&&(this.taskPane.Qyj(this.kdg),this.taskPane=null);super.dispose()}}Object(c.a)(V,"EnrichmentTaskPaneWrapper",ta,[]);class ia{constructor(Ha){this.Zz=null;this.Gha=Ha}XLi(Ha,$a){this.Zz=Ha;this.Gha&&this.Gha.show(this,$a,null)}sJc(Ha,$a){this.Gha&&this.Gha.sJc(Ha,$a)}$Cb(){this.Gha&&this.Gha.hide()}dispose(){this.Gha&&(this.Gha.dispose(),
this.Gha=null)}selectEntity(Ha){return this.Zz?this.Zz.selectEntity(Ha):!1}searchEntity(Ha,$a){this.Zz&&this.Zz.searchEntity(Ha,$a)}dWd(Ha,$a,Nb,rb){this.Zz&&this.Zz.dWd(Ha,$a,Nb,rb)}jJb(Ha){return this.Zz?this.Zz.jJb(Ha):!1}onPaneClosed(){if(this.Zz)this.Zz.onPaneClosed()}cancelSearch(){this.Zz&&this.Zz.cancelSearch()}selectDataType(Ha){this.Zz&&this.Zz.selectDataType(Ha)}showHelpArticle(Ha){this.Zz&&this.Zz.showHelpArticle(Ha)}showSurveyDialog(Ha){this.Zz&&this.Zz.showSurveyDialog(Ha)}insertTable(Ha,
$a){this.Zz&&this.Zz.insertTable(Ha,$a)}}Object(c.a)(ia,"EnrichmentManager",null,[551,2]);class X extends ia{constructor(Ha){super(Ha)}dispose(){super.dispose()}}Object(c.a)(X,"ExcelEnrichmentManager",ia,[]);var la=a(16);class sa{constructor(Ha){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Ha;this.commentQuestion=
la.a.instance.Lb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=la.a.instance.Lb(195);this.ratingValuesAscending=[la.a.instance.Lb(196),la.a.instance.Lb(197),la.a.instance.Lb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=la.a.instance.Lb(194)}}Object(c.a)(sa,"FloodgateSurvey",null,[]);var Va=a(25),nb=a(79),ha=a(429),jb=a(47),Fb=a(382),Rb=a(200),mb=a(30),sb=a(91),Ya=a(33),Ma=a(246),xb=a(20);class qb{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(qb,"EnrichmentMessageContentAppProperties",null,[]);class Ra{constructor(Ha,$a,Nb,rb,ec){this.zwa=this.VTe=!1;this.Ogb=this.Sda=!0;this.LLb=this.WRb=!1;this.hib=null;this.Dwc=0;this.Zx=()=>{(this.Ogb||this.zwa)&&2!==this.Dwc&&(this.LLb||this.PBd(!1))};this.zd=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.X2i=pc=>{Ya.a.Zf(pc.Errors)?(pc=Ya.a.Ic(pc.Errors),pc.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${pc}`)):pc.Result&&(this.$.ea.Kk(this.zd),this.$.ea.pk(this.zd),pc=pc.Result,this.hib=pc.SkydanceFeatureBitmask,this.eGd(pc),this.WRb=!0)};this.Xe=()=>{(this.Ogb||this.zwa)&&this.PBd(!1)};this.Cuc=(pc,vb)=>{Ya.a.Zf(pc.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Ya.a.Ic(pc.Errors)}`):pc.Result&&(pc=pc.Result,pc.DisambiguationJson?(this.WRb=!1,this.geg(vb),this.hib=pc.SkydanceFeatureBitmask,vb=pc.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.LLb=!1,this.ayf(vb)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.I5i=(pc,vb)=>{Ya.a.Zf(pc.Errors)?(vb=Ya.a.Ic(pc.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${vb}`)):pc.Result&&(pc=pc.Result,pc.DisambiguationJson?(this.geg(vb),this.hib=pc.SkydanceFeatureBitmask,vb=pc.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.LLb=!0,this.ayf(vb)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.j9i=pc=>{Ya.a.Zf(pc.Errors)?(pc=Ya.a.Ic(pc.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${pc}`),this.Ogb=!0):pc.Result&&(pc=pc.Result,this.hib=pc.SkydanceFeatureBitmask,this.eGd(pc),this.WRb=!0)};this.jbj=pc=>{if(Ya.a.Zf(pc.Errors)){const vb=Ya.a.Ic(pc.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${vb}`)}pc.Result?
(this.eGd(pc.Result),this.WRb=!0):this.Hva()};this.OQf=pc=>{Ya.a.Zf(pc.Errors)?(pc=Ya.a.Ic(pc.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${pc}`)):pc.Result?this.qdc.sJc(pc.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Hva())};this.Q7i=pc=>{Ya.a.Zf(pc.Errors)?(pc=Ya.a.Ic(pc.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${pc}`)):this.Hva()};this.$=Ha;this.gridView=xb.h(this.$);this.gridView.ga.sx(this.Xe);this.gridView.jt(this.Zx);this.TXe=rb;this.convertToLinkedEntityManager=ec;mb.a.Sd()||Nb.kS($a);Ha=new V($a);this.qdc=new X(Ha);n.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(pc=>{pc.isFeatureEnabled("mso_sendASmile",!0).then(vb=>{this.Sda=vb;return null})})}dispose(){this.$&&(this.gridView.ga.Ww(this.Xe),this.gridView.Rv(this.Zx))}selectEntity(Ha){const $a=
jb.o(this.gridView.ga.pa.activeCell,this.$),Nb=()=>new ha.a;Fb.a(this.$.userOperationManager,(rb,ec,pc)=>S(this.$.qa.va,$a,Ha,Ma.b(rb,this.jbj),ec,pc,null),rb=>new Rb.a(109,0,rb,void 0,Nb),null);return!0}searchEntity(Ha,$a,Nb=!1,rb=0,ec=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${$a}`);const pc=jb.o(this.gridView.ga.pa.activeCell,this.$);Fb.a(this.$.userOperationManager,(vb,ob,Tb)=>J(this.$.qa.va,pc,Ha,this.Sda,Nb,rb,
ec,Ma.b(vb,this.OQf),ob,Tb,null),vb=>new Rb.a(110,0,vb,16),null)}jJb(Ha){const $a=jb.o(this.gridView.ga.pa.activeCell,this.$);this.Ogb=!1;Fb.a(this.$.userOperationManager,(Nb,rb,ec)=>R(this.$.qa.va,$a,Ha,Ma.b(Nb,this.j9i),rb,ec,null),Nb=>new Rb.a(111,0,Nb,16),null);return!0}onPaneClosed(){this.zwa=!1;this.VTe=!0;this.Dwc=0;this.LLb=!1}cancelSearch(){const Ha=this.wWd();Ha&&Fb.a(this.$.userOperationManager,($a,Nb,rb)=>Y(this.$.qa.va,Ha,Ma.b($a,this.OQf),Nb,rb,null),$a=>new Rb.a(112,0,$a,16),null)}selectDataType(Ha){b.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Hva();if(Ha&&Ha.length)if(Ha=JSON.parse(Ha))if(null==Ha.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var $a={};$a.Id=Ha.domainId;$a.StringId=Ha.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity($a)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(Ha){const $a=new sb.a(-859308420,nb.a.Vb,this.$.Kc,9,null);this.$.Ia.$b($a,{[nb.a.Bg]:"HelpID="+Ha,["InputMethod"]:nb.a.Vb,["ShouldCanvasTakeFocus"]:!0,[nb.a.rd]:w.a.fS})}showSurveyDialog(Ha){A.a.cib(new sa(Ha))}insertTable(Ha,$a){const Nb=this.wWd();Nb&&Fb.a(this.$.userOperationManager,(rb,ec,pc)=>L(this.$.qa.va,Nb,Ha,$a,Ma.b(rb,this.Q7i),ec,pc,null),rb=>new Rb.a(259,0,rb,1),null)}PBd(Ha){this.launchOrCloseDisambiguationPane(Ha)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Ha=this.UIj();Ha&&Fb.a(this.$.userOperationManager,($a,Nb,rb)=>I(this.$.qa.va,Ha,!0,this.Sda,!1,null,Ma.b($a,this.I5i),Nb,rb,1),$a=>new Rb.a(114,0,$a,16),null)}launchLinkedEntityDataTypeSelectorPane(Ha,$a){Fb.a(this.$.userOperationManager,(Nb,rb,ec)=>Q(this.$.qa.va,Ha,$a,Ma.b(Nb,this.Cuc),rb,ec,2),Nb=>new Rb.a(233,0,Nb,16),null)}RLi(Ha,$a){Ha&&Fb.a(this.$.userOperationManager,
(Nb,rb,ec)=>I(this.$.qa.va,Ha,!1,!1,!0,$a,Ma.b(Nb,this.Cuc),rb,ec,2),Nb=>new Rb.a(257,0,Nb,16),null)}geg(Ha){Ha&&(this.Dwc=Ha)}ayf(Ha){var $a=new sb.a(-90814711,nb.a.Vb,0,10,null);this.$.Ia.$b($a,null);this.zwa?this.qdc.sJc(Ha,null):($a=3,null!=this.hib?$a=this.hib:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Ha=this.Z4h(Ha,$a))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.TXe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),
this.qdc.XLi(this.TXe,Ha),this.zwa=!0)}Hva(){this.zwa&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.qdc.$Cb(),this.zwa=!1,this.Dwc=0,this.LLb=!1)}eGd(Ha){var $a=Ha.Row+1;Ha=Ha.Column+1;0>$a||0>Ha?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Hva(),this.$.ea.Kk(this.zd)):($a=new Va.Range($a,Ha,$a,Ha,!0,!1),this.gridView.ga.updateSelection($a,
$a,60),this.Ogb=!0)}Z4h(Ha,$a){const Nb=new qb;Nb.applicationVersion=d.AFrameworkApplication.buildVersion;Nb.applicationName="ExcelWac";Nb.anid="00000000-0000-0000-0000-000000000000";Nb.sessionId=d.AFrameworkApplication.userSessionId;Nb.appCorrelationId=y.a.create().toString();var rb=z.a.sL(d.AFrameworkApplication.lcid);rb=rb?rb.name:null;Nb.uiLanguage=rb;Nb.market=this.bhc(rb);Nb.themeId=0;Nb.disambiguationJson=Ha;$a<=E.a.i3?Nb.featuresBitMask=$a:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");
return Nb}bhc(Ha){Ha=Ha.split("-");return Ha[Ha.length-1]}launchOrCloseDisambiguationPane(Ha){const $a=this.gridView.ga.pa.activeCell;if(this.wWd()&&$a)if(this.gridView.Mb.iEb($a)){if((!this.VTe||Ha||this.WRb)&&!this.gridView.Eb){Ha&&(this.Ogb=!0);var Nb=jb.q($a,this.$);Fb.a(this.$.userOperationManager,(rb,ec,pc)=>I(this.$.qa.va,Nb,!1,this.Sda,!1,null,Ma.b(rb,this.Cuc),ec,pc,1),rb=>new Rb.a(114,0,rb,16),null)}}else this.Hva();else this.Hva()}Hsj(){if(this.zwa){var Ha=this.gridView.ga.pa.activeCell;
if(Ha){var $a=jb.q(Ha,this.$);Fb.a(this.$.userOperationManager,(Nb,rb,ec)=>I(this.$.qa.va,$a,!1,this.Sda,!1,null,Ma.b(Nb,this.Cuc),rb,ec,1),Nb=>new Rb.a(114,0,Nb,16),null)}else this.Hva()}}wWd(){const Ha=this.gridView.ga.pa;return Ha.aea()?jb.o(Ha.activeCell,this.$):null}UIj(){const Ha=this.gridView.ga.pa;return Ha.aea()?jb.q(Ha.activeCell,this.$):null}}Object(c.a)(Ra,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Jb=a(2),yb=a(385),Gb=a(1358),ub=a(54),Ja=a(737);class zb{constructor(Ha,$a,
Nb){this.Ayf=2;this.zyf="Size64by48";this.$=Ha;this.Ya=$a;this.convertToLinkedEntityManager=Nb}eYh(Ha,$a){var {ConvertToLinkedEntityManager:Nb}=a(792);this.vek();$a=this.Ya.ur($a).RF();let rb=0,ec=0,pc=!1;for(var vb of Ha.Categories){const ob=this.LYh(vb,rb);ob&&(ec===Nb.lbb&&(pc=!0),$a.MenuSectionList.push(ob),++rb);++ec}pc&&rb<=Nb.Byf&&$a.MenuSectionList.splice(Nb.lbb,1);Nb=this.Ya.jd().h7b();vb=ub.a.dg(11);for(const ob of Ha.LongButtons)this.convertToLinkedEntityManager.QVj(ob)&&this.vUg(Nb,ob,
vb);0<Nb.ControlList.length&&$a.MenuSectionList.push(Nb);return $a}vUg(Ha,$a,Nb){if($a){var rb="Data.ConvertToLinkedEntityMenuItem_"+$a.Name,ec=this.convertToLinkedEntityManager.QV($a.DomainId);ec&&($a=Object(Jb.a)(new yb.a,{Id:rb,ExternalId:rb,Command:"-1662108744",LabelText:$a.Name,Alt:$a.SuperTip,Visible:!0,MenuItemId:a(792).ConvertToLinkedEntityManager.w5a($a.DomainId),Image16by16:Nb,Image16by16Class:this.Pqi(ec.FontLocator)}),Ha.ControlList.push($a))}}GYh(Ha,$a){return Object(Jb.a)(new Gb.a,
{Id:a(792).ConvertToLinkedEntityManager.LVe+Ha.toString(),ExternalId:a(792).ConvertToLinkedEntityManager.LVe+Ha.toString(),MenuItemId:a(792).ConvertToLinkedEntityManager.Hed+Ha.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.ilf($a.FontLocator),LabelText:$a.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.gmd($a)})}Z3g(Ha){switch(Ha){case "Animal":return Ja.a.k0g;case "Apple":return Ja.a.s1g;case "Atom":return Ja.a.S2g;
case "Beaker":return Ja.a.P4g;case "Bridge":return Ja.a.p6g;case "Cat":return Ja.a.xbh;case "City":return Ja.a.Pdh;case "Constellation":return Ja.a.Pih;case "Dog":return Ja.a.Vzh;case "Finance":return Ja.a.H4g;case "GradCap":return Ja.a.aji;case "HumanAnatomy":return Ja.a.gqi;case "LocationPointer":return Ja.a.COi;case "Map":return Ja.a.Nej;case "MedicineNeedle":return Ja.a.kVi;case "Mountain":return Ja.a.CWi;case "Movie":return Ja.a.VWi;case "Music":return Ja.a.gXi;case "OuterSpace":return Ja.a.rfj;
case "Planet":return Ja.a.Eij;case "Satellite":return Ja.a.iGj;case "WolframGeneric":return Ja.a.aFj;default:return Ja.a.Ckh}}Pqi(Ha){if("PowerBIRibbon"!==Ha)return x.a.Wgd;switch(Ha){case "AnimalRibbon":return x.a.xLh;case "AppleRibbon":return x.a.yLh;case "AtomRibbon":return x.a.zLh;case "BeakerRibbon":return x.a.ALh;case "BridgeRibbon":return x.a.BLh;case "CenterMapRibbon":return x.a.CLh;case "CityRibbon":return x.a.DLh;case "CurrencyRibbon":return x.a.ELh;case "ExerciseRibbon":return x.a.FLh;
case "FinanceRibbon":return x.a.J0e;case "FirstAidRibbon":return x.a.GLh;case "GlobeLightningRibbon":return x.a.HLh;case "GradCapRibbon":return x.a.ILh;case "HumanAnatomyRibbon":return x.a.JLh;case "LeafRibbon":return x.a.KLh;case "LocationPointerRibbon":return x.a.MLh;case "MapRibbon":return x.a.H0e;case "MountainRibbon":return x.a.NLh;case "MovieRibbon":return x.a.OLh;case "MusicRibbon":return x.a.PLh;case "NotablePeopleRibbon":return x.a.QLh;case "OuterSpaceRibbon":return x.a.RLh;case "PartlySunnyWeatherRibbon":return x.a.SLh;
case "PowerBIRibbon":return x.a.I0e;case "SatelliteRibbon":return x.a.TLh;case "WolframGenericRibbon":return x.a.LLh;case "YogaRibbon":return x.a.VLh;default:return x.a.G0e}}ilf(Ha){switch(Ha){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";
case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";
case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";
case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}LYh(Ha,$a){$a=this.Ya.$D("ConvertToLinkedEntitySection_"+$a,this.Ayf,this.zyf);var Nb=!1;for(var rb of Ha.DomainIds){const ec=this.convertToLinkedEntityManager.QV(rb);if(!ec||ec.DomainBlocked||!ec.ShowInRibbon)continue;Nb=ec.Name;const pc=a(792).ConvertToLinkedEntityManager.w5a(rb);$a.mu("Data.ConvertToLinkedEntityMenuItem_"+pc,-1203788282,"QueryLinkedEntityGalleryIcon",
void 0,pc,this.ilf(ec.FontLocator),void 0,void 0,this.gmd(ec),Nb);Nb=!0}if(!Nb)return null;rb=$a.g7b(!0);$a=this.Ya.jd();$a.title=Ha.Name;Ha=$a.h7b();Ha.ControlList.push(rb);return Ha}vek(){this.Ayf=5;this.zyf="Size112by64"}gmd(Ha){return Ha.RibbonTooltipHeader?Ha.RibbonTooltipHeader+"\n\n"+Ha.RibbonTooltip:Ha.RibbonTooltip}}Object(c.a)(zb,"ConvertToLinkedEntityMenuRenderer",null,[530]);var na=a(61),Ea=a(323),ma=a(120),Ka=a(1),cb=a(128),Fa=a(69);class wa{constructor(Ha,$a){this.Mrd=this.Ord=!1;this.P$i=
Nb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Ord=!0;if(Ya.a.Zf(Nb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Ya.a.Ic(Nb.Errors)}`);else{var rb=0,ec=[],pc=!1;try{if(!Nb.Result)return;const vb=Nb.Result;if(!vb){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}ec=this.Mgj(vb);if(!ec||!ec.length)return;rb=ec.length;this.zVi(ec);this.aDa.o7f();b.ULS.sendTraceTag(537166677,
0,50,`OnReadRoamingStringSuccess MruCount:${this.aDa.kfb.length}`);if(Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const ob of this.aDa.kfb)if(1===(ob.Id&1048320)>>8){pc=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${pc}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${rb} data types.`),Nb=[],Nb.push(Object(Jb.a)(new Fa.a,{name:"MruCount",int64:rb})),Nb.push(Object(Jb.a)(new Fa.a,
{name:"MruWolframAvailable",bool:pc})),cb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Nb)}this.Mrd&&(this.Gxg(this.aDa.kfb),this.Mrd=!1)}};this.hej=Nb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Ya.a.Zf(Nb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Ya.a.Ic(Nb.Errors)}`):Nb.Result&&(Nb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.sQf=
(Nb,rb,ec)=>{Nb=ma.a.lf(Nb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${ec}. Errors: ${Ya.a.Ic(Nb)}.`)};this.$=Ha;this.aDa=$a}pci(){!this.Ord&&this.$.ea.Ec&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Ea.w(this.$.qa.va,0,this.P$i,this.sQf,null,null))}Gxg(Ha){Ha&&Ha.length?this.Ord?(Ha=this.GKj(Ha))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
Ea.C(this.$.qa.va,0,Ha,this.hej,this.sQf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Mrd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}GKj(Ha){if(!Ha||!Ha.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var $a=[];for(const Nb of Ha)Ha=
{},Ha.Id=Nb.Id,Nb.StringId&&(Ha.StringId=Nb.StringId),$a.push(Ha);$a="<DataTypes>"+na.a.Zc($a)+"</DataTypes>";return 1906<$a.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):$a}Mgj(Ha){if(!Ha)return b.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Ha.startsWith("<DataTypes>")||!Ha.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,
0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Ha=Ha.substring(11,Ha.length-12);if(!Ha)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let $a=[];try{$a=na.a.Xi(Ha)}catch(Nb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Nb.message}`),null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${$a.length} data types.`);
return $a}zVi(Ha){const $a=this.aDa.kfb,Nb=this.aDa.Erj;if($a.length!==Nb){for(let rb=0;rb<Ha.length&&$a.length<Nb;++rb){const ec=Ha[rb];this.aDa.QV(ec)&&!$a.includes(ec)&&$a.push(ec)}this.aDa.kfb=$a}}}Object(c.a)(wa,"LinkedDataTypeRoamingHandler",null,[]);var ka=a(63),Oa=a(52),hb=a(152),Pa=a(40),ca=a(51),ba=a(32),ib=a(230),Lb=a(23),gc=a(106),Gc=a(71),Kb=a(100),pb=a(149),nc=a(36);a.d(C,"ConvertToLinkedEntityManager",function(){return Wb});class Wb extends v.a{constructor(Ha,$a,Nb,rb,ec,pc,vb){super();
this.Iuf=this.zzd=this.vAd=this.lyd=this.kyd=this.K$a=this.ovd=null;this.OJb=this.prd=0;this.Xna=null;this.zvd=!1;this.pkd=this.Io=this.eVd=null;this.Gt=0;this.c_=null;this.wOa=8;this.Z6c=this.yyf=this.Dqf=this.zdb=!1;this.WBa=this.d7e=this.K3e=null;this.g5c=0;this.i4g=5;this.y6b=3E4;this.Dpg=!1;this.Dba=null;this.Lwa=Array(5);this.msg=this.s6d=!1;this.M8f=this.oCd=0;this.oc=this.rle=null;this.ojg=!0;this.zd=(ob,Tb)=>{Tb.Ec&&!Tb.mGb&&this.showUntrustedImageBusinessBarIfNecessary()};this.I6i=ob=>{if(ob.Result){var Tb=
ob.Result;if(Tb&&Tb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Tb.length} labels`);var Rd=Oa.GetServiceTaskFactory.Za(this.$.da,274,275,0);Pa.TaskExtensions.za(Rd,()=>{Rd.result.U4c(Tb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.fg=()=>{this.A$j();this.mli(this.$.ea.Pn.LinkedEntityAsyncRefreshStateId);
this.W$a?this.pmi(this.$.ea.Pn.RichDataClassificationLabelStateId):this.Z9a&&this.F5d(!0)};this.e4i=()=>{this.s6d=!0;this.Io&&this.Io.Hsj()};this.a6i=ob=>{if(ob&&!ib.a(ob))try{ob.Result.HasUntrustedImageUrl&&(this.businessBar.zh(59,null),this.msg=!0)}catch(Tb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Tb}.`)}};this.Yxf=()=>{if(!this.yyf&&this.DEb()&&!this.nwd())if(cb.a("DataTabActive"),
ka.a.eh.tS)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var ob=this.L$b();if(ob){var Tb={};Tb.InputMethod=nb.a.Vb;Tb.CalloutName=8;Tb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.$b(ob,Tb);this.yyf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else b.ULS.sendTraceTag(537166882,
0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.Y2i=ob=>{Ya.a.Zf(ob.Errors)||(this.W$a||this.F5d(!1),this.raiseEvent("LinkedEntityConverted"))};this.mcj=()=>{this.$.da.Gb(211,ob=>{ob.readText(la.a.instance.ha(1813))})};this.Td=(ob,Tb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Tb.cX?b.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):
(this.$.isEditMode?this.$Ie():this.LCj(),this.s6d&&this.VWe())};this.j6i=ob=>{this.O8b();if(ob.Result){var Tb=ob.Result;ob=Tb.DomainDataArray;if(this.Xna=Tb.Ribbon){var Rd={};Rd.Name=la.a.instance.ha(1803);Rd.DomainIds=this.ML;this.Xna.Categories.splice(Wb.lbb,0,Rd)}0<Tb.MaximumCellsToConvert&&(this.rle=Tb.MaximumCellsToConvert);this.Gt=2;Tb=!1;if(ob){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${ob.length} domains`);this.TQa||(this.TQa=[]);Rd=la.a.instance.ha(1800);
const Jd=la.a.instance.ha(1802);for(const ld of ob)ld.DomainId?(this.TQa.push(ld),ld.DomainBlocked?(ob=!!ld.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${ob?ld.DomainId.Id.toString():ld.Name} is telemetry only, do not show in menu (Has String ID: ${ob})`)):(this.OV.ia(Wb.w5a(ld.DomainId),ld),ld.Name===Rd||268435456===ld.DomainId.Id?this.K3e=ld.DomainId.Id.toString():ld.Name===Jd||536870912===ld.DomainId.Id?this.d7e=ld.DomainId.Id.toString():268435712===ld.DomainId.Id&&ld.ShowInRibbon&&
(this.Z6c=!0),Tb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Tb||(this.TQa=null);this.Zsg();this.eVd.pci();this.Dpg||(this.v$j(),this.Dpg=!0)}else this.TQa=null,this.Gt=3,-1<this.wOa&&window.setTimeout(()=>{this.EMb()},100*(8-this.wOa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.HQd();this.oPe();this.Z6c&&this.$rf&&hb.c(this.Yxf,this.$.ka,500);this.Z9a&&!this.W$a&&this.F5d(!0)};this.i6i=
ob=>{ob=ma.a.lf(ob.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Ya.a.Ic(ob)}].`);this.TQa=null;this.Gt=3;this.zdb=!0;this.HQd()};this.onContentReady=()=>{this.Uqg()&&this.gridView.Rv(this.onContentReady);this.ojg&&this.$.workbookContext.Options&1048576&&(this.businessBar.EZj(),this.ojg=!1)};this.Cj=()=>{this.O8b()};this.I8i=ob=>{if(ib.a(ob)){const Tb=Object(Gc.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Kb.d)(pb.a.resolve(nc.h,{Wa:0})):
Oa.GetServiceTaskFactory.Za(this.$.da,5,4,0);Pa.TaskExtensions.za(Tb,()=>{let Jd=null;if(null===ob||void 0===ob?0:ob.Errors)Jd=ob.Errors[0];Tb.result.Uig(Jd,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ya.a.Ic(ob.Errors)}].`);const Rd=Ya.a.bB(ob.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.To(Rd)}};
this.S6c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.y6b} millisecond interval`);this.Pnf("Periodic auto-refresh check",this.l1i,this.k1i)};this.l1i=ob=>{ib.a(ob)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ya.a.Ic(ob.Errors)}].`),++this.g5c):this.g5c=0;f.a.Ka(this.WBa);this.g5c>=this.i4g?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.WBa=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.WBa=ca.a.instance.create(this.S6c,this.y6b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.k1i=ob=>{ob=ma.a.lf(ob.data);e.a.sh(ob)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Ya.a.Ic(ob)}].`);f.a.Ka(this.WBa);this.WBa=ca.a.instance.create(this.S6c,this.y6b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.J9i=ob=>{ob=!!ob.Result&&ob.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${ob.toString()}`);ob?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${ba.a.Bb.Ye.m-
this.prd} ms, retry count = ${this.OJb}`),this.EMb()):this.$Fc()};this.I9i=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.$Fc()};this.M5i=ob=>{ob.Result?(ob=ob.Result)?(this.QRd(),this.businessBar.Uig(null,ob)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Ha;this.businessBar=pc;this.svgIconProvider=
Nb;this.oc=vb;this.TQa=[];this.ML=[];this.gridView=xb.h(this.$);this.Rjc=-1;this.SDi=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.Z9a=Ka.EwaSettings.ya(387);this.W$a=Ka.EwaSettings.ya(586);this.$rf=Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.OV=new gc.a;this.Tbb=new zb(Ha,$a,this);rb&&(this.Io=new Ra(Ha,rb,ec,this,this));this.$.Ql(this.Td);r.a(this.$)&&r.a(this.$).iMj(this);
this.$Ie();(this.Z9a||this.W$a)&&this.$.ea.nv(this.fg);Ka.EwaSettings.ya(123)&&Ka.EwaSettings.ya(131)&&(this.Uqg()||this.gridView.jt(this.onContentReady));this.$.dA(this.Cj);this.$.ea.pk(this.zd);this.showUntrustedImageBusinessBarIfNecessary();this.eVd=new wa(this.$,this)}dispose(){(this.Z9a||this.W$a)&&this.$.ea.Xw(this.fg);this.$.ea.Kk(this.zd);!this.Dba&&Ka.EwaSettings.ya(123)&&Ka.EwaSettings.ya(131)&&this.gridView.Rv(this.onContentReady);this.Io&&this.Io.dispose();this.$.UC(this.Cj);this.$.Rm(this.Td);
this.Z9a&&(this.ovd=null);f.a.Ka(this.WBa)}AXg(Ha){this.addHandler("LinkedEntityConverted",Ha)}Ayj(Ha){this.removeHandler("LinkedEntityConverted",Ha)}get Erj(){return 5}get kfb(){return this.ML}set kfb(Ha){this.ML=Ha}selectEntity(Ha){return this.Io?this.Io.selectEntity(Ha):!1}searchEntity(Ha,$a){this.Io&&this.Io.searchEntity(Ha,$a)}dWd(Ha,$a,Nb,rb){this.Io&&this.Io.searchEntity(Ha,$a,!0,Nb,rb)}jJb(Ha){return this.Io?this.Io.jJb(Ha):!1}onPaneClosed(){if(this.Io)this.Io.onPaneClosed()}cancelSearch(){this.Io&&
this.Io.cancelSearch()}selectDataType(Ha){this.Io&&this.Io.selectDataType(Ha)}showHelpArticle(Ha){this.Io&&this.Io.showHelpArticle(Ha)}showSurveyDialog(Ha){this.Io&&this.Io.showSurveyDialog(Ha)}insertTable(Ha,$a){this.Io&&this.Io.insertTable(Ha,$a)}pmi(Ha){this.$.isEditMode&&this.M8f!==Ha&&d.AFrameworkApplication.fa.ra("SupportsPolicies")&&(this.M8f=Ha,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),F(this.$.qa.va,this.I6i,
null,null,null))}VWe(){this.$.userOperationManager.kd(new Rb.a(589,0,(Ha,$a,Nb)=>pa(this.$.qa.va,Ma.b(Ha,this.e4i),$a,Nb,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.s6d||this.msg||!this.$.ea.Ec||this.IJj()}IJj(){this.$.userOperationManager.kd(new Rb.a(588,0,(Ha,$a,Nb)=>Ga(this.$.qa.va,Ma.b(Ha,this.a6i),$a,Nb,null),80),null)}F5d(Ha){if(this.Z9a&&null==this.ovd&&!this.W$a&&d.AFrameworkApplication.fa.ra("SupportsPolicies")&&null!=this.K$a&&this.K$a&&(!Ha||this.$.workbookContext.Options&
262144)){var $a=Oa.GetServiceTaskFactory.Za(this.$.da,274,275,0);Pa.TaskExtensions.za($a,()=>{this.ovd=$a.result.Y1f(2)},this.$.ka,3)}}get LIb(){return this.Lwa.length}get hVi(){return this.rle}Dkh(Ha){(Ha=this.Zzh(Ha))?this.convertToLinkedEntity(Ha):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Ha){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Ha.Id}].`);if(this.gridView){var $a=
this.gridView.ga.pa.Hd,Nb=$a.Ue(this.gridView.QR);this.zvd&&this.gVg(Ha);if(Nb){Nb=this.gridView.Mb.Mza(Nb);if(!this.Hif(Ha)&&this.dtf(Ha.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(ka.a.eh.tS){$a=this.yld();if(!$a){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Nb=this.L$b();if(!Nb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");
return}var rb={["InputMethod"]:nb.a.Vb,CalloutName:3};rb.Target=$a;rb.RibbonButtonLabel=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.z8f(Ha):this.dHb(Ha.Id.toString());rb.ExampleEntities=this.F1e(Ha);this.$.Ia.$b(Nb,rb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.dtf(Ha.Id)&&!Ha.StringId)this.launchLinkedEntityDataTypeSelectorPane(Wb.w5a(Ha));
else{if(Nb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.N3j(Ha)){$a=jb.r(this.gridView.ga.pa.selectedRanges,this.$);this.Io.RLi($a,Ha);return}if(ka.a.eh.tS){$a=this.yld();if(!$a){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Nb=this.L$b();if(!Nb){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}rb={["InputMethod"]:nb.a.Vb,CalloutName:2};rb.Target=$a;rb.RibbonButtonLabel=this.z8f(Ha);rb.ExampleEntities=this.F1e(Ha);rb.BlankCellResourceId=this.n5g(Ha);rb.HasBlankCellWalkthrough=this.jni(Ha);rb.ServiceDomain=Ha.Id;this.$.Ia.$b(Nb,rb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.P$c(Ha,!1,$a)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Dba&&this.Dba.ZKa()}onAutoDetectUIShown(){Fb.a(this.$.userOperationManager,(Ha,$a,Nb)=>M(this.$.qa.va,Ha,$a,Nb,null),Ha=>new Rb.a(230,0,Ha,80),null)}P$c(Ha,$a,Nb){const rb=jb.q(Nb,this.$),ec=()=>new ha.a;Fb.a(this.$.userOperationManager,(pc,vb,ob)=>O(this.$.qa.va,rb,Ha,$a,Ma.b(pc,this.Y2i,this.mcj,this.Io.X2i),vb,ob,null),pc=>new Rb.a(115,0,pc,void 0,ec),null)}gVg(Ha){if(this.zvd){var $a={};$a.Id=Ha.Id;Ha.StringId&&($a.StringId=
Ha.StringId);if(!(0<this.ML.length&&this.ML[0].Id===$a.Id&&this.ML[0].StringId===$a.StringId)){Ha=!1;this.ML.splice(0,0,$a);for(let Nb=1;Nb<this.ML.length;++Nb)if(this.ML[Nb].Id===$a.Id&&this.ML[Nb].StringId===$a.StringId){this.ML.splice(Nb,1);Ha=!0;break}for(;5<this.ML.length;)this.ML.splice(this.ML.length-1,1);this.Xna.Categories[Wb.lbb].DomainIds=this.ML;this.o7f();Ha||this.eVd.Gxg(this.ML)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");
if(this.gridView){var Ha=jb.q(this.gridView.ga.pa.Hd,this.$);Fb.a(this.$.userOperationManager,($a,Nb,rb)=>B(this.$.qa.va,Ha,$a,Nb,rb,null),$a=>new Rb.a(116,0,$a),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(xb.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");
this.QRd();var Ha=jb.r(this.gridView.ga.pa.selectedRanges,this.$);Fb.a(this.$.userOperationManager,($a,Nb,rb)=>D(this.$.qa.va,Ha,$a,Nb,rb,null),$a=>new Rb.a(248,0,$a),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}QVj(Ha){Ha=this.QV(Ha.DomainId);if(!Ha||Ha.DomainBlocked||Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Ha.HasCuratedData)return!1;if(this.SDi){for(let $a of this.OV)if($a.value.DomainId.Id===Ha.DomainId.Id&&$a.value.ShowInRibbon)return!0;
return!1}return Ha.ShowInRibbon}rUj(Ha){return 2!==this.Gt||!this.Lwa[Ha]}launchDisambiguationPaneForSearch(){this.Io&&this.Io.launchDisambiguationPaneForSearch()}ld(Ha,$a,Nb){if("PopulateConvertToLinkedEntityMenu"!==$a)return!1;this.pkd=Nb.MenuId;if(0===this.Gt||3===this.Gt)return this.jjj(),!0;if(!this.Xna)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.OV)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),
!1;this.c_=this.c_||this.Tbb.eYh(this.Xna,Nb.MenuId);Nb.MenuItems=this.c_;return this.zvd=!0}jjj(){-1===this.Rjc&&(this.EMb(),this.Rjc=window.setInterval(()=>{this.EMb()},2E3))}EMb(){this.$.ea.Ec&&2!==this.Gt&&(this.wOa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Gt=1,P(this.$.qa.va,this.j6i,this.i6i,null,null))}nwd(){return this.$.isEditMode&&2!==this.Gt&&(0<=this.wOa||!this.zdb)}e7d(Ha){d.AFrameworkApplication.Wg?
b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):r.a(this.$)?(this.cfk(),Ha&&this.$.Wf()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}LCj(){this.OJb=0;this.wOa=8;this.zdb=!1;this.Gt=this.Rjc=0;this.TQa=this.Xna=null;this.O8b();for(let Ha=0;Ha<this.LIb;++Ha)this.Lwa[Ha]=null;this.DEb()&&this.e7d(!0)}O8b(){this.c_=null}DEb(){const Ha=w.a.wNb,$a=r.a(this.$);return!!$a&&$a.pq.Lz===Ha}Zsg(){if(this.Xna){let Nb=
0;var Ha=-1,$a=-1;let rb=0,ec=0,pc=0,vb=0;const ob=[null,null,null,null,null];for(const Tb of this.Xna.Categories){let Rd=!1;for(const Jd of Tb.DomainIds){let ld=this.QV(Jd);ld&&!ld.DomainBlocked&&ld.ShowInRibbon&&(Nb<this.LIb?(this.Lwa[Nb]=Jd,ec===Wb.lbb&&(-1===Ha&&(Ha=Nb),$a=Nb,vb=$a-Ha+1),++Nb):Nb===this.LIb&&rb<vb&&ec!==Wb.lbb&&(ob[rb]=Jd,++rb),Rd=!0)}Rd&&++pc;++ec}if(-1<Ha&&pc<=Wb.Byf){for(;$a>=Ha;--$a)this.Lwa.splice($a,1);for(Ha=0;Ha<vb;++Ha)this.Lwa.splice(Nb+Ha,0,ob[Ha])}for(;Nb<this.LIb;)this.Lwa[Nb]=
null,++Nb}}Uqg(){const Ha=xb.h(this.$).Ca,$a=this.gridView.ga.gf;if(Ha&&Ha.vrd&&1===$a&&this.gridView.ga.pa.activeCell){const Nb=Object(Gc.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(Kb.d)(pb.a.resolve(nc.mb,{Wa:1})):Oa.GetServiceTaskFactory.Za(this.$.da,12,477,1);Pa.TaskExtensions.za(Nb,()=>{this.Dba=new t.a(this.$,this.svgIconProvider,Nb.result,this,this.oc)},this.$.ka,3);return!0}return!1}ULi(){this.Io&&this.Io.PBd(!0)}launchLinkedEntityDataTypeSelectorPane(Ha){if(this.Io)if(Ha=
this.led(Ha))if(Ha.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var $a=jb.r(this.gridView.ga.pa.selectedRanges,this.$);this.Io.launchLinkedEntityDataTypeSelectorPane($a,Ha.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}Sih(Ha){const $a=this.Oqi(Ha),Nb=h.a.ki(this.dHb(Ha));Ha=h.a.ki(this.F4d(Ha));return Wb.KXh($a,ub.a.dg(11),Nb,Ha)}F4d(Ha){try{return this.WUe(parseInt(Ha,
10)).Description}catch($a){}return la.a.instance.ha(1797)}dHb(Ha){try{return this.WUe(parseInt(Ha,10)).Name}catch($a){}return la.a.instance.ha(1783)}z8f(Ha){try{return this.QV(Ha).Name}catch($a){}return this.dHb(Ha.Id.toString())}n5g(Ha){try{return this.QV(Ha).BlankCellResourceId}catch($a){}return null}jni(Ha){try{return this.QV(Ha).HasBlankCellWalkthrough}catch($a){}return!1}Hif(Ha){try{const $a=Wb.w5a(Ha);if(this.OV.Fb($a))return this.OV.ma($a).HasCuratedData}catch($a){}return!1}N3j(Ha){try{return this.QV(Ha).SupportsStarterData}catch($a){}return!1}dtf(Ha){return 268435968===
Ha}yld(){return 2===r.a(this.$).wP?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}L$b(){return new sb.a(-847286761,nb.a.Vb,this.$.Kc,0,w.a.U1)}oPe(){if(this.DEb()&&!this.nwd()&&!this.Dqf&&Ka.EwaSettings.ya(387)&&this.Hif({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),ka.a.eh.tS){const Nb=this.yld();if(Nb){var Ha=this.L$b();if(Ha){var $a=
{["InputMethod"]:nb.a.Vb,CalloutName:6};$a.Target=Nb;$a.ShouldCanvasTakeFocus=!0;this.$.Ia.$b(Ha,$a);this.Dqf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}pqi(Ha){Ha=this.led(Ha);
return Ha?this.Tbb.Z3g(Ha.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}zmc(Ha){return this.Dba?this.Dba.Y3g(Ha):!1}S_h(){return this.Dba?this.Dba.P0h():""}Dyi(){return this.Dba?this.Dba.HHb:!1}J4h(Ha,$a){const Nb=this.Qlf(Ha);if(0>Nb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Ha}`);else if(Ha=(Ha=this.XUe(Ha))?this.QV(Ha):
null)$a[l.a.GalleryButtonProps]=this.Tbb.GYh(Nb,Ha),$a[l.a.Alt]=this.Tbb.gmd(Ha)}o7f(){this.Zsg();this.DEb()&&this.e7d(!0);this.O8b()}Oqi(Ha){return Ha===this.K3e?x.a.J0e:Ha===this.d7e?x.a.H0e:x.a.G0e}F1e(Ha){try{return this.QV(Ha).ExampleEntities}catch($a){}return la.a.instance.ha(1805)}HQd(){(0>this.wOa||this.zdb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Gt||0>this.wOa||this.zdb)&&window.clearInterval(this.Rjc);this.nwd()?
this.pkd&&this.$.frame.uy(this.pkd):this.e7d(this.DEb())}ic(Ha){return this.$.fc+Ha}cfk(){var Ha=!0;const $a=Array(this.LIb),Nb=r.a(this.$)?r.a(this.$).pq:null;if(Nb){for(let rb=0;rb<$a.length;++rb)this.rUj(rb)?$a[rb]=!0:Ha=$a[rb]=!1;Nb.xeg(["ConvertToLinkedEntityGallery"],Ha);if(!Ha)for(Ha=0;Ha<$a.length;++Ha)$a[Ha]&&Nb.xeg([this.I4h(Ha)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}QV(Ha){const $a=Wb.w5a(Ha);if(this.OV.Fb($a))return this.OV.ma($a);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${Ha.Id} (Has String ID: ${!!Ha.StringId})`);return null}I4h(Ha){return"ConvertToLinkedEntityPreview"+Ha.toString()}V6d(){k.a.get_instance().wj(10,()=>{this.oPe();this.Z6c&&this.$rf&&hb.c(this.Yxf,this.$.ka,500)})}Djc(Ha,$a){switch(Ha){case "QueryLinkedEntityGalleryButtons":if(!$a[l.a.InnerHTML]){Ha=$a[nb.a.rd].toString();const Nb=Lb.a.equals(Ha,la.a.instance.ha(1800),!0)||Lb.a.equals(Ha,la.a.instance.ha(1801),!0),rb=Lb.a.equals(Ha,la.a.instance.ha(1802),
!0);Nb||rb||this.J4h(Ha,$a)}break;case "QueryLinkedEntityMenuGalleryButtons":$a[l.a.InnerHTML]||($a[l.a.InnerHTML]=this.Sih($a[nb.a.rd]))}return $a}Zzh(Ha){var $a=this.XUe(Ha);if($a)return $a;if($a=this.led(Ha))return $a.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Ha}`);return null}WUe(Ha){const $a={};$a.Id=Ha;return this.QV($a)}led(Ha){return this.OV.Fb(Ha)?this.OV.ma(Ha):null}Qlf(Ha){if(!Ha.startsWith(Wb.Hed))return-1;const $a=parseInt(Ha.substr(Wb.Hed.length),
10);return isNaN($a)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Ha}`),-1):$a}XUe(Ha){Ha=this.Qlf(Ha);return 0>Ha?null:this.Lwa[Ha]}Pnf(Ha,$a,Nb){this.OV&&this.OV.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Ha})`),Ha=this.$.qa.va.Bc(),this.$.ea.Ec&&aa(this.$.qa.va,Ma.b(this.I8i,$a),Nb,null,null,Ha))}v$j(){this.Pnf("Auto-refresh on load",null,null)}A$j(){this.OV&&this.OV.count&&(this.WBa?b.ULS.sendTraceTag(537166799,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Pn.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.WBa=ca.a.instance.create(this.S6c,this.y6b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}$Fc(){if(this.$.ea.Ec&&null!=this.K$a&&null!=this.kyd&&null!=this.lyd&&null!=this.vAd&&null!=this.zzd)if(++this.OJb,12>=this.OJb){1===this.OJb&&(this.prd=ba.a.Bb.Ye.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const Ha=this.$.qa.va.Bc();
Ea.u(this.$.qa.va,this.ZMi,this.$Mi(),this.J9i,this.I9i,null,Ha)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${ba.a.Bb.Ye.m-this.prd} ms`),this.zdb=!0,this.HQd()}$Ie(){if(this.$.isEditMode)if(null!=this.K$a)this.$Fc();else{var Ha=ba.a.Bb.Ye.m,$a=[];n.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Nb=>{Nb.isFeatureEnabled("ExcelPowerBiPro",!1).then(rb=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${ba.a.Bb.Ye.m-Ha} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${rb}]`);return this.K$a=rb}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelWolframAlpha",!1).then(rb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${ba.a.Bb.Ye.m-Ha} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${rb}]`);return this.vAd=rb}))}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(rb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${ba.a.Bb.Ye.m-Ha} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${rb}]`);
const ec=[Object(Jb.a)(new Fa.a,{name:"IsRestrictedByLicense",bool:rb})];cb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,ec);this.Iuf=rb&&Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return rb}))}).then(()=>{$a.push(Nb.isFeatureEnabled("StockHistory",!1).then(rb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${ba.a.Bb.Ye.m-Ha} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,
`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${rb}]`);return this.zzd=rb}))}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelPowerBiFree",!1).then(rb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${ba.a.Bb.Ye.m-Ha} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${rb}]`);return this.kyd=rb}))}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",
!1).then(rb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${ba.a.Bb.Ye.m-Ha} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${rb}]`);return this.lyd=rb}))}).then(()=>{Promise.all($a).then(()=>{this.$Fc()})})})}}get ZMi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}$Mi(){return[this.K$a,
this.vAd,this.zzd,this.kyd,this.lyd,this.Iuf]}QRd(){this.businessBar&&this.businessBar.qna(58)&&this.businessBar.removeEntry(58)}mli(Ha){this.oCd!==Ha&&this.businessBar&&((this.oCd=Ha)?W(this.$.qa.va,this.M5i,null,null,null):this.QRd())}static KXh(Ha,$a,Nb,rb){Ha=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Ha,$a,rb);Nb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Nb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Ha,Nb)}static w5a(Ha){return Ha.StringId?Ha.Id.toString()+"."+Ha.StringId:Ha.Id.toString()}}Wb.LVe="ConvertToLinkedEntityPreview";Wb.Hed="PreviewGalleryButtonIndex.";Wb.lbb=0;Wb.Byf=2;Object(c.a)(Wb,"ConvertToLinkedEntityManager",v.a,[506,507,2,508])},872:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);C=a(735);var c=a(91);class b extends C.a{constructor(f,e,d){super(f,e);this.Hs=!0;this.command=
d}Km(f){super.Km(f);this.businessBar.$.Ia.$b(new c.a(this.command,f,this.businessBar.$.Kc,10,null))}}Object(u.a)(b,"CommandActionBusinessBarEntry",C.a,[])},894:function(u,C,a){a.r(C);u=a(0);var c=a(2),b=a(15),f=a(330),e=a(33),d=a(12),h=a(274);class l{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(u.a)(l,"ConnectionErrorLogInfo",null,[]);var k=a(1081),n=a(1082);class v{constructor(w){this.Psd=[k.a.syg,k.a.vLc];this.Am=(r,t)=>{this.vP[t]=r;this.Tni()&&
this.IBj("OnNetworkDownImmediatePing"===r.caller)};this.roa=w;this.$=w.$;this.vP={}}PLi(){const w=n.a.Okd(this.Am,"OnNetworkDownImmediatePing",this.$,this.Psd);for(const r of w)r.runTest()}Tni(){for(const w of this.Psd)if(void 0===this.vP[w]||null===this.vP[w])return!1;return!0}IBj(w){const r=this.$.Af.A7;w&&this.N2j(r);for(var t of this.Psd)this.vP[t]=Sys.Serialization.JavaScriptSerializer.serialize(this.vP[t]);w=Date.now();t=this.roa.Lpd(a(894).NetworkConnectionHealthChecker.yJb).returnValue;const A=
this.roa.Lpd(a(894).NetworkConnectionHealthChecker.MQb).returnValue;this.vP.isOfflineMode=r;this.vP.networkDownBBAge=-1===t?t:w-t;this.vP.transientServerCommunicationFailuresBBAge=-1===A?A:w-A;this.roa.businessBar?(this.vP.isNetworkDownBBShown=this.roa.businessBar.YF(56).toString(),this.vP.isServerErrorBBShown=this.roa.businessBar.YF(21).toString()):(this.vP.isNetworkDownBBShown="unknown",this.vP.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.vP)}`)}N2j(w){const {NetworkConnectionHealthChecker:r}=
a(894),t={};for(const A of Object.keys(this.vP)){const y=this.vP[A];t[y.testName]=y.isSuccess}t.isOfflineMode=w;this.roa.q2d(r.l$c,Sys.Serialization.JavaScriptSerializer.serialize(t))}}Object(u.a)(v,"ConnectionHealthTestsRunner",null,[]);a.d(C,"NetworkConnectionHealthChecker",function(){return x});class x{constructor(w){this.businessBar=this.Sab=null;this.a1i=(r,t)=>{t.Wdd?this.c1i(t):this.b1i(t)};this.Th=(r,t)=>{r=t.context.methodName;this.Sab&&r===this.Sab&&(b.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.Sab}" has now succeeded. Querying local storage for BB showings.`),
this.tbb(x.MQb,!0),this.Sab=null);this.sAf(!1);this.N9b=!1};this.tn=(r,t)=>{e.a.Fh(t.errors,[-1387426400])&&!this.N9b&&(this.N9b=!0,this.Ngg()&&window.performance.mark(x.zHf),(new v(this)).PLi())};this.Ig=()=>{this.sAf(!0);this.tbb(x.yJb,!1);this.tbb(x.MQb,!1)};this.BBa=()=>{this.tbb(x.yJb,!0)};this.$=w;this.qa=this.$.qa;this.localStorage=new h.a;this.N9b=!1;this.$.ea.nk(this.Ig);this.qa.Af.asb(this.BBa);this.qa.ms(this.Th);this.$.da.Gb(5,r=>{this.businessBar=r;r.TVg(this.a1i)});this.qa.Iy(this.tn)}dispose(){this.$&&
(this.$.ea&&this.$.ea.Pm(this.Ig),this.qa&&(this.qa.Af.DOb(this.BBa),this.qa.Jz(this.tn),this.qa.Mt(this.Th)))}c1i(w){const r={};r.Timestamp=Date.now().toString();switch(w.T2a){case 21:this.Sab=w.data.FailedMethod;r.FailedMethod=this.Sab;this.q2d(x.MQb,JSON.stringify(r));break;case 56:this.q2d(x.yJb,JSON.stringify(r))}}b1i(w){switch(w.T2a){case 21:this.tbb(x.MQb,!0);break;case 56:this.tbb(x.yJb,!0)}}q2d(w,r){try{this.localStorage.sf()&&this.localStorage.setItem(w,r)}catch(t){b.ULS.sendTraceTag(537155231,
0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${t.message||"Unknown"}`)}}Lpd(w){if(this.localStorage.sf()&&(w=this.localStorage.ONa(w))&&"null"!==w){var r=JSON.parse(w);w=parseInt(r.Timestamp,10);r=Sys.Serialization.JavaScriptSerializer.serialize(r);return{returnValue:w,rawData:r}}return{returnValue:-1,rawData:null}}sAf(w){if(this.localStorage.sf()){const r=this.localStorage.ONa(x.l$c);if(r&&"null"!==r){let t=-1;this.N9b&&(t=this.G4h(x.zHf,
x.M_i));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(r)}, Period offline: ${t}, New session: ${w}`);this.localStorage.removeItem(x.l$c)}}}G4h(w,r){if(!this.Ngg())return-1;window.performance.measure(r,w);w=window.performance.getEntriesByName(r);return w.length&&w[w.length-1]?w[w.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${r} returned no measures.`),
-1)}tbb(w,r){try{let t;const A=({rawData:t}=this.Lpd(w)).returnValue;if(-1!==A){const y=Object(c.a)(new l,{timeElapsed:Date.now()-A,scenario:w,isNewSession:!r,rawData:t});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(y)}`)}this.localStorage.removeItem(w)}catch(t){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${t.message||"Unknown"}`)}}Ngg(){return d.HelperMethods.Y5c&&
f.a.Utb}}x.yJb="NetworkDownBBShown";x.MQb="ServerCommunicationFailureBBShown";x.l$c="ConnectionHealthPingRsults";x.zHf="offMoStMa";x.M_i="offMoDuMea";Object(u.a)(x,"NetworkConnectionHealthChecker",null,[2])},945:function(u,C,a){a.d(C,"a",function(){return d});u=a(0);var c=a(15),b=a(6),f=a(41),e=a(31);class d{static I7e(h,l){switch(h){case 3:return d.aii(l);case 2:return d.sai(l);case 1:return d.k5h(l)}return""}static aii(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static sai(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static k5h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,
l,k){if(e.a.rh||e.a.Mo)window.setTimeout(()=>{d.s1f(k,d.agf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.XAe(k),h,0,!1)}static Xeh(h,l,k,n){l&&n&&n();d.openInClient(h,l,k)}static agf(){return e.a.rh?1:e.a.Mo?2:e.a.Fab?3:e.a.isMac?4:0}static get xFb(){return"zh-CN"===window.navigator.language}static s1f(h,l){1===l?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),h=d.I7e(h,l),8<e.a.iDb?f.a.Jf(h,void 0,void 0,"RedirectToAppStore"):f.a.jW(h)):document.hidden||
(d.xFb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.jW(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.I7e(h,l),null,null)))}static XAe(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get H_d(){return(e.a.Fab||
e.a.isMac)&&e.a.rp}static Y7e(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static PDi(h){return(h=d.q8h(h))&&""!==h?Boolean.parse(h):!1}static LYd(h){d.fOj(h)}static q8h(h){try{return localStorage.getItem(h)}catch(l){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static fOj(h){try{localStorage.setItem(h,"true")}catch(l){c.ULS.sendTraceTag(18416669,
306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}d.Kdh="ChromeExtensionBarDismiss";Object(u.a)(d,"WildFireUtilities",null,[])},984:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(234),f;(function(r){r[r.paren=0]="paren";r[r.lead=1]="lead";r[r.intern=2]="intern";r[r.trail=3]="trail";r[r.undefined=4]="undefined"})(f||(f={}));Object(u.b)("CurrencyFormatOption",f);var e;(function(r){r[r.none=-1]="none";r[r.mdy=0]="mdy";r[r.dmy=1]="dmy";r[r.ymd=2]="ymd";r[r.myd=3]="myd";r[r.dym=
4]="dym";r[r.ydm=5]="ydm"})(e||(e={}));Object(u.b)("DateOrderOption",e);var d=a(9);class h{constructor(r,t){({CalcHelper:r}=a(984));t&&(t.uf||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.gKg=r.sPe(t,r.dPe(t.Qla));this.hKg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.hKg}get localeData(){return this.gKg}}Object(u.a)(h,"LocaleHolder",null,[]);var l=a(1099),k=a(54),n=a(1),v=a(23),x=a(172);a.d(C,"CalcHelper",
function(){return w});class w{constructor(r){this.$=r;(this.Fv=this.$.da.Ba(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let t;t=n.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?k.a.current.Lo(78):k.a.current.Lo(81);this.logger=new l.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.yOi=new h(r,this.Fv);excelOnlineCalc.config.initCalc(this.logger,
this.Fv?A=>this.Fv.isFeatureEnabled(A):()=>!1,t);this.Xr=excelOnlineCalc.config.calcConfig(this.yOi.localeInfo)}get config(){return this.Xr}fth(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.ua)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const r=this.$.ua.na;return r?r.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.ua.na.index}createParser(){const r=
{};r.config=this.config;return excelOnlineCalc.parse.createParser(r)}createNumberFormatter(){const r=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(t,A)=>excelOnlineCalc.calc.getTime(this.config,t,A,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(r)}urh(r,t,A,y){if(!y)return{range:{row:t,col:A},sheet:{document:this.documentLoc,index:r}};t=excelOnlineCalc.location.gridCell(t,A);r=excelOnlineCalc.location.sheetIndex(this.documentLoc,r);return excelOnlineCalc.location.sheetGridCell(r,
t)}static sPe(r,t=null){const A=w.S$b(),y=r.uf.TrueValueString,z=r.uf.FalseValueString,E=r.uf.DecimalSeparator.toString(),G=r.uf.ListSeparator.toString(),F=r.uf.ColumnSeparator.toString(),O=r.uf.RowSeparator.toString(),M=r.uf.ThousandsDataArray,P=r.uf.ThousandSeparator.toString(),B=r.uf.Lcid,D=r.uf.Country,I=r.uf.DigitsNumber,S=r.uf.ExpSeparatedBySpace,J=r.uf.FractionSeparator.toString(),L=r.uf.PercentSeparatedBySpace,R=v.a.lbh(Enum.toString(f,r.uf.CurrencyFormat)),Y=r.uf.CurrencySymbolLead,Q=r.uf.CurrencySeparatedBySpace,
W=r.uf.CurrencySymbolString,Ga=r.uf.DigitsCurrency,pa=-1===r.uf.DateOrder?"MDY":x.e(Enum.toString(e,r.uf.DateOrder)),aa=r.uf.DateSeparator.toString(),Z=r.uf.DateAlternativeSeparator.toString(),fa=r.uf.Year4Digits,ya=r.uf.Month2Digits,Aa=r.uf.Day2Digits,ja=r.uf.LongDateFormat,za=r.uf.TimeSeparator.toString(),ra=r.uf.TimeAltSeparator,fb=r.uf.Hour2Digits,Ua=r.uf.Use24HourClock,Ca=r.uf.AmPmSeparatedBySpace,Ia=[r.uf.AmString,r.uf.PmString],oa=r.uf.DayNameShortArray,Da=r.uf.DayNameLongArray,bb=r.uf.MonthNameShortArray,
Za=r.uf.MonthNameLongArray,Xa=r.uf.PictureSpecialArray,Ba=b.a.map(("\x00"+r.uf.PictureSingleString).split(""),nb=>"\x00"===nb?null:nb),Wa=r.uf.PictureColorArray,Na=r.uf.PictureDbnumArray,ta=r.uf.RowLetter.toString(),V=r.uf.ColumnLetter.toString(),ia=r.uf.LeftBrace.toString(),X=r.uf.RightBrace.toString(),la=r.uf.LeftBracket.toString(),sa=r.uf.RightBracket.toString(),Va=w.Tei(r.uf);return excelOnlineCalc.calc.localeData(t,A,y,z,ta,V,ia,X,la,sa,E,G,F,O,M,P,B,D,I,S,J,L,R,Y,Q,W,Ga,pa,aa,Z,fa,ya,Aa,ja,
za,ra,fb,Ua,Ca,Ia,oa,Da,bb,Za,Xa,Ba,Wa,Na,Va,r.uf.SysDateFormatString,r.uf.SysTimeFormatString)}static dPe(r){const t=[];if(!r)return t;for(const A of r)r=null,A.IsDynamicUdf||(r=excelOnlineCalc.calc.worksheetFunctionName(A.FunctionIndexInServer,A.NameUI)),r&&t.push(r);return t}static S$b(){const r=[],t=Object.keys(d.a.errorNames);for(let A=0;A<t.length;A++){const y=excelOnlineCalc.calc.errorTypeName(A+1,t[A]);y&&r.push(y)}return r}static Tei(r){const t=Array(6);t[1]="#"+r.AllStructRefString;t[3]=
"#"+r.HeadersStructRefString;t[2]="#"+r.DataStructRefString;t[4]="#"+r.TotalsStructRefString;t[5]="#"+r.ThisRowStructRefString;return t}}Object(u.a)(w,"CalcHelper",null,[])},989:function(u,C,a){a.r(C);u=a(119);var c=a(0),b=a(15),f=a(6),e=a(92),d=a(31),h=a(144),l=a(273),k=a(42),n=a(86),v;(function(fa){fa[fa.unableToRefreshLock=0]="unableToRefreshLock";fa[fa.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";fa[fa.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";fa[fa.workbookTooLarge=3]=
"workbookTooLarge";fa[fa.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";fa[fa.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";fa[fa.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";fa[fa.unsupportedFeatures=7]="unsupportedFeatures";fa[fa.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";fa[fa.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";fa[fa.collabDataLocaleMismatch=10]=
"collabDataLocaleMismatch";fa[fa.lastGenericStatusError=11]="lastGenericStatusError";fa[fa.scratchPadWarning=12]="scratchPadWarning";fa[fa.authenticationLost=13]="authenticationLost";fa[fa.odfCompatibilityIssues=14]="odfCompatibilityIssues";fa[fa.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";fa[fa.workbookIsIrmProtected=16]="workbookIsIrmProtected";fa[fa.biFeatureNotAvailable=17]="biFeatureNotAvailable";fa[fa.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
fa[fa.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";fa[fa.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";fa[fa.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";fa[fa.editAttemptInReadOnly=22]="editAttemptInReadOnly";fa[fa.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";fa[fa.unsupportedBrowser=24]="unsupportedBrowser";fa[fa.readOnlyPermissions=25]="readOnlyPermissions";fa[fa.documentIsIrmProtectedWarning=
26]="documentIsIrmProtectedWarning";fa[fa.policyWarningMessage=27]="policyWarningMessage";fa[fa.workingOnIt=28]="workingOnIt";fa[fa.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";fa[fa.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";fa[fa.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";fa[fa.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";fa[fa.legacyConnectionsBB=33]="legacyConnectionsBB";fa[fa.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";fa[fa.groupedSlicersBB=35]="groupedSlicersBB";fa[fa.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";fa[fa.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";fa[fa.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";fa[fa.wacGdprNotice=39]="wacGdprNotice";fa[fa.automaticSensitivityLabel=40]="automaticSensitivityLabel";fa[fa.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";fa[fa.mandatorySensitivityLabel=42]=
"mandatorySensitivityLabel";fa[fa.localStorageDisabled=43]="localStorageDisabled";fa[fa.autoRefreshDisabled=44]="autoRefreshDisabled";fa[fa.corruptedFileRepaired=45]="corruptedFileRepaired";fa[fa.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";fa[fa.minorVersionLimitReached=47]="minorVersionLimitReached";fa[fa.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";fa[fa.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";fa[fa.sensitivityApplicationLabelNotSupportedError=
50]="sensitivityApplicationLabelNotSupportedError";fa[fa.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";fa[fa.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";fa[fa.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";fa[fa.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";fa[fa.promptEnableExternalLinks=55]="promptEnableExternalLinks";
fa[fa.networkDown=56]="networkDown";fa[fa.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";fa[fa.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";fa[fa.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";fa[fa.canvasHealth=60]="canvasHealth";fa[fa.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";fa[fa.optimizeWorkbook=62]="optimizeWorkbook";fa[fa.novModePostDepreciation=63]="novModePostDepreciation";fa[fa.officeScriptsRunning=
64]="officeScriptsRunning";fa[fa.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";fa[fa.readOnlyPivotTable=66]="readOnlyPivotTable";fa[fa.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";fa[fa.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";fa[fa.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";fa[fa.dataCleansingSuggestions=70]="dataCleansingSuggestions";fa[fa.count=71]="count"})(v||(v={}));Object(c.b)("EwaBusinessBarEntryType",
v);var x=a(7),w=a(1087);class r extends Sys.EventArgs{constructor(fa,ya,Aa=null){super();this.T2a=fa;this.Wdd=ya;this.data=Aa}}Object(c.a)(r,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var t=a(1090),A=a(1088),y=a(1092);a(1091);var z=a(1085),E=a(484),G=a(52),F=a(40),O=a(668),M=a(33),P=a(1),B=a(23),D=a(20),I=a(64),S=a(74),J=a(945),L=a(30),R=a(43),Y=a(149),Q=a(36),W=a(1089),Ga=a(100);a.d(C,"BusinessBarManager",function(){return Z});var pa;const aa=[55,39,5,30,16,14,7,41,4,37];let Z=pa=
class extends n.a{constructor(fa,ya=!fa.F0){super();this.Ra=new k.a;this.eR=null;this.HPc=[];this.Ttc=()=>{this.$.qa.pPa?this.removeEntry(13):this.zh(13,null)};this.Th=(Aa,ja)=>{for(let za=0,ra=pa.ajc().length;za<ra;za++)Aa=pa.ajc()[za],this.removeEntry(Aa);ja.context&&0<ja.context.communicationErrorRetryCount&&(b.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));
this.TAj()};this.tn=(Aa,ja)=>{var za;Aa=this.eSh(ja.errors);let ra=[];for(let Ua=0,Ca=Aa.length;Ua<Ca;++Ua){const Ia=Aa[Ua];if(1===Ia.Type&&Ia.Appearance&32)ra=this.smi(Ia,ra);else if(ja.PKj){b.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var fb=(null===(za=ja.context)||void 0===za?0:za.stopwatch)?ja.context.stopwatch.fd:-1;5E3>fb?b.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${fb}ms).`):
f.AFrameworkApplication.XHi()||this.oVg(Ia,ja.context.methodName)}fb=[...pa.ajc()];for(let oa=0,Da=ra.length;oa<Da;++oa){const bb=ra[oa];this.zh(bb,Ia);Array.remove(fb,bb)}for(let oa=0,Da=fb.length;oa<Da;++oa)this.removeEntry(fb[oa])}};this.zd=(Aa,ja)=>{this.Xc(Aa,ja)};this.Xc=()=>{const Aa=this.$.ea;Aa.Ec||Aa.mg()||(this.pRd(),this.HPc.length=0)};this.Td=(Aa,ja)=>{this.$.ea.mg()&&!ja.cX||this.Zlf(ja.cX)};this.HLb=()=>{const Aa=this.$.userOperationManager.Lic();Aa&&Aa.operation.flags&1&&this.nig()};
this.GMf=()=>{this.nig()};this.fg=()=>{this.SIe();this.vig()};this.TO=()=>{if(this.$.D7&&this.$.ea.mg()&&this.$.ea.Ec)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const Aa=this.$.da.Ba(331);Aa&&Aa.GMa||this.removeEntry(55);this.removeEntry(5)}};this.$=fa;this.M1a=ya;this.V2g();f.AFrameworkApplication.de&&f.AFrameworkApplication.de.G1c(this);
this.JIa=Array(71);for(let Aa=0;71>Aa;Aa++)this.JIa[Aa]=null;this.ii=O.EcmaDateClock.instance;this.Pwf=this.ii.Cc.getTime();ya&&(ya=fa.qa,ya.Iy(this.tn),ya.ms(this.Th),ya.Rrb(this.Ttc),ya.i1a(this.Ttc),fa.ea.pk(this.zd),fa.ea.nv(this.fg),fa.Ql(this.Td),fa.Xj(this.Xc),fa.ea.E4(this.TO),fa.userOperationManager.ks(this.HLb),P.EwaSettings.ya(158)&&fa.ea.oh.get(45)&&f.AFrameworkApplication.fa.ra("SupportsPolicies")||this.Vhf(),this.Zlf(I.c(fa)));fa.da.Ja(5,this);L.a.kab()&&(this.$.ISb=this.yyi())}Vhf(){M.a.Aq(this.$.ea.XG)&&
this.tn(this,new E.a(this.$.ea.XG,null,!1,-1,-1,-1,-1,"",-1,"",-1))}TVg(fa){this.Ra.addHandler("bBarAttachedOrDetached",fa)}get dfd(){return this.HPc}get domElement(){return this.eR?this.eR.domElement:null}dispose(){if(this.$){const fa=this.$,ya=fa.qa;ya.Jz(this.tn);ya.Mt(this.Th);ya.Kzc(this.Ttc);ya.tOb(this.Ttc);fa.ea.Kk(this.zd);fa.ea.Xw(this.fg);fa.Rm(this.Td);fa.Ll(this.Xc);fa.ea.r9(this.TO);fa.userOperationManager.Uo(this.HLb);D.h(fa).wc.Un(this.GMf)}e.a.Ka(this.eR);this.$=this.eR=null;super.dispose()}yyi(){for(let fa=
0;fa<aa.length;fa++)if(this.JIa[aa[fa]])return!0;return!1}azi(fa){switch(fa){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:return!0;default:return!1}}zh(fa,ya,Aa=null,ja=null,za=null){if(!this.$.isMobileMode||this.azi(fa))this.M1a&&!this.YF(fa)&&(this.JIa[fa]=this.ii.eha,this.eR.CD(fa,ya,ja,za),L.a.kab()&&this.hdk(fa),this.Ra.raiseEvent("bBarAttachedOrDetached",new r(fa,!0,Aa))),ya&&32===ya.Appearance&&S.a(this.$).Qd.Dea(ya)}NXj(fa,ya,Aa,ja){b.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
z.a.initialize(fa,ya,Aa,ja);this.zh(39,null)}NWj(fa,ya,Aa,ja){w.a.initialize(fa,ya,Aa,ja);this.zh(40,null)}WYj(fa,ya,Aa,ja){A.a.initialize(fa,ya,Aa,ja);this.zh(41,null)}jXj(fa,ya,Aa,ja){W.a.initialize(fa,ya,Aa,ja);this.zh(70,null)}lYj(fa,ya,Aa,ja){t.a.initialize(fa,ya,Aa,ja);this.zh(42,null)}bZj(fa,ya,Aa,ja){y.a.initialize(fa,ya,Aa,ja);this.zh(54,null)}removeEntry(fa){this.M1a&&(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&b.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(v,
fa)}`),this.JIa[fa]=null,this.eR.removeEntry(fa)&&this.Ra.raiseEvent("bBarAttachedOrDetached",new r(fa,!1)))}qna(fa){return this.M1a?this.eR.qna(fa):!1}YF(fa){return this.M1a?this.eR.YF(fa):!1}zJb(){b.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}gtc(){b.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}V2g(){const {BusinessBarControl:fa}=
a(1192);if(this.M1a&&!this.eR){D.h(this.$).wc.ao(this.GMf);var ya=document.getElementById(this.$.fc+x.a.SFe);this.eR=new fa(this.$,ya)}}pRd(){this.M1a&&this.eR.pRd()}hdk(fa){0<=aa.indexOf(fa)&&!this.$.ISb&&(this.$.ISb=!0,this.$.l7b=fa,this.$.v3c&&this.lcg(!0))}TAj(){if(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ya=this.ii.eha;if(3E5<=ya-this.Pwf){this.Pwf=ya;for(let Aa=0;71>Aa;Aa++){var fa=this.JIa[Aa];if(fa&&(fa=ya-fa,3E5<=fa)){const ja=Enum.toString(v,Aa);
b.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${ja}] was activated but not turned off for ${fa} Millis`)}}}}}eSh(fa){const ya=[];for(const Aa of fa)switch(Aa.MessageId){case -113742550:const ja=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||M.a.Fh(fa,ja))&&ya.push(-113742550)}return M.a.bB(fa,ya)}smi(fa,ya){switch(fa.MessageId){case 2113407564:const Aa=M.a.P2a([1821390342,-943219229,-502303485,1437034227]);
for(let ja=0;ja<Aa.length;ja++)Aa[ja].HelpTopicId=fa.HelpTopicId,Aa[ja].HelpDescription=fa.HelpDescription,this.HPc.push(Aa[ja])}switch(fa.MessageId){case -395951567:this.zh(6,fa);break;case 1643490758:this.zh(4,fa);break;case -907264831:this.zh(5,fa);break;case 757111532:case 2113407564:this.zh(7,fa);break;case 2010656511:this.zh(15,fa);break;case 1321660996:this.$.wcd=!0;this.zh(8,fa);break;case 526339737:this.$.wcd=!0;this.zh(9,fa);break;case -407088521:this.zh(10,fa);break;case 1756116017:this.zh(14,
fa);break;case -1703455218:this.zh(17,fa);break;case 1393475740:this.zh(25,fa);break;case -949523941:this.zh(26,fa);break;case 1779381952:this.zh(44,fa);break;case 1421575100:this.zh(45,fa);break;case 613676060:this.zh(46,fa);break;case 1233668252:this.zh(61,fa);break;case 1911608588:fa=!!(this.$.$d&64);!this.$.ea.mg()&&fa&&ya.push(29);break;case 1544494907:break;case -655555355:ya.push(this.Rzd()?1:0);break;case -1221382671:ya.push(2);break;case 1662282929:ya.push(3);break;case 104919273:this.$.ea.mg()||
ya.push(30);break;case -689453604:fa=!!(this.$.$d&64);this.$.ea.fjf=!0;!this.$.ea.mg()&&fa&&ya.push(31);break;case 157762400:this.$.ea.Bnc=!0;!this.$.ea.mg()&&this.$.$d&64&&!this.$.isEditMode&&ya.push(32);break;case -1125398042:P.EwaSettings.isChangeGateEnabled("OfficeVSO:7812191_CleanLoadBlockingFloatingObjects")&&!this.$.ea.mg()&&this.$.$d&64&&!this.$.isEditMode&&ya.push(34);break;case -73730134:!this.$.ea.mg()&&this.$.$d&64&&ya.push(33);break;case -293349236:ya.push(65);break;case 1580811823:ya.push(67);
break;case -37299333:break;case 136737622:ya.push(47);break;case -1780327030:this.zh(55,fa);break;case -113742550:this.zh(57,fa);break;case -260312420:this.$.ea.mg()||ya.push(66);break;case 784737213:this.$.ea.mg()||ya.push(70);break;default:this.zh(11,fa)}return ya}Zsi(){if(f.AFrameworkApplication.fa.ra("WildFireExcelBizBar")&&!J.a.PDi(J.a.Y7e(1))&&(d.a.Mo||d.a.rh)){const fa=P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Ga.d)(Y.a.resolve(Q.p,{Wa:1})):
G.GetServiceTaskFactory.create(this.$.da,155,this.$.ka,1);F.TaskExtensions.za(fa,()=>{this.zh(20,null)},this.ka,3)}}rsi(fa){fa||3!==this.$.workbookContext.WorkbookNovType||this.zh(63,null)}Zlf(fa){(!fa&&!this.$.printingEnabled||this.$.Ne.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(b.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.zh(16,null));this.Zsi();this.SIe();this.vig();this.rsi(fa)}SIe(){this.$.workbookContext.Options&
32768&&this.CXj()}CXj(){this.JIa[37]||this.zh(37,null)}EZj(){this.JIa[38]||this.zh(38,null)}vig(){this.$.workbookContext.Options&524288&&this.zh(59,null)}Uig(fa,ya){this.zh(58,fa,null,ya)}xwe(fa,ya=null){this.eR.YF(fa)?this.eR.KUb(fa,ya):this.zh(fa,null,null,null,ya)}nig(){this.$.$d&8&&this.zh(12,null)}Rzd(){const fa=this.$.da.Ba(38);return fa?fa.tokenExpired:!1}oVg(fa,ya){if(!this.YF(21)&&-1387426400!==fa.MessageId){b.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");
const Aa={};Aa.FailedMethod=ya;this.zh(21,fa,Aa)}}static ajc(){return pa.Tze||(pa.Tze=[0,1,2,3])}lcg(fa){try{const ja=h.a.get(x.a.QLd);if(B.a.sh(ja))b.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.nYd();else{var ya=R.a(decodeURIComponent(ja)),Aa=ya.Options;ya.Options=fa?Aa|4096:~(~Aa|4096);try{const za=R.c(ya);h.a.Qt(x.a.QLd,za,l.AFrame.jQ);b.ULS.sendTraceTag(509686989,
0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised");h.a.Qt(x.a.m7b,this.$.l7b.toString(),l.AFrame.jQ)}catch(za){b.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${za.message}`)}}}catch(ja){b.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${ja.message}`)}}uld(fa){return this.eR.uld(fa)}};
Z.Tze=null;Z=pa=Object(u.b)([Object(Y.d)(Q.h),Object(u.c)(0,Object(Q.A)())],Z);Object(c.a)(Z,"BusinessBarManager",n.a,[567,2,69])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.pi.js.map/1e42f7b8df5a31607d81e58e9db0e901/EwaDSOpt.pi.js.map