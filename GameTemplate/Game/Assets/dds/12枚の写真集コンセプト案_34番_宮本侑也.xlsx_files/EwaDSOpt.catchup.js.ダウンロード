'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1022:function(u,C,a){a.d(C,"a",function(){return f});u=a(0);var c=a(178);C=a(890);var b=a(755);class f extends C.a{constructor(e,d){super(e,d);d!==b.a.HK&&this.QQ(d);this.QZ(f.iterateNext);this.QZ(f.aAa);this.X0a(c.a.KXa);this.X0a(c.a.LXa);this.X0a(c.a.O_)}}f.iterateNext="IterateNext";f.aAa="IteratePrevious";f.bUb="ToggleShowChanges";f.setCurrentChangeCount="SetCurrentChangeCount";f.setTotalChangesCount="SetTotalChangesCount";
f.wSa="OnVHDiffReady";Object(u.a)(f,"VersionHistoryMessenger",C.a,[])},1312:function(u,C,a){u=a(0);var c=a(15),b=a(82),f=a(769),e=a(126),d=a(9),h=a(217),l=a(73),k=a(47),n=a(200),v=a(129),x=a(230),w=a(1),r=a(12),t=a(107),A=a(16),y=a(246),z=a(20),E=a(354);class G{constructor(I,S,J){this.NIa=I;this.el=S;this.O7d=J}}Object(u.a)(G,"UserActivityLocation",null,[]);var F=a(1022),O=a(58);const M=(I,S,J,L,R,Y=null)=>{Y=I.Pa(1,Y);return O.g(I,"GetVersionHistoryHighlightActivitiesData",Y,S,J,L,R,4)};var P=a(755),
B=a(62);a.d(C,"a",function(){return D});class D{constructor(I,S,J,L){this.authorColor=this.o4=this.cha=null;this.lab=!1;this.L4a=-1;this.$bd=0;this.BLa=100;this.P7=-1;this.t8d=null;this.Ftb=d.a.Ojk;this.Ucd=d.a.Pjk;this.BJb=!1;this.W3h=()=>({DisplayName:d.a.Qjk,Email:null,Id:null,Provider:null});this.Th=R=>{(R=x.a(R)?null:R.Result)?R.OperationWaitingForFileDownload?20>this.$bd?(this.BLa*=2,B.Task.delay(this.BLa).continueWith(()=>{this.y5d()})):(this.AJc(),c.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
R.ActivityList?(this.initialize(R.ActivityList,R.VersionAuthors),w.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?this.wSa():this.rSb(!0),this.t8d.stop(),c.ULS.sendTraceTag(41743369,0,50,`VersionHistoryHighlightManager: Time taken For showing diffs in Ms:${this.t8d.fd.toString()}`)):(this.AJc(),c.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(this.BLa*=2,B.Task.delay(this.BLa).continueWith(()=>
{this.y5d()}),c.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.NBa=()=>{this.AJc();c.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.DAd=R=>{c.ULS.sendTraceTag(537150400,0,50,`VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:${R.MessageId}`);switch(R.MessageId){case F.a.iterateNext:this.iterateNext();this.P7=(this.P7+1)%this.NP.length;
this.zQb(F.a.setCurrentChangeCount,this.P7+1);break;case F.a.aAa:this.aAa();this.P7=0>this.P7?0:this.P7;this.P7=(this.P7+this.NP.length-1)%this.NP.length;this.zQb(F.a.setCurrentChangeCount,this.P7+1);break;case F.a.bUb:this.rSb(R.Values.ToggleValue)}};this.Ehh=(R,Y)=>this.z9b(R.el,Y.el);this.Chh=(R,Y)=>this.z9b(R.el,Y);this.Dd=()=>{w.EwaSettings.isChangeGateEnabled("OfficeVSO:7487107_XlOnlineVHRemovingDeselectOnSelectionChanged")||this.ubc()};this.vo=()=>{this.ubc()};this.Ji=()=>{this.ubc()};c.ULS.sendTraceTag(537150411,
0,50,"VersionHistoryHighlightManager::Constructor.");this.$=I;this.ariaLiveNotifier=L;this.gridView=z.h(this.$);this.gridView.ga.gp(this.Dd);this.gridView.KF(this.vo);this.gridView.wc.ao(this.Ji);this.Mek();this.BJb=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7468185_XlOnlineVHNewIterationAlgorithm");S&&(this.t8d=I.nc.qd("UserAction","VersionHistoryDiffManagerStopWatch"),this.y5d());if(this.Dt=J)I=b.a.wL(this.$.xa.VersionHistoryActionUrl)||P.a.HK,I!==P.a.HK&&this.Dt.QQ(I),this.Dt.fn(F.a.iterateNext),
this.Dt.fn(F.a.aAa),this.Dt.fn(F.a.bUb),this.Dt.hl(F.a.iterateNext,this.DAd),this.Dt.hl(F.a.aAa,this.DAd),this.Dt.hl(F.a.bUb,this.DAd)}get wkb(){return this.o4}get vQb(){return-1===this.L4a?null:this.NP[this.L4a]}get NP(){this.lab||(this.cha.sort(this.Ehh),this.lab=!0);return this.cha}dispose(){this.JCa();this.cha=this.o4=null;this.gridView&&(this.gridView.ga&&this.gridView.ga.Gp(this.Dd),this.gridView.dH(this.vo),this.gridView.wc&&this.gridView.wc.Un(this.Ji),this.Dt&&(this.Dt.X2(F.a.aAa),this.Dt.X2(F.a.iterateNext),
this.Dt.X2(F.a.bUb)))}initialize(I,S){I?(this.JCa(),this.L4a=-1,this.cha=[],this.lab=!1,this.o4={},this.authorColor={},this.LTi(S),this.Kbd(I)):c.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")}y5d(){c.ULS.sendTraceTag(537150409,0,50,`VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: ${this.$bd.toString()} --${this.BLa.toString()}`);this.$bd++;this.$.userOperationManager.kd(new n.a(537,0,(I,S,J)=>M(this.$.qa.va,
y.b(I,this.Th),y.a(S,this.NBa),J,null),80),null)}rSb(I){const S=this.o4;for(let L in S){var J=L;const R=S[L];R?R.tSb(I):c.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+J+"view was Null")}}JCa(){const I=this.o4;for(let J in I){var S=J;const L=I[J];L?L.zRd():c.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+S+"view was Null")}this.cha=this.o4=null}Bag(I){let S;if(this.BJb)S=I?this.Nbf(this.P7):this.Tcf(this.P7),I=
this.NP[S];else if(!({Slf:S,fvg:I}=this.y$h(I,this.L4a)).returnValue)return;c.ULS.shipAssertTag(537150402,0,!!I,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null");this.ubc();if(I.NIa.toString()in this.o4){this.o4[I.NIa.toString()].QIj(I.el);var J=k.E(I.el);this.ariaLiveNotifier.setEnabled(!1);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.readText(String.format(A.a.instance.Lb(158),S+1,this.NP.length,J.nz(!1),I.O7d.DisplayName));this.L4a=S}else c.ULS.shipAssertTag(537150401,
0,!1,`VersionHistoryHighlightManager.SelectNextOrPreviousChange - ${I.NIa.toString()} view not present in views dictionary`)}zQb(I,S){if(w.EwaSettings.ya(279))if(this.Dt){var J={};J.count=S;I=new f.a(I);I.Values=J;this.Dt.send(I)}else c.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else c.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")}y$h(I,
S){let J,L=!1;J=null;let R=0;for(;!L&&R<this.NP.length;){S=I?this.Nbf(S):this.Tcf(S);J=this.NP[S];const Y=Object(e.a)(t.a,this.$.ua.getItemByName(J.el.SheetName));if(!Y)return c.ULS.shipAssertTag(537150369,0,!1,"VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet"),{returnValue:!1,Slf:S,fvg:J};Y.visible&&(L=!0);R++}return{returnValue:L,Slf:S,fvg:J}}Nbf(I){return this.BJb||-1!==I?(I+1)%this.NP.length:this.Ibf()}Tcf(I){this.BJb&&
-1===I?I=0:-1===I&&(I=this.Ibf());return I=(I+this.NP.length-1)%this.NP.length}Kbd(I){this.ssh(I);this.pbd()}jhi(I,S){const J=[];if(!I.RangeList)return c.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),J;for(const L of I.RangeList)if(!L||!this.$.ua.fl(L.SheetName))c.ULS.shipAssertTag(537150367,0,!1,"Invalid sheet name "+L.SheetName);else if(!this.BJb||this.$.ua.getItemByName(L.SheetName).visible)I=
new G(0,L,S),J.push(I);return J}ssh(I){for(const S of I)if(!S||v.e(S.LocationList))c.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(const J of S.LocationList)if(J)switch(J.Type){case 0:this.cha.push(...this.jhi(J,S.Person));break;default:c.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else c.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")}pbd(){var I=
{};const S=[];for(const J of this.cha){if(0!==J.NIa)continue;const L=new E.a(k.E(J.el),l.d(this.$.ua.getItemByName(J.el.SheetName))),R=D.kEc(L);R in I||S.push(L);I[R]=this.i2h(J.O7d);I[R]===this.Ucd&&this.Vgk(J)}c.ULS.sendTraceTag(42541534,0,15,`VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : ${this.cha.length}, Highlightable activities: ${S.length},Total userlist in activities : ${this.cha.length}, Total userlist from pane: ${S.length} `);this.AJc();0<S.length&&(I=new (a(1425).RangeVersionHistoryHighlightView)(this.$,
S,I,this.Ftb),this.o4["0"]=I)}Vgk(I){w.EwaSettings.isChangeGateEnabled("OfficeVSO:7213684_NarratorReadsAuthorNameForChangesWithoutUserAttributionDuringIteration")&&(I.O7d=this.W3h())}AJc(){const I=this.cha?this.NP.length:0;this.zQb(F.a.setCurrentChangeCount,0);this.zQb(F.a.setTotalChangesCount,I)}wSa(){this.zQb(F.a.wSa,0)}LTi(I){if(I)for(let R=0;R<I.length;++R)if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!I[R].InitialsColor)c.ULS.sendTraceTag(537150362,0,15,
"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var S=I[R].EmailAddress;var J=I[R].UserName;var L=null;if(I[R].LoginName){const Y=I[R].LoginName.split("|");3===Y.length&&(L=Y[2])}L?this.authorColor[L]=I[R].InitialsColor:S?(c.ULS.sendTraceTag(537150361,0,15,"VersionHistoryHighlightManager Map Author Color: LoginName is null"),this.authorColor[S]=I[R].InitialsColor):J?(c.ULS.sendTraceTag(537150360,0,15,"VersionHistoryHighlightManager Map Author Color: Email Address is null"),
this.authorColor[J]=I[R].InitialsColor):c.ULS.sendTraceTag(537150359,0,10,"VersionHistoryHighlightManager Map Author Color: User name is null")}else c.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")}Mek(){if(this.$.xa.VersionHistoryHighlightsSettings){var I=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.xa.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.xa.VersionHistoryHighlightsSettings):
null;for(let J=0;J<I.length;J++){var S=I[J];const L=S.key?S.key:S.Key?S.Key:"";S=S.value?S.value:S.Value?S.Value:"";"DefaultColor"===L?this.Ucd=S:"InitialTint"===L?this.Ftb=S:c.ULS.sendTraceTag(537150357,0,15,"VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect")}}else c.ULS.sendTraceTag(537150358,0,15,"VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null")}i2h(I){if(I.Email in this.authorColor)return this.authorColor[I.Email];if(I.DisplayName in
this.authorColor)return this.authorColor[I.DisplayName];c.ULS.sendTraceTag(537150356,0,15,"VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary");return this.Ucd}z9b(I,S){var J=Object(e.a)(t.a,this.$.ua.getItemByName(I.SheetName));const L=Object(e.a)(t.a,this.$.ua.getItemByName(S.SheetName));return J&&L?(J=(J=r.HelperMethods.SG(J.index,L.index))||r.HelperMethods.SG(I.FirstRow,S.FirstRow))||r.HelperMethods.SG(I.FirstColumn,S.FirstColumn):(c.ULS.sendTraceTag(537150355,
0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)}Ibf(){var I=k.m(this.gridView.ga.pa.activeRange,this.$.ua.na);if(!I)return c.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;I=r.HelperMethods.Jy(new h.a(this.NP),0,this.NP.length,I,this.Chh);0>I&&(I=~I);return I%this.NP.length}ubc(){if(this.vQb){if(!(this.vQb.NIa.toString()in this.o4)){c.ULS.shipAssertTag(537150353,0,!1,
`VersionHistoryHighlightManager.DeselectCurrentlySelectedView - ${this.vQb.NIa.toString()} view not present in views dictionary`);return}this.o4[this.vQb.NIa.toString()].ewh(this.vQb.el)}this.L4a=-1}iterateNext(){this.Bag(!0)}aAa(){this.Bag(!1)}static kEc(I){return`${I.range}${I.sheetId}`}}Object(u.a)(D,"VersionHistoryHighlightManager",null,[684,2])},1425:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(9);class f{}f.IKh="ewa-vhr-rectinnerborder";Object(u.a)(f,"CssClassNames",null,[]);var e=a(73),d=
a(47),h=a(207),l=a(20),k=a(354),n=a(1312);a.d(C,"RangeVersionHistoryHighlightView",function(){return v});class v{constructor(x,w,r,t){this.inb=null;this.$=x;this.JNg=w;this.xVa=r;this.yVa={};this.Ftb=t;this.Rui()}get xG(){return[v.X6]}get dc(){return this.inb||(this.inb=l.h(this.$).dc)}tSb(x){x?this.dc.Ur(this.xG):this.dc.Hk(this.xG)}zRd(){this.tSb(!1);this.dc.iVa(new k.a(null,e.d(this.$.na)),this.xG)}QIj(x){if(this.xVa){var w=new k.a(d.E(x),e.d(this.$.ua.getItemByName(x.SheetName))),r=n.a.kEc(w);
if(r in this.xVa)if(r in this.yVa){w=h.a.aq(this.xVa[r]);r=this.yVa[r];for(let t in r)r[t].style.backgroundColor=`rgba(${w.r},${w.g},${w.b},${b.a.Rjk})`;l.h(this.$).ga.Sa.uI(null);l.h(this.$).Egf(x,60,!0,"RangeVersionHistoryHighlightViewSelectView.SelectView")}else c.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+r);else c.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+
r)}else c.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")}ewh(x){x=new k.a(d.E(x),e.d(this.$.ua.getItemByName(x.SheetName)));var w=n.a.kEc(x);if(w in this.yVa)if(w in this.xVa){x=h.a.aq(this.xVa[w]);w=this.yVa[w];for(let r in w)w[r].style.backgroundColor=`rgba(${x.r},${x.g},${x.b},${this.Ftb})`}else c.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+w);else c.ULS.sendTraceTag(537150425,
0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+w)}Rui(){this.dc.iB(this.JNg,[v.X6],!1,(x,w)=>{if(x&&x.range&&x.sheetId&&w){var r=new k.a(x.range,x.sheetId);r=n.a.kEc(r);r in this.yVa||(this.yVa[r]={});this.yVa[r][x.paneType.toString()]=w;r in this.xVa?(x=this.xVa[r],r=h.a.aq(x),w.style.borderColor=x,w.style.backgroundColor=`rgba(${r.r},${r.g},${r.b},${this.Ftb})`,x=document.createElement("div"),x.className=f.IKh,w.appendChild(x)):c.ULS.sendTraceTag(537150419,
0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r)}else c.ULS.shipAssertTag(537150423,0,!!x,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),c.ULS.shipAssertTag(537150422,0,!x||!!x.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),c.ULS.shipAssertTag(537150421,0,!x||!!x.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),c.ULS.shipAssertTag(537150420,
0,!!w,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})}}v.X6=23;Object(u.a)(v,"RangeVersionHistoryHighlightView",null,[718])},1501:function(u,C,a){a.r(C);var c=a(10),b=a(0),f=a(6),e=a(229),d=a(15),h=a(123),l=a(128),k=a(43);class n extends h.a{constructor(Mb,rc,id,Gd,de){super(Mb,rc);this.executionContext=null;this.retryCount=0;this.raj=ae=>{({HUd:ae}=this.N$j(ae)).returnValue?ae.Success?(l.c(2138207060,!0),d.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):
(l.c(2138207060,!1),d.ULS.sendTraceTag(42287317,0,10,`RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message ${ae.Output}`),this.Wh(this.kL)):(l.c(2138207060,!1),this.Wh(this.kL));(ae=this.executionContext.activityState[n.DDd])&&ae();this.mq();this.executionContext.BN()};this.qaj=()=>{if(0<this.retryCount)d.ULS.sendTraceTag(537150418,0,15,`RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : ${this.retryCount}`),this.retryCount--,this.f8f();
else{d.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");l.c(2138207060,!1);this.Wh(this.kL);var ae=this.executionContext.activityState[n.DDd];ae&&ae();this.mq();this.executionContext.BN()}};this.kL=id;this.k5=Gd;this.baseUrl=de}execute(Mb){this.executionContext=Mb;this.retryCount=3;this.f8f();return 1}f8f(){var Mb=this.executionContext.activityState[n.hyc];const rc=`${this.baseUrl}${"restoreversion.ashx"}`,id={};id.VersionId=this.executionContext.activityState[n.nwg];
id.QuerySignature=Mb;Mb=k.c(id);this.k5.Fn(rc,2,Mb,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.raj,this.qaj,null)}N$j(Mb){let rc;rc=null;Mb=Mb?Mb.data?Mb.data.Fe:null:null;return Mb&&Mb.length?({qt:rc}=k.d(Mb)).returnValue?{returnValue:!0,HUd:rc}:(d.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,HUd:rc}):(d.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),
{returnValue:!1,HUd:rc})}}n.nwg="RVAvi";n.hyc="RVAqs";n.DDd="RVlvrt";Object(b.a)(n,"RestoreVersionActivity",h.a,[]);var v=a(8);class x extends e.a{constructor(Mb,rc,id){super();this.activityName=Mb;this.dL=rc;this.kL=id;this.kc()}create(){this.Pb(new n(this.activityName,this.dL,this.kL,f.AFrameworkApplication.de,f.AFrameworkApplication.sa.Qa.s1))}static la(Mb){Mb.da.Ja(320,new x(v.a.KUd,v.a.Dj,v.a.LUd))}}Object(b.a)(x,"RestoreVersionActivityFactory",e.a,[]);class w extends h.a{constructor(Mb,rc){super(Mb,
rc)}execute(Mb){(0,Mb.activityState[w.Zig])(()=>{this.mq();Mb.BN()});return 1}}w.Zig="RVEAssea";Object(b.a)(w,"RestoreVersionErrorActivity",h.a,[]);class r extends e.a{constructor(Mb,rc){super();this.activityName=Mb;this.dL=rc;this.kc()}create(){this.Pb(new w(this.activityName,this.dL))}static la(Mb){Mb.da.Ja(321,new r(v.a.LUd,v.a.Dj))}}Object(b.a)(r,"RestoreVersionErrorActivityFactory",e.a,[]);var t=a(82),A=a(722),y=a(52),z=a(40),E=a(198),G=a(383),F=a(62);class O{constructor(Mb,rc){this.$=Mb;this.Ujk=
rc}hd(){return f.AFrameworkApplication.fa.ra("IsAnonymousUser")?(d.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1}executeCommand(Mb,rc){d.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Mb=!1;switch(rc.command){case -1112508866:G.a(this.$)&&this.$.da.Ba(423).gFc(!1),Mb=this.Ujk.AZj()}d.ULS.sendTraceTag(537150413,0,50,`VersionHistoryCommandHandler:ExecuteCommand response${Mb}.`);return Mb?F.Task.Ua(Mb):E.a(rc.command)}Tc(Mb,
rc){return-1112508866===rc.command&&this.$.isVersionHistoryEnabled()}ld(){return!1}}Object(b.a)(O,"VersionHistoryCommandHandler",null,[200]);var M=a(2),P=a(264),B=a(178),D=a(480);class I{static addAppPLTEventToLog(Mb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Mb)}catch(rc){}}static setIsPageLoadForFirstTime(Mb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Mb)}catch(rc){}}}Object(b.a)(I,"VersionHistoryLogConnector",null,[]);var S=a(31),
J=a(769),L=a(890),R=a(166),Y=a(91),Q=a(33),W=a(1),Ga=a(49),pa=a(262),aa=a(1022),Z=a(272),fa=a(259),ya=a(13);class Aa{constructor(Mb){this.ey=Mb}Pi(){Z.a(this.ey.$).Lx(this.Ge)||Z.a(this.ey.$).Pi(this)}w$(){Z.a(this.ey.$).Lx(this.Ge)&&Z.a(this.ey.$).aB(this)}get Ge(){return fa.a.kwg}get Lc(){return document.querySelector('[id="vhHeader"]')}get sg(){return!0}hi(Mb){return ya.DOMElementExtensions.lg(this.Lc,Mb)}ek(){this.ey.$.frame.vf.Wk(this.ey.$.frame.vf.iG)}Gk(){}Qg(Mb,rc){rc||this.ey.uUb.then(id=>
{id.enterHeaderFocusTrapZone();return null});return!rc}}Object(b.a)(Aa,"VersionHistoryHeader",null,[29]);class ja{constructor(Mb){this.ey=Mb}Pi(){Z.a(this.ey.$).Lx(this.Ge)||Z.a(this.ey.$).Pi(this)}w$(){Z.a(this.ey.$).Lx(this.Ge)&&Z.a(this.ey.$).aB(this)}get Ge(){return fa.a.lwg}get Lc(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}get sg(){return!0}hi(Mb){return ya.DOMElementExtensions.lg(this.Lc,Mb)}ek(){this.ey.$.frame.vf.Wk(this.ey.$.frame.vf.iG)}Gk(){}Qg(Mb,rc){rc||
this.ey.uUb.then(id=>{id.enterFocusTrapZone();return null});return!rc}}Object(b.a)(ja,"VersionHistoryPane",null,[29]);class za{constructor(Mb){this.ey=Mb}Pi(){Z.a(this.ey.$).Lx(this.Ge)||Z.a(this.ey.$).Pi(this)}w$(){Z.a(this.ey.$).Lx(this.Ge)&&Z.a(this.ey.$).aB(this)}get Ge(){return fa.a.mwg}get Lc(){return document.querySelector('[id="vhViewer"]')}get sg(){return!0}hi(Mb){return ya.DOMElementExtensions.lg(this.Lc,Mb)}ek(){this.ey.$.frame.vf.Wk(this.ey.$.frame.vf.iG)}Gk(){}Qg(Mb,rc){rc||this.ey.uUb.then(id=>
{id.enterViewerFocusTrapZone();return null});return!rc}}Object(b.a)(za,"VersionHistoryViewer",null,[29]);var ra=a(158),fb=a(265),Ua=a(74),Ca=a(529),Ia=a(755);class oa{constructor(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}}Object(b.a)(oa,"AppBootSettings",null,[]);class Da{constructor(){this.rootDiv=this.appBootSettings=null}}Object(b.a)(Da,"AppVersionControllerFactoryParameters",null,[]);class bb{constructor(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=
null}}Object(b.a)(bb,"OnVersionSelectedParams",null,[]);class Za{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=
!1;this.wdDisableSPOFileCache=this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(b.a)(Za,"AppSettings",null,[]);class Xa{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(b.a)(Xa,"ControllerFactoryParameters",null,[]);var Ba;(function(Mb){Mb[Mb.none=0]="none";Mb[Mb.vhUnknown=1]="vhUnknown";Mb[Mb.vhFailedToLoadVersionList=100]="vhFailedToLoadVersionList";Mb[Mb.vhFailedToGetDownloadToken=
101]="vhFailedToGetDownloadToken";Mb[Mb.vhFailedToParseVersionList=102]="vhFailedToParseVersionList";Mb[Mb.vhFetchFailed=103]="vhFetchFailed";Mb[Mb.vhVersioningNotEnabled=104]="vhVersioningNotEnabled";Mb[Mb.vhFileNotFound=105]="vhFileNotFound";Mb[Mb.vhVersionTooOld=106]="vhVersionTooOld";Mb[Mb.vhFetchException=107]="vhFetchException";Mb[Mb.vhServiceUnavailable=108]="vhServiceUnavailable";Mb[Mb.vhBadGateway=109]="vhBadGateway";Mb[Mb.vhUnauthorized=110]="vhUnauthorized";Mb[Mb.vhInternalServerError=
111]="vhInternalServerError";Mb[Mb.vhEmptyVersionMetadatas=112]="vhEmptyVersionMetadatas";Mb[Mb.vhFailedHostDownload=113]="vhFailedHostDownload";Mb[Mb.vhFailedToAddDownloadToVersionStore=114]="vhFailedToAddDownloadToVersionStore";Mb[Mb.vhFailedToCacheParts=115]="vhFailedToCacheParts";Mb[Mb.vhFailedToDownloadVersionMetadata=116]="vhFailedToDownloadVersionMetadata";Mb[Mb.vhFailedToDownloadParts=117]="vhFailedToDownloadParts";Mb[Mb.vhInvalidDocID=118]="vhInvalidDocID";Mb[Mb.vhMissingDocID=119]="vhMissingDocID";
Mb[Mb.vhNullDocID=120]="vhNullDocID";Mb[Mb.vhNullHashedDocID=121]="vhNullHashedDocID";Mb[Mb.vhNullGetDownloadAccessTokenRequest=122]="vhNullGetDownloadAccessTokenRequest";Mb[Mb.vhFailedToDownloadVersionFromHost=123]="vhFailedToDownloadVersionFromHost";Mb[Mb.vhNullResponseFromFetch=124]="vhNullResponseFromFetch";Mb[Mb.vhGetTipVersionException=125]="vhGetTipVersionException";Mb[Mb.vhGetVersionsException=126]="vhGetVersionsException";Mb[Mb.vhGetDownloadTokenException=127]="vhGetDownloadTokenException";
Mb[Mb.vhFetchRetryException=128]="vhFetchRetryException";Mb[Mb.vhNullResponseFromRequestVersionHistory=129]="vhNullResponseFromRequestVersionHistory";Mb[Mb.vhNullResponseFromRequestDownloadToken=130]="vhNullResponseFromRequestDownloadToken";Mb[Mb.vhXhrJsonParseFailed=131]="vhXhrJsonParseFailed";Mb[Mb.vhXhrException=132]="vhXhrException";Mb[Mb.vhNullResponseFromXhr=133]="vhNullResponseFromXhr";Mb[Mb.vhFileGone=134]="vhFileGone";Mb[Mb.vhNullRevisionIDs=135]="vhNullRevisionIDs";Mb[Mb.vhRequestDeleteVersionsException=
136]="vhRequestDeleteVersionsException";Mb[Mb.vhNullResponseFromRequestDeleteVersions=137]="vhNullResponseFromRequestDeleteVersions";Mb[Mb.vhVersionInfoFromTipVersionException=138]="vhVersionInfoFromTipVersionException"})(Ba||(Ba={}));Object(b.b)("VersionHistoryFullAppErrorCode",Ba);var Wa=a(313);class Na{constructor(Mb){this.baseVersionInfo=this.J5=this.Lra=this.fm=this.ewaAccessibilityManager=this.uUb=null;this.iRd=this.eGf=!1;this.gRe=!0;this.dialog=this.accessTokenExpirationManager=this.Uz=this.H4e=
this.$E=this.w8d=this.u8d=this.v8d=null;this.dQf=rc=>{d.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(this.nWj()){var id=de=>{l.c(2138207060,!1);this.fm.setRestoreFailedAtServer(de)};this.$E&&this.$E.startTimer(Na.pog);var Gd=()=>{this.$E.endTimer(Na.pog);this.ZHe(this.$E)};this.fm.setRestoreInProgress();Ga.a(this.$).Ns(new pa.a(v.a.Hx,5,()=>{const de=Ua.a(this.$).Qd.activityState;de[fb.a.xq]=v.a.NKe;de[ra.a.PZ]=!0;de[ra.a.PU]=0;de[n.nwg]=
rc;de[n.hyc]=f.AFrameworkApplication.ej;de[n.DDd]=Gd;de[w.Zig]=id;W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RestoreVersionForConvergenceExcelOnline",!1)&&(de[Wa.a.iwc]=!0)}))}else l.c(2138207060,!1)};this.QSf=rc=>{this.uUb.then(id=>{id.enterFocusTrapZone();return null});d.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");this.$E.endTimer(Na.X3d);this.$E.incrementCounter(Na.llh);d.ULS.sendTraceTag(537150348,0,50,`VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:${this.$E.getTimerDuration(Na.X3d)}`);
this.xCj(rc.containerDiv);rc.versions&&0<rc.versions.length&&(this.H4e=Na.uG(rc.versions[rc.versions.length-1]));this.J5&&this.Lra&&this.tWd(this.J5);d.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=rc=>{d.ULS.sendTraceTag(537150345,0,50,`VersionHistoryPaneActor:OnVersionSelected called. for Version:${Na.uG(rc.currentVersion)}, LastSelected:${Na.uG(this.J5)}`);this.$E.incrementCounter(Na.klh);this.J5=rc.currentVersion;this.baseVersionInfo=rc.baseVersion;
this.eGf=rc.noBaseToCompareTo;this.Lra&&this.fjk()&&(this.tWd(rc.currentVersion),d.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.zKf=rc=>{d.ULS.sendTraceTag(537150337,0,50,`VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:${(null===rc||void 0===rc?0:rc.versionSelected)?Na.uG(rc.versionSelected.currentVersion):null} UpdatedVersionsCount${(null===rc||void 0===rc?0:rc.updatedVersions)?rc.updatedVersions.length:0}, LastSelected:${Na.uG(this.J5)}`);
this.$E.incrementCounter(Na.jlh);if(this.baseVersionInfo){if((null===rc||void 0===rc?0:rc.updatedVersions)&&2<=rc.updatedVersions.length){let id=null,Gd=null;const de=Na.uG(this.J5),ae=Na.uG(this.baseVersionInfo);for(const Ae of rc.updatedVersions)if(rc=Na.uG(Ae),de===rc?id=Ae:ae===rc&&(Gd=Ae),id&&Gd)break;id&&Gd?(this.J5=id,this.baseVersionInfo=Gd,d.ULS.sendTraceTag(537150307,0,50,`VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: ${Na.uG(this.J5)}, RevisionID[N-1]: ${Na.uG(this.baseVersionInfo)}.`),
this.tWd(this.J5)):d.ULS.sendTraceTag(537150306,0,50,`VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: ${de}, RevisionID[N-1]: ${ae}.`)}else d.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");d.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else d.ULS.sendTraceTag(537150336,
0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.xJf=()=>{d.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");this.Hfh();const rc=new Y.a(1470556788,0,this.$.Kc,0,null);this.$.Ia.$b(rc)};this.uQf=rc=>{d.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");let id=new Y.a(-1244760097,0,this.$.Kc,0,null);this.$.Ne.get(51)&&(d.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),
id=new Y.a(-309686558,0,this.$.Kc,0,null));l.c(1604651619,!0);this.$.Ia.$b(id,{["FileDownloadUrl"]:rc})};this.AKf=rc=>{d.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");if(!W.EwaSettings.isChangeGateEnabled("OfficeVSO:6794681_VHDisableDownloadACopy")||this.mWj())rc=new P.QueryStringBuilder(rc),rc.Kj("fn",f.AFrameworkApplication.fileName),d.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+rc.toString().length),8===this.$.frame.fcb(rc.toString(),
!0)?(d.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),l.c(1316171850,!1)):l.c(1316171850,!0)};this.cIf=rc=>{this.fm.setFullAppErrorCode(rc);W.EwaSettings.isChangeGateEnabled("OfficeVSO:6773359_ExcelVersionHistoryErrorHandlingFixes")&&this.fm.setViewerError(!0)};this.kDe=rc=>{const id=document.getElementById(Na.N1e);!id||this.Uz&&!rc||(d.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.Uz=new aa.a(id.contentWindow,
t.a.wL(this.$.xa.VersionHistoryActionUrl)||Ia.a.HK),this.Uz.hl(B.a.KXa,this.ifb),this.Uz.hl(B.a.LXa,this.ifb),this.Uz.hl(B.a.O_,this.ifb),this.Uz.fn(aa.a.setCurrentChangeCount),this.Uz.fn(aa.a.setTotalChangesCount),W.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.Uz.fn(aa.a.wSa),this.Uz.hl(aa.a.setCurrentChangeCount,this.ifb),this.Uz.hl(aa.a.setTotalChangesCount,this.ifb),W.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.Uz.hl(aa.a.wSa,this.ifb))};this.SLf=rc=>{if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6773359_ExcelVersionHistoryErrorHandlingFixes"))rc=Ba[rc]?Ba[rc]:"None";else switch(rc){case 101:rc="VHFailedToGetDownloadToken";break;case 100:rc="VHFailedToLoadVersionList";break;case 104:rc="VHVersioningNotEnabled";break;case 105:rc="VHFileNotFound";break;case 106:rc="VHVersionTooOld";break;default:rc="None"}this.$E.addEvent("OnFullAppError",rc);d.ULS.sendTraceTag(537150291,0,10,`FullApp Error Event: ${rc}`)};
this.MKd=rc=>{this.gRe=rc;d.ULS.sendTraceTag(537150290,0,50,`VersionHistoryPaneActor:Show Changes toggled to:${rc.toString()}`);this.OWd(aa.a.bUb,{["ToggleValue"]:rc})};this.tNf=rc=>{d.ULS.sendTraceTag(50405840,0,50,`VersionHistoryPaneActor:OnIteratorSelected next: ${rc}`);l.c(1488635506,!0);const id={};rc?this.OWd(aa.a.iterateNext,id):this.OWd(aa.a.aAa,id)};this.ifb=rc=>{switch(rc.MessageId){case B.a.KXa:d.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");
W.EwaSettings.ya(370)&&this.fm.setVersionLoadComplete();break;case B.a.LXa:d.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case aa.a.setCurrentChangeCount:rc=rc.Values.count;d.ULS.sendTraceTag(537150288,0,50,`VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : ${rc}`);this.fm.setCurrentChangeCount(rc);break;case aa.a.setTotalChangesCount:rc=rc.Values.count;d.ULS.sendTraceTag(537150287,0,50,`VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : ${rc}`);
this.fm.setTotalChangesCount(rc);break;case aa.a.wSa:this.MKd(this.gRe);break;case B.a.O_:if(!W.EwaSettings.isChangeGateEnabled("OfficeVSO:7402639_ExcelVHAccessTokenExpiredRefreshFix"))break;d.ULS.sendTraceTag(509682466,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession DocumentRefresh");this.X_i();break;default:d.ULS.sendTraceTag(537150286,0,15,`VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:${rc.MessageId}`)}};this.$=Mb;this.lec=this.$.fc+Na.cPh;this.ysh();W.EwaSettings.isChangeGateEnabled("OfficeVSO:7323755_ExcelVersionHistoryTokenRefreshFix")&&
this.$.da.Gb(38,rc=>{this.accessTokenExpirationManager=rc;this.uSa=this.uSa.bind(this);this.accessTokenExpirationManager.dsb(this.uSa)});this.wHb="";this.tBd=0;this.perfTelemetryInfos=[]}uSa(){null!=this.fm&&(this.fm.updateDocId(f.AFrameworkApplication.ej),d.ULS.sendTraceTag(509699330,0,50,"VersionHistoryPaneActor:onTokenRefreshed completed Successfully"))}dispose(){W.EwaSettings.isChangeGateEnabled("OfficeVSO:7323755_ExcelVersionHistoryTokenRefreshFix")&&this.accessTokenExpirationManager.cAc(this.uSa);
this.BJe()}Kjj(){this.$.da.Gb(15,Mb=>{this.ewaAccessibilityManager=Mb;this.ewaAccessibilityManager.mode=2})}ysh(){this.v8d=new ja(this);this.u8d=new Aa(this);this.w8d=new za(this)}AZj(){d.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");f.AFrameworkApplication.GS("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");f.AFrameworkApplication.GS("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
f.AFrameworkApplication.AO("8492a557;72ff4572");this.$E=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.$E.startTimer(Na.oog);if(!this.fm&&(Ca.a(()=>{this.fm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(M.a)(new Xa,{ulsLogger:new D.a,docId:f.AFrameworkApplication.ej,appSettings:Object(M.a)(new Za,{appName:120,userSessionId:f.AFrameworkApplication.userSessionId,wdEnableSaveACopy:!0,wdEnableDownloadTokens:!0,wacCluster:f.AFrameworkApplication.de.pQ,
uiLocale:f.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:W.EwaSettings.ya(281)&&this.$.isEditMode,wdEnableIterator:W.EwaSettings.ya(279),useXhr:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:W.EwaSettings.ya(370),disableSaveACopy:this.WZd(),wdEnableShowVersionChanges:!0,disabledChangeGates:this.$.xa.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:W.EwaSettings.ya(466),isRtl:f.AFrameworkApplication.isRtl,wdExperimentWithIteratorLocation:W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VersionHistoryIteratorInPane",
!1)}),perfTelemetryInfos:this.perfTelemetryInfos}))}),!this.fm))return d.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),l.c(429638140,!1),!1;this.BZj();this.$E.endTimer(Na.oog);this.$E.startTimer(Na.rog);d.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");l.c(429638140,!0);return!0}BZj(){var Mb;this.avj();if(!document.getElementById(this.lec)){const rc=
document.createElement("div");rc.id=this.lec;rc.style.width="100%";rc.style.zIndex="998";rc.style.display="block";rc.style.position="absolute";if(f.AFrameworkApplication.sa.Qa.Pf){const id=(null===(Mb=document.getElementById("HeaderRegion"))||void 0===Mb?void 0:Mb.offsetHeight)||0;rc.style.top=id+"px";rc.style.bottom="0px";rc.style.height=`calc(100vh - ${id}px)`}else rc.style.height="100%";this.$.zq.insertBefore(rc,this.$.zq.firstChild);this.uUb=this.fm.createVersionHistoryDialog(rc)}document.getElementById(this.lec).style.display=
"block";this.ZQd();this.$E.startTimer(Na.X3d);this.fm.getVersions("")}ZQd(){this.v8d.Pi();this.u8d.Pi();this.w8d.Pi();this.Kjj()}i6d(){this.v8d.w$();this.u8d.w$();this.w8d.w$();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}avj(){this.fm.getVersionsReadyEvent().addListener(this.QSf);this.fm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.fm.getCloseSelectedEvent().addListener(this.xJf);this.fm.getFullAppErrorEvent().addListener(this.SLf);this.fm.getIteratorSelectedEvent().addListener(this.tNf);
this.fm.getShowVersionChangesToggledEvent().addListener(this.MKd);this.fm.getDownloadTokenReadyEvent().addListener(this.zKf);this.fm.getSaveACopySelectedEvent().addListener(this.uQf);this.fm.getDownloadVersionSelectedEvent().addListener(this.AKf);W.EwaSettings.ya(281)&&this.$.isEditMode&&(this.fm.getRestoreVersionSelectedEvent().addListener(this.dQf),this.iRd=!0)}bvj(){this.Lra.getAppErrorEvent().addListener(this.cIf)}oj(){this.fm.getVersionsReadyEvent().removeListener(this.QSf);this.fm.getVersionSelectedEvent().removeListener(this.onVersionSelected);
this.fm.getCloseSelectedEvent().removeListener(this.xJf);this.fm.getFullAppErrorEvent().removeListener(this.SLf);this.fm.getIteratorSelectedEvent().removeListener(this.tNf);this.fm.getShowVersionChangesToggledEvent().removeListener(this.MKd);this.fm.getSaveACopySelectedEvent().removeListener(this.uQf);this.fm.getDownloadVersionSelectedEvent().removeListener(this.AKf);this.fm.getDownloadTokenReadyEvent().removeListener(this.zKf);this.iRd&&(this.fm.getRestoreVersionSelectedEvent().removeListener(this.dQf),
this.iRd=!1);this.Lra&&this.Lra.getAppErrorEvent().removeListener(this.cIf)}MTj(){return this.WZd()||!f.AFrameworkApplication.Q_}mWj(){return this.MTj()?(d.ULS.sendTraceTag(520180169,0,15,"VersionHistoryPaneActor:OnDownloadVersion blocked"),l.c(1316171850,!1),!1):!0}nWj(){let Mb=!0;if(!this.$.ea.amIAlone&&!W.EwaSettings.ya(277)){this.bPi();this.fm.setCoauthRestoreError();Mb=!1;const rc=new Y.a(-729359593,0,this.$.Kc,0,null);this.$.Ia.$b(rc)}this.$.mS&&(d.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),
Mb&&(Mb=!1,this.zZj()));return Mb}zZj(){var Mb=Q.a.Od(1,0,1903,1902,0,-1603358883,"RestoreVersionUnsavedChangesError");Mb=this.dialog||new R.ErrorDialog(this.$,Mb);Mb.initialize();Mb.Rg()}fjk(){d.ULS.sendTraceTag(537150343,0,50,`VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion${this.baseVersionInfo?Na.uG(this.baseVersionInfo):""}`);if(Na.uG(this.J5)===this.H4e)return d.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;
if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.eGf)return d.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return d.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;const Mb=Na.B4h(this.baseVersionInfo);d.ULS.sendTraceTag(537150339,0,50,`downloadURL length ${Mb?Mb.length:
0}`);return Mb?!0:(d.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)}WZd(){return!this.$.mna}Hfh(){document.getElementById(this.lec).style.display="none";const Mb=new Y.a(-1423792966,0,this.$.Kc,0,null);this.$.Ia.$b(Mb);this.BJe()}BJe(){this.$E&&(this.$E.endTimer(Na.rog),this.ZHe(this.$E),this.$E=null);this.oj();this.i6d();this.perfTelemetryInfos&&(d.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.map(Mb=>JSON.stringify(Mb)).toString()),
this.perfTelemetryInfos=null);this.Uz&&(this.Uz.X2(B.a.KXa),this.Uz.X2(B.a.LXa),this.Uz.X2(aa.a.setCurrentChangeCount),this.Uz.X2(aa.a.setTotalChangesCount),this.Uz.X2(B.a.O_),W.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.Uz.X2(aa.a.wSa),this.Uz.dispose(),this.Uz=null)}xCj(Mb){try{this.Lra?(I.setIsPageLoadForFirstTime(!1),W.EwaSettings.isChangeGateEnabled("OfficeVSO:6773359_ExcelVersionHistoryErrorHandlingFixes")&&!document.getElementById(Na.N1e)&&
(this.Lra.resetContainer(Mb),this.kDe(!0))):(I.setIsPageLoadForFirstTime(!0),Ca.a(()=>{const rc=new oa;rc.ulsLogger=new D.a;rc.actionUrl=this.$.xa.VersionHistoryActionUrl;rc.hideEmbedFooter=!0;rc.useFetch=!S.a.Px;this.Lra=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(M.a)(new Da,{appBootSettings:rc,rootDiv:Mb}))})),this.bvj()}catch(rc){d.ULS.sendTraceTag(41239239,0,10,`VersionHistoryPaneActor: ResetAppVersionController failed due to exception. ${rc}`)}}tWd(Mb){d.ULS.sendTraceTag(537150298,
0,50,`VersionHistoryPaneActor:SelectVersion called. for Version:${Na.uG(Mb)}, LastSelected:${this.wHb}`);if(Mb)if(Na.uG(Mb).length){var rc=(new Date).getTime();if(Na.uG(Mb)===this.wHb&&1E3>rc-this.tBd)d.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{Na.uG(Mb)!==this.wHb&&(d.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.fm.setTotalChangesCount(-1),this.fm.setCurrentChangeCount(-1));
var id=excelVersionHistory.FactoryGlobal.getTelemetryCollector();id.addEvent("SelectVersion",Na.uG(Mb));try{this.Qlk(id);this.tBd=rc;this.wHb=Na.uG(Mb);const Gd=new bb;Gd.selectedVersionInfo=this.J5;Gd.baseVersionInfo=this.baseVersionInfo;Gd.telemetryCollector=id;this.Lra.onVersionSelectedWithParams(Gd);this.fm&&this.fm.setDisableSaveACopy(this.WZd());this.kDe(!1)}catch(Gd){this.tBd=0,this.wHb="",id.addEvent("Exception",Gd.toString()),d.ULS.sendTraceTag(42016832,0,10,`VersionHistoryPaneActor: OnVersionSelected failed due to exception. ${Gd}`)}finally{d.ULS.sendTraceTag(537150292,
0,50,id?id.getJsonForLogging():"")}}}else d.ULS.sendTraceTag(537150296,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else d.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")}Qlk(Mb){for(const rc of this.perfTelemetryInfos){const id=rc.TelemetryEventKey?rc.TelemetryEventKey:rc.telemetryEventKey?rc.telemetryEventKey:"",Gd=rc.TelemetryEventData?rc.TelemetryEventData:rc.telemetryEventData?rc.telemetryEventData:"";id&&Gd&&
Mb.addEvent(id,Gd)}this.perfTelemetryInfos.length=0}ZHe(Mb){d.ULS.sendTraceTag(42553886,0,15,`VersionHistoryPaneActor:CaptureSessionTelemetry - ${Mb?Mb.getJsonForLogging():""} `)}bPi(){const Mb=this.$.ea.to,rc={};let id=null;for(const Gd of Mb)Gd.UserEmail&&(rc[Gd.UserEmail]=Gd.UserEmail in rc?rc[Gd.UserEmail]+1:1),Gd.User.UserID===this.$.ea.clientId&&(id=Gd.UserEmail);d.ULS.sendTraceTag(42522438,0,10,`VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: ${Mb.length}, TotalAuthorsAsYourself ${id?
rc[id]:-1}`)}X_i(){Ga.a(this.$).Ns(new pa.a(v.a.Hx,5,()=>{const Mb=Ua.a(this.$).Qd.activityState;Mb[fb.a.xq]=v.a.Dj;Mb[Wa.a.iwc]=!0}))}OWd(Mb,rc){d.ULS.sendTraceTag(537150285,0,50,`VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:${Mb}`);if(this.Uz){Mb=new J.a(Mb);Mb.Values[L.a.Swb]=this.$.xa.UserSessionId;if(rc)for(let id in rc)Mb.Values[id]=rc[id];this.Uz.send(Mb)}else d.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")}static uG(Mb){return Mb?
Mb.RevisionID?Mb.RevisionID:Mb.revisionID?Mb.revisionID:"":""}static B4h(Mb){return Mb?Mb.DownloadUrl?Mb.DownloadUrl:Mb.downloadUrl?Mb.downloadUrl:"":""}}Na.cPh="_excelVersionHistoryOverlay";Na.N1e="vhs_frame";Na.oog="TimeTakenShowVersionHistoryDialogAction";Na.rog="TimeTillVersionHistoryDialogWasOpenMs";Na.X3d="TimeTakenGetVersionsToOnVersionsReady";Na.klh="CountOnVersionSelectedCalledinOneVHSession";Na.llh="CountOnVersionsReadyCalledinOneVHSession";Na.jlh="CountOnDownloadTokenReadyCalledinOneVHSession";
Na.pog="TimeTakenVersionRestore";Object(b.a)(Na,"VersionHistoryPaneActor",null,[2]);var ta=a(100),V=a(149),ia=a(36);class X extends A.a{constructor(Mb){super(Mb)}he(){const Mb=this.iOi(),rc=y.GetServiceTaskFactory.Za(this.$.da,21,137,this.La);z.TaskExtensions.za(z.TaskExtensions.ke([Mb,rc],this.ka,3),()=>{var id=rc.result;const Gd=t.a.wL(this.$.xa.VersionHistoryActionUrl);Gd!==Ia.a.HK&&id.QQ(Gd);id=new Na(this.$);this.Pd([new O(this.$,id)])},this.ka,3)}iOi(){return ta.d(V.a.resolve(ia.x,{Wa:this.La}).then(Mb=>
Mb("excelVersionHistory")))}static la(Mb){A.a.ye(304,new X(Mb))}}Object(b.a)(X,"VersionHistoryCommandHandlerFactory",A.a,[]);var la=a(1312),sa=a(725);class Va extends e.a{constructor(Mb){super();this.$=Mb;this.kc()}create(){const Mb=y.GetServiceTaskFactory.Za(this.$.da,211,212,this.La),rc=y.GetServiceTaskFactory.Za(this.$.da,21,137,this.La);z.TaskExtensions.za(z.TaskExtensions.ke([Mb,rc],this.$.ka),()=>{const id=Object(sa.a)(this.$.da,305,()=>new la.a(this.$,!0,rc.result,Mb.result));this.Pb(id)},
this.$.ka,3)}static la(Mb){Mb.da.Ja(306,new Va(Mb))}}Object(b.a)(Va,"VersionHistoryHighlightManagerFactory",e.a,[]);var nb=a(521),ha=a(7),jb=a(176),Fb=a(16);class Rb extends h.a{constructor(Mb,rc,id){super(Mb,rc);this.lineageManager=id}execute(Mb){this.lineageManager.lineageHidePreviousHistory();return super.execute(Mb)}}Object(b.a)(Rb,"LineageClearHistoryConfirmedActivity",h.a,[]);var mb=a(17),sb=a(154);class Ya{constructor(Mb,rc){this.$=Mb;this.lineageManager=rc;Mb=[new mb.a(v.a.jCd,1038647878,
0,0,2244),new mb.a(v.a.idle,1038647878,0,1)];Ua.a(this.$).MQd(new sb.a(v.a.iCd,v.a.idle,Mb),new Rb(v.a.jCd,v.a.idle,rc))}hd(){return!1}executeCommand(Mb,rc,id){Mb=!1;switch(rc.command){case 1834994092:9===rc.yf&&this.d4j();this.aXj(rc,id);Mb=!0;break;case -409942531:this.cXj(),Mb=!0}return Mb?F.Task.Ua(!0):E.a(rc.command)}Tc(Mb,rc){return 1834994092===rc.command||-409942531===rc.command}ld(){return!1}aXj(Mb,rc){d.ULS.sendTraceTag(537155483,0,50,`LineageActivityCommandHandler::ShowChangesCore command location: ${rc.MenuItemId||
Mb.yf}`);this.lineageManager.uig(19===Mb.yf&&!!rc.MenuItemId,rc.MenuItemId,Mb.yf,rc)}d4j(){const Mb=ha.a.zyc;Mb!==jb.a(this.$).pq.Lz&&jb.a(this.$).pq.activateRibbonTab(Mb)}cXj(){Ga.a(this.$).Ns(new pa.a(v.a.iCd,5,()=>{const Mb=Ua.a(this.$).Qd,rc=Q.a.Od(3,1,2241,2242,2243,1038647878,"LineageConfirmClearHistory");rc.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";rc.HelpDescription=Fb.a.instance.ha(1319);Mb.gs([rc])}))}}Object(b.a)(Ya,"LineageActivityCommandHandler",null,[200]);class Ma extends A.a{constructor(Mb){super(Mb)}he(){z.TaskExtensions.za(y.GetServiceTaskFactory.Za(this.$.da,
366,367,this.La),Mb=>{this.Pd([new Ya(this.$,Mb.result)])},this.ka,3)}static la(Mb){A.a.ye(363,new Ma(Mb))}}Object(b.a)(Ma,"LineageActivityCommandHandlerFactory",A.a,[]);var xb=a(426),qb=a(30),Ra=a(84),Jb=a(173),yb=a(114);class Gb{}Object(b.a)(Gb,"LineageClientParams",null,[]);class ub{}Object(b.a)(ub,"LineageFilter",null,[]);var Ja=a(73),zb=a(79),na=a(136),Ea=a(47),ma=a(200),Ka=a(120),cb=a(129),Fa=a(230),wa=a(246),ka=a(20),Oa=a(137),hb=a(58);const Pa=(Mb,rc,id,Gd,de,ae,Ae,Re=null)=>{Re=Mb.Pa(1,Re);
Re.clientParams=rc;Re.lineageFilter=id;return hb.g(Mb,"LineageOpenPaneOrChangeFilter",Re,Gd,de,ae,Ae,0)},ca=(Mb,rc,id,Gd,de,ae,Ae=null)=>{Ae=Mb.Pa(1,Ae);Ae.fetchFromBelow=rc;return hb.g(Mb,"LineageLoadMore",Ae,id,Gd,de,ae,0)},ba=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageRefreshView",ae,rc,id,Gd,de,0)},ib=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageUpdateView",ae,rc,id,Gd,de,0)},Lb=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageClosePane",
ae,rc,id,Gd,de,0)},gc=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageHidePreviousHistory",ae,rc,id,Gd,de,0)},Gc=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageLoadInGridBlueDots",ae,rc,id,Gd,de,0)},Kb=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageGetOriginalBlueDotsUidList",ae,rc,id,Gd,de,4)},pb=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"LineageGetBlueDotsInformation",ae,rc,id,Gd,de,4)},nc=(Mb,rc,id,Gd,de,ae,Ae=null)=>{Ae=Mb.Pa(1,
Ae);Ae.blueDotsReloadHint=rc;return hb.g(Mb,"LineageLoadInGridBlueDotsWithReloadHint",Ae,id,Gd,de,ae,0)};var Wb=a(55),Ha=a(355);class $a{constructor(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}}Object(b.a)($a,"LineageActivitiesResponseDTO",
null,[]);class Nb extends $a{constructor(){super();this.hasNewActivities=!1;this.filterSheetMultiRange=null}}Object(b.a)(Nb,"LineageActivitiesUpdateResponseDTO",$a,[]);class rb{constructor(){this.hasAnyActiveInGridHighlight=this.shouldShowBlueDot=this.onDisplayInGridHighlightsChanged=this.areInGridHighlightsEnabled=this.areInGridHighlightsAvailable=this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=
this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}}Object(b.a)(rb,"LineageAppCallbacks",null,[]);class ec{constructor(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(b.a)(ec,"LineageAuthorDTO",null,[]);class pc{constructor(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}}Object(b.a)(pc,"LineageControllerFactoryParams",
null,[]);class vb{constructor(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}}Object(b.a)(vb,"LineageSharedRangeDTO",null,[]);class ob{constructor(){this.sheetName=this.rangeList=null}}Object(b.a)(ob,"LineageSheetMultiRangeDTO",null,[]);class Tb{constructor(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=
0}}Object(b.a)(Tb,"LineageUserActivityDTO",null,[]);class Rd{constructor(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}}Object(b.a)(Rd,"LineageValueChangeDTO",null,[]);var Jd;(function(Mb){Mb[Mb.default=0]="default";Mb[Mb.D48X48=1]="D48X48";Mb[Mb.D64X64=2]="D64X64";Mb[Mb.D96X96=3]="D96X96";Mb[Mb.D120X120=4]="D120X120";Mb[Mb.D240X240=5]="D240X240";Mb[Mb.D360X360=6]="D360X360";Mb[Mb.D432X432=7]="D432X432";Mb[Mb.D504X504=8]="D504X504";Mb[Mb.D648X648=9]="D648X648"})(Jd||
(Jd={}));Object(b.b)("ProfilePhotoDimension",Jd);const ld=(Mb,rc)=>{let id=[];for(const te of Mb){Mb=te;var Gd=rc,de=Object(M.a),ae=new Tb,Ae=Number.parseLocale(Mb.UserActivity.Id),Re=Mb.Uid,La=Mb.UserActivity.Type;var Hb=Mb.UserActivity.Person;var xc=Gd;if(Hb){var Yc=null;f.AFrameworkApplication.fa.ra("IsUserProfilePictureResolutionEnabled")&&(Yc=xc.wka(Hb.Email,Hb.Provider,f.AFrameworkApplication.ej,Jd.default));Hb=Object(M.a)(new ec,{id:Hb.Id,provider:Hb.Provider,displayName:Hb.DisplayName,email:Hb.Email,
imageUrl:Yc})}else Hb=null;xc=Mb.SheetName;Yc=new Date(Mb.UserActivity.DisplayTimestamp);var xd=Mb.DisplayLocation,Vd=Mb.LineageValueChangeList;var pe=[];for(const af of Vd)Vd=Object(M.a)(new Rd,{hasNewValue:af.HasNewValue,hasOldValue:af.HasOldValue,newValue:af.HasNewValue?af.NewValue:null,oldValue:af.HasOldValue?af.OldValue:null,cellLocation:af.CellLocation}),pe.push(Vd);Vd=Mb.IsBulkEditOverFlow;a:{var re=Mb.UserActivity.LocationList;var $e=Mb.UserActivity.Type;if(!re){d.ULS.sendTraceTag(512259102,
0,15,"LineageManagerUtil:: RangeHighlightLocation.ActivityLocationList is null");$e=null;break a}if(!re.length){d.ULS.sendTraceTag(512259101,0,50,"LineageManagerUtil:: RangeHighlightLocation.ActivityLocationList is empty");$e=null;break a}var qf=[],He=[];let af="";21===$e?He.push(re[0]):He=re;for(const xf of He)switch(xf.Type){case 1:break;case 2:af=xf.SheetName;break;case 0:re=xf;if(!re.RangeList){d.ULS.sendTraceTag(512259099,0,50,"LineageManagerUtil:: RangeHighlightLocation.RangeActivityLocation is null");
break}af=re.RangeList[0].SheetName;He=[];21===$e?He.push(re.RangeList[0]):He=re.RangeList;for(const cg of He)re=Object(M.a)(new vb,{firstCol:cg.FirstColumn,firstRow:cg.FirstRow,lastRow:cg.LastRow,lastCol:cg.LastColumn}),qf.push(re);break;default:d.ULS.sendTraceTag(512259098,0,50,"LineageManagerUtil:: RangeHighlightLocation.ActivityLocationList is of type: ",xf.Type)}$e=Object(M.a)(new ob,{sheetName:af,rangeList:qf})}Gd=(qf=Mb.NestedActivityList)?ld(qf,Gd):null;Mb=de(ae,{activityId:Ae,activityGuid:Re,
activityType:La,author:Hb,sheetName:xc,displayTimestamp:Yc,gridLocation:xd,valueChanges:pe,isBulkEditOverflow:Vd,rangeHighlightLocation:$e,nestedActivityList:Gd,degradedCardTypeBits:Mb.DegradedCardTypeBits});25===Mb.activityType?(de=[],Yd(Mb,de),id=[...id,...de]):id.push(Mb)}return id},Yd=(Mb,rc)=>{25===Mb.activityType?Mb.nestedActivityList.forEach(id=>{id&&Yd(id,rc)}):rc.push(Mb)};class Ke{constructor(Mb,rc,id,Gd,de){this.x6a=this.CE=null;this.GF=this.tAa=0;this.UKb=()=>{this.Y9&&(this.Y9.stop(),
this.Y9=null);this.iSb.start();this.CE.createLineageTaskPane(this.hCd,this.x6a,this.activityGuid)};this.onBlueDotDismissed=()=>{this.CE.onBlueDotDismissed()};this.lineageOpenPaneOrChangeFilterRequest=(ae,Ae)=>{this.iSb.stop();Oa.b(this.$).Ld(na.a.D8i,{});this.G0d();const Re=Object(M.a)(new Gb,{ClientViewCapacity:ae.clientViewCapacity});let La=null;Ae&&(La=Object(M.a)(new ub,{FilterSheetMultiRange:this.e9j(Ae.filterSheetMultiRange)}));const Hb=xc=>{xc=Ka.a.lf(xc.data);d.ULS.sendTraceTag(537155481,
0,50,`LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [${Q.a.Ic(xc)}]`)};this.$.userOperationManager.kd(new ma.a(1010,0,(xc,Yc,xd)=>Pa(this.$.qa.va,Re,La,wa.b(xc,this.Mnd("LineageOpenPaneOrChangeFilter")),wa.a(Yc,Hb),xd,null),80),null)};this.lineageLoadMoreRequest=ae=>{Oa.b(this.$).Ld(na.a.C8i,{});const Ae=Re=>{Re=Ka.a.lf(Re.data);d.ULS.sendTraceTag(537155480,0,50,`LineageManager::LineageLoadMore service call failed. Errors: [${Q.a.Ic(Re)}]`)};this.$.userOperationManager.kd(new ma.a(1011,
0,(Re,La,Hb)=>ca(this.$.qa.va,ae,wa.b(Re,this.Mnd("LineageLoadMore")),wa.a(La,Ae),Hb,null),80),null)};this.lineageRefreshViewRequest=()=>{Oa.b(this.$).Ld(na.a.F8i,{});const ae=Ae=>{Ae=Ka.a.lf(Ae.data);d.ULS.sendTraceTag(537155479,0,50,`LineageManager::LineageRefreshView service call failed. Errors: [${Q.a.Ic(Ae)}]`)};this.$.userOperationManager.kd(new ma.a(1012,0,(Ae,Re,La)=>ba(this.$.qa.va,wa.b(Ae,this.Mnd("LineageRefreshView")),wa.a(Re,ae),La,null),80),null)};this.lineageUpdateViewRequest=()=>{ib(this.$.qa.va,
ae=>{if(ae=Fa.a(ae)?null:ae.Result){var Ae={["CountOfUpdatedActivities"]:ae.LineageActivitiesResponse.ActivityList.length};Oa.b(this.$).Ld(na.a.G8i,Ae);ae=Object(M.a)(new Nb,{activityList:W.EwaSettings.isChangeGateEnabled("OfficeVSO:7124981_HandleFlatteningActivitiesInLineageManager")?ld(ae.LineageActivitiesResponse.ActivityList,this.Cfa):this.yOd(ae.LineageActivitiesResponse.ActivityList),latestActivityId:ae.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:ae.LineageActivitiesResponse.FirstSearchedActivityId,
serverMessageCode:ae.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(ae.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:ae.HasNewActivities,filterSheetMultiRange:this.V8j(ae.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:ae.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:ae.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:ae.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:ae.LineageActivitiesResponse.EolCorrelationId,
eolDateHideHistory:new Date(ae.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:this.yBb(ae.LineageActivitiesResponse.EolPersonHideHistory)});this.CE.onLineageActivitiesUpdateResponse(ae)}else d.ULS.shipAssertTag(537155475,0,!!ae,"LineageManager.LineageUpdateView returned null response.")},ae=>{ae=Ka.a.lf(ae.data);d.ULS.sendTraceTag(537155474,0,50,`LineageManager::LineageUpdateView service call failed. Errors: [${Q.a.Ic(ae)}]`)},null,null)};this.areInGridHighlightsAvailable=()=>
qb.a.mEb(this.$)&&this.blueDotManager&&this.blueDotManager.areInGridHighlightsAvailable();this.areInGridHighlightsEnabled=()=>this.blueDotManager&&this.blueDotManager.areInGridHighlightsEnabled();this.hasAnyActiveInGridHighlight=()=>this.blueDotManager?this.blueDotManager.hasAnyActiveInGridHighlight():!0;this.onDisplayInGridHighlightsChanged=ae=>{this.blueDotManager&&this.blueDotManager.XNj(ae)};this.onCardSelected=(ae,Ae)=>{var Re,La;if(null===(Re=this.blueDotManager)||void 0===Re?0:Re.shouldShowBlueDot(ae.activityGuid))null===
(La=this.blueDotManager)||void 0===La?void 0:La.OLa(ae.activityGuid,1);if(ae=ae.rangeHighlightLocation){if(Ae){if(({range:Re}=Ea.ab(Ae,W.EwaSettings.isChangeGateEnabled("OfficeVSO:7236999_passEwaSheetsInLineageManager")?this.$.ua:null)).returnValue){this.rkf(ae.sheetName,this.HBb([Ea.j(Re)]));return}d.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+Ae+" is not valid.")}ae.rangeList.length?this.rkf(ae.sheetName,ae.rangeList):this.zpi(ae.sheetName)}};this.onLearnMoreLinkClicked=
()=>{const ae=new Y.a(-859308420,zb.a.Vb,this.$.Kc,12,null);this.$.Ia.$b(ae,{[zb.a.Bg]:"HelpID=XLO_LineageTS",["InputMethod"]:zb.a.Vb,[zb.a.rd]:ha.a.fS,["ShouldCanvasTakeFocus"]:!0})};this.onVersionHistoryButtonClicked=ae=>{this.$.Ia.$b(new Y.a(-1112508866,ae,this.$.Kc,12,null))};this.isFeatureEnabled=ae=>{switch(ae){case "FlattenListInLineageManager":return W.EwaSettings.isChangeGateEnabled("OfficeVSO:7124981_HandleFlatteningActivitiesInLineageManager");case "UseLineagePaneContainer":return W.EwaSettings.isChangeGateEnabled("OfficeVSO:7883958_UseLineagePaneContainer");
default:return!1}};this.fg=()=>{const ae=this.$.ea.Pn.LineageVersion;ae!==this.tAa&&(d.ULS.sendTraceTag(537155470,0,50,`LineageManager.OnWorkbookMetadataChanged: lineageVersion: ${ae}, this.lineageVersion: ${this.tAa}`),this.tAa=ae,this.Rsj())};this.zd=(ae,Ae)=>{this.CE&&!this.lineageTaskPane.wFb&&Ae.FG&&(d.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),this.onStaleActivitiesDetected())};this.Tn=()=>{this.CE&&!this.lineageTaskPane.wFb&&(d.ULS.sendTraceTag(587220562,
0,15,"LineageManager::LoadOnDemandOccurred detected."),this.onStaleActivitiesDetected())};this.PE=()=>{const ae=this.a8a();this.CE.onFilterableSheetListChange(ae)};this.JBa=()=>{const ae=this.a8a();this.CE.onFilterableSheetListChange(ae)};this.Mvc=()=>{const ae=this.a8a();this.CE.onFilterableSheetListChange(ae)};this.onPaneClosed=()=>{this.CE.onPaneClosed();Lb(this.$.qa.va,null,ae=>{ae=Ka.a.lf(ae.data);d.ULS.sendTraceTag(537155469,0,50,`LineageManager::OnLineageClosePaneFailed service call failed. Errors: [${Q.a.Ic(ae)}]`)},
null,null)};this.onRangeFilterInputEnabled=ae=>{ae?this.gridView.ga.sx(this.Dd):this.gridView.ga.Ww(this.Dd)};this.Dd=()=>{var ae=Ea.q(this.gridView.ga.pa.activeRange,this.$);ae=Object(M.a)(new ob,{rangeList:this.HBb(ae.Ranges),sheetName:ae.SheetName});this.CE.onSelectedRangeUpdated(ae)};this.tryParseRangeInfo=ae=>{let Ae;if(({sheetName:Ae,range:ae}=Ea.ab(ae,this.$.ua)).returnValue){Ae||(Ae=this.$.ua.na.sheetName);const Re=[];Re.push(ae);ae=Ea.u(Ae,null,Re);return Object(M.a)(new ob,{rangeList:this.HBb(ae.Ranges),
sheetName:ae.SheetName})}return null};this.UA=()=>{const ae=this.GF!==this.$.ea.We;this.CE&&this.lineageTaskPane.isVisible&&ae&&(this.GF=this.$.ea.We,this.CE.onRefreshRequired());this.blueDotManager&&this.blueDotManager.nFb()&&this.blueDotManager.E8i(!this.lineageTaskPane.wFb)};this.$=Mb;rc.Ja(366,this);this.blueDotManager=Gd;this.gridView=ka.h(this.$);this.lineageTaskPane=id;this.hCd=this.lineageTaskPane.vV();this.batchSize=50;this.Y9=de;this.iSb=this.$.nc.hh("UserAction","LineagePaneLoadingShimmerStopWatch");
this.Cfa=Ra.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.mui();this.QSg()}dispose(){this.$vj();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.ZX(this.onPaneClosed),this.lineageTaskPane.eH(this.UA),this.lineageTaskPane=null);this.iSb=this.Cfa=this.x6a=this.hCd=this.CE=null}uig(Mb,rc,id,Gd){this.activityGuid=null;if(this.lineageTaskPane.isVisible){if(9===id){d.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");
return}if(!Mb&&16!==id&&18!==id&&30!==id){this.lineageTaskPane.f9b();return}}qb.a.Sd()||(this.iSb.start(),this.Y9&&(Wb.b().OB(this.iSb.id,this.Y9.id,"actions","actions"),this.Y9.stop(),this.Y9=null));this.lineageTaskPane.wFb||d.ULS.sendTraceTag(537155482,0,50,`LineageManager::ShowLineageTaskPane pane reopened by user via ${Mb?rc:id}`);this.GF=this.$.ea.We;this.x6a=null;Mb?(Mb=Ea.r(this.gridView.ga.pa.selectedRanges,this.$),this.x6a=Object(M.a)(new ob,{rangeList:rc.toString()===ha.a.Ohg?this.HBb(Mb.Ranges):
null,sheetName:Mb.SheetName})):W.EwaSettings.isChangeGateEnabled("OfficeVSO:6883957_InvokeEntryPointForClickingActivityIndicatorTooltip")&&30===id&&this.Mkj(Gd);qb.a.Sd()&&this.lineageTaskPane.wFb?this.lineageTaskPane.tOj(this.UKb):this.CE.createLineageTaskPane(this.hCd,this.x6a,this.activityGuid);this.lineageTaskPane.Dh(!0);this.$.xd(-71295319,-1,0,null)}Mkj(Mb){var rc;if(Mb){var id=Mb.sheetRanges;Mb=Mb.activityGuid;id&&Mb?(null===(rc=this.blueDotManager)||void 0===rc?void 0:rc.OLa(Mb,2),this.activityGuid=
Mb,this.x6a=this.I5h(id)):d.ULS.shipAssertTag(509752709,0,!1,"Blue dot gridLocation/activityGuid is not set.")}else d.ULS.shipAssertTag(509752710,0,!1,"Blue dot unexpected undefined properties for command handling.")}lineageHidePreviousHistory(){const Mb={["paneVisible"]:this.lineageTaskPane.isVisible};Jb.a.sendTelemetryEvent(Object(M.a)(new Ha.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:yb.a.Yh(Mb)}));this.$.userOperationManager.kd(new ma.a(1018,0,(rc,id,Gd)=>gc(this.$.qa.va,
rc,id,Gd,null),64),null);this.lineageTaskPane.isVisible||this.uig(!1,null,4,void 0)}mui(){const Mb=Object(M.a)(new rb,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest,areInGridHighlightsAvailable:this.areInGridHighlightsAvailable,areInGridHighlightsEnabled:this.areInGridHighlightsEnabled,hasAnyActiveInGridHighlight:this.hasAnyActiveInGridHighlight,onDisplayInGridHighlightsChanged:this.onDisplayInGridHighlightsChanged,shouldShowBlueDot:rc=>{var id,Gd;return null!==(Gd=null===(id=this.blueDotManager)||void 0===id?void 0:id.shouldShowBlueDot(rc))&&void 0!==
Gd?Gd:!1}});Ca.a(()=>{this.CE=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(M.a)(new pc,{clientBatchSize:this.batchSize,filterableSheetList:this.a8a(),uiCulture:this.$.xa.UICultureTag,dataCulture:this.$.xa.DataCultureTag,logger:new D.a,lineageAppCallbacks:Mb}))})}I5h(Mb){const rc=[],id=this.$.ua.na;for(const Gd of Mb)Gd.sheetId===id.sheetId&&(Mb=Ea.j(Gd.range),Mb=Object(M.a)(new vb,{firstCol:Mb.FirstColumn,firstRow:Mb.FirstRow,lastCol:Mb.LastColumn,lastRow:Mb.LastRow}),
rc.push(Mb));return Object(M.a)(new ob,{rangeList:rc,sheetName:id.sheetName})}Mnd(Mb){return rc=>{if(rc=Fa.a(rc)?null:rc.Result){var id={["CountOfActivities"]:rc.ActivityList.length};id.WebRequestName=Mb;Oa.b(this.$).Ld(na.a.h6i,id);rc=Object(M.a)(new $a,{activityList:W.EwaSettings.isChangeGateEnabled("OfficeVSO:7124981_HandleFlatteningActivitiesInLineageManager")?ld(rc.ActivityList,this.Cfa):this.yOd(rc.ActivityList),latestActivityId:rc.LastSearchedActivityId,oldestActivityId:rc.FirstSearchedActivityId,
serverMessageCode:rc.LineageResponseCode,lastSearchedActivityTimestamp:new Date(rc.EcmaLastSearchedDate),serverFirstActivityId:rc.ServerFirstActivityId,serverLastActivityId:rc.ServerLastActivityId,showLoadPrevious:rc.ShowLoadPrevious,eolCorrelationId:rc.EolCorrelationId,eolDateHideHistory:new Date(rc.EolDateHideHistory),eolPersonHideHistory:this.yBb(rc.EolPersonHideHistory)});this.CE.onLineageActivitiesResponse(rc)}else d.ULS.shipAssertTag(537155477,0,!!rc,"LineageManager."+Mb+" returned null response.")}}V8j(Mb){return cb.e(Mb.Ranges)&&
!Mb.SheetName?null:Object(M.a)(new ob,{rangeList:this.HBb(Mb.Ranges),sheetName:Mb.SheetName})}HBb(Mb){const rc=[];for(const id of Mb)Mb=Object(M.a)(new vb,{firstCol:id.FirstColumn,firstRow:id.FirstRow,lastRow:id.LastRow,lastCol:id.LastColumn}),rc.push(Mb);return rc}e9j(Mb){if(!Mb)return null;const rc={};rc.Ranges=this.Kod(Mb.rangeList);rc.SheetName=Mb.sheetName;return rc}Kod(Mb){const rc=[];if(cb.e(Mb))return rc;for(const id of Mb)Mb={},Mb.FirstColumn=id.firstCol,Mb.FirstRow=id.firstRow,Mb.LastRow=
id.lastRow,Mb.LastColumn=id.lastCol,rc.push(Mb);return rc}zpi(Mb){(Mb=this.$.ua.getItemByName(Mb))&&Mb.visible&&Mb.activate(!0)}rkf(Mb,rc){const id=[];for(var Gd of rc)rc={},rc.FirstColumn=Gd.firstCol,rc.FirstRow=Gd.firstRow,rc.LastRow=Gd.lastRow,rc.LastColumn=Gd.lastCol,id.push(Ea.E(rc));Gd=id.length-1;rc=id[Gd].topLeft;ka.h(this.$).z0(id,Gd,Mb,null,rc,null,null,3,"LineageManager.OnCardSelected",void 0,void 0,void 0,!0)}Rsj(){this.CE&&this.lineageTaskPane.isVisible&&(this.GF=this.$.ea.We,this.CE.onRefreshRequired())}QSg(){var Mb;
this.lineageTaskPane.XU(this.onPaneClosed);this.lineageTaskPane.LF(this.UA);this.$.ea.nv(this.fg);this.$.ea.pk(this.zd);this.$.ea.DK(this.Tn);const rc=this.$.ua;rc.UZ(this.PE);rc.eja(this.Mvc);rc.YIa(this.JBa);rc.l1a(this.Mvc);null===(Mb=this.blueDotManager)||void 0===Mb?void 0:Mb.Lxe(this.onBlueDotDismissed)}$vj(){var Mb;this.$.ea.Xw(this.fg);this.gridView.ga.Ww(this.Dd);this.$.ea.Kk(this.zd);this.$.ea.rP(this.Tn);const rc=this.$.ua;rc.u9(this.PE);rc.Epa(this.Mvc);rc.XTa(this.JBa);rc.AOb(this.Mvc);
null===(Mb=this.blueDotManager)||void 0===Mb?void 0:Mb.o4f(this.onBlueDotDismissed)}onStaleActivitiesDetected(){this.CE.onStaleActivitiesDetected()}a8a(){const Mb=this.$.ua.items,rc=[];for(const id of Mb)id.visible&&!Ja.e(id)&&rc.push(id.sheetName);return rc}G0d(){var Mb=this.$.da.Ba(403);Mb&&Mb.disable();Mb=new Y.a(-847286761,zb.a.Vb,this.$.Kc,0,ha.a.U1);this.$.Ia.$b(Mb,{["InputMethod"]:zb.a.Vb,CalloutName:5})}yOd(Mb){const rc=[];for(const id of Mb)Mb=Object(M.a)(new Tb,{activityId:Number.parseLocale(id.UserActivity.Id),
activityGuid:id.Uid,activityType:id.UserActivity.Type,author:this.yBb(id.UserActivity.Person),sheetName:id.SheetName,displayTimestamp:new Date(id.UserActivity.DisplayTimestamp),gridLocation:id.DisplayLocation,valueChanges:this.Rmj(id.LineageValueChangeList),isBulkEditOverflow:id.IsBulkEditOverFlow,rangeHighlightLocation:this.Emj(id.UserActivity.LocationList,id.UserActivity.Type),nestedActivityList:this.xmj(id.NestedActivityList),degradedCardTypeBits:id.DegradedCardTypeBits}),rc.push(Mb);return rc}Emj(Mb,
rc){if(!Mb)return d.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Mb.length)return d.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;const id=[];var Gd=[];let de="";21===rc?Gd.push(Mb[0]):Gd=Mb;for(const ae of Gd)switch(ae.Type){case 1:break;case 2:de=ae.SheetName;break;case 0:Mb=ae;if(!Mb.RangeList){d.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");
break}de=Mb.RangeList[0].SheetName;Gd=[];21===rc?Gd.push(Mb.RangeList[0]):Gd=Mb.RangeList;for(const Ae of Gd)Mb=Object(M.a)(new vb,{firstCol:Ae.FirstColumn,firstRow:Ae.FirstRow,lastRow:Ae.LastRow,lastCol:Ae.LastColumn}),id.push(Mb);break;default:d.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ")}return Object(M.a)(new ob,{sheetName:de,rangeList:id})}Rmj(Mb){const rc=[];for(const id of Mb)Mb=Object(M.a)(new Rd,{hasNewValue:id.HasNewValue,
hasOldValue:id.HasOldValue,newValue:id.HasNewValue?id.NewValue:null,oldValue:id.HasOldValue?id.OldValue:null,cellLocation:id.CellLocation}),rc.push(Mb);return rc}xmj(Mb){return Mb?this.yOd(Mb):null}yBb(Mb){if(!Mb)return null;let rc=null;f.AFrameworkApplication.fa.ra("IsUserProfilePictureResolutionEnabled")&&(rc=this.Cfa.wka(Mb.Email,Mb.Provider,f.AFrameworkApplication.ej,0));return Object(M.a)(new ec,{id:Mb.Id,provider:Mb.Provider,displayName:Mb.DisplayName,email:Mb.Email,imageUrl:rc})}}Object(b.a)(Ke,
"LineageManager",null,[804,2]);class Bb extends e.a{constructor(Mb){super();this.Y9=this.lineageTaskPane=null;this.$=Mb;this.kc()}Syf(Mb,rc){z.TaskExtensions.za(Mb,()=>{this.Pb(this.$.da.Ba(366)||new Ke(this.$,this.$.da,this.lineageTaskPane,rc,this.Y9))},this.$.ka,3)}create(){this.Y9=this.$.nc.qd("UserAction","LineagePaneSeenStopwatch");this.Y9.start();const Mb=y.GetServiceTaskFactory.Za(this.$.da,365,364,this.La),rc=xb.a(this.$);let id=ta.d(V.a.resolve(ia.y,{Wa:this.La}));if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",
!1)){const Gd=y.GetServiceTaskFactory.Za(this.$.da,501,500,0);z.TaskExtensions.za(z.TaskExtensions.ke([Mb,rc,id,Gd],this.$.ka),()=>{this.lineageTaskPane=Mb.result;qb.a.Sd()||rc.result.kS(this.lineageTaskPane);this.Syf(ta.d(id.result.eu.loadScript("cellLineage")),Gd.result)},this.$.ka,3)}else z.TaskExtensions.za(z.TaskExtensions.ke([Mb,rc,id],this.$.ka),()=>{this.lineageTaskPane=Mb.result;qb.a.Sd()||rc.result.kS(this.lineageTaskPane);this.Syf(ta.d(id.result.eu.loadScript("cellLineage")),null)},this.$.ka,
3)}static la(Mb){Mb.da.Ja(367,new Bb(Mb))}}Object(b.a)(Bb,"LineageManagerFactory",e.a,[]);var Ob=a(825),ed=a(231),Sd=a(14),Pd=a(113),ic=a(273),Kc=a(90),dc=a(247),Hc=a(19),Uc=a(732);const Fd=ha.a.y3d+"LineageActivityPaneTitle",Td=ha.a.ATb+"LineageActivityCloseButton";class ad extends dc.a{constructor(Mb,rc,id){super(Mb);this.UKb=this.EKe=this.ff=null;this.Yxd=!0;this.dx=0;this.Zt=!1;this.Xc=(Gd,de)=>{de.mg||this.f9b()};this.$l=()=>{this.f9b();return!0};this.$=rc;this.taskPaneManager=id;this.$.Xj(this.Xc);
Z.a(this.$).Pi(this);qb.a.Sd()&&(this.isVisible=!1)}YU(Mb){this.get_events().addHandler("LineageTaskPaneRemove",Mb)}$X(Mb){this.get_events().removeHandler("LineageTaskPaneRemove",Mb)}LF(Mb){this.addHandler("LineageTaskPaneVisibilityChanged",Mb)}eH(Mb){this.removeHandler("LineageTaskPaneVisibilityChanged",Mb)}XU(Mb){this.get_events().addHandler("LineageTaskPaneClose",Mb)}ZX(Mb){this.get_events().removeHandler("LineageTaskPaneClose",Mb)}get isVisible(){return super.isVisible}set isVisible(Mb){super.isVisible!==
Mb&&(super.isVisible=Mb,this.raiseEvent("LineageTaskPaneVisibilityChanged"))}get wFb(){return this.Yxd}get sg(){return this.isVisible}get yi(){return 15}get Ge(){return fa.a.jNi}get vl(){return Hc.a.hMh}get iS(){return Fb.a.instance.ha(1077)}get Wq(){return 300}get isResizable(){return!1}get Lc(){return this.domElement}get height(){return this.taskPaneManager.YP.offsetHeight}get titleText(){return Fb.a.instance.ha(1294)}get pB(){return this.taskPaneManager.Bxa(this.Lc,this.titleText,this.Wq,this.isResizable,
()=>{this.isVisible=!0;this.UKb?this.UKb():d.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},()=>{this.isVisible=!1;this.f9b()},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Wq)}Jr(){return this.Zt}Mu(){return this.Zt}zX(){}EW(){return!1}ek(){}Gk(){}dispose(){this.$&&(this.$.Ll(this.Xc),Z.a(this.$).aB(this));this.ff&&(ed.a.instance.Aa(Sd.a.click,this.ff,this.$l),Pd.KeyInputManager.instance.ty(this.ff,this.EKe));this.ff=this.taskPaneManager=this.$=null;super.dispose()}Qg(Mb,
rc){if(!rc){Mb=ya.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!Mb)return!1;ya.DOMElementExtensions.setFocus(Mb)}return!rc}hi(Mb){return ya.DOMElementExtensions.lg(this.Lc,Mb)}Dh(Mb){this.Zt=Mb;const rc=this.taskPaneManager;if(this.isVisible=Mb)this.$.frame.vf.kk("LineagePane"),this.Yxd=!1;if(qb.a.Sd())Mb?rc.T8("LineageTaskPane",this.pB):rc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.fD();const id=!!this.taskPaneManager.si&&15===this.taskPaneManager.si.taskPane.yi;
Mb&&0<rc.gF.length&&(!id||rc.isCollapsed)&&rc.JJ(this,!0)}this.$.Wf()}vV(){var Mb=this.$.fc;Mb=qb.a.Sd()?this.domElement:document.getElementById(Mb+ha.a.mCd);if(!qb.a.Sd()||!W.EwaSettings.isChangeGateEnabled("OfficeVSO:7858326_TaskPaneReactHeader")){var rc=this.FN();Mb.appendChild(rc)}rc=Uc.b("div","LineagePaneBodyId","LineageActivityBody");Mb.appendChild(rc);this.uOj();return rc}f9b(){this.$.frame.vf.kk(this.$.frame.vf.iG||ic.AFrame.bV);this.Yxd=!0;this.Dh(!1);this.raiseEvent("LineageTaskPaneClose")}tOj(Mb){this.UKb=
Mb}uOj(){this.$.frame.vf.Wk("LineagePane");const Mb=this.$.frame.vf.hj("LineagePane");Mb.parent=ic.AFrame.bV;Mb.yO=!0}FN(){const Mb=Uc.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),rc=Uc.b("h1","LineagePaneTitleId",Fd);rc.innerText=this.titleText;this.ff=Ob.a.Kb("LineagePaneCloseButtonId",Td,Fb.a.instance.ha(10),"ClosePaneGlyph_16x16x32",!1);this.ff.classList.add(f.AFrameworkApplication.isRtl?ha.a.vla:ha.a.wla);ed.a.instance.ta(Sd.a.click,this.ff,this.$l);this.EKe=Pd.KeyInputManager.instance.Tu(this.ff,
this.$l,Kc.a.Ai);Mb.appendChild(rc);Mb.appendChild(this.ff);return Mb}static la(Mb,rc){const id=Mb.fc;let Gd=document.getElementById(id+ha.a.mCd);Gd||(Gd=document.createElement("div"),Gd.id=Mb.fc+ha.a.mCd,Gd.classList.add("LineageActivityPane"),qb.a.Sd()||document.getElementById(id+ha.a.uX).appendChild(Gd));return Mb.da.Ba(365)||Mb.da.Ja(365,new ad(Gd,Mb,rc))}}Object(b.a)(ad,"LineageTaskPane",dc.a,[716,2,483,29]);class Qd extends e.a{constructor(Mb){super();this.Uh=this.aj=null;this.$=Mb;this.kc()}get TE(){this.aj||
(this.aj=z.TaskExtensions.za(xb.a(this.$),Mb=>{this.Uh=ad.la(this.$,Mb.result)},this.ka,3));return this.aj}create(){const Mb=y.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.La),rc=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(ta.d)(V.a.resolve(ia.p,{Wa:this.La})):y.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La);z.TaskExtensions.za(z.TaskExtensions.ts(z.TaskExtensions.ke([Mb,rc],this.ka),()=>this.TE,this.ka),()=>{this.Pb(this.Uh)},
this.ka,3)}dispose(){this.Uh=this.aj=this.$=null;super.dispose()}static la(Mb){Mb.da.Ja(364,new Qd(Mb))}}Object(b.a)(Qd,"LineageTaskPaneFactory",e.a,[]);var Zb=a(912),Wc=a(85);class md{constructor(Mb,rc){this.lh=Mb;this.iw=rc}qY(Mb,rc,id,Gd=null){return this.Czh(Mb,Gd,de=>this.lh.Orb(de,2,id,rc,void 0,void 0,void 0,void 0,void 0,"2"))}Czh(Mb,rc,id){const Gd=!!rc&&""!==rc;let de=Mb;Gd&&(de=t.a.UU(Mb,"perfTag",rc));const ae=new Date;return Zb.a.then(id(de),Ae=>{const Re=+new Date-+ae;if(!Ae||!Ae.Ph||
!Ae.Ph.data)return Ae;Gd&&Ae.Ph.data.request&&this.YJj(Ae.Ph.data.request.getResolvedUrl(),rc,Re);return Ae})}YJj(Mb,rc,id){Mb=this.iw.Vci(Mb);if(Mb.count&&(Mb=Wc.last(Mb))){const Gd={Message:"Request durations for activities calls."};Gd.PerfTag=rc;Gd.CustomDuration=id;Gd.PerformanceDuration=Mb.duration;d.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Gd))}}}Object(b.a)(md,"CatchUpNetworkingWrapper",null,[715]);var Nd=a(254);class kd extends Nd.a{constructor(Mb,rc){super(Mb,rc)}hda(){return 6}}
Object(b.a)(kd,"GetActivityFeedRequest",Nd.a,[]);class yd extends Nd.a{constructor(Mb,rc,id,Gd,de,ae){super(Mb,rc);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=id;this.ActivityStatesToSet=Gd;this.ActivityStatesToReset=de;this.ResetUnseenCount=ae}hda(){return 7}}Object(b.a)(yd,"UpdateActivityFeedStateRequest",Nd.a,[]);var lc=a(249),Lc=a(394);class nd{constructor(Mb,rc,id){this.fme=Mb;this.FFa=rc;this.XFa=id}getActivityFeed(Mb){return Zb.a.then(this.XFa.execute(new kd(this.FFa(),
null),(rc,id,Gd)=>this.fme.qY(rc,id,Gd,"ActivityFeed"),Mb),rc=>{if(!rc)return d.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!rc.Ph)return d.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;rc=rc.Ph.data;if(!rc)return d.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(rc.httpStatus!==lc.a.hK)return d.ULS.sendTraceTag(508929507,3012,10,"GetActivityFeed: Response status code {0}",rc.httpStatus),
null;if(!rc.Fe)return d.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;rc=Lc.a.CLa(rc.Fe);return rc?rc:(d.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}Jck(Mb,rc,id,Gd){return Zb.a.then(this.XFa.execute(new yd(this.FFa(),null,Mb,rc,id,Gd),(de,ae,Ae)=>this.fme.qY(de,ae,Ae,"UpdateActivityFeedState"),null),de=>{try{return de.succeeded}catch(ae){return d.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception {0}",
ae.message),!1}})}}Object(b.a)(nd,"CatchUpRequestHandler",null,[714]);var Wd=a(474);class $d{constructor(Mb){this.Cia=Mb;this.Rke=new Wd.a}aPi(){this.RPi()}RPi(){if(this.Cia){var Mb=rc=>{this.Rke.contains("CatchUpChangesFeedback")||(this.Rke.add("CatchUpChangesFeedback"),rc.logActivity("CatchUpChangesFeedback",null))};this.Cia.execute(rc=>{window.setTimeout(()=>{Mb(rc)},2E4)})}else d.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(b.a)($d,
"FloodgateEventLogger",null,[]);var se=a(199);class je{constructor(Mb){this.MLg=Mb}get duration(){return this.MLg.duration}}Object(b.a)(je,"PerformanceResourceTimingWrapper",null,[]);class Le{constructor(Mb){this.iw=Mb}Vci(Mb){const rc=new se.a;if(!this.iw)return rc;Mb=this.iw.getEntriesByName(Mb,"resource");if(!Mb)return rc;for(const id of Mb)rc.add(new je(id));return rc}}Object(b.a)(Le,"PerformanceWrapper",null,[]);var oe=a(260);class ue{constructor(){this.Db=null}get name(){return"Common.App.CatchUpActivity"}Di(Mb){this.Db=
Mb;this.Db.register(md,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Uc().dd(()=>new md(f.AFrameworkApplication.de,new Le(window.performance)));this.Db.register(nd,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Uc().dd(()=>new nd(this.Db.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>f.AFrameworkApplication.ej,new Lc.a));this.Db.register($d,"Common.App.CatchUpActivity.FloodgateEventLogger").Uc().dd(()=>
new $d(this.Db.qc("Common.ISystemInitiatedFeedback")))}init(){this.Db.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Db.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){oe.a.instance.nj(new ue)}}Object(b.a)(ue,"CatchUpActivityPackage",null,[4,5]);class df{constructor(Mb,rc){this.$=Mb;this.catchUpActivityManager=rc}hd(Mb,rc){return this.catchUpActivityManager?-876699925===rc?!this.catchUpActivityManager.Oof:!1:!0}executeCommand(Mb,rc,id){Mb=
!1;switch(rc.command){case -876699925:Mb=this.catchUpActivityManager.Zcj();break;case 950288339:return this.catchUpActivityManager.nFb()?(rc=id.LineageTaskPaneVisible,void 0!==rc?this.catchUpActivityManager.bfk(rc):this.catchUpActivityManager.showHideInGridHighlights()):this.catchUpActivityManager.showHideInGridHighlights(),F.Task.Ua(!0)}return Mb?F.Task.Ua(!0):E.a(rc.command)}Tc(Mb,rc){return W.EwaSettings.ya(382)?-876699925===rc.command||950288339===rc.command:!1}ld(){return!1}}Object(b.a)(df,"CatchUpActivityCommandHandler",
null,[200]);class Se extends A.a{constructor(Mb){super(Mb)}he(){this.$.da.Gb(286,Mb=>{this.Pd([new df(this.$,Mb)])})}static la(Mb){A.a.ye(285,new Se(Mb))}}Object(b.a)(Se,"CatchUpActivityCommandHandlerFactory",A.a,[]);var bf=a(119),Ye=a(234),gf=a(528),nf=a(92),oc=a(126),Ac=a(26);class xa{constructor(Mb){this.Ci=Mb}doesContentExist(Mb){if(!Mb)return d.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(Mb.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Mb.navigationId)return d.ULS.sendTraceTag(537168065,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const rc={};rc.NavigationId=atob(Mb.navigationId);return 32===this.Ci.Be(Ac.a.ULa,2,rc);default:return!1}}}Object(b.a)(xa,"CatchUpActivityContentManager",null,[704]);var Cb=a(860),bc=a(1288);class Fc{constructor(Mb){this.OKb=()=>{switch(this.Nw.model.state){case 1:this.Hig(!0);break;case 0:this.tSb(!1);break;case 2:case 3:this.tSb(!0);break;default:d.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
this.Nw.model.state)}};this.WHg=Mb;this.Nw.vxe(this.OKb);this.qz=[]}get Nw(){return this.WHg}dispose(){this.Nw.b4f(this.OKb);this.qz=null}NNj(Mb){this.qz.push(Mb)}Keh(){this.qz.length=0}Hig(Mb){for(const rc of this.qz){rc.className=Cb.a.Abh;const id=document.getElementById(`${rc.id}-${ha.a.dIe}`);ya.DOMElementExtensions.setVisible(id,Mb)}}tSb(Mb){for(const rc of this.qz)rc&&(Mb?rc.className=2===this.Nw.model.state?Cb.a.Ppj:Cb.a.Qpj:this.Hig(!1))}}Object(b.a)(Fc,"RangeCatchUpActivityView",null,[749,
2]);var Tc=a(23);class gd extends bc.a{constructor(Mb,rc,id){super(Mb,rc,id);this.gridView=ka.h(Mb);this.qpa=rc}dispose(){this.gridView=null;super.dispose()}tVg(Mb){const rc=this.wkb[0];rc?rc.NNj(Mb):d.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.qpa.activityId)}hDj(){const Mb=this.wkb[0];Mb&&Mb.Keh()}CTg(Mb){this.qpa.addRange(Mb)}v2h(){if(3!==this.qpa.activityType)return null;d.ULS.shipAssertTag(537168003,
0,1===this.qpa.QSb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Ea.E(this.qpa.QSb[0])}nWd(Mb){if(Mb){if(!this.qpa)return;this.yGd(this.lEj())}super.nWd(Mb)}Kbd(){const Mb=this.pbd();this.wkb.push(Mb)}pbd(){return new Fc(this)}yGd(Mb){Mb?Mb.SheetName?(this.gridView.ga.Sa.uI(null),this.gridView.focus(),this.gridView.Egf(Mb,3,!1,"RangeCatchUpActivityHighlightController.NavigateToRange")):d.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
d.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")}lEj(){if(cb.e(this.qpa.QSb))return d.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var Mb=this.$.ua.na;d.ULS.shipAssertTag(537167970,0,!!Mb,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
Mb=this.u$j(Mb.sheetName,this.qpa.QSb);if(!Mb&&(Mb=this.Qhi(this.qpa.QSb),!Mb))return null;const rc={};rc.SheetName=Mb.SheetName;rc.FirstColumn=Mb.FirstColumn;rc.FirstRow=Mb.FirstRow;rc.LastColumn=Mb.FirstColumn;rc.LastRow=Mb.FirstRow;return rc}Qhi(Mb){if(cb.e(Mb))return null;let rc=null;for(let Gd=0;Gd<Mb.length;Gd++){var id=Mb[Gd].SheetName;if(!Tc.a.equals(id,rc,!1)&&(rc=id,id=this.$.ua.getItemByName(id),null===id||void 0===id?0:id.visible))return Mb[Gd]}return null}u$j(Mb,rc){if(rc)for(const id of rc)if(Tc.a.equals(id.SheetName,
Mb,!1))return id;return null}}Object(b.a)(gd,"RangeCatchUpActivityHighlightController",bc.a,[]);var td=a(86);class kb extends td.a{constructor(Mb,rc,id,Gd,de,ae){super();this.$=Mb;this.gae=rc;this.qCg=id;this.dI=Gd;W.EwaSettings.isChangeGateEnabled("OfficeVSO:7809002_CatchUpActivityHoverStateFix")&&de&&ae?this.state=2:this.state=de?1:0}get type(){return this.dI}get activityId(){return this.gae}get activityType(){return this.qCg}dispose(){this.gae=null;super.dispose()}}Object(b.a)(kb,"CatchUpActivityHighlightModelBase",
td.a,[]);class Vb extends kb{constructor(Mb,rc,id,Gd,de,ae,Ae){super(Mb,rc,id,Gd,ae,Ae);this.ranges=de;this.lab=!1}get QSb(){this.lab||(this.ranges.sort(Vb.z9b),this.lab=!0);return this.ranges}addRange(Mb){for(const rc of Mb)this.ranges.push(rc)}dispose(){this.ranges=null;super.dispose()}static z9b(Mb,rc){if(!Mb.SheetName||!rc.SheetName)return d.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;const id=Mb.SheetName.localeCompare(rc.SheetName);
return id?id:Mb.FirstColumn<rc.FirstColumn||Mb.FirstColumn===rc.FirstColumn&&Mb.FirstRow<rc.FirstRow?-1:Mb.FirstColumn===rc.FirstColumn&&Mb.FirstRow===rc.FirstRow?0:1}}Object(b.a)(Vb,"RangeCatchUpActivityHighlightModel",kb,[]);var qc=a(354);class Bc{constructor(){this.D9b=[];this.Ahb={};this.Y0c={};this.xmc=W.EwaSettings.isChangeGateEnabled("OfficeVSO:7795308_EnableCatchupHighlightLogging")}dispose(){this.Y0c=this.Ahb=this.D9b=null}o5f(Mb,rc){rc?ka.h(Mb).dc.Ur([24]):ka.h(Mb).dc.Hk([24]);this.xmc&&
d.ULS.sendTraceTag(508933385,0,50,`CatchUpHighlightControllersCreator:renderAllCatchUpRangeHighlights with setVisible=${rc}.`)}vvj(Mb){this.jPe(Mb,[new qc.a(null,null)],this.Ahb,!1);this.xmc&&d.ULS.sendTraceTag(508933384,0,50,"In CatchUpHighlightControllersCreator:removeAllCatchUpRangeHighlights().")}anh(Mb,rc,id,Gd){var de;const ae={};for(const Re of rc){if(!Re||cb.e(Re.LocationList))continue;rc=[];const La={},Hb=[];for(const xc of Re.LocationList){if(!xc){d.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+
Re.Id);break}switch(xc.Type){case 0:var Ae=xc;let Yc;"0"in La?(Yc=La["0"],Yc.CTg(Ae.RangeList)):(Yc=new gd(Mb,new Vb(Mb,Re.Id,Re.Type,0,Ae.RangeList,Gd,id.UCi(Re.Id)),id),rc.push(Yc),La["0"]=Yc);for(const xd of Ae.RangeList){Ae=new qc.a(Ea.E(xd),Ja.d(Mb.ua.getItemByName(xd.SheetName)));if(this.jEc(Ae)in this.Ahb)this.Ahb[this.jEc(Ae)].push(Yc);else{let Vd=[];Vd.push(Yc);this.Ahb[this.jEc(Ae)]=Vd}Hb.push(Ae);this.D9b.push(Ae)}break;default:d.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}d.ULS.shipAssertTag(537168011,
0,!(Re.Id in ae),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Re.Id);this.Y0c[Re.Id]=Hb;ae[Re.Id]=rc}this.jPe(Mb,this.D9b,this.Ahb,Gd);this.xmc&&d.ULS.sendTraceTag(508933383,0,50,`CatchUpHighlightControllersCreator:createControllersAndHighlights, length of completeSheetRangeList is ${null===(de=this.D9b)||void 0===de?void 0:de.length}.`);return ae}QBb(Mb){return this.Y0c[Mb]}Deh(Mb){for(let rc in Mb){const id=Mb[rc];for(const Gd of id)Gd.hDj()}}jEc(Mb){return`${Mb.range}-${Mb.sheetId}`}jPe(Mb,
rc,id,Gd){this.Deh(id);ka.h(Mb).dc.iB(rc,[24],Gd,(de,ae)=>{if(null==de.range){for(var Ae of de.$Z)Ae.dispose();de.$Z=[]}else{Ae=new qc.a(de.range,de.sheetId);Ae=this.jEc(Ae);var Re=id[Ae];if(Re)for(const La of Re)La.tVg(ae),de.metadata=La;else d.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+Ae)}})}}Object(b.a)(Bc,"CatchUpHighlightControllersCreator",null,[]);class $b{constructor(){this.activityIds=
this.container=this.target=null;this.isSticky=!1;this.dirHint=0;this.onHoverLeave=this.onHoverEnter=this.activityNavigationManager=null}}Object(b.a)($b,"CreateIndicatorTooltipParameters",null,[]);class tc{constructor(){this.clearSticky=!1}}Object(b.a)(tc,"DismissIndicatorTooltipParameters",null,[]);class Xc{constructor(){this.target=null;this.isSticky=!1}}Object(b.a)(Xc,"UpdateIndicatorTooltipParameters",null,[]);class qd{constructor(Mb,rc,id){this.$=Mb;this.Ci=rc;this.QBb=id}navigateToActivity(Mb){if(Mb.fromSummaryString){var rc=
new Y.a(1834994092,zb.a.Vb,this.$.Kc,18,null);this.$.Ia.$b(rc);return this.mFa(1)}Mb=Mb.activity;if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6883957_InvokeEntryPointForClickingActivityIndicatorTooltip")&&Mb&&1===Mb.type){var id=new Y.a(1834994092,zb.a.Vb,this.$.Kc,30,null);const Gd={["activityGuid"]:Mb.activityId,["sheetRanges"]:null===(rc=this.QBb)||void 0===rc?void 0:rc.call(this,Mb.activityId)};this.$.Ia.$b(id,Gd);return this.mFa(1)}if(!this.Zxi(Mb))return this.mFa(4);if(!this.kIi(Mb))return this.mFa(7);
rc={};try{id=window.self.atob(Mb.navigationId);if(!id)return this.mFa(5);rc.NavigationId=id}catch(Gd){return d.ULS.sendTraceTag(537168023,3012,10,`Exception thrown when trying to decode activity NavigationID: ${Gd}`),this.mFa(5)}if(8===this.Ci.Be(Ac.a.ULa,2,rc))return this.Ci.processAction(Ac.a.scb,2),this.mFa(2);rc=32===this.Ci.Be(Ac.a.Y3a,2,rc)?1:6;return this.mFa(rc)}Zxi(Mb){return Mb&&Mb.navigationId?!0:!1}kIi(Mb){switch(Mb.type){case 3:case 4:case 6:case 7:case 9:case 8:case 10:return!0;default:return!1}}mFa(Mb){return Promise.resolve(Mb)}}
Object(b.a)(qd,"CatchUpActivityNavigationManager",null,[705]);var Cd=a(37);class Xd{constructor(Mb,rc){this.n$b=this.Xra=null;this.sCd=!1;this.lCd=!0;this.Gof=!1;this.Tkc=this.NUa=null;this.Pya={};this.wGa=null;this.vsd=!1;this.QBb=id=>this.mka.QBb(id);this.OKb=(id,Gd)=>{switch(Gd.state){case 0:case 1:3===Gd.Xxc?(this.Noi(),this.NUa=null):2===Gd.Xxc&&(this.Tkc=null);break;case 2:this.Tkc=Gd.activityId;break;case 3:this.OSe();this.NUa=Gd.activityId;this.dXj();break;default:d.ULS.shipAssertTag(537168030,
0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Gd.state)}};this.Lm=()=>{this.sxb()};this.Dd=()=>{this.sxb()};this.vo=()=>{this.sxb()};this.Ji=()=>{this.sxb()};this.ddj=()=>{this.S8b()};this.edj=()=>{this.QJe();this.f5e=setTimeout(()=>{this.Bxb()},200)};this.Ghg=(id,Gd)=>{Gd.Ezi?(this.S8b(),this.Bxb()):(this.Gof&&d.ULS.sendTraceTag(508938368,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Flyout is created while bluedots are updating."),
this.cKe(),this.yjd=setTimeout(()=>{this.S8b();this.Bxb();const de=this.L$j(Gd.Ada);de?(this.Xra.createActivityIndicatorTooltip(Object(M.a)(new $b,{target:this.JDh(Gd.Ada),container:de,activityIds:[Gd.activityId],isSticky:!1,dirHint:this.gridView.rtl?12:9,activityNavigationManager:W.EwaSettings.isChangeGateEnabled("OfficeVSO:6883957_InvokeEntryPointForClickingActivityIndicatorTooltip")?this.a8b:void 0,onHoverEnter:this.ddj,onHoverLeave:this.edj})),this.Gkc=Gd.Ada,d.ULS.sendTraceTag(51172353,0,50,
"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event."),this.bnc||(this.gridView.view.ls(this.VIc),this.gridView.jt(this.VIc),this.bnc=!0)):d.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null.")},150))};this.ELf=()=>{this.S8b();this.f5e=setTimeout(()=>{this.Bxb()},200)};this.VIc=()=>{this.Xra?(this.O8a&&this.Xra.updateActivityIndicatorTooltip(Object(M.a)(new Xc,{target:this.O8a,
isSticky:!0})),this.Gkc&&this.Xra.updateActivityIndicatorTooltip(Object(M.a)(new Xc,{target:this.O8a,isSticky:!1}))):d.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=Mb;this.gridView=ka.h(this.$);this.ga=this.gridView.ga;this.Xb=this.gridView.wc;this.ga.p4b(this.Lm);this.ga.gp(this.Dd);this.gridView.KF(this.vo);this.Xb.ao(this.Ji);this.O8a=this.Gkc=null;this.bnc=!1;this.tjd={};this.a8b=new qd(this.$,f.AFrameworkApplication.Qb,
this.QBb);this.blueDotManager=rc;this.qkc=!!rc&&rc.nFb()}get $ue(){return this.Xra}set $ue(Mb){this.Xra=Mb}get excelCommentManager(){this.wGa||(this.wGa=this.$.da.Ba(65));return this.wGa}get mka(){this.n$b||(this.n$b=new Bc);return this.n$b}set mka(Mb){this.n$b=Mb}dispose(){this.ga.Nzc(this.Lm);this.ga.Gp(this.Dd);this.gridView.dH(this.vo);this.Xb.Un(this.Ji);this.XSe();this.tjd=this.O8a=this.Gkc=this.Tkc=this.NUa=this.Xb=this.ga=this.gridView=null}pXd(Mb){var rc;const id=this.P5b();this.XSe();if(cb.e(Mb))this.mka.vvj(this.$),
null===(rc=this.blueDotManager)||void 0===rc?void 0:rc.d4i(),this.mka.xmc&&d.ULS.sendTraceTag(508933386,0,50,"CatchUpActivityHighlightManager:setActivityPayloadForHighlights - userActivities is NULL or empty.");else{d.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:setActivityPayloadForHighlights().");if(this.Pya=this.mka.anh(this.$,Mb,this,id)){Mb=this.Pya;for(let Gd in Mb){rc=Mb[Gd];for(const de of rc)this.b3g(de)}}this.mka.o5f(this.$,id)}}rSb(){const Mb=this.P5b();Mb&&this.vsd?
d.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read"):(Mb||this.sxb(),this.mka.o5f(this.$,Mb))}OLa(Mb){this.blueDotManager&&this.blueDotManager.OLa(Mb,0)}TXd(Mb,rc){if(!this.qkc||!(0===rc&&this.sCd===Mb||1===rc&&this.lCd===Mb)){var id=this.P5b();this.qkc&&0!==rc?this.qkc&&1===rc?this.lCd=Mb:d.ULS.shipAssertTag(508908755,0,!1,"CatchUpActivityHighlightManager.SetForceHighlightsOff - Unknown reason for setting force highlights off"):
this.sCd=Mb;id!==this.P5b()&&this.rSb()}}icg(Mb){this.Gof=Mb}UCi(Mb){return this.Tkc===Mb}XSe(){if(this.Pya){const Mb=this.Pya;for(let rc in Mb){const id=Mb[rc];for(const Gd of id)this.awj(Gd),Gd.dispose()}}this.Pya={};this.mka.dispose();this.mka=null}dXj(){if(this.excelCommentManager){var Mb=this.Pya[this.NUa];Mb&&0<Mb.length&&3===Mb[0].model.activityType&&((Mb=Mb[0])?this.excelCommentManager.HXj(Mb.v2h()):d.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}}Noi(){this.excelCommentManager&&
this.excelCommentManager.syb()}OSe(){if(this.NUa){const Mb=this.Pya[this.NUa];if(Mb){for(const rc of Mb)rc.nWd(!1);this.NUa=null}else d.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}}sxb(){this.OSe();this.Bxb()}L$j(Mb){if(!Mb)return d.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Mb=`${Mb.id}-${ha.a.ybh}`;let rc=this.tjd[Mb];if(!rc){if(!this.gridView.domElement)return d.ULS.shipAssertTag(537168025,
0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;rc=document.createElement("Div");rc.className=Cb.a.zbh;rc.id=Mb;this.gridView.domElement.appendChild(rc);this.tjd[Mb]=rc}return rc}Bxb(){if(this.Xra&&(this.Xra.dismissActivityIndicatorTooltips(Object(M.a)(new tc,{clearSticky:!0})),this.O8a=this.Gkc=null,this.bnc&&!this.O8a&&(this.gridView.view.oq(this.VIc),this.gridView.Rv(this.VIc),this.bnc=!1),this.flyoutAnchorTarget)){const Mb=this.flyoutAnchorTarget.parentElement;
null===Mb||void 0===Mb?void 0:Mb.removeChild(this.flyoutAnchorTarget);this.flyoutAnchorTarget=null}}b3g(Mb){Mb.vxe(this.OKb);Mb.YVg(this.Ghg);Mb.XVg(this.ELf)}awj(Mb){Mb.b4f(this.OKb);Mb.lxj(this.Ghg);Mb.kxj(this.ELf)}cKe(){this.yjd&&clearTimeout(this.yjd)}QJe(){this.yjd&&clearTimeout(this.f5e)}S8b(){this.cKe();this.QJe()}P5b(){return this.blueDotManager&&this.blueDotManager.areInGridHighlightsEnabled()&&!this.sCd&&(!this.qkc||!this.lCd)}JDh(Mb){if(this.flyoutAnchorTarget){d.ULS.debugAssertTag(509225110,
0,!1,"CatchUpActivityHighlightManager::ensureFlyoutAnchorTarget got non-null flyoutAnchorTarget.");var rc=this.flyoutAnchorTarget.parentElement;null===rc||void 0===rc?void 0:rc.removeChild(this.flyoutAnchorTarget);this.flyoutAnchorTarget=null}var id=Mb.getBoundingClientRect();this.flyoutAnchorTarget=document.createElement("div");this.flyoutAnchorTarget.className=Cb.a.Dbh;this.$.QD.appendChild(this.flyoutAnchorTarget);Mb=Cd.a(this.$).ri(id.left);rc=Cd.a(this.$).ri(id.top);const Gd=Cd.a(this.$).ri(id.width);
id=Cd.a(this.$).ri(id.height);this.flyoutAnchorTarget.style.left=`${Mb}px`;this.flyoutAnchorTarget.style.top=`${rc}px`;this.flyoutAnchorTarget.style.width=`${Gd}px`;this.flyoutAnchorTarget.style.height=`${id}px`;return this.flyoutAnchorTarget}}Object(b.a)(Xd,"CatchUpActivityHighlightManager",null,[729,2]);var ge=a(439);class ve{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(b.a)(ve,"ActivityFeedEntry",null,[]);const Ie=
(Mb,rc)=>rc.isUserProfilePictureResolutionEnabled?Wc.toArray(Wc.select(Wc.asEnumerable(Mb),id=>{if(!id||!id.activityFeedItemPayload)return id;const Gd=JSON.parse(id.activityFeedItemPayload);var de=Gd.actor;if(!de||de.pictureUrl)return id;const ae=de.userPrincipalName||de.email;if(!ae)return id;de=rc.wka(ae,de.provider,f.AFrameworkApplication.ej,0);if(!de)return id;Gd.actor.pictureUrl=de;return Object.assign(new ve,{id:id.id,type:id.type,collectionId:id.collectionId,activityState:id.activityState,
activityFeedItemPayload:JSON.stringify(Gd),timestamp:id.timestamp})})):Mb,Ee=(Mb,rc)=>{const id=new Map,Gd=new Map;for(const de of Mb){if(!de||!de.activityFeedItemPayload)continue;Mb=JSON.parse(de.activityFeedItemPayload).actor;if(!Mb)continue;const ae=Mb.email||Mb.userPrincipalName;ae&&!Gd.has(ae)&&Gd.set(ae,new ge.a(ae,null,Mb.name))}Gd.forEach(de=>{const ae=rc.Tic(de,6);id.set(de.UserId,ae)});return id};class pf{}Object(b.a)(pf,"GetRelevantActivitiesDataRequest",null,[]);class Xe{constructor(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(b.a)(Xe,"Activity",null,[]);class Ve{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(b.a)(Ve,"ActivityFeedItem",null,[]);class wf{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(b.a)(wf,"ActivityFeedPayload",null,[]);class Ff{constructor(){this.lowWaterline=
this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(b.a)(Ff,"ActivityRequestPayload",null,[]);class db{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(b.a)(db,"Person",null,[]);class U extends Xe{constructor(){super();this.relationship=0}}Object(b.a)(U,"TaskActivity",Xe,[]);const Ta=(Mb,rc,id,Gd,de,ae=null)=>{ae=Mb.Pa(1,ae);return hb.g(Mb,"GetLineageWywaAuthors",
ae,rc,id,Gd,de,4)},wb=(Mb,rc,id,Gd,de,ae,Ae=null)=>{Ae=Mb.Pa(1,Ae);Ae.getRelevantActivitiesDataRequest=rc;return hb.g(Mb,"GetRelevantActivitiesData",Ae,id,Gd,de,ae,0)};class Qb{constructor(Mb,rc,id=!1,Gd=null){this.N7d=null;this.$=Mb;this.b8b=rc;this.Vdb=Ra.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.Cfa=Ra.a.instance.resolve("Common.App.People.IUserProfilePictureUtilsV2");this.s$a=id;this.blueDotManager=Gd}requestWYWAActivities(){return this.s$a?new Promise((Mb,rc)=>{Ta(this.$.qa.va,
id=>{var Gd;id=Fa.a(id)?null:id.Result;if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)){const de=null===(Gd=null===id||void 0===id?void 0:id.WywaAuthors)||void 0===Gd?void 0:Gd.length;if(null!=de&&0<de){const ae={activities:[],actors:id?this.oic(id.WywaAuthors):null,hasMore:!1,highWaterline:Qb.Ika,lowWaterline:Qb.Ika,wywaWaterline:Qb.Ika};this.stg(Ae=>{ae.activities=Ae;Mb(ae)},Ae=>{d.ULS.sendTraceTag(509638481,0,10,`updateInGridBlueDots failed: reason: "${Ae}"`);Mb(ae)},
!0,!1)}else Mb(Qb.lxb)}else Gd=Object(M.a)(new Ff,{activities:[],actors:id?this.oic(id.WywaAuthors):null,hasMore:!1,highWaterline:Qb.Ika,lowWaterline:Qb.Ika,wywaWaterline:Qb.Ika}),Mb(Gd)},()=>{d.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");rc(null)},null,null)}):Promise.resolve(Qb.lxb)}requestActivities(){return Promise.resolve(Qb.lxb)}requestRelevantActivities(){if(!this.$.ea.Ec||this.$.ea.E8a)return d.ULS.sendTraceTag(537168021,3012,
15,`CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: ${this.$.ea.Ec}, HasRaisedSessionEnded: ${this.$.ea.E8a}]`),Promise.resolve(Qb.lxb);const Mb=Object(M.a)(new pf,{SetDaysBack:f.AFrameworkApplication.fa.oe("AppWaterlineOverrideDaysValue",0),SetTimestamp:f.AFrameworkApplication.fa.oe("AppWaterlineOverrideTimestampValue",0)});return new Promise((rc,id)=>{wb(this.$.qa.va,Mb,Gd=>{let de=Qb.lxb;Gd?Fa.a(Gd)?(Gd=Q.a.Ic(Gd.Errors),d.ULS.sendTraceTag(578353159,
3012,10,`CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: ${Gd}`)):de=this.Aci(Gd.Result):d.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");rc(de)},Gd=>{Gd=Ka.a.lf(Gd.data);Gd=Q.a.Ic(Gd);d.ULS.sendTraceTag(537168019,3012,10,`CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [${Gd}]`);id(null)},null,null)})}requestActivityFeed(){return ta.c(this.getActivityFeed()).then(Mb=>
{Mb=this.T8j(Mb);return Object(M.a)(new wf,{activityFeedItems:Ie(Mb,this.Cfa),personaColorMap:Ee(Mb,this.Vdb)})})}updateActivityState(Mb){return this.b8b?ta.c(this.b8b).then(rc=>{var id,Gd;return ta.c(rc.Jck(Mb.itemIds,null!==(id=Mb.activityStatesToSet)&&void 0!==id?id:0,null!==(Gd=Mb.activityStatesToReset)&&void 0!==Gd?Gd:0,Mb.resetUnseenCount))}):Promise.resolve(!1)}getActivityFeed(){return this.b8b?Zb.a.R3d(this.b8b,Mb=>Mb.getActivityFeed(null)):F.Task.Ua([])}Aci(Mb){if(!Mb)return d.ULS.sendTraceTag(537168018,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object(M.a)(new Ff,{activities:[]});const rc=this.Bpg(Mb.NewActivities,2);Mb=this.Bpg(Mb.OutstandingActivities,3);for(const id of Mb)rc.push(id);return Object(M.a)(new Ff,{activities:rc})}Bpg(Mb,rc=1){const id=[];if(!Mb||!Mb.length)return id;for(const Gd of Mb)Gd?(Mb=Qb.$8j(Gd.Type),6===Mb||7===Mb||9===Mb||8===Mb?id.push(Object(M.a)(new U,{activityId:Gd.Id,type:Mb,displayTimestamp:new Date(Gd.DisplayTimestamp),
navigationId:Gd.NavigationId,actors:this.oic(Gd.People),relevancy:rc,relationship:this.Z8j(Gd.Relationship)})):id.push(Object(M.a)(new Xe,{activityId:Gd.Id,type:Mb,displayTimestamp:new Date(Gd.DisplayTimestamp),navigationId:Gd.NavigationId,actors:this.oic(Gd.People),relevancy:rc}))):d.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return id}Z8j(Mb){switch(Mb){case 1:return 1;case 2:return 2;case 3:return 3}d.ULS.sendTraceTag(537168016,
0,10,"Unexpected Relationship.");return 1}T8j(Mb){const rc=[];for(const id of Mb)Mb=Object(M.a)(new Ve,{id:id.id,type:id.type,collectionId:id.collectionId,activityState:id.activityState,activityFeedItemPayload:id.activityFeedItemPayload,timestamp:id.timestamp}),rc.push(Mb);return rc}oic(Mb){const rc=[];if(!Mb||!Mb.length)return rc;for(const id of Mb)id&&rc.push(this.yBb(id));return rc}yBb(Mb){return Object(M.a)(new db,{id:Mb.Id,provider:Mb.Provider,displayName:Mb.DisplayName,email:Mb.Email,imageUrl:this.Cfa.wka(Mb.Email,
Mb.Provider,f.AFrameworkApplication.ej,0),color:this.Vdb.Tic(new ge.a(null,void 0,Mb.DisplayName),6)})}static $8j(Mb){switch(Mb){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return d.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}}FLc(){if(this.blueDotManager){const Mb=this.blueDotManager.P5c;return this.N7d.filter(rc=>!Mb.has(rc.Id))}return this.N7d}jmj(Mb,
rc){const id=Mb.map(Gd=>({activityId:Gd.activityGuid,activityFeedItemId:null,type:1,actors:[{id:Gd.author.id,provider:Gd.author.provider,displayName:Gd.author.displayName,givenName:null,email:Gd.author.email,imageUrl:Gd.author.imageUrl,color:null}],location:{type:105,region:null,subregion:null},displayTimestamp:Gd.displayTimestamp,relevancy:null,navigationId:null,state:0,collectionId:null}));this.N7d=Mb.map(Gd=>{var de,ae;const Ae=null!==(ae=null===(de=Gd.rangeHighlightLocation)||void 0===de?void 0:
de.rangeList.map(Re=>({Type:0,RangeList:[{SheetName:Gd.sheetName,FirstRow:Re.firstRow,LastRow:Re.lastRow,FirstColumn:Re.firstCol,LastColumn:Re.lastCol}]})))&&void 0!==ae?ae:[];return{Id:Gd.activityGuid,Type:null,Person:null,DisplayTimestamp:null,LocationList:Ae}});rc(id)}stg(Mb,rc,id,Gd){this.blueDotManager?(Gd?this.blueDotManager.PNi():this.blueDotManager.ONi()).then(de=>{this.jmj(de,Mb);this.blueDotManager.nQa()&&id&&this.blueDotManager.zNi()},de=>{rc&&rc(de)}):d.ULS.shipAssertTag(509703879,3012,
!1,"CatchUpActivityRequestManager.updateInGridBlueDots: Missing blue dot manager in blue dot method")}}Qb.Ika="<WywaWaterline>DefaultWaterline</WywaWaterline>";Qb.lxb=Object(M.a)(new Ff,{activities:[],actors:[],hasMore:!1,highWaterline:Qb.Ika,lowWaterline:Qb.Ika,wywaWaterline:Qb.Ika});Object(b.a)(Qb,"CatchUpActivityRequestManager",null,[706]);class sc{constructor(Mb){this.$=Mb}shouldShowEmptyExperienceButton(){return this.$.ea.kbb?!0:!1}onButtonClick(){const Mb={["InputMethod"]:zb.a.Vb};this.$.Ia.$b(new Y.a(1834994092,
zb.a.Vb,this.$.Kc,16,null),Mb)}onInviteOthersButtonClick(){const Mb={["InputMethod"]:zb.a.Vb};this.$.Ia.$b(new Y.a(869186573,zb.a.Vb,this.$.Kc,16,null),Mb)}getExplanationText(){const Mb=this.$.da.Ba(365);return Fb.a.instance.Ha(Mb&&Mb.isVisible?657:656)}getCommandName(){return Fb.a.instance.ha(443)}}Object(b.a)(sc,"CatchUpEmptyExperienceBehaviorManager",null,[707]);const Vc=Mb=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Mb)};class Ld{constructor(Mb,
rc=null){this.$=Mb;this.flyoutRibbonButton=rc;Z.a(this.$).Pi(this);this.hasFocus=!1}dispose(){Z.a(this.$).aB(this)}get Lc(){return document.getElementById("catchUpFlyoutContainer")}get sg(){return this.flyoutRibbonButton.Lqf&&!this.hasFocus}get Ge(){return fa.a.C7c}Qg(Mb,rc){if(rc)return!1;Mb=document.getElementById("flyoutItem0");if(!Mb)return d.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;Mb.focus();this.oyh(Mb);return!0}hi(Mb){return this.Lc?
ya.DOMElementExtensions.lg(this.Lc,Mb):!1}ek(){this.hasFocus=!0}Gk(){this.hasFocus=!1}oyh(Mb){if(Sys.Browser.agent===Sys.Browser.Firefox){var rc=document.createEvent("KeyboardEvent");rc.initKeyEvent(Sd.a.yc,!0,!0,window.self,!1,!1,!1,!1,Kc.a.nVb,0);Mb.dispatchEvent(rc)}else rc=document.createEvent("Events"),rc.initEvent(Sd.a.yc,!0,!0),rc.keyCode=Kc.a.nVb,rc.which=Kc.a.nVb,Mb.dispatchEvent(rc)}}Object(b.a)(Ld,"FlyoutFocus",null,[29,2]);var le=a(428);class Ce{constructor(Mb){this.buttonClickedCallback=
null;this.Gnb=this.WEb=!1;this.NUh=new Date;this.T4e=Mb}dispose(){this.Gnb=this.WEb=!1}registerButtonClickedEvent(Mb){this.buttonClickedCallback&&d.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Mb.buttonClickedCallback}onFlyoutInitialized(){this.WEb&&d.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const Mb=(new Date).getTime()-this.NUh.getTime();
d.ULS.sendTraceTag(593601546,3012,50,`Time from retrieve activities to initialize Flyout: ${Mb}`);l.c(Ac.a.Ebh,!0,l.e,0,0,Mb);this.WEb=!0;le.a.FF&&le.a.FF.updateCommandUI(!0)}logFlightTriggers(){}toggleCatchUpFlyout(){this.WEb?this.buttonClickedCallback?this.buttonClickedCallback():d.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):d.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")}get Lqf(){return this.Gnb}onFlyoutVisibilityChanged(Mb){this.Gnb!==
Mb.flyoutIsVisible&&(this.Gnb=Mb.flyoutIsVisible,le.a.FF&&le.a.FF.updateCommandUI(!0),this.Gnb||this.T4e&&this.T4e.aPi())}}Object(b.a)(Ce,"FlyoutRibbonButton",null,[722]);var Oe=a(534);class ef{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=
null}}Object(b.a)(ef,"CatchUpConfiguration",null,[]);class uf{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(b.a)(uf,"SharedControllerFactoryParameters",null,[]);class Ab{constructor(Mb,rc,id=null,Gd=null,de=null){var ae;this.qKa=null;this.Aif=!1;this.tCd=
this.tAa=0;this.nQa=!1;this.fg=()=>{const Ae=this.$.ea.Pn.LineageVersion;this.tAa!==Ae&&(d.ULS.sendTraceTag(509645837,0,50,`CatchUpActivityManager.onWorkbookMetadataChanged: lineageVersion: ${Ae}, this.lineageVersion: ${this.tAa}`),this.tAa=Ae,this.Qyc(!1))};this.Tn=()=>{d.ULS.sendTraceTag(509109976,0,100,"CatchUpActivityManager.onLoadOnDemandOccured");this.Qyc(!0)};this.zd=(Ae,Re)=>{Ae=W.EwaSettings.isChangeGateEnabled("OfficeVSO:7788930_BlueDotReloadAfterBecomingActive");Re.FG&&this.blueDotManager&&
(d.ULS.sendTraceTag(509109975,0,100,"CatchUpActivityManager.onSessionIdChanged"),Ae&&this.Qyc(!0));Ae||this.Qyc(!0)};this.jTf=Ae=>{var Re;W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&!Ye.a.sh(Ae.wywaActivities)&&2!==Ae.wywaActivities[0].type&&(this.i_.pXd(this.p3a.FLc()),this.showHideInGridHighlights(),this.$.ea.nv(this.fg),null===(Re=this.blueDotManager)||void 0===Re?void 0:Re.Lxe(this.onBlueDotDismissed),this.nQa&&(this.$.ea.DK(this.Tn),this.$.ea.pk(this.zd)))};this.onBlueDotDismissed=
()=>{this.i_.pXd(this.p3a.FLc())};this.$=Mb;this.blueDotManager=de;this.i_=new Xd(this.$,this.blueDotManager);this.Xbe=new xa(f.AFrameworkApplication.Qb,W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1));Mb=gf.a.n7j(Ra.a.instance.qc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.uyf=Gd;this.p3a=new Qb(this.$,Mb,this.s$a(),this.blueDotManager);this.a8b=new qd(this.$,f.AFrameworkApplication.Qb);this.emptyCatchUpBehaviorManager=new sc(this.$);
this.CNi(Ae=>{this.u1i(Ae)},rc);this.KPi();rc=null;id||(rc=Ra.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=id||new Ce(rc);this.flyoutFocus=new Ld(this.$,this.flyoutRibbonButton);this.KEe=this.$.nc.hh("UserAction","BlueDotLiveUpdateIntervalStopwatch");this.nQa=null===(ae=this.blueDotManager)||void 0===ae?void 0:ae.nQa()}get Oof(){const Mb=this.flyoutRibbonButton.WEb;Mb&&!this.Aif&&(d.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),
this.Aif=!0);return Mb}get mzi(){return this.flyoutRibbonButton.Lqf}dispose(){var Mb;this.qKa&&this.qKa.getWywaEvent().removeListener(this.jTf);this.qKa=this.$=null;nf.a.Ka(this.i_);this.flyoutRibbonButton=this.flyoutFocus=this.Xbe=this.a8b=this.p3a=this.i_=null;this.$.ea.Xw(this.fg);null===(Mb=this.blueDotManager)||void 0===Mb?void 0:Mb.o4f(this.onBlueDotDismissed);this.nQa&&(this.$.ea.rP(this.Tn),this.$.ea.Kk(this.zd))}Zcj(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0}bfk(Mb){this.i_.TXd(!Mb,
1)}showHideInGridHighlights(){this.i_.rSb()}nFb(){return!!this.blueDotManager&&this.blueDotManager.nFb()}KPi(){d.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.gof()&&d.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Qyc(Mb){if(this.blueDotManager){var rc=W.EwaSettings.isChangeGateEnabled("OfficeVSO:7643204_BlueDotLiveUpdatePerfTelemetry")&&!Mb&&this.tCd<Ab.vNi,id=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDotsHideSuppression",
!1);id?this.i_.icg(!0):this.i_.TXd(!0,0);rc&&this.KEe.start();this.p3a.stg(()=>{this.i_.pXd(this.p3a.FLc());id?this.i_.icg(!1):this.i_.TXd(!1,0);rc&&(this.KEe.stop(),this.tCd+=1);Mb&&(this.tAa=0)},null,Mb&&this.blueDotManager.aVj(),Mb)}else d.ULS.sendTraceTag(508953163,0,50,"blueDotManager is null when refreshBlueDots is called")}CNi(Mb,rc){Vc("ScriptDownload");void V.a.resolve(ia.x,{Wa:rc}).then(id=>Object(bf.a)(this,void 0,void 0,function*(){Mb(ta.d(id("catchUpActivity")))}))}s$a(){return!!this.uyf&&
this.uyf.s$a()&&this.$.ea.kbb}gof(){return W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}u1i(Mb){z.TaskExtensions.za(Mb,()=>{Ca.a(()=>{this.qKa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(M.a)(new uf,{activityContentManager:Object(oc.a)(704,this.Xbe),activityNavigationManager:Object(oc.a)(705,this.a8b),activityRequestManager:Object(oc.a)(706,this.p3a),dataCulture:this.$.xa.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(oc.a)(Ce,
this.flyoutRibbonButton),uiCulture:this.$.xa.UICultureTag,ulsLogger:new D.a,emptyCatchUpBehaviorManager:Object(oc.a)(707,this.emptyCatchUpBehaviorManager)}))});this.i_.$ue=this.qKa.getActivityIndicatorTooltipManager();Oe.a(this.$);this.qKa.getWywaEvent().addListener(this.jTf);Vc("InitializeCatchUpApp");this.qKa.initialize(Object(M.a)(new ef,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:this.s$a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:!0,activityFeedDataEnabled:this.gof()}))},
this.$.ka,3)}}Ab.vNi=10;Object(b.a)(Ab,"CatchUpActivityManager",null,[708,2]);class cc extends e.a{constructor(Mb){super();this.$=Mb;this.kc()}create(){let Mb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)?y.GetServiceTaskFactory.Za(this.$.da,501,500,1):F.Task.Ua(null),rc=y.GetServiceTaskFactory.Za(this.$.da,458,459,this.La);z.TaskExtensions.za(z.TaskExtensions.ke([Mb,rc],this.$.ka),()=>{const id=rc.result,Gd=Mb.result,de=Object(sa.a)(this.$.da,286,()=>new Ab(this.$,this.La,
null,id,Gd));this.Pb(de)},this.$.ka,3)}static la(Mb){Mb.da.Ja(287,new cc(Mb))}}Object(b.a)(cc,"CatchUpActivityManagerFactory",e.a,[]);var uc=a(243),$c=a(170),Bd=a(323),ee=a(42);class qe{}Object(b.a)(qe,"LineageBlueDotsInfo",null,[]);class Yb extends Error{constructor(Mb,rc){super(`${Yb.K5g}: ${Mb}. With errors: ${Q.a.Ic(rc)}`)}}Yb.K5g="BlueDotError";Object(b.a)(Yb,"BlueDotError",Error,[]);class Nc extends ee.a{constructor(Mb,rc){super();this.blueDotSettings=0;this.U4=this.wLd=null;this.bjf=!1;this.areInGridHighlightsAvailable=
()=>!0;this.areInGridHighlightsEnabled=()=>0===(this.blueDotSettings&1);this.XNj=id=>{d.ULS.sendTraceTag(509732679,0,50,"User toggled in grid highlights, new value {0}.",id);this.blueDotSettings=id?0:1;this.sbg({});this.Klk()};this.E8i=id=>{this.sbg({LineageTaskPaneVisible:id})};this.$=Mb;this.blueDotSettings=rc;this.Cfa=Ra.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Qtb=new Set;this.P5c=new Set}dispose(){this.$=null}Lxe(Mb){this.addHandler("cubddek",Mb)}o4f(Mb){this.removeHandler("cubddek",
Mb)}OLa(Mb,rc){W.EwaSettings.isChangeGateEnabled("OfficeVSO:7633322_BlueDotDismissTelemetry")&&d.ULS.sendTraceTag(509167327,0,50,"BlueDotManager::dismissBlueDot: Blue dot dismissed by "+rc);this.P5c.add(Mb);W.EwaSettings.isChangeGateEnabled("OfficeVSO:7525040_BlueDotDismissal")&&this.raiseEvent("cubddek",Mb)}shouldShowBlueDot(Mb){return this.Qtb.has(Mb)&&!this.P5c.has(Mb)}nQa(){return W.EwaSettings.isChangeGateEnabled("OfficeVSO:6633490_BlueDotsServerReload")}hasAnyActiveInGridHighlight(){return W.EwaSettings.isChangeGateEnabled("OfficeVSO:7665355_DisableToggleForEmptyInGridHighlights")?
!this.bjf&&0<this.Qtb.size:!0}d4i(){this.bjf=!0}ONi(){return Object(bf.a)(this,void 0,void 0,function*(){return new Promise((Mb,rc)=>{d.ULS.sendTraceTag(512234945,0,50,"BlueDotManager::loadInGridBlueDots");Oa.b(this.$).Ld(na.a.lineageLoadInGridBlueDots,{});const id=de=>{de=Ka.a.lf(de.data);d.ULS.sendTraceTag(512234944,0,50,`BlueDotManager::LineageLoadInGridBlueDots service call failed. Errors: [${Q.a.Ic(de)}]`);rc(new Yb("loadInGridBlueDots failed",de))},Gd=de=>{if(de=Fa.a(de)?null:de.Result){var ae=
{["CountOfActivities"]:de.ActivityList.length};Oa.b(this.$).Ld(na.a.hNi,ae);var Ae=ld(de.ActivityList,this.Cfa);this.nQa()?(this.S9b(Ae),this.U4&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:7833821_BlueDotsReapplyFlattenedUids")&&this.N5b(this.U4.FlattenedUids),Mb(Ae)):null==this.wLd?this.wxi().then(Re=>{this.wLd=Re;this.S9b(Ae);this.N5b(Re);Mb(Ae)},Re=>{rc(Re)}):(this.S9b(Ae),this.N5b(this.wLd),Mb(Ae))}else d.ULS.shipAssertTag(512234914,0,!!de,"BlueDotManager LineageLoadInGridBlueDots returned null response.")};
this.$.userOperationManager.kd(new ma.a(1024,0,(de,ae,Ae)=>Gc(this.$.qa.va,wa.b(de,Gd),wa.a(ae,id),Ae,null),80),null)})})}PNi(){return Object(bf.a)(this,void 0,void 0,function*(){return new Promise((Mb,rc)=>{var id,Gd,de,ae,Ae,Re;d.ULS.sendTraceTag(509109974,0,50,"BlueDotManager::loadInGridBlueDotsWithReloadHint");Oa.b(this.$).Ld(na.a.lineageLoadInGridBlueDotsWithReloadHint,{});const La=Yc=>{Yc=Ka.a.lf(Yc.data);d.ULS.sendTraceTag(509109973,0,50,`BlueDotManager::LineageLoadInGridBlueDotsWithReloadHint service call failed. Errors: [${Q.a.Ic(Yc)}]`);
rc(new Yb("loadInGridBlueDotsWithReloadHint failed",Yc))},Hb=Yc=>{if(Yc=Fa.a(Yc)?null:Yc.Result){var xd={["CountOfActivities"]:Yc.ActivityList.length};Oa.b(this.$).Ld(na.a.iNi,xd);Yc=ld(Yc.ActivityList,this.Cfa);this.S9b(Yc);Mb(Yc)}else d.ULS.shipAssertTag(509109971,0,!1,"BlueDotManager LineageLoadInGridBlueDotsWithReloadHint returned null response.")},xc=Object(M.a)(new qe,{FlattenedUids:null,ToplevelUids:null===(id=this.U4)||void 0===id?void 0:id.ToplevelUids,XrevidFirst:null===(Gd=this.U4)||void 0===
Gd?void 0:Gd.XrevidFirst,XrevidLast:null===(de=this.U4)||void 0===de?void 0:de.XrevidLast,XrevidLastAccepted:null===(ae=this.U4)||void 0===ae?void 0:ae.XrevidLastAccepted,ApplyToplevelAllowList:null===(Ae=this.U4)||void 0===Ae?void 0:Ae.ApplyToplevelAllowList,DocId:null===(Re=this.U4)||void 0===Re?void 0:Re.DocId});this.$.userOperationManager.kd(new ma.a(1031,0,(Yc,xd,Vd)=>nc(this.$.qa.va,xc,wa.b(Yc,Hb),wa.a(xd,La),Vd,null),80),null)})})}zNi(){this.ANi().then(Mb=>{this.U4=Mb;this.N5b(Mb.FlattenedUids)},
()=>{})}ANi(){return Object(bf.a)(this,void 0,void 0,function*(){return new Promise((Mb,rc)=>{d.ULS.sendTraceTag(509109970,0,50,"BlueDotManager::loadBlueDotsInformationAsync");const id=de=>{de=Ka.a.lf(de.data);d.ULS.sendTraceTag(509109969,0,50,`BlueDotManager  loadBlueDotsInformation service call failed. Errors: [${Q.a.Ic(de)}]`);rc(new Yb("loadBlueDotsInformation load failed",de))},Gd=de=>{(de=Fa.a(de)?null:de.Result)?Mb(de):d.ULS.shipAssertTag(509109967,0,!!de,"BlueDotManager loadBlueDotsInformation returned null response.")};
this.$.userOperationManager.kd(new ma.a(1030,0,(de,ae,Ae)=>pb(this.$.qa.va,wa.b(de,Gd),wa.a(ae,id),Ae,null),80),null)})})}N5b(Mb){Mb&&Mb.forEach(rc=>{rc=`{${rc.toUpperCase()}}`;this.Qtb.has(rc)||this.Qtb.add(rc)})}S9b(Mb){this.Qtb=new Set(Mb.map(rc=>rc.activityGuid))}sbg(Mb){if(qb.a.mEb(this.$)){var rc=new Y.a(950288339,0,2,12,null);this.$.Ia.$b(rc,Mb)}}nFb(){return W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideBlueDotBehindLineage",!1)}aVj(){return!this.U4||this.U4.ApplyToplevelAllowList}wxi(){return Object(bf.a)(this,
void 0,void 0,function*(){return new Promise((Mb,rc)=>{d.ULS.sendTraceTag(509645136,0,50,"BlueDotManager::invokeOriginalBlueDotsUidList");const id=de=>{de=Ka.a.lf(de.data);d.ULS.sendTraceTag(509645135,0,50,`BlueDotManager  LineageGetOriginalBlueDotsUidList service call failed. Errors: [${Q.a.Ic(de)}]`);rc("BlueDotUidList load failed")},Gd=de=>{(de=Fa.a(de)?null:de.Result)?Mb(de):d.ULS.shipAssertTag(509645133,0,!!de,"BlueDotManager LineageGetOriginalBlueDotsUidList returned null response.")};this.$.userOperationManager.kd(new ma.a(1029,
0,(de,ae,Ae)=>Kb(this.$.qa.va,wa.b(de,Gd),wa.a(ae,id),Ae,null),80),null)})})}Klk(){W.EwaSettings.isChangeGateEnabled("OfficeVSO:7146345_bluedotroamingsetting")&&!W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Test.BlueDotSkipRoamingCall",!1)&&Bd.C(this.$.qa.va,4,this.blueDotSettings.toString(),Mb=>{Q.a.Zf(Mb.Errors)?d.ULS.sendTraceTag(509732678,0,10,`BlueDotManager.writeBlueDotSettingsToRoamingService: encountered an error. Errors: ${Q.a.Ic(Mb.Errors)}`):Mb.Result||d.ULS.sendTraceTag(509732677,
0,10,"BlueDotManager.writeBlueDotSettingsToRoamingService failed to write to roaming service.")},(Mb,rc,id)=>{Mb=Ka.a.lf(Mb.data);d.ULS.sendTraceTag(509732676,0,10,`BlueDotManager.writeBlueDotSettingsToRoamingService: Encountered errors for ${id}. Errors: ${Q.a.Ic(Mb)}.`)},null,null)}}Object(b.a)(Nc,"BlueDotManager",ee.a,[682,2]);class ud extends e.a{constructor(Mb){super();this.Bgc=null;this.u5i=rc=>{rc=Ka.a.lf(rc.data);d.ULS.sendTraceTag(509732673,0,10,`LineageBlueDotFactory: Encountered errors while reading roaming setting. Errors: ${Q.a.Ic(rc)}.`)};
this.$=Mb;this.kc()}create(){this.Bgc||(this.Bgc=this.t0h());this.Bgc.continueWith(()=>{this.Pb(Object(sa.a)(this.$.da,501,()=>new Nc(this.$,this.Bgc.result)))})}static la(Mb){Mb.da.Ja(500,new ud(Mb))}t0h(){if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Test.BlueDotSkipRoamingCall",!1))return uc.a.Ua(0);let Mb=new $c.a;Object(Bd.w)(this.$.qa.va,4,rc=>{this.v5i(rc,Mb)},rc=>{this.u5i(rc);Mb.setResult(1)},null,null);return Mb.task}v5i(Mb,rc){Q.a.Zf(Mb.Errors)?(d.ULS.sendTraceTag(509732675,
0,10,`LineageBlueDotFactory encountered an error while reading roaming setting. Errors: ${Q.a.Ic(Mb.Errors)}`),rc.setResult(1)):null==Mb.Result?rc.setResult(0):(Mb=parseInt(Mb.Result,10),d.ULS.sendTraceTag(509732674,0,50,`LineageBlueDotFactory read roaming setting. Value: ${Mb}`),rc.setResult(Mb))}}Object(b.a)(ud,"BlueDotManagerFactory",e.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");
Type.registerNamespace("_Ewa");c.a.Fa(X.la);c.a.Fa(Va.la);c.a.Fa(r.la);c.a.Fa(x.la);nb.a.ij('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(()=>{c.a.Fa(Mb=>{Qd.la(Mb);Bb.la(Mb);Ma.la(Mb)})})();Type.registerNamespace("Common.App.CatchUpActivity");ue.main();(()=>{c.a.Fa(Mb=>{Vc("Begin");cc.la(Mb);Se.la(Mb)})})();(()=>{c.a.Fa(Mb=>{ud.la(Mb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.catchup.js.map/daedb9dbe5cf114383a6c160db93b8be/EwaDSOpt.catchup.js.map