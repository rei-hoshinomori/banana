/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[16],{1162:function(u,C,a){a.d(C,"a",function(){return c});const c=()=>{Type.registerNamespace("Common.App.InsertFile")}},1163:function(u,C,a){a.d(C,"a",function(){return c});const c=()=>{Type.registerNamespace("Common.App.InsertPicture")}},1164:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);C=a(974);var c=a(33);class b extends C.a{constructor(f=null,e=null){super(c.a.Ic(f,"_"),e)}}Object(u.a)(b,"EwaCCPError",
C.a,[])},1165:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}")}},
1167:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1168:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1183:function(u,C,a){var c=a(0),b=a(2),f=a(15),e=a(229),d=a(34),h=a(31),l=a(362),k=a(185),n=a(366),v=a(25),x=a(1),w=a(42),r=a(9),t=a(294),A=a(16);class y extends t.a{constructor(xa){super(xa);this.kfh=()=>{f.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};f.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");this.rc=0;this.Hc(1,A.a.instance.ha(2260));xa=A.a.instance.ha(2258);const Cb=this.JI();this.initializeAndShow(xa,
this.kfh,Cb)}get Qc(){return"ClipboardReadPermissionAskDialog"}JI(){const xa={};xa.id=this.Qc;const Cb=A.a.instance.ha(2259);xa.DialogMessage=Cb;return xa}}Object(c.a)(y,"ClipboardReadPermissionAskDialog",t.a,[]);var z=a(55);const E=(xa,Cb,bc,Fc,Tc)=>{const gd=xa.Stopwatch,td={};td.a=Tc;td.e=gd.id;td.c="RearrangeRowColumn";td.b="mouse";td.d=xa.OperationId.toString();td.f=bc.toString();td.g=Fc.toString();td.h=Cb.toString();td.i=xa.DragDropIsShiftKeyDown;td.j=!0;td.o=gd.fd;td.q=!1;td.r=xa.CopyPasteTargetType.toString();
td.s=xa.EncounteredDeploymentErrors;return td};class G{constructor(xa,Cb){this.rXh=()=>{const bc={};bc.SourceItem=this.toString();return bc};this.sessionStateId=xa;this.sessionId=Cb;this.toJSON=this.rXh}kqf(xa){return xa?this.sessionStateId===xa.sessionStateId&&this.sessionId===xa.sessionId:!1}isFromCurrentSession(xa){return this.sessionId===xa.xa.UserSessionId}}Object(c.a)(G,"SourceItem",null,[]);class F extends G{constructor(xa,Cb,bc,Fc,Tc){super(bc,Fc);this.activeFloatingObjectControlId=xa;this.sheetName=
Cb;this.type=Tc}isEqual(xa){return xa&&Object.getType(xa)===F?this.kqf(xa)&&this.activeFloatingObjectControlId===xa.activeFloatingObjectControlId&&this.sheetName===xa.sheetName:!1}toString(){return this.type.toString()}}Object(c.a)(F,"ArtSourceItem",G,[]);var O;(function(xa){xa[xa.valid=0]="valid";xa[xa.notPairwiseDisjoint=1]="notPairwiseDisjoint";xa[xa.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";xa[xa.notValidForm=3]="notValidForm";xa[xa.temporarilyBlockedCopy=
4]="temporarilyBlockedCopy"})(O||(O={}));Object(c.b)("CopySourceValidationOptions",O);var M=a(47);class P extends G{constructor(xa,Cb,bc,Fc,Tc){super(Fc,Tc);f.ULS.shipAssertTag(537167645,0,!!Cb&&0<Cb.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=xa;this.ranges=Cb;this.sheetName=bc}isEqual(xa){return xa&&Object.getType(xa)===P?this.kqf(xa)&&M.R(this.ranges,xa.ranges)&&this.sheetName===xa.sheetName:!1}toString(){return M.i(this.ranges,",",this.$,!1)}}Object(c.a)(P,"RangeSourceItem",
G,[]);const B=xa=>!!xa&&Object.getType(xa)===P;class D{}D.Mhk="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(c.a)(D,"ExpectedErrorNames",null,[]);class I{}I.plainText="text/plain";I.html="text/html";I.png="image/png";I.shadowWorkbook="data/shadow-workbook";I.JDi="metadata/is-last-copy-was-external";I.Gzi="metadata/is-last-copy-was-external-XLO-source";I.Mdh="metadata/chrome-extension-id";I.m4a="copyId";I.PZg="metadata/additional-signature-data-attributes";Object(c.a)(I,"ClipboardDataFormat",
null,[]);const S=xa=>xa.clipboardItems&&(xa=xa.clipboardItems.getItem(I.JDi))&&"1"===xa?!0:!1,J=xa=>S(xa)&&!(void 0===xa.clipboardItems||null===xa.clipboardItems)&&!!xa.clipboardItems.getItem(I.png)&&!xa.clipboardItems.getItem(I.plainText),L=xa=>xa.clipboardItems&&(xa=xa.clipboardItems.getItem(I.Gzi))&&"1"===xa?!0:!1,R=xa=>xa&&(xa=xa.getCachedMetadata(),null===xa||void 0===xa?0:xa.lastCopy)?xa.lastCopy:null;var Y=a(53),Q=a(20),W=a(37);class Ga{constructor(xa,Cb,bc,Fc){this.$=xa;this.originalDestinations=
Cb;this.tec=bc;this.BCg=Fc;this.BMg=this.originalDestinations;this.uGg=this.tec;this.XJg="PasteRecoveryUI"}get OZg(){return this.BCg}get fyf(){return this.XJg}get tsj(){return this.BMg}get x2e(){return this.uGg}Pxa(){return Ga.nhj}q4h(){return this.tec&&1===this.tec.length?this.r4h(this.tec[0]):null}lmd(){return"PasteRecoveryUI-Floatie"}r4h(xa){var Cb=Q.h(this.$);const bc=Cb.Cb.ti(xa);var Fc=Cb.Vg(xa,bc);Cb=Cb.rtl;if(!Fc)return null;xa=Q.h(this.$).og(bc);const Tc=xa.am;if(!Tc.Nd(Fc))return null;Fc=
Tc.Ue(Fc);const gd=Fc.topLeft.y;var td=Fc.bottomRight.y;const kb=Cb?Fc.bottomRight.x:Fc.topLeft.x;Fc=Cb?Fc.topLeft.x:Fc.bottomRight.x;var Vb=new Y.a(Fc+(Cb?-81:81),td+38+6);if(Tc.kka(Vb))return this.P7a(xa,Tc,bc,Fc,td,Cb?12:-3,66);Vb=new Y.a(Fc+(Cb?-81:81),td);if(Tc.kka(Vb))return this.P7a(xa,Tc,bc,Fc,td,Cb?20:3,22);Vb=new Y.a(Fc,td+38+6);if(Tc.kka(Vb))return this.P7a(xa,Tc,bc,Fc,td,-81+(Cb?18:0),66);Fc=new Y.a(kb+(Cb?81:-81),td);if(Tc.kka(Fc))return this.P7a(xa,Tc,bc,kb,td,-81+(Cb?12:-6),22);td=
new Y.a(kb,gd-38-6);return Tc.kka(td)?this.P7a(xa,Tc,bc,kb,gd,Cb?15:0,16):this.P7a(xa,Tc,bc,Cb?Tc.topLeft.x:Tc.bottomRight.x,Tc.bottomRight.y,-81+(Cb?15:-6),22)}P7a(xa,Cb,bc,Fc,Tc,gd,td){var kb=Q.h(this.$);const Vb=kb.rtl;xa=Sys.UI.DomElement.getLocation(xa.domElement);Fc=new Sys.UI.Point(Fc+(Vb?0:xa.x)-Cb.topLeft.x,Tc+xa.y-Cb.topLeft.y);Vb&&(kb=kb.view.visibleArea,Fc.x=kb.bottomRight.x-kb.topLeft.x-Fc.x,2===bc||4===bc)&&(Fc.x+=Cb.bottomRight.x);Fc=W.a(this.$).qma(Fc);return new Sys.UI.Point(Fc.x+
gd,Fc.y+td)}}Ga.nhj=["PasteRecoveryUI"];Object(c.a)(Ga,"PasteRecoveryUI",null,[420]);var pa=a(79),aa=a(277);class Z{}Z.CRg="ActiveSelection";Z.shadowWorkbook="ShadowWorkbook";Z.Dzg="GVML";Z.plainText="PlainText";Z.html="Html";Z.j5g="Bitmap";Object(c.a)(Z,"PayloadType",null,[]);class fa{}fa.o_j="Slice6";Object(c.a)(fa,"SliceName",null,[]);class ya{}ya.QYi="NotCalled";ya.success="Success";ya.failed="Failed";Object(c.a)(ya,"SucceededPopulatingSystemClipboardOptions",null,[]);var Aa=a(346);const ja=(xa,
Cb)=>xa?Cb&&Cb.xa?xa.sessionId!==Cb.xa.UserSessionId:(f.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(f.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),za=xa=>{switch(xa){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},ra=xa=>{if(!xa)return"null";const Cb=[];for(const bc of xa.get())Cb.push(`${bc.clipboardDataFormat}(${bc.data.length})`);Cb.sort();return Cb.join(",")};var fb;(function(xa){xa[xa.valid=0]="valid";xa[xa.destinationRangesIsEmpty=
1]="destinationRangesIsEmpty";xa[xa.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";xa[xa.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";xa[xa.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";xa[xa.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";xa[xa.sourceAndDestinationAreOverlapping=
6]="sourceAndDestinationAreOverlapping";xa[xa.copySourceNotValid=7]="copySourceNotValid";xa[xa.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";xa[xa.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";xa[xa.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";xa[xa.unknown=100]="unknown"})(fb||(fb={}));Object(c.b)("PasteValidationOptions",fb);var Ua=a(52),Ca=a(151),Ia=a(40),oa=a(166),Da=a(356),bb=a(33),Za=a(278),Xa=a(12),Ba=a(23),
Wa=a(138),Na=a(121),ta=a(577),V=a(106),ia=a(62),X=a(100);class la extends Sys.EventArgs{constructor(xa,Cb,bc){super();this.command=xa;this.destinationRange=Cb;this.sourceRange=bc}}Object(c.a)(la,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var sa=a(124),Va=a(71),nb=a(149),ha=a(36);class jb extends Ga{constructor(xa,Cb,bc,Fc){super(xa,Cb,bc,Fc);this.xMi="DragRecoveryUI"}get fyf(){return this.xMi}Pxa(){return jb.mAh}lmd(){return"DragRecoveryUI-Floatie"}}jb.mAh=["DragRecoveryUI"];Object(c.a)(jb,"DragFillRecoveryUI",
Ga,[]);var Fb;(function(xa){xa[xa.source=0]="source";xa[xa.destination=1]="destination"})(Fb||(Fb={}));Object(c.b)("RangeType",Fb);class Rb extends w.a{constructor(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb=null){super();this.pasteShortcutManager=this.Iwa=null;this.cpf=x.EwaSettings.Tb();this.zza=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.Zng=null;this.dab=!1;this.Kzd=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6660890_Tag_aoi75RetryLoggingFix3");this.ZTe=()=>{var qc,
Bc;let $b=null===(qc=this.Iwa)||void 0===qc?void 0:qc.Tpc;null===(Bc=this.Iwa)||void 0===Bc||!Bc.ztf()||M.R(Q.h(this.$).ga.pa.selectedRanges,this.Iwa.jqc)||M.R([Q.h(this.$).ga.pa.activeCell],[$b.activeCell])&&!Q.h(this.$).ga.pa.Hd.isSingle||(this.Iwa.Mka(),this.Iwa=null)};this.UJd=qc=>{this.xTj(qc)&&(this.io.skc(),f.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.yRi=(qc,Bc)=>{f.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${qc}]. userPressedExtensionLink=${Bc}`);this.gridView.focus()};this.Td=(qc,Bc)=>{Bc.uO||Bc.mg||this.ys("OnWorkbookOpened",!1).catch(()=>{})};this.ik=(qc,Bc)=>{qc=R(this.oJ);const $b=this.io.U7a(qc);$b&&(Bc.na&&Bc.na.sheetName===$b.sheetName&&$b.isFromCurrentSession(this.$)?this.io.qkf($b.ranges,qc.commandParameters.commandType):this.io.skc())};this.Quc=
(qc,Bc)=>{qc=R(this.oJ);(qc=this.io.U7a(qc))&&Bc.item&&Bc.item.sheetName===qc.sheetName&&qc.isFromCurrentSession(this.$)&&this.ys("OnItemDeleting",!1).catch(()=>{})};this.KBa=(qc,Bc)=>{this.cpf?this.Zng(qc,Bc):this.URf()};this.QS=(qc,Bc)=>{1===Bc.Pr&&Bc.pg.operation.flags&2&&this.ys("OnQueueItemChanged/ItemRemoved",!1).catch(()=>{})};this.$=xa;this.ag=bc;this.gridView=Q.h(xa);this.io=Tc;this.Evi=gd;this.oJ=Cb;this.cwb=Fc;this.getStringifiedError=Vb||copyPasteInfra.getStringifiedError;this.qhg=1===
kb;this.mj();this.copyPasteShortcutDialogFactory=this.$.da.Ba(85);f.ULS.shipAssertTag(537167825,0,!!this.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");td||(f.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),td=Rb.fvh);this.userHash=d.a.rv(td);this.DVi="CultureTag: "+A.a.instance.kbc+" HASH: ";this.oJ.addMetadataChangeListener(Rb.qEf,this.UJd);this.uUi=aa.a.OIb;this.RAa=this.zza?
x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):r.a.RAa;(this.No=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7568646_PressEnterToPaste"))&&xa.da.Gb(478,qc=>{this.pasteShortcutManager=qc});this.cpf&&(this.Zng=Za.b(()=>{this.URf()},1,this.$.ka,"CopyPasteInfrastructure.OnStartEditInternal",!0))}ycc(){var xa=R(this.oJ);return xa?(xa=xa.sourceItem)&&!xa.isFromCurrentSession(this.$)?(f.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return this.$.da.Ba(373)}gYg(xa){this.addHandler(Rb.QKd,xa)}Wyj(xa){this.removeHandler(Rb.QKd,xa)}copy(xa){xa.stopwatch=this.$.nc.qd("UserAction",z.b().jk(xa.ribbonCommandInfo.command)+"ClientSide");if(this.No){const gd=Ua.GetServiceTaskFactory.Za(this.$.da,478,479,0);Ia.TaskExtensions.za(gd,()=>{this.pasteShortcutManager=gd.result},this.ka,3)}const Cb=!!R(this.oJ);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&
!h.a.pC&&(this.dab=!1);this.ys("Copy/before/"+l.a[xa.ribbonCommandInfo.method],!1,void 0,!0,xa.copyPasteTargetType).catch(()=>{});var bc=-1985798686===xa.ribbonCommandInfo.command;if(1===this.gridView.gf&&(bc=this.io.vpf(this.gridView.ga.pa.selectedRanges,bc),0!==bc)){const gd=Rb.$jh(bc);this.bCa(gd,O[bc],!1);return Promise.reject(!1)}xa.userHash=this.userHash;xa.id=k.a.create().toString();let Fc=this,Tc=this;return this.cwb.onCopy(xa).then(gd=>{gd.isAsyncCopy||xa.stopwatch.stop();Fc.pasteIndicationManager.jVe();
const td=Aa.d(xa);f.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${td}`);Fc.nPi(gd,Cb);gd=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6591921_CheckTargetTypeForEnterToPaste")?1===xa.copyPasteTargetType:!0;!xa.isFormatPainter&&Fc.No&&gd&&(Fc.pasteShortcutManager?Fc.pasteShortcutManager.MCh():f.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},gd=>{let td=!1,kb="none",Vb=Rb.kxb,qc=!0,Bc=-1,$b=
Rb.copyErrorName+Rb.nMa,tc=!1,Xc=null;if(gd){Xc=gd.copyContext;Bc=gd.reason;$b+=Rb.HNa(gd);gd.message&&(Vb=gd.message);var qd=Rb.Zjh(gd);if(qd)if(3===qd.copyErrorName)td=!0,Vb=kb="Async Copy canceled by the user.",qc=!1;else if(bb.a.Aq(qd.ewaErrors))if(Vb=Tc.qhc(qd.ewaErrors),bb.a.Fh(qd.ewaErrors,Rb.operationSucceededWithAlert))tc=td=!0;else if(bb.a.Fh(qd.ewaErrors,Rb.pasteDataLimitHit)||bb.a.Fh(qd.ewaErrors,Rb.copyThrottlingError))td=!0;13===gd.reason?(td=!0,qc=!1):11===gd.reason&&(qc=!1)}qd=gd?
Tc.getStringifiedError(gd):"null";td?(qd=Aa.d(xa),f.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${qc}, Friendly message: ${kb}, Error Message: ${Vb}, CommandParameters: ${qd}`)):f.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${qc}, Error Message: ${qd}, CommandParameters: ${Aa.d(xa)}`);qc&&Tc.ys("Copy/fail/"+l.a[xa.ribbonCommandInfo.method],
!0,void 0,void 0,xa.copyPasteTargetType).catch(()=>{});Tc.mPi(xa,td,Vb,$b,Bc,tc,Xc);return Promise.reject(gd)})}Ehj(xa){if(this.ycc())return X.a(this.Glc(xa.commandType,xa.ribbonCommandInfo));let Cb;Cb=M.d(this.gridView.ga.pa.selectedRanges);xa.originalDestinations=Cb;xa.expandDestinations=this.F7b(xa.originalDestinations,xa.commandType);if(this.P7b(xa.commandType,xa.expandDestinations)||this.dHe())xa.userHash=this.userHash,xa.id=k.a.create().toString(),this.cwb.onPaste(xa).then(()=>Promise.resolve(!0),
bc=>Promise.reject(bc));return Promise.resolve(!0)}D4i(xa){if(xa.method){var Cb={};Cb.activeCell=this.gridView.ga.pa.activeCell;var bc=new jb(this.$,M.d(this.gridView.ga.pa.selectedRanges),M.d(this.gridView.ga.pa.selectedRanges),Cb);Cb=Tc=>{const gd=Ua.GetServiceTaskFactory.Za(this.$.da,406,405,0);Ia.TaskExtensions.za(gd,()=>{xa.method&&Tc(gd.result)},this.ka,8)};var Fc=Tc=>{Tc.qEe(bc);Tc.Tig(xa.method);this.Iwa=Tc};this.Iwa?Fc(this.Iwa):Cb(Fc)}}paste(xa){xa.stopwatch=this.$.nc.qd("UserAction",z.b().jk(xa.ribbonCommandInfo.command)+
"ClientSide");x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.pC&&(f.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.dab=!1,xa.clipboardPicklingApiDataFormatsToRead=[I.shadowWorkbook]);Q.h(this.$).Bh&&Q.h(this.$).Bh.I2(this.jod(xa.ribbonCommandInfo.command),xa.stopwatch.id);if(xa.isPasteCommandFromRecoveryUI){var Cb=this.$.da.Ba(406);var bc=M.d(Cb.jqc);Cb=Cb.Tpc;xa.pasteRecoveryCachedClipboardItems=
Cb?Cb[Rb.dVf]:null}else bc=M.d(this.gridView.ga.pa.selectedRanges);xa.originalDestinations=bc;xa.expandDestinations=this.F7b(xa.originalDestinations,xa.commandType);if(this.P7b(xa.commandType,xa.expandDestinations)||this.dHe())return xa.userHash=this.userHash,xa.id=k.a.create().toString(),x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!h.a.pC&&(xa.clipboardReadPermissionPromptShown=!1,xa.clipboardAsyncApiDataFormatsToRead=[I.plainText+"Async"],this.cwb.shouldShowClipboardReadPermissionDialog().then(Fc=>
{Fc&&(xa.clipboardReadPermissionPromptShown=!0,new y(this.$));return Promise.resolve(!0)},()=>Promise.resolve(!0))),this.cwb.onPaste(xa).then(Fc=>this.qvc(Fc,xa),Fc=>this.gLb(xa,Fc));this.$.xd(927125067,pa.a.Vb,30,null);bc=M.i(xa.expandDestinations,",",this.$,!1);f.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${bc}, CommandType: ${xa.commandType}, copyPasteTargetType="${xa.copyPasteTargetType}"`);
return Promise.resolve(!0)}jod(xa){switch(xa){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}dHe(){return!!Q.h(this.$).ga.Sa.activeFloatingObjectControlId&&this.$.mt(null,!1,470)}Xab(){const xa=R(this.oJ);return xa&&xa.commandParameters?xa.commandParameters.copyPasteTargetType:0}IDi(){return!!R(this.oJ)&&ja(R(this.oJ),this.$)}ys(xa,Cb,bc=!1,Fc=!1,Tc=0){try{this.No&&this.pasteShortcutManager&&this.pasteShortcutManager.Rbc();let gd=
Tc;const td=this.qLi();if(!Fc&&2===td)return f.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${Cb}', isExplicit = '${bc}', isForce = '${Fc}', Current CCP operation copyPasteTargetType = '${Tc}', LastCopyPasteTargetType = '${td}'`),Promise.reject(null);0===gd&&(gd=td);const kb=this.$.nc.qd("UserAction","ClearCopyState"),Vb=kb.id;f.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${Cb}', isExplicit = '${bc}', isForce = '${Fc}', Current CCP operation copyPasteTargetType = '${Tc}', LastCopyPasteTargetType = '${td}'`);
this.io.skc();this.Apj();return this.cwb.onCancelCopy(Cb).then(()=>{Cb&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.pC&&(this.dab=!1);kb.stop();this.Mzf(xa,Vb,!0,bc,Cb,"","",kb.fd,gd);return Promise.resolve(!0)},qc=>{var Bc=qc?this.getStringifiedError(qc):"null";f.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Bc}`);kb.stop();Bc=Rb.Yah+Rb.nMa;let $b=Rb.kxb;qc&&
(Bc+=Rb.HNa(qc),qc.message&&($b=qc.message));this.Mzf(xa,Vb,!1,bc,Cb,$b,Bc,kb.fd,gd);return Promise.reject(qc)})}catch(gd){return Promise.reject(null)}}M8c(xa,Cb,bc=!1,Fc=!1,Tc=0){return Fc||this.ycc()?this.ys(xa,Cb,bc,Fc,Tc):(f.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}bCa(xa,Cb,bc){f.ULS.sendTraceTag(590705172,0,50,
`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${Cb}`);const Fc=new V.a;Fc.ia("reason",Cb);ta.a(Wa.a.discontinuousSelectionBlocking,[bc?Na.a.fhj:Na.a.Ukh],!0,!0,!1,!1,Fc);xa=bb.a.Od(1,1,751,xa,0,371863010,"DiscontinuousSelectionBlocking");x.EwaSettings.wz()?new Da.a(this.$,xa):(xa=new oa.ErrorDialog(this.$,xa),xa.initialize(),xa.Rg())}qLi(){const xa=R(this.oJ);return xa&&xa.sourceItem?Object.getType(xa.sourceItem)===F?2:1:0}dragDropCells(xa,
Cb,bc,Fc,Tc=!1){xa.stopwatch=this.$.nc.qd("UserAction","DragDropClientSide");xa.isDragDrop=!0;this.ys("DragDrop/before/"+l.a[xa.ribbonCommandInfo.method],!1,void 0,void 0,xa.copyPasteTargetType).catch(()=>{});const gd=Tc?2:1;let td=0;td=Tc?4:Fc?256:128;const kb={encounteredDeploymentErrors:!1};kb.commandParameters=xa;xa.userHash=this.userHash;xa.id=k.a.create().toString();return this.Kzd?this.io.pasteRange(xa.ribbonCommandInfo,M.q(Cb,this.$),M.q(bc,this.$),gd,td,[xa.stopwatch],kb,!1,()=>{f.ULS.sendTraceTag(537167818,
0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${xa.copyPasteTargetType}"`);this.qbb(xa,gd,Cb,bc,kb)},Vb=>{this.Ncb(Vb,xa,gd,Cb,bc,kb)}).then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},Vb=>Promise.reject(Vb)):this.io.pasteRange(xa.ribbonCommandInfo,M.q(Cb,this.$),M.q(bc,this.$),gd,td,[xa.stopwatch],kb,!1,null,null).then(()=>{f.ULS.sendTraceTag(521410075,0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${xa.copyPasteTargetType}"`);
this.gridView.ga.selectionType=-1;this.qbb(xa,gd,Cb,bc,kb);return Promise.resolve(!0)},Vb=>{this.Ncb(Vb,xa,gd,Cb,bc,kb);return Promise.reject(Vb)})}lAh(xa,Cb,bc,Fc,Tc=!1){xa.stopwatch=this.$.nc.qd("UserAction","DragDropReplaceClientSide");xa.isDragDrop=!0;this.M8c("DragDropReplace/before/"+l.a[xa.ribbonCommandInfo.method],!1,void 0,void 0,xa.copyPasteTargetType).catch(()=>{});const gd=Tc?2:1;let td=0;td=Tc?4:Fc?256:128;const kb={encounteredDeploymentErrors:!1};kb.commandParameters=xa;x.EwaSettings.getBooleanFeatureGate(aa.a.Bcc,
!1)&&(xa.isDragInsert=!1);xa.userHash=this.userHash;xa.id=k.a.create().toString();return this.Kzd?this.io.pasteRange(xa.ribbonCommandInfo,M.q(Cb,this.$),M.q(bc,this.$),gd,td,[xa.stopwatch],kb,!1,()=>{f.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${xa.copyPasteTargetType}"`);this.qbb(xa,gd,Cb,bc,kb)},Vb=>this.Ncb(Vb,xa,gd,Cb,bc,kb)).then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},Vb=>Promise.reject(Vb)):this.io.pasteRange(xa.ribbonCommandInfo,
M.q(Cb,this.$),M.q(bc,this.$),gd,td,[xa.stopwatch],kb,!1,null,null).then(()=>{f.ULS.sendTraceTag(521410073,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${xa.copyPasteTargetType}"`);this.gridView.ga.selectionType=-1;this.qbb(xa,gd,Cb,bc,kb);return Promise.resolve(!0)},Vb=>{this.Ncb(Vb,xa,gd,Cb,bc,kb);return Promise.reject(Vb)})}kAh(xa,Cb,bc,Fc,Tc=!1){xa.stopwatch=this.$.nc.qd("UserAction","DragDropInsertClientSide");this.M8c("DragDropInsert/before/"+l.a[xa.ribbonCommandInfo.method],
!1,void 0,void 0,xa.copyPasteTargetType).catch(()=>{});const gd=Tc?2:1,td=M.L(this.F7b([bc],gd));var kb=this.$.ea.na.sheetName;const Vb=this.$.ea.na.sheetName,qc=M.v(Cb,this.$);qc.SheetName=kb;kb=M.v(td,this.$);kb.SheetName=Vb;Fc=td.isRow||Cb.isRow||Fc?1:0;const Bc={encounteredDeploymentErrors:!1};xa.isDragInsert=!0;Bc.commandParameters=xa;xa.userHash=this.userHash;xa.id=k.a.create().toString();if(this.Kzd)return Tc=this.io.sVe(Bc,qc,kb,Tc,Fc,xa.ribbonCommandInfo,()=>{f.ULS.sendTraceTag(537167814,
0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${xa.copyPasteTargetType}"`);this.qbb(xa,gd,Cb,bc,Bc)},tc=>{this.Ncb(tc,xa,gd,Cb,bc,Bc)}),X.d(Tc.then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},tc=>Promise.reject(tc))).Xp(()=>!0);Tc=this.io.sVe(Bc,qc,kb,Tc,Fc,xa.ribbonCommandInfo,null,null);let $b=this;return X.d(Tc.then(()=>{f.ULS.sendTraceTag(521410071,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${xa.copyPasteTargetType}"`);
this.gridView.ga.selectionType=-1;this.qbb(xa,gd,Cb,bc,Bc);return Promise.resolve(!0)},tc=>{$b.Ncb(tc,xa,gd,Cb,bc,Bc);return Promise.reject(tc)})).Xp(()=>!0)}Glc(xa,Cb,bc,Fc,Tc,gd){var td=R(this.oJ);if(!td)return f.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),ia.Task.Ua(!1);if(!B(td.sourceItem))return f.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),ia.Task.Ua(!1);var kb=td.sourceItem;if(!kb)return f.ULS.shipAssertTag(537167810,
0,!!kb,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),ia.Task.Ua(!1);if(!kb.isFromCurrentSession(this.$)&&!aa.a.PPa)return f.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),ia.Task.Ua(!1);if(1<kb.ranges.length)return f.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.bCa(2192,"InsertCopiedCutCells",!0),ia.Task.Ua(!1);td=M.L(kb.ranges);var Vb=this.gridView.ga.pa.Hd.clone();
xa=M.L(this.F7b([Vb],xa));const qc=this.txf();kb=kb.sheetName;Vb=this.$.ea.na.sheetName;const Bc=M.v(td,this.$);Bc.SheetName=kb;const $b=M.v(xa,this.$);$b.SheetName=Vb;kb=this.gridView.ga.pa.activeRange;const tc=()=>{f.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},Xc=()=>{f.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(xa.gh||td.gh||x.EwaSettings.isChangeGateEnabled("OfficeVSO:7578311_InsertCopiedCutCellsDefaultShiftInTable")&&
this.io.rVj(this.$,td,kb)?ia.Task.Ua(0):xa.isRow||td.isRow||x.EwaSettings.isChangeGateEnabled("OfficeVSO:7578311_InsertCopiedCutCellsDefaultShiftInTable")&&this.io.sVj(this.$,td,kb)?ia.Task.Ua(1):this.Evi.G$b(this.$,Q.h(this.$).rtl)).Xp(qd=>!this.ycc()&&aa.a.PPa?this.io.executeInsertCopiedCutCellsAcrossSession(Bc,$b,qc,qd.result,Cb,tc,Xc,bc,Fc,Tc,gd):this.io.executeInsertCopiedCutCellsOperation(Bc,$b,qc,qd.result,Cb,null,null)).continueWith(()=>{!x.EwaSettings.isChangeGateEnabled("OfficeVSO:7646005_InsertCopiedCutCellsClearState")&&
qc?this.io.skc():this.ys("InsertCopiedCutCells/success/"+l.a[Cb.method],!0)})}rFb(){const xa=R(this.oJ),Cb=this.gridView.ga.pa.Lh;return!!xa&&B(xa.sourceItem)&&Cb&&1===xa.sourceItem.ranges.length}txf(){return this.uxf(-911352779)}kzd(){var xa,Cb;const bc=R(this.oJ);return bc?(null===(xa=bc.asyncClipboardItemsKeys)||void 0===xa?void 0:xa.includes(I.shadowWorkbook))||(null===(Cb=bc.syncClipboardItemsKeys)||void 0===Cb?void 0:Cb.includes(I.shadowWorkbook))||3!==bc.copyStatus:!1}iqc(){return this.uxf(-1985798686)}P7b(xa,
Cb){var bc=new Ca.a(this.$.ua),Fc=36===xa;const Tc=bc.xe(4);xa=2===this.Xab()&&bc.xe(1);Fc=Fc&&Tc;bc=!bc.$h||!this.iqc()||!Ca.a.occ(Cb,Q.h(this.$));return Fc||xa||this.$.mt(Cb,!0)&&bc}fFb(xa,Cb){return this.io.fFb(xa,Cb)}dispose(){super.dispose();this.oj();this.oJ.removeMetadataChangeListener(Rb.qEf)}ced(xa,Cb,bc,Fc,Tc,gd){if(!this.Teh(xa.commandParameters.ribbonCommandInfo.command))return xa.cseStatus=2,!1;if(gd&&Cb.Nd(Fc))return xa.cseStatus=4,!1;if(bc!==Tc)return xa.cseStatus=6,!1;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(Fc.width%Cb.width||Fc.height%Cb.height))return xa.cseStatus=16,!1;if(x.EwaSettings.getBooleanFeatureGate(aa.a.OQe,!1)){if(bc=Cb,Fc=Fc.Ue(this.gridView.hk),Cb=null===Cb.Ue(this.gridView.hk),Tc=xa.commandParameters.ribbonCommandInfo.command,Cb&&1804571062!==Tc&&-185374993!==Tc||!Fc)return xa.cseStatus=7,!1}else if(bc=Cb.Ue(this.gridView.hk),Fc=Fc.Ue(this.gridView.hk),!bc||!Fc)return xa.cseStatus=7,!1;if(aa.a.yEe){Cb=this.xEe(this.gridView,xa.commandParameters.ribbonCommandInfo.command,bc,Fb.source);
if(0!==Cb)return xa.cseStatus=Cb,!1;Cb=this.xEe(this.gridView,xa.commandParameters.ribbonCommandInfo.command,Fc,Fb.destination);if(0!==Cb)return xa.cseStatus=Cb,!1}Cb=M.v(bc,this.$);Cb=this.ag.khj(this.gridView,Cb,M.v(Fc,this.$),xa.commandParameters.ribbonCommandInfo.command,xa.commandParameters.stopwatch);1===Cb&&(gd&&(this.ag.D8c(bc,!1),this.ag.D8c(bc,!0)),gd=new la(xa.commandParameters.ribbonCommandInfo.command,Fc,bc),Q.h(this.$).d_f(gd),this.pasteIndicationManager.ukc(xa.commandParameters.id),
this.rQb(xa.commandParameters.expandDestinations,xa.commandParameters.isPasteCommandFromRecoveryUI),this.L8c("DoPasteClientEstimation/"+l.a[xa.commandParameters.ribbonCommandInfo.method],xa));xa.cseStatus=Cb;return 1===Cb}xEe(xa,Cb,bc,Fc){const Tc=new sa.a("CopyPasteInfrastructure.blockCseForPaste",xa,bc);try{for(;Tc.moveNext();){let gd=Tc.get_current().cell;if(gd.GA)return 8;if(237279923===Cb||-185374993===Cb){if(gd.YT&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste"))return 18;
if(gd.bO&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste"))return 19}if(Fc===Fb.source){if(gd.bea)return 23;if(gd.yzd)return 24;if(gd.hasIgnorableError)return 25;if((237279923===Cb||1804571062===Cb)&&this.UFi(xa,bc))return 20;if(237279923===Cb){if(gd.Hma)return 22;if(gd.hasHyperlink||gd.vna)return 21}}}}finally{Tc&&Tc.dispose()}return 0}sWf(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.yRi)}cRi(xa,Cb,bc,Fc){xa=E(xa,Cb,bc,Fc,this.$.xa.UserSessionId);
xa.k=!0;z.b().Df(45,xa,!0)}T$i(xa,Cb,bc,Fc,Tc){var gd=!1,td=!1,kb=Rb.kxb,Vb=Rb.lVe+Rb.nMa;xa&&(Vb+=Rb.HNa(xa),bb.a.Aq(xa.ewaErrors)?(kb=this.qhc(xa.ewaErrors),bb.a.Fh(xa.ewaErrors,[-103190598])&&(gd=!0)):xa.message&&(kb=xa.message));td||(td=this.Iwd(xa));Cb=E(Cb,bc,Fc,Tc,this.$.xa.UserSessionId);Cb.k=!1;Cb.l=td;Cb.n=kb;Cb.p=Vb;Cb.q=gd;z.b().Df(45,Cb,!0);return Promise.reject(xa)}UFi(xa,Cb){const bc=xa.sj("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new v.Range(Cb.top,Cb.right,Cb.bottom,
Cb.right,!0,!0));for(;bc.$$mn();){let Fc=bc.$$cu();if(Fc&&Fc.Fya())return f.ULS.sendTraceTag(509436432,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0}for(xa=xa.sj("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new v.Range(Cb.bottom,Cb.left,Cb.bottom,Cb.right,!0,!0));xa.$$mn();)if((Cb=xa.$$cu())&&Cb.Bya())return f.ULS.sendTraceTag(509436431,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0;return!1}I3g(xa,
Cb,bc){xa.cseStatus=0;xa.cseStatus=this.uBi(xa.commandParameters.ribbonCommandInfo.command,bc,this.gridView,Cb);if(0!==xa.cseStatus)return!1;xa.cseStatus=this.ag.lhj(this.gridView,Cb,bc,xa.commandParameters.stopwatch);Cb=new la(xa.commandParameters.ribbonCommandInfo.command,bc,null);1===xa.cseStatus&&(Q.h(this.$).d_f(Cb),this.pasteIndicationManager.ukc(xa.commandParameters.id),this.rQb(xa.commandParameters.expandDestinations,xa.commandParameters.isPasteCommandFromRecoveryUI),this.L8c("AttemptExternalPlainTextPasteClientEstimation/"+
l.a[xa.commandParameters.ribbonCommandInfo.method],xa));return 1===xa.cseStatus}uBi(xa,Cb,bc,Fc){if(-875588320!==xa&&-185374993!==xa&&237279923!==xa)return 2;if(bc.Mb.TPa(Cb))return 8;if(bc.Mb.xAd(Cb))return 18;if(bc.Mb.YW(Cb))return 11;if(this.ag.TUe(Cb))return 12;xa=this.x$g(Cb,Fc);return Q.j(this.gridView,xa)?0:7}x$g(xa,Cb){var bc=Cb.indexOf("\r");bc=-1!==bc?"\n"===Cb[bc+1]?Cb.split("\r\n"):Cb.split("\r"):Cb.split("\n");Cb=bc.length;bc=bc[0].split("\t").length;return new v.Range(xa.top,xa.left,
xa.top+Cb-1,xa.left+bc-1,!0,!0)}Teh(xa){switch(xa){case 237279923:case 808159687:return x.EwaSettings.isChangeGateEnabled("OfficeVSO:7317055_PasteCse");case -185374993:return!0;case 1804571062:return!0;default:return!1}}uxf(xa){const Cb=R(this.oJ);if(!Cb)return!1;const bc=Cb.sourceItem;return aa.a.PPa||!bc||bc.isFromCurrentSession(this.$)?Cb.commandParameters.ribbonCommandInfo.command===xa:(f.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),
!1)}xTj(xa){return xa&&xa.lastCopy?ja(xa.lastCopy,this.$):!0}U9e(xa,Cb,bc,Fc,Tc){const gd={};gd.a=this.$.xa.UserSessionId;gd.e=xa.stopwatch.id;gd.c=z.b().jk(xa.ribbonCommandInfo.command);gd.b=l.a[xa.ribbonCommandInfo.method];gd.d=xa.id;gd.f=bc.toString();gd.g=Fc.toString();gd.h=Cb.toString();gd.o=xa.stopwatch.fd;gd.q=!1;gd.r=xa.copyPasteTargetType.toString();gd.s=Tc.encounteredDeploymentErrors;x.EwaSettings.getBooleanFeatureGate(aa.a.Bcc,!1)&&(gd.i=Tc.commandParameters.dragDropIsShiftKeyDown,gd.j=
Tc.commandParameters.isDragInsert);return gd}qbb(xa,Cb,bc,Fc,Tc){xa=this.U9e(xa,Cb,bc,Fc,Tc);xa.k=!0;z.b().Df(45,xa,!0)}vPi(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){xa=this.U9e(xa,Cb,bc,Fc,Vb);xa.k=!1;xa.l=Tc;xa.n=gd;xa.p=td;xa.q=kb;z.b().Df(45,xa,!0)}Mzf(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){const qc={};qc.a=this.$.xa.UserSessionId;qc.b=Cb;qc.c=xa;qc.f=bc;qc.e=Fc;qc.d=Tc;qc.g=gd;qc.h=td;qc.i=kb;qc.j=Vb.toString();z.b().Df(46,qc,!0)}nPi(xa,Cb){xa=this.p9e(xa.commandParameters,xa);xa.l=!0;xa.j=Cb;z.b().Df(43,xa,!0)}mPi(xa,
Cb,bc,Fc,Tc,gd,td){xa=this.p9e(xa,td);xa.l=!1;xa.m=Cb;xa.o=bc;xa.y=Fc;xa.x=Tc;xa.z=gd;z.b().Df(43,xa,!0);f.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${xa.y},ErrorReason=${xa.x},IsExpectedError=${xa.m},IsSucceededWithAlert=${xa.z},ErrorMessage=${xa.o}`)}p9e(xa,Cb){const bc={};bc.a=this.$.xa.UserSessionId;bc.f=xa.stopwatch.id;bc.g=xa.id;bc.c=z.b().jk(xa.ribbonCommandInfo.command);bc.b=l.a[xa.ribbonCommandInfo.method];bc.q=xa.stopwatch.fd;bc.bd=Rb.Dgc();
bc.bg=xa.copyPasteHandlerName;bc.bj=void 0===xa.ribbonCommandInfo.yf||null===xa.ribbonCommandInfo.yf?null:n.a[xa.ribbonCommandInfo.yf];bc.bq=xa.uploadToClipService;bc.br=xa.floatingObjectType;bc.s=xa.copyPasteTargetType.toString();bc.bc=za(xa.copyPasteTargetType);bc.z=!1;if(Cb){bc.bk=Cb.id;bc.bl=Cb.serverRequestTimeInMs;Cb.requestTelemetryData&&(bc.bm=Cb.requestTelemetryData.EcsOperationDuration,bc.bn=Cb.requestTelemetryData.EcsRequestDuration,bc.bo=Cb.requestTelemetryData.WfeRequestDuration);bc.d=
Cb.sourceItem?Cb.sourceItem.toString():null;bc.e=-1;if(B(Cb.sourceItem)){bc.e=0;xa=Cb.sourceItem.ranges;for(const Fc of xa)bc.e+=Fc.sw}bc.h=Cb.isAsyncCopy;bc.i=Cb.isFromCache;bc.k=Cb.isSelectionAllowed;bc.r=Cb.plainTextPayloadSize;bc.u=Cb.htmlPayloadSize;bc.v=Cb.htmlSizeExceedsLimit;bc.w=Cb.copyTotalSizeExceedsLimit;bc.t=Cb.shadowWorkbookPayloadSize;bc.p=Cb.clientSideCopyTime;bc.ba=Cb.encounteredDeploymentErrors;bc.bb=Cb.shadowWorkbookSizeExceedsLimit;bc.be=Cb.syncClipboardItemsKeys;bc.bf=Cb.asyncClipboardItemsKeys;
bc.bh=this.BNe(Cb.succeededPopulatingSystemClipboardSync);bc.bi=this.BNe(Cb.succeededPopulatingSystemClipboardAsync)}return bc}rQb(xa,Cb=!1){if(!this.gridView.Eb&&!this.gridView.Wi){var bc=this.gridView.ga.pa,Fc=!Cb&&1===xa.length&&M.R(xa,bc.selectedRanges),Tc=Fc?bc.activeCell:xa[0].topLeft;xa[0].contains(Tc)||(f.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${bc.selectedRanges}, IndexOfActiveRange ${bc.Hr}, ActiveCell ${bc.activeCell}, calculatedDestinationRanges ${xa}, keepThePreviousActiveCell ${Fc}, newActiveCell ${Tc}, isPasteCommandFromRecoveryUI ${Cb}`),
Tc=xa[0].topLeft);this.gridView.ga.jH(xa,0,Tc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}zcf(xa,Cb){const bc={};bc.a=this.$.xa.UserSessionId;bc.g=xa.stopwatch.id;bc.t=xa.stopwatch.fd;bc.bz=!1;Cb&&(bc.bv=Cb.id,bc.bw=Cb.serverRequestTimeInMs,bc.n=Cb.commandParameters.clipboardFormatReadTimes,bc.o=Cb.commandParameters.clipboardFormatReadStatus,bc.p=Cb.commandParameters.clipboardReadPermissionPromptShown,bc.q=Cb.commandParameters.asyncApiReadTimedOut,Cb.requestTelemetryData&&(bc.cb=Cb.requestTelemetryData.EcsOperationDuration,
bc.cc=Cb.requestTelemetryData.EcsRequestDuration,bc.cd=Cb.requestTelemetryData.WfeRequestDuration));bc.x=xa.copyPasteTargetType.toString();bc.bl=za(xa.copyPasteTargetType);bc.br=xa.copyPasteHandlerName;bc.i=M.i(xa.expandDestinations,",",this.$,!1);bc.h=M.i(xa.originalDestinations,",",this.$,!1);bc.e=xa.id;bc.d=xa.commandType;bc.c=z.b().jk(xa.ribbonCommandInfo.command);bc.b=l.a[xa.ribbonCommandInfo.method];bc.bf=!1;bc.bg=!1;bc.bp=Rb.Dgc();bc.bt=void 0===xa.ribbonCommandInfo.yf||null===xa.ribbonCommandInfo.yf?
null:n.a[xa.ribbonCommandInfo.yf];bc.cj=xa.isPasteCommandFromEnterShortcut;if(bc.ca=xa.isPasteCommandFromRecoveryUI)bc.cf=xa.pasteRecoveryUndoStopwatch.id,bc.cg=xa.pasteRecoveryUndoStopwatch.fd;if(Cb){if((xa=Cb.copyContextSnapshot)&&!Cb.wasLastCopyExternal){bc.f=xa.commandParameters.id;bc.j=xa.sourceItem.toString();bc.k=-1;if(B(xa.sourceItem)){bc.k=0;const Fc=xa.sourceItem.ranges;for(const Tc of Fc)bc.k+=Tc.sw}bc.bg=1===xa.commandParameters.commandType}else Cb.clipboardItems?bc.f=Cb.clipboardItems.getItem(I.m4a):
f.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");bc.bz=Cb.pasteRecoveryUIDisplayed;bc.ci=Cb.cseStatus}else f.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return bc}KQi(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){xa=this.zcf(xa,kb);xa.l=!1;xa.m=Cb;xa.s=bc;xa.bc=Fc;xa.be=Tc;xa.bd=gd;xa.bf=td;kb?(xa.y=S(kb)||!kb.copyContextSnapshot,xa.bi=!xa.y&&ja(kb.copyContextSnapshot,this.$),xa.bj=kb.shadowWorkbookSizeExceedsLimit,
xa.v=kb.shadowWorkbookPayloadSize,xa.w=kb.htmlPayloadSize,xa.bq=ra(kb.clipboardItems),xa.bb=kb.activeSelectionType,xa.bs=kb.isSameSession,xa.bn=kb.payloadOrigin,xa.bo=kb.payloadType,xa.bu=kb.externalAppSource,xa.bx=kb.indicationDisplayScheduled,xa.by=kb.pasteIndicationDisplayStatus,xa.ck=kb.pasteDestinationHasMergedCells):xa.bi=ja(Vb,this.$);z.b().Df(44,xa,!0);f.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${xa.be},ErrorReason=${xa.bd},IsExpectedError=${xa.m},IsSucceededWithAlert=${xa.bf},ErrorMessage=${xa.s}`)}LQi(xa){const Cb=
this.zcf(xa.commandParameters,xa);Cb.y=xa.wasLastCopyExternal;Cb.l=!0;Cb.u=xa.plainTextPayloadSize;Cb.v=xa.shadowWorkbookPayloadSize;Cb.w=xa.htmlPayloadSize;Cb.z=xa.isClipboardDataContainShadowWorkbook;Cb.ba=xa.isShadowWorkbookParsedSuccessfully;Cb.bb=xa.activeSelectionType;Cb.bc=xa.pasteResult;Cb.bh=xa.encounteredDeploymentErrors;Cb.bj=xa.shadowWorkbookSizeExceedsLimit;Cb.bk=L(xa);Cb.bq=ra(xa.clipboardItems);Cb.bs=xa.isSameSession;Cb.bn=xa.payloadOrigin;Cb.bo=xa.payloadType;Cb.bu=xa.externalAppSource;
Cb.bx=xa.indicationDisplayScheduled;Cb.by=xa.pasteIndicationDisplayStatus;Cb.ck=xa.pasteDestinationHasMergedCells;Cb.bm=xa.clipboardItems?xa.clipboardItems.getItem(I.Mdh):null;Cb.bi=!xa.isSameSession&&!xa.wasLastCopyExternal;Cb.ci=xa.cseStatus;z.b().Df(44,Cb,!0)}mj(){aa.a.Sxb&&this.gridView.ga.EK(this.ZTe);this.$.ua.Lg(this.ik);this.$.ua.nXg(this.Quc);this.$.userOperationManager.ks(this.QS);this.$.Ql(this.Td);Q.h(this.$).wc.ao(this.KBa)}oj(){this.$&&this.$.ua&&(aa.a.Sxb&&this.gridView.ga.sP(this.ZTe),
this.$.ua.ih(this.ik),this.$.ua.nyj(this.Quc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.Uo(this.QS);this.gridView&&this.gridView.wc&&this.gridView.wc.Un(this.KBa)}gLb(xa,Cb){var bc=null;let Fc=!1;var Tc=null;let gd="UnknownFailure",td=-1,kb=Rb.kxb,Vb=Rb.pasteErrorName+Rb.nMa,qc=!1;this.pasteIndicationManager.ukc(xa.id);this.pasteDestinationHasMergedCells(xa.expandDestinations)&&(Cb.pasteContext.pasteDestinationHasMergedCells=!0);const Bc=R(this.oJ);(xa.clearStateOnFinish||
xa.clearSystemClipboard)&&this.ys("Paste/fail/"+l.a[xa.ribbonCommandInfo.method],!0,void 0,void 0,xa.copyPasteTargetType).catch(()=>{});if(Cb){td=Cb.reason;Vb+=Rb.HNa(Cb);Cb.message&&(kb=Cb.message);if(bc=Rb.mkh(Cb))if(1===bc.pasteErrorName)Fc=!0,gd="CopyPasteLengthTooLongPopup",kb=Tc="The pasted content is too long. Popup a dialog to the user.",f.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Tc}, copyPasteTargetType="${xa.copyPasteTargetType}"`),bc=bb.a.Od(1,0,26,690,0,
1306609195,"CopyPasteOversizeError"),x.EwaSettings.wz()?new Da.a(this.$,bc):(bc=new oa.ErrorDialog(this.$,bc),bc.initialize(),bc.Rg());else if(7===bc.pasteErrorName)Fc=!0,gd="No-Op",kb=Tc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",f.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Tc}, copyPasteTargetType="${xa.copyPasteTargetType}"`);else if(8===bc.pasteErrorName)Fc=!0,gd="UseShortcutsPopup",kb=Tc="Unable to paste content from the system clipboard. Popup dialog to the user.",
f.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Tc}, copyPasteTargetType="${xa.copyPasteTargetType}"`),this.sWf();else if(18===bc.pasteErrorName){Fc=!0;gd="PasteExternalNotSupportMultipleSelectionPopup";kb="Paste external not support multiple selection.";Tc="Unknown";var $b=2192;100!==bc.validationFailureReason&&(Tc=fb[bc.validationFailureReason],$b=Rb.tNe(bc.validationFailureReason));this.bCa($b,Tc,!0)}else 20===bc.pasteErrorName||19===bc.pasteErrorName?(Fc=!0,20===bc.pasteErrorName?
(gd="PasteAcrossSessionNotSupportMultipleSelectionPopup",kb="Paste across session does not support multiple selection."):(gd="PasteInSameSessionNotSupportMultipleSelectionPopup",kb="This kind of multiple selection is not supported for same session paste."),Tc="Unknown",$b=2192,100!==bc.validationFailureReason&&(Tc=fb[bc.validationFailureReason],$b=Rb.tNe(bc.validationFailureReason)),bc=6===bc.validationFailureReason,this.P7b(xa.commandType,xa.expandDestinations)&&bc&&this.rQb(xa.expandDestinations),
this.bCa($b,Tc,!0)):6===bc.pasteErrorName?(Fc=!0,gd="No-Op",kb=Tc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",f.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Tc}, copyPasteTargetType="${xa.copyPasteTargetType}"`)):17===bc.pasteErrorName?(Fc=!0,gd="No-Op",kb=Tc="Paste text on Art is not yet a supported operation",f.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Tc}, copyPasteTargetType="${xa.copyPasteTargetType}"`)):
16===bc.pasteErrorName?(Fc=!0,gd="No-Op",kb=Tc="Paste has failed because the previous copy has failed",bc=this.getStringifiedError(bc),f.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Tc}, copyPasteTargetType="${xa.copyPasteTargetType}", error=${bc}`)):bb.a.Aq(bc.ewaErrors)?(bb.a.wba(bc.ewaErrors)||bb.a.Fh(bc.ewaErrors,bb.a.fjc())?(Fc=!0,gd="CommunicationError",Tc=bb.a.Ic(bc.ewaErrors),f.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${kb} copyPasteTargetType="${xa.copyPasteTargetType}"`)):
bb.a.Fh(bc.ewaErrors,Rb.TGj)?(Fc=!0,gd="SavingWorkbookError",Tc=bb.a.Ic(bc.ewaErrors),f.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${kb} copyPasteTargetType="${xa.copyPasteTargetType}"`)):bb.a.Fh(bc.ewaErrors,Rb.operationSucceededWithAlert)&&(qc=Fc=!0,gd="OperationSucceededWithAlert",Tc=bb.a.Ic(bc.ewaErrors),f.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${kb} copyPasteTargetType="${xa.copyPasteTargetType}"`)),Fc||(kb=this.qhc(bc.ewaErrors),Fc=
this.Iwd(Cb))):11===bc.pasteErrorName&&(Fc=!0,gd="No-Op",kb="Paste has failed because user try copy cross-session oart object");15===Cb.reason&&(Fc=!0,gd="No-Op",kb="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");Ba.a.equals(Vb,D.Mhk,!1)&&(Fc=!0,gd="No-Op",kb="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Fc||(bc=Cb?this.getStringifiedError(Cb):"null",
f.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${bc}, copyPasteTargetType="${xa.copyPasteTargetType}"`));this.KQi(xa,Fc,kb,gd,Vb,td,qc,Cb.pasteContext,Bc);return Promise.reject(Cb)}qvc(xa,Cb){var bc;f.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${Cb.copyPasteTargetType}"`);this.pasteIndicationManager.ukc(Cb.id);if(this.qhj(Cb.copyPasteTargetType,xa)){x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!h.a.pC&&xa.wasLastCopyExternal&&xa.payloadType===Z.shadowWorkbook&&(this.dab=!0);let Fc=null;(null===(bc=xa.pastedRange)||void 0===bc?0:bc.Ranges)&&0<xa.pastedRange.Ranges.length?Fc=M.g(xa.pastedRange.Ranges):xa.wasLastCopyExternal||(Fc=Cb.expandDestinations);this.MIj(xa,Fc);if(this.NVj(xa,Fc)){let Tc;bc=M.d(Cb.originalDestinations);Tc=1028===Cb.commandType?M.d(Cb.expandDestinations):M.d(Fc);let gd=null;xa.wasLastCopyExternal&&(Cb.isKeyboardEvent||Cb.isPasteCommandFromRecoveryUI)&&(gd={[Rb.dVf]:xa.clipboardItems});
this.pasteDestinationHasMergedCells(Cb.expandDestinations)&&(xa.pasteDestinationHasMergedCells=!0);xa.pasteRecoveryUIDisplayed=!0;const td=new Ga(this.$,bc,Tc,gd),kb=Ua.GetServiceTaskFactory.Za(this.$.da,406,405,0);Ia.TaskExtensions.za(kb,()=>{const Vb=kb.result;Vb.qEe(td);Vb.Tig(Cb.ribbonCommandInfo.method)},this.ka,8)}this.n3i(xa,Fc)}this.L8c("Paste/success/"+l.a[Cb.ribbonCommandInfo.method],xa);this.LQi(xa);this.qhg&&(!Cb.isKeyboardEvent||L(xa))&&this.$.ea.oh.get(66)&&(f.ULS.sendTraceTag(537167770,
0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.qhg=!1,this.Ulh());return Promise.resolve(!0)}n3i(xa,Cb){Ia.TaskExtensions.za(Ua.GetServiceTaskFactory.Za(this.$.da,534,535,1),bc=>{bc.result.T9j(xa,Cb)},this.$.ka,3)}NVj(xa,Cb){return!Cb||1!==Cb.length||xa.commandParameters.clearSystemClipboard||xa.commandParameters.clearStateOnFinish||xa.commandParameters.skipClipboardAccess?!1:S(xa)&&(Cb=xa.clipboardItems.getItem(I.plainText),xa=xa.clipboardItems.getItem(I.html),
void 0===Cb||null===Cb||Cb.length>this.uUi||void 0===xa||null===xa||xa.length>this.RAa)?(f.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}qhj(xa,Cb){return 1===xa||Cb.payloadType===Z.plainText||x.EwaSettings.ya(151)&&Cb.payloadType===Z.html||x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.pC&&Cb.payloadType===Z.shadowWorkbook}pasteDestinationHasMergedCells(xa){const Cb=
Q.h(this.$).Ca.lz();if(!Cb||!Cb.length)return!1;for(const bc of Cb)if(bc.Cv(xa[0]))return!0;return!1}L8c(xa,Cb){let bc;({xKa:bc}=this.Dzi(Cb)).returnValue&&this.ys(xa,bc,void 0,void 0,Cb.commandParameters.copyPasteTargetType).catch(()=>{})}Ncb(xa,Cb,bc,Fc,Tc,gd){const td=xa?this.getStringifiedError(xa):"null";let kb=!1,Vb=!1,qc=!1,Bc=Rb.kxb,$b=Rb.lVe+Rb.nMa;xa&&($b+=Rb.HNa(xa),bb.a.Aq(xa.ewaErrors)?(Bc=this.qhc(xa.ewaErrors),bb.a.Fh(xa.ewaErrors,Rb.operationSucceededWithAlert)&&(kb=!0),bb.a.Fh(xa.ewaErrors,
Rb.dragDropNonEmptyRange)&&(Vb=qc=!0)):xa.message&&(Bc=xa.message));qc||(qc=this.Iwd(xa));Vb?this.gridView.ga.selectionType=-1:this.io.xsj(Tc);qc||f.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${td}, copyPasteTargetType="${Cb.copyPasteTargetType}`);this.vPi(Cb,bc,Fc,Tc,qc,Bc,$b,kb,gd)}F7b(xa,Cb){let bc=xa;const Fc=this.J8h();if(null===Fc||void 0===Fc?0:Fc.ranges)bc=this.io.O$g(Cb,Fc.ranges,xa);return bc}J8h(){const xa=R(this.oJ);return xa&&B(xa.sourceItem)?xa.sourceItem:
null}Apj(){this.raiseEvent(Rb.QKd,null)}MIj(xa,Cb){const bc=xa.commandParameters.originalDestinations;Cb&&(M.R(this.gridView.ga.pa.selectedRanges,bc)?(this.rQb(Cb),xa=Xa.HelperMethods.htb(Cb),f.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${xa}`)):xa.commandParameters.isPasteCommandFromRecoveryUI?(this.rQb(Cb,!0),f.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${Cb}, active cell: ${Cb[0].topLeft}`)):
(xa=Xa.HelperMethods.htb(bc),f.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${xa}`)))}Dzi(xa){if(xa.isPlainTextPaste||xa.isHtmlPaste||J(xa)||xa.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,xKa:!1};var Cb=xa.copyContextSnapshot;if(xa.commandParameters.clearStateOnFinish)return{returnValue:!0,xKa:!0};if(Cb&&B(Cb.sourceItem)){var bc=Cb.sourceItem;
if(!bc.isFromCurrentSession(this.$))return{returnValue:!1,xKa:!0};Cb=-1985798686===Cb.commandParameters.ribbonCommandInfo.command;if(!(1<bc.ranges.length||1<xa.commandParameters.expandDestinations.length)){const Fc=M.L(bc.ranges);xa=M.L(xa.commandParameters.expandDestinations);const Tc=this.$.ea.na.sheetName;bc=bc.sheetName;if(bc===Tc&&xa.equals(Fc))return{returnValue:!1,xKa:!0};if(bc===Tc&&xa.Ue(Fc))return{returnValue:!0,xKa:!1}}return{returnValue:Cb,xKa:!0}}return{returnValue:!1,xKa:!0}}URf(){var xa=
R(this.oJ);(xa=this.io.U7a(xa))&&xa.isFromCurrentSession(this.$)&&this.ys("OnStartEdit",!1).catch(()=>{})}qhc(xa){xa=bb.a.f5h(xa,Rb.nMa);return this.DVi+d.a.rv(xa).toString()}Iwd(xa){xa=Rb.HNa(xa);return!!xa&&Ba.a.M5a(xa,Rb.CVi)}Ulh(){const xa=bb.a.Od(1,2,327,328,h.a.rp?329:h.a.YI?330:331,530046625,"ActivateLocalStorage"),Cb=Object(Va.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(X.d)(nb.a.resolve(ha.h,{Wa:0})):Ua.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ia.TaskExtensions.za(Cb,
()=>{Cb.result.zh(43,xa)},this.ka,3)}BNe(xa){return void 0===xa||null===xa?ya.QYi:xa?ya.success:ya.failed}static mkh(xa){const Cb=xa.innerError;return Cb&&0!==Cb.pasteErrorName?xa.innerError:null}static Zjh(xa){const Cb=xa.innerError;return Cb&&0!==Cb.copyErrorName?xa.innerError:null}static HNa(xa){let Cb="";if(!xa)return Rb.YRe;xa.errorName&&(Cb=xa.errorName,xa.innerError&&(Cb+=Rb.nMa+Rb.HNa(xa.innerError)));Cb||(Cb=xa&&xa.name?xa.name:Rb.YRe);return Cb}static Dgc(){Rb.Nb||(Rb.Nb=fa.o_j);return Rb.Nb}static tNe(xa){switch(xa){case 7:case 1:return 2199;
case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return f.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${xa}`),2199}}static $jh(xa){switch(xa){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;default:return f.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${xa}`),
2199}}}Rb.qEf="EwaJsMetadataChangeListenerId";Rb.QKd="cpiOSC";Rb.fvh="cpiDID";Rb.kxb="Unknown";Rb.YRe="UnknownError";Rb.nMa="_";Rb.lVe="DragAndDropError";Rb.pasteErrorName="PasteError";Rb.Yah="CancelError";Rb.copyErrorName="CopyError";Rb.CVi="MergedCellOverlap";Rb.dVf="PasteRecoveryCachedClipboardItems";Rb.TGj=[1352631530,1679665408];Rb.operationSucceededWithAlert=[-103190598];Rb.pasteDataLimitHit=[1306609195];Rb.copyThrottlingError=[-386183710];Rb.dragDropNonEmptyRange=[563945982];Rb.Nb=null;Object(c.a)(Rb,
"CopyPasteInfrastructure",w.a,[409,410,2]);class mb{constructor(){this.J3a=this.oKe=null}}Object(c.a)(mb,"ClipboardPlatformInitializationResult",null,[]);var sb=a(199),Ya=a(662),Ma=a(563),xb=a(234),qb=a(134),Ra=a(7),Jb=a(58);const yb=(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb,qc=null)=>{Vb=xa.Pa(9,Vb);Vb.sourceRanges=Cb;Vb.destinationRanges=bc;Vb.flags=Fc;return Jb.g(xa,"PasteRange",Vb,Tc,gd,td,kb,64,qc)},Gb=(xa,Cb,bc,Fc,Tc,gd,td,kb=null)=>{td=xa.Pa(1,td);td.pasteHtmlParameters=Cb;return Jb.g(xa,"PasteHtmlContent",
td,bc,Fc,Tc,gd,64,kb)},ub=(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb=null)=>{kb=xa.Pa(9,kb);kb.destinationRange=Cb;kb.source=bc;return Jb.g(xa,"PasteString",kb,Fc,Tc,gd,td,64,Vb)},Ja=(xa,Cb,bc,Fc,Tc,gd,td=null,kb=null)=>{td=xa.Pa(1,td);td.copyParameters=Cb;return Jb.g(xa,"Copy",td,bc,Fc,Tc,gd,0,kb)},zb=(xa,Cb,bc,Fc,Tc,gd,td=null,kb=null)=>{td=xa.Pa(1,td);td.copyParameters=Cb;return Jb.g(xa,"Cut",td,bc,Fc,Tc,gd,0,kb)},na=(xa,Cb,bc,Fc,Tc,gd,td=null,kb=null)=>{td=xa.Pa(1,td);td.pasteParameters=Cb;return Jb.g(xa,"Paste",
td,bc,Fc,Tc,gd,64,kb)};class Ea{constructor(xa,Cb,bc){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=xa;this.destinationRange=Cb;this.pasteFlags=bc}}Object(c.a)(Ea,"MacroRecorderPasteRangePayload",null,[139]);class ma{constructor(xa,Cb){this.content=this.destinationRange=null;this.destinationRange=xa;this.content=Cb}getContent(){return this.content}}Object(c.a)(ma,"MacroRecorderPasteStringPayload",null,[139]);var Ka=a(73);class cb{constructor(xa){this.pasteParameters=
null;this.pasteParameters=xa}}Object(c.a)(cb,"MacroRecorderPastePayload",null,[139]);var Fa=a(600),wa=a(794),ka=a(200),Oa=a(30),hb=a(215),Pa=a(120),ca=a(246),ba=a(354);const ib=(xa,Cb,bc,Fc,Tc,gd,td=null)=>{td=xa.Pa(41,td);td.insertCopiedCutCellsParameters=Cb;return Jb.g(xa,"InsertCopiedCutCells",td,bc,Fc,Tc,gd,4)},Lb=(xa,Cb,bc,Fc,Tc,gd,td=null)=>{td=xa.Pa(41,td);td.insertCopiedCutCellsParameters=Cb;return Jb.g(xa,"InsertCopiedCutCellsV2",td,bc,Fc,Tc,gd,0)},gc=(xa,Cb,bc,Fc,Tc,gd,td=null)=>{td=xa.Pa(41,
td);td.insertCopiedCutCellsParameters=Cb;return Jb.g(xa,"InsertCopiedCutCellsCrossSession",td,bc,Fc,Tc,gd,0)};class Gc{constructor(xa){this.parameters=null;this.parameters=xa}getParameters(){return this.parameters}}Object(c.a)(Gc,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[139]);var Kb=a(382);class pb{constructor(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){this.destinationRange=xa;this.m4a=bc;this.ihj=Fc;this.Wd=Tc;this.iVb=gd;this.pasteContext=td;this.F8b=kb;this.ipg=Vb}}Object(c.a)(pb,"PasteHtmlRequestParams",
null,[]);class nc{constructor(xa,Cb){this.Wpc=this.IQa=null;this.OSa=aa.a.OSa;this.hMd=aa.a.hMd;this.OIb=aa.a.OIb;this.Imc=x.EwaSettings.getBooleanFeatureGate(aa.a.Kwb,!1);this.pDi=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7316963_InsertCopiedCutCellsV2Enabled");this.evd=!1;this.zza=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.jDi=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimitsForPasteString",!1);this.VA=(bc,Fc)=>
{if(2===Fc.Pr)this.Tw.clear(),this.IQa=null;else if(1===Fc.Pr&&this.Tw&&this.Tw.contains(Fc.pg)){bc=qb.a(Fc.pg.operation.operationName);const Tc=Fc.pg.dequeueUtcTime.getTime()-Fc.pg.enqueueUtcTime.getTime();f.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${bc} returned, it took ${Tc} milliseconds to complete.`);this.Tw.remove(Fc.pg);this.IQa=null}};this.$=xa;this.gridView=Cb;this.evd&&(this.$.userOperationManager.ks(this.VA),this.Tw=new sb.a)}get RAa(){return this.zza?
x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):r.a.RAa}copy(xa,Cb,bc,Fc=null,Tc=null){const gd=this.$.qa.va.Bc();this.evd&&this.IZ();this.Wpc=gd.ClientRequestId;var td=new ka.a(505,0,(kb,Vb,qc)=>{const Bc={CopyPasteTargetType:1};Bc.SourceRanges=xa;Bc.CopyOperationId=Cb.id;f.ULS.sendTraceTag(537167756,0,50,`CopyPasteInfrastructure.Copy served from CopyPasteProxy : ${this.zza}, CopyOperationId : ${Bc.CopyOperationId}`);return this.IQa=
this.zza?Ja(this.$.qa.zw,Bc,ca.b(kb,bc),Fc?ca.a(Vb,Fc):Vb,qc,Cb.ribbonCommandInfo,gd,Tc):Ja(this.$.qa.va,Bc,ca.b(kb,bc),Fc?ca.a(Vb,Fc):Vb,qc,Cb.ribbonCommandInfo,gd,Tc)},80);td=this.$.userOperationManager.kd(td,Cb.ribbonCommandInfo);this.evd&&this.Tw.add(td)}cVf(xa,Cb,bc,Fc,Tc,gd){return new Promise((td,kb)=>{var Vb;const qc=gd.commandParameters.stopwatch.fd;let Bc=2;20===gd.commandParameters.commandType&&(Bc=16);36===gd.commandParameters.commandType&&(Bc=32);68===gd.commandParameters.commandType&&
(Bc=64);Oa.a.sAd(this.$)&&1028===gd.commandParameters.commandType&&(Bc=1024);let $b=null;if(null===(Vb=gd.copyContextSnapshot)||void 0===Vb?0:Vb.commandParameters)$b=gd.copyContextSnapshot.commandParameters.id;nc.NWd(this.$,xa,Fc,Cb,bc,null,tc=>{nc.Hjc(tc,gd,td,kb,qc,this.$,null,!0,null,null)},tc=>{gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.fd-qc;tc=Pa.a.lf(tc.data);kb(new wa.a(5,tc))},Tc,Bc,$b,gd.commandParameters.id)})}pasteRange(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb,qc){return new Promise((Bc,
$b)=>{const tc=td.commandParameters.stopwatch.fd;nc.WJj(this.$,xa,Cb,bc,Fc|-5&Tc,Xc=>{nc.Hjc(Xc,td,Bc,$b,tc,this.$,null,!0,Vb,qc)},Xc=>{td.serverRequestTimeInMs=td.commandParameters.stopwatch.fd-tc;Xc=Pa.a.lf(Xc.data);Xc=new wa.a(5,Xc);null===qc||void 0===qc?void 0:qc(Xc);$b(Xc)},gd,kb)})}Cmj(xa,Cb,bc,Fc,Tc,gd,td){return(new Promise((kb,Vb)=>{if(Cb)if(Cb.length>this.RAa){var qc=td.clipboardItems.getItem(I.plainText);let Bc=-1;void 0!==qc&&null!==qc&&(Bc=qc.length);aa.a.vqf&&Cb.length<this.hMd&&Cb.length>
this.OSa&&(this.kWf(Cb),this.EX=new pb(xa,Cb,bc,Fc,Tc,gd,td,0,this.Pwc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.xMd()));f.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${Cb.length}, MaxHtmlImportLength: ${this.RAa}, PlainTextLength: ${Bc}`);Vb(new wa.a(1))}else qc=new ka.a(204,0,(Bc,$b,tc)=>{this.$.Kz();const Xc=td.commandParameters.stopwatch.fd;Bc=ca.b(Bc,ge=>{nc.Hjc(ge,td,kb,Vb,Xc,this.$,
Cb,!1,null,null)});$b=ca.a($b,ge=>{td.serverRequestTimeInMs=td.commandParameters.stopwatch.fd-Xc;ge=Pa.a.lf(ge.data);Vb(new wa.a(3,ge))});const qd=this.$.qa.va.Bc(),Cd=M.v(xa,this.$),Xd={};Xd.SourceHtml=Cb;Xd.DestinationRanges=Cd?M.s(Cd):null;Xd.CopyOperationId=bc;Xd.PasteId=Fc;f.ULS.sendTraceTag(537167755,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.zza}. PasteId : ${Xd.PasteId}`);return this.zza?Gb(this.$.qa.zw,Xd,Bc,$b,tc,null,qd,gd):Gb(this.$.qa.va,Xd,Bc,
$b,tc,null,qd,gd)},65),this.$.userOperationManager.kd(qc,Tc);else kb("")})).then(()=>{aa.a.vqf&&Cb.length>this.OSa&&(this.kWf(Cb),this.EX=new pb(xa,Cb,bc,Fc,Tc,gd,td,0,this.Pwc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.xMd()))})}kWf(xa){const Cb=this.$.nc.qd("Task","pasteHtmlChunkOperation"),bc=Math.floor(xa.length/this.OSa)+1;this.Pwc=Array(bc);let Fc=0;for(;Fc<bc;)this.Pwc[Fc]=xa.substring(Fc*this.OSa,(Fc+1)*this.OSa),Fc++;f.ULS.sendTraceTag(523257954,0,50,`CopyPasteUtils.populatePasteChunks Time taken for chunking: ${Cb.fd}`)}xMd(){this.hhj(this.EX.destinationRange,
this.Pwc[this.EX.F8b],this.EX.m4a,this.EX.ihj,this.EX.Wd,this.EX.iVb,this.EX.pasteContext,this.EX.F8b,this.EX.ipg);this.EX.F8b++;this.EX.F8b<this.EX.ipg&&window.requestIdleCallback(()=>this.xMd())}hhj(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){const qc=new ka.a(204,0,(Bc,$b,tc)=>{const Xc=td.commandParameters.stopwatch.fd;Bc=ca.b(Bc,()=>{f.ULS.sendTraceTag(512313415,0,15,`CopyPasteUtils.pasteHtmlServerCall succeeded serverRequestTimeInMs:${td.commandParameters.stopwatch.fd-Xc},
             pasteid:${Fc},
             chunkIndex:${kb},
             totalChunks:${Vb}`)});$b=ca.a($b,()=>{td.serverRequestTimeInMs=td.commandParameters.stopwatch.fd-Xc;f.ULS.sendTraceTag(512313414,0,15,`CopyPasteUtils.pasteHtmlServerCall failed serverRequestTimeInMs:${td.serverRequestTimeInMs},
               pasteid:${Fc},
               chunkIndex:${kb},
               totalChunks:${Vb}`)});const qd=this.$.qa.va.Bc();var Cd=M.v(xa,this.$);Cd={SourceHtml:Cb,DestinationRanges:Cd?M.s(Cd):null,CopyOperationId:bc,PasteId:`${Fc}_chunk_${kb}`,ChunkIndex:kb,TotalChunks:Vb};f.ULS.sendTraceTag(523257952,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.zza}. PasteId : ${Cd.PasteId}`);return Gb(this.$.qa.zw,Cd,Bc,$b,tc,null,qd,gd)},65);this.$.userOperationManager.kd(qc,Tc)}Dmj(xa,Cb,bc,Fc,Tc){return new Promise((gd,td)=>{f.ULS.sendTraceTag(537167754,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Tc.id}`);Cb&&(Cb=Ba.a.trimEnd(Cb,"\n","\r"));f.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Tc.id}`);if(Cb)if(Cb.length>this.OIb)f.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Cb.length,this.OIb),td(new wa.a(1));
else{let Vb,qc;const Bc=M.v(xa,this.$);f.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Tc.id}`);var kb=!this.$.ea.isNamedObjectViewMode&&!Cb.includes("\n")&&!Cb.includes("\t");f.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Tc.id}. treatAsLink=${kb}`);kb=kb&&Ba.a.Zrf(Cb);f.ULS.sendTraceTag(537167750,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Tc.id}. treatAsLink=${kb}`);
const $b=this.$.qa.va.Bc();if(kb){qc=526;f.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Tc.id}`);const tc=hb.a.ljd(Cb);f.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Tc.id}`);const Xc=M.s(Bc);kb=(qd,Cd,Xd)=>{const ge=Tc.commandParameters.stopwatch.fd;qd=ca.b(qd,ve=>{f.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Tc.id}`);
Tc.requestTelemetryData=ve.RequestTelemetryData;Tc.serverRequestTimeInMs=Tc.commandParameters.stopwatch.fd-ge;ve.Errors&&0<ve.Errors.length?td(new wa.a(2,ve.Errors)):gd(Cb)});Cd=ca.a(Cd,ve=>{Tc.serverRequestTimeInMs=Tc.commandParameters.stopwatch.fd-ge;ve=Pa.a.lf(ve.data);td(new wa.a(2,ve))});this.$.Kz();f.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Tc.id}`);return Jb.b(this.$.qa.va,Xc,Cb,tc,!1,!1,63,qd,Cd,Xd,
xa,$b,Fc)};Vb=()=>new Fa.a(Xc,Cb,tc)}else qc=180,kb=(tc,Xc,qd)=>{this.$.Kz();const Cd=Tc.commandParameters.stopwatch.fd;tc=ca.b(tc,Xd=>{f.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Tc.id}`);nc.Hjc(Xd,Tc,gd,td,Cd,this.$,Cb,!1,null,null)});Xc=ca.a(Xc,Xd=>{Tc.serverRequestTimeInMs=Tc.commandParameters.stopwatch.fd-Cd;Xd=Pa.a.lf(Xd.data);td(new wa.a(4,Xd))});f.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Tc.id}`);
return ub(this.jDi?this.$.qa.zw:this.$.qa.va,Bc,Cb,tc,Xc,qd,null,$b,Fc)},Vb=()=>new ma(Bc,Cb);f.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Tc.id}`);kb=new ka.a(qc,0,kb,65,Vb);f.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Tc.id}`);this.$.userOperationManager.kd(kb,bc)}else gd("")})}qkf(xa,Cb){Cb=[1===Cb?4:5];this.gridView.dc.iB(ba.a.qEa(Ka.d(this.$.na),
xa),Cb,!0);this.gridView.dc.Ur(Cb);this.gridView.dc.update(!0)}skc(){const xa=[4,5];this.gridView.dc.Hk(xa,!1,!1);this.gridView.dc.il(null,xa,!1);1===this.gridView.ga.gf&&this.gridView.Ur(!1,!1);this.gridView.dc.update(!1,!1)}O$g(xa,Cb,bc){const Fc=[];for(const Tc of bc)Fc.push(this.U$g(xa,Cb,Tc));return Fc}IZ(){if(this.Tw)for(let xa of this.Tw)if(this.$&&this.$.userOperationManager){if(xa.operation){const Cb=qb.a(xa.operation.operationName);f.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${Cb}.`)}this.Wah();
this.$.userOperationManager.uwa(xa)}}Wah(){if(this.IQa){const xa=this.IQa.pv;f.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${xa}`);Pa.a.cw(xa);!x.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.Wpc&&Jb.h(this.$.qa.va,this.Wpc,null,null,null);this.Wpc=this.IQa=null}}U$g(xa,Cb,bc){f.ULS.shipAssertTag(537167713,0,!!Cb,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");f.ULS.shipAssertTag(537167712,0,0<Cb.length,
"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let Fc=0,Tc=0;var gd=new Set;const td=new Set;for(const kb of Cb){Cb=`${kb.left}_${kb.right}`;const Vb=`${kb.top}_${kb.bottom}`;td.has(Cb)||(td.add(Cb),Tc+=kb.width);gd.has(Vb)||(gd.add(Vb),Fc+=kb.height)}if(36===xa)return bc.isSingle?nc.u2e(Tc,Fc,bc):bc.clone();516===xa&&(xa=Fc,Fc=Tc,Tc=xa);xa=!(bc.width%Tc)&&!(bc.height%Fc);gd=bc.gX&&!(bc.height%Fc);bc.J7&&!(bc.width%Tc)||gd?bc=nc.u2e(Tc,Fc,bc):xa?bc=bc.clone():
(bc=bc.clone(),bc.bottom=Math.min(r.a.Hg,bc.top+Fc-1),bc.right=Math.min(r.a.Gg,bc.left+Tc-1));return bc}n2g(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb,qc,Bc){if(!Fc||!Fc.length)return 1;if(1<Fc.length){if(!this.Imc&&gd)return 3;if(qc)return 0;if(kb)return 9;if(Vb)return 8;if(Bc)return 2;if(1<Cb.length)return 4;const $b=Cb[0];if(!td&&!xb.a.all(Fc,tc=>tc.isSingle||!(tc.width%$b.width)&&!(tc.height%$b.height)))return 5;if((!this.Imc||!gd)&&Ba.a.equals(xa,bc,!0))for(const tc of Tc)if(tc.Nd($b)&&!tc.equals($b))return 6}else if(Cb&&
0<Cb.length){if(0!==this.vpf(Cb,Vb))return 7;if(1<Cb.length){if(!this.Imc&&gd)return 3;if((!this.Imc||!gd)&&Ba.a.equals(xa,bc,!0))for(const $b of Cb)if(xa=Tc[0],$b.Nd(xa)&&!$b.equals(xa))return 6}}return 0}vpf(xa,Cb){if(!xa||1>=xa.length)return 0;if(Cb)return 2;if(!M.T(xa))return 1;Cb=new Ya.a(Ma.a.Ah());for(const bc of xa)for(const Fc of xa){const Tc=bc.top===Fc.top&&bc.bottom===Fc.bottom,gd=bc.left===Fc.left&&bc.right===Fc.right,td=Math.max(bc.left,Fc.left)<Math.min(bc.right,Fc.right);if(Math.max(bc.top,
Fc.top)<Math.min(bc.bottom,Fc.bottom)&&!Tc||td&&!gd)return 3;Cb.add(`${bc.top}-${bc.bottom}-${Fc.left}-${Fc.right}`);Cb.add(`${Fc.top}-${Fc.bottom}-${bc.left}-${bc.right}`)}for(const bc of xa)Cb.remove(`${bc.top}-${bc.bottom}-${bc.left}-${bc.right}`);return 0<Cb.count?3:0}xsj(xa){const Cb=this.gridView.ga;Cb.updateSelection(xa,xa.topLeft,0);Cb.selectionType=-1}U7a(xa){if(null===xa||void 0===xa?0:xa.sourceItem){if(!B(xa.sourceItem))return null;if((xa=xa.sourceItem)&&M.db(xa.ranges,!0))return xa}return null}fFb(xa,
Cb){f.ULS.shipAssertTag(537167711,0,!!xa,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Cb&&Ra.a.cF in Cb||xa.tabName?!1:1===xa.method}static WJj(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){const qc=xa.qa.va.Bc(Vb?{joa:!0,bna:1}:{joa:!1,bna:0});Vb=new ka.a(506,0,(Bc,$b,tc)=>{xa.Kz();return yb(xa.qa.va,bc,Fc,Tc,ca.b(Bc,gd),ca.a($b,td),tc,null,qc,kb)},65,()=>new Ea(bc,Fc,Tc));xa.userOperationManager.kd(Vb,Cb)}static Hjc(xa,Cb,bc,Fc,Tc,gd,td=null,kb,Vb,qc){f.ULS.sendTraceTag(537167710,
0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${Cb.id}`);Cb.requestTelemetryData=xa.RequestTelemetryData;Cb.serverRequestTimeInMs=Cb.commandParameters.stopwatch.fd-Tc;bb.a.Zf(xa.Errors)?bb.a.oja(xa.Errors)?(Cb&&(Cb.encounteredDeploymentErrors=!0),xa=bb.a.Ic(xa.Errors),f.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${xa}`)):
(xa=new wa.a(5,xa.Errors),null===qc||void 0===qc?void 0:qc(xa),Fc(xa)):xa.Result?(Fc=!!xa&&!!xa.RequestTelemetryData,Q.h(gd).Bh.loa(Cb.commandParameters.stopwatch.id,xa.StateId,Fc?xa.RequestTelemetryData.EcsOperationDuration:0,Fc?xa.RequestTelemetryData.EcsRequestDuration:0,Fc?xa.RequestTelemetryData.WfeRequestDuration:0),Cb.pastedRange=xa.Result.SheetMultiRange,f.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${Cb.id}`),
null===Vb||void 0===Vb?void 0:Vb(),bc(!0),x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&kb&&!Cb.commandParameters.isDragDrop&&(Cb=gd.da.Ba(465))&&Cb.r$(6,xa)):(f.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${Cb.id}`),bc(td||!0))}static NWd(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb,qc,Bc,$b){const tc=xa.qa.va.Bc(),Xc=nc.SPe(bc,
Fc,Tc,qc,Bc,$b);bc=new ka.a(503,0,(qd,Cd,Xd)=>{xa.Kz();return na(xa.qa.va,Xc,ca.b(qd,td),ca.a(Cd,kb),Xd,gd,tc,Vb)},65,()=>new cb(Xc));xa.userOperationManager.kd(bc,Cb)}static SPe(xa,Cb,bc,Fc,Tc,gd){const td={};td.ShadowWorkbookBase64=xa.shadowWorkbookBase64;td.SourceRanges={};td.SourceRanges.Ranges=Array(1);td.SourceRanges.Ranges[0]={};td.SourceRanges.Ranges[0].FirstRow=xa.rangeRowStart;td.SourceRanges.Ranges[0].LastRow=xa.rangeRowEnd;td.SourceRanges.Ranges[0].FirstColumn=xa.rangeColumnStart;td.SourceRanges.Ranges[0].LastColumn=
xa.rangeColumnEnd;x.EwaSettings.getBooleanFeatureGate(aa.a.Kwb,!1)?bc?td.DestinationRanges=M.u(bc.SheetName,bc.NamedObjectName,M.g(bc.Ranges)):(f.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),td.DestinationRanges=null):td.DestinationRanges=Cb?M.s(Cb):null;td.CopyPasteTargetType=1;td.PasteType=Fc;td.CopyOperationId=Tc;td.PasteId=gd;td.SourceClientPath=xa.sourceClientPath;td.SourceSheetName=xa.sourceSheetName;td.SourceWorkbookName=xa.sourceWorkbookName;
if(!xa.originalSourceRangesCountExceedsLimit&&xa.originalSourceRanges&&0<xa.originalSourceRanges.length&&1024===Fc){td.OriginalSourceMultiRange={};Cb=Array(xa.originalSourceRanges.length);for(bc=0;bc<Cb.length;++bc)Cb[bc]={},Cb[bc].FirstRow=xa.originalSourceRanges[bc][0],Cb[bc].FirstColumn=xa.originalSourceRanges[bc][1],Cb[bc].LastRow=xa.originalSourceRanges[bc][2],Cb[bc].LastColumn=xa.originalSourceRanges[bc][3];td.OriginalSourceMultiRange.Ranges=Cb}return td}static u2e(xa,Cb,bc){bc=bc.clone();bc.height<
Cb&&(bc.bottom=Math.min(r.a.Hg,bc.top+Cb-1));bc.width<xa&&(bc.right=Math.min(r.a.Gg,bc.left+xa-1));return bc}sVj(xa,Cb,bc){return(xa=Q.h(xa).Mb.ph(bc))?Cb.width===xa.usedRange.width&&bc.left===xa.usedRange.left||bc.left===xa.usedRange.left&&bc.right===xa.usedRange.right&&0===bc.width%Cb.width:!1}rVj(xa,Cb,bc){return(xa=Q.h(xa).Mb.ph(bc))?Cb.height===xa.usedRange.height&&bc.top===xa.usedRange.top||bc.top===xa.usedRange.top&&bc.bottom===xa.usedRange.bottom&&0===bc.height%Cb.height:!1}executeInsertCopiedCutCellsOperation(xa,
Cb,bc,Fc,Tc,gd=null,td=null){const kb={};kb.InsertDirection=Fc;kb.SourceRange=xa;kb.DestRange=Cb;kb.CopyCutOperation=bc?0:1;const Vb=this.$.qa.va,qc=this.$.qa.va.Bc(),Bc=()=>new Gc(kb);return Kb.a(this.$.userOperationManager,($b,tc,Xc)=>this.pDi?Lb(Vb,kb,gd?ca.b($b,gd):$b,td?ca.a(tc,td):tc,Xc,qc):ib(Vb,kb,gd?ca.b($b,gd):$b,td?ca.a(tc,td):tc,Xc,null),$b=>new ka.a(104,0,$b,void 0,Bc),Tc,x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}sVe(xa,
Cb,bc,Fc,Tc,gd,td,kb){return new Promise((Vb,qc)=>{this.executeInsertCopiedCutCellsOperation(Cb,bc,Fc,Tc,gd,Bc=>{xa.requestTelemetryData=Bc.RequestTelemetryData;if(Bc.Errors&&0<Bc.Errors.length){const $b=new wa.a(21,Bc.Errors);null===kb||void 0===kb?void 0:kb($b);qc(new wa.a(21,Bc.Errors))}else null===td||void 0===td?void 0:td(),Vb(!0)},Bc=>{Bc=Pa.a.lf(Bc.data);Bc=new wa.a(21,Bc);null===kb||void 0===kb?void 0:kb(Bc);qc(Bc)})})}executeInsertCopiedCutCellsAcrossSession(xa,Cb,bc,Fc,Tc,gd=null,td=null,
kb,Vb,qc,Bc){let $b={};$b.PasteParameters=nc.SPe(qc,kb,Vb,2,Bc.copyContextSnapshot.commandParameters.id,Bc.commandParameters.id);$b.InsertDirection=Fc;$b.SourceRange=xa;$b.DestRange=Cb;$b.CopyCutOperation=bc?0:1;const tc=this.$.qa.va,Xc=this.$.qa.va.Bc(),qd=()=>new Gc($b);return Kb.a(this.$.userOperationManager,(Cd,Xd,ge)=>gc(tc,$b,gd?ca.b(Cd,gd):Cd,td?ca.a(Xd,td):Xd,ge,Xc),Cd=>new ka.a(106,0,Cd,void 0,qd),Tc)}}Object(c.a)(nc,"CopyPasteUtils",null,[408]);var Wb=a(503),Ha;(function(xa){xa[xa.range=
0]="range";xa[xa.art=1]="art"})(Ha||(Ha={}));Object(c.b)("SourceItemType",Ha);var $a=a(91);class Nb{constructor(xa){this.Olg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1};this.RSb={};this.Klg={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,
["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.y4c={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.Nlg={["RibbonCommand.Copy"]:-911352779,
["RibbonCommand.Cut"]:-1985798686};this.WUd={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut"};this.Mlg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.Zma={};this.Llg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.Q6a={};this.Plg={["UILocation.Unknown"]:0,
["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,
["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.Ws={};this.$=xa;this.Zma.notDefined="InputManager.InputMethod.NotDefined";this.Zma.unknown="InputManager.InputMethod.Unknown";this.Zma.keyboard="InputManager.InputMethod.Keyboard";this.Zma.mouse="InputManager.InputMethod.Mouse";this.Zma.touch="InputManager.InputMethod.Touch";this.Zma.crossSlide="InputManager.InputMethod.CrossSlide";
this.Q6a.none="FrameMode.None";this.Q6a.reading="FrameMode.Reading";this.Q6a.edit="FrameMode.Edit";this.Ws.unknown="UILocation.Unknown";this.Ws.upperRibbon="UILocation.UpperRibbon";this.Ws.ribbon="UILocation.Ribbon";this.Ws.QAT="UILocation.QAT";this.Ws.jewel="UILocation.Jewel";this.Ws.navigationPane="UILocation.NavigationPane";this.Ws.keyboardShortcut="UILocation.KeyboardShortcut";this.Ws.statusBar="UILocation.StatusBar";this.Ws.dialog="UILocation.Dialog";this.Ws.floatie="UILocation.Floatie";this.Ws.notificationBar=
"UILocation.NotificationBar";this.Ws.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Ws.taskPane="UILocation.TaskPane";this.Ws.heroDock="UILocation.HeroDock";this.Ws.singleLineRibbon="UILocation.SingleLineRibbon";this.Ws.multilineRibbon="UILocation.MultilineRibbon";this.Ws.overflow="UILocation.Overflow";this.Ws.tellMe="UILocation.TellMe";this.Ws.farPeripheralControls="UILocation.FarPeripheralControls";this.Ws.header="UILocation.Header";this.Ws.fileMenu="UILocation.FileMenu";this.Ws.contextMenu=
"UILocation.ContextMenu";this.Ws.dialogMenu="UILocation.DialogMenu";this.Ws.toolbar="UILocation.Toolbar";this.Ws.canvas="UILocation.Canvas";this.RSb.range="SourceItemType.Range";this.RSb.art="SourceItemType.Art"}serializeSourceItem(xa){const Cb={};if(xa&&Object.getType(xa)===P)Cb.sheetName=xa.sheetName,Cb.topArray=xb.a.map(xa.ranges,bc=>bc.top),Cb.leftArray=xb.a.map(xa.ranges,bc=>bc.left),Cb.bottomArray=xb.a.map(xa.ranges,bc=>bc.bottom),Cb.rightArray=xb.a.map(xa.ranges,bc=>bc.right),Cb.sessionStateId=
xa.sessionStateId,Cb.sessionId=xa.sessionId,Cb.sourceItemType=this.xbg(0);else if(xa&&Object.getType(xa)===F)Cb.activeFloatingObjectControlId=xa.activeFloatingObjectControlId,Cb.sheetName=xa.sheetName,Cb.sessionStateId=xa.sessionStateId,Cb.sessionId=xa.sessionId,Cb.floatingObjectType=this.xKj(xa.type),Cb.sourceItemType=this.xbg(1);else return f.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Cb)}serializeCommandParameters(xa){if(!xa)return f.ULS.shipAssertTag(537167704,
0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const Cb={};Cb.id=xa.id;Cb.commandType=xa.commandType;Cb.copyPasteTargetType=xa.copyPasteTargetType;xa.ribbonCommandInfo&&(Cb.ribbonCommandName=this.HKj(xa.ribbonCommandInfo.command),Cb.inputMethodName=this.BKj(xa.ribbonCommandInfo.method),Cb.frameModeName=this.zKj(xa.ribbonCommandInfo.mode),Cb.uiLocationName=this.LKj(xa.ribbonCommandInfo.yf),Cb.tabName=xa.ribbonCommandInfo.tabName);return JSON.stringify(Cb)}deserializeSourceItem(xa){if(!xa)return null;
try{const Cb=JSON.parse(xa);if(!Cb)return f.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let bc=null;switch(this.lwh(Cb.sourceItemType)){case 0:bc=new P(this.$,this.iwh(Cb),Cb.sheetName,Cb.sessionStateId,Cb.sessionId);break;case 1:bc=new F(Cb.activeFloatingObjectControlId,Cb.sheetName,Cb.sessionStateId,Cb.sessionId,this.fwh(Cb.floatingObjectType))}return bc}catch(Cb){return f.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${xa?
xa.length:0}, errror: ${Cb}`),null}}deserializeCommandParameters(xa){if(!xa)return null;try{const Cb=JSON.parse(xa);if(!Cb)return f.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const bc=Aa.a();bc.id=Cb.id;bc.ribbonCommandInfo=this.kwh(Cb);bc.commandType=Cb.commandType;bc.copyPasteTargetType=Cb.copyPasteTargetType;return bc}catch(Cb){return f.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${xa?
xa.length:0}, errror: ${Cb}`),null}}iwh(xa){const Cb=[];f.ULS.shipAssertTag(537167699,0,!!xa.topArray&&0<xa.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${xa.topArray?"empty":"null"}.`);f.ULS.shipAssertTag(537167698,0,!!xa.leftArray&&0<xa.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${xa.leftArray?"empty":"null"}.`);f.ULS.shipAssertTag(537167697,0,!!xa.bottomArray&&0<xa.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${xa.bottomArray?
"empty":"null"}.`);f.ULS.shipAssertTag(537167696,0,!!xa.rightArray&&0<xa.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${xa.rightArray?"empty":"null"}.`);if(!(xa.topArray&&xa.leftArray&&xa.bottomArray&&xa.rightArray))return Cb;f.ULS.shipAssertTag(537167695,0,xa.topArray.length===xa.bottomArray.length&&xa.topArray.length===xa.leftArray.length&&xa.topArray.length===xa.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${xa.topArray.length}), BottomArray(${xa.bottomArray.length}), LeftArray(${xa.leftArray.length}), RightArray(${xa.rightArray.length}) should be the same.`);
const bc=Math.min(xa.topArray.length,xa.bottomArray.length,xa.leftArray.length,xa.rightArray.length);for(let Fc=0;Fc<bc;Fc++)Cb.push(new v.Range(xa.topArray[Fc],xa.leftArray[Fc],xa.bottomArray[Fc],xa.rightArray[Fc],!1,!1));return Cb}kwh(xa){return new $a.a(this.jwh(xa.ribbonCommandName),this.hwh(xa.inputMethodName),this.gwh(xa.frameModeName),this.nwh(xa.uiLocationName),xa.tabName)}HKj(xa){return void 0!==xa&&null!==xa&&xa.toString()in this.WUd?this.WUd[xa.toString()]:(f.ULS.shipAssertTag(537167694,
0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${xa}`),this.WUd["-911352779"])}jwh(xa){return xa&&xa in this.Nlg?this.Nlg[xa]:(f.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${xa}`),-911352779)}BKj(xa){return void 0!==xa&&null!==xa&&l.a[xa]in this.Zma?
this.Zma[l.a[xa]]:(f.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${xa}`),this.Zma.unknown)}hwh(xa){return xa&&xa in this.Mlg?this.Mlg[xa]:(f.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${xa}`),0)}zKj(xa){return void 0!==xa&&null!==xa&&Wb.a[xa]in this.Q6a?this.Q6a[Wb.a[xa]]:(f.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${xa}`),
this.Q6a.edit)}gwh(xa){return xa&&xa in this.Llg?this.Llg[xa]:(f.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${xa}`),2)}xbg(xa){return void 0!==xa&&null!==xa&&Ha[xa]in this.RSb?this.RSb[Ha[xa]]:(f.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${xa}`),this.RSb.range)}lwh(xa){return xa&&xa in this.Olg?this.Olg[xa]:(f.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${xa}`),
0)}xKj(xa){return void 0!==xa&&null!==xa&&xa.toString()in this.y4c?this.y4c[xa.toString()]:(f.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${xa}`),this.y4c["99"])}fwh(xa){return xa&&xa in this.Klg?this.Klg[xa]:(f.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${xa}`),99)}LKj(xa){return void 0!==xa&&null!==xa&&n.a[xa]in this.Ws?this.Ws[n.a[xa]]:(f.ULS.shipAssertTag(36229129,
0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${xa}`),this.Ws.ribbon)}nwh(xa){return xa&&xa in this.Plg?this.Plg[xa]:(f.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${xa}`),2)}}Object(c.a)(Nb,"EnvironmentSerializationHelper",null,[]);var rb=a(6);class ec{}ec.O9f="SameSession";ec.Nbd="CrossSession";ec.hyf="LegacyCrossSession";ec.external="External";Object(c.a)(ec,"PayloadOrigin",null,[]);const pc=xa=>xa?
xa.shadowWorkbookSizeExceedsLimit&&void 0!==xa.shadowWorkbookBlockedSize&&null!==xa.shadowWorkbookBlockedSize?xa.shadowWorkbookBlockedSize:xa.shadowWorkbookBase64?xa.shadowWorkbookBase64.length:0:0,vb=xa=>xa.shadowWorkbookSizeExceedsLimit?!0:pc(xa)>r.a.isc;var ob=a(66),Tb=a(177),Rd=a(128);class Jd{constructor(xa,Cb,bc=null){this.kJa=!1;this._name=Cb;this.$=xa;this.Wm=A.a.instance;this.io=new nc(xa,Q.h(xa));this.p$b=bc}get name(){return this._name}get B4c(){return this.Wm.Ha(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}fak(xa){let Cb;
Cb=null;try{const bc=xa.getItem(I.shadowWorkbook);if(!bc)return{returnValue:!1,wY:Cb};Cb=JSON.parse(bc);return{returnValue:this.zJi(Cb),wY:Cb}}catch(bc){return f.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+bc),{returnValue:!1,wY:Cb}}}zJi(xa){return!!xa&&(!!xa.shadowWorkbookBase64||xa.shadowWorkbookSizeExceedsLimit)&&void 0!==xa.rangeRowStart&&void 0!==xa.rangeRowEnd&&void 0!==xa.rangeColumnStart&&void 0!==xa.rangeColumnEnd}Nwc(xa){xa.wasLastCopyExternal=
!0;x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&xa.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(xa.commandParameters.commandType=-185374993===this.$.shortcutKeyManager.hbc?20:4);if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.pC&&516!==xa.commandParameters.commandType&&1028!==xa.commandParameters.commandType){var Cb=null;if(({wY:Cb}=this.fak(xa.clipboardItems)).returnValue)return xa.isShadowWorkbookParsedSuccessfully=
!0,this.ghj(xa,Cb)}if(516!==xa.commandParameters.commandType&&36!==xa.commandParameters.commandType){if(x.EwaSettings.ya(151)&&20!==xa.commandParameters.commandType){Cb=xa.clipboardItems.getItem(I.html);var bc=!(void 0===Cb||null===Cb)&&!!Cb&&Cb.trim()!==this.B4c&&(Cb.startsWith("<")||h.a.ng&&Cb.startsWith("\n<"));if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:7698173_FormulaPasteAsText")){const Fc=xa.clipboardItems.getItem(I.m4a);return!bc||!Fc&&Tb.f(xa.clipboardItems.getItem(I.plainText))?this.gMd(xa):
this.ZUf(xa,Cb,void 0===Fc?null:Fc)}if(bc)return bc=xa.clipboardItems.getItem(I.m4a),this.ZUf(xa,Cb,void 0===bc?null:bc)}return this.gMd(xa)}return Promise.reject(new wa.a(6))}ghj(xa,Cb){f.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");xa.pasteResult="SystemClipboardShadowWorkbookPaste";xa.payloadType=Z.shadowWorkbook;xa.payloadOrigin=ec.external;xa.shadowWorkbookPayloadSize=pc(Cb);xa.shadowWorkbookSizeExceedsLimit=
vb(Cb);let bc=null,Fc=null;const Tc=xa.commandParameters.originalDestinations;x.EwaSettings.getBooleanFeatureGate(aa.a.Kwb,!1)?bc=M.r(Tc,this.$):Fc=M.v(M.L(Tc),this.$);Cb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(xa.originalSourceRangesCountExceedsLimit=Cb.originalSourceRangesCountExceedsLimit);if(xa.shadowWorkbookSizeExceedsLimit)return f.ULS.sendTraceTag(537167833,0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${xa.shadowWorkbookPayloadSize}) is over the limit(${r.a.isc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Cb.shadowWorkbookSizeExceedsLimit}`),
Promise.reject(new wa.a(1));f.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${xa.commandParameters.id}`);return this.io.cVf(xa.commandParameters.ribbonCommandInfo,Fc,bc,Cb,[xa.commandParameters.stopwatch],xa)}gMd(xa){var Cb=xa.clipboardItems.getItem(I.plainText);if(void 0!==Cb&&null!==Cb&&Cb.trim()===this.B4c)return Promise.reject(new wa.a(7));void 0!==Cb&&null!==Cb&&(xa.plainTextPayloadSize=Cb.length);let bc=!1;aa.a.nQh&&
null!==this.p$b&&(bc=this.p$b.I3g(xa,Ba.a.trimEnd(Cb,"\n","\r"),M.L(xa.commandParameters.originalDestinations)));bc&&Q.h(this.$).Bh.PP(xa.commandParameters.stopwatch.id,ob.BasicTelemetryCalculator.jO);this.kJa||(this.kJa=!0,Rd.b("AutoAdjustedColumnWidth"));xa.isPlainTextPaste=!0;xa.pasteResult="SystemClipboardPaste";xa.payloadOrigin=L(xa)?ec.hyf:ec.external;xa.payloadType=Z.plainText;f.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${xa.id}, PasteOperationId=${xa.commandParameters.id}`);
Cb=this.io.Dmj(M.L(xa.commandParameters.originalDestinations),Cb,xa.commandParameters.ribbonCommandInfo,[xa.commandParameters.stopwatch],xa);f.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${xa.id}`);return Cb}ZUf(xa,Cb,bc){this.kJa||(this.kJa=!0,Rd.b("AutoAdjustedColumnWidth"));xa.htmlPayloadSize=Cb.length;xa.isHtmlPaste=!0;xa.pasteResult="SystemClipboardHtmlPaste";xa.payloadType=Z.html;xa.payloadOrigin=L(xa)?ec.hyf:ec.external;
f.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${xa.commandParameters.id}`);return this.io.Cmj(M.L(xa.commandParameters.originalDestinations),Cb,bc,xa.commandParameters.id,xa.commandParameters.ribbonCommandInfo,[xa.commandParameters.stopwatch],xa)}lQe(xa){const Cb={};xa&&(Cb.shadowWorkbookBase64=xa.ShadowWorkbookBase64,Cb.shadowWorkbookSizeExceedsLimit=xa.ShadowWorkbookSizeExceedsLimit,Cb.originalSourceRangesCountExceedsLimit=
xa.OriginalSourceRangesCountExceedsLimit,Cb.originalSourceRangesCount=xa.OriginalSourceRangesCount,Cb.shadowWorkbookBlockedSize=xa.ShadowWorkbookBlockedSize);return Cb}Pvg(xa,Cb){const bc=S(xa),Fc=32===(xa.commandParameters.commandType&32),Tc=1024===(xa.commandParameters.commandType&1024);let gd=!1,td=null,kb=null,Vb=!1;if(!bc){gd=-1985798686===xa.commandParameters.ribbonCommandInfo.command;var qc=xa.copyContextSnapshot;if(Cb)Vb=!qc.sourceItem.isFromCurrentSession(this.$);else if(qc=this.io.U7a(qc))td=
qc.ranges,kb=qc.sheetName,Vb=!xa.isSameSession}return this.io.n2g(kb,td,this.$.na.sheetName,xa.commandParameters.originalDestinations,xa.commandParameters.expandDestinations,Vb,Fc,Tc,gd,Cb,bc)}}Object(c.a)(Jd,"BaseCopyPasteHandler",null,[436,437,438]);class ld{constructor(xa){this.clipboardItems=this.key=null;this.Xba=xa}sya(xa){return this.key&&this.key.isEqual(xa)?this.createClipboardItems(this.clipboardItems):null}setValue(xa,Cb){this.key=xa;this.clipboardItems=this.createClipboardItems(Cb)}createClipboardItems(xa){const Cb=
this.Xba.create();var bc=xa.getItem(I.plainText);bc&&Cb.setItem(I.plainText,bc);(bc=xa.getItem(I.shadowWorkbook))&&Cb.setItem(I.shadowWorkbook,bc);(xa=xa.getItem(I.html))&&Cb.setItem(I.html,xa);return Cb}}Object(c.a)(ld,"CopyCache",null,[]);class Yd extends Jd{constructor(xa,Cb,bc,Fc,Tc=null){super(xa,Fc,Cb);this.p$b=Cb;this.Xba=bc;this.Y$c=Tc||new ld(this.Xba);this.gridView=Q.h(xa);this.ga=this.gridView.ga;this.clipboardRangeFactory=xa.da.Ba(169)}getSourceItem(){const xa=M.d(this.gridView.ga.pa.selectedRanges);
return new P(this.$,xa,this.$.ea.na.sheetName,this.$.ea.We,this.$.xa.UserSessionId)}beforeSerialize(xa){xa.isSelectionAllowed=!1;xa.isAsyncCopy=!1;xa.isFromCache=!1;xa.encounteredDeploymentErrors=!1;xa.plainTextPayloadSize=0;xa.shadowWorkbookPayloadSize=0;xa.htmlPayloadSize=0;xa.clientSideCopyTime=0;const Cb=new Ca.a(this.$.ua),bc=xa.sourceItem;xa.isSelectionAllowed=xb.a.all(bc.ranges,Fc=>this.isSelectionAllowed(Cb,Fc));xa.isSelectionAllowed&&this.io.qkf(bc.ranges,xa.commandParameters.commandType)}bQa(xa){return this.gridView.Ca.g7()&&
Q.j(this.gridView,xa)}Hhj(xa,Cb,bc,Fc){let Tc=!1,gd=1===Cb.commandParameters.commandType,td=Fc[0].sw;1===bc.ranges.length&&1===Fc.length?x.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&gd&&1!==td&&td!==bc.ranges[0].sw?xa.cseStatus=17:Tc=this.p$b.ced(xa,M.L(bc.ranges),bc.sheetName,M.L(xa.commandParameters.expandDestinations),this.$.ea.na.sheetName,gd):xa.cseStatus=5;Tc&&Q.h(this.$).Bh.PP(xa.commandParameters.stopwatch.id,ob.BasicTelemetryCalculator.jO);return this.ohj(xa,
bc,M.u(this.$.na.sheetName,null,Fc),Cb.commandParameters.commandType,Tc)}isSelectionAllowed(xa,Cb){return xa.pGb(Cb,this.gridView)}ohj(xa,Cb,bc,Fc,Tc){Cb=M.u(Cb.sheetName,null,Cb.ranges);xa.pasteResult="SameSessionPaste";xa.payloadOrigin=ec.O9f;xa.payloadType=Z.CRg;f.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${xa.commandParameters.id}`);return this.io.pasteRange(xa.commandParameters.ribbonCommandInfo,Cb,bc,Fc,xa.commandParameters.commandType,
[xa.commandParameters.stopwatch],xa,Tc,null,null)}}Object(c.a)(Yd,"BaseRangeCopyPasteHandler",Jd,[]);var Ke=a(38);class Bb{constructor(xa){this.KV=new Ke.a(!0);this.$=xa}onDeferredPasteStarted(xa){this.KV.Fb(xa.id)||this.KV.add(xa.id,!0);if(0<this.KV.count){const Cb=Object(Va.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(X.d)(nb.a.resolve(ha.h,{Wa:0})):Ua.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ia.TaskExtensions.za(Cb,()=>{Cb.result.zh(28,null)},this.$.ka,3)}}onDeferredPasteCompleted(xa){const Cb=
0<this.KV.count;this.KV.Fb(xa.id)&&this.KV.remove(xa.id);if(Cb&&!this.KV.count){const bc=Object(Va.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(X.d)(nb.a.resolve(ha.h,{Wa:0})):Ua.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ia.TaskExtensions.za(bc,()=>{bc.result.removeEntry(28)},this.$.ka,3)}}}Object(c.a)(Bb,"DeferredPasteTracker",null,[]);var Ob;(function(xa){xa[xa.none=0]="none";xa[xa.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";xa[xa.loadCopiedDataFromServerFailed=
2]="loadCopiedDataFromServerFailed";xa[xa.asyncCopyCanceled=3]="asyncCopyCanceled";xa[xa.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Ob||(Ob={}));Object(c.b)("CopyErrorType",Ob);var ed=a(974),Sd=a(1164);class Pd extends ed.a{constructor(xa,Cb=null){super(Ob[xa]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=xa;this.ewaErrors=Cb;if(null===Cb||void 0===Cb?0:Cb.length)this.innerError=new Sd.a(Cb,null)}}Object(c.a)(Pd,"CopyInnerError",ed.a,[]);var ic=a(129);
class Kc extends Yd{constructor(xa,Cb,bc,Fc=null){super(xa,Cb,bc,"AcrossSessionRangeCopyPasteHandler",Fc);this.KV=new Bb(xa)}serialize(xa){const Cb=xa.sourceItem,bc={};let Fc=this.Y$c.sya(Cb);if(Fc)bc.synchronousResult=Fc,xa.isFromCache=!0,xa.clientSideCopyTime=xa.commandParameters.stopwatch.fd;else{let gd=null;var Tc=M.G(Cb.ranges);if(!Oa.a.rrf()&&this.bQa(Tc)){f.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");
Tc=this.clipboardRangeFactory.create(Tc);try{gd=Tc.toString(),Fc=this.Xba.create(),Fc.setItem(I.plainText,gd),this.Y$c.setValue(Cb,Fc),bc.synchronousResult=Fc,xa.clientSideCopyTime=xa.commandParameters.stopwatch.fd}finally{Tc&&Tc.dispose()}}else xa.isAsyncCopy=!0,bc.synchronousResult=this.Xba.create(),bc.synchronousResult.setItem(I.plainText,this.B4c);bc.asynchronousResult=this.Zld(xa,Cb,gd)}xa.syncClipboardItemsKeys=ra(bc.synchronousResult);return bc}shouldWaitForCopyToComplete(xa){if(!xa||!xa.copyContextSnapshot)return f.ULS.sendTraceTag(537167907,
0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;f.ULS.shipAssertTag(537167906,0,!!this.$.xa,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(xa.copyContextSnapshot.sessionId===this.$.xa.UserSessionId)return f.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),
!1;f.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(xa){this.KV.onDeferredPasteStarted(xa)}onDeferredPasteCompleted(xa){this.KV.onDeferredPasteCompleted(xa)}deserialize(xa){xa.isClipboardDataContainShadowWorkbook=!(void 0===xa.clipboardItems.getItem(I.shadowWorkbook)||null===xa.clipboardItems.getItem(I.shadowWorkbook));if(Q.h(this.$).ga.gf&326)return S(xa)&&(xa.wasLastCopyExternal=!0),Promise.reject(new wa.a(17));
var Cb=this.Pvg(xa,!1);if(0!==Cb)return Promise.reject(new wa.a(S(xa)?18:xa.isSameSession?19:20,void 0,void 0,void 0,Cb));var bc=xa.copyContextSnapshot,Fc=this.io.U7a(bc);if(S(xa))return this.Nwc(xa);Cb=xa.commandParameters.originalDestinations;if(Fc&&xa.isSameSession)return this.Hhj(xa,bc,Fc,Cb);if(516!==xa.commandParameters.commandType){if(({wY:bc}=this.Jqg(xa.clipboardItems)).returnValue){xa.isShadowWorkbookParsedSuccessfully=!0;let Tc=Fc=null;x.EwaSettings.getBooleanFeatureGate(aa.a.Kwb,!1)?Fc=
M.r(Cb,this.$):Tc=M.v(M.L(Cb),this.$);return this.dhj(xa,Tc,Fc,bc)}if(xa.isClipboardInaccessible)return Promise.reject(new wa.a(8));if(36!==xa.commandParameters.commandType)return this.gMd(xa)}return Promise.reject(new wa.a(6))}beforePaste(xa){this.$.da.Ba(373).nHj(xa);xa.indicationDisplayScheduled=!0}z$j(xa){let Cb;if(!(xa&&xa.SourceRanges&&xa.SourceRanges.Ranges&&xa.SourceRanges.Ranges.length&&(xa.OriginalSourceRangesCountExceedsLimit||xa.OriginalSourceMultiRange&&xa.OriginalSourceMultiRange.Ranges&&
xa.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,wY:null};var bc=xa.SourceRanges.Ranges[0];if(!xa.ShadowWorkbookBase64&&!xa.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,wY:null};Cb=this.lQe(xa);Cb.rangeRowStart=bc.FirstRow;Cb.rangeRowEnd=bc.LastRow;Cb.rangeColumnStart=bc.FirstColumn;Cb.rangeColumnEnd=bc.LastColumn;Cb.sourceClientPath=xa.SourceClientPath;Cb.sourceSheetName=xa.SourceSheetName;Cb.sourceWorkbookName=xa.SourceWorkbookName;if(!xa.OriginalSourceRangesCountExceedsLimit)for(xa=
xa.OriginalSourceMultiRange.Ranges,Cb.originalSourceRanges=Array(xa.length),bc=0;bc<xa.length;++bc)Cb.originalSourceRanges[bc]=[xa[bc].FirstRow,xa[bc].FirstColumn,xa[bc].LastRow,xa[bc].LastColumn];return{returnValue:!0,wY:Cb}}Jqg(xa){let Cb;Cb=null;xa=xa.getItem(I.shadowWorkbook);if(!xa)return{returnValue:!1,wY:Cb};Cb=JSON.parse(xa);return{returnValue:this.yJi(Cb),wY:Cb}}yJi(xa){return!!xa&&(!!xa.shadowWorkbookBase64||xa.shadowWorkbookSizeExceedsLimit)&&void 0!==xa.rangeRowStart&&void 0!==xa.rangeRowEnd&&
void 0!==xa.rangeColumnStart&&void 0!==xa.rangeColumnEnd}dhj(xa,Cb,bc,Fc){f.ULS.shipAssertTag(537167903,0,!!Fc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");rb.AFrameworkApplication.GS("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");xa.pasteResult="CrossSessionPaste";xa.payloadOrigin=ec.Nbd;xa.payloadType=Z.shadowWorkbook;xa.shadowWorkbookPayloadSize=pc(Fc);xa.shadowWorkbookSizeExceedsLimit=vb(Fc);Fc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&
(xa.originalSourceRangesCountExceedsLimit=Fc.originalSourceRangesCountExceedsLimit);if(xa.shadowWorkbookSizeExceedsLimit)return f.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${xa.shadowWorkbookPayloadSize}) is over the limit(${r.a.isc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Fc.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new wa.a(1));if(1028===xa.commandParameters.commandType&&xa.originalSourceRangesCountExceedsLimit)return f.ULS.sendTraceTag(572617859,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${Fc.originalSourceRangesCount}) is over the limit(${r.a.vUi}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${Fc.originalSourceRangesCountExceedsLimit}`),Promise.reject(new wa.a(1));f.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${xa.commandParameters.id}`);return this.io.cVf(xa.commandParameters.ribbonCommandInfo,
Cb,bc,Fc,[xa.commandParameters.stopwatch],xa)}Zld(xa,Cb,bc){f.ULS.shipAssertTag(537167901,0,!!xa,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const Fc=xa.commandParameters.stopwatch.fd,Tc=M.u(Cb.sheetName,null,Cb.ranges);return new Promise((gd,td)=>{f.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${xa.id}`);this.io.copy(Tc,xa.commandParameters,
kb=>{xa.requestTelemetryData=kb.RequestTelemetryData;xa.serverRequestTimeInMs=xa.commandParameters.stopwatch.fd-Fc;if(bb.a.Zf(kb.Errors))if(bb.a.oja(kb.Errors))xa.encounteredDeploymentErrors=!0,kb=bb.a.Ic(kb.Errors),f.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${kb}. copy Id: ${xa.id}`);else{var Vb=bb.a.Ic(kb.Errors),qc=[-591377245];if(aa.a.Xkh&&bb.a.Fh(kb.Errors,
qc)&&(qc=this.nz(Tc))){qc=String.format(this.Wm.Lb(218),qc.toLocaleUpperCase());var Bc=ic.d(kb.Errors,tc=>-591377245===tc.MessageId);kb.Errors[Bc].Description=qc;f.ULS.sendTraceTag(509125507,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${xa.id}`)}f.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Vb}. copy Id: ${xa.id}`);td(new Pd(2,
kb.Errors))}else if(f.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${xa.id}`),xa.markForCancellation)td(new Pd(3,kb.Errors));else{Vb=kb.Result;Bc=Vb.PlainTextResult;void 0!==bc&&null!==bc&&(Bc=bc);void 0!==Bc&&null!==Bc&&(xa.plainTextPayloadSize=Bc.length);qc=this.Xba.create();if(({wY:$b}=this.z$j(Vb)).returnValue){xa.shadowWorkbookPayloadSize=pc($b);xa.shadowWorkbookSizeExceedsLimit=vb($b);xa.originalSourceRangesCountExceedsLimit=
Vb.OriginalSourceRangesCountExceedsLimit;var $b=JSON.stringify($b);qc.setItem(I.shadowWorkbook,$b)}qc.setItem(I.plainText,Bc);Oa.a.rrf()&&(Bc=Vb.HtmlResult,xa.htmlSizeExceedsLimit=Vb.HtmlSizeExceedsLimit,void 0!==Bc&&null!==Bc&&(xa.htmlPayloadSize=Bc.length),qc.setItem(I.html,Bc));xa.copyTotalSizeExceedsLimit=Vb.CopyTotalSizeExceedsLimit;qc.setItem(I.m4a,xa.commandParameters.id);this.Y$c.setValue(Cb,qc);xa.asyncClipboardItemsKeys=ra(qc);gd(qc);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&(Vb=1===xa.commandParameters.commandType?8:7,(qc=this.$.da.Ba(465))&&qc.r$(Vb,kb))}},kb=>{xa.serverRequestTimeInMs=xa.commandParameters.stopwatch.fd-Fc;kb=Pa.a.lf(kb.data);const Vb=bb.a.Ic(kb);f.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Vb}. copy Id: ${xa.id}`);td(new Pd(2,kb))},[xa.commandParameters.stopwatch])})}nz(xa){return null==xa||null==xa.Ranges||0===xa.Ranges.length?(f.ULS.sendTraceTag(509125506,
0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===xa.Ranges.length?M.C(xa.Ranges[0]):M.G(M.g(xa.Ranges))).toString()}}Object(c.a)(Kc,"AcrossSessionRangeCopyPasteHandler",Yd,[]);class dc{constructor(xa,Cb,bc,Fc,Tc,gd=null,td=null){this.floatingObjectId=xa;this.commandParameters=Cb;this.pH=bc;this.rth=Fc;this.ila=gd;this.iVb=td;this.Okh=Tc}}Object(c.a)(dc,"CopyArtRequest",null,[]);class Hc{constructor(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb){this.promise=null;this.ribbonCommandInfo=
xa;this.destination=Cb;this.TSe=bc;this.iVb=Tc;this.wY=gd;this.item=td;this.pasteContext=kb;this.jRa=bc||Cb.FirstRow+"_"+Cb.FirstColumn;this.Qrf=!0;this.lKe=Vb}}Object(c.a)(Hc,"PasteArtRequest",null,[]);class Uc{constructor(xa,Cb){this.hPb=new V.a;this.f2a=xa;this.$=Cb;this.dnj=bc=>Promise.resolve(bc);this.gLb=bc=>Promise.reject(bc)}hmi(xa){if(this.bFi(xa.jRa)){f.ULS.sendTraceTag(537167681,5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${xa.jRa}`);
const Cb=this.hPb.ma(xa.jRa);this.hPb.ia(xa.jRa,xa);const bc=Cb.promise;Cb.Qrf=!1;return this.nDh(xa,bc)}this.hPb.ia(xa.jRa,xa);return this.qMi(xa)}bFi(xa){return this.hPb.Fb(xa)}qMi(xa){return new Promise((Cb,bc)=>{xa.promise=this.f2a.YUf(xa).then(Fc=>{Cb(null);return this.qvc(xa,Fc)},Fc=>{bc(null);return this.gLb(Fc)})})}nDh(xa,Cb){return new Promise((bc,Fc)=>{xa.promise=Cb.then(Tc=>{this.Ffk(xa,Tc);return this.f2a.YUf(xa).then(gd=>{bc(null);return this.qvc(xa,gd)},gd=>{Fc(null);return this.gLb(gd)})},
Tc=>this.gLb(Tc))})}qvc(xa,Cb){xa.Qrf&&(this.reh(xa.jRa),this.rWd(xa,Cb));return this.dnj(Cb)}reh(xa){this.hPb.remove(xa)}rWd(xa,Cb){const bc=this.Mdi();xa.jRa===bc&&this.f2a.rWd(xa.destination,Cb,xa.item.type)}Mdi(){var xa=Q.h(this.$).ga.Sa.activeFloatingObjectControlId;xa||(xa=M.v(Q.h(this.$).ga.pa.activeCell,this.$),xa=xa.FirstRow+"_"+xa.FirstColumn);return xa}Ffk(xa,Cb){xa.destination=null;xa.TSe=Cb}}Object(c.a)(Uc,"PasteArtRequestManager",null,[]);var Fd=a(208),Td=a(135),ad=a(109);class Qd extends Jd{constructor(xa,
Cb,bc,Fc,Tc=null){super(xa,"ArtCopyPasteHandler");this.lfh="XLO";this.mfh="3";this.KV=new Bb(xa);this.Xba=Cb;this.f2a=bc;this.ga=Q.h(xa).ga;this.X$c=Tc||new ld(this.Xba);this.ehj=new Uc(bc,xa);this.jtb=Fc}getSourceItem(){f.ULS.shipAssertTag(537167896,0,!!this.ga.Sa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");f.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ga.Sa.activeFloatingObjectControlId}]`);
return new F(this.ga.Sa.activeFloatingObjectControlId,this.$.ea.na.sheetName,this.$.ea.We,this.$.xa.UserSessionId,this.ga.Sa.Fc.floatingObject.type)}beforeSerialize(xa){xa&&xa.commandParameters?(xa?(xa.isAsyncCopy=!1,xa.isSelectionAllowed=!1,xa.isFromCache=!1,xa.plainTextPayloadSize=0,xa.shadowWorkbookPayloadSize=0,xa.htmlPayloadSize=0,xa.htmlSizeExceedsLimit=!1,xa.clientSideCopyTime=0,xa.encounteredDeploymentErrors=!1,xa.shadowWorkbookSizeExceedsLimit=!1,xa.originalSourceRangesCountExceedsLimit=
!1,xa.copyTotalSizeExceedsLimit=!1):f.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),xa.commandParameters.copyPasteTargetType=2):f.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(xa){const Cb=xa.sourceItem,bc={};if(!Cb)return f.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),bc;if(!this.lIi())return f.ULS.sendTraceTag(36824456,
0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),bc;f.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${Cb.activeFloatingObjectControlId}]`);this.wNd();let Fc=this.X$c.sya(Cb);if(Fc)bc.synchronousResult=Fc,xa.isFromCache=!0,xa.isAsyncCopy=!1,xa.clientSideCopyTime=xa.commandParameters.stopwatch.fd,1===xa.commandParameters.commandType&&this.$.xd(2045211913,xa.commandParameters.ribbonCommandInfo.method,
xa.commandParameters.ribbonCommandInfo.yf,null);else{xa.isFromCache=!1;xa.isAsyncCopy=!0;Fc=this.Xba.create();if(xa.commandParameters.uploadToClipService){const Tc={};Tc["data-clipservice-ccpid"]=xa.commandParameters.id;Tc["data-pkey"]=xa.commandParameters.pKey;Tc["data-clipservice-type"]=xa.commandParameters.clipServiceDataType;Tc["data-clipservice-count"]=xa.commandParameters.objectCount.toString();Tc["data-clipservice-dc"]=xa.commandParameters.clipServiceDataCenter;Tc["data-clipservice-client"]=
this.lfh;Tc["data-TimeStamp"]=(new Date).toUTCString();Tc["data-clipservice-version"]=this.mfh;Fc.setItem(I.PZg,JSON.stringify(Tc))}bc.synchronousResult=this.kTg(Fc);bc.asynchronousResult=this.Zld(xa,Cb,Fc)}xa.syncClipboardItemsKeys=ra(bc.synchronousResult);return bc}kTg(xa){f.ULS.shipAssertTag(537167891,0,!!this.ga.Sa.Fc,"Expecting a floating object to be currently selected for copy");xa||(xa=this.Xba.create());const Cb=this.ga.Sa.Fc.bAb();Cb&&xa.setItem(I.html,`<img src='${Cb}'>`);return xa}wNd(){const xa=
this.ga.Sa.Fc;this.jtb.wNd(Td.a.ovb(xa.floatingObject),Td.a.ofh(xa.Ar))}shouldWaitForCopyToComplete(){f.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(xa){this.KV.onDeferredPasteStarted(xa)}onDeferredPasteCompleted(xa){this.KV.onDeferredPasteCompleted(xa)}deserialize(xa){var Cb=S(xa),bc=null;let Fc=null;var Tc=!1;if(!Cb){bc=xa.copyContextSnapshot;Fc=bc.sourceItem;if(!Fc)return Promise.reject(new wa.a(10));Tc=Fc.isFromCurrentSession(this.$)}var gd=
this.Pvg(xa,!0);if(0!==gd)return Promise.reject(new wa.a(Cb?18:Tc?19:20,void 0,void 0,void 0,gd));if(Cb)return this.Nwc(xa);if(!Tc&&!Qd.kAi(Fc))return xa=`User attempted to paste art of type [${Fc.type}] between sessions.`,f.ULS.sendTraceTag(537167889,0,50,xa),Promise.reject(new wa.a(11,void 0,void 0,xa));if(bc.isAsyncSerializeFailed)return Promise.reject(new wa.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let td;try{const kb=xa.clipboardItems.getItem(I.shadowWorkbook);
td=JSON.parse(kb)}catch(kb){return xa=copyPasteInfra.getStringifiedError(kb),f.ULS.sendTraceTag(537167888,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${xa}`),Promise.reject(new wa.a(12,void 0,kb))}td.floatingObjectId!==Fc.activeFloatingObjectControlId?f.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Fc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${td.floatingObjectId}]`):
f.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Fc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${td.floatingObjectId}]`);if(!td||!td.shadowWorkbookBase64)return Promise.reject(new wa.a(13,void 0,void 0,`shadowWorkbookPayload is null = ${!td}`));xa.isShadowWorkbookParsedSuccessfully=!0;xa.shadowWorkbookPayloadSize=pc(td);xa.shadowWorkbookSizeExceedsLimit=vb(td);xa.payloadOrigin=Tc?ec.O9f:
ec.Nbd;xa.payloadType=Z.Dzg;if(vb(td))return xa=`Shadow workbook size [${xa.shadowWorkbookPayloadSize}] is over the limit [${r.a.isc}]. ShadowWorkbookSizeExceedsLimit: ${td.shadowWorkbookSizeExceedsLimit}`,f.ULS.sendTraceTag(36304156,0,15,`ArtCopyPasteHandler.Deserialize: ${xa}`),Promise.reject(new wa.a(1,void 0,void 0,xa));bc=Cb=null;Q.h(this.$).ga.gf&326?bc=Q.h(this.$).ga.Sa.activeFloatingObjectControlId:Cb=this.$.na&&this.$.na.activeCell?M.v(this.$.na.activeCell,this.$):M.v(M.L(xa.commandParameters.originalDestinations),
this.$);Tc=null;if(this.jtb.Qgg(Fc))try{Tc=this.jtb.ced()}catch(kb){gd=copyPasteInfra.getStringifiedError(kb),f.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${gd}`)}return this.ehj.hmi(new Hc(xa.commandParameters.ribbonCommandInfo,Cb,bc,xa.commandParameters.commandType,[xa.commandParameters.stopwatch],td,Fc,xa,Tc))}Nwc(xa){xa.wasLastCopyExternal=!0;if(xa.clipboardItems.getItem("image/png")){const Cb=xa.commandParameters.stopwatch.fd;
xa.payloadType=Z.j5g;return X.c(this.$.xd(1403967063,xa.commandParameters.ribbonCommandInfo.method,xa.commandParameters.ribbonCommandInfo.yf,{["dataUrl"]:xa.clipboardItems.getItem("image/png")})).then(bc=>{xa.serverRequestTimeInMs=xa.commandParameters.stopwatch.fd-Cb;return bc?Promise.resolve(null):Promise.reject(new wa.a(15))},()=>{xa.serverRequestTimeInMs=xa.commandParameters.stopwatch.fd-Cb;return Promise.reject(new wa.a(15))})}f.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");
return super.Nwc(xa)}lIi(){const xa=Q.h(this.$).ga;return xa.Sa.activeFloatingObjectControlId&&xa.Sa.Fc&&xa.Sa.Fc.floatingObject?xa.Sa.Fc.floatingObject.M2d():!1}Zld(xa,Cb,bc){return new Promise((Fc,Tc)=>{const gd=xa.commandParameters.stopwatch.fd;f.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.f2a.Qkh(new dc(Cb.activeFloatingObjectControlId,xa.commandParameters,td=>{xa.requestTelemetryData=td.RequestTelemetryData;
xa.serverRequestTimeInMs=xa.commandParameters.stopwatch.fd-gd;if(bb.a.Zf(td.Errors))if(bb.a.oja(td.Errors))xa.encounteredDeploymentErrors=!0,td=bb.a.Ic(td.Errors),f.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${td}`);else{var kb=bb.a.Ic(td.Errors);f.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${kb}`);Tc(new Pd(4,
td.Errors))}else if(f.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${Cb.activeFloatingObjectControlId}].`),xa.markForCancellation)Tc(new Pd(3,td.Errors));else{if(bb.a.Aq(td.Errors)){var Vb=bb.a.Ic(td.Errors);f.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Vb}`)}if(Vb=td.Result){Vb=this.lQe(Vb);Vb.floatingObjectId=Cb.activeFloatingObjectControlId;
xa.shadowWorkbookPayloadSize=pc(Vb);xa.shadowWorkbookSizeExceedsLimit=vb(Vb);try{kb=JSON.stringify(Vb)}catch(qc){Tc(new wa.a(14,void 0,qc,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${xa.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Vb.floatingObjectId}]`));return}f.ULS.shipAssertTag(537167881,0,!!bc,"Expecting syncClipboardItems to be defined");bc.setItem(I.shadowWorkbook,kb);1===xa.commandParameters.commandType&&(this.Qkj(Cb.type,Cb.activeFloatingObjectControlId,
td.StateId),this.deleteFloatingObject(Cb.activeFloatingObjectControlId,Cb.type));this.X$c.setValue(Cb,bc);xa.asyncClipboardItemsKeys=ra(bc);Fc(bc)}else f.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${Cb.activeFloatingObjectControlId}`),Fc(this.X$c.sya(Cb))}},xa.commandParameters.commandType,Cb.type,td=>{xa.serverRequestTimeInMs=xa.commandParameters.stopwatch.fd-gd;td=Pa.a.lf(td.data);1===xa.commandParameters.commandType&&
this.f2a.fbk(Cb.type,Cb.activeFloatingObjectControlId);const kb=bb.a.Ic(td);f.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${kb}`);Tc(new Pd(4,td))},[xa.commandParameters.stopwatch]))})}deleteFloatingObject(xa,Cb){xa=Fd.a.pA(Cb,xa);if(xa=ad.a(this.$).Es(xa))ad.a(this.$).deleteFloatingObject(xa,14,!0),Q.h(this.$).ga.Sa.YB=null}Qkj(xa,Cb,bc){const Fc=this.$.da.Ba(277);if(Fc){let gd=null;xa=Fd.a.pA(xa,Cb);xa=ad.a(this.$).Es(xa);
if(null===xa||void 0===xa?0:xa.Lj)gd=xa.Lj.block;if(gd){var Tc=xa.floatingObject.Jh();Fc.Y3b(()=>!gd.gj.Fb(Tc),bc,"CutArt")}}}static kAi(xa){return 1===xa.type||5===xa.type||x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartAndInkPasteEnabled",!1)&&(0===xa.type||8===xa.type)}}Object(c.a)(Qd,"ArtCopyPasteHandler",Jd,[]);var Zb=a(61);class Wc extends cb{constructor(xa,Cb,bc,Fc){super(xa);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=Cb;this.top=
bc;this.left=Fc}}Object(c.a)(Wc,"MacroRecorderPasteArtPayload",cb,[]);class md{constructor(xa,Cb){this.$=xa;this.jtb=Cb}Tri(xa,Cb,bc,Fc,Tc,gd=null,td=null){const kb=this.$.qa.va.Bc();let Vb=null;const qc={CopyPasteTargetType:2};qc.FloatingObjectId=xa;qc.CopyOperationId=bc.id;bc.floatingObjectType=Cb;qc.UploadToClipService=bc.uploadToClipService;qc.PKey=bc.pKey;qc.ClipServiceDataCenter=bc.clipServiceDataCenter;let Bc=0;2===Tc?(Tc=505,Bc=16,Vb=($b,tc,Xc)=>Ja(this.$.qa.va,qc,ca.b($b,Fc),gd?ca.a(tc,gd):
tc,Xc,bc.ribbonCommandInfo,kb,td)):(Tc=179,Vb=($b,tc,Xc)=>{this.mzh(Cb,xa);this.$.Kz();return zb(this.$.qa.va,qc,ca.b($b,Fc),gd?ca.a(tc,gd):tc,Xc,bc.ribbonCommandInfo,kb,td)});this.$.userOperationManager.kd(new ka.a(Tc,0,Vb,Bc|64),bc.ribbonCommandInfo)}mzh(xa,Cb){var bc=Fd.a.pA(xa,Cb);(bc=ad.a(this.$).Es(bc))?(Q.h(this.$).ga.Sa.uI(bc),bc.isVisible=!1):f.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${xa}, FloatingObjectId: ${Cb}`)}fbk(xa,
Cb){xa=Fd.a.pA(xa,Cb);if(xa=ad.a(this.$).Es(xa))xa.isVisible=!0}Qkh(xa){this.Tri(xa.floatingObjectId,xa.Okh,xa.commandParameters,xa.pH,xa.rth,xa.ila,xa.iVb)}xsi(xa,Cb,bc,Fc,Tc,gd,td,kb=null,Vb=!0){return new Promise((qc,Bc)=>{const $b=gd.commandParameters.stopwatch.fd;this.NWd(xa,Tc,Cb,bc,tc=>{gd.requestTelemetryData=tc.RequestTelemetryData;gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.fd-$b;if(bb.a.oja(tc.Errors))gd&&(gd.encounteredDeploymentErrors=!0),tc=bb.a.Ic(tc.Errors),f.ULS.sendTraceTag(537167875,
0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${tc}`);else if(bb.a.Zf(tc.Errors)){var Xc=bb.a.Ic(tc.Errors);f.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Xc}`);Bc(new wa.a(9,tc.Errors))}else tc.Result?(Xc=tc.Result,f.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.blj(td,Xc.FloatingObjectId,tc.StateId),qc(md.utd(Xc.FloatingObjectId))):(f.ULS.sendTraceTag(537167873,
0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Bc(new wa.a(9,tc.Errors)))},tc=>{gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.fd-$b;tc=Pa.a.lf(tc.data);f.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${bb.a.Ic(tc)}`);Bc(new wa.a(9,tc))},Fc,kb,Vb)})}blj(xa,Cb,bc){const Fc=this.$.da.Ba(277);if(Fc){const Tc=Fd.a.pA(xa,md.utd(Cb));Fc.Y3b(()=>!!ad.a(this.$).Es(Tc),bc,"PasteArt")}}W5d(xa,Cb){Cb&&this.jtb.W5d(xa,
Fd.a.pA(xa.type,Cb))}YUf(xa){return this.xsi(xa.ribbonCommandInfo,xa.destination,xa.TSe,xa.iVb,xa.wY,xa.pasteContext,xa.item.type,xa.lKe,xa.item.isFromCurrentSession(this.$)).then(Cb=>Cb,Cb=>{this.W5d(xa.item,xa.lKe);return Promise.reject(Cb)})}rWd(xa,Cb,bc){xa||(xa=M.v(Q.h(this.$).ga.pa.activeCell,this.$));Q.h(this.$).yoc(M.E(xa),1)?ad.a(this.$).G9(bc,Cb,!0):Q.h(this.$).ga.Sa.tKa(xa,Cb,bc).continueWith(Fc=>{Fc.result?f.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${Cb}]`):
f.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${Cb}]`)})}NWd(xa,Cb,bc,Fc,Tc,gd,td,kb,Vb=!0){const qc=this.$.qa.va.Bc(),Bc={};Bc.ShadowWorkbookBase64=Cb.shadowWorkbookBase64;Bc.FloatingObjectId=Fc;Bc.DestinationRanges=bc?M.s(bc):null;Bc.CopyPasteTargetType=2;Bc.ClientEstimationFloatingObjectId=kb;bc=new ka.a(503,0,($b,tc,Xc)=>{kb||this.$.Kz();return na(this.$.qa.va,Bc,ca.b($b,Tc),ca.a(tc,gd),Xc,null,qc,td)},void 0,()=>{if(Vb){let $b;
$b=Zb.a.Xi(Zb.a.Zc(Bc));$b.FloatingObjectId=Cb.floatingObjectId;Bc.DestinationRanges||($b.DestinationRanges=M.p(this.$.ua.na.sheetName,"",0,0,0,0));return new Wc($b,Vb,0,0)}return new Wc(Bc,Vb,0,0)});bc.flags=65;this.$.userOperationManager.kd(bc,xa)}static utd(xa){return`${xa.length+2}.{${xa.toUpperCase()}}`}}Object(c.a)(md,"ArtCopyPasteUtils",null,[429]);var Nd=a(203);class kd{constructor(xa){this.V$c=this.Wva=null;this.Odb=15;this.$=xa}wNd(xa,Cb){this.Wva=xa;this.V$c=Cb}ced(){if(!this.Wva||!this.V$c)return f.ULS.sendTraceTag(537167841,
0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const xa=Td.a.ovb(new Fd.a(this.Wva));xa.Id=md.utd(k.a.create().toString());xa.Version=-1;xa.Name="";xa.IsClientEstimation=!0;var Cb=this.Mti(xa);if(!Cb)return null;const bc=new Fd.a(xa);Cb.block.gj.add(bc);bc.lPb();const Fc=ad.a(this.$);Fc.E$b(bc,Cb);Cb=Fc.Es(Fd.a.h7h(xa));!Cb||Cb.floatingObject.JPa||Cb.floatingObject.kQa||Cb.cVa(this.V$c);
Fc.G9(xa.Type,xa.Id,!0);return xa.Id}Qgg(xa){return x.EwaSettings.ya(205)&&xa.isFromCurrentSession(this.$)&&!Q.h(this.$).rtl&&!Q.h(this.$).Cb.jj}W5d(xa,Cb){this.Qgg(xa)&&(xa=ad.a(this.$).Es(Cb))&&(f.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${Cb}] of type [${xa.floatingObject.type}]`),ad.a(this.$).deleteFloatingObject(xa,15,!0),xa.Lj&&xa.yfb(xa.Lj,!1))}Mti(xa){if(!xa)return f.ULS.sendTraceTag(537167839,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(Q.h(this.$).ga.Sa.activeFloatingObjectControlId){var Cb=Q.h(this.$).ga.Sa.YB.floatingObject;xa.OriginDeltaX=Cb.offsetX+this.Odb;xa.OriginDeltaY=Cb.offsetY+this.Odb;xa.AbsoluteLeft+=this.Odb;xa.AbsoluteTop+=this.Odb;xa.AbsoluteRight+=this.Odb;xa.AbsoluteBottom+=this.Odb;xa.ZOrder=Cb.kD+1;return Q.h(this.$).ga.Sa.YB.Lj}if(!this.$.na||!this.$.na.activeCell)return f.ULS.sendTraceTag(537167838,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var bc=this.$.na.activeCell;Cb=Q.h(this.$).PY(bc);if(!Cb)return f.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${bc.toString()} is null.`),null;const Fc=Xa.HelperMethods.vBb(Cb.domElement,Cb.Yj.domElement);bc=Cb.gridView.Vg(bc,2);if(!Fc||!bc)return f.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!Fc}. cellPositionRelativeToGridOrigin is null: ${!bc} .`),
null;xa.OriginDeltaX=bc.topLeft.x-Fc.x;xa.OriginDeltaY=bc.topLeft.y-Fc.y;xa.AbsoluteLeft=bc.topLeft.x;xa.AbsoluteTop=bc.topLeft.y;xa.AbsoluteRight=xa.AbsoluteLeft+Math.abs(this.Wva.AbsoluteRight-this.Wva.AbsoluteLeft);xa.AbsoluteBottom=xa.AbsoluteTop+Math.abs(this.Wva.AbsoluteBottom-this.Wva.AbsoluteTop);xa.ZOrder=this.Wva.ZOrder+100;return new Nd.a(Cb.gridView.Ca.lm(Cb.hashCode),Cb.hashCode)}}Object(c.a)(kd,"ArtPasteClientEstimation",null,[428]);class yd{create(){const xa=window.clipboardPlatform;
return xa?xa.createClipboardItems():null}}Object(c.a)(yd,"ClipboardItemsFactory",null,[427]);class lc{}lc.undefined="Undefined";Object(c.a)(lc,"CCPTelemetryConsts",null,[]);class Lc{}Lc.cells="Cells";Lc.floatingObject="FloatingObject";Lc.unknown="Unknown";Object(c.a)(Lc,"ActiveSelection",null,[]);class nd{}nd.yyh="DisplayNotInvoked";nd.Wdd="Displayed";nd.llj="PrerequisitesNotReady";Object(c.a)(nd,"PasteIndicationDisplayStatus",null,[]);class Wd extends Kc{constructor(xa,Cb,bc,Fc=null){super(xa,Cb,
bc,Fc);this.ica=null}beforePaste(){f.ULS.sendTraceTag(509162378,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(xa){xa.isClipboardDataContainShadowWorkbook=!(void 0===xa.clipboardItems.getItem(I.shadowWorkbook)||null===xa.clipboardItems.getItem(I.shadowWorkbook));this.io.U7a(xa.copyContextSnapshot);const Cb=xa.commandParameters.originalDestinations;if(!xa.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let bc;if(({wY:bc}=this.Jqg(xa.clipboardItems)).returnValue){xa.isShadowWorkbookParsedSuccessfully=
!0;let Fc=null,Tc=null;x.EwaSettings.getBooleanFeatureGate(aa.a.Kwb,!1)?Fc=M.r(Cb,this.$):Tc=M.v(M.L(Cb),this.$);return this.Chj(xa,Tc,Fc,bc)}return xa.isClipboardInaccessible?Promise.reject(new wa.a(8)):Promise.reject(new wa.a(6))}get copyPasteInfrastructure(){var xa;null!==(xa=this.ica)&&void 0!==xa?xa:this.ica=this.$.da.Ba(254,!0);return this.ica}Dvi(xa,Cb,bc,Fc){return this.copyPasteInfrastructure?X.a(this.copyPasteInfrastructure.Glc(null,Fc.commandParameters.ribbonCommandInfo,xa,Cb,bc,Fc)):Promise.reject(new wa.a(0))}Chj(xa,
Cb,bc,Fc){xa.pasteResult="CrossSessionPaste";xa.payloadOrigin=ec.Nbd;xa.payloadType=Z.shadowWorkbook;xa.shadowWorkbookPayloadSize=pc(Fc);xa.shadowWorkbookSizeExceedsLimit=vb(Fc);Fc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(xa.originalSourceRangesCountExceedsLimit=Fc.originalSourceRangesCountExceedsLimit);return xa.shadowWorkbookSizeExceedsLimit?Promise.reject(new wa.a(1)):1028===xa.commandParameters.commandType&&xa.originalSourceRangesCountExceedsLimit?Promise.reject(new wa.a(1)):
this.Dvi(Cb,bc,Fc,xa)}}Object(c.a)(Wd,"AcrossSessionInsertCopiedCutCellsHandler",Kc,[]);class $d{constructor(xa){this.pSc=this.VMc=this.jXc=null;this.$=xa}get yPd(){if(!this.jXc){const xa=this.$.da.Ba(254,!0);xa&&(this.jXc=new Kc(this.$,xa,new yd))}return this.jXc}get Gvi(){if(!this.pSc){const xa=this.$.da.Ba(254,!0);xa&&(this.pSc=new Wd(this.$,xa,new yd))}return this.pSc}get x4c(){if(!this.VMc&&this.$.da.Ba(254,!0)){const xa=new kd(this.$);this.VMc=new Qd(this.$,new yd,new md(this.$,xa),xa)}return this.VMc}getCopyFlowHandler(xa){const Cb=
this.Y2h(Q.h(this.$).gf);xa.commandParameters.copyPasteHandlerName=Cb.name;return Cb}getPasteFlowHandler(xa){var Cb=xa.copyContextSnapshot;switch(xa.commandParameters.ribbonCommandInfo.command){case -160032004:case -1065525230:return xa=this.Gvi;default:return Cb=J(xa)?this.x4c:S(xa)?this.yPd:(null===Cb||void 0===Cb?0:Cb.sourceItem)&&Object.getType(Cb.sourceItem)===F?this.x4c:this.yPd,xa.commandParameters.copyPasteHandlerName=Cb.name,Cb}}initializePasteContext(xa){if(xa&&(xa.isSameSession=!1,xa.isShadowWorkbookParsedSuccessfully=
!1,xa.pasteResult=lc.undefined,xa.payloadOrigin=lc.undefined,xa.payloadType=lc.undefined,xa.encounteredDeploymentErrors=!1,xa.shadowWorkbookSizeExceedsLimit=!1,xa.originalSourceRangesCountExceedsLimit=!1,xa.activeSelectionType=this.JZh(),xa.indicationDisplayScheduled=!1,xa.pasteDestinationHasMergedCells=!1,xa.cseStatus=0,xa.pasteIndicationDisplayStatus=nd.yyh,xa.copyContextSnapshot)){var Cb=xa.copyContextSnapshot;const td=B(Cb.sourceItem);var bc=Cb.sourceItem;var Fc=!!bc&&Object.getType(bc)===F;bc=
0;var Tc=!1;td?(Tc=Cb.sourceItem,xa.isSameSession=Tc.isFromCurrentSession(this.$),bc=1,Tc=this.dFi(Tc,xa)):Fc&&(xa.isSameSession=Cb.sourceItem.isFromCurrentSession(this.$),bc=2);if(xa.copyContextSnapshot.commandParameters){const kb=-1985798686===Cb.commandParameters.ribbonCommandInfo.command;Fc=xa.commandParameters;var gd=this.$;Cb?gd&&gd.xa?Cb=Cb.sessionId===gd.xa.UserSessionId:(f.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Cb=!1):(f.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),
Cb=!1);Fc.clearSystemClipboard=Cb&&kb&&td&&!Tc;xa.commandParameters.copyPasteTargetType=bc}}}getSessionId(){return this.$.xa.UserSessionId}dFi(xa,Cb){const bc=ic.b(xa.ranges,Fc=>Fc.gh)&&ic.b(Cb.commandParameters.originalDestinations,Fc=>1!==Fc.top);return ic.b(xa.ranges,Fc=>Fc.isRow)&&ic.b(Cb.commandParameters.originalDestinations,Fc=>1!==Fc.left)||bc}Y2h(xa){switch(xa){case 1:return this.yPd;case 64:case 4:case 2:case 256:return this.x4c;default:throw Error.invalidOperation("Unsupported selection");
}}JZh(){return Q.h(this.$).ga.gf&470?Lc.floatingObject:1===Q.h(this.$).ga.gf?Lc.cells:Lc.unknown}getDialogResponse(){}}Object(c.a)($d,"ExcelCopyPasteApplicationHost",null,[407]);var se=a(170);class je extends t.a{constructor(xa,Cb){super(xa);this.Bu=null;this.Fvi=(bc,Fc)=>{1===bc?(bc=je.Jxh[Fc[je.Ixh]],f.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===bc?"Horizontal":"Vertical"}`),this.Bu.setResult(bc)):
(f.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.Bu.Pt())};this.fh(Cb)}get Qc(){return"InsertCopiedCutCellsDialog"}fh(xa){this.Bu=new se.a;const Cb=A.a.instance.ha(16);xa=this.JI(xa);this.initializeAndShow(Cb,this.Fvi,xa)}JI(xa){return{[je.Au]:this.Qc,[je.NGi]:xa}}}je.Ixh="direction";je.NGi="isRtl";je.Jxh={["Vertical"]:1,["Horizontal"]:0};Object(c.a)(je,"InsertCopiedCutCellsDialog",t.a,[]);class Le{G$b(xa,Cb){return(new je(xa,
Cb)).Bu.task}}Object(c.a)(Le,"InsertCopiedCutCellsDialogFactory",null,[406]);var oe=a(92),ue=a(51),df=a(48);class Se{constructor(xa){this.Dac="";this.s4=this.tu=null;this.Exc=!1;this.Wjf=(Cb=null,bc=null)=>{this.hide(Cb,bc)};this.gridView=Q.h(xa);this.gridView.ga.gp(this.Wjf)}jVe(){this.Exc||(f.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.wA(xa=>{xa.x6(0).then(()=>{this.Exc=!0})}))}nHj(xa){var Cb=xa.commandParameters.id;
f.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${Cb}, cancelCtx is null = ${!this.tu}, PrerequisitesDownloaded = ${this.Exc}`);this.jVe();this.Dac=Cb;Cb=!this.TFf();if(!this.tu||Cb)this.vHe(),this.tu=ue.a.instance.create(()=>{this.xyh(xa)},void 0===xa.timeoutToShowSpinnerInMs||null===xa.timeoutToShowSpinnerInMs?100:xa.timeoutToShowSpinnerInMs,df.a.jhj);this.s4=xa.commandParameters.originalDestinations}xyh(xa){this.Exc?(this.display(xa.commandParameters.originalDestinations),
xa.pasteIndicationDisplayStatus=nd.Wdd):(f.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),xa.pasteIndicationDisplayStatus=nd.llj)}display(xa){f.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.dc.iB(ba.a.qEa(Ka.d(this.gridView.$.na),xa),Se.Owc,!0);this.gridView.dc.Ur(Se.Owc)}ukc(xa){f.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${xa}, currentPasteCommandId = ${this.Dac}`);
xa&&Ba.a.equals(xa,this.Dac,!1)&&this.hide()}hide(xa=null){this.s4&&xa&&this.TFf()&&f.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.Dac="";this.vHe();this.s4=null;x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AvoidHighlightUpdate",!1)&&0===this.gridView.dc.ild([30]).length||(this.gridView.dc.Hk(Se.Owc),this.gridView.dc.il(null,Se.Owc))}TFf(){return M.R(this.gridView.ga.pa.selectedRanges,
this.s4)}vHe(){this.tu&&(oe.a.Ka(this.tu),this.tu=null)}dispose(){this.hide();this.gridView.ga.Gp(this.Wjf)}}Se.Owc=[30];Object(c.a)(Se,"PasteIndicationManager",null,[405,2]);var bf=a(1099),Ye=a(54),gf=a(725);class nf extends e.a{constructor(xa){super();this.$=xa;this.Wm=A.a.instance;this.kc()}create(){const xa=Ye.a.oX([76,77],4,this.La,void 0,void 0,void 0,nf.bqa);let Cb;Cb=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(X.d)(nb.a.resolve(ha.H,
{Wa:this.La})):Ua.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.La);Ia.TaskExtensions.za(Ia.TaskExtensions.ke([Cb,xa],this.ka),()=>{const bc=new bf.a;let Fc=null;this.kih(bc).then(Tc=>{Fc=Tc.oKe;const gd=copyPasteInfra.createCopyPasteInfra(Fc,new $d(this.$),bc,{isChangeGateEnabled:x.EwaSettings.isChangeGateEnabled});f.ULS.shipAssertTag(537167762,0,!!this.$.xa,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");f.ULS.shipAssertTag(537167761,0,!!this.$.xa&&
!!this.$.xa.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");const td=Fc.getMetadataManager();var kb=Object(gf.a)(this.$.da,254,()=>new Rb(this.$,td,Cb.result,gd,new nc(this.$,Q.h(this.$)),new Le,this.$.xa.DocumentHostInfo.UserId,Fc.getInitializationError()));this.Pb(kb);if(Tc.J3a){kb=Rb.Dgc();const Vb=JSON.stringify(Tc.J3a.dataClipboardCapabilities),qc=Tc.J3a.clipboardStrategiesToInitialize[0].clipboardStrategyType===
Tc.J3a.dataClipboardStrategyType,Bc=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();f.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${kb}, StrategyType=${Tc.J3a.dataClipboardStrategyType}, StrategyCapabilities=${Vb}, IsBestStrategyTypeInitialized=${qc}, InfraLoadTimeMS=${Bc}`)}else f.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},
Tc=>{const gd=Rb.Dgc();Tc=Tc?copyPasteInfra.getStringifiedError(Tc):"null";f.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${gd} error: ${Tc}`)})},this.ka,3)}dispose(){super.dispose()}kih(xa){let Cb=null;var bc=window.clipboardPlatform;bc&&(Cb=bc.getClipboardPlatformEnvironment());if(!Cb)return f.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),
Promise.reject(null);bc=this.$.xa;const Fc=[bc.OfficeOnlineChromeExtensionId,bc.ChromeClipboardAccessExtensionId],Tc=this.Wm.Ha(5);var gd=this.$.Ne.get(57);let td=!gd&&this.$.Ne.get(5);const kb=this.$.ea.Gc;kb&&(kb.inWebPart||kb.inViewerFromWebPart||kb.isDivSyndicated)&&(td=!1);gd=this.Z1h(td,!gd);f.ULS.shipAssertTag(537167758,0,!!bc.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Cb.init({isChangeGateEnabled:x.EwaSettings.isChangeGateEnabled},
xa,Fc,bc.SharedClipboardHostingApp,bc.SharedClipboardHostingApps,bc.SharedClipboardHostingEnvironments,bc.SharedClipboardOverrideOrigin,bc.SharedClipboardSchemaVersion,bc.SharedClipboardExpirationInMinutes,bc.ClipboardPromiseTimeoutInMinutes,Tc,bc.MachineCluster,new Nb(this.$),gd,bc.DocumentHostInfo.UserId,bc.ClipboardTtlInMS,x.EwaSettings.ya(273),bc.UserSessionId,bc.BulsEndpointUrl).then(Vb=>Object(b.a)(new mb,{oKe:Cb,J3a:Vb}),Vb=>Promise.reject(Vb))}Z1h(xa,Cb){const bc=[];xa&&Cb&&bc.push(this.Trh());
Cb&&(bc.push(this.Gbd(7)),bc.push(this.Gbd(0)));xa&&bc.push(this.rPe());bc.push({clipboardStrategyType:4});const Fc=bc?bc.map(Tc=>JSON.stringify(Tc)).join(","):"[]";f.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${xa}, isSystemClipboardAllowed=${Cb}, result = ${Fc}`);return bc}rPe(){const xa=this.$.xa,Cb={clipboardStrategyType:5};Cb.sessionId=xa.UserSessionId;Cb.useSharedClipboardIframe=
!0;Cb.sharedClipboardHostingApp=xa.SharedClipboardHostingApp;Cb.sharedClipboardHostingApps=xa.SharedClipboardHostingApps;Cb.sharedClipboardHostingEnvironments=xa.SharedClipboardHostingEnvironments;Cb.sharedClipboardOverrideOrigin=xa.SharedClipboardOverrideOrigin;Cb.sharedClipboardSchemaVersion=xa.SharedClipboardSchemaVersion;Cb.sharedClipboardExpirationInMinutes=xa.SharedClipboardExpirationInMinutes;Cb.wacCluster=xa.MachineCluster;return Cb}Trh(){const xa={clipboardStrategyType:6};xa.localStorageStrategyParameters=
this.rPe();xa.systemClipboardStrategyParameters=this.Gbd(0);return xa}Gbd(xa){const Cb={};Cb.clipboardStrategyType=xa;Cb.skipFilesIfPlainTextExists=!0;return Cb}static la(xa){xa.da.Ja(373,new Se(xa));xa.da.Ja(nf.bqa,new nf(xa))}}nf.bqa=255;Object(c.a)(nf,"CopyPasteInfrastructureFactory",e.a,[]);var oc=a(10);a.d(C,"a",function(){return Ac});const Ac=()=>{oc.a.Fa(xa=>{nf.la(xa)})}},1187:function(u,C,a){var c=a(10),b=a(0),f=a(229),e=a(42);class d extends e.a{constructor(Kb){super();Kb.da.Ja(376,this)}dZg(Kb){this.addHandler("TAF",
Kb)}Nzj(Kb){this.removeHandler("TAF",Kb)}Joj(){this.raiseEvent("TAF")}}Object(b.a)(d,"GridHighlightBehaviorEventManager",e.a,[392,2]);class h extends f.a{constructor(Kb){super();this.$=Kb;this.kc()}create(){this.Pb(this.$.da.Ba(376)||new d(this.$))}static la(Kb){Kb.da.Ja(377,new h(Kb))}}Object(b.a)(h,"GridHighlightBehaviorEventManagerFactory",f.a,[]);var l=a(52),k=a(40),n=a(31),v=a(86),x=a(15),w=a(248),r=a(14),t=a(168),A=a(7),y=a(117),z=a(13);class E extends Sys.EventArgs{constructor(Kb,pb){super();
this.start=Kb;this.i9a=pb}}Object(b.a)(E,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var G=a(30);class F extends e.a{constructor(Kb){super();this.csc=[3];this.Vsa=void 0;this.gridView=Kb;this.Wqg=G.a.yE(this.gridView.$);this.oO=G.a.yE(this.gridView.$)}get coloredReferencesManager(){const Kb=this.gridView.$.da.Ba(281);Kb||x.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
return Kb}get hC(){if(this.Vsa)return this.Vsa;const Kb=this.gridView.$.da.Ba(464);Kb||x.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");Kb.hC||x.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Vsa=Kb.hC}HXg(Kb){this.addHandler("mrek",
Kb)}oP(Kb,pb,nc){for(const Wb of this.gridView.wo)w.a.instance.ta(r.a.Tk,Wb.domElement,Kb);w.a.instance.ta(r.a.Pg,document.documentElement,pb);this.gridView.cellTextEditBox.fdc(!0);nc&&w.a.instance.ta(r.a.LC,this.gridView.qk,pb)}h6d(Kb,pb,nc){for(const Wb of this.gridView.wo)w.a.instance.Aa(r.a.Tk,Wb.domElement,Kb);w.a.instance.Aa(r.a.Pg,document.documentElement,pb);this.gridView.cellTextEditBox.fdc(!1);nc&&w.a.instance.Aa(r.a.LC,this.gridView.qk,pb)}Mtj(Kb,pb){for(const nc of this.gridView.wo)t.a.instance.ta(r.a.Zg,
nc.domElement,Kb);t.a.instance.ta(r.a.$e,document.documentElement,pb)}Pbk(Kb,pb){for(const nc of this.gridView.wo)t.a.instance.Aa(r.a.Zg,nc.domElement,Kb);t.a.instance.Aa(r.a.$e,document.documentElement,pb)}Cad(Kb,pb,nc,Wb){const Ha=document.createElement("div");Ha.className=pb;for(const $a of nc)Ha.classList.add($a);Kb.appendChild(Ha);w.a.instance.ta(r.a.pointerDown,Ha,Wb);return Ha}Zdf(Kb){Kb=Kb.tc.parentNode;if(!Kb)return x.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),
null;Kb=parseInt(Kb.getAttribute(A.a.i9a),10);return isNaN(Kb)?(x.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.dc.nE(3,1,Kb)}pRb(Kb,pb,nc=!0){Kb=nc&&(this.oO?!!this.hC&&this.hC.WDi(Kb):!!this.coloredReferencesManager&&this.coloredReferencesManager.VDi(Kb));for(const Wb of pb)z.DOMElementExtensions.setVisible(Wb,Kb)}qgc(){return this.gridView.tm?y.a(this.gridView.$):this.gridView.wc}O0f(){if(this.oO){var Kb=
this.qgc();Kb&&this.hC?this.Wqg?Kb.iF(null):this.hC.Ajb(Kb,null):(x.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.dc.Hk(this.csc),this.gridView.dc.il(null,this.csc))}else this.wrj()}wrj(){const Kb=this.qgc();Kb&&this.coloredReferencesManager?this.Wqg?Kb.iF(null):this.coloredReferencesManager.iF(Kb,null):(x.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),
this.gridView.dc.Hk(this.csc),this.gridView.dc.il(null,this.csc))}VZf(Kb,pb){this.raiseEvent("mrek",new E(Kb,pb))}}Object(b.a)(F,"BehaviorHelperMethods",e.a,[]);var O=a(92),M=a(41),P=a(101);class B extends P.a{constructor(Kb,pb=null){super(Kb,pb)}D1a(){}}Object(b.a)(B,"HighlightFlyweightBehavior",P.a,[]);var D=a(19),I=a(469),S=a(79),J=a(12),L=a(122),R=a(231),Y=a(50),Q=a(247),W=a(9),Ga=a(75),pa=a(1),aa=a(37);class Z extends Q.a{constructor(Kb,pb,nc){super(document.createElement("div"));this.Eac=null;
this.HVb=!1;this.onPointerDown=Wb=>{Wb=aa.a(this.$)?aa.a(this.$).Se(Wb):Wb;this.HVb=!1;if(3===(S.a.Vb=Wb.Wb)){const Ha=Wb.Da.rawEvent,$a=Ha.srcElement||Ha.target;z.DOMElementExtensions.lg(this.domElement,$a)&&z.DOMElementExtensions.lg(Ha.currentTarget,$a)&&(this.HVb=!0,this.Eac=Wb.clientPoint)}return!1};this.Mh=Wb=>{Wb=aa.a(this.$)?aa.a(this.$).Se(Wb):Wb;this.raiseEvent("GrPointerUp",Wb);return this.HVb=!1};this.Qj=Wb=>{Wb=aa.a(this.$)?aa.a(this.$).Se(Wb):Wb;3===Wb.Wb&&this.HVb&&this.Lni(Wb.clientPoint)&&
(this.raiseEvent("GrDrag"),this.HVb=!1);return!1};this.Gd=Wb=>{aa.a(this.$)&&aa.a(this.$).Se(Wb);return!0};this.$=nc;nc=!pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(nc?Ga.a.k1e:Ga.a.j1e);this.domElement.classList.add(Ga.a.hec);Kb.appendChild(this.domElement);z.DOMElementExtensions.setVisible(this.domElement,!1);this.sOa=document.createElement("div");this.sOa.classList.add(Ga.a.gec);this.sOa.style.borderColor=pb;this.domElement.appendChild(this.sOa);
w.a.instance.ta(r.a.pointerDown,this.domElement,this.onPointerDown);w.a.instance.ta(r.a.Pg,this.domElement,this.Mh);t.a.instance.ta(r.a.$e,this.domElement,this.Mh);w.a.instance.ta(r.a.Tk,this.domElement,this.Qj);t.a.instance.ta(r.a.Zg,this.domElement,this.Qj);R.a.instance.ta(r.a.click,this.domElement,this.Gd)}bye(Kb){this.addHandler("GrDrag",Kb)}C4f(Kb){this.removeHandler("GrDrag",Kb)}aye(Kb){this.addHandler("GrContxt",Kb)}B4f(Kb){this.removeHandler("GrContxt",Kb)}cye(Kb){this.addHandler("GrPointerUp",
Kb)}D4f(Kb){this.removeHandler("GrPointerUp",Kb)}dispose(){Y.a.zpa(this.domElement);super.dispose()}bcg(){this.domElement.classList.remove(Ga.a.hec);this.sOa.classList.remove(Ga.a.gec);this.sOa.classList.add(Ga.a.l1e)}csg(){this.sOa.classList.remove(Ga.a.l1e);this.sOa.classList.add(Ga.a.gec);this.domElement.classList.add(Ga.a.hec)}Lni(Kb){return!!this.Eac&&(3<Math.abs(Kb.x-this.Eac.x)||3<Math.abs(Kb.y-this.Eac.y))}static xAb(Kb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
(Kb=aa.a(Kb.$)?aa.a(Kb.$).zoom:W.a.u1,Math.round(9/Math.max(Kb,1))):9}}Z.QEd=0;Object(b.a)(Z,"TouchGrippie",Q.a,[]);class fa extends B{constructor(Kb,pb,nc,Wb){super(pb);this.Xzd=this.Xsb=!1;this.x7b=null;this.Uda=this.Szd=!1;this.dy=()=>{this.Xsb&&this.Szd?this.Dqa():this.U6()};this.KMf=$a=>{3===$a.Wb&&(this.Szd=!0,this.Dqa());return!1};this.LMf=$a=>{if(3===$a.Wb){if(!$a.tc||this.qBi($a))return!1;this.Szd=!1;this.U6()}return!1};this.Xe=()=>{this.Uda&&this.l6d();this.Dqa();this.Xzd=!1};this.Ls=()=>
{this.U6();this.Xzd=!0};this.GBa=($a,Nb)=>{Nb.X6===this.X6&&(Nb.visible?this.Xzd||this.Dqa():this.U6())};this.uSf=()=>{this.MMf(this.NT.domElement,!1)};this.LIf=()=>{this.MMf(this.cR.domElement,!0)};this.Iuc=($a,Nb)=>{this.ga.tCa(Nb)};this.Juc=($a,Nb)=>{this.ga.tCa(I.b(Nb))};this.RKb=()=>{3===S.a.Vb?this.Dqa():this.U6();this.Uda&&1===S.a.Vb&&this.l6d()};this.vSf=()=>{this.BLj()};this.SVe=()=>{this.U6()};this.vo=()=>{this.ga.Sa.Fc&&this.U6()};this.zIf=()=>{this.U6()};this.DMf=($a,Nb)=>{this.l6d();
3===Nb.Wb?this.Dqa():this.U6()};this.wyc=()=>{this.Xsb&&(this.U6(),this.Dqa())};const Ha=nc.$;this.iu=nc;this.ga=nc.ga;this.Cda=Kb;this.$Ij=pb;this.paneType=Wb;Kb=this.domElement.currentStyle;pb="#000000";Kb&&(pb=Kb.borderTopColor);this.NT=new Z(this.Z3e(),pb,Ha);this.cR=new Z(this.Z3e(),pb,Ha);this.NT.bye(this.uSf);this.NT.aye(this.Iuc);this.NT.cye(this.Juc);this.cR.bye(this.LIf);this.cR.aye(this.Iuc);this.cR.cye(this.Juc);for(const $a of this.gridView.wo)t.a.instance.ta(r.a.Yf,$a.domElement,this.LMf),
t.a.instance.ta(r.a.$e,$a.domElement,this.KMf);nc.view.ls(this.dy);nc.wc.ao(this.SVe);nc.dc.isb(this.GBa);nc.c2c(this.zIf);Ha.dA(this.wyc);nc.jt(this.wyc);this.ga.I4(this.Xe);this.ga.eba(this.Ls);nc.KF(this.vo);this.ga.p4b(this.DMf);S.a.jye(this.RKb);k.TaskExtensions.za(l.GetServiceTaskFactory.Za(Ha.da,376,377,0),$a=>{$a.result.dZg(this.vSf)},Ha.ka,3)}get gridView(){return this.iu}dispose(){O.a.Rc([this.NT,this.cR]);this.NT.C4f(this.uSf);this.NT.B4f(this.Iuc);this.NT.D4f(this.Juc);this.cR.C4f(this.LIf);
this.cR.B4f(this.Iuc);this.cR.D4f(this.Juc);for(var Kb of this.gridView.wo)t.a.instance.Aa(r.a.Yf,Kb.domElement,this.LMf),t.a.instance.Aa(r.a.$e,Kb.domElement,this.KMf);this.gridView.view.oq(this.dy);this.gridView.wc.Un(this.SVe);this.gridView.dc.JOb(this.GBa);this.gridView.YRd(this.zIf);this.gridView.$.UC(this.wyc);this.gridView.Rv(this.wyc);this.ga.c2(this.Xe);this.ga.Ufa(this.Ls);this.gridView.dH(this.vo);this.ga.Nzc(this.DMf);S.a.J4f(this.RKb);this.Uda&&x.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");
(Kb=this.gridView.$.da.Ba(376))&&Kb.Nzj(this.vSf);super.dispose()}DVa(){if(!this.Cda.range||!this.Cda.range.equals(this.Mgb))return!1;const Kb=!this.gridView.ZPa();return this.gridView.Eb&&Kb&&(this.Mgb.isRow||this.Mgb.gh)?!1:this.Uda?!0:3===S.a.Vb}U6(){this.Xsb&&(this.NT.set_visible(!1),this.cR.set_visible(!1),this.Xsb=!1)}Dqa(){if(this.DVa()){var Kb=z.DOMElementExtensions.getBoundingClientRect(this.x7b);Kb||x.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",
this.gridView.qk,this.gridView.Cb.jj);var pb=z.DOMElementExtensions.getBoundingClientRect(this.$Ij),nc=new Sys.UI.Bounds(pb.x-Kb.x,pb.y-Kb.y,pb.width,pb.height),Wb=this.Mgb,Ha=Wb.topLeft,$a=Wb.bottomRight,Nb=Wb.isRow||Wb.gh;if(Wb.gh){var rb=this.SSh();Wb=nc.x-2*Z.xAb(this.gridView);var ec=rb;var pc=nc.x+pb.width}else Wb.isRow?(Wb=pc=this.RSh(),ec=nc.y-2*Z.xAb(this.gridView),rb=nc.y+pb.height):(ec=nc.y,rb=nc.y+pb.height,this.gridView.rtl?(Wb=nc.x+pb.width,pc=nc.x):(Wb=nc.x,pc=nc.x+pb.width));pb=Z.QEd+
(Nb?0:Z.xAb(this.gridView));this.NT.style.left=J.HelperMethods.Yc(Wb-pb);this.NT.style.top=J.HelperMethods.Yc(ec-pb);this.cR.style.left=J.HelperMethods.Yc(pc-pb);this.cR.style.top=J.HelperMethods.Yc(rb-pb);this.NT.set_visible(this.arf(ec,Wb,Ha,Nb,Kb));this.cR.set_visible(this.arf(rb,pc,$a,Nb,Kb));this.Xsb=!0}}arf(Kb,pb,nc,Wb,Ha){const $a=z.DOMElementExtensions.getBoundingClientRect(this.gridView.og(this.paneType).domElement);Ha=new Sys.UI.Bounds($a.x-Ha.x-3,$a.y-Ha.y-3,$a.width+6,$a.height+6);return(this.gridView.Cb.ti(nc)===
this.paneType||Wb)&&M.a.sS(Ha,new Sys.UI.Point(pb,Kb))}SSh(){return(this.gridView.view.visibleArea.height+this.gridView.Cb.height+Z.QEd-Z.xAb(this.gridView))/2}RSh(){return(this.gridView.view.visibleArea.width+this.gridView.Cb.width+Z.QEd-Z.xAb(this.gridView))/2}GQf(){this.Dqa()}qBi(Kb){return z.DOMElementExtensions.yUa(Kb.tc,D.a.Eu)&&(this.ECi(Kb)||this.FCi(Kb))}FCi(Kb){if(this.gridView.rtl)Kb=Kb.clientPoint.x;else{const pb=z.DOMElementExtensions.getBoundingClientRect(Kb.tc);Kb=Kb.clientPoint.x-
(pb.x+pb.width-L.a.Uv)}return 0<Kb&&Kb<=L.a.Uv}ECi(Kb){const pb=z.DOMElementExtensions.getBoundingClientRect(Kb.tc);Kb=Kb.clientPoint.y-(pb.y+pb.height-L.a.Uv);return 0<Kb&&Kb<=L.a.Uv}MMf(Kb,pb){this.Uda&&x.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.o7c(Kb,pb,this.Uda);this.U6()}BLj(){this.Uda||(x.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Uda=!0,this.NT.bcg(),this.cR.bcg(),this.gridView.ga.sourceRange=
this.gridView.ga.pa.Hd,this.Dqa())}l6d(){this.Uda&&(x.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Uda=!1,this.NT.csg(),this.cR.csg())}Z3e(){this.x7b||(this.x7b=this.gridView.qk);return this.x7b}}Object(b.a)(fa,"SelectionTouchGrippiesBehaviorBase",B,[]);class ya extends fa{constructor(Kb,pb,nc,Wb){super(Kb,pb,nc,Wb)}get X6(){return 19}get Mgb(){return this.gridView.ga.pa.activeRange}DVa(){const Kb=this.gridView.Wi||this.gridView.Eb;return!this.gridView.ga.pa.Lh&&
!Kb&&super.DVa()}}Object(b.a)(ya,"DiscontinuousSelectionTouchGrippiesBehavior",fa,[]);var Aa=a(277);class ja extends B{constructor(Kb){super(Kb);const pb=document.createElement("div");pb.className=Ga.a.UNh;Kb.appendChild(pb)}}Object(b.a)(ja,"SelectionBorderBehavior",B,[]);class za{}za.shd="ewr-selection-draghandle";za.thd="ewr-selection-draghandle-grab";za.NNh="ewr-selection-draghandle-top-ie";za.ONh="ewr-selection-draghandle-top-ie-enhanced";za.LNh="ewr-selection-draghandle-top";za.MNh="ewr-selection-draghandle-top-enhanced";
za.BNh="ewr-selection-draghandle-bottom-ie";za.CNh="ewr-selection-draghandle-bottom-ie-enhanced";za.zNh="ewr-selection-draghandle-bottom";za.ANh="ewr-selection-draghandle-bottom-enhanced";za.FNh="ewr-selection-draghandle-left-ie";za.GNh="ewr-selection-draghandle-left-ie-enhanced";za.DNh="ewr-selection-draghandle-left";za.ENh="ewr-selection-draghandle-left-enhanced";za.JNh="ewr-selection-draghandle-right-ie";za.KNh="ewr-selection-draghandle-right-ie-enhanced";za.HNh="ewr-selection-draghandle-right";
za.INh="ewr-selection-draghandle-right-enhanced";za.PNh="ewr-selection-dragtooltip";za.QNh="ewr-selection-dragtooltip-updated";za.aOh="ewr_selection_rearrangeleft";za.bOh="ewr_selection_rearrangeright";za.cOh="ewr_selection_rearrangetop";za.$Nh="ewr_selection_rearrangebottom";za.selecting="selecting";za.dOh="ewr-selection-resizemarqueehandle";za.gOh="ewr-selection-resizemarqueehandle-topleft";za.hOh="ewr-selection-resizemarqueehandle-topright";za.eOh="ewr-selection-resizemarqueehandle-bottomleft";
za.fOh="ewr-selection-resizemarqueehandle-bottomright";za.pNh="ewr-marquee-thick";za.tNh="ewr-resizemarqueehandle-thick";Object(b.a)(za,"CssClassNames",null,[]);var ra=a(261),fb=a(20);class Ua extends ja{constructor(Kb,pb,nc,Wb){super(Kb);this.nWa=!1;this.Sue=this.Tue=null;this.Vaa=0;this.Pq=pa.EwaSettings.getBooleanFeatureGate(Aa.a.Bcc,!1);this.PAi=pa.EwaSettings.getBooleanFeatureGate(Aa.a.iAh,!1);this.y8d=this.Asd=this.q_=0;this.JX=this.hc=this.sourceRange=this.npa=null;this.Mh=Ha=>{Ha=aa.a(this.$).Se(Ha);
return this.qPf(Ha)};this.onPointerDown=Ha=>{Ha=aa.a(this.$).Se(Ha);if(pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&!this.Rhb())return!1;if(2===Ha.Wb&&Ha.Ro===Sys.UI.MouseButton.leftButton&&!this.nWa){var $a=this.$od(Ha);if(!$a)return x.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.hc=$a.clone();this.sourceRange=this.hc.clone();this.npa=this.hc;if($a=this.S9h(Ha))if(this.Kn=5,this.y8d=
$a.top-this.sourceRange.top,this.Asd=$a.left-this.sourceRange.left,fb.h(this.$).Ch.rq(this.Pq?Ua.Wxb:Ua.mVe),this.nKd(Ha),this.nWa=!0,ra.b(this.$,!0),pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))return!0}return!1};this.Qj=Ha=>{Ha=aa.a(this.$).Se(Ha);if(this.Pq&&this.oKd(Ha))return!0;if(Ha=this.ga.Yq(Ha.clientPoint,Ha.tc,5,void 0,void 0,!0)){Ha=this.Aub(Ha);if(this.hc.equals(Ha))return!0;this.hc=Ha;if(!this.PT())return x.ULS.shipAssertTag(537159378,0,!1,
"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Eec(!0),!1}return!0};this.Td=(Ha,$a)=>{$a.uO||(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.bVa(this.$.isEditMode&&this.Rhb()):this.bVa(this.$.isEditMode))};this.qA=[];this.$=pb;this.ga=fb.h(this.$).ga;this.paneType=nc;this.jp=Wb;pb=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.AWd=this.PAi?pb?[za.MNh,za.ANh,za.ENh,za.INh]:[za.ONh,za.CNh,za.GNh,za.KNh]:pb?[za.LNh,za.zNh,za.DNh,za.HNh]:[za.NNh,za.BNh,za.FNh,za.JNh];if(!pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const Ha of this.AWd)pb=this.jp.Cad(Kb,Ha,this.Pq?[za.thd]:[za.shd],this.onPointerDown),this.qA.push(pb);this.$.Ql(this.Td);pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.bVa(this.$.isEditMode)}get dc(){return fb.h(this.$).dc}get Kn(){return this.ga.selectionType}set Kn(Kb){this.ga.selectionType=
Kb}dispose(){this.qA.forEach(Kb=>{w.a.instance.Aa(r.a.pointerDown,Kb,this.onPointerDown)});this.qA.length=0;this.npa=this.sourceRange=this.hc=null;x.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Vaa}, EwaControl is null : ${!this.$}`);this.$&&(this.$.Rm(this.Td),1===this.Vaa&&(x.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.MK(this.Sue,this.Tue,!1)));super.dispose()}qPf(Kb){if(5!==
this.Kn)return!1;(Kb=this.jSa(Kb))||this.Eec(!1);ra.b(this.$,!1);return Kb}oP(Kb,pb){x.ULS.shipAssertTag(537159377,0,!this.Vaa,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.Vaa}`);this.Vaa+=1;this.Sue=Kb;this.Tue=pb;this.jp.oP(Kb,pb,this.b5d())}Aub(Kb){if(!Kb||!this.hc)return x.ULS.shipAssertTag(537159376,0,!!Kb,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),x.ULS.shipAssertTag(537159375,
0,!!this.hc,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const pb=this.hc.clone();1!==this.q_&&(pb.left=Math.max(Kb.left-this.Asd,1),pb.right=pb.left+this.sourceRange.width-1);2!==this.q_&&(pb.top=Math.max(Kb.top-this.y8d,1),pb.bottom=pb.top+this.sourceRange.height-1);return this.vsb(pb)}MK(Kb,pb,nc=!0,Wb=!0){x.ULS.shipAssertTag(537159374,0,1===this.Vaa,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.Vaa}`);--this.Vaa;
this.Pq||fb.h(this.$).Ch.rq(A.a.zW);this.jp.h6d(Kb,pb,this.b5d());nc&&this.yJe(Wb);this.q_=0;this.nWa=!1}vsb(Kb){var pb=fb.h(this.$);let nc=Kb;if(pb.Cb.HW){if(!pb.jc(Kb.topLeft)){pb=pb.sj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",pb.QR,this.npa.top!==Kb.top?1:2);try{pb.ul=this.npa.top<Kb.top||this.npa.left<Kb.left,pb.Sw(Kb.topLeft),nc=pb.$$cu().range}finally{pb&&pb.dispose()}}pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?(nc.right=Math.min(nc.left+
Kb.width-1,W.a.Gg),nc.bottom=Math.min(nc.top+Kb.height-1,W.a.Hg)):(nc.right=nc.left+Kb.width-1,nc.bottom=nc.top+Kb.height-1)}return this.npa=nc}bVa(Kb){this.qA.forEach(pb=>{z.DOMElementExtensions.setVisible(pb,Kb)})}S9h(Kb){const pb=Kb.tc;Kb=Kb.clientPoint;if(!pb||!Kb)return x.ULS.shipAssertTag(537159373,0,!!pb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),x.ULS.shipAssertTag(537159372,0,!!Kb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;Kb.y+=
pb===this.qA[Ua.Ecc]?2:pb===this.qA[Ua.pVe]?-2:0;Kb.x+=pb===this.qA[Ua.rVe]?2:pb===this.qA[Ua.Dcc]?-2:0;return this.ga.Yq(Kb,pb,5,void 0,void 0,!0)}}Ua.mVe="move";Ua.Z$c="copy";Ua.Wxb="grabbing";Ua.Ecc=0;Ua.pVe=1;Ua.rVe=2;Ua.Dcc=3;Object(b.a)(Ua,"DragSelectionClickBehaviorBase",ja,[]);class Ca extends Ua{constructor(Kb,pb,nc,Wb,Ha,$a){super(Kb,pb,nc,Ha);this.Xb=this.gH=null;this.Mhf=()=>{this.Eec(!0)};if(pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const Nb of this.AWd)pb=
this.jp.Cad(Kb,Nb,this.Pq?[za.thd]:[za.shd],this.onPointerDown),this.qA.push(pb);pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.bVa(this.$.isEditMode);this.gridView=fb.h(this.$);this.NG=Wb;this.coloredReferencesManager=this.$.da.Ba(281);x.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.oO=G.a.yE(this.$))Kb=this.$.da.Ba(464),
x.ULS.shipAssertTag(512312961,0,!!Kb,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.hC=Kb.hC;for(const Nb of this.qA)w.a.instance.ta(r.a.KX,Nb,this.NG.Wkf),w.a.instance.ta(r.a.LC,Nb,this.NG.Xkf);this.D1a($a)}D1a(Kb){this.jp.pRb(Kb,this.qA);this.NG.h2()}nKd(Kb){x.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.YOa=!0;this.Xb.SF(!1);this.Kn=
5;this.NG.tVe(Kb.tc);this.Xb.textBox.removeSelection();this.Xb.z4b(this.Mhf);this.oP(this.Qj,this.Mh);this.q_=this.sourceRange.isRow?1:this.sourceRange.gh?2:0}jSa(){const Kb=this.uY();this.Kn=-1;this.MK(this.Qj,this.Mh);return Kb}yJe(){this.gridView.YOa=!1;this.NG.uVe(this.qA[0]);this.Xb.textBox.setCaretPositionToEnd();this.Xb.Wzc(this.Mhf);this.jp.O0f()}Eec(Kb){x.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
Kb&&this.MK(this.Qj,this.Mh)}$od(Kb){this.Xb=this.jp.qgc();this.gH=this.jp.Zdf(Kb);return this.Xb&&this.gH&&this.gH.range?this.gH.range:(x.ULS.shipAssertTag(537159388,0,!!this.Xb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),x.ULS.shipAssertTag(537159387,0,!!this.gH,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),x.ULS.shipAssertTag(537159386,0,!!this.gH.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),
null)}uY(){return this.gH?this.oO?this.hC.iJb(this.Xb,this.gH,this.hc):this.coloredReferencesManager.iJb(this.Xb,this.gH,this.hc):(x.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}PT(){return this.uY()}b5d(){return!0}oKd(){return!1}Rhb(){return!0}}Object(b.a)(Ca,"DragMarqueeClickBehavior",Ua,[]);var Ia=a(90),oa=a(113),Da=a(185),bb=a(84),Za=a(425),Xa=a(738),Ba=a(232),
Wa=a(33),Na=a(49);class ta extends Ua{constructor(Kb,pb,nc,Wb,Ha){super(Kb,pb,nc,Ha);this.Qh=null;this.gh=this.isRow=!1;this.Xe=()=>{this.domElement.classList.remove(za.selecting)};this.Ls=()=>{this.domElement.classList.add(za.selecting)};this.Dd=()=>{if(this.$.isEditMode){const $a=this.Rhb();this.bVa($a)}};this.tableManager=Wb;if(pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)){if(0===ta.hcc[nc].length)for(const $a of this.AWd)pb=document.createElement("div"),
pb.className=$a,pb.classList.add(this.Pq?za.thd:za.shd),ta.hcc[nc].push(pb);for(const $a of ta.hcc[nc])Kb.appendChild($a),w.a.instance.ta(r.a.pointerDown,$a,this.onPointerDown),this.qA.push($a)}pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.bVa(this.Rhb()&&this.$.isEditMode):this.bVa(this.$.isEditMode);this.Xm={};this.zA=!1;this.ga.eba(this.Ls);this.ga.I4(this.Xe);pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1)||this.ga.EK(this.Dd);this.g8d=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ga&&(this.ga.Ufa(this.Ls),this.ga.c2(this.Xe),pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)||this.ga.sP(this.Dd),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ga.jAc(this.jdb));if(this.Xm)for(var Kb=1;4>=Kb;Kb++)z.DOMElementExtensions.gg(this.Xm[Kb.toString()]);if(pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1))for(Kb=1;4>=Kb;Kb++)ta.hcc[Kb].length=0;this.Xm=this.Qh=null;super.dispose()}yJe(Kb){Kb&&(this.Pq&&fb.h(this.$).Ch.rq(A.a.zW),oa.KeyInputManager.instance.Aa(r.a.yc,this.domElement.ownerDocument.body,this.onKeyDown),this.zA=!1);for(Kb=1;4>=Kb;Kb++){const pb=this.Xm[Kb.toString()];pb&&pb.parentNode.removeChild(pb);this.Xm[Kb.toString()]=null}this.Qh=null}$od(){return this.ga.pa.Hd}uY(){this.ga.updateSelection(this.hc,this.hc.topLeft,0);return!0}PT(Kb=!1){this.dc.il(this.hc,this.Wl());this.dc.Ur(this.Wl());
this.SJ(Kb);return!0}zra(Kb=!1){this.dc.il(this.hc,this.Qh);this.dc.Ur(this.Qh);this.SJ(Kb)}Eec(){x.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}b5d(){return!1}U9(Kb,pb,nc,Wb,Ha=!1){var $a=z.DOMElementExtensions.getBoundingClientRect(pb);let Nb=pb===this.qA[Ua.Ecc]||pb===this.qA[Ua.pVe];if(this.Pq){var rb=pb===this.qA[Ua.rVe]||pb===this.qA[Ua.Dcc];this.isRow&&rb||this.gh&&Nb?rb="100px":(Nb=this.isRow||Nb,rb=
(Nb?Ha?ta.X7j:ta.b8j:Ha?ta.W7j:ta.Z7j)+"px");pb=Nb?pb===this.qA[Ua.Ecc]?"top":"bottom":pb===this.qA[Ua.Dcc]?"right":"left";Kb=100*(Nb?Kb.x-$a.x:Kb.y-$a.y)/(Nb?$a.width:$a.height);for($a=1;4>=$a;$a++){Wb=document.createElement("div");var ec=document.createElement("div");const pc=document.createElement("div");Wb.appendChild(ec);Wb.appendChild(pc);Ha&&(ec=document.createElement("div"),Wb.appendChild(ec),pc.style.fontWeight="bold");Wb.className=za.QNh;this.Xm[$a.toString()]=Wb;this.dc.nE(nc,$a).Fg.appendChild(Wb);
Wb=this.Xm[$a.toString()];Wb.style[pb]=rb;Wb.style[Nb?"left":"top"]=Kb+"%"}}else for(Ha=(Nb?-ta.a8j:-ta.Y7j)+"px",rb=Nb?pb===this.qA[Ua.Ecc]?"top":"bottom":pb===this.qA[Ua.Dcc]||Wb?"right":"left",pb=100*(Nb?Wb?0:Kb.x-$a.x:Kb.y-$a.y)/(Nb?$a.width:$a.height),Kb=1;4>=Kb;Kb++)$a=document.createElement("div"),$a.className=za.PNh,this.Xm[Kb.toString()]=$a,this.dc.nE(nc,Kb).Fg.appendChild($a),$a=this.Xm[Kb.toString()],$a.style[rb]=Ha,$a.style[Nb?"left":"top"]=pb+"%"}Ktg(Kb,pb,nc){const Wb=fb.h(this.$),Ha=
Wb.Vg(Kb);var $a=Wb.og(this.paneType);nc=Xa.a.aw($a.view.Zi,this.domElement.parentNode,nc,Wb.rtl);$a=!1;let Nb=2;pb&&nc.y-Ha.topLeft.y>Ha.height/2?($a=!0,Nb=1):!pb&&nc.x-Ha.topLeft.x>Ha.width/2&&($a=!0);if($a){pb=Wb.sj("DragSelectionClickBehavior.updateMouseSelectionRange",Wb.QR,Nb);try{pb.Sw(Kb),pb.$$mn(),pb.$$cu()}finally{pb&&pb.dispose()}}}$ub(Kb){this.dc.Hk(this.Qh);this.MK(this.Qoa,this.Roa,void 0,Kb)}pV(Kb){this.dc.Hk(this.Wl());this.MK(this.Qj,this.Mh,void 0,Kb)}JAb(){return this.Pq?48:6}Wl(){return this.Pq?
ta.jAh:ta.nAh}N9a(Kb){return Kb.Da.keyCode===Ia.a.Hra||n.a.isMac&&Kb.Da.keyCode===Ia.a.CXa}YDb(Kb){Kb=fb.h(this.$).getRangeInformation(Kb);for(let pb=0,nc=Kb.length;pb<nc;++pb)if(Object(Za.a)(Ba.PivotTableRange,Kb[pb]))return Kb=Wa.a.Od(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Na.a(this.$).Wu([Kb]),!0;return!1}}ta.Y7j=50;ta.a8j=25;ta.Z7j=-85;ta.b8j=-40;ta.W7j=-120;ta.X7j=-50;ta.nAh=[6];ta.jAh=[48];ta.hcc=[[],[],[],[],[],[]];Object(b.a)(ta,"DragSelectionClickBehavior",Ua,[]);var V=a(25),ia=
a(794),X=a(47),la=a(200),sa=a(120),Va=a(246),nb=a(58);const ha=(Kb,pb,nc,Wb,Ha,$a,Nb,rb=null)=>{rb=Kb.Pa(41,rb);rb.sourceRange=pb;rb.destinationRange=nc;return nb.g(Kb,"RearrangeRowColumn",rb,Wb,Ha,$a,Nb,0)},jb=(Kb,pb,nc,Wb,Ha,$a,Nb=null)=>{Nb=Kb.Pa(1,Nb);Nb.moveRange=pb;return nb.g(Kb,"MoveLineItems",Nb,nc,Wb,Ha,$a,0)};class Fb{constructor(Kb,pb){this.destinationRange=this.sourceRange=null;this.sourceRange=Kb;this.destinationRange=pb}}Object(b.a)(Fb,"MacroRecorderTableRowColumnRearrangedPayload",
null,[139]);var Rb=a(16);class mb extends ta{constructor(Kb,pb,nc,Wb,Ha){super(Kb,pb,nc,Wb,Ha);this.Bga=null;this.zS=this.AS=!1;this.Nwf=0;this.GDa=this.Gwa=null;this.$K=0;this.Fcc=Rb.a.instance.ha(2269);this.vVe=Rb.a.instance.ha(2270);this.nEc=Rb.a.instance.ha(2271);this.cgg=Rb.a.instance.ha(2272);this.onKeyDown=$a=>{if(this.Pq){if(this.N9a($a)||$a.Da.keyCode===Ia.a.DXa)return this.QPa||(oa.KeyInputManager.instance.ta(r.a.te,this.domElement.ownerDocument.body,this.onKeyUp),this.QPa=!0),!this.O0&&
this.N9a($a)&&(fb.h(this.$).Ch.rq(Ua.Z$c),this.O0=!0),this.P0||$a.Da.keyCode!==Ia.a.DXa||(fb.h(this.$).Ch.rq(Ua.Wxb),this.P0=!0,2===this.$K?(x.ULS.shipAssertTag(509159443,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150300,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!1),this.q_=0,this.Qh=this.zS?[11]:[12],this.AS=this.zS,this.SQd(),x.ULS.shipAssertTag(509159442,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.zra()):3===this.$K?(x.ULS.shipAssertTag(509159441,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150299,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Zub(!1),this.q_=this.isRow?1:2,this.wpa(),x.ULS.shipAssertTag(509159440,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.PT()):1===this.$K&&(x.ULS.shipAssertTag(509159439,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
x.ULS.sendTraceTag(509150298,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.$ub(!1),this.wpa(),x.ULS.shipAssertTag(509159438,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.PT())),!0}else if(!this.O0&&($a.Da.keyCode===Ia.a.Hra||n.a.isMac&&$a.Da.keyCode===Ia.a.CXa))return oa.KeyInputManager.instance.ta(r.a.te,this.domElement.ownerDocument.body,this.onKeyUp),fb.h(this.$).Ch.rq(Ua.Z$c),this.O0=!0;return!1};this.onKeyUp=
$a=>{if(this.Pq){if(this.N9a($a)||$a.Da.keyCode===Ia.a.DXa)return this.Nwf=this.N9a($a)?0:1,this.zA&&fb.h(this.$).Ch.rq(Ua.Wxb),$a.Da.keyCode===Ia.a.DXa&&(2===this.$K?(x.ULS.shipAssertTag(509159437,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150297,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Zub(!1),this.q_=0,this.wpa(!0),x.ULS.shipAssertTag(509159436,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.PT(!0)):3===this.$K?(x.ULS.shipAssertTag(509159435,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150296,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!1),this.q_=this.isRow?1:2,this.Qh=this.isRow?[11]:[12],this.SQd(!0),x.ULS.shipAssertTag(509159434,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zra(!0)):1===this.$K&&(x.ULS.shipAssertTag(509159433,
0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150295,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!1),this.Qh=this.zS?[11]:[12],this.SNb(!0),x.ULS.shipAssertTag(509159432,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zra(!0))),this.KIc(this.Nwf),!0}else if($a.Da.keyCode===Ia.a.Hra||n.a.isMac&&$a.Da.keyCode===Ia.a.CXa)return this.KIc(),this.zA&&fb.h(this.$).Ch.rq(Ua.mVe),
!0;return!1};this.Roa=$a=>{$a=aa.a(this.$).Se($a);5===this.Kn?this.qPf($a):(this.zA=!1,x.ULS.shipAssertTag(509159430,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.dc.Hk(this.Qh),!this.$.mt([this.hc],!1)||this.trj()||this.Csf()||(this.ga.sourceRange=this.sourceRange.clone(),this.Pq?this.Fmj():this.g2e(),this.cea()?this.hc.top>this.sourceRange.top&&($a=this.hc.height,this.hc.top-=$a,this.hc.bottom-=$a):this.hc.left>this.sourceRange.left&&($a=this.hc.width,
this.hc.left-=$a,this.hc.right-=$a),this.uY()),this.SCd());x.ULS.sendTraceTag(509150292,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.MK(this.Qoa,this.Roa);this.tableRange=null;this.Kn=-1;this.Pq&&(this.Bga=null,this.$K=0);return!0};this.iLb=()=>{this.zA=!1;this.$K=0;x.ULS.shipAssertTag(509159429,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.dc.Hk(this.Qh);if(!this.$.mt([this.hc],!1))return x.ULS.sendTraceTag(509150291,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.MK(this.hLb,this.iLb),this.Kn=-1,!0;if(!(this.ga.pa.Hd.equals(this.hc)||this.YDb(this.hc)||this.YDb(this.sourceRange)||this.Csf()||(this.uY(),this.ga.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[A.a.WLa]:this.O0,[A.a.sed]:!0,[A.a.ted]:this.AS,[A.a.Jca]:this.ga.sourceRange,[A.a.Ica]:this.ga.pa.Hd,[A.a.Txb]:this.P0}),this.O0))){if(this.hc.top>this.sourceRange.top&&(this.isRow||this.hc.left===this.sourceRange.left&&
this.AS)){var $a=this.hc.height;this.hc.top-=$a;this.hc.bottom-=$a}else this.hc.left>this.sourceRange.left&&(this.gh||this.hc.top===this.sourceRange.top&&!this.AS)&&($a=this.hc.width,this.hc.left-=$a,this.hc.right-=$a);this.uY()}x.ULS.sendTraceTag(509150290,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.MK(this.hLb,this.iLb);this.Bga=this.tableRange=null;this.Kn=-1;this.AS=!1;this.SCd();return!0};this.Qoa=$a=>{const Nb=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Nb&&($a=aa.a(this.$).Se($a));var rb=$a.clientPoint;Nb||($a=aa.a(this.$).Se($a));this.Pq&&(this.JX=$a);if($a=this.ga.Yq(rb,$a.tc,5,void 0,void 0,!0)){if(this.tableRange.contains($a.topLeft)){if(this.Ktg($a,this.cea(),rb),this.hc=this.fKa($a),this.ga.sourceRange=this.hc,this.dc.il(this.hc,this.Qh),x.ULS.shipAssertTag(509159428,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.dc.Ur(this.Qh),x.ULS.shipAssertTag(509159427,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.dc.Hk(this.Wl()),6!==this.Kn){for(rb=1;4>=rb;rb++)$a=this.Xm[rb.toString()],$a.parentNode.removeChild($a),this.dc.nE(this.cea()?11:12,rb).Fg.appendChild($a);this.Kn=6}}else if(this.hc=this.Aub($a),this.Pq)this.lhf(!1);else if(this.dc.il(this.hc,this.Wl()),x.ULS.shipAssertTag(509159426,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.dc.Ur(this.Wl()),x.ULS.shipAssertTag(509159425,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.dc.Hk(this.Qh),5!==this.Kn){for(rb=1;4>=rb;rb++)$a=this.Xm[rb.toString()],$a.parentNode.removeChild($a),this.dc.nE(this.JAb(),rb).Fg.appendChild($a);this.Kn=5}this.SJ()}return!0};this.hLb=$a=>{var Nb=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Nb&&($a=aa.a(this.$).Se($a));var rb=$a.clientPoint;Nb||($a=aa.a(this.$).Se($a));this.JX=$a;if(Nb=this.ga.Yq(rb,$a.tc,5,void 0,void 0,!0)){if(this.Qif(Nb))return this.hc=this.Aub(Nb),this.khf(!1),!0;var ec=fb.h(this.$),
pc=ec.Vg(Nb),vb=ec.og(this.paneType);rb=Xa.a.aw(vb.view.Zi,this.domElement.parentNode,rb,ec.rtl);vb=!1;let ob=2;this.AS=!1;if(this.isRow||this.gh){this.isRow&&rb.y-pc.topLeft.y>pc.height/2?(vb=!0,ob=1):this.gh&&rb.x-pc.topLeft.x>pc.width/2&&(vb=!0);if(vb){$a=ec.sj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ec.QR,ob);try{$a.Sw(Nb),$a.$$mn(),Nb=$a.$$cu().range}finally{$a&&$a.dispose()}}this.hc=this.Aub(Nb)}else{rb.x-pc.topLeft.x===pc.width?(this.AS=!1,vb=!0):rb.y-pc.topLeft.y>
pc.height/2&&(this.AS=vb=!0,ob=1);this.Bga&&(this.AS=this.zS);if(vb){ec=ec.sj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ec.QR,ob);try{ec.Sw(Nb),ec.$$mn(),Nb=ec.$$cu().range}finally{ec&&ec.dispose()}}x.ULS.shipAssertTag(509159424,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.dc.Hk(this.Qh);this.Qh=this.AS?[11]:[12];for(ec=1;4>=ec;ec++)(pc=this.Xm[ec.toString()])&&pc.parentNode.removeChild(pc),this.Xm[ec.toString()]=null;this.U9($a.clientPoint,
$a.tc,this.AS?11:12,!0);this.hc=this.fKa(Nb)}this.ga.sourceRange=this.hc;this.dc.il(this.hc,this.Qh);x.ULS.shipAssertTag(509159395,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.dc.Ur(this.Qh);x.ULS.shipAssertTag(509159394,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.dc.Hk(this.Wl());if(6!==this.Kn){for($a=1;4>=$a;$a++)Nb=this.Xm[$a.toString()],Nb.parentNode.removeChild(Nb),this.dc.nE(this.isRow||this.AS?11:
12,$a).Fg.appendChild(Nb);this.Kn=6}this.SJ()}return!0};this.jdb=()=>{this.Pq?this.zA&&5<=this.Kn&&(this.tableRange?this.P0?(x.ULS.shipAssertTag(509159381,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150281,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!0)):(x.ULS.shipAssertTag(509159380,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150280,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.$ub(!0)):this.P0?this.isRow||this.gh?(x.ULS.shipAssertTag(509159385,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150285,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!0)):(x.ULS.shipAssertTag(509159384,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150284,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Zub(!0)):this.isRow||this.gh?(x.ULS.shipAssertTag(509159383,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150283,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Zub(!0)):(x.ULS.shipAssertTag(509159382,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150282,0,50,
"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!0))):this.zA&&5<=this.Kn&&(this.tableRange?(x.ULS.shipAssertTag(509159378,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.dc.Hk(this.Qh),x.ULS.sendTraceTag(509150278,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.MK(this.Qoa,this.Roa)):(x.ULS.shipAssertTag(509159379,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.dc.Hk(this.Wl()),x.ULS.sendTraceTag(509150279,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.MK(this.Qj,this.Mh)))};this.tableRange=null;this.QPa=this.O0=this.P0=!1;this.ga.N2c(this.jdb)}dispose(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ga&&this.ga.jAc(this.jdb);this.O0&&this.KIc();this.Pq&&this.P0&&this.KIc(1);super.dispose()}nKd(Kb){this.Pq&&(this.JX=Kb,this.Bga=null,this.zS=this.isRow=this.gh=this.AS=
!1,oa.KeyInputManager.instance.ta(r.a.yc,this.domElement.ownerDocument.body,this.onKeyDown));this.zA=!0;this.tableRange=this.V$g(this.tableManager.Lq(this.sourceRange.topLeft));fb.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Pq?(this.Bga=this.tableRange,this.$K=1,this.Qh=(this.zS=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Kn=6,x.ULS.sendTraceTag(509150305,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),
this.oP(this.Qoa,this.Roa),this.Gwa=this.Fcc,this.GDa=this.nEc,this.U9(Kb.clientPoint,Kb.tc,this.zS?11:12,!0,!0),x.ULS.shipAssertTag(509159447,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zra(!0)):(this.Qh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Kn=6,x.ULS.sendTraceTag(509150304,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oP(this.Qoa,
this.Roa),this.U9(Kb.clientPoint,Kb.tc,this.isRow?11:12,!0)):(this.tableRange=null,this.Pq?(this.isRow=this.sourceRange.isRow,this.gh=this.sourceRange.gh,this.isRow||this.gh?(this.$K=3,this.q_=this.isRow?1:2,this.Kn=6,this.Qh=this.isRow?[11]:[12],x.ULS.sendTraceTag(509150303,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oP(this.hLb,this.iLb),this.Gwa=this.Fcc,this.GDa=this.nEc,this.U9(Kb.clientPoint,Kb.tc,this.isRow?11:12,!0,!0),x.ULS.shipAssertTag(509159446,
0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zra(!0)):(this.$K=2,this.q_=0,x.ULS.sendTraceTag(509150302,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oP(this.Qj,this.Mh),this.Gwa=this.vVe,this.GDa=this.cgg,this.U9(Kb.clientPoint,Kb.tc,this.JAb(),!1,!0),x.ULS.shipAssertTag(509159445,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.PT(!0))):(x.ULS.sendTraceTag(509150301,0,50,
"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oP(this.Qj,this.Mh),oa.KeyInputManager.instance.ta(r.a.yc,this.domElement.ownerDocument.body,this.onKeyDown),this.q_=this.sourceRange.isRow?1:this.sourceRange.gh?2:0,this.U9(Kb.clientPoint,Kb.tc,this.JAb(),!1),x.ULS.shipAssertTag(509159444,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.PT()))}jSa(){this.zA=!1;this.Pq&&(this.$K=0);x.ULS.shipAssertTag(509159431,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");
this.dc.Hk(this.Wl());if(!this.$.mt([this.hc],!1))return x.ULS.sendTraceTag(509150294,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.MK(this.Qj,this.Mh),this.Kn=-1,!0;if(this.ga.pa.Hd.equals(this.hc)||this.YDb(this.hc)||this.YDb(this.sourceRange))this.Kn=-1;else{this.uY();this.ga.sourceRange=this.sourceRange.clone();const Kb=this.ga.sourceRange,pb=this.ga.pa.Hd;this.Pq?this.$.xd(-694765314,2,30,{[A.a.WLa]:this.O0,[A.a.Jca]:Kb,[A.a.Ica]:pb,[A.a.Txb]:this.P0}):this.$.xd(-694765314,
2,30,{[A.a.WLa]:this.O0,[A.a.Jca]:Kb,[A.a.Ica]:pb})}if(this.Pq||!this.tableRange)x.ULS.sendTraceTag(509150293,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.MK(this.Qj,this.Mh);this.SCd();return!0}oKd(Kb){const pb=this.ga.Yq(Kb.clientPoint,Kb.tc,5,void 0,void 0,!0);this.JX=Kb;return this.Qif(pb)?(this.hc=this.fKa(pb),this.khf(!0),!0):this.pni(pb)?(this.hc=this.Aub(pb),this.lhf(!0),!0):!1}SJ(Kb=!1){const pb=this.hc.toString();if(this.Pq)for(var nc=1;4>=nc;nc++)if(this.g8d){const Wb=
this.Xm[nc.toString()];Wb&&Wb.childNodes&&0<Wb.childNodes.length&&(Wb.childNodes[0].innerText=pb,Wb.childNodes[1].innerText=this.Gwa,Kb&&(Wb.childNodes[2].innerText=this.GDa))}else this.Xm[nc.toString()].childNodes[0].innerText=pb,this.Xm[nc.toString()].childNodes[1].innerText=this.Gwa,Kb&&(this.Xm[nc.toString()].childNodes[2].innerText=this.GDa);else for(Kb=1;4>=Kb;Kb++)if(this.g8d){if(nc=this.Xm[Kb.toString()])nc.innerText=pb}else this.Xm[Kb.toString()].innerText=pb}Qif(Kb){return!!this.Bga&&1!==
this.$K&&!!Kb&&this.Bga.contains(Kb.topLeft)}pni(Kb){return!!this.Bga&&1===this.$K&&!!Kb&&!this.Bga.contains(Kb.topLeft)}khf(Kb){this.tableRange=this.Bga;this.$K=1;const pb=!this.P0;Kb?(x.ULS.shipAssertTag(509159393,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150289,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!1),this.Qh=this.zS?[11]:[12],this.SNb(pb),x.ULS.shipAssertTag(509159392,0,!!this.Qh,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zra(pb)):(x.ULS.shipAssertTag(509159391,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150288,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Zub(!1),this.wpa(pb),x.ULS.shipAssertTag(509159390,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.PT(pb))}lhf(Kb){this.tableRange=null;this.$K=
2;const pb=!this.P0;Kb?(x.ULS.shipAssertTag(509159389,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150287,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.pV(!1),this.Qh=this.zS?[11]:[12],this.AS=this.zS,this.SQd(pb),x.ULS.shipAssertTag(509159388,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zra(pb)):(x.ULS.shipAssertTag(509159387,0,!!this.Qh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
x.ULS.sendTraceTag(509150286,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.$ub(!1),this.wpa(pb),x.ULS.shipAssertTag(509159386,0,!!this.Wl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.PT(pb))}Rhb(){if(!fb.h(this.$).ga.pa.Lh)return!1;const Kb=fb.h(this.$).getRangeInformation(this.ga.pa.Hd);for(const pb of Kb)if(Object(Za.a)(Ba.PivotTableRange,pb))return!1;return!0}V$g(Kb){if(Kb&&Kb.contains(this.sourceRange)&&!Kb.equals(this.sourceRange)){if(Kb.Jma&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===Kb.top){const pb=new V.Range(this.sourceRange.top,this.sourceRange.left,Kb.bottom,this.sourceRange.right,!1,!1);if(!pb.equals(Kb))return this.sourceRange=pb,this.ga.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),Kb}this.Pq?this.zS=Kb.left===this.sourceRange.left&&Kb.right===this.sourceRange.right:this.isRow=Kb.left===this.sourceRange.left&&Kb.right===this.sourceRange.right;if(Kb.top===this.sourceRange.top&&Kb.bottom===
this.sourceRange.bottom||this.cea())return Kb}return null}fKa(Kb){const pb=Kb.clone();this.cea()?pb.left=Math.max(Kb.left-this.Asd,1):pb.top=Math.max(Kb.top-this.y8d,1);pb.right=pb.left+this.sourceRange.width-1;pb.bottom=pb.top+this.sourceRange.height-1;return this.vsb(pb)}Csf(){const Kb=this.hc.topLeft.Nd(this.sourceRange);return Kb||this.Pq&&!this.tableRange?Kb:this.cea()?this.hc.top===this.sourceRange.bottom+1:this.hc.left===this.sourceRange.right+1}trj(){if(this.cea()&&this.hc.left!==this.tableRange.left||
!this.cea()&&this.hc.top!==this.tableRange.top){const Kb=Wa.a.Od(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Na.a(this.$).Wu([Kb]);return!0}return!1}Fmj(){const Kb=this.$.nc.qd("UserAction","RearrangeRowColumnClientSide"),pb={["CopyPasteTargetType"]:1,["OperationId"]:Da.a.create().toString(),["Stopwatch"]:Kb,["DragDropIsShiftKeyDown"]:this.P0,["EncounteredDeploymentErrors"]:!1},nc=this.O0?2:1,Wb=this.$.da.Ba(254);(new Promise((Ha,$a)=>{this.g2e(Nb=>{Nb.Errors&&0<Nb.Errors.length?$a(new ia.a(22,
Nb.Errors)):Ha(!0)},Nb=>{Nb=sa.a.lf(Nb.data);$a(new ia.a(22,Nb))})})).then(()=>{x.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Wb&&Wb.cRi(pb,nc,this.sourceRange,this.hc);return Promise.resolve(!0)},Ha=>{x.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Ha?copyPasteInfra.getStringifiedError(Ha):"null"}, copyPasteTargetType="${1}"`);return Wb?Wb.T$i(Ha,pb,nc,this.sourceRange,
this.hc):Promise.reject(Ha)})}g2e(Kb=null,pb=null){const nc={};this.cea()?(nc.FirstRow=this.hc.top-1,nc.FirstColumn=0,nc.DeltaColumn=0,nc.DeltaRow=this.hc.bottom-this.hc.top+1):(nc.FirstRow=0,nc.FirstColumn=this.hc.left-1,nc.DeltaColumn=this.hc.right-this.hc.left+1,nc.DeltaRow=0);nc.LastRow=W.a.yz;nc.LastColumn=W.a.Wx;nc.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.Zb.getItemByName(this.$.Zb.na.name).sheetName;const Wb=X.v(this.sourceRange,this.$);this.$.userOperationManager.kd(new la.a(514,0,
(Ha,$a,Nb)=>ha(this.$.qa.va,Wb,nc,Kb?Va.b(Ha,Kb):Ha,pb?Va.a($a,pb):$a,Nb,null),64,()=>new Fb(Wb,nc)),null)}KIc(Kb=0){0===Kb?this.O0=!1:1===Kb&&(this.P0=!1);this.Pq&&(this.O0||this.P0)||(oa.KeyInputManager.instance.Aa(r.a.te,this.domElement.ownerDocument.body,this.onKeyUp),this.QPa=!1)}wpa(Kb=!1){this.Kn=5;x.ULS.sendTraceTag(509150277,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.oP(this.Qj,this.Mh);this.Gwa=this.vVe;this.GDa=this.cgg;this.U9(this.JX.clientPoint,
this.JX.tc,this.JAb(),!1,Kb)}SQd(Kb=!1){this.Kn=6;x.ULS.sendTraceTag(509150276,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.oP(this.hLb,this.iLb);this.Gwa=this.Fcc;this.GDa=this.nEc;this.U9(this.JX.clientPoint,this.JX.tc,this.isRow||this.zS?11:12,!0,Kb)}SNb(Kb=!1){this.Kn=6;x.ULS.sendTraceTag(509150275,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.oP(this.Qoa,this.Roa);this.Gwa=this.Fcc;this.GDa=this.nEc;this.U9(this.JX.clientPoint,
this.JX.tc,this.cea()?11:12,!0,Kb)}cea(){return!this.Pq&&this.isRow||this.Pq&&this.zS}Zub(Kb){this.dc.Hk(this.Qh);this.MK(this.hLb,this.iLb,void 0,Kb)}SCd(){const Kb=bb.a.instance.qc("Common.ISystemInitiatedFeedback");Kb&&Kb.execute(pb=>{pb.logActivity("DragDrop",null)})}}Object(b.a)(mb,"DragSelectionClickBehaviorCellRangeAndTable",ta,[]);var sb=a(328),Ya=a(151);class Ma extends ta{constructor(Kb,pb,nc,Wb,Ha){super(Kb,pb,nc,Wb,Ha);this.jdb=()=>{this.zA&&(x.ULS.shipAssertTag(509159371,0,!!this.Qh,
"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),x.ULS.sendTraceTag(509150340,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.$ub(!0));5===this.Kn&&(x.ULS.shipAssertTag(509159370,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150339,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.pV(!0))};this.Roa=$a=>{aa.a(this.$).Se($a);this.zA=!1;x.ULS.shipAssertTag(509159369,
0,!!this.Qh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.dc.Hk(this.Qh);this.ga.sourceRange=this.sourceRange.clone();this.yuf?this.$.xd(927125067,S.a.Vb,30,null):this.qza?(this.uY(),this.ga.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[A.a.WLa]:!0,[A.a.Jca]:this.ga.sourceRange,[A.a.Ica]:this.ga.pa.Hd,[A.a.Txb]:!1}),x.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),fb.h(this.$).Ch.rq(A.a.zW),
this.qza=!1):this.wmj();x.ULS.sendTraceTag(509150338,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.MK(this.Qoa,this.Roa);this.Kn=-1;return!0};this.Qoa=$a=>{$a=aa.a(this.$).Se($a);const Nb=$a.clientPoint;this.JX=$a;let rb=this.ga.Yq(Nb,$a.tc,5,void 0,void 0,!0);if(rb){if(!this.yyd(rb))return this.pki($a),!0;this.Ktg(rb,this.isRow,Nb);if(this.isRow||this.gh)this.hc=this.fKa(rb);this.ga.sourceRange=this.hc;this.dc.il(this.hc,this.Qh);x.ULS.shipAssertTag(509159368,
0,!!this.Qh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.dc.Ur(this.Qh);x.ULS.shipAssertTag(509159367,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null");this.dc.Hk(this.Wl());this.SJ()}return!0};this.onKeyDown=$a=>this.N9a($a)?(this.QPa||(oa.KeyInputManager.instance.ta(r.a.te,this.domElement.ownerDocument.body,this.onKeyUp),this.QPa=!0),this.qza||(fb.h(this.$).Ch.rq(Ua.Z$c),this.qza=!0),!0):!1;this.onKeyUp=$a=>{this.N9a($a)&&(oa.KeyInputManager.instance.Aa(r.a.te,
this.domElement.ownerDocument.body,this.onKeyUp),this.QPa=!1,this.zA?fb.h(this.$).Ch.rq(Ua.Wxb):fb.h(this.$).Ch.rq(A.a.zW),this.qza=!1);return!0};this.uOf=$a=>{$a.Errors&&0<$a.Errors.length?(x.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${Wa.a.Ic($a.Errors)}]`),this.hc.left=this.sourceRange.left,this.hc.right=this.sourceRange.right,this.hc.top=this.sourceRange.top,this.hc.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=
this.hc.top&&this.sourceRange.bottom>=this.hc.top-1?(this.hc.top=this.sourceRange.top,this.hc.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.hc.top||(this.hc.top-=this.sourceRange.height),this.hc.bottom=this.hc.top+this.sourceRange.height-1):this.sourceRange.left<=this.hc.left&&this.sourceRange.right>=this.hc.left-1?(this.hc.left=this.sourceRange.left,this.hc.right=this.sourceRange.right):(this.sourceRange.left>this.hc.left||(this.hc.left-=this.sourceRange.width),this.hc.right=this.hc.left+
this.sourceRange.width-1);this.uY();this.Kn=-1};this.tOf=$a=>{$a=sa.a.lf($a.data);x.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${Wa.a.Ic($a)}]`)};this.ga.N2c(this.jdb);this.qza=this.QPa=!1}dispose(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ga&&this.ga.jAc(this.jdb);super.dispose()}nKd(Kb){this.JX=Kb;this.isRow=this.gh=!1;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7642616_DraggingEntireColumnsBug")&&
(this.q_=null!=this.hc?this.hc.isRow?1:this.hc.gh?2:0:0);this.zA=!0;oa.KeyInputManager.instance.ta(r.a.yc,this.domElement.ownerDocument.body,this.onKeyDown);this.pc=this.tableManager.oma(this.sourceRange);this.kpf=this.RFi(this.hc);this.pc||x.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.yuf=(new Ya.a(this.$.ua)).$h;fb.h(this.$);fb.h(this.$).Ch.rq(Ua.Wxb);this.yyd(this.hc)?(this.isRow=this.JGi(),
this.gh=this.Qzi(),this.isRow||this.gh?(this.E$a=!1,this.SNb(Kb),this.hc=this.fKa(this.hc),x.ULS.shipAssertTag(509159377,0,!!this.Qh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),this.zra()):(this.E$a=!0,this.wpa(Kb),x.ULS.shipAssertTag(509159376,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.PT())):(this.E$a=!0,this.wpa(Kb),x.ULS.shipAssertTag(509159375,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
this.PT())}jSa(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7657099_CleaningUpIsDragging")&&(this.zA=!1);return this.yuf?(this.$.xd(927125067,S.a.Vb,30,null),x.ULS.shipAssertTag(509159374,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150343,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.pV(!0),this.E$a=!1,this.Kn=-1,!0):this.qza||pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MovePivotTables",
!1)&&pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&this.kpf?(this.uY(),this.ga.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[A.a.WLa]:this.qza,[A.a.Jca]:this.ga.sourceRange,[A.a.Ica]:this.ga.pa.Hd,[A.a.Txb]:!1}),x.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.qza}"`),fb.h(this.$).Ch.rq(A.a.zW),x.ULS.shipAssertTag(509159373,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
x.ULS.sendTraceTag(509150342,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.pV(!0),this.E$a=!1,this.Kn=-1,this.kpf=!1,!0):5===this.Kn?(x.ULS.shipAssertTag(509159372,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150341,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.pV(!0),this.E$a=!1,this.qXj(),this.Kn=-1,!0):!1}oKd(Kb){const pb=this.ga.Yq(Kb.clientPoint,Kb.tc,5,void 0,
void 0,!0);this.JX=Kb;return this.E$a?!1:this.yyd(pb)?(this.qki(Kb),!0):!1}SJ(){let Kb=new V.Range(this.hc.top,this.hc.left,this.hc.bottom,this.hc.right,!1,!0);6===this.Kn&&(this.isRow?(--Kb.top,Kb.bottom=Kb.top+this.hc.height-1):(--Kb.left,Kb.right=Kb.left+this.hc.width-1));for(let pb=1;4>=pb;pb++)if(this.g8d){const nc=this.Xm[pb.toString()];nc&&nc.childNodes&&0<nc.childNodes.length&&(nc.childNodes[0].innerText=Kb.toString())}else this.Xm[pb.toString()].childNodes[0].innerText=Kb.toString()}Rhb(){if(!fb.h(this.$).ga.pa.Lh)return!1;
var Kb=fb.h(this.$).getRangeInformation(this.ga.pa.Hd);for(var pb of Kb)if(Object(Za.a)(Ba.PivotTableRange,pb)&&(Kb=this.tableManager.oma(pb)))return pb=!Kb.isOlap||!Kb.yQa(!0),x.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",Kb),Kb.isActionable&&pb;return!1}fKa(Kb){Kb=Kb.clone();this.isRow?(Kb.left=this.sourceRange.left,Kb.right=this.pc.right,Kb.bottom=Kb.top+this.sourceRange.height-1):this.gh?(Kb.top=this.sourceRange.top,
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")&&!this.pc.Nt?Kb.bottom=this.pc.bottom:Kb.bottom=this.pc.Nt.bottom,Kb.right=Kb.left+this.sourceRange.width-1):x.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.vsb(Kb)}wmj(){const Kb={},pb=X.v(this.sourceRange,this.$);fb.h(this.$).getRangeInformation(this.hc);if(this.isRow){pb.FirstColumn=Kb.FirstColumn=this.hc.left-1;pb.LastColumn=Kb.LastColumn=
this.hc.right-1;if(this.sourceRange.top<=this.hc.top&&this.sourceRange.bottom>=this.hc.top-1){x.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.hc.top?Kb.LastRow=Kb.FirstRow=this.hc.top-1:(Kb.FirstRow=this.hc.top-this.sourceRange.height-1,Kb.LastRow=Kb.FirstRow+this.sourceRange.height-1)}else{pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?Kb.FirstRow=Math.min(this.hc.top,this.hc.bottom-
1):Kb.FirstRow=this.hc.top;Kb.LastRow=this.hc.bottom-1;if(this.sourceRange.left<=this.hc.left&&this.sourceRange.right>=this.hc.left-1){x.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}Kb.LastColumn=this.sourceRange.left>this.hc.left?Kb.FirstColumn=this.hc.left-1:Kb.FirstColumn=this.hc.left-this.sourceRange.width-1}const nc={};nc.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.Zb.getItemByName(this.$.Zb.na.name).sheetName;nc.Ranges=Array(2);
nc.Ranges[0]=pb;nc.Ranges[1]=Kb;this.wPh(nc)}wPh(Kb){this.$.userOperationManager.kd(new la.a(265,0,(pb,nc,Wb)=>jb(this.$.qa.va,Kb,this.uOf?Va.b(pb,this.uOf):pb,this.tOf?Va.a(nc,this.tOf):nc,Wb,null),64),null)}yyd(Kb){return null!==this.pc&&this.KDi(Kb)&&this.CGi(Kb)&&this.UIi(Kb)&&this.Vyi(Kb)}KDi(Kb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.pc.Nt?Kb.left>=this.pc.Nt.left:this.pc.ww?Kb.left>=this.pc.ww.left:Kb.left>=this.pc.left:null===this.pc.Nt||Kb.left>=
this.pc.Nt.left}CGi(Kb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.pc.ww?Kb.right<=this.pc.ww.right:this.pc.Nt?Kb.right<=this.pc.Nt.right:Kb.right<=this.pc.right:null===this.pc.ww||Kb.right<=this.pc.ww.right}UIi(Kb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7666231_CannotSortColumnsInPivotTable")?this.isRow?null!==this.pc.Nt&&Kb.top>=this.pc.Nt.top:this.gh?null!==this.pc.ww&&Kb.top>=this.pc.ww.top:null===this.pc.top||Kb.top>=this.pc.top:null===
this.pc.Nt||Kb.top>=this.pc.Nt.top}Vyi(Kb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.pc.Nt?Kb.bottom<=this.pc.Nt.bottom:this.pc.ww?Kb.bottom<=this.pc.ww.bottom:Kb.bottom<=this.pc.bottom:null===this.pc.Nt||Kb.bottom<=this.pc.Nt.bottom}RFi(Kb){return null!==this.pc&&this.pc.left>=Kb.left&&this.pc.right<=Kb.right&&this.pc.top>=Kb.top&&this.pc.bottom<=Kb.bottom}JGi(){return null!==this.pc&&null!==this.pc.Nt&&this.pc.Nt.top<=this.hc.top&&this.pc.Nt.left<=this.hc.left&&
this.pc.Nt.right>=this.hc.left}Qzi(){return null!==this.pc&&null!==this.pc.ww&&this.pc.ww.top===this.hc.top&&this.pc.ww.left<=this.hc.left&&this.pc.ww.right>=this.hc.right}SNb(Kb){this.Kn=6;this.Qh=this.isRow?[11]:[12];x.ULS.sendTraceTag(509150337,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.oP(this.Qoa,this.Roa);this.U9(Kb.clientPoint,Kb.tc,this.isRow?11:12,!0,!1)}wpa(Kb){this.Kn=5;x.ULS.sendTraceTag(509150336,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");
this.oP(this.Qj,this.Mh);this.U9(Kb.clientPoint,Kb.tc,this.JAb(),!1,!1)}qki(Kb){x.ULS.shipAssertTag(509159366,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange.handleDragWithinPivotTable: getDragHighlight is null");x.ULS.sendTraceTag(509150307,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.pV(!1);this.SNb(Kb);this.hc=this.fKa(this.hc);x.ULS.shipAssertTag(509159365,0,!!this.Qh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.zra()}pki(Kb){x.ULS.shipAssertTag(509159364,
0,!!this.Qh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");x.ULS.sendTraceTag(509150306,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.$ub(!1);this.wpa(Kb);x.ULS.shipAssertTag(509159363,0,!!this.Wl(),"DragSelectionClickBehaviorPivotTableRange.handleDragOutsidePivotTable: getDragHighlight is null");this.PT()}qXj(){if(!(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7563140_ClickingEdgeOfCellFix")&&null!=this.sourceRange&&null!=this.hc&&this.sourceRange.nz(!1)===
this.hc.nz(!1)||this.YDb(this.hc))){var Kb=Wa.a.Od(1,0,904,903,0,2069074184,"PivotTableInvalidMove");Kb.HelpTopicId=sb.a.d0j;Kb.HelpDescription=Rb.a.instance.ha(913);Na.a(this.$).Wu([Kb])}}}Object(b.a)(Ma,"DragSelectionClickBehaviorPivotTableRange",ta,[]);var xb=a(383);class qb extends ja{constructor(Kb,pb){super(Kb);this.Xe=()=>{this.domElement.classList.remove(za.selecting);xb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Ls=()=>{this.domElement.classList.add(za.selecting)};
this.onPointerDown=nc=>{2===nc.Wb&&nc.Ro===Sys.UI.MouseButton.leftButton&&(this.gridView.ga.selectionType=4,this.gridView.ga.sourceRange=this.gridView.ga.pa.Hd,xb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Wea=()=>{this.gridView.$.xd(1983983164,2,30,null);return!0};this.Td=()=>{z.DOMElementExtensions.setVisible(this.Yca,this.gridView.$.isEditMode)};this.P8=()=>{z.DOMElementExtensions.setVisible(this.Yca,!1)};this.O8=()=>{z.DOMElementExtensions.setVisible(this.Yca,
!0)};this.FMf=()=>{z.DOMElementExtensions.setVisible(this.Yca,!1)};this.EMf=()=>{z.DOMElementExtensions.setVisible(this.Yca,!0)};this.zKb=(nc,Wb)=>{z.DOMElementExtensions.setVisible(this.Yca,!Wb.Vue)};this.gridView=pb;pb=document.createElement("div");pb.className=Ga.a.TNh;this.Yca=pb;this.Td(null,null);Kb.appendChild(pb);w.a.instance.ta(r.a.pointerDown,this.Yca,this.onPointerDown);R.a.instance.ta(r.a.dl,this.Yca,this.Wea);pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionFillHandleListener",
!1)||(this.gridView.ga.eba(this.Ls),this.gridView.ga.I4(this.Xe));this.gridView.$.Ql(this.Td);this.gridView.$.Ob.V4b(this.P8);this.gridView.$.Ob.U4b(this.O8);this.gridView.Bxe(this.zKb);this.gridView.cellTextEditBox.ao(this.FMf);this.gridView.cellTextEditBox.Bm(this.EMf)}dispose(){w.a.instance.Aa(r.a.pointerDown,this.Yca,this.onPointerDown);R.a.instance.Aa(r.a.dl,this.Yca,this.Wea);this.gridView.$&&(pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionFillHandleListener",!1)||
(this.gridView.ga.Ufa(this.Ls),this.gridView.ga.c2(this.Xe)),this.gridView.$.Rm(this.Td),this.gridView.$.Ob.oAc(this.P8),this.gridView.$.Ob.nAc(this.O8),this.gridView.g4f(this.zKb),this.gridView.cellTextEditBox.Un(this.FMf),this.gridView.cellTextEditBox.Qm(this.EMf));super.dispose()}}Object(b.a)(qb,"FillHandleClickBehavior",ja,[]);class Ra extends B{constructor(Kb,pb){super(Kb);this.lbj=nc=>{const Wb=J.HelperMethods.qp(nc);var Ha=this.wya.E8d(nc.clientPoint);if(!Ha)return!1;var $a=Ha.Ie,Nb=this.wya.Ca.XAb($a.hashCode).Nxa(Ha.gK);
if(!Nb)return!1;nc=$a.Yj.domElement;Ha=J.HelperMethods.Dwe(J.HelperMethods.vBb($a.domElement,nc),Ha.gK);$a=0;Nb=this.wya.jc(Nb.getRange());for(let ec=0,pc=Ra.nIe.length;ec<pc;++ec){const vb=Ra.nIe[ec];if((128===vb||64===vb)&&this.wya.$.isEditMode)continue;var rb=Nb.MNa(vb);if(!rb||!rb.t9a||"none"===rb.t9a.style.display)continue;rb=rb.t9a;const ob=J.HelperMethods.vBb(rb,nc);rb=new Sys.UI.Bounds(ob.x,ob.y,rb.offsetWidth,rb.offsetHeight);if(M.a.sS(rb,Ha)){$a=vb;break}}return 0!==$a?(Nb.invoke($a,Wb),
!0):!1};this.DHg=pb;R.a.instance.ta(r.a.click,Kb,this.lbj)}get wya(){return this.DHg}}Ra.nIe=[1,2,32,256,128,64];Object(b.a)(Ra,"IPadSelectionClickThroughBehavior",B,[]);var Jb=a(23);class yb{constructor(Kb){this.Wkf=pb=>{this.mJc(pb.tc,1);return!0};this.Xkf=pb=>{this.mJc(pb.tc,-1);return!0};this.Xe=()=>{this.mxd=!1};this.Ls=()=>{this.mxd=!0};this.gridView=Kb;this.S8a=0;this.mxd=this.unc=!1;this.U7=Number.NaN;this.gridView.ga.eba(this.Ls);this.gridView.ga.I4(this.Xe);this.gridView.ga.N2c(this.Xe)}dispose(){this.gridView.ga.Ufa(this.Ls);
this.gridView.ga.c2(this.Xe);this.gridView.ga.jAc(this.Xe)}h2(){this.S8a=0;this.unc=!1;this.U7=Number.NaN}tVe(Kb){this.unc=!0;this.mJc(Kb,1)}uVe(Kb){this.unc=!1;this.mJc(Kb,-1)}mJc(Kb,pb){if(Kb)if(Kb.parentNode)if(this.mxd)isNaN(this.U7)||(this.EJc(this.U7,!1),this.U7=Number.NaN);else if(Kb=parseInt(Kb.parentNode.getAttribute(A.a.i9a),10),isNaN(Kb))x.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.U7)&&
Kb!==this.U7){if(this.unc)return;this.EJc(this.U7,!1)}if(isNaN(this.U7)||Kb!==this.U7)this.U7=Kb,this.S8a=0;!this.S8a&&0<pb&&this.EJc(Kb,!0);this.S8a=Math.max(this.S8a+pb,0);!this.S8a&&0>pb&&(this.EJc(Kb,!1),this.U7=Number.NaN)}else x.ULS.shipAssertTag(537159367,0,!!Kb.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else x.ULS.shipAssertTag(537159368,0,!!Kb,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}EJc(Kb,pb){var nc=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateHighlightOnRelevantPanes",
!1)&&pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7903302_avoidGettingIrrelevantHighlights")?this.gridView.Cb.RKc:[1,3,2,4];for(const Wb of nc)for(nc=this.gridView.dc.nE(3,Wb,Kb).Fg,z.DOMElementExtensions.toggleCssClass(nc,za.pNh,pb),nc=nc.firstChild;nc;nc=nc.nextSibling)Jb.a.contains(nc.className,"resizemarqueehandle",!0)&&z.DOMElementExtensions.toggleCssClass(nc,za.tNh,pb)}}Object(b.a)(yb,"MarqueeHoveringManager",null,[]);var Gb=a(179),ub=a(126),Ja=a(860),zb=a(1288);class na extends B{constructor(Kb,
pb){super(Kb);this.tvc=()=>{if(!this.Nw)return x.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Nw.zpj(this.Ada);this.Nw.gDh(this.Bda);if(3===this.Nw.model.state)return!0;this.Nw.Rsd(!0);return!0};this.efa=()=>{if(!this.Nw)return!1;this.Nw.IZf(!1);this.Nw.hUd(this.Bda,!1);if(3===this.Nw.model.state)return!0;this.Nw.Rsd(!1);return!0};this.onPointerDown=nc=>this.Nw?2===nc.Wb&&nc.Ro===Sys.UI.MouseButton.leftButton?!0:!1:!1;
this.YKb=()=>{if(!this.Nw)return!1;this.Nw.hUd(this.Bda,!0);this.Nw.Rsd(!1);this.Nw.OLa();return!0};this.onDoubleClick=nc=>{if(nc.Da)return nc.Da.stopPropagation(),!0;x.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Nw=Object(ub.a)(zb.a,pb.metadata);this.Bda=document.createElement("div");this.Bda.id=`${Kb.id}-${A.a.dIe}`;this.Bda.className=Ja.a.Cbh;this.Ada=document.createElement("div");this.Ada.id=`${Kb.id}-${A.a.A7c}`;
this.Ada.className=Ja.a.A7c;this.gS=document.createElement("div");this.gS.appendChild(this.Ada);this.gS.className=Ja.a.Bbh;this.Bda.appendChild(this.gS);Kb.appendChild(this.Bda);x.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");w.a.instance.ta(r.a.KX,this.gS,this.tvc);w.a.instance.ta(r.a.LC,this.gS,this.efa);w.a.instance.ta(r.a.pointerDown,this.gS,this.onPointerDown);Gb.a.instance.ta(r.a.click,
this.gS,this.YKb);Gb.a.instance.ta(r.a.dl,this.gS,this.onDoubleClick);z.DOMElementExtensions.setVisible(this.gS,pb.isVisible)}dispose(){w.a.instance.Aa(r.a.KX,this.gS,this.tvc);w.a.instance.Aa(r.a.LC,this.gS,this.efa);w.a.instance.Aa(r.a.pointerDown,this.gS,this.onPointerDown);Gb.a.instance.Aa(r.a.click,this.gS,this.YKb);Gb.a.instance.Aa(r.a.dl,this.gS,this.onDoubleClick);z.DOMElementExtensions.gg(this.Ada);this.Ada=null;z.DOMElementExtensions.gg(this.Bda);this.Nw=this.Bda=null;super.dispose()}D1a(Kb){this.Nw=
Object(ub.a)(zb.a,Kb.metadata);pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")||Kb.isVisible===Kb.nAa||(this.Nw.YQj(Kb.isVisible?1:0),z.DOMElementExtensions.setVisible(this.Bda,Kb.isVisible))}}Object(b.a)(na,"RangeCatchUpActivityHighlightBehavior",B,[]);class Ea extends fa{constructor(Kb,pb,nc,Wb){super(Kb,pb,nc,Wb)}get X6(){return 16}get Mgb(){return this.gridView.ga.rangePicker.cld(!1)}DVa(){return(this.gridView.inRangePicker||this.gridView.Wi)&&super.DVa()}}
Object(b.a)(Ea,"RangePickerTouchGrippiesBehavior",fa,[]);class ma extends B{constructor(Kb,pb){super(Kb);const nc=document.createElement("div"),Wb=document.createElement("div");nc.className=pb?za.aOh:za.cOh;Wb.className=pb?za.bOh:za.$Nh;Kb.appendChild(nc);Kb.appendChild(Wb)}}Object(b.a)(ma,"RearrangeHighlightBehavior",B,[]);var Ka;(function(Kb){Kb[Kb.topLeft=0]="topLeft";Kb[Kb.topRight=1]="topRight";Kb[Kb.bottomLeft=2]="bottomLeft";Kb[Kb.bottomRight=3]="bottomRight";Kb[Kb.error=4]="error"})(Ka||(Ka=
{}));Object(b.b)("Corner",Ka);class cb extends B{constructor(Kb,pb,nc,Wb,Ha){super(Kb);this.Xb=this.gH=null;this.E5=0;this.hc=this.sourceRange=null;this.nWa=!1;this.onPointerDown=$a=>{$a=aa.a(this.$).Se($a);if(this.Dgg($a)&&!this.nWa){this.IAf();this.Xb=this.jp.qgc();this.gH=this.jp.Zdf($a);if(!this.Xb||!this.gH||!this.gH.range)return x.ULS.shipAssertTag(537159361,0,!!this.Xb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),x.ULS.shipAssertTag(537159360,0,!!this.gH,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),
x.ULS.shipAssertTag(537159331,0,!!this.gH.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.hc=this.gH.range.clone();this.sourceRange=this.hc.clone();this.E5=this.y$e($a);if(4===this.E5)return x.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Nb=this.zbf($a,!0);if(!Nb)return x.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),
!1;if(!this.CPe(Nb))return x.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.YOa=!0;this.Xb.SF(!1);this.NG.tVe($a.tc);this.jp.VZf(!0,this.Cda.qV);this.Xb.textBox.removeSelection();this.Xb.z4b(this.Nhf);this.q2f();this.nWa=!0;ra.b(this.$,!0)}return!0};this.Qj=$a=>{$a=aa.a(this.$).Se($a);$a=this.zbf($a,!1);if(!$a)return!0;$a=this.CPe($a);if(!$a)return x.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),
this.lfc(!0),!1;if(this.hc.equals($a))return!0;this.hc=$a;$a=this.PT();$a||(x.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.lfc(!0));return $a};this.Mh=$a=>{aa.a(this.$).Se($a);$a=this.uY();x.ULS.shipAssertTag(537159325,0,$a,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.lfc(!$a);return $a};this.Nhf=()=>{this.lfc(!0)};this.gridView=pb;this.$=pb.$;this.nM=[];this.ga=this.gridView.ga;this.NG=nc;this.jp=Wb;this.Cda=
Ha;this.coloredReferencesManager=this.$.da.Ba(281);x.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.oO=G.a.yE(this.$))pb=this.$.da.Ba(464),x.ULS.shipAssertTag(510255176,0,!!pb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.hC=pb.hC;for(const $a of this.E7f())pb=this.jp.Cad(Kb,
$a,this.kze(),this.onPointerDown),this.nM.push(pb);for(const $a of this.nM)w.a.instance.ta(r.a.KX,$a,this.NG.Wkf),w.a.instance.ta(r.a.LC,$a,this.NG.Xkf);this.D1a(Ha)}dispose(){this.nM.forEach(Kb=>{w.a.instance.Aa(r.a.pointerDown,Kb,this.onPointerDown)});this.nM.length=0;super.dispose()}D1a(Kb){this.Cda=Kb;this.tze(Kb);this.jp.pRb(Kb,this.nM,this.x_d());this.NG.h2()}zbf(Kb,pb){const nc=Kb.tc;Kb=Kb.clientPoint;if(!nc||!Kb)return x.ULS.shipAssertTag(537159324,0,!!nc,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),
x.ULS.shipAssertTag(537159323,0,!!Kb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;pb&&(Kb=this.SEf(Kb));pb=this.ga.Yq(Kb,nc,0,!0,!1,!0);pb||(Kb=this.SEf(Kb),pb=this.ga.Yq(Kb,nc,0,!0,!1,!0));return pb}SEf(Kb){Kb.y+=0===this.E5||1===this.E5?2:-2;Kb.x+=0===this.E5||2===this.E5?2:-2;return Kb}CPe(Kb){if(!Kb||!this.sourceRange)return x.ULS.shipAssertTag(537159322,0,!!Kb,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),x.ULS.shipAssertTag(537159321,0,!!this.sourceRange,
"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.E5)return new V.Range(Kb.top,Kb.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.E5)return new V.Range(Kb.top,this.sourceRange.left,this.sourceRange.bottom,Kb.right,!0,!1);if(2===this.E5)return new V.Range(this.sourceRange.top,Kb.left,Kb.bottom,this.sourceRange.right,!0,!1);if(3===this.E5)return new V.Range(this.sourceRange.top,this.sourceRange.left,Kb.bottom,Kb.right,!0,!1);x.ULS.shipAssertTag(537159320,
0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Ka[this.E5]}`);return null}uY(){return this.oO?this.hC.iJb(this.Xb,this.gH,this.hc):this.coloredReferencesManager.iJb(this.Xb,this.gH,this.hc)}PT(){return this.uY()}lfc(Kb){Kb&&x.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.NG.uVe(this.nM[0]);this.jp.VZf(!1,this.Cda.qV);this.Xb.textBox.setCaretPositionToEnd();
this.Xb.Wzc(this.Nhf);this.Wrg();this.nWa=this.gridView.YOa=!1;ra.b(this.$,!1);this.jp.O0f()}}Object(b.a)(cb,"ResizeMarqueeBehaviorBase",B,[]);class Fa extends cb{constructor(Kb,pb,nc,Wb,Ha){super(Kb,pb,nc,Wb,Ha)}E7f(){return[za.gOh,za.hOh,za.eOh,za.fOh]}kze(){return[za.dOh]}y$e(Kb){Kb=Kb.tc;if(Kb===this.nM[0])return 0;if(Kb===this.nM[1])return 1;if(Kb===this.nM[2])return 2;if(Kb===this.nM[3])return 3;x.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}q2f(){this.jp.oP(this.Qj,this.Mh,!0)}Wrg(){this.jp.h6d(this.Qj,this.Mh,!0)}Dgg(Kb){return 2===(S.a.Vb=Kb.Wb)&&Kb.Ro===Sys.UI.MouseButton.leftButton}x_d(){return!0}IAf(){x.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}tze(Kb){for(const pb of this.nM)pb.style.backgroundColor=Kb.Fg.style.borderColor}}Object(b.a)(Fa,"ResizeMarqueeMouseBehavior",cb,[]);class wa extends cb{constructor(Kb,pb,nc,Wb,Ha){super(Kb,pb,nc,
Wb,Ha);this.RKb=()=>{const $a=3===S.a.Vb;this.iBd&&!$a?this.jp.pRb(this.Cda,this.nM,!1):!this.iBd&&$a&&this.jp.pRb(this.Cda,this.nM,!0);this.iBd=$a};this.paj=($a,Nb)=>{Nb.i9a===this.Cda.qV&&this.jp.pRb(this.Cda,this.nM,!Nb.start&&this.x_d())};S.a.jye(this.RKb);this.iBd=3===S.a.Vb;this.jp.HXg(this.paj)}dispose(){S.a.J4f(this.RKb);super.dispose()}E7f(){return[Ga.a.iNh,Ga.a.hNh]}kze(){const Kb=!pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[Kb?Ga.a.k1e:Ga.a.j1e,Ga.a.hec,
Kb?Ga.a.gNh:Ga.a.gec]}y$e(Kb){Kb=Kb.tc;if(Kb===this.nM[0])return 0;if(Kb===this.nM[1])return 3;x.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}q2f(){n.a.Px?this.jp.oP(this.Qj,this.Mh,!1):this.jp.Mtj(this.Qj,this.Mh)}Wrg(){n.a.Px?this.jp.h6d(this.Qj,this.Mh,!1):this.jp.Pbk(this.Qj,this.Mh)}Dgg(Kb){return 3===(S.a.Vb=Kb.Wb)}x_d(){return 3===S.a.Vb}IAf(){x.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}tze(){}}
Object(b.a)(wa,"ResizeMarqueeTouchBehavior",cb,[]);class ka extends B{constructor(Kb,pb){super(Kb);ka.mwb(Kb,D.a.yNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.horizontal);ka.mwb(Kb,D.a.xNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.vertical);ka.mwb(Kb,D.a.uNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.horizontal);ka.mwb(Kb,D.a.wNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.vertical);ka.mwb(Kb,Ga.a.vNh)}static mwb(Kb,pb,nc){const Wb=document.createElement("div");Wb.className=pb;nc&&(Wb.style.backgroundImage=
`url("${nc}")`);Kb.appendChild(Wb)}}Object(b.a)(ka,"SelectionCutCopyBehavior",B,[]);class Oa extends B{constructor(Kb){super(Kb);appChrome.renderSpinner(Kb)}}Object(b.a)(Oa,"SelectionPasteBehavior",B,[]);class hb extends B{constructor(Kb,pb){super(Kb);hb.Dwb(Kb,D.a.ZNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.horizontal);hb.Dwb(Kb,D.a.YNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.vertical);hb.Dwb(Kb,D.a.VNh+" "+Ga.a.dxa,null===pb||void 0===pb?void 0:pb.horizontal);hb.Dwb(Kb,D.a.XNh+" "+Ga.a.dxa,
null===pb||void 0===pb?void 0:pb.vertical);hb.Dwb(Kb,Ga.a.WNh)}static Dwb(Kb,pb,nc){const Wb=document.createElement("div");Wb.className=pb;nc&&(Wb.style.backgroundImage=`url("${nc}")`);Kb.appendChild(Wb)}}Object(b.a)(hb,"SelectionRangePickerBehavior",B,[]);class Pa extends fa{constructor(Kb,pb,nc,Wb){super(Kb,pb,nc,Wb)}get X6(){return 0}get Mgb(){return this.gridView.ga.pa.Hd}DVa(){const Kb=this.gridView.Wi||this.gridView.Eb;return this.gridView.ga.pa.Lh&&!Kb&&super.DVa()}}Object(b.a)(Pa,"SelectionTouchGrippiesBehavior",
fa,[]);var ca=a(54);class ba extends v.a{constructor(Kb,pb){super();this.j2a=(nc,Wb)=>{nc=Wb.X6;const Ha=this.gridView;Wb=Wb.Bpi;const $a=Wb.Fg,Nb=Wb.$Z;n.a.rh&&Nb.push(new Ra($a,Ha));switch(nc){case 24:Wb.$Z.push(new na($a,Wb));break;case 0:Wb.$Z.push(new qb($a,Ha));n.a.iq||(Nb.push(new mb($a,this.gridView.$,Wb.paneType,this.tableManager,this.jp)),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7824744_ManualDragDropInPivotTables")&&Nb.push(new Ma($a,this.gridView.$,Wb.paneType,this.tableManager,this.jp)));
Nb.push(new Pa(Wb,$a,Ha,Wb.paneType));break;case 3:Nb.push(new ja($a));n.a.iq||(Nb.push(new Ca($a,this.gridView.$,Wb.paneType,this.NG,this.jp,Wb)),Nb.push(new Fa($a,this.gridView,this.NG,this.jp,Wb)),Nb.push(new wa($a,this.gridView,this.NG,this.jp,Wb)));break;case 4:case 5:Nb.push(new ka($a,this.HAe));break;case 30:Nb.push(new Oa($a));break;case 16:Nb.push(new hb($a,this.HAe));Nb.push(new Ea(Wb,$a,Ha,Wb.paneType));break;case 11:case 12:Nb.push(new ma($a,11===nc));break;case 17:Nb.push(new ja($a));
break;case 19:Nb.push(new ja($a)),Nb.push(new ya(Wb,$a,Ha,Wb.paneType))}Wb.H6b=!0};this.$=Kb;this.gridView=fb.h(Kb);this.tableManager=pb;this.NG=new yb(this.gridView);this.jp=new F(this.gridView);this.gridView.dc&&(this.gridView.dc.aXg(this.j2a),this.gridView.dc.update(!1));Kb.da.Ja(64,this)}get HAe(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.GAe&&(this.GAe={vertical:ca.a.current.Lo(106),horizontal:ca.a.current.Lo(107)});return this.GAe}dispose(){this.gridView.dc.fyj(this.j2a);
this.NG&&(this.NG.dispose(),this.NG=null);super.dispose()}}Object(b.a)(ba,"GridHighlightsBehaviorManager",v.a,[]);var ib=a(36),Lb=a(149);class gc extends f.a{constructor(Kb){super();this.$=Kb;this.kc()}create(){const Kb=pb=>{this.Pb(this.$.da.Ba(64)||new ba(this.$,pb))};pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?void Lb.a.resolve(ib.ub,{Wa:this.La}).then(Kb):k.TaskExtensions.za(l.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.La),pb=>Kb(pb.result),
this.ka,3)}static la(Kb){Kb.da.Ja(149,new gc(Kb))}}Object(b.a)(gc,"GridHighlightsBehaviorManagerFactory",f.a,[]);a.d(C,"a",function(){return Gc});const Gc=()=>{c.a.Fa(gc.la);c.a.Fa(h.la)}},1201:function(u,C,a){u=a(0);var c=a(15),b=a(712),f=a(563),e=a(88),d=a(126),h;(function(Ua){Ua[Ua.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Ua[Ua.cloudPolicySettings=1]="cloudPolicySettings";Ua[Ua.alternateAuthToken=2]="alternateAuthToken"})(h||(h={}));Object(u.b)("ApplicationFeatureHelperRequestType",
h);class l{constructor(){this.message=null;this.Sya=0}}Object(u.a)(l,"HttpRequstToPromiseRejectData",null,[]);var k=a(103),n=a(82),v=a(249),x=a(586);class w{constructor(Ua,Ca){this.Ta=Ua;this.lh=Ca}swb(Ua,Ca,Ia,oa=null,Da=null,bb=null,Za=null,Xa=null){const Ba=h[Ia],Wa=Ba+"RequestFailure";k.Health.instance.recordKpiUsage(Wa,0,"jpittsdirects",null);return new Promise((Na,ta)=>{c.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
Ba);const V=null!=Za?Za:this.Ta.oe("ApplicationFeatureHelperRequestQueueTimeout",15E3),ia=null!=Xa?Xa:this.Ta.oe("ApplicationFeatureHelperRequestSentTimeout",3E4);this.lh.$aa(Ua,1,null,this.ond(Ia,oa),bb,!1,1,X=>{c.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Ba);try{if(void 0===X||null===X||void 0===X.data||null===X.data||void 0===X.data.Fe||null===X.data.Fe){k.Health.instance.recordKpiFailure(Wa,"Invalid RequestSucceededEventArgs",
!1,!0,null);let sa=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",Ba);ta(this.H6(sa,X))}else if(X.data.httpStatus!==v.a.hK){k.Health.instance.recordKpiFailure(Wa,"HttpStatusCode_"+X.data.httpStatus.toString(),!1,!0,null);let sa=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
X.data.httpStatus,Ba);ta(this.H6(sa,X))}else{void 0!==Da&&null!==Da&&void 0!==X.data.responseHeaders&&null!==X.data.responseHeaders&&Da(X.data.responseHeaders);var la=Ca(X.data.Fe);if(la)c.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Ba),Na(la);else{k.Health.instance.recordKpiFailure(Wa,"Parse Failure",!1,!0,null);let sa=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
Ba);ta(this.H6(sa,X))}}}catch(sa){k.Health.instance.recordKpiFailure(Wa,"Unexpected Failure",!1,!0,null),la=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",sa,Ba),ta(this.H6(la,X))}},X=>{if(X.data){k.Health.instance.recordKpiFailure(Wa,"HttpStatusCode_"+X.data.httpStatus.toString(),!1,!0,null);var la=x.a.Y7a(X.data.Fe||"No Data");la=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
X.data.httpStatus,la,Ba)}else k.Health.instance.recordKpiFailure(Wa,"Invalid RequestFailedEventArgs",!1,!0,null),la=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Ba);ta(this.H6(la,X))},null,void 0,void 0,V,ia)})}H6(Ua,Ca){const Ia=new l;Ia.message=Ua;Ia.Sya=Ca&&Ca.data?Ca.data.httpStatus:-1;return Ia}ond(Ua,Ca){const Ia={};Ia["x-UserDataSignature"]=this.Ta.Va("UserDataSignature");Ia["x-LicensingIsEnabled"]=this.Ta.ra("LicensingIsEnabled").toString();
Ia["x-CacheIsEnabled"]=this.Ta.ra("LicensingRedisIsEnabled").toString();Ia["x-OcpsIsEnabled"]=this.Ta.ra("OcpsIsEnabled").toString();Ia["x-LicensingAADIdIsEnabled"]=this.Ta.ra("LicensingAadIdIsEnabled").toString();0===Ua&&(Ia["x-LicenseCheckOnTenantEnabled"]="true",Ia["x-SupportUserConsentDependentFeatures"]="true",Ia["x-AFHUserConsentGroupValue"]="0",Ia["x-UseShellServiceForUserConsentGroup"]="true",Ia["x-SMBUserLicensingEnabled"]="true",Ia["x-AFHPIPLComplianceEnabled"]=n.a.mz(window.location.href,
"wd_afhpipl")||"false");if(Ca)for(let oa of Ca.keys)Ia[oa]=Ca.ma(oa);return Ia}}Object(u.a)(w,"HttpRequestToPromiseUtility",null,[]);var r=a(6),t;(function(Ua){Ua[Ua.loki=0]="loki";Ua[Ua.augloopACLP=1]="augloopACLP"})(t||(t={}));Object(u.b)("AlternateAuthSupportApp",t);var A=a(567),y=a(43);class z{constructor(){this.Token=null;this.ExpirationTime=0}}Object(u.a)(z,"WacAlternateAuthToken",null,[]);class E{constructor(Ua,Ca){this.L7j=3E5;if(void 0===Ua||null===Ua||void 0===Ca||null===Ca)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ta=Ua;this.AWb=new b.a(f.a.Ah());this.rnb=new w(Ua,Ca);void 0!==A.OAuthManagerSettings.LDd&&null!==A.OAuthManagerSettings.LDd&&void 0!==A.OAuthManagerSettings.wrc&&null!==A.OAuthManagerSettings.wrc&&0<A.OAuthManagerSettings.wrc&&(Ua=new z,Ua.Token=A.OAuthManagerSettings.LDd,Ua.ExpirationTime=A.OAuthManagerSettings.wrc,this.AWb.ia("loki",Ua))}r_h(){let Ua=null;this.AWb.Fb(t[0])&&(Ua=this.AWb.ma(t[0]));return void 0===Ua||null===Ua||this.Rzd(Ua)?this.bRh():Promise.resolve(Ua.Token)}Rzd(Ua){return Ua.ExpirationTime-
Date.now()<this.L7j}bRh(){const Ua=new b.a(f.a.Ah());Ua.ia("X-AlternateAuthApp",t[0]);return this.rnb.swb(this.Sxa("/afhs/AlternateAuthHelperHandler.ashx"),Object(e.a)(this,this.ugj,"parseAlternateAuthTokenResponse"),2,Ua).then(Ca=>{c.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",t[0]);this.AWb.ia(t[0],Ca);return Ca.Token},Ca=>{Ca=Object(d.a)(l,Ca);c.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
Ca.message,Ca.Sya);return null})}ugj(Ua){let Ca=null;({qt:Ca}=y.d(Ua));c.ULS.sendTraceTag(545821457,3004,Ca?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Ua);return Ca}Sxa(Ua){return String.format("{0}{1}?{2}",this.Ta.Va("WebServiceBase"),Ua,r.AFrameworkApplication.ej)}}Object(u.a)(E,"AlternateAuthHelper",null,[236]);var G=a(463);class F{constructor(Ua,Ca,Ia){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=Ua;this.isEnabled=Ca;this.tierName=
Ia}}Object(u.a)(F,"FeatureStateChangeArgs",null,[]);var O=a(147),M=a(264),P=a(31),B=a(115),D=a(185),I;(function(Ua){Ua[Ua.Enabled=0]="Enabled";Ua[Ua.Disabled=1]="Disabled"})(I||(I={}));Object(u.b)("FeatureState",I);var S=a(84),J=a(26),L=a(184);class R{constructor(Ua,Ca,Ia=null,oa=null,Da=null){this.ixa=this.b1b=this.lpe=this.nta=this.c2b=null;this.rnb=new w(Ua,Ca);this.Ta=Ua;this.aKg=Ua.oe("LicensingMaxRetryAttempts",0);this.JZb=Ua.ra("IsO365ConsumerHost");this.iTc=Ua.ra("IsO365CommercialHost");this.USc=
Ua.ra("PremiumUpsellIsEnabled");this.JZa=!1;this.qUc=0;this.sce=Ia;this.Ate=oa;this.Na=Da;this.mta=Ua.ra("LicensingIsEnabled");this.AHa=Ua.ra("OcpsIsEnabled")&&this.iTc;this.N_c=Ua.ra("ShowPrivacyDialog")&&!!oa;this.vSc=Ua.ra("IsAnonymousUser");this.Hec=new Promise(bb=>{bb(!1)});this.DEa=new Promise(bb=>{bb(!0)});this.hxa=new b.a(f.a.Ah());this.S2b=!0;this.yke=this.X8h();this.Rxd()&&!this.vSc?(void 0!==r.AFrameworkApplication.sa&&null!==r.AFrameworkApplication.sa&&(this.c2b=r.AFrameworkApplication.sa.hF,
void 0!==this.c2b&&null!==this.c2b&&(this.nta=this.c2b.hh("WebServiceCall","ApplicationFeatureHelperService"))),this.ixa=this.E5d()):this.ixa=new Promise(bb=>{bb({})});this.ixa.catch(bb=>{bb=Object(d.a)(l,bb);c.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",bb?bb.Sya.toString():"Unknown")});this.S2b&&this.isFeatureEnabled("FreemiumUpsell",!0).then(bb=>{this.JZa=bb;return null})}X8h(){const Ua=this.Ta.Dq("AllLicensedFeatures")?this.Ta.Kw("AllLicensedFeatures"):
[],Ca=new G.a;for(let Ia=0;Ia<Ua.length;Ia++)Ca.add(Ua[Ia]);return Ca}Rxd(){return this.iTc||this.JZb}E5d(Ua=0,Ca=!1){c.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ca);const Ia=O.a.ot();Ia&&(Ia.set("retryAttempt",Ua.toString()),Ia.set("forceRefresh",Ca.toString()),Ia.set("isO365ConsumerHost",this.JZb.toString()),Ia.set("isO365CommercialHost",this.iTc.toString()),Ia.set("isFreemiumUpsellSettingEnabled",this.USc.toString()));k.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",Ia);k.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",Ia);void 0!==this.nta&&null!==this.nta&&this.nta.start();let oa=null;Ca&&(oa=new b.a(f.a.Ah()),oa.ia("x-LicensingForceRefresh","true"));this.lpe=new Date;return(this.mta?this.rnb.swb(this.Sxa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(e.a)(this,this.xgj,"parseApplicationFeatureHelperResponse"),0,oa,Object(e.a)(this,this.fmj,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Da=>
{const bb=Object.assign(new L.a,{durationMs:this.nlg()});bb.extendedProperties=Ia;bb.extendedProperties&&Da&&(bb.extendedProperties.set("featureCount",B.a.count(Da).toString()),bb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Da).toString()),bb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Da).toString()),"FreemiumUpsell"in Da&&bb.extendedProperties.set("isFreemiumUpsellEnabled",Da.FreemiumUpsell.toString()),this.b1b&&bb.extendedProperties.set("fromCache",
(this.b1b<this.lpe).toString()));k.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",bb);return Da},Da=>{const bb=Object.assign(new L.a,{durationMs:this.nlg()}),Za=Object(d.a)(l,Da);if(!Za)return c.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),k.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,bb),new Promise((Xa,Ba)=>{Ba(Da)});bb.extendedProperties=
Ia;bb.extendedProperties&&bb.extendedProperties.set("status",Za.Sya.toString());k.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,bb);return 408===Za.Sya&&++Ua<=this.aKg?this.E5d(Ua):new Promise((Xa,Ba)=>{Ba(Za)})})}xgj(Ua){(Ua=y.b(Ua))?(c.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),c.ULS.sendTraceTag(50938594,3004,50,"{0}",Ua)):c.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return Ua.Features}Sxa(Ua){var Ca=String.format("{0}{1}",this.Ta.Va("WebServiceBase"),Ua);this.Ta.Dq("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ta.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Ua=R.Shc(this.Ta))&&0<Ua.length&&(this.S2b&&(Ua+="ucbf"),Ca=new M.QueryStringBuilder(Ca),Ca.Kj("afhskey",Ua),Ca=Ca.toString());return Ca}isFeatureEnabled(Ua,Ca){if(!this.AHa&&!this.N_c&&!this.mta)return this.DEa;c.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
Ua);if("ConnectedServices"===Ua){var Ia=this.AHa?this.sce.UN("ControllerConnectedServicesEnabled"):this.DEa;const bb=this.N_c?this.Ate.getSettings().then(Za=>2!==Za.uv,()=>Ca):this.DEa;return Ia.then(Za=>Za?bb:this.Hec)}if("FreemiumUpsell"===Ua&&(!this.USc||!this.JZb||this.vSc))return this.Hec;Ia=null;Ia=this.AHa?this.sce.isFeatureEnabled(Ua):this.DEa;let oa=null;oa=this.mta?this.xBi(Ua,Ca):this.DEa;let Da=null;Da=this.N_c?this.Ate.isFeatureEnabled(Ua):this.DEa;return Ia.then(bb=>bb?Da.then(Za=>Za?
oa:this.Hec):this.Hec).then(bb=>{this.Vzf(Ua,bb,!0);return bb},()=>{this.Vzf(Ua,Ca,!1);return Ca})}Vzf(Ua,Ca,Ia){c.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Ua,Ca,Ia)}getFeatureTier(Ua,Ca){if(!this.mta)return new Promise(Ia=>{Ia(2)});c.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",Ua);return this.ixa.then(Ia=>this.Pic(Ua,Ia,Ca),()=>Ca)}isFreemiumUpsellEnabled(){if(this.USc&&this.JZb&&!this.vSc){if(this.JZa&&
2!==this.qUc||!this.JZa&&1!==this.qUc)c.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.JZa.toString()),this.qUc=this.JZa?2:1;return this.JZa}return!1}launchUpsellExperience(Ua,Ca=null){c.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Ua));var Ia=O.a.ot();Ia&&(Ia.set("experienceId",Ua),Ca&&Ia.set("campaignId",Ca));k.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Ia);if(Ia=S.a.instance.ah("Common.IInProductMessagingUIManager")){const oa=Object(e.a)(this,this.lki,"handleDimeTaskComplete");Ia.Uxf(Ua,oa,Ca)}else c.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Na.Be(J.a.Yfc,2,{["experience"]:Ua})}JTa(Ua,Ca){if(!this.mta)return null;if(!Ua||!Ca)return c.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const Ia=D.a.create().toString();this.hxa.Fb(Ua)||this.hxa.ia(Ua,new b.a(f.a.Ah()));this.hxa.ma(Ua).add(Ia,Ca);c.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ia,Ua));return Ia}xRd(Ua,Ca){this.mta&&(Ua&&this.hxa.Fb(Ua)?Ca&&D.a.isValid(Ca)?this.hxa.ma(Ua).Fb(Ca)?(c.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
Ca,Ua)),this.hxa.ma(Ua).remove(Ca)):c.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ca,Ua)):c.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ca,Ua)):c.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
Ua)))}Pic(Ua,Ca,Ia){return this.S2b?Ua in Ca?Ca[Ua].LicenseTier:Ia:Ua in Ca?this.Vgj(Ca[Ua],Ia):Ia}Vgj(Ua,Ca){switch(Ua.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ca}}lki(){c.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.ixa.then(Ua=>{this.H1f(Ua)}).catch(()=>{this.H1f({})})}H1f(Ua){c.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const Ca=
this.E5d(0,!0);Ca.then(Ia=>{this.ixa=Ca;B.a.count(Ia)>B.a.count(Ua)?k.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let oa of this.hxa.keys)if(oa in Ia){const Da=this.Pic(oa,Ia,0);oa in Ua?this.Pic(oa,Ua,0)!==Da&&this.CHd(oa,!0,Da):this.CHd(oa,!0,Da)}else oa in Ua&&this.CHd(oa,!1,this.Pic(oa,Ua,0))}).catch(Ia=>{k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",
!1,!0,null);c.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ia))})}CHd(Ua,Ca,Ia){c.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",Ua,Ca,Ia);Ca=new F(Ua,Ca,Ia);Ia=this.hxa.ma(Ua);for(let oa of Ia)try{oa.value(Ca)}catch(Da){c.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
Ua,oa.key,Da.message))}}xe(Ua,Ca){if(this.mta){const Ia=this.yke.contains(Ua);let oa=!0,Da="",bb=!1;return this.ixa.then(Za=>{Ua in Za?(Za=Za[Ua],Da=I[Za.FeatureState],oa=1!==Za.FeatureState):oa=!Ia;this.eAf(Ua,Ia,Da,bb,Ca,oa);return oa},()=>{bb=!0;Ia&&(oa=Ca);this.eAf(Ua,Ia,Da,bb,Ca,oa);return oa})}return this.DEa}eAf(Ua,Ca,Ia,oa,Da,bb){c.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",
Ua,Ca,oa,Ia,Da,bb)}xBi(Ua,Ca){if(this.S2b)return this.xe(Ua,Ca);if(this.mta){if(this.yke.contains(Ua))return this.ixa.then(Ia=>Ua in Ia,()=>Ca);c.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Ua)}return this.DEa}fmj(Ua){try{Ua&&"Date"in Ua&&(this.b1b=new Date(Ua.Date),c.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.b1b.toString()))}catch(Ca){c.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Ca)}}nlg(){if(void 0!==this.nta&&null!==this.nta){const Ua=this.nta.fd;this.nta.stop();return Ua}return null}static Shc(Ua){try{if(P.a.Q3j){const Ca=Ua.Va("UserDataSignature").split(".");if(1<Ca.length){const Ia=window.self.atob(Ca[1]),oa=JSON.parse(Ia).LocalStorageKey;if(void 0!==oa&&null!==oa&&0<oa.length)return oa}}}catch(Ca){c.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",Ca.toString())}return null}}
Object(u.a)(R,"ApplicationFeatureHelper",null,[237]);var Y=a(199);class Q{constructor(Ua,Ca){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=Ua.PolicySettings;Ua=new Date;Ua.setMinutes(Ua.getMinutes()+Ca);this.ExpirationTime=Ua.getTime()}}Object(u.a)(Q,"CloudPolicySettingsCacheData",null,[]);var W=a(820),Ga=a(467),pa=a(267);class aa{static sjg(){return r.AFrameworkApplication.fa.ra("SideCarIsEnabled")?aa.hCc&&aa.owd?new Promise(Ua=>{Ua(!0)}):new Promise((Ua,Ca)=>{aa.hCc=pa.a.create(r.AFrameworkApplication.fa.Va("SideCarUrl"));
Ga.a.Uwa(aa.hCc);aa.hCc.fja((Ia,oa)=>{(aa.owd=oa.succeeded)?Ua(oa.succeeded):Ca(oa.succeeded)})}):new Promise(Ua=>{Ua(!1)})}}aa.owd=!1;aa.hCc=null;Object(u.a)(aa,"SideCarLoader",null,[]);class Z{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(u.a)(Z,"CloudPolicySettingsData",null,[]);class fa{constructor(Ua,Ca){this.ZNc=0;this.h9b=null;this.rnb=new w(Ua,Ca);this.Ta=Ua;Ca=Ua.Va("HostAuthType");this.AHa=Ua.ra("OcpsIsEnabled")&&Ua.ra("IsO365CommercialHost")&&
!(void 0===Ca||null===Ca)&&"aad"===Ca.toLowerCase();this.Hme=y.b(Ua.Va("OcpsDefaultSettings")||"{}");this.oob=this.Shc();Ca=this.Ta.Dq("ServicesControlsMicrosoftControllerServicesList")?this.Ta.Kw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.BXb=new G.a;for(let Ia=0;Ia<Ca.length;Ia++)this.BXb.add(Ca[Ia]);this.AHa&&!Ua.ra("IsAnonymousUser")&&Ua.ra("SideCarIsEnabled")?this.h9b=this.X$j():this.h9b=this.sra(this.AHa,this.Sxa("/afhs/CloudPolicySettings.ashx"),Object(e.a)(this,this.ygj,
"parseCloudPolicySettingsResponse"));this.h9b.then(()=>null).catch(Ia=>{Ia=Object(d.a)(l,Ia);c.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Ia?Ia.Sya.toString():"Unknown")})}UN(Ua,Ca=!0){if(!this.AHa){const bb=this;return new Promise(Za=>{Za(bb.uBb(Ua))})}let Ia=this,oa=this;const Da=this.h9b.then(bb=>{try{let Za=null;bb.PolicySettings&&"unknown"in bb.PolicySettings&&(Za=bb.PolicySettings.unknown);if(Za){if(Ua in Za&&void 0!==Za[Ua]&&null!==Za[Ua])return new Promise(Ba=>
{Ba("0"!==Za[Ua])});const Xa=Ua.toLowerCase();if(Xa in Za&&void 0!==Za[Xa]&&null!==Za[Xa])return new Promise(Ba=>{Ba("0"!==Za[Xa])});c.ULS.sendTraceTag(51512667,3004,50,"Policy"+Ua+" not found, using default");return new Promise(Ba=>{Ba(Ia.uBb(Ua))})}return new Promise(Xa=>{Xa(Ia.uBb(Ua))})}catch(Za){return c.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Ua+" policy value. Error Message: {0}",Za.message),Ia.handleError(Za.toString(),Ca,Ia.uBb(Ua))}},bb=>oa.handleError(bb,Ca,oa.uBb(Ua)));Da.then(bb=>
{c.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",Ua,bb);return null});return Da}isFeatureEnabled(Ua,Ca=!0){if(this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.zBi(Ua,Ca);let Ia=new Promise(Da=>{Da(!0)}),oa="";this.BXb.contains(Ua)&&(oa="ControllerConnectedServicesEnabled",Ia=this.UN(oa,Ca));Ia.then(Da=>{c.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Ua,Da,oa);return null});return Ia}zBi(Ua,Ca=!0){let Ia=new Promise(Da=>{Da(!0)}),oa="";"mso_sendASmile"===Ua?oa="Enabled":"Survey"===Ua||"FloodgateSurvey"===Ua?oa="SurveyEnabled":this.BXb.contains(Ua)&&(oa="ControllerConnectedServicesEnabled");""!==oa&&(Ia=this.UN(oa,Ca));Ia.then(Da=>{c.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Ua,Da,oa);return null});return Ia}handleError(Ua,Ca,Ia){return Ca?new Promise(oa=>
{oa(Ia)}):new Promise((oa,Da)=>{Da(Ua)})}sra(Ua,Ca,Ia){if(!Ua)return Promise.resolve(new Z);let oa=!1,Da=null;k.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let bb=this.rad("GetCloudPolicySettings");return(new Promise((Za,Xa)=>{if(void 0!==this.oob&&null!==this.oob&&0<this.oob.length){const Ba=this.I$j();if(void 0!==Ba&&null!==Ba){oa=!0;Za(Ba);return}}this.rnb.swb(Ca,Ia,1,null,Object(e.a)(this,this.kmj,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],
this.Ta.oe("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ta.oe("CloudPolicySettingsRequestSentTimeout",3E4)).then(Ba=>{c.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.vak(Ba);Za(Ba);return Ba},Ba=>{Xa(Ba);return null})})).then(Za=>{({stopwatch:bb,returnValue:Da}=this.iGc(bb));var Xa=O.a.ot();Xa&&Xa.set("FromCache",oa.toString());Xa=Object.assign(new L.a,{durationMs:Da,extendedProperties:Xa});k.Health.instance.recordKpiSuccess("GetCloudPolicySettings",
Xa);return Za})}X$j(){return aa.sjg().then(()=>{c.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Sxa(Ua){return String.format("{0}{1}",this.Ta.Va("WebServiceBase"),Ua)}ygj(Ua){let Ca=null;({qt:Ca}=y.d(Ua));Ua=!!Ca;c.ULS.sendTraceTag(50622687,3004,Ua?50:10,"ParseCloudPolicySettingsResponse: Success={0}",Ua);return Ca}kmj(Ua){try{if(void 0!==Ua&&null!==Ua&&"CheckIn-Interval"in
Ua){const Ca=parseInt(Ua["CheckIn-Interval"]);void 0!==Ca&&null!==Ca&&0<Ca&&(this.ZNc=Ca)}}catch(Ca){c.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Ca)}}uBb(Ua){return Ua in this.Hme?"0"!==this.Hme[Ua]:!0}I$j(){try{const Ua=W.a.instance.getItem(this.oob);if(void 0===Ua||null===Ua)return c.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;c.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
Ua);const Ca=JSON.parse(Ua);if(void 0===Ca||null===Ca)return c.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===Ca.ExpirationTime||null===Ca.ExpirationTime)return c.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ca.ExpirationTime)).getTime()<Date.now())return c.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const Ia=new Z;Ia.PolicySettings=Ca.PolicySettings;Ia.ControllerConnectedServicesFeatureNames=new Y.a;this.Ta.Dq("ServicesControlsMicrosoftControllerServicesList")&&this.Ta.Kw("ServicesControlsMicrosoftControllerServicesList");for(let oa of this.BXb)Ia.ControllerConnectedServicesFeatureNames.add(oa);c.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ia}catch(Ua){return c.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
Ua.toString()),null}}vak(Ua){try{if(void 0===Ua||null===Ua||void 0===Ua.PolicySettings||null===Ua.PolicySettings)c.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.ZNc)c.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const Ca=new Q(Ua,this.ZNc),Ia=JSON.stringify(Ca);c.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ia);W.a.instance.setItem(this.oob,
Ia);c.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(Ca){c.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",Ca.toString())}}Shc(){const Ua=R.Shc(this.Ta);return Ua&&0<Ua.length?"OCPS"+Ua:null}rad(Ua){const Ca=S.a.instance.ah("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ca&&null!==Ca?Ca.qd("WebServiceCall",Ua):null}iGc(Ua){if(void 0!==Ua&&null!==Ua){const Ca=Ua.fd;Ua.stop();return{returnValue:Ca,
stopwatch:null}}return{returnValue:null,stopwatch:Ua}}}Object(u.a)(fa,"CloudPolicySettingsHelper",null,[234]);class ya{constructor(){this.dVe=this.hvg=this.uv=0;this.eVe=this.ivg=this.YKa="";this.tZc=this.dha=2}clone(){const Ua=new ya;Ua.uv=this.uv;Ua.hvg=this.hvg;Ua.dVe=this.dVe;Ua.YKa=this.YKa;Ua.ivg=this.ivg;Ua.eVe=this.eVe;Ua.dha=this.dha;Ua.tZc=this.src;return Ua}get src(){return this.tZc}serialize(Ua=null){const Ca={};if(!Ua||Ua.contains(ya.PRa))Ca[ya.PRa]=this.uv;if(!Ua||Ua.contains(ya.bKb))Ca[ya.bKb]=
this.YKa;if(!Ua||Ua.contains(ya.cKb))Ca[ya.cKb]=this.dha;return JSON.stringify(Ca)}static create(Ua,Ca=null){const Ia=new ya;Ia.tZc=Ua;void 0!==Ca&&null!==Ca&&(ya.PRa in Ca&&(Ia.uv=Ca[ya.PRa]),ya.bKb in Ca&&(Ia.YKa=Ca[ya.bKb]),ya.cKb in Ca&&(Ia.dha=Ca[ya.cKb]));return Ia}static deserialize(Ua,Ca){try{const Ia=JSON.parse(Ua);if(void 0!==Ia&&null!==Ia)return ya.create(Ca,Ia);c.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Ua);throw Error.argument("settingsData");
}catch(Ia){throw c.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ia.toString()),Ia;}}}ya.PRa="CCS";ya.bKb="CCSTime";ya.cKb="OfficePrivacyRoamedNoticeShown";Object(u.a)(ya,"UserPrivacySettings",null,[]);var Aa=a(144);class ja{constructor(Ua,Ca){if(void 0===Ua||null===Ua||void 0===Ca||null===Ca)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ta=Ua;this.lh=Ca;this.LYc=this.Re=null}Sxa(Ua){var Ca=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ta.appSettings.RoamingServiceHandlerWebServiceBase||"");Ca=new Sys.StringBuilder(Ca);Ca.append(Ua);Ca.append("&");Ca.append(r.AFrameworkApplication.ej);return Ca.toString()}executeRequest(Ua,Ca,Ia,oa=null){return this.lh.Orb(Ua,Ca,oa,null,Ia,"33",!1,null,6E4)}saveSettings(Ua){return new Promise((Ca,Ia)=>{try{if(void 0===this.Re||null===this.Re||void 0===Ua||null===Ua)c.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ia("Can't determine setting changes to save");
else{var oa=this.Re.uv!==Ua.uv;if(2===this.Re.src&&oa)this.GGj(Ua),Ca(!0);else{var Da=this.IKj(Ua);if(void 0===Da||null===Da||!Da.length)c.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ia("No changes to save");else if(1===this.Re.src)Ca(this.Oqg(Da));else if(0===this.Re.src){c.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Da);const bb=this.executeRequest(this.Sxa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Da);bb.continueWith(()=>{if(bb.Zh||bb.vg)c.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Ca(!1);else{var Za=bb.result;void 0!==Za.Ph&&null!==Za.Ph&&void 0!==Za.Ph.data&&null!==Za.Ph.data&&Za.Ph.data.httpStatus===v.a.hK?(c.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Ca(!0)):(c.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Ca(!1))}})}}}}catch(bb){c.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",bb.toString()),Ca(!1)}})}IKj(Ua){if(void 0===this.Re||null===this.Re||void 0===Ua||null===Ua)throw Error.invalidOperation("User Privacy settings have not been initialized");const Ca=new Y.a;0===Ua.src?(this.Re.uv!==Ua.uv&&(Ca.add(ya.PRa),Ca.add(ya.bKb)),this.Re.dha!==Ua.dha&&Ca.add(ya.cKb)):1===Ua.src&&this.Re.uv!==Ua.uv&&Ca.add(ya.PRa);return Ca.count?Ua.serialize(Ca):(c.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.LYc){const Ua=this;this.LYc=new Promise(Ca=>{try{Ua.Re?Ca(Ua.Re.clone()):Ua.Q$j().then(Ia=>{Ua.Re=Ia;Ca(Ua.Re.clone());return null},()=>{Ua.O$j().then(Ia=>{Ua.Re=Ia;Ca(Ua.Re.clone());return null},()=>{Ua.P$j().then(Ia=>{Ua.Re=Ia;Ca(Ua.Re.clone());return null},()=>{c.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");Ua.Re=new ya;Ca(Ua.Re.clone());return null});return null});return null})}catch(Ia){c.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Ia.toString()),Ua.Re=new ya,Ca(Ua.Re.clone())}})}return this.LYc}Q$j(){return new Promise((Ua,Ca)=>{try{const oa=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ta.ra("PrivacyDialogShouldCheckRoaming")||oa){var Ia=this.executeRequest(this.Sxa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ia.continueWith(()=>{try{if(Ia.Zh||Ia.vg)c.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{const Da=Ia.result;if(Da&&Da.Ph&&Da.Ph.data)if(Da.Ph.data.httpStatus!==v.a.hK)c.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Da.Ph.data.httpStatus);else{if(Da.Ph.data.Fe){Ua(ja.parse(Da.Ph.data.Fe,0));c.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Da.Ph.data.Fe);return}c.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else c.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Ca("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Da){c.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Da.toString()),Ca("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else c.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Ca("Roaming should not be used")}catch(oa){c.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",oa.toString()),Ca("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}O$j(){return new Promise((Ua,Ca)=>{try{const Ia=Aa.a.get("WacUPToggleState");let oa=null;void 0!==Ia&&null!==Ia&&0<Ia.length&&(oa=decodeURIComponent(Ia));if(void 0!==oa&&null!==oa&&0<oa.length){const Da=ja.parse(oa,1);c.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Da.toString());Ua(Da)}else{const Da=ya.create(1),
bb=new Y.a;bb.add(ya.PRa);const Za=Da.serialize(bb);this.Oqg(Za)?(c.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Za),Ua(Da)):(c.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Za),Ca("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ia){c.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Ia.toString()),Ca("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}P$j(){return new Promise(Ua=>{try{var Ca=-1!==window.location.href.indexOf("&wdccsoff=1");let Ia=ya.create(2);Ca?(Ia.uv=2,r.AFrameworkApplication.ITe(),c.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ia.toString())):(Ia.uv=1,c.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",Ia.toString()));Ua(Ia)}catch(Ia){c.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ia.toString()),Ca=ya.create(2),Ca.uv=1,Ua(Ca)}})}GGj(Ua){c.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Ua.uv?r.AFrameworkApplication.ITe():r.AFrameworkApplication.HCh();c.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Ua)}Oqg(Ua){try{c.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",Ua);const Ca=
this.Ta.Va("PrivacyCookieDomain")||"";if(!Ca||!Ca.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");c.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Ua);return Aa.a.QYd("WacUPToggleState",Ua,Aa.a.m1,"/",Ca)}catch(Ca){return c.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Ca.toString()),!1}}isFeatureEnabled(Ua){return this.getSettings().then(Ca=>{const Ia=this.Ta.Dq("ServicesControlsMicrosoftControllerServicesList")?
this.Ta.Kw("ServicesControlsMicrosoftControllerServicesList"):[],oa=new G.a;for(let Da=0;Da<Ia.length;Da++)oa.add(Ia[Da]);return oa.contains(Ua)?2!==Ca.uv:!0},()=>{c.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Ua);return!0})}static parse(Ua,Ca){try{return c.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",Ua,Ca),ya.deserialize(Ua,Ca)}catch(Ia){throw c.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ia.toString()),
Ia;}}}Object(u.a)(ja,"UserPrivacySettingsHelper",null,[235]);var za=a(260);class ra{constructor(){this.Db=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Di(Ua){this.Db=Ua;this.Db.register(234,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Uc().dd(()=>new fa(r.AFrameworkApplication.fa,r.AFrameworkApplication.de));this.Db.register(235,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Uc().dd(()=>new ja(r.AFrameworkApplication.fa,
r.AFrameworkApplication.de));this.Db.register(236,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Uc().dd(()=>new E(r.AFrameworkApplication.fa,r.AFrameworkApplication.de));this.Db.register(237,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Uc().dd(()=>new R(r.AFrameworkApplication.fa,r.AFrameworkApplication.de,this.Db.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Db.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
r.AFrameworkApplication.Qb))}init(){r.AFrameworkApplication.fa.Hv(()=>{const Ua=this.Db.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");r.AFrameworkApplication.fa.ra("LicensingIsEnabled")&&(Ua.isFeatureEnabled("LicensingTestFeature",!1).then(Ca=>{c.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Ca,r.AFrameworkApplication.fa.Va("IsAnonymousUser"));return null}),Ua.getFeatureTier("LicensingTestFeature",
0).then(Ca=>{c.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Ca,r.AFrameworkApplication.fa.Va("IsAnonymousUser"));return null}));this.Db.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.o5j()})}dispose(){}o5j(){try{r.AFrameworkApplication.fa.ra("SideCarIsEnabled")&&aa.sjg().then(Ua=>{c.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",
Ua);return Ua})}catch(Ua){}}static main(){za.a.instance.nj(new ra)}}Object(u.a)(ra,"ApplicationFeatureHelperPackage",null,[4,5]);a.d(C,"a",function(){return fb});const fb=()=>{Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");ra.main()}},1202:function(u,C,a){u={};a.r(u);a.d(u,"EmbeddedWorkbookReadoutHandler",function(){return Na});var c={};a.r(c);a.d(c,"WorkbookReadoutHandler",function(){return ta});var b=a(10),f=a(1),e=a(0),d=a(229),h=a(15),l=a(35),k=
a(7),n=a(13),v=a(23),x=a(16),w=a(268),r=a(20),t=a(34);class A{constructor(X){this.MBc=X||""}static get MWe(){return A.Pee||(A.Pee=new A(""))}static get MDd(){return A.ale||(A.ale=A.oW(2).MBc)}static bNa(X){X=t.a.ki(X||"");return new A(X)}static Lla(X){return A.bNa(x.a.instance.ha(X))}static oW(X){return new A(x.a.instance.Ha(X))}static mkd(X,...la){return A.uWh(x.a.instance.Lb(X),...la)}static uWh(X,...la){const sa=la.length,Va=Array(sa);for(let nb=0;nb<sa;nb++)Va[nb]=(la[nb]||A.MWe).MBc;return new A(String.format(X,
Va))}}A.Pee=null;A.ale=null;Object(e.a)(A,"SafeHtml",null,[417]);const y=(X,la)=>{la&&(X.append(la),X.append(A.MDd))};var z=a(173),E=a(114),G=a(2),F=a(355),O=a(177),M=a(109),P=a(770),B=a(31),D=a(221);class I{constructor(X,la){this.X1=this.cT=this.gM=null;this.Ela=la;this.Lqh(X);this.Rkj();f.EwaSettings.Tb()&&X.da.Ja(244,this)}get isActive(){return!!this.Ela&&document.activeElement===this.Ela}readText(X){X=f.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?
X:String.format(x.a.instance.Lb(30),X);this.gM.setAttribute(k.a.ov,X);this.cT.setAttribute(k.a.ov,X);this.f4j()}dispose(){this.X1&&this.X1.parentNode&&this.X1.parentNode.removeChild(this.X1);this.cT=this.gM=this.X1=this.Ela=null}Lqh(X){var la=X.fc+"readoutElementWrapper";const sa=X.fc+"readoutElement1",Va=X.fc+"readoutElement2";this.X1=document.getElementById(la);this.X1||(this.X1=document.createElement(D.a.div),this.X1.id=la,this.gM=document.createElement(D.a.label),this.gM.id=sa,this.gM.setAttribute(k.a.fe,
k.a.d2a),this.gM.setAttribute("aria-roledescription",""),this.gM.setAttribute("aria-multiline",!1),this.cT=document.createElement(D.a.label),this.cT.id=Va,this.cT.setAttribute(k.a.fe,k.a.d2a),this.cT.setAttribute("aria-roledescription",""),this.cT.setAttribute("aria-multiline",!1),this.gM.style.width="0px",this.gM.style.height="0px",this.cT.style.width="0px",this.cT.style.height="0px",this.gM.tabIndex=-1,this.cT.tabIndex=-1,this.X1.appendChild(this.gM),this.X1.appendChild(this.cT),X=X.fc+k.a.a$b,
la=document.getElementById(X),h.ULS.shipAssertTag(537153942,3,!!la,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${X}`),la&&la.appendChild(this.X1))}Rkj(){this.Ela&&this.gM&&this.cT&&(this.Ela.setAttribute(k.a.L4,this.gM.id),this.Ela.setAttribute(k.a.d6b,`${this.gM.id} ${this.cT.id}`))}f4j(){if(this.isActive){let X="";n.DOMElementExtensions.hasAttribute(this.Ela,k.a.L4)&&(X=this.Ela.getAttribute(k.a.L4).toString());this.Ela.setAttribute(k.a.L4,X===this.gM.id?
this.cT.id:this.gM.id)}else h.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static wza(){if(null==I.Fzb)if(f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!B.a.jQa)I.Fzb=!0,h.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(I.Fzb=!1,B.a.YI||B.a.ng)I.Fzb=!0,h.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");
return I.Fzb}static la(X){I.wza()&&X.da.Ja(244,new I(X,r.h(X).cellTextEditBox.textBox.pf))}}I.Fzb=null;Object(e.a)(I,"FocusBasedReadout",null,[375,2]);class S{constructor(X,la,sa,Va=null){this.EJf=(nb,ha)=>{this.g0f(ha.Wd.command)};this.Wag=()=>{if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&!this.$.ea.Ec){var nb={["AriaLiveOffCount"]:this.Pae,["AriaLivePoliteCount"]:this.Qae,["AriaLiveAssertiveCount"]:this.Oae,["AriaLiveRudeCount"]:this.Rae,["ScreenReaderDivCount"]:this.jqe,
["AlertScreenReaderDivCount"]:this.tae,["AuxScreenReaderDivCount"]:this.$ae,["AriaAlertCount"]:this.Mae,["ReadCommandOnCompletionCount"]:this.Toe,["TotalAriaLiveRegionUpdates"]:this.Pse};z.a.sendTelemetryEvent(Object(G.a)(new F.a,{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:E.a.Yh(nb)}))}};this.$=X;this.oc=Va;this.I$=document.createElement("div");this.I$.setAttribute(k.a.N4,k.a.$k);this.I$.className=l.a.zgd;la.insertBefore(this.I$,sa);this.Iaa=document.createElement("div");
this.Iaa.setAttribute(k.a.N4,k.a.$k);this.Iaa.className=l.a.zgd;la.insertBefore(this.Iaa,this.I$);this.pKg=x.a.instance.Ha(2);this.P4=document.createElement("div");this.P4.setAttribute(k.a.fe,k.a.rja);this.P4.setAttribute(k.a.sja,k.a.c2a);this.P4.className=l.a.zgd;la.insertBefore(this.P4,this.Iaa);this.Pse=this.Toe=this.Mae=this.$ae=this.tae=this.jqe=this.Rae=this.Oae=this.Qae=this.Pae=0;this.register();this.$.da.Ja(211,this)}get zAa(){return this.pKg}get isActive(){return!0}get C_g(){return this.I$}get BHj(){return this.Iaa}get activeCell(){return r.h(this.$).jc(null)}get uEb(){return f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",
!1)}dispose(){this.$&&this.unregister();n.DOMElementExtensions.gg(this.P4);n.DOMElementExtensions.gg(this.I$);n.DOMElementExtensions.gg(this.Iaa);this.Iaa=this.I$=this.P4=this.$=null}setEnabled(X){this.Tcg(this.Iaa,X)}PMj(){this.Tcg(this.I$,!0)}readText(X){this.bfb(A.bNa(X),!0)}tpa(X){this.bfb(A.bNa(X),!1)}j0f(X,la){if(1>la||!X)h.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var sa=new Sys.StringBuilder;X=String.format(x.a.instance.Lb(34),la,X);y(sa,X);y(sa,x.a.instance.ha(857));
this.bfb(A.bNa(sa.toString()),!1)}}crj(X,la,sa){if(1>sa||1>la||la>sa||!X)h.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Va=new Sys.StringBuilder;y(Va,X);Va.append(String.format(x.a.instance.Lb(55),la,sa));this.bfb(A.bNa(Va.toString()),!1)}}g0f(X){this.uEb||(X=this.bdi(X),this.bfb(X,!1))}arj(X){this.uEb&&(X=this.adi(X),this.bfb(X,!1,!0))}bfb(X,la,sa=!1){if(X=X?X.MBc:null)la=la?this.Iaa:this.I$,v.a.equals(la.innerHTML,X,!1)&&(X+=A.MDd),this.xpg(la,sa),this.oc.Oh(la,X)}afb(X,
la){this.P4.getAttribute(k.a.sja)!==la&&this.P4.setAttribute(k.a.sja,la);X=X?A.bNa(X).MBc:"";this.xpg(this.P4);this.oc.Oh(this.P4,X)}drj(X,la,sa,Va){const nb=x.a.instance.Lb(54);h.ULS.shipAssertTag(537153949,0,!(void 0===X||null===X));h.ULS.shipAssertTag(537153948,0,!(void 0===la||null===la));h.ULS.shipAssertTag(537153947,0,!(void 0===sa||null===sa));h.ULS.shipAssertTag(537153946,0,!(void 0===Va||null===Va));h.ULS.shipAssertTag(537153945,0,!(void 0===nb||null===nb));X=String.format(nb,X||"",la||"",
sa||"",Va||"");this.afb(X,k.a.dva)}Tck(X){var la=this.Iaa.style;X?(X=w.a.j7b(X.cell,la),la=X.cD,la.top=la.left=la.bottom=la.right=null,X.J4()):la.cssText=""}bdi(X){if(this.uEb)return null;switch(X){case -1985798686:return A.Lla(12);case -911352779:return A.Lla(11);case 237279923:return A.Lla(13);case -1502853784:return A.oW(81);case -111689794:return A.oW(78);case -287251124:return this.Rod(1333,la=>la.bold);case -1925065947:return this.Rod(1334,la=>la.italic);case 1764140053:return this.Rod(1335,
la=>la.underline)}return null}adi(X){if(!this.uEb||6!==X.yf)return null;switch(X.command){case -1985798686:return A.Lla(12);case -911352779:return A.Lla(11);case 237279923:return A.Lla(13);case -1502853784:return A.oW(81);case -111689794:return A.oW(78);case 368460465:X=r.h(this.$).Mb.ph(this.activeCell.range,!0);if(null!==X)return this.$Na(2291,!X.hasAutoFilter,!1);X=this.$.ua.getItemByName(this.$.ea.na.sheetName);return this.$Na(2291,null===X.yT,!1);case -1522760979:return this.$Na(1150,r.h(this.$).isFormulaView,
!1);case 1941920197:return A.Lla(836);case 1051390410:return A.oW(589);case 1542466017:return A.oW(591);case -706918724:return A.oW(590);case 369708605:return A.oW(592);case -1215659745:return A.oW(523);case 1783960667:return A.oW(521);case -1355155015:return A.oW(554);case -1158102843:return A.oW(522);case -287251124:return this.$Na(1333,this.enc(X.command));case -1925065947:return this.$Na(1334,this.enc(X.command));case 1764140053:return this.$Na(1335,this.enc(X.command));case -1590502662:return this.$Na(1336,
this.enc(X.command));case 862890474:case 963349338:if(X=A.bNa(String(this.Vxa())),null!==X)return A.mkd(214,X)}return null}register(){h.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(h.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.Ia&&this.$.Ia.dja(this.EJf),this.$.ea&&f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.DD(this.Wag))}unregister(){this.$&&(this.$.Ia.Qfa(this.EJf),
f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.YE(this.Wag))}Tcg(X,la){const sa=X===this.I$;la?(sa&&I.wza()||X.setAttribute(k.a.sja,k.a.dva),sa&&X.setAttribute(k.a.fe,k.a.rja),X.setAttribute(k.a.N4,k.a.ns),X.removeAttribute(k.a.N4),this.oc.Oh(X,X.innerHTML+" ")):(X.removeAttribute(k.a.sja),sa&&X.removeAttribute(k.a.fe),X.setAttribute(k.a.N4,k.a.$k))}Rod(X,la){const sa=this.activeCell;if(!sa)return null;const Va=f.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),
nb=[7,8];la=la(sa)?!0:!1;return A.mkd(Va?nb[+la]:nb[+!la],A.Lla(X))}xpg(X,la=!1){if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")){switch(X.getAttribute(k.a.sja)){case k.a.BCe:++this.Pae;break;case k.a.dva:++this.Qae;break;case k.a.c2a:++this.Oae;break;case k.a.F2g:++this.Rae}switch(X){case this.BHj:++this.jqe;break;case this.C_g:++this.tae;break;case this.P4:++this.$ae}X.getAttribute(k.a.fe)===k.a.rja&&++this.Mae;la&&++this.Toe;this.Pse++}}$Na(X,la,sa=!0){return this.uEb&&
this.activeCell?A.mkd(la?sa?7:216:sa?8:217,A.Lla(X)):null}enc(X){return r.h(this.$).ga.Sa.qS?this.WBi(X):this.XBi(X)}WBi(X){const la={};switch(X){case -287251124:X="QueryBold";break;case -1925065947:X="QueryItalics";break;case 1764140053:X="QueryUnderline";break;case -1590502662:X="QueryStrikethrough";break;default:return!1}const sa=M.a(this.$);return sa?(sa.vOa(X,la),la[P.a.On]):!1}XBi(X){var la=r.h(this.$);const sa=O.a(la.jc(null));f.EwaSettings.Tb()&&la.Eb&&(sa.Font=la.Rh.Wxa(sa.Font));la=sa.Font;
switch(X){case -287251124:return la.Bold;case -1925065947:return la.Italic;case 1764140053:return la.Underline;case -1590502662:return la.Strikethrough}return!1}Vxa(){let X=r.h(this.$);if(X.ga.Sa.qS)return null;const la=O.a(X.jc(null));f.EwaSettings.Tb()&&X.Eb&&(la.Font=X.Rh.Wxa(la.Font));return la.Font.FontSize}}Object(e.a)(S,"AriaLiveNotifier",null,[397,375,2]);var J=a(40),L=a(100),R=a(149),Y=a(36);class Q extends d.a{constructor(X){super();this.$=X;this.kc()}create(){const X=Object(L.d)(R.a.resolve(Y.S,
{Wa:this.La}));J.TaskExtensions.za(J.TaskExtensions.ke([X],this.$.ka),()=>{this.Pb(this.$.da.Ba(211)||new S(this.$,this.$.yw,this.$.$f,X.result))},this.ka,3)}static la(X){X.da.Ja(212,new Q(X))}}Object(e.a)(Q,"AriaLiveNotifierFactory",d.a,[]);class W extends d.a{constructor(X){super();this.$=X;this.kc()}create(){I.wza()?r.h(this.$).cellTextEditBox.textBox.gR(()=>{const X=this.$.da.Ba(244)||new I(this.$,r.h(this.$).cellTextEditBox.textBox.pf);this.Pb(X)}):this.Pb(null)}static la(X){X.da.Ja(315,new W(X))}}
Object(e.a)(W,"FocusBasedReadoutFactory",d.a,[]);var Ga=a(52),pa=a(92),aa=a(126);const Z=X=>{switch(X){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;
case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var fa=a(25),ya=a(47),Aa=a(218),ja=a(51),za=a(48),ra=a(135);class fb{static get Opj(){return fb.Loe||(fb.Loe=RegExp("([A-Z]+)","g"))}static get Npj(){return fb.Koe||(fb.Koe=RegExp("([A-Z])","g"))}static get mdh(){return fb.ece||(fb.ece=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static God(X){return fb.adf(X.toString())}static adf(X){return fb.mdh.test(X)?
X.replace(fb.Opj,"$1 ").replace(fb.Npj,' "$1"').trim():X}static JAj(X){const la=X.lastIndexOf("!");return X.substring(0,-1<la?la+1:0)+fb.adf(X.substring(-1<la?la+1:0,X.length))}}fb.Loe=null;fb.Koe=null;fb.ece=null;Object(e.a)(fb,"RangeAriaExtensions",null,[]);class Ua{constructor(){this.activeItemName=null;this.iuf=!1;this.tableName=null;this.R3a=0;this.ZGc=!1}}Object(e.a)(Ua,"SelectionReadoutState",null,[]);a(73);var Ca=a(79);class Ia{constructor(X,la,sa,Va,nb){this.gridReadoutNotifier=null;this.Veb=
!1;this.tva=this.ntb=null;this.Dfa=()=>{f.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?h.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):r.h(this.$).Eb||this.j6b.Zq()};this.b0i=()=>{if(!r.h(this.$).ga.Sa.Zxd){var ha,jb=({activeCell:ha}=this.GZh()).returnValue;this.readText(jb,ha)}};this.BC=()=>{const ha=this.activeCell;this.readText("Editing",ha);f.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||
ha&&ha.$jc&&!r.h(this.$).Fif||this.j6b.cancel()};this.Dd=()=>{f.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?h.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(this.Dfa(),this.Veb&&r.h(this.$).inRangePicker&&1===Ca.a.Vb&&(null===this.ntb?this.ntb=ja.a.instance.create(this.ZPd,Ia.K0c,"readSelectedRanges"):this.ntb.Zq()))};this.$=la;this.ariaLiveNotifier=X;this.sparklineManager=Va;this.tableManager=sa;this.XE=
new Ua;this.wza=I.wza();this.Veb=f.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.wza&&(f.EwaSettings.Tb()?this.gridReadoutNotifier=nb:this.gridReadoutNotifier=la.da.Ba(244),h.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Ia.K0c=700);this.j6b=ja.a.instance.create(this.b0i,Ia.K0c,za.a.jJj,!1);this.mj()}get activeCell(){return r.h(this.$).jc(null)}dispose(){this.$&&this.oj();pa.a.Ka(this.j6b);
this.sparklineManager=this.$=this.j6b=null}t8e(X,la,sa=!0){if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&null!==this.$.Ob.Xh&&"FindAndReplaceDialog"===this.$.Ob.Xh.Qc||!X)return"";var Va=this.$.da;const nb=new Sys.StringBuilder;this.o1g(nb,X,la);if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var ha=this.tableManager.oma(X.range);(null===ha||void 0===ha?0:ha.V_d)&&this.bBe(nb,ha);ha=this.tableManager.Lq(X.range);(null===
ha||void 0===ha?0:ha.Jma)&&this.bBe(nb,ha)}ha=X.Q6?this.uaf(X):X.text;y(nb,ha);ha=this.$.activeItemName;this.XE.activeItemName!==ha&&(y(nb,ha),this.XE.activeItemName=ha);ha=1===la.length?ya.L(la).isSingle?"":x.a.instance.ha(853):String.format(x.a.instance.Lb(31),la.length);y(nb,ha);for(var jb of la)ha=this.wza?jb.toString():fb.God(jb),y(nb,ha),1===la.length&&Ia.VIi(jb)&&(ha=r.h(this.$).Ca.Fr(jb.bottomRight),void 0!==ha&&null!==ha&&ha.text&&(ha=ha.Q6?this.taf(ha,ha.text):ha.text,y(nb,ha)));jb=X.cell;
jb=this.pai(jb.rFj,jb.mgh);y(nb,jb);this.Y0g(nb,X);sa&&(X.J$a?y(nb,x.a.instance.ha(841)):X.Kza&&y(nb,x.a.instance.ha(842)));if(X.hasAutoFilter||X.P6)this.p1g(nb,X.hasAutoFilter?X.cell.autoFilterType:X.cell.iij),sa&&y(nb,x.a.instance.ha(844));Aa.c(this.$,X.range)&&y(nb,x.a.instance.ha(848));this.V0g(nb,X);sa=(sa=Va.Ba(14))?sa.G_h():"";y(nb,sa);X.pz&&(sa=r.h(this.$).Ca.Fr(X.range),sa=!!sa&&sa.hasIgnorableError,Ia.gTj(X)?Ia.W0g(nb,X):f.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
sa?y(nb,x.a.instance.ha(846)):y(nb,x.a.instance.ha(845)));X.bO&&(y(nb,x.a.instance.ha(847)),X.uCb&&y(nb,String.format(x.a.instance.Lb(16),X.Nth)),y(nb,X.iconName));X.hasRichValueIcon&&(jb=this.$.da.Ba(271),sa="",jb&&X.cell.xyf&&(jb=jb.QV(X.cell.xyf))&&jb.DomainId.Id!==Ia.dlk&&(sa=jb.Name),X.cell.tyi?(y(nb,String.format(x.a.instance.Lb(187),sa)),y(nb,x.a.instance.ha(1812))):(y(nb,String.format(x.a.instance.Lb(185),sa)),y(nb,x.a.instance.ha(1811))));this.zni(X)&&y(nb,Ia.D6h(X));(Va=Va.Ba(231))&&y(nb,
Va.Jaf(la,!0));1===la.length&&la[0].isSingle&&Ia.fTj(X,la[0],this.$)&&(la=this.$.da.Ba(271))&&y(nb,la.S_h());X.fUb&&X.gUb&&y(nb,X.gUb);(la=X.cell.J7c)&&y(nb,la);X.YPa&&X.wMb&&(X=X.CMd)&&(y(nb,x.a.instance.ha(1985)),y(nb,X));return nb.toString()}nGe(X){this.tva=this.XE;this.XE=Object(G.a)(new Ua,{activeItemName:this.tva.activeItemName,ZGc:X?this.tva.ZGc:!1,tableName:X?this.tva.tableName:"",R3a:X?this.tva.R3a:-1})}Y7f(){this.tva&&(this.XE=this.tva,this.tva=null)}pai(X,la){return 2===X||2===la?x.a.instance.ha(875):
1===X||1===la?x.a.instance.ha(876):""}uaf(X){return this.taf(X.cell,X.text)}o1g(X,la,sa){if(sa&&1===sa.length&&sa[0].isSingle){sa="";var Va=this.tableManager.oma(la.range);if(Va){sa=Va.pivotTableName;this.Q3c(X,sa);var nb=Va.Umc?x.a.instance.ha(835):"";f.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(nb+=(Va.altText?Va.altText+" . ":"")+(Va.altTextSummary?Va.altTextSummary:""));this.dBe(X,!0,sa,nb);y(X,this.tableManager.HGi(Va,la.range)?x.a.instance.ha(838):
"");y(X,this.tableManager.Pzi(Va,la.range)?x.a.instance.ha(837):"")}else if(Va=this.tableManager.Lq(la.range)){sa=(nb=r.h(this.$).Mb.ph(la.range))?nb.name:"";this.Q3c(X,sa);let ha="";nb&&(ha=(nb.CWa?nb.CWa+" . ":"")+(nb.DWa?nb.DWa:""));this.dBe(X,!1,sa,ha);y(X,this.tableManager.crf(Va,la.range)?x.a.instance.ha(837):"")}else this.Q3c(X,sa),this.XE.tableName="",this.XE.R3a=-1}}Q3c(X,la){la!==this.XE.tableName&&this.XE.tableName&&(X.append(x.a.instance.ha(this.XE.ZGc?834:833)),y(X," "+this.XE.tableName))}dBe(X,
la,sa,Va){sa!==this.XE.tableName&&(X.append(x.a.instance.ha(la?832:831)),y(X," "+sa),y(X,Va),this.XE.tableName=sa,this.XE.ZGc=la,this.XE.R3a=-1)}bBe(X,la){const sa=r.h(this.$).ga.pa.activeCell;if(sa.top!==la.top&&sa.left!==this.XE.R3a){X.append(x.a.instance.ha(837));la=new fa.Range(la.top,sa.left,la.top,sa.left,!0,!0);y(X,fb.God(la));if(la=r.h(this.$).jc(la))la=la.Q6?this.uaf(la):la.text,y(X,la);this.XE.R3a=sa.left}}taf(X,la){const sa=X.V8a;return X.Cya?String.format(x.a.instance.Lb(14),la,sa):String.format(x.a.instance.Lb(13),
la,fb.JAj(sa))}mj(){h.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var X=r.h(this.$);h.ULS.shipAssertTag(537153929,0,!!X,"Can't register to grid's events");X&&(X.wc.ao(this.BC),X.Ca.rw(this.Dfa),X.KF(this.Dfa),this.Veb&&X.wc.Bm(this.Jg.bind(this)),X=X.ga,h.ULS.shipAssertTag(537153928,0,!!X,"Can't register to selectionManager's events"),X&&(X.gp(this.Dd),X.add_activeCellChanged(this.Dfa),X.Sa.RQ(this.Dfa),this.Veb&&(this.ZPd=this.ZPd.bind(this))))}}oj(){if(this.$){var X=
r.h(this.$);X&&(X.wc.Un(this.BC),X.Ca.Vw(this.Dfa),X.dH(this.Dfa),this.Veb&&X.wc.Qm(this.Jg),X=X.ga)&&(X.Gp(this.Dfa),X.remove_activeCellChanged(this.Dfa),X.Sa.b2(this.Dfa))}}readText(X,la){this.wza&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(X):(f.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(X),this.Veb&&!la||this.ariaLiveNotifier.Tck(la))}Jg(){this.ntb&&
this.ntb.cancel()}ZPd(){this.readText(this.Pdi())}Pdi(){let X="";r.h(this.$).ga.rangePicker.fP.forEach(()=>{X+=void 0});return X+=" selected"}GZh(){let X;X=null;var la=r.h(this.$).ga;if(1!==la.gf&&!la.Sa.Fc)return h.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${la.gf} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:X};switch(la.gf){case 2:return{returnValue:this.L1h(la),activeCell:X};case 64:var sa=la.Sa.Fc.floatingObject,Va="";if(la=
la.Sa.Fc.Yt||la.Sa.Fc.qe)Va=(Va=la.firstChild)?n.DOMElementExtensions.getTextContent(Va):"";return{returnValue:String.format(x.a.instance.Lb(53),Ia.ogc(sa.altText,sa.altTextDescription,sa.name),Va,sa.altTextDescription),activeCell:X};case 4:return{returnValue:Ia.c0g(la.Sa.Fc.floatingObject),activeCell:X};case 512:return{returnValue:ra.a.Z9e(la.Sa.Fc.floatingObject.Ied),activeCell:X};case 8:return sa=la.Sa.Fc.floatingObject,{returnValue:String.format(x.a.instance.Lb(51),sa?sa.name:""),activeCell:X};
case 1:return X=this.activeCell,{returnValue:this.t8e(X,la.pa.selectedRanges),activeCell:X}}return{returnValue:"",activeCell:X}}L1h(X){const la=new Sys.StringBuilder;la.append(Ia.Dch(X));const sa=this.$.da.Ba(231);sa&&y(la,sa.Jaf(X.Sa.Fc.floatingObject,!1));return la.toString()}zni(X){X=X.Uof();let la=!1;this.XE.iuf!==X&&(this.XE.iuf=X,la=!0);return la}Y0g(X,la){if(la.FCb)if(la=this.sparklineManager.Rei(la)){var sa=x.a.instance,Va=sa.ha;a:switch(la.type){case 0:var nb=828;break a;case 1:nb=829;break a;
default:nb=830}sa=Va.call(sa,nb);y(X,String.format(x.a.instance.Lb(25),sa));la=String.format(x.a.instance.Lb(24),fb.God(la.u0j));y(X,la)}else h.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),y(X,String.format(x.a.instance.Lb(25),""))}p1g(X,la){switch(la){case 1:case 11:y(X,x.a.instance.ha(849));break;case 6:y(X,x.a.instance.ha(849));y(X,x.a.instance.ha(851));break;case 7:y(X,x.a.instance.ha(849));y(X,x.a.instance.ha(852));break;case 2:y(X,x.a.instance.ha(850));
y(X,x.a.instance.ha(851));break;case 3:y(X,x.a.instance.ha(850));y(X,x.a.instance.ha(852));break;default:y(X,x.a.instance.ha(850))}}V0g(X,la){var sa;const Va=this.$.da.Ba(65);la=Va?Va.vNa(la.range):null;let nb="";const ha=Object(aa.a)(394,la);if(la)nb=!la.q$a&&ha&&ha.uIi?String.format(x.a.instance.Lb(29),ha.X4j):String.format(x.a.instance.Lb(23),la.author);else if(null===(sa=null===Va||void 0===Va?void 0:Va.Rn)||void 0===sa?0:sa.wG)nb=String.format(x.a.instance.Lb(28),Va.Rn.KO.author);y(X,nb)}static c0g(X){return String.format(x.a.instance.Lb(52),
Ia.ogc(X.altText,X.altTextDescription,X.name),X.altTextDescription)}static D6h(X){return x.a.instance.ha(X.Uof()?839:840)}static ogc(X,la,sa){return X||la?X:sa}static Dch(X){var la=X.Sa.Fc;X=la.floatingObject;const sa=X.Kd,Va=sa.ChartTitle,nb=X.altText,ha=X.altTextDescription,jb=!!(sa.Attributes&4);return(la=la.getSelectionDescription())?la:sa.DataRangeForDisplay?String.format(x.a.instance.Lb(jb?49:47),Ia.ogc(nb,ha,X.name),ha,Va,x.a.instance.ha(Z(sa.ChartCategory)),sa.DataRangeForDisplay):String.format(x.a.instance.Lb(jb?
50:48),Ia.ogc(nb,ha,X.name),ha,Va,x.a.instance.ha(Z(sa.ChartCategory)))}static gTj(X){return f.EwaSettings.ya(101)&&(X.JEb||X.Tmc)}static W0g(X,la){la.Oqa?la.JEb?y(X,String.format(x.a.instance.Lb(26),la.Oqa.topLeft.toString())):la.Tmc&&(la=la.Oqa.fQ(),y(X,String.format(x.a.instance.Lb(27),(la.LastColumn-la.FirstColumn+1).toString(),(la.LastRow-la.FirstRow+1).toString()))):h.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static fTj(X,
la,sa){return X.pz||!f.EwaSettings.ya(131)?!1:(X=sa.da.Ba(271))?X.zmc(la):!1}static VIi(X){return X.top===X.bottom&&X.left+1===X.right||X.top+1===X.bottom&&X.left===X.right}}Ia.dlk=268435712;Ia.K0c=500;Object(e.a)(Ia,"SelectionReadoutHandler",null,[395,2]);var oa=a(62),Da=a(725),bb=a(71);class Za extends d.a{constructor(X){super();this.$=X;this.kc()}create(){const X=this.$.da,la=Ga.GetServiceTaskFactory.Za(X,211,212,this.La),sa=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",
!1)?Object(L.d)(R.a.resolve(Y.ub,{Wa:this.La})):Ga.GetServiceTaskFactory.Za(X,66,134,this.La),Va=Object(bb.b)("OfficeVSO:7624512_MigrateSparklineManagerService")?Object(L.d)(R.a.resolve(Y.tb,{Wa:this.La})):Ga.GetServiceTaskFactory.Za(X,240,239,this.La);let nb=oa.Task.Ua(null);f.EwaSettings.Tb()&&(nb=Ga.GetServiceTaskFactory.Za(X,244,315,this.La));J.TaskExtensions.za(J.TaskExtensions.ke([la,sa,Va,nb],this.ka),()=>{const ha=Object(Da.a)(this.$.da,226,()=>new Ia(la.result,this.$,sa.result,Va.result,
nb.result));this.Pb(ha)},this.$.ka,3)}static la(X){X.da.Ja(227,new Za(X))}}Object(e.a)(Za,"SelectionReadoutHandlerFactory",d.a,[]);var Xa=a(119);class Ba{constructor(X,la){this.$=la;this.ariaLiveNotifier=X}r0f(){const X=this.I_h();this.ariaLiveNotifier.afb(X,k.a.c2a)}I_h(){const X=new Sys.StringBuilder;this.$.workbookContext&&y(X,this.$.workbookContext.WorkbookFileName);y(X,x.a.instance.ha(855));y(X,this.K_h());y(X,this.J_h());y(X,x.a.instance.ha(856));return X.toString()}K_h(){return this.$.isEditMode?
x.a.instance.ha(860):x.a.instance.ha(861)}J_h(){var X=this.okk();const la=this.$.ua.na;X=1!==X?String.format(x.a.instance.Lb(32),X):x.a.instance.ha(854);X=new Sys.StringBuilder(X);la&&la.sheetName&&(X.append(A.MDd),X.append(String.format(x.a.instance.Lb(33),la.sheetName)));return X.toString()}okk(){let X=0;for(const la of this.$.ua.items)la.visible&&X++;return X}}Object(e.a)(Ba,"WorkbookReadout",null,[]);var Wa=a(472);let Na=class{constructor(X,la,sa){this.ANf=()=>{this.s9d.r0f();this.ariaLiveNotifier.setEnabled(!0)};
this.$=la;this.ariaLiveNotifier=X;this.s9d=new Ba(X,la);this.Ffc=sa.mod(this.$);this.Ffc.uXg(this.ANf)}dispose(){this.Ffc&&this.Ffc.uyj(this.ANf);this.Ffc=this.ariaLiveNotifier=this.$=null}};Na=Object(Xa.b)([Object(R.d)(Y.z),Object(Xa.c)(0,Object(Wa.AriaLiveNotifierService)()),Object(Xa.c)(1,Object(Y.A)()),Object(Xa.c)(2,Object(Y.mb)())],Na);Object(e.a)(Na,"EmbeddedWorkbookReadoutHandler",null,[2]);let ta=class{constructor(X,la){this.AX=()=>{this.pe||this.DAe()};this.pe=!1;this.E_=la.z_;this.ariaLiveNotifier=
X;this.s9d=new Ba(X,la);this.E_&&this.E_.nS?this.DAe():this.mj()}dispose(){this.oj();this.ariaLiveNotifier=this.E_=null;this.pe=!0}mj(){if(this.E_){this.E_.jt(this.AX);this.E_.Ca.rw(this.AX);this.E_.KF(this.AX);var X=Object(aa.a)(221,this.E_);X&&(X.wc.ao(this.AX),X.ga.gp(this.AX),X.ga.add_activeCellChanged(this.AX),X.ga.Sa.RQ(this.AX))}else h.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}oj(){if(this.E_){this.E_.Ca.Vw(this.AX);this.E_.dH(this.AX);
const X=Object(aa.a)(221,this.E_);X&&(X.wc.Un(this.AX),X.ga.Gp(this.AX),X.ga.remove_activeCellChanged(this.AX),X.ga.Sa.b2(this.AX))}}DAe(){this.s9d.r0f();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.PMj();this.dispose()}};ta=Object(Xa.b)([Object(R.d)(Y.Ab),Object(Xa.c)(0,Object(Wa.AriaLiveNotifierService)()),Object(Xa.c)(1,Object(Y.A)())],ta);Object(e.a)(ta,"WorkbookReadoutHandler",null,[2]);class V extends d.a{constructor(X){super();this.$=X;this.kc()}create(){const X=Ga.GetServiceTaskFactory.Za(this.$.da,
211,212,this.La);if(this.$.HG){const la=Object(bb.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(L.d)(R.a.resolve(Y.mb,{Wa:this.La})):Ga.GetServiceTaskFactory.Za(this.$.da,12,477,this.La);J.TaskExtensions.za(J.TaskExtensions.ke([X,la],this.$.ka),()=>{const sa=Object(Da.a)(this.$.da,228,()=>new Na(X.result,this.$,la.result));this.Pb(sa)},this.$.ka,3)}else J.TaskExtensions.za(X,la=>{const sa=Object(Da.a)(this.$.da,228,()=>new ta(la.result,this.$));this.Pb(sa)},this.$.ka,3)}static la(X){X.da.Ja(229,
new V(X))}}Object(e.a)(V,"WorkbookReadoutHandlerFactory",d.a,[]);a.d(C,"a",function(){return ia});const ia=()=>{b.a.Fa(X=>{Q.la(X);f.EwaSettings.Tb()?W.la(X):I.la(X);Za.la(X);Object(bb.b)("OfficeVSO:7641163_MigratingWorkbookReadoutHandlerService")||V.la(X)})};String(c);String(u);window.___1684305474253_closurehack=c;window.___1684305474253_closurehack=u},1206:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(119),e=a(15),d=a(1421),h=a(655),l=a(559),k=a(31),n=a(92),v=a(34),x=a(170),w=a(9),r=a(61),
t=a(166),A=a(356),y=a(51),z=a(48),E=a(33),G=a(1),F=a(23),O=a(16),M=a(109),P=a(126),B=a(88),D=a(157),I=a(6),S=a(14),J=a(102),L=a(50),R=a(1166);class Y extends D.a{constructor(mb,sb=!0){super(!1,!1,Y.ew);this.F_a=null;this.tfe=!1;this.Zn=[];this.xk=null;this.M2b=mb;this.FNg=sb;this.yy=this.jse=!1;this.Nia=null;this.hQc=!1;this.Eg=this.mxh;this.Te="InsertFileDialog";this.Hc(1,this.i3b);Y.ew?(this.F_a={["id"]:this.Te,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,
["onExecute"]:Object(B.a)(this,this.udj,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(B.a)(this,this.g5i,"onFrameReady")},this.initializeAndShow(this.titleText,Object(B.a)(this,this.Hlc,"insertDialogHandler"),this.F_a),this.cYb=!0):(this.showDialog(this.titleText,Object(B.a)(this,this.Hlc,"insertDialogHandler")),sb&&this.afg(),(mb=this.pL(1))&&this.Zn.push(mb),(mb=this.pL(0))&&this.Zn.push(mb),this.Ftg(),this.cYb=!1)}get lhk(){return this.M2b}validate(){this.xk.nG||
e.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.xk.nG.value?!0:(Y.kB(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}g5i(mb){this.FNg&&(this.xk=this.$eg(mb,this.M2b))}udj(){this.xk&&this.xk.nG&&(this.tfe||(this.xk.luj(Object(B.a)(this,this.mJd,"onFileChosen")),this.tfe=!0),this.xk.j3e())}mJd(mb){this.F_a.uploadStatusLabel=mb;this.jXa(this.titleText,Object(B.a)(this,this.Hlc,"insertDialogHandler"),this.F_a)}Hlc(mb){1===mb&&this.isEnabled()?Y.ew&&this.xk.nG&&
!this.xk.nG.value?(this.F_a.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.jXa(this.titleText,Object(B.a)(this,this.Hlc,"insertDialogHandler"),this.F_a)):(this.L8a(),this.M2b.finalizeUpload(this.xk,Object(B.a)(this,this.dispose,"dispose"))):0===mb&&this.hide()}afg(){this.hQc=!1;this.xk=this.$eg(document.getElementById("uploadFrameContainer"),this.M2b);I.AFrameworkApplication.fa.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Nia=Object(B.a)(this,this.WKd,"onUploadFrameLoad"),
L.a.addHandler(this.xk.iFrame,"load",this.Nia));this.xk.nG||e.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.vYf()}WKd(){this.vYf()}vYf(){if(this.xk&&!this.hQc){var mb=this.xk.nG;mb&&(L.a.addHandler(mb,S.a.yc,Object(B.a)(this,this.onKeyDown,"onKeyDown")),mb=[mb],this.Zn=mb.concat.apply(mb,this.Zn),this.Ftg(),this.hQc=!0)}}dispose(){if(this.xk&&!Y.ew){const mb=this.xk.nG;mb&&L.a.removeHandler(mb,S.a.yc,Object(B.a)(this,this.onKeyDown,"onKeyDown"));this.Nia&&L.a.removeHandler(this.xk.iFrame,
"load",this.Nia)}this.xk=null;super.dispose()}Ftg(){if(0<this.Zn.length){const mb=new R.a(this.Zn),sb=J.FocusManager.instance().WR();sb&&(this.Zn[0].focus(),sb.Qf=mb,sb.i1=!0)}}onKeyDown(mb){4!==J.FocusManager.instance().yYf(mb)&&mb.preventDefault()}static get ew(){return I.AFrameworkApplication.sa.Qa.Qw&&I.AFrameworkApplication.sa.Qa.utf}static kB(mb){const sb=document.getElementById("errorText");sb.innerText=mb;sb.style.display="inline-block"}}Object(u.a)(Y,"InsertFileDialog",D.a,[]);class Q{static get Eg(){return D.a.$p(Q.Sl,
CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Q.Sl="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(u.a)(Q,"InsertImageDialogHtml",null,[]);class W extends Y{constructor(mb,sb=!0){super(mb,sb)}get i3b(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get mxh(){return Q.Eg}validate(){this.xk.nG||
e.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");const mb=Object(P.a)(d.a,this.lhk),sb=mb.Nvg(this.xk.nG.value);return 0!==sb?(Y.kB(mb.h$e(sb)),!1):!0}}Object(u.a)(W,"InsertImageDialog",Y,[]);var Ga=a(564);const pa=(mb,sb,Ya)=>{if(mb){var Ma=0;do{try{mb();break}catch(xb){if(e.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",Ma,Ya,xb.message,xb.stack),Ma>=sb)break}Ma++}while(1)}};var aa=a(112),Z=a(93),fa=
a(43),ya=a(264),Aa=a(172),ja=a(82),za=a(470),ra=a(185);class fb{constructor(mb,sb,Ya,Ma,xb,qb,Ra,Jb,yb=!0,Gb=null,ub=!1){this.q3e="FileUpload.ashx";this.$o=null;this._initialized=!1;this.yh=this.Pmb=this.gQc=this.Nia=this.CYb=this.Yr=this.hu=null;this.Bn=!1;this.qF=this.DYb=this.J_c=null;this._parent=mb;this.tIg=sb;this.YMg=Ya;this.Zfe=xb;this.IYc=Ra;this.S$d=Jb;this.Wbe=Gb;this.I_c=!1;this.RIg=Ma.ra("CanaryRenewalForFileUploadIsEnabled");this.Xug=!1;(this.Bta=ub)||this.Nlh(qb);yb&&this.Nmf()}get S7f(){return this.YMg}get sessionId(){return this.IYc}get iFrame(){return this.$o}get nG(){return this.Yr}get dcb(){return I.AFrameworkApplication.fa?
I.AFrameworkApplication.fa.ra("NativeFileOpenDialogIsEnabled"):!1}get k3e(){return I.AFrameworkApplication.fa?I.AFrameworkApplication.fa.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}get ODi(){return this.Bta?!1:Aa.b(this.$o.contentWindow.location.pathname,this.q3e,0)}get X_g(){return!k.a.Bza&&I.AFrameworkApplication.fa.ra("AllowMultipleImageInsertFromLocalDevice")}Nmf(){this.qF=ra.a.create().toString();this.Bta?this.Cfd():this.e1g()}Nlh(mb){this.$o=document.createElement("iframe");this.$o.className=
mb;this.$o.id=mb;this.Zfe&&(this.$o.style.visibility="visible",this.$o.style.height="30px",this.$o.setAttribute("frameborder","0"));this.Nia=Object(B.a)(this,this.WKd,"onUploadFrameLoad");L.a.addHandler(this.$o,"load",this.Nia)}mcc(mb=null){I.AFrameworkApplication.sa.Bxc();if(!this.Yr)return e.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";L.a.addHandler(this.Yr,"change",()=>{this.uRh(mb)});pa(Object(B.a)(this,this.j3e,"fileInputClick"),1,"DoFileOpenDialog");return this.Yr.value}uRh(mb){mb&&
mb(this.Yr.value)}vRh(){this.CYb&&(this.CYb.innerText=this.Eaf())}luj(mb){L.a.addHandler(this.Yr,"change",()=>{mb(this.Eaf())})}Eaf(){let mb=null;if(this.Yr.value){const sb=this.Yr.value,Ya=sb.lastIndexOf("\\");0<Ya&&(mb=sb.substring(Ya+1,sb.length))}return mb?mb:""}j3e(){try{e.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Yr.click()}catch(mb){throw e.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",mb.message),mb;
}}d3j(){this.mHi()?this.amg():(this.x7d(),this.hu.submit())}mHi(){return(this.RIg||this.Bta)&&!(void 0===window.self.FormData||null===window.self.FormData)}nbg(mb){if(mb){const sb=this.bOe();this.yh=new XMLHttpRequest;this.yh.open("POST",sb);this.yh.setRequestHeader("X-CorrelationId",this.qF);this.NPi(mb);this.yh.onreadystatechange=Object(B.a)(this,this.Fra,"uploadResponseReceived");this.yh.send(mb)}}NPi(mb){if(!k.a.Bza&&mb.get){var sb=mb.get("ImageId");mb=window.self.navigator;sb={["CorrelationId"]:this.qF,
["Canary"]:I.AFrameworkApplication.canary,["ImageNodeId"]:sb};mb&&(mb=mb.connection?mb.connection:mb.mozConnection?mb.mozConnection:mb.webkitConnection?mb.webkitConnection:null)&&(sb.effectiveType=mb.effectiveType,sb.downlink=mb.downlink,sb.type=mb.type,sb.rtt=mb.rtt);e.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",sb)}}amg(){try{this.x7d();e.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const mb=new (Type.parse("FormData"))(this.hu);
this.nbg(mb)}catch(mb){e.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+mb.message),this.odb(null)}}$lg(mb){try{if(this.x7d(),e.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.hjk(mb)){this.DYb=mb;this.hu.contains(this.Yr)&&this.hu.removeChild(this.Yr);var sb=new (Type.parse("FormData"))(this.hu);sb.append("applicationfileInput",mb.blob,mb.filename);this.nbg(sb)}else this.odb(null)}catch(Ya){e.ULS.sendTraceTag(591267743,
322,10,"SubmitFormWithBlob failed to send the request with exception "+Ya.message),this.odb(null)}}hjk(mb){return mb&&void 0!==mb.blob&&null!==mb.blob&&void 0!==mb.filename&&null!==mb.filename&&""!==mb.filename?void 0===window.self.FormData||null===window.self.FormData?(e.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(mb=mb?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===mb.blob||null===mb.blob,void 0===mb.filename||null===mb.filename||
""===mb.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",e.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",mb)),!1)}Fra(){if(4===this.yh.readyState)if(200===this.yh.status){e.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.qF);const mb=this.yh.getResponseHeader("X-NewKey"),sb=this.kzi(this.yh);let Ya=!1;if(void 0!==mb&&null!==mb&&sb&&(Ya=this.Vik(mb),!this.I_c&&
Ya)){e.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.qF);this.I_c=!0;void 0!==this.DYb&&null!==this.DYb?this.$lg(this.DYb):this.amg();return}e.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.I_c,sb,!(void 0===mb||null===mb),Ya,this.qF);this.odb(this.yh.responseText)}else e.ULS.sendTraceTag(42874946,
322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.yh.status,this.yh.responseText?!1:!0,this.qF),this.odb(null)}kzi(mb){try{const sb=fa.a(mb.responseText).Responses;if(void 0!==sb&&null!==sb&&1===sb.length){const Ya=sb[0];if(void 0!==Ya&&null!==Ya&&2===Ya.length&&28===Ya[1].StatusCode)return!0}}catch(sb){}return!1}Vik(mb){za.a.Asg(mb);return I.AFrameworkApplication.canary!==mb?!1:!0}x7d(){this.J_c||(this.J_c=new Date)}dispose(){this.Bn||(this.Bta?this._parent.removeChild(this.hu):
(this._parent.removeChild(this.$o),L.a.removeHandler(this.$o,"load",this.Nia),this.Nia=null),this.gQc&&(L.a.removeHandler(this.Yr,"change",this.gQc),this.gQc=null),this.k3e&&(this.Pmb&&(L.a.removeHandler(this.Yr,"change",this.Pmb),this.Pmb=null),this.CYb=null),this.Yr=this.hu=this._parent=this.$o=null,this.Bn=!0,this.J_c=null,e.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}roh(mb){if(this.hu){var sb;(sb=this.hu.querySelector("input[name=__REQUESTDIGEST]"))?
sb.value=mb:(sb=this.Zad(),sb.type="hidden",sb.id="__REQUESTDIGEST",sb.name="__REQUESTDIGEST",sb.value=mb,this.hu.appendChild(sb))}}Zad(){return this.Bta?document.createElement("input"):this.$o.contentWindow.document.createElement("input")}WKd(){try{if(!this.$o.contentWindow.document.body)return}catch(sb){this.Xmi();return}if(!(this._initialized||this.dcb&&k.a.IG))this.Cfd();else if(!this.dcb||!k.a.IG||this.ODi){let sb;sb=k.a.Pw?this.$o.contentWindow.document.body.innerText:this.Xug?this.$o.contentWindow.document.body.firstChild.innerText:
this.$o.contentWindow.document.body.firstChild.innerHTML;var mb=this.$o.contentWindow.document.body.innerText.toLowerCase();const Ya=0<=mb.indexOf("responses")||0<=mb.indexOf("wopisrc");mb=0<=mb.indexOf("http error");!Ya&&mb&&e.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.$o.contentWindow.document.body.innerText);this.odb(sb)}}Cfd(){if(!this._initialized){var mb=this.ha("uploadForm");const sb=this.ha("fileInput"),Ya=this.bOe();this.Ynh();this.hu.id=
mb;this.hu.method="post";this.hu.encoding="multipart/form-data";this.hu.action=Ya;this.Yr.type="file";this.S$d&&(this.Yr.accept=this.S$d,this.Wbe&&(this.Yr.capture=this.Wbe));this.Yr.id=sb;this.Yr.name=sb;this.X_g&&(this.Yr.multiple=!0);!this.k3e||k.a.Pw||k.a.YI||(this.Pmb=Object(B.a)(this,this.vRh,"fileInputChangedHandleAccessibility"),L.a.addHandler(this.Yr,"change",this.Pmb),this.CYb=Z.a.fBe(this.hu,this.Yr,"InputFileDescription"));this.Zfe&&(this.Bta||(mb=this.$o.contentWindow.document.body,mb.style.margin=
"0",mb.style.overflow="hidden"),mb=I.AFrameworkApplication.sa,this.Yr.style.fontFamily=mb.W2,this.Yr.style.fontSize=mb.zIc,this.Yr.style.margin="0");(mb=document.getElementById("__REQUESTDIGEST"))&&this.roh(mb.value);this.hu.appendChild(this.Yr);this._initialized=!0;this.tIg(this)}}Ynh(){if(this.Bta)this.hu=document.createElement("form"),this._parent.appendChild(this.hu),this.Yr=document.createElement("input");else{this.hu=this.$o.contentWindow.document.createElement("form");const mb=this.$o.contentWindow.document;
mb.body.appendChild(this.hu);this.Yr=mb.createElement("input")}}e1g(){this._parent.appendChild(this.$o);this.dcb&&k.a.IG&&this.Cfd()}bOe(){var mb=new ya.QueryStringBuilder(this.q3e);I.AFrameworkApplication.Z0a(mb);this.wLj(mb);mb=mb.toString();if(k.a.ng||k.a.IG||k.a.YI)mb=ja.a.Wkd(mb);return mb}Sve(){const mb=new aa.a(2,1,0,Object(B.a)(this,this.delayedDispose,"delayedDispose"),4);I.AFrameworkApplication.Mi.jg(mb)}}Object(u.a)(fb,"UploadFrame",null,[2]);var Ua=a(47),Ca=a(120),Ia=a(20);class oa extends fb{constructor(mb,
sb,Ya,Ma,xb,qb,Ra=!1,Jb=!1){super(mb,sb,Ya,Ma,xb,"UploadFrame",qb.ea.sessionId,"image/*",!1,null,Ra);this.$=qb;this.Xug=!0;this.qzi=Jb;this.Nmf()}ha(mb){return mb}wLj(mb){e.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Ca.a.S3c(mb,this.$.xa);mb.C4(w.a.sessionId,this.sessionId);var sb=Ia.h(this.$).ga;sb=Ua.o(sb.pa.u6,this.$);mb.C4(w.a.vnj,this.$.ua.na.name);mb.C4(w.a.unj,sb.FirstRow.toString());mb.C4(w.a.tnj,sb.FirstColumn.toString());mb.C4(w.a.Rvi,this.qzi.toString())}Xmi(){this.S7f("ServerUploadError")}odb(mb){this.S7f(mb)}static vBi(mb){return!mb||
F.a.equals(mb,"ServerUploadError",!1)}}Object(u.a)(oa,"UploadFrameWrapper",fb,[]);class Da extends W{constructor(mb,sb,Ya,Ma){super(mb,!1);this.aW=null;this.ZDa=!1;this.oc=null;this.muc=()=>{this.H6d("");this.OIc();return!1};this.$=sb;this.bKc=mb;this.jS=Ga.a.instance;this.fa=Ya;this.oc=Ma;this.afg();this.hud();this.$.Ob.xz=!0}$eg(mb,sb){return new oa(mb,Object(B.a)(sb,sb.ELb,"onUploadFrameInitialized"),Object(B.a)(sb,sb.Fra,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.OIc();this.jS=
this.bKc=null;super.dispose()}hide(){super.hide();this.$.Ob.xz=!1}validate(){var mb=this.bKc.e8d(this.xk.nG.value,this.bKc.rqg(this.xk));return 0!==mb?(mb=this.bKc.zmd(mb).Description,this.H6d(mb),this.A2d(),!1):!0}isEnabled(){return!0}H6d(mb){var sb;null===(sb=this.oc)||void 0===sb?void 0:sb.Xcg(this.aW,mb)}hud(){this.aW=document.getElementById("errorText");this.aW.style.display="inline-block";this.ZDa=!1;this.H6d("");this.GLa.style.maxWidth=this.GLa.currentStyle.minWidth}A2d(){this.jS.ta(S.a.click,
this.xk.nG,this.muc);this.jS.ta(S.a.yc,this.xk.nG,this.muc);this.ZDa=!0}OIc(){this.ZDa&&(this.jS.Aa(S.a.click,this.xk.nG,this.muc),this.jS.Aa(S.a.yc,this.xk.nG,this.muc),this.ZDa=!1)}}Object(u.a)(Da,"InsertImageDialogWrapper",W,[]);var bb=a(55),Za=a(62),Xa=a(40),Ba=a(100),Wa=a(149),Na=a(36);class ta extends d.a{constructor(mb,sb,Ya,Ma,xb=!0){super(null,sb,Ya);this.hla=this.pH=null;this.Kvd=this.qab=!1;this.EMd=null;this.Fra=qb=>{this.d9d.stop();this.n6b.cancel();if(oa.vBi(qb))this.NHc?this.ohf(4):
(qb=new h.a(0,2,null,null,!1,null,null,null),qb.status=8,this.f5d(new l.a(qb),null,"InsertPictureWebMethod")),e.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.NHc}`);else{const Ra=ta.ojk(qb);0!==Ra?(e.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${qb}`),this.ohf(Ra)):this.Jmi(qb)}this.$vc();this.dispose()};this.z4i=qb=>{this.XEa(qb,this.xk)&&this.finalizeUpload(this.xk,null)};this.ELb=qb=>{e.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");
this.xk=qb;if(!this.k5a){if(this.F7d){if(this.cHe()||this.dcb&&k.a.IG){qb.mcc(this.z4i);return}const Ra=qb.mcc(null);if(!this.XEa(Ra,qb))return}this.finalizeUpload(qb,null)}};this.Scj=()=>{this.NHc=!0};this.Jb=mb;this.d9d=mb.nc.hh("WebServiceCall","InsertPictureOperation");this.n6b=y.a.instance.create(this.Scj,1E5,z.a.K4g,!1);this.NHc=!1;this.dsc=this.$.xa.InsertPictureMaxFileSizeBytes;Ma&&(this.qab="TestOnly"in Ma);Ma&&(this.Kvd="IsCellPicture"in Ma);xb&&this.showDialog()}get $(){return this.Jb}get kUi(){return this.dsc/
1024/1024}dispose(){n.a.Ka(this.n6b);this.xk&&this.xk.Sve();this.xk=this.n6b=this.Jb=null}jrj(mb){if(!this.$)return e.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Za.Task.Ua(!0);if(!this.$.Wda)return Za.Task.Ua(!0);const sb=new x.a,Ya=new FileReader;mb=mb.nG.files[0];const Ma=()=>{sb.ex(!0)};Ya.onload=()=>{this.EMd=Ya.result;sb.ex(!0)};Ya.onerror=Ma;Ya.onabort=Ma;Ya.readAsDataURL(mb);return sb.task}rqg(mb){let sb=-1;mb=mb.nG;(null===mb||void 0===mb?0:mb.files)&&
0<mb.files.length&&(sb=mb.files[0].size);return sb}e8d(mb,sb){let Ya=ta.Hkh(d.a.XEa(mb));0===Ya?-1!==sb&&(e.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${sb}, maxAllowedSize: ${this.dsc}, remainingWorkbookSize: ${this.$.ea.zxf}`),sb>this.dsc?Ya=3:sb>this.$.ea.zxf&&(Ya=7)):6===Ya&&this.XRi(mb);e.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${Ya}`);return Ya}XEa(mb,sb){mb=this.e8d(mb,this.rqg(sb));return 0!==mb?(this.k5a||1===mb||this.k0d(mb),!1):
!0}Mpg(mb){mb.d3j()}zmd(mb){let sb=0,Ya=1,Ma=-1100324317,xb="InsertPictureUnknownError",qb=null;switch(mb){case 1:sb=1758;Ya=0;Ma=940870981;xb="InsertPictureNoFileSelected";break;case 3:Ya=0;Ma=1250467391;xb="InsertPicturePictureTooBig";qb=String.format(O.a.instance.Lb(181),this.kUi.toLocaleString());break;case 6:sb=1762;Ya=0;Ma=1380041209;xb="InsertPictureUnsupportedFormat";break;case 7:sb=1759;Ya=0;Ma=-903115058;xb="InsertPictureExceedWorkbookSize";break;case 4:sb=1760;Ya=0;Ma=1218352119;xb="InsertPictureUploadTimeout";
break;case 5:sb=1761,Ya=0,Ma=1979899005,xb="InsertPictureServiceNonDeterministicError"}mb=ta.Od(sb,Ya,Ma,xb);qb&&(mb.Description=qb);return mb}showDialog(){if(this.cHe())this.k5a=!1,this.xk=new oa(this.$.domElement,this.ELb,this.Fra,this.fa,!1,this.$,!0,this.Kvd);else if(e.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.qab&&(k.a.Px||k.a.IG&&72>k.a.qJe))this.k5a=!1,this.xk=new oa(this.$.domElement,this.ELb,this.Fra,this.fa,!1,this.$);else{this.k5a=!0;const mb=Object(Ba.d)(Wa.a.resolve(Na.S,
{Wa:0}));Xa.TaskExtensions.za(mb,()=>{this.xk=(new Da(this,this.$,this.fa,mb.result)).xk},this.$.ka,3)}}Jmi(mb){let sb={};try{if(sb=r.a.Xi(mb),bb.b().OB(this.d9d.id,sb.ServerCorrelationId,"actions","ServerActions"),!E.a.Zf(sb.Errors)&&sb.Result&&(this.$.ea.KY(sb.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.Kvd)){const Ya=sb.Result;M.a(this.$).G9(1,Ya);const Ma=this.$.da.Ba(277);Ma&&Ma.B1c(this.$,1,sb.Result,sb,"InsertPicture");e.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Ya){e.ULS.sendTraceTag(526399113,
0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${mb?mb.length:-1}, errror: ${Ya}`)}this.oIc(sb,null,"InsertPictureWebMethod")}ohf(mb){mb=this.zmd(mb);const sb={};sb.Errors=[mb];this.oIc(sb,null,"InsertPictureWebMethod")}oIc(mb,sb,Ya){this.pH(mb,sb,Ya)}f5d(mb,sb,Ya){this.hla(mb,sb,Ya)}k0d(mb){mb=this.zmd(mb);G.EwaSettings.wz()?new A.a(this.$,mb):(new t.ErrorDialog(this.$,mb)).Rg()}XRi(mb){const sb=this.$.xa.InsertPicturUnsupportedExtensionsForLogging;
mb=v.a.kl(mb);for(let Ya=0;Ya<sb.length;++Ya)if(mb.endsWith(sb[Ya])){e.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${sb[Ya]}`);break}}static ojk(mb){return!mb||F.a.equals(mb,w.a.insertPictureUnknownError,!0)?2:F.a.equals(mb,w.a.insertPictureNoFileSelectedError,!0)?1:F.a.equals(mb,w.a.Qvi,!0)?3:F.a.equals(mb,w.a.Tvi,!0)?5:0}static Od(mb,sb,Ya,Ma){return E.a.Od(1,0,0,mb,sb,Ya,Ma)}static Hkh(mb){switch(mb){case 1:return 1;case 2:return 6}return 0}cHe(){return this.qab||
void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(u.a)(ta,"BasePictureUploaderWrapper",d.a,[2]);class V extends ta{constructor(mb,sb,Ya,Ma,xb,qb=!0){super(mb,sb,Ya,Ma,!1);this.ARh=xb;this.Vec=mb.nc.hh("LoadResource","FileReaderUploaderLoadResource");qb&&this.showDialog()}BXj(){this.dsc=28E5;this.k0d(3)}Gid(mb){e.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const sb=new FileReader;mb=mb.nG.files;if(0==mb.length)e.ULS.sendTraceTag(526399110,
0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Ya=mb[0];sb.onload=()=>{this.Vec.stop();this.ARh.ocj(sb.result,this);e.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${Ya.type}, Size:${Ya.size.toString()}`)};sb.onerror=()=>{this.Vec.stop();e.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${Ya.type}, Size:${Ya.size.toString()}`)};sb.onabort=()=>{this.Vec.stop();
e.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${Ya.type}, Size:${Ya.size.toString()}`)};this.Vec.start();sb.readAsDataURL(Ya)}}finalizeUpload(mb,sb){this.Gid(mb,sb)}}Object(u.a)(V,"FileReaderUploaderWrapper",ta,[416]);var ia=a(382),X=a(200);class la{constructor(mb,sb){this.dataUri=this.sheetName=null;this.sheetName=mb;this.dataUri=sb}getSheetName(){return this.sheetName}}Object(u.a)(la,"MacroRecorderPictureInsertedPayload",null,[139]);class sa extends ta{constructor(mb,
sb,Ya,Ma,xb,qb=!0){super(mb,Ya,Ma,xb,!1);this.Wd=sb;qb&&this.showDialog()}Gid(mb,sb){super.finalizeUpload(mb,sb);ia.a(this.$.userOperationManager,(Ya,Ma)=>{this.pH=Ya;this.hla=Ma;this.d9d.start();this.n6b.Zq();this.NHc=!1;this.Mpg(mb);return this.jrj(mb)},Ya=>{const Ma={};this.$.Fk(Ma);const xb=Ma.SheetName;Ya=new X.a(510,0,Ya,72,()=>new la(xb,this.EMd?this.EMd:""));Ya.xDa(()=>!0);Ya.Wd=this.Wd;return Ya},this.Wd)}finalizeUpload(mb,sb){this.Gid(mb,sb)}}Object(u.a)(sa,"PictureUploaderWrapper",ta,[]);
class Va{constructor(mb,sb){this.filename=mb;this.blob=sb}}Object(u.a)(Va,"UploadBlobParameters",null,[]);class nb extends sa{constructor(mb,sb,Ya,Ma,xb,qb,Ra){super(mb,sb,Ya,Ma,xb,!1);this.F7d=!1;this.XJ=Ra;this.alc=nb.EXh(qb);mb=this.e8d(this.alc.name,this.alc.size);0!==mb?(this.k0d(mb),this.XJ.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),this.dispose()):this.xk=new oa(this.$.domElement,this.ELb,this.Fra,Ma,!1,this.$)}f5d(mb,sb,Ya){super.f5d(mb,sb,Ya);this.XJ.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}oIc(mb,
sb,Ya){super.oIc(mb,sb,Ya);E.a.Zf(mb.Errors)?this.XJ.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${E.a.Ic(mb.Errors)}`)):this.XJ.setResult(!0)}Mpg(mb){const sb=new Va(this.alc.name,this.alc);mb.$lg(sb)}static EXh(mb){var sb=mb.split(",");mb=sb[0].includes("base64")?window.self.atob(sb[1]):window.self.decodeURI(sb[1]);sb=sb[0].split(":")[1].split(";")[0];const Ya=new Uint8Array(mb.length);for(let Ma=0;Ma<mb.length;Ma++)Ya[Ma]=
mb.charCodeAt(Ma);mb=new Blob([Ya],{type:sb});mb.name="Image.png";return mb}}Object(u.a)(nb,"DataUrlUploaderWrapper",sa,[]);let ha=class{constructor(){}zui(mb,sb,Ya,Ma,xb){-2060689045===sb.command&&(xb.IsCellPicture=!0);new sa(mb,sb,Ya,Ma,xb,!0)}yti(mb,sb,Ya,Ma,xb,qb){new nb(mb,null,sb,Ya,Ma,xb,qb)}Jti(mb,sb,Ya,Ma,xb){new V(mb,sb,Ya,Ma,xb,!0)}};ha=Object(f.b)([Object(Wa.d)(Na.yb)],ha);Object(u.a)(ha,"UploaderCreator",null,[398]);class jb extends b.a{constructor(mb){super();this.$=mb;this.kc()}static la(mb){mb.da.Ja(485,
new jb(mb))}create(){var mb;this.Pb(null!==(mb=this.$.da.Ba(484))&&void 0!==mb?mb:this.$.da.Ja(484,new ha))}}Object(u.a)(jb,"UploaderCreatorFactory",b.a,[]);var Fb=a(71);a.d(C,"a",function(){return Rb});const Rb=()=>{c.a.Fa(mb=>{Object(Fb.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")||jb.la(mb)})}},1209:function(u,C,a){u=a(0);var c=a(88),b=a(562),f=a(15);class e{constructor(){this.dMc={}}oRg(za){this.dMc[za.id.toString()]=za}aZi(za){const ra=this.dMc;for(let fb in ra)ra[fb].notify(za,
!1);this.dMc={}}Bnj(za,ra){ra&&this.oRg(ra);return this.iQf(za,ra)}gfd(za){this.aZi(za)}IWe(za,ra){za.notify(ra,!0)}}Object(u.a)(e,"AEventEmitter",null,[390]);var d;(function(za){za[za.notStarted=0]="notStarted";za[za.waiting=1]="waiting";za[za.shouldRetry=2]="shouldRetry";za[za.complete=3]="complete"})(d||(d={}));Object(u.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(za){f.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],
["NewState"]:d[za]},"ResultType",this.zdf());this._state=za}}Object(u.a)(h,"AEventResult",null,[431]);class l extends h{constructor(){super();this.EZc=this.mpb=null;this.state=0;this.sSc=this.Dhe=!1}get ZS(){return this.mpb}get Rqa(){return this.EZc}get lwi(){return this.Dhe}zdf(){return"GetMoreInfo Result"}}Object(u.a)(l,"GetMoreInfoResult",h,[443,431]);var k=a(6),n=a(82),v=a(41),x=a(714),w=a(384),r=a(178),t=a(666),A=a(588),y=a(111),z=a(26);class E{constructor(za,ra,fb,Ua,Ca,Ia,oa,Da){this.Na=za;
this.lh=ra;this.WCg=fb;this.o3=Ua;this.Ce=Ca;this.VQc=Ia;this.IHg=oa;this.j2b=Da}itj(){this.jcb.xc(z.a.openUrlInNewTab,y.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.jcb.xc(z.a.zSa,y.a.frame,Object(c.a)(this,this.zSa,"openDocumentUrl"));k.AFrameworkApplication.HN?this.jAf():this.jcb.ef(z.a.wcc,y.a.frame,Object(c.a)(this,this.wcc,"documentLoaded"),96)}openUrlInNewTab(za,ra,fb,Ua,Ca){Ca&&Ca.MenuItemId&&(f.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:Ca.SourceControlId,
["AppType"]:A.a[this.NS]}),v.a.Jf(Ca.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}zSa(za,ra,fb,Ua,Ca){if(Ca&&Ca.MenuItemId){const Ia=k.AFrameworkApplication.fa.ra("WacInTabOpenMRUIsEnabledForUiHost"),oa=k.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");f.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Ia,oa);if(Ia&&oa){f.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Ca.SourceControlId,
["AppType"]:A.a[this.NS]});za=Ca.MenuItemId.toString();const Da={};Da[w.a.zTa]="1";Da[w.a.documentUrl]=za;Da[w.a.reason]=t.a.open;f.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");k.AFrameworkApplication.cS().execute(bb=>{bb.sendMessage(r.a.O_,Da)})}else this.openUrlInNewTab(za,ra,fb,Ua,Ca)}return 32}wcc(){this.jAf();return 32}eRa(za,ra,fb=""){if(ra&&ra.CG){const Ua=x.a[ra.status];ra=ra.CG.getTime();const Ca=this.Jx()-ra;f.ULS.sendTraceTag(5849679,202,50,
"Making request to the WAC server {0}",{["Caller"]:za,["RequestStatus"]:Ua,["ElapsedMs"]:Ca,["StartTime"]:ra,["Notes"]:fb})}else f.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:za})}jAf(){var za=k.AFrameworkApplication.fa.ra("QPGVCI"),ra=n.a.mz(document.URL,"wdNewAndOpenCt",za);if(ra){ra=parseInt(ra);var fb=n.a.mz(document.URL,"wdPreviousSession",za);za=n.a.mz(document.URL,"wdPreviousCorrelation",za);var Ua=k.AFrameworkApplication.fa.ra("NAOPLP");
if(k.AFrameworkApplication.HN){var Ca=k.AFrameworkApplication.HN.getTime();!ra||ra>Ca?f.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:ra,["DocumentLoadedTime"]:Ca,["SessionId"]:fb,["Correlation"]:za}):f.ULS.sendTraceTag(5849683,202,Ua?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:Ca-ra,["ClickTimestamp"]:ra,["SessionId"]:fb,["Correlation"]:za})}else f.ULS.sendTraceTag(5849681,
202,Ua?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:ra,["SessionId"]:fb,["Correlation"]:za})}}get jcb(){return this.Na.value}get AJb(){return this.lh.value}get KFf(){return this.WCg.value}get NS(){return this.o3.value}get htc(){return this.Ce.value}get Jx(){return this.VQc}get s1(){return this.IHg.value}get supportsGetMoreInfoForPersonalStorage(){return this.j2b.value}static get instance(){return E.Oa||(E.Oa=
E.SN())}static SN(){return new E(new b.a(()=>k.AFrameworkApplication.Qb),new b.a(()=>k.AFrameworkApplication.de),new b.a(()=>k.AFrameworkApplication.sa),new b.a(()=>k.AFrameworkApplication.sa.Qa.Ii),new b.a(()=>k.AFrameworkApplication.Mi),()=>(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.sa.Qa.s1),new b.a(()=>k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}E.Oa=null;Object(u.a)(E,"NewAndOpenCommonHelpers",null,[389]);var G=a(112);class F{constructor(za,ra,fb){this.u1b=
this.Jj=null;this.OXc=0;this.ANg=za;this.Ce=ra;this.Pde=fb}k_g(){this.OXc=this.rgb+1}lUd(za){this.Jj&&(this.Ce.Zp(this.Jj),this.Jj=null);za&&(this.OXc=0)}C1j(za){const ra=this.V6j;0<=ra?(this.k_g(),this.lUd(!1),this.Jj=new G.a(4,1,ra,za,107),this.Ce.jg(this.Jj)):(this.lUd(!0),f.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Pde}))}get rgb(){return this.OXc}get V6j(){return this.rgb>=this.Ebg.length?-1:this.Ebg[this.rgb]}get Ebg(){if(!this.u1b){const za=(this.ANg.value||"0").split(",");
this.u1b=[];for(let ra=0;ra<za.length;ra++){const fb=parseInt(za[ra]);isNaN(fb)?f.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Pde,["Entry"]:za[ra]}):Array.add(this.u1b,fb)}}return this.u1b}}Object(u.a)(F,"RetryHelper",null,[]);var O=a(43),M=a(34);class P extends e{constructor(za,ra){super();this.Y3=za;this.Lpb=new F(ra,this.dJb.htc,"GetMoreInfo");this.Qp=new l}kTi(){this.JEd("Document opened")}Yoh(za){return()=>{this.JEd(za,!0)}}iQf(za,ra=
null){f.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:za});3===this.Qp.state?(ra&&this.IWe(ra,this.Qp),f.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:za})):this.JEd(za);return this.Qp}JEd(za,ra=!1){this.Lpb.lUd(!ra);1===this.Qp.state?f.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:za,["RetryIndex"]:this.Lpb.rgb}):(f.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",
{["Trigger"]:za,["RetryIndex"]:this.Lpb.rgb}),this.Qp.state=1,ra=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.dJb.s1,k.AFrameworkApplication.ej),this.dJb.AJb.$aa(ra,1,null,null,[P.Vne,P.Tre],!1,5,this.eoh(),this.doh(za),null))}eoh(){return za=>{var ra=!1;let fb=!1;var Ua=!1,Ca;k.AFrameworkApplication.fa.ra("GetMoreInfoDataFromResponseBody")&&(za.data.Fe?({qt:Ca}=O.d(za.data.Fe)).returnValue?Ca?(Ua=!0,this.Qp.EZc=Ca.StorageServiceDisplayName,this.Qp.mpb=P.Gvf(Ca.PersonalFileStorageUrl)?Ca.PersonalFileStorageUrl:
"",""===this.Qp.ZS&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Va("FileSource")&&(this.Qp.mpb=n.a.Mfa(k.AFrameworkApplication.breadcrumbFolderUrl)),ra=""===this.Qp.ZS&&""!==this.Qp.Rqa):f.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):f.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):f.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));Ua||((Ca=za.data.responseHeaders)?(this.Qp.EZc=(Ca[P.Tre]||"").toString(),ra=(Ca[P.Vne]||"").toString(),this.Qp.mpb=P.Gvf(ra)?ra:"",""===this.Qp.ZS&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Va("FileSource")?(this.Qp.mpb=n.a.Mfa(k.AFrameworkApplication.breadcrumbFolderUrl),ra=""===this.Qp.ZS&&""!==this.Qp.Rqa):ra=""===ra&&""!==this.Qp.Rqa):(f.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),fb=!0));Ua=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.Lpb.rgb,fb,ra,Ua);this.dJb.eRa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",za.data,Ua);this.Vbg(3,ra,fb)}}doh(za){return ra=>{this.dJb.eRa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",ra.data,"Failure");this.Vbg(2);this.Lpb.C1j(this.Yoh(za))}}Vbg(za,ra=!1,fb=!1){this.Qp.state=za;this.Qp.Dhe=
ra;this.Qp.sSc=fb;this.gfd(this.Qp)}get dJb(){return this.Y3.value}static get instance(){return P.Oa||(P.Oa=P.SN())}static SN(){return new P(new b.a(()=>E.instance),new b.a(()=>k.AFrameworkApplication.Q9h))}static Gvf(za){if(!za)return f.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(M.a.kl(za).startsWith("https://"))return!0;f.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}P.Vne="PersonalFileStorageUrl";P.Tre=
"StorageServiceDisplayName";P.Oa=null;Object(u.a)(P,"GetMoreInfoActor",e,[]);var B=a(108),D=a(105);class I{constructor(za,ra,fb,Ua,Ca){this.nIg=6E4;this.Klf="inactive";this.Mue="active";this.tU=!0;this.Ce=za;this.oHg=ra;this.VQc=fb;this.A2b=Ua;this.$a=new D.a;Ca&&this.u1j();this.Ije=this.Vaf()}Bve(za){this.$a.addHandler(this.Mue,za)}MTg(za){this.$a.addHandler(this.Klf,za)}u1j(){const za=new G.a(5,2,this.nIg,Object(c.a)(this,this.fri,"inactiveLoop"),108);this.gri.jg(za)}fri(){const za=this.Vaf(),ra=
this.Jx()-za;ra>this.KHc&&this.tU&&(f.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ra}),this.tU=!1,this.$a.raiseEvent(this.Klf));za-this.Ije>this.KHc&&(this.tU=!0,this.$a.raiseEvent(this.Mue));this.Ije=za}get gri(){return this.Ce.value}get Vaf(){return this.oHg}get Jx(){return this.VQc}get KHc(){return this.A2b.value}static get instance(){return I.Oa||(I.Oa=I.SN())}static SN(){return new I(new b.a(()=>B.a.instance),()=>k.AFrameworkApplication.DBd.getTime(),()=>
(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.KHc),!0)}}I.Oa=null;Object(u.a)(I,"InactivityManager",null,[]);var S=a(126),J=a(955);class L extends h{constructor(){super();this.Tle=this.Vle=this.Ule=null;this.state=this.Mse=0;this.sSc=!1}get hGd(){return this.Ule}get WEf(){return this.Vle}get gGd(){return this.Tle}get a7j(){return this.Mse}zdf(){return"MruActor Result"}}Object(u.a)(L,"MruResult",h,[430,431]);var R=a(249);class Y{constructor(za,ra,fb){this.task=null;this.ulc=za;this.TUi=
ra;this.taskManager=fb;this.retryCount=this.XDb=0;this.aXc=this.nHb=null}gFi(za,ra){return za===R.a.Njd||20===ra||18===ra||3===ra}yGi(za){return 3===za||5===za||6===za||7===za||9===za||10===za||11===za||12===za||13===za||14===za||15===za||16===za||23===za||26===za||27===za||28===za}get Rxc(){return this.aXc}reset(){this.XDb=this.retryCount=0;this.aXc=this.nHb=null;this.task&&(this.taskManager.Zp(this.task),this.task=null)}qvi(za,ra,fb,Ua){this.aXc=String.format("{0}_{1}",fb,Ua);if(this.retryCount>=
this.TUi)return f.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.gFi(fb,Ua))return f.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.yGi(Ua)&&1<=this.XDb)return this.nHb=fb,!1;ra=Math.max(ra,this.ulc*Math.pow(2,this.XDb));if(26===Ua)ra=Math.max(ra,3E4);else if(27===Ua||28===Ua)ra=Math.max(ra,6E4);9===Ua||412===fb&&(null==this.nHb||412!==this.nHb)?ra=500:this.XDb+=1;this.nHb=fb;this.retryCount+=1;this.task&&this.taskManager.Zp(this.task);
f.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ra);this.task=new G.a(2,1,ra,za,107);this.taskManager.jg(this.task);return!0}}Object(u.a)(Y,"RetryManager",null,[]);var Q=a(103),W=a(147),Ga=a(140);class pa{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(u.a)(pa,"WriteOptions",null,[]);var aa=a(569),Z=a(184);class fa extends e{constructor(za,ra,fb,Ua,Ca,Ia,oa){super();this.Y3=za;this.iKg=ra;this.Pta=new Y(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.QE.htc);this.sua=new Y(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.QE.htc);this.AMg=fb;this.gue=Ua;this.JQg={};this.wU=new L;this.kHg=Ca;this.G_b="";this.lx=Ia;this.See=oa}get kLc(){return this.JQg}fvj(){this.QE.jcb.xc(z.a.renameMostRecentlyUsedFileEntry,
y.a.frame,Object(c.a)(this,this.bAj,"renameMruEntry"))}bAj(){return this.z9d("Rename")}uTi(){this.WCf("File Opened")}vTi(){this.WCf("IntervalUpdate")}WCf(za){f.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:za});this.z9d(za)}A6(za){(za=M.a.A6(za))&&za.startsWith(".")&&(za=za.substring(1,za.length));return za}H7e(){switch(this.QE.NS){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Ahi(za){var ra=
this.kHg();if(!ra)return null;const fb=new pa;fb.documentUrl=this.See.value?encodeURI(ra):ra;fb.mruItemId=this.G_b;fb.app=this.H7e();if(ra=this.lx())fb.folderName=ra.breadcrumbFolderName,ra=ra.co,fb.documentName=M.a.Jq(ra),fb.documentExt=this.A6(ra);za&&(fb.documentName?fb.documentName.length?255<=fb.documentName.length?za.set("DocumentNameLength","Long"):2084<=fb.documentName.length&&za.set("DocumentNameLength","VeryLong"):za.set("DocumentNameLength","0"):za.set("DocumentNameLength","Null"));return JSON.stringify(fb)}z9d(za,
ra=!1){if(4===this.QE.NS&&!k.AFrameworkApplication.Bwa)return 2;var fb=W.a.ot();fb&&(fb.set("Trigger",za),fb.set("IsRetry",ra?"true":"false"),fb.set("MruIdSent",this.G_b?"true":"false"),fb.set("URLEncoded",this.See.value?"true":"false"));Q.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",fb);za=this.Ahi(fb);if(!za)return ra=!k.AFrameworkApplication.webEditingEnabled,fb&&(fb.set("WebEditingIsEnabled",k.AFrameworkApplication.webEditingEnabled?"true":"false"),fb.set("ProtectedFile",k.AFrameworkApplication.cyc?
"true":"false")),Q.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ra,!1,Object.assign(new Z.a,{extendedProperties:fb})),2;this.sua&&!ra&&this.sua.reset();fb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.QE.s1,this.localeName);this.gue?this.kLc["X-FileId"]=k.AFrameworkApplication.ej:fb+=String.format("&{0}",k.AFrameworkApplication.ej);k.AFrameworkApplication.Nc&&(this.kLc["X-Office-AudienceGroup"]=Object(S.a)(String,k.AFrameworkApplication.Nc.AudienceGroup)||"");this.kLc["X-Timeout"]=
15E3;return this.QE.AJb.Fn(fb,2,za,this.kLc,!0,5,Object(c.a)(this,this.Plk,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.Jsh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}Plk(za){this.Thf(za.data)}Thf(za){const ra=W.a.ot();this.sua&&(ra&&this.sua.Rxc&&(ra.set("LastError",this.sua.Rxc),ra.set("NumRetries",this.sua.retryCount.toString())),this.sua.reset());const fb=J.c(za.Fe);fb&&fb.diagnostics_data&&(this.G_b=fb.diagnostics_data.mru_id);za=
+za.q5-+za.CG;ra&&ra.set("RequestDuration",za.toString());Q.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Z.a,{extendedProperties:ra}))}Jsh(za){if(za.data.httpStatus===R.a.Iwb)this.Thf(za.data);else{var ra=za.data.httpStatus===R.a.LMb,fb=W.a.ot();this.eif(this.sua,za,this.vsh(),fb);fb&&(fb.set("StatusCode",za.data.httpStatus.toString()),ra||this.s1c(za.data,fb));Q.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",za.data.httpStatus),ra,!1,Object.assign(new Z.a,
{extendedProperties:fb}))}}vsh(){return()=>{this.z9d("Retry",!0)}}W9h(){this.Xrc("Polling")}V9h(){this.Xrc("Retry",!0)}mTi(){this.Xrc("Open")}lTi(){this.Xrc("Activity")}Xrc(za,ra=!1){f.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:za});const fb=W.a.ot();fb&&(fb.set("Trigger",za),fb.set("IsRetry",ra?"true":"false"));Q.Health.instance.recordKpiUsage("GetMru",0,"smartfio",fb);this.Pta&&!ra&&this.Pta.reset();this.foh(Object(c.a)(this,this.Y9h,"getMruV2FromServerSuccessCallback"),
Object(c.a)(this,this.U9h,"getMruFromServerFailureCallback"))}s1c(za,ra){za&&za.responseHeaders&&(za=za.responseHeaders["X-CorrelationId"])&&ra.set("ServerCorrelationId",za)}XPi(za,ra){za&&(ra&&ra.set("RequestDuration",(+za.q5-+za.CG).toString()),Q.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Z.a,{extendedProperties:ra})))}Y9h(za){this.Z9h(za)}Z9h(za){var ra="";let fb=null,Ua=null,Ca=null;const Ia=J.c(za.data.Fe);Ia&&(fb=Ia.places?Ia.places.items:[],Ua=Ia.documents?Ia.documents.items:
[],(Ca=J.a(Ia,!1))&&(ra=O.c(Ca)));k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.X0&&Ga.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ra,!0));ra=W.a.ot();this.Pta&&(ra&&this.Pta.Rxc&&(ra.set("LastError",this.Pta.Rxc),ra.set("NumRetries",this.Pta.retryCount.toString())),this.Pta.reset());Ca||fb||Ua?(this.QE.eRa("MruActor.GetMruV2FromServerSuccessCallback",za.data,"Success"),this.KJc(3,Ca,fb,Ua),this.XPi(za.data,ra)):(this.QE.eRa("MruActor.GetMruV2FromServerSuccessCallback",
za.data,"Failure: Invalid JSON"),ra&&this.s1c(za.data,ra),Q.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Z.a,{extendedProperties:ra})),this.KJc(3,null,null,null,!0));this.gfd(this.wU)}eif(za,ra,fb,Ua){let Ca=0,Ia=0;const oa=J.c(ra.data.Fe);oa&&(null!=oa.response_code&&(Ca=oa.response_code,Ua&&Ua.set("MruResponseCode",Ca.toString()),9===Ca&&(this.G_b="")),oa.error_data&&null!=oa.error_data.retry_after_ms&&(Ia=oa.error_data.retry_after_ms,Ua&&Ua.set("ExpectedRetryAfter",
Ia.toString())));za&&(ra=za.qvi(fb,Ia,ra.data.httpStatus,Ca),Ua&&(Ua.set("CurrentRetryCount",za.retryCount.toString()),Ua.set("RetryScheduled",ra?"true":"false")))}U9h(za){this.X9h(za)}X9h(za){const ra=za.data.httpStatus===R.a.LMb,fb=W.a.ot();fb&&(fb.set("StatusCode",za.data.httpStatus.toString()),ra||this.s1c(za.data,fb));this.QE.eRa("MruActor.GetMruFromServerFailureCallback",za.data,"Failure");this.KJc(2);this.eif(this.Pta,za,Object(c.a)(this,this.V9h,"getMruFromServerRetryTask"),fb);Q.Health.instance.recordKpiFailure("GetMru",
String.format("RequestFailed_{0}",za.data.httpStatus),ra,!1,Object.assign(new Z.a,{extendedProperties:fb}));this.gfd(this.wU);k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.X0&&Ga.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}KJc(za,ra=null,fb=null,Ua=null,Ca=!1){if(3!==this.wU.state||3===za)this.wU.Ule=ra,this.wU.Vle=fb,this.wU.Tle=Ua,this.wU.state=za,this.wU.sSc=Ca,this.wU.Mse=this.QE.Jx()}iQf(za,
ra){f.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:za,["ResultState"]:this.wU.state});ra&&3===this.wU.state&&this.IWe(ra,this.wU);return this.wU}foh(za,ra){this.KJc(1);let fb;const Ua={};fb=String.format(this.QE.s1+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.H7e(),this.localeName);this.AMg.value||(fb+="&entity=docs");k.AFrameworkApplication.Nc&&(Ua["X-Office-AudienceGroup"]=Object(S.a)(String,k.AFrameworkApplication.Nc.AudienceGroup)||"");this.gue?
Ua["X-FileId"]=k.AFrameworkApplication.ej:fb+=String.format("&{0}",k.AFrameworkApplication.ej);this.QE.AJb.Fn(fb,1,null,Ua,!0,5,za,ra,null)}get QE(){return this.Y3.value}get localeName(){return this.iKg.value}static get instance(){return fa.Oa||(fa.Oa=fa.SN())}static SN(){return new fa(new b.a(()=>E.instance),new b.a(()=>aa.a.sL(k.AFrameworkApplication.lcid).name),new b.a(()=>k.AFrameworkApplication.sa.Qa.Qw),k.AFrameworkApplication.fa.ra("MruWriteFileIdInHeader"),()=>k.AFrameworkApplication.sa.Qa.Cx,
()=>k.AFrameworkApplication.kn,new b.a(()=>k.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")))}}fa.Oa=null;Object(u.a)(fa,"MruActor",e,[]);class ya{constructor(){this.Nqb=this.Voe=this.Db=null;this.Bn=!1}get name(){return"Common.App.NewAndOpen.Core"}Di(za){this.Db=za;za.register(389,"Common.INewAndOpenCommonHelpers").Uc().dd(()=>E.instance);za.register(390,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Uc().dd(()=>P.instance);za.register(390,"Common.IEventEmitter<Common.IMruResult>").Uc().dd(()=>
fa.instance)}init(){k.AFrameworkApplication.fa.Hv(()=>{this.HDb()})}HDb(){this.Db.resolve("Common.INewAndOpenCommonHelpers");this.Db.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Db.resolve("Common.IEventEmitter<Common.IMruResult>");var za=!1;E.instance.itj();k.AFrameworkApplication.toa&&(za=!0);k.AFrameworkApplication.i0f&&(fa.instance.mTi(),0<k.AFrameworkApplication.XEf&&this.fwe(),this.YRj(),za=!0);k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&za&&P.instance.kTi();
k.AFrameworkApplication.kfk&&(za=fa.instance,za.fvj(),za.uTi(),B.a.instance.jg(this.lfk))}YRj(){I.instance.Bve(Object(c.a)(fa.instance,fa.instance.lTi,"makeGetMruRequestActivityTrigger"));I.instance.Bve(Object(c.a)(this,this.fwe,"addGetMruFromServerTask"));I.instance.MTg(Object(c.a)(this,this.Gvh,"deleteGetMruFromServerTask"))}Gvh(){B.a.instance.Zp(this.YEf)}fwe(){B.a.instance.jg(this.YEf)}get YEf(){return this.Voe||(this.Voe=new G.a(5,2,k.AFrameworkApplication.XEf,Object(c.a)(fa.instance,fa.instance.W9h,
"getMruFromServerTask"),109))}get lfk(){return this.Nqb||(this.Nqb=new G.a(2,2,6E4*k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(fa.instance,fa.instance.vTi,"makeUpdateMruTask"),197))}dispose(){this.Bn||(this.Bn=!0,this.Nqb&&(B.a.instance.Zp(this.Nqb),this.Nqb=null))}}Object(u.a)(ya,"CorePackageManager",null,[4,5,2]);var Aa=a(260);a.d(C,"a",function(){return ja});const ja=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");
Aa.a.instance.nj(new ya)}},1225:function(u,C,a){var c=a(10);u=a(0);var b=a(722),f=a(170),e=a(108),d=a(6),h=a(30),l=a(198),k=a(15),n=a(1421),v=a(34),x=a(103),w=a(84),r=a(569),t=a(185),A=a(47),y=a(382),z=a(200),E=a(323),G=a(33),F=a(230),O=a(12),M=a(16),P=a(246),B=a(109),D=a(20),I=a(157),S=a(173),J=a(93),L=a(102),R=a(178),Y=a(195),Q;(function(sa){sa[sa.unknown=0]="unknown";sa[sa.bing=1]="bing";sa[sa.M365=2]="M365"})(Q||(Q={}));Object(u.b)("InsertMediaProviders",Q);var W=a(95),Ga=a(166),pa=a(356),aa=
a(1),Z=a(890),fa=a(82);class ya extends Z.a{constructor(sa,Va){super(sa,fa.a.wL(Va))}RNb(sa,Va){this.isEnabled()&&this.QQ(this.targetOrigin)&&(this.fn(sa),this.hl(sa,Va))}}Object(u.a)(ya,"InsertMediaCrossDocumentMessenger",Z.a,[439,355,2]);var Aa=a(2);class ja{}Object(u.a)(ja,"OnlineMediaSearchResult",null,[]);var za=a(325),ra=a(857),fb=a(355),Ua;(function(sa){sa[sa.OK=0]="OK";sa[sa.cancel=1]="cancel";sa[sa.error=2]="error";sa[sa.open=3]="open"})(Ua||(Ua={}));Object(u.b)("HubbleAction",Ua);var Ca=
a(69);class Ia extends I.a{constructor(sa,Va,nb,ha,jb,Fb){super();this.wnc=!1;this.correlationId=this.cCd=this.NC=this.Zya=null;this.q1i=()=>{this.gxa(this.L2a);this.JCc(1)};this.TAd=Rb=>{Rb.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Rb.target.id||Rb.shiftKey?"KeepFocusStartDiv"===Rb.target.id&&Rb.shiftKey&&(Rb.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Rb.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.z8i=()=>{this.Ksb&&(this.Ksb.launchUpsellExperience("stockimages"),
k.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.X9i=Rb=>{Rb&&Rb.Values&&(Rb=Rb.Values,delete Rb.m_Origin,delete Rb.m_Source,delete Rb.m_ReceivedTime,k.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+Rb.eventName||!1),S.a.sendOtelEvent(Object.assign(new ra.a,{otelEvent:Rb})))};this.tl=Fb;this.$=sa;this.$mf=Va;this.Ksb=nb;this.I9=[];this.Qbb=ha;this.nxh=jb;this.eAe=this.$.xa.InsertOnlinePictureMaxCountOfImagesToInsert;this.Eg=this.Doh()}aYj(sa){this.wnc=
!1;this.showDialog(this.tl,null);this.Zya=document.getElementById(this.wi("InsertMediaFrame"));if(!this.Zya)throw this.gxa(this.L2a),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Va=document.getElementById(this.wi("WACDialogPanel"));Va&&Va.setAttribute(J.a.fe,J.a.ftb);Va=document.createElement("div");Va.id="KeepFocusStartDiv";Va.tabIndex=0;Va.className="keep-focus-start";this.Zya.parentNode.insertBefore(Va,this.Zya.parentNode.firstChild);Va=document.createElement("div");Va.id="KeepFocusDiv";
Va.tabIndex=0;Va.className="keep-focus";this.correlationId=t.a.create();this.Zya.parentNode.appendChild(Va);$addHandler(this.GLa,"keydown",this.TAd);this.Zya.src=this.$mf;this.Zya.frameBorder="0";Va=document.getElementById(this.wi("WACDialogButtonPanel"));if(!Va)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Va.className="display-none";Va=document.getElementById(this.wi("WACDialogTitleText"));if(!Va)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Va.className=
"display-none";2===this.Qbb&&(document.getElementById(this.wi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.wi("WACDialogBodyPanel")).className="padding-zero");L.FocusManager.instance().WR().scope.yO=!0;this.NC=new ya(this.Zya.contentWindow,this.$mf);this.NC.QQ("https://osiziwuspersimmon002.blob.core.windows.net");this.NC.QQ("https://osizewuspersimmon001.blob.core.windows.net");this.NC.QQ("https://osizpscuspersimmon000.blob.core.windows.net");this.NC.QQ("https://cdn.hubblecontent.msit.osi.office.net");
this.NC.QQ("https://cdn.hubblecontent.osi.office.net");this.NC.RNb(R.a.qTg,nb=>{this.f0i(nb,sa.Fra)});this.NC.RNb(R.a.insert,()=>{this.M7i(sa.Fra)});this.NC.RNb(R.a.e7c,this.q1i);this.NC.RNb(R.a.RTg,nb=>{this.X9i(nb)});2===this.Qbb&&0===this.nxh&&(this.NC.RNb(R.a.gMi,this.z8i),this.cCd=this.Ksb.JTa("MsoPremiumStockImages",nb=>{k.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");nb.isEnabled?this.NC.sendMessage(R.a.fhk,{["LicenseTier"]:nb.toString()}):k.ULS.sendTraceTag(537155810,
0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.JCc(3)}dispose(){this.I9=null;this.Ksb&&this.cCd&&this.Ksb.xRd("MsoPremiumStockImages",this.cCd);this.NC&&(this.NC.dispose(),this.NC=null);super.dispose()}hide(){super.hide();W.a.vDc(this.$)}get v6(){return Y.a.Dbc+"/InsertMediaDialog"}get g_(){return!1}f0i(sa,Va){sa=sa&&sa.Values?(sa=sa.Values)?Object(Aa.a)(new ja,{Action:sa.action||"",Caption:sa.caption||"",ContentType:sa.contentType||"",FileExtension:sa.extension||
"",PageUrl:sa.pageUrl||"",SourceUrl:sa.sourceUrl||"",ThumbnailUrl:sa.thumbnailUrl||"",LicenseUrl:sa.licenseUrl||"",LicenseDisplayName:sa.licenseDisplayName||"",Height:sa.height||0,Width:sa.width||0}):null:null;sa&&(this.I9.push(sa),this.wnc&&(k.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Va(this.I9),this.wnc=!1,this.gxa(this.L2a)))}M7i(sa){this.I9&&0<this.I9.length?this.I9.length<=this.eAe?(sa(this.I9),this.JCc(0),this.gxa(this.L2a)):(this.kB(),
k.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.I9.length=0,this.JCc(2)):this.wnc=!0}Doh(){const sa=document.createElement("div");sa.id="InsertMediaDialog";sa.className=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const Va=document.createElement("div");Va.id="InsertMediaPanel";Va.className=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",
!0)?"insert-media-panel":"insert-media-panel-old";const nb=document.createElement("iframe");nb.id="InsertMediaFrame";nb.className="insert-media-frame";sa.appendChild(Va);Va.appendChild(nb);return za.b(sa)}kB(){const sa=G.a.Od(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");sa.Description=String.format(M.a.instance.Lb(206),this.eAe.toLocaleString());aa.EwaSettings.wz()?new pa.a(this.$,sa):(new Ga.ErrorDialog(this.$,sa)).Rg()}w9h(){return 2===this.Qbb?"M365":"bing"}JCc(sa){var Va,nb;if(2===
this.Qbb||1===this.Qbb){const jb=d.AFrameworkApplication.fa.Va("InsertMediaDialogAriaTenantNameSpace");if(jb&&""!==jb){var ha=[];Array.add(ha,Object.assign(new Ca.a,{name:"DialogMode",string:this.w9h()}));Array.add(ha,Object.assign(new Ca.a,{name:"Provider",string:Q[this.Qbb]}));Array.add(ha,Object.assign(new Ca.a,{name:"InsertedFiles",int64:null===(Va=this.I9)||void 0===Va?void 0:Va.length}));ha.push(Object.assign(new Ca.a,{name:"MediaDetails",string:this.I9?JSON.stringify(this.I9.map(Fb=>Fb.SourceUrl)):
null}));Array.add(ha,Object.assign(new Ca.a,{name:"DialogResult",string:Ua[sa]}));Array.add(ha,Object.assign(new Ca.a,{name:"CorrelationId",string:null===(nb=this.correlationId)||void 0===nb?void 0:nb.toString()}));S.a.sendTelemetryEvent(Object.assign(new fb.a,{name:String.format("{0}.{1}",jb,"InsertOnlineImages"),dataFields:ha}))}}}}Object(u.a)(Ia,"InsertMediaDialog",I.a,[]);var oa=a(387),Da=a(300);class bb extends n.a{constructor(sa,Va,nb,ha,jb,Fb){super(null,nb,ha);this.oBf=0;this.Fra=Rb=>{if(Rb){var mb=
Array(Rb.length);for(var sb=0;sb<Rb.length;sb++){const xb=Rb[sb];mb[sb]={};mb[sb].SourceUrl=xb.SourceUrl;v.a.Dza(xb.LicenseUrl)&&v.a.Dza(xb.PageUrl)&&(mb[sb].LicenseUrl=xb.LicenseUrl,mb[sb].LicenseDisplayName=xb.LicenseDisplayName,mb[sb].PageUrl=xb.PageUrl);mb[sb].AltText=-2053056795===this.Wd.command?xb.Caption:"";mb[sb].IsCellPicture=15735758===this.Wd.command||570484235===this.Wd.command}var Ya=-2009825598===this.Wd.command?"bing":"M365";sb=D.h(this.$);var Ma=A.o(sb.ga.pa.activeCell,this.$);y.a(this.$.userOperationManager,
(xb,qb,Ra)=>E.s(this.$.qa.va,Ma,mb,Ya,P.b(xb,this.m$i),P.a(qb,this.l$i),Ra,null),xb=>new z.a(595,0,xb),this.Wd);O.HelperMethods.R0?(sb=new Map,sb.set("MediaProvider",Ya),sb.set("ImagesCount",Rb.length.toString()),sb.set("TimeTakenToOpenDialog",this.oBf.toString()),x.Health.instance.recordKpiUsage(Da.a.Nvi,1,oa.a.yng,sb)):k.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.$vc()}else k.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
this.m$i=Rb=>{if(F.a(Rb))k.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${G.a.Ic(Rb.Errors)}`);else{k.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const mb=this.Wd.command;15735758!==mb&&570484235!==mb&&(Rb.Result?B.a(this.$).G9(1,Rb.Result):k.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};
this.l$i=()=>{k.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=sa;this.Wd=Va;this.XJ=Fb;this.OAe=w.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let sa=null;sa=this.$.nc.qd("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Wd.command){case -2009825598:case 15735758:this.kXj();break;case -2053056795:case 570484235:this.OAe.execute(Va=>
{Va.isFeatureEnabled("MsoPremiumStockImages",!1).catch(nb=>k.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${nb}`)).then(nb=>{this.lXj(nb);return null})})}sa.stop();this.oBf=sa.fd}kXj(){let sa=this.$.xa.BingPictureEndpoint;const Va=r.a.sL(d.AFrameworkApplication.lcid),nb=t.a.create();sa?(sa=0<sa.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(sa,1,1):String.format(sa,1,d.AFrameworkApplication.lcid,
Va?Va.name:"en-us",d.AFrameworkApplication.buildVersion,nb.toString(),1,this.$.xa.DocumentHostInfo.LoggableUserId),this.G$b(sa,1,-1,M.a.instance.ha(1764))):(k.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.XJ.setException(Error.create("Failed to access the Bing service endpoint")))}lXj(sa){var Va=this.$.xa.M365PictureEndpoint,nb=t.a.create();if(Va){var ha=this.$.xa.DocumentHostInfo.UserId;ha=ha?v.a.rv(ha).toString():
"0";var jb=this.OAe.instance.isFreemiumUpsellEnabled();sa=sa?1:jb?0:-1;nb=nb.toString();jb=r.a.sL(d.AFrameworkApplication.lcid).name;Va=String.format(Va,d.AFrameworkApplication.lcid,jb,d.AFrameworkApplication.buildVersion,nb,1,ha,sa,1);this.G$b(Va,2,sa,M.a.instance.ha(1763))}else k.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.XJ.setException(Error.create("Failed to access the M365 service endpoint"))}G$b(sa,
Va,nb,ha){try{(new Ia(this.$,sa,w.a.instance.ah("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Va,nb,ha)).aYj(this),this.XJ.setResult(!0)}catch(jb){k.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${jb}] [MediaProvider : ${Va}] [DialogLicenseTier : ${nb}]`),this.XJ.setException(jb)}}}Object(u.a)(bb,"OnlinePictureUploaderWrapper",n.a,[2]);var Za=a(62);class Xa{constructor(sa,Va){this.$=sa;this.uploaderCreator=Va}executeCommand(sa,
Va,nb){sa=Va.command;switch(sa){case 1403967063:case -2060689045:if(nb&&"dataUrl"in nb)return Va=new f.a,this.uploaderCreator&&this.uploaderCreator.yti(this.$,e.a.instance,d.AFrameworkApplication.fa,nb,nb.dataUrl,Va),Va.task;this.uploaderCreator&&this.uploaderCreator.zui(this.$,Va,e.a.instance,d.AFrameworkApplication.fa,nb);return Za.Task.Ua(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return sa=new f.a,new bb(this.$,Va,e.a.instance,d.AFrameworkApplication.fa,nb,sa),sa.task;
default:return l.a(sa)}}Tc(sa,Va){let nb=this.$.isEditMode;if(nb)switch(Va.command){case 1403967063:nb=!0;break;case -2053056795:nb=!0;break;case -2009825598:nb=!0;break;case -2060689045:case 15735758:case 570484235:nb=h.a.sFb()&&1===sa;break;default:nb=!1}return nb}ld(){return!1}hd(){return!1}}Object(u.a)(Xa,"PictureCommandHandler",null,[200]);var Ba=a(40),Wa=a(52),Na=a(100),ta=a(149),V=a(36),ia=a(71);class X extends b.a{constructor(sa){super(sa)}he(){Ba.TaskExtensions.za(Object(ia.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?
Object(Na.d)(ta.a.resolve(V.yb,{Wa:this.La})):Wa.GetServiceTaskFactory.Za(this.$.da,484,485,1),sa=>{this.Pd([new Xa(this.$,sa.result)])},this.$.ka,3)}static la(sa){b.a.ye(90,new X(sa))}}Object(u.a)(X,"PictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return la});const la=()=>{c.a.Fa(sa=>{X.la(sa)})}},1226:function(u,C,a){u=a(0);var c=a(15),b=a(199),f=a(88),e=a(126),d=a(393),h=a(106),l=a(50);class k{constructor(){this.Gfa=this.e7e=null}}Object(u.a)(k,"GestureAdapterInfo",null,[]);var n=a(6),
v=a(467),x=a(267);class w{constructor(){this.mPc=null}HNi(){if(!this.mPc){var L="hammer.min.js";n.AFrameworkApplication.fa.Dq("IsServerFlavorDebug")&&(L=n.AFrameworkApplication.fa.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");L=n.AFrameworkApplication.oT(String.format("{0}",L),5);L=x.a.create(L,null,null);v.a.Uwa(L);this.mPc=L.nbb}return this.mPc}static get instance(){w.Oa||(w.Oa=new w);return w.Oa}}w.Oa=null;Object(u.a)(w,"HammerJsDependencyLoader",null,[418]);var r=a(14);const t=(L,R,Y=
null)=>{if(void 0===R||null===R)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Q=null;switch(L){case r.a.pinch:Q=new Hammer.Pinch(Y);break;case r.a.pan:Q=new Hammer.Pan(Y)}Q&&(Q.manager=R);return Q};var A;(function(L){L[L.none=-1]="none";L[L.pinch=0]="pinch";L[L.pan=1]="pan";L[L.swipe=2]="swipe"})(A||(A={}));Object(u.b)("GestureEvent",A);var y=a(81);class z extends y.a{constructor(L,R,Y,Q,W,Ga,pa,aa){super(L,Y,Q,Ga);this.Blb=R;
this.Aia=pa;this.eZ=aa;this.hHg=W}get shiftKey(){return this.Aia}get ctrlKey(){return this.eZ}get clientPoint(){return this.Blb}get Cxa(){return this.hHg}static create(L,R,Y,Q,W,Ga){if(Y.rawEvent)if(Ga){var pa=Y.rawEvent;pa=new Sys.UI.Point(pa.clientX,pa.clientY)}else pa=y.a.yAb(Y);else pa=new Sys.UI.Point(Y.clientX,Y.clientY);return new z(L,pa,R,Y,Q,W,Y.shiftKey,Y.ctrlKey,Ga)}}Object(u.a)(z,"GestureEventArgs",y.a,[]);class E{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=
null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(u.a)(E,"GestureManagerData",null,[]);class G{}G.KAg=2;G.LAg=4;G.MAg=8;G.NAg=8;Object(u.a)(G,"HammerConstants",null,[]);var F=a(99),O=a(212),M=a(34),P=a(85);class B extends l.a{constructor(L,
R){super();this.ata=d.a.qZh;this.UWc=!!window.PointerEvent;this.Qse=window.hasOwnProperty("ontouchstart");this.rZa=this.Vob=null;this.laa=!1;this.xU=new h.a;this.opb=new h.a;this.iHg=new b.a;this.zsa=null;this.tYa=this.eRc=this.dce=this.YNc=this.MUc=this.npe=this.jce=this.Pqb=!1;this.zob=-1;this.curRecognizer=this.element=this.handlers=this.session=this.DZc=null;this.ue=F.EventHandlerManager.instance;this.UWc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Vob=Object(f.a)(this,this.iSa,
"onPointerEvent"),this.rZa=r.a.sZh):this.Qse?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Vob=Object(f.a)(this,this.LBa,"onTouchEvent"),this.rZa=r.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Vob=Object(f.a)(this,this.fvc,"onMouseEvent"),this.rZa=r.a.rZh);this.gi=R;this.Cha=L;n.AFrameworkApplication.fa&&(this.Pqb=n.AFrameworkApplication.fa.ra("UsePointerCaptureIsEnabled"),this.jce=n.AFrameworkApplication.fa.ra("ClearCacheOnPrimaryPointerIsEnabled"),
this.npe=n.AFrameworkApplication.fa.ra("ResetHandledBeforeInputHandlerIsEnabled"),this.MUc=n.AFrameworkApplication.fa.ra("LogCoalescedEventsIsEnabled"),this.YNc=n.AFrameworkApplication.fa.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.dce=n.AFrameworkApplication.fa.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),this.eRc=n.AFrameworkApplication.fa.ra("HammerJsPerformanceTimersIsEnabled"),this.tYa=this.Pqb&&n.AFrameworkApplication.fa.ra("CancelDragFromGestureInputManagerIsEnabled")&&n.AFrameworkApplication.fa.ra("UseGestureInputManagerPointerCacheIsEnabled"))}R6h(){return this.UWc?
0:this.Qse?1:2}mo(L){super.mo(L);this.ue.Xma(this.rZa,L,0,this.Vob)}jn(L){super.jn(L);this.ue.ALa(L,this.rZa)}Gtj(L,R,Y=null){n.AFrameworkApplication.Pnc()?w.instance.HNi().continueWith(Q=>{this.M1j();if(Q.vg||Q.Zh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Q.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Q.status);if(this.dce){Q=window.Hammer;if("undefined"===typeof Q){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.pGc();
return}if("undefined"===typeof Q.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.pGc();return}}if(!L)throw this.pGc(),Error.argumentNull("source element can not be null");Q=O.a.eya(L,this.ata);if(void 0===Q||null===Q)Q=new h.a,O.a.khb(L,this.ata,Q),this.Htj(L);var W=null;Q.Fb(A[0])||(W=Object.assign(new k,{Gfa:t(A[0],this,null),e7e:R}),Q.add(A[0],W));if(void 0!==Y&&null!==Y)for(let Ga=0;Ga<Y.length;Ga++)if(Q.Fb(A[Y[Ga]])){const pa=Q.ma(A[Y[Ga]]);W.Gfa.recognizeWith(pa.Gfa)}}this.pGc()}):
c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}M1j(){this.eRc&&(this.gi?this.DZc=this.gi.qd("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}pGc(){this.eRc&&(this.DZc?this.DZc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Htj(L){this.iHg.add(L);this.ue.Xma(this.rZa,L,0,this.Vob)}recognize(L){var R=Array(L.pointers.length);for(var Y=
0;Y<L.pointers.length;Y++)R[Y]=L.pointers[Y].target;Y=null;for(this.zsa=this.o9h(R);void 0!==this.zsa&&null!==this.zsa&&(Y=O.a.eya(this.zsa,this.ata),void 0===Y||null===Y);this.zsa=this.zsa.parentNode);if(void 0!==Y&&null!==Y){this.curRecognizer&&this.curRecognizer.state===G.NAg&&(this.curRecognizer=null);R=Y.keys;for(let Q of R){R=Y.ma(Q);void 0!==R&&null!==R&&void 0!==R.Gfa&&null!==R.Gfa&&(void 0===this.curRecognizer||null===this.curRecognizer||R.Gfa===this.curRecognizer||R.Gfa.canRecognizeWith(this.curRecognizer))&&
R.Gfa.recognize(L);const W=R.Gfa.state;this.curRecognizer||G.KAg!==W&&G.LAg!==W&&G.MAg!==W||(this.curRecognizer=R.Gfa)}}}emit(L,R){if("hammer.input"!==L){this.laa=!1;R=z.create(L,this.zsa,R.srcEvent,R,3,this.UWc);var Y=O.a.eya(this.zsa,this.ata);if(this.jFi(L))var Q=0;else if(this.ZEi(L))Q=1;else if(this.qIi(L))Q=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Y}=Y.nd(A[Q]));void 0!==Y&&null!==Y&&((Y=Y.e7e,Y.vCi())?L.endsWith("start")?this.laa=
Y.q5i(R):L.endsWith("end")?(Y.o5i(R),this.laa=!0):L.endsWith("cancel")?(Y.n5i(R),this.laa=!0):L.endsWith("move")&&(this.laa=Y.p5i(R)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",L))}}get(L){return Object(e.a)(Hammer.Recognizer,L)}o9h(L){if(1>L.length)return null;if(1===L.length)return L[0];var R=L[0],Y=!0;for(let Q=1;Q<L.length;Q++){if(!L[Q])return null;if(R!==L[Q]){Y=!1;break}}if(Y)return R;R=this.z7e(L[0]);Y=0;for(const Q of L){L=this.z7e(Q);if(R.ma(R.count-1)!==
L.ma(L.count-1))return null;for(let W=R.count-2,Ga=L.count-2;W>=Y&&0<=Ga;W--,Ga--)if(R.ma(W)!==L.ma(Ga)){Y=W+1;break}}return R.ma(Y)}z7e(L){const R=new b.a;for(;void 0!==L&&null!==L;L=L.parentNode)R.add(L);return R}Faf(L){switch(L){case r.a.Yf:case r.a.Gba:return 1;case r.a.Zg:case r.a.Gja:return 2;case r.a.$e:case r.a.VJa:return 4;case r.a.dIc:case r.a.W5c:return 8}return 0}LBa(L,R,Y){L=this.Faf(L);R=this.T7h(Y);Hammer.inputHandler(this,L,R);this.laa&&Y.preventDefault();return this.laa}vif(){return 1<
this.xU.count}V7b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Pqb)for(let L of this.xU)this.C3f(L.key);else this.xU=new h.a;this.session=null}NTg(L,R,Y){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",L);if(!this.opb.Fb(L)){try{R.setPointerCapture(L)}catch(Q){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Q)}this.opb.add(L,R)}this.xU.ia(L,Y);this.tYa&&1<this.xU.count&&this.Cha&&!this.Cha.Gub&&(this.Cha.Gub=!0)}C3f(L){c.ULS.sendTraceTag(594055957,
310,50,"RemovePointerFromCaches: pointerId: {0}",L);if(this.opb.Fb(L)){try{this.opb.ma(L).releasePointerCapture(L)}catch(R){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",R)}this.opb.remove(L)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",L);this.xU.remove(L);this.tYa&&1>=this.xU.count&&this.Cha&&this.Cha.Gub&&(this.Cha.Gub=!1)}iSa(L,R,Y){var Q=Y.rawEvent.pointerType.toString();const W=Y.rawEvent.pointerId.toString();if("touch"!==Q)return!1;
L=this.Faf(L);if(1!==L&&!this.xU.Fb(W))return!1;this.jce&&1===L&&Y.rawEvent.isPrimary&&this.xU.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.V7b());this.Pqb?this.NTg(W,R,Y):this.xU.ia(W,Y);this.MUc&&2===L&&(!this.YNc||this.YNc&&"function"===typeof Y.rawEvent.getCoalescedEvents)&&(R=Y.rawEvent.getCoalescedEvents())&&this.vif()&&(this.zob=Math.max(this.zob,R.length));this.npe&&(this.laa=!1);Q=this.S7h(this.xU,Y,Q);Hammer.inputHandler(this,L,Q);if(4===L||8===L)this.Pqb?
this.C3f(W):this.xU.remove(W),this.xU.count||(this.session=null,this.MUc&&-1!==this.zob&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.zob),this.zob=-1));this.laa&&Y.preventDefault();return this.laa}fvc(){return!1}T7h(L){const R=new E;var Y=L.rawEvent;const Q=Y.touches;Y=Y.changedTouches;R.pointers=Array.clone(Q);R.pointers=Array.clone(0<Q.length?Q:Y);R.changedPointers=Array.clone(Y);R.srcEvent=L;R.pointerType="touch";return R}S7h(L,R,Y){const Q=new E;Q.pointers=
P.toArray(L.values);Q.changedPointers=[R];Q.pointerType=Y;Q.srcEvent=R;return Q}jFi(L){return M.a.startsWith(L,r.a.pinch)}ZEi(L){return M.a.startsWith(L,r.a.pan)}qIi(L){return M.a.startsWith(L,r.a.swipe)}}Object(u.a)(B,"GestureInputManager",l.a,[401,402]);var D=a(290),I=a(260);class S{constructor(){this.Db=null;this.Ay=!1}get name(){return"Common.App.GestureInputManager"}Di(L){L.register(B,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Uc().dd(()=>new B(D.a.instance,
n.AFrameworkApplication.sa.hF));this.Db=L}init(){this.Ay||(this.Db.resolve("Common.App.GestureManager.GestureInputManager"),this.Ay=!0)}dispose(){}static main(){I.a.instance.nj(new S)}}Object(u.a)(S,"GestureInputManagerPackage",null,[4,5]);a.d(C,"a",function(){return J});const J=()=>{Type.registerNamespace("Common.App.GestureManager");S.main()}},1250:function(u,C,a){u=a(0);var c=a(88),b=a(157),f=a(6);class e extends b.a{constructor(z){super(!1,!1,!0);this.$Xa=z}start(){var z={["tooltipPersistenceEnabled"]:this.$Xa.Usd};
f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(z.textSelectionChangeEnabled=this.$Xa.P3d);z={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:z};this.initializeAndShow("",Object(c.a)(this,this.eEj,"resultHandler"),z)}eEj(z,E){1===z&&(this.$Xa.Usd=E.tooltipPersistenceEnabled,f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.$Xa.P3d=E.textSelectionChangeEnabled))}}
Object(u.a)(e,"AccessibilitySettingsDialog",b.a,[]);var d=a(111),h=a(26);class l{constructor(z,E){this.Na=z;this.$Xa=E}vh(){this.Na.xc(h.a.DWj,d.a.frame,Object(c.a)(this,this.EWj,"showAccessibilitySettingsDialogHandler"))}EWj(){(new e(this.$Xa)).start();return 32}}Object(u.a)(l,"AccessibilitySettingsDialogActor",null,[400]);var k=a(170);const n=z=>{const E=new k.a;f.AFrameworkApplication.de.Fn(v(z),1,null,null,!0,2,G=>{200===G.data.httpStatus?E.setResult("true"===G.data.Fe.toLowerCase()):E.setResult(!1)},
()=>{E.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return E.task},v=z=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",f.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",z,f.AFrameworkApplication.ej);var x=a(140);class w{constructor(){this.b_c=this.zZa=null}get Usd(){return!!this.zZa}set Usd(z){z!==this.zZa&&(this.zZa=z,x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(z),this.Ttf()&&f.AFrameworkApplication.de.Fn(v("saveHoverableRibbonTooltipIsEnabled"),
2,z.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get P3d(){return!!this.b_c}set P3d(z){z!==this.b_c&&(this.b_c=z)}NNi(){const z=new k.a;if(this.zZa)z.setResult(this.zZa);else if(this.Ttf()){const E=n("getHoverableRibbonTooltipIsEnabled");E.continueWith(()=>{this.zZa=E.result;x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(E.result);z.setResult(E.result)},8)}else z.setResult(!1)}Ttf(){const z=f.AFrameworkApplication.fa.ra("IsRoamingServiceEnabled"),
E=f.AFrameworkApplication.fa.ra("IsAnonymousUser");return z&&!E}}Object(u.a)(w,"AccessibilitySettingsInfo",null,[399]);var r=a(260),t=a(148);class A{constructor(){this.Db=null}get name(){return"Common.App.AccessibilitySettings"}Di(z){this.Db=z;this.Db.register(w,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").dd(()=>new w).Uc();this.Db.register(l,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").dd(()=>
new l(f.AFrameworkApplication.Qb,this.Db.ah("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).Uc()}init(){const z=this.Db.ah("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),E=this.Db.ah("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");z&&E?(E.vh(),z.NNi()):t.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){r.a.instance.nj(new A)}}Object(u.a)(A,
"AccessibilitySettingsPackage",null,[4,5]);a.d(C,"a",function(){return y});const y=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");A.main()}},1251:function(u,C,a){u={};a.r(u);a.d(u,"TableManager",function(){return bb});var c=a(10),b=a(0),f=a(229),e=a(119),d=a(15),h=a(92),l=a(31),k=a(425),n=a(487),v=a(532),x=a(180),w=a(232),r=a(25),t=a(73),A=a(47),y=a(187),z=a(218),E=a(51),G=a(48),F=a(13),O=a(76),M=a(141),P=a(1),B=a(12),D=a(20),I=a(354),S=a(248),J=a(14),L=a(168),R=a(101),Y=a(7),Q=a(261),
W=a(79),Ga=a(49),pa=a(37);class aa extends R.a{constructor(Ba,Wa,Na,ta){super(Ba);this.bng=[6];this.Xmg=[26];this.rr=null;this.FFb=this.npc=!1;this.Et=this.vda=null;this.onPointerDown=V=>{if(1!==this.$.Ia.EI())return!0;V=pa.a(this.$).Se(V);if(this.sC)return!0;var ia=Ga.a(this.$).jxd||Ga.a(this.$).Qq();if(this.izd||ia)return this.dgb(),!0;this.Et=this.Wn;this.wRd();this.tsd();ia=2===V.Wb&&V.Ro===Sys.UI.MouseButton.leftButton;const X=3===V.Wb;if(ia||X)V=this.ga.Yq(V.clientPoint,V.tc,5,void 0,void 0,
!0),V||(V=this.Et),this.FFb=ia,this.npc=X,this.Et=this.Hff(V),this.tsd(),ia?this.fuj():X&&this.Xuj(),Q.b(this.$,!0);return!0};this.Qj=V=>{V=pa.a(this.$).Se(V);if(!this.sC)return!1;let ia=this.FFb?this.ga.Yq(V.clientPoint,V.tc,5,void 0,void 0,!0):this.ga.Yq(V.clientPoint,V.tc,5,!0,!1,!0);ia||(ia=this.ga.Usb(V.clientPoint,V.tc,5));ia&&(V=this.Hff(this.vsb(ia)),this.b7b(V.bottomRight),this.Et.equals(V)||(this.Et=V,this.iOb(!1),this.wRd(!1),this.tsd(!1),this.vpi(),this.dc.update(!1)),this.Ldk(this.Et));
return!0};this.Mh=V=>{pa.a(this.$).Se(V);if(!this.sC)return!1;this.resizeTable();this.dgb();return!0};this.BLb=V=>{pa.a(this.$).Se(V);if(!this.sC)return d.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.dgb();return!0};this.efa=V=>{pa.a(this.$).Se(V);this.dgb();return!0};this.UIf=()=>{this.sC&&this.dgb()};this.gridView=Wa;this.$=Wa.$;this.tableManager=ta;this.ga=Wa.ga;this.dc=Wa.dc;this.parentElement=Ba;
this.R8g();l.a.iq||l.a.S0||S.a.instance.ta(J.a.pointerDown,this.vda,this.onPointerDown);this.Wn=Na;this.CTc=this.izd=!1;this.tableManager.WVg(this.UIf)}get sC(){return this.FFb||this.npc}get Uuf(){return this.CTc}dispose(){this.dgb();this.tableManager.jxj(this.UIf);this.Uuf||l.a.iq||l.a.S0||S.a.instance.Aa(J.a.pointerDown,this.vda,this.onPointerDown);if(this.sC){Q.b(this.$,!1);try{this.gx()}catch(Ba){d.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ba}`)}}this.parentElement&&
this.parentElement.contains(this.vda)&&this.parentElement.removeChild(this.vda);this.vda=this.parentElement=null;super.dispose()}Hff(Ba){const Wa=Ba.bottom-this.Wn.topLeft.bottom-1;return 0<=Ba.right-this.Wn.topLeft.right+1&&0<=Wa&&Ba.bottom>=this.Wn.top&&Ba.right>=this.Wn.left?new r.Range(this.Wn.top,this.Wn.left,Ba.bottom,Ba.right,!1,!1):this.Et}tsd(Ba=!0){this.yDc([this.Et],6,Ba);this.dc.Ur(this.bng)}iOb(Ba=!0){this.dc.Hk(this.bng);this.yDc([null],6,Ba)}wRd(Ba=!0){this.dc.Hk(this.Xmg);this.yDc([null],
26,Ba)}vpi(){const Ba=this.K4j();0<Ba.length&&(this.yDc(Ba,26,!1),this.dc.Ur(this.Xmg))}K4j(){const Ba=[];this.Wn.contains(this.Et)&&(this.Wn.right!==this.Et.right&&Ba.push(new r.Range(this.Wn.top,this.Et.right+1,this.Et.bottom,this.Wn.right,!1,!1)),this.Wn.bottom!==this.Et.bottom&&Ba.push(new r.Range(this.Et.bottom+1,this.Wn.left,this.Wn.bottom,this.Wn.right,!1,!1)));return Ba}resizeTable(){if(!this.Et.equals(this.Wn)){const Ba=new r.Range(this.Wn.top,this.Wn.left,this.Et.bottom,this.Et.right,!1,
!1);this.Q9j(Ba);this.izd=!0}}onKeyDown(Ba){pa.a(this.$).Se(Ba);return!0}iJd(){this.Uuf&&(l.a.iq||l.a.S0||(S.a.instance.ta(J.a.pointerDown,this.vda,this.onPointerDown),this.vda.classList.remove("ewr-table-resize-default-cursor"),this.CTc=this.vda.disabled=!1),this.CTc=!1)}R8g(){const Ba=document.createElement("div");Ba.className="ewr-table-resize-handle";const Wa=document.createElement("div");Wa.className="ewr-table-resize-fillhandle-higher";const Na=document.createElement("div");Na.className="ewr-table-resize-fillhandle-broader";
Ba.appendChild(Wa);Ba.appendChild(Na);this.vda=Ba;this.parentElement.appendChild(this.vda)}b7b(Ba){let Wa=60;const Na=this.Et.contains(Ba);let ta=Ba.top,V=Ba.bottom,ia=Ba.left,X=Ba.right,la=null;if(Na){if(this.gridView.JL(this.Wn.topLeft)&&!this.Wn.QDa)return;Ba.bottom<this.Et.bottom?(ta=Math.max(1,V-2,this.Wn.top),Wa=16):(ia=Math.max(1,X-2,this.Wn.left),Wa=4);V=ta;X=ia;la=new r.Range(ta,ia,ta,ia,!1,!1)}else Ba.right>=this.Wn.right?(X+=2,Wa=8):Ba.bottom>=this.Wn.bottom&&(V+=2,Wa=32),ta=V,ia=X,la=
new r.Range(V,X,V,X,!1,!1),Wa=16;this.gridView.JL(la)||(this.rr?this.rr.Po||(this.rr=E.a.instance.create(()=>{this.gridView.Lw(la,Wa,"TableResizeBehavior.BringRangeIntoView")},40,G.a.$mg)):this.rr=E.a.instance.create(()=>{this.gridView.Lw(la,Wa,"TableResizeBehavior.BringRangeIntoView")},40,G.a.$mg))}vsb(Ba){let Wa=Ba;if(this.gridView.Cb.HW){if(!this.gridView.jc(Ba.topLeft)){const Na=this.gridView.sj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.QR,this.Et.top!==Ba.top?1:2);try{Na.ul=
this.Et.top<Ba.top||this.Et.left<Ba.left,Na.Sw(Ba.topLeft),Wa=Na.$$cu().range}finally{Na&&Na.dispose()}}Wa.right=Wa.left+Ba.width-1;Wa.bottom=Wa.top+Ba.height-1}return Wa}yDc(Ba,Wa,Na=!0){const ta=[];for(const V of Ba)ta.push(new I.a(V,t.d(this.$.na)));this.dc.iB(ta,[Wa],!0,void 0,Na)}fuj(){S.a.instance.ta(J.a.Tk,document.documentElement,this.Qj);for(const Ba of this.gridView.wo)S.a.instance.ta(J.a.Tk,Ba.domElement,this.Qj);S.a.instance.ta(J.a.Pg,document.documentElement,this.Mh);this.NTe()}Xuj(){L.a.instance.ta(J.a.Zg,
document.documentElement,this.Qj);for(const Ba of this.gridView.wo)L.a.instance.ta(J.a.Zg,Ba.domElement,this.Qj);L.a.instance.ta(J.a.$e,document.documentElement,this.BLb);this.NTe()}gx(){this.FFb&&this.Ubk();this.npc&&this.gck()}Ubk(){S.a.instance.Aa(J.a.Tk,document.documentElement,this.Qj);for(const Ba of this.gridView.wo)S.a.instance.Aa(J.a.Tk,Ba.domElement,this.Qj);S.a.instance.Aa(J.a.Pg,document.documentElement,this.Mh);this.v1f()}gck(){L.a.instance.Aa(J.a.Zg,document.documentElement,this.Qj);
for(const Ba of this.gridView.wo)L.a.instance.Aa(J.a.Zg,Ba.domElement,this.Qj);L.a.instance.Aa(J.a.$e,document.documentElement,this.BLb);this.v1f()}NTe(){this.gridView.cellTextEditBox.fdc(!0)}v1f(){this.gridView.cellTextEditBox.fdc(!1)}Q9j(Ba){this.$.xd(-1400250766,W.a.Vb,30,{["ResizeTableRange"]:Ba,["OriginalTableRange"]:this.Wn})}Ldk(Ba){if(!this.Wn.contains(Ba)){Ba=this.J4j();for(const Wa of Ba)if(this.tableManager.Izd(Wa)){this.gridView.Ch.rq(Y.a.PYi);return}}this.gridView.rtl?this.gridView.Ch.rq(Y.a.ZXi):
this.gridView.Ch.rq(Y.a.k_i)}dgb(){if(this.sC){Q.b(this.$,!1);try{this.gx()}catch(Ba){d.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ba}`)}}this.rr&&(this.rr.cancel(),this.rr.dispose());this.npc=this.FFb=!1;this.iOb();this.wRd();Q.b(this.$,!1);this.gridView.Ch.rq(Y.a.zW)}J4j(){const Ba=[];this.Wn.right!==this.Et.right&&Ba.push(new r.Range(this.Wn.top,this.Wn.right+1,this.Et.bottom,this.Et.right,!1,!1));this.Wn.bottom!==this.Et.bottom&&
Ba.push(new r.Range(this.Wn.bottom+1,this.Wn.left,this.Et.bottom,this.Wn.right,!1,!1));return Ba}static createInstance(Ba,Wa,Na,ta){if(!Wa)return null;const V=Ba.dc;V.iB(Na,[27],!0);V.Ur(aa.C4j);Na=V.nE(27,Ba.Cb.ti(Wa.bottomRight),aa.s4h(Wa,Na)).Fg;return new aa(Na,Ba,Wa,ta)}static s4h(Ba,Wa){var Na;for(let ta=0;ta<Wa.length;ta++)if((null===(Na=Wa[ta])||void 0===Na?0:Na.range)&&Wa[ta].range.equals(Ba))return ta;return 0}}aa.C4j=[27];Object(b.a)(aa,"TableResizeBehavior",R.a,[]);var Z=a(2);R=a(247);
class fa{}fa.GKh="ewa-ttrd-buttonarea";Object(b.a)(fa,"CssClassNames",null,[]);var ya=a(53),Aa=a(136),ja=a(91),za=a(23),ra=a(16),fb=a(268),Ua=a(137),Ca=a(276),Ia=a(149),oa=a(36);class Da extends R.a{constructor(Ba){super(document.createElement("div"));this.N0c=this.qwd=this.JUf=this.eS=!1;this.tQb=null;this.xg=()=>{z.c(this.$,this.gridView.ga.pa.activeCell)?(this.kPa=!0,this.iwb(!1)):(this.Q0=this.kPa=!1,this.hsg())};this.Dp=()=>{this.kPa?this.iwb(!0):this.Q0=!1};this.qBa=()=>{this.N0c=!0;this.kPa&&
(this.Q0=!1)};this.onContentReady=()=>{this.$.isEditMode?z.c(this.$,this.gridView.ga.pa.activeCell)&&(this.kPa=!0,this.iwb(!1)):this.Q0=!1};this.w8=()=>{this.N0c=!1;this.kPa?this.iwb(!1):this.Q0=!1};this.Uf=(Wa,Na)=>{this.kPa&&(Wa=this.gridView.Kdb(Na.Jd.block.Ke.BlockCachePosition.PaneType).iD(Na.Jd.hash))&&(Wa.PSd(this.xjf),Wa.X2c(this.xjf))};this.xjf=()=>{this.D5f()};this.$=Ba;this.gridView=D.h(this.$);this.parentElement=this.domElement;this.parentElement.className=fa.GKh;this.mOa=this.gridView.qk;
this.kjd=P.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.kPa=!0;this.Wti();this.kjd&&this.Pri();this.j3g();this.iwb(!1);d.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get Q0(){return this.qwd}set Q0(Ba){this.qwd!==Ba&&(this.qwd=this.isVisible=Ba)}get EGb(){return!!(this.$.$d&16)}get HDi(){const Ba=this.gridView.ga.pa.activeCell;return Ba.right===Ba.maxColumns}get krb(){const Ba=this.gridView.jc(null);return Ba&&this.gridView.$da(Ba.range)?
this.fya(Ba):(Ba&&d.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.wwh();this.$=this.gridView=this.parentElement=this.mOa=null;super.dispose()}m2h(Ba){const Wa=this.Kgi(this.gridView.jc(null).range);return Wa?this.kjd?`=${this.Vef()}(${Ba}${this.$.listSeparator}${Wa})`:`=SUBTOTAL(${Ba},${Wa})`:null}Vef(){var Ba,Wa,Na;return null!==(Na=null===(Wa=null===(Ba=this.calcManager)||void 0===Ba?void 0:Ba.localeInfo)||
void 0===Wa?void 0:Wa.getWorksheetFuncName(344))&&void 0!==Na?Na:"SUBTOTAL"}Kgi(Ba){var Wa=D.h(this.$).Mb.ph(Ba);if(!Wa)return null;Wa=y.a(Wa,!1);Wa.right=Wa.left=Ba.left;return Wa.toString()}Wti(){Da.GK={};Da.GK["100"]=ra.a.instance.ha(1105);Da.GK["101"]=ra.a.instance.ha(1108);Da.GK["102"]=ra.a.instance.ha(1107);Da.GK["103"]=ra.a.instance.ha(1112);Da.GK["104"]=ra.a.instance.ha(1109);Da.GK["105"]=ra.a.instance.ha(1110);Da.GK["109"]=ra.a.instance.ha(1106);Da.GK["107"]=ra.a.instance.ha(1113);Da.GK["110"]=
ra.a.instance.ha(1115);Da.GK["111"]=ra.a.instance.ha(1166)}Pri(){(P.EwaSettings.qC()?Ba=>Ia.a.resolve(oa.i).then(Wa=>setTimeout(()=>Ba(Wa),0)):Ba=>this.$.da.Gb(266,Ba))(Ba=>{this.calcManager=Ba})}sgj(){var Ba=this.gridView.jc(null);if(Ba&&(Ba=Ba.pz?Ba.formulaBarText:null))if(this.kjd){const Wa="="+this.Vef()+"(",Na=Wa.length;if(Ba.toUpperCase().startsWith(Wa)){if(Ba=Ba.substring(Na,Na+3),Ba in Da.GK)return Ba}else return"111"}else if("=SUBTOTAL("===Ba.substring(0,10)){if(Ba=Ba.substring(10,13),Ba in
Da.GK)return Ba}else return"111";return"100"}j3g(){this.gridView.Ca.mv(this.Uf);this.gridView.ga.add_activeCellChanged(this.xg);this.gridView.jt(this.onContentReady);this.gridView.cellTextEditBox.ao(this.qBa);this.gridView.cellTextEditBox.Bm(this.w8)}wwh(){this.gridView&&(this.gridView.ga&&(this.gridView.ga.remove_activeCellChanged(this.xg),this.gridView.Ca.Lt(this.Uf)),this.gridView.Rv(this.onContentReady),this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.Un(this.qBa),this.gridView.cellTextEditBox.Qm(this.w8)),
this.hsg())}iwb(Ba){this.Xdk(Ba);this.EGb&&(this.g3j(),this.krb?(this.JUf||this.u3g(),this.N0c?this.Q0=!1:(this.Q0=!0,this.D5f())):(d.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.Q0=!1))}D5f(){appChrome.renderTableTotalRowOptions(this.parentElement,Da.GK,Da.GK[this.sgj()].toString(),Math.round(pa.a(this.$).ri(17)),Ba=>{d.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${Ba}`);
let Wa={["SelectedOption"]:Da.GK[Ba],["FunctionKeyCode"]:Ba,["Location"]:"canvas"};Ua.b(this.$).Ld(Aa.a.O4j,Wa,null,!0);if("111"===Ba)return this.uxi(),!0;if("100"!==Ba){this.tQb=this.m2h(Ba);if(!this.tQb)return d.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.YUa(this.tQb)}else this.YUa("");F.DOMElementExtensions.setFocus(this.gridView.wc.textBox.domElement);return!0})}uxi(){d.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const Ba=new ja.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ia.$b(Ba)}fya(Ba){if(!Ba)return null;var Wa=this.gridView.cellTextEditBox.textBox.domElement;var Na=0<F.DOMElementExtensions.getHeight(Wa)&&0<F.DOMElementExtensions.getWidth(Wa)&&0<=Wa.offsetTop&&0<=Wa.offsetLeft;if(Na)Wa=F.DOMElementExtensions.fya(Wa,this.gridView.qk);else{Wa=this.gridView.getCellBounds(Ba.cell);var ta=F.DOMElementExtensions.getBoundingClientRect(this.gridView.qk);Wa=new Sys.UI.Bounds(Wa.x-ta.x,Wa.y-ta.y,Wa.width,
Wa.height)}if(Wa)if(Na)2<Wa.height&&2<Wa.height&&(Wa.x+=1,Wa.y+=1,Wa.height-=2,Wa.width-=2);else if(Na=D.h(this.$).qL(Ba.cell))Na=Na.width,ta=za.a.equals(fb.a.DAb(Ba.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&ta&&(Wa.x=Wa.x+Wa.width-Na),Ba.bea&&this.gridView.rtl===ta&&(Wa.width=Na);else return null;return Wa}Xdk(Ba){var Wa=this.krb;if(Wa){var Na=17>=Wa.height?Wa.y:Wa.y+Wa.height-17-2;Wa=this.HDi?this.gridView.rtl?Wa.x:Wa.x+Wa.width-(17<Wa.height?17:Wa.height):this.gridView.rtl?Wa.x-(17<
Wa.height?17:Wa.height):Wa.x+Wa.width;var ta=pa.a(this.$).qma(new Sys.UI.Point(Wa,Na));this.parentElement.style.top=B.HelperMethods.Yc(ta.y);this.parentElement.style.left=B.HelperMethods.Yc(ta.x);pa.a(this.$).TOj(this.parentElement);Ba&&(this.Q0=this.gridView.ypc(new ya.a(Wa,Na)))}else this.Q0=!1}u3g(){this.mOa.insertBefore(this.parentElement,this.mOa.firstChild);this.JUf=!0}g3j(){this.eS||(this.gridView.view.ls(this.Dp),this.eS=!0)}hsg(){this.eS&&this.gridView.view&&(this.gridView.view.oq(this.Dp),
this.eS=!1)}YUa(Ba){const Wa=this.gridView.wc,Na=this.gridView.jc(null);Na&&(Ba=Object(Z.a)(new Ca.a,{Text:Ba}),this.gridView.setCell(Ba,Na.range,0,127,null),Wa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Da.N4j="TableTotalRowDropDownIconButtonId";Da.GK=null;Object(b.a)(Da,"TableTotalRowOptions",R.a,[2]);let bb=class extends n.a{constructor(Ba){super(D.h(Ba));this.zub=this.P2=this.cHc=this.xub=null;this.LAe=!1;this.Hje=null;this.KXb=0;this.Lac=null;this.t6b=()=>{const Wa={},Na=this.Kod();
for(let V in Na){const ia=Na[V];if(!ia)continue;const X=this.Mfi(ia);if(X){if(X in this.LIa){var ta=this.LIa[X];if(ta.sC){ta.Wn.equals(ia)||(ta.Wn=ia);delete this.LIa[X];Wa[X]=ta;continue}}(ta=aa.createInstance(D.h(this.$),ia,this.g_h(),this))?Wa[X]=ta:d.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ia.nz(!1)}`)}}this.I8b(null,null);this.qWb=Wa};this.I8b=()=>{const Wa=this.LIa;for(let V in Wa){var Na=V,ta=Wa[V];ta&&(ta.dispose(),delete this.LIa[Na])}this.qWb=
{}};this.E_f=()=>{this.I8b(null,null);this.t6b(null,null)};this.onFocus=()=>{this.Hje=D.h(this.$).ga.pa.activeCell};this.u8=()=>{this.$.isEditMode&&this.xg(null,null)};this.xg=()=>{!this.LAe&&z.c(this.$,this.gridView.ga.pa.activeCell)&&this.YNi()};this.KE=()=>{this.LDb(1);this.$.ea.Pm(this.KE)};this.GMb=()=>{this.LAe=!0;this.cHc=new Da(this.$)};this.$=Ba;this.gridView=D.h(this.$);P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)||this.$.da.Ja(66,this);this.qWb={};
this.t6b(null,null);this.$.ua&&this.$.ua.Lg(this.E_f);this.H2c(this.t6b);this.$.ea.E4(this.u8);this.gridView.ga.add_activeCellChanged(this.xg);this.$.isEditMode&&this.xg(null,null)}H2c(Ba){this.addHandler(n.a.Seb,Ba)}DSd(Ba){this.removeHandler(n.a.Seb,Ba)}WVg(Ba){this.addHandler("tce",Ba)}jxj(Ba){this.removeHandler("tce",Ba)}get LIa(){return this.qWb}get aBd(){return this.Hje}get uLa(){return this.KXb}get Mj(){const Ba=D.h(this.$);return Ba.Mb.ph(Ba.ga.pa.activeCell,!1)}get gOd(){return this.aBd?
D.h(this.$).Mb.ph(this.aBd,!1):null}Izd(Ba){return!!this.ucf(Ba)}Lq(Ba){return this.bci(this.ddf(Ba))}nAb(Ba){return this.ddf(Ba)}Uuj(Ba){Ba?(this.zub?this.zub!==Ba&&(h.a.Ka(this.P2),this.P2=null,this.zub=Ba):this.zub=Ba,this.P2||(this.P2=M.a.instance.He(this.zub)),this.P2.zj("focusin")||this.P2.la("focusin",this.onFocus)):d.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}crf(Ba,Wa){return Ba?Ba.Jma&&Ba.top===Wa.top:(d.ULS.shipAssertTag(537151244,
0,!!Ba,"autofilterRange can't be null"),!1)}oma(Ba){Ba=this.xub?A.J(Ba,this.xub):this.view.getRangeInformation(Ba);return 0<Ba.length&&Object(k.a)(w.PivotTableRange,Ba[0])?Ba[0]:null}Pzi(Ba,Wa){return Ba?!Ba.Umc&&!!Ba.ww&&Ba.ww.Nd(Wa):(d.ULS.shipAssertTag(537151243,0,!!Ba,"Pivot table can't be null"),!1)}HGi(Ba,Wa){return Ba?!Ba.Umc&&!!Ba.Nt&&Ba.Nt.Nd(Wa):(d.ULS.shipAssertTag(537151242,0,!!Ba,"Pivot table can't be null"),!1)}f4b(Ba){super.f4b(Ba);if((Ba=B.HelperMethods.Gcf(Ba))&&0<Ba.length){this.xub=
Array(Ba.length);for(let Wa=0;Wa<Ba.length;Wa++)this.xub[Wa]=x.a.PR(Ba[Wa])}}bOb(){super.bOb();this.xub=null}flh(Ba,Wa){return this.VNe(Ba,Wa).returnValue}VNe(Ba,Wa){var Na=!1;if(!Ba||!Wa)return{returnValue:!1,a_:Na};Ba=Ba.clone();Ba.right+=1;Ba.left=Ba.right;return!Ba.IA||Ba.top<Wa.Cb.yj&&(Na=Ba.clone(),Na.bottom>=Wa.Cb.yj&&(Na.bottom=Wa.Cb.yj-1),!({a_:Na}=this.UNe(Na,Wa)).returnValue)||Ba.bottom>=Wa.Cb.yj&&(Na=Ba.clone(),Na.top<=Wa.Cb.yj&&(Na.top=Wa.Cb.yj),!({a_:Na}=this.UNe(Na,Wa)).returnValue)?
{returnValue:!1,a_:Na}:{returnValue:!0,a_:Na}}ang(Ba){(Ba=this.Lq(Ba.topLeft))&&Ba.toString()in this.LIa&&(this.LIa[Ba.toString()].izd=!1)}voj(){this.raiseEvent("tce")}ji(Ba,Wa){if(!this.cHc)return!1;switch(Wa){case -569786022:case 541421805:if(this.cHc.Q0){const Na=document.getElementById(Da.N4j);Na&&E.a.instance.create(()=>{F.DOMElementExtensions.Ulc(Na,null)},0,G.a.G4j,!0,!0)}return!0;default:return!1}}dispose(){this.I8b(null,null);this.DSd(this.t6b);this.$.ua.ih(this.E_f);this.$.Ll(this.I8b);
this.qWb=null;this.$.ea&&this.$.ea.r9(this.u8);this.gridView.ga.remove_activeCellChanged(this.xg);this.cHc=null;this.P2&&(h.a.Ka(this.P2),this.P2=null);super.dispose()}Omi(Ba,Wa,Na,ta){var V=this.gridView.Mb.ph(new r.Range(Wa,Na,Wa,Na,!1,!1));if(this.Lac=V){var ia=V.usedRange,X=Ba.ctrlKey||l.a.isMac&&O.b(Ba);V=!Ba.shiftKey&&X;Ba=Ba.shiftKey&&!X;D.h(this.$).ga.selectionType=3;switch(ta){case 0:this.KXb=0;Wa=this.Ibd(Ba,ia.top,Na,ia.bottom,Na);this.GYd(Wa,V,Ba);break;case 1:this.KXb=1;Wa=this.Ibd(Ba,
Wa,ia.left,Wa,ia.right);this.GYd(Wa,V,Ba);break;case 2:this.KXb=2;Wa=this.Ibd(Ba,ia.top,ia.left,ia.bottom,ia.right);this.GYd(Wa,V,Ba);break;default:d.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${ta.toString()}`);return}D.h(this.$).ga.selectionType=3;d.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else d.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}GTj(Ba){const Wa=
this.Lac.usedRange;return this.ptf(Ba)||1!==this.uLa&&this.ptf(new r.Range(Wa.top,Ba.left,Wa.bottom,Ba.right,!1,!1))?!0:!1}zPd(Ba){return Ba.Autofilters}UNe(Ba,Wa){let Na;Na=!1;const ta=Wa.Cb.ti(Ba),V=Wa.og(ta).hk;if(!V)return d.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${ta}`),{returnValue:!1,a_:Na};if(!V.Ue(Ba))return{returnValue:!0,a_:Na};Ba=Wa.sj("TableManager.CouldExpandImpl",Ba,2);try{for(;Ba.$$mn();){if(Ba.$$cu().text||Ba.Cm.Yjc)return Na=
!0,{returnValue:!1,a_:Na};if(Ba.$$cu().GG)return{returnValue:!1,a_:Na}}}finally{Ba&&Ba.dispose()}return{returnValue:!0,a_:Na}}bci(Ba){if(!Ba)return null;const Wa=new v.AutofilterRange(Ba.top,Ba.left,Ba.bottom,Ba.right,null,null,null,Ba.id,Ba.Jma);Wa.QDa=Ba.QDa;const Na=this.gridView.Mb.ph(Ba,!0);if(!Na)return null;for(let ta=0,V=this.rangeList.length;ta<V;ta++){const ia=this.rangeList[ta],X=this.gridView.Mb.ph(ia,!0);X&&X.name===Na.name&&ia!==Ba&&this.JFi(ia)&&(Wa.union(ia),ia.QDa&&(Wa.QDa=!0))}return Wa}JFi(Ba){return!!D.h(this.$).Mb.ph(Ba)}g_h(){const Ba=
[];for(const Wa of this.rangeList){const Na=new I.a(this.Lq(Wa.topLeft),t.d(this.$.na));Ba.push(Na)}return Ba}Kod(){const Ba={};for(const Wa of this.rangeList){if(!Wa)continue;const Na=this.Lq(Wa.topLeft);Na&&(Ba[Na.toString()]=this.Lq(Wa.topLeft))}return Ba}YNi(){this.$.ea.Of?this.LDb(0):this.$.ea.nk(this.KE)}LDb(Ba){this.$.wA(Wa=>{Wa.x6(Ba).then(this.GMb)})}Mfi(Ba){const Wa=this.gridView.Mb.ph(Ba);return Wa?Wa.name:Ba.toString()}GYd(Ba,Wa,Na){Ba&&(Na=Na?D.h(this.$).ga.pa.activeCell:Ba.topLeft,Wa?
this.gridView.ga.updateSelection(Ba,Na,0,1):this.gridView.ga.jH([Ba],0,Na,0))}Ibd(Ba,Wa,Na,ta,V){const ia=y.d(this.Lac),X=y.g(this.Lac),la=Wa+(1!==this.uLa&&ia?1:0),sa=ta-(1!==this.uLa&&X?1:0),Va=this.gridView.inRangePicker||this.gridView.Wi;if(Ba){var nb=Va&&!I.a.cac(this.gridView.ga.rangePicker.fP).length?new r.Range(la,Na,sa,V,!1,!1):Va?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.pa.activeCell;nb=new r.Range(nb.top<la?nb.top:la,nb.left<Na?nb.left:Na,nb.bottom>sa?nb.bottom:sa,nb.right>
V?nb.right:V,!1,!1)}else nb=new r.Range(la,Na,sa,V,!1,!1);if(1!==this.uLa&&(ia||X)&&(!Ba||Ba&&this.X9c(nb,la,Na,sa,V))){Ba=Va?I.a.cac(this.gridView.ga.rangePicker.fP):this.gridView.ga.pa.selectedRanges;for(const ha of Ba)if(this.X9c(ha,la,Na,sa,V)){nb.top=Wa;nb.bottom=ta;break}}return nb}ptf(Ba){const Wa=this.gridView.inRangePicker||this.gridView.Wi?I.a.cac(this.gridView.ga.rangePicker.fP):this.gridView.ga.pa.selectedRanges;for(const Na of Wa)if(this.X9c(Na,Ba.top,Ba.left,Ba.bottom,Ba.right))return!0;
return!1}X9c(Ba,Wa,Na,ta,V){return!!Ba&&Ba.top===Wa&&Ba.bottom===ta&&Ba.left===Na&&Ba.right===V}};bb=Object(e.b)([Object(Ia.d)(oa.ub),Object(e.c)(0,Object(oa.A)())],bb);Object(b.a)(bb,"TableManager",n.a,[373,2]);class Za extends f.a{constructor(Ba){super();this.tableManager=null;this.$=Ba;this.kc()}create(){this.Pb(this.tableManager||(this.tableManager=new bb(this.$)))}}Object(b.a)(Za,"TableManagerFactory",f.a,[]);a.d(C,"a",function(){return Xa});const Xa=()=>{c.a.Fa(Ba=>{P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",
!1)||Ba.da.Ja(134,new Za(Ba))})};String(u);window.___1684305476354_closurehack=u},1261:function(u,C,a){var c=a(10);u=a(0);var b=a(229),f=a(15),e=a(126),d=a(123),h=a(33),l=a(39);class k extends d.a{constructor(B,D){super(B,D)}execute(B){const D=Object(e.a)(7,B.mf);f.ULS.shipAssertTag(537153921,0,h.a.Ysb(B.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");D.yJ(!0,!0);B.activityState[l.a.J3b]=D.ea.sessionId;B.activityState[l.a.rrb]=!0;B.activityState[l.a.P3b]=
!0;f.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(u.a)(k,"SessionReloadActivity",d.a,[]);var n=a(8);class v extends b.a{constructor(){super();this.kc()}create(){this.Pb(new k(n.a.Wgb,n.a.kA))}static la(B){B.da.Ja(142,new v)}}Object(u.a)(v,"SessionReloadActivityFactory",b.a,[]);var x=a(61),w=a(280),r=a(129),t=a(51),A=a(48),y=a(38),z=a(1),E=a(44),G=a(258),F=a(125);class O extends d.a{constructor(B,D,I,S,J){super(B,D);
O.zEd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];O.yEd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];O.HCf=[-1468309555,611268539,-1750576502,61029505];O.GCf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.rFc=I;this.KZj=S;this.l8j=J}execute(B){var D=Object(e.a)(7,B.mf);B.activityState[l.a.zua]=!0;var I=O.Hei(B);if(O.uTj(B,I))return O.ZTi(B),I=50,0<B.errors.length&&(I=15),f.ULS.sendTraceTag(537153891,
0,I,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.Ic(B.errors)}`),B.activityState[l.a.zua]=!1,this.Wh(n.a.idle),3;switch(I){case 1:case 3:this.svi(B,I);break;case 2:this.rvi(B);break;case 0:B.activityState[l.a.W0a]=null}f.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${I}. activityName:${this.activityName}. NextActivityName:${this.t1}. TimeFromLastStatefulResponse:${D.ea.GY}.`);var S=y.a.$g(B.activityState,
F.a.rjb);f.ULS.shipAssertTag(40502925,0,!S||S&&(1===I||3===I),`triggerSilentReloadAfterTokenRefresh: ${S}, silentReloadType: ${I}`);D=D.Kl.reloadCount;return 0!==I&&0<D?(S=w.a.ZNa(D,200),f.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${I}] retryNum [${D}] delayInMs [${S}] activityName [${this.activityName}]`),t.a.instance.create(()=>{O.BN(B)},S,A.a.cLj),1):3}svi(B,D){f.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");
const I=Object(e.a)(7,B.mf);B.activityState[l.a.rrb]=!0;I.hmc||E.PageLoadTrackingInfo.instance.Ck("ReopenOnLoad");!O.isEditMode(B)&&h.a.Ysb(B.errors)&&(f.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),B.activityState[l.a.J3b]=I.ea.sessionId,B.activityState[l.a.P3b]=!0);B.REd();3===D?(I.ea.mg()||I.ea.xZi(),I.yJ(!0,!0),this.Wh(this.l8j),B.activityState[l.a.kve]=I.workbookContext.CalcMode):(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===D&&I.yJ(!0,!0),B.activityState[l.a.c1c]=!1,this.Wh(this.rFc))}rvi(B){f.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");B.activityState[l.a.W0a]=null;B.REd();this.Wh(this.KZj);B=Object(e.a)(7,B.mf);B.hmc||(E.PageLoadTrackingInfo.instance.Ck("RefreshOnLoad"),B.XOb())}static BN(B){B.BN()}static Hei(B){const D=Object(e.a)(7,B.mf),I=D.ea,S=O.isEditMode(B);var J=h.a.Fh(B.errors,S?O.yEd:O.zEd);const L=h.a.Fh(B.errors,S?O.GCf:O.HCf),R=D.mS,
Y=D.Kl.reloadCount,Q=D.xa.MaxConsecutiveSilentReloadAllowed,W=D.Kl.Zif(),Ga=h.a.Ic(B.errors),pa=h.a.Ic(B.mCa),aa=0<h.a.ON(Aa=>!Aa.triggerSilentReopenOnly,B.errors).length;let Z=J;const fa=y.a.$g(B.activityState,F.a.rjb);fa&&(Z=!0);const ya={name:"SessionReloadSilentActivity.GetSilentReloadType"};ya.editMode=S;ya.isSilentReopenError=J;ya.isSilentRefreshError=L;ya.reloadSequenceCount=D.Kl.OTa;ya.reloadCount=Y;ya.maxReloads=Q;ya.stopSilentReloads=W;ya.errorNames=Ga;ya.processedErrorNames=pa;ya.isClientDirty=
R;ya.errorsForSilentReopenOnly=aa;ya.triggerSilentReloadAfterTokenRefresh=fa;ya.IsReopenDisabled=D.fQa;J=x.a.Zc(ya);f.ULS.sendTraceTag(21837004,0,50,J);if(!W){if(Z&&(S?O.kTj(B):O.nTj(B)))return G.a.mgg(B,D)?3:D.fQa?2:1;if(L&&(S||!I.ffb))return 2}return 0}static uTj(B,D){for(const I of B.errors)if(-1337545025===I.MessageId||-238814601===I.MessageId)return!1;return h.a.ON(I=>!I.triggerSilentReopenOnly,B.errors).length?3!==D:!1}static ZTi(B){const D=h.a.ON(I=>!I.triggerSilentReopenOnly,B.errors);for(const I of D)B.Dea(I)}static isEditMode(B){const D=
Object(e.a)(7,B.mf);return D.ea.Ec?D.Js&&!!(D.$d&64):y.a.$g(B.activityState,l.a.dt)}static nTj(B){const D=Object(e.a)(7,B.mf),I=h.a.l6(B.errors,O.zEd);if(r.b(I,S=>S.ForceVersionUpgrade))return!1;B=h.a.Ysb(B.errors);return!D.ea.ffb||B?!0:!1}static kTj(B){B=h.a.l6(B.errors,O.yEd);return!r.b(B,D=>D.ForceVersionUpgrade)}}O.zEd=null;O.yEd=null;O.HCf=null;O.GCf=null;Object(u.a)(O,"SessionReloadSilentActivity",d.a,[]);class M extends b.a{constructor(B,D){super();this.activityName=B;this.dL=D;this.kc()}create(){this.Pb(new O(this.activityName,
this.dL,n.a.kA,n.a.Dj,n.a.jUb))}static la(B){B.da.Ja(143,new M(n.a.eqa,n.a.A6b));B.da.Ja(144,new M(n.a.ZCc,n.a.ASa));B.da.Ja(145,new M(n.a.$Cc,n.a.iLd));B.da.Ja(154,new M(n.a.Xgb,n.a.mQ))}}Object(u.a)(M,"SessionReloadSilentActivityFactory",b.a,[]);a.d(C,"a",function(){return P});const P=()=>{c.a.Fa(B=>{v.la(B);M.la(B)})}},1279:function(u,C,a){u=a(0);var c=a(229),b=a(15),f=a(178),e=a(259),d=a(384),h=a(6),l=a(667),k=a(93),n=a(101),v=a(272),x=a(176),w=a(83),r=a(428),t=a(52),A=a(40),y=a(91),z=a(76),E=
a(1),G=a(587),F=a(20),O=a(30);class M extends n.a{constructor(R,Y){super(R);this.vU=[];this.Cje=null;this.vPb=Q=>{let W="forward";Q.Values[d.a.direction]?W=Q.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Q=0;let Ga=!0;"backward"===W?(Q=this.WAd.length-1,Ga=!1):"forward"===W?(Q=0,Ga=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${W}`);this.QEf(Ga,Q,!1)};this.yNf=()=>{this.vU=[]};this.fSa=Q=>{-411645385===
this.$.shortcutKeyManager.Ds(Q,!0)&&this.Orf()&&(this.$.Ia.$b(new y.a(-411645385,1,this.$.Kc,6,null),{["event"]:Q},Q),Q.stopPropagation())};this.o8i=Q=>{this.Noa(Q)};this.Jb=Y;this.iu=F.h(this.Jb);this.od.la("keydown",this.o8i);this.od.la("keyup",this.fSa);v.a(Y).OYg(this.yNf);w.a(Y.xa,27)&&A.TaskExtensions.za(t.GetServiceTaskFactory.Za(Y.da,21,137,1),Q=>{Q=Q.result;Q.fn(f.a.Ckf);Q.hl(f.a.Ckf,this.vPb)},Y.ka)}get $(){return this.Jb}get WAd(){this.vU.length||(this.vU=this.Raf());return this.vU}get Qna(){return this.Cje}set Qna(R){this.Cje=
R;this.vU=this.Raf()}dispose(){this.$&&v.a(this.$).Azj(this.yNf);this.Jb=null;this.vU.length=0;super.dispose()}pmj(R){this.Noa(R)}QEf(R,Y,Q=!0,W=null){var Ga=this.a4j(R,Y,Q,W);if(!Ga){Q=Y;var pa=R?1:-1,aa=this.WAd;do{Ga=!1;if(w.a(this.$.xa,27)){if(Q+=pa,Q>=aa.length||0>Q)Ga=!0}else Q=(Q+pa+aa.length)%aa.length;if(Ga){this.lSi(R,Y,W);break}else if(Ga=this.Lmg(R,Y,Q,!1,W))break}while(Q!==Y)}}a4j(R,Y,Q=!0,W=null){let Ga=null;0<=Y&&(Ga=this.vU[Y]);return(null===Ga||void 0===Ga?0:Ga.sg)&&Ga.Qg(R,Q)?(W&&
z.g(W),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Ga.Ge} into a sub region`),Ga.ek(),!0):!1}Lmg(R,Y,Q,W,Ga=null){Q=this.vU[Q];if(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const pa=v.a(this.Jb).Lx(e.a.qxa),aa=v.a(this.Jb).Lx(e.a.cCb),Z=this.iu.ga.Sa.qS;if(Q===aa&&Z||Q===pa&&!W&&!Z)return!1}if((null===Q||void 0===Q?0:Q.sg)&&Q.Qg(R,!1)){Ga&&z.g(Ga);Q.ek();if(R=this.vU[Y])R.Gk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${R.Ge} to ${Q.Ge}`);
return!0}return!1}lSi(R,Y,Q=null){Q&&z.g(Q);if(Y=this.vU[Y])Y.Gk(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${Y.Ge}`);A.TaskExtensions.za(t.GetServiceTaskFactory.Za(this.$.da,21,137,0),W=>{W.result.sendMessage(f.a.Zqb,{[d.a.direction]:R?"forward":"backward"})},this.$.ka)}Noa(R){var Y=this.$.isEditMode?x.a(this.$):null;if(!this.$.Ob.Hza||M.gDi(Y))if(117===R.keyCode&&(R.ctrlKey||z.b(R))){Y=this.Vdf(R.target);var Q=!R.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${Y}`);
if(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var W=v.a(this.Jb).Lx(e.a.BPb);W=this.vU.indexOf(W);h.AFrameworkApplication.sa.Qa.Sx&&this.$.Y0&&-1!==W&&Y===W&&l.ShyRibbon.KK(this.$.dib,0)}else h.AFrameworkApplication.sa.Qa.Sx&&this.$.Y0&&1===Y&&l.ShyRibbon.KK(this.$.dib,0);this.QEf(Q,Y,!0,R)}else 117!==R.keyCode||M.M2e?-411645385===this.$.shortcutKeyManager.Ds(R)?this.Orf()&&(this.$.Ia.$b(new y.a(-411645385,1,this.$.Kc,6,null),{["event"]:R},R),R.stopPropagation()):
1588554917===this.$.shortcutKeyManager.Ds(R)?0===this.mode?(G.a(this.$)||this.$.Ia.$b(new y.a(1588554917,1,this.$.Kc,6,null),{["event"]:R},R),R.preventDefault(),R.stopPropagation()):3===this.mode&&(R.preventDefault(),R.stopPropagation()):-1966746939===this.$.shortcutKeyManager.Ds(R)?(R.preventDefault(),R.stopPropagation()):E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.Ds(R)?(Y=this.Vdf(R.target),W=v.a(this.Jb).Lx(e.a.BPb),
Q=v.a(this.Jb).Lx(e.a.qxa),W=this.vU.indexOf(W),Q=this.vU.indexOf(Q),h.AFrameworkApplication.sa.Qa.Sx&&this.$.Y0&&-1!==W&&Y===W&&1===this.$.dib&&l.ShyRibbon.KK(1,0),-1!==Q&&Y!==Q&&this.Lmg(!0,Y,Q,!0,R)):this.Iki(R):(R=r.a.FF.notificationBar.x5(k.a.m5h(),!1),O.a.YFb()?R.image=3:R.image=0,r.a.FF.notificationBar.CD(R),M.M2e=!0)}Vdf(R){const Y=this.WAd;for(let Q=0,W=Y.length;Q<W;++Q){const Ga=Y[Q];if(Ga&&Ga.hi(R))return Q}return-1}Raf(){const R=[];for(let Y=0,Q=this.Qna.length;Y<Q;Y++){const W=v.a(this.$).Lx(this.Qna[Y]);
W&&R.push(W)}return R}Orf(){return 0===this.mode||4===this.mode}static gDi(R){return R?R.inKeytipMode:!1}}M.M2e=!1;Object(u.a)(M,"AccessibilityManager",n.a,[291,2]);var P=a(162),B=a(23),D=a(16);class I extends M{constructor(R){super(document.documentElement,R);this.uD=0;this.J4g=[e.a.GNe,e.a.xHd,e.a.lkc,e.a.B4d,e.a.BPb,e.a.r6c,e.a.$jd,e.a.Igf,e.a.B5c,e.a.hHc,e.a.k_j,e.a.cCb,e.a.w7c,e.a.qxa,e.a.GZd,e.a.C7c,e.a.glg,e.a.Fyf,e.a.U5c];this.Sjk=[e.a.lkc,e.a.lwg,e.a.kwg,e.a.mwg];this.Slj=[e.a.lkc,e.a.UXf,
e.a.VXf,e.a.YXf];this.Rbh=[e.a.Q5e,e.a.Hgf,e.a.Zjd,e.a.Yjd,e.a.CRe];this.tlj=[e.a.GNe,e.a.xHd,e.a.r6c,e.a.$jd,e.a.B5c,e.a.hHc,e.a.cCb,e.a.w7c,e.a.qxa,e.a.GZd,e.a.qXf,e.a.C7c,e.a.U5c];this.Hlj=[e.a.cCb,e.a.V5e];const Y=D.a.instance.Ha(253);this.uNj=this.$.shortcutKeyManager.$Ab(Y);this.mode=0;R.da.Ja(15,this);A.TaskExtensions.za(t.GetServiceTaskFactory.Za(R.da,21,137,1),Q=>{Q=Q.result;Q.fn(f.a.Zqb);Q.hl(f.a.Zqb,this.vPb)},R.ka)}get mode(){return this.uD}set mode(R){this.uD=R;switch(R){case 0:this.Qna=
this.J4g;break;case 2:this.Qna=this.Sjk;break;case 3:this.Qna=this.Slj;break;case 4:this.Qna=this.Rbh;break;case 5:this.Qna=this.tlj;break;case 6:this.Qna=this.Hlj;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Noa(R){this.$.$d&65536&&super.Noa(R)}Iki(R){if(B.a.equals(this.uNj,this.$.shortcutKeyManager.jnd(R),!1)){const Y=P.b(this.$);if(null===Y||void 0===Y?0:Y.sg)z.g(R),Y.Qg(!0,!1)}}}Object(u.a)(I,"EwaAccessibilityManager",M,[]);class S extends c.a{constructor(R){super();
this.$=R;this.kc()}create(){this.Pb(this.$.da.Ba(15)||new I(this.$))}static la(R){R.da.Ja(157,new S(R))}}Object(u.a)(S,"AccessibilityManagerFactory",c.a,[]);var J=a(10);a.d(C,"a",function(){return L});const L=()=>{J.a.Fa(S.la)}},1303:function(u,C,a){u=a(0);var c=a(113),b=a(229),f=a(15),e=a(14),d=a(42),h=a(91),l=a(1),k=a(20),n=a(7);class v extends d.a{constructor(A,y,z){super();this.statusBarManager=null;this.PTe=()=>{this.Rbc()};this.Rxh=()=>{this.Rbc()};this.OTe=E=>{10===E&&this.Rbc()};this.onKeyDown=
E=>13===E.Da.keyCode?(E=new h.a(237279923,1,2,6,null),this.$.Ia.$b(E,{[n.a.skipClipboardAccess]:!0,[n.a.SXe]:!0}),!0):!1;this.$=A;this.yp=y;this.xn=z;this.Pfd=!1;(this.rhg=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7568646_PressEnterToPaste"))&&this.$.da.Gb(29,E=>{this.statusBarManager=E;E.BK(this)})}dispose(){this.oj();this.xn=this.yp=this.$=null;this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null)}ro(){return this.rhg}ut(A,y){if("QueryPasteShortcutEnabledLabel"!==
A&&!v.l2j.includes(A))return!1;const z=this.No();"QueryPasteShortcutEnabledLabel"===A?(y.Visible=z,f.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${z} for commandId ${A}`)):(y.Visible=!z,f.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!z} for commandId ${A}`));return!0}MCh(){this.mj();this.raiseEvent("pasteShortcutStatusChanged")}Rbc(){this.oj();this.raiseEvent("pasteShortcutStatusChanged")}No(){return this.Pfd}qr(A){this.addHandler("pasteShortcutStatusChanged",
A)}Rr(A){this.removeHandler("pasteShortcutStatusChanged",A)}mj(){if(!this.No()){this.Pfd=!0;k.h(this.$).Rh.ao(this.PTe);this.xn.la("blur",this.Rxh);const A=this.$.da.Ba(65);A&&A.o5&&A.o5.registerForCommentEvents(this.OTe);this.yp.Jt(e.a.yc,this.$.yw,this.onKeyDown,!0)}}oj(){if(this.No()){this.Pfd=!1;k.h(this.$).Rh.Un(this.PTe);this.xn.detach("blur");const A=this.$.da.Ba(65);A&&A.o5&&A.o5.unregisterForCommentEvents(this.OTe);this.yp.Vt(e.a.yc,this.$.yw,this.onKeyDown,!0)}}}v.l2j=["QuerySheetNumberButton",
"QueryWorkbookStatisticsButton"];Object(u.a)(v,"PasteShortcutManager",d.a,[403,196,197,2]);var x=a(141);class w extends b.a{constructor(A){super();this.$=A;this.kc()}create(){const A=this.$;this.Pb(A.da.Ba(478)||this.$.da.Ja(478,new v(A,c.KeyInputManager.instance,x.a.instance.sI())))}static la(A){A.da.Ja(479,new w(A))}}Object(u.a)(w,"PasteShortcutManagerFactory",b.a,[]);var r=a(10);a.d(C,"a",function(){return t});const t=()=>{r.a.Fa(A=>{w.la(A)})}},1304:function(u,C,a){var c=a(10);u=a(0);var b=a(722),
f=a(15),e=a(108),d=a(6),h=a(1402),l=a(1),k=a(198),n=a(62);class v{constructor(G,F,O){this.cxb=null;this.$=G;F?(f.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.cxb=new h.a(G,F,O)):f.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}hd(){return!1}executeCommand(G,F,O){G=!1;switch(F.command){case 73979048:this.cxb&&this.cxb.Xkj(F,
e.a.instance,d.AFrameworkApplication.fa,O),G=!0}return G?n.Task.Ua(!0):k.a(F.command)}Tc(G,F){return 73979048===F.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}ld(){return!1}dispose(){this.cxb&&this.cxb.dispose()}}Object(u.a)(v,"DataFromPictureCommandHandler",null,[200,2]);var x=a(40),w=a(52),r=a(100),t=a(149),A=a(36),y=a(71);class z extends b.a{constructor(G){super(G)}he(){const G=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",
!1)?Object(r.d)(t.a.resolve(A.f,{Wa:1})):w.GetServiceTaskFactory.Za(this.$.da,328,327,1),F=Object(y.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?Object(r.d)(t.a.resolve(A.yb,{Wa:this.La})):w.GetServiceTaskFactory.Za(this.$.da,484,485,1);x.TaskExtensions.za(x.TaskExtensions.ke([G,F],this.$.ka),()=>{this.Pd([new v(this.$,G.result,F.result)])},this.$.ka,3)}static la(G){b.a.ye(452,new z(G))}}Object(u.a)(z,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return E});const E=
()=>{c.a.Fa(G=>{z.la(G)})}},1305:function(u,C,a){u={};a.r(u);a.d(u,"SparklineManager",function(){return v});var c=a(10),b=a(71),f=a(0),e=a(229),d=a(119),h=a(487),l=a(20),k=a(149),n=a(36);let v=class extends h.a{constructor(r){super(Object(l.h)(r));Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||r.da.Ja(240,this)}Rei(r){for(const t of this.rangeList)if(r.range.contains(t))return t;return null}zPd(r){return r.GridBlockModel&&(r=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(r.GridBlockModel))?
r.getSparklineRanges():null}};v=Object(d.b)([Object(k.d)(n.tb),Object(d.c)(0,Object(n.A)())],v);Object(f.a)(v,"SparklineManager",h.a,[374]);class x extends e.a{constructor(r){super();this.sparklineManager=null;this.$=r;this.kc()}create(){this.Pb(this.sparklineManager||(this.sparklineManager=new v(this.$)))}static la(r){r.da.Ja(239,new x(r))}}Object(f.a)(x,"SparklineManagerFactory",e.a,[]);a.d(C,"a",function(){return w});const w=()=>{c.a.Fa(r=>{Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||
x.la(r)})};String(u);window.___1684305475863_closurehack=u},1306:function(u,C,a){u=a(0);var c=a(562),b=a(88),f=a(15),e=a(170),d=a(6),h=a(43),l=a(82),k=a(798);class n{constructor(r,t){this.UYc=this.TYc=null;this.h0a=new e.a;this.lh=r;this.BIa=t.appSettings[n.Qkk]||""}get XSj(){return this.h0a.task}get k5(){return this.lh.value}nCj(){const r={};r[n.eni]=d.AFrameworkApplication.ej;r["Content-Type"]="application/json; charset=utf-8";f.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const t=l.a.Pl(this.BIa+n.YSj,n.x_i,d.AFrameworkApplication.sa.Qa.Ii.toString());this.k5.Fn(t,1,"",r,!0,2,Object(b.a)(this,this.wLb,"onSuccessCallback"),Object(b.a)(this,this.GKb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}AQi(r){try{const t={};t.FlightName=r.FlightName;t.SessionID=r.SessionID;f.ULS.sendTraceTag(594883776,215,50,h.c(t))}catch(t){f.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}wLb(r){if((r=r.data.Fe)&&r.length)try{const t=h.a(r);this.TYc=t.NavBarDataJson;
f.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.TYc?({qt:this.UYc}=h.d(t.NavBarDataJson)).returnValue?(this.AQi(this.UYc),this.h0a.setResult(this.UYc)):(f.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:k.a.wjb(this.TYc)}),this.h0a.Pt()):(f.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.h0a.Pt())}catch(t){f.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.h0a.Pt()}else f.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")}GKb(){this.h0a.Pt();f.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return n.Oa||(n.Oa=n.Tla())}static Tla(){return new n(new c.a(()=>d.AFrameworkApplication.de),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Qa.Ii)}}n.eni="X-qs";n.x_i="at";n.YSj="O365ShellServiceProxy.ashx";n.Oa=null;n.Qkk="ShellWebServiceBase";Object(u.a)(n,"O365ShellActor",null,[393]);var v=a(260);class x{constructor(){this.Db=
null}get name(){return"Common.App.O365Shell"}Di(r){this.Db=r;this.Db.register(n,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").Uc().dd(()=>new n(new c.a(()=>d.AFrameworkApplication.de),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Qa.Ii))}init(){d.AFrameworkApplication.fa.Hv(Object(b.a)(this,this.DC,"onFullAppSettingsReady"))}DC(){d.AFrameworkApplication.useO365ShellService&&d.AFrameworkApplication.sa.Qa.Kv&&this.Db.resolve("Common.App.O365Shell.O365ShellActor").nCj()}dispose(){}static main(){v.a.instance.nj(new x)}}
Object(u.a)(x,"PackageManager",null,[4,5]);a.d(C,"a",function(){return w});const w=()=>{Type.registerNamespace("Common.App.O365Shell");x.main()}},1402:function(u,C,a){(function(c){a.d(C,"a",function(){return G});var b=a(0),f=a(15),e=a(185),d=a(126),h=a(1408),l=a(42),k=a(261),n=a(47),v=a(382),x=a(200),w=a(58),r=a(91),t=a(16),A=a(20),y=a(43),z=a(1409),E=a(1);class G extends l.a{constructor(F,O,M){super();this.Uqi=h.a.getTypeName();this.qDb=this.rV=this.Wd=null;this.imageHeight=this.imageWidth=0;this.XOa=
this.errorMessage=this.tableData=null;this.Xsd=0;this.v0c=!1;this.tRe=P=>{if(P){var B={};if(({qt:B}=y.d(this.quh(P.data))).returnValue&&(P=Object(d.a)(Object,B),"."===P.DataFromPictureWildcard))if(P.SessionId!==this.XOa)f.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
P.CmdType){case "ACK":this.v0c=!0;this.qng.stop();f.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.MJj();0<this.errorMessage.length?this.abg():0<this.tableData.length&&this.tbg();break;case "insert_html":const I=this.$.qa.va;B={};var D=A.h(this.$).ga.pa.Hd.clone();B.PasteId=e.a.create().toString();B.DestinationRanges=n.s(n.v(D,this.$));D=P.Parameters.split("|",3);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||f.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${D[0]}|${D[1]}|${D[2]}.`);D=P.Parameters.indexOf("|");D=P.Parameters.indexOf("|",D+1);D=P.Parameters.indexOf("|",D+1);B.SourceHtml=P.Parameters.substring(D+1);B.CopyOperationId=null;const S=I.Pa(1,I.Bc());S.pasteHtmlParameters=B;v.a(this.$.userOperationManager,(J,L,R)=>w.g(I,"pasteHtmlContent",S,J,L,R,null,64),J=>new x.a(204,0,J,1),null);this.Xsd++;f.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Xsd.toString()}`)}}};
this.Tqi=(P,B)=>{if(P=B.QB)if(!B.parentPath||1>=B.parentPath.length||B.parentPath[1]!==this.XOa)f.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");B=P.errorCode;switch(B){case null:case -1:this.errorMessage=t.a.instance.ha(2273);break;case 1:this.errorMessage=t.a.instance.ha(2274);
break;case 2:this.errorMessage=t.a.instance.ha(2275)}0<this.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${B?B.toString():"null"}.`);this.BAe.stop();this.tableData=P.html;this.v0c&&(0<this.errorMessage.length?this.abg():0<this.tableData.length&&this.tbg())}else f.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=F;this.augmentationLoopManager=
O;this.uploaderCreator=M;this.initialize()}dispose(){window.removeEventListener("message",this.tRe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}ocj(F,O){f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let M=new Image;M.onload=()=>{var P=document.createElement("canvas");P.width=M.width;P.height=M.height;const B=P.getContext("2d");try{B.drawImage(M,0,0,M.width,M.height)}catch(S){f.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${S.message}`);
return}let D;try{D=P.toDataURL("image/jpeg")}catch(S){f.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${S.message}`);return}P=D.split(",");if(2>P.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{P=P[1];try{var I=window.self.atob(P)}catch(S){f.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${S.message}`);
return}28E5<I.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),O.BXj()):(this.NFj(this.Wd,this.rV,P,M.width,M.height),URL.revokeObjectURL(M.src),M=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};M.src=F}Xkj(F,O,M,P){this.Wd=F;this.rV=P;this.uploaderCreator.Jti(this.$,O,M,P,this)}NFj(F,O,M,P,B){this.XOa=e.a.create().toString();this.Xsd=0;this.qDb=M;this.imageWidth=P;this.imageHeight=
B;this.errorMessage=this.tableData="";this.v0c=!1;this.qng=this.$.nc.hh("LoadResource","DataFromPictureTaskpaneLaunch");this.qng.start();this.Vej(F,O);this.BAe=this.$.nc.hh("LoadResource","DataFromPictureAnnotation");this.BAe.start();this.ihk()}ihk(){if(this.qDb.length){var F=window.self.atob(this.qDb);var O=new Uint8Array(F.length);for(let M=0;M<F.length;M++)O[M]=F.charCodeAt(M);this.augmentationLoopManager.hhk(O,this.XOa,this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}Vej(F,
O){O.SessionID=this.XOa;O.DataFromPictureAssetId="FA000000050";O.LoadDataFromPictureTaskpane=!0;F=new r.a(-859308420,F.method,F.mode,F.yf,F.tabName);this.$.Ia.$b(F,O)}lfd(F){try{const O=c.from(F,"utf16le").toString("base64");return z.a.ZKa(this.XOa,O)}catch(O){return f.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}quh(F){try{const O=z.a.ZKa(this.XOa,F);return c.from(O,"base64").toString("utf16le")}catch(O){return f.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}MJj(){if(this.qDb.length){var F=k.a(this.$).$ca("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.imageData=this.lfd(this.qDb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",O,M=>{M&&f.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}tbg(){if(this.tableData.length){var F=
k.a(this.$).$ca("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.tableHtml=this.lfd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",O,M=>{M&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}abg(){if(this.errorMessage.length){var F=
k.a(this.$).$ca("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.errorMessage=this.lfd(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",O,M=>{M&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.tRe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.j0().v2("DataFromPicture").t2(()=>{}).activateAnnotation({annotationType:this.Uqi,Jv:!1,HO:this.Tqi}).build())}}Object(b.a)(G,"DataFromPictureManager",l.a,[419])}).call(this,a(1403).ryg)},1403:function(u,C,a){(function(c){function b(){try{var B=new Uint8Array(1);B.__proto__={__proto__:Uint8Array.prototype,Pnk:function(){return 42}};return"function"===typeof B.subarray&&0===B.subarray(1,1).byteLength}catch(D){return!1}}
function f(B,D){if((e.qQ?2147483647:1073741823)<D)throw new RangeError("Invalid typed array length");e.qQ?(B=new Uint8Array(D),B.__proto__=e.prototype):(null===B&&(B=new e(D)),B.length=D);return B}function e(B,D,I){if(!(e.qQ||this instanceof e))return new e(B,D,I);if("number"===typeof B){if("string"===typeof D)throw Error("If encoding is specified then the first argument must be a string");return l(this,B)}return d(this,B,D,I)}function d(B,D,I,S){if("number"===typeof D)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&D instanceof ArrayBuffer){D.byteLength;if(0>I||D.byteLength<I)throw new RangeError("'offset' is out of bounds");if(D.byteLength<I+(S||0))throw new RangeError("'length' is out of bounds");D=void 0===I&&void 0===S?new Uint8Array(D):void 0===S?new Uint8Array(D,I):new Uint8Array(D,I,S);e.qQ?(B=D,B.__proto__=e.prototype):B=k(B,D);D=B}else if("string"===typeof D){S=B;B=I;if("string"!==typeof B||""===B)B="utf8";if(!e.hqf(B))throw new TypeError('"encoding" must be a valid string encoding');
I=x(D,B)|0;S=f(S,I);D=S.write(D,B);D!==I&&(S=S.slice(0,D));D=S}else D=n(B,D);return D}function h(B){if("number"!==typeof B)throw new TypeError('"size" argument must be a number');if(0>B)throw new RangeError('"size" argument must not be negative');}function l(B,D){h(D);B=f(B,0>D?0:v(D)|0);if(!e.qQ)for(var I=0;I<D;++I)B[I]=0;return B}function k(B,D){var I=0>D.length?0:v(D.length)|0;B=f(B,I);for(var S=0;S<I;S+=1)B[S]=D[S]&255;return B}function n(B,D){if(e.isBuffer(D)){var I=v(D.length)|0;B=f(B,I);if(0===
B.length)return B;D.copy(B,0,0,I);return B}if(D){if("undefined"!==typeof ArrayBuffer&&D.buffer instanceof ArrayBuffer||"length"in D)return(I="number"!==typeof D.length)||(I=D.length,I=I!==I),I?f(B,0):k(B,D);if("Buffer"===D.type&&O(D.data))return k(B,D.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function v(B){if(B>=(e.qQ?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.qQ?2147483647:
1073741823).toString(16)+" bytes");return B|0}function x(B,D){if(e.isBuffer(B))return B.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(B)||B instanceof ArrayBuffer))return B.byteLength;"string"!==typeof B&&(B=""+B);var I=B.length;if(0===I)return 0;for(var S=!1;;)switch(D){case "ascii":case "latin1":case "binary":return I;case "utf8":case "utf-8":case void 0:return y(B).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
I;case "hex":return I>>>1;case "base64":return E(B).length;default:if(S)return y(B).length;D=(""+D).toLowerCase();S=!0}}function w(B,D,I){var S=!1;if(void 0===D||0>D)D=0;if(D>this.length)return"";if(void 0===I||I>this.length)I=this.length;if(0>=I)return"";I>>>=0;D>>>=0;if(I<=D)return"";for(B||(B="utf8");;)switch(B){case "hex":B=D;D=I;I=this.length;if(!B||0>B)B=0;if(!D||0>D||D>I)D=I;S="";for(I=B;I<D;++I)B=S,S=this[I],S=16>S?"0"+S.toString(16):S.toString(16),S=B+S;return S;case "utf8":case "utf-8":return A(this,
D,I);case "ascii":B="";for(I=Math.min(this.length,I);D<I;++D)B+=String.fromCharCode(this[D]&127);return B;case "latin1":case "binary":B="";for(I=Math.min(this.length,I);D<I;++D)B+=String.fromCharCode(this[D]);return B;case "base64":return 0===D&&I===this.length?F.b6e(this):F.b6e(this.slice(D,I));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":D=this.slice(D,I);I="";for(B=0;B<D.length;B+=2)I+=String.fromCharCode(D[B]+256*D[B+1]);return I;default:if(S)throw new TypeError("Unknown encoding: "+
B);B=(B+"").toLowerCase();S=!0}}function r(B,D,I,S,J){if(0===B.length)return-1;"string"===typeof I?(S=I,I=0):2147483647<I?I=2147483647:-2147483648>I&&(I=-2147483648);I=+I;isNaN(I)&&(I=J?0:B.length-1);0>I&&(I=B.length+I);if(I>=B.length){if(J)return-1;I=B.length-1}else if(0>I)if(J)I=0;else return-1;"string"===typeof D&&(D=e.from(D,S));if(e.isBuffer(D))return 0===D.length?-1:t(B,D,I,S,J);if("number"===typeof D)return D&=255,e.qQ&&"function"===typeof Uint8Array.prototype.indexOf?J?Uint8Array.prototype.indexOf.call(B,
D,I):Uint8Array.prototype.lastIndexOf.call(B,D,I):t(B,[D],I,S,J);throw new TypeError("val must be string, number or Buffer");}function t(B,D,I,S,J){function L(W,Ga){return 1===R?W[Ga]:W.orj(Ga*R)}var R=1,Y=B.length,Q=D.length;if(void 0!==S&&(S=String(S).toLowerCase(),"ucs2"===S||"ucs-2"===S||"utf16le"===S||"utf-16le"===S)){if(2>B.length||2>D.length)return-1;R=2;Y/=2;Q/=2;I/=2}if(J)for(S=-1;I<Y;I++)if(L(B,I)===L(D,-1===S?0:I-S)){if(-1===S&&(S=I),I-S+1===Q)return S*R}else-1!==S&&(I-=I-S),S=-1;else for(I+
Q>Y&&(I=Y-Q);0<=I;I--){Y=!0;for(S=0;S<Q;S++)if(L(B,I+S)!==L(D,S)){Y=!1;break}if(Y)return I}return-1}function A(B,D,I){I=Math.min(B.length,I);for(var S=[];D<I;){var J=B[D],L=null,R=239<J?4:223<J?3:191<J?2:1;if(D+R<=I)switch(R){case 1:128>J&&(L=J);break;case 2:var Y=B[D+1];128===(Y&192)&&(J=(J&31)<<6|Y&63,127<J&&(L=J));break;case 3:Y=B[D+1];var Q=B[D+2];128===(Y&192)&&128===(Q&192)&&(J=(J&15)<<12|(Y&63)<<6|Q&63,2047<J&&(55296>J||57343<J)&&(L=J));break;case 4:Y=B[D+1];Q=B[D+2];var W=B[D+3];128===(Y&
192)&&128===(Q&192)&&128===(W&192)&&(J=(J&15)<<18|(Y&63)<<12|(Q&63)<<6|W&63,65535<J&&1114112>J&&(L=J))}null===L?(L=65533,R=1):65535<L&&(L-=65536,S.push(L>>>10&1023|55296),L=56320|L&1023);S.push(L);D+=R}B=S.length;if(B<=M)S=String.fromCharCode.apply(String,S);else{I="";for(D=0;D<B;)I+=String.fromCharCode.apply(String,S.slice(D,D+=M));S=I}return S}function y(B,D){D=D||Infinity;for(var I,S=B.length,J=null,L=[],R=0;R<S;++R){I=B.charCodeAt(R);if(55295<I&&57344>I){if(!J){if(56319<I){-1<(D-=3)&&L.push(239,
191,189);continue}else if(R+1===S){-1<(D-=3)&&L.push(239,191,189);continue}J=I;continue}if(56320>I){-1<(D-=3)&&L.push(239,191,189);J=I;continue}I=(J-55296<<10|I-56320)+65536}else J&&-1<(D-=3)&&L.push(239,191,189);J=null;if(128>I){if(0>--D)break;L.push(I)}else if(2048>I){if(0>(D-=2))break;L.push(I>>6|192,I&63|128)}else if(65536>I){if(0>(D-=3))break;L.push(I>>12|224,I>>6&63|128,I&63|128)}else if(1114112>I){if(0>(D-=4))break;L.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw Error("Invalid code point");
}return L}function z(B){for(var D=[],I=0;I<B.length;++I)D.push(B.charCodeAt(I)&255);return D}function E(B){var D=F,I=D.g7j;B=(B.trim?B.trim():B.replace(/^\s+|\s+$/g,"")).replace(P,"");if(2>B.length)B="";else for(;0!==B.length%4;)B+="=";return I.call(D,B)}function G(B,D,I,S){for(var J=0;J<S&&!(J+I>=D.length||J>=B.length);++J)D[J+I]=B[J];return J}var F=a(1405);a(1406);var O=a(1407);C.ryg=e;C.dnk=function(B){+B!=B&&(B=0);return e.Uze(+B)};C.Jmk=50;e.qQ=void 0!==c.qQ?c.qQ:b();C.$nk=e.qQ?2147483647:1073741823;
e.from=function(B,D,I){return d(null,B,D,I)};e.qQ&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0}));e.Uze=function(B){h(B);return f(null,B)};e.P_g=function(B){return l(null,B)};e.isBuffer=function(B){return!(null==B||!B.PIg)};e.compare=function(B,D){if(!e.isBuffer(B)||!e.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(B===D)return 0;
for(var I=B.length,S=D.length,J=0,L=Math.min(I,S);J<L;++J)if(B[J]!==D[J]){I=B[J];S=D[J];break}return I<S?-1:S<I?1:0};e.hqf=function(B){switch(String(B).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=function(B,D){if(!O(B))throw new TypeError('"list" argument must be an Array of Buffers');if(0===B.length)return e.Uze(0);var I;if(void 0===D)for(I=D=
0;I<B.length;++I)D+=B[I].length;D=e.P_g(D);var S=0;for(I=0;I<B.length;++I){var J=B[I];if(!e.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(D,S);S+=J.length}return D};e.byteLength=x;e.prototype.PIg=!0;e.prototype.toString=function(){var B=this.length|0;return 0===B?"":0===arguments.length?A(this,0,B):w.apply(this,arguments)};e.prototype.equals=function(B){if(!e.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B?!0:0===e.compare(this,
B)};e.prototype.compare=function(B,D,I,S,J){if(!e.isBuffer(B))throw new TypeError("Argument must be a Buffer");void 0===D&&(D=0);void 0===I&&(I=B?B.length:0);void 0===S&&(S=0);void 0===J&&(J=this.length);if(0>D||I>B.length||0>S||J>this.length)throw new RangeError("out of range index");if(S>=J&&D>=I)return 0;if(S>=J)return-1;if(D>=I)return 1;D>>>=0;I>>>=0;S>>>=0;J>>>=0;if(this===B)return 0;var L=J-S,R=I-D,Y=Math.min(L,R);S=this.slice(S,J);B=B.slice(D,I);for(D=0;D<Y;++D)if(S[D]!==B[D]){L=S[D];R=B[D];
break}return L<R?-1:R<L?1:0};e.prototype.includes=function(B,D,I){return-1!==this.indexOf(B,D,I)};e.prototype.indexOf=function(B,D,I){return r(this,B,D,I,!0)};e.prototype.lastIndexOf=function(B,D,I){return r(this,B,D,I,!1)};e.prototype.write=function(B,D,I,S){if(void 0===D)S="utf8",I=this.length,D=0;else if(void 0===I&&"string"===typeof D)S=D,I=this.length,D=0;else if(isFinite(D))D|=0,isFinite(I)?(I|=0,void 0===S&&(S="utf8")):(S=I,I=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var J=this.length-D;if(void 0===I||I>J)I=J;if(0<B.length&&(0>I||0>D)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(J=!1;;)switch(S){case "hex":D=Number(D)||0;S=this.length-D;I?(I=Number(I),I>S&&(I=S)):I=S;S=B.length;if(0!==S%2)throw new TypeError("Invalid hex string");I>S/2&&(I=S/2);for(S=0;S<I;++S){J=parseInt(B.substr(2*S,2),16);if(isNaN(J))break;this[D+S]=J}return S;case "utf8":case "utf-8":return G(y(B,this.length-D),this,D,I);case "ascii":return G(z(B),
this,D,I);case "latin1":case "binary":return G(z(B),this,D,I);case "base64":return G(E(B),this,D,I);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":S=B;J=this.length-D;for(var L=[],R=0;R<S.length&&!(0>(J-=2));++R){var Y=S.charCodeAt(R);B=Y>>8;Y%=256;L.push(Y);L.push(B)}return G(L,this,D,I);default:if(J)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase();J=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.knk||this,0)}};var M=4096;e.prototype.slice=
function(B,D){var I=this.length;B=~~B;D=void 0===D?I:~~D;0>B?(B+=I,0>B&&(B=0)):B>I&&(B=I);0>D?(D+=I,0>D&&(D=0)):D>I&&(D=I);D<B&&(D=B);if(e.qQ)D=this.subarray(B,D),D.__proto__=e.prototype;else{I=D-B;D=new e(I,void 0);for(var S=0;S<I;++S)D[S]=this[S+B]}return D};e.prototype.orj=function(B){if(0!==B%1||0>B)throw new RangeError("offset is not uint");if(B+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[B]<<8|this[B+1]};e.prototype.copy=function(B,D,I,S){I||(I=0);
S||0===S||(S=this.length);D>=B.length&&(D=B.length);D||(D=0);0<S&&S<I&&(S=I);if(S===I||0===B.length||0===this.length)return 0;if(0>D)throw new RangeError("targetStart out of bounds");if(0>I||I>=this.length)throw new RangeError("sourceStart out of bounds");if(0>S)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length);B.length-D<S-I&&(S=B.length-D+I);var J=S-I;if(this===B&&I<D&&D<S)for(S=J-1;0<=S;--S)B[S+D]=this[S+I];else if(1E3>J||!e.qQ)for(S=0;S<J;++S)B[S+D]=this[S+I];else Uint8Array.prototype.set.call(B,
this.subarray(I,I+J),D);return J};e.prototype.fill=function(B,D,I,S){if("string"===typeof B){"string"===typeof D?(S=D,D=0,I=this.length):"string"===typeof I&&(S=I,I=this.length);if(1===B.length){var J=B.charCodeAt(0);256>J&&(B=J)}if(void 0!==S&&"string"!==typeof S)throw new TypeError("encoding must be a string");if("string"===typeof S&&!e.hqf(S))throw new TypeError("Unknown encoding: "+S);}else"number"===typeof B&&(B&=255);if(0>D||this.length<D||this.length<I)throw new RangeError("Out of range index");
if(I<=D)return this;D>>>=0;I=void 0===I?this.length:I>>>0;B||(B=0);if("number"===typeof B)for(S=D;S<I;++S)this[S]=B;else for(B=e.isBuffer(B)?B:y((new e(B,S)).toString()),J=B.length,S=0;S<I-D;++S)this[S+D]=B[S%J];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1404))},1404:function(u){var C=function(){return this}();try{C=C||(new Function("return this"))()}catch(a){"object"===typeof window&&(C=window)}u.exports=C},1405:function(u,C){function a(e){var d=e.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");
e=e.indexOf("=");-1===e&&(e=d);return[e,e===d?0:4-e%4]}C.byteLength=function(e){e=a(e);var d=e[1];return 3*(e[0]+d)/4-d};C.g7j=function(e){var d=a(e);var h=d[0];d=d[1];var l=new f(3*(h+d)/4-d),k=0,n=0<d?h-4:h,v;for(v=0;v<n;v+=4)h=b[e.charCodeAt(v)]<<18|b[e.charCodeAt(v+1)]<<12|b[e.charCodeAt(v+2)]<<6|b[e.charCodeAt(v+3)],l[k++]=h>>16&255,l[k++]=h>>8&255,l[k++]=h&255;2===d&&(h=b[e.charCodeAt(v)]<<2|b[e.charCodeAt(v+1)]>>4,l[k++]=h&255);1===d&&(h=b[e.charCodeAt(v)]<<10|b[e.charCodeAt(v+1)]<<4|b[e.charCodeAt(v+
2)]>>2,l[k++]=h>>8&255,l[k++]=h&255);return l};C.b6e=function(e){for(var d=e.length,h=d%3,l=[],k=0,n=d-h;k<n;k+=16383){for(var v=l,x=v.push,w,r=e,t=k+16383>n?n:k+16383,A=[],y=k;y<t;y+=3)w=(r[y]<<16&16711680)+(r[y+1]<<8&65280)+(r[y+2]&255),A.push(c[w>>18&63]+c[w>>12&63]+c[w>>6&63]+c[w&63]);w=A.join("");x.call(v,w)}1===h?(e=e[d-1],l.push(c[e>>2]+c[e<<4&63]+"==")):2===h&&(e=(e[d-2]<<8)+e[d-1],l.push(c[e>>10]+c[e>>4&63]+c[e<<2&63]+"="));return l.join("")};var c=[],b=[],f="undefined"!==typeof Uint8Array?
Uint8Array:Array;for(u=0;64>u;++u)c[u]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(u)]=u;b[45]=62;b[95]=63},1406:function(u,C){C.read=function(a,c,b,f,e){var d=8*e-f-1;var h=(1<<d)-1,l=h>>1,k=-7;e=b?e-1:0;var n=b?-1:1,v=a[c+e];e+=n;b=v&(1<<-k)-1;v>>=-k;for(k+=d;0<k;b=256*b+a[c+e],e+=n,k-=8);d=b&(1<<-k)-1;b>>=-k;for(k+=f;0<k;d=256*d+a[c+e],e+=n,k-=8);if(0===b)b=1-l;else{if(b===h)return d?NaN:Infinity*
(v?-1:1);d+=Math.pow(2,f);b-=l}return(v?-1:1)*d*Math.pow(2,b-f)};C.write=function(a,c,b,f,e,d){var h,l=8*d-e-1,k=(1<<l)-1,n=k>>1,v=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;d=f?0:d-1;var x=f?1:-1,w=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,f=k):(f=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-f))&&(f--,h*=2),c=1<=f+n?c+v/h:c+v*Math.pow(2,1-n),2<=c*h&&(f++,h/=2),f+n>=k?(c=0,f=k):1<=f+n?(c=(c*h-1)*Math.pow(2,e),f+=n):(c=c*Math.pow(2,n-1)*Math.pow(2,e),f=0));for(;8<=
e;a[b+d]=c&255,d+=x,c/=256,e-=8);f=f<<e|c;for(l+=e;0<l;a[b+d]=f&255,d+=x,f/=256,l-=8);a[b+d-x]|=128*w}},1407:function(u){var C={}.toString;u.exports=Array.isArray||function(a){return"[object Array]"==C.call(a)}},1408:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);C=a(746);var c=a(726);class b extends C.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.je()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static je(){return["AugLoop_Core_Annotation"]}}
Object(u.a)(b,"DetectedHtmlTableAnnotation",C.a,[])},1409:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{static ZKa(b,f){if(!(b&&f&&b.length&&f.length)||256<b.length)return"";const e=Array(256),d=Array(256);let h,l=0,k=0;let n,v="";for(h=0;256>h;h++)e[h]=h;for(h=0;256>h;h++){var x=b.charCodeAt(h%b.length);if(256<=x)return"";l=(l+e[h]+x)%256;x=e[h];e[h]=e[l];e[l]=x}for(h=0;256>h;h++)d[h]=e[256-h-1];l=h=0;for(b=0;b<f.length;b++){h=(h+1)%256;l=(l+e[h])%256;x=e[h];e[h]=e[l];e[l]=x;x=f.charCodeAt(b);
if(256<=x)return"";n=x^e[(e[h]+e[l])%256];k=(k+d[h])%256;x=d[h];d[h]=d[k];d[k]=x;v+=String.fromCharCode(n^e[(d[h]+d[k])%256])}return v}}Object(u.a)(c,"RC4A",null,[])},1421:function(u,C,a){u=a(0);var c=a(15),b=a(88);a(112);var f=a(31);class e{constructor(x,w,r){this.xk=this.VKd=null;this.XHa=this.Haa=0;this.EYb=null;this.gU=x;this.Ce=w;this.Ta=r;this.k5a=!1;this.F7d=!0;this.UCj();this.dcb=this.fa.ra("NativeFileOpenDialogIsEnabled")}get context(){return this.gU}get fa(){return this.Ta}get retryCount(){return this.Haa}get jBc(){return this.XHa}ELb(x){this.xk=
x;if(!this.k5a){if(this.F7d){if(this.dcb&&f.a.IG){this.EYb=x.mcc(Object(b.a)(this,this.mJd,"onFileChosen"));return}this.EYb=x.mcc(null);if(!this.XEa(this.EYb,x))return}this.finalizeUpload(x,null)}}mJd(x){if(this.XEa(x,this.xk)){if(f.a.IG||f.a.ng)this.EYb=x;this.finalizeUpload(this.xk,null)}}$vc(){this.VKd&&this.VKd()}UCj(){this.Haa=0;this.XHa=this.fa.oe("Box4UploadRetryDelayStart",200);this.xk&&(this.xk.dispose(),this.xk=null)}}Object(u.a)(e,"FileUploader",null,[]);var d=a(6),h=a(329),l=a(818),k=
a(146),n=a(34);a.d(C,"a",function(){return v});class v extends e{constructor(x,w,r){super(x,w,r);this.p0b=this.nua=null}get SP(){return d.AFrameworkApplication.sa.hF}h$e(x){switch(x){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}Nvg(x){return v.XEa(x,this.Bhi())}Bhi(){return v.Dte}XEa(x,w=null){x=this.Nvg(x);return 0!==x?(w&&w.Sve(),2===x&&this.lk(0,this.h$e(x)),!1):!0}finalizeUpload(x,w){c.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.VKd=w;this.hYj();h.a.mark(5576);this.p0b=this.SP.qd("LoadResource","PictureUploadTime")}lk(x,w){const r=new k.StandardDialog;r.rc=0;r.kB(x,CommonUIStrings.l_ImageUploadFailedTitle,w,null)}$vc(){c.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.$vc();this.p0b&&(this.p0b.stop(),this.p0b=null);this.wfh()}hYj(){this.nua=(new l.a).create();this.nua.message=CommonUIStrings.l_ImageUploadWait;this.nua.rc=5;this.nua.Iu=!1;this.nua.ODa(null,
null,null)}wfh(){this.nua&&(this.nua.close(),this.nua=null)}static eoi(x,w){x=n.a.kl(x);for(let r=0;r<w.length;++r)if(x.endsWith(w[r]))return!0;return!1}static XEa(x,w=null){w||(w=v.Dte);return x?v.eoi(x,w)?0:2:1}}v.Dte=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(v,"PictureUploader",e,[])},1485:function(u,C,a){a.r(C);u=a(1201);C=a(1162);var c=a(1163),b=a(1183),f=a(1303),e=a(1304),d=a(1165),h=a(1225),l=a(1206),k=a(1226),n=a(1250),v=a(1202),x=a(1305),w=a(1167),r=a(1187),t=a(1209),
A=a(1306),y=a(1168),z=a(1251),E=a(1279);a=a(1261);Object(u.a)();Object(C.a)();Object(c.a)();Object(b.a)();Object(f.a)();Object(e.a)();Object(d.a)();Object(h.a)();Object(l.a)();Object(k.a)();Object(n.a)();Object(v.a)();Object(x.a)();Object(w.a)();Object(r.a)();Object(t.a)();Object(A.a)();Object(y.a)();Object(z.a)();Object(E.a)();Object(a.a)()},794:function(u,C,a){u=a(0);var c;(function(d){d[d.none=0]="none";d[d.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";d[d.applyLinkFailed=2]="applyLinkFailed";
d[d.pasteHtmlFailed=3]="pasteHtmlFailed";d[d.pasteStringFailed=4]="pasteStringFailed";d[d.pasteRangeFailed=5]="pasteRangeFailed";d[d.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";d[d.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";d[d.clipboardIsInaccessible=8]="clipboardIsInaccessible";d[d.pasteArtFailed=9]="pasteArtFailed";d[d.noArtSourceItem=10]="noArtSourceItem";d[d.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";
d[d.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";d[d.invalidShadowWorkbook=13]="invalidShadowWorkbook";d[d.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";d[d.failedToPasteExternalImage=15]="failedToPasteExternalImage";d[d.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";d[d.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";d[d.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";
d[d.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";d[d.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";d[d.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";d[d.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed"})(c||(c={}));Object(u.b)("PasteErrorType",c);var b=a(974),f=a(1164);a.d(C,"a",function(){return e});class e extends b.a{constructor(d,h=null,l=
null,k="",n=100){super(c[d]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=d;this.ewaErrors=h;this.validationFailureReason=n;this.innerError=h?new f.a(h,l):l;this.message=k}}Object(u.a)(e,"PasteInnerError",b.a,[])},974:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{constructor(b,f=null){this.errorName=this.innerError=null;this.errorName=b;this.innerError=f}}Object(u.a)(c,"CCPError",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.frs.js.map/5ebefc72818cead4d3fc6f90ec3ffdfc/EwaDSOpt.frs.js.map