'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1175:function(u,C,a){a.d(C,"a",function(){return b});var c=a(521);const b=()=>{c.a.ij(".ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#217346}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.ewa-fb-full-width .ewa-rteTextElement{width:100%}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}")}},
1176:function(u,C,a){a.d(C,"d",function(){return l});a.d(C,"c",function(){return k});a.d(C,"b",function(){return n});a.d(C,"a",function(){return v});var c=a(23),b=a(897),f=a(1177),e=a(121),d=a(138),h=a(577);const l=w=>255<w.length||!x(w)||c.a.nH(w,"_xl")?!1:!0,k=(w,r)=>{var t=r.ga;r=t.pa.Lh;t=t.pa.activeRange;return w.ua.na&&r?b.b(w.Zb,t,w.ua.na.name):null},n=w=>{let r=null;w=w.ga.Sa;w.qS&&(r=w.Fc.floatingObject);return r},v=(w,r=!0)=>{const t=f.a.getInstance(w),A=t.o$h();A&&!w.Zb.fl(A)&&h.a(d.a.cgh,
[e.a.lFf],!0,!0,!1,!1,null);t.stop(r)},x=w=>{if(!w.length)return!1;for(let r=0;r<w.length;r++){const t=w.charAt(r),A=w.charCodeAt(r);if(!r){if("\\"!==t&&"_"!==t&&!c.a.isLetter(A))return!1}else if("_"!==t&&"."!==t&&!c.a.Vrf(A)&&!c.a.isNumeral(A))return!1}return!0}},1177:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);var c=a(15);class b{constructor(f){this.start=e=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):
(this.Li.start(),this.inProgress=!0,this.YFf=e)};this.stop=(e=!0)=>{this.inProgress&&(this.Li.stop(),e&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.Li.fd}}`),this.inProgress=!1,this.YFf=void 0)};this.o$h=()=>this.YFf;this.Li=f.nc.hh("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=f=>{void 0===b.instance&&(b.instance=new b(f));return b.instance};Object(u.a)(b,"NameBoxTelemetry",null,[])},1222:function(u,C,a){var c=a(10);u=a(0);var b=a(722),
f=a(52),e=a(40),d=a(199),h=a(15),l=a(827),k=a(144),n=a(273),v=a(73),x=a(79),w=a(136),r=a(30),t=a(117),A=a(9),y=a(25),z=a(47),E=a(897),G=a(120),F=a(390),O;(function(V){V[V.NONE=0]="NONE";V[V.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";V[V.PRINT_AREA=2]="PRINT_AREA";V[V.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";V[V.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";V[V.INVALID_NAME=5]="INVALID_NAME";V[V.EMPTY_RANGE=6]="EMPTY_RANGE";V[V.GENERIC_ERROR=7]="GENERIC_ERROR"})(O||(O={}));Object(u.b)("NameBoxInvalidOperation",
O);var M=a(129),P=a(33),B=a(23),D=a(16),I=a(121),S=a(138),J=a(577),L=a(106);class R extends F.a{constructor(V,ia,X=null){super(V,ia);this.lXi=X;this.aoa();this.Ss()}get Qc(){return"NameBoxErrorDialog"}Ss(){super.Ss();const V=this.error.Caption,ia=this.d5h(this.error),X=this.c5h(this.error);this.rc=0;this.Aua(X);this.vm(V,ia,2,this.e$)}d5h(V){return B.a.equals(V.MessageIdName,R.SIc,!0)?String.format(V.Description):B.a.equals(V.MessageIdName,R.aEb,!0)?"":V.Description}c5h(V){const ia=[];B.a.equals(V.MessageIdName,
R.aEb,!0)&&(V=String.format(D.a.instance.ha(2253)),ia.push(...M.f(V.split("-"),X=>X.trim())));return ia}aoa(){if(this.error.MessageIdName===R.aEb)h.ULS.sendTraceTag(528053385,0,50,this.error.Caption);else{let V=this.error.Caption;this.error.MessageIdName===R.SIc&&(V=`Unsupported Operation: ${O[this.lXi]}`);const ia=new L.a;ia.ia("errorCaption",V);J.a(S.a.VPh,[I.a.lFf],!0,!0,!1,!1,ia)}}static Od(V){switch(V){case 3:case 1:case 2:return P.a.Od(1,0,2254,2255,0,-1280789630,R.SIc);case 5:case 4:return P.a.Od(1,
0,2252,2253,0,875859818,R.aEb);case 7:return P.a.Od(1,0,0,1,0,424201999,R.aEb);case 6:return P.a.Od(1,0,2256,2257,0,-1280789630,R.SIc);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}R.SIc="NameBoxUnsupportedOperation";R.aEb="NameBoxInvalidName";Object(u.a)(R,"NameBoxErrorDialog",F.a,[]);class Y{constructor(){this.type=this.location=this.name=this.key=null}}Object(u.a)(Y,"NamedObjectOption",null,[]);const Q=(V,ia,X,la)=>{const sa=
new Y;sa.key=V;sa.name=ia;sa.location=X;a:switch(la){case 2:V="Table";break a;case 3:V=B.a.M5a(ia,"Print_Area")?"Print Area":"Named Range";break a;default:V="Unknown"}sa.type=V;return sa};var W=a(1176),Ga=a(1),pa=a(20),aa=a(137),Z=a(1177);class fa{constructor(V,ia){this.printArea="Print_Area";this.sFj="R";this.ngh="C";this.kXi="Value";this.$=V;this.gridView=pa.h(this.$);this.bBa=ia;this.mXi=Z.a.getInstance(this.$)}vjj(){var V=this.$.Zb.items,ia=this.$.na.name;const X={};for(var la of V){V=E.a(la.name);
var sa=V.Bhb;if(v.h(la)&&(!sa||B.a.equals(V.scope,ia,!1))){const Va=V.name in X;if(!Va||Va&&sa)X[V.name]={["namedObjectDetails"]:V,["namedObjectItem"]:la}}}ia=[];for(let Va in X)V=X[Va],la=V.namedObjectItem,V=V.namedObjectDetails,sa=`${la.sheetName}!${la.usedRange.topLeft.nz(!1)}:${la.usedRange.bottomRight.nz(!1)}`,ia.push(Q(la.name,V.name,sa,la.type));ia.sort((Va,nb)=>Va.name.localeCompare(nb.name));this.bBa.wjj(ia);W.a(this.$,!1);this.uTd(ia.length)}xli(V){V=E.a(V[this.kXi].toString());const ia=
V.name,X=V.scope.length?V.scope:null;var la=this.sdh(V);this.OIj(V)||(this.oPi(V),0!==la?(this.bBa.lUe(this.$,la),this.v8f()):W.d(ia)?(la=z.r(pa.h(this.$).ga.pa.selectedRanges,this.$),this.bBa.kph(this.$,ia,la,X,fa.e0i,fa.d0i),this.mXi.start(V.name)):(this.bBa.lUe(this.$,5),this.v8f()))}Cjd(){this.bBa.Cjd()}OIj(V){const ia=V.fullName,X=V.name,la=V.scope;let sa,Va,nb=!1;!({sheetName:sa,range:Va}=z.ab(ia,this.$.ua)).returnValue||!Va.IA&&Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?
B.a.equals(X,this.sFj,!0)?(this.PIj(la),this.bUa(2)):B.a.equals(X,this.ngh,!0)?(this.GIj(la),this.bUa(2)):this.$.Zb.fl(ia)?(this.zag(ia),this.bUa(V.Bhb?1:0)):this.$.Zb.fl(X)?(this.zag(X),this.bUa(0)):nb=!0:(this.HIj(sa,Va),this.bUa(3));return!nb}HIj(V,ia){V=V||this.$.ua.na.name;var X=E.b(this.$.Zb,ia,V);E.c(X)||(X=z.v(ia,this.$),X.SheetName=V,pa.h(this.$).qh(X,ia.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.gridView.focus())}PIj(V=null){const ia=this.gridView.ga.pa.activeCell;
this.CIe(V)&&(V=new y.Range(ia.top,0,ia.bottom,A.a.Gg,!0,!1),this.gridView.ga.jH([V],0,V,0))}GIj(V=null){const ia=this.gridView.ga.pa.activeCell;this.CIe(V)&&(V=new y.Range(0,ia.left,A.a.Hg,ia.right,!0,!1),this.gridView.ga.jH([V],0,V,0))}CIe(V){return V?(V=this.$.ua.getItemByName(V),(null===V||void 0===V?0:V.visible)?(V.activate(),!0):!1):!0}zag(V){V=this.$.Zb.getItemByName(V);E.c(V);this.gridView.focus()}sdh(V){return this.PBi()?1:B.a.equals(V.name,this.printArea,!0)?2:this.byh()?3:this.Kqi(V)?4:
this.eBi()?6:0}v8f(){var V=W.b(this.gridView);null!=V?this.bBa.R7c("",V.name):(V=W.c(this.$,this.gridView))?this.bBa.R7c(V.name,V.name):this.bBa.R7c("",this.gridView.ga.pa.activeCell.toString())}PBi(){return!!this.gridView.ga.Sa.activeFloatingObjectControlId}byh(){return 1<this.gridView.ga.pa.selectedRanges.length}Kqi(V){return V.Bhb&&!this.$.eX(V.scope)}eBi(){return this.gridView.Mb.Mza(this.gridView.ga.pa.selectedRanges[0])}static e0i(V){return ia=>{P.a.Zf(ia.Errors)&&(new R(V,ia.Errors[0]),Z.a.getInstance(V).stop(!1))}}static d0i(V){return ia=>
{(ia=G.a.lf(ia.data))&&0<ia.length?new R(V,ia[0]):new R(V,R.Od(7));Z.a.getInstance(V).stop(!1)}}oPi(V){const ia=null!=W.c(this.$,this.gridView);V.Bhb?this.bUa(ia?7:6):this.bUa(ia?5:4)}bUa(V){aa.b(this.$).Ld(w.a.e3j,{type:V.toString()},null,!0)}uTd(V){aa.b(this.$).Ld(w.a.jWf,{Ymk:V},null,!0)}}Object(u.a)(fa,"NameBoxCommandHandler",null,[]);var ya=a(382),Aa=a(200),ja=a(58);const za=(V,ia,X,la,sa,Va,nb,ha,jb,Fb,Rb=null)=>{Rb=V.Pa(9,Rb);Rb.name=ia;Rb.selectedRanges=X;Rb.sheetName=la;Rb.formula=sa;Rb.comment=
Va;return ja.g(V,"AddDefinedName",Rb,nb,ha,jb,Fb,0)};var ra=a(246),fb=a(140);class Ua{wjj(V){fb.c()&&appChrome.populateNameBoxMenu(V)}kph(V,ia,X,la,sa,Va){ya.a(V.userOperationManager,(nb,ha,jb)=>za(V.qa.va,ia,X,la,"","",ra.b(nb,sa(V)),ra.a(ha,Va(V)),jb,V),nb=>new Aa.a(1020,0,nb),null)}lUe(V,ia){new R(V,R.Od(ia),ia)}Cjd(){appChrome.updateNameBoxState({["focus"]:!0})}R7c(V,ia){appChrome.setNamedObjectOrActiveCellRange(V,ia)}}Object(u.a)(Ua,"NamedObjectsService",null,[284]);var Ca=a(198),Ia=a(383),oa=
a(62),Da=a(7);class bb{constructor(V,ia){this.$=V;this.gridView=pa.h(this.$);this.Ya=ia;this.rGd=(this.cQa=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7843354_AddNamedRange"))?new fa(V,new Ua):null}hd(){return!1}executeCommand(V,ia,X){ia=ia.command;V=null;switch(ia){case 1726517890:this.cQa?this.rGd.xli(X):X[l.a.IsFreeForm]||((X=this.$.Zb.getItemByName(X[x.a.rd].toString()))?X.activate():h.ULS.sendTraceTag(537161937,0,15,"FormulaBarCommandHandler.ExecuteCommand: Can't find named Object related to selected item in ComboBox"));
break;case 2045896573:X=t.a(this.$);(null===X||void 0===X?0:X.$Ma)?X.$Ma.t2e():h.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.rGd.Cjd();break;case -1790328692:X=t.a(this.$);ia=!this.$.bFb;X.isVisible=ia;X.textBox.isVisible=ia;this.$.bFb=ia;this.$.Wf();try{k.a.Qt(Da.a.Vqf,ia.toString(),n.AFrame.jQ)}catch(la){h.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${la.message}`)}break;
default:V=Ca.a(ia)}return V||oa.Task.Ua(!0)}Tc(V,ia,X){V=!1;switch(ia.command){case 1726517890:V=!!X;break;case -1003645154:V=!0;break;case 2045896573:V=r.a.qO();break;case -1790328692:V=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisplaySettings",!1)}return V}ld(V,ia,X){if("PopulateNameBoxMenu"!==ia)return!1;V=this.$.nc.qd("UserAction","PopulateNameBoxMenuTimer");if(this.cQa)this.rGd.vjj();else{ia=bb.Qei(this.$.Zb.items,this.$.na.name);const sa=this.Ya.ur();Ia.a(this.$)&&(sa.id=
"presentModeNamedObjectsMenu");const Va=this.Ya.jd();Va.Fq="Menu";for(var la of ia){const nb=this.jph(la);Va.buttons.push(nb)}ia.count||(la=this.Ya.bbd("EmptyMenuLabel",D.a.instance.ha(711)),Va.buttons.push(la));sa.Vc.push(Va);X.PopulationXML=this.Ya.cgf(sa);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5404120_NameboxTelemetry")&&this.uTd(ia.count)}V.stop();return!0}jph(V){let ia=V;V.includes("!")&&(ia=V.split("!")[1]);V=this.Ya.rR(222,V,1726517890,null,3,"None",0,0,V,!1,0);V.label=ia;V.uT(ia);return V}uTd(V){V=
{["NamedObjectsCount"]:V};aa.b(this.$).Ld(w.a.jWf,V,null,!0)}static Qei(V,ia){const X=new d.a;for(let la=0,sa=V.length;la<sa;la++){const Va=V[la];if(v.h(Va)){if(Va.name.includes("!")){const nb=Va.name.split("!"),ha=nb[1];if(nb[0]!==ia)continue;X.contains(ha)&&X.remove(ha)}X.add(Va.name)}}X.sort();return X}}Object(u.a)(bb,"FormulaBarCommandHandler",null,[200]);class Za extends b.a{constructor(V){super(V)}he(){e.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.La),V=>{this.Pd([new bb(this.$,
V.result)])},this.$.ka)}static la(V){b.a.ye(280,new Za(V))}}Object(u.a)(Za,"FormulaBarCommandHandlerFactory",b.a,[]);F=a(229);var Xa=a(883),Ba=a(44),Wa=a(725);class Na extends F.a{constructor(V){super();this.$=V;this.kc()}create(){Ba.PageLoadTrackingInfo.instance.hqa(Da.a.Jla);const V=f.GetServiceTaskFactory.Za(this.$.da,388,387,this.La);e.TaskExtensions.za(e.TaskExtensions.ke([V],this.ka),()=>{this.Pb(Object(Wa.a)(this.$.da,172,()=>new Xa.FormulaBar(this.$,V.result)))},this.$.ka,3)}}Object(u.a)(Na,
"FormulaBarFactory",F.a,[]);a.d(C,"a",function(){return ta});const ta=()=>{c.a.Fa(V=>{V.da.Ja(186,new Na(V));Za.la(V)})}},1491:function(u,C,a){a.r(C);u=a(1175);a=a(1222);Object(u.a)();Object(a.a)()},883:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(90),f=a(6),e=a(113),d=a(14),h=a(92),l=a(718),k=a(31),n=a(374),v=a(70),x=a(143),w=a(97);class r{}r.uHh="ewa-fb";r.AHh="ewa-fb-placeholder";r.BHh="ewa-fb-text-box";r.CHh="ewa-fb-text-box-monospace-experiment";r.DHh="ewa-fb-text-box-new";r.mZe="ewa-fb-refactor";
r.kZe="ewa-fb-extended";r.TYi="not-ie";r.p6e="functionbox";r.bji="green-fill-paths";r.AR="drop-down";r.Jtc="ok-cancel-buttons-container";r.GHf="okbox";r.THe="cancelbox";r.lZe="ewa-fb-nb";r.zHh="ewa-fb-name-box-placeholder";r.YFe="button-disabled";r.xHh="ewa-fb-expand-button-img";r.wHh="ewa-fb-expand-button-container";r.EHh="ewa-fb-text-div-container";r.jZe="ewa-fb-drag-resize";r.vHh="ewa-fb-drag-handler";r.g_e="ewa-svg-icon";r.yHh="ewa-fb-full-width";r.zV="cui-disabled";Object(u.a)(r,"CssClassNames",
null,[]);var t=a(7),A=a(272),y=a(632),z=a(630),E=a(488),G=a(162),F=a(136),O=a(52),M=a(86),P=a(101);class B extends P.a{constructor(cb,Fa,wa,ka,Oa,hb){super(cb);this.VO=()=>{this.domElement.disabled||(this.r9b.className=this.fbc+" "+this.MEf)};this.UO=()=>{this.domElement.disabled||(this.r9b.className=this.fbc+" "+this.EWi)};this.mOf=Pa=>{if(!this.domElement.disabled){const ca=Pa.keyCode;if("mousedown"===Pa.type||13===ca||32===ca)this.r9b.className=this.fbc+" "+this.ylj}};this.nOf=()=>{this.domElement.disabled||
(this.r9b.className=this.fbc+" "+this.MEf)};this.fbc=wa;this.MEf=ka;this.EWi=Oa;this.ylj=hb;this.od.la("mouseover",this.VO);this.od.la("mouseout",this.UO);this.od.la("focus",this.VO);this.od.la("blur",this.UO);this.od.la("mousedown",this.mOf);this.od.la("keydown",this.mOf);this.od.la("mouseup",this.nOf);this.od.la("keyup",this.nOf);this.r9b=Fa}}Object(u.a)(B,"PseudoClassBehavior",P.a,[]);var D=a(13);class I extends M.a{constructor(cb){super();this.Jud=[];this.$=cb}dispose(){h.a.Rc(this.Jud);this.Jud.length=
0;this.$=null;super.dispose()}s6b(cb,Fa,wa,ka,Oa){const hb=D.DOMElementExtensions.getElementById(this.$.domElement,this.$.fc+cb);cb=cb===Fa?hb:D.DOMElementExtensions.getElementById(this.$.domElement,this.$.fc+Fa);if(!hb)return null;wa=new B(hb,cb,wa,ka,"",Oa);this.Jud.push(wa);return wa}}I.x9g="ewa-menu-btn-hover";I.z9g="ewa-menu-btn-pressed";Object(u.a)(I,"InitializePseudoClasses",M.a,[]);var S=a(30),J=a(259),L=a(202),R=a(151),Y=a(40),Q=a(34),W=a(827),Ga=a(16),pa=a(73),aa=a(47),Z=a(897),fa=a(187);
class ya{constructor(cb="",Fa=""){this.menuItemId=cb;this.commandValueId=Fa}nda(){return""}Xla(){return this.commandValueId}L6(){return this.menuItemId}Cz(){}}Object(u.a)(ya,"NotSelectedMenuItem",null,[144,133]);var Aa=a(141),ja=a(33),za=a(1),ra=a(109),fb=a(20),Ua=a(49),Ca=a(737);class Ia{constructor(cb,Fa,wa,ka,Oa=null){this.n9a=this.r_=this.dca=this.Ir=null;this.ugh=Ga.a.instance.ha(710);this.itb="EditableNamedObjectDropdownArrowId";this.fCa=this.Cwa=null;this.cSa=()=>{const hb=this.gridView.ga,
Pa=hb.pa.z8a()?hb.pa.f5a:hb.pa.activeRange;this.Ir.value=Pa.isSingle?hb.pa.activeCell.toString():Pa.edf()};this.s2=()=>{let hb=this.Dbf();this.P5d(hb)||(this.dca.OUa&&(hb=this.$.Zb.getItemByName(this.dca.OUa.Xla()))&&hb.deactivate(),this.Zw(this.gridView.ga.pa.activeCell.toString()))};this.t8=(hb,Pa)=>{if(hb=Pa.na){Pa=hb.usedRange;2===hb.type&&(Pa=fa.a(hb));var ca=this.gridView.ga.pa.Lh,ba=this.gridView.inRangePicker||this.gridView.Wi,ib=!1;2===hb.type&&ca&&!ba&&(ca=this.gridView.ga.pa.activeRange,
ib=hb.sheetName===this.$.ua.na.name&&!!ca&&ca.top===Pa.top&&ca.left===Pa.left&&ca.bottom===Pa.bottom&&ca.right===Pa.right);ib||(Pa=aa.v(Pa,this.$),Pa.NamedObjectName=hb.name,Pa.SheetName=hb.sheetName,this.gridView.qh(Pa,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged"));Pa=hb.name.split("!")[1];this.Zw(Pa||hb.name,hb.name)}};this.Or=()=>{this.gridView.ga.Sa.Fc&&this.Zw(this.gridView.ga.Sa.Fc.floatingObject.name)};this.JKb=(hb,Pa)=>{this.cSa(hb,Pa)};this.P8=()=>{this.dca.enabled=
!1};this.O8=()=>{this.dca.enabled=!0};this.Nu=()=>{this.dca.enabled=this.$.isEditMode};this.WG=(hb,Pa)=>{this.dca.enabled=Pa.fN?!1:this.$.isEditMode};this.Xji=()=>{this.Aag()};this.cli=hb=>{if(hb.keyCode!==b.a.Ai)hb.keyCode===b.a.zH&&this.m2e();else{var Pa=this.Ir.value;c.ULS.sendTraceTag(39653979,0,50,"FormulaBarCommandHandler.HandleInputCommit: Name Box commit input value.");if(!({sheetName:hb,range:ca}=aa.ab(Pa,this.$.ua)).returnValue||!ca.IA&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown"))if(this.$.Zb.fl(Pa)){var ca=
this.$.Zb.getItemByName(Pa);this.P5d(ca);this.gridView.focus()}else c.ULS.sendTraceTag(39653980,0,15,"FormulaBarCommandHandler.HandleInputCommit: Input value is not a valid range or a Named Range."),ca=ja.a.Od(1,0,84,83,0,-1137246675,"GotoInvalidReference"),Y.TaskExtensions.za(Ua.a(this.$).lk(ca),()=>{this.m2e()},this.$.ka);else hb=hb||this.$.ua.na.name,Pa=Z.b(this.$.Zb,ca,hb),this.P5d(Pa)||(Pa=aa.v(ca,this.$),Pa.SheetName=hb,fb.h(this.$).qh(Pa,ca.topLeft,null,null,60,"EditableNamedObjectsDropdownList.HandleInputCommit"),
this.gridView.focus())}};this.$=cb;this.gridView=fb.h(cb);this.U3a=this.$.fc+t.a.qGd;this.tgh=this.$.fc+"NameBoxMenu";this.sib=Fa.PTb;this.svgIconProvider=Oa;cb=null;Oa&&(cb=document.createElement("div"),cb.style.display="none",this.Cwa=Oa.sma(Ca.a.jhh,8),this.Cwa.id=this.itb,cb.appendChild(this.Cwa),document.body.appendChild(cb));this.a6c(wa,ka)&&(this.Ir=D.DOMElementExtensions.getElementById(this.r_,this.U3a),c.ULS.shipAssertTag(537161952,0,!!this.Ir,"EditableNamedObjectDropdownList: InputElement inside ComboBoxElement is null"),
this.Ir.setAttribute(x.a.spellcheck,v.a.Kra),this.Zw(this.gridView.ga.pa.activeCell.toString()),this.dca.enabled=!Ua.a(this.$).Qq()&&this.$.isEditMode,this.mj(),cb&&(c.ULS.shipAssertTag(537161951,0,this.Cwa.parentNode!==cb,"EditableNamedObjectDropdownList: SVG element was not extraced from invisible DIV."),document.body.removeChild(cb)))}dispose(){this.sib&&this.sib.sRd(this.U3a);this.$&&(this.$.Ob.oAc(this.P8),this.$.Ob.nAc(this.O8),this.$.ea.qP(this.Nu),ra.a(this.$).yOb(this.JKb),ra.a(this.$).iAc(this.Or),
Ua.a(this.$).yg.Tfa(this.WG));this.$.Zb&&(this.$.Zb.ih(this.t8),this.$.Zb.BOb(this.s2));this.$.ua&&this.$.ua.ih(this.s2);if(this.gridView){const cb=this.gridView.ga;cb.c2(this.s2);cb.sP(this.cSa);cb.Sa.b2(this.Or)}this.$&&this.n9a&&this.n9a.detach("keyup");h.a.Ka(this.n9a);this.sib=null;D.DOMElementExtensions.PD(this.Ir);this.Ir.className="";this.fCa=this.Cwa=this.Ir=null}sek(cb){!this.fCa&&this.svgIconProvider&&(this.fCa=this.svgIconProvider.sma(Ca.a.lhh,8))&&(this.Cwa.parentNode.appendChild(this.fCa),
this.fCa.classList.add("ewa-fb-nb-dropdown-button-img"));this.Cwa&&this.fCa&&(D.DOMElementExtensions.setVisible(this.Cwa,!cb),D.DOMElementExtensions.setVisible(this.fCa,cb))}mj(){this.$.Ob.V4b(this.P8);this.$.Ob.U4b(this.O8);this.$.ea.SQ(this.Nu);const cb=this.gridView.ga;this.$.Zb.Lg(this.t8);this.$.ua.Lg(this.s2);cb.I4(this.s2);cb.EK(this.cSa);cb.Sa.RQ(this.Or);ra.a(this.$).N4b(this.Or);ra.a(this.$).Yrb(this.JKb);this.n9a=Aa.a.instance.He(this.Ir);za.EwaSettings.isChangeGateEnabled("OfficeVSO:4696898_DisableFormulaFunctionBoxAndNamedObjectsDropdownDuringPI")&&
Ua.a(this.$).yg.dba(this.WG);za.EwaSettings.isChangeGateEnabled("OfficeVSO:4619995_NamedRangeHandleBlur")&&this.n9a.la("blur",this.Xji);this.n9a.la("keyup",this.cli);this.$.Zb.$rb(this.s2)}a6c(cb,Fa){const wa=cb.brh(this.U3a,this.tgh,Q.a.Sf(this.ugh),Ia.vgh,this.itb);if(!wa)return c.ULS.sendTraceTag(537161950,0,10,"EditableNamedObjectDropdownList.BuildAndAttachComboBox: ribbonComboBox is null"),!1;cb=cb.cgf(wa);this.sib.x4(this.U3a,cb);this.r_=this.sib.E9e(this.U3a,t.a.kFf);c.ULS.shipAssertTag(537161949,
0,!!this.r_,"EditableNamedObjectDropdownList: ComboBoxElement was not Created after BuildAndAttachComboBox called");za.EwaSettings.isChangeGateEnabled("OfficeVSO:5663983_NameBoxOverFlowFix")&&this.r_.classList.add(Ia.jXi);this.dca=this.sib.aqd(this.U3a);cb=document.getElementById(this.$.fc+t.a.bkd);void 0!==cb&&null!==cb&&Fa.removeChild(cb);Fa.insertBefore(this.r_,Fa.firstChild);return!0}m2e(){this.Aag();this.gridView.focus()}Aag(){const cb=this.Dbf();cb?this.Zw(cb.name):this.Zw(this.gridView.ga.pa.activeCell.toString())}Dbf(){var cb=
this.gridView.ga;const Fa=cb.pa.Lh;cb=cb.pa.activeRange;return this.$.ua.na&&Fa?Z.b(this.$.Zb,cb,this.$.ua.na.name):null}Zw(cb,Fa=""){cb=new ya(cb,Fa);this.dca.Zw(cb);this.dca.mc[W.a.Value]=cb.L6()}P5d(cb){return cb&&pa.h(cb)?(cb.activate(),!0):!1}}Ia.vgh="102px";Ia.jXi="ewa-fb-nb-fix";Object(u.a)(Ia,"EditableNamedObjectDropdownList",null,[2]);class oa{constructor(cb,Fa){this.$=cb;this.Xb=Fa;A.a(this.$).Pi(this)}get Lc(){return this.Xb.textBox.pf}get sg(){return fb.h(this.$).Eb&&fb.h(this.$).tm}get Ge(){return J.a.Q5e}Qg(cb,
Fa){Fa||D.DOMElementExtensions.setFocus(this.Lc);return!Fa}hi(cb){return D.DOMElementExtensions.lg(this.Lc,cb)}ek(){}Gk(){}dispose(){A.a(this.$).aB(this)}}Object(u.a)(oa,"FormulaBarFocusManager",null,[29,2]);var Da=a(231),bb=a(248),Za=a(19),Xa=a(54),Ba=a(91),Wa=a(165);class Na extends M.a{constructor(cb,Fa,wa,ka=null){super();this.hTa=this.X8a=null;this.KLf=()=>{const Oa=new Ba.a(753860909,2,this.$.Kc,2,null);this.$.Ia.$b(Oa);return!0};this.LLf=Oa=>Oa.Da.keyCode===b.a.Ai?(Oa=new Ba.a(753860909,1,
this.$.Kc,2,null),this.$.Ia.$b(Oa),!0):!1;this.MLf=()=>{if(this.gridView.Eb){const Oa=this.gridView.Rh;za.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix")?Oa.textBox.T6b():Oa.textBox.yG=!0}return!1};this.$=wa;this.gridView=fb.h(wa);this.svgIconProvider=ka;this.GWh=Fa.ha(1035);this.FWh=r.p6e+" "+r.AR;this.R1=cb.s6b(t.a.Tfc,t.a.Tfc,this.FWh,r.bji,"");this.X8a=ka?ka.Lda(Ca.a.DWh,13,13,this.R1.domElement,void 0,void 0,void 0,Fa.ha(1035)):Wa.createClusteredImageFromClusterWithImageClass(13,
13,Za.a.dLh,Xa.a.dg(0),null,null,!0,Fa.ha(1035));this.R1.domElement.appendChild(this.X8a);Da.a.instance.ta(d.a.click,this.R1.domElement,this.KLf);e.KeyInputManager.instance.ta(d.a.yc,this.R1.domElement,this.LLf);bb.a.instance.ta(d.a.pointerDown,this.R1.domElement,this.MLf)}dispose(){this.R1&&(Da.a.instance.Aa(d.a.click,this.R1.domElement,this.KLf),e.KeyInputManager.instance.Aa(d.a.yc,this.R1.domElement,this.LLf),bb.a.instance.Aa(d.a.pointerDown,this.R1.domElement,this.MLf));h.a.Ka(this.R1);this.R1=
null;D.DOMElementExtensions.gg(this.X8a);this.hTa=this.X8a=null;super.dispose()}rek(cb){!this.hTa&&this.svgIconProvider&&(this.hTa=this.svgIconProvider.Lda(Ca.a.PWh,13,13,this.R1.domElement,void 0,void 0,void 0,this.GWh))&&this.hTa.classList.add("ewa-fb-function-button-img");this.X8a&&this.hTa&&(D.DOMElementExtensions.setVisible(this.X8a,!cb),D.DOMElementExtensions.setVisible(this.hTa,cb))}}Object(u.a)(Na,"FormulaBarFunctionControl",M.a,[]);var ta=a(179),V=a(168),ia=a(50),X=a(9),la=a(150),sa=a(12);
class Va{constructor(cb){this.Hwa=this.dla=this.IQc=this.HQc=this.GQc=null;this.Qoc=this.twd=this.p7=!1;this.ope=this.iob=this.rGe=this.G7f=0;this.tuc=Fa=>{this.t2e();Fa.Da.rawEvent.preventDefault();return!0};this.puc=Fa=>{this.twd=!0;this.G7f=Fa.clientPoint.y;document.body.classList.add(r.jZe);this.p7||(this.iUa=0);this.A5a.la("mousemove",this.HKf,!0);this.A5a.la("touchmove",this.HKf);this.A5a.la("mouseup",this.gJd);this.A5a.la("touchend",this.gJd);this.A5a.la("mouseleave",this.gJd);return!0};this.gJd=
()=>{this.twd=!1;this.iUa=this.Ko.clientHeight-la.c;document.body.classList.remove(r.jZe);this.A5a.eE();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Ko.clientHeight} pixel`)};this.HKf=Fa=>{this.twd?(Fa=sa.HelperMethods.Ogc(Fa).y,Fa=this.Hbf(this.iUa+Math.min(Fa,this.$.domElement.clientHeight-75)-this.G7f),this.p7=Fa>=this.lineHeight,D.DOMElementExtensions.toggleCssClass(this.Ko,r.kZe,this.p7),Fa=la.c+Math.round(Math.max(Fa-2,
0)),this.Ko.clientHeight!==Fa&&(this.Ko.style.height=Fa+"px",this.$.UCa())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.XO=Fa=>{this.p7&&(this.aNa=Math.round((Math.round(this.aNa/this.lineHeight)+(0<Fa.Ora?1:-1))*this.lineHeight));Fa.Da.preventDefault();return!1};this.J8=()=>{this.ZCj();this.Qoc&&(ta.a.instance.Aa(d.a.pJ,document.body,this.J8),ta.a.instance.Aa(d.a.VAa,document.body,this.J8),V.a.instance.Aa(d.a.$e,
document.body,this.J8),this.Qoc=!1);return!1};this.xg=()=>{this.aNa=0};this.onScroll=Fa=>{this.Qoc||(ta.a.instance.ta(d.a.pJ,document.body,this.J8),ta.a.instance.ta(d.a.VAa,document.body,this.J8),V.a.instance.ta(d.a.$e,document.body,this.J8),this.Qoc=!0);Fa.preventDefault()};this.Gcj=Fa=>{this.aNa=this.rGe;Fa.preventDefault()};this.$=cb;this.A5a=Aa.a.instance.dLa(document.body.ownerDocument)}get lineHeight(){return this.iob?this.iob:X.a.akd}set lineHeight(cb){this.iob=cb}get Ko(){const {FormulaBar:cb}=
a(883);this.GQc||(this.GQc=cb.zhc(this.$));return this.GQc}get Ufc(){this.HQc||(this.HQc=document.getElementById(t.a.P6a));return this.HQc}get Kla(){this.IQc||(this.IQc=document.getElementById(t.a.P6a+"_"+t.a.zHc));return this.IQc}get aNa(){return this.Kla.scrollTop}set aNa(cb){this.rGe=cb;this.Kla.scrollTop!==cb&&(this.Kla.scrollTop=cb)}get KVh(){return 2*this.lineHeight-2}get iUa(){return this.ope}set iUa(cb){this.ope=cb}t2e(){this.p7=!this.p7;D.DOMElementExtensions.toggleCssClass(this.Ko,r.kZe,
this.p7);this.p7&&!this.iUa&&(this.iUa=this.KVh);this.Ko.style.height=la.c+(this.p7?this.iUa:0)+"px";this.dla.setAttribute(t.a.ov,this.p7?"Collapse the formula bar":"Expand the formula bar");this.$.UCa();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.p7?"expanded":"collapsed"}`)}Zrh(cb){const Fa=document.createElement("div");Fa.id=this.$.fc+t.a.T5e;Fa.className=r.EHh;this.dla=Va.Znh(this.$.fc,cb);Fa.appendChild(this.dla);this.Hwa=Va.xnh(this.$.fc);
Fa.appendChild(this.Hwa);return Fa}Euj(){ta.a.instance.ta(d.a.nq,this.dla,this.tuc);V.a.instance.ta(d.a.Yf,this.dla,this.tuc);ta.a.instance.ta(d.a.nq,this.Hwa,this.puc);V.a.instance.ta(d.a.Yf,this.Hwa,this.puc)}Huj(){ta.a.instance.ta(d.a.FE,this.Ufc,this.XO);ia.a.addHandler(this.Kla,d.a.scroll,this.onScroll);ia.a.addHandler(this.Kla,d.a.focus,this.Gcj);fb.h(this.$).ga.add_activeCellChanged(this.xg)}bck(){void 0!==this.dla&&null!==this.dla&&(ta.a.instance.Aa(d.a.nq,this.dla,this.tuc),V.a.instance.Aa(d.a.Yf,
this.dla,this.tuc));void 0!==this.Hwa&&null!==this.Hwa&&(ta.a.instance.Aa(d.a.nq,this.Hwa,this.puc),V.a.instance.Aa(d.a.Yf,this.Hwa,this.puc));void 0!==this.Ufc&&null!==this.Ufc&&ta.a.instance.Aa(d.a.FE,this.Ufc,this.XO);fb.h(this.$).ga.remove_activeCellChanged(this.xg)}ZCj(){this.aNa=Math.round(this.Hbf(this.aNa))}Hbf(cb){return Math.round(cb/this.lineHeight)*this.lineHeight}static Znh(cb,Fa){const wa=document.createElement("a");wa.id=cb+t.a.NVh;wa.classList.add(r.wHh);D.DOMElementExtensions.py(wa,
t.a.qu);wa.setAttribute(t.a.ov,"Expand the formula bar");Fa.Lda(Ca.a.khh,12,12,wa).classList.add(r.xHh);return wa}static xnh(cb){const Fa=document.createElement("div");Fa.id=cb+t.a.LVh;Fa.className=r.vHh;return Fa}}Object(u.a)(Va,"FormulaBarResizeControl",null,[]);P=a(247);var nb=a(1176);class ha{}ha.disabled="disabled";ha.Z0j="stale";ha.slj="presentationMode";Object(u.a)(ha,"NameBoxStateUpdateKey",null,[]);class jb extends P.a{constructor(cb,Fa){super(document.createElement("div"));this.Me=null;
this.F9j=()=>{this.$.Ia.kCb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.cSa=()=>{var wa=this.gridView.ga;const ka=wa.pa.z8a()?wa.pa.f5a:wa.pa.activeRange;wa=ka.isSingle?wa.pa.activeCell.toString():ka.edf();this.Zw(wa)};this.ik=(wa,ka)=>{this.Hfa(wa,ka);this.s2(wa,ka)};this.s2=()=>{let wa=nb.c(this.$,this.gridView);Z.c(wa,za.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection"))||(this.Me&&(wa=this.$.Zb.getItemByName(this.Me))&&wa.deactivate(),this.Zw(this.gridView.ga.pa.activeCell.toString()))};
this.t8=(wa,ka)=>{if(wa=ka.na){var Oa=wa.usedRange;2===wa.type&&(Oa=fa.a(wa));var hb=this.gridView.ga.pa.Lh,Pa=this.gridView.inRangePicker||this.gridView.Wi,ca=!1;2===wa.type&&hb&&!Pa&&(hb=this.gridView.ga.pa.activeRange,ca=wa.sheetName===this.$.ua.na.name&&!!hb&&hb.top===Oa.top&&hb.left===Oa.left&&hb.bottom===Oa.bottom&&hb.right===Oa.right);Oa=aa.v(Oa,this.$),Oa.NamedObjectName=wa.name,Oa.SheetName=wa.sheetName,za.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection")?
this.gridView.qh(Oa,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,ka.disableAutoFocusOnGrid):this.gridView.qh(Oa,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged");ka=Z.a(wa.name);this.Zw(ka.name,ka.fullName)}};this.Or=()=>{const wa=nb.b(this.gridView);null!=wa&&this.Zw(wa.name)};this.JKb=(wa,ka)=>{this.cSa(wa,ka)};this.Baj=()=>{this.NLa(this.$.isEditMode&&this.gridView.Rh.W9a())};this.Jg=()=>{this.NLa(!1)};this.P8=()=>{this.NLa(!0)};
this.O8=()=>{this.NLa(!1)};this.Nu=()=>{this.NLa(!this.$.isEditMode)};this.WG=(wa,ka)=>{this.NLa(ka.fN?!0:!this.$.isEditMode)};this.onKeyDown=wa=>wa.Da.keyCode===b.a.Ira?(this.gridView.focus(),!0):!1;this.Hfa=()=>{this.Y6d({[ha.Z0j]:!0})};this.$=cb;this.gridView=fb.h(cb);this.a6c(Fa)&&(this.Zw(this.gridView.ga.pa.activeCell.toString()),this.NLa(Ua.a(this.$).Qq()||!this.$.isEditMode),this.mj(),e.KeyInputManager.instance.ta(d.a.yc,this.domElement,this.onKeyDown.bind(this)))}dispose(){this.$&&(this.$.Ob.oAc(this.P8.bind(this)),
this.$.Ob.nAc(this.O8.bind(this)),this.$.ea.qP(this.Nu.bind(this)),ra.a(this.$).yOb(this.JKb.bind(this)),ra.a(this.$).iAc(this.Or.bind(this)),Ua.a(this.$).yg.Tfa(this.WG.bind(this)),this.$.Zb&&(this.$.Zb.ih(this.t8.bind(this)),this.$.Zb.BOb(this.s2.bind(this)),this.$.Zb.BOb(this.w1f.bind(this)),this.$.Zb.u9(this.Hfa.bind(this)),this.$.Zb.Epa(this.Hfa.bind(this)),this.$.Zb.XTa(this.Hfa.bind(this)),this.$.Zb.AOb(this.Hfa.bind(this))),this.$.ua&&this.$.ua.ih(this.ik.bind(this)));if(this.gridView){const cb=
this.gridView.ga;cb.c2(this.s2.bind(this));cb.sP(this.cSa.bind(this));cb.Sa.b2(this.Or.bind(this))}super.dispose()}pek(cb){this.Y6d({[ha.slj]:cb})}a6c(cb){const Fa=document.getElementById(this.$.fc+t.a.bkd);void 0!==Fa&&null!==Fa&&cb.removeChild(Fa);appChrome.renderNameBoxUI(this.domElement,this.F9j.bind(this));cb.insertBefore(this.domElement,cb.firstChild);return!0}mj(){this.$.Ob.V4b(this.P8.bind(this));this.$.Ob.U4b(this.O8.bind(this));this.$.ea.SQ(this.Nu.bind(this));const cb=this.gridView.ga;
this.$.Zb.Lg(this.t8.bind(this));this.$.ua.Lg(this.ik.bind(this));cb.I4(this.s2.bind(this));cb.EK(this.cSa.bind(this));cb.Sa.RQ(this.Or.bind(this));ra.a(this.$).N4b(this.Or.bind(this));ra.a(this.$).Yrb(this.JKb.bind(this));za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRangePLTFix",!1)||(this.$.lsb(this.Baj.bind(this)),this.gridView.Rh.Bm(this.Jg.bind(this)));za.EwaSettings.isChangeGateEnabled("OfficeVSO:4696898_DisableFormulaFunctionBoxAndNamedObjectsDropdownDuringPI")&&Ua.a(this.$).yg.dba(this.WG.bind(this));
this.$.Zb.$rb(this.s2.bind(this));this.$.Zb.$rb(this.w1f.bind(this));this.$.Zb.UZ(this.Hfa.bind(this));this.$.Zb.eja(this.Hfa.bind(this));this.$.Zb.YIa(this.Hfa.bind(this));this.$.Zb.l1a(this.Hfa.bind(this))}Zw(cb,Fa=""){this.Me=""!==Fa?Fa:this.Me;appChrome.setNamedObjectOrActiveCellRange(Fa,cb)}NLa(cb){this.Y6d({[ha.disabled]:cb})}w1f(cb,Fa){nb.a(this.$,!0);this.Hfa(cb,Fa)}Y6d(cb){appChrome.updateNameBoxState(cb)}}Object(u.a)(jb,"NameBox",P.a,[2]);var Fb=a(186);const Rb=r.GHf+" "+r.AR,mb=r.THe+" "+
r.AR;class sb extends M.a{constructor(cb,Fa,wa,ka){super();this.Hub=this.gKb=this.kKa=this.URa=null;this.XI=this.Coc=!1;this.r2f=()=>{this.gridView.bL.ao(this.Ji);this.gridView.bL.Bm(this.Jg);this.Coc=!0};this.Ji=()=>{this.UEb?this.Tog(!0):this.Jtc.style.display="flex"};this.Jg=()=>{this.UEb?this.Tog(!1):this.Jtc.style.display="none"};this.OOf=hb=>this.Ytc(!0,`OkCancelEditControl.OnOkClick: ${hb.Wb}`,sa.HelperMethods.qp(hb));this.POf=hb=>this.Ytc(!0,`OkCancelEditControl.OnOkKeyDown: ${hb.Wb}`);this.SIf=
hb=>this.Ytc(!1,`OkCancelEditControl.OnCancelClick: ${hb.Wb}`,sa.HelperMethods.qp(hb));this.VIf=hb=>this.Ytc(!1,`OkCancelEditControl.OnCancelKeyDown: ${hb.Wb}`);this.onPointerDown=()=>{this.gridView.Eb&&(this.gridView.Rh.textBox.yG=!0);return!1};const {FormulaBar:Oa}=a(883);this.$=wa;this.gridView=fb.h(wa);this.XI=S.a.XI();this.Jtc=sb.U$h(wa);this.UEb=S.a.qO();ka?(this.URa=ka.sma(Ca.a.Fdh,16),this.kKa=ka.sma(Ca.a.Hvh,16),this.UEb&&(this.gKb=ka.sma(Ca.a.Gdh,16),this.Hub=ka.sma(Ca.a.Ivh,16),this.URa.style.display=
"none",this.kKa.style.display="none")):(this.URa=Wa.createClusteredImageFromClusterWithImageClass(16,16,Za.a.WKh,Xa.a.dg(1),null,null,!0,Fa.ha(1041)),this.kKa=Wa.createClusteredImageFromClusterWithImageClass(16,16,Za.a.YKh,Xa.a.dg(1),null,null,!0,Fa.ha(1042)));this.s8=cb.s6b(Oa.gId,Oa.gId,Rb,"","");this.s8.domElement.appendChild(this.URa);this.d5=cb.s6b(Oa.d7c,Oa.d7c,mb,"","");this.d5.domElement.appendChild(this.kKa);this.UEb&&(this.s8.domElement.appendChild(this.gKb),this.d5.domElement.appendChild(this.Hub));
this.gridView.cellTextEditBox.ao(this.Ji);this.gridView.cellTextEditBox.Bm(this.Jg);Da.a.instance.ta(d.a.click,this.s8.domElement,this.OOf);e.KeyInputManager.instance.ta(d.a.yc,this.s8.domElement,this.POf);bb.a.instance.ta(d.a.pointerDown,this.s8.domElement,this.onPointerDown);Da.a.instance.ta(d.a.click,this.d5.domElement,this.SIf);e.KeyInputManager.instance.ta(d.a.yc,this.d5.domElement,this.VIf);bb.a.instance.ta(d.a.pointerDown,this.d5.domElement,this.onPointerDown);this.XI&&this.gridView.tWg(this.r2f)}dispose(){this.gridView&&
this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.Un(this.Ji),this.gridView.cellTextEditBox.Qm(this.Jg));this.gridView&&this.XI&&(this.gridView.Hxj(this.r2f),this.Coc&&(this.gridView.bL.Un(this.Ji),this.gridView.bL.Qm(this.Jg),this.Coc=!1));this.s8&&(Da.a.instance.Aa(d.a.click,this.s8.domElement,this.OOf),e.KeyInputManager.instance.Aa(d.a.yc,this.s8.domElement,this.POf),bb.a.instance.Aa(d.a.pointerDown,this.s8.domElement,this.onPointerDown));this.d5&&(Da.a.instance.Aa(d.a.click,this.d5.domElement,
this.SIf),e.KeyInputManager.instance.Aa(d.a.yc,this.d5.domElement,this.VIf),bb.a.instance.Aa(d.a.pointerDown,this.d5.domElement,this.onPointerDown));h.a.Ka(this.s8);this.s8=null;h.a.Ka(this.d5);this.d5=null;D.DOMElementExtensions.gg(this.kKa);this.kKa=null;D.DOMElementExtensions.gg(this.URa);this.URa=null;this.UEb&&(D.DOMElementExtensions.gg(this.Hub),this.Hub=null,D.DOMElementExtensions.gg(this.gKb),this.gKb=null);super.dispose()}Ytc(cb,Fa,wa=null){const ka=this.gridView.Rh;if(wa){const Oa=this.gridView.tm?
"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let hb=void 0;za.EwaSettings.F$a&&(hb=[Object(Fb.a)(this.gridView.cellTextEditBox.textBox.iEa)]);Fb.b(this.$).AEa(wa.rawEvent,Oa,hb)}this.Coc&&this.gridView.bL.eG?this.gridView.bL.endEdit(cb,Fa,0):ka.endEdit(cb,Fa,0);this.gridView.focus();return!0}Tog(cb){const Fa=cb?"block":"none";cb=cb?"none":"block";this.URa.style.display=Fa;this.kKa.style.display=Fa;this.gKb.style.display=cb;this.Hub.style.display=cb}static U$h(cb){const {FormulaBar:Fa}=
a(883);return document.getElementById(cb.fc+Fa.FHf)}}Object(u.a)(sb,"OkCancelEditControl",M.a,[]);var Ya=a(297),Ma=a(271),xb=a(76),qb=a(198),Ra=a(263),Jb=a(222),yb=a(295),Gb=a(137),ub=a(175),Ja=a(44),zb=a(325),na=a(278),Ea=a(177),ma;(function(cb){cb[cb.loaded=0]="loaded";cb[cb.error=1]="error";cb[cb.loading=2]="loading";cb[cb.unloaded=3]="unloaded";cb[cb.missing=4]="missing"})(ma||(ma={}));Object(u.b)("LoadStatus",ma);a.d(C,"FormulaBar",function(){return Ka});class Ka extends n.a{constructor(cb,Fa=
null){super(fb.h(cb));this.bog=null;this.sGd=["nameBox","nameBoxData"];this.Wfe=this.Dr=this.clearContentNotifier=this.nameBox=this.HRa=this.Ko=null;this.W8d=!1;this.Kla=null;this.esf=this.ZAf=this.wCb=!1;this.Ji=()=>{this.fnc&&(this.W8d=!1);this.IYd()};this.Jg=()=>{this.IYd();this.Tb||this.GJe()};this.eSf=()=>{this.Eb||this.textBox.disabled||this.startEdit(!0,!1,null)};this.vo=()=>{this.zDa()};this.WG=(ka,Oa)=>{this.zDa();Ka.zxa&&(Oa.fN?Ka.zxa.classList.add(r.YFe):this.h3c())};this.Nr=(ka,Oa)=>{ka=
this.grid;this.fnc&&(this.W8d=!0);this.Eb?(this.l$a||(Oa.IEb||this.iF(null),this.raiseEvent(n.a.Pub,Oa)),this.Tb&&this.l$a||(this.Tb?ka.cellTextEditBox.textBox.isCursorAttached()&&!this.textBox.isCursorAttached()&&ka.cellTextEditBox.textBox.clearCursorFormatLocation():this.Tb||this.Kjb())):ka.Eb&&this.zDa()};this.Uf=(ka,Oa)=>{(ka=this.grid.ga.pa.activeCell)&&(Oa=this.grid.iD(Oa.Jd.hash))&&ka.Nd(Oa.af)&&this.zDa()};this.jKd=(ka,Oa)=>{-185374993===Oa.command&&(c.ULS.sendTraceTag(537161939,0,50,"FormulaBar: OnPasteCSERendered updated instantaneously"),
this.zDa())};this.Ee=()=>{this.zDa();Y.TaskExtensions.za(L.a(this.$.da),()=>{this.qdg()},this.ka,11)};this.Tea=()=>{this.qdg();Ja.PageLoadTrackingInfo.instance.d2(t.a.Jla,["formulaButton","textbox","textboxData"]);Ja.PageLoadTrackingInfo.instance.cY(t.a.Jla,["formulaButton","textbox","textboxData"]);Ja.PageLoadTrackingInfo.instance.bY(t.a.Jla,["formulaButton"])};this.onKeyDown=ka=>{if(!this.Tb){var Oa=this.$.shortcutKeyManager.Ds(ka.Da);this.BXf(ka.Da,Oa)}if(ka.Da.keyCode===b.a.Tz){var hb=this.Uxa();
Oa=D.DOMElementExtensions.nm(hb);hb=D.DOMElementExtensions.iC(hb);return D.DOMElementExtensions.vDa(ka.Da,Oa,hb)}return!1};this.TO=()=>{this.h3c()};this.PDb=()=>{this.Ko?(this.nameBox=new jb(this.$,this.Ko),this.t6f()):this.vTd()};this.kui=(ka,Oa,hb,Pa,ca)=>{this.Ko?(this.HRa=new Ia(ka,Oa,hb,Pa,ca),this.t6f()):this.vTd()};Fa||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");S.a.qO()?(this.Wfe=new Va(cb),this.initialize(this.aYd(cb,Fa)),this.$Ma.Euj()):(this.initialize(Ka.bOj(cb)),
this.Ko=Ka.zhc(cb));if(f.AFrameworkApplication.sa.Qa.Pf){var wa=document.getElementById("AdditionalBarsRegion");wa&&(wa.style.height="")}this.eCi()&&D.DOMElementExtensions.getElementById(this.Ko,t.a.P6a).classList.add(r.yHh);this.bwd=za.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.JD=new Ya.a(this.Ko,1);this.cQa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:7843354_AddNamedRange");this.dCi=za.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");
this.cCi=S.a.nO(this.$);this.vab=this.yE&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",!1);this.fnc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarTabbingBehaviorChangeXLO",!1);this.esf=za.EwaSettings.isChangeGateEnabled("OfficeVSO:7367969_formulaEditingLogLoadedFontStatus");this.Blc=new I(cb);this.Blc.s6b(t.a.Rog,t.a.Rog,t.a.A7j+" cui-TabRowRight",I.x9g,I.z9g);this.R5e=new Na(this.Blc,Ga.a.instance,cb,Fa);this.S_i=new sb(this.Blc,Ga.a.instance,
cb,Fa);this.bog=na.b(()=>{this.Seg()},1,this.$.ka,"FormulaBar.setTextBoxForActiveItem",!0);cb.ua.Lg(this.Ee);wa=this.grid;wa.cellTextEditBox.ao(this.Ji);wa.cellTextEditBox.Bm(this.Jg);wa.cellTextEditBox.VIa(this.Nr);wa.KF(this.vo);wa.Ca.mv(this.Uf);wa.Ca.bba(this.Uf);wa.Gye(this.jKd);Ua.a(cb).yg.dba(this.WG);cb.ea.E4(this.TO);ra.a(cb).N4b(this.vo);za.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&cb.da.Gb(313,ka=>{this.clearContentNotifier=ka;this.clearContentNotifier.wxe(this.Nr)});
e.KeyInputManager.instance.ta(d.a.yc,this.Lc,this.onKeyDown);wa=this.textBox.style;Ra.c(wa,cb.isChromeRtl,"0px");wa.textAlign=this.Bof?"right":"left";this.isVisible=!1;this.bwd&&(this.textBox.isVisible=!1);G.a(this.$).ZIa(this.Tea);this.$.ea.jna&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.Tea(null,null));this.zDa();this.h3c();this.textBox.Tgg=!0;this.tui(cb,Fa);A.a(cb).Pi(this);this.textBox.Txe(this.eSf);this.l$a=
!1;this.Dr=new oa(this.$,this);S.a.Uqf()&&this.Ssi();this.textBox.gR(()=>{Ja.PageLoadTrackingInfo.instance.bY(t.a.Jla,["textbox","textboxData"]);this.toggleEditingEvents(!1)})}set text(cb){this.Tb&&this.Eb?this.textBox.setPlainText(cb):super.text=cb}get Eb(){return super.Eb}set Eb(cb){super.Eb=cb;this.toggleEditingEvents(cb)}get kTb(){return!0}get formattedText(){return this.Tb?this.textBox.getFormattedText():super.formattedText}set formattedText(cb){this.Tb?this.textBox.setFormattedText(cb):super.formattedText=
cb}get Y9a(){return this.Eb}get isVisible(){return D.DOMElementExtensions.isVisible(this.Ko)}set isVisible(cb){this.bwd?D.DOMElementExtensions.setVisible(this.Ko,cb):(D.DOMElementExtensions.setVisible(this.Ko,cb),this.textBox.isVisible=cb)}get Lc(){return this.Ko}get sg(){return this.isVisible}get Ge(){return J.a.$jd}get $Ma(){return this.Wfe}Qg(cb,Fa){cb=!1;Fa||(cb=this.UUh());return cb}dispose(){const cb=this.$;if(cb){cb.ua.ih(this.Ee);var Fa=this.grid;Fa.cellTextEditBox.Un(this.Ji);Fa.cellTextEditBox.Qm(this.Jg);
Fa.cellTextEditBox.WTa(this.Nr);Fa.dH(this.vo);Fa.Ca.Lt(this.Uf);Fa.Ca.VTa(this.Uf);Ua.a(this.$).yg.Tfa(this.WG);cb.ea.r9(this.TO);ra.a(cb).iAc(this.vo);Fa=G.a(this.$);e.KeyInputManager.instance.Aa(d.a.yc,this.Lc,this.onKeyDown);S.a.qO()&&this.$Ma.bck();Fa&&Fa.YTa(this.Tea);A.a(cb).aB(this);za.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.$Rd(this.Nr),cb.da.LV(313))}this.textBox&&this.textBox.u4f(this.eSf);
this.cQa&&this.nameBox&&this.$.ea.Pm(this.PDb);h.a.Rc([this.JD,this.R5e,this.S_i,this.Blc,this.HRa,this.nameBox]);h.a.Ka(this.Dr);this.Ko&&(D.DOMElementExtensions.PD(this.Ko),this.Ko.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.Ko=null;super.dispose()}endEdit(cb,Fa,wa,ka=null){this.textBox.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:cb,["Caller"]:Fa});this.$Da(!1);if(this.Eb){var Oa=null;this.fnc&&ka&&(Oa=this.$.shortcutKeyManager.Ds(ka));
if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")){var hb=this.grid.cellTextEditBox.textBox.domElement;c.ULS.sendTraceTag(537161945,0,50,`FormulaBar.EndEdit: gridKeyboardHandler is: ${hb.id}, parent is: ${hb.parentNode?hb.parentNode.id:"null"}`)}hb=this.grid.wc;this.Tb||this.textBox.clear("FormulaBar.EndEdit");this.Eb=!1;this.SF(!0);this.Uza()&&this.grid.pt&&this.grid.pt.wxa&&this.grid.pt.Sgb(t.a.yDb);if(cb){var Pa=new y.a(this.grid.ga.pa.activeCell,
hb.text,hb.text,!1,this.grid.$.ua.na);this.GZf(Pa);null!==Pa&&(hb.text=Pa.newValue)}else this.textBox.setPlainText(this.text);Pa=new z.a(this.grid.ga.pa.activeCell,hb.text,cb);this.gPd(Pa);hb.endEdit(cb,`${Fa}->FormulaBar.EndEdit`,wa,ka);this.Suf(Oa)||hb.textBox.focus();this.textBox.yib("FormulaBar.EndEdit")}else this.textBox.yib("FormulaBar.EndEdit",{["IsEditing"]:"false"})}t6(cb,Fa,wa,ka=!0,Oa=!0){super.t6(cb,Fa,wa,ka,Oa);this.Tb&&this.grid.wc.t6(cb,Fa,wa,ka,Oa)}DXf(cb){if(this.Tb){const Fa=this.grid.wc,
wa=this.textBox.selection;wa.length&&Fa.t6(wa.index,wa.length,cb,!1,!1)}}hi(cb){return D.DOMElementExtensions.lg(this.Ko,cb)}ek(){f.AFrameworkApplication.sa.vf.Wk(this.Ge)}Gk(){}ktg(cb){this.cQa?this.nameBox.pek(cb):this.HRa.sek(cb);this.R5e.rek(cb)}tug(){if(this.Kla){var cb=Object(Ea.g)(this.text);this.wCb!==cb&&(this.Teg(cb),this.wCb=cb)}}lKb(){this.textBox.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const cb=this.grid.wc;if(this.Tb){if(!cb.Eb||!this.Eb)return;cb.formattedText=
this.formattedText}else cb.text=this.text;cb.setCaretPosition(this.textBox.caretPosition)}yLb(cb){this.textBox.disabled||(this.grid.cellTextEditBox.textBox.yG=!0,this.Tb&&this.Eb||this.startEdit(!1,!0,cb),this.n_())}tSa(cb){this.Tb?(this.eM&&(this.aN=this.textBox.caretPosition,this.AU=this.textBox.sT.length),this.yE&&this.iF(null)):super.tSa(cb);this.Yfa();this.Yqg()}Uoa(cb){var Fa=this.$.shortcutKeyManager.Ds(cb);const wa=this.Tb&&this.l$a;1872288872===Fa||125627505===Fa||267796030===Fa?this.cCi?
super.Uoa(cb):xb.g(cb):wa?xb.g(cb):this.Eb&&this.grid.wc.Eb&&(Fa=this.grid.wc,this.Tb?Fa.formattedText=this.formattedText:Fa.text=this.text,Fa.setCaretPosition(this.textBox.caretPosition),this.qJc(),this.vab&&0===this.textBox.selection.length&&this.iF(null,null),this.dCi&&this.inRangePicker&&this.N1d(),super.Uoa(cb))}Dd(cb,Fa){this.Eb&&super.Dd(cb,Fa)}Ls(cb,Fa){this.Eb&&super.Ls(cb,Fa)}Ssi(){const cb=this.grid.jc(void 0);cb?(this.wCb=cb.pz||Object(Ea.g)(cb.text),this.Teg(this.wCb)):c.ULS.sendTraceTag(509720320,
0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}Teg(cb){D.DOMElementExtensions.toggleCssClass(this.Kla,r.CHh,cb);this.esf&&!this.ZAf&&this.wCb&&(this.ZAf=!0,this.UPi())}UPi(){setTimeout(()=>{const cb=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(["Consolas","Monaco","Menlo","Courier New","monospace"]);let Fa="FormulaBar: Formula fonts load status: ";for(const wa of cb)Fa+=`${wa.font}: ${ma[wa.status]}; `;c.ULS.sendTraceTag(509642332,0,50,Fa)},2E3)}aYd(cb,Fa){this.Ko=Ka.zhc(cb);
this.Ko.classList.add(r.lZe);this.Ko.classList.add(r.mZe);const wa=this.$Ma.Zrh(Fa);Fa=Ka.gac(this.Tb,!0);wa.appendChild(Fa);Ka.zxa=Ka.cPe(cb.fc);const ka=Ka.ZOe(),Oa=Ka.GPe(cb.fc),hb=Ka.FPe(cb.fc),Pa=Ka.zOe(cb.fc);hb.tabIndex=-1;Pa.tabIndex=-1;Oa.appendChild(Pa);Oa.appendChild(hb);Oa.appendChild(Ka.zxa);ka.appendChild(Oa);ka.appendChild(wa);cb=Ka.xPe(cb.fc);this.Ko.appendChild(cb);this.Ko.appendChild(ka);const ca=new yb.a(Fa,this.Tb,!1);this.Kla=Fa;this.$Ma.lineHeight=ca.x6h();ca.gR(()=>{zb.c(ca.pf,
l.a.ariaLabel,"formula bar")});ca.gR(()=>{this.$Ma.Huj()});ca.isVisible=!1;return ca}sSa(cb){this.qyc(cb);super.sSa(cb);Gb.b(this.$).Ld(F.a.RVh,{["Location"]:"canvas"});k.a.rh&&window.focus();const Fa=this.$.shortcutKeyManager.Ds(cb);this.Tb&&this.BXf(cb,Fa);this.textBox.disabled||this.Tb&&this.Eb||this.startEdit(!0,!1,cb);let wa;wa={};wa.wasEditing=this.Eb;wa.formulaBar=!0;let ka=this.ji(cb,Fa);!ka&&qb.d(Fa,this.z$a,!0)&&(ka=this.Suf(Fa)?!0:this.grid.ga.ji(cb,Fa,wa));ka||ub.a(this.$).BDd(cb,0,7)}startEdit(cb,
Fa,wa){const ka=this.grid;if(!this.Eb||!ka.Eb){this.textBox.yib("FormulaBar.StartEdit");this.textBox.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:cb,["IsOnMouseDown"]:Fa});Gb.b(ka.$).Ld(F.a.PVh,{["Location"]:"canvas"});this.Eb=this.l$a=!0;ka.Qr&&ka.Qr.fDc(this);ka.cellTextEditBox.SF(!1);ka.cellTextEditBox.XTd();this.leg(!1);if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")){const hb=this.grid.cellTextEditBox.textBox.domElement;
c.ULS.sendTraceTag(537161940,0,50,`FormulaBar.StartEdit: gridKeyboardHandler is: ${hb.id}, parent is: ${hb.parentNode?hb.parentNode.id:"null"}`)}var Oa=()=>{var hb=ka.$.ua.na;const Pa=ka.jc(null);hb=new E.a(Pa,hb,void 0,void 0,void 0,this.ynd(Pa));this.hPd(hb);this.Tb&&this.mDc(ka.cellTextEditBox.textBox.gG);!this.Tb&&Pa&&Pa.f0d&&(this.text="");this.Tb?(window.setTimeout(()=>{if(this.Eb&&ka.Eb){ka.Eb&&ka.cellTextEditBox.textBox.detachCursorFormat();if(!this.iF(null)){const ba=ka.cellTextEditBox.formattedText;
var ca=this.textBox.caretPosition;const ib=ba.Text.length;ca=this.textBox.text.length!==ib?ib:ca;this.formattedText=ba;this.textBox.caretPosition=ca}this.l$a=!1;this.textBox.clearHistory()}else this.Eb=!1},0),ka.cellTextEditBox.cUd()):(Fa||(this.Kjb(),this.iF(null)),ka.cellTextEditBox.cUd(),this.l$a=!1)};if(ka.Eb)ka.jG=1,Oa();else if(this.textBox.yG=!0,Y.TaskExtensions.za(ka.startEdit(!1,1,wa,!1,void 0,Fa,1),hb=>{hb.result?(ka.Eb||(this.textBox.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),
c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.Eb&&ka.Eb?(ka.cellTextEditBox.textBox.yG=!0,hb=ka.jc(null),this.textBox.s5e(Number.NaN,this.ynd(hb)),cb&&this.textBox.setCaretPositionToEnd(),Oa()):this.Eb=!1):this.Eb=!1},this.ka,11),this.textBox.yG=!1,wa=ka.jc(null),null===wa||void 0===wa?0:wa.txd)this.textBox.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=sa.HelperMethods.Tlg(this.text)}}xg(cb,
Fa){super.xg(cb,Fa);this.IYd()}tVa(cb){za.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!cb}`);super.tVa(cb)}IYd(){const cb=this.grid;cb.Eb&&2===cb.jG||this.zDa()}Xe(){var cb=this.grid;this.Eb&&cb.Eb&&(cb=cb.wc,cb.text=this.text,cb.setCaretPosition(this.textBox.caretPosition),this.inRangePicker&&this.textBox.focus())}zDa(){this.Tb?this.bog():
this.Seg()}Seg(){if(this.textBox){var cb=this.grid;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.Eb,["TextBox.Initialized"]:this.textBox.initialized,["Grid.IsEditing"]:cb.Eb});if(!this.Eb){var Fa=Ua.a(this.$).Qq();this.Ko.disabled=Fa||!this.$.isEditMode;var wa=(Fa=this.$.z_===cb)&&1===cb.ga.gf;this.textBox.initialized&&(this.textBox.disabled=this.Ko.disabled||Fa&&!wa);Fa=new Jb.a(this.textBox.style);var ka=!1;if(wa)if(cb.Eb)this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",
{["ActiveCellContents"]:"CellTextEditBox.Text"}),wa=cb.cellTextEditBox.text;else{ka=cb.jc(null);wa=new R.a(this.$.ua);if(!ka||!wa.pGb(ka.range,cb))return;cb=wa.$h;wa=ka.ui;var Oa=ka.formulaBarText;const hb=ka.text;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:cb,["activeCell.IsHidden"]:wa,["activeCell.FormulaBarText"]:!!Oa,["activeCell.Text"]:!!hb});wa=cb&&wa?"":Oa||hb;ka=ka.f0d}else wa="",Oa=cb.ga.Sa.Fc,Oa=(null===
Oa||void 0===Oa?0:Oa.floatingObject)?Oa.floatingObject.Yb:null,64===cb.ga.gf&&Oa&&Oa.IsShapeFormulaPresent&&((cb=(cb=Oa.ShapeText)?cb.substring(cb.indexOf("\nFormula:")+9,cb.indexOf(";FormulaVal:")):null)?(this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),wa="="+cb):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));
this.leg(ka);this.sZb=this.P6c();Fa.cD.direction=this.R9a?w.a.rtl:w.a.ybb;Fa.cD.textAlign=this.R9a?w.a.right:w.a.left;Fa.J4();this.text=wa}}}qdg(){var cb=this.$.z_;if(this.bwd){const Fa=!!this.grid.bL&&this.grid.bL.eG;this.isVisible=cb=!!cb&&this.$.ckd&&!this.$.ea.Gc.inEmbedView;Fa||(this.textBox.isVisible=cb)}else this.isVisible=!!cb&&this.$.ckd&&!this.$.ea.Gc.inEmbedView;this.$.kC(t.a.JSb);this.$.CJ()}leg(cb){D.DOMElementExtensions.toggleCssClass(this.textBox.domElement,r.AHh,cb)}Uxa(){return this.Ko.querySelectorAll(D.DOMElementExtensions.Er+
", div[tabindex]")}nm(){return D.DOMElementExtensions.nm(this.Uxa())}UUh(){const cb=this.nm();return cb?(D.DOMElementExtensions.setFocus(cb),!0):!1}BXf(cb,Fa){Fa=-287251124===Fa||-1925065947===Fa||1764140053===Fa;Ma.a.uQa()&&Fa&&cb.preventDefault()}h3c(){Ka.zxa&&D.DOMElementExtensions.toggleCssClass(Ka.zxa,r.YFe,!this.$.isEditMode)}mDc(cb){this.Tb&&(this.textBox.gG=cb)}eCi(){return this.Tb&&!S.a.qO()}toggleEditingEvents(cb){this.textBox.toggleEditingEvents(cb)}tui(cb,Fa=null){this.Ko?this.cQa?za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InitNameBoxEagerly",
!1)?this.PDb():za.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?this.$.ea.Of?this.PDb():this.$.ea.nk(this.PDb):this.$.ea.nk(this.PDb):cb.da.Gb(53,wa=>{Y.TaskExtensions.za(O.GetServiceTaskFactory.create(cb.da,102,this.ka,1),ka=>{this.kui(cb,wa,ka.result,this.Ko,Fa)},this.ka)}):this.vTd()}t6f(){Ja.PageLoadTrackingInfo.instance.d2(t.a.Jla,this.sGd);Ja.PageLoadTrackingInfo.instance.cY(t.a.Jla,this.sGd);Ja.PageLoadTrackingInfo.instance.bY(t.a.Jla,this.sGd)}vTd(){c.ULS.sendTraceTag(537161947,
0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}Suf(cb){return this.fnc&&!this.W8d&&(125627505===cb||706199415===cb)}get text(){return super.text}static zhc(cb){return document.getElementById(cb.fc+t.a.V4a)}static bOj(cb){const Fa=za.EwaSettings.Tb(),wa=Ka.zhc(cb);wa.classList.add(r.lZe);Ka.zxa=Ka.cPe(cb.fc);const ka=Ka.gac(Fa,!0),Oa=Ka.ZOe();Oa.appendChild(Ka.zxa);Oa.appendChild(ka);const hb=Ka.GPe(cb.fc),Pa=Ka.FPe(cb.fc),ca=Ka.zOe(cb.fc);hb.appendChild(Pa);hb.appendChild(ca);
Oa.appendChild(hb);cb=Ka.xPe(cb.fc);wa.appendChild(cb);wa.appendChild(Oa);const ba=new yb.a(ka,Fa,!1);ba.gR(()=>{zb.c(ba.pf,l.a.ariaLabel,"formula bar")});ba.isVisible=!1;return ba}static ZOe(){const cb=document.createElement("div");cb.className=r.uHh;cb.classList.add(r.AR);return cb}static GPe(cb){const Fa=document.createElement("div");Fa.id=cb+Ka.FHf;Fa.className=r.Jtc;Fa.classList.add(r.AR);return Fa}static gac(cb,Fa){const wa=Ma.a.uQa(),ka=document.createElement(wa?"div":"textarea");ka.className=
r.BHh;Fa&&cb&&ka.classList.add(r.DHh);cb?ka.classList.add(r.TYi):(ka.setAttribute(x.a.autoCorrect,v.a.off),ka.setAttribute(x.a.wrap,v.a.virtual),ka.setAttribute(x.a.spellcheck,v.a.Kra),D.DOMElementExtensions.py(ka,t.a.d2a),ka.tabIndex=0);wa?(ka.id=t.a.P6a,cb||ka.setAttribute(x.a.contentEditable,v.a.o8d)):(ka.cols=20,ka.rows=2);return ka}static cPe(cb){const Fa=document.createElement("div");Fa.id=cb+t.a.Tfc;Fa.className=r.p6e;D.DOMElementExtensions.py(Fa,t.a.qu);Fa.setAttribute(t.a.ov,"insert function");
Fa.tabIndex=0;Fa.classList.add(r.AR);return Fa}static FPe(cb){const Fa=document.createElement("div");Fa.id=cb+Ka.gId;Fa.className=r.GHf;D.DOMElementExtensions.py(Fa,t.a.qu);Fa.setAttribute(t.a.ov,"commit edit");Fa.tabIndex=0;Fa.classList.add(r.AR);return Fa}static zOe(cb){const Fa=document.createElement("div");Fa.id=cb+Ka.d7c;Fa.className=r.THe;D.DOMElementExtensions.py(Fa,t.a.qu);Fa.setAttribute(t.a.ov,"cancel edit");Fa.tabIndex=0;Fa.classList.add(r.AR);return Fa}static xPe(cb){const Fa=document.createElement("div");
Fa.id=cb+t.a.bkd;Fa.className=r.zHh;return Fa}}Ka.FHf="okCancelButtonContainer";Ka.gId="okboxButton";Ka.d7c="cancelboxButton";Ka.zxa=null;Object(u.a)(Ka,"FormulaBar",n.a,[29])},897:function(u,C,a){var c=a(73);u=a(0);class b{constructor(){this.Bhb=!1;this.fullName=this.name=this.scope=null}}Object(u.a)(b,"NamedObjectDetails",null,[]);var f=a(187),e=a(129),d=a(23);a.d(C,"b",function(){return h});a.d(C,"a",function(){return l});a.d(C,"c",function(){return k});const h=(n,v,x,w=!1)=>{for(let r=0,t=n.count;r<
t;r++){const A=n.getItem(r),y=2===A.type?f.a(A):A.usedRange,z=w&&2===A.type?A.usedRange:null;if((y.equals(v)||v.equals(z))&&A.sheetName===x)return A}return null},l=n=>{const v=new b;v.fullName=n;n=e.c(n.split(RegExp("[!']")),x=>!d.a.equals(x,"",!0));2===n.length?(v.Bhb=!0,v.scope=n[0],v.name=n[1]):(v.Bhb=!1,v.scope="",v.name=n[0]);return v},k=(n,v=!1)=>n&&c.h(n)?(n.activate(v),!0):!1}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.vrd.js.map/b95bae7ecee95e9632b3c2ebde3a8d91/EwaDSOpt.vrd.js.map