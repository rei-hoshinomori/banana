'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1008:function(u,C,a){a.d(C,"a",function(){return c});const c=(b,f)=>{let e=!1;b&&(b=f.osfControl,(f=b.getManifest())&&f.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(e=!0));return e}},1009:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.vja=this.TWa=this.tnd=this.Npd=this.TBb=this.D3d=null}}Object(u.a)(c,
"AppsForOfficeOauthResult",null,[])},1012:function(u,C,a){a.d(C,"a",function(){return c});const c=(b,f)=>OfficeExtension.WacRuntime.Utility.createPromise((e,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,f))})},1239:function(u,C,a){a.r(C);u=a(0);var c=a(2),b=a(15),f=a(6),e=a(170),d=a(199),h=a(126),l=a(200),k=a(58),n=a(52),v=a(40),x=a(235),w=a(120),r=a(539);class t{constructor(fb){fb=fb.split("|");this.Ey=fb[1];this.pZc=fb[2];this.t2d=fb[3]}get solutionId(){return this.Ey}get solutionVersion(){return this.pZc}get needToRestoreManifest(){return this.t2d===
OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(t,"AddinStoreInfo",null,[]);class A{}Object(u.a)(A,"CustomFunctionRegistrationInfos",null,[]);var y=a(205),z=a(77);const E=(fb,Ua,Ca)=>G(fb,Ua,y.a.none,z.a.current,Ca),G=(fb,Ua,Ca,Ia,oa)=>{Ca=fb.continueWith(()=>{Ua(fb)},3,Ca,Ia);Ca.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,oa)},4);return Ca},F=(fb,Ua,Ca)=>O(fb,Ua,y.a.none,z.a.current,Ca),O=(fb,Ua,Ca,Ia,oa)=>{Ca=fb.Xp(()=>Ua(fb),3,Ca,Ia);Ca.continueWith(()=>{b.ULS.sendTraceTag(537163462,
0,10,oa)},4);return v.TaskExtensions.UIc(Ca)},M=(fb,Ua,Ca)=>P(fb,Ua,y.a.none,z.a.current,Ca),P=(fb,Ua,Ca,Ia,oa)=>{Ca=fb.Xp(()=>Ua(fb),3,Ca,Ia);Ca.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,oa)},4);return Ca},B=(fb,Ua,Ca)=>D(fb,Ua,y.a.none,z.a.current,Ca),D=(fb,Ua,Ca,Ia,oa)=>{Ca=fb.Xp(()=>Ua(fb),3,Ca,Ia);Ca.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,oa)},4);return v.TaskExtensions.UIc(Ca)},I=(fb,Ua,Ca)=>S(fb,Ua,y.a.none,z.a.current,Ca),S=(fb,Ua,Ca,Ia,oa)=>{Ca=fb.continueWith(()=>
{Ua(fb)},3,Ca,Ia);Ca.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,oa)},4);return Ca},J=(fb,Ua)=>{M(a(1239).CustomFunctionsInstaller.ebf("CustomFunctionsRuntimeLogging"),Ca=>{if(Ca.result&&window.console)switch(Ca=L(fb.severity)+" "+fb.message+Ua,fb.severity){case 2:window.console.log&&window.console.log(Ca);break;case 0:window.console.info&&window.console.info(Ca);break;case 1:window.console.error&&window.console.error(Ca)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},
L=fb=>{switch(fb){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var R=a(1008);class Y{}Object(u.a)(Y,"InstallationInfo",null,[]);class Q{}Object(u.a)(Q,"UninstallationInfo",null,[]);var W=a(32),Ga=a(91),pa=a(38),aa=a(33),Z=a(1),fa=a(23),ya=a(246),Aa=a(821),ja=a(62);class za{constructor(fb,Ua){this.NYc=fb;this._message=Ua}get severity(){return this.NYc}get message(){return this._message}}Object(u.a)(za,"CustomFunctionLog",null,[]);a.d(C,"CustomFunctionsInstaller",
function(){return ra});class ra{constructor(fb,Ua,Ca){this.Aza=!1;this.BG={};this.$=fb;this.mk=Ua;this.Gud().Rpa();this.indexedDB=Ca;this.indexedDB.sf()&&(this.Aza=!0,this.indexedDB.initialize(ra.EDb,ra.FDb))}get LW(){return this.mk.LW}hnf(fb,Ua,Ca,Ia){if(Ia.invariantNamespace)for(let oa=0;oa<Ia.invariantNamespace.length;++oa){const Da=Ia.invariantNamespace.charAt(oa);if("."!==Da&&"_"!==Da&&"a">Da&&"z"<Da&&"A">Da&&"Z"<Da&&"0">Da&&"9"<Da)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Da}', Position=${oa}.`),
Error.create("InvariantNamespace validation failed");}return F(this.i$g(Ca,Ia.manifest),()=>F(this.VPd(fb),oa=>{let Da=oa.result;return(null===Da||void 0===Da?0:Da.isDynamicMetadata)?this.UQd(fb,Ua,Da,!1,!1,!1):F(this.Ulk(fb,Ua,Ia),bb=>{Da=new Y;Da.addinId=Ca;Da.locale=Ia.locale;Da.addinInvariantNamespace=Ia.invariantNamespace;Da.addinNamespace=Ia.namespace;Da.addinTitle=Ia.title;Da.isXllCompatible=Ia.isXllCompatible;Da.metadataContent=JSON.stringify(JSON.parse(bb.result));return this.UQd(fb,Ua,Da,
!1,ra.EQh(Ia.osfControl.getStoreType()),R.a(this.$,Ia))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}jnf(fb,Ua,Ca,Ia){if(!ra.fAd(Ca))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return F(this.VPd(fb),oa=>{oa=oa.result;if(!oa&&(oa=pa.a.nd(this.LW,fb),!oa))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fb,Ua,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");oa.metadataContent=JSON.stringify(JSON.parse(Ca));oa.isDynamicMetadata=!0;return this.UQd(fb,Ua,oa,!0,!0,Ia)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}xrg(fb,
Ua){this.mk.Xka();const Ca=Object(c.a)(new Q,{solutionId:fb}),Ia=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fb,Ua,null)}.`;return F(this.BRd(fb),()=>F(this.JRd(fb),()=>this.f6d(this.mk,fb,Ua,Ca),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Ia)}Ulk(fb,Ua,Ca){const Ia=new e.a;OSF.OUtil.xhrGet(Ca.metadataUrl,oa=>{oa?Ia.setResult(oa):Ia.setException(Error.create("Invalid manifest"))},
oa=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fb,Ua,null)}. ErrorCode: ${oa}.`);Ia.Pt()});return Ia.task}Gud(){return F(this.Cyc(),fb=>{const Ua=fb.result;if(!Ua.length)return ja.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");fb=new d.a;const Ca=[];for(let Ia=
0;Ia<Ua.length;Ia++){const oa=Object(h.a)(String,Ua[Ia]);fb.add(M(this.VPd(oa),Da=>{if(Da=Da.result){const bb=pa.a.nd(this.BG,Da.addinId);bb&&bb===Da.metadataContent||(this.BG[Da.addinId]=Da.metadataContent,this.LW[oa]=Da,Ca.push(Da))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return B(ja.Task.WhenAllEnumerable(fb),()=>{if(Ca.length){let Ia=new A;Ia.registrationInfos=Ca;return this.E6b(this.mk,Ua,Ia)}b.ULS.sendTraceTag(537163546,0,
50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ja.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}knf(){var fb=new e.a;new d.a;const Ua=[],Ca=[];Object.keys(this.LW).forEach(Ia=>{Ia=Object(h.a)(String,Ia);const oa=pa.a.nd(this.LW,Ia);Ua.push(oa);Ca.push(Ia)});if(!Ca.length)return fb.setResult(!0),fb.task;fb=Object(c.a)(new A,
{registrationInfos:Ua});return this.E6b(this.mk,Ca,fb)}Cyc(){return M(this.Nnd(r.a.z1a),fb=>{fb=fb.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(fb||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(fb||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Hxg(fb){return this.fYd(r.a.z1a,Sys.Serialization.JavaScriptSerializer.serialize(fb))}VPd(fb){return F(this.Nnd(r.a.J7a(fb)),Ua=>{Ua=Ua.result||
"";return 0<Ua.length?ja.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(Ua,!0)):ja.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}Mlk(fb,Ua){return F(this.wXe(fb),()=>F(this.fYd(r.a.J7a(fb),Sys.Serialization.JavaScriptSerializer.serialize(Ua)),()=>ra.gYd(r.a.Crd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}BRd(fb){return F(this.b3f(fb),
()=>F(this.s3f(r.a.J7a(fb)),()=>F(this.Cyc(),Ua=>Ua.result.length?ja.Task.Ua(!0):ra.gYd(r.a.Crd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}k0f(fb){return this.Nnd(r.a.I7a(fb))}Exg(fb,Ua){return F(this.wXe(fb),
()=>this.fYd(r.a.I7a(fb),Ua),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}JRd(fb){return F(this.b3f(fb),()=>this.s3f(r.a.I7a(fb)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}wXe(fb){return F(this.Cyc(),Ua=>{Ua=Ua.result;const Ca=fb.toLowerCase();if(Ua.includes(Ca))return ja.Task.Ua(!0);Ua.push(Ca);return this.Hxg(Ua)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}b3f(fb){return F(this.Cyc(),
Ua=>{Ua=Ua.result;const Ca=fb.toLowerCase();return Ua.includes(Ca)?(Ua.splice(Array.indexOf(Ua,Ca),1),this.Hxg(Ua)):ja.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}i$g(fb,Ua){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return fb=new OSF.AddinIdInfo(fb),fb.needToRestoreManifest()?this.Exg(fb.getSolutionId(),Ua):ja.Task.Ua(!0);fb=new t(fb);return fb.needToRestoreManifest?this.Exg(fb.solutionId,
Ua):ja.Task.Ua(!0)}$Dj(fb){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Ca=new OSF.AddinIdInfo(fb);return Ca.needToRestoreManifest()?M(this.k0f(Ca.getSolutionId()),Ia=>{(Ia=Ia.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ca.getSolutionId(),Ca.getSolutionVersion(),Ia,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ja.Task.Ua(!0)}const Ua=new t(fb);return Ua.needToRestoreManifest?
M(this.k0f(Ua.solutionId),Ca=>{(Ca=Ca.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ua.solutionId,Ua.solutionVersion,Ca,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ja.Task.Ua(!0)}s3f(fb){return this.Aza?this.indexedDB.ldd(fb):ra.swj(fb)}fYd(fb,Ua){return this.Aza?this.indexedDB.Fgb(new Aa.a(fb,Ua)):ra.gYd(fb,Ua)}Nnd(fb){return this.Aza?this.indexedDB.E7a(fb):ra.ebf(fb)}UQd(fb,Ua,Ca,Ia,oa,Da){const bb=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fb,
Ua,null)}.`;return v.TaskExtensions.UIc(M(this.VQd(this.mk,fb,Ua,Ca,!1,Ia,Da),()=>oa?this.Mlk(fb,Ca):ja.Task.Ua(!0),bb))}VQd(fb,Ua,Ca,Ia,oa,Da,bb){if(!Da&&(Da=pa.a.nd(this.BG,Ia.addinId))&&Da===Ia.metadataContent)return ja.Task.Ua(!0);this.BG[Ia.addinId]=Ia.metadataContent;this.LW[Ua]=Ia;bb||fb.gOb(Ua);fb.Xka();return F(this.Etj(Ua,Ca,Ia),()=>this.COd(Ia.addinId,oa),"Failed to register functions for customfunction addin")}Etj(fb,Ua,Ca){const Ia=new e.a,oa=this.YJa(Ca);return this.j6(Da=>{J(ra.$wb,
fb);(Da=Da.Result)&&204===Da.ResponseStatusCode?Ia.setResult(!0):(delete this.BG[Ca.addinId],delete this.LW[fb],E(this.BRd(fb),()=>{E(this.JRd(fb),()=>{this.Whg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${fb}. Received status code ${Da?Da.ResponseStatusCode.toString():"Unknown"}.`),Ia.setResult(!1))},Da=>{Da=w.a.lf(Da.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fb,
Ua,null)}. Errors: ${aa.a.Ic(Da)}.`);J(ra.Zwb,fb);delete this.BG[Ca.addinId];delete this.LW[fb];Ia.setResult(!1)},oa,Ia,!0)}E6b(fb,Ua,Ca){const Ia=new e.a,oa=W.a.Bb.Ye.m;Ua.forEach(bb=>{bb=Object(h.a)(String,bb);fb.RIe(bb)});fb.Xka();const Da=this.d6c(Ca);return this.j6(bb=>{J(ra.$wb,Sys.Serialization.JavaScriptSerializer.serialize(Ua));bb=bb.Result;let Za=!0;var Xa=[];Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),Xa=Sys.Serialization.JavaScriptSerializer.deserialize(bb.ResponseBody.toString()),
Xa=Array.isArray(Xa.value)?Xa.value:null;const Ba=new d.a;for(let Wa=0;Wa<Xa.length;Wa++)if(!Xa[Wa]){Za=!1;const Na=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${bb.ResponseStatusCode}.`;Ba.add(F(this.BRd(Ua[Wa]),()=>{delete this.BG[Ca.registrationInfos[Wa].addinId];delete this.LW[Ua[Wa]];return this.JRd(Ua[Wa])},Na))}I(ja.Task.WhenAllEnumerable(Ba),()=>{E(this.COd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${W.a.Bb.Ye.m-
oa} Millisecond.`);Za?Ia.setResult(Za):I(this.Whg(),()=>{Ia.setResult(Za)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},bb=>{bb=w.a.lf(bb.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${aa.a.Ic(bb)}.`);
J(ra.Zwb,Sys.Serialization.JavaScriptSerializer.serialize(Ua));for(bb=0;bb<Ca.registrationInfos.length;bb++)delete this.BG[Ca.registrationInfos[bb].addinId],delete this.LW[Ua[bb]];Ia.setResult(!1)},Da,Ia,!0)}f6d(fb,Ua,Ca,Ia){return F(this.Mbk(fb,Ua,Ca,Ia),()=>this.COd(Ia.solutionId,!1),"Failed to unregister functions for customfunction addin")}Mbk(fb,Ua,Ca,Ia){const oa=new e.a;fb.gOb(Ua);(fb=pa.a.nd(this.LW,Ua))&&delete this.BG[fb.addinId];delete this.LW[Ua];Ia=this.q6c(Ia);return this.j6(()=>{J(ra.icd,
Ua);oa.setResult(!0)},Da=>{Da=w.a.lf(Da.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ua,Ca,null)}. Errors: ${aa.a.Ic(Da)}.`);J(ra.hcd,Ua);oa.setResult(!1)},Ia,oa,!1)}j6(fb,Ua,Ca,Ia,oa){const Da=this.$.userOperationManager,bb=this.$.qa;let Za=null,Xa=null,Ba=null;const Wa=()=>{if(Da.SKa()||0<bb.va.k6||0<bb.Dl.k6)return!1;Za&&Da.Uo(Za);Xa&&bb.Mt(Xa);
Ba&&bb.Jz(Ba);const Na=Ca.request;let ta=0;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Na.RequestFlags&1&&256!==(Na.RequestFlags&256)||(ta=16):ta=Na.RequestFlags&1?0:16;Da.lG(new l.a(507,0,(V,ia,X)=>{J(oa?ra.gcd:ra.jcd,Na.RequestBody);return k.g(bb.va,"ExecuteRichApiRequest",Ca,ya.b(V,fb),ya.a(ia,Ua),X,null,0)},ta|64));return!0};Wa()||(Za=()=>{Wa()},Xa=()=>{Wa()},Ba=()=>{Wa()},Da.ks(Za),bb.ms(Xa),bb.Iy(Ba));return Ia.task}YJa(fb){const Ua={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ua.RequestBody=JSON.stringify(fb);Ua.RequestFlags=1;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ua.RequestFlags|=256);fb=this.$.qa.va.Pa(1);fb.request=Ua;return fb}d6c(fb){const Ua={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ua.RequestBody=JSON.stringify(fb);Ua.RequestFlags=1;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(Ua.RequestFlags|=256);fb=this.$.qa.va.Pa(1);fb.request=Ua;return fb}q6c(fb){const Ua={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ua.RequestBody=JSON.stringify(fb);Ua.RequestFlags=1;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ua.RequestFlags|=256);fb=this.$.qa.va.Pa(1);fb.request=Ua;return fb}COd(fb,Ua){const Ca=n.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);return O(Ca,()=>{Ca.result.WTd();return fb&&Ua?
this.$Dj(fb):ja.Task.Ua(!0)},this.$.ka,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}Whg(){const fb=new Ga.a(1949669462,0,this.$.Kc,0,null);return this.$.Ia.$b(fb)}static ebf(fb){try{return ja.Task.Ua(localStorage.getItem(fb))}catch(Ua){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${Ua.message||"Unknown"}`),ja.Task.Ua(null)}}static gYd(fb,
Ua){try{return localStorage.setItem(fb,Ua),ja.Task.Ua(!0)}catch(Ca){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Ca.message||"Unknown"}`),ja.Task.Ua(!1)}}static swj(fb){try{return localStorage.removeItem(fb),ja.Task.Ua(!0)}catch(Ua){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${Ua.message||"Unknown"}`),
ja.Task.Ua(!1)}}static EQh(fb){return fa.a.equals(fb,"registry",!0)||fa.a.equals(fb,"uploadfiledevcatalog",!0)||f.AFrameworkApplication.userNameUnknown||f.AFrameworkApplication.limitedEdit}static fAd(fb){if(!fb)return!1;try{JSON.parse(fb)}catch(Ua){return!1}return!0}}ra.EDb="CustomFunctionCache";ra.FDb="CustomFunction";ra.gcd=new za(2,"CustomFunctions [Registration] [Begin] SolutionId=");ra.$wb=new za(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");ra.Zwb=new za(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
ra.jcd=new za(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");ra.icd=new za(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");ra.hcd=new za(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(ra,"CustomFunctionsInstaller",null,[696])},1243:function(u,C,a){a.r(C);u=a(0);var c=a(2),b=a(15),f=a(981),e=a(170),d=a(126),h=a(200),l=a(58),k=a(52),n=a(40),v=a(120),x=a(539),w=a(1008);class r{constructor(L){L=L.split("|");this.Ey=L[1];this.pZc=L[2];this.t2d=
L[3]}get solutionId(){return this.Ey}get solutionVersion(){return this.pZc}get needToRestoreManifest(){return this.t2d===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(r,"AddinStoreInfo",null,[]);class t{}Object(u.a)(t,"CustomFunctionRegistrationInfos",null,[]);const A=(L,R)=>{if(a(1243).CustomFunctionsLegacyInstaller.jBb("CustomFunctionsRuntimeLogging")&&window.console)switch(R=y(L.severity)+" "+L.message+R,L.severity){case 2:window.console.log&&window.console.log(R);break;case 0:window.console.info&&
window.console.info(R);break;case 1:window.console.error&&window.console.error(R)}},y=L=>{switch(L){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class z{}Object(u.a)(z,"InstallationInfo",null,[]);class E{}Object(u.a)(E,"UninstallationInfo",null,[]);var G=a(167),F=a(38),O=a(33),M=a(1),P=a(16),B=a(246),D=a(908),I=a(62);class S{constructor(L,R){this.NYc=L;this._message=R}get severity(){return this.NYc}get message(){return this._message}}Object(u.a)(S,"CustomFunctionLog",
null,[]);a.d(C,"CustomFunctionsLegacyInstaller",function(){return J});class J{constructor(L){this.BG={};this.$=L;this.Gud().Rpa()}hnf(L,R,Y,Q){const W=new e.a;if(Q.invariantNamespace)for(R=0;R<Q.invariantNamespace.length;++R){const pa=Q.invariantNamespace.charAt(R);if("."!==pa&&"_"!==pa&&"a">pa&&"z"<pa&&"A">pa&&"Z"<pa&&"0">pa&&"9"<pa)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${pa}', Position=${R}.`),W.setResult(!1),
W.task}J.cacheManifest(Y,Q.manifest);let Ga=J.WPd(L);(null===Ga||void 0===Ga?0:Ga.isDynamicMetadata)?this.TQd(L,Ga,W,!1,!1):OSF.OUtil.xhrGet(Q.metadataUrl,pa=>{Ga=Object(c.a)(new z,{addinId:Y,locale:Q.locale,addinInvariantNamespace:Q.invariantNamespace,addinNamespace:Q.namespace,addinTitle:Q.title,isXllCompatible:Q.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(pa))});this.TQd(L,Ga,W,!1,w.a(this.$,Q))},pa=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${L}. ErrorCode: ${pa}.`);
W.setResult(!1)});return W.task}jnf(L,R,Y,Q){R=new e.a;if(!J.fAd(Y))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),R.setResult(!1),R.task;const W=J.WPd(L);if(!W)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),R.setResult(!1),R.task;W.metadataContent=JSON.stringify(JSON.parse(Y));W.isDynamicMetadata=
!0;this.TQd(L,W,R,!0,Q);return R.task}xrg(L){const R=new e.a,Y=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);n.TaskExtensions.za(Y,()=>{const Q=Y.result;Q.Xka();const W=Object(c.a)(new E,{solutionId:L});J.CRd(L);J.KRd(L);n.TaskExtensions.za(this.f6d(Q,L,W),Ga=>{G.b(Ga)?R.setResult(Ga.result):(Ga.vg?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${L}.`):Ga.Zh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${L}.`),
R.setResult(!1))},this.$.ka,0)},this.$.ka,3);return R.task}Gud(){const L=new e.a,R=J.aQd();0<R.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Y=[];R.forEach(W=>{W=Object(d.a)(String,W);if(W=J.WPd(W)){const Ga=F.a.nd(this.BG,W.addinId);Ga&&Ga===W.metadataContent||(this.BG[W.addinId]=W.metadataContent,Y.push(W))}});if(!Y.length)return L.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
L.task;const Q=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);n.TaskExtensions.za(Q,()=>{const W=Q.result,Ga=Object(c.a)(new t,{registrationInfos:Y});n.TaskExtensions.za(this.E6b(W,R,Ga),pa=>{G.b(pa)?L.setResult(pa.result):(pa.vg?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):pa.Zh&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
L.setResult(!1))},this.$.ka,0)},this.$.ka,3);return L.task}ZDj(L){L=new r(L);if(L.needToRestoreManifest){const R=J.erj(L.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(L.solutionId,L.solutionVersion,R,this.$.xa.UICultureTag)}}TQd(L,R,Y,Q,W){const Ga=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);n.TaskExtensions.za(Ga,()=>{n.TaskExtensions.za(this.VQd(Ga.result,L,R,!1,Q,W),pa=>{G.b(pa)?((pa=pa.result)&&J.Nlk(L,R),Y.setResult(pa)):(pa.vg?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${L}.`):
pa.Zh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${L}.`),Y.setResult(!1))},this.$.ka,0)},this.$.ka,3)}VQd(L,R,Y,Q,W,Ga){if(!W&&(W=F.a.nd(this.BG,Y.addinId))&&W===Y.metadataContent)return I.Task.Ua(!0);this.BG[Y.addinId]=Y.metadataContent;const pa=new e.a;Ga||L.gOb(R);L.Xka();L=this.YJa(Y);return this.j6(aa=>{A(J.$wb,R);const Z=aa.Result;204===Z.ResponseStatusCode?n.TaskExtensions.za(this.BOd(pa,Y.addinId,
Q),fa=>{fa.vg?R?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${R}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Y.addinId}.`):fa.Zh&&(R?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${R}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Y.addinId}.`));pa.setResult(!1)},this.$.ka,4):(aa=()=>{delete this.BG[Y.addinId];J.CRd(R);J.KRd(R);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${R}. Received status code ${Z.ResponseStatusCode}.`);pa.setResult(!1)},aa=Object(c.a)(new D.a,{$Oa:OSF.InfoType.Error,title:Y.addinTitle,
description:String.format(P.a.instance.Lb(153),P.a.instance.ha(1892)),buttonText:P.a.instance.ha(4),Kja:aa,Ekc:!1,Lka:aa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),f.a.N_d(aa))},aa=>{aa=v.a.lf(aa.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${R}. Errors: ${O.a.Ic(aa)}.`);A(J.Zwb,R);delete this.BG[Y.addinId];pa.setResult(!1)},L,pa,!0)}E6b(L,R,Y){const Q=new e.a;R.forEach(Ga=>
{Ga=Object(d.a)(String,Ga);L.RIe(Ga)});L.Xka();const W=this.d6c(Y);return this.j6(Ga=>{A(J.$wb,Sys.Serialization.JavaScriptSerializer.serialize(R));Ga=Ga.Result;let pa=!0;var aa=[];M.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),aa=Sys.Serialization.JavaScriptSerializer.deserialize(Ga.ResponseBody.toString()),aa=Array.isArray(aa.value)?aa.value:null;for(let Z=0;Z<aa.length;Z++)aa[Z]||(pa=!1,delete this.BG[Y.registrationInfos[Z].addinId],J.CRd(R[Z]),J.KRd(R[Z]),b.ULS.sendTraceTag(537163478,
0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${R[Z]}. Received status code ${Ga.ResponseStatusCode}.`));n.TaskExtensions.za(this.BOd(Q,"",!1),Z=>{Z.vg?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Z.Zh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Q.setResult(!1)},
this.$.ka,4);Q.setResult(pa)},Ga=>{Ga=v.a.lf(Ga.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(R)}. Errors: ${O.a.Ic(Ga)}.`);A(J.Zwb,Sys.Serialization.JavaScriptSerializer.serialize(R));for(const pa of Y.registrationInfos)delete this.BG[pa.addinId];Q.setResult(!1)},W,Q,!0)}f6d(L,R,Y){const Q=new e.a;L.gOb(R);L=this.q6c(Y);return this.j6(()=>
{A(J.icd,R);n.TaskExtensions.za(this.BOd(Q,Y.solutionId,!1),W=>{W.vg?R&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${R}.`):W.Zh&&R&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${R}.`);Q.setResult(!1)},this.$.ka,4)},W=>{W=v.a.lf(W.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${R}. Errors: ${O.a.Ic(W)}.`);
A(J.hcd,R);Q.setResult(!1)},L,Q,!1)}j6(L,R,Y,Q,W){const Ga=this.$.userOperationManager,pa=this.$.qa;let aa=null,Z=null,fa=null;const ya=()=>{if(Ga.SKa()||0<pa.va.k6||0<pa.Dl.k6)return!1;aa&&Ga.Uo(aa);Z&&pa.Mt(Z);fa&&pa.Jz(fa);const Aa=Y.request;Ga.lG(new h.a(507,0,(ja,za,ra)=>{A(W?J.gcd:J.jcd,Aa.RequestBody);return l.g(pa.va,"ExecuteRichApiRequest",Y,B.b(ja,L),B.a(za,R),ra,null,0)},(Aa.RequestFlags&1?0:16)|64));return!0};ya()||(aa=()=>{ya()},Z=()=>{ya()},fa=()=>{ya()},Ga.ks(aa),pa.ms(Z),pa.Iy(fa));
return Q.task}YJa(L){const R={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};R.RequestBody=JSON.stringify(L);R.RequestFlags=1;L=this.$.qa.va.Pa(1);L.request=R;return L}d6c(L){const R={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};R.RequestBody=JSON.stringify(L);R.RequestFlags=1;L=this.$.qa.va.Pa(1);L.request=R;return L}q6c(L){const R={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};R.RequestBody=JSON.stringify(L);
R.RequestFlags=1;L=this.$.qa.va.Pa(1);L.request=R;return L}BOd(L,R,Y){const Q=k.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);n.TaskExtensions.za(Q,()=>{Q.result.WTd();R&&Y&&this.ZDj(R);L.setResult(!0)},this.$.ka,3);return Q}knf(){return I.Task.Ua(!0)}static aQd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(J.jBb(x.a.z1a)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(J.jBb(x.a.z1a)||"[]"):null)||[]}static Ixg(L){J.hYd(x.a.z1a,Sys.Serialization.JavaScriptSerializer.serialize(L))}static WPd(L){L=
J.jBb(x.a.J7a(L))||"";return 0<L.length?Sys.Serialization.JavaScriptSerializer.deserialize(L,!0):null}static Nlk(L,R){J.vXe(L);J.hYd(x.a.J7a(L),Sys.Serialization.JavaScriptSerializer.serialize(R))}static CRd(L){J.a3f(L);J.t3f(x.a.J7a(L))}static erj(L){return J.jBb(x.a.I7a(L))}static Olk(L,R){J.vXe(L);J.hYd(x.a.I7a(L),R)}static KRd(L){J.a3f(L);J.t3f(x.a.I7a(L))}static vXe(L){const R=J.aQd();L=L.toLowerCase();R.includes(L)||(R.push(L),J.Ixg(R))}static a3f(L){const R=J.aQd();L=L.toLowerCase();R.includes(L)&&
(R.splice(Array.indexOf(R,L),1),J.Ixg(R))}static cacheManifest(L,R){L=new r(L);L.needToRestoreManifest&&J.Olk(L.solutionId,R)}static jBb(L){try{return localStorage.getItem(L)}catch(R){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${R.message||"Unknown"}`),null}}static hYd(L,R){try{localStorage.setItem(L,R)}catch(Y){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Y.message||
"Unknown"}`)}}static t3f(L){try{localStorage.removeItem(L)}catch(R){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${R.message||"Unknown"}`)}}static fAd(L){if(!L)return!1;try{JSON.parse(L)}catch(R){return!1}return!0}}J.gcd=new S(2,"CustomFunctions [Registration] [Begin] SolutionId=");J.$wb=new S(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");J.Zwb=new S(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
J.jcd=new S(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");J.icd=new S(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");J.hcd=new S(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(J,"CustomFunctionsLegacyInstaller",null,[696])},1285:function(u,C,a){u=a(0);var c=a(205),b=a(15);class f{}Object(u.a)(f,"AddinCommandsHost",null,[]);var e=a(1359),d=a(1463),h=a(905),l=a(58);const k=(F,O,M,P,B,D)=>{const I=F.Pa(9);I.sharedInfo=O;return l.g(F,"InsertAgaveTaskpane",
I,M,P,B,D,0)},n=(F,O,M,P,B,D,I=null)=>{I=F.Pa(9,I);I.sharedInfo=O;return l.g(F,"ShowAgaveTaskpane",I,M,P,B,D,0)};var v=a(382),x=a(200),w=a(40),r=a(1),t=a(246),A=a(157);class y extends A.a{constructor(F){super();this.Te=this.iGa="AddInCommandsDialog";this.rc=5;this.dialogWidth=695;this.dialogHeight=438;this.djh="100%";this.ajh="408px";this.bjh="15px";this.cjh="0";this.gLg=F}get containerDiv(){return this.Bi}gy(){super.gy();this.Bi.style.width=this.djh;this.Bi.style.height=this.ajh;this.Bi.style.marginTop=
this.bjh;this.Bi.style.padding=this.cjh}bF(){super.bF();this.Hb.style.width=String.format("{0}px",this.dialogWidth);this.Hb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.gLg()}}Object(u.a)(y,"AddInCommandsDialog",A.a,[]);var z=a(62),E=a(77);A=a(106);a.d(C,"a",function(){return G});class G extends f{constructor(F,O,M,P=null,B=null){super();this.$=F;this.me=O;this.ownerAddinInfo=M;this.Wd=B;this.tgb=P||z.Task.Ua(!0)}Wih(){const F=this.tgb;this.tgb=z.Task.Ua(!0);
return F}disposeHost(F){this.me.STa(F)}setOwnerAddinEToken(F){this.ownerAddinInfo.eToken=F}showTaskpane(F,O,M){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let P=null,B=!1,D=(new e.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,!0)).nRe(F.solutionId.substr(this.ownerAddinInfo.solutionId.length));P=O.getSharedRuntimeForTaskpane("Workbook",D);B=!!P&&1===P.LifeTime;this.me.UIe(B?this.ownerAddinInfo.solutionId:F.solutionId,B?P:null,null)||(this.FAf(B,!0),this.tgb=
this.Eud(F,P,(I,S)=>{I?(B&&(I.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,I.SharedRuntime=P),I.WebExtensionOsfControlType=3,this.me.fLa(I),M(I.InstanceId,S),this.FAf(B,!1),r.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),M(null,S))}))}getSettings(F,O){let M=this.me.$ca(F.solutionId);
M?O(this.me.gW(M).OsfPropertyBag):this.tgb=this.Eud(F,null,P=>{P?O(P.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(F,O,M){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const P=this.$.qa.va,B=I=>{const S=I.Result,J=S?S.AgaveData:null;J?(this.me.fQe(J,()=>{const L=new y(()=>{this.disposeHost(J.InstanceId)});L.initializeAndShow("",null,null);return L.containerDiv}),M(J.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
M(null,I.Errors?I.Errors[0].ErrorCause:5001))},D=G.bwa(F,this.ownerAddinInfo);this.tgb=v.a(this.$.userOperationManager,(I,S,J)=>k(P,D,t.b(I,B),S,J,null),I=>new x.a(500,0,I,64),this.Wd)}createUILessSandbox(F,O,M){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const P=O.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),B=!!P&&1===P.LifeTime;(O=this.me.mTh(B?this.ownerAddinInfo.solutionId:F.solutionId,B?P:null))?M(O,0):this.tgb=this.Eud(F,P,(D,I)=>{D?(B?(D.PrimaryMarketplace.SolutionId=
this.ownerAddinInfo.solutionId,D.SharedRuntime=P,D.TaskpaneVisible=!1,D.WebExtensionOsfControlType=3,this.me.fLa(D)):(D.WebExtensionOsfControlType=4,this.me.fQe(D,()=>{G.Bjb.ia(D.InstanceId,new d.a);return G.Bjb.ma(D.InstanceId).Dca})),M(D.InstanceId,I)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),M(null,I))})}Eud(F,O,M){let P=null;const B=this.$.qa.va,D=R=>{const Y=R.Result;(P=Y?Y.AgaveData:null)||M(null,R.Errors?R.Errors[0].ErrorCause:5001)},I=G.bwa(F,this.ownerAddinInfo);
O&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),I.SharedRuntimeId=O.Resid);let S=500;var J=(R,Y,Q)=>k(B,I,t.b(R,D),Y,Q,null);let L=0;void 0===I.IsToBePersisted||null===I.IsToBePersisted||I.IsToBePersisted||(S=538,J=(R,Y,Q)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,
null,null,this.ownerAddinInfo.storeId));return n(B,I,t.b(R,D),Y,Q,null)},L=16);L|=64;J=v.a(this.$.userOperationManager,J,R=>new x.a(S,0,R,L),this.Wd);return w.TaskExtensions.ts(J,()=>P?this.BCd(B,P.InstanceId,(R,Y)=>{if(R){O||(P.PrimaryMarketplace.MarketplaceType=F.storeType);F.assetId?F.assetId.toLowerCase().startsWith("wa")?P.AssetMarketplace={SolutionId:F.assetId,SolutionVersion:F.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:F.assetStoreId}:(P.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,
344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):P.AssetMarketplace=null;P.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;P.OwnerAddinStoreType=this.ownerAddinInfo.storeType;P.OsfPropertyBag=[];for(Y=0;Y<R.Settings.length;Y++){const Q=[];Q[0]=R.Settings[Y].Name;Q[1]=R.Settings[Y].Value;P.OsfPropertyBag[Y]=Q}M(P,0)}else M(null,Y.Errors?Y.Errors[0].ErrorCause:5001)}):z.Task.Ua(!1),c.a.none,3,E.a.current)}BCd(F,O,M){const P=B=>{M(B.Result,B)};return v.a(this.$.userOperationManager,
(B,D,I)=>{B=t.b(B,P);const S=F.Pa(1);S.controlId=O;return l.g(F,"DdaLoadSettings",S,B,D,I,null,0)},B=>new x.a(501,0,B,80),this.Wd)}FAf(F,O){var M;F&&(null===(M=window.performance)||void 0===M?0:M.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${O}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(F){G.Bjb.Fb(F)&&
G.Bjb.ma(F).initializeAndShowWithTitle()}static hideUILessDialog(F){G.Bjb.Fb(F)&&G.Bjb.ma(F).hide()}static bwa(F,O){const M={};M.SolutionId=F.solutionId;M.Version=F.version;M.StoreType=O.storeType;M.StoreId=F.storeId;M.AssetId=F.solutionId;M.AssetStoreId="omex";M.TargetType=1;M.Width=350;M.OwnerAddinSolutionId=O.solutionId;M.OwnerAddinStoreType=O.storeType;M.SharedRuntimeId=null;M.Preload=!1;return M}}G.Bjb=new A.a;Object(u.a)(G,"WACExcelAddinCommandsHost",f,[])},1359:function(u,C,a){a.d(C,"a",function(){return b});
u=a(0);a(15);var c=a(6);class b{constructor(f,e,d,h){this.Mob=f;c.AFrameworkApplication.fa.ra("AddInCommandsMissingTabIsEnabled")&&d.A9h();this.Ey=e;this.PNg=h}get vJb(){return this.Mob}get solutionId(){return this.Ey}get l_d(){return this.PNg}xNa(f){f=this.vJb+this.solutionId+f;return this.l_d?(f in b.Y4b||(b.Y4b[f]="AddinControl"+b.zZg++),b.Y4b[f]):f}nRe(f){if(this.l_d){const d=b.Y4b;for(let h in d){var e=h;if(f===d[h])return e.substr(this.vJb.length+this.solutionId.length)}}return f}Wef(f){f=this.vJb+
this.solutionId+f;return this.l_d?(f in b.e3c||(b.e3c[f]="AddinTab"+b.KZg++),b.e3c[f]):f}}b.Y4b={};b.e3c={};b.KZg=0;b.zZg=0;Object(u.a)(b,"DefaultRibbonNamingProvider",null,[767])},1424:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(126),f;(function(w){w[w.none=0]="none";w[w.testEvent=1]="testEvent";w[w.test1Event=2]="test1Event";w[w.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";w[w.worksheetActivatedEvent=11]="worksheetActivatedEvent";w[w.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";
w[w.worksheetAddedEvent=13]="worksheetAddedEvent";w[w.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";w[w.worksheetDeletedEvent=15]="worksheetDeletedEvent";w[w.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";w[w.worksheetFilteredEvent=17]="worksheetFilteredEvent";w[w.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";w[w.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";w[w.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";w[w.worksheetSingleClickedEvent=
21]="worksheetSingleClickedEvent";w[w.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";w[w.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";w[w.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";w[w.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";w[w.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";w[w.worksheetMovedEvent=27]="worksheetMovedEvent";w[w.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";
w[w.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";w[w.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";w[w.chartAddedEvent=50]="chartAddedEvent";w[w.chartActivatedEvent=51]="chartActivatedEvent";w[w.chartDeactivatedEvent=52]="chartDeactivatedEvent";w[w.chartDeletedEvent=53]="chartDeletedEvent";w[w.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";w[w.tableDataChangedEvent=101]="tableDataChangedEvent";w[w.tableAddedEvent=102]=
"tableAddedEvent";w[w.tableDeletedEvent=103]="tableDeletedEvent";w[w.tableFilteredEvent=104]="tableFilteredEvent";w[w.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";w[w.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";w[w.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";w[w.commentAddedEvent=250]="commentAddedEvent";w[w.commentDeletedEvent=251]="commentDeletedEvent";w[w.commentChangedEvent=252]="commentChangedEvent";w[w.invocationMessage=1E3]=
"invocationMessage";w[w.cancellationMessage=1001]="cancellationMessage";w[w.metadataMessage=1002]="metadataMessage";w[w.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";w[w.visualChangeEvent=2001]="visualChangeEvent";w[w.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";w[w.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";w[w.shapeActivatedEvent=2101]="shapeActivatedEvent";w[w.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";w[w.shapeAddedEvent=2103]=
"shapeAddedEvent";w[w.shapeDeletedEvent=2104]="shapeDeletedEvent";w[w.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";w[w.wacOperationEvent=2201]="wacOperationEvent";w[w.recordingStateChangedEvent=2202]="recordingStateChangedEvent";w[w.workbookActivatedEvent=2203]="workbookActivatedEvent";w[w.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";w[w.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";w[w.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";w[w.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";w[w.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";w[w.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";w[w.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";w[w.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";w[w.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";w[w.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";w[w.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";w[w.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";w[w.pivotTableAddedEvent=2900]="pivotTableAddedEvent";w[w.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";w[w.namedItemAddedEvent=3E3]="namedItemAddedEvent";w[w.namedItemDeletedEvent=3001]="namedItemDeletedEvent";w[w.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";w[w.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";w[w.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";w[w.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";w[w.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";w[w.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";w[w.beforeCloseNotifiactionCancelledEvent=
65540]="beforeCloseNotifiactionCancelledEvent";w[w.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent"})(f||(f={}));Object(u.b)("MessageType",f);var e=a(796),d=a(261),h=a(765),l=a(61),k=a(40),n=a(167),v=a(1);a.d(C,"DdaEventDispatch",function(){return x});class x{constructor(w){this.$B=null;this.npg={};this.ppg={};this.Zid={};this.tHd={};this.jrd=(r,t)=>{r=this.$.nc.qd("Task","DdaEventDispatch.HandleServerEvent");t=t.Abg;for(let E=0;E<t.length;E++)switch(t[E].EventType){case 2:var A=
t[E],y={};y.Name=A.Name;y.BindingType=A.BindingType;y.ColCount=A.ColCount;y.RowCount=A.RowCount;this.yya(A.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,y,null);break;case 4:this.yya(t[E].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(A=t[E],A.InstanceId){y=Array(A.Entries.length);for(var z=0;z<A.Entries.length;z++)y[z]=x.vic(A.Entries[z],A.IsRemoteOverride);0<A.Entries.length&&1===A.Entries[0].Category?this.nmj(A.InstanceId,y):A.InstanceId&&this.yya(A.InstanceId,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)}else{this.Zid={};this.tHd={};for(y=0;y<A.Entries.length;y++)this.iUe(A.Entries[y],A.IsRemoteOverride);A=JSON.stringify(this.Zid);y=JSON.stringify(this.tHd);z=JSON.stringify(this.npg);const G=JSON.stringify(this.ppg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${A}, Number of Not Fired event: ${y}, Total Number of Fired event: ${z}, Total Number of Not Fired event: ${G}`)}}r.stop()};this.wQb=(r,t)=>{this.yya(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,t)};this.$=w;this.RCc=this.jrd}D4b(w){w&&(this.Xka(),this.$B.push(w))}Zzc(w){this.$B&&(Array.remove(this.$B,w),this.$B.length||(this.$.wantServerEvents=!1,this.$.Czj(this.RCc),this.$B=null))}nmj(w,r){const t=Object(b.a)(h.DdaFacade,d.a(this.$));k.TaskExtensions.za(t.cai(w),A=>{if(n.b(A)){var y=A.result;A=t.Ln(y);if(y)if(A.eoc)this.yya(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r);else if(A.Qac)for(y=0;y<r.length;y++)A.Qac.push(r[y]);else A.Qac=r}else A.vg?c.ULS.sendTraceTag(537170591,
0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):A.Zh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}Kmj(w,r){const t=Object(b.a)(h.DdaFacade,d.a(this.$)),A=t.QZh(w);A?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(A,r,this.wQb):t.ylh(w,r)}iUe(w,r){let t=!1;const A=parseInt(w.Type,10);var y=w.Target;const z=Object(b.a)(h.DdaFacade,d.a(this.$));
if((y=z.Vh.iai(A,y))&&0<Object.keys(y).length){t=!0;for(let G in y)if(y=G,z.Vh.U5b(y)){const F=Array(1);F[0]=x.vic(w,r);if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var E=F[0][3];if(void 0!==E&&null!==E&&(E=Object(b.a)(Object,l.a.Xi(E)))&&void 0!==E.triggerControlId&&null!==E.triggerControlId&&void 0!==E.triggerSource&&null!==E.triggerSource){let O=!1;r?(E.triggerSource="Unknown",O=!0):z.lzh(E.triggerControlId,y)&&(E.triggerSource="ThisLocalAddin",O=!0);O&&
(F[0][3]=l.a.Zc(E))}}this.yya(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,F)}}t?(this.ilc(f[A],this.Zid),this.ilc(f[A],this.npg)):(this.ilc(f[A],this.tHd),this.ilc(f[A],this.ppg))}Xka(){this.$B||(this.$B=[],this.$.Rye(this.RCc),this.$.wantServerEvents=!0)}ilc(w,r){w in r||(r[w]=0);r[w]+=1}pG(w,r,t){const A={};A.Target=r;A.Category=65536;A.Type=w;A.Message=t;A.Id=-1;this.iUe(A,!1)}CTh(w,r){const t={Target:"",Category:2,Type:1E3};t.Message=r;t.Id=0;r=Array(1);r[0]=x.vic(t,!1);this.Kmj(w,r)}ofc(w,
r,t,A){const y={};y.Target=t;y.Category=65536;y.Type=r;y.Message=A;y.Id=-1;r=Array(1);r[0]=x.vic(y,!1);this.yya(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)}BTh(w,r){this.yya(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)}yya(w,r,t,A){if(this.$B){var y=Object(b.a)(h.DdaFacade,d.a(this.$));if(!y||r!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&r!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.Vh.U5b(w)){w=new e.a(r,w,t,A);for(let z=0,E=this.$B.length;z<E;z++)(r=this.$B[z])&&
r(w)}}}static vic(w,r){const t=Array(6);t[0]=w.Category;t[1]=w.Type;t[2]=w.Target;t[3]=w.Message;t[4]=w.Id;t[5]=r;return t}}Object(u.a)(x,"DdaEventDispatch",null,[])},1463:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);C=a(157);var c=a(93);class b extends C.a{constructor(){super(void 0,void 0,void 0,!0);this.iGa="AddinCommandsUILessDialog";this.p_c="WACDialogTitleText";this.dZ="0";this.tF=380;this.pD=190;this.Te=this.iGa;this.rc=5;this.TEg=String.format("{0}px",this.tF);this.cZ=String.format("{0}px",
this.pD);this.Bif=this.Iu=!1;this.gy()}gy(){super.gy();this.Bi.style.width=this.TEg;this.Bi.style.height=this.cZ;this.Bi.style.padding=this.dZ}Mz(f){this.bF();document.getElementById(this.wi(this.p_c)).innerText=f}bF(){super.bF();this.Hb.style.width=String.format("{0}px",this.tF);this.Hb.style.height=String.format("{0}px",this.pD);this.Hb.removeAttribute(c.a.fe);this.Hb.removeAttribute(c.a.pN)}hide(){this.L8a()}get Dca(){return this.Bi}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(u.a)(b,"AddinCommandsUILessDialog",C.a,[773])},1496:function(u,C,a){a.r(C);var c={};a.r(c);a.d(c,"CopilotSDX",function(){return gj});var b=a(521),f=a(10),e=a(0),d=a(229),h=a(199),l=a(602);class k{constructor(){this.$kb=null}get N4g(){this.$kb||(this.$kb=new h.a,this.$kb.add(12),this.$kb.add(11));return this.$kb}Jyi(N){return this.N4g.contains(N.operation)}Yak(N){const Qa=[],Db=N.payload;for(const fc of Db.batchedOperations)Qa.push(new l.a(N.operation,fc));return Qa}}Object(e.a)(k,
"MacroRecorderBatchedEventList",null,[]);var n=a(15),v=a(61),x=a(134),w=a(662);class r{equals(N,Qa){return N===Qa}getHashCode(N){return N}dma(N){return N}}Object(e.a)(r,"UserOperationNameComparer",null,[33,34]);class t{static Eii(){t.$c||(t.$c=new w.a(new r),t.$c.add(507),t.$c.add(10),t.$c.add(576),t.$c.add(563),t.$c.add(564),t.$c.add(565),t.$c.add(566),t.$c.add(567),t.$c.add(568),t.$c.add(569),t.$c.add(570),t.$c.add(571),t.$c.add(572),t.$c.add(573),t.$c.add(574),t.$c.add(575),t.$c.add(501),t.$c.add(520),
t.$c.add(1),t.$c.add(1002),t.$c.add(129),t.$c.add(198),t.$c.add(500),t.$c.add(519),t.$c.add(538),t.$c.add(1E3),t.$c.add(1003),t.$c.add(144),t.$c.add(502),t.$c.add(505),t.$c.add(179),t.$c.add(205),t.$c.add(134),t.$c.add(230),t.$c.add(103),t.$c.add(110),t.$c.add(112),t.$c.add(113),t.$c.add(124),t.$c.add(133),t.$c.add(154),t.$c.add(162),t.$c.add(168),t.$c.add(172),t.$c.add(201),t.$c.add(222),t.$c.add(227),t.$c.add(513),t.$c.add(534),t.$c.add(539),t.$c.add(545),t.$c.add(600),t.$c.add(547),t.$c.add(555),
t.$c.add(558),t.$c.add(562),t.$c.add(585),t.$c.add(1001),t.$c.add(1005),t.$c.add(1008),t.$c.add(1010),t.$c.add(1011),t.$c.add(1012),t.$c.add(1018),t.$c.add(1029),t.$c.add(252),t.$c.add(253),t.$c.add(258),t.$c.add(101),t.$c.add(102),t.$c.add(108),t.$c.add(257),t.$c.add(119),t.$c.add(120),t.$c.add(123),t.$c.add(126),t.$c.add(127),t.$c.add(130),t.$c.add(140),t.$c.add(159),t.$c.add(160),t.$c.add(165),t.$c.add(166),t.$c.add(167),t.$c.add(169),t.$c.add(189),t.$c.add(223),t.$c.add(214),t.$c.add(228),t.$c.add(233),
t.$c.add(247),t.$c.add(504),t.$c.add(511),t.$c.add(512),t.$c.add(525),t.$c.add(533),t.$c.add(537),t.$c.add(542),t.$c.add(544),t.$c.add(548),t.$c.add(550),t.$c.add(551),t.$c.add(552),t.$c.add(554),t.$c.add(577),t.$c.add(584),t.$c.add(586),t.$c.add(587),t.$c.add(588),t.$c.add(592),t.$c.add(1009),t.$c.add(1016),t.$c.add(1017),t.$c.add(1024),t.$c.add(260),t.$c.add(597),t.$c.add(264),t.$c.add(596),t.$c.add(254),t.$c.add(262),t.$c.add(1030),t.$c.add(1031));return t.$c}}t.$c=null;Object(e.a)(t,"MacroRecorderUnrecognizedEventList",
null,[]);class A{constructor(N,Qa,Db){this.jzb=null;this.ZSi=(fc,vc)=>{this.Sgg()&&this.Wid(vc)};this.SCf=Qa;this.RCf=Db;this.$=N;this.$.WW&&this.$.ZXg(this.ZSi);N.da.Ja(297,this)}init(N){this.$.WW&&(N?this.jzb=N:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Wid(N){if(this.Sgg())try{if(this.RCf.Jyi(N)){var Qa=this.RCf.Yak(N);for(const Db of Qa)this.o4e(Db)}else this.o4e(N)}catch(Db){Qa=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${x.a(N.operation)}, Exception: ${Db.stack}`;
n.ULS.sendTraceTag(537155423,0,10,Qa);try{this.zTh(N)}catch(fc){}}}o4e(N){var Qa=this.SCf.kbf(N,!0);Qa?(this.jzb(Qa.eventId,v.a.Zc(N.payload)),n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Qa.eventId}`)):(Qa=this.SCf.kbf(N,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Qa.eventId}, but failed to match filters`):t.Eii().contains(N.operation)||(this.jzb(0,v.a.Zc(N.operation)),N=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${x.a(N.operation)}`,
n.ULS.sendTraceTag(537155420,0,50,N))}zTh(N){this.jzb(222,v.a.Zc(N.operation))}Sgg(){return this.$.Ana&&this.jzb&&this.$.Wda?!0:!1}}Object(e.a)(A,"MacroRecorderEventHandler",null,[703]);var y=a(1);class z{constructor(){this.dQc=this.eQc=this.lWc=this.P_c=null}get operations(){this.lWc||(this.lWc=new h.a,this.Ac());return this.lWc}get vKc(){this.P_c||(this.P_c=new h.a,this.Ng());return this.P_c}get U2e(){this.dQc||(this.dQc=new h.a);return this.dQc}get featureGates(){this.eQc||(this.eQc=new h.a,this.Xya());
return this.eQc}Ng(){}Xya(){}Vd(N){this.vKc.add(N)}uc(N){this.operations.contains(N)||this.operations.add(N)}Grb(){this.featureGates.add(585)}$ve(N){this.U2e.add(N)}}Object(e.a)(z,"MacroRecorderEventBase",null,[]);class E extends z{constructor(){super()}get eventId(){return 130}Ac(){this.uc(100)}}Object(e.a)(E,"AccessibilityCheckRunEvent",z,[]);class G extends z{constructor(){super()}get eventId(){return 160}Ac(){this.uc(241)}Ng(){this.Vd(N=>N.addToPrintArea)}}Object(e.a)(G,"AddedToPrintAreaEvent",
z,[]);class F extends z{constructor(){super()}get eventId(){return 65}Ac(){this.uc(516)}}Object(e.a)(F,"AutoFilterToggledEvent",z,[]);class O extends z{constructor(){super()}get eventId(){return 118}Ac(){this.uc(502)}Ng(){this.Vd(N=>!(N.Z7a().FirstColumn===N.Z7a().LastColumn&&N.Z7a().FirstRow===N.Z7a().LastRow))}}Object(e.a)(O,"AutoSumEvent",z,[]);class M extends z{constructor(){super()}get eventId(){return 223}Ac(){this.uc(1032)}}Object(e.a)(M,"CellImageAltTextAppliedEvent",z,[]);class P extends z{constructor(N,
Qa){super();this.Hha=N;this.Qik=Qa}get eventId(){return this.Hha}Ac(){this.uc(529);this.uc(594)}Ng(){this.Vd(N=>this.Qik.includes(N.jod()))}}Object(e.a)(P,"ChartPropertyAppliedEventBase",z,[]);class B extends P{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(e.a)(B,"ChartAxisChangedEvent",P,[]);class D extends P{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(e.a)(D,"ChartAxisTitleChangedEvent",P,[]);class I extends P{constructor(){super(82,
[200,201,202,203,204,205,206,207,208,209,210])}}Object(e.a)(I,"ChartDataLabelsChangedEvent",P,[]);class S extends P{constructor(){super(76,[-100])}}Object(e.a)(S,"ChartDataSelectedEvent",P,[]);class J extends P{constructor(){super(83,[500,501,502])}}Object(e.a)(J,"ChartDataTableChangedEvent",P,[]);var L=a(563),R=a(425),Y=a(126);class Q extends z{constructor(){super()}}Object(e.a)(Q,"RichApiRequestExecutedEventBase",z,[]);class W{constructor(N,Qa,Db){this.response=this.request=this.eventId=this.source=
null;N&&(this.source=N.source,this.eventId=N.eventId,this.request=Qa,this.response=Db)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(e.a)(W,"MacroRecorderRichApiRequestExecutedPayload",null,[139]);class Ga extends Q{constructor(){super()}get eventId(){return 117}Rx(N){Ga.q9||(Ga.q9=new w.a(L.a.Ah()),Ga.q9.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Ga.q9.add("fa000000014"));return!!N&&Ga.q9.contains(N.toLowerCase())}Ac(){this.uc(507);
this.uc(10);this.uc(576)}Ng(){this.Vd(N=>Object(R.a)(W,N)&&(N=Object(Y.a)(W,N),N.isValid&&this.Rx(N.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${N.eventId}`),!0):!1)}}Ga.q9=null;Object(e.a)(Ga,"ChartFormatRichApiRequestExecutedEvent",Q,[]);class pa extends P{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(e.a)(pa,"ChartGridlinesChangedEvent",P,[]);class aa extends z{constructor(){super()}get eventId(){return 66}Ac(){this.uc(528)}}
Object(e.a)(aa,"ChartInsertedEvent",z,[]);class Z extends P{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(e.a)(Z,"ChartLegendChangedEvent",P,[]);class fa extends P{constructor(){super(75,[-101])}}Object(e.a)(fa,"ChartRowColumnSwitchedEvent",P,[]);class ya extends P{constructor(){super(79,[0,1,2,-102])}}Object(e.a)(ya,"ChartTitleChangedEvent",P,[]);class Aa extends P{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,
-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(e.a)(Aa,"ChartTypeChangedEvent",P,[]);class ja extends z{constructor(){super()}get eventId(){return 131}Ac(){this.uc(521)}}Object(e.a)(ja,"ConnectorFloatingObjectResizedEvent",z,[]);class za extends z{constructor(){super()}get eventId(){return 129}Ac(){this.uc(109)}}Object(e.a)(za,"EntitySelectedEvent",z,[]);class ra extends z{constructor(){super()}get eventId(){return 49}Ac(){this.uc(149);this.uc(147)}}Object(e.a)(ra,"FindCellEvent",
z,[]);class fb extends z{constructor(){super()}get eventId(){return 96}Ac(){this.uc(122)}}Object(e.a)(fb,"FloatingObjectAltTextAppliedEvent",z,[]);class Ua extends z{constructor(){super()}get eventId(){return 93}Ac(){this.uc(522)}}Object(e.a)(Ua,"FloatingObjectDeletedEvent",z,[]);class Ca extends z{constructor(){super()}get eventId(){return 94}Ac(){this.uc(524)}}Object(e.a)(Ca,"FloatingObjectMovedAndResizedEvent",z,[]);class Ia extends z{constructor(){super()}get eventId(){return 95}Ac(){this.uc(523)}}
Object(e.a)(Ia,"FloatingObjectRotatedEvent",z,[]);class oa extends z{constructor(){super()}get eventId(){return 100}Ac(){this.uc(543)}}Object(e.a)(oa,"GroupDetailsShownOrHiddenEvent",z,[]);class Da extends z{constructor(){super()}get eventId(){return 154}Ac(){this.uc(125)}}Object(e.a)(Da,"HyperlinksRemovedFromRangeEvent",z,[]);class bb extends Q{constructor(){super()}get eventId(){return 125}Rx(N){bb.q9||(bb.q9=new w.a(L.a.Ah()),bb.q9.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),bb.q9.add("fa000000005"));
return!!N&&bb.q9.contains(N.toLowerCase())}Ac(){this.uc(507);this.uc(10);this.uc(576)}Ng(){this.Vd(N=>Object(R.a)(W,N)?(N=Object(Y.a)(W,N),N.isValid&&this.Rx(N.source)):!1)}}bb.q9=null;Object(e.a)(bb,"IdeasRichApiRequestExecutedEvent",Q,[]);class Za extends z{constructor(){super()}get eventId(){return 136}Ac(){this.uc(115)}}Object(e.a)(Za,"LinkedEntityConvertedEvent",z,[]);class Xa extends z{constructor(){super()}get eventId(){return 148}Ac(){this.uc(114)}}Object(e.a)(Xa,"LinkedEntityDisambiguationPaneToggledEvent",
z,[]);class Ba extends z{constructor(){super()}get eventId(){return 127}Ac(){this.uc(119)}}Object(e.a)(Ba,"MovedToEdgeEvent",z,[]);class Wa extends z{constructor(){super()}get eventId(){return 135}Ac(){this.uc(191)}Xya(){this.Grb()}}Object(e.a)(Wa,"NamedSheetViewCreatedEvent",z,[]);class Na extends z{constructor(){super()}get eventId(){return 166}Ac(){this.uc(200)}Xya(){this.Grb()}}Object(e.a)(Na,"NamedSheetViewDeletedEvent",z,[]);class ta extends z{constructor(){super()}get eventId(){return 133}Ac(){this.uc(192)}Xya(){this.Grb()}}
Object(e.a)(ta,"NamedSheetViewExitedEvent",z,[]);class V extends z{constructor(){super()}get eventId(){return 162}Ac(){this.uc(199)}Xya(){this.Grb()}}Object(e.a)(V,"NamedSheetViewRenamedEvent",z,[]);class ia extends z{constructor(){super()}get eventId(){return 167}Ac(){this.uc(195)}Xya(){this.Grb()}}Object(e.a)(ia,"NamedSheetViewSwitchedEvent",z,[]);class X extends z{constructor(){super()}get eventId(){return 99}Ac(){this.uc(174)}}Object(e.a)(X,"OutlineLevelSetEvent",z,[]);class la extends z{constructor(){super()}get eventId(){return 156}Ac(){this.uc(244)}}
Object(e.a)(la,"PageBreakInsertedEvent",z,[]);class sa extends z{constructor(){super()}get eventId(){return 157}Ac(){this.uc(245)}}Object(e.a)(sa,"PageBreakRemovedEvent",z,[]);class Va extends z{constructor(){super()}get eventId(){return 158}Ac(){this.uc(246)}}Object(e.a)(Va,"PageBreaksAllResetEvent",z,[]);class nb extends z{constructor(){super()}get eventId(){return 112}Ac(){this.uc(503)}Ng(){this.Vd(N=>!!N.pasteParameters.ClientEstimationFloatingObjectId&&2===N.pasteParameters.CopyPasteTargetType&&
!N.isFromCurrentSession)}}Object(e.a)(nb,"PasteArtOtherWorkbookEvent",z,[]);class ha extends z{constructor(){super()}get eventId(){return 52}Ac(){this.uc(503)}Ng(){this.Vd(N=>!!N.pasteParameters.ClientEstimationFloatingObjectId&&2===N.pasteParameters.CopyPasteTargetType&&N.isFromCurrentSession)}}Object(e.a)(ha,"PasteArtSameWorkbookEvent",z,[]);class jb extends z{constructor(){super()}get eventId(){return 110}Ac(){this.uc(204)}}Object(e.a)(jb,"PasteHtmlEvent",z,[]);class Fb extends z{constructor(){super()}get eventId(){return 35}Ac(){this.uc(506)}}
Object(e.a)(Fb,"PasteRangeEvent",z,[]);class Rb extends z{constructor(){super()}get eventId(){return 111}Ac(){this.uc(503)}Ng(){this.Vd(N=>1===N.pasteParameters.CopyPasteTargetType)}}Object(e.a)(Rb,"PasteShadowWorkbookRangeEvent",z,[]);class mb extends z{constructor(){super()}get eventId(){return 42}Ac(){this.uc(180)}}Object(e.a)(mb,"PasteStringEvent",z,[]);class sb extends z{constructor(){super()}get eventId(){return 134}Ac(){this.uc(220)}}Object(e.a)(sb,"PendingMergeEvent",z,[]);class Ya extends z{constructor(){super()}get eventId(){return 122}Ac(){this.uc(510)}}
Object(e.a)(Ya,"PictureInsertedEvent",z,[]);class Ma extends z{constructor(){super()}get eventId(){return 153}Ac(){this.uc(161)}}Object(e.a)(Ma,"PivotDrillToggledEvent",z,[]);class xb extends z{constructor(N,Qa){super();this.Hha=N;this.opType=Qa}get eventId(){return this.Hha}Ac(){this.uc(225)}Ng(){this.Vd(N=>N.opType===this.opType)}}Object(e.a)(xb,"PivotTableSettingsChangedEventBase",z,[]);class qb extends xb{constructor(){super(171,4)}}Object(e.a)(qb,"PivotTableAllItemLabelsRepeatedEvent",xb,[]);
class Ra extends xb{constructor(){super(184,17)}}Object(e.a)(Ra,"PivotTableAltTextDescriptionChangedEvent",xb,[]);class Jb extends xb{constructor(){super(183,16)}}Object(e.a)(Jb,"PivotTableAltTextTitleChangedEvent",xb,[]);class yb extends xb{constructor(){super(173,6)}}Object(e.a)(yb,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",xb,[]);class Gb extends xb{constructor(){super(172,5)}}Object(e.a)(Gb,"PivotTableBlankLineAfterEachItemToggledEvent",xb,[]);class ub extends xb{constructor(){super(170,
3)}}Object(e.a)(ub,"PivotTableColumnGrandTotalShownEvent",xb,[]);class Ja extends z{constructor(){super()}get eventId(){return 98}Ac(){this.uc(132)}}Object(e.a)(Ja,"PivotTableCreatedEvent",z,[]);class zb extends xb{constructor(){super(177,10)}}Object(e.a)(zb,"PivotTableDisplayErrorStringToggledEvent",xb,[]);class na extends xb{constructor(){super(178,11)}}Object(e.a)(na,"PivotTableDisplayNullStringToggledEvent",xb,[]);class Ea extends xb{constructor(){super(179,12)}}Object(e.a)(Ea,"PivotTableErrorStringChangedEvent",
xb,[]);class ma extends xb{constructor(){super(174,7)}}Object(e.a)(ma,"PivotTableExpandCollapseButtonsShownEvent",xb,[]);class Ka extends xb{constructor(){super(187,20)}}Object(e.a)(Ka,"PivotTableIndentChangedEvent",xb,[]);class cb extends xb{constructor(){super(176,9)}}Object(e.a)(cb,"PivotTableItemsWithNoDataOnColumnsShownEvent",xb,[]);class Fa extends xb{constructor(){super(175,8)}}Object(e.a)(Fa,"PivotTableItemsWithNoDataOnRowsShownEvent",xb,[]);class wa extends xb{constructor(){super(186,19)}}
Object(e.a)(wa,"PivotTableLayoutTypeSetEvent",xb,[]);class ka extends xb{constructor(){super(180,13)}}Object(e.a)(ka,"PivotTableNullStringChangedEvent",xb,[]);class Oa extends z{constructor(){super()}get eventId(){return 149}Ac(){this.uc(219)}}Object(e.a)(Oa,"PivotTablePivotLocationChangedEvent",z,[]);class hb extends z{constructor(){super()}get eventId(){return 102}Ac(){this.uc(145)}}Object(e.a)(hb,"PivotTablePivotedEvent",z,[]);class Pa extends xb{constructor(){super(182,15)}}Object(e.a)(Pa,"PivotTableRefreshDataOnLoadToggledEvent",
xb,[]);class ca extends z{constructor(){super()}get eventId(){return 104}Ac(){this.uc(50)}Ng(){this.Vd(N=>!!N.pivotTableId&&!!N.pivotTableName)}}Object(e.a)(ca,"PivotTableRefreshedEvent",z,[]);class ba extends xb{constructor(){super(168,1)}}Object(e.a)(ba,"PivotTableRenamedEvent",xb,[]);class ib extends xb{constructor(){super(169,2)}}Object(e.a)(ib,"PivotTableRowGrandTotalShownEvent",xb,[]);class Lb extends xb{constructor(){super(181,14)}}Object(e.a)(Lb,"PivotTableSaveSourceDataWithFileToggledEvent",
xb,[]);var gc=a(625);class Gc extends z{constructor(){super()}get eventId(){return 155}Ac(){this.uc(131)}Ng(){this.Vd(N=>{N=Object(Y.a)(gc.a,N);return!!N&&!!N.CNa()&&!!N.hierarchyName})}}Object(e.a)(Gc,"PivotTableSortedEvent",z,[]);class Kb extends xb{constructor(){super(185,18)}}Object(e.a)(Kb,"PivotTableSubTotalsVisibilitySettingSetEvent",xb,[]);class pb extends z{constructor(){super()}get eventId(){return 206}Ac(){this.uc(560)}}Object(e.a)(pb,"PivotValueFieldSettingAppliedEvent",z,[]);class nc extends z{constructor(){super()}get eventId(){return 161}Ac(){this.uc(243)}}
Object(e.a)(nc,"PrintAreaClearedEvent",z,[]);class Wb extends z{constructor(){super()}get eventId(){return 159}Ac(){this.uc(241)}Ng(){this.Vd(N=>!N.addToPrintArea)}}Object(e.a)(Wb,"PrintAreaSetEvent",z,[]);class Ha extends z{constructor(){super()}get eventId(){return 57}Ac(){this.uc(517)}}Object(e.a)(Ha,"RangeAutoFilterClearedEvent",z,[]);class $a extends z{constructor(N,Qa){super();this.Hha=N;this.Z7d=Qa}get eventId(){return this.Hha}Ac(){this.uc(11)}Ng(){this.Vd(N=>16===N.l0().ValidMembers);this.Vd(N=>
N.l0().Font.ValidMembers===this.Z7d)}}Object(e.a)($a,"RangeFontFormattedEventBase",z,[]);class Nb extends $a{constructor(){super(3,4)}}Object(e.a)(Nb,"RangeBoldedEvent",$a,[]);class rb extends z{constructor(){super()}get eventId(){return 2}Ac(){this.uc(11)}Ng(){this.Vd(N=>128===N.l0().ValidMembers)}}Object(e.a)(rb,"RangeBorderedEvent",z,[]);class ec{}ec.wdb="Table";ec.kwc="Sheet";Object(e.a)(ec,"MacroRecorderEventConstants",null,[]);class pc extends z{constructor(){super()}get eventId(){return 113}Ac(){this.uc(208)}Ng(){this.Vd(N=>
N.getParameters().FilterType===ec.kwc)}}Object(e.a)(pc,"RangeCheckedItemsFilteredEvent",z,[]);class vb extends z{constructor(){super()}get eventId(){return 109}Ac(){this.uc(105)}}Object(e.a)(vb,"RangeConditionalFormattingCreatedEvent",z,[]);class ob extends z{constructor(){super()}get eventId(){return 124}Ac(){this.uc(221)}}Object(e.a)(ob,"RangeConditionalFormattingRuleDeletedEvent",z,[]);class Tb extends z{constructor(){super()}get eventId(){return 29}Ac(){this.uc(508)}Ng(){this.Vd(N=>3===N.Ds()||
1===N.Ds()||4===N.Ds())}}Object(e.a)(Tb,"RangeContentClearedEvent",z,[]);class Rd extends z{constructor(){super()}get eventId(){return 40}Ac(){this.uc(104)}}Object(e.a)(Rd,"RangeCopiedCutCellsInsertedEvent",z,[]);class Jd extends z{constructor(){super()}get eventId(){return 114}Ac(){this.uc(209)}Ng(){this.Vd(N=>N.getParameters().FilterType===ec.kwc)}}Object(e.a)(Jd,"RangeCustomFilteredEvent",z,[]);class ld extends z{constructor(){super()}get eventId(){return 106}Ac(){this.uc(121)}}Object(e.a)(ld,
"RangeDataValidationChangedEvent",z,[]);class Yd extends $a{constructor(){super(4,64)}}Object(e.a)(Yd,"RangeDoubleUnderlinedEvent",$a,[]);class Ke extends z{constructor(){super()}get eventId(){return 69}Ac(){this.uc(190)}}Object(e.a)(Ke,"RangeDuplicatesRemovedEvent",z,[]);class Bb extends z{constructor(){super()}get eventId(){return 1}Ac(){this.uc(527);this.uc(12)}}Object(e.a)(Bb,"RangeEditedEvent",z,[]);class Ob extends z{constructor(){super()}get eventId(){return 164}Ac(){this.uc(255)}Ng(){this.Vd(N=>
4===N.actionType)}}Object(e.a)(Ob,"RangeExternalLinksBrokeAllLinksEvent",z,[]);class ed extends z{constructor(){super()}get eventId(){return 119}Ac(){this.uc(255)}Ng(){this.Vd(N=>3===N.actionType)}}Object(e.a)(ed,"RangeExternalLinksBrokeLinkEvent",z,[]);class Sd extends z{constructor(){super()}get eventId(){return 205}Ac(){this.uc(256)}Xya(){this.$ve("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(e.a)(Sd,"RangeExternalLinksChangeSourceEvent",z,[]);class Pd extends z{constructor(){super()}get eventId(){return 163}Ac(){this.uc(553)}Ng(){this.Vd(N=>
1===N.actionType)}}Object(e.a)(Pd,"RangeExternalLinksRefreshedAllEvent",z,[]);class ic extends z{constructor(){super()}get eventId(){return 77}Ac(){this.uc(553)}Ng(){this.Vd(N=>0===N.actionType)}}Object(e.a)(ic,"RangeExternalLinksRefreshedEvent",z,[]);class Kc extends z{constructor(){super()}get eventId(){return 165}Ac(){this.uc(224)}}Object(e.a)(Kc,"RangeExternalLinksSetAutoRefreshEvent",z,[]);class dc extends z{constructor(){super()}get eventId(){return 5}Ac(){this.uc(11)}Ng(){this.Vd(N=>64===N.l0().ValidMembers)}}
Object(e.a)(dc,"RangeFillColoredEvent",z,[]);class Hc extends z{constructor(){super()}get eventId(){return 59}Ac(){this.uc(155)}}Object(e.a)(Hc,"RangeFilledEvent",z,[]);class Uc extends z{constructor(){super()}get eventId(){return 115}Ac(){this.uc(176)}Ng(){this.Vd(N=>N.pW().AutoFilterType===ec.kwc&&!!N.pW().CriteriaType)}}Object(e.a)(Uc,"RangeFilterAppliedEvent",z,[]);class Fd extends z{constructor(){super()}get eventId(){return 58}Ac(){this.uc(176)}Ng(){this.Vd(N=>N.pW().AutoFilterType===ec.kwc&&
!N.pW().CriteriaType)}}Object(e.a)(Fd,"RangeFilterClearedEvent",z,[]);class Td extends z{constructor(){super()}get eventId(){return 41}Ac(){this.uc(518)}}Object(e.a)(Td,"RangeFilterReappliedEvent",z,[]);class ad extends z{constructor(){super()}get eventId(){return 86}Ac(){this.uc(150)}}Object(e.a)(ad,"RangeFlashFilledEvent",z,[]);class Qd extends $a{constructor(){super(6,32)}}Object(e.a)(Qd,"RangeFontColoredEvent",$a,[]);class Zb extends $a{constructor(){super(7,8)}}Object(e.a)(Zb,"RangeFontItalicizedEvent",
$a,[]);class Wc extends $a{constructor(){super(8,1)}}Object(e.a)(Wc,"RangeFontNamedEvent",$a,[]);class md extends $a{constructor(){super(9,2)}}Object(e.a)(md,"RangeFontSizedEvent",$a,[]);class Nd extends z{constructor(){super()}get eventId(){return 74}Ac(){this.uc(215)}}Object(e.a)(Nd,"RangeFormattedAsTableEvent",z,[]);class kd extends z{constructor(){super()}get eventId(){return 97}Ac(){this.uc(188)}}Object(e.a)(kd,"RangeGroupedOrUngroupedEvent",z,[]);class yd extends z{constructor(){super()}get eventId(){return 60}Ac(){this.uc(11)}Ng(){this.Vd(N=>
2===N.l0().ValidMembers)}}Object(e.a)(yd,"RangeHorizontallyAlignedEvent",z,[]);class lc extends z{constructor(){super()}get eventId(){return 43}Ac(){this.uc(526)}}Object(e.a)(lc,"RangeHyperlinkAppliedEvent",z,[]);class Lc extends z{constructor(){super()}get eventId(){return 63}Ac(){this.uc(11)}Ng(){this.Vd(N=>256===N.l0().ValidMembers)}}Object(e.a)(Lc,"RangeIndentChangedEvent",z,[]);class nd extends z{constructor(){super()}get eventId(){return 53}Ac(){this.uc(156)}Ng(){this.Vd(N=>2===N.Ds()||5===
N.Ds()||6===N.Ds()||7===N.Ds())}}Object(e.a)(nd,"RangeMergedEvent",z,[]);class Wd extends z{constructor(){super()}get eventId(){return 107}Ac(){this.uc(216)}}Object(e.a)(Wd,"RangeNamedCellStyleAppliedEvent",z,[]);class $d extends z{constructor(){super()}get eventId(){return 12}Ac(){this.uc(11)}Ng(){this.Vd(N=>32===N.l0().ValidMembers)}}Object(e.a)($d,"RangeNumberFormattedEvent",z,[]);var se=a(1002);class je extends z{constructor(){super()}get eventId(){return 108}Ac(){this.uc(141)}Ng(){this.Vd(N=>
Object(R.a)(se.a,N))}}Object(e.a)(je,"RangeSortedEvent",z,[]);class Le extends $a{constructor(){super(10,128)}}Object(e.a)(Le,"RangeStrikedThroughEvent",$a,[]);class oe extends $a{constructor(){super(11,16)}}Object(e.a)(oe,"RangeUnderlinedEvent",$a,[]);class ue extends z{constructor(){super()}get eventId(){return 61}Ac(){this.uc(11)}Ng(){this.Vd(N=>1===N.l0().ValidMembers)}}Object(e.a)(ue,"RangeVerticallyAlignedEvent",z,[]);class df extends z{constructor(){super()}get eventId(){return 62}Ac(){this.uc(11)}Ng(){this.Vd(N=>
8===N.l0().ValidMembers)}}Object(e.a)(df,"RangeWrapTextToggledEvent",z,[]);class Se extends z{constructor(){super()}get eventId(){return 103}Ac(){this.uc(51)}}Object(e.a)(Se,"RefreshedAllEvent",z,[]);class bf extends z{constructor(){super()}get eventId(){return 47}Ac(){this.uc(148)}}Object(e.a)(bf,"ReplaceAllEvent",z,[]);class Ye extends z{constructor(){super()}get eventId(){return 226}Ac(){this.uc(1025)}}Object(e.a)(Ye,"SampleTableCreatedEvent",z,[]);class gf extends z{constructor(){super()}get eventId(){return 91}Ac(){this.uc(532)}Ng(){this.Vd(N=>
95!==N.getShapeType()&&96!==N.getShapeType()&&97!==N.getShapeType()&&98!==N.getShapeType()&&100!==N.getShapeType()&&102!==N.getShapeType()&&103!==N.getShapeType())}}Object(e.a)(gf,"ShapeInsertedEvent",z,[]);class nf extends z{constructor(){super()}get eventId(){return 92}Ac(){this.uc(531)}}Object(e.a)(nf,"ShapeStyleSetEvent",z,[]);var oc=a(853);class Ac extends z{constructor(N,Qa){super();this.Hha=N;this.Z7d=Qa}get eventId(){return this.Hha}Ac(){this.uc(581)}Ng(){this.Vd(N=>Object(R.a)(oc.a,N)&&4===
N.getShapeTextFormat().ValidMembers);this.Vd(N=>Object(R.a)(oc.a,N)&&N.getShapeTextFormat().Font.ValidMembers===this.Z7d)}}Object(e.a)(Ac,"ShapeTextFontFormattedEventBase",z,[]);class xa extends Ac{constructor(){super(193,4)}}Object(e.a)(xa,"ShapeTextBoldedEvent",Ac,[]);var Cb=a(1004);class bc extends z{constructor(){super()}get eventId(){return 191}Ac(){this.uc(581)}Ng(){this.Vd(N=>Object(R.a)(Cb.a,N))}}Object(e.a)(bc,"ShapeTextChangedEvent",z,[]);class Fc extends Ac{constructor(){super(196,32)}}
Object(e.a)(Fc,"ShapeTextFontColorChangedEvent",Ac,[]);class Tc extends Ac{constructor(){super(197,1)}}Object(e.a)(Tc,"ShapeTextFontNameChangedEvent",Ac,[]);class gd extends Ac{constructor(){super(198,2)}}Object(e.a)(gd,"ShapeTextFontSizeChangedEvent",Ac,[]);class td extends z{constructor(){super()}get eventId(){return 199}Ac(){this.uc(581)}Ng(){this.Vd(N=>Object(R.a)(oc.a,N)&&2===N.getShapeTextFormat().ValidMembers)}}Object(e.a)(td,"ShapeTextHorizontallyAlignedEvent",z,[]);class kb extends Ac{constructor(){super(194,
8)}}Object(e.a)(kb,"ShapeTextItalicizedEvent",Ac,[]);class Vb extends Ac{constructor(){super(195,16)}}Object(e.a)(Vb,"ShapeTextUnderlinedEvent",Ac,[]);class qc extends z{constructor(){super()}get eventId(){return 200}Ac(){this.uc(581)}Ng(){this.Vd(N=>Object(R.a)(oc.a,N)&&1===N.getShapeTextFormat().ValidMembers)}}Object(e.a)(qc,"ShapeTextVerticallyAlignedEvent",z,[]);class Bc extends z{constructor(){super()}get eventId(){return 13}Ac(){this.uc(138)}}Object(e.a)(Bc,"SheetAddedEvent",z,[]);var $b=a(9);
class tc extends z{constructor(){super()}get eventId(){return 142}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>{N=N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>N.DeltaColumn&&!N.DeltaRow&&(!!N.InsertDeleteRange.FirstRow||N.InsertDeleteRange.LastRow!==$b.a.yz)||!N.DeltaColumn&&0>N.DeltaRow&&(!!N.InsertDeleteRange.FirstColumn||N.InsertDeleteRange.LastColumn!==$b.a.Wx)})}}Object(e.a)(tc,
"SheetCellsDeletedEvent",z,[]);class Xc extends z{constructor(){super()}get eventId(){return 143}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>{N=N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<N.DeltaColumn&&!N.DeltaRow&&(!!N.InsertDeleteRange.FirstRow||N.InsertDeleteRange.LastRow!==$b.a.yz)||!N.DeltaColumn&&0<N.DeltaRow&&(!!N.InsertDeleteRange.FirstColumn||N.InsertDeleteRange.LastColumn!==
$b.a.Wx)})}}Object(e.a)(Xc,"SheetCellsInsertedEvent",z,[]);class qd extends z{constructor(){super()}get eventId(){return 139}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);
this.Vd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===$b.a.yz)}}Object(e.a)(qd,"SheetColumnDeletedEvent",z,[]);class Cd extends z{constructor(){super()}get eventId(){return 138}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Vd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===$b.a.yz)}}Object(e.a)(Cd,"SheetColumnInsertedEvent",z,[]);class Xd extends z{constructor(){super()}get eventId(){return 14}Ac(){this.uc(137)}}Object(e.a)(Xd,"SheetDeletedEvent",z,[]);class ge extends z{constructor(){super()}get eventId(){return 137}Ac(){this.uc(185)}}Object(e.a)(ge,"SheetDirectionChangedEvent",
z,[]);class ve extends z{constructor(){super()}get eventId(){return 54}Ac(){this.uc(139)}}Object(e.a)(ve,"SheetDuplicatedEvent",z,[]);class Ie extends z{constructor(){super()}get eventId(){return 15}Ac(){this.uc(207)}}Object(e.a)(Ie,"SheetNameEditedEvent",z,[]);class Ee extends z{constructor(){super()}get eventId(){return 90}Ac(){this.uc(151)}}Object(e.a)(Ee,"SheetPaneFrozenEvent",z,[]);class pf extends z{constructor(){super()}get eventId(){return 120}Ac(){this.uc(226)}}Object(e.a)(pf,"SheetPrintSettingsSavedEvent",
z,[]);var Xe=a(900);class Ve extends z{constructor(){super()}get eventId(){return 215}Ac(){this.uc(507)}Xya(){this.$ve("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Ng(){this.Vd(N=>Object.getType(N)===Xe.a)}}Object(e.a)(Ve,"SheetProtectionPausedResumedEvent",z,[]);class wf extends z{constructor(){super()}get eventId(){return 64}Ac(){this.uc(557)}}Object(e.a)(wf,"SheetReorderedEvent",z,[]);class Ff extends z{constructor(){super()}get eventId(){return 141}Ac(){this.uc(237)}Ng(){this.Vd(N=>
!!N.insertDeleteMultiRangeParameters);this.Vd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Vd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Vd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===$b.a.Wx)}}Object(e.a)(Ff,
"SheetRowDeletedEvent",z,[]);class db extends z{constructor(){super()}get eventId(){return 140}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Vd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);
this.Vd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===$b.a.Wx)}}Object(e.a)(db,"SheetRowInsertedEvent",z,[]);class U extends z{constructor(){super()}get eventId(){return 39}Ac(){this.uc(135)}}Object(e.a)(U,"SheetRowsColumnsAutoFitEvent",z,[]);class Ta extends z{constructor(){super()}get eventId(){return 36}Ac(){this.uc(136)}}Object(e.a)(Ta,"SheetRowsColumnsResizedEvent",z,[]);class wb extends z{constructor(){super()}get eventId(){return 68}Ac(){this.uc(183)}}
Object(e.a)(wb,"SheetShowGridlinesToggledEvent",z,[]);class Qb extends z{constructor(){super()}get eventId(){return 67}Ac(){this.uc(184)}}Object(e.a)(Qb,"SheetShowHeadingsToggledEvent",z,[]);class sc extends z{constructor(){super()}get eventId(){return 89}Ac(){this.uc(213)}}Object(e.a)(sc,"SheetSpellCheckedEvent",z,[]);class Vc extends z{constructor(){super()}get eventId(){return 70}Ac(){this.uc(515)}}Object(e.a)(Vc,"SheetTabColoredEvent",z,[]);class Ld extends z{constructor(){super()}get eventId(){return 71}Ac(){this.uc(157)}}
Object(e.a)(Ld,"SheetVisibilityChangedEvent",z,[]);class le extends z{constructor(){super()}get eventId(){return 126}Ac(){this.uc(239)}}Object(e.a)(le,"SheetsVisibilityChangedEvent",z,[]);class Ce extends z{constructor(){super()}get eventId(){return 188}Ac(){this.uc(203)}}Object(e.a)(Ce,"SlicerInsertedEvent",z,[]);class Oe extends z{constructor(){super()}get eventId(){return 189}Ac(){this.uc(173)}Ng(){this.Vd(N=>!N.clearFilter)}}Object(e.a)(Oe,"SlicerSelectionAppliedEvent",z,[]);class ef extends z{constructor(){super()}get eventId(){return 190}Ac(){this.uc(173)}Ng(){this.Vd(N=>
N.clearFilter)}}Object(e.a)(ef,"SlicerSelectionClearedEvent",z,[]);class uf extends z{constructor(){super()}get eventId(){return 27}Ac(){this.uc(208)}Ng(){this.Vd(N=>N.getParameters().FilterType===ec.wdb)}}Object(e.a)(uf,"TableCheckedItemsFilteredEvent",z,[]);class Ab extends z{constructor(){super()}get eventId(){return 144}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Ab,"TableColumnDeletedEvent",z,[]);class cc extends z{constructor(){super()}get eventId(){return 145}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(e.a)(cc,"TableColumnInsertedEvent",z,[]);var uc=a(1003);class $c extends z{constructor(){super()}get eventId(){return 121}Ac(){this.uc(141)}Ng(){this.Vd(N=>Object(R.a)(uc.a,N))}}Object(e.a)($c,"TableColumnSortedEvent",z,[]);class Bd extends z{constructor(){super()}get eventId(){return 105}Ac(){this.uc(193)}}Object(e.a)(Bd,"TableConvertedToRangeEvent",z,[]);class ee extends z{constructor(){super()}get eventId(){return 16}Ac(){this.uc(206)}}Object(e.a)(ee,"TableCreatedEvent",z,[]);class qe extends z{constructor(){super()}get eventId(){return 30}Ac(){this.uc(209)}Ng(){this.Vd(N=>
N.getParameters().FilterType===ec.wdb)}}Object(e.a)(qe,"TableCustomFilteredEvent",z,[]);class Yb extends z{constructor(){super()}get eventId(){return 25}Ac(){this.uc(187)}Ng(){this.Vd(N=>1===N.options.OperationType)}}Object(e.a)(Yb,"TableCustomSortedEvent",z,[]);class Nc extends z{constructor(){super()}get eventId(){return 28}Ac(){this.uc(176)}Ng(){this.Vd(N=>N.pW().AutoFilterType===ec.wdb);this.Vd(N=>0===N.pW().CriteriaType)}}Object(e.a)(Nc,"TableFilterClearedEvent",z,[]);class ud extends z{constructor(){super()}get eventId(){return 32}Ac(){this.uc(176)}Ng(){this.Vd(N=>
N.pW().AutoFilterType===ec.wdb);this.Vd(N=>{const Qa=new h.a;Qa.add(1);Qa.add(2);Qa.add(8);Qa.add(9);Qa.add(10);Qa.add(11);Qa.add(12);Qa.add(13);Qa.add(14);Qa.add(15);Qa.add(16);Qa.add(17);Qa.add(18);Qa.add(19);Qa.add(20);Qa.add(21);Qa.add(22);Qa.add(23);Qa.add(24);Qa.add(25);Qa.add(26);Qa.add(27);Qa.add(28);Qa.add(29);Qa.add(30);Qa.add(31);Qa.add(32);Qa.add(33);Qa.add(34);Qa.add(35);Qa.add(36);Qa.add(37);Qa.add(38);Qa.add(39);return Qa.contains(N.pW().CriteriaType)})}}Object(e.a)(ud,"TableItemFilteredEvent",
z,[]);class Mb extends z{constructor(){super()}get eventId(){return 101}Ac(){this.uc(217)}}Object(e.a)(Mb,"TableRenamedEvent",z,[]);class rc extends z{constructor(){super()}get eventId(){return 73}Ac(){this.uc(211)}}Object(e.a)(rc,"TableResizedEvent",z,[]);class id extends z{constructor(){super()}get eventId(){return 44}Ac(){this.uc(514)}}Object(e.a)(id,"TableRowColumnRearrangedEvent",z,[]);class Gd extends z{constructor(){super()}get eventId(){return 146}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);
this.Vd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Vd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Gd,"TableRowDeletedEvent",z,[]);class de extends z{constructor(){super()}get eventId(){return 147}Ac(){this.uc(237)}Ng(){this.Vd(N=>!!N.insertDeleteMultiRangeParameters);this.Vd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.Vd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Vd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(de,"TableRowInsertedEvent",z,[]);class ae extends z{constructor(){super()}get eventId(){return 26}Ac(){this.uc(177)}Ng(){this.Vd(N=>N.pW().AutoFilterType===ec.wdb)}}Object(e.a)(ae,"TableSortedEvent",z,[]);class Ae extends z{constructor(){super()}get eventId(){return 87}Ac(){this.uc(212)}}Object(e.a)(Ae,"TableStyleAppliedEvent",z,[]);class Re extends z{constructor(){super()}get eventId(){return 88}Ac(){this.uc(196)}}
Object(e.a)(Re,"TableStyleOptionToggledEvent",z,[]);class La extends z{constructor(){super()}get eventId(){return 31}Ac(){this.uc(210)}Ng(){this.Vd(N=>N.getParameters().FilterType===ec.wdb)}}Object(e.a)(La,"TableTop10FilteredEvent",z,[]);class Hb extends z{constructor(){super()}get eventId(){return 207}Ac(){this.uc(238)}}Object(e.a)(Hb,"TextToColumnsEvent",z,[]);class xc extends z{constructor(){super()}get eventId(){return 128}Ac(){this.uc(559)}}Object(e.a)(xc,"ValuesSortedEvent",z,[]);class Yc extends z{constructor(){super()}get eventId(){return 55}Ac(){this.uc(197)}}
Object(e.a)(Yc,"WorkbookCalculationModeSetEvent",z,[]);class xd extends z{constructor(){super()}get eventId(){return 34}Ac(){this.uc(181)}Ng(){this.Vd(N=>!!N.parentCommentId)}}Object(e.a)(xd,"WorkbookCommentRepliedEvent",z,[]);class Vd extends z{constructor(){super()}get eventId(){return 33}Ac(){this.uc(181)}Ng(){this.Vd(N=>!N.parentCommentId)}}Object(e.a)(Vd,"WorkbookCommentedEvent",z,[]);class pe extends z{constructor(){super()}get eventId(){return 56}Ac(){this.uc(128)}}Object(e.a)(pe,"WorkbookRecalculatedEvent",
z,[]);class re extends z{constructor(){super()}get eventId(){return 46}Ac(){this.uc(171)}}Object(e.a)(re,"WorkbookRedoEvent",z,[]);class $e extends z{constructor(){super()}get eventId(){return 45}Ac(){this.uc(170)}}Object(e.a)($e,"WorkbookUndoEvent",z,[]);class qf extends z{constructor(){super()}get eventId(){return 116}Ac(){this.uc(507);this.uc(576);this.uc(10)}Ng(){this.Vd(N=>{if(Object(R.a)(W,N)&&(N=Object(Y.a)(W,N),void 0!==N.source&&null!==N.source&&void 0!==N.eventId&&null!==N.eventId))return n.ULS.sendTraceTag(537155426,
0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${N.source}; eventId: ${N.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(e.a)(qf,"DefaultRichApiRequestExecutedEvent",z,[]);class He extends z{constructor(){super()}get eventId(){return 216}Ac(){this.uc(1022)}}Object(e.a)(He,"TablelAltTextEditedEvent",z,[]);class te extends z{constructor(){super()}get eventId(){return 217}Ac(){this.uc(263)}}Object(e.a)(te,
"FloatingObjectZOrderChangedEvent",z,[]);var af=a(1005);class xf extends z{constructor(){super()}get eventId(){return 192}Ac(){this.uc(507)}Ng(){this.Vd(N=>Object(R.a)(af.a,N)?!0:!1)}}Object(e.a)(xf,"VisualPropertySetEvent",z,[]);class cg extends P{constructor(){super(219,[510])}}Object(e.a)(cg,"ChartSeriesDeletedEvent",P,[]);class gb extends z{get eventId(){return 220}Ac(){this.uc(1027)}}Object(e.a)(gb,"ChartDataChangedEvent",z,[]);class Eb extends P{constructor(){super(221,[512])}}Object(e.a)(Eb,
"ChartSeriesDataChangedEvent",P,[]);class ac extends z{constructor(){super()}get eventId(){return 225}Ac(){this.uc(269)}}Object(e.a)(ac,"FloatingObjectPutFloatingImageInCellEvent",z,[]);class zc extends z{constructor(){super()}get eventId(){return 224}Ac(){this.uc(268)}}Object(e.a)(zc,"ImageInCellConvertToFloatingObjectEvent",z,[]);class Jc{constructor(N){this.Ub=null;this.$=N}get macroRecorderEvents(){this.Ub||(this.Ub=new h.a,this.Ub.add(new Bb),this.Ub.add(new rb),this.Ub.add(new Nb),this.Ub.add(new Yd),
this.Ub.add(new dc),this.Ub.add(new Qd),this.Ub.add(new Zb),this.Ub.add(new Wc),this.Ub.add(new md),this.Ub.add(new Le),this.Ub.add(new oe),this.Ub.add(new $d),this.Ub.add(new Bc),this.Ub.add(new Xd),this.Ub.add(new Ie),this.Ub.add(new ee),this.Ub.add(new Ab),this.Ub.add(new cc),this.Ub.add(new Gd),this.Ub.add(new de),this.Ub.add(new Cd),this.Ub.add(new qd),this.Ub.add(new db),this.Ub.add(new Ff),this.Ub.add(new Yb),this.Ub.add(new ae),this.Ub.add(new uf),this.Ub.add(new Nc),this.Ub.add(new Tb),this.Ub.add(new qe),
this.Ub.add(new La),this.Ub.add(new ud),this.Ub.add(new Vd),this.Ub.add(new xd),this.Ub.add(new Fb),this.Ub.add(new Ta),this.Ub.add(new tc),this.Ub.add(new Xc),this.Ub.add(new U),this.Ub.add(new Rd),this.Ub.add(new Td),this.Ub.add(new lc),this.Ub.add(new mb),this.Ub.add(new id),this.Ub.add(new re),this.Ub.add(new $e),this.Ub.add(new bf),this.Ub.add(new ra),this.Ub.add(new ha),this.Ub.add(new nd),this.Ub.add(new ve),this.Ub.add(new Yc),this.Ub.add(new pe),this.Ub.add(new Ha),this.Ub.add(new Fd),this.Ub.add(new Hc),
this.Ub.add(new yd),this.Ub.add(new ue),this.Ub.add(new df),this.Ub.add(new Lc),this.Ub.add(new wf),this.Ub.add(new F),this.Ub.add(new aa),this.Ub.add(new Qb),this.Ub.add(new wb),this.Ub.add(new Ke),this.Ub.add(new Ld),this.Ub.add(new Vc),this.Ub.add(new rc),this.Ub.add(new Nd),this.Ub.add(new fa),this.Ub.add(new S),this.Ub.add(new ic),this.Ub.add(new M),this.Ub.add(new Aa),this.Ub.add(new ya),this.Ub.add(new D),this.Ub.add(new Z),this.Ub.add(new I),this.Ub.add(new J),this.Ub.add(new B),this.Ub.add(new pa),
this.Ub.add(new ad),this.Ub.add(new Ae),this.Ub.add(new Re),this.Ub.add(new sc),this.Ub.add(new Ee),this.Ub.add(new gf),this.Ub.add(new nf),this.Ub.add(new Ua),this.Ub.add(new Ca),this.Ub.add(new Ia),this.Ub.add(new fb),this.Ub.add(new kd),this.Ub.add(new Ja),this.Ub.add(new X),this.Ub.add(new oa),this.Ub.add(new Mb),this.Ub.add(new hb),this.Ub.add(new Se),this.Ub.add(new ca),this.Ub.add(new Bd),this.Ub.add(new ld),this.Ub.add(new Wd),this.Ub.add(new je),this.Ub.add(new vb),this.Ub.add(new jb),this.Ub.add(new Rb),
this.Ub.add(new nb),this.Ub.add(new pc),this.Ub.add(new Jd),this.Ub.add(new Uc),this.Ub.add(new O),this.Ub.add(new Ya),this.Ub.add(new ed),this.Ub.add(new pf),this.Ub.add(new $c),this.Ub.add(new ob),this.Ub.add(new le),this.Ub.add(new Ba),this.Ub.add(new xc),this.Ub.add(new za),this.Ub.add(new E),this.Ub.add(new ja),this.Ub.add(new ta),this.Ub.add(new sb),this.Ub.add(new Wa),this.Ub.add(new Za),this.Ub.add(new ge),this.Ub.add(new Xa),this.Ub.add(new Oa),this.Ub.add(new Ma),this.Ub.add(new Da),this.Ub.add(new Gc),
this.Ub.add(new la),this.Ub.add(new sa),this.Ub.add(new Va),this.Ub.add(new Wb),this.Ub.add(new G),this.Ub.add(new nc),this.Ub.add(new V),this.Ub.add(new Pd),this.Ub.add(new Ob),this.Ub.add(new Kc),this.Ub.add(new Na),this.Ub.add(new ia),this.Ub.add(new ba),this.Ub.add(new ib),this.Ub.add(new ub),this.Ub.add(new qb),this.Ub.add(new Gb),this.Ub.add(new yb),this.Ub.add(new ma),this.Ub.add(new Fa),this.Ub.add(new cb),this.Ub.add(new zb),this.Ub.add(new na),this.Ub.add(new Ea),this.Ub.add(new ka),this.Ub.add(new Lb),
this.Ub.add(new Pa),this.Ub.add(new Jb),this.Ub.add(new Ra),this.Ub.add(new Kb),this.Ub.add(new wa),this.Ub.add(new Ka),this.Ub.add(new Ce),this.Ub.add(new Oe),this.Ub.add(new ef),this.Ub.add(new bc),this.Ub.add(new xa),this.Ub.add(new kb),this.Ub.add(new Vb),this.Ub.add(new Fc),this.Ub.add(new Tc),this.Ub.add(new gd),this.Ub.add(new td),this.Ub.add(new qc),this.Ub.add(new Sd),this.Ub.add(new pb),this.Ub.add(new Hb),this.Ub.add(new Ve),this.Ub.add(new He),this.Ub.add(new te),this.Ub.add(new xf),this.Ub.add(new cg),
this.Ub.add(new Eb),this.Ub.add(new gb),this.Ub.add(new zc),this.Ub.add(new ac),this.Ub.add(new Ye),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Uvj());return this.Ub}kbf(N,Qa){let Db=this.lbf(N,this.macroRecorderEvents,Qa);Db||(Db=this.lbf(N,Jc.yii(),Qa),!Db&&this.hsf(N,Jc.iSe,Qa)&&(Db=Jc.iSe));return Db}lbf(N,Qa,Db){const fc=new h.a;for(let vc of Qa)this.hsf(N,vc,Db)&&fc.add(vc);return 1===fc.count?fc.ma(0):1<fc.count?Jc.h0h(fc):null}hsf(N,Qa,Db){const fc=Jc.afj(N,
Qa);return Db?fc&&Jc.yjk(N,Qa):fc}Uvj(){const N=new h.a;for(let Qa of this.Ub){let Db=!1;for(let fc of Qa.featureGates)if(!y.EwaSettings.ya(fc)){N.add(Qa);Db=!0;break}if(!Db)for(let fc of Qa.U2e)if(!y.EwaSettings.getBooleanFeatureGate(fc,!1)){N.add(Qa);break}}for(let Qa of N)this.Ub.remove(Qa)}static yii(){Jc.HIb||(Jc.HIb=new h.a,Jc.HIb.add(new Ga),Jc.HIb.add(new bb));return Jc.HIb}static afj(N,Qa){return Qa.operations.contains(N.operation)}static yjk(N,Qa){Qa=Qa.vKc;if(!Qa.count)return!0;let Db=
!0;for(let fc of Qa)if(!fc(N.payload)){Db=!1;break}return Db}static h0h(N){let Qa=N.ma(0);for(let Db of N)Db.vKc.count>Qa.vKc.count&&(Qa=Db);return Qa}}Jc.HIb=null;Jc.iSe=new qf;Object(e.a)(Jc,"MacroRecorderEventList",null,[]);class od extends d.a{constructor(N){super();this.$=N;this.kc()}create(){this.Pb(this.$.da.Ba(297)||new A(this.$,new Jc(this.$),new k))}static la(N){N.da.Ja(298,new od(N))}}Object(e.a)(od,"MacroRecorderEventHandlerFactory",d.a,[]);var Ed=a(2),he=a(570);class ne{constructor(){this.ZDg=
new h.a}get y7b(){return this.ZDg}S$h(N){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",N);const Qa=new h.a;for(let Db of this.y7b)for(let fc of Db.aKb)fc.id===N&&Qa.add(fc);return Qa}Nve(N){this.y7b.add(N)}Nvj(N){for(let Qa of this.y7b)if(Qa.Lze===N.Lze){this.y7b.remove(Qa);break}}static Mxh(N,Qa,Db=null){N=ne.P2h(N);0<N.length&&(ne.tDc(N,!1),Db&&Db(Qa,N))}static P2h(N){const Qa=[];if(N&&N.aKb&&0<N.aKb.count)for(let Db of N.aKb)if(Db.controls&&0<Db.controls.count)for(let fc of Db.controls)if(fc.menuItems&&
0<fc.menuItems.count)for(let vc of fc.menuItems)Array.add(Qa,vc.id);return Qa}static tDc(N,Qa){if(N.length){var Db=[];for(const fc of N)Db.push(appChrome.actions.updateControlEnabledDisabledState(fc,Qa));appChrome.api.dispatch(Db)}}}Object(e.a)(ne,"ContextMenuExtensibilityCache",null,[769,770]);var m=a(1536),Sb=a(88),hc=a(6),Ic=a(908),jd=a(850);class Md{e1a(N,Qa=null){if(N=jd.a.X6a(N)){appChrome.addInApi.dispatchActionsToInstallAddIn(N,Qa);for(const Db of N.tabs)if(Db.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(N,
()=>{});break}}}TRd(N){(N=jd.a.X6a(N))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(N)}Mdg(){}static Uxh(N,Qa,Db=null){N=Md.$ci(N);0<N.length&&(Md.tDc(N,!1),Db&&Db(Qa,N))}static $ci(N){const Qa=[];if(N&&(N=N.BX,N.ou&&0<N.ou.count))for(let Db of N.ou)if(Db.groups&&0<Db.groups.length)for(const fc of Db.groups)if(fc.controls&&0<fc.controls.length)for(const vc of fc.controls)Array.add(Qa,vc.id);return Qa}static tDc(N){if(N.length){var Qa=[];for(const Db of N)Qa.push(appChrome.actions.updateControlEnabledDisabledState(Db,
!0));appChrome.api.dispatch(Qa)}}}Object(e.a)(Md,"OneLineRibbonExtensibilityManager",null,[787]);var Ud=a(981);class fe{constructor(){this.Zae=this.WLc=null}get z0c(){return this.WLc||(this.WLc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set z0c(N){this.WLc=N}get l4g(){return this.Zae||(this.Zae=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(N,Qa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(N,
Qa)}Iqd(N,Qa,Db,fc,vc,Rc=null,cd=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",N);if((N=Qa.pla(vc.ownerAddinInfo.storeType,vc.ownerAddinInfo.solutionId))&&N.IC&&!N.IC.getIsUpgrading())if(Qa=null,0<N.IC.getNotificationParams().length&&(Qa=this.yFe(N.IC.getNotificationParams()[0]))&&2147758681===Qa.errorCode&&(N.isUpgraded=!0),2!==N.IC.getStatus()&&(1!==N.IC.getStatus()||Qa&&2147758681===Qa.errorCode))Qa&&this.Hhg(N,Qa,cd);else try{Db.setOwnerAddinEToken(N.IC.getEToken()),vc.action(Db,
fc.kfa),Rc&&Rc()}catch(dd){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",hc.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?dd.stack:dd.message)),Ud.a.M_d(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}Hhg(N,Qa,Db=null){const fc=N.IC;if(1===fc.getNotificationParams().length||Qa.Ekc){const vc=Qa.Kja,Rc=Qa.Lka;Qa.Kja=()=>{fc.removeFirstNotification();if(0<fc.getNotificationParams().length){const cd=
this.yFe(fc.getNotificationParams()[0]);this.Hhg(N,cd)}2147758681===Qa.errorCode&&(Md.Uxh(N.Vo,fc,Object(Sb.a)(this,this.omf,"initUpgradeStateDetectTask")),ne.Mxh(N.Xvb,fc,Object(Sb.a)(this,this.omf,"initUpgradeStateDetectTask")));vc&&vc()};Qa.Lka=()=>{Rc&&Rc();Db&&Db()};Ud.a.N_d(Qa)}}omf(N,Qa){let Db=null;Db=()=>{N.getIsUpgrading()?window.setTimeout(Db,1E3):N.getUpgradingFailed()?Md.tDc(Qa,!0):hc.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Db,1E3)}yFe(N){const Qa=new Ic.a;Qa.$Oa=
N.infoType;Qa.id=N.id;Qa.title=N.title;Qa.description=N.description;Qa.buttonText=N.buttonTxt;Qa.Kja=N.buttonCallback;Qa.Ekc=N.highPriority;Qa.Lka=N.dismissCallback;Qa.errorCode=N.errorCode;Qa.ulf=N.iframeNotificationUrl;return Qa}}Object(e.a)(fe,"AddinCommandsActionHandler",null,[776]);var me=a(84),Te=a(170),Pe=a(722),zf=a(7),Nf=a(767),Gf=a(723);class Tf{constructor(N,Qa){this.Ya=N;this.ujh=Qa}jYh(N){if(void 0!==N&&null!==N&&N===zf.a.cNe)N="ContextMenuCell";else return null;const Qa=this.Ya.jd();
this.CXh(Qa,N);return Qa}CXh(N,Qa){Qa=this.ujh.S$h(Qa);for(let Db of Qa){Qa=Db.controls;for(let fc of Qa)this.oXh(N,fc)}}oXh(N,Qa){var Db=Qa.uV[Nf.a.id];const fc=Qa.uV[Nf.a.UXa],vc=Qa.uV[Nf.a.YXa];let Rc="Image16by16",cd=Qa.uV[Nf.a.VXa];Gf.c(vc)&&(Rc="None");0<Qa.menuItems.count?(Db=this.Ya.Aw(Db,Db,fc,798637440),Db.bRb(Rc,vc,null),this.hYh(Db.menu,Qa),N.buttons.push(Db)):N.buttons.push(this.Ya.bLa(Db,fc,cd,vc,Rc,null,!1))}hYh(N,Qa){const Db=this.Ya.jd();for(let fc of Qa.menuItems){Qa=fc.noa[Nf.a.id];
const vc=fc.noa[Nf.a.UXa],Rc=fc.noa[Nf.a.YXa];let cd="Image16by16";const dd=fc.noa[Nf.a.VXa];Gf.c(Rc)&&(cd="None");Qa=this.Ya.bLa(Qa,vc,dd,Rc,cd,null,!1);Db.buttons.push(Qa)}N.Vc.push(Db)}}Object(e.a)(Tf,"AddInCommandsContextMenuExtensibilityHandler",null,[757]);var Qf=a(901);class jg{constructor(){this.Fi=null;this.visible=!1}}Object(e.a)(jg,"AddinStatusCommandValues",null,[]);class yg{static Cnj(N){const Qa=new jg;Qa.Fi=N.x1a;Qa.visible=Qa.Fi?!0:!1;return Qa}static fFc(N,Qa,Db,fc,vc){const Rc=document.getElementById(Db);
Rc?yg.gYj(N,Qa,Rc,fc,vc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Db))}static gYj(N,Qa,Db,fc,vc){Db?N.x1a===CommonUIStrings.l_ErrorLoadingAddInsTitle?Ud.a.UWj(Qa,Db,fc,vc):N.x1a===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Ud.a.mYj(Qa,Db):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(e.a)(yg,"AddinCommandsStatusHandler",null,[]);var Yf=a(42),ug=a(233),cf=a(16),Sa=a(30);class Pb extends Yf.a{constructor(N,
Qa){super();this.agaveCommandManager=this.statusBarManager=null;this.VJe=()=>{this.fH&&this.fH.xJe()};this.Ugf=()=>{this.raiseEvent("LAC")};this.zd=(Db,fc)=>{!Db.Ec&&ug.b(fc)&&this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null)};this.fH=Qa;this.$=N;Sa.a.vp()||(this.hGc=N.fc+"OfficeAddinLabel-Medium14");this.$.da.Gb(29,Db=>{this.statusBarManager=Db;Db.BK(this)});this.$.ea.pk(this.zd);this.fH.GVg(this.Ugf);this.$.da.Gb(206,Db=>{this.agaveCommandManager=Db;Db.gXg(this.VJe)})}qr(N){this.addHandler("LAC",
N)}Rr(N){this.removeHandler("LAC",N)}ut(N,Qa){if("QueryAddinLabel"!==N)return!1;Qa[Qf.a.LabelText]!==this.fH.x1a&&(N=yg.Cnj(this.fH),Qa[Qf.a.LabelText]=N.Fi,Qa[Qf.a.Visible]=N.visible,window.setTimeout(()=>{this.fFc()},0));return!0}ro(){return!0}fFc(){if(this.$){if(Sa.a.vp()&&isNullOrUndefined(this.hGc)){const N=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');N&&(this.hGc=N.getElementsByClassName("ms-Button-label")[0].id)}this.hGc&&yg.fFc(this.fH,this.$.domElement,this.hGc,
cf.a.instance.ha(333),cf.a.instance.ha(334))}}dispose(){this.$.ea.Kk(this.zd);this.fH.$wj(this.Ugf);this.agaveCommandManager&&(this.agaveCommandManager.lyj(this.VJe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null);this.fH=this.$=null;super.dispose()}}Object(e.a)(Pb,"AddinCommandsStatusBarManager",Yf.a,[196,197]);var jc=a(173),wc=a(114),da=a(741),qa=a(904),Xb=a(1357),Pc=a(820),zd=a(133),ce=a(112),we=a(583),De=a(142);class kf{constructor(){this.w1a=
null}setErrorMessageForAddin(N,Qa){this.w1a||(this.w1a={});this.w1a[N]=Qa}e5h(N){return this.w1a&&N in this.w1a?this.w1a[N]:null}}Object(e.a)(kf,"AddinCommandsErrorManager",null,[]);var Ue=a(342),Uf=a(105);class Cf{constructor(){this.lq=this.lP=0;this.$2c=null;this.$xc=this.aIc=0;this.tsa=this.JQc=this.nMc=this.$9b=this.Nla=this.gba=null}get Z2c(){this.nMc||(this.nMc=new h.a);return this.nMc}get okd(){this.JQc||(this.JQc=new h.a);return this.JQc}get TKa(){this.tsa||(this.tsa=new h.a);return this.tsa}}
Object(e.a)(Cf,"AddinCommandsListLoaderContext",null,[]);var pg=a(856);class zg{}Object(e.a)(zg,"AppsForOfficeEntitlementQueryInfo",null,[]);var Bg=a(43);const dh=N=>{const Qa={};Qa.solutionId=N.solutionId;Qa.version=N.version;Qa.storeType=N.storeType;Qa.storeId=N.storeId;Qa.assetId=N.assetId;Qa.assetStoreId=N.assetStoreId;Qa.targetType=N.targetType;Qa.requireConsent=N.requireConsent||!1;Qa.isAddinCommands=!0;Qa.addinCommandsActionType=0;return Qa};class Fg{constructor(N,Qa){this.entitlement=N;this.metadata=
Qa}XTb(){const N=dh(this.entitlement);N.targetType=this.targetType;return N}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(e.a)(Fg,"AddinEntitlementEx",null,[]);var uh=a(269),fg=a(34);class Gg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(e.a)(Gg,"AddinAbstract",null,[]);class Cg extends Sys.EventArgs{constructor(){super();this.Vo=this.Rk=null}}Object(e.a)(Cg,"InsertionParamEventArgs",Sys.EventArgs,[]);class rg{constructor(N,Qa,Db,fc=null){this.HPb=hc.AFrameworkApplication.fa.Va("RoamingServiceHandlerWebServiceBase");this.appName=N;this.NGa=Qa;this.dnb=Db;this.qpb=fc}nec(N){this.Z1e(N,
"getAddinTeachingCalloutSettings",Object(Sb.a)(this,this.I6,"getRequestSuccessCallback"),Object(Sb.a)(this,this.ZN,"getRequestFailureCallback"))}uPh(){const N=new h.a;N.add(this.appName);this.Z1e(N,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(Sb.a)(this,this.Nci,"getRequestSuccessCallbackForBEP"),Object(Sb.a)(this,this.ZN,"getRequestFailureCallback"))}Z1e(N,Qa,Db,fc){const vc=new Sys.StringBuilder(this.HPb);vc.append("RoamingServiceHandler.ashx?action=");vc.append(Qa);vc.append("&");
vc.append(this.Eod(N));vc.append("&");vc.append(hc.AFrameworkApplication.ej);hc.AFrameworkApplication.de.Fn(vc.toString(),1,null,null,!0,2,Db,fc,null)}p6a(N){this.d2e(N,"saveAddinTeachingCalloutSettings")}zPh(N){this.d2e(N,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}d2e(N,Qa){const Db=new Sys.StringBuilder(this.HPb);Db.append("RoamingServiceHandler.ashx?action=");Db.append(Qa);Db.append("&");Db.append(hc.AFrameworkApplication.ej);Qa=Db.toString();N=Bg.c(N);hc.AFrameworkApplication.de.Fn(Qa,
2,N,null,!0,4,null,Object(Sb.a)(this,this.gP,"postRequestFailureCallback"),null)}I6(N){let Qa=!1,Db=null;try{if(0<N.data.Fe.length){const fc=Object(Y.a)(Object,Bg.a(N.data.Fe)),vc=fc?fc[this.appName]:null;vc&&(Db=Object(Y.a)(Object,Bg.a(vc.toString())))}Qa=!0}catch(fc){this.ZN(null)}Qa&&this.NGa&&this.NGa(Db)}Nci(N){let Qa=!1,Db=null;try{if(0<N.data.Fe.length){const fc=Object(Y.a)(Object,Bg.a(N.data.Fe));Db=Object(Y.a)(String,fc[this.appName])||null}Qa=!0}catch(fc){this.ZN(null)}Qa&&this.NGa&&(N=
{},N.Platforms=Db,this.NGa(N))}ZN(N){this.dnb&&this.dnb(N?N.data:null)}gP(N){this.qpb&&this.qpb(N?N.data:null)}Eod(N){const Qa=new Sys.StringBuilder("requestedsettings=");for(let Db=0;Db<N.count;Db++)Qa.append(N.ma(Db)),Db<N.count-1&&Qa.append(";");return Qa.toString()}}Object(e.a)(rg,"AddinTeachingUIRoamingRequestHandler",null,[]);class lh extends Sys.EventArgs{constructor(N){super();this.solutionId=N.solutionId;this.assetId=N.assetId;this.storeType=N.storeType;this.storeId=N.storeId;this.assetStoreId=
N.assetStoreId;this.targetType=N.targetType;this.width=N.width;this.height=N.height;this.displayName=N.displayName;this.version=N.version}}Object(e.a)(lh,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Of=a(355);class Pg{constructor(N){this.A1a=this.Rk=null;this.dga=!1;this.tsa=this.vWb=this.ppa=this.Lf=this.YY=this.xP=null;this.Ra=N}get appName(){return hc.AFrameworkApplication.fa.Va("WebAppShortName")}get usb(){this.YY||(this.YY=new rg(this.appName,Object(Sb.a)(this,this.I6,
"getRequestSuccessCallback"),Object(Sb.a)(this,this.ZN,"getRequestFailureCallback"),Object(Sb.a)(this,this.gP,"postRequestFailureCallback")));return this.YY}get Nua(){this.vWb||(this.vWb=new h.a);return this.vWb}set Nua(N){this.vWb=N}get TKa(){this.tsa||(this.tsa=new h.a);return this.tsa}set TKa(N){this.tsa=N}v1c(N,Qa){window.addEventListener?(this.Rk=N,this.A1a=Qa,window.addEventListener("LaunchAddinTaskpane",Object(Sb.a)(this,this.QJd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Sb.a)(this,this.AKb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Sb.a)(this,this.vKb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Sb.a)(this,this.oKb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}p5d(N,Qa,Db,fc){this.Lf=N;this.Nua=Qa;this.TKa=Db;this.ppa=fc;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",
Qa?Qa.count.toString():"null",Db?Db.count.toString():"null");0<this.Nua.count||0<this.TKa.count?(N=new h.a,N.add(this.appName),this.usb.nec(N)):this.ppa(new h.a,null)}QJd(){const N=new uh.ScriptSharpLegacyMap;this.A1a&&this.A1a.tabs&&!this.A1a.tabs[0].isOfficeTab&&N.ia("SDX.FeatureFlags","NonOfficeTab");this.$na(Pg.vW(this.Rk),"ClickOnLaunch",N);this.koa();this.A1a?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.A1a,()=>{const Qa=new Cg;Qa.Rk=this.Rk;this.Ra.raiseEvent(da.a.KBd,Qa)}):
n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}vKb(){this.$na(Pg.vW(this.Rk),"ClickOnClose");this.koa()}AKb(){this.$na(Pg.vW(this.Rk),"ClickOnDismiss");this.koa()}oKb(N){if(N&&(N=N.detail)&&N.id&&this.Cvd(N.id)){const Qa=(N.action||"").toLowerCase();if(N.success&&"opened"===Qa)this.$na(Pg.vW(this.Rk),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.koa(),window.removeEventListener&&
window.removeEventListener("FGWebSurfaceEvent",Object(Sb.a)(this,this.oKb,"onCampaignLaunchedHandler"),!0);else{let Db;try{Db=JSON.stringify(N),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Db)}catch(fc){Db="id : "+N.id+" telemetryEventName: "+N.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Db+" Error: "+(fc?fc.toString():""))}}}}Cvd(N){N=fg.a.kl(N);return-1!==N.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==N.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==N.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==N.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==N.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==N.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}dDa(N){if(this.appName){const Qa={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=N;Qa[this.appName]=Bg.c(Db);this.usb.p6a(Qa);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,
220,10,"Fail to save roaming service since AppName is null")}koa(){if(!this.dga){const N=window.g_roamingAddinList;N&&(this.dDa(N),this.dga=!0)}}I6(N){N?this.cSb(N)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.xP="AddinHasShown"in N&&N.AddinHasShown?N.AddinHasShown.toString():null,this.Jvb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.ppa(this.Nua,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.xP=null,this.Jvb())}ZN(N){n.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",N?N.httpStatus:-1);this.ppa(this.Nua,null)}gP(N){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}Jvb(){const N=this.tdd();0===N.targetType?(N.solutionId?this.aPd(N):this.$na(null,"NoSolutionId"),this.bug(N),this.ppa(this.Nua,null)):this.ppa(this.Nua,N);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",N.addinId)}aPd(N){const Qa=new zg;
Qa.callbackFunc=Db=>{if(Db.errorCode){this.$na(N.solutionId,"FailToGetAppDetails");var fc=window.g_roamingAddinList;fc&&this.dDa(fc)}else if(Db.value)for(fc of Db.value)if(Db=fc[1],Db===N.solutionId){const vc={};vc.solutionId=Db;vc.assetId=fc[5];vc.storeType=fc[12];vc.storeId=fc[11];vc.assetStoreId=fc[6];vc.targetType=fc[3];vc.width=fc[7];vc.height=fc[8];vc.displayName=fc[0];vc.version=fc[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",N.solutionId);fc=new lh(vc);
this.Ra.raiseEvent(da.a.R_d,fc);break}};Qa.storeType=OSF.StoreTypeEnum.PrivateCatalog;Qa.fromInsertDialog=!1;Qa.refresh=!1;this.Lf.queryEntitlementDetails(Qa)}cSb(N){if("LastTeachingUIShowTime"in N){if(N=+new Date-+new Date(N.LastTeachingUIShowTime.toString()),N<hc.AFrameworkApplication.fa.WN("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",N),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");
return!0}tdd(){let N=new Ue.a(new Gg,0),Qa=new Ue.a(new Gg,0),Db=0,fc=0,vc=0;var Rc=new h.a;for(var cd of this.Nua)Rc.add(cd);for(let dd of this.TKa)Rc.add(dd);for(let dd of Rc)if(!("excatalog"!==dd.storeType||Gf.c(dd.installTimeInMS)||!dd.installTimeInMS||dd.installTimeInMS<=hc.AFrameworkApplication.fa.WN("DateTimeInMSForNewAddin",16409952E5))){Rc=Pg.hAb(dd);if(this.xP&&(cd=this.xP.split(","),0<cd.length&&Array.contains(cd,Rc))){vc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");
continue}Rc.startsWith("private_")?(N=Pg.Waf(dd,N),fc++):(Qa=Pg.Waf(dd,Qa),Db++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",fc,Db,vc);return 0<Qa.value?Qa.key:0<N.value?N.key:Object.assign(new Gg,{addinId:null,targetType:-1,solutionId:null})}$na(N,Qa,Db=null){N={["AppTeachingUICalloutAction"]:Qa,["SDX.Id"]:N,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Db)for(let fc of Db.keys)N[fc]=
Db.ma(fc);jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}))}bug(N){N&&(window.g_roamingAddinList=this.xP?this.xP+","+N.addinId:N.addinId)}static vW(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static Waf(N,Qa){return Qa.value<N.installTimeInMS?new Ue.a(Object.assign(new Gg,{addinId:Pg.hAb(N),targetType:N.targetType,solutionId:N.solutionId}),N.installTimeInMS):
Qa}static hAb(N){return Telemetry.PrivacyRules.IsPrivateAddin(N.storeType,N.assetId,null,null,N.storeId)?"private_"+N.installTimeInMS:N.solutionId}}Object(e.a)(Pg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var ch=a(82);const qh=()=>{const N=ch.a.u0(window.location.href.toLowerCase(),"wdomexsrctype");return!!N&&"4"===N},fh=()=>ch.a.u0(window.location.href.toLowerCase(),"wdtpl"),eh=()=>{const N=ch.a.u0(window.location.href.toLowerCase(),"wdomexsrctype");return!!N&&"1"===N};var Zg=a(855),zh=a(711);
class Dh{constructor(N){this.Ys=null;this.jv=N}get_current(){if(!this.Ys)throw Error.argumentOutOfRange();return this.Ys.data}moveNext(){if(!this.Ys)return this.Ys=this.jv,!!this.jv;if(!this.Ys.next)return!1;this.Ys=this.Ys.next;return!0}Rsc(){if(!this.Ys)return this.Ys=this.jv,!!this.jv;if(!this.Ys.previous)return!1;this.Ys=this.Ys.previous;return!0}reset(){this.Ys=this.jv}}Object(e.a)(Dh,"ListEnumerator",null,[0]);class gh{constructor(N,Qa,Db){this.next=Db;this.previous=Qa;this.data=N}}Object(e.a)(gh,
"ListNode",null,[]);class $g{constructor(){this.KB=this.hr=null;this._count=0}add(N){this.hr?this.KB=this.KB.next=new gh(N,this.KB,null):this.hr=this.KB=new gh(N,null,null);this._count=this.count+1}insert(N,Qa){if(N>this.count||0>N)throw Error.argumentOutOfRange("pos");if(N===this.count)this.add(Qa);else{for(var Db=this.hr;0!==N--;)Db=Db.next;N=new gh(Qa,Db.previous,Db);N.previous?N.previous.next=N:this.hr=N;N.next?N.next.previous=N:this.KB=N;this._count=this.count+1}}remove(N){let Qa=this.hr;for(;Qa&&
Qa.data!==N;)Qa=Qa.next;if(!Qa)return!1;Qa.previous?Qa.previous.next=Qa.next:this.hr=Qa.next;Qa.next?Qa.next.previous=Qa.previous:this.KB=Qa.previous;this._count=this.count-1;return!0}clear(){let N=this.hr,Qa;for(this.KB=this.hr=null;N;)Qa=N.next,N.previous=null,N.next=null,N=Qa;this._count=0}indexOf(N){let Qa=this.hr,Db=0;for(;Qa&&Qa.data!==N;)Qa=Qa.next,Db++;return Qa?Db:-1}ma(N){return this.at(N).data}get count(){return this._count}getEnumerator(){return new Dh(this.hr)}[Symbol.iterator](){return Object(zh.a)(this.getEnumerator())}ohc(N){N=
this.at(N);return new Dh(N)}toArray(){const N=Array(this.count);let Qa=0;for(let Db of this)N[Qa]=Db,Qa++;return N}at(N){let Qa=this.hr,Db=0;for(;Db!==N;){if(!Qa)throw Error.argumentOutOfRange("pos");Qa=Qa.next;Db++}return Qa}}Object(e.a)($g,"List",null,[1]);class hh extends Sys.EventArgs{constructor(N){super();this.properties=N}}Object(e.a)(hh,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class ea{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(e.a)(ea,
"MiniAddinInfo",null,[]);class H{constructor(N,Qa,Db){this.Ra=new Uf.a;this.context=new Cf;this.VZc=this.t1d=this.eJa=this.xP=this.YY=null;this.contextActivationMgr=N;this.AZg=Qa;this.fJa=Db;this.appName=hc.AFrameworkApplication.fa.Va("WebAppShortName")}get ETb(){this.VZc||(this.VZc=new Pg(this.Ra));return this.VZc}EVg(N){this.Ra.addHandler(da.a.psb,N)}ZYg(N){this.Ra.addHandler(da.a.R_d,N)}sak(N){null!==N&&(this.context.lP=N[da.a.TQ],this.context.lq=N[da.a.mN],this.context.aIc=this.context.$xc=0,
N=da.a.gJa in N?N[da.a.gJa]:0,-1!==this.context.lP&&0!==this.context.lq&&(this.context.gba=new $g,this.context.Nla=new $g,this.context.$9b=new $g,this.context.$2c=this.AZg.createAddinDataProvider(Zg.a(this.context.lP),this.contextActivationMgr),this.context.$2c?this.context.$2c.getEntitlementsAsync(this.contextActivationMgr.kfa,!0,N,Qa=>{this.J8i(Qa)}):n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.lP)))}J8i(N){if(N&&0<N.length){this.context.aIc=N.length;
const Db=hc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?fh():null;for(let fc=0;fc<N.length;fc++){const vc=N[fc];if(hc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&eh()&&vc&&vc.storeType&&"omex"===vc.storeType.toLowerCase()&&vc.assetId&&Db&&vc.assetId.toLowerCase()===Db.toLowerCase()){var Qa={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:H.vW(vc)};jc.a.sendTelemetryEvent(Object.assign(new Of.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:wc.a.Yh(Qa)}))}!vc||1!==vc.targetType&&-1!==vc.targetType?this.Otc():(Qa={},hc.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Qa.solutionId=vc.solutionId,Qa.version=vc.version):(Qa.marketplaceId=vc.solutionId,Qa.marketplaceVersion=vc.version),Qa.storeType=vc.storeType,Qa.storeId=vc.storeId,Qa.targetData=vc,H.FTb?this.contextActivationMgr.isAddinCommandsExAsync(Qa,
Object(Sb.a)(this,this.d8i,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Qa,(Rc,cd,dd)=>{Rc?(cd&&this.context.gba.add(dd.targetData),10===this.context.lP&&(Rc=dd.targetData,cd=Rc.targetType,Gf.c(dd.targetTypeForExp)||(cd=dd.targetTypeForExp,Rc.targetType=cd),this.context.Nla.add(Rc),0===cd&&this.context.$9b.add(Rc))):(dd=dd.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(dd.solutionId,
dd.storeType,dd.assetId,null,null,dd.storeId),dd.storeType));this.Otc()}))}}else this.Otc()}Otc(){var N;(N=this.context).$xc=N.$xc+1;this.context.$xc>=this.context.aIc&&(this.fJa.Qbg(this.context.lP,!1),0<this.context.aIc&&10===this.context.lP&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(N=!1,qh()&&(N=this.xPi()),this.KOi(),hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!N?H.FTb?this.ETb.p5d(this.contextActivationMgr,
this.context.Z2c,this.context.TKa,(Qa,Db)=>{const fc=new h.a;for(let vc of Qa)Qa=vc.XTb(),Db&&Db.solutionId===vc.solutionId&&(Qa.showCallout=!0,this.ETb.bug(Db)),fc.add(Qa);this.ppa(fc)}):this.XZh(this.context.gba):this.$3b(this.context.gba)):this.$3b(this.context.gba))}$3b(N){if(H.FTb)this.ppa(this.Phh(this.context.Z2c));else{var Qa=new h.a;if(N)for(let Db of this.context.gba)Qa.add(dh(Db));this.context.gba&&1>this.context.gba.count&&pg.a.zjb(da.a.qsb,"false",this.context.lP);N={["ack2"]:Qa};N[da.a.TQ]=
this.context.lP;N[da.a.mN]=this.context.lq;this.Ra.raiseEvent(da.a.psb,new hh(N),this)}}Phh(N){const Qa=new h.a;if(N)for(let Db of N)Qa.add(Db.XTb());return Qa}ppa(N){N&&N.count||pg.a.zjb(da.a.qsb,"false",this.context.lP);N={["ack2"]:N};N[da.a.TQ]=this.context.lP;N[da.a.mN]=this.context.lq;this.Ra.raiseEvent(da.a.psb,new hh(N),this)}dDa(N){if(this.appName){const Qa={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=N;Qa[this.appName]=Bg.c(Db);this.YY&&(this.YY.p6a(Qa),n.ULS.sendTraceTag(539530527,
306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}XZh(N){(this.eJa=N)?(N=new h.a,N.add(this.appName),this.YY=new rg(this.appName,Object(Sb.a)(this,this.I6,"getRequestSuccessCallback"),Object(Sb.a)(this,this.ZN,"getRequestFailureCallback"),Object(Sb.a)(this,this.gP,"postRequestFailureCallback")),this.YY.nec(N)):(N={["ack2"]:new h.a},N[da.a.TQ]=
this.context.lP,N[da.a.mN]=this.context.lq,this.Ra.raiseEvent(da.a.psb,new hh(N),this))}I6(N){N?this.cSb(N)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.xP="AddinHasShown"in N&&N.AddinHasShown?N.AddinHasShown.toString():null,this.Jvb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.$3b(this.eJa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.xP=null,this.Jvb())}ZN(N){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",
N?N.httpStatus:-1);this.$3b(this.eJa)}gP(N){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}Jvb(){const N=this.tdd();0===N.targetType?(N.solutionId?(this.t1d=N.solutionId,this.aPd()):this.$na("NoSolutionId"),N.addinId&&(window.g_roamingAddinList=this.xP?this.xP+","+N.addinId:N.addinId),this.kwe(null)):this.kwe(N.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",N.addinId)}aPd(){const N=new zg;N.callbackFunc=
Qa=>{if(Qa.errorCode){this.$na("FailToGetAppDetails");var Db=window.g_roamingAddinList;Db&&this.dDa(Db)}else if(Qa.value)for(Db of Qa.value)if(Qa=Db[1],Qa===this.t1d){const fc={};fc.solutionId=Qa;fc.assetId=Db[5];fc.storeType=Db[12];fc.storeId=Db[11];fc.assetStoreId=Db[6];fc.targetType=Db[3];fc.width=Db[7];fc.height=Db[8];fc.displayName=Db[0];fc.version=Db[4];Db=new lh(fc);this.Ra.raiseEvent(da.a.R_d,Db);break}};N.storeType=OSF.StoreTypeEnum.PrivateCatalog;N.fromInsertDialog=!1;N.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(N)}cSb(N){if("LastTeachingUIShowTime"in
N){if(N=+new Date-+new Date(N.LastTeachingUIShowTime.toString()),N<hc.AFrameworkApplication.fa.WN("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",N),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}tdd(){let N=new Ue.a(new ea,0),Qa=new Ue.a(new ea,0),Db=0,fc=0,vc=0;var Rc=new $g;if(0<this.context.gba.count)for(var cd of this.context.gba)Rc.add(cd);if(0<this.context.$9b.count)for(let dd of this.context.$9b)Rc.add(dd);
for(let dd of Rc)if(!("excatalog"!==dd.storeType||Gf.c(dd.installTimeInMS)||!dd.installTimeInMS||dd.installTimeInMS<=hc.AFrameworkApplication.fa.WN("DateTimeInMSForNewAddin",16409952E5))){Rc=H.hAb(dd);if(this.xP&&(cd=this.xP.split(","),0<cd.length&&Array.contains(cd,Rc))){vc++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Rc.startsWith("private_")?(N.value<dd.installTimeInMS&&(N=new Ue.a(Object.assign(new ea,{addinId:Rc,targetType:dd.targetType,solutionId:dd.solutionId}),
dd.installTimeInMS)),fc++):(Qa.value<dd.installTimeInMS&&(Qa=new Ue.a(Object.assign(new ea,{addinId:Rc,targetType:dd.targetType,solutionId:dd.solutionId}),dd.installTimeInMS)),Db++)}n.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",fc,Db,vc);return 0<Qa.value?Qa.key:0<N.value?N.key:Object.assign(new ea,{addinId:null,targetType:-1,solutionId:null})}kwe(N){const Qa=new h.a;for(let Db of this.eJa){const fc=dh(Db);if(N){const vc=
H.hAb(Db);N===vc&&(fc.showCallout=!0,window.g_roamingAddinList=this.xP?this.xP+","+N:N)}Qa.add(fc)}this.eJa&&1>this.eJa.count&&pg.a.zjb(da.a.qsb,"false",this.context.lP);N={["ack2"]:Qa};N[da.a.TQ]=this.context.lP;N[da.a.mN]=this.context.lq;this.Ra.raiseEvent(da.a.psb,new hh(N),this)}xPi(){if(H.FTb)return this.yPi(this.context.okd);var N=!1;if(this.context.Nla&&1>this.context.Nla.count)return N;const Qa=fh();if(!Qa)return N;for(let Db of this.context.Nla)if(Db.storeId&&Db.storeId.toLowerCase()===Qa.toLowerCase()||
Db.assetId&&Db.assetId.toLowerCase()===Qa.toLowerCase())N={["SDX_Id"]:H.vW(Db),["SDX_TargetType"]:Gf.c(Db.targetType)?"":Db.targetType.toString()},jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:wc.a.Yh(N)})),N=!0;return N}KOi(){if(H.FTb)this.LOi(this.context.okd);else if(!(this.context.Nla&&1>this.context.Nla.count))if(this.fJa.csf()){var N=this.fJa.Scf();N?(N=this.t9e(this.context.Nla,N),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):
(N=this.t9e(this.context.Nla,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.fJa.seg(N)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}t9e(N,Qa){const Db={};let fc=!1;for(let vc of N)if(N=H.vW(vc))!Qa||N in Qa||(this.LA(vc,N),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===N.toLowerCase()?fc||(fc=!0,Db[N]=null):Db[N]=null;return Db}LA(N,Qa){var Db=N.installTimeInMS?(new Date(N.installTimeInMS)).toISOString():"";
Db={["SDX.Id"]:Qa,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Gf.c(N.targetType)?"":N.targetType.toString(),["SDX.AdminDeploymentTime"]:Db};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wc.a.Yh(Db)}));1===N.targetType&&(N={["SDX.Id"]:Qa,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:wc.a.Yh(N)})))}yPi(N){let Qa=
!1;if(N&&1>N.count)return Qa;const Db=fh();if(!Db)return Qa;for(let fc of N)if(fc.storeId&&fc.storeId.toLowerCase()===Db.toLowerCase()||fc.assetId&&fc.assetId.toLowerCase()===Db.toLowerCase())N={["SDX_Id"]:H.Ucf(fc),["SDX_TargetType"]:Gf.c(fc.targetType)?"":fc.targetType.toString()},jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:wc.a.Yh(N)})),Qa=!0;return Qa}LOi(N){if(!(N&&1>N.count))if(this.fJa.csf()){var Qa=this.fJa.Scf();Qa?(N=
this.u9e(N,Qa),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(N=this.u9e(N,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.fJa.seg(N)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}u9e(N,Qa){const Db={};let fc=!1;for(let vc of N)if(N=H.Ucf(vc))!Qa||N in Qa||(this.KRi(vc,N),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===N.toLowerCase()?fc||(fc=!0,Db[N]=null):Db[N]=null;return Db}KRi(N,
Qa){var Db=N.installTimeInMS?(new Date(N.installTimeInMS)).toISOString():"";Db={["SDX.Id"]:Qa,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Gf.c(N.targetType)?"":N.targetType.toString(),["SDX.AdminDeploymentTime"]:Db};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wc.a.Yh(Db)}));1===N.targetType&&(N={["SDX.Id"]:Qa,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},jc.a.sendTelemetryEvent(Object.assign(new Of.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:wc.a.Yh(N)})))}d8i(N,Qa,Db,fc){N?(-1===fc.targetType&&(fc.targetType=Db.targetTypeForExp),N=new Fg(Db.targetData,fc),Qa&&this.context.Z2c.add(N),10===this.context.lP&&(this.context.okd.add(N),0===N.targetType&&this.context.TKa.add(N))):(Qa=Db.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Qa.solutionId,Qa.storeType,Qa.assetId,null,null,Qa.storeId),Qa.storeType));
this.Otc()}$na(N){N={["AppTeachingUICalloutAction"]:N,["SDX.Id"]:this.t1d,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}))}static get FTb(){return hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static vW(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,
N.storeType,N.assetId,null,null,N.storeId)}static Ucf(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static hAb(N){return Telemetry.PrivacyRules.IsPrivateAddin(N.storeType,N.assetId,null,null,N.storeId)?"private_"+N.installTimeInMS:N.solutionId}}Object(e.a)(H,"AddInCommandsListLoader",null,[]);class va{constructor(N){this.sLg=N}get kfa(){return this.sLg}insertOsfControl(N){return this.kfa.insertOsfControl(N)}getManifestInvaildErrorString(){return this.kfa.getManifestInvaildErrorString()}isAddinCommandsAsync(N,
Qa){this.kfa.isAddinCommandsAsync(N,Qa)}isAddinCommandsExAsync(N,Qa){this.kfa.isAddinCommandsExAsync(N,Qa)}ownerAddinControlRecreated(N,Qa){this.kfa.ownerAddinControlRecreated(N,Qa)}queryEntitlementDetails(N){this.kfa.queryEntitlementDetails(N)}}Object(e.a)(va,"ContextActivationMgrWrapper",null,[765]);class lb{createAddinDataProvider(N,Qa){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(N,Qa.kfa)}static get instance(){lb.Oa||(lb.Oa=new lb);return lb.Oa}}lb.Oa=null;Object(e.a)(lb,
"OSFAddinDataProviderFactory",null,[764]);class Ub{constructor(){this.Ver=1}}Object(e.a)(Ub,"CacheItem",null,[]);class Mc{constructor(N){this.kHa=N}lm(N){const Qa=this.kHa.getItem(N);if(Qa){let Db=new Ub;try{Db=Sys.Serialization.JavaScriptSerializer.deserialize(Qa,!0)}catch(fc){return this.kHa.removeItem(N),null}return Db.Data?Db.Data:Db.data}return null}QTa(N){this.kHa.removeItem(N)}}Object(e.a)(Mc,"AppsDataCacheManager",null,[786]);class rd{constructor(){new Mc(Pc.a.instance)}Qbg(N,Qa){N=da.a.z$e()+
N;Pc.a.instance.setItem(N,Qa.toString())}Scf(){var N=da.a.Vcf();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",N);N=Pc.a.instance.getItem(N);return Bg.a(N)}seg(N){const Qa=da.a.Vcf();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Qa);Pc.a.instance.setItem(Qa,Bg.c(N))}csf(){return!!Pc.a.instance.localStorage}static get instance(){rd.Oa||(rd.Oa=new rd);return rd.Oa}}rd.Oa=null;Object(e.a)(rd,"AddInCommandsCacheManager",null,[768]);class Id{constructor(N){this.pHc=null;this.dga=!1;
this.Ra=new Uf.a;this.IPb=this.dsa=null;this.contextActivationMgr=N;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(Sb.a)(this,this.x$i,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",Object(Sb.a)(this,this.AKb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(Sb.a)(this,this.vKb,"onCloseButtonClickedEventHandler"),!0))}get appName(){Gf.b(this.dsa)&&(this.dsa=hc.AFrameworkApplication.fa.Va("WebAppShortName"));
return this.dsa}yXg(N){this.Ra.addHandler(da.a.Xxf,N)}p5d(){this.contextActivationMgr.queryStoreDisabled("omex",N=>{N?n.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.X9j()})}X9j(){this.pHc=new rg(this.appName,Object(Sb.a)(this,this.I6,"getRequestSuccessCallback"),Object(Sb.a)(this,this.ZN,"getRequestFailureCallback"),Object(Sb.a)(this,this.gP,"postRequestFailureCallback"));this.pHc.uPh()}I6(N){this.cSb(N)&&(n.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),
this.G0d())}ZN(N){n.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",N?N.httpStatus:-1)}gP(N){n.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",N?N.httpStatus:-1)}cSb(N){if(!N)n.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in N&&(this.IPb=Object(Y.a)(String,N.Platforms),!Gf.b(this.IPb)&&(N=this.IPb.split(","),0<N.length&&Array.contains(N,"Web"))))return n.ULS.sendTraceTag(509690973,
344,50,"callout has shown for this platform"),!1;return!0}G0d(){const N=me.a.instance.qc("Common.ISystemInitiatedFeedback");if(N){var Qa=this.NZh();Gf.b(Qa)?n.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):N.execute(Db=>{Db.logActivity(Qa,null)})}else n.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}x$i(){this.LA("ClickOnLaunch");this.GVd();this.Ra.raiseEvent(da.a.Xxf)}vKb(){this.LA("ClickOnClose");this.GVd()}AKb(){this.LA("ClickOnDismiss");this.GVd()}NZh(){let N;
switch(this.appName){case "Word":N="WordShowCalloutForBEPHomeTab";break;case "Excel":N="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":N="PPTShowCalloutForBEPHomeTab";break;default:N=""}return N}LA(N){N={["AppTeachingUICalloutAction"]:N,["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}))}GVd(){if(!this.dga)if(Gf.b(this.appName))n.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");
else{const N={};N[this.appName]=this.IPb?this.IPb+",Web":"Web";this.pHc&&(this.pHc.zPh(N),n.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.dga=!0}}}Object(e.a)(Id,"BetterEntryTeachingCalloutLauncher",null,[]);class be{constructor(N,Qa,Db,fc,vc,Rc){this.lq=N;this.Rk=Qa;this.iY=Db;this.displayName=vc;this.Uwf=Rc}}Object(e.a)(be,"PostLaunchAddinCommandsParameters",null,[]);class ze{constructor(N,Qa,Db){this.dga=!1;this.YY=null;this.$a=N;this.ynb=
Qa;this.Skb=Db}v1c(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Sb.a)(this,this.QJd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Sb.a)(this,this.AKb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Sb.a)(this,this.vKb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Sb.a)(this,this.oKb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}QJd(){const N={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ze.vW(this.ynb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.Skb&&this.Skb.tabs&&!this.Skb.tabs[0].isOfficeTab&&(N["SDX.FeatureFlags"]="NonOfficeTab");jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}));this.koa();this.Skb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Skb,
()=>{const Qa=new Cg;Qa.Rk=this.ynb;this.$a.raiseEvent(da.a.KBd,Qa)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}vKb(){const N={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ze.vW(this.ynb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}));this.koa()}AKb(){const N=
{["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ze.vW(this.ynb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}));this.koa()}oKb(N){if(N&&(N=N.detail)&&N.id&&this.Cvd(N.id)){const Db=(N.action||"").toLowerCase();if(N.success&&"opened"===Db){var Qa={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:ze.vW(this.ynb),
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Qa)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.koa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Sb.a)(this,this.oKb,"onCampaignLaunchedHandler"),!0)}else try{Qa=JSON.stringify(N),n.ULS.sendTraceTag(523321995,
220,15,"Campaign launch failure. Event:"+Qa)}catch(fc){Qa="id : "+N.id+" telemetryEventName: "+N.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Qa+" Error: "+(fc?fc.toString():""))}}}Cvd(N){N=fg.a.kl(N);return-1!==N.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==N.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==N.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==N.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==N.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||
-1!==N.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}dDa(N){const Qa=hc.AFrameworkApplication.fa.Va("WebAppShortName");if(Qa){const Db={},fc={};fc.LastTeachingUIShowTime=(new Date).toUTCString();fc.AddinHasShown=N;Db[Qa]=Bg.c(fc);this.YY=new rg(Qa,null,null,Object(Sb.a)(this,this.gP,"postRequestFailureCallback")),this.YY.p6a(Db),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}koa(){if(!this.dga){const N=window.g_roamingAddinList;N&&(this.dDa(N),this.dga=!0)}}gP(N){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}static vW(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}}Object(e.a)(ze,"PrivateCatalogTeachingCalloutHandler",null,[]);class Me{constructor(N){this.XTc=null;this.xhe=
N}get eAa(){return this.XTc}e1a(N,Qa=null){this.xhe.e1a(N,Qa);this.XTc=N}TRd(N){this.xhe.TRd(N)}Mdg(N){this.XTc=N}}Object(e.a)(Me,"RibbonExtensibilityManagerWithChangeDetection",null,[787]);var jf=a(907),If=a(106);class Rf{static saf(N){const Qa=new h.a;if(Rf.eMe)for(var Db of Rf.eMe)Qa.add(Db);Db=null;switch(N){case "Workbook":Db=Rf.ulk;break;case "Document":Db=Rf.Hzh;break;case "Presentation":Db=Rf.rlj}if(Db)for(const fc of Db)Qa.add(fc);return Qa}}Rf.eMe=["PrimaryCommandSurface","ContextMenu"];
Rf.ulk=null;Rf.Hzh=null;Rf.rlj=null;Object(e.a)(Rf,"ExtensionPointType",null,[]);class ng{constructor(N){this.Kme=null;if(Gf.c(N))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.ECg=N}get aKb(){return this.Kme||(this.Kme=new h.a)}get Lze(){return this.ECg}}Object(e.a)(ng,"ContextMenuExtensibility",null,[774]);class mg{constructor(N,Qa=null,Db=0){if(Gf.c(N))throw n.ULS.sendTraceTag(9041814,
220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.lLg=N;this.xOg=Qa;this.gHg=Db}get BX(){return this.lLg}get startedNode(){return this.xOg}get lZh(){return this.gHg}}Object(e.a)(mg,"RibbonExtensibility",null,[810]);class kg{constructor(N){this.hGg=N.entitlement}get entitlement(){return this.hGg}createActionContext(N,Qa){N={};N.ownerAddinInfo=this.entitlement;N.action=Qa;return N}}Object(e.a)(kg,
"AddInCommandsContextProvider",null,[]);class Hg{constructor(N,Qa,Db){this.mae=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=N;this.eventBuilder=Qa;this.contextMenuBuilder=Db}get addinInfo(){return this.mae}Ymh(N){return new kg(N)}createActionBuilder(N,Qa){return OfficeExt.DefaultControlActionBinder.createActionBuilder(N,Qa.entitlement,Qa.manifest)}startApplyAddin(N){this.mae=N;const Qa=this.Ymh(N);this.actionBuilder=this.createActionBuilder(Qa,
N)}endApplyAddin(){}Skd(N,Qa,Db=0){return this.ribbonBuilder.ou&&0<this.ribbonBuilder.ou.count?new mg(this.wYh(N,Qa),this.addinInfo.startedNode,Db):null}D6e(){var N=null;if(this.contextMenuBuilder.wsc&&0<this.contextMenuBuilder.wsc.count){N||(N=this.addinInfo.entitlement.solutionId);N=new ng(N);for(let Qa of this.contextMenuBuilder.wsc)N.aKb.add(Qa);return N}return null}wYh(N,Qa){return this.ribbonBuilder.ou&&0<this.ribbonBuilder.ou.count?new jd.a(this.ribbonBuilder.ou,N,Qa):null}}Object(e.a)(Hg,
"AddinCommandsBuilder",null,[]);class vh{constructor(N,Qa,Db,fc,vc,Rc,cd){this.qWa=new If.a;this.lq=N;this.Lf=Qa;this.Tp=Db;this.ribbonManager=fc;this.contextMenuManager=vc;this.fH=Rc;this.ija=cd;this.SP=hc.AFrameworkApplication.sa.hF}FHb(N,Qa,Db,fc,vc,Rc,cd){const dd=(Hd,Zd,Fe,Ne)=>{vc(Hd,Zd,Fe,Ne);Hd=jf.a[this.lq]+Zd.assetId;({value:Zd}=this.qWa.nd(Hd)).returnValue&&(Zd.stop(),this.qWa.remove(Hd))};if(0!==this.lq&&N){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",N.count);4===this.lq&&(n.ULS.sendTraceTag(17586256,
220,100,String.format("Refresh AddinCommands for dataprovider : {0}",fc)),this.$dh(N,fc),Rc());for(let Hd of N)if(N=Hd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId))),this.dwg(N))if(cd&&N.requireConsent)cd(N,Zd=>{try{if(this.SP){const Ne=jf.a[this.lq]+Zd.solutionId,sf=this.SP.qd("ComponentAttach",Ne);this.qWa.ia(Ne,sf)}const Fe=this.fH.pla(Zd.storeType,
Zd.solutionId);6!==this.lq&&(Fe&&(this.M8b(Fe),Fe.IC.purge(!1)),this.Lf.insertOsfControl(this.NMb(Zd,Qa,Db,dd)),Fe&&this.Lf.ownerAddinControlRecreated(Zd.solutionId,Zd.storeType))}catch(Fe){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Zd.solutionId,Zd.ownerAddinStoreType||Zd.storeType,Zd.assetId,null,null,Zd.storeId),Zd.version,
Zd.storeType,Zd.storeId,Fe.message)),dd(!1,Zd,null,null)}});else try{if(this.SP){const Fe=jf.a[this.lq]+N.solutionId,Ne=this.SP.qd("ComponentAttach",Fe);this.qWa.ia(Fe,Ne)}const Zd=this.fH.pla(N.storeType,N.solutionId);!hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==hc.AFrameworkApplication.sa.Qa.Ii&&1!==hc.AFrameworkApplication.sa.Qa.Ii&&2!==hc.AFrameworkApplication.sa.Qa.Ii||3!==this.lq||"excatalog"===N.storeType||!Zd||Zd.isUpgraded?
6!==this.lq&&(Zd&&(this.M8b(Zd),Zd.IC.purge(!1)),this.Lf.insertOsfControl(this.NMb(N,Qa,Db,dd)),Zd&&this.Lf.ownerAddinControlRecreated(N.solutionId,N.storeType)):(this.ribbonManager.Mdg(Zd.Vo),dd(!0,N,null,Zd.displayName))}catch(Zd){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,
N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,Zd.message)),dd(!1,N,null,null)}else dd(!1,N,null,null)}}VLi(N,Qa,Db,fc,vc,Rc){const cd=(dd,Hd,Zd,Fe)=>{Rc(dd,Hd,Zd,Fe);dd=jf.a[this.lq]+Hd.solutionId;({value:Hd}=this.qWa.nd(dd)).returnValue&&(Hd.stop(),this.qWa.remove(dd))};if(6===this.lq&&N)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,
null,null,N.storeId))),this.dwg(N))try{if(this.SP){const Hd=jf.a[this.lq]+N.solutionId,Zd=this.SP.qd("ComponentAttach",Hd);this.qWa.ia(Hd,Zd)}const dd=this.fH.pla(N.storeType,N.solutionId);dd||cd(!1,N,null,null);hc.AFrameworkApplication.sa&&hc.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.a7e(N,Qa,fc,vc,Db,Hd=>{cd(Hd,N,Db,dd.displayName)}):(this.a7e(N,Qa,fc,vc,Db),cd(!0,N,Db,dd.displayName))}catch(dd){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,dd.message)),cd(!1,N,null,null)}else cd(!1,N,null,null)}g0i(N,Qa,Db,fc,vc,Rc){if(Rc)if(Rc._isAddinCommandsManifest(this.Tp.eO))try{hc.AFrameworkApplication.sa&&hc.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.$6e(N,Qa,Db,vc,Rc,cd=>{fc(cd,N,Rc,Rc.getDefaultDisplayName())}):(this.$6e(N,Qa,Db,vc,Rc),fc(!0,N,Rc,Rc.getDefaultDisplayName()))}catch(cd){n.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,cd.message)),fc(!1,N,Rc,Rc.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId)),fc(!1,N,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Tp.eO,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId)),
fc(!1,N,null,null)}NMb(N,Qa,Db,fc){const vc={},Rc=document.createElement("div");Rc.setAttribute("visible","false");vc.div=Rc;vc.id=N.solutionId;vc.solutionId=N.solutionId;vc.version=N.version;vc.storeType=N.storeType;vc.storeId=N.storeId;vc.assetId=N.assetId;vc.assetStoreId=N.assetStoreId;vc.isvirtualOsfControl=!0;vc.virtualOsfControlActivationCallback=(cd,dd)=>{const Hd=this.fH.pla(N.storeType,N.solutionId);Hd&&(Hd.isUpgraded&&(N.isUpgraded=!0),this.M8b(Hd));this.g0i(N,Qa,Db,fc,cd,dd)};vc.reason=
3===this.lq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return vc}$6e(N,Qa,Db,fc,vc,Rc=null){const cd={};cd.solutionId=fc.getSolutionId();cd.version=fc.getVersion();cd.storeType=fc.getStoreType();cd.storeId=fc.getStoreId();cd.assetId=fc.getAssetId();cd.assetStoreId=fc.getAssetStoreId();cd.targetType=fc.getOsfControlType();let dd=null,Hd=null;if(hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))dd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Tp.eO,this.Tp.formFactor)).parseExtensions(cd,vc,this.ija),Hd=Rf.saf(this.Tp.eO);else try{dd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Tp.eO,this.Tp.formFactor)).parseExtensions(cd,vc,this.ija),Hd=Rf.saf(this.Tp.eO)}catch(Fe){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Fe.message),Fe;}if(Hd&&0<Hd.count){if(hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Zd=Qa(N);Qa=Db(N);Db=!!hc.AFrameworkApplication.fa&&hc.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");Zd=new Hg(Zd,null,Qa);for(let Fe of Hd)Zd.commandSurface=Fe,dd.apply(Zd,this.ija,Db)}else try{let Fe=Qa(N),Ne=Db(N),sf=!!hc.AFrameworkApplication.fa&&hc.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");Zd=new Hg(Fe,null,Ne);for(let vg of Hd)Zd.commandSurface=vg,dd.apply(Zd,this.ija,sf)}catch(Fe){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Fe.message),Fe;}if(OSF.OUtil.checkFlight(14))try{let Fe=Zd.Skd(N.solutionId,vc.getDefaultDisplayName()),Ne=Zd.D6e();Fe&&this.ribbonManager.e1a(Fe,Rc);Ne&&this.contextMenuManager.Nve(Ne);this.fH.rwe(fc,Fe,Ne,vc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",vc.getDefaultDisplayName())}catch(Fe){throw OfficeExt.DevConsole.log(Fe),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Fe.message),Fe;}else try{let Fe=Zd.Skd(N.solutionId,
vc.getDefaultDisplayName()),Ne=Zd.D6e();Fe&&this.ribbonManager.e1a(Fe);Ne&&this.contextMenuManager.Nve(Ne);this.fH.rwe(fc,Fe,Ne,vc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",vc.getDefaultDisplayName())}catch(Fe){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Fe.message),Fe;}}}a7e(N,Qa,Db,fc,vc,Rc=null){const cd={};cd.solutionId=N.solutionId;cd.version=N.version;cd.storeType=N.storeType;cd.storeId=N.storeId;cd.assetId=
N.assetId;cd.assetStoreId=N.assetStoreId;cd.targetType=N.targetType;const dd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Tp.eO,this.Tp.formFactor);try{const Hd=Qa.getManifest(),Zd=dd.parse(cd,Hd,vc,this.ija,Qa.getSharedRuntimeId(),Qa),Fe=Db(N),Ne=fc(N),sf=new Hg(Fe,null,Ne);sf.commandSurface="PrimaryCommandSurface";Zd.apply(sf,this.ija,!0);if(sf.ribbonBuilder.ou&&0<sf.ribbonBuilder.ou.count){const vg=sf.Skd(N.solutionId,Qa.getManifest().getDefaultDisplayName(),1);hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.e1a(vg,Rc):vg&&this.ribbonManager.e1a(vg,Rc);this.fH.ITg(Qa,vg,vc,Qa.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Qa.getManifest().getDefaultDisplayName())}}catch(Hd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Qa.getManifest().getDefaultDisplayName(),Hd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Hd)}}M8b(N){N.Vo&&this.ribbonManager.TRd(N.Vo);
N.Xvb&&this.contextMenuManager.Nvj(N.Xvb);this.fH.uvj(N.IC.getStoreType(),N.IC.getSolutionId())}$dh(N,Qa){Qa=Zg.a(Qa);for(let Db of this.fH.r9a){if(Db.IC.getStoreType()!==Qa)continue;let fc=!0;for(let vc of N){const Rc=vc;if(Rc&&Db.Xtf(Rc.storeType,Rc.solutionId)){fc=!1;break}}fc&&(this.M8b(Db),Db.IC.purge(!1))}}dwg(N){return!!N&&!!N.solutionId&&!!N.version&&!!N.storeType&&!!N.storeId}}Object(e.a)(vh,"AddInCommandsIntegration",null,[]);class mh{constructor(N,Qa,Db,fc,vc,Rc,cd,dd=null){this.$a=new Uf.a;
this.pMc=N;this.YEg=Qa;this.Bk=Db;this.Wse=fc;this.N_a=vc;this.tCg=Rc;this.wWb=cd;this.cLg=dd}FVg(N){this.$a.addHandler(da.a.fze,N)}xXg(N){this.$a.addHandler(da.a.KBd,N)}YYg(N){this.$a.addHandler(da.a.Nhg,N)}MVg(N){this.$a.addHandler(da.a.f5c,N)}oMi(N,Qa,Db){const fc=Db[da.a.osb],vc=void 0===Db[da.a.mN]?0:Db[da.a.mN];if(fc&&0!==vc)if(0>=fc.count&&4!==vc)this.BWf(new be(vc,null,null,Qa,null,!0));else{var Rc=fc.count,cd=new Me(new Md),dd=void 0===Db[da.a.TQ]?-1:Db[da.a.TQ],Hd=new vh(vc,this.Bk,this.pMc,
cd,this.YEg,this.N_a,this.wWb),Zd=hg=>this.Wse.f8g(hg.solutionId,this.wWb,this.pMc,N),Fe=hg=>this.Wse.p7g(hg.solutionId),Ne=(hg,Wf,bg)=>{Rc--;bg=new be(vc,Wf,cd,Qa,bg,0>=Rc);if(hg&&Wf)this.BWf(bg);else{if(3===vc||Wf&&Wf.isUpgraded)hg="",Wf&&(hg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Wf.solutionId,Wf.ownerAddinStoreType||Wf.storeType,Wf.assetId,null,null,Wf.storeId)),Wf={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:hg},jc.a.sendTelemetryEvent(Object.assign(new Of.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:wc.a.Yh(Wf)}));this.AWf(bg)}Rc||hc.AFrameworkApplication.sa.updateCommandUI()},sf=(hg,Wf,bg,wg)=>{Ne(hg,Wf,wg)},vg=()=>{this.GHd();0>=fc.count&&4===vc&&this.N_a.JXd()};6===vc?(dd=Db[da.a.XLa],Db=Db[da.a.YLa],Hd.VLi(fc.ma(0),dd,Db,Zd,Fe,(hg,Wf,bg,wg)=>{Ne(hg,Wf,wg)})):Hd.FHb(fc,Zd,Fe,dd,sf,vg,this.cLg)}else jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wc.a.Yh({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.pMc.eO)),this.AWf(new be(vc,null,null,Qa,null,!0))}AWf(N){this.GHd(N);this.Eig(!1,N)}BWf(N){const Qa=N.Rk;let Db=null;null!==Qa&&(Db=Qa.storeType,Db=Db.toLowerCase());if(N&&"omex"===Db&&(3===N.lq||Qa.isUpgraded)){var fc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Qa.solutionId,
Qa.ownerAddinStoreType||Qa.storeType,Qa.assetId,null,null,Qa.storeId)};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wc.a.Yh(fc)}))}this.GHd(N);fc=eh()&&"omex"===Db&&!!N.iY&&!!Qa.solutionId&&2===N.lq&&Qa.solutionId.toLowerCase()===fh().toLowerCase();var vc="excatalog"===Db&&3===N.lq;if("omex"===Db&&N.iY&&(3===N.lq&&"hardcodedpreinstall"!==Db||Qa.isUpgraded)||fc||vc)fc=new Cg,fc.Rk=Qa,fc.Vo=N.iY.eAa,this.$a.raiseEvent(da.a.f5c,fc);fc=qh();vc=
fh();fc&&Qa&&"excatalog"===Qa.storeType&&N.iY&&5===N.lq&&vc&&(Qa.storeId&&Qa.storeId.toLowerCase()===vc.toLowerCase()||Qa.assetId&&Qa.assetId.toLowerCase()===vc.toLowerCase())&&(fc=new Cg,fc.Rk=Qa,fc.Vo=N.iY.eAa,this.$a.raiseEvent(da.a.f5c,fc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));Qa&&(rd.instance.Qbg(Zg.b(Db),!0),"uploadfiledevcatalog"===Db&&(fc=this.tCg.createAddinDataProvider(Db,this.Bk))&&fc.localCacheAddinCommands(this.Bk.kfa,Qa.solutionId,Qa.version,
Qa.storeId),pg.a.zjb(da.a.qsb,"true",Zg.b(Db)));this.Eig(!0,N)}Eig(N,Qa){N?hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Qa.iY&&5===Qa.lq&&Qa.iY.eAa&&void 0!==Qa.Rk.showCallout&&null!==Qa.Rk.showCallout&&Qa.Rk.showCallout?(hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Pg(this.$a)).v1c(Qa.Rk,jd.a.X6a(Qa.iY.eAa)):(new ze(this.$a,Qa.Rk,jd.a.X6a(Qa.iY.eAa))).v1c(),
N=new Cg,N.Vo=Qa.iY.eAa,N.Rk=Qa.Rk,this.$a.raiseEvent(da.a.Nhg,N)):3!==Qa.lq?Qa.Uwf&&this.N_a.JXd():Qa.iY&&Qa.iY.eAa&&"hardcodedpreinstall"!==Qa.Rk.storeType&&Ud.a.WWj(Qa.displayName,Qa.iY.eAa,Qa.Rk.isAutoLaunched):3===Qa.lq?Qa.Rk&&"uploadfiledevcatalog"===Qa.Rk.storeType.toLowerCase()?(Qa=this.wWb.e5h(Qa.Rk.solutionId),Ud.a.M_d(Qa?Qa:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.N_a.$cg():Qa.Uwf&&this.N_a.JXd()}GHd(N=null){var Qa=N?N.Rk:null;const Db=new Cg;
if(Db.Rk=Qa){var fc=this.N_a.pla(Qa.storeType,Qa.solutionId,6===N.lq?1:0);if(fc&&fc.Vo){Db.Vo=fc.Vo;var vc=fh();vc=eh()&&!!Qa.solutionId&&!!vc&&Qa.solutionId.toLowerCase()===vc.toLowerCase()&&2===N.lq;if(3===N.lq&&"hardcodedpreinstall"!==Qa.storeType||vc)N="",fc.Vo.BX&&fc.Vo.BX.ou&&(fc=fc.Vo.BX.ou.ma(0))&&(N=fc.id),Qa={["SDX_CommandPlacement"]:N,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Qa.solutionId,Qa.ownerAddinStoreType||
Qa.storeType,Qa.assetId,null,null,Qa.storeId)},jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:wc.a.Yh(Qa)}))}}this.$a.raiseEvent(da.a.fze,Db)}}Object(e.a)(mh,"LaunchAddinCommandsHandler",null,[775]);class $f{}$f.UXa="Alt";$f.VXa="Command";$f.id="Id";$f.YXa="Image16by16";$f.fWb="LabelText";$f.ZXa="Title";$f.GROUP="Group";$f.g$d="Groups";$f.Jkb="Controls";$f.button="Button";$f.cda="FlyoutAnchor";$f.LARGE="Large";$f.SMALL="Small";Object(e.a)($f,
"AddinDataNodeConstants",null,[]);var wh=a(385);a(578);var hi=a(573);a(140);class ii{constructor(N,Qa){this.qHa=this.Wce=null;if(Gf.c(N)||Gf.c(Qa))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.dFg=Qa;this._id=N;this.uV[$f.id]=this._id}get id(){return this._id||""}get uV(){return this.Wce||(this.Wce={})}get controlType(){return this.dFg||""}get menuItems(){return this.qHa||
(this.qHa=new h.a)}}Object(e.a)(ii,"ControlDefinition",null,[772]);class Ah{constructor(N){this.ule=null;if(Gf.c(N))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=N;this.noa[$f.id]=this._id}get noa(){return this.ule||(this.ule={})}get id(){return this._id||""}}Object(e.a)(Ah,"MenuItemDefinition",null,[793]);class wi{constructor(N){this.vsa=null;if(Gf.c(N))throw n.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=N}get id(){return this._id}get controls(){return this.vsa||(this.vsa=new h.a)}}Object(e.a)(wi,"OfficeMenuDefinition",null,[771]);var Ze=a(26);class ji{constructor(N,Qa,Db){this.lK=this.KYa=null;this.IVc=N;this.AYa=Qa;this.bYa=Db;this.BKg=new h.a}get dtc(){return this.IVc}get xvb(){return this.AYa}get y0c(){return this.bYa}addButton(N){n.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",N.actionType);this.lK=new ii(this.ova(N.id),$f.button);this.lK.uV[$f.fWb]=N.label;this.lK.uV[$f.UXa]=N.label;this.lK.uV[$f.YXa]=N.icon["16"];this.Jtb(this.lK.uV[$f.id],N.action);this.QIa(this.lK.uV);this.KYa.controls.add(this.lK);this.lK=null}startBuildMenu(N){if(Gf.c(this.KYa))this.KYa=new wi(N.id);else{const Qa=this.ova(N.id);this.lK=new ii(Qa,$f.cda);this.N2a(this.lK.uV,N);this.lK.uV[$f.YXa]=N.icon["16"];this.lK.uV[$f.VXa]=Ze.a.alwaysEnabled}}addMenuItem(N){n.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",N.actionType);const Qa=new Ah(this.ova(N.id));this.N2a(Qa.noa,N);N.icon&&(Qa.noa[$f.YXa]=N.icon["16"]);this.Jtb(Qa.noa[$f.id],N.action);this.QIa(Qa.noa);this.lK.menuItems.add(Qa)}endBuildMenu(){Gf.c(this.lK)?(this.wsc.add(this.KYa),this.KYa=null):(this.KYa.controls.add(this.lK),this.lK=null)}get wsc(){return this.BKg}Jtb(N,Qa){this.y0c.bindAction(N,Qa)}QIa(N){this.xvb.QIa(N)}ova(N){return this.dtc.xNa(N)}N2a(N,Qa){N[$f.fWb]=Qa.label;N[$f.UXa]=Qa.label}}
Object(e.a)(ji,"ContextMenuExtensibilityCreator",null,[783,779]);class Ih{constructor(N){this.Mob=N}get vJb(){return this.Mob}xNa(N){return this.vJb+N}}Object(e.a)(Ih,"DefaultContextMenuNamingProvider",null,[782]);var ki=a(1359);class Wh{bindAction(N,Qa){OfficeExt.DefaultControlActionBinder.bindAction(N,Qa)}}Object(e.a)(Wh,"DefaultUIControlActionBinder",null,[781]);class Xh{constructor(N){this.UFa=N}get command(){return this.UFa}QIa(N){N[$f.VXa]=this.command}}Object(e.a)(Xh,"DefaultUIControlCommandBinder",
null,[780]);var Yh=a(28);class nh{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(e.a)(nh,"AddInControl",null,[]);class Qg{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(e.a)(Qg,"AddInGroup",null,[]);class Eh{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(e.a)(Eh,"AddInMenuItem",null,[]);class Zh{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(e.a)(Zh,"AddInTab",null,[]);class li{constructor(N,Qa,Db,fc,vc,Rc){this.tWb=new h.a;this.Ylb=this.vha=this.LYa=null;this.IVc=N;this.bYa=Qa;this.AYa=Db;this.Ey=fc;this.wWb=vc;this.cfe=Rc}get dtc(){return this.IVc}get ou(){return this.tWb}get y0c(){return this.bYa}get xvb(){return this.AYa}startBuildTab(N){const Qa=N.isOfficeTab?N.id:this.dtc.Wef(N.id),
Db=N.isOfficeTab?null:N.label;this.LYa=Object.assign(new Zh,{id:Qa,title:Db,isOfficeTab:N.isOfficeTab,visible:N.visible,groups:[],tabType:N.tabType,insertBefore:N.insertBefore,insertAfter:N.insertAfter,autoFocus:N.autoFocus})}startBuildGroup(N){const Qa=this.ova(N.id);this.vha=Object.assign(new Qg,{id:Qa,mlrId:N.mlrId,title:N.label,controls:[],groupType:0})}addNativeGroup(N){this.vha=Object.assign(new Qg,{id:N.id,mlrId:N.mlrId,title:N.label,controls:[],groupType:1});this.LYa.groups.push(this.vha)}addButton(N){const Qa=
this.ova(N.id);Qa&&(this.Jtb(Qa,N.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",N.actionType),N=Object.assign(new nh,{id:Qa,title:N.label,iconLocation:this.und(N),enabled:N.enabled,controlType:0,attributes:this.N2a()}),this.cfe.xve(new Yh.a(Qa,this.xvb.command.toString())),this.vha.controls.push(N))}addNativeControl(N){N.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",N.actionType),N=Object.assign(new nh,{id:N.id,
title:"",iconLocation:"",enabled:N.enabled,controlType:2,attributes:this.N2a()}),this.vha.controls.push(N))}startBuildMenu(N){const Qa=this.ova(N.id);Qa&&(this.Ylb=Object.assign(new nh,{id:Qa,title:N.label,iconLocation:this.und(N),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(N){const Qa=this.ova(N.id);Qa&&(this.Jtb(Qa,N.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",N.actionType),N=Object.assign(new Eh,{id:Qa,title:N.label,iconLocation:this.und(N),
enabled:N.enabled,attributes:this.N2a()}),this.cfe.xve(new Yh.a(Qa,this.xvb.command.toString())),this.Ylb.menuItems.push(N))}endBuildMenu(){Gf.c(this.Ylb.id)||this.vha.controls.push(this.Ylb);this.Ylb=null}endBuildGroup(){Gf.c(this.vha.id)||this.LYa.groups.push(this.vha);this.vha=null}endBuildTab(){Gf.c(this.LYa.id)||this.tWb.add(this.LYa);this.LYa=null}N2a(){const N={};this.QIa(N);return N}und(N){return N.icon["80"]?N.icon["80"]:N.icon["32"]}QIa(N){this.xvb.QIa(N)}ova(N){return this.dtc.xNa(N)}Jtb(N,
Qa){this.y0c.bindAction(N,Qa)}}Object(e.a)(li,"OneLineRibbonExtensibilityCreator",null,[778,779]);class mi{constructor(N,Qa){this.Mob=N;this.bYa=new Wh;this.AYa=new Xh(Qa)}p7g(N){N=new Ih(N);return new ji(N,this.AYa,this.bYa)}f8g(N,Qa,Db,fc){Db=new ki.a(this.Mob,N,Db,!0);return new li(Db,this.bYa,this.AYa,N,Qa,fc)}}Object(e.a)(mi,"UIExtensibilityFactory",null,[766]);var ye=a(91),K=a(905),ua=a(23),ab=a(40),Ib=a(79),mc=a(52);class Cc{constructor(N){this.dJa=this.iJa=this.Rk=this.Vo=null;this.k3f=0;
this.w8i=()=>{if(this.Rk&&this.dJa){const Qa=new ye.a(Ze.a.y4,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Qa,{["SourceControlId"]:this.dJa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.XWj=(Qa,Db)=>{Qa=null;if(Db)if(Qa=Db,this.Rk=Qa.Rk,(this.Vo=Qa.Vo)&&this.Vo.BX&&this.Vo.BX.ou&&(this.iJa=this.Vo.BX.ou.ma(0)),this.iJa&&this.iJa.id)if(this.iJa.isOfficeTab)if(Db=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Qa=
this.Rk.solutionId,Qa in Db?this.dJa=Db[Qa]:(Db=Cc.GetPrivacyCompliantId(this.Rk),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Db}`),this.dJa=this.WZh(this.Vo)),this.dJa)if(ua.a.contains(this.iJa.id,zf.a.bT,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(jd.a.X6a(this.Vo),()=>{this.gjg(this.Fod(this.dJa))});else{if(Db=this.$.Ia)Db.Yye(this.ZRf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),Db={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Db)})),this.h8();else this.ijg(this.Fod(this.iJa.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
Db={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Db)})),this.h8();else this.h8()};this.ZRf=()=>{if(ua.a.contains(this.iJa.id,appChrome.selectors.getSelectedTabId(),!0)){var Qa=this.$.Ia;Qa&&Qa.h5f(this.ZRf);this.gjg(this.Fod(this.dJa))}};this.y8i=
()=>{var Qa={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Cc.WXa(this.WD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Qa)}));this.h8();let Db={};Db[Ib.a.Bg]=this.WD;Qa={};Qa.solutionId=this.WD.solutionId;Qa.assetId=this.WD.assetId;Qa.assetStoreId=this.WD.assetStoreId;Qa.height=0!=this.WD.height?this.WD.height:600;Qa.storeId=
this.WD.storeId;Qa.storeType=this.WD.storeType;Qa.targetType=this.WD.targetType;Qa.width=0!=this.WD.width?this.WD.width:600;Qa.displayName=this.WD.displayName;Qa.version=this.WD.version;Qa.isAddinCommands=!1;Db[da.a.jja]=Qa;let fc=new ye.a(-741808261,0,0,2,null);ab.TaskExtensions.za(mc.GetServiceTaskFactory.Za(this.$.da,374,375,1),vc=>{vc=vc.result;null!=vc&&vc.insertAgave(Db,fc)},this.$.ka,3)};this.g2i=()=>{let Qa={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Cc.WXa(this.WD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Qa)}));this.h8()};this.E3i=()=>{let Qa={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Cc.WXa(this.WD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Qa)}));this.h8()};
this.gP=Qa=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Qa?Qa.httpStatus:-1}`)};this.$=N.$;this.addinUICommandHandler=N;this.appName=hc.AFrameworkApplication.fa.Va("WebAppShortName")||"Excel";this.FZg=hc.AFrameworkApplication.fa.oe("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static WXa(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,
N.storeType,N.assetId,null,null,N.storeId)}Nuj(N){this.WD=N;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.y8i,!0),window.addEventListener("DismissCallout",this.E3i,!0),window.addEventListener("CloseCallout",this.g2i,!0))}Fod(N){return"[id="+N+"]"}ijg(N,Qa){Qa>this.FZg?(window.clearTimeout(this.k3f),this.hjg("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
N)?this.hjg(N):this.k3f=window.setTimeout(()=>{this.ijg(N,Qa+1)},1E3)}gjg(N){var Qa=document.querySelector("button[data-unique-id='RightPaddle']");if(Qa)N={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}));else if(Qa=document.querySelector("button"+
N),!Qa||"none"===window.getComputedStyle(Qa).display)if(Qa=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Qa){Qa={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(Qa)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");
this.h8();return}this.Npg(Qa,"ShowTeachingUIForAddinButton")}hjg(N){N=document.querySelector("button"+N);if(!N&&(N=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!N)){N={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}));n.ULS.sendTraceTag(537170690,
220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.h8();return}this.Npg(N,"ShowTeachingUIForAddinTab")}Npg(N,Qa){N.setAttribute("lpp-id","latestAddin");const Db=me.a.instance.qc("Common.ISystemInitiatedFeedback");Db&&N?(Db.execute(fc=>{fc.logActivity(Qa,null)}),N={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),N={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Cc.GetPrivacyCompliantId(this.Rk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)})),this.h8())}WZh(N){if(!N)return null;N=N.BX;if((null===N||void 0===N?0:N.ou)&&0<N.ou.count)for(let Qa of N.ou)if(Qa.groups&&0<Qa.groups.length)for(const Db of Qa.groups)if(Db.controls&&0<Db.controls.length)for(const fc of Db.controls){if(fc.attributes&&0===fc.controlType&&fc.enabled)return fc.id;if(fc.menuItems)for(const vc of fc.menuItems)if(vc.attributes&&vc.enabled)return fc.id}return null}pZj(){var N=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");
if(N&&"none"!==window.getComputedStyle(N).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{N=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==N){N={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Cc.WXa(this.WD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)}));
n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.h8();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Qa=me.a.instance.qc("Common.ISystemInitiatedFeedback");null==Qa||null==N?(N={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Cc.WXa(this.WD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:wc.a.Yh(N)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.h8()):(Qa.execute(Db=>{Db.logActivity("ShowTeachingUIForContentAddin",null)}),N={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Cc.WXa(this.WD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh(N)})),n.ULS.sendTraceTag(527286664,
220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}dDa(N){const Qa={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=N;Qa[this.appName]=Bg.c(Db);this.usb=new rg(this.appName,null,null,this.gP),this.usb.p6a(Qa),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}h8(){if(!this.dga){const N=window.g_roamingAddinList;N&&(this.dDa(N),this.dga=!0)}}}Object(e.a)(Cc,"AddinTeachingCalloutHandler",
null,[]);var Ec=a(1285),hd=a(428),Zc=a(12),bd=a(198),Ad=a(46),Od=a(20),ke=a(62),Qe=a(157),Be=a(195);class Ge extends Qe.a{constructor(N,Qa,Db,fc){super();this.cZ="calc(100% - 46px)";this.U$="15px";this.dZ="0";this.qmb="WACDialogPanel";this.tF=695;this.rmb=462;this.pD="80%";this.elb=350;this.ksa="100%";this.pU=null;this.rc=5;this.Te="AddinInstallDialog";this.iDg=N;this.oZ=Qa;this.WPg=Db;this.iLg=fc}gy(){super.gy();this.Bi.style.width=this.ksa;this.Bi.style.height=this.cZ;this.Bi.style.marginTop=this.U$;
this.Bi.style.padding=this.dZ;document.getElementById(this.wi("WACDialogButtonPanel")).style.display="none";this.Vja.setAttribute("tabindex","0");$addHandler(this.Vja,"keyup",Object(Sb.a)(this,this.onKeyUp,"onKeyUp"));const N=document.createElement("iframe");N.setAttribute("id","InstallAddinDialog");N.setAttribute("src","about:blank");N.setAttribute("width","100%");N.setAttribute("height","100%");N.setAttribute("marginHeight","0");N.setAttribute("marginWidth","0");N.setAttribute("frameBorder","0");
N.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Qa=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.iDg,this.oZ,this.WPg);N.setAttribute("src",Qa);this.pU=N;$addHandler(N,"load",Object(Sb.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Sb.a)(this,this.onMessage,"onMessage"));this.Bi.appendChild(N);this.Bi.appendChild(this.Wnh())}Wnh(){const N=document.createElement("div");
N.setAttribute("tabindex","0");$addHandler(N,"focus",Object(Sb.a)(this,this.T8i,"onLoopPivotFocus"));return N}onKeyUp(N){13!==N.keyCode&&32!==N.keyCode||this.hide()}T8i(){this.Vja.focus()}onLoad(){this.pU.focus()}onMessage(N){N=N.rawEvent;if(N.source===this.pU.contentWindow&&(N=(N=N.data)?N.split("|"):null)&&0<N.length&&("REFRESH_REQUIRED"===N[0]||"PRELOAD_MANIFEST"===N[0])){Pc.a.instance.setItem("refreshRequired","true");const Qa={};Qa.solutionId=N[1];Qa.version=Ge.LYi(N[3]);Qa.storeType=N[4];Qa.storeId=
N[5];Qa.assetId=N[6];Qa.targetType=Ge.Ugj(N[2]);Qa.assetStoreId=N[7];Qa.width=parseInt(N[8]);Qa.height=parseInt(N[9]);this.iLg(Qa)}}spa(){this.Bi.style.width=this.ksa;this.Bi.style.height=this.cZ;this.Bi.style.marginTop=this.U$;this.Bi.style.padding=this.dZ;this.tF>Be.a.J1?(this.Hb.style.width=String.format("{0}px",Be.a.J1),this.Hb.style.overflowX="scroll",hc.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0"):(this.Hb.style.width=String.format("{0}px",this.tF),this.Hb.style.overflowX=
"hidden");this.Hb.offsetHeight>Be.a.YS||this.rmb+50>Be.a.YS?(this.Hb.style.height=String.format("{0}px",Be.a.YS),this.Hb.style.overflowY="scroll",this.Hb.style.top="0",hc.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0",this.Bi.style.minHeight=String.format("{0}px",this.elb)):(this.Hb.style.overflowY="hidden",this.Hb.style.top="10%",this.Hb.style.height=this.pD);this.Qba()}Qba(){if(this.Hb){var N=this.Hb.style.zIndex;this.Hb.style.zIndex="-9999";if(this.tF>Be.a.J1)hc.AFrameworkApplication.isRtl?
this.Hb.style.marginRight="0":this.Hb.style.marginLeft="0";else{const Qa=String.format("{0}px",Math.floor(-this.Hb.offsetWidth/2));hc.AFrameworkApplication.isRtl?this.Hb.style.marginRight=Qa:this.Hb.style.marginLeft=Qa;hc.AFrameworkApplication.isRtl?this.Hb.style.right="50%":this.Hb.style.left="50%"}this.Hb.style.zIndex=String(N)}else n.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}bF(){super.bF();const N=document.getElementById(this.wi(this.qmb));N.style.width=String.format("{0}px",
this.tF);N.style.height=this.pD}get Dca(){return this.Bi}dispose(){super.dispose();$removeHandler(window,"message",Object(Sb.a)(this,this.onMessage,"onMessage"))}static Ugj(N){switch(N){case "1":return 0;case "2":return 1;default:return 0}}static LYi(N){const Qa=N.split(".");for(let Db=0;Db<4-Qa.length;Db++)N+=".0";return N}}Object(e.a)(Ge,"AddinInstallDialog",Qe.a,[]);var vf=a(906);class ff{constructor(N){this.vYc=N}next(N){this.vYc=(9301*this.vYc+49297)%233280;return Math.floor(this.vYc/233280*
N)}}Object(e.a)(ff,"Random",null,[]);class tf extends wh.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(e.a)(tf,"CuiButtonPropsExtended",wh.a,[]);var Qc=a(1007),vd=a(595);class We{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(e.a)(We,"GallerySectionProps",null,[]);var Pf=a(1358),Xf=a(579);class Zf{constructor(){this.text=this.href=null}}Object(e.a)(Zf,"LinkProps",null,[]);class xg{constructor(){this.icon=this.text=this.href=null}}
Object(e.a)(xg,"LinkWithLabelProps",null,[]);var ig=a(1006),Vg=a(172);class Hh{constructor(N,Qa,Db,fc,vc,Rc=null,cd=null){this.RQc={};this.Dke={};this.RYb={};this.cge=0;this.goe=!1;this.Qkb=0;this.sge=!1;this.oGa=this.bob=0;this.Rkb=Qa;this.Cy=null;this.UJg=Db;this.WJg=fc;this.wNg=vc;this.jae=cd;this.Ta=Rc||hc.AFrameworkApplication.fa;this.Rkb.rfb(Object(Sb.a)(this,this.oBa,"onAddinDetailsRefreshed"));appChrome.addInApi.loadOfficeAddInIcons()}get Sjh(){return this.RYb}Vtj(N){if(N.FK)for(let Qa=0;Qa<
N.FK.length;Qa++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+N.FK[Qa].solutionId,N.FK[Qa].iconUrl);else 0===N.errorCode&&n.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get Dnc(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get wxd(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadEnabled",!1)}get Cnc(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadV2Enabled",
!1)}get Nnc(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}bUj(N){0===N.hI&&(this.Qkb|=1);1===N.hI&&(this.Qkb|=2);return!!this.Qkb}oBa(N,Qa){this.Vtj(Qa);this.jae&&this.jae.oBa(N,Qa);this.bUj(Qa)&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",!1)&&this.DQi()}cij(N){const Qa=[];var Db=
new ff((new Date).getDate());for(var fc=0;8>fc;fc++)Array.add(Qa,Db.next(N.count));Db=0;for(let vc of N){fc=!1;for(const Rc of Qa)if(Db===Rc){fc=!0;break}Db++;if(fc){let Rc;(Rc=vc.addinInfo).AUP=20*Rc.AUP}else if(1===vc.addinInfo.priority){let Rc;(Rc=vc.addinInfo).AUP=4*Rc.AUP}else if(2===vc.addinInfo.priority){let Rc;(Rc=vc.addinInfo).AUP=2*Rc.AUP}}N.Sc((vc,Rc)=>vc.addinInfo.AUP<Rc.addinInfo.AUP?1:-1);return N}dij(N){for(let Qa of N)if(1===Qa.addinInfo.priority){let Db;(Db=Qa.addinInfo).AUP=4*Db.AUP}else if(2===
Qa.addinInfo.priority){let Db;(Db=Qa.addinInfo).AUP=2*Db.AUP}N.Sc((Qa,Db)=>Qa.addinInfo.AUP<Db.addinInfo.AUP?1:-1);return N}rca(N,Qa){const Db={};Db.width=N;Db.height=Qa;Db.backgroundColor="transparent";return Db}Jad(){return{flexDirection:"column"}}cbd(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}P6h(){const N=
{},Qa={},Db={};Qa.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Qa.inner={margin:"-4px"};Db.root=this.rca(100,100);Db.flexContainer=this.Jad();Db.label=this.Dnc?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.cbd();N.galleryButtonInExpanded=Db;N.galleryStack=Qa;return N}OYh(){return Object.assign(new Pf.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.wNg,
LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}JXh(N,Qa,Db){const fc={},vc={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"};hc.AFrameworkApplication.isRtl&&(vc.direction=
"ltr");fc.root=vc;return Object.assign(new Pf.a,{Id:Db,ExternalId:Db,Icon:"AddinFlyoutControl"+Qa.solutionId,Command:N===CommonUIStrings.l_PopularAddins?this.UJg:this.WJg,LabelText:Qa.displayName,FullIconStyle:fc,Alt:Qa.description})}ojj(N,Qa,Db){const fc=Object.assign(new We,{SectionId:N,Title:N,GalleryButtons:[]});for(let vc=0;vc<Db;vc++)Array.add(fc.GalleryButtons,this.JXh(N,Qa[vc],this.RQc[Qa[vc].solutionId]));return fc}jci(){var N=[];const Qa=this.Rkb.gAb(0);Array.addRange(N,Qa.FK);const Db=
this.Rkb.gAb(1);Array.addRange(N,Db.FK);let fc=N.length;this.oGa=0<fc?5:6;hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&n.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",fc,vf.a[Qa.errorCode],Qa.FK.length,vf.a[Db.errorCode],Db.FK.length);N.sort((Fe,Ne)=>{Fe=Vg.d(Fe.displayName);Ne=Vg.d(Ne.displayName);return fg.a.localeCompare(Fe,Ne)});const vc=6<fc;vc&&(fc=5);for(var Rc=0;Rc<
fc;Rc++)this.qFe(N[Rc]);let cd=[];Rc=null;this.Cy?cd=this.Cy:(Rc=this.Rkb.gAb(2),0===Rc.errorCode&&Rc.FK.forEach(Fe=>{-1!==Fe.addinInfo.priority&&(this.qFe(Fe),cd.push(Fe))}));Rc=!0;cd.length||(Rc=!1);let dd=0;if(Rc&&(dd=N.length?3>=N.length?9:6:12,cd=this.Dnc?this.O1g(cd,N):this.N1g(cd,N),dd>cd.length&&(dd=cd.length),hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.goe&&!this.Dnc)){var Hd="",Zd="";for(let Fe=0;Fe<cd.length&&
Fe<dd;Fe++)Hd+=cd[Fe].displayName,Hd+=",",Zd+=cd[Fe].solutionId,Zd+=",";n.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",dd,Hd,Zd);this.goe=!0}Hd=Object.assign(new he.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Zd=Object.assign(new wh.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Hd.ControlList,Zd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",
CommonUIStrings.l_AddinPickerButtonMore));Hd=Object.assign(new hi.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Hd,UpdateDynamically:!0});2!==Qa.errorCode||N.length?3===Qa.errorCode&&3===Db.errorCode?(n.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),N=this.G6e("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Hd.MenuSectionList,N)):(0<fc?this.dOe(Hd,N,fc,"MRUAddins",CommonUIStrings.l_MyAddinSection,vc):this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(N=this.kXh(),Array.add(Hd.MenuSectionList,N),n.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),Rc&&(this.Dnc?(Array.add(Hd.MenuSectionList,this.DYh(cd,this.oGa)),N=[],this.Atg(N),appChrome.api.dispatch(N),this.bob=this.Cy.length<this.oGa?this.Cy.length:this.oGa):this.dOe(Hd,cd,dd,"PopularAddins",CommonUIStrings.l_PopularAddins))):(n.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),N=this.G6e("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Hd.MenuSectionList,
N));return Hd}$3j(){if(!(this.oGa>=this.Cy.length)){var N=[];for(let Qa=0;Qa<this.oGa;Qa++)this.Dke["PopularAddInsListItem"+Qa]=this.Cy[Qa].solutionId,this.Lck(N,Qa.toString(),this.Cy[this.bob]),this.bob===this.Cy.length-1?this.bob=0:this.bob++;this.Atg(N);appChrome.api.dispatch(N)}}Atg(N){6>this.oGa?N.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):N.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}DYh(N,Qa){const Db=Object.assign(new he.a,
{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let fc=0;fc<0+Qa&&fc<N.length;fc++)this.Dke.PopularAddInsListItem0=N[fc].solutionId,this.fXh(Db.ControlList,fc.toString(),N[fc]);N=Object.assign(new tf,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"RefreshGreen_20",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1});Array.add(Db.ControlList,
N);return Db}fXh(N,Qa,Db){Qa=this.pPe(Qa,Db);Array.add(N,Qa)}Lck(N,Qa,Db){Db=this.pPe(Qa,Db);const fc={};fc.label=Db.Label;fc.secondaryLabel=Db.SecondaryLabel;fc.description=Db.Description;fc.iconSet=Db.iconSet;fc.links=Db.Links;this.Cnc&&(fc.details=Db.Details);fc.commandValueId=Db.CommandValueId;fc.actionCommandValueId=Db.ActionCommandValueId;N.push(appChrome.actions.updateMultiActionButton("PopularAddInsListItem"+Qa,fc))}pPe(N,Qa){let Db="";if(this.wxd||this.Cnc){var fc=Qa.addinInfo.downloadNumber;
5E6<=fc?(fc=5E6,Db=fc.toLocaleString()+"+"):1E3<=fc?(fc=1E3*Math.round(fc/1E3),Db=fc.toLocaleString()+"+"):0<fc&&(fc=1E3,Db="<"+fc.toLocaleString());this.wxd&&(Db="\u2b73 "+Db);0>=fc&&(Db=CommonUIStrings.l_AddinDownloadNewText)}fc=[];const vc=[];if(this.Cnc){var Rc=Object.assign(new xg,{icon:Db===CommonUIStrings.l_AddinDownloadNewText?null:"download",text:Db});Array.add(vc,Rc);Rc=Object.assign(new xg,{text:this.Ta.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinListStoreLabel",CommonUIStrings.l_AddinListStore2),
href:"https://appsource.microsoft.com/en-us/product/office/"+Qa.solutionId});Array.add(vc,Rc)}else Rc=Object.assign(new Zf,{text:CommonUIStrings.l_AddinListPrivacy,href:Qa.privacyUrl}),Array.add(fc,Rc),Rc=Object.assign(new Zf,{text:CommonUIStrings.l_AddinListLicense,href:Qa.licenseUrl}),Array.add(fc,Rc),Rc=Object.assign(new Zf,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Qa.solutionId}),Array.add(fc,Rc);Rc={};Rc["default"]="AddinFlyoutControl"+
Qa.solutionId;const cd=this.x6e(Qa);return Object.assign(new ig.a,{Id:"PopularAddInsListItem"+N,ExternalId:"PopularAddInsListItem"+N,CommandId:"PopularAddInsListItem"+N,iconSet:Rc,SecondaryLabel:this.wxd&&!this.Cnc?"("+Db+")":null,Details:vc,Label:Qa.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:Qa.description,Links:fc,ActionId:"PopularAddInsListItemAdd"+N,ActionCommandValueId:cd,CommandValueId:cd})}x6e(N){return this.Nnc?String.format("{0}#{1}",N.solutionId,N.storeId):N.solutionId}g7a(N){if(!N)return null;
var Qa=N.split("#");if(1!==Qa.length&&2!==Qa.length)return n.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;N=Qa[0].trim();Qa=2===Qa.length?Qa[1].trim():hc.AFrameworkApplication.uiCulture;return this.Rkb.fAb(N,Qa)}qFe(N){if(!(N.solutionId in this.RQc)){const Qa="AddinGalleryButton"+this.cge.toString();this.RQc[N.solutionId]=Qa;N=this.x6e(N);this.RYb[Qa]=N;this.RYb[Qa+"Add"]=N;this.cge++}}Cff(N){return N?this.RYb[N]:null}kXh(){const N=Object.assign(new he.a,
{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),Qa=Object.assign(new Xf.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",LabelText:this.Ta.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(N.ControlList,Qa);return N}G6e(N,Qa){const Db=Object.assign(new he.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});N=Object.assign(new Qc.a,
{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:N,Label:Qa,RetryButtonTitle:CommonUIStrings.l_AddinPickerTryAgain,OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===N?Qa:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(Db.ControlList,N);return Db}N1g(N,Qa){var Db=new h.a;for(let fc=0;fc<N.length;fc++)Db.add(N[fc]);this.Cy||(8<Db.count&&(Db=this.cij(Db)),this.Cy=Db.toArray());for(N=0;N<this.Cy.length;N++)for(Db=0;Db<Qa.length;Db++)if(this.Cy[N].solutionId.toLowerCase()===
Qa[Db].solutionId.toLowerCase()){Array.remove(this.Cy,this.Cy[N--]);break}return this.Cy}O1g(N,Qa){var Db=new h.a;for(let fc=0;fc<N.length;fc++)Db.add(N[fc]);this.Cy||(8<Db.count&&(Db=this.dij(Db)),this.Cy=Db.toArray());for(N=0;N<this.Cy.length;N++)for(Db=0;Db<Qa.length;Db++)if(this.Cy[N].solutionId.toLowerCase()===Qa[Db].solutionId.toLowerCase()){Array.remove(this.Cy,this.Cy[N--]);break}return this.Cy}dOe(N,Qa,Db,fc,vc,Rc=!1){const cd=Object.assign(new he.a,{Id:fc+"Section",ControlsId:fc+"Section.Controls",
ControlList:[]});fc=Object.assign(new vd.a,{Id:fc+"GalleryControl",ExternalId:fc+"GalleryControl",GalleryStyle:this.P6h(),Width:3,Type:4,GallerySections:[]});Array.add(N.MenuSectionList,cd);Array.add(cd.ControlList,fc);N=this.ojj(vc,Qa,Db);Rc&&Array.add(N.GalleryButtons,this.OYh());fc.GallerySections.push(N)}sjj(N){if(N)try{N.MenuItems=this.jci()}catch(Qa){n.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(Qa?Qa.toString():""))}else n.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}DQi(){if(!this.sge&&
this.FCc){var N=appChrome.selectors.getSelectedTabId();N&&Vg.a(N,"Home")&&((N=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(N,"").display||n.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.sge=!0)}}get FCc(){return!!window.appChrome&&!!appChrome.selectors}}Object(e.a)(Hh,"AppsFlyoutGenerator",null,[2]);var xh=a(71),$h=a(100),ai=a(149),bi=a(36);class ci{constructor(N,Qa,Db,fc,vc,Rc,cd=null){this.disposed=!1;this.Z4b=null;this.nsb=0;this.Kqf=this.O_d=
!1;this.JUh=1E3;this.OUh="AddinFlyoutFeedbackSurvey";this.PUh=15E3;this.w_d=!0;this.Hji=(dd,Hd)=>{if(dd){if(dd=this.g7a(dd))dd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(dd.solutionId,dd.storeType,dd.assetId,dd.storeId)},dd.href=Hd,jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:wc.a.Yh(dd)}))}else n.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.gli=dd=>{if(this.uba.Nnc){dd=this.g7a(dd);if(!dd){n.ULS.sendTraceTag(508872144,
220,10,"Fail to get a valid AddinDetail with provided unique id.");return}dd=dd.XTb()}else dd=this.Gaf(dd);if(dd){var Hd={[da.a.jja]:dd,[Ib.a.Bg]:this.me.bwa(dd)},Zd=new ye.a(-741808261,0,this.$.Kc,0,"");this.$.Ia.$b(Zd,Hd);this.me.dLb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,dd);dd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(dd.solutionId,dd.storeType,dd.assetId,dd.storeId)};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",
dataFields:wc.a.Yh(dd)}))}else n.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")};this.Qhf=dd=>{if(dd)if(dd=this.g7a(dd)){var Hd=this.me.Lf;Hd=Hd?Hd.getAppUILocale()||"en-US":"en-US";this.Z4b=new Ge(dd.solutionId,"wac_excel",Hd,Zd=>{this.me.dLb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Zd);const Fe=new ye.a(-741808261,0,this.$.Kc,0,null);this.$.Ia.$b(Fe,{[da.a.jja]:Zd,[Ib.a.Bg]:this.me.bwa(Zd)});this.Z4b&&this.Z4b.hide();y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",
!0)&&(Zd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Zd.solutionId,Zd.storeType,Zd.assetId,null,null,Zd.storeId),jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:wc.a.Yh({SolutionId:Zd})})))});this.Z4b.initializeAndShow("",null,null)}else n.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else n.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};this.kli=dd=>{if(dd){if(this.uba.Nnc){dd=
this.uba.Cff(dd);if(!dd){n.ULS.sendTraceTag(508872142,220,10,"Can not find a valid uniqueId with control id.");return}dd=this.uba.g7a(dd);if(!dd){n.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}dd=dd.XTb()}else{dd=this.uba.Sjh[dd];if(!dd){n.ULS.sendTraceTag(509362326,220,10,"SolutionId is null.");return}dd=this.Gaf(dd);if(!dd){n.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}}var Hd={[da.a.jja]:dd,[Ib.a.Bg]:this.me.bwa(dd)},
Zd=new ye.a(-741808261,0,this.$.Kc,0,"");this.$.Ia.$b(Zd,Hd);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(dd=Telemetry.PrivacyRules.GetPrivacyCompliantId(dd.solutionId,dd.storeType,dd.assetId,null,null,dd.storeId),jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:wc.a.Yh({SolutionId:dd})})))}else n.ULS.sendTraceTag(509362327,220,10,"Control id is null.")};this.g7a=dd=>
this.uba.Nnc?this.uba.g7a(dd):this.iba.fAb(dd);this.M0i=(dd,Hd)=>{if(Hd)if(Hd)if(dd=Hd.Rk){if(eh()||qh()){const Fe=this.$.ea.workbookContext.WebExtensions;if(Fe){let Ne=!1;for(var Zd of Fe)if(Zd.PrimaryMarketplace.SolutionId.toLowerCase()===dd.solutionId.toLowerCase()){Ne=!0;break}if(!Ne){n.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{n.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Hd=Hd.Vo;Zd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();
if(dd.solutionId in Zd)Hd=Zd[dd.solutionId];else if(Hd=this.Q2h(Hd),void 0===Hd||null===Hd){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Zd=new ye.a(Ze.a.y4,0,0,2,null);this.executeCommand(0,Zd,{["SourceControlId"]:Hd},null);dd.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.dnf=
(dd,Hd)=>{"Insert"==Hd.tabName&&(dd=this.$.Ia,null!=dd&&(dd.h5f(this.dnf),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.ETb.pZj())};this.x8i=(dd,Hd)=>{dd=null;Hd&&(dd=Hd);(null===dd||void 0===dd?0:dd.Vo)&&this.HPj(dd.Vo);this.$.Wf();dd&&dd.Rk&&this.k4g(dd.Rk)};this.Kck=(dd,Hd)=>{Hd.hI===qa.a.myAddins&&(this.nsb|=1);Hd.hI===qa.a.adminManaged&&(this.nsb|=2);this.vgg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};
this.$=N;n.ULS.shipAssertTag(537170659,0,!(void 0===Qa||null===Qa),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Ad.a.w_()}`);this.me=Qa;this.bNe=Db;this.X4b=fc;this.hba=vc;this.rsb=Rc;this.Tp=new K.a;this.ija=new kf;this.Uhd=cd;Xb.a.dDb=Xb.a.O1e;this.Vcd=new h.a;this.o5a=new h.a;this.b3c&&(this.O_d=hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1),this.iba=this.me.iba,null!==this.iba?(this.uba=new Hh(hc.AFrameworkApplication.Qb,
this.iba,Ze.a.wqc.toString(),Ze.a.Bqc.toString(),"1296389134",hc.AFrameworkApplication.fa),this.iba.rfb(this.Kck)):n.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get b3c(){return hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}dispose(){void 0!==this.rsb&&null!==this.rsb&&(this.rsb.dispose(),this.rsb=
null);this.me=this.$=null;this.disposed=!0}YTj(N,Qa){switch(N){case Ze.a.y4:N=this.HTj(Qa);break;default:N=!1}return N}hd(N,Qa){return 619219938===Qa?!this.vgg():!1}executeCommand(N,Qa,Db){N=ab.TaskExtensions.zk();Qa=Qa.command;switch(Qa){case 843847158:break;case Ze.a.wqc:this.Cfb();Db=Db.SourceControlId;if(!Db){n.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break}this.Qhf(this.uba.Cff(Db));break;case Ze.a.LBd:this.Cfb();Qa=Db.CommandValueId;"LinkClickedPayload"===Db.Type?this.Hji(Qa,
Db.Href):this.Qhf(Qa);break;case Ze.a.b3d:this.Cfb();this.uba.$3j();break;case Ze.a.Hud:this.Cfb();this.gli(Db.CommandValueId);break;case Ze.a.Bqc:this.Cfb();this.kli(Db.SourceControlId);break;case -2025863019:Ud.a.M_d(Db[da.a.a3c].toString(),()=>{Od.h(this.$).focus()});break;case -1777565636:Ec.a.showUILessDialog(Db[da.a.tsb].toString());this.me.iXj(Db[da.a.tsb].toString());break;case 1592314317:Ec.a.hideUILessDialog(Db[da.a.tsb].toString());this.me.Qoi(Db[da.a.tsb].toString());break;case Ze.a.y4:N=
this.Iqd(Db);break;case Ze.a.EHb:this.FHb(Db);break;case Ze.a.$G:this.wnj(Db);break;case Ze.a.Mpa:this.Mpa(Db);break;case Ze.a.QEc:this.rsb.fFc();break;case Ze.a.refreshAddinCommands:this.Bsj();break;case 1949669462:this.hba.$cg(!0);break;case -1014260128:N=this.executeDynamicAddInCommandsAPI(Db);break;case Ze.a.sjb:this.sjb();break;default:N=bd.a(Qa)}return N}Tc(N,Qa,Db){N=!1;switch(Qa.command){case Ze.a.LBd:case Ze.a.b3d:case Ze.a.Hud:case Ze.a.wqc:case Ze.a.Bqc:N=!!Db;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case Ze.a.$G:case Ze.a.Mpa:case Ze.a.QEc:case Ze.a.refreshAddinCommands:case 1949669462:case Ze.a.EHb:case -1014260128:case Ze.a.sjb:N=
!0;break;case Ze.a.y4:N=!hc.AFrameworkApplication.protectedFile}return N}vgg(){return 0!==this.nsb&&this.$.cV&&!y.EwaSettings.ya(174)}ld(N,Qa,Db){switch(Qa){case "PopulateAddInGallery":return y.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:wc.a.Yh({})})),this.uba.sjj(Db),this.O_d&&(this.Cfb(),this.LLi()),!0;default:return!1}}LLi(){Pc.a.instance.getItem("AddinFlyoutSurveyShowed")&&
(this.w_d=!1);this.w_d&&(window.setTimeout(()=>{let N=this.J$e();N&&"hidden"!==N.visibility&&(this.Kqf=!0)},this.JUh),this.gwj=window.setTimeout(()=>{this.Qmg=me.a.instance.qc("Common.ISystemInitiatedFeedback");this.Kqf&&this.Qmg&&this.Qmg.execute(N=>{let Qa=this.J$e();Qa&&"hidden"===Qa.visibility&&(N.cib(this.OUh,null),this.w_d=!1,Pc.a.instance.setItem("AddinFlyoutSurveyShowed","1"))})},this.PUh))}J$e(){let N=null;try{const Qa=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");Qa&&(N=zd.a.uA(Qa.parentNode.parentNode.parentNode))}catch(Qa){n.ULS.sendTraceTag(508911886,
220,10,"AddinFlyout get parent and parent get exception "+(Qa?Qa.toString():""))}return N}Cfb(){this.O_d&&window.clearTimeout(this.gwj)}Q2h(N){if(!N)return n.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((N=N.BX)&&N.ou&&0<N.ou.count)for(let Qa of N.ou){if(Qa.groups&&1===Qa.groups.length){N=Qa.groups[0];if(N.controls&&1===N.controls.length){const Db=N.controls[0];if(Db.attributes&&!Db.controlType&&Db.enabled)return Db.id}N.controls&&n.ULS.sendTraceTag(528098403,220,
15,"It has multiple buttons")}Qa.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}wnj(N){N&&da.a.TQ in N?this.$G(N[da.a.TQ],!0):n.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}$G(N,Qa=!1){this.me?(n.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",N,Qa),this.me.$G(N,Qa)):n.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}Bsj(){if(this.hba.Vqc()){this.hba.xJe();
var N=this.pld();if(N&&0<N.count)for(let Qa of N)N={[da.a.TQ]:Qa,[da.a.mN]:4,[da.a.gJa]:(new Date).getTime()},this.Mpa(N)}else hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(n.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.hba.Vqc()),this.$G(10,!0),this.$G(0,!0))}Mpa(N){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${N[da.a.mN]}, DataProvider ${N[da.a.TQ]}.`);
this.hba.ELj();window.setTimeout(()=>{if(void 0===this.me||null===this.me)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Ad.a.w_()}`);else{const Qa=new H(new va(this.me.Lf),lb.instance,rd.instance);Qa.EVg((Db,fc)=>{hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.$G(N[da.a.TQ]);this.FHb(fc.properties)});hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Qa.ZYg((Db,fc)=>{null==fc?jc.a.sendTelemetryEvent(Object(Ed.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wc.a.Yh({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.ETb=new Cc(this),this.ETb.Nuj(fc),Db=this.$.Ia,null!=Db&&(Db.Yye(this.dnf),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Qa.sak(N)}},0)}sjb(){if(this.Hyi)if(void 0===this.me||
null===this.me)n.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const N=new Id(this.me.Lf);N.yXg(()=>{this.OBd()});N.p5d()}}get Hyi(){return!y.EwaSettings.ya(174)&&this.$.ea.oh.get(27)&&this.$.cV}OBd(){const N=document.getElementById("InsertAddInFlyout");if(null===N||void 0===N||"none"===window.getComputedStyle(N).display){const Qa=document.getElementById("RibbonOverflowMenu-overflow");null!=Qa?(Qa.onclick=function(){const Db=new ce.a(0,1,500,()=>{const fc=document.getElementsByName("Add-ins")[0];
null!=fc&&(fc.click(),n.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});hc.AFrameworkApplication.Mi.jg(Db);Qa.onclick=function(){}},Qa.click()):n.ULS.sendTraceTag(509677591,220,10,"Cannot find flyout button on ribbon or overflow button")}else N.click(),n.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}FHb(N){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${N[da.a.mN]}.`);try{if(y.EwaSettings.ya(174)){const Db=N[da.a.osb];if(Db&&0<Db.count){const fc=
Db.count;for(let vc=fc-1;0<=vc;vc--){const Rc=Db.ma(vc);OSF.OsfControl.isFirstPartyStoreString(Rc.storeType)||Db.remove(Db.ma(vc))}if(Db.count<fc){const vc=Object(xh.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object($h.d)(ai.a.resolve(bi.h,{Wa:0})):mc.GetServiceTaskFactory.Za(this.$.da,5,4,0);ab.TaskExtensions.za(vc,()=>{vc.result.zh(36,null)},this.$.ka,3)}if(!Db.count)return}}if(void 0===this.me||null===this.me)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Ad.a.w_()}`);
else{var Qa=null;Qa=hc.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled")?new mh(this.Tp,this.bNe,new va(this.me.Lf),new mi(this.$.fc,Ze.a.y4),this.hba,lb.instance,this.ija,(Db,fc)=>{const vc={};vc.InstanceId=we.a.create().toString();vc.PrimaryMarketplace={};vc.PrimaryMarketplace.SolutionId=Db.solutionId;vc.PrimaryMarketplace.SolutionVersion=Db.version;vc.PrimaryMarketplace.MarketplaceType=Db.storeType;vc.PrimaryMarketplace.MarketplaceRef=Db.storeId;vc.WebExtensionType=1;this.me.vZj(vc,()=>
{fc(Db)})}):new mh(this.Tp,this.bNe,new va(this.me.Lf),new mi(this.$.fc,Ze.a.y4),this.hba,lb.instance,this.ija);Qa.MVg(this.M0i);Qa.FVg(this.x8i);if(hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){const Db=new Cc(this);Qa.xXg(Db.w8i);Qa.YYg(Db.XWj)}this.$.da.Ba(53).pq&&De.a.get_instance().wj(5,null).continueWith(()=>{this.disposed||Qa.oMi(this.Uhd,this.$.domElement,N)})}}catch(Db){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Db.message}.`)}}}Iqd(N){const Qa=
ab.TaskExtensions.zk();N=N[this.Tp.lka];const Db=this.X4b.z0c(N),fc=new Ec.a(this.$,this.me,Db.ownerAddinInfo,Qa);return this.Tgf(Qa,N,Db,fc)}Tgf(N,Qa,Db,fc){this.X4b.Iqd(Qa,this.hba,fc,new va(this.me.Lf),Db,()=>{N=fc.Wih()},()=>{Od.h(this.$).focus()});return N}k4g(N){const Qa=ab.TaskExtensions.zk();var Db=this.me.$ca(N.solutionId);if(Db){var fc=this.me.gW(Db);if(Zc.HelperMethods.Mx(fc)&&0!==fc.SharedRuntime.State)return}fc=this.X4b.l4g;const vc=N.solutionId in fc?fc[N.solutionId]:null;if(vc){const Rc=
this.X4b.z0c(vc),cd=new Ec.a(this.$,this.me,Rc.ownerAddinInfo,Qa),dd=Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,null!==Rc.ownerAddinInfo?Rc.ownerAddinInfo.storeType:N.storeType,N.assetId,null,null,N.storeId);fc=Hd=>{if(Hd){const Zd={};for(const Fe of Hd)Zd[Fe[0]]=Fe[1];(Hd=da.a.eze in Zd?Zd[da.a.eze]:null)&&"true"===Hd.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${N.storeType}, StoreId ${N.storeId}, SolutionId ${dd}.`),this.Tgf(Qa,
vc,Rc,cd))}};n.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${N.storeType}, StoreId ${N.storeId}, SolutionId ${dd}.`);if(Db)fc(this.me.gW(Db).OsfPropertyBag);else if(Db=this.$.ea.workbookContext.WebExtensions)for(const Hd of Db)if((1===Hd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===N.targetType&&Hd.PrimaryMarketplace.MarketplaceType.toLowerCase()===N.storeType.toLowerCase()&&Hd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===
N.storeId.toLowerCase()&&Hd.PrimaryMarketplace.SolutionId.toLowerCase()===N.solutionId.toLowerCase()){fc(Hd.OsfPropertyBag);break}}}g3d(N,Qa,Db=!1){N&&(!Db||Qa||this.Vcd.contains(N)||this.Vcd.add(N),(Db=this.o5a.contains(N))&&Qa&&this.o5a.remove(N),Db||Qa||this.o5a.add(N))}HPj(N){if((N=N.BX)&&N.ou)for(let Qa of N.ou)if(Qa.groups)for(const Db of Qa.groups)if(Db.controls)for(const fc of Db.controls)if(this.g3d(fc.id,fc.enabled,!0),1===fc.controlType&&fc.menuItems)for(const vc of fc.menuItems)this.g3d(vc.id,
vc.enabled,!0)}pld(){const N=new h.a;y.EwaSettings.ya(52)&&(this.$.ea.oh.get(27)&&(N.add(0),N.add(16)),this.$.ea.oh.get(33)&&N.add(1),N.add(8));return N}executeDynamicAddInCommandsAPI(N){let Qa=!0;if(void 0===N||null===N||void 0===N[da.a.byb]||null===N[da.a.byb])return ke.Task.Ua(!1);switch(N[da.a.byb]){case 1:Qa=this.Gdk(N);break;case 2:Qa=this.LPj(N);break;case 4:this.o5a.clear();this.o5a.addRange(this.Vcd);break;case 3:Qa=this.installContextualTab(N);break;default:Qa=!1}return ke.Task.Ua(Qa)}HTj(N){return N&&
this.Tp.lka in N?(N=N[this.Tp.lka])?this.o5a.contains(N):!1:!1}Gdk(N){var Qa=null;let Db=null,fc=null,vc=!0;void 0!==N[da.a.X5]&&null!==N[da.a.X5]&&void 0!==N[this.Tp.lka]&&null!==N[this.Tp.lka]&&void 0!==N[da.a.W5]&&null!==N[da.a.W5]&&(Qa=N[da.a.X5],Db=N[da.a.Occ],fc=N[this.Tp.lka],vc=N[da.a.W5]);if(!Qa||!fc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;N=(new ki.a(this.$.fc,Qa,this.Tp,!0)).xNa(fc);Qa={DynamicAddinCommandsApiName:"UpdateControlEnableState"};
Qa.AssetId=Db;Qa.MaskedTabId=N;Qa.IsToEnable=vc;n.ULS.sendTraceTag(537170648,220,50,v.a.Zc(Qa));this.g3d(N,vc);hd.a.FF.updateCommandUI();return!0}LPj(N){var Qa,Db,fc=null,vc=null;let Rc=null;var cd=null;let dd=!0;void 0!==N[da.a.Ced]&&null!==N[da.a.Ced]&&void 0!==N[da.a.X5]&&null!==N[da.a.X5]&&void 0!==N[this.Tp.lka]&&null!==N[this.Tp.lka]&&void 0!==N[da.a.W5]&&null!==N[da.a.W5]&&(fc=N[da.a.Ced],vc=N[da.a.X5],Rc=N[da.a.Occ],cd=N[this.Tp.lka],dd=N[da.a.W5]);if(!fc||!vc||!cd)return n.ULS.sendTraceTag(537170647,
220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;N=(new ki.a(this.$.fc,vc,this.Tp,!0)).Wef(cd);cd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};cd.StoreType=fc;cd.AssetId=Rc;cd.MaskedTabId=N;cd.IsToShow=dd;n.ULS.sendTraceTag(537170646,220,15,v.a.Zc(cd));fc=this.hba.pla(fc,vc,1);vc=!1;if(null===(Db=null===(Qa=null===fc||void 0===fc?void 0:fc.Vo)||void 0===Qa?void 0:Qa.BX)||void 0===Db?0:Db.ou)for(let Hd of fc.Vo.BX.ou)if(Hd.id===N){vc=!0;break}if(!vc)return n.ULS.sendTraceTag(537170645,
220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Qa=[];dd?appChrome.selectors.getSelectedTabId()!==N&&Qa.push(appChrome.actions.activateRibbonTab(N)):(appChrome.selectors.getSelectedTabId()===N&&Qa.push(appChrome.actions.setCurrentTab(zf.a.bT)),Qa.push(appChrome.actions.deactivateRibbonTab(N)));appChrome.api.dispatch(Qa);return!0}Gaf(N){if(this.iba){if(N=this.iba.fAb(N)){const Qa={};Qa.solutionId=N.solutionId;Qa.version=N.version;Qa.storeType=N.storeType;Qa.storeId=N.storeId;Qa.assetId=
N.assetId;Qa.assetStoreId=N.assetStoreId;Qa.targetType=N.targetType;Qa.displayName=N.displayName;Qa.width=N.width;Qa.height=N.height;return Qa}n.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}n.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(N){let Qa=null,Db=null,fc=null;var vc=null;if(void 0!==N[da.a.X5]&&null!==N[da.a.X5]&&void 0!==N[da.a.W5]&&null!==N[da.a.W5]){const Rc=N[da.a.W5];Qa=N[da.a.X5];void 0!==Rc[da.a.XLa]&&null!==
Rc[da.a.XLa]&&void 0!==Rc[da.a.YLa]&&null!==Rc[da.a.YLa]&&(Db=Rc[da.a.XLa],fc=Rc[da.a.YLa],vc=Rc[da.a.Ded])}if(!(Qa&&fc&&Db&&vc))return n.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;N=this.hba.pla(vc.PrimaryMarketplace.MarketplaceType,vc.PrimaryMarketplace.SolutionId,1);if(null===N||void 0===N?0:N.Vo)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;N={};N.solutionId=vc.PrimaryMarketplace.SolutionId;N.version=
vc.PrimaryMarketplace.SolutionVersion;N.storeType=vc.PrimaryMarketplace.MarketplaceType;N.storeId=vc.PrimaryMarketplace.MarketplaceRef;vc.AssetMarketplace?(N.assetId=vc.AssetMarketplace.SolutionId,N.assetStoreId=vc.AssetMarketplace.MarketplaceRef):(N.assetId=null,N.assetStoreId=null);N.targetType=vc.WebExtensionOsfControlType;N.width=vc.TaskpaneWidth;N.height=0;N.isAddinCommands=!0;vc=new h.a;vc.add(N);N={};N[da.a.osb]=vc;N[da.a.mN]=6;N[da.a.XLa]=Db;N[da.a.YLa]=fc;this.FHb(N);return!0}}Object(e.a)(ci,
"AddinUICommandHandler",null,[203,200,2]);var Gi=a(65);class di{constructor(N=null,Qa=null,Db=null,fc=0){this.NZd=N;this.F0c=Qa;this.Lcd=Db;this.Vyb=fc}Fhb(){return this.NZd()}activate(){return this.F0c()}deactivate(){this.Lcd()}dispose(){this.Lcd=this.F0c=this.NZd=null}}Object(e.a)(di,"FeatureActivator",null,[21,2]);var Eg=a(21),Rh=a(18);class xi extends Pe.a{constructor(N){super(N);this.handler=null;this.rRg=()=>{n.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.$d&
16384)}]`);const Qa=new Te.a;this.$.da.Gb(53,Zd=>{n.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Qa.setResult(Zd)});const Db=Qa.task,fc=new ne,vc=m.a.getInstance(),Rc=new Pb(this.$,vc),cd=mc.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.La),dd=this.jtj(fc),Hd=Object(xh.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object($h.d)(ai.a.resolve(bi.db,{Wa:this.La})):mc.GetServiceTaskFactory.Za(this.$.da,349,350,this.La);
return ab.TaskExtensions.za(ab.TaskExtensions.ke([Db,cd,dd,Hd],this.ka),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");ab.TaskExtensions.za(mc.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.La),Zd=>{this.handler=new ci(this.$,Zd.result,fc,new fe,vc,Rc,me.a.instance.ah("Common.IExternalUICommandDefinitionMapping"));n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.Pd([this.handler]);this.$.da.Ja(198,this.handler)},this.ka,3)},this.ka,3)};this.fuh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.Afb(this.handler),this.$.da.LV(198),this.handler=null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.LV(204);Rh.a(Eg.a,20,this.$.da,198)}}he(){n.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Gi.a(this.$).add(Object(Ed.a)(new di,
{NZd:()=>{const N=this.$.ea.bJ&&this.$.ea.Ec&&!!(this.$.$d&16384)&&this.$.isEditMode;this.$.ea.Ec&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${N}] IsSessionFullyLoaded [${this.$.ea.bJ}] IsSessionActive [${this.$.ea.Ec}] ShowCommandUI [${!!(this.$.$d&16384)}] IsEditMode [${this.$.isEditMode}]`);return N},F0c:this.rRg,Lcd:this.fuh,Vyb:2}))}jtj(N){const Qa=mc.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.La);
return ab.TaskExtensions.za(Qa,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ja(204,new Tf(Qa.result,N))},this.ka,3)}static la(N){Pe.a.ye(199,new xi(N))}}Object(e.a)(xi,"AddinUICommandHandlerFactory",Pe.a,[]);var Kh=a(1239),hj=a(1243),ni=a(725);class Ch extends d.a{constructor(N){super();this.$=N;this.kc()}create(){let N;if(y.EwaSettings.ya(355)){const Qa=mc.GetServiceTaskFactory.create(this.$.da,
106,this.$.ka,this.La);let Db=Object($h.d)(ai.a.resolve(bi.U,{Wa:this.La}));ab.TaskExtensions.za(ke.Task.BH(Qa,Db),()=>{this.Pb(Object(ni.a)(this.$.da,278,()=>new Kh.CustomFunctionsInstaller(this.$,Qa.result,Db.result)))},this.$.ka,3)}else N=Object(ni.a)(this.$.da,278,()=>new hj.CustomFunctionsLegacyInstaller(this.$)),this.Pb(N)}static la(N){N.da.Ja(279,new Ch(N))}}Object(e.a)(Ch,"CustomFunctionsInstallerFactory",d.a,[]);var oi=a(92),of=a(51),Sh=a(48);class jh{constructor(N,Qa){this.xTa=this.yTa=
null;this.Qpg=(Db,fc)=>{let vc=null,Rc=null,cd=null;fc?(Object(R.a)(457,fc)?(vc=fc.pJa,cd=fc.instanceId):Object(R.a)(243,fc)&&(vc=fc.get_element(),cd=fc.instanceId),vc)?(Rc=Object(Y.a)(691,Db),Rc)?this.J0f(cd,vc,Rc)||cd in this.xTa||(this.yTa[cd]=0,this.xTa[cd]=of.a.instance.ZD(()=>{10<=this.yTa[cd]||this.J0f(cd,vc,Rc)?(delete this.yTa[cd],this.xTa[cd].dispose(),delete this.xTa[cd]):this.yTa[cd]+=1},500,Sh.a.p_g,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):
n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=N;this.$=Qa;this.Q4c=!1;this.$.da.Ja(224,this)}la(N){this.Q4c?n.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.Q4c=!0,this.xTa={},this.yTa={},N?N.pWg(this.Qpg):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(N){if(N){N.Dxj(this.Qpg);
N=this.xTa;for(let Qa in N)oi.a.Ka(N[Qa]);this.yTa=this.xTa=null;this.Q4c=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}J0f(N,Qa,Db){if(this.kyi(Db,N))return!1;N=Qa.querySelector("iframe");if(!N)return n.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;N=N.title;if(!N||!N.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(N);return!0}kyi(N,Qa){return(N=N.Lf.getOsfControl(Qa))?N.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(e.a)(jh,"AgaveOnSelectedReadoutHandler",null,[692]);class Tg extends d.a{constructor(N){super();this.$=N;this.kc()}create(){const N=this.$.da;ab.TaskExtensions.za(mc.GetServiceTaskFactory.Za(N,211,212,this.La),Qa=>{Qa=N.Ba(224)||new jh(Qa.result,this.$);this.Pb(Qa)},this.ka,3)}static la(N){N.da.Ja(225,new Tg(N))}}Object(e.a)(Tg,"AgaveOnSelectedReadoutHandlerFactory",
d.a,[]);var qg=a(765),pi=a(54);const qi=(N,Qa)=>pi.a.ACd(67,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,hc.AFrameworkApplication.fa.oe("MaxRetriesForLoadingScript",0),N,Qa);var Ui=a(249);class ri{constructor(N,Qa,Db){this.iframe=N;this.onSuccess=Qa;this.onError=Db;$addHandler(window,"message",Object(Sb.a)(this,this.dif,"handleResponse"))}dif(N){try{if(N&&N.rawEvent&&N.rawEvent.origin&&this.iframe&&this.iframe.id){var Qa=this.NUf(N.rawEvent.origin);const Db=this.NUf(document.domain);
if(L.a.Ah().equals(Db,Qa))if(N.rawEvent.source&&N.rawEvent.source.frameElement&&N.rawEvent.source.frameElement.id&&L.a.Ah().equals(N.rawEvent.source.frameElement.id,this.iframe.id)){Qa=null;try{Qa=JSON.parse(N.rawEvent.data)}catch(fc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",fc.message)}Qa?(Qa.statusCode!==Ui.a.hK||void 0!==Qa.error&&Qa.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
Qa.statusCode,Qa.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Qa.authorizationCode?Qa.authorizationCode:Qa.signInUrl)),$removeHandler(window,"message",Object(Sb.a)(this,this.dif,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,
344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Db){n.ULS.sendTraceTag(23707649,
344,10,"Exception in authentication proxy message handler: {0}.",Db.message)}}NUf(N){let Qa="";try{N&&(Qa=-1<N.indexOf("//")?N.split("/")[2]:N.split("/")[0])&&(Qa=Qa.split(":")[0],Qa=Qa.split("?")[0])}catch(Db){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Db.message)}return Qa}static la(N,Qa,Db){new ri(N,Qa,Db)}}Object(e.a)(ri,"ResponseHandler",null,[]);var si=a(264);class sh{constructor(N){this.CIa=N}tryAuthenticate(N,Qa){this.Xdb(sh.gIg,()=>{N()},Qa)}tryAuthorize(N,
Qa){this.Xdb(sh.pDg,N,Qa)}getSignInUrl(N,Qa){this.Xdb(sh.tre,N,Qa)}signOut(N,Qa){this.Xdb(sh.iOg,N,Qa)}Xdb(N,Qa,Db){var fc=new si.QueryStringBuilder("AuthenticationProxyHandler.aspx");fc.Kj("responseType",N);hc.AFrameworkApplication.Z0a(fc);fc=String.format("{0}{1}&{2}",this.CIa,fc.toString(),hc.AFrameworkApplication.ej);const vc=document.createElement("iframe");vc.setAttribute("id","privateCatalogIframe");vc.setAttribute("name","privateCatalogIframe");vc.setAttribute("style","display: none");L.a.Ah().equals(N,
sh.tre)||vc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");ri.la(vc,Qa,Db);vc.setAttribute("src",fc);document.body.appendChild(vc)}}sh.pDg="authcode";sh.gIg="identitytoken";sh.tre="signinurl";sh.iOg="signout";Object(e.a)(sh,"AuthenticationProxy",null,[]);class Ag{}Ag.getUserId="getUserId";Ag.getLastStoreUpdate="laststoreupdate";Ag.getEntitlement="getEntitlements";Ag.getEToken="getEToken";Ag.getManifest="getManifest";Ag.getAppState="getAppState";
Ag.getKilledApps="getRemovedAddins";Ag.getAppDetails="getAppDetails";Ag.removeApps="removeAddin";Ag.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Ag.getPrivateCatalogAddIns="getAddIns";Ag.getPrivateCatalogManifests="getAppManifests";Ag.isStoreDisabled="isStoreDisabled";Object(e.a)(Ag,"S2SWebRequestActions",null,[]);var Hi=a(588);class ti{getUserId(N,Qa){const Db=new h.a;Db.add(new Ue.a("corr",N));this.qY(Ag.getUserId,Db,1,Qa)}getLastStoreUpdate(N,Qa,Db){const fc=new h.a;fc.add(new Ue.a("lc",
N));fc.add(new Ue.a("corr",Qa));this.qY(Ag.getLastStoreUpdate,fc,1,Db)}getEntitlement(N,Qa,Db,fc){N=new h.a;N.add(new Ue.a("av",Qa));N.add(new Ue.a("corr",Db));this.qY(Ag.getEntitlement,N,1,fc)}getEToken(N,Qa,Db,fc,vc,Rc){const cd=new h.a;cd.add(new Ue.a("cmu",N));cd.add(new Ue.a("cmf",Qa));cd.add(new Ue.a("assetid",Db));cd.add(new Ue.a("expver",fc));cd.add(new Ue.a("corr",vc));this.qY(Ag.getEToken,cd,1,Rc)}getManifest(N,Qa,Db,fc){const vc=new h.a;vc.add(new Ue.a("cmu",N));vc.add(new Ue.a("assetid",
Qa));vc.add(new Ue.a("corr",Db));this.qY(Ag.getManifest,vc,1,fc)}getAppState(N,Qa,Db){const fc=new h.a;fc.add(new Ue.a("ma",N));fc.add(new Ue.a("corr",Qa));this.qY(Ag.getAppState,fc,1,Db)}getKilledApps(N,Qa){const Db=new h.a;Db.add(new Ue.a("corr",N));this.qY(Ag.getKilledApps,Db,1,Qa)}getAppDetails(N,Qa,Db,fc){const vc=new h.a;vc.add(new Ue.a("cmo",N));vc.add(new Ue.a("corr",Db));this.sendWithBody(Ag.getAppDetails,vc,Qa,2,fc,!1)}removeApps(N,Qa,Db){const fc=new h.a;fc.add(new Ue.a("corr",Qa));this.sendWithBody(Ag.removeApps,
fc,N,2,Db,!1)}getLastPrivateCatalogUpdate(N,Qa,Db,fc,vc,Rc){const cd=new h.a;cd.add(new Ue.a("catalog","privatecatalog"));cd.add(new Ue.a("clientCode",N));cd.add(new Ue.a("clientVersion",Qa));cd.add(new Ue.a("corr",vc));N=String.format("authorizationCode={0}&refreshToken={1}",Db?fg.a.Rf(Db):"",fc?fg.a.Rf(fc):"");this.sendWithBody(Ag.getLastPrivateCatalogUpdate,cd,N,2,Rc,!0)}getPrivateCatalogAddIns(N,Qa,Db,fc,vc,Rc){const cd=new h.a;cd.add(new Ue.a("catalog","privatecatalog"));cd.add(new Ue.a("clientCode",
N));cd.add(new Ue.a("clientVersion",Qa));cd.add(new Ue.a("corr",vc));N=String.format("authorizationCode={0}&refreshToken={1}",Db?fg.a.Rf(Db):"",fc?fg.a.Rf(fc):"");this.sendWithBody(Ag.getPrivateCatalogAddIns,cd,N,2,Rc,!0)}getPrivateCatalogManifests(N,Qa,Db,fc,vc){const Rc=new h.a;Rc.add(new Ue.a("catalog","privatecatalog"));Rc.add(new Ue.a("corr",fc));N=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",fg.a.Rf(N),Qa?fg.a.Rf(Qa):"",Db?fg.a.Rf(Db):"");this.sendWithBody(Ag.getPrivateCatalogManifests,
Rc,N,2,vc,!0)}isStoreDisabled(N,Qa){const Db=new h.a;Db.add(new Ue.a("corr",N));this.qY(Ag.isStoreDisabled,Db,2,Qa)}qY(N,Qa,Db,fc){this.sendWithBody(N,Qa,null,Db,fc,!1)}sendWithBody(N,Qa,Db,fc,vc,Rc){const cd=new si.QueryStringBuilder("AddinServiceHandler.ashx");cd.Kj("action",N);cd.Kj("app",Hi.a[hc.AFrameworkApplication.sa.Qa.Ii]);for(let dd of Qa)cd.Kj(dd.key,dd.value);Qa=String.format("{0}{1}&{2}",hc.AFrameworkApplication.sa.Qa.s1,cd.toString(),hc.AFrameworkApplication.ej);hc.AFrameworkApplication.de.Fn(Qa,
fc,Db,null,!1,2,dd=>{let Hd=null,Zd=null;dd&&dd.data&&(dd.data.responseHeaders["X-BlockedForMinor"]&&"1"===dd.data.responseHeaders["X-BlockedForMinor"].toString()&&(dd.data.httpStatus=451),Hd=dd.data.Fe,Zd=dd.data.responseHeaders);vc(dd.data.httpStatus,Hd,Zd)},dd=>{var Hd=null;let Zd=null;Rc&&dd&&dd.data&&dd.data.Fe&&(Hd=dd.data.Fe,Zd=dd.data.responseHeaders);vc(dd.data.httpStatus,Hd,Zd);if(hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){Hd={message:"AddinServiceHandler request failed"};Hd.code=dd.data.httpStatus;Hd.action=N;if(dd.data.request||dd.data.request.get_headers())Hd["X-UserSessionId"]=dd.data.request.get_headers()["X-UserSessionId"];408===dd.data.httpStatus||503===dd.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Hd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Hd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",dd.data.httpStatus)},null,void 0,void 0,void 0,void 0,
"AddinServiceHandler_"+N,void 0,void 0,void 0,["X-UserKey"])}}Object(e.a)(ti,"S2SWebRequestManager",null,[]);class Ii extends d.a{constructor(N){super();this.I0f=this.ddaFacade=null;this.$=N;N.da.Ja(106,this);this.kc()}get me(){return this.ddaFacade||(this.ddaFacade=new qg.DdaFacade(this.$,this.I0f,this.ag))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");hc.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${hc.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
y.EwaSettings.ya(359)?me.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(N=>{N.isFeatureEnabled("mso_officeStore",!0).then(Qa=>{qg.DdaFacade.l$b=Qa;this.uwb();return null})}):this.uwb()}uwb(){const N=mc.GetServiceTaskFactory.Za(this.$.da,224,225,this.La),Qa=pi.a.ACd(66,()=>!(void 0===window.OSF||null===window.OSF),this.$.xa.MaxRetriesForLoadingScript,this.$.ka,this.La,106),Db=qi(this.ka,this.La);let fc;fc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",
!1)?Object($h.d)(ai.a.resolve(bi.H,{Wa:this.La})):mc.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.La);ab.TaskExtensions.za(ab.TaskExtensions.ke([N,Qa,Db,fc],this.$.ka),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Ad.a.w_()}`):this.Fsi();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");
this.I0f=N.result;this.ag=fc.result;this.Pb(this.me);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}Fsi(){y.EwaSettings.ya(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new ti);this.$.Ne.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new ti,new sh(hc.AFrameworkApplication.fa.appSettings.WebServiceBase),y.EwaSettings.ya(70),!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new ti);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&
OfficeExt.ProxyBasedCatalogService.initRequestHandler(new ti)}dispose(){oi.a.Ka(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(N){new Ii(N)}}Object(e.a)(Ii,"DdaFacadeServiceFactory",d.a,[]);class Vi{constructor(N,Qa,Db,fc,vc,Rc){this.$=N;this.agaveCommandManager=Rc}ld(){return!1}hd(){return!1}Tc(N,Qa,Db,fc){let vc=!1;switch(Qa.command){case -684355545:vc=!0;break;case -741808261:vc=!!Db;break;case -859308420:vc=!!fc&&1===fc.Qy;break;case 418618014:vc=1===N&&!!fc&&1===fc.Qy;break;
case -167264441:vc=Sa.a.PEb(this.$)&&1===N&&!!fc&&1===fc.Qy;break;case -515602470:Qa=y.EwaSettings.ya(217)&&2===N;vc=(1===N||Qa)&&!!fc&&1===fc.Qy;break;case 2086613372:vc=y.EwaSettings.ya(217)&&2===N&&!!fc&&1===fc.Qy;break;case -1336341324:vc=y.EwaSettings.ya(417)&&1===N&&!!fc&&1===fc.Qy;break;case 451940422:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===N&&!!fc&&1===fc.Qy;break;case -1444574190:case -336193495:vc=1===N&&!!fc&&1===fc.Qy;break;case 1296389134:vc=
1===N&&!!fc&&1===fc.Qy;break;case Ze.a.p9a:vc=1===N&&!!fc&&1===fc.Qy;break;case 1221897806:vc=y.EwaSettings.ya(155)&&2===N;break;case 1172793074:case 1930653487:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===N;break;case -1753056834:vc=!0;break;case 932597253:vc=!0;break;case 301511274:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!0)&&this.$.isEditMode;break;case 1723441034:vc=this.$.isEditMode&&this.$.ea.HRb}return vc}executeCommand(N,Qa,Db){let fc=ab.TaskExtensions.zk();const vc=Qa.command;switch(Qa.command){case Ze.a.p9a:this.agaveCommandManager.pmh(Db.SourceControlId);break;case 1296389134:this.agaveCommandManager.w1j(Db.SourceControlId,Db.LabelText);break;case -684355545:this.agaveCommandManager.e7c();break;case -741808261:fc=this.agaveCommandManager.insertAgave(Db,Qa);break;case -1336341324:y.EwaSettings.ya(417)&&(fc=
this.agaveCommandManager.Wqd(Db,N,Qa));break;case 1172793074:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(fc=this.agaveCommandManager.Wqd(Db,N,Qa));break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:fc=this.agaveCommandManager.Wqd(Db,N,Qa);break;default:fc=bd.a(vc)}return fc}}
Object(e.a)(Vi,"AgaveCommandHandler",null,[200]);class Ji{}Object(e.a)(Ji,"Selection",null,[]);var Wi=a(1365),Xi=a(1364),Yi=a(1366),ag=a(1362),Ki=a(1360);class Zi{}Object(e.a)(Zi,"SmartLookupApplicationInterface",null,[]);class Li{}Object(e.a)(Li,"ApplicationProperties",null,[]);class ui{}Object(e.a)(ui,"EnterpriseUserInfo",null,[]);class Mi{}Object(e.a)(Mi,"FeatureGates",null,[]);class $i{constructor(N,Qa,Db=!0){this.K7j=9E5;this.N7j=3E5;this.gEd=null;this.EBf="";this.dEd=0;this.fxb=Date.now;this.FAa=
N;this.Hbb=Qa;Db&&this.kld()}Dei(){const N=this.fxb();if(N<this.dEd+this.K7j)return N>this.dEd+this.N7j&&this.kld(),this.EBf;this.kld();return""}kld(){this.gEd=this.gEd||new Promise(N=>{this.Eei().then(Qa=>{this.EBf=Qa;this.dEd=this.fxb();this.gEd=null;N(Qa)})})}Eei(){return this.Hbb&&this.Hbb.length?new Promise(N=>{this.FAa.dD("SmartLookup",this.Hbb).then(Qa=>{Qa.IsSuccess?Qa.Token||(N(""),n.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,
1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Qa.ErrorCode+": "+Qa.ErrorMessage),N(""));N(Qa.Token)}).catch(Qa=>{Qa=Bg.c(Qa);n.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Qa);N("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(e.a)($i,"SmartLookupAuthenticationManager",null,[733]);class yi{static Y4h(){switch(Object(Y.a)(String,hc.AFrameworkApplication.Nc.AudienceGroup)||
""){case "Dogfood":if(hc.AFrameworkApplication.fa){let N=hc.AFrameworkApplication.fa.Va("UserPrincipalName");N=fg.a.kl(N);const Qa=hc.AFrameworkApplication.fa.Dq("SmartLookupINTEnabledForSKITeam")?hc.AFrameworkApplication.fa.Kw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Qa,N)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static aei(){switch(hc.AFrameworkApplication.fa.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":hc.AFrameworkApplication.fa.ra("IntentSvcEnableProdSourceLocationOverride")?
"PROD":hc.AFrameworkApplication.fa.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":yi.Y4h()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(e.a)(yi,"Utils",null,[]);var ij=a(569),tg=a(185);class Th{constructor(N){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");
this.lCf=hc.AFrameworkApplication.fa.ra("IsTellMeUpSellEnterpriseEnabled");this.pSi=hc.AFrameworkApplication.fa.Va("SmartLookupApprovedOriginPattern");this.Hbb=hc.AFrameworkApplication.fa.Va("SmartLookupShredderServiceEndpoint");this.TSi=ch.a.vL(hc.AFrameworkApplication.fa.Va("AppCatalogUrl")||"");this.Gbb=new Mi;this.Gbb.EnableAllTabV2=!0;this.Gbb.EnableIntentService=!0;this.Gbb.EnableInDocumentSearch=hc.AFrameworkApplication.fa.ra("SmartLookupEnableInDocumentSearch");this.Gbb.EnableLocalSearch=
hc.AFrameworkApplication.fa.ra("SmartLookupEnableLocalSearch");this.Gbb.IntentServiceEndpoint=yi.aei();this.OSi=new $i(N,this.Hbb)}get approvedOriginPattern(){return this.pSi}A_h(){return Promise.resolve(this.B_h())}B_h(){const N=new Li;N.anid="";N.applicationVersion=hc.AFrameworkApplication.buildVersion;N.appCorrelationId=tg.a.create().toString();N.themePlatform=Th.Akk;N.lcid=hc.AFrameworkApplication.lcid;N.launchUtcTime=(new Date).toUTCString();N.featureGates=this.Gbb;var Qa=ij.a.sL(hc.AFrameworkApplication.lcid);
Qa=Qa?Qa.name:null;N.market=this.bhc(Qa);N.uiLanguage=Qa;N.sessionId=hc.AFrameworkApplication.userSessionId;N.themeId=0;N.parentalControl=Th.rgj;const Db=new ui;Db.CountryCode=this.bhc(Qa);Db.ServiceEndpoint=this.Hbb;Db.IsGoLocal=!1;Db.IsEnabled=this.lCf;Db.IsEnterpriseEnabled=this.lCf;Db.TenantRoot=this.TSi;N.enterpriseUserInfo=Db;N.accessToken=this.OSi.Dei();return N}bhc(N){N=N.split("-");return N[N.length-1]}}Th.Akk="web";Th.rgj="yes";Object(e.a)(Th,"SmartLookupManager",null,[720]);class Lh extends Yf.a{constructor(N){super();
this.$=N;this.isFirstLaunch=!1}ld(){return!1}hd(){return!1}Tc(N,Qa){N=y.EwaSettings.ya(127);return-983891024===Qa.command&&N}executeCommand(N,Qa){N=ab.TaskExtensions.zk();-983891024===Qa.command&&this.WLi();return N}WLi(){var N=new Th(null);const Qa={};var Db=Od.h(this.$).jc(null).originalText;Db=Object(Ed.a)(new Ji,{neighborhood:Db,mentionStart:0,mentionLength:Db?Db.length:0});const fc=Object(Ed.a)(new Zi,{selection:Db,entryPoint:0});N.A_h().then(Rc=>{Rc.applicationName=Lh.appName;Rc.isFirstLaunch=
this.isFirstLaunch;Rc.themeId=5;Qa[Lh.smartLookupApplicationInterface]=JSON.stringify(fc);Qa[Lh.P0g]=JSON.stringify(Rc);this.isFirstLaunch=!1});N=new Wi.a("ExcelOnline","Web","en-Us");Db=new Xi.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const vc=new Yi.a;vc.optionalProperties[ag.a.jl]=cf.a.instance.ha(1810);vc.optionalProperties[ag.a.taskPaneWidth]=350;vc.optionalProperties[ag.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";vc.xr=Qa;Ki.a.instance.Vna(Db,"Taskpane",
"SmartLookupSDXTaskpane",N,vc)}}Lh.P0g="AppProperties";Lh.appName="Excel";Lh.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(e.a)(Lh,"SmartLookupCommandHandler",Yf.a,[200]);var aj=a(466);class zi extends Pe.a{constructor(N){super(N)}he(){aj.a(this.$,374,375,this.La,N=>{this.Pd([new Vi(this.$,null,null,null,null,N),new Lh(this.$)])})}static la(N){Pe.a.ye(76,new zi(N))}}Object(e.a)(zi,"AgaveCommandHandlerFactory",Pe.a,[]);var Fh=a(1367),Mh=a(111);class th{constructor(){this.me=
null;this.Heb=(N,Qa,Db,fc,vc)=>{if(2===Db){N=vc?vc:{};Qa=N.callback;Db=N.refresh?N.refresh:!1;if(!Qa)return 16;hc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=N.storeType?this.me.eZf(Qa,Db,N.storeType):this.me.$Od(Qa,Db)}return 32};this.Yyc=(N,Qa,Db,fc,vc)=>{if(2===Db){N=vc?vc:{};Qa=N.Observer;if(!Qa)return n.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(N)),16;if(!this.me||!this.me.iba)return n.ULS.sendTraceTag(509671006,
220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(N)),16;this.me.iba.rfb(Qa)}return 32};this.nuj=(N,Qa,Db,fc,vc)=>{2===Db&&(N=vc?vc.callback:null)&&this.me.oWg(N);return 32};this.Cvi=(N,Qa,Db,fc,vc)=>{2===Db&&this.me.dLb(null,OSF.AgaveHostAction.InsertAgave,vc);return 32}}initialize(N){th.initialized||(this.me=N,this.vh(),th.initialized=!0)}vh(){hc.AFrameworkApplication.Qb.ef(Ze.a.Heb,Mh.a.frame,this.Heb,
96);hc.AFrameworkApplication.Qb.ef(Ze.a.Yyc,Mh.a.frame,this.Yyc,96);hc.AFrameworkApplication.Qb.xc(Ze.a.$sj,Mh.a.frame,this.nuj);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",!1)&&hc.AFrameworkApplication.Qb.ef(Ze.a.anf,Mh.a.frame,this.Cvi,96)}static get instance(){th.Oa||(th.Oa=new th);return th.Oa}}th.Oa=null;th.initialized=!1;Object(e.a)(th,"AgaveCommandActor",null,[]);var Ug=a(1420),ei=a(1363),Ai=a(115),Ni=a(366),Oi=a(362),Pi=a(1270),Jg=a(19),bj=
a(357);class Bi{constructor(){this.z3d=this.mHc=null;this.dx=0;this.kHc=null}}Object(e.a)(Bi,"FirstPartyAddinTaskpaneOverrides",null,[]);class fi{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(e.a)(fi,"IdeasSelectionContext",null,[]);class cj extends fi{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;
this.userSelectedPivotTable=!1}}Object(e.a)(cj,"IdeasTableSelectionContext",fi,[]);class jj{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(e.a)(jj,"AutoFilterRange",null,[]);class Qi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(e.a)(Qi,"IdeasAutoFilterSource",null,[]);class Ri{constructor(N,Qa){this.selection=N;this.tables=Qa}}Object(e.a)(Ri,"IdeasXLIMTableBoundaries",null,[]);var Og=a(58);const Ci=
(N,Qa,Db,fc,vc,Rc,cd=null)=>{cd=N.Pa(9,cd);cd.sharedInfo=Qa;return Og.g(N,"ShowAgaveTaskpane",cd,Db,fc,vc,Rc,0)};var kh=a(1010),gi=a(73),dj=a(136),Nh=a(47),Si=a(382),Uh=a(200),Ti=a(187),Di=a(575),Vf=a(246),T=a(109),eb=a(137),tb=a(55);class kc extends Qe.a{constructor(){super();this.cZ="calc(100% - 46px)";this.U$="15px";this.dZ="0";this.qmb="WACDialogPanel";this.tF=695;this.rmb=462;this.pD="80%";this.elb=350;this.ksa="100%";this.rc=5;this.Te="AppsForOfficeInsertionDialog";this.JPc=!!hc.AFrameworkApplication.fa&&
hc.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix")}gy(){super.gy();this.Bi.style.width=this.ksa;this.Bi.style.height=this.cZ;this.Bi.style.marginTop=this.U$;this.Bi.style.padding=this.dZ}spa(){this.Bi.style.width=this.ksa;this.Bi.style.height=this.cZ;this.Bi.style.marginTop=this.U$;this.Bi.style.padding=this.dZ;this.tF>Be.a.J1?(this.Hb.style.width=String.format("{0}px",Be.a.J1),this.Hb.style.overflowX="scroll",hc.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left=
"0"):(this.Hb.style.width=String.format("{0}px",this.tF),this.Hb.style.overflowX="hidden");this.Hb.offsetHeight>Be.a.YS||this.rmb+50>Be.a.YS?(this.Hb.style.height=String.format("{0}px",Be.a.YS),this.Hb.style.overflowY="scroll",this.Hb.style.top="0",hc.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0",this.JPc||(this.Hb.style.marginTop="-48px"),this.Bi.style.minHeight=String.format("{0}px",this.elb)):(this.Hb.style.overflowY="hidden",this.Hb.style.top="10%",this.Hb.style.height=
this.pD);this.Qba()}Qba(){if(this.Hb){var N=this.Hb.style.zIndex;this.Hb.style.zIndex="-9999";if(this.tF>Be.a.J1)hc.AFrameworkApplication.isRtl?this.Hb.style.marginRight="0":this.Hb.style.marginLeft="0";else{const Qa=String.format("{0}px",Math.floor(-this.Hb.offsetWidth/2));hc.AFrameworkApplication.isRtl?this.Hb.style.marginRight=Qa:this.Hb.style.marginLeft=Qa;hc.AFrameworkApplication.isRtl?this.Hb.style.right="50%":this.Hb.style.left="50%"}this.Hb.style.zIndex=String(N)}else n.ULS.sendTraceTag(19976784,
306,10,"_divMessageBox is null in CenterDialog()")}bF(){super.bF();const N=document.getElementById(this.wi(this.qmb));N.style.width=String.format("{0}px",this.tF);N.style.height=this.pD}get Dca(){return this.Bi}}Object(e.a)(kc,"AppsForOfficeInsertionDialog",Qe.a,[413]);class yc extends Qe.a{constructor(N=!0,Qa=!0,Db=null){super();this.cZ="calc(100% - 46px)";this.U$="15px";this.dZ="0";this.qmb="WACDialogPanel";this.tF=695;this.rmb=462;this.pD="80%";this.elb=350;this.ksa="100%";this.iee="auto";this.jee=
"5px";this.kee="auto";this.hee="40px";this.dYb="100px";this.smb="200px";this.rc=5;this.Te="SDXDialog";this.HZb=N;this.GCb=Qa;this.ZXb=Db}gy(){super.gy();this.Bi.style.width=this.ksa;this.Bi.style.height=this.cZ;this.Bi.style.marginTop=this.U$;this.Bi.style.padding=this.dZ}spa(){this.Bi.style.width=this.ksa;this.Bi.style.height=this.HZb?this.cZ:"100%";this.Bi.style.marginTop=this.HZb?this.U$:"0px";this.Bi.style.padding=this.dZ;if(this.HZb){this.dYb&&this.smb&&(this.tF=parseInt(this.smb.substring(0,
this.smb.length-2)),this.pD=this.dYb);this.tF>Be.a.J1?(this.Hb.style.width=String.format("{0}px",Be.a.J1),this.Hb.style.overflowX="scroll",hc.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0"):(this.Hb.style.width=String.format("{0}px",this.tF),this.Hb.style.overflowX="hidden");if(this.Hb.offsetHeight>Be.a.YS||this.rmb+50>Be.a.YS)this.Hb.style.height=String.format("{0}px",Be.a.YS),this.Hb.style.overflowY="scroll",this.Hb.style.top="0",hc.AFrameworkApplication.isRtl?this.Hb.style.right=
"0":this.Hb.style.left="0",this.Bi.style.minHeight=String.format("{0}px",this.elb);else{this.Hb.style.overflowY="hidden";const N="%"===this.pD.substring(this.pD.length-1,this.pD.length),Qa=N?parseInt(this.pD.substring(0,this.pD.length-1)):parseInt(this.pD.substring(0,this.pD.length-2));this.Hb.style.top=N?(100-Qa)/2+"%":100*(Be.a.YS-Qa)/Be.a.YS/2+"%";this.Hb.style.height=this.pD}this.Qba()}else this.Hb.style.left=this.iee,this.Hb.style.right=this.jee,this.Hb.style.top=this.kee,this.Hb.style.bottom=
this.hee,this.Hb.style.width=this.smb,this.Hb.style.height=this.dYb,this.Hb.style.overflowX="hidden",this.Hb.style.overflowY="hidden"}Qba(){if(this.Hb){var N=this.Hb.style.zIndex;this.Hb.style.zIndex="-9999";if(this.tF>Be.a.J1)hc.AFrameworkApplication.isRtl?this.Hb.style.marginRight="0":this.Hb.style.marginLeft="0";else{const Qa=String.format("{0}px",Math.floor(-this.Hb.offsetWidth/2));hc.AFrameworkApplication.isRtl?this.Hb.style.marginRight=Qa:this.Hb.style.marginLeft=Qa;hc.AFrameworkApplication.isRtl?
this.Hb.style.right="50%":this.Hb.style.left="50%"}this.Hb.style.zIndex=String(N)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}bF(){super.bF();const N=document.getElementById(this.wi(this.qmb));N.style.width=String.format("{0}px",this.tF);N.style.height=this.pD}get x7(){return this.HZb}get Dca(){return this.Bi}DMj(N,Qa,Db,fc){this.iee=N;this.jee=Qa;this.kee=Db;this.hee=fc}FMj(N,Qa){this.dYb=N;this.smb=Qa}}Object(e.a)(yc,"SDXDialog",Qe.a,[]);var Sc=a(909),fd=
a(128),sd=a(332),Dc;(function(N){N[N.Valid=2]="Valid";N[N.Invalid=4]="Invalid";N[N.All=6]="All"})(Dc||(Dc={}));Object(e.b)("MetadataState",Dc);var pd=a(354),Dd=a(858);class wd extends Yf.a{constructor(N,Qa,Db,fc,vc){super();this.qqa={};this.aWd={};this.ejd={};this.dCa=this.sdxDialog=this.G0=null;this.tfb=!1;this.o0j=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton",
"AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.pmh=Rc=>{Rc?(Rc=new ye.a(-847286761,Ib.a.Vb,this.$.Kc,0,Rc),this.$.Ia.$b(Rc,{["CalloutName"]:19})):n.ULS.sendTraceTag(509220127,220,10,"Control id is null.")};this.jli=(Rc,cd,dd,Hd,Zd)=>{if(2!==dd)return 32;this.Aqc(Zd);return 32};this.GHb=(Rc,cd,dd,Hd,Zd)=>{2===dd&&(this.G0=new kc,this.G0.initializeAndShow("",null,null),Rc=Zd.CommandValueId,cd=[],cd.push(Zd.SourceControlId),cd.push(Rc),cd.push(null),this.me.byf(this.G0.Dca,
cd));return 32};this.Aqc=Rc=>{var cd=Rc[Sc.a.Ryb];Rc=Rc[Sc.a.jfa];var dd=Rc.optionalProperties[ag.a.tl],Hd=Rc.optionalProperties[ag.a.dialogHeight];const Zd=Rc.optionalProperties[ag.a.dialogWidth],Fe=Rc.optionalProperties[ag.a.dialogLeft],Ne=Rc.optionalProperties[ag.a.tTe],sf=Rc.optionalProperties[ag.a.dialogTop],vg=Rc.optionalProperties[ag.a.jTe];this.sdxDialog=new yc(Rc.optionalProperties[ag.a.pTe],Rc.optionalProperties[ag.a.uTe]);null!=Fe&&null!=Ne&&null!=sf&&null!=vg&&this.sdxDialog.DMj(Fe,Ne,
sf,vg);null!=Hd&&null!=Zd&&this.sdxDialog.FMj(Hd,Zd);this.sdxDialog.initializeAndShow(dd,null,null);dd=Rc.optionalProperties.InstanceToken;Hd=null!=dd?dd:(new we.a(tg.a.create(),1)).toString();dd={};dd.div=this.sdxDialog.Dca;dd.id=Hd;dd.solutionId=cd.getId();dd.version=cd.BFa;dd.storeType=cd.getStoreType();dd.storeId=cd.getStoreId();dd.assetId=null;dd.assetStoreId=null;dd.settings=null!=Rc.xr?Rc.xr:{};dd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;dd.osfControlType=OSF.OsfControlType.ContainerLevel;
dd.sourceLocationOverrideResourceId=Rc.optionalProperties[ag.a.sourceLocationOverrideResourceId];dd.featureGates=hc.AFrameworkApplication.fa.A$e(cd.getId());dd.onExtensionLaunchCallback=Rc.optionalProperties[ag.a.onExtensionLaunchCallback];cd={};cd.InstanceId=dd.id;cd.WebExtensionType=2;cd.PrimaryMarketplace={};cd.PrimaryMarketplace.SolutionId=dd.solutionId;cd.PrimaryMarketplace.MarketplaceType=dd.storeType;cd.PrimaryMarketplace.MarketplaceRef=dd.storeId;cd.PrimaryMarketplace.SolutionVersion=dd.version;
cd.SrcLocationOverrideResourceId=dd.sourceLocationOverrideResourceId;cd.WebExtensionOsfControlType=6;cd.OnExtensionLaunchCallback=dd.onExtensionLaunchCallback;this.qqa[dd.solutionId]=dd.settings;const {byc:hg,nzb:Wf}=this.zsc([],dd.solutionId);cd.OsfPropertyBag=hg;cd.HostPropertyBag=Wf;this.me.fLa(cd);this.me.Lf.insertOsfControl(dd)};this.Emi=(Rc,cd,dd,Hd,Zd)=>{if(2!==dd)return 32;Rc=Zd[Sc.a.Ryb];dd=Zd[Sc.a.NKa];Zd=Zd[Sc.a.jfa];cd=new Ug.a;cd.bwi=Zd.optionalProperties.InstanceToken;cd.jl=Zd.optionalProperties[ag.a.jl];
cd.ZP=Zd.optionalProperties[ag.a.ZP];ag.a.taskPaneWidth in Zd.optionalProperties&&(cd.taskPaneWidth=Zd.optionalProperties[ag.a.taskPaneWidth]);cd.sourceLocationOverrideResourceId=Zd.optionalProperties[ag.a.sourceLocationOverrideResourceId];cd.onTaskPaneClose=Zd.optionalProperties[ag.a.onTaskPaneClose];cd.onExtensionLaunchCallback=Zd.optionalProperties[ag.a.onExtensionLaunchCallback];cd.PA=Zd.xr;cd.NKa=dd;dd=new ye.a(-859308420,0,2,0,"");Hd=Rc.getStoreType()===OSF.StoreType.Sdx;const Fe=new kh.a;Fe.T6=
Zd.optionalProperties.HeaderCssClass||Jg.a.g6a;Fe.Yib=Zd.optionalProperties.TitleCssClass;this.b$(dd,Rc.getId(),cd,Hd,Fe);return 32};this.imi=(Rc,cd,dd,Hd,Zd)=>{if(2!==dd)return 32;Rc=Zd[Sc.a.Ryb].getId();Zd=Zd[Sc.a.jfa].optionalProperties[ag.a.sourceLocationOverrideResourceId];return Rc?(this.me.Lf.refreshOsfControl(Rc,Zd),32):8};this.ekj=Rc=>{Rc=Rc.Result;if(Rc=null===Rc?null:Rc.SolutionId)this.me.Qve(Rc),T.a(this.$).G9(3,Rc)};this.zWf=(Rc,cd)=>{var dd;const Hd=(Rc=Rc.Result)?Rc.AgaveData:null;
if(Hd){var Zd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Hd.PrimaryMarketplace.SolutionId,Hd.PrimaryMarketplace.MarketplaceType,null===(dd=null===Hd||void 0===Hd?void 0:Hd.AssetMarketplace)||void 0===dd?void 0:dd.SolutionId,null,null,Hd.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,0,Hd.TaskpaneWidth===wd.bvh,`Taskpane width is ${Hd.TaskpaneWidth}, assetId is ${Zd}.`);if(dd=this.ejd[Hd.PrimaryMarketplace.SolutionId])dd.mHc&&(Hd.TaskpaneTitle=dd.mHc),dd.kHc&&(Hd.TaskpaneIconId=
dd.kHc),dd.z3d&&(Hd.TaskpaneButtonTooltip=dd.z3d),0<dd.dx&&(Hd.TaskpaneWidth=dd.dx);cd&&(Hd.FocusOnIframeWhenLoaded=cd.focusOnIframeWhenLoaded,cd.width&&(Hd.TaskpaneWidth=cd.width),Hd.TaskpaneIconCssClass=cd.vl,Hd.TaskpaneHeaderCssClass=cd.T6,Hd.TaskpaneTitleCssClass=cd.Yib,Hd.IsFirstPartyOptOutAppContextOptmization=cd.isFirstPartyOptOutAppContextOptmization);if(this.qqa[Hd.PrimaryMarketplace.SolutionId]){const {byc:Fe,nzb:Ne}=this.zsc(Hd.OsfPropertyBag,Hd.PrimaryMarketplace.SolutionId);Hd.OsfPropertyBag=
Fe;Hd.HostPropertyBag=Ne}Di.a(Hd)||(Hd.WebExtensionOsfControlType=1);Hd.OnExtensionLaunchCallback=this.aWd[Hd.PrimaryMarketplace.SolutionId];Hd&&(this.me.Qve(Rc.SolutionId),this.me.fLa(Hd))}else n.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.RQh=Rc=>{Rc&&(this.hid.zwf(Rc),this.YHe())};this.DWf=Rc=>{Rc=Rc.toDataURL("image/jpeg");const cd=this.me.$ca(wd.Qjf+"."+wd.ijc),dd={};dd.screenshot=Rc;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(cd,
"onScreenshot",dd,()=>{})};this.Bki=(Rc,cd,dd,Hd,Zd)=>{if(2!==dd)return 32;if(Ai.a.sh(Zd)||Zd[Sc.a.qMe]!==ei.a.action)return 8;cd=Zd[Sc.a.jfa];return cd?(Rc=(Rc=this.hai(Zd))?this.me.$ca(Rc):null)?(Zd=this.me.ulh(Zd[Sc.a.NKa],cd.optionalProperties[ag.a.x0c]),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(dd=this.me.gW(Rc),dd.TaskpaneTitle!==cd.optionalProperties[ag.a.jl]&&(dd.TaskpaneTitle=cd.optionalProperties[ag.a.jl],dd.TaskpaneIconCssClass=cd.optionalProperties.IconCssClass,
dd.TaskpaneIconUrl=cd.optionalProperties.TaskPaneIconUrl,dd.TaskpaneIconId=cd.optionalProperties.TaskPaneIconId,dd.OnExtensionLaunchCallback=cd.optionalProperties[ag.a.onExtensionLaunchCallback],y.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(cd=this.me.Lf,cd.changeIframeTitle(Rc,dd.TaskpaneTitle),dd=cd.getOsfControl(Rc),cd.raiseOsfControlStatusChange(dd)):(cd=this.me.Lf.getOsfControl(Rc),this.me.Lf.raiseOsfControlStatusChange(cd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Rc,
Zd,this.wQb),32):8:8};this.wQb=(Rc,cd)=>{this.me.vTh(Rc,cd)};this.cRd=()=>{ab.TaskExtensions.u5(mc.GetServiceTaskFactory.Za(this.$.da,20,404,1),Rc=>{Rc.result.pya()},this.$.ka)};this.$=N;this.viewBlockContainerHelpers=Db;this.me=Qa;this.hid=fc;this.Ci=vc;this.Ci.xc(Ze.a.gig,Mh.a.frame,this.Emi);this.Ci.xc(Ze.a.V7f,Mh.a.frame,this.imi);this.Ci.xc(Ze.a.R1e,Mh.a.frame,this.Bki);this.Ci.xc(Ze.a.Aqc,Mh.a.frame,this.jli);this.Ci.xc(Ze.a.GHb,Mh.a.frame,this.GHb)}gXg(N){this.addHandler(wd.kLd,N)}lyj(N){this.removeHandler(wd.kLd,
N)}dispose(){oi.a.Ka(this.G0);this.G0=null;this.tfb&&(this.$.ea.Pm(this.cRd),this.tfb=!1);super.dispose()}e7c(){this.G0&&this.G0.hide()}w1j(N,Qa){var Db;if(N){y.EwaSettings.isChangeGateEnabled("OfficeVSO:7671629_LogUserInstalledOMEXAddinListSizeEnabled")&&this.me.Lf.getEntitlementDetails(Object.assign(new Dd.a,{storeType:OSF.StoreTypeEnum.MarketPlace,refresh:!1}),vc=>{vc={["AddinListSize"]:null==vc.value?0:vc.value.length,["Origin"]:"OMEX"};jc.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AddinListInfoWhenUserOpenDialog",
dataFields:wc.a.Yh(vc)}))});this.raiseEvent(wd.kLd);const fc=N.split("|");this.oQi(N,Qa,fc);this.G0=new kc;this.G0.initializeAndShow("",null,null);this.me.byf(this.G0.Dca,fc);window[wd.CZg]=null!==(Db=this.o0j.get(N))&&void 0!==Db?Db:"Unknown"}}Wqd(N,Qa,Db){var fc=ab.TaskExtensions.zk();if(-515602470===Db.command||-167264441===Db.command||-336193495===Db.command||2086613372===Db.command||-1444574190===Db.command||-1336341324===Db.command||451940422===Db.command)fc=this.Yki(N,Qa,Db);418618014===Db.command&&
(Qa=new Ug.a,Qa.jl=cf.a.instance.ha(1823),fc=this.b$(Db,wd.Coi,Qa,!0));if((Db.tabName===this.$.fc+zf.a.D8f||Db.tabName===zf.a.U1)&&2===Db.yf||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),N[Ib.a.rd])||N[Ib.a.rd]===zf.a.fS)return this.Ihf(N,Db);if(7===Db.yf&&N.SourceControlId===this.$.fc+zf.a.uya)return N.MenuItemId=zf.a.cQd,this.Ihf(N,Db);1221897806===Db.command&&(fc=this.Phg(Db,"Format"));if(1930653487===Db.command||1172793074===Db.command)fc=this.Phg(Db,"Data");
-1753056834===Db.command&&(fc=this.eYj(Db));932597253===Db.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),fd.c(932597253,!0),Qa=new Ug.a,Qa.jl=cf.a.instance.ha(2163),Qa.sourceLocationOverrideResourceId=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?wd.nkj:wd.pkj,Qa.focusOnIframeWhenLoaded=!0,Qa.taskPaneWidth=wd.qlf,fc={},fc.LaunchSource=Object(Y.a)(String,N.SourceControlId),fc.LaunchMode="Default",Qa.PA=fc,fc=this.b$(Db,
wd.okj,Qa,!0));301511274===Db.command&&(fc=this.pYj(Db));if(515196233===Db.command){Qa=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);fc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var vc=this.$.da.Ba(465);vc&&(vc.J8a(),Qa||fc)&&(vc.dvi(),fc&&vc.eOj(10===Db.yf));vc=new Ug.a;vc.jl=cf.a.instance.ha(2237);const Rc={};Rc.SourceUILocation=Ni.a[Db.yf];if(Qa||fc)Rc.SessionID=
this.$.ea.sessionId,Qa&&this.KXd(Rc);vc.PA=Rc;Qa=new kh.a;Qa.T6=Jg.a.g6a;fc=this.b$(Db,wd.cfj,vc,!0,Qa,void 0,vc.jl)}1723441034===Db.command&&(Qa=new Ug.a,Qa.jl=cf.a.instance.ha(2249),Qa.focusOnIframeWhenLoaded=!0,Qa.taskPaneWidth=wd.gnj,fc=new kh.a,fc.T6=Jg.a.KHh,fc=this.b$(Db,sd.c,Qa,!0,fc));y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&N.LoadDataFromPictureTaskpane&&(Qa={},fc=new Ug.a,fc.jl=cf.a.instance.ha(2276),Qa.SessionID=N.SessionID,fc.PA=Qa,fc.focusOnIframeWhenLoaded=
!0,fc=this.b$(Db,N.DataFromPictureAssetId,fc,!0));return fc}insertAgave(N,Qa){var Db=ab.TaskExtensions.zk();const fc=this.$;let vc;var Rc=N[da.a.jja];vc=N[Ib.a.Bg];let cd=null;kh.a.key in N&&(cd=N[kh.a.key]);this.G0&&this.G0.hide();if(!vc||!Rc)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Db;this.$.D7&&zf.a.$qa in N&&(vc.EnabledInViewMode=N[zf.a.$qa]);N=this.p2h(Qa.command);if(!vc.EnabledInViewMode&&!fc.mt(null,!1,N))return Db;let dd=void 0===vc.IsToBePersisted||
null===vc.IsToBePersisted||vc.IsToBePersisted?0:16;if(1===vc.TargetType)Db=this.Yvi(vc,Rc,Qa,cd,dd);else{Rc=Od.h(fc);Db=this.viewBlockContainerHelpers.tkb(Rc);const Hd=fc.ea.isNamedObjectViewMode?fc.na.sheetName:fc.na.name;let Zd,Fe,Ne,sf;Db?(Rc=Db.Ie,Zd=Rc.af.top,Fe=Rc.af.left,Ne=Db.gK.x,sf=Db.gK.y):(Zd=Fe=1,Db=this.viewBlockContainerHelpers.iOa(Rc),Ne=Db.x,sf=Db.y);const vg=this.$.qa.va.Bc();dd|=64;Db=Si.a(this.$.userOperationManager,(hg,Wf,bg)=>{var wg=fc.qa.va,Xg=Zd,Kg=Fe,Yg=Ne,Vh=sf;hg=Vf.b(hg,
this.ekj);const vi=wg.Pa(9,vg);vi.sharedInfo=vc;vi.sheetName=Hd;vi.positionRow=Xg;vi.positionCol=Kg;vi.positionOffsetX=Yg;vi.positionOffsetY=Vh;return Og.g(wg,"InsertWebExtension",vi,hg,Wf,bg,null,0)},hg=>new Uh.a(534,0,hg,dd),Qa)}return Db}Rih(){var N=me.a.instance.qc("Common.App.ICustomerFeedbackUiWrapper");if(!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var Qa=me.a.instance.qc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");
this.hid?this.hid.Unb?this.YHe():Qa.instance.med(this.RQh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Qa={};hc.AFrameworkApplication.fa.jwe(Qa);N=N.instance.getContext(Qa);Qa={};"telemetryGroup"in N&&(Qa=N.telemetryGroup);Qa.processSessionId=N.sessionId;Qa.officeBuild=N.build;N.telemetryGroup=Qa;N.feedbackType=-1;N.userVoiceEnabled=!1;"disableIncludeScreenshot"in N||(N.disableIncludeScreenshot=!1);"screenshot"in N||(N.screenshot=!1);N.disableScreenshotPreview=!1;N.includeScreenshotSelectedDefault=
!0;return N}WWf(N){if(!this.dCa&&y.EwaSettings.getBooleanFeatureGate(wd.zqi,!1)){var Qa=this.Dnd();Qa=this.rFe(Qa);const Db=new kh.a;Db.vl=Jg.a.Hyb;Db.T6=Jg.a.MZe;Db.Yib=Jg.a.Egd;this.dCa=this.bCc(Qa,null,!1,null,Db);eb.b(this.$).Ld(dj.a.Dkj,{["Location"]:N?Ni.a[N.yf]:0,["InputMethod"]:N?Oi.a[N.method]:0},void 0,!0);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.m5d()}}KXd(N){const Qa=this.$.ea.oh.get(17);me.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Db=>
{Db.isFeatureEnabled("mso_sendASmile",Qa).then(fc=>{N.FeedbackEnabled=Qa&&fc;return null})})}YCi(){return this.me.xIi(this.me.jNa(wd.UOa,this.Dnd()))}Phg(N,Qa){const Db=Od.h(this.$),fc=new Ug.a;var vc={};vc.ActiveTab=Qa;vc.DatapaneFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);vc.MergeIvyBiDataSources=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeIvyBiDataSources",!1);vc.ComboChartUIInXLO=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",
!1);vc.AceFlighting=!0;vc.ThemeColorsFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");vc.UOMirror=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);vc.FormatTaskPaneAceButtonDark=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);vc.FormatTaskPaneBetterFeedbackButton=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",
!1);vc.FormatTaskPaneBetterScrollbar=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);vc.FormatTaskPaneUXImprovePhase2=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);vc.ChartTPNewFontAndColorTheme=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);vc.ChartFOTPRenderRefactor=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSTrendlineEquationFormat",
!1);this.KXd(vc);vc.startTimeMs=Date.now();vc.UserSessionId=this.$.xa.UserSessionId;(Qa=Db.ga.Sa.Wo)&&(vc.SubSelection=Qa);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${vc.UserSessionId}, UILocation: ${void 0===N.yf||null===N.yf?"Null":Ni.a[N.yf]}, SubSelection: ${Qa||"ChartRoot"}`);fc.PA=vc;fc.jl=cf.a.instance.ha(984);vc=new kh.a;vc.T6=Jg.a.g6a;return this.b$(N,wd.Gch,fc,!0,vc)}eYj(N){const Qa=new Ug.a;Qa.PA={};Qa.jl=cf.a.instance.ha(1809);Qa.ZP=wd.Cyf;const Db=new kh.a;
Db.T6=Jg.a.g6a;return this.b$(N,wd.Cyf,Qa,!0,Db,void 0,Qa.jl)}pYj(N){const Qa=new Ug.a;Qa.PA={};Qa.jl=cf.a.instance.ha(2187);const Db=new kh.a;Db.T6=Jg.a.mJh;Db.Yib=Jg.a.QZe;return this.b$(N,wd.VXi,Qa,!0,Db)}Ihf(N,Qa){const Db=wd.Qjf;var fc=N[Ib.a.rd].toString();const vc={},Rc=new Ug.a;Rc.jl=cf.a.instance.ha(9);switch(fc){case "A0":vc.query=(N[Ib.a.Bg]||"").split("|").slice(2,bj.a.i3).join("|");break;case "A1":vc.query=N.CommandValueId;break;case "Help":vc.query="";break;case zf.a.cQd:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(Rc.jl=cf.a.instance.ha(1775),Rc.sourceLocationOverrideResourceId=wd.ijc,vc.feedback=this.Rih()):vc.query=fc;break;case "HelpArticle":vc.query=N[Ib.a.Bg];break;case "ContactSupport":vc.query=fc;Rc.sourceLocationOverrideResourceId=wd.Zih;break;case "ShowTraining":case "WhatsNew":vc.query=fc;break;default:return ke.Task.Ua(!0)}Rc.PA=vc;fc=new kh.a;fc.T6=Jg.a.g6a;return this.b$(Qa,Db,Rc,!1,fc,N[zf.a.$qa]||!1)}rFe(N){const Qa={};Qa.SolutionId=wd.UOa;Qa.Version="0.0.0.0";Qa.StoreType=OSF.StoreType.Sdx;
Qa.StoreId=OSF.StoreType.Sdx;Qa.AssetId=null;Qa.AssetStoreId=null;Qa.Height=0;Qa.Width=0;Qa.TargetType=OSF.OsfControlTarget.TaskPane;Qa.IsToBePersisted=!1;Qa.SourceLocationOverrideResourceId=N;Qa.SharedRuntimeId=N;return Qa}Yki(N,Qa,Db){function fc(){cd.LaunchMode="Default";vc.jl=cf.a.instance.ha(1822);vc.ZP=wd.x5b;vc.vl=Jg.a.Hyb;Rc.vl=Jg.a.Hyb}const vc=new Ug.a,Rc=new kh.a,cd={};this.dCa&&this.KXd(cd);cd.LaunchSource="";cd.StartTimeMs=Date.now();cd.CorrelationId=tg.a.create().toString();vc.PA=cd;
vc.focusOnIframeWhenLoaded=!0;vc.taskPaneWidth=wd.qlf;Rc.T6=Jg.a.MZe;Rc.Yib=Jg.a.Egd;switch(Db.command){case -1444574190:let Zd;cd.LaunchMode="RecommendedPivotTables";cd.SelectionContext="";cd.LaunchSource="PivotTableHandRaise"===Object(Y.a)(String,N.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&N.SourceSelection){var dd=N.SourceSelection.split(",")[0];Qa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?
-1:0;if(({sheetName:dd,B_f:Zd,range:Hd}=Nh.ab(dd,this.$.ua)).returnValue&&!Od.h(this.$).Mb.YW(Hd))N=this.$.ua.getItemByName(dd),cd.SelectionContext=JSON.stringify(Object(Ed.a)(new fi,{address:Zd,addressWithSheet:dd+"!"+Hd.nz(!1),sheetId:gi.d(N),sheetName:dd,isSheetEmpty:!1,columnCount:Hd.width,rowCount:Hd.height,columnIndex:Hd.left+Qa,rowIndex:Hd.top+Qa,selectionType:"Continuous"}));else if((N=this.$.Zb.getItemByName(Object(Y.a)(String,N.SourceSelection)))&&gi.n(N)){var Hd=Ti.a(N,!0);dd=this.$.ua.getItemByName(N.sheetName);
cd.SelectionContext=JSON.stringify(Object(Ed.a)(new cj,{tableName:N.name,hasTableHeaders:Ti.d(N),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Hd.nz(!1),addressWithSheet:dd.name+"!"+Hd.nz(!1),sheetId:gi.d(dd),sheetName:dd.name,isSheetEmpty:!1,columnCount:Hd.width,rowCount:Hd.height,columnIndex:Hd.left+Qa,rowIndex:Hd.top+Qa,selectionType:"Continuous"}))}}vc.jl=cf.a.instance.ha(1821);vc.ZP=wd.uij;vc.vl=Jg.a.Y0e;Rc.vl=Jg.a.Y0e;break;case -336193495:cd.LaunchMode="RecommendedCharts";vc.jl=
cf.a.instance.ha(1820);vc.ZP=wd.Grj;vc.vl=Jg.a.Z0e;Rc.vl=Jg.a.Z0e;break;case -1336341324:if(!y.EwaSettings.ya(417))return ke.Task.Ua(!1);cd.LaunchMode="NL";vc.ZP=wd.x5b;switch(y.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:vc.jl=cf.a.instance.ha(1825);cd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:vc.jl=cf.a.instance.ha(1826);cd.NLLaunchModeBrandingCandidatesIndex=2;break;default:vc.jl=cf.a.instance.ha(1824),cd.NLLaunchModeBrandingCandidatesIndex=
0}break;case 2086613372:if(!y.EwaSettings.ya(217))return ke.Task.Ua(!1);cd.LaunchMode="ChartDesigner";cd.LaunchSelectionMode=Qa.toString();vc.jl=cf.a.instance.ha(1827);vc.ZP=wd.x5b;break;case 451940422:cd.LaunchSource="AutoFilter";Hd=JSON.parse(N.CommandValueId);cd.AutoFilterSource=JSON.stringify(Object.assign(new Qi,{autoFilterRange:{sheetName:Hd.AutoFilterRange.SheetName,firstColumn:Hd.AutoFilterRange.FirstColumn,lastColumn:Hd.AutoFilterRange.LastColumn,firstRow:Hd.AutoFilterRange.FirstRow,lastRow:Hd.AutoFilterRange.LastRow},
autoFilterType:Hd.AutoFilterType,itemIndex:Hd.ItemIndex,id:Hd.Id}));fc();break;case -167264441:cd.LaunchMode="ExcelIntelligence";cd.TableName=N.tableName;vc.jl=cf.a.instance.ha(2287);vc.ZP=wd.x5b;vc.vl=Jg.a.Hyb;Rc.vl=Jg.a.Hyb;break;default:y.EwaSettings.ya(217)&&(cd.LaunchSelectionMode=Qa.toString()),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(cd.XlimTableBoundaries=this.Gfi()),fc()}vc.sourceLocationOverrideResourceId=this.Dnd();return this.dCa?
this.dCa.Xp(()=>this.Rag(cd,vc)):this.eui(Db,vc,Rc,cd)}eui(N,Qa,Db,fc){this.dCa=this.bCc(this.rFe(Qa.sourceLocationOverrideResourceId),Qa,!1,N,Db,!1);return y.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(fc.NoActionMsgOnFirstInstance=!0,this.qqa[wd.UOa]=fc,this.dCa):this.dCa.Xp(()=>this.Rag(fc,Qa))}Rag(N,Qa){const Db=this.me.$ca(this.me.jNa(wd.UOa,Qa.sourceLocationOverrideResourceId));if(Db){this.qqa[wd.UOa]=N;const {byc:fc,nzb:vc}=this.zsc(this.me.gW(Db).OsfPropertyBag,
wd.UOa);this.me.gW(Db).OsfPropertyBag=fc;this.me.gW(Db).HostPropertyBag=vc}this.Vna(wd.UOa,ei.a.action,"LaunchIdeasAction",N,"1.0.0.0",Qa);return ke.Task.Ua(!0)}Dnd(){const N=hc.AFrameworkApplication.Nc.AudienceGroup;if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(N){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(N){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}b$(N,
Qa,Db=null,fc=!1,vc=null,Rc=!1,cd=null){ab.TaskExtensions.zk();Db||(Db=new Ug.a);const dd={};dd.SolutionId=Qa;dd.Version="0.0.0.0";dd.StoreType=fc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;dd.StoreId=fc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;dd.AssetId=null;dd.AssetStoreId=null;dd.Height=0;dd.Width=0;dd.TargetType=OSF.OsfControlTarget.TaskPane;dd.IsToBePersisted=!1;dd.SourceLocationOverrideResourceId=Db.sourceLocationOverrideResourceId;if(Db.jl||cd)this.ejd[Qa]=Object(Ed.a)(new Bi,{mHc:Db.jl,
z3d:cd,kHc:Db.ZP});y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Db.PA||(Db.PA={}),Db.PA.ShowFeedback=this.$.isFeedbackEnabled,this.qqa[Qa]=Db.PA):Db.PA&&(this.qqa[Qa]=Db.PA);this.aWd[Qa]=Db.onExtensionLaunchCallback;Qa={};Qa[Ib.a.Bg]=dd;cd={};cd.solutionId=dd.SolutionId;cd.version=dd.Version;cd.storeType=dd.StoreType;cd.storeId=dd.StoreId;cd.assetId=dd.AssetId;cd.assetStoreId=dd.AssetStoreId;cd.height=dd.Height;cd.targetType=
dd.TargetType;cd.width=dd.Width;cd.isAddinCommands=!fc;Qa[da.a.jja]=cd;vc||(vc=new kh.a);vc.focusOnIframeWhenLoaded=Db.focusOnIframeWhenLoaded;vc.width=Db.taskPaneWidth;Qa[kh.a.key]=vc;Qa[zf.a.$qa]=Rc;return this.insertAgave(Qa,N)}Yvi(N,Qa,Db,fc,vc){const Rc=(Zd,Fe)=>{var Ne=Zd.SolutionId;const sf=OSF.OsfControl.isFirstPartyStoreString(Zd.StoreType);sf&&Zd.SourceLocationOverrideResourceId&&(Ne=this.me.jNa(Ne,Zd.SourceLocationOverrideResourceId));var vg=this.me.UIe(Ne,null,Zd.SharedRuntimeId);if(sf){if(y.EwaSettings.ya(263)&&
vg&&(Ne=this.me.$ca(Ne))){const {byc:hg,nzb:Wf}=this.zsc(this.me.gW(Ne).OsfPropertyBag,Zd.SolutionId);if(Ne=this.me.Lf.getOsfControl(Ne))Ne.setSettings(hg),Ne.setHostSettings(Wf)}Zd.SharedRuntimeId&&vg||this.me.Lf.refreshOsfControl(Zd.SolutionId,Zd.SourceLocationOverrideResourceId)}if(!vg){const hg=this.$.qa.va.Bc();let Wf=519;vg=(bg,wg,Xg)=>{var Kg=this.$.qa.va;bg=Vf.b(bg,this.zWf);const Yg=Kg.Pa(9,hg);Yg.sharedInfo=Zd;return Og.g(Kg,"InsertAgaveTaskpane",Yg,bg,wg,Xg,fc,0)};void 0===Zd.IsToBePersisted||
null===Zd.IsToBePersisted||Zd.IsToBePersisted||(Wf=538,vg=(bg,wg,Xg)=>{const Kg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Zd.SolutionId,Zd.StoreType,Zd.AssetId,null,null,Zd.StoreId);n.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Zd.StoreType}, StoreId ${Zd.StoreId}, SolutionId ${Kg}.`);return Ci(this.$.qa.va,Zd,Vf.b(bg,this.zWf),wg,Xg,fc,hg)});vc|=64;return Si.a(this.$.userOperationManager,vg,bg=>new Uh.a(Wf,0,bg,vc),Fe)}return ab.TaskExtensions.rda()},
cd=Zd=>{var Fe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Zd.solutionId,Zd.storeType,Zd.assetId,null,null,Zd.storeId);n.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Fe} from ${Zd.storeType}.`);Fe={};const Ne=new h.a;Ne.add(Zd);Fe[da.a.osb]=Ne;Fe[da.a.mN]=3;Zd=new ye.a(Ze.a.EHb,0,this.$.Kc,0,null);return this.$.Ia.$b(Zd,Fe)};if(!y.EwaSettings.ya(52)||N.StoreId===OSF.StoreType.FirstParty)return Rc(N,Db,fc);if(Qa.isAddinCommands)return cd(Qa);const dd=new Te.a,Hd={};Hd.solutionId=
N.SolutionId;Hd.version=N.Version;Hd.storeType=N.StoreType;Hd.storeId=N.StoreId;Hd.targetData=N;this.me.Lf.isAddinCommandsAsync(Hd,(Zd,Fe,Ne)=>{dd.setResult(Fe);Zd||(Zd=Ne.targetData,Fe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Zd.SolutionId,Zd.StoreType,Zd.AssetId,null,null,Zd.StoreId),n.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Fe} from ${Zd.StoreType} during addin inserting`))});return ab.TaskExtensions.ts(dd.task,Zd=>Zd.result?cd(Qa):Rc(N,Db,fc),this.$.ka)}zsc(N,
Qa){if(!this.qqa[Qa])return{tok:N,nzb:null};const Db={},fc={};if(N)for(const [Rc,cd]of N)Db[Rc]=cd;N=this.qqa[Qa];for(var vc of Object.keys(N))Qa=N[vc],vc===wd.TQh&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Db[vc]=fc[vc]=Sys.Serialization.JavaScriptSerializer.serialize(Qa):Db[vc]=fc[vc]=Sys.Serialization.JavaScriptSerializer.serialize(Qa.toString());vc=Object.keys(Db).map(Rc=>[Rc,Db[Rc].toString()]);N=Object.keys(fc).map(Rc=>[Rc,fc[Rc].toString()]);
return{byc:vc,nzb:N}}oQi(N,Qa,Db){const fc=this.$.xa.UserSessionId,vc=this.$.xa.UICultureTag,Rc=this.$.xa.UICultureTagLcid,cd=this.$.xa.WacHostId;let dd="",Hd="";5<=Db.length&&(dd=Db[3],Hd=Db[4]);this.pQi(dd,Hd,N,Qa,vc,Rc,fc,cd)}pQi(N,Qa,Db,fc,vc,Rc,cd,dd){const Hd={};Hd.a=cd;Hd.b=Db;Hd.c=fc;Hd.d=N;Hd.e=Qa;Hd.f=vc;Hd.g=Rc;Hd.h=dd;tb.b().Df(36,Hd)}YHe(){if(Pi.a.iHf())n.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.DWf);
return}catch(N){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(N?N.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.DWf)}catch(N){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(N?N.toString():null))}}}bCc(N,Qa=null,Db=!1,fc=null,vc=null,Rc=!0){var cd=N.SolutionId;let dd=ke.Task.Ua(!1);N&&cd&&N.SharedRuntimeId&&(fc=fc||new ye.a(-859308420,0,2,0,""),cd={},cd.solutionId=N.SolutionId,cd.version=N.Version,cd.storeType=N.StoreType,
cd.storeId=N.StoreId,cd.assetId=N.AssetId,cd.assetStoreId=N.AssetStoreId,cd.height=N.Height,cd.targetType=N.TargetType,cd.width=0,cd.isAddinCommands=!1,cd.sharedRuntimeId=N.SharedRuntimeId,N.Preload=Rc,vc=vc?vc:new kh.a,vc.width=0,Qa&&(vc.focusOnIframeWhenLoaded=Qa.focusOnIframeWhenLoaded,Rc=new Bi,Qa.jl&&(Rc.mHc=Qa.jl),0<Qa.taskPaneWidth&&(Rc.dx=Qa.taskPaneWidth),Qa.ZP&&(Rc.kHc=Qa.ZP),y.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&Qa.PA&&(this.qqa[N.SolutionId]=Qa.PA),
this.ejd[N.SolutionId]=Rc,this.aWd[N.SolutionId]=Qa.onExtensionLaunchCallback),Qa={},Qa[Ib.a.Bg]=N,Qa[da.a.jja]=cd,Qa[kh.a.key]=vc,Qa[zf.a.$qa]=Db,dd=this.insertAgave(Qa,fc));return dd}Vna(N,Qa,Db,fc,vc,Rc=null){if(N&&Db){N=new Xi.a(N,OSF.StoreType.Sdx,OSF.StoreType.Sdx,vc);vc=new Wi.a("ExcelOnline","Web",this.$.xa.UICultureTag);const cd=new Yi.a;cd.optionalProperties[ag.a.x0c]=fc;Rc&&(Rc.sourceLocationOverrideResourceId&&(cd.optionalProperties[ag.a.sourceLocationOverrideResourceId]=Rc.sourceLocationOverrideResourceId),
Rc.jl&&(cd.optionalProperties[ag.a.jl]=Rc.jl),Rc.vl&&(cd.optionalProperties.IconCssClass=Rc.vl),Rc.w3d&&(cd.optionalProperties.TaskPaneIconUrl=Rc.w3d),Rc.ZP&&(cd.optionalProperties.TaskPaneIconId=Rc.ZP),Rc.onExtensionLaunchCallback&&(cd.optionalProperties[ag.a.onExtensionLaunchCallback]=Rc.onExtensionLaunchCallback));Ki.a.instance.Vna(N,Qa,Db,vc,cd)}}hai(N){if(!Ai.a.sh(N)){var Qa=N[Sc.a.Ryb];if(Qa&&(Qa=Qa.getId(),N=N[Sc.a.jfa],Qa&&N))return this.jNa(Qa,N.optionalProperties[ag.a.sourceLocationOverrideResourceId])}return null}jNa(N,
Qa=null){return N&&Qa?`${N}.${Qa}`:N}p2h(N){switch(N){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return y.EwaSettings.ya(217)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}m5d(){this.$.ea.Of?this.cRd():(this.$.ea.nk(this.cRd),this.tfb=!0)}Gfi(){var N=this.$.da.Ba(20);if(!N)return this.m5d(),"";N=N.pya();if(!N)return this.m5d(),"";var Qa=this.$.ua.getItemByName(this.$.ea.isNamedObjectViewMode?
this.$.na.sheetName:this.$.na.name);Qa=gi.d(Qa);var Db=Od.h(this.$).ga.pa.selectedRanges;const fc=[];for(const Rc of Db){Db=new pd.a(Rc,Qa);var vc=N.W7a(Db,Dc.Valid);Db=[];if(vc)for(const cd of vc)(vc=cd.table.PB)&&(vc=vc.range.toString())&&Db.push(vc);Db=new Ri(Rc.toString(),Db);fc.push(Db)}return JSON.stringify(fc)}}wd.zqi="Microsoft.Office.Excel.IdeasXLOPreload";wd.kLd="IDS";wd.Qjf="FA000000012";wd.UOa="FA000000005";wd.Coi="HelloWorld";wd.Gch="FA000000014";wd.ijc="Help.GiveFeedback.Url";wd.Zih=
"Help.ContactSupport.Url";wd.TQh="feedback";wd.Cyf="FA000000066";wd.pkj="PowerBi.Url";wd.nkj="PowerBi.DevUrl";wd.okj="FA000000054";wd.VXi="FA000000064";wd.cfj="FA000000075";wd.x5b="AnalyzeDataTaskPane";wd.Grj="RecommendedChartsTaskPane";wd.uij="PivotTableTaskPane";wd.bvh=350;wd.qlf=320;wd.gnj=320;wd.CZg="g_InstallOrigin";Object(e.a)(wd,"AgaveCommandManager",Yf.a,[697,698]);class Kd extends d.a{constructor(N){super();this.$=N;this.kc()}create(){const N=this.$.da,Qa=mc.GetServiceTaskFactory.create(N,
106,this.ka,this.La),Db=mc.GetServiceTaskFactory.create(N,104,this.ka,this.La),fc=pi.a.loadScript(35,0,this.La,void 0,void 0,375);ab.TaskExtensions.za(ab.TaskExtensions.ke([Db,Qa,fc],this.ka),()=>{let vc=null;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(vc=me.a.instance.qc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);th.instance.initialize(Qa.result);const Rc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",
!0)?Object(ni.a)(this.$.da,374,()=>new wd(this.$,Qa.result,Db.result,vc,hc.AFrameworkApplication.Qb)):new wd(this.$,Qa.result,Db.result,vc,hc.AFrameworkApplication.Qb);N.Ja(206,Rc);this.Pb(N.Ba(374)||N.Ja(374,Rc))},this.ka,3);me.a.instance.register(Fh.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Uc().dd(()=>new Fh.a(this.$.yw))}static la(N){N.da.Ja(375,new Kd(N))}}Object(e.a)(Kd,"AgaveCommandManagerFactory",d.a,[]);var ie=a(1369),xe=a(762);class Je{constructor(){this.ofe=this.Jee=
this.Aha=null;this.snb=0}get displayName(){return this.Aha}set displayName(N){this.Aha=N}get email(){return this.Jee}set email(N){this.Jee=N}get federationProvider(){return this.ofe}set federationProvider(N){this.ofe=N}get identityType(){return this.snb}set identityType(N){this.snb=N}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(N){switch(N){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Qa){switch(N){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}static coh(N){const Qa=new Je;Qa.displayName=N.displayName;Qa.email=N.email;
switch(N.authority){case ie.a.nTf:Qa.identityType=1;break;default:Qa.identityType=0}Qa.federationProvider="";return Qa}}Object(e.a)(Je,"OfficeIdentityInfo",null,[]);class rf{static get aYe(){return rf.lGg}static phc(N){return N in rf.aYe?rf.aYe[N].toString():N}}rf.lGg={["GeneralException"]:xe.a.generalException,["AccessDenied"]:xe.a.r0c,["ApiNotAvailable"]:xe.a.apiNotAvailable,["UserNotSignedIn"]:xe.a.userNotSignedIn,["UserAborted"]:xe.a.userAborted,["UnsupportedUserIdentity"]:xe.a.Dck,["InvalidResourceUrl"]:xe.a.invalidResourceUrl,
["InvalidGrant"]:xe.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:xe.a.EZg,["ResourceNotAllowed"]:xe.a.KDj,["ClientError"]:xe.a.clientError,["ServerError"]:xe.a.serverError};rf.map=null;Object(e.a)(rf,"SingleSignOnErrorCodeMap",null,[]);class eg{constructor(N,Qa){this.lWb=N;this.snb=Qa}get accessToken(){return this.lWb}set accessToken(N){this.lWb=N}get tokenIdenityType(){return this.snb}set tokenIdenityType(N){this.snb=N}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(N){switch(N){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Qa){switch(N){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(eg,"SingleSignOnToken",null,[]);class Sf{constructor(){this.Wae=null;this.iqe=this.Y0b=this.qF="";this.vre=!0;this.options=null}get authChallenge(){return this.Wae}set authChallenge(N){this.Wae=
N}get correlationId(){return this.qF}set correlationId(N){this.qF=N}get policy(){return null}set policy(N){}get resource(){return this.Y0b}set resource(N){this.Y0b=N}get scope(){return this.iqe}set scope(N){this.iqe=N}get silentLogin(){return this.vre}set silentLogin(N){this.vre=N}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(N){switch(N){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Qa){switch(N){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Qa){N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(Sf,"TokenParameters",null,[451]);class yf{constructor(N,Qa){this.Plb=Qa;this.px=N}get roamingSettings(){return null}getAccessToken(N){const Qa=this.Plb.getOsfControl(this.px),Db=Qa.getManifest(),fc=Db.getMarketplaceID();this.gRa(N,fc);return OfficeExtension.WacRuntime.Utility.createPromise((vc,Rc)=>{Qa.isFirstParty()&&this.Plb._enableFirstPartySSO?this.Cyi(Db,N)?me.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(N,
fc).then(cd=>{vc(cd)},cd=>{Rc(cd)}):Rc(xe.a.r0c):Rc(xe.a.apiNotAvailable)}).then(vc=>{let Rc;switch(vc.authority){case ie.a.nTf:Rc=1;break;default:Rc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new eg(vc.accessToken,Rc))},vc=>{this.logErrorResponse(N,fc,vc);return vc?OfficeExtension.WacRuntime.Utility.createPromise((Rc,cd)=>{cd(OfficeExtension.WacRuntime.Utility.createRichApiException(vc,rf.phc(vc)))}):OfficeExtension.WacRuntime.Utility.createPromise((Rc,cd)=>{cd(OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.generalException,
rf.phc(xe.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const N=this.Plb.getOsfControl(this.px);N.getManifest();const Qa=N.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((Db,fc)=>{me.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Qa).then(vc=>{Db(vc)},vc=>{fc(vc.toString())})}).then(Db=>{Db=Je.coh(Db);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Db)},Db=>Db?OfficeExtension.WacRuntime.Utility.createPromise((fc,
vc)=>{vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Db,rf.phc(Db)))}):OfficeExtension.WacRuntime.Utility.createPromise((fc,vc)=>{vc(OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.generalException,rf.phc(xe.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(N){switch(N){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 1:return this.xZh(Qa);case 3:return this.P_h();case 2:return this.nbi()}N=this.invokeMethod(N,
Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}xZh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,Sf);return this.getAccessToken(N)}P_h(){return this.getAuthContext()}nbi(){return this.getPrimaryIdentityInfo()}Cyi(N,Qa){let Db=!1;const fc=N.getWebApplicationAuthorizations();N=null;for(const vc of fc)if(vc.getResource().toLowerCase()===Qa.resource.toLowerCase()){N=vc;Db=!0;break}if(!Db)return!1;Qa=Qa.scope.split(" ,+");for(const vc of Qa)if(vc&&vc.length){Qa=
!1;for(const Rc of N.getScopes())vc.toLowerCase()===Rc.toLowerCase()&&(Qa=!0);if(!Qa)return!1}return!0}gRa(N,Qa){N=this.ZGf(N.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Qa,["resource"]:N})}logErrorResponse(N,Qa,Db){N=this.ZGf(N.resource);n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Qa,["resource"]:N,["error"]:Db})}ZGf(N){return N.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(e.a)(yf,"AuthenticationService",null,[]);class og{create(N,
Qa){return new yf(N,Qa)}}Object(e.a)(og,"AuthenticationServiceFactory",null,[]);var Mf=a(119),sg=a(887),Mg=a(1009),ah=a(993);class dg{}dg.generalException="generalException";dg.invalidArgument="invalidArgument";dg.notAllowed="notAllowed";dg.apiNotAvailable="apiNotAvailable";dg.unresolvedPendingRequest="unresolvedPendingRequest";dg.timeout="timeout";dg.adalTimeout="adalTimeout";dg.userNotSignedIn="userNotSignedIn";dg.userAborted="userAborted";dg.silentSignInFailed="silentSignInFailed";dg.invalidResourceUrl=
"invalidResourceUrl";dg.invalidGrant="invalidGrant";dg.connectionLost="connectionLost";dg.clientError="clientError";dg.serverError="serverError";Object(e.a)(dg,"WopiHostErrorCodes",null,[]);var Wg=a(567);class ph{}Object(e.a)(ph,"OAuthCallerMetadata",null,[]);var ih=a(31);class bh{constructor(N){this.FAa=N;this.cGg=hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}fRg(N,Qa,Db,fc,vc,Rc){if(!this.FAa)return fc=new Mg.a,fc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(fc);const cd=new ph;cd.AddinName=vc;cd.AddinTrustId=Rc;let dd=-1;Rc=null;if(fc&&this.Hrf())Rc=this.FAa.yqg(da.a.EHc,N,fc,bh.Wcf(vc),cd);else{const Hd=Date.now();Rc=this.FAa.dD(da.a.EHc,N,cd).then(Zd=>{dd=Date.now()-Hd;const Fe=(Qa||Db)&&"login_required"===Zd.ErrorCode;return(Qa&&("interaction_required"===Zd.ErrorCode||"consent_required"===Zd.ErrorCode||"invalid_grant"===Zd.ErrorCode)||Fe)&&this.Hrf()?this.FAa.yqg(da.a.EHc,N,null,bh.Wcf(vc),cd):Promise.resolve(Zd)})}return Rc.then(Hd=>
{const Zd=new Mg.a;Hd.IsSuccess?(Zd.token=Hd.Token,Hd.Telemetry&&(Zd.TWa=Hd.Telemetry.fromCache,Zd.expiresOn=Hd.Telemetry.expiresOn)):(Zd.errorCode=this.NTi(Hd),Zd.D3d=this.tgj(Hd));return Zd}).catch(()=>{const Hd=new Mg.a;Hd.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Hd)}).then(Hd=>{Hd.vja="OauthManager";0<=dd&&(Hd.TBb=dd);return Hd})}gBi(N){const Qa=(hc.AFrameworkApplication.fa.Va(hc.AFrameworkApplication.u$)||"").toLowerCase();return(ih.a.Wza||"teams"===
Qa&&Wg.OAuthManagerSettings.eDb)&&!bh.LAi(N)||!this.FAa||!this.FAa.oPa()?!1:!0}Hrf(){return this.cGg||1!==ah.a.Agc()}NTi(N){switch(N.ErrorCode){case "UserCancelled":case "interaction_required":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":N=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:N=N.ErrorCode===dg.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:N.ErrorCode===dg.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:N.ErrorCode===dg.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
N.ErrorCode===dg.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:N.ErrorCode===dg.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return N}tgj(N){let Qa="";(N=RegExp("AADSTS(\\d+)").exec(N.ErrorMessage))&&1<N.length&&(Qa=N[1]);return Qa}static Wcf(N){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,N)}static LAi(N){if(!N)return!1;N=N.toLowerCase();for(const Qa of sg.AppsForOfficeSingleSignOnManager.w4e)if(Qa===
N)return!0;return!1}}Object(e.a)(bh,"AppsforOfficeTokenFromOauthManager",null,[65]);class Af{constructor(N){this.VSi=N}static sra(){if(hc.AFrameworkApplication.fa.ra("AppForOfficeSSOV2IsEnabled")){var N=null;try{N=me.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Qa){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Qa)}N=new bh(N);Af.Oa=new Af(N)}}static getInstance(){Af.phe||(Af.sra(),Af.phe=!0);return Af.Oa}}Af.Oa=null;Af.phe=!1;Object(e.a)(Af,"AppsForOfficeOauthManagerFactory",
null,[41]);var lf=a(1368),Df=a(146);class mf{constructor(N,Qa,Db,fc){this.menuItemId=N;this.cF=Qa;this.R2j=Db;this.DRh=fc}}Object(e.a)(mf,"NewDocumentParameters",null,[]);const Hf=N=>{var Qa=N.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Db=Qa.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Db.addParameter("shortcuts","String[]",1,null,0);Qa.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);Db=Qa.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Db.addParameter("shortcuts","Object",1,null,0);Qa=N.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Db=Qa.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Db.addParameter("pickerCustomizationJsonString","String",1,null,0);Qa=N.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",
3,2);Db=Qa.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Db.addParameter("appName","String",1,null,0);Db.addParameter("target","String",1,null,0);Qa=N.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);Qa.addProperty("Data",4,"String",1,!1,null,0);Qa=N.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",
3,2);Db=Qa.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Db.addParameter("data","String",1,null,0);Qa.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Qa.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);Qa=N.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Db=Qa.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",
4);Db.addParameter("batchId","String",1,null,0);Db=Qa.addMethod("StartCopilotOperation",4,"Void",0,0,"StartCopilotOperation",4);Db.addParameter("batchId","String",1,null,0);Qa.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Qa.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);Qa.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);Qa=N.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}",
"",3,0);Db=Qa.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Db.addParameter("base64File","String",1,null,0);Qa=N.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Qa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Db=Qa.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Db.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Qa=
N.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Qa.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Db=Qa.addMethod("Register",1,"Void",0,0,"Register",0);Db.addParameter("metadata","String",1,null,0);Db.addParameter("javascript","String",1,null,0);Qa=N.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Qa.addProperty("Enabled",
1,"Boolean",1,!1,null,0);Qa.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Qa.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Qa=N.addEnumType("Microsoft.Authentication.IdentityType");Qa.addEnumField("OrganizationAccount",0);Qa.addEnumField("MicrosoftAccount",1);Qa=N.addEnumType("Microsoft.Authentication.AuthorityType");Qa.addEnumField("External",0);Qa.addEnumField("Msa",1);Qa.addEnumField("Aad",2);Qa=N.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}",
"{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Qa.addProperty("DisplayName",4,"String",1,!1,null,0);Qa.addProperty("Email",3,"String",1,!1,null,0);Qa.addProperty("FederationProvider",2,"String",1,!1,null,0);Qa.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Qa=N.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Qa.addProperty("AppId",4,"String",1,!1,null,0);Qa.addProperty("Authority",
2,"String",1,!1,null,0);Qa.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Qa.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Qa.addProperty("TenantId",6,"String",1,!1,null,0);Qa.addProperty("Upn",1,"String",1,!1,null,0);Qa=N.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Qa.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,
null,0);Db=Qa.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Db.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Qa.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);Qa.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Qa=N.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",
2,0);Qa.addProperty("AuthChallenge",3,"String",1,!1,null,0);Qa.addProperty("CorrelationId",7,"String",1,!1,null,0);Qa.addProperty("Policy",4,"String",1,!1,null,0);Qa.addProperty("Resource",2,"String",1,!1,null,0);Qa.addProperty("Scope",5,"String",1,!1,null,0);Qa.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Qa=N.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Qa.addProperty("AccessToken",2,"String",1,
!1,null,0);Qa.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Qa=N.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Qa.addProperty("Id",1,"String",1,!0,null,0);Qa.addProperty("Value",2,"Object",1,!1,null,0);Qa=N.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Db=Qa.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Db.addParameter("id",
"String",1,null,0);Db=Qa.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Db.addParameter("id","String",1,null,0);Qa=N.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Qa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Db=Qa.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Db.addParameter("appRuntimeState",
"Microsoft.AppRuntime.AppRuntimeState",1,null,0);Qa=N.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Qa.addEnumField("Inactive",0);Qa.addEnumField("Background",1);Qa.addEnumField("Visible",2);Qa=N.addEnumType("Microsoft.AppRuntime.Visibility");Qa.addEnumField("Hidden",1);Qa.addEnumField("Visible",2);Qa=N.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Qa.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",
3,!0,null,0);Db=Qa.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Db.addParameter("jsonCreate","String",1,null,0);Db=Qa.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Db.addParameter("jsonUpdate","String",1,null,0);Db=Qa.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Db.addParameter("id","String",1,null,0);Db=Qa.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Db.addParameter("id","String",1,null,
0);Qa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Qa=N.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Qa.addProperty("Id",2,"String",1,!0,null,0);Db=Qa.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Db.addParameter("visibility","Boolean",1,null,0);Qa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Qa=N.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Qa.addProperty("Enabled",3,"Boolean",
1,!1,null,0);Qa.addProperty("Id",2,"String",1,!0,null,0);Qa.addProperty("Label",4,"String",1,!0,null,0);Db=Qa.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Db.addParameter("enabled","Boolean",1,null,0);Qa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Qa=N.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Qa.addMethod("GetCount",3,"Int32",1,1,"Count",0);Db=Qa.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Db.addParameter("key",
"String",1,null,0);Qa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Qa.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Qa=N.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Qa.addEnumField("Unknown",0);Qa.addEnumField("Basic",1);Qa.addEnumField("Premium",2);Qa=N.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Db=Qa.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);Db.addParameter("feature","String",1,null,0);Db.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Db=Qa.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Db.addParameter("feature","String",1,null,0);Db=Qa.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Db.addParameter("feature","String",1,null,0);Db.addParameter("fallbackValue","Boolean",1,null,0);Qa.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Db=Qa.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Db.addParameter("experienceId","String",1,null,0);Db=Qa.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Db.addParameter("feature","String",1,null,0);Qa=N.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Qa.addProperty("Id",5,"String",1,!0,null,0);Qa.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);Qa.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Qa=N.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);Qa.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Qa=N.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",
3,0);Qa.addMethod("Disable",3,"Void",0,1,"Disable",0);Qa.addMethod("Enable",2,"Void",0,1,"Enable",0);Qa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var hf=a(189);class Kf{constructor(N,Qa){this.vKg=N;this.QKg=Qa}createAndOpenWorkbook(N){if(N&&N.length>this.vKg)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",N.length),OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.invalidArgument,hf.a.ha(1769));const Qa=new mf("blank","agave",N?"streamBase64":"streamEmpty",
N);let Db=null;return OfficeExtension.WacRuntime.Utility.createPromise((fc,vc)=>{const Rc=new Df.StandardDialog;Rc.rc=4;Rc.vm(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,cd=>{2===cd||0===cd?vc("Cancelled"):(Db=window.open(""),this.QKg.create(fc,vc,Qa).v4a())})}).then(fc=>{if(!fc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.generalException,hf.a.ha(1765));try{Db.top.location.href=fc}catch(vc){n.ULS.sendTraceTag(538572820,0,10,
"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",ih.a.rp,vc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Db.location.replace(fc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},fc=>{if("Cancelled"===fc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.nLd,hf.a.ha(1768));Db.close();this.d6j();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 1:return this.Olh(Qa)}N=this.invokeMethod(N,
Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Olh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.createAndOpenWorkbook(N)}d6j(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.generalException,hf.a.ha(1765));}}Object(e.a)(Kf,"WacWorkbook",null,[]);const Dg=(N,Qa)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof N+", objectId="+N+", value="+Qa);return null},Ng=N=>{N.add("InternalTest",
"PreviewExecutionMethod",Dg)};var Jf=a(261),Lf=a(760),Qh=a(761);class rh{constructor(N){this.Jb=N}get $(){return this.Jb}}Object(e.a)(rh,"RichApiPreviewExecutionContext",null,[]);var Jh=a(25),lg=a(1011),Lg=a(215),Rg=a(219),gg=a(132),Sg=a(13);class oh extends Rg.a{constructor(N,Qa,Db,fc,vc){super(N,"Select Data");this.Ktb=null;this.FRe=Qa;this.Kcd=Db;this.oc=vc;this.callback=fc}get Qc(){return"DdaBindingPrompt"}start(N,Qa){let Db="<div class='"+gg.a.pGh+" "+Jg.a.Eu+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+
gg.a.iL+"' /></div>";Db=String.format(Db,fg.a.ki(this.Kcd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.oc.Oh(this.zc,Db);this.Ktb=Sg.DOMElementExtensions.getElementById(this.zc,"bindingText");N=Qa?N.z6a(Qa,this.Kcd.DdaBindingsMethod.BindingId):null;(null===N||void 0===N?0:N.IsValidRef)?(Qa=new Jh.Range(N.Reference.FirstRow+1,N.Reference.FirstColumn+1,N.Reference.LastRow+1,N.Reference.LastColumn+1,!1,!1),this.Ktb.value=N.Reference.SheetName+"!"+Qa):(N=Od.h(this.$).ga,this.Ktb.value=
gi.f(this.$.na)||!N.pa.Lh?"":N.Dka);this.initialize();this.Rg()}cr(){this.s8c();this.addButton(0);this.addButton(1);super.cr()}setFocus(){Sg.DOMElementExtensions.setFocus(this.Ktb)}validate(){return!0}commit(){let N=this.Ktb.value.trim();const Qa=N.indexOf("!");-1!==Qa&&(N=this.vei(N.substring(0,Qa))+N.substr(Qa));this.FRe.addBinding(this.Kcd,N,0,this.callback);return!0}uva(){this.FRe.ER.kg(Lf.a.internalError,this.callback);super.uva()}vei(N){N=ua.a.trimStart(N.trim(),"=");return N.length?N.startsWith("'")&&
N.endsWith("'")?N:Zc.HelperMethods.Edc(N):""}}Object(e.a)(oh,"DdaBindingPrompt",Rg.a,[]);class Bh{constructor(N){this.ea=N}kg(N,Qa){if(Qa){const Db={};Db.Error=N;Db.Version=this.ea.We;Qa(Db)}}iNa(N,Qa){this.kg(N,Qa)}CI(N,Qa){this.kg(Lf.a.c6e(N.Errors[0].MessageId),Qa)}Gw(N){N&&N(this.sR())}sR(){const N={Error:0};N.Version=this.ea.We;return N}}Object(e.a)(Bh,"DdaErrorGenerator",null,[]);var Ig=a(230);class Ph{constructor(N,Qa,Db){this.$=N;this.ER=Qa;this.tB=Db}wGd(N,Qa){const Db=N.DdaGoToByIdMethod.GoToType,
fc=N.DdaGoToByIdMethod.SelectionMode,vc=N.DdaGoToByIdMethod.Id.toString().trim(),Rc=cd=>{const dd=this.$.ua.getItemByName(cd.SheetName);(null===dd||void 0===dd?0:dd.visible)?(Od.h(this.$).qh(cd,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.ER.Gw(Qa)):this.ER.kg(Lf.a.ibh,Qa)};0===Db?this.KXi(vc,fc,N.DdaMethod.ControlId,Rc,Qa):1===Db?this.OXi(vc,fc,Rc,Qa):this.ER.kg(Lf.a.Ack,Qa)}KXi(N,Qa,Db,fc,vc){this.tB.ddaGetBinding(Db,N,Rc=>{if(!Ig.a(Rc)&&Rc.Result&&Rc.Result.Reference){Rc=
Rc.Result;var cd={};cd.SheetName=Rc.Reference.SheetName;cd.FirstRow=Rc.Reference.FirstRow;cd.FirstColumn=Rc.Reference.FirstColumn;cd.LastRow=Rc.Reference.LastRow;cd.LastColumn=Rc.Reference.LastColumn;Ph.n3c(cd,Qa);1!==Rc.BindingType?fc(cd):this.tB.ddaGetBindingData(Db,N,1,0,2,0,0,-1,-1,dd=>{Ig.a(dd)||!dd.Result?this.ER.CI(dd,vc):(dd=dd.Result,2!==Qa&&(cd.FirstRow-=dd.Headers.length,0>cd.FirstRow&&(cd.FirstRow=0)),fc(cd))},vc)}else this.ER.iNa(Lf.a.mkg,vc)},vc)}OXi(N,Qa,Db,fc){var vc=Nh.A(N);vc?(vc=
Nh.v(vc,this.$),Ph.n3c(vc,Qa),Db(vc)):this.$.ea.isNamedObjectViewMode&&this.$.Zb.fl(N)?this.$.Zb.na=this.$.Zb.getItemByName(N):(vc=Rc=>{Ig.a(Rc)||!Rc.Result?this.$.ua.contains(N)?(Rc={},Rc.SheetName=N,Rc.FirstRow=0,Rc.FirstColumn=0,Rc.LastRow=0,Rc.LastColumn=0,Db(Rc)):this.ER.iNa(Lf.a.mkg,fc):(Rc=Rc.Result,Ph.n3c(Rc,Qa),Db(Rc))},this.$.ua.na?this.tB.parseRangeForGoto(N,this.$.ua.na.name,vc,fc):this.tB.parseRange(N,vc,fc))}static n3c(N,Qa){N.LastRow=2===Qa?N.FirstRow:N.LastRow;N.LastColumn=2===Qa?
N.FirstColumn:N.LastColumn}}Object(e.a)(Ph,"DdaNavigator",null,[]);const oj=(N,Qa,Db,fc,vc,Rc)=>{const cd=N.Pa(1);cd.request=Qa;return Og.g(N,"ExecuteRichApiRequest",cd,Db,fc,vc,Rc,0)};var pj=a(305),ej;(function(N){N[N.unsupported=0]="unsupported";N[N.surface=1]="surface";N[N.combo=2]="combo";N[N.column=3]="column";N[N.column3D=4]="column3D";N[N.bar=5]="bar";N[N.bar3D=6]="bar3D";N[N.line=7]="line";N[N.line3D=8]="line3D";N[N.pie=9]="pie";N[N.pie3D=10]="pie3D";N[N.scatter=11]="scatter";N[N.bubble=12]=
"bubble";N[N.area=13]="area";N[N.area3D=14]="area3D";N[N.doughnut=15]="doughnut";N[N.radar=16]="radar";N[N.stock=17]="stock";N[N.waterfall=18]="waterfall";N[N.funnel=19]="funnel";N[N.treemap=20]="treemap";N[N.sunburst=21]="sunburst";N[N.boxWhisker=22]="boxWhisker";N[N.histogram=23]="histogram";N[N.pareto=24]="pareto";N[N.regionMap=25]="regionMap";N[N.noVisibleSeries=26]="noVisibleSeries";N[N.complexDataSource=27]="complexDataSource";N[N.pivotChart=28]="pivotChart"})(ej||(ej={}));Object(e.b)("ChartCategory",
ej);class qj{constructor(N,Qa){this.source=N;this.eventId=Qa}}Object(e.a)(qj,"MacroRecorderEventData",null,[]);class yh{constructor(N,Qa,Db){this.parentName=N;this.$=Qa;this.request=Db}Lci(N){var Qa;if(void 0===N||null===N||void 0===N.RequestBody||null===N.RequestBody)return null;const Db=JSON.parse(N.RequestBody);if(void 0!==N.ActiveFloatingObjectId&&null!==N.ActiveFloatingObjectId){Db.ActiveFloatingObjectId=N.ActiveFloatingObjectId;const fc=Od.h(this.$).ga.Sa.Fc;if(null===(Qa=null===fc||void 0===
fc?void 0:fc.floatingObject)||void 0===Qa?0:Qa.Kd)Db.ActiveChartType=ej[fc.floatingObject.Kd.ChartCategory]}void 0!==N.SheetMultiRange&&null!==N.SheetMultiRange&&(Db.SheetName=N.SheetMultiRange.SheetName);return Db}Xci(N){if(void 0===N||null===N||void 0===N.Result||null===N.Result)return null;N=N.Result;return void 0===N.ResponseBody||null===N.ResponseBody||N.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(N.ResponseBody.join(""))}dGi(N){return!!N&&!(void 0===N.eventId||null===N.eventId)&&
0<N.eventId.length}Mk(N){return()=>{if(this.$.Wda){const Qa=this.p8g(this.request);if(this.dGi(Qa)){const Db=this.Lci(this.request),fc=this.Xci(N);if(Db&&!Ai.a.isEmpty(Db)&&fc&&!Ai.a.isEmpty(fc))return n.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new W(Qa,Db,fc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Db?"(not null)":"(null)"}; responseInfo: ${fc?"(not null)":"(null)"}`}`)}}return new W(null,
null,null)}}p8g(N){const Qa=this.eGi(N.SolutionId),Db=yh.rci(N);if(Db&&Qa)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Db,["request.SolutionId"]:N.SolutionId})}`),new qj(N.SolutionId,Db);N=JSON.stringify({["recorderEventId"]:Db,["isRecorderAwareAddin"]:Qa,["request.SolutionId"]:N.SolutionId});n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${N}`);return null}eGi(N){if(!N)return!1;N=N.toLowerCase();return yh.Bii().contains(N)}static Bii(){yh.BCa||
(yh.BCa=new w.a(L.a.Ah()),yh.BCa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),yh.BCa.add("fa000000005"),yh.BCa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),yh.BCa.add("fa000000014"),yh.BCa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return yh.BCa}static rci(N){let Qa=null;var Db=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Db.test(N.RequestBody))Qa=Db.exec(N.RequestBody)[1];else{N=N.RequestHeaders;if(!N)return Qa;Db=$b.a.z_i.toLowerCase();for(let fc=0;fc<N.length;fc++)if(N[fc].Name.toLowerCase()===
Db){Qa=N[fc].Value;break}}return Qa}}yh.BCa=null;Object(e.a)(yh,"DdaRichApiRequestRecorder",null,[]);class rj extends pj.a{constructor(N,Qa,Db,fc,vc,Rc,cd,dd){super(10,0,Qa,dd);this.vqb=Db;this.Lmb=fc;this.L5=vc;this.xIa=Rc;this.request=cd;this.dVd=new yh("10",N,cd)}get iKc(){return this.xIa}get pH(){return this.vqb}get ila(){return this.Lmb}Y4(N){return super.Y4(N)||this.eah(N)}Mk(){return this.dVd.Mk(this.Zd)}$ib(){const N={OperationType:3};N.RichApiRequest=this.request;return N}eah(N){return(Qa,
Db,fc)=>oj(N,this.request,Vf.b(Qa,this.vqb),Vf.a(Db,this.Lmb),fc,this.L5)}}Object(e.a)(rj,"DdaRichApiRequestBatchOperation",pj.a,[]);class sj extends Uh.a{constructor(N,Qa,Db,fc){super(576,0,Db,fc);this.dVd=new yh("576",N,Qa)}Mk(){return this.dVd.Mk(this.Zd)}}Object(e.a)(sj,"DdaRichApiRequestOperation",Uh.a,[]);class tj{constructor(N,Qa){this.xJ=(Db,fc)=>{this.ER.iNa(Lf.a.internalError,fc)};this.$=N;this.ER=Qa}ddaAddBinding(N,Qa,Db,fc,vc,Rc,cd){this.jL((dd,Hd,Zd)=>{var Fe=this.$.qa.va,Ne=this.$la();
dd=Vf.b(dd,Rc);Hd=Vf.a(Hd,this.xJ);const sf=Fe.Pa(9);sf.controlId=N;sf.bindingId=Qa;sf.bindingType=Db;sf.currentSheetName=Ne;sf.formula=fc;sf.options=vc;return Og.g(Fe,"DdaAddBinding",sf,dd,Hd,Zd,cd,0)},cd,563)}ddaReleaseBinding(N,Qa,Db,fc){this.jL((vc,Rc,cd)=>{var dd=this.$.qa.va;vc=Vf.b(vc,Db);Rc=Vf.a(Rc,this.xJ);const Hd=dd.Pa(9);Hd.controlId=N;Hd.bindingId=Qa;return Og.g(dd,"DdaReleaseBinding",Hd,vc,Rc,cd,fc,0)},fc,564)}ddaGetBinding(N,Qa,Db,fc){this.jL((vc,Rc,cd)=>{var dd=this.$.qa.va;vc=Vf.b(vc,
Db);Rc=Vf.a(Rc,this.xJ);const Hd=dd.Pa(1);Hd.controlId=N;Hd.bindingId=Qa;return Og.g(dd,"DdaGetBinding",Hd,vc,Rc,cd,fc,0)},fc,565,16)}ddaGetAllBindings(N,Qa,Db){this.jL((fc,vc,Rc)=>{var cd=this.$.qa.va;fc=Vf.b(fc,Qa);vc=Vf.a(vc,this.xJ);const dd=cd.Pa(1);dd.controlId=N;return Og.g(cd,"DdaGetAllBindings",dd,fc,vc,Rc,Db,0)},Db,566,16)}ddaGetBindingData(N,Qa,Db,fc,vc,Rc,cd,dd,Hd,Zd,Fe){this.jL((Ne,sf,vg)=>{var hg=this.$.qa.va,Wf=this.$la();Ne=Vf.b(Ne,Zd);sf=Vf.a(sf,this.xJ);const bg=hg.Pa(1);bg.controlId=
N;bg.bindingId=Qa;bg.coerceType=Db;bg.valueFormat=fc;bg.filterType=vc;bg.startRow=Rc;bg.startCol=cd;bg.rowCount=dd;bg.colCount=Hd;bg.currentSheetName=Wf;return Og.g(hg,"DdaGetBindingData",bg,Ne,sf,vg,Fe,0)},Fe,567,16)}ddaSetBindingData(N,Qa,Db,fc,vc,Rc,cd){this.jL((dd,Hd,Zd)=>{var Fe=this.$.qa.va,Ne=this.$la();dd=Vf.b(dd,Rc);Hd=Vf.a(Hd,this.xJ);const sf=Fe.Pa(9);sf.controlId=N;sf.bindingId=Qa;sf.startRow=Db;sf.startCol=fc;sf.currentSheetName=Ne;sf.bindingData=vc;return Og.g(Fe,"DdaSetBindingData",
sf,dd,Hd,Zd,cd,0)},cd,568)}ddaGetSelectedData(N,Qa,Db,fc,vc,Rc,cd){this.jL((dd,Hd,Zd)=>{var Fe=this.$.qa.va,Ne=this.$la();dd=Vf.b(dd,Rc);Hd=Vf.a(Hd,this.xJ);const sf=Fe.Pa(1);sf.controlId=N;sf.coerceType=Qa;sf.valueFormat=Db;sf.filterType=fc;sf.currentSheetName=Ne;sf.formula=vc;return Og.g(Fe,"DdaGetSelectedData",sf,dd,Hd,Zd,cd,0)},cd,569,16)}ddaSetSelectedData(N,Qa,Db,fc,vc){this.jL((Rc,cd,dd)=>{var Hd=this.$.qa.va,Zd=this.$la();Rc=Vf.b(Rc,fc);cd=Vf.a(cd,this.xJ);const Fe=Hd.Pa(9);Fe.controlId=N;
Fe.currentSheetName=Zd;Fe.formula=Qa;Fe.bindingData=Db;return Og.g(Hd,"DdaSetSelectedData",Fe,Rc,cd,dd,vc,0)},vc,570)}ddaLoadSettings(N,Qa,Db){this.jL((fc,vc,Rc)=>{var cd=this.$.qa.va;fc=Vf.b(fc,Qa);vc=Vf.a(vc,this.xJ);const dd=cd.Pa(1);dd.controlId=N;return Og.g(cd,"DdaLoadSettings",dd,fc,vc,Rc,Db,0)},Db,501,16)}ddaSaveSettings(N,Qa,Db,fc,vc){this.jL((Rc,cd,dd)=>{var Hd=this.$.qa.va;Rc=Vf.b(Rc,fc);cd=Vf.a(cd,this.xJ);const Zd=Hd.Pa(9);Zd.controlId=N;Zd.settings=Qa;Zd.overwriteIfStale=Db;return Og.g(Hd,
"DdaSaveSettings",Zd,Rc,cd,dd,vc,0)},vc,571)}ddaAddRowsColumns(N,Qa,Db,fc,vc,Rc){this.jL((cd,dd,Hd)=>{var Zd=this.$.qa.va,Fe=this.$la();cd=Vf.b(cd,vc);dd=Vf.a(dd,this.xJ);const Ne=Zd.Pa(9);Ne.controlId=N;Ne.bindingId=Qa;Ne.isRow=Db;Ne.currentSheetName=Fe;Ne.bindingData=fc;return Og.g(Zd,"DdaAddRowsColumns",Ne,cd,dd,Hd,Rc,0)},Rc,572)}ddaDeleteAllDataValues(N,Qa,Db,fc){this.jL((vc,Rc,cd)=>{var dd=this.$.qa.va,Hd=this.$la();vc=Vf.b(vc,Db);Rc=Vf.a(Rc,this.xJ);const Zd=dd.Pa(9);Zd.controlId=N;Zd.bindingId=
Qa;Zd.currentSheetName=Hd;return Og.g(dd,"DdaDeleteAllDataValues",Zd,vc,Rc,cd,fc,0)},fc,573)}ddaClearBindingFormats(N,Qa,Db,fc){this.jL((vc,Rc,cd)=>{var dd=this.$.qa.va,Hd=this.$la();vc=Vf.b(vc,Db);Rc=Vf.a(Rc,this.xJ);const Zd=dd.Pa(9);Zd.controlId=N;Zd.bindingId=Qa;Zd.currentSheetName=Hd;return Og.g(dd,"DdaClearBindingFormats",Zd,vc,Rc,cd,fc,0)},fc,574)}ddaSetBindingFormats(N,Qa,Db,fc,vc,Rc){this.jL((cd,dd,Hd)=>{var Zd=this.$.qa.va,Fe=this.$la();cd=Vf.b(cd,vc);dd=Vf.a(dd,this.xJ);const Ne=Zd.Pa(9);
Ne.controlId=N;Ne.bindingId=Qa;Ne.currentSheetName=Fe;Ne.bindingData=Db;Ne.isSetFormats=fc;return Og.g(Zd,"DdaSetBindingFormats",Ne,cd,dd,Hd,Rc,0)},Rc,575)}parseRange(N,Qa,Db){this.jL((fc,vc,Rc)=>{const cd=this.$.qa.va.Bc();return Og.v(this.$.qa.va,N,-1,Vf.b(fc,Qa),Vf.a(vc,this.xJ),Rc,Db,cd)},Db,162,16)}parseRangeForGoto(N,Qa,Db,fc){this.jL((vc,Rc,cd)=>{const dd=this.$.qa.va.Bc();return Og.w(this.$.qa.va,N,Qa,Vf.b(vc,Db),Vf.a(Rc,this.xJ),cd,fc,dd)},fc,562,16)}executeRichApiRequest(N,Qa,Db){y.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(N.RequestFlags&=8191);if(y.EwaSettings.ya(233))this.HPh(this.$.qa.va.Bc(),Qa,()=>{this.ER.iNa(Lf.a.internalError,Db)},Db,N);else{let fc=qg.DdaFacade.iod(N);!this.$.Ob.xz||fc&16?(fc|=64,this.$.userOperationManager.lG(new sj(this.$,N,(vc,Rc,cd)=>oj(this.$.qa.va,N,Vf.b(vc,Qa),Vf.a(Rc,this.xJ),cd,Db),fc))):(this.ER.iNa(Lf.a.lLc,Db),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}$la(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}jL(N,Qa,Db,fc=
0){!this.$.Ob.xz||fc&16?this.$.userOperationManager.lG(new Uh.a(Db,0,N,fc|64)):(this.ER.iNa(Lf.a.lLc,Qa),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}HPh(N,Qa,Db,fc,vc){let Rc=qg.DdaFacade.iod(vc);if(!this.$.Ob.xz||Rc&16){var cd=this.$.nc.qd("UserAction","Rich Api request");this.$.userOperationManager.kd(new rj(this.$,N,Qa,Db,fc,cd,vc,Rc|64),null)}else this.ER.iNa(Lf.a.lLc,fc),n.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(e.a)(tj,"DdaWebServiceHelper",
null,[]);class uj{constructor(N,Qa,Db,fc){this.rRh=N;this.fileSize=Qa;this.p_j=fc}}Object(e.a)(uj,"DocumentFile",null,[]);class Oh{}Oh.generalException="GeneralException";Oh.C0g="ApiNotFound";Oh.nLd="OperationCancelled";Oh.invalidArgument="InvalidArgument";Object(e.a)(Oh,"ErrorCodes",null,[]);class kj{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(e.a)(kj,"WacApiDelegates",null,[]);var Kj=a(633);class fj extends kj{constructor(N,Qa){super();this.zuf=(Db,fc)=>{Db=fj.hkh(Db,fc);if(!Kj.a(this.$,Db))return!0;Db=this.$.shortcutKeyManager.wef(Db);return!!Db&&0<Db.length};this.addinId=N;this.$=Qa}replaceShortcuts(N){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,N,this.zuf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(N){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(N,
this.zuf)}static Ioh(N,Qa){const Db=document.createEvent("KeyboardEvent");if(ih.a.IG)Db.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(N&8),!!(N&32),!!(N&4),!!(N&256));else{const fc=[];N&4&&fc.push("Shift");N&8&&fc.push("Control");N&32&&fc.push("Alt");Db.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,fc.join(" "),!1,"en-US")}N=new Sys.UI.DomEvent(Db);N.keyCode=Qa;return N}static hkh(N,Qa){if(ih.a.ng)switch(Qa){case 189:Qa=173;break;case 187:Qa=61;break;case 186:Qa=59}return fj.Ioh(N,
Qa)}}Object(e.a)(fj,"ExcelWacApiDelegates",kj,[]);class Gh{constructor(N){this.TLa={};this.GUi=N}MSg(N,Qa){this.Ujc(N)||(this.TLa[N]={});if(this.KAi(N))return n.ULS.sendTraceTag(537163157,344,50,`App ${N} has reach the limit of number of cached files.`),Lf.a.mVi;this.TLa[N][Qa.rRh.toString()]=Qa;return Lf.a.success}z4h(N,Qa){let Db=null;this.Ujc(N)&&(Db=this.TLa[N][Qa.toString()]);Db||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${N}, fileHandler:${Qa}] doesn't exist`);return Db}Ujc(N){return N in
this.TLa}mvj(N,Qa){if(this.Ujc(N)){const Db=this.TLa[N];delete Db[Qa.toString()];1>Object.keys(Db).length&&delete this.TLa[N];return Qa.toString()in Db?Lf.a.internalError:Lf.a.success}return Lf.a.internalError}KAi(N){return this.Ujc(N)?Object.keys(this.TLa[N]).length>=this.GUi:!1}static getInstance(N){return N.da.Ba(200)||N.da.Ja(200,new Gh(Gh.HUi))}static tYi(){return++Gh.m$g}}Gh.hUi=4194304;Gh.HUi=1;Gh.m$g=0;Object(e.a)(Gh,"GetFileApiHelper",null,[]);class vj{constructor(N){this.px=N}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.px)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){switch(N){case 1:return this.$Yi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){N=this.invokeMethod(N,
Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}$Yi(){this.notifyActionHandlerReady();return null}}Object(e.a)(vj,"AddinInternalService",null,[]);class wj{constructor(N,Qa){this.JH=Qa;this.px=N}getAppRuntimeState(){return this.JH.getAppRuntimeState(this.px)?2:1}setAppRuntimeState(N){switch(N){case 2:N=!0;break;case 1:N=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.invalidArgument,hf.a.ha(1769));}this.JH.setAppRuntimeState(this.px,N)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,Qa){switch(N){case 2:return this.C_h();case 1:return this.uLj(Qa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,
Qa){N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}C_h(){return this.getAppRuntimeState()}uLj(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"int");this.setAppRuntimeState(N);return null}}Object(e.a)(wj,"AppRuntimeService",null,[]);var lj=a(1012);class xj{constructor(N,Qa,Db,fc){this.Ey=N;this.z3=Db;this.Yz=fc.Lf.getOsfControl(Qa)}disable(){try{if(!hf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qOe();
if(!this.Wtf())return this.rOe();this.z3.Dbk(this.Ey)}catch(N){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",N.message||"Unknown"),this.oOe()}return null}enable(){try{if(!hf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qOe();if(!this.Wtf())return this.rOe();this.z3.etj(this.Ey)}catch(N){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
N.message||"Unknown"),this.oOe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,
Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){switch(N){case 1:return this.tFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 3:return this.Qxh();case 2:return this.JCh()}N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Qxh(){return this.disable()}JCh(){return this.enable()}tFa(){this._OnAccess();return null}qOe(){return lj.a(xe.a.notImplemented,
hf.a.ha(1770))}rOe(){return lj.a(xe.a.sharedRuntimeNotAvailable,hf.a.ha(1774))}oOe(){return lj.a(xe.a.generalException,hf.a.ha(1765))}Wtf(){const N=this.Yz.getSharedRuntimeId();return!!N&&0<N.length}}Object(e.a)(xj,"BeforeDocumentCloseNotification",null,[]);class yj{constructor(){this.Vre=this.cme=this.Xo=!1}get enabled(){return this.Xo}set enabled(N){this.Xo=N}get nativeRuntime(){return this.cme}set nativeRuntime(N){this.cme=N}get streamingEnabled(){return this.Vre}set streamingEnabled(N){this.Vre=
N}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(N){switch(N){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Qa){switch(N){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Qa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Qa){N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(yj,"CustomFunctionEngineStatus",null,[]);class zj{constructor(N,Qa,Db){this.FIg=N;this.GIg=Qa;this.DMg=Db}get status(){const N=new yj;N.enabled=this.FIg;N.streamingEnabled=this.GIg;N.nativeRuntime=!1;return N}register(N){return OfficeExtension.WacRuntime.Utility.createPromise(this.DMg(N))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(N){switch(N){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 1:return this.Ytj(Qa)}N=this.invokeMethod(N,
Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Ytj(N){const Qa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"string");return this.register(Qa,N)}}Object(e.a)(zj,"CustomFunctionManager",null,[]);var Lj=a(992);class Aj{constructor(N,Qa,Db,fc){this.Jbe="";this.zYb=0;this.tQ=N;this._id=Qa;this.px=Db;this.JH=fc}get id(){return this._id}_RegisterStateChange(){this.zYb||this.tQ.execute(N=>
{this.Jbe=N.JTa(this._id,Qa=>{this.JH.ATh(this.px,this._id,JSON.stringify(Qa))})});this.zYb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.zYb--;this.zYb||this.tQ.execute(N=>{N.xRd(this._id,this.Jbe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(N){switch(N){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 6:return this.fCg();case 7:return this.iCg()}N=
this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}fCg(){return this._RegisterStateChange()}iCg(){return this._UnregisterStateChange()}}Object(e.a)(Aj,"LicenseFeature",null,[]);class Bj{constructor(N,Qa){this.tQ=me.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.px=N;this.JH=Qa;this.tLg=this.JH.Lf.getOsfControl(this.px)}getFeatureTier(N,Qa){return OfficeExtension.WacRuntime.Utility.createPromise(Db=>{const fc=1===Qa?1:2===
Qa?2:0;this.tQ.execute(vc=>{vc.getFeatureTier(N,fc).then(Rc=>{Db(this.W8h(Rc))},()=>{Db(Qa)})})})}getLicenseFeature(N){N=new Aj(this.tQ,N,this.px,this.JH);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}isFeatureEnabled(N,Qa){return OfficeExtension.WacRuntime.Utility.createPromise(Db=>{this.tQ.execute(fc=>{fc.isFeatureEnabled(N,Qa).then(vc=>{Db(vc)},()=>{Db(Qa)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(N=>{this.tQ.execute(Qa=>{Qa=
Qa.isFreemiumUpsellEnabled();N(Qa)})})}launchUpsellExperience(N){if(this.tLg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.tQ.execute(Qa=>{Qa.launchUpsellExperience(N)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.r0c,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,Qa){switch(N){case 6:return this.gCg(Qa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 2:return this.s5h(Qa);case 5:return this.V8h(Qa);
case 1:return this.yBi(Qa);case 3:return this.oCi();case 4:return this.wMi(Qa)}N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}s5h(N){const Qa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"int");return this.getFeatureTier(Qa,N)}V8h(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.getLicenseFeature(N)}yBi(N){const Qa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,
0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"boolean");return this.isFeatureEnabled(Qa,N)}oCi(){return this.isFreemiumUpsellEnabled()}wMi(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.launchUpsellExperience(N)}gCg(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");this._TestFireStateChangedEvent(N);return null}W8h(N){switch(N){case 1:return 1;case 2:return 2;default:return 0}}}Object(e.a)(Bj,"License",
null,[]);var Mj=a(167);const Nj=(N,Qa,Db)=>fc=>(vc,Rc)=>{ab.TaskExtensions.za(mc.GetServiceTaskFactory.create(Qa.da,279,Qa.ka,1),cd=>{cd=cd.result;let dd=!1;var Hd=Db.Lf.getOsfControl(N);let Zd=null;Hd&&(Zd=Hd.getStoreType(),(Hd=Hd.getManifest())&&Hd.getSharedRuntimeForCustomFunctions("Workbook")&&(dd=!0));ab.TaskExtensions.za(cd.jnf(N,Zd,fc,dd),Fe=>{Mj.b(Fe)?Fe.result?vc(null):Rc(OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.invalidArgument,cf.a.instance.ha(1769))):Rc(OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.generalException,
cf.a.instance.ha(1765)))},Qa.ka,3)},Qa.ka,3)};class Cj{constructor(N){if(!N)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.EEd=N}areShortcutsInUse(N){return OfficeExtension.WacRuntime.Utility.createPromise((Qa,Db)=>{this.EEd.checkShortcutsInUse(N).then(fc=>{Qa(fc)}).catch(fc=>{Db(fc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((N,Qa)=>{this.EEd.getShortcuts().then(Db=>{N(Db)}).catch(Db=>{Qa(Db)})})}replaceShortcuts(N){return OfficeExtension.WacRuntime.Utility.createPromise((Qa,
Db)=>{this.EEd.replaceShortcuts(N).then(()=>{Qa(null)}).catch(fc=>{Db(fc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Qa){switch(N){case 3:return this.s2g(Qa);case 1:return this.Aei();case 2:return this.LAj(Qa)}N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}s2g(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"Array<string>");return this.areShortcutsInUse(N)}Aei(){return this.getShortcuts()}LAj(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"any");return this.replaceShortcuts(N)}}Object(e.a)(Cj,"ActionService",
null,[]);class Dj{constructor(){this.data=null}}Object(e.a)(Dj,"AugLoopHostMessageReceivedEventArgs",null,[]);var Ej=a(1013);class Ei{constructor(N,Qa=!1,Db=null){this.bGa=N;this.MZa=Qa;this.RPc=Db||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(N){this.MZa||Ej.a.cKj(N)}_RegisterHostMessageReceivedEvent(){this.MZa||(Ei.C2f||(Ej.a.Qtj(N=>{this.RPc.fireEvent("",65542,Object.assign(new Dj,{data:N}))}),Ei.C2f=!0),this.RPc.register(this.bGa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.MZa||
this.RPc.unregister(this.bGa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,
Qa){switch(N){case 1:return this.SJj(Qa);case 2:return this.eCg();case 3:return this.hCg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}SJj(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");this.sendMessage(N);return null}eCg(){this._RegisterHostMessageReceivedEvent();return null}hCg(){this._UnregisterHostMessageReceivedEvent();
return null}}Ei.C2f=!1;Object(e.a)(Ei,"AugLoopEventService",null,[]);var Oj=a(797),Fj=a(528);class Fi{constructor(N,Qa,Db){this.WVc=this.fge=null;this.bGa=N;this.qne=Qa;if(this.Ta=Db)this.fge=this.Ta.Va("GetAccessTokenOAuthFirstPartyAllowList")}O$h(){this.WVc||(this.WVc=Fj.a.dr(me.a.instance.qc("Common.App.OAuth.IOAuthManager")));return this.WVc}yCi(N,Qa){if(!this.qne||""===this.bGa||!this.Ta)return!1;const Db=this.qne.getOsfControl(this.bGa);if(!Db)return!1;let fc=!1;this.fge.split(";").forEach(vc=>
{Qa===vc&&(fc=!0)});return this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===hc.AFrameworkApplication.sa.Qa.Ii&&Db.isFirstParty()&&N===Fi.Z_g&&fc&&Vg.d(Db.getSolutionId())===Fi.$_g}getAccessTokenFirstPartyOAuth(N,Qa){let Db;Db=this.yCi(N,Qa)?fc=>{const vc=this.O$h();vc.continueWith(()=>{vc.result.dD(N,Qa).then(Rc=>{fc(Rc);return Rc})})}:fc=>{fc(Object.assign(new Oj.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Db)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Qa){switch(N){case 1:return this.wZh(Qa)}N=this.invokeMethod(N,
Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}wZh(N){const Qa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"string");return this.getAccessTokenFirstPartyOAuth(Qa,N)}}Fi.Z_g="Maker";Fi.$_g="fa000000043";Object(e.a)(Fi,"Auth",null,[]);class Gj{constructor(){this.aua=null}mei(){this.aua||(this.aua=Fj.a.dr(me.a.instance.qc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.aua}getSharedFilePickerResponse(N){return OfficeExtension.WacRuntime.Utility.createPromise((Qa,
Db)=>{try{const fc=this.mei();ke.Task.WAA.call(null,fc).continueWith(()=>{const vc=fc.result;if(vc){let Rc={};({qt:Rc}=Bg.d(N)).returnValue?vc.Jmd(Rc).then(cd=>{cd&&0<cd.length?Qa(cd):Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(cd=>{Db(cd)}):Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(fc){Db(fc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Qa){this.invokePropertySet(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Qa){switch(N){case 1:return this.lei(Qa)}N=this.invokeMethod(N,Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}lei(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.getSharedFilePickerResponse(N)}}Object(e.a)(Gj,"SharedFilePicker",null,[]);class Hj{createInstance(N,Qa,Db="",fc=null,vc=null){switch(N){case "Microsoft.Office.ActionService":return new Cj(Qa);case "Microsoft.Office.SharedFilePicker":return new Gj;case "Microsoft.Office.Auth":return new Fi(Db,
fc,vc);case "Microsoft.Office.AugLoopEventService":return new Ei(Db)}return null}}Object(e.a)(Hj,"WacApiHost",null,[]);class Ij{constructor(N,Qa,Db,fc,vc){this.X2b=null;this.FWb=N;this.px=Qa;this.JH=Db;this.Jb=fc;this.Tte=vc}hostName(){return"ExcelOnline"}appId(){return this.FWb}createInstance(N){switch(N){case "Microsoft.Authentication.AuthenticationService":return me.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.px,this.JH.Lf);case "Microsoft.Authentication.TokenParameters":return new Sf;
case "Microsoft.ExcelServices.CustomFunctionManager":N=y.EwaSettings.ya(114);var Qa=y.EwaSettings.ya(115);return new zj(N,Qa,Nj(this.FWb,this.Jb,this.JH));case "Microsoft.AppRuntime.AppRuntimeService":return new wj(this.px,this.JH);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return N=Jf.a(this.Jb),new xj(this.FWb,this.px,N,this.JH);case "Microsoft.DynamicRibbon.DynamicRibbon":return N=Jf.a(this.Jb),new Lj.DynamicRibbon(this.FWb,this.px,this.JH,N,N.Ln(this.px).Ol);
case "Microsoft.Office.Licensing.License":return new Bj(this.px,this.JH);case "Microsoft.InternalService.AddinInternalService":return new vj(this.px);case "Microsoft.Office.AugLoopEventService":const Db=Jf.a(this.Jb),fc=Db.Ln(this.px).Ol;Qa=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===fc.PrimaryMarketplace.SolutionId&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.Jb.xa.DocumentHostInfo.HostTier||"Dogfood"===hc.AFrameworkApplication.Nc.AudienceGroup);
if(Di.a(fc)||Qa())return N=vc=>(Rc,cd,dd)=>{Db.Vh.rhf({actionType:vc,controlId:Rc,messageType:dd,targetId:cd,message:""})},N={register:N(1),unregister:N(2),fireEvent:(vc,Rc,cd)=>{Db.Vh.HL(Rc,vc)&&Db.pG(Rc,vc,JSON.stringify(cd))}},new Ei(this.px,!1,N);break;default:if(this.X2b||(this.X2b=new Hj),hc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)){if(Qa=this.X2b.createInstance(N,this.Tte,this.px,this.JH.Lf,hc.AFrameworkApplication.fa))return Qa}else if(Qa=
this.X2b.createInstance(N,this.Tte))return Qa}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${N} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(xe.a.generalException,xe.a.generalException);}}Object(e.a)(Ij,"RichApiHost",null,[]);var Pj=a(391),Jj=a(32),Qj=a(130),mj=a(38),Rj=a(107),Sj=a(295),Tj=a(49),Uj=a(262),Vj=a(8),Wj=a(74);class Bf{constructor(N,Qa,Db,fc){this.oc=this.rangePicker=null;this.$=N;this.me=Qa;this.oc=
fc;this.kf=new Bh(N.ea);this.tB=new tj(N,this.kf);this.OFf=Db;this.Fec=new Map}get ER(){return this.kf}dispose(){this.$=this.Fec=null}hd(){return!1}ld(){return!1}executeCommand(N,Qa,Db){N=Qa.command;switch(N){case 451041795:this.kf.kg(Db[Ib.a.Bg],Db[Ib.a.L5]);break;case 974713501:this.qli(Db[Ib.a.Bg],Db[Ib.a.L5]);break;case 1237877382:this.kf.Gw(Db[Ib.a.L5]);break;default:return bd.a(N)}return ke.Task.Ua(!0)}Tc(N,Qa,Db){if(N=!!Db)switch(Qa.command){case 974713501:case 1237877382:case 451041795:break;
default:N=!1}return N}qli(N,Qa){var Db;const fc=N.DdaMethod;"undefined"===typeof fc.DispatchId?this.kf.kg(Lf.a.internalError,Qa):Bf.CAi(N)||this.$.$d&1?(fc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new oh(this.$,this,N,Qa,this.oc)).start(this.me,N.DdaMethod.ControlId):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.Ldi(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.hQj(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(N,this.cmd(N.DdaMethod.ControlId),0,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.j0h(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.FLj(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.i0h(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.lvj(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.h_h(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.BCd(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(N.DdaAddRowsColumns.IsRow=!0,this.Mwe(N,Qa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(N.DdaAddRowsColumns.IsRow=!1,this.Mwe(N,Qa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.xvh(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.deh(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(N.DdaSetBindingFormats.IsSetFormats=!0,this.gcg(N,Qa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(N.DdaSetBindingFormats.IsSetFormats=!1,this.gcg(N,Qa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(N,N.DdaBindingsMethod.ItemName,N.DdaBindingsMethod.FailOnCollision?2:1,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.x5h(Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.wGd(N,Qa):fc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.w4h(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.x4h(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.nvj(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(N.DdaMethod.ControlId,N),this.kf.Gw(Qa)):
fc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?y.EwaSettings.ya(23)?this.kf.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qa):this.HVi(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?y.EwaSettings.ya(23)?this.kf.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qa):this.EVi(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(N,Qa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(N,Qa):this.kf.kg(Lf.a.rLd,Qa),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&fc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(N=this.me.gW(N.DdaMethod.ControlId),Qa="",N&&(Qa=qg.DdaFacade.getSolutionId(N,this.$),Qa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qa,N.OwnerAddinStoreType||N.PrimaryMarketplace.MarketplaceType,null===(Db=N.AssetMarketplace)||void 0===Db?void 0:Db.SolutionId,null,null,N.PrimaryMarketplace.MarketplaceRef)),
n.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${fc.DispatchId}, AppID: ${Qa}`))):this.kf.kg(Lf.a.OUe,Qa)}j0h(N,Qa){N.DdaGetBindingData.CoerceType=Bf.k9b(N.DdaGetBindingData.CoerceType);N.DdaGetBindingData.FilterType=Bf.F3e(N.DdaGetBindingData.FilterType);N.DdaGetBindingData.ValueFormat=Bf.Xvg(N.DdaGetBindingData.ValueFormat);if(this.rpc(N.DdaGetBindingData.CoerceType,Qa)){if(N.DdaGetBindingData){const Db=N.DdaGetBindingData;0===Db.FilterType&&(Db.FilterType=2);Db.StartCol|=0;Db.StartRow|=0;
Db.ColCount=void 0===Db.ColCount?-1:Db.ColCount;Db.RowCount=void 0===Db.RowCount?-1:Db.RowCount}this.tB.ddaGetBindingData(N.DdaMethod.ControlId,N.DdaGetBindingData.BindingId,N.DdaGetBindingData.CoerceType,N.DdaGetBindingData.ValueFormat,N.DdaGetBindingData.FilterType,N.DdaGetBindingData.StartRow,N.DdaGetBindingData.StartCol,N.DdaGetBindingData.RowCount,N.DdaGetBindingData.ColCount,Db=>{if(Ig.a(Db)||!Db.Result)this.kf.CI(Db,Qa);else{const fc=this.kf.sR();fc.Data=Bf.oFe(Db.Result);Qa(fc)}},Qa)}}FLj(N,
Qa){N.DdaSetBindingData.CoerceType=Bf.k9b(N.DdaSetBindingData.CoerceType);if(this.rpc(N.DdaSetBindingData.CoerceType,Qa)){var Db=Bf.e6c(N.DdaSetBindingData.CoerceType,N.DdaSetBindingData.Data);Bf.omc(Db)?this.kf.kg(Lf.a.RIc,Qa):(1===Db.CoerceType&&(Db.CellFormat||(Db.CellFormat=N.DdaSetBindingData.CellFormat),Db.TableOptions||(Db.TableOptions=N.DdaSetBindingData.TableOptions)),N.DdaSetBindingData&&(N.DdaSetBindingData.StartCol|=0,N.DdaSetBindingData.StartRow|=0),this.tB.ddaSetBindingData(N.DdaMethod.ControlId,
N.DdaSetBindingData.BindingId,N.DdaSetBindingData.StartRow,N.DdaSetBindingData.StartCol,Db,fc=>{Ig.a(fc)?this.kf.CI(fc,Qa):this.kf.Gw(Qa)},Qa))}}Ldi(N,Qa){N.DdaGetBindingData.CoerceType=Bf.k9b(N.DdaGetBindingData.CoerceType);N.DdaGetBindingData.ValueFormat=Bf.Xvg(N.DdaGetBindingData.ValueFormat);N.DdaGetBindingData.FilterType=Bf.F3e(N.DdaGetBindingData.FilterType);if(this.rpc(N.DdaGetBindingData.CoerceType,Qa)){var Db=this.cmd(N.DdaMethod.ControlId);Db?this.tB.ddaGetSelectedData(N.DdaMethod.ControlId,
N.DdaGetBindingData.CoerceType,N.DdaGetBindingData.ValueFormat,N.DdaGetBindingData.FilterType,Db,fc=>{if(Ig.a(fc))this.kf.CI(fc,Qa);else{const vc=this.kf.sR();vc.Data=Bf.oFe(fc.Result);Qa(vc)}},Qa):this.kf.kg(Lf.a.eef,Qa)}}w4h(N,Qa){const Db=N[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],fc=N[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],vc=N.DdaMethod.ControlId,Rc=Gh.getInstance(this.$);if(0>=fc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),
this.kf.kg(Lf.a.Ywi,Qa);else if(fc>Gh.hUi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.kf.kg(Lf.a.G9e,Qa);else{var cd=null;switch(Db){case 1:cd="Compressed";break;case 0:cd="Text";break;case 2:cd="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Db} is not supported.`);this.kf.kg(Lf.a.p3e,Qa);return}if("Text"===cd)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${cd} is not supported.`),this.kf.kg(Lf.a.p3e,
Qa);else{y.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(N=new Sys.StringBuilder,N.append(lg.a(this.$,cd)),"Pdf"===cd&&Lg.a.Bl(N,$b.a.oZf,"WholeWorkbook"),N=N.toString()):N=lg.a(this.$,cd);var dd=null,Hd=new XMLHttpRequest;Hd.onreadystatechange=()=>{if(4===Hd.readyState)if(200===Hd.status){var Zd=Hd.response;if(Zd){dd=new Uint8Array(Zd);Zd=this.kf.sR();var Fe=dd.length,Ne=Gh.tYi(),sf={},vg=0;for(let hg=0;hg<Fe;hg+=fc){const Wf=[],bg=hg+fc<Fe?hg+fc:Fe;
for(let wg=0,Xg=hg;Xg<bg;wg++,Xg++)Wf[wg]=dd[Xg];sf[(vg++).toString()]=Wf}sf=new uj(Ne,Fe,fc,sf);sf=Rc.MSg(vc,sf);sf!==Lf.a.success?this.kf.kg(sf,Qa):(Zd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Ne,Zd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Fe,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${cd}, the file size is ${Fe}`),Qa(Zd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${cd}.`),
this.kf.kg(Lf.a.internalError,Qa)}else 500===Hd.status?this.kf.kg(Lf.a.c6e(parseInt(Hd.statusText,10)),Qa):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${cd}.`),this.kf.kg(Lf.a.dYi,Qa))};Hd.open("GET",N,!0);Hd.responseType="arraybuffer";Hd.setRequestHeader("If-Modified-Since","0");Hd.send(null)}}}x4h(N,Qa){var Db=N[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],fc=N[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];N=N.DdaMethod.ControlId;(Db=
Gh.getInstance(this.$).z4h(N,Db))?(Db=Db.p_j,0>fc||fc>=Object.keys(Db).length?this.kf.kg(Lf.a.zri,Qa):(fc=Db[fc.toString()],Db=this.kf.sR(),Db[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=fc,Db[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=fc.length,Qa(Db))):this.kf.kg(Lf.a.internalError,Qa)}nvj(N,Qa){var Db=N[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];N=N.DdaMethod.ControlId;Db=Gh.getInstance(this.$).mvj(N,Db);Db===Lf.a.success?this.kf.Gw(Qa):this.kf.kg(Db,
Qa)}hQj(N,Qa){N.DdaSetBindingData.CoerceType=Bf.k9b(N.DdaSetBindingData.CoerceType);if(this.rpc(N.DdaSetBindingData.CoerceType,Qa)){var Db=this.cmd(N.DdaMethod.ControlId);if(Db){var fc=Bf.e6c(N.DdaSetBindingData.CoerceType,N.DdaSetBindingData.Data),vc=Od.h(this.$).ga;1===fc.CoerceType&&(!fc.Data&&vc.pa.fX&&(fc.Headers||(fc.Headers=[]),fc.Headers.length||fc.Headers.push([]),fc.Headers[0].length||fc.Headers[0].push("")),Bf.omc(fc)||(fc.CellFormat||(fc.CellFormat=N.DdaSetBindingData.CellFormat),fc.TableOptions||
(fc.TableOptions=N.DdaSetBindingData.TableOptions)));if(Bf.omc(fc))this.kf.kg(Lf.a.RIc,Qa);else{var Rc=vc.pa.Hd.clone(),cd=vc.pa.activeCell.clone();this.tB.ddaSetSelectedData(N.DdaMethod.ControlId,Db,fc,dd=>{var Hd;if(Ig.a(dd))this.kf.CI(dd,Qa);else{dd=Rc.clone();const Zd=fc.Headers?fc.Headers[0].length:fc.Data[0].length;1!==fc.CoerceType||fc.Data?1===fc.CoerceType&&(null===(Hd=fc.TableOptions)||void 0===Hd?0:Hd.length)&&0==fc.TableOptions[0]?(dd.top+=1,dd.bottom=dd.top+fc.Data.length-1):dd.bottom=
dd.top+fc.Data.length-(1===fc.CoerceType?0:1):dd.bottom=dd.top+1;dd.right=dd.left+Zd-1;Hd=dd.contains(cd)?cd:dd.topLeft;vc.updateSelection(dd,Hd,0);this.kf.Gw(Qa)}},Qa)}}else this.kf.kg(Lf.a.UHe,Qa)}}addBinding(N,Qa,Db,fc){Qa?this.tB.ddaAddBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,N.DdaBindingsMethod.BindingType,Qa,Db,vc=>{if(Ig.a(vc))this.kf.CI(vc,fc);else{const Rc=this.kf.sR();Rc.Bindings=Array(1);Rc.Bindings[0]=this.me.J6b(vc.Result);fc(Rc)}},fc):this.kf.kg(Lf.a.WIj,fc)}i0h(N,
Qa){this.tB.ddaGetBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Db=>{if(Ig.a(Db)||!Db.Result)this.kf.CI(Db,Qa);else{const fc=this.kf.sR();fc.Bindings=Array(1);fc.Bindings[0]=this.me.J6b(Db.Result);Qa(fc)}},Qa)}x5h(N){const Qa=this.kf.sR(),Db={};Db[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Qa[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Db;N(Qa)}lvj(N,Qa){this.tB.ddaReleaseBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,
Db=>{Ig.a(Db)?this.kf.CI(Db,Qa):this.kf.Gw(Qa)},Qa)}h_h(N,Qa){this.tB.ddaGetAllBindings(N.DdaMethod.ControlId,Db=>{if(Ig.a(Db))this.kf.CI(Db,Qa);else{const fc=this.kf.sR();if(Db.Result){Db=Db.Result;fc.Bindings=Array(Db.length);for(let vc=0;vc<Db.length;vc++)fc.Bindings[vc]=this.me.J6b(Db[vc])}else fc.Bindings=null;Qa(fc)}},Qa)}BCd(N,Qa){this.tB.ddaLoadSettings(N.DdaMethod.ControlId,Db=>{if(Ig.a(Db))this.kf.CI(Db,Qa);else{const fc=this.kf.sR();fc.Properties=Db.Result;Qa(fc)}},Qa)}saveSettings(N,Qa){const Db=
{Settings:[]};for(let fc=0;fc<N.DdaSettingsMethod.Properties.length;fc++){const vc={};vc.Name=N.DdaSettingsMethod.Properties[fc][0];vc.Value=N.DdaSettingsMethod.Properties[fc][1];Db.Settings[fc]=vc}this.tB.ddaSaveSettings(N.DdaMethod.ControlId,Db,N.DdaSettingsMethod.OverwriteIfStale,fc=>{Ig.a(fc)?this.kf.CI(fc,Qa):this.kf.Gw(Qa)},Qa)}Mwe(N,Qa){const Db=Bf.e6c(1,N.DdaAddRowsColumns.Data);Bf.omc(Db)?this.kf.kg(Lf.a.RIc,Qa):this.tB.ddaAddRowsColumns(N.DdaMethod.ControlId,N.DdaAddRowsColumns.BindingId,
N.DdaAddRowsColumns.IsRow,Db,fc=>{Ig.a(fc)?this.kf.CI(fc,Qa):this.kf.Gw(Qa)},Qa)}xvh(N,Qa){this.tB.ddaDeleteAllDataValues(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Db=>{Ig.a(Db)?this.kf.CI(Db,Qa):this.kf.Gw(Qa)},Qa)}deh(N,Qa){this.tB.ddaClearBindingFormats(N.DdaMethod.ControlId,N.DdaClearBindingFormats.BindingId,Db=>{Ig.a(Db)?this.kf.CI(Db,Qa):this.kf.Gw(Qa)},Qa)}gcg(N,Qa){const Db={},fc=N.DdaSetBindingFormats.IsSetFormats;fc?Db.CellFormat=N.DdaSetBindingFormats.CellFormat:Db.TableOptions=
N.DdaSetBindingFormats.TableOptions;this.tB.ddaSetBindingFormats(N.DdaMethod.ControlId,N.DdaSetBindingFormats.BindingId,Db,fc,vc=>{Ig.a(vc)?this.kf.CI(vc,Qa):this.kf.Gw(Qa)},Qa)}executeRichApiRequest(N,Qa){var Db;const fc=N.ArrayData,vc={},Rc=Od.h(this.$).ga;if(fc){if("WacPartition"===fc[0]){this.jPh(N,Qa);return}const Ne=Object(Y.a)(qg.DdaFacade,Jf.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===fc[0]){var cd=Ne.Ln(N.DdaMethod.ControlId);cd&&(cd.eoc=!0,cd.BYf())}vc.HttpMethod=fc[1];
vc.PathAndQuery=fc[2];vc.RequestHeaders=Bf.iaf(fc[3]);vc.RequestBody=fc[4];vc.AppPermission=fc[5];cd=fc[6];vc.RequestFlags=cd;var dd=0;if(gi.i(this.$.na))switch(Rc.gf){case 1:dd=2;break;case 2:dd=3;break;case 64:dd=16;break;case 128:dd=4;break;default:dd=1}var Hd=null;Rc.Sa.YB&&(Hd=Rc.Sa.YB.Tj);vc.SheetMultiRange=Nh.r(Rc.pa.selectedRanges,this.$);vc.ActiveCell=Nh.v(Rc.pa.activeCell,this.$);vc.ActiveFloatingObjectId=Hd;vc.SelectionState=dd;dd=this.me.gW(N.DdaMethod.ControlId);vc.InstanceId=dd?dd.InstanceId:
"";if(dd&&dd.PrimaryMarketplace){let sf;if(dd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)sf=dd.PrimaryMarketplace.SolutionId,Hd=dd.PrimaryMarketplace.MarketplaceType;else{if(!dd.OwnerAddinSolutionId){n.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.kf.kg(Lf.a.$Db,Qa);return}if(!dd.OwnerAddinStoreType){n.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.kf.kg(Lf.a.$Db,Qa);
return}sf=dd.OwnerAddinSolutionId;Hd=dd.OwnerAddinStoreType}let vg=Telemetry.PrivacyRules.GetPrivacyCompliantId(sf,Hd,null===(Db=dd.AssetMarketplace)||void 0===Db?void 0:Db.SolutionId,null,null,dd.PrimaryMarketplace.MarketplaceRef);vc.CompliantSolutionId=vg;vc.SolutionId=sf;vc.MarketplaceType=Hd;vc.SolutionVersion=dd.PrimaryMarketplace.SolutionVersion;vc.StoreLocation=dd.PrimaryMarketplace.MarketplaceRef}else vc.SolutionId=vc.MarketplaceType="",vc.CompliantSolutionId="";vc.IsEventsEnabled=void 0===
Ne||null===Ne||Ne.Vh.U5b(vc.InstanceId);vc.RequestGuid=tg.a.create().toString();Db=vc.RequestBody.length;if(Db>this.$.xa.ExcelRichApiMaxAllowedRequestPayloadSize){this.kf.kg(Lf.a.hCj,Qa);n.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Db} exceeded the limit`);return}y.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&cd&4096&&(Db=new rh(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Db,Ng,fc),vc.RequestBody=fc[4])}const Zd=Bf.Ddf(vc.RequestHeaders);
Bf.pMd++;const Fe=Jj.a.Bb.Cc;y.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&vc&&vc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${vc.RequestBody.length}`);this.tB.executeRichApiRequest(vc,Ne=>{var sf;this.lbg(Fe,!0,Ne.ServerCorrelationId);let vg=null,hg=null;var Wf=Ne.ServerCorrelationId;if(null===(sf=null===Ne||void 0===Ne?void 0:Ne.Errors)||void 0===sf?0:sf[0])vg=Ne.Errors[0].MessageIdName,hg=Ne.Errors[0].Description,Wj.a(this.$).Qd.jN(Ne.Errors[0].MessageId);
if(Ig.a(Ne)||!Ne.Result)this.vbb(Wf,Zd,"Server error",vg,hg),this.kf.CI(Ne,Qa);else{let wg=null;if(y.EwaSettings.ya(233))if((sf=Ne.Result)&&sf.length){for(let Yg=0;Yg<sf.length;Yg++)if(sf[Yg].RequestGuid===vc.RequestGuid){wg=sf[Yg];break}wg||this.kf.CI(Ne,Qa)}else wg=Ne.Result;else wg=Ne.Result;if(!vg&&wg&&wg.ResponseBody&&wg.ResponseBody[0])if(Ne=wg.ResponseBody[0],Ne.startsWith('{"Error":')){1<wg.ResponseBody.length&&(Ne=Ne.substring(0,Ne.indexOf("}")+1),Ne+="}");try{var bg=v.a.Xi(Ne);bg.Error&&
this.vbb(Wf,Zd,"Pipeline error",bg.Error.Code,bg.Error.Message)}catch(Yg){this.vbb(Wf,Zd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.vbb(Wf,Zd);else this.vbb(Wf,Zd,"Server error",vg,hg);const Xg=(Wf=wg.SheetMultiRange)?Wf.SheetName:null;bg=wg.ActiveFloatingObjectId;const Kg=wg.SelectionState;Ne=5===Kg&&!!Wf||6===Kg||7===Kg||17===Kg||8===Kg;if(this.$.Ob.xz&&Ne)this.kf.kg(Lf.a.lLc,Qa),n.ULS.sendTraceTag(537163211,0,50,`${Kg.toString()} is not allowed`);else if(5===
Kg&&Wf){if(this.$.ua&&Xg)if(this.$.ua.fl(Xg))this.V0c(Xg);else{let Yg=null;Yg=()=>{this.$.ua.fl(Xg)&&(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.V0c(Xg),this.$.ua.BOb(Yg))};this.$.ua.$rb(Yg);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Vh=null;Vh=()=>{this.$.ua.fl(Xg)&&(this.V0c(Xg),this.$.ua.Epa(Vh))};this.$.ua.eja(Vh)}}}else if(6===Kg||7===Kg||17===Kg||8===Kg||9===Kg){if(Wf){const Yg=Nh.g(Wf.Ranges);
if(Xg&&Nh.db(Yg,!0))if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.ua.fl(Xg)){let Vh=null;Vh=()=>{this.gug(Rc,Yg,Xg,Kg);this.$.ua.Epa(Vh)};this.$.ua.eja(Vh)}else this.gug(Rc,Yg,Xg,Kg)}7===Kg?(bg="38.{"+Vg.e(bg)+"}",T.a(this.$).G9(0,bg,!0)):17===Kg?(bg="38.{"+Vg.e(bg)+"}",T.a(this.$).G9(5,bg,!0)):8===Kg&&T.a(this.$).G9(2,bg,!0);9===Kg&&(this.$.xa.ApiCallToSetPageLayout=!0)}wg.PostProcessActions?(Wf=v.a.Xi(wg.PostProcessActions),this.ikj(Wf).then(()=>
{this.Qgb(wg,Qa);this.Xid(N.DdaMethod.ControlId,vc);return Promise.resolve(null)},Yg=>{this.Qgb(wg,Qa,Yg);return Promise.reject(Yg)})):this.Qgb(wg,Qa)}},Ne=>{this.lbg(Fe,!1,null);this.vbb(null,Zd,"Web service error");Qa(Ne)})}Xid(N,Qa){const Db=Object(Y.a)(qg.DdaFacade,Jf.a(this.$));(null===Db||void 0===Db?0:Db.cVd)&&Db.Ln(N)&&Bf.jUj(Qa.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${N}; SolutionId: ${Qa.SolutionId}.`),
Db.cVd.VDh(N))}jPh(N,Qa){var Db=this.me.gW(N.DdaMethod.ControlId);const fc=qg.DdaFacade.getSolutionId(Db,this.$);var vc=null;vc=qg.DdaFacade.Dxa(Db,this.$);vc=new fj(vc,this.$);vc=new Ij(fc,N.DdaMethod.ControlId,this.me,this.$,vc);const Rc={ResponseHeaders:[]};Rc.ResponseBody=Array(1);Db=Bf.iaf(N.ArrayData[3]);const cd=Bf.Ddf(Db);Db=new Kf(this.$.xa.CreateWorkbookMaxAllowedBase64Size,this.OFf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(vc,Hf,Db,N.ArrayData).then(dd=>{if(!dd)return this.rDd(!1,
"The rich api executor call failed",cd),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Rc.ResponseStatusCode=500,this.Qgb(Rc,Qa),null;this.rDd(!0,"The rich api executor call succeeded",cd);Rc.ResponseStatusCode=dd[0];Rc.ResponseBody[0]=dd[2];this.Qgb(Rc,Qa);return null},dd=>{Rc.ResponseStatusCode=400;Rc.ResponseBody[0]=dd.toString();this.rDd(!1,"The rich api executor call failed",cd);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${fc}`);
this.Qgb(Rc,Qa);return null})}lbg(N,Qa,Db){Bf.pMd--;N=Qj.a(Jj.a.Bb,N);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${N}, requests pending:${Bf.pMd}, request result:${Qa?"success":"false"}, server correlationid: ${Db}.`)}Qgb(N,Qa,Db=null){const fc=Array(3);fc[0]=N.ResponseStatusCode;fc[1]=Bf.lfi(N.ResponseHeaders);const vc=[];var Rc=!1;if(Db&&N.ResponseBody){const cd=v.a.Xi(N.ResponseBody.join(""));cd.Error||(Rc={},Rc.Error=Db,Rc.TraceIds=cd.TraceIds,Rc.ProcessedResults=
{},Rc.ProcessedResults.Results=cd.Results,vc[0]=v.a.Zc(Rc),Rc=!0)}fc[2]=Rc?vc:N.ResponseBody;N=this.kf.sR();N.Data=fc;Qa(N)}wGd(N,Qa){(new Ph(this.$,this.kf,this.tB)).wGd(N,Qa)}HVi(N,Qa){n.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Db=N[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],fc=N[da.a.c3c],vc=N[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];N=this.$.da.Ba(232).j5a.IVi(N.DdaMethod.ControlId,Db,fc,vc);N===Lf.a.success?this.kf.Gw(Qa):(n.ULS.sendTraceTag(537163205,
0,10,"MessageParent API Failed!"),this.kf.kg(N,Qa))}EVi(N,Qa){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Db=N[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],fc=N[da.a.c3c],vc=N[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Ba(232).j5a.TJj(N.DdaMethod.ControlId,Db,fc,vc);this.kf.Gw(Qa)}getAccessToken(N,Qa){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Db=(vc,Rc)=>{var cd;if(vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)vc=this.kf.sR(),
vc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Rc.accessToken,Qa(vc);else{Rc=this.me.gW(N.DdaMethod.ControlId);let dd=null!==Rc.OwnerAddinStoreType?Rc.OwnerAddinStoreType:Rc.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:vc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(qg.DdaFacade.getSolutionId(Rc,this.$),dd,null===(cd=Rc.AssetMarketplace)||void 0===cd?void 0:cd.SolutionId,null,null,Rc.PrimaryMarketplace.MarketplaceRef),
["storeType"]:dd})}.`);this.kf.kg(vc,Qa)}},fc=!y.EwaSettings.ya(23);ab.TaskExtensions.za(mc.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),vc=>{const Rc=this.me.Lf,cd=Af.getInstance();sg.AppsForOfficeSingleSignOnManager.getInstance(Rc,vc.result,cd).getAccessToken(N.DdaMethod.ControlId,fc,N,Db)},this.$.ka)}getAuthContext(N,Qa){ab.TaskExtensions.za(mc.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),()=>{var Db=this.me.Lf.getOsfControl(N.DdaMethod.ControlId);if(Db.isFirstParty()){Db=
Db.getManifest();var fc=Db.getMarketplaceID(),vc=Db.getWebApplicationId(),Rc=Db.getWebApplicationMsaId();me.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(fc).then(cd=>{const dd=this.kf.sR(),Hd={};Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=vc;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Rc||vc;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=cd.upn;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=cd.userId;
Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=cd.authority;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=lf.a.R_h(cd.authorityType);Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=cd.isAnonymous;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=cd.tenantId;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=cd.supportsAuthToken;dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Hd;
Qa(dd)},cd=>{const dd=this.kf.sR(),Hd={},Zd=new lf.a;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=vc;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Rc||vc;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Zd.upn;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Zd.userId;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Zd.authority;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Zd.authorityType;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Zd.isAnonymous;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Zd.tenantId;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=cd;Hd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Zd.supportsAuthToken;dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Hd;dd.Error=1;Qa(dd)})}},this.$.ka)}oAi(N){const Qa=Od.h(this.$).ga;return 16===Qa.gf&&!!Qa.Sa.Fc&&!!Qa.Sa.Fc.floatingObject&&ua.a.equals(Qa.Sa.Fc.floatingObject.id,N,!0)}cmd(N){const Qa=
Od.h(this.$).ga;return Qa.pa.Lh?1===Qa.gf||this.oAi(N)?Qa.Dka:null:null}rpc(N,Qa){return 1!==N&&2!==N&&3!==N?(this.kf.kg(Lf.a.iLe,Qa),!1):!0}rDd(N,Qa,Db){const fc={};fc.a=this.$.xa.UserSessionId;fc.b=N;fc.c=Qa;fc.d=null;fc.e=Db;tb.b().Df(37,fc)}vbb(N,Qa,Db=null,fc=null,vc=null){const Rc={};N&&(Rc.ServerCorrelationId=N);void 0!==Qa&&null!==Qa&&(Rc.Source=Qa);Db&&(Rc.ErrorType=Db);fc&&(Rc.MessageId=fc);vc&&(Rc.StatusDescription=vc);y.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&
fc&&"ExternalDataRefreshFailed"===fc&&(Rc.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,v.a.Zc(Rc))}ikj(N){let Qa=new Promise(Db=>{Db(null)});for(let Db=0;Db<N.length;Db++)Qa=this.hkj(Qa,N[Db]);return Qa}hkj(N,Qa){return Object(Mf.a)(this,void 0,void 0,function*(){if(!Qa)return n.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),N.then(()=>Promise.reject(Bf.a7a(Oh.generalException,cf.a.instance.ha(1765),null)));switch(Qa.actionType){case 1:case 2:N=N.then(()=>{const vc=Object(Y.a)(qg.DdaFacade,
Jf.a(this.$));if(vc.Ln(Qa.controlId))switch(vc.Vh.rhf(Qa),Qa.messageType){case 14:case 100:vc.bVd.r6b(Qa);break;case 11:case 12:vc.XEj.utb(Qa);break;case 51:case 52:vc.VEj.utb(Qa);break;case 2101:case 2102:vc.WEj.utb(Qa);break;case 2E3:vc.YEj.r6b(Qa);break;case 2201:this.$.Ana&&vc.cVd.m3g(Qa);break;case 2203:vc.ZEj.n3g(Qa);break;case 2700:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&vc.aVd.r6b(Qa);break;case 65541:vc.$Ud.l3g(Qa)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Qa.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:N=N.then(()=>{this.iki(Qa);return Promise.resolve(null)});break;case 15:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(N=N.then(()=>{this.Zli(Qa);return Promise.resolve(null)}));break;case 4:N=N.then(()=>{if(y.EwaSettings.ya(102)){var vc=Od.h(this.$).ga.pa.activeCell;vc.top!==Qa.row+1&&vc.left!==Qa.column+1&&(vc=Nh.v(Jh.Range.gd(Qa.row+1,Qa.column+1),this.$),Od.h(this.$).qh(vc,null,null,null,3,"DdaMethodHandler.ShowCard"));aj.a(this.$,
243,242,0,Rc=>{Rc.Whb(Qa.row+1,Qa.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:N=N.then(()=>{Object(Y.a)(qg.DdaFacade,Jf.a(this.$)).Vh.TWe(Qa.controlId,Qa.isEnableEvents);return Promise.resolve(null)});break;case 5:N=N.then(()=>this.Ish(Qa));break;case 6:N=N.then(()=>this.Wej(Qa));break;case 8:N=N.then(()=>{y.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(Y.a)(qg.DdaFacade,Jf.a(this.$)).ceh();const vc=new Uj.a(Vj.a.Dk,
5,null);Tj.a(this.$).Ns(vc);return Promise.resolve(null)});break;case 9:N=N.then(()=>this.JLj(Qa));break;case 10:N=N.then(()=>this.Blk(Qa));break;case 11:N=N.then(()=>this.Alk());break;case 12:N=N.then(()=>this.xlk());break;case 13:N=N.then(()=>this.ylk(Qa));break;case 14:N=N.then(()=>this.zlk(Qa));break;case 16:N=N.then(()=>Promise.resolve(Qa));break;case 17:N=N.then(()=>this.UHj(Qa,Object(Y.a)(qg.DdaFacade,Jf.a(this.$))));break;case 18:Od.h(this.$).focus();break;case 19:this.Ygf(Qa.entryType,!1,
Qa.options);break;case 20:this.Ygf(Qa.entryType,!0,Qa.options);break;case 21:const Db=Jf.a(this.$);N=N.then(()=>Db.$Ud.Qji(Qa));break;case 22:const fc=Jf.a(this.$);N=N.then(()=>fc.$Ud.Rji(Qa));break;case 23:(Sa.a.PEb(this.$)||Sa.a.Ewd())&&this.me.K8f.Gmi(Qa.worksheetId,Qa.anchorCell,Qa.values,Qa.options);break;case 24:(Sa.a.PEb(this.$)||Sa.a.Ewd())&&this.me.K8f.Uki(Qa.worksheetId);break;default:N=N.then(()=>Promise.reject(Bf.a7a(Oh.C0g,cf.a.instance.ha(1766),null)))}return N})}Zli(N){var Qa=Object(Y.a)(qg.DdaFacade,
Jf.a(this.$)).Ln(N.controlId);if(Qa&&!(0===N.operationType^!Qa.cga)){Od.h(this.$).ADb=!0;switch(N.operationType){case 0:var Db=new Sj.a(document.createElement("input"));Db.text=N.range;Qa.Nui(Od.h(this.$).Ch.drh(Db,new Pj.a(this.$)));Qa.cga.startEdit(!0);break;case 1:Qa.I3f();this.rangePicker=null;break;case 2:Qa.cga.wug(N.range);break;case 3:Qa.cga.wug(N.startingRange);Qa=N.expandSelection;Db=N.getNextDataRegionCell;let fc=0;switch(N.keyboardDirectionValue){case 2:fc=38;N=Qa&&Db?105288353:Qa?-31900117:
Db?542791952:137938150;break;case 3:fc=40;N=Qa&&Db?-1297307319:Qa?-1603798598:Db?1713663844:-798660877;break;case 0:fc=37;N=Qa&&Db?-403586027:Qa?2039316657:Db?-2012742350:-1470715894;break;case 1:fc=39;N=Qa&&Db?784916030:Qa?589730764:Db?1324884057:-1231471547;break;default:N=1461300262}Qa=this.Y$b("keydown",fc,Qa,Db);Od.h(this.$).MPb(Qa,new ye.a(N,1,0,8,null))}Od.h(this.$).ADb=!1}}Y$b(N,Qa,Db,fc){const vc=document.createEvent("KeyboardEvent");if(ih.a.IG)vc.initKeyboardEvent(N,!1,!1,window.self,"A",
0,fc,!1,Db,!1);else{let Rc="";Db&&(Rc+="Shift");fc&&(Rc+=0<Rc.length?" Control":"Control");vc.initKeyboardEvent(N,!1,!1,window.self,"A",0,Rc,!1,"en-US")}N=new Sys.UI.DomEvent(vc);N.keyCode=Qa;return N}iki(N){switch(N.operationType){case 1:ab.TaskExtensions.za(mc.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1),Qa=>{Qa.result.WTd()},this.$.ka,3);break;case 2:if(N=Object(Y.a)(qg.DdaFacade,Jf.a(this.$)).Ln(N.controlId))N.eoc=!0,N.BYf()}}Ish(N){const Qa=N.fileBase64;return Qa&&Qa.length>this.$.xa.CreateWorkbookMaxAllowedBase64Size?
Promise.reject(Bf.a7a(Oh.invalidArgument,cf.a.instance.ha(1769),"Application.CreateWorkbook")):(new Promise((Db,fc)=>{const vc=new Df.StandardDialog;vc.rc=4;vc.vm(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Rc=>{2!==Rc&&0!==Rc||fc(Bf.a7a(Oh.nLd,cf.a.instance.ha(1768),"Application.CreateWorkbook"));Rc=new mf("blank","agave",Qa?"streamBase64":"streamEmpty",Qa);this.OFf.create(Db,fc,Rc).v4a()})})).then(Db=>{this.Fec.set(N.fakeFileId,Db);return Promise.resolve(null)},
Db=>Db?Promise.reject(Db):Promise.reject(Bf.a7a(Oh.generalException,cf.a.instance.ha(1765),"Application.CreateWorkbook")))}Wej(N){return new Promise((Qa,Db)=>{if(this.Fec.has(N.fakeFileId)){const fc=this.Fec.get(N.fakeFileId);Db=new Df.StandardDialog;Db.rc=4;Db.vm(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,vc=>{1===vc&&Zc.HelperMethods.Jf(fc,void 0,void 0,"DdaMethodHandler.fileUrl");Qa(null)})}else Db(Bf.a7a(Oh.generalException,cf.a.instance.ha(1765),
"Document.Open"))})}JLj(N){return new Promise(Qa=>{Object(Y.a)(qg.DdaFacade,Jf.a(this.$)).L8f=N.runtimeCalculationMode;const Db=this.$.da.Ba(268);Db&&Db.zHd(3===N.runtimeCalculationMode);Qa(null)})}Blk(N){Sa.a.MGb(this.$)&&this.$.da.Ba(331).Rgb(0,N.urlStr,!0,!0,null);return Promise.resolve(null)}Alk(){Sa.a.MGb(this.$)&&this.$.da.Ba(331).Rgb(1,null,!0,!0,null);return Promise.resolve(null)}xlk(){Sa.a.MGb(this.$)&&this.$.da.Ba(331).QWe();return Promise.resolve(null)}ylk(N){Sa.a.MGb(this.$)&&this.$.da.Ba(331).Rgb(5,
N.urlStr,!0,!0,null);return Promise.resolve(null)}zlk(N){if(Sa.a.MGb(this.$)){const Qa=this.$.da.Ba(331);for(const Db of Qa.Wca)Db.IsActive&&Db.HostEditUrl&&Db.UrlStr===N.hostEditUrlStr&&Zc.HelperMethods.Jf(Db.HostEditUrl,"_blank")}return Promise.resolve(null)}UHj(N,Qa){const Db=Qh.a.pM;N=v.a.Xi(N.payload);const fc={};"eventId"in N&&"payload"in N&&(fc.eventId=N.eventId,fc.payload=N.payload);Qa.pG(2201,Db,v.a.Zc(fc));return Promise.resolve(null)}Ygf(N,Qa,Db){const fc=this.$.da.Ba(5);fc&&(N=this.N0h(N))&&
(Qa?fc.removeEntry(N):fc.xwe(N,Db))}N0h(N){switch(N){case 0:return 64;case 1:if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}V0c(N){N=Object(Y.a)(Rj.a,this.$.ua.getItemByName(N));(null===N||void 0===N?0:N.visible)&&N.activate(!0)}gug(N,Qa,Db,fc){var vc=N.pa.Hr;const Rc=vc<Qa.length&&Qa[vc].contains(N.pa.activeCell);N=Rc?N.pa.activeCell:Qa[0].topLeft;vc=Rc?vc:0;Od.h(this.$).z0(Qa,vc,Db,null,N,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,
6===fc)}static get Zth(){Bf.Esa||(Bf.Esa={},Bf.Esa[Microsoft.Office.WebExtension.CoercionType.Table]=1,Bf.Esa[Microsoft.Office.WebExtension.CoercionType.Text]=2,Bf.Esa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,Bf.Esa[Microsoft.Office.WebExtension.CoercionType.Html]=4,Bf.Esa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Bf.Esa}static get buh(){Bf.bmb||(Bf.bmb={},Bf.bmb[Microsoft.Office.WebExtension.FilterType.All]=1,Bf.bmb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=
2);return Bf.bmb}static get cuh(){Bf.cmb||(Bf.cmb={},Bf.cmb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Bf.cmb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return Bf.cmb}static iaf(N){if(!N||!N.length)return null;const Qa=Array(N.length/2);for(let Db=0;Db<N.length/2;Db++)Qa[Db]={},Qa[Db].Name=N[2*Db],Qa[Db].Value=N[2*Db+1];return Qa}static lfi(N){if(!N||!N.length)return null;const Qa=Array(2*N.length);for(let Db=0;Db<N.length;Db++)Qa[2*Db]=N[Db].Name,Qa[2*Db+1]=N[Db].Value;
return Qa}static mjd(N){if(!N||!N.length)return null;const Qa=Array(N.length);for(let Db=0,fc=N.length;Db<fc;Db++){const vc=N[Db].length;if(vc){Qa[Db]=Array(vc);for(let Rc=0;Rc<vc;Rc++)Qa[Db][Rc]=null==N[Db][Rc]?null:N[Db][Rc].toString()}else return null}return Qa}static k9b(N){return"string"===typeof N?mj.a.er(Bf.Zth,N,0):N}static F3e(N){return"string"===typeof N?mj.a.er(Bf.buh,N,0):N}static Xvg(N){return"string"===typeof N?mj.a.er(Bf.cuh,N,0):N}static CAi(N){switch(N.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static e6c(N,
Qa){const Db={};Db.CoerceType=N;1===Db.CoerceType?(Db.Data=Bf.mjd(Qa.Rows),Db.Headers=Bf.mjd(Qa.Headers)):Db.Data=Bf.mjd(Qa);return Db}static oFe(N){return 1===N.CoerceType?{["Headers"]:N.Headers,["Rows"]:N.Data}:N.Data}static omc(N){return 1===N.CoerceType?!N.Data&&!N.Headers:!N.Data}static Ddf(N){let Qa="Unknown";if(!N)return Qa;for(let Db=0;Db<N.length;Db++)if(N[Db].Name.toLowerCase()===$b.a.$Ej){Qa=N[Db].Value;break}return Qa}static jUj(N){if(!N)return!1;const Qa=$b.a.A_i.toLowerCase();for(let Db=
0;Db<N.length;Db++)if(N[Db].Name.toLowerCase()===Qa)return!0;return!1}static a7a(N,Qa,Db){const fc={};fc.Code=N;fc.Message=Qa;fc.Location=Db;fc.ActionIndex=0;return fc}}Bf.Esa=null;Bf.bmb=null;Bf.cmb=null;Bf.pMd=0;Object(e.a)(Bf,"DdaMethodHandler",null,[200,2]);class nj extends Pe.a{constructor(N){super(N)}he(){const N=mc.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.La),Qa=mc.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.La),Db=qi(this.ka,this.La),fc=Object($h.d)(ai.a.resolve(bi.S,
{Wa:this.La}));ab.TaskExtensions.za(ab.TaskExtensions.ke([N,Qa,Db,fc],this.ka),()=>{const Rc=N.result,cd=me.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Pd([new Bf(this.$,Rc,cd,fc.result)])},this.ka,3);const vc=me.a.instance;ab.TaskExtensions.za(mc.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,this.La),()=>{vc.register(og,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Uc().dd(()=>new og)},this.$.ka)}static la(N){Pe.a.ye(82,
new nj(N))}}Object(e.a)(nj,"DdaCommandHandlerFactory",Pe.a,[]);var Xj=a(472);let gj=class{constructor(N){this.agaveCommandManager=N;this.K9j=()=>{this.agaveCommandManager.Vna("FA000000124",ei.a.taskpane,"CopilotSDXTaskpane",void 0,"1.1.0.0",{jl:"Copilot (Preview)"})};window.setTimeout(this.K9j,5E3)}};gj=Object(Mf.b)([Object(ai.d)(bi.r),Object(Mf.c)(0,Object(Xj.AgaveCommandManagerService)())],gj);Object(e.a)(gj,"CopilotSDX",null,[]);b.a.ij(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");
(()=>{f.a.Fa(N=>{od.la(N)})})();(()=>{f.a.Fa(N=>{y.EwaSettings.ya(52)&&xi.la(N)})})();(()=>{f.a.Fa(N=>{y.EwaSettings.ya(114)&&Ch.la(N)})})();f.a.Fa(Tg.la);f.a.Fa(Ii.la);(()=>{f.a.Fa(N=>{zi.la(N);Kd.la(N)})})();f.a.Fa(nj.la);String(c);window.___1684305534299_closurehack=c},1536:function(u,C,a){u=a(0);var c=a(199),b=a(105);class f{constructor(){this.MVe=this.displayName=this.Xvb=this.Vo=this.IC=null;this.isUpgraded=!1}Xtf(d,h){return this.IC.getStoreType().toLowerCase()===d.toLowerCase()&&this.IC.getSolutionId().toLowerCase()===
h.toLowerCase()}}Object(u.a)(f,"AddinCommandsResourceItem",null,[]);a.d(C,"a",function(){return e});class e{constructor(){this.oMc=null;this.hRc=0;this.NSc=!1;this.$a=new b.a;this.yIg=new c.a}GVg(d){this.$a.addHandler("AddinCommandsLoadingMessageChanged",d)}$wj(d){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",d)}get x1a(){return this.oMc}qhb(d){d!==this.oMc&&(this.oMc=d,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))}ELj(){this.hRc++;this.x1a||this.qhb(CommonUIStrings.l_LoadingAddInsTitle)}JXd(){this.hRc--;
this.Vqc()&&(this.NSc?this.x1a!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.qhb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.qhb(null))}$cg(d=!1){this.NSc=!0;this.qhb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}xJe(){this.NSc=!1;this.Vqc()?this.qhb(null):this.qhb(CommonUIStrings.l_LoadingAddInsTitle)}Vqc(){return 0>=this.hRc}get r9a(){return this.yIg}pla(d,h,l=0){for(let k of this.r9a)if(k.Xtf(d,h)&&(!k.Vo||k.Vo.lZh===l))return k;
return null}rwe(d,h,l,k){const n=new f;n.IC=d;n.Vo=h;n.Xvb=l;n.displayName=k;this.r9a.add(n)}ITg(d,h,l,k){const n=new f;n.IC=d;n.Vo=h;n.Xvb=null;n.MVe=l;n.displayName=k;this.r9a.add(n)}uvj(d,h){let l=0;for(let k of this.r9a)k.IC.getStoreType()===d&&k.IC.getSolutionId()===h?this.r9a.removeAt(l):l++}static getInstance(){e.Oa||(e.Oa=new e);return e.Oa}}e.Oa=null;Object(u.a)(e,"AddinCommandsResourceManager",null,[])},760:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);var c=a(38);class b{static get GVi(){return b.Cle||
(b.Cle={["-2002156328"]:b.iLe,["-1954750170"]:b.eef,["317650254"]:b.Tfh,["-1005263101"]:b.Rwi,["1353664579"]:b.iJj,["159671765"]:b.Swi,["1446690022"]:b.G9e,["1150069548"]:b.RIc,["-1409306331"]:b.UHe,["338507772"]:b.uRe,["-457159301"]:b.Nfj,["-1037701970"]:b.zth,["-1893322318"]:b.Xwi,["965579896"]:b.Bth,["93287890"]:b.Ath,["358088857"]:b.vMj,["-1223650923"]:b.uRe,["2007306190"]:b.Pbh,["1549955423"]:b.rEe,["-1275974171"]:b.Wwi,["382101082"]:b.Zej,["-898776235"]:b.nXi,["335464256"]:b.eXi,["1677378049"]:b.Vwi,
["-261992848"]:b.vbk,["-980820954"]:b.rEe,["-931375837"]:b.Yej,["929186550"]:b.mBh,["-982144310"]:b.fnj,["-785741187"]:b.Pwi,["2125217573"]:b.Zwi,["299124955"]:b.Qwi,["1669853884"]:b.nFj,["-1515932330"]:b.Ufh,["314621024"]:b.BVh,["-300049690"]:b.Tbh,["14766835"]:b.NRj,["-1251992761"]:b.OUe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,
["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.MIa,["49173765"]:b.MIa,["-907155566"]:b.MIa,["-1201603824"]:b.MIa,["1541165282"]:b.MIa,["-1347753427"]:b.MIa,["134912532"]:b.MIa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static c6e(f){return c.a.er(b.GVi,f.toString(),b.internalError)}}b.success=0;b.iLe=1E3;b.eef=1001;b.Tfh=1002;b.Rwi=1003;b.iJj=1004;b.Swi=1005;b.G9e=1008;b.p3e=1009;b.invalidSheetName=1014;b.RIc=2E3;b.UHe=2001;b.uRe=2002;b.Nfj=2003;b.zth=2004;b.Xwi=2005;b.Bth=2007;
b.Ath=2008;b.vMj=2009;b.Pbh=2014;b.WIj=3E3;b.rEe=3002;b.Wwi=3004;b.Zej=3005;b.nXi=3006;b.eXi=3007;b.Vwi=3008;b.vbk=3009;b.Yej=3010;b.NRj=4002;b.rLd=5E3;b.internalError=5001;b.OUe=5002;b.$Db=5004;b.Ack=5007;b.zri=5008;b.b7f=5011;b.invalidOrTimedOutSession=5012;b.lLc=5016;b.MIa=5102;b.hCj=5103;b.responsePayloadSizeLimitExceeded=5104;b.ibh=7001;b.mkg=7002;b.mBh=8E3;b.fnj=8001;b.Pwi=8010;b.Zwi=8011;b.Qwi=8012;b.nFj=8020;b.Ufh=8021;b.BVh=8022;b.Tbh=8023;b.mVi=11E3;b.dYi=11001;b.Ywi=11002;b.Cle=null;Object(u.a)(b,
"DdaErrorIds",null,[])},761:function(u,C,a){a.d(C,"a",function(){return f});u=a(0);var c=a(15),b=a(115);class f{constructor(){this.lRd=0;this.YX={};this.Rva={}}iai(e,d){return this.YX[f.h6c(e,d)]}TWe(e,d){d||void 0!==this.Rva[e]&&null!==this.Rva[e]?d&&void 0!==this.Rva[e]&&null!==this.Rva[e]&&delete this.Rva[e]:this.Rva[e]=1}U5b(e){return void 0===this.Rva[e]||null===this.Rva[e]}rhf(e){const d=f.h6c(e.messageType,e.targetId);1===e.actionType?this.dmi(e.controlId,e.messageType,d):2===e.actionType&&
this.Wmi(e.controlId,e.messageType,d)}bwj(e){if(e){var d=Object.keys(this.YX);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.YX[h],d[e]&&(delete d[e],Object.keys(d).length||delete this.YX[h])}}HL(e,d){e=f.h6c(e,d);e=this.YX[e];return!!e&&0<Object.keys(e).length}Rni(){return!b.a.isEmpty(this.YX)}Vuf(){return 0<this.lRd}j5h(){const e=[],d=this.YX;for(let k in d){var h=k,l=d[k];for(let n in l){l=n;const v={};v.eventType=parseInt(h.split("#")[0],10);v.targetId=h.split("#")[1];v.addinId=
l;e.push(v)}}return e}dmi(e,d,h){if(this.YX[h])h=this.YX[h],h[e]=h[e]?h[e]+1:1;else{let l={};l[e]=1;this.YX[h]=l}100===d&&this.lRd++}Wmi(e,d,h){if(this.YX[h]){const l=this.YX[h];if(e){const k=l[e];1===k?(delete l[e],Object.keys(l).length||delete this.YX[h]):l[e]=k-1;100===d&&this.lRd--}else c.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${e}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static h6c(e,
d){return String.format("{0}#{1}",e,d)}}f.pM="Workbook";Object(u.a)(f,"RichApiEventRegistration",null,[])},762:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.r0c="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.nLd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.Dck="UnsupportedUserIdentity";
c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.EZg="AddinIsAlreadyRequestingToken";c.KDj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.Tjh="ControlIdNotFound";c.vEj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(u.a)(c,"ErrorCodes",null,[])},765:function(u,C,a){a.r(C);var c=a(0),b=a(2),f=a(15),e=a(1360),d=a(88),
h=a(105);class l{constructor(U,Ta,wb){this._id=U;this.vCg=Ta;this.CEg=wb;this.Rnf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get DZg(){return this.vCg}get xgh(){return this.CEg}execute(U,Ta,wb){wb=wb||{};wb.commandMode=this.Rnf;Ta.invokeAppCommand(this.DZg,this.xgh,wb,()=>{U.n9i(this.id)})}}Object(c.a)(l,"AddinNativeActionBase",null,[104]);class k extends l{constructor(U,Ta){super(1,U,Ta);this.Rnf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(k,"AddinTakeSnapshotAction",
l,[]);class n{zlh(U){return new l(3,U,this.UZh().getNativeActionName(3))}UZh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(n,"AddinNativeActionManager",null,[94]);var v=a(157);class x{invokeAppCommand(U,Ta,wb,Qb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,Ta,wb,Qb)}static getInstance(){x.Oa||(x.Oa=new x);return x.Oa}}x.Oa=null;Object(c.a)(x,"OSFAddinCommandsRuntimeManager",null,[95]);var w=a(6),r=a(195),t=a(31);class A extends v.a{constructor(U,Ta,wb){super();
this.Naa=null;this.p_c="WACDialogTitleText";this.dZ="0";this.U$="15px";this.SEg="0px";this.cZ="calc(100% - 30px)";this.REg="100%";this.cpe=0;this.$a=new h.a;this.xCg=new n;this.rc=5;this.Te=this.iGa=wb;this.uPc=U;this.Rde=Ta;this.JPc=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix")}UXg(U){this.$a.addHandler("OnDialogClosedEventKey",U)}EOj(){this.sHa=null}gy(){super.gy();this.Bi.style.width="100%";this.Bi.style.height=this.GCb?this.cZ:this.REg;
this.Bi.style.marginTop=this.GCb?this.U$:this.SEg;this.Bi.style.padding=this.dZ}bF(){super.bF();this.Hb.style.width=String.format("{0}px",this.uPc*window.innerWidth/100);this.Hb.style.height=String.format("{0}px",this.Rde*window.innerHeight/100);this.Hb.style.minWidth="0px";this.JPc&&w.AFrameworkApplication.isRtl&&100===this.uPc&&(this.Hb.style.right="0px",this.Hb.style.marginRight="0px");this.Naa=document.getElementById(this.wi(this.p_c));this.Naa.style.position="absolute";this.Naa.style.whiteSpace=
"nowrap";this.Naa.style.textOverflow="ellipsis";w.AFrameworkApplication.isRtl?(this.Naa.style.right="14px",this.Naa.style.left="44px"):(this.Naa.style.right="44px",this.Naa.style.left="14px")}Mz(U){super.Mz(U);this.Naa&&this.Naa.setAttribute("title",U)}get Dca(){return this.Bi}bUd(){this.Hb.style.width=String.format("{0}px",this.uPc*window.innerWidth/100);this.Hb.style.height=String.format("{0}px",this.Rde*window.innerHeight/100);this.Hb.style.overflowY="hidden";this.Hb.style.overflowX="hidden";this.Hb.style.marginTop=
"";this.Hb.style.top="";t.a.VW&&w.AFrameworkApplication.isRtl?(this.Hb.style.right="",this.Hb.style.marginRight=""):(this.Hb.style.left="",this.Hb.style.marginLeft="")}hide(){this.xCg.zlh(this.iGa).execute(this,x.getInstance(),{});this.cpe=window.setTimeout(()=>{this.$a.raiseEvent("OnDialogClosedEventKey",this.iGa);r.a.prototype.hide.call(this)},500)}n9i(U){3===U&&(window.clearTimeout(this.cpe),this.$a.raiseEvent("OnDialogClosedEventKey",this.iGa),super.hide())}}Object(c.a)(A,"AppsForOfficeDialog",
v.a,[72,73]);class y{constructor(){this.dialog=this.Te=null}}Object(c.a)(y,"DialogInfo",null,[]);class z{}z.url="url";z.height="height";z.width="width";z.Sdd="displayInIframe";z.Dkc="hideTitle";Object(c.a)(z,"DialogSettings",null,[]);class E{constructor(){this.height=this.width=0;this.Te=this.controlId=this.pageUrl=null;this.Dkc=this.Sdd=!1}}Object(c.a)(E,"DisplayDialogParams",null,[]);class G extends Sys.EventArgs{constructor(U,Ta,wb=null,Qb="",sc=""){super();this.controlId=U;this.messageType=Ta;
this.messageContent=wb;this.messageOrigin=Qb;this.targetOrigin=sc}}Object(c.a)(G,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(U,Ta,wb=null,Qb="",sc=""){super();this.controlId=U;this.messageType=Ta;this.messageContent=wb;this.messageOrigin=Qb;this.targetOrigin=sc}}Object(c.a)(F,"OnMessageParentEventArgs",Sys.EventArgs,[]);var O=a(43),M=a(34),P=a(185),B=a(106);class D{constructor(U){this.$a=new h.a;this.Bk=U}bYg(U){this.$a.addHandler("OnMessageParentEventKey",
U)}aYg(U){this.$a.addHandler("OnMessageDialogEventKey",U)}showDialog(U,Ta,wb,Qb){if(D.H$.Fb(Ta))f.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const ef=O.b(U),uf=ef[z.url];if(this.Bk.getOsfControl(Ta).checkAppDomains(uf)){var sc=new E;sc.width=ef[z.width];sc.height=ef[z.height];sc.pageUrl=uf;sc.Sdd=ef[z.Sdd];sc.Dkc=ef[z.Dkc];sc.controlId=Ta;sc.Te=P.a.create().toString();
var Vc=new y;Vc.Te=sc.Te;var Ld=this.Bk.getOsfControl(sc.controlId).getManifest().getDefaultDisplayName(),le=this.Bk.getOsfControl(sc.controlId).getStoreType().toLowerCase();U=null;U=(4===w.AFrameworkApplication.sa.Qa.Ii&&"hardcodedpreinstall"===le||"sdxcatalog"===le)&&sc.Dkc?this.createAndShowAppsForOfficeDialog(sc.width,sc.height,sc.Te,!0,Ld):this.createAndShowAppsForOfficeDialog(sc.width,sc.height,sc.Te,!1,Ld);var Ce=this.Bk.getOsfControl(sc.controlId),Oe=Ce.getManifest();Ta={};Ta.id=sc.Te;Ta.solutionId=
Ce.getSolutionId();Ta.version=Ce.getVersion();Ta.storeType=le;Ta.storeId=Ce.getStoreId();Ta.assetId=Ce.getAssetId();Ta.assetStoreId=Ce.getAssetStoreId();Ta.ownerAddinSolutionId=Ce.getOwnerAddinSolutionId();Ta.ownerAddinStoreType=Ce.getOwnerAddinStoreType();Ta.appDomains=Oe.getAppDomains();Ta.dialogUrl=uf;Ta.osfControlType=1;Ta.agaveName=Ld;Ta.div=U.Dca;f.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.ownerAddinStoreType||
Ta.storeType,Ta.assetId,null,null,Ta.storeId),M.a.rv(sc.pageUrl));this.Bk.insertDialogControl(Ta);U.UXg(Object(d.a)(this,this.z3i,"onDialogClosed"));Vc.dialog=U;D.H$.ia(sc.controlId,Vc);Qb&&Qb(Ta);wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else f.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ef){f.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",ef.message),
wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}IVi(U,Ta,wb,Qb){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Qb&&(Qb=wb);try{const sc=this.xNa(U);sc&&this.$a.raiseEvent("OnMessageParentEventKey",new F(sc,OSF.DialogMessageType.DialogMessageReceived,Ta,wb,Qb))}catch(sc){return f.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",sc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}svb(U,
Ta){if(D.H$.Fb(U))try{const wb=D.H$.ma(U);wb.dialog&&wb.dialog.hide();this.Bk.purgeDialogControl(wb.Te);D.H$.remove(U);Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(wb){f.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",wb.message),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else f.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}TJj(U,
Ta,wb,Qb){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Qb&&(Qb=wb);if(D.H$.Fb(U)&&(U=D.H$.ma(U),U.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new G(U.Te,OSF.DialogMessageType.DialogParentMessageReceived,Ta,wb,Qb))}catch(sc){f.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",sc.message)}}xNa(U){let Ta=null;for(let wb of D.H$)if(wb.value.Te===U){Ta=wb.key;break}return Ta}z3i(U,
Ta){if(U=this.xNa(Ta))this.Bk.purgeDialogControl(Ta),D.H$.remove(U),this.$a.raiseEvent("OnMessageParentEventKey",new F(U,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(U,Ta,wb,Qb,sc){U=new A(U,Ta,wb);sc=Qb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,sc);Qb&&(U.GCb=!1,U.Iu=!1);U.initializeAndShow(sc,null,null);U.EOj();return U}static kii(){return D.H$}static getInstance(U){D.Oa||(D.Oa=new D(U));return D.Oa}}D.Oa=null;D.H$=new B.a;Object(c.a)(D,
"AppsForOfficeDialogManager",null,[55]);var I=a(887),S=a(712),J=a(563),L=a(199),R=a(386),Y=a(904);class Q{constructor(){this.downloadNumber=this.AUP=this.priority=0}}Object(c.a)(Q,"AddinDetailInfo",null,[]);class W{constructor(U){this.solutionIds=null;this.errorCode=0;this.failure=null;this.$ba=U}}Object(c.a)(W,"AddinCollection",null,[]);class Ga extends Sys.EventArgs{constructor(U,Ta,wb,Qb=null){super();this.hI=U;this.errorCode=Ta;this.FK=wb;this.failure=Qb}}Object(c.a)(Ga,"AddinDetailsRefreshedEventArgs",
Sys.EventArgs,[]);class pa{constructor(U){this.errorCode=U;this.FK=[];this.failure=null}}Object(c.a)(pa,"GetAddinDetailsResult",null,[]);var aa=a(741),Z=a(822),fa=a(858),ya=a(172),Aa=a(190),ja=a(85);class za{constructor(U,Ta,wb=null){this.$a=new h.a;this.Np=new S.a(J.a.Ah());this.Uj=new R.a;this.KQ=null;this.i4=new Aa.a;this.i4.add(OSF.StoreTypeEnum.MarketPlace,0);this.i4.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ta=U;this.Bk=Ta;this.Xr=wb;this.unb=za.dBb(U,"https://store-images.s-microsoft.com");
this.Kua(Object(d.a)(this,this.oBa,"onAddinDetailsRefreshed"))}get rxa(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get VEb(){return this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Lf(){return this.Bk.value}gAb(U){if(!this.e7(U))return U=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[U]}),Object.assign(new pa(1),{failure:U});if(this.Uj.ma(U).failure)return Object.assign(new pa(this.Uj.ma(U).errorCode),
{failure:this.Uj.ma(U).failure});f.ULS.shipAssertTag(509870082,220,!!this.Uj.ma(U).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",U);const Ta=new pa(0);for(let wb of this.Uj.ma(U).solutionIds)this.Np.Fb(wb)&&Array.add(Ta.FK,this.Np.ma(wb));return Ta}fAb(U){return this.Np.Fb(U)?this.Np.ma(U):null}rfb(U){if(U){this.Kua(U);for(let wb of this.Uj.keys)if(this.e7(wb)&&!this.Uj.ma(wb).failure){f.ULS.shipAssertTag(509870081,220,!!this.Uj.ma(wb).solutionIds,
"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",wb);var Ta=[];for(let Qb of this.Uj.ma(wb).solutionIds)Array.add(Ta,this.Np.ma(Qb));Ta=new Ga(wb,this.Uj.ma(wb).errorCode,Ta);U(null,Ta)}}}$G(U,Ta=!1){0!==U&&10!==U?f.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Z.a[U]):this.iNb(U,Object(d.a)(this,this.kLb,"onQueryAddinDetailsCompleted"),Ta)}Kua(U){this.$a.addHandler(aa.a.y1a,U)}kLb(U,Ta,wb){if(wb)if(za.eIb(U,wb,window.performance.now()-
Ta),0===wb.errorCode){let sc;if(wb.value){let Vc=0;sc=Array(wb.value.length);wb.value.forEach(Ld=>{sc[Vc++]=Ld})}else sc=[];this.zC(U,sc)}else if(-1===wb.errorCode||10===wb.errorCode)this.zC(U,[]);else{var Qb={};Qb.collectionType=Y.a[U];Qb.invokeResultCode=wb.errorCode;Qb["queryResult.Value"]=wb.value?String.format("Length: {0}",wb.value.length):"null";Qb.queryStart=Ta;Qb.queryDuration=window.performance.now()-Ta;this.Uj.ia(U,Object.assign(new W(U),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",
Qb)}));f.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Y.a[U],this.Uj.ma(U).failure.toString(),JSON.stringify(this.Uj.ma(U).failure))}else Qb={},Qb.collectionType=Y.a[U],Qb.queryResult=wb?"not null":"null",Qb.queryStart=Ta,Qb.queryDuration=window.performance.now()-Ta,this.Uj.ia(U,Object.assign(new W(U),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Qb)})),f.ULS.sendTraceTag(512231323,
220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Y.a[U],this.Uj.ma(U).failure.toString(),JSON.stringify(this.Uj.ma(U).failure))}nrd(U){const Ta={};Ta.collectionType=Y.a[U];this.Uj.ia(U,Object.assign(new W(U),{errorCode:2,failure:Error.create("The store is disabled.",Ta)}));f.ULS.sendTraceTag(510253056,220,15,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Y.a[U],this.Uj.ma(U).failure.toString(),
JSON.stringify(this.Uj.ma(U).failure))}VRb(){return this.e7(2)?this.Ta.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Uj.ma(2).failure:!1:!0}iNb(U,Ta,wb=!1){f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",U);U!==OSF.StoreTypeEnum.MarketPlace&&U!==OSF.StoreTypeEnum.PrivateCatalog?f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",U):(this.VRb()&&this.queryStoreDisabled(0,(Qb,sc)=>{sc?this.nrd(2):(Qb=window.performance.now(),
Ta(2,Qb,this.zod()))}),this.queryStoreDisabled(U,(Qb,sc)=>{if(Qb===OSF.StoreTypeEnum.MarketPlace&&sc)this.nrd(0);else if(Qb===OSF.StoreTypeEnum.PrivateCatalog&&sc)this.nrd(1);else{var Vc=window.performance.now();this.Lf.getEntitlementDetails(Object.assign(new fa.a,{storeType:Qb,refresh:wb}),Ld=>{Ta(this.i4.ma(Qb),Vc,Ld)})}}))}zC(U,Ta){U=new Ga(U,0,Ta);this.$a.raiseEvent(aa.a.y1a,U)}oBa(U,Ta){U=Object.assign(new W(Ta.hI),{solutionIds:new L.a});var wb=Ta.FK;for(const Qb of wb)wb=Qb.solutionId,this.Np.Fb(wb)?
this.Np.ia(wb,this.TIb(this.Np.ma(wb),Ta.hI,Qb)):this.Np.add(wb,Qb),U.solutionIds.add(wb);this.Uj.ia(Ta.hI,U)}e7(U){return this.Uj.Fb(U)?!!this.Np:!1}get atb(){return this.Xr?!this.Xr.AreThirdPartyAddInsAllowed||this.Xr.AppsForOfficeThirdPartyIsDisabled:!this.Ta.ra("AreThirdPartyAddInsAllowed")||this.Ta.ra("AppsForOfficeThirdPartyIsDisabled")}get zFb(){return this.Xr?!this.Xr.AppsForOfficeAllowExternalMarketplace:!this.Ta.ra("AppsForOfficeAllowExternalMarketplace")}get $Ba(){return this.Xr?this.Xr.PopularAddinDetailsJsonString:
this.Ta.Va("PopularAddinDetailsJsonString")}queryStoreDisabled(U,Ta){if(this.atb)Ta(U,!0);else if(U===OSF.StoreTypeEnum.MarketPlace&&this.zFb)Ta(U,!0);else{const wb=za.ZTb(U);if(wb){const Qb=window.performance.now();this.Lf.queryStoreDisabled(wb,sc=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",U,sc,Qb,window.performance.now()-Qb);Ta(U,sc)})}else Ta(U,!1)}}TIb(U,Ta,wb){if(!U)return wb;if(!wb)return U;if(this.rxa)return 2===
Ta?za.TAa(wb,U):za.TAa(U,wb);if(2===Ta)return U.addinInfo=wb.addinInfo,U;wb.addinInfo=U.addinInfo;return wb}zod(){if(!this.KQ){const U=JSON.parse(this.$Ba);this.rzb(U);this.KQ=U}return za.XJa(0,this.KQ)}rzb(U){this.rxa&&za.Qsb(U);this.Y1a(U);this.szb(U)}Y1a(U){const Ta=this.eub();for(var wb=0;wb<U.length&&0<Ta.count;wb++){const Qb=U[wb];if(Ta.Fb(Qb.solutionId)){let sc=String.format("Found an override, solutionId: {0}",Qb.solutionId);const Vc=Ta.ma(Qb.solutionId);Vc&&(isNaN(Vc.addinInfo.priority)||
(sc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",sc,Qb.addinInfo.priority,Vc.addinInfo.priority),Qb.addinInfo.priority=Vc.addinInfo.priority),isNaN(Vc.addinInfo.AUP)||(sc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",sc,Qb.addinInfo.AUP,Vc.addinInfo.AUP),Qb.addinInfo.AUP=Vc.addinInfo.AUP),isNaN(Vc.addinInfo.downloadNumber)||(sc=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",sc,Qb.addinInfo.downloadNumber,Vc.addinInfo.downloadNumber),Qb.addinInfo.downloadNumber=
Vc.addinInfo.downloadNumber),Vc.displayName&&(sc=String.format("{0}; DisplayName: update {1} to {2}",sc,Qb.displayName,Vc.displayName),Qb.displayName=Vc.displayName),Vc.iconUrl&&(sc=String.format("{0}; IconUrl: update {1} to {2}",sc,Qb.iconUrl,Vc.iconUrl),Qb.iconUrl=Vc.iconUrl),Vc.description&&(sc=String.format("{0}; Description: update {1} to {2}",sc,Qb.description,Vc.description),Qb.description=Vc.description));Ta.remove(Qb.solutionId);this.VEb&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",
sc)}}for(let Qb of Ta.keys)wb=Ta.ma(Qb),wb.displayName&&wb.iconUrl&&wb.addinInfo&&(U.push(wb),this.VEb&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(wb)))}eub(){const U=new S.a(J.a.Ah());let Ta=this.Ta.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Ta)return U;Ta=Ta.trim();if(12>=Ta.length)return 0<Ta.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",
Ta),U;this.VEb&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Ta);try{const wb=[],Qb=Ta.split("|");for(let sc=Qb.length-1;0<=sc;sc--){const Vc=Qb[sc],Ld=Vc.split("\\");if(2>Ld.length){wb.push(Vc);continue}const le=za.hMb(Ld);le?U.Fb(le.solutionId)||U.add(le.solutionId,le):wb.push(Vc)}this.VEb&&0<wb.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",wb.join("|"));this.VEb&&0<U.count&&f.ULS.sendTraceTag(509379103,
220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",U.count,JSON.stringify(ja.toArray(U.values)));return U}catch(wb){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Ta,wb.toString())}return U}szb(U){for(let Ta=0;Ta<U.length;Ta++)ya.c(U[Ta].iconUrl.toLowerCase(),"http",0)||(U[Ta].iconUrl=String.format("{0}/image/apps.{1}",this.unb,U[Ta].iconUrl))}static eIb(U,Ta,wb){const Qb={};Qb.AddinCollectionType=
Y.a[U];Qb.ErrorCode=Ta.errorCode;Qb.AddinCount=Ta.value?Ta.value.length:0;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",wb,JSON.stringify(Qb))}static XJa(U,Ta){const wb={};wb.errorCode=U;wb.value=Ta;return wb}static ZTb(U){return U===OSF.StoreTypeEnum.MarketPlace?"omex":U===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static TAa(U,Ta){Ta.solutionId=Ta.solutionId||U.solutionId;Ta.version=Ta.version||U.version;Ta.storeType=
Ta.storeType||U.storeType;Ta.storeId=Ta.storeId||U.storeId;Ta.assetId=Ta.assetId||U.assetId;Ta.assetStoreId=Ta.assetStoreId||U.assetStoreId;Ta.displayName=Ta.displayName||U.displayName;Ta.provider=Ta.provider||U.provider;Ta.description=Ta.description||U.description;Ta.iconUrl=Ta.iconUrl||U.iconUrl;Ta.webApplicationId=Ta.webApplicationId||U.webApplicationId;Ta.highResolutionIconUrl=Ta.highResolutionIconUrl||U.highResolutionIconUrl;Ta.licenseUrl=Ta.licenseUrl||U.licenseUrl;Ta.privacyUrl=Ta.privacyUrl||
U.privacyUrl;Ta.addinInfo=Ta.addinInfo||U.addinInfo;isNaN(Ta.targetType)&&(Ta.targetType=U.targetType);isNaN(Ta.height)&&(Ta.height=U.height);isNaN(Ta.width)&&(Ta.width=U.width);return Ta}static Qsb(U){for(const Ta of U)isNaN(Ta.targetType)&&(Ta.targetType=1),Ta.assetId=Ta.assetId||Ta.solutionId,Ta.storeId=Ta.storeId||"en-US",Ta.storeType=Ta.storeType||"omex",Ta.assetStoreId=Ta.assetStoreId||"omex",isNaN(Ta.width)&&(Ta.width=0),isNaN(Ta.height)&&(Ta.height=0)}static hMb(U){const Ta={};let wb=0;wb<
U.length&&0<U[wb].trim().length&&U[wb].trim().toLowerCase().startsWith("wa")&&(Ta.solutionId=U[wb].trim(),Ta.addinInfo=Object.assign(new Q,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.priority=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.AUP=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.downloadNumber=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.displayName=
U[wb].trim()),++wb<U.length&&0<U[wb].trim().length&&(Ta.iconUrl=U[wb].trim()),++wb<U.length&&0<U[wb].trim().length&&(Ta.description=U[wb].trim()));return Ta.solutionId?Ta:null}static dBb(U,Ta){U=U.Va("AddinImageStoreServiceUrl");if(!U)return Ta;U=U.toLowerCase();return U.startsWith("http://")||U.startsWith("https://")?U:Ta}}Object(c.a)(za,"AddinDetailsManager",null,[386,387]);class ra{constructor(U,Ta=0){this.failure=null;this.$ba=U;this.errorCode=Ta}}Object(c.a)(ra,"AddinQueryResult",null,[]);class fb extends ra{constructor(U,
Ta=0){super(U,Ta);this.solutionIds=null}}Object(c.a)(fb,"AddinCollection",ra,[]);var Ua=a(906);class Ca{constructor(U,Ta,wb=null){this.$a=new h.a;this.Np=new S.a(J.a.Ah());this.Uj=new R.a;this.KQ=null;this.i4=new Aa.a;this.i4.add(OSF.StoreTypeEnum.MarketPlace,0);this.i4.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ta=U;this.Bk=Ta;this.Xr=wb;this.unb=Ca.dBb(U,"https://store-images.s-microsoft.com");this.Kua(Object(d.a)(this,this.oBa,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ta&&
this.Ta.ra("IsAnonymousUser")}get zjd(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get Ezb(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get rxa(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get r6(){return this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Lf(){return this.Bk.value}gAb(U){if(!this.e7(U))return U=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[U]}),Object.assign(new pa(1),{failure:U});if(this.Uj.ma(U).failure)return Object.assign(new pa(this.Uj.ma(U).errorCode),{failure:this.Uj.ma(U).failure});f.ULS.shipAssertTag(509870082,220,!!this.Uj.ma(U).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",U);const Ta=new pa(0);for(let wb of this.Uj.ma(U).solutionIds)this.Np.Fb(wb)&&Array.add(Ta.FK,this.Np.ma(wb));return Ta}fAb(U){return this.Np.Fb(U)?
this.Np.ma(U):null}rfb(U){if(U){this.Kua(U);for(let Ta of this.Uj.keys){if(!this.e7(Ta)||this.Uj.ma(Ta).failure)continue;f.ULS.shipAssertTag(509870081,220,!!this.Uj.ma(Ta).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ta);const wb=[],Qb=this.Uj.ma(Ta);for(let sc of Qb.solutionIds)Array.add(wb,this.Np.ma(sc));U(null,new Ga(Ta,Qb.errorCode,wb,Qb.failure))}}}$G(U,Ta=!1){0!==U&&10!==U?f.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
Z.a[U]):this.iNb(U,Object(d.a)(this,this.kLb,"onQueryAddinDetailsCompleted"),Ta)}Kua(U){this.$a.addHandler(aa.a.y1a,U)}kLb(U,Ta,wb){if(wb)if(Ca.eIb(U,wb,window.performance.now()-Ta),0===wb.errorCode){let Qb;if(wb.value){let sc=0;Qb=Array(wb.value.length);wb.value.forEach(Vc=>{Qb[sc++]=Vc})}else Qb=[];this.zC(new ra(U),Qb)}else-1===wb.errorCode||10===wb.errorCode?this.zC(new ra(U),[]):(U=this.o6c(U,Ta,wb),this.zC(U));else U=Ca.p6c(U,Ta),this.zC(U)}o6c(U,Ta,wb){const Qb={};Qb.collectionType=Y.a[U];
Qb.invokeResultCode=wb.errorCode;Qb["queryResult.Value"]=wb.value?String.format("Length: {0}",wb.value.length):"null";Qb.queryStart=Ta;Qb.queryDuration=window.performance.now()-Ta;return Object.assign(new ra(U,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Qb)})}VRb(){return this.e7(2)?this.Ta.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Uj.ma(2).failure:!1:!0}iNb(U,Ta,wb=!1){f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",
U);U!==OSF.StoreTypeEnum.MarketPlace&&U!==OSF.StoreTypeEnum.PrivateCatalog?f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",U):(this.VRb()&&this.queryStoreDisabled(0,(Qb,sc)=>{sc?(Qb=Ca.ZJa(2),this.zC(Qb)):(Qb=window.performance.now(),Ta(2,Qb,this.zod()))}),this.Ezb&&this.isAnonymousUser?(U=Ca.c6c(U===OSF.StoreTypeEnum.MarketPlace?0:1),this.zC(U)):this.queryStoreDisabled(U,(Qb,sc)=>{if(Qb===OSF.StoreTypeEnum.MarketPlace&&sc)sc=Ca.ZJa(0),this.zC(sc);else if(Qb===OSF.StoreTypeEnum.PrivateCatalog&&
sc)sc=Ca.ZJa(1),this.zC(sc);else{var Vc=window.performance.now();this.Lf.getEntitlementDetails(Object.assign(new fa.a,{storeType:Qb,refresh:wb}),Ld=>{Ta(this.i4.ma(Qb),Vc,Ld)})}}))}zC(U,Ta=null){0!==U.errorCode?(f.ULS.shipAssertTag(509116673,220,!Ta,"The parameter addinDetails must be null for any failed queries"),f.ULS.shipAssertTag(509116672,220,!!U.failure,"The result.Failure must not be available for any failed queries"),f.ULS.sendTraceTag(510253056,220,this.Upd(U),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",
Y.a[U.$ba],Ua.a[U.errorCode],U.failure?U.failure.toString():"null",JSON.stringify(U.failure))):(f.ULS.shipAssertTag(509116643,220,!!Ta,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",Y.a[U.$ba]),f.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Y.a[U.$ba],Ta?Ta.length:-1));U=new Ga(U.$ba,U.errorCode,Ta,U.failure);this.$a.raiseEvent(aa.a.y1a,U)}Upd(U){return 3===U.errorCode&&
(this.Ezb&&-2147208619===Ca.gBb(U)||this.zjd&&-2===Ca.gBb(U))?15:2===U.errorCode?15:10}oBa(U,Ta){if(0!==Ta.errorCode)this.Uj.ia(Ta.hI,Object.assign(new fb(Ta.hI,Ta.errorCode),{failure:Ta.failure}));else{U=Object.assign(new fb(Ta.hI),{solutionIds:new L.a});var wb=Ta.FK;for(const Qb of wb)wb=Qb.solutionId,this.Np.Fb(wb)?this.Np.ia(wb,this.TIb(this.Np.ma(wb),Ta.hI,Qb)):this.Np.add(wb,Qb),U.solutionIds.add(wb);this.Uj.ia(Ta.hI,U)}}e7(U){return this.Uj.Fb(U)?!!this.Np:!1}get atb(){return this.Xr?!this.Xr.AreThirdPartyAddInsAllowed||
this.Xr.AppsForOfficeThirdPartyIsDisabled:!this.Ta.ra("AreThirdPartyAddInsAllowed")||this.Ta.ra("AppsForOfficeThirdPartyIsDisabled")}get zFb(){return this.Xr?!this.Xr.AppsForOfficeAllowExternalMarketplace:!this.Ta.ra("AppsForOfficeAllowExternalMarketplace")}get $Ba(){return this.Xr?this.Xr.PopularAddinDetailsJsonString:this.Ta.Va("PopularAddinDetailsJsonString")}queryStoreDisabled(U,Ta){if(this.atb)Ta(U,!0);else if(U===OSF.StoreTypeEnum.MarketPlace&&this.zFb)Ta(U,!0);else{const wb=Ca.ZTb(U);if(wb){const Qb=
window.performance.now();this.Lf.queryStoreDisabled(wb,sc=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",U,sc,Qb,window.performance.now()-Qb);Ta(U,sc)})}else Ta(U,!1)}}TIb(U,Ta,wb){if(!U)return wb;if(!wb)return U;if(this.rxa)return 2===Ta?Ca.TAa(wb,U):Ca.TAa(U,wb);if(2===Ta)return U.addinInfo=wb.addinInfo,U;wb.addinInfo=U.addinInfo;return wb}zod(){if(!this.KQ){const U=JSON.parse(this.$Ba);this.rzb(U);this.KQ=U}return Ca.XJa(0,
this.KQ)}rzb(U){this.rxa&&Ca.Qsb(U);this.Y1a(U);this.szb(U)}Y1a(U){const Ta=this.eub();for(var wb=0;wb<U.length&&0<Ta.count;wb++){const Qb=U[wb];if(Ta.Fb(Qb.solutionId)){let sc=String.format("Found an override, solutionId: {0}",Qb.solutionId);const Vc=Ta.ma(Qb.solutionId);Vc&&(isNaN(Vc.addinInfo.priority)||(sc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",sc,Qb.addinInfo.priority,Vc.addinInfo.priority),Qb.addinInfo.priority=Vc.addinInfo.priority),isNaN(Vc.addinInfo.AUP)||(sc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
sc,Qb.addinInfo.AUP,Vc.addinInfo.AUP),Qb.addinInfo.AUP=Vc.addinInfo.AUP),isNaN(Vc.addinInfo.downloadNumber)||(sc=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",sc,Qb.addinInfo.downloadNumber,Vc.addinInfo.downloadNumber),Qb.addinInfo.downloadNumber=Vc.addinInfo.downloadNumber),Vc.displayName&&(sc=String.format("{0}; DisplayName: update {1} to {2}",sc,Qb.displayName,Vc.displayName),Qb.displayName=Vc.displayName),Vc.iconUrl&&(sc=String.format("{0}; IconUrl: update {1} to {2}",sc,Qb.iconUrl,
Vc.iconUrl),Qb.iconUrl=Vc.iconUrl),Vc.description&&(sc=String.format("{0}; Description: update {1} to {2}",sc,Qb.description,Vc.description),Qb.description=Vc.description));Ta.remove(Qb.solutionId);this.r6&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",sc)}}for(let Qb of Ta.keys)wb=Ta.ma(Qb),wb.displayName&&wb.iconUrl&&wb.addinInfo&&(U.push(wb),this.r6&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(wb)))}eub(){const U=new S.a(J.a.Ah());let Ta=this.Ta.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Ta)return U;Ta=Ta.trim();if(12>=Ta.length)return 0<Ta.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Ta),U;this.r6&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Ta);try{const wb=[],Qb=Ta.split("|");for(let sc=Qb.length-1;0<=sc;sc--){const Vc=
Qb[sc],Ld=Vc.split("\\");if(2>Ld.length){wb.push(Vc);continue}const le=Ca.hMb(Ld);le?U.Fb(le.solutionId)||U.add(le.solutionId,le):wb.push(Vc)}this.r6&&0<wb.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",wb.join("|"));this.r6&&0<U.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",U.count,JSON.stringify(ja.toArray(U.values)));return U}catch(wb){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Ta,wb.toString())}return U}szb(U){for(let Ta=0;Ta<U.length;Ta++)ya.c(U[Ta].iconUrl.toLowerCase(),"http",0)||(U[Ta].iconUrl=String.format("{0}/image/apps.{1}",this.unb,U[Ta].iconUrl))}static p6c(U,Ta){const wb={};wb.collectionType=Y.a[U];wb.queryResult="null";wb.queryStart=Ta;wb.queryDuration=window.performance.now()-Ta;return Object.assign(new ra(U,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",wb)})}static ZJa(U){const Ta={};Ta.collectionType=Y.a[U];return Object.assign(new ra(U,
2),{failure:Error.create("The store is disabled.",Ta)})}static c6c(U){const Ta={};Ta.collectionType=Y.a[U];Ta.invokeResultCode=-2147208619;Ta.queryDuration=0;return Object.assign(new ra(U,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Ta)})}static gBb(U){return U.failure?U.failure.invokeResultCode:-1E3}static eIb(U,Ta,wb){const Qb={};Qb.AddinCollectionType=Y.a[U];Qb.ErrorCode=Ta.errorCode;Qb.AddinCount=Ta.value?Ta.value.length:0;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",
wb,JSON.stringify(Qb))}static XJa(U,Ta){const wb={};wb.errorCode=U;wb.value=Ta;return wb}static ZTb(U){return U===OSF.StoreTypeEnum.MarketPlace?"omex":U===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static TAa(U,Ta){Ta.solutionId=Ta.solutionId||U.solutionId;Ta.version=Ta.version||U.version;Ta.storeType=Ta.storeType||U.storeType;Ta.storeId=Ta.storeId||U.storeId;Ta.assetId=Ta.assetId||U.assetId;Ta.assetStoreId=Ta.assetStoreId||U.assetStoreId;Ta.displayName=Ta.displayName||U.displayName;Ta.provider=
Ta.provider||U.provider;Ta.description=Ta.description||U.description;Ta.iconUrl=Ta.iconUrl||U.iconUrl;Ta.webApplicationId=Ta.webApplicationId||U.webApplicationId;Ta.highResolutionIconUrl=Ta.highResolutionIconUrl||U.highResolutionIconUrl;Ta.licenseUrl=Ta.licenseUrl||U.licenseUrl;Ta.privacyUrl=Ta.privacyUrl||U.privacyUrl;Ta.addinInfo=Ta.addinInfo||U.addinInfo;isNaN(Ta.targetType)&&(Ta.targetType=U.targetType);isNaN(Ta.height)&&(Ta.height=U.height);isNaN(Ta.width)&&(Ta.width=U.width);return Ta}static Qsb(U){for(const Ta of U)isNaN(Ta.targetType)&&
(Ta.targetType=1),Ta.assetId=Ta.assetId||Ta.solutionId,Ta.storeId=Ta.storeId||"en-US",Ta.storeType=Ta.storeType||"omex",Ta.assetStoreId=Ta.assetStoreId||"omex",isNaN(Ta.width)&&(Ta.width=0),isNaN(Ta.height)&&(Ta.height=0)}static hMb(U){const Ta={};let wb=0;wb<U.length&&0<U[wb].trim().length&&U[wb].trim().toLowerCase().startsWith("wa")&&(Ta.solutionId=U[wb].trim(),Ta.addinInfo=Object.assign(new Q,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++wb<U.length&&0<U[wb].trim().length&&
(Ta.addinInfo.priority=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.AUP=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.downloadNumber=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.displayName=U[wb].trim()),++wb<U.length&&0<U[wb].trim().length&&(Ta.iconUrl=U[wb].trim()),++wb<U.length&&0<U[wb].trim().length&&(Ta.description=U[wb].trim()));return Ta.solutionId?Ta:null}static dBb(U,Ta){U=U.Va("AddinImageStoreServiceUrl");
if(!U)return Ta;U=U.toLowerCase();return U.startsWith("http://")||U.startsWith("https://")?U:Ta}}Object(c.a)(Ca,"AddinDetailsManager1",null,[386,387]);class Ia{constructor(U,Ta=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=U.solutionId;
this.version=U.version;this.storeType=U.storeType;this.storeId=U.storeId;this.assetId=U.assetId;this.assetStoreId=U.assetStoreId;this.displayName=U.displayName;this.provider=U.provider;this.description=U.description;this.targetType=U.targetType;this.height=U.height;this.width=U.width;this.iconUrl=U.iconUrl;this.webApplicationId=U.webApplicationId;this.highResolutionIconUrl=U.highResolutionIconUrl;this.licenseUrl=U.licenseUrl;this.privacyUrl=U.privacyUrl;this.addinInfo=Ta}XTb(){const U={};U.solutionId=
this.solutionId;U.version=this.version;U.storeType=this.storeType;U.storeId=this.storeId;U.assetId=this.assetId;U.assetStoreId=this.assetStoreId;U.targetType=this.targetType;U.displayName=this.displayName;U.width=this.width;U.height=this.height;return U}}Object(c.a)(Ia,"AddinDetail",null,[]);class oa{constructor(U,Ta,wb,Qb,sc){this.X1b=null;this.Ta=U;this.Bk=Ta;this.JHa=wb;this.lMg=Qb;this.Vlb=sc}$G(U,Ta){this.Lf.queryAppDetails(this.lMg,this.Vlb,this.solutionIds,U,(wb,Qb)=>{const sc=Array(Qb.length);
for(let Vc=0;Vc<Qb.length;Vc++)sc[Vc]=new Ia(Qb[Vc],this.kSi(Qb[Vc].solutionId));Ta(wb,sc)})}get tCi(){return!!this.Lf.queryAppDetails}kSi(U){return this.JHa.ma(U)}get solutionIds(){if(!this.X1b){this.X1b=new L.a;for(let U of this.JHa.keys)this.X1b.add(ya.d(U))}return this.X1b.toArray()}get Lf(){return this.Bk.value}}Object(c.a)(oa,"AddinDetailsLoader",null,[]);class Da{constructor(U,Ta=0){this.failure=null;this.$ba=U;this.errorCode=Ta}}Object(c.a)(Da,"AddinQueryResult",null,[]);class bb extends Da{constructor(U,
Ta=0){super(U,Ta);this.r2d=this.solutionIds=null}}Object(c.a)(bb,"AddinCollection",Da,[]);var Za=a(721);class Xa extends Za.a{constructor(){super(J.a.Ah())}}Object(c.a)(Xa,"AddinDetailTable",Za.a,[]);class Ba{constructor(U,Ta,wb=null){this.$a=new h.a;this.Np=new S.a(J.a.Ah());this.Uj=new R.a;this.JHa=this.KQ=null;this.i4=new Aa.a;this.i4.add(OSF.StoreTypeEnum.MarketPlace,0);this.i4.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ta=U;this.Bk=Ta;this.Xr=wb;this.unb=Ba.dBb(U,"https://store-images.s-microsoft.com");
this.WWc=null;this.Kua(Object(d.a)(this,this.oBa,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ta&&this.Ta.ra("IsAnonymousUser")}get zjd(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get Ezb(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get rxa(){return!!this.Ta&&this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)}get r6(){return this.Ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Lf(){return this.Bk.value}get TMd(){this.WWc||(this.WWc=new oa(this.Ta,this.Bk,this.Yij,0,this.Lf.getAppUILocale()));return this.WWc}gAb(U){if(!this.e7(U))return U=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[U]}),Object.assign(new pa(1),{failure:U});const Ta=this.Uj.ma(U);if(Ta.failure)return Object.assign(new pa(Ta.errorCode),{failure:Ta.failure});
f.ULS.shipAssertTag(509870082,220,!!Ta.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",U);const wb=new pa(0);for(let Qb=0;Qb<Ta.solutionIds.count;Qb++){const sc=Ta.solutionIds.ma(Qb),Vc=Ta.r2d.ma(Qb);if(this.Np.Fb(sc)){const Ld=this.Np.ma(sc);Ld.Fb(Vc)?Array.add(wb.FK,Ld.ma(Vc)):f.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",sc,U,Vc)}else f.ULS.sendTraceTag(0,220,15,
"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",sc,U)}return wb}fAb(U,Ta=null){if(U=this.RZh(U))if(Ta||(Ta=this.uiCulture),U.Fb(Ta))return U.ma(Ta);return null}RZh(U){return this.Np.Fb(U)?this.Np.ma(U):null}rfb(U){if(U){this.Kua(U);for(let Ta of this.Uj.keys){if(!this.e7(Ta)||this.Uj.ma(Ta).failure)continue;f.ULS.shipAssertTag(509870081,220,!!this.Uj.ma(Ta).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ta);const wb=
[],Qb=this.Uj.ma(Ta);for(let sc of Qb.solutionIds)Array.add(wb,this.Np.ma(sc));U(null,new Ga(Ta,Qb.errorCode,wb,Qb.failure))}}}$G(U,Ta=!1){0!==U&&10!==U?f.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Z.a[U]):this.iNb(U,Object(d.a)(this,this.kLb,"onQueryAddinDetailsCompleted"),Ta)}Kua(U){this.$a.addHandler(aa.a.y1a,U)}kLb(U,Ta,wb){wb?(Ba.eIb(U,wb,window.performance.now()-Ta),0===wb.errorCode?(Ta=wb.value?Ba.G0g(wb.value):[],this.zC(new Da(U),Ta)):-1===wb.errorCode||
10===wb.errorCode?this.zC(new Da(U),[]):(U=this.o6c(U,Ta,wb),this.zC(U))):(U=Ba.p6c(U,Ta),this.zC(U))}o6c(U,Ta,wb){const Qb={};Qb.collectionType=Y.a[U];Qb.invokeResultCode=wb.errorCode;Qb["queryResult.Value"]=wb.value?String.format("Length: {0}",wb.value.length):"null";Qb.queryStart=Ta;Qb.queryDuration=window.performance.now()-Ta;return Object.assign(new Da(U,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Qb)})}VRb(){return this.e7(2)?this.Ta.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?
!!this.Uj.ma(2).failure:!1:!0}iNb(U,Ta,wb=!1){f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",U);U!==OSF.StoreTypeEnum.MarketPlace&&U!==OSF.StoreTypeEnum.PrivateCatalog?f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",U):(this.VRb()&&this.queryStoreDisabled(0,(Qb,sc)=>{sc?(Qb=Ba.ZJa(2),this.zC(Qb)):this.clj(Ta)}),this.Ezb&&this.isAnonymousUser?(U=Ba.c6c(U===OSF.StoreTypeEnum.MarketPlace?0:1),this.zC(U)):this.queryStoreDisabled(U,(Qb,sc)=>{if(Qb===
OSF.StoreTypeEnum.MarketPlace&&sc)sc=Ba.ZJa(0),this.zC(sc);else if(Qb===OSF.StoreTypeEnum.PrivateCatalog&&sc)sc=Ba.ZJa(1),this.zC(sc);else{var Vc=window.performance.now();this.Lf.getEntitlementDetails(Object.assign(new fa.a,{storeType:Qb,refresh:wb}),Ld=>{Ta(this.i4.ma(Qb),Vc,Ld)})}}))}zC(U,Ta=null){0!==U.errorCode?(f.ULS.shipAssertTag(509116673,220,!Ta,"The parameter addinDetails must be null for any failed queries"),f.ULS.shipAssertTag(509116672,220,!!U.failure,"The result.Failure must not be available for any failed queries"),
f.ULS.sendTraceTag(510253056,220,this.Upd(U),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",Y.a[U.$ba],Ua.a[U.errorCode],U.failure?U.failure.toString():"null",JSON.stringify(U.failure))):(f.ULS.shipAssertTag(509116643,220,!!Ta,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",Y.a[U.$ba]),f.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",
Y.a[U.$ba],Ta?Ta.length:-1));U=new Ga(U.$ba,U.errorCode,Ta,U.failure);this.$a.raiseEvent(aa.a.y1a,U)}Upd(U){return 3===U.errorCode&&(this.Ezb&&-2147208619===Ba.gBb(U)||this.zjd&&-2===Ba.gBb(U))?15:2===U.errorCode?15:10}oBa(U,Ta){if(0!==Ta.errorCode)this.Uj.ia(Ta.hI,Object.assign(new bb(Ta.hI,Ta.errorCode),{failure:Ta.failure}));else{U=Object.assign(new bb(Ta.hI),{solutionIds:new L.a,r2d:new L.a});var wb=Ta.FK;for(const sc of wb){wb=sc.solutionId;const Vc=sc.storeId;if(this.Np.Fb(wb)){var Qb=this.Np.ma(wb);
Qb.Fb(Vc)?Qb.ia(Vc,this.TIb(Qb.ma(Vc),Ta.hI,sc)):Qb.add(Vc,sc)}else Qb=new Xa,Qb.add(Vc,sc),this.Np.add(wb,Qb);U.solutionIds.add(wb);U.r2d.add(Vc)}this.Uj.ia(Ta.hI,U)}}e7(U){return this.Uj.Fb(U)?!!this.Np:!1}get uiCulture(){return this.Xr&&this.Xr.UICulture?this.Xr.UICulture:w.AFrameworkApplication.uiCulture}get atb(){return this.Xr?!this.Xr.AreThirdPartyAddInsAllowed||this.Xr.AppsForOfficeThirdPartyIsDisabled:!this.Ta.ra("AreThirdPartyAddInsAllowed")||this.Ta.ra("AppsForOfficeThirdPartyIsDisabled")}get zFb(){return this.Xr?
!this.Xr.AppsForOfficeAllowExternalMarketplace:!this.Ta.ra("AppsForOfficeAllowExternalMarketplace")}get Yij(){if(!this.JHa){this.JHa=new S.a(J.a.Ah());const U=JSON.parse(this.$Ba);for(const Ta of U)this.JHa.add(Ta.solutionId,Ta.addinInfo)}return this.JHa}get $Ba(){return this.Xr?this.Xr.PopularAddinDetailsJsonString:this.Ta.Va("PopularAddinDetailsJsonString")}queryStoreDisabled(U,Ta){if(this.atb)Ta(U,!0);else if(U===OSF.StoreTypeEnum.MarketPlace&&this.zFb)Ta(U,!0);else{const wb=Ba.ZTb(U);if(wb){const Qb=
window.performance.now();this.Lf.queryStoreDisabled(wb,sc=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",U,sc,Qb,window.performance.now()-Qb);Ta(U,sc)})}else Ta(U,!1)}}TIb(U,Ta,wb){if(!U)return wb;if(!wb)return U;if(this.rxa)return 2===Ta?Ba.TAa(wb,U):Ba.TAa(U,wb);if(2===Ta)return U.addinInfo=wb.addinInfo,U;wb.addinInfo=U.addinInfo;return wb}clj(U){const Ta=window.performance.now();if(this.KQ)U(2,Ta,Ba.XJa(0,this.KQ));
else if(this.TMd&&this.TMd.tCi)this.TMd.$G(!1,(Qb,sc)=>{this.Y1a(sc);this.KQ=sc;U(2,Ta,Ba.XJa(Qb,this.KQ))});else{var wb=JSON.parse(this.$Ba);this.rzb(wb);this.KQ=wb;U(2,Ta,Ba.XJa(0,this.KQ))}}rzb(U){this.rxa&&Ba.Qsb(U);this.Y1a(U);this.szb(U)}Y1a(U){const Ta=this.eub();for(var wb=0;wb<U.length&&0<Ta.count;wb++){const Qb=U[wb];if(Ta.Fb(Qb.solutionId)){let sc=String.format("Found an override, solutionId: {0}",Qb.solutionId);const Vc=Ta.ma(Qb.solutionId);Vc&&(isNaN(Vc.addinInfo.priority)||(sc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
sc,Qb.addinInfo.priority,Vc.addinInfo.priority),Qb.addinInfo.priority=Vc.addinInfo.priority),isNaN(Vc.addinInfo.AUP)||(sc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",sc,Qb.addinInfo.AUP,Vc.addinInfo.AUP),Qb.addinInfo.AUP=Vc.addinInfo.AUP),isNaN(Vc.addinInfo.downloadNumber)||(sc=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",sc,Qb.addinInfo.downloadNumber,Vc.addinInfo.downloadNumber),Qb.addinInfo.downloadNumber=Vc.addinInfo.downloadNumber),Vc.displayName&&(sc=String.format("{0}; DisplayName: update {1} to {2}",
sc,Qb.displayName,Vc.displayName),Qb.displayName=Vc.displayName),Vc.iconUrl&&(sc=String.format("{0}; IconUrl: update {1} to {2}",sc,Qb.iconUrl,Vc.iconUrl),Qb.iconUrl=Vc.iconUrl),Vc.description&&(sc=String.format("{0}; Description: update {1} to {2}",sc,Qb.description,Vc.description),Qb.description=Vc.description));Ta.remove(Qb.solutionId);this.r6&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",sc)}}for(let Qb of Ta.keys)wb=Ta.ma(Qb),wb.displayName&&wb.iconUrl&&wb.addinInfo&&
(U.push(wb),this.r6&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(wb)))}eub(){const U=new S.a(J.a.Ah());let Ta=this.Ta.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Ta)return U;Ta=Ta.trim();if(12>=Ta.length)return 0<Ta.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Ta),U;this.r6&&f.ULS.sendTraceTag(509379105,
220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Ta);try{const wb=[],Qb=Ta.split("|");for(let sc=Qb.length-1;0<=sc;sc--){const Vc=Qb[sc],Ld=Vc.split("\\");if(2>Ld.length){wb.push(Vc);continue}const le=Ba.hMb(Ld);le?U.Fb(le.solutionId)||U.add(le.solutionId,le):wb.push(Vc)}this.r6&&0<wb.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",wb.join("|"));this.r6&&0<U.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",
U.count,JSON.stringify(ja.toArray(U.values)));return U}catch(wb){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Ta,wb.toString())}return U}szb(U){for(let Ta=0;Ta<U.length;Ta++)ya.c(U[Ta].iconUrl.toLowerCase(),"http",0)||(U[Ta].iconUrl=String.format("{0}/image/apps.{1}",this.unb,U[Ta].iconUrl))}static p6c(U,Ta){const wb={};wb.collectionType=Y.a[U];wb.queryResult="null";wb.queryStart=Ta;wb.queryDuration=window.performance.now()-
Ta;return Object.assign(new Da(U,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",wb)})}static ZJa(U){const Ta={};Ta.collectionType=Y.a[U];return Object.assign(new Da(U,2),{failure:Error.create("The store is disabled.",Ta)})}static c6c(U){const Ta={};Ta.collectionType=Y.a[U];Ta.invokeResultCode=-2147208619;Ta.queryDuration=0;return Object.assign(new Da(U,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Ta)})}static gBb(U){return U.failure?U.failure.invokeResultCode:
-1E3}static eIb(U,Ta,wb){const Qb={};Qb.AddinCollectionType=Y.a[U];Qb.ErrorCode=Ta.errorCode;Qb.AddinCount=Ta.value?Ta.value.length:0;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",wb,JSON.stringify(Qb))}static XJa(U,Ta){const wb={};wb.errorCode=U;wb.value=Ta;return wb}static ZTb(U){return U===OSF.StoreTypeEnum.MarketPlace?"omex":U===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static TAa(U,Ta){Ta.solutionId=Ta.solutionId||
U.solutionId;Ta.version=Ta.version||U.version;Ta.storeType=Ta.storeType||U.storeType;Ta.storeId=Ta.storeId||U.storeId;Ta.assetId=Ta.assetId||U.assetId;Ta.assetStoreId=Ta.assetStoreId||U.assetStoreId;Ta.displayName=Ta.displayName||U.displayName;Ta.provider=Ta.provider||U.provider;Ta.description=Ta.description||U.description;Ta.iconUrl=Ta.iconUrl||U.iconUrl;Ta.webApplicationId=Ta.webApplicationId||U.webApplicationId;Ta.highResolutionIconUrl=Ta.highResolutionIconUrl||U.highResolutionIconUrl;Ta.licenseUrl=
Ta.licenseUrl||U.licenseUrl;Ta.privacyUrl=Ta.privacyUrl||U.privacyUrl;Ta.addinInfo=Ta.addinInfo||U.addinInfo;isNaN(Ta.targetType)&&(Ta.targetType=U.targetType);isNaN(Ta.height)&&(Ta.height=U.height);isNaN(Ta.width)&&(Ta.width=U.width);return Ta}static G0g(U){const Ta=Array(U.length);for(let wb=0;wb<Ta.length;wb++)Ta[wb]=new Ia(U[wb],U[wb].addinInfo);return Ta}static Qsb(U){for(const Ta of U)isNaN(Ta.targetType)&&(Ta.targetType=1),Ta.assetId=Ta.assetId||Ta.solutionId,Ta.storeId=Ta.storeId||"en-US",
Ta.storeType=Ta.storeType||"omex",Ta.assetStoreId=Ta.assetStoreId||"omex",isNaN(Ta.width)&&(Ta.width=0),isNaN(Ta.height)&&(Ta.height=0)}static hMb(U){const Ta={};let wb=0;wb<U.length&&0<U[wb].trim().length&&U[wb].trim().toLowerCase().startsWith("wa")&&(Ta.solutionId=U[wb].trim(),Ta.addinInfo=Object.assign(new Q,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.priority=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.AUP=
parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.addinInfo.downloadNumber=parseInt(U[wb].trim())),++wb<U.length&&0<U[wb].trim().length&&(Ta.displayName=U[wb].trim()),++wb<U.length&&0<U[wb].trim().length&&(Ta.iconUrl=U[wb].trim()),++wb<U.length&&0<U[wb].trim().length&&(Ta.description=U[wb].trim()));return Ta.solutionId?Ta:null}static dBb(U,Ta){U=U.Va("AddinImageStoreServiceUrl");if(!U)return Ta;U=U.toLowerCase();return U.startsWith("http://")||U.startsWith("https://")?U:Ta}}Object(c.a)(Ba,
"AddinDetailsManager2",null,[386,387]);class Wa{static createInstance(U,Ta,wb=null){if(Wa.IEi(U)){if(Wa.BZg(U))return f.ULS.sendTraceTag(508925833,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),new Ba(U,Ta,wb);f.ULS.sendTraceTag(508925832,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");return new Ca(U,Ta,wb)}f.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");
return new za(U,Ta,wb)}static IEi(U){return(U||w.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static BZg(U){return(U||w.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}}Object(c.a)(Wa,"AddinDetailsManagerFactory",null,[]);var Na=a(855),ta=a(1359),V=a(1463),ia=a(981),X=a(188),la=a(1367),sa=a(131),Va=a(84),nb=a(92),ha=a(662),jb=a(126),Fb=a(425),Rb=a(562),mb=
a(170),sb=a(42),Ya=a(7),Ma=a(905),xb=a(1285),qb=a(86);class Ra{constructor(){this.command=0;this.properties=null}}Object(c.a)(Ra,"DdaRequestInfo",null,[]);var Jb=a(760),yb=a(79);class Gb extends qb.a{constructor(U,Ta){super();this.requests=[];this.disposed=this.f8b=!1;this.Jg=()=>{if(!this.disposed){this.grid.wc.Qm(this.Jg);this.f8b=!1;const wb=this.requests;this.requests=[];for(let Qb of wb)this.ddaFacade.BL(Qb.command,Qb.properties)}};this.ddaFacade=U;this.grid=Ta}nvh(U,Ta){this.disposed||(this.f8b||
(this.grid.wc.Bm(this.Jg),this.f8b=!0),this.requests.push(Object(b.a)(new Ra,{command:U,properties:Ta})))}dispose(){if(!this.disposed){this.disposed=!0;this.f8b&&this.grid.wc.Qm(this.Jg);var U=this.requests;this.requests=null;for(let Ta of U)(U=Ta.properties?Ta.properties[yb.a.L5]:null)&&this.ddaFacade.kg(Jb.a.$Db,U);this.ddaFacade=this.grid=null;super.dispose()}}static Agh(U,Ta){var wb=!1;974713501===U&&(Ta=(U=Ta?Ta[yb.a.Bg]:null)?U.DdaMethod:null)&&Ta.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(wb=U.ArrayData,wb=!!wb&&64===(wb[6]&64));return wb}}Object(c.a)(Gb,"DdaCellEditDelayRequestHandler",qb.a,[]);var ub=a(796);class Ja extends ub.a{constructor(U,Ta,wb,Qb,sc,Vc,Ld){super(U,Ta,wb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Qb;this.messageContent=sc;this.messageOrigin=Vc;this.targetOrigin=Ld}}Object(c.a)(Ja,"DialogMessageReceivedEventArgs",ub.a,[]);class zb extends ub.a{constructor(U,Ta,wb,Qb,sc,Vc,Ld){super(U,Ta,wb);this.messageType=
0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Qb;this.messageContent=sc;this.messageOrigin=Vc;this.targetOrigin=Ld}}Object(c.a)(zb,"DialogParentMessageReceivedEventArgs",ub.a,[]);var na=a(1),Ea=a(20);class ma{constructor(U){this.Lf=this.d4c=null;this.d9i=(Ta,wb)=>{this.handlers.Fb(wb.controlId)&&(Ta=new Ja(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,wb.controlId,null,wb.messageType,wb.messageContent,wb.messageOrigin,wb.targetOrigin),this.handlers.ma(wb.controlId)(Ta),
wb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(wb.controlId))};this.c9i=(Ta,wb)=>{this.Bsc.Fb(wb.controlId)&&(Ta=new zb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,wb.controlId,null,wb.messageType,wb.messageContent,wb.messageOrigin,wb.targetOrigin),this.Bsc.ma(wb.controlId)(Ta))};this.handlers=new B.a;this.Bsc=new B.a;this.Gh=U;this.j5a.bYg(this.d9i);this.j5a.aYg(this.c9i)}get j5a(){this.d4c||(this.d4c=D.getInstance(this.contextActivationMgr));return this.d4c}get contextActivationMgr(){!this.Lf&&
this.Gh&&(this.Lf=this.Gh.Lf);return this.Lf}addHandler(U,Ta,wb,Qb){if(na.EwaSettings.ya(23))this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,wb);else{f.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const sc=Vc=>{Vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(U,Ta),this.Gh.Gw(wb)):(f.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Gh.kg(Vc,wb))};this.handlers.Fb(U)?
sc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(U,Qb,sc)}}zTg(U,Ta,wb){na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,wb):(f.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Bsc.ia(U,Ta),this.Gh.Gw(wb))}removeHandler(U,Ta){na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):this.handlers.Fb(U)?(f.ULS.sendTraceTag(537170499,
0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.j5a.svb(U,wb=>{this.handlers.remove(U);wb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Gh.Gw(Ta):(f.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Gh.kg(wb,Ta))})):this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ta)}uwj(U,Ta){na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):(f.ULS.sendTraceTag(537170497,0,50,
"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Bsc.remove(U),this.Gh.Gw(Ta))}showDialog(U,Ta,wb){try{na.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Ea.h(this.Gh.$).Eb&&Ea.h(this.Gh.$).Jp(!0),this.j5a.showDialog(Ta,U,wb,Qb=>{this.Gh.QTg(this.i9g(Qb))})}catch(Qb){f.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Qb.message}`),wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}i9g(U){const Ta=
{};Ta.InstanceId=U.id;Ta.WebExtensionType=U.osfControlType===OSF.OsfControlTarget.InContent?0:1;Ta.PrimaryMarketplace={};Ta.PrimaryMarketplace.SolutionId=U.solutionId;Ta.PrimaryMarketplace.SolutionVersion=U.version;Ta.PrimaryMarketplace.MarketplaceRef=U.storeId;Ta.PrimaryMarketplace.MarketplaceType=U.storeType;Ta.OwnerAddinSolutionId=U.ownerAddinSolutionId;Ta.OwnerAddinStoreType=U.ownerAddinStoreType;return Ta}static la(U){if(!U.$.da.Ba(232)){const Ta=new ma(U);U.$.da.Ja(232,Ta)}}}Object(c.a)(ma,
"DialogMessageReceivedEventManager",null,[753]);class Ka{constructor(U,Ta){this.$B=null;this.Hha=U;this.ZOg=Ta}D4b(U){U&&(this.$B||(this.$B=[]),this.$B.push(U))}Zzc(U){this.$B&&Array.remove(this.$B,U)}get eventId(){return this.Hha}get targetId(){return this.ZOg}get Fni(){return 0<this.$B.length}fUi(U){return this.eventId!==U.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===U.ddaBinding.Name:
!0}K7b(U){this.$B&&Array.forEach(this.$B,Ta=>{Ta(U)})}zpa(){this.$B=[]}}Object(c.a)(Ka,"DdaEventRegistration",null,[]);class cb{constructor(U){this.fG=null;this.Rya=!1;this.Dd=()=>{this.fG.forEach(Ta=>{Ta.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ta.K7b(new ub.a(Ta.eventId,"",null))})};this.Gh=U}invokeDdaMethod(U,Ta){const wb={};wb[yb.a.Bg]=U;wb[yb.a.L5]=Ta;this.Gh.BL(974713501,wb)}registerDdaEventAsync(U,Ta,wb,Qb,sc){cb.OEb(U)?(cb.ewd(U)&&this.ysd(),this.fG||(this.fG=[]),
Ta=this.ezb(U,wb),Ta||(Ta=new Ka(U,wb),this.fG.push(Ta)),Ta.D4b(Qb),this.Gh.Gw(sc)):this.Gh.kg(-1,sc)}unregisterDdaEventAsync(U,Ta,wb,Qb,sc){cb.OEb(U)?((U=this.ezb(U,wb))&&U.Zzc(Qb),this.Gh.Gw(sc)):this.Gh.kg(-1,sc)}ysd(){this.Rya||(Ea.h(this.Gh.$).ga.EK(this.Dd),this.Rya=!0)}ezb(U,Ta){if(!this.fG)return null;for(let wb=0;wb<this.fG.length;wb++){const Qb=this.fG[wb];if(Qb.eventId===U&&Qb.targetId===Ta)return Qb}return null}static OEb(U){return U===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static ewd(U){return U===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(cb,"EmbeddingPage",null,[695]);var Fa=a(192);class wa extends ub.a{constructor(U,Ta,wb,Qb,sc,Vc,Ld,le){super(U,Ta,wb);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Vc-Qb.Reference.FirstColumn;this.columnCount=le;U=Math.max(sc,Qb.Reference.FirstRow);sc=Math.min(sc+Ld-1,Qb.Reference.LastRow);U>sc?this.startRow=this.rowCount=void 0:(this.startRow=U-Qb.Reference.FirstRow,this.rowCount=sc-U+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(wa,"DdaBindingSelectionEventArgs",ub.a,[]);var ka=a(208),Oa=a(25),hb=a(47),Pa=a(52),ca=a(426),ba=a(30),ib=a(40),Lb=a(575),gc=a(129),Gc=a(54),Kb=a(91),pb=a(13),nc=a(12),Wb=a(109);class Ha{}Ha.MKh="ewa-wx-disabled-div";Ha.LKh="ewa-wx-container-div";Ha.NZe="ewa-ptp-nov2-flex";Object(c.a)(Ha,"CssClassNames",null,[]);var $a=a(71),Nb=a(100),rb=a(149),ec=a(36);const pc=Ha.MKh,vb=Ha.LKh;class ob extends Fa.a{constructor(U,Ta,wb,Qb=!1){super();this.Vgb=0;this.fG=null;this.Rya=!1;this.Oxc=null;
this.NV=0;this.Rac=this.NYa=this.ude=this.Vae=null;this.aTc=this.Pie=!1;this.mWc=this.cga=this.Y8d=null;this.Dd=()=>{this.enabled&&(this.eKj(),this.Oxc=hb.d(Ea.h(this.$).ga.pa.selectedRanges))};this.fhf=sc=>{sc.controlId===this.Xd.InstanceId&&Array.forEach(this.fG,Vc=>{Vc.fUi(sc)&&Vc.K7b(sc)})};this.ZHf=sc=>{if((sc=Object(jb.a)(457,sc))&&!sc.Mu())if(!this.Xd||OSF.OsfControl.isFirstPartyStoreString(this.Xd.PrimaryMarketplace.MarketplaceType)||this.$.cV){sc.Nf=this.Xd;sc.mk=this.Gh;this.Y8d=sc;this.IDc(sc.pJa);
const Vc=na.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&ba.a.Sd()&&nc.HelperMethods.Mx(this.Xd)&&this.Xd.Preload&&!this.Xd.TaskpaneVisible;Vc?sc.IJd():na.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(sc.IJd(),(this.Xd.SharedRuntime&&1===this.Xd.SharedRuntime.LifeTime||this.Xd.SharedRuntimeId)&&!this.Xd.TaskpaneVisible&&sc.Dh(!1)):((this.Xd.SharedRuntime&&1===this.Xd.SharedRuntime.LifeTime||this.Xd.SharedRuntimeId)&&
!this.Xd.TaskpaneVisible&&sc.Dh(!1),sc.IJd());this.A9a||(ba.a.Sd()?Vc||sc.T8():ca.a(this.$).result.JJ(sc,!0));this.$.da.Ba(77).X3f(this.ZHf);this.Aba=Object(jb.a)(273,sc)}else f.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(sc,Vc)=>{3===Vc.control.floatingObject.type&&Vc.control.floatingObject.Ol.InstanceId===this.g3.WebExtensionId&&(this.Aba=Object(jb.a)(273,Vc.control),this.IDc(Vc.control.qe.firstChild),Wb.a(this.$).Szc(this.onFloatingObjectControlAdded))};
this.Jb=U.$;this.Gh=U;this.Xd=wb;this.Xd.InstanceId=wb.SrcLocationOverrideResourceId?U.jNa(wb.InstanceId,wb.SrcLocationOverrideResourceId):wb.InstanceId;this.Hh=Ta;this.g3={};this.g3.WebExtensionId=wb.InstanceId;this.$Tf="osfControl_"+wb.InstanceId;this.Fdd="disabled_"+wb.InstanceId;this.g3.BindingData=wb.BindingData;this.A9a=this.Gh.A9a(wb.InstanceId);this.emc=this.Gh.emc(wb.InstanceId);this.pne=wb.WebExtensionOsfControlType;this.zXf=Qb}get controlId(){return this.Xd.InstanceId}get mDi(){return this.aTc}Nui(U){this.cga||
(this.cga=U)}I3f(){this.cga&&(this.cga.dispose(),this.cga=null)}get controlType(){return this.Xd.WebExtensionType}get ownerAddinSolutionId(){return this.Xd.OwnerAddinSolutionId}get $(){return this.Jb}get enabled(){return!this.NV}get visible(){return this.Xd.TaskpaneVisible}get Ez(){return this.mWc}get qR(){return this.Xd.SrcLocationOverrideResourceId?this.Gh.jNa(this.Xd.PrimaryMarketplace.SolutionId,this.Xd.SrcLocationOverrideResourceId):this.Xd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Xd.SrcLocationOverrideResourceId}get Ol(){return this.Xd}get Aba(){return this.Vae}set Aba(U){this.Vae=
U}get osfControlType(){return this.pne}get nwa(){return this.ude}set nwa(U){this.ude=U}get Qac(){return this.NYa}set Qac(U){this.NYa=U}get focusOnIframeWhenLoaded(){return this.Xd.FocusOnIframeWhenLoaded}get eoc(){return this.Pie}set eoc(U){this.Pie=U}Std(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Xd.PrimaryMarketplace.MarketplaceType)&&na.EwaSettings.ya(174)){const Ta=Object($a.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Nb.d)(rb.a.resolve(ec.h,{Wa:0})):Pa.GetServiceTaskFactory.Za(this.$.da,
5,4,0);ib.TaskExtensions.za(Ta,()=>{Ta.result.zh(36,null)},this.ka,3);return this}if(1===this.Xd.WebExtensionType)ib.TaskExtensions.za(ca.a(this.$),Ta=>{Ta.result.qwb(this.$.da,77,5,this.ZHf,1)},this.ka,3);else{var U=this.M3e();const Ta=Wb.a(this.$);U||(U={Type:3},U.Id=this.g3.WebExtensionId,U.WebExtensionData=this.Xd,U.ContentHtml="<div/>",U.Version=0,U.AbsoluteLeft=0,U.AbsoluteTop=0,U.AbsoluteRight=0,U.AbsoluteBottom=0,U.Width=0,U.Height=0,U.ZOrder=0,U.OriginDeltaX=0,U.OriginDeltaY=0,U=new ka.a(U),
Ta.E$b(U,null),U=Ta.Es(U.Jh()));U?(this.IDc(U.qe.firstChild),this.Aba=Object(jb.a)(273,U)):Ta.v4b(this.onFloatingObjectControlAdded)}return this}hmf(U){this.IDc(U);return this}juc(){this.zXf||this.Gh.Lf.purgeOsfControl(this.controlId,!1);this.urg(!0);const U=this.M3e();U&&Wb.a(this.$).deleteFloatingObject(U);this.Gh.Vh.bwj(this.controlId);this.Gh.Vh.TWe(this.controlId,!0);this.mWc=null}UJd(U){this.g3=U}invokeDdaMethod(U,Ta){if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled){var wb={};wb[yb.a.Bg]=U;wb[yb.a.L5]=Ta;this.Gh.BL(974713501,wb)}else this.Gh.kg(Jb.a.$Db,Ta)}ltj(U,Ta,wb,Qb){if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!ob.Qzh(U)||void 0!==Ta&&null!==Ta&&void 0!==this.z6a(Ta)&&null!==this.z6a(Ta))if(f.ULS.sendTraceTag(36444195,0,50,`eventId: ${U}, targetId: ${Ta}`),ob.Npf(U)&&this.Gpi(),ob.ewd(U)&&this.ysd(),ob.Lpf(U))na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Qb):(this.aTc=!0,this.Gh.$.da.Ba(232).addHandler(this.controlId,wb,Qb,Ta));else if(ob.Mpf(U))na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qb):(this.aTc=!0,this.Gh.$.da.Ba(232).zTg(this.controlId,wb,Qb));else{ob.Kpf(U)&&this.hhf(-1777565636,Qb);this.fG||(this.fG=[]);var sc=this.ezb(U,Ta);sc||(sc=new Ka(U,Ta),this.fG.push(sc));sc.zpa();sc.D4b(wb);this.Gh.Gw(Qb);U===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.NYa&&(this.Rac=wb)}else this.Gh.kg(3002,
Qb);else this.Gh.kg(-1,Qb)}Gbk(U,Ta,wb,Qb){ob.Lpf(U)?na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qb):this.Gh.$.da.Ba(232).removeHandler(this.controlId,Qb):ob.Mpf(U)?na.EwaSettings.ya(23)?this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qb):this.Gh.$.da.Ba(232).uwj(this.controlId,Qb):(ob.Kpf(U)&&this.hhf(1592314317,Qb),Ta=this.ezb(U,Ta),this.enabled?(Ta&&(Ta.Zzc(wb),Ta.Fni||Array.remove(this.fG,Ta),this.fG.length?ob.Npf(U)&&
this.vrg(!1):this.urg(!1)),this.Gh.Gw(Qb)):this.Gh.kg(-1,Qb))}la(U){pb.DOMElementExtensions.getElementById(U,this.$Tf)||U.appendChild(pb.DOMElementExtensions.gg(this.Ez))}showHide(U){pb.DOMElementExtensions.setVisible(this.Ez,U)}resize(U,Ta){pb.DOMElementExtensions.hx(this.Ez,U);pb.DOMElementExtensions.eK(this.Ez,Ta)}HTe(U){if(!this.NV&&!pb.DOMElementExtensions.getElementById(this.Ez,this.Fdd)&&this.Ez){const Ta=document.createElement("div");Ta.id=this.Fdd;Ta.className=pc;Ta.style.backgroundImage=
"url("+Gc.a.current.Lo(104)+")";Ta.style.opacity=U?"1":"0";Ta.style.backgroundRepeat="no-repeat";Ta.style.backgroundPosition="center";this.Ez.insertBefore(Ta,this.Ez.firstChild)}this.NV++}GCh(){0<this.NV&&this.NV--;this.NV||(pb.DOMElementExtensions.gg(pb.DOMElementExtensions.getElementById(this.Ez,this.Fdd)),this.Rya&&!hb.R(this.Oxc,Ea.h(this.$).ga.pa.selectedRanges)&&this.Dd(null,null))}z6a(U){if(!this.g3||!this.g3.BindingData)return null;for(let Ta=0;Ta<this.g3.BindingData.length;Ta++)if(this.g3.BindingData[Ta].Name===
U)return this.g3.BindingData[Ta];return null}getDefaultIconUrl(){const U=this.rcf();return U?U.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Xd.TaskpaneTitle)return this.Xd.TaskpaneTitle;const U=this.rcf();return U?U.getDefaultDisplayName():null}BYf(){if(this.NYa&&this.Rac){const U=new ub.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.NYa);this.Rac(U);this.Rac=this.NYa=null}}Dh(U){this.Y8d&&this.Y8d.Dh(U)}hMj(){this.$.ea.isNamedObjectViewMode&&this.zFi()&&(this.$.da.Ba(34).gMj(this.Ez),
this.showHide(!1));if(this.Gh.Pkk){if(!this.zXf){const U={};U.div=this.Ez;U.id=this.Xd.InstanceId;U.solutionId=this.Xd.PrimaryMarketplace.SolutionId;U.version=this.Xd.PrimaryMarketplace.SolutionVersion;U.storeId=this.Xd.PrimaryMarketplace.MarketplaceRef;U.storeType=this.Xd.PrimaryMarketplace.MarketplaceType;U.ownerAddinSolutionId=this.Xd.OwnerAddinSolutionId;U.ownerAddinStoreType=this.Xd.OwnerAddinStoreType;this.Xd.AssetMarketplace?(U.assetId=this.Xd.AssetMarketplace.SolutionId,U.assetStoreId=this.Xd.AssetMarketplace.MarketplaceRef):
(U.assetId=null,U.assetStoreId=null);U.settings=this.Xd.OsfPropertyBag;U.hostSettings=this.Xd.HostPropertyBag;na.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?U.reason=this.A9a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.emc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:U.reason=this.A9a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;U.osfControlType=0===this.Xd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;U.isForUILessAction=4===this.Xd.WebExtensionOsfControlType;U.sourceLocationOverrideResourceId=this.Xd.SrcLocationOverrideResourceId;U.focusOnIframeWhenLoaded=this.Xd.FocusOnIframeWhenLoaded;Lb.a(this.Xd)&&(U.featureGates=w.AFrameworkApplication.fa.A$e(U.solutionId));U.hostInfoFlags=0;this.nwa&&(U.hostInfoFlags|=2);nc.HelperMethods.Mx(this.Xd)&&
(U.hostInfoFlags|=1);this.$.cV||(f.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),U.hostInfoFlags|=4);na.EwaSettings.ya(553)&&(U.hostInfoFlags|=8);U.sharedRuntimeId=this.Xd.SharedRuntime?this.Xd.SharedRuntime.Resid:this.Xd.SharedRuntimeId;!nc.HelperMethods.Mx(this.Xd)||this.Xd.Preload||Lb.a(this.Xd)||this.Gh.Lf.getOsfControl(a(765).DdaFacade.getSolutionId(this.Xd,this.$))||(na.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&
this.Gh.LSf(this.Xd):this.Gh.LSf(this.Xd));U.onExtensionLaunchCallback=this.Xd.OnExtensionLaunchCallback;U.initialDisplayMode=this.Xd.TaskpaneVisible?2:1;na.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(U.titleOverride=this.Ol.TaskpaneTitle);this.Gh.Lf.insertOsfControl(U)}this.NV=0}else this.HTe(!0)}urg(U){this.vrg(U);this.obk()}Gpi(){this.Vgb||this.Hh.D4b(this.fhf);this.Vgb++}vrg(U){0<this.Vgb&&(U?this.Vgb=0:this.Vgb--,this.Vgb||this.Hh.Zzc(this.fhf))}ysd(){if(!this.Rya){const U=
Ea.h(this.$).ga;this.Oxc=hb.d(Ea.h(this.$).ga.pa.selectedRanges);U.EK(this.Dd);this.Rya=!0}}obk(){this.Rya&&(Ea.h(this.$).ga.sP(this.Dd),this.Rya=!1)}XIj(U){var Ta=new Oa.Range(U.Reference.FirstRow+1,U.Reference.FirstColumn+1,U.Reference.LastRow+1,U.Reference.LastColumn+1,!1,!1);1===U.BindingType&&(U.HasHeaders&&--Ta.top,U.HasTotals&&(Ta.bottom+=1));var wb=Ea.h(this.$).ga.pa.selectedRanges;U=Ta.u9a(this.Oxc);wb=Ta.u9a(wb);return(Ta=Ta.Ue(Ea.h(this.$).ga.pa.activeRange))&&(gc.e(U)&&!gc.e(wb)||!gc.e(U)&&
!gc.e(wb)&&!hb.R(U,wb))?Ta:null}eKj(){Array.forEach(this.fG,U=>{if(U.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&U.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Gh.Vh.U5b(this.controlId))if(U.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)U.K7b(new ub.a(U.eventId,this.controlId,null));else if(U.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Ta=this.z6a(U.targetId);if((null===Ta||void 0===Ta?0:Ta.IsValidRef)&&
(this.$.ea.isNamedObjectViewMode?this.$.Zb.na.sheetName:this.$.ua.na.name)===Ta.Reference.SheetName){const wb=this.XIj(Ta);wb&&U.K7b(new wa(U.eventId,this.controlId,this.Gh.J6b(Ta),Ta,wb.top-1,wb.left-1,wb.height,wb.width))}}})}ezb(U,Ta){if(!this.fG)return null;for(let wb=0;wb<this.fG.length;wb++){const Qb=this.fG[wb];if(Qb.eventId===U&&Qb.targetId===Ta)return Qb}return null}M3e(){const U=Wb.a(this.$).hW;for(let Ta=U.length-1;0<=Ta;--Ta){const wb=U[Ta];if(3===wb.floatingObject.type&&wb.floatingObject.Ol.InstanceId===
this.g3.WebExtensionId)return wb}return null}zFi(){for(let U=0;U<this.$.Zb.count;U++)if(this.$.Zb.getItem(U).imageId===this.g3.WebExtensionId)return!0;return!1}IDc(U){this.mWc=U;this.Ez.id=this.$Tf;this.Ez.className=vb;this.Ez.dir=this.$.isChromeRtl?"rtl":"ltr";this.hMj()}rcf(){if(!this.enabled)return null;const U=Lb.a(this.Ol)?"":this.Ol.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Ol.PrimaryMarketplace.SolutionId,U)}hhf(U,Ta){if(na.EwaSettings.ya(23))this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Ta);else try{if(f.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.pne)this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Ta);else{const wb={};wb[aa.a.tsb]=this.controlId;const Qb=new Kb.a(U,0,this.$.isEditMode?2:1,0,null);this.$.Ia.$b(Qb,wb);this.Gh.Gw(Ta)}}catch(wb){f.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${wb.message}.`),this.Gh.kg(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Ta)}}static Qzh(U){return U===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||U===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Npf(U){return U===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||U===OSF.DDA.EventDispId.dispidSettingsChangedEvent||U===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static ewd(U){return U===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||U===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Lpf(U){return U===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Mpf(U){return U===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Kpf(U){return U===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(ob,"OsfControl",Fa.a,[752]);class Tb{constructor(){this.B1a={}}add(U){this.B1a[U]=!0}remove(U){delete this.B1a[U]}clear(){for(const U of Object.keys(this.B1a))delete this.B1a[U]}xif(){return 0<Object.keys(this.B1a).length}TZh(){return Object.keys(this.B1a)}}Object(c.a)(Tb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);
var Rd=a(61);class Jd{constructor(U,Ta,wb){this.B2f=this.A2f=0;this.GRb=this.teb=null;this.C1i=()=>{var Qb=Ea.h(this.$).ga.Sa.YB;if(this.Ovd(Qb)&&(Qb=this.wAb(Qb))){var sc={};sc.chartId=Qb;sc.worksheetId=this.ama();sc=Rd.a.Zc(sc);this.sla(51,Qb,sc);this.sla(51,this.ama(),sc)}};this.D1i=()=>{if(this.teb){var Qb={};Qb.chartId=this.teb;Qb.worksheetId=this.GRb;Qb=Rd.a.Zc(Qb);this.sla(52,this.teb,Qb);this.sla(52,this.GRb,Qb)}Qb=Ea.h(this.$).ga.Sa.YB;this.Ovd(Qb)?(this.teb=this.wAb(Qb),this.GRb=this.ama()):
this.GRb=this.teb=null};this.$=U;this.Vh=Ta;this.Hh=wb}utb(U){51===U.messageType?this.A2f=this.EJa(U.actionType,this.A2f,this.C1i):52===U.messageType&&(this.B2f=this.EJa(U.actionType,this.B2f,this.D1i))}EJa(U,Ta,wb){if(1===U)Ta||Ea.h(this.$).ga.Sa.k2c(wb),Ta++,this.gQj();else if(2===U){if(1>Ta)return Ta;1===Ta&&Ea.h(this.$).ga.Sa.iSd(wb);Ta--}return Ta}sla(U,Ta,wb){Ta&&this.Vh.HL(U,Ta)&&this.Hh.pG(U,Ta,wb)}wAb(U){return U&&U.floatingObject?(U=U.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===U.length?U[0]:null:null}ama(){const U=this.$.ua.na;return U&&0===U.lH?U.sheetId:null}gQj(){const U=Ea.h(this.$).ga.Sa.YB;this.Ovd(U)&&(this.teb=this.wAb(U),this.GRb=this.ama())}Ovd(U){return!!U&&!!U.floatingObject&&0===U.floatingObject.type}}Object(c.a)(Jd,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var ld=a(761),Yd=a(196),Ke=a(629),Bb=a(107),Ob=a(358),ed=a(62);class Sd extends qb.a{constructor(U,Ta,wb){super();this.NV=this.ICa=0;this.Dd=(Qb,sc)=>{if(this.enabled&&!(this.Mrf()||null!==
sc&&void 0!==sc&&sc.gvf)&&(Qb=Object(jb.a)(Bb.a,this.$.ua.na))&&0===Qb.lH){const Vc=Qb.sheetId,Ld=this.y9e();let le=null,Ce=null;this.Vh.Vuf()&&(le=this.grid.Mb.ph(this.grid.ga.pa.activeCell),Ce=Vc in this.bqc?this.bqc[Vc]:null);this.qCe(Vc,Ld)&&ib.TaskExtensions.za(ed.Task.Ua(!0),()=>{this.cni(Vc,Ld);this.Nmi(Vc,Ld,le,Ce)},this.ka);this.JUe(Vc,Ld,le)}};this.$=U;this.Vh=Ta;this.Hh=wb;this.grid=Ea.h(U);this.MQa={};this.bqc={}}get enabled(){return!this.NV&&0<this.ICa}r6b(U){Object(jb.a)(Ob.a,this.$.ua);
1===U.actionType?(this.ICa||this.grid.ga.EK(this.Dd),this.ICa++):2!==U.actionType||1>this.ICa||(1===this.ICa&&this.grid.ga.sP(this.Dd),this.ICa--)}rDc(U){U?this.NV++:(0<this.NV&&this.NV--,this.NV||this.Dd(null,new Ke.a(!1)))}y9e(){return this.grid.ga.pa.selectedRanges}qCe(U,Ta){return na.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!U&&Yd.e(this.MQa)||U in this.MQa)&&!hb.R(this.MQa[U],Ta):U in this.MQa&&!hb.R(this.MQa[U],Ta)}JUe(U,Ta,wb){this.MQa[U]=
hb.d(Ta);this.bqc[U]=wb}Mrf(){return this.grid.Eb||this.grid.Wi}k4e(U,Ta){this.Vh.HL(14,U)&&this.Hh.pG(14,U,Ta);this.Vh.HL(14,ld.a.pM)&&this.Hh.pG(14,ld.a.pM,Ta)}cni(U,Ta){const wb={};wb.worksheetId=U;wb.address=this.Jod(Ta);Ta=Rd.a.Zc(wb);this.k4e(U,Ta)}Nmi(U,Ta,wb,Qb){if(this.Vh.Vuf()){var sc="";let Vc="";Qb&&(sc=Qb.Tj);wb&&(Vc=wb.Tj);Qb?wb?(Ta=wb.usedRange.u9a(Ta),sc!==Vc&&this.pfc(sc,"",U),this.pfc(Vc,this.Jod(Ta),U)):this.pfc(sc,"",U):wb&&(sc=wb.usedRange.u9a(Ta),this.pfc(Vc,this.Jod(sc),U))}}pfc(U,
Ta,wb){if(this.Vh.HL(100,U)){const Qb={};Qb.address=Ta;Qb.worksheetId=wb;this.Hh.pG(100,U,Rd.a.Zc(Qb))}}Jod(U){return hb.i(U,",",this.$,!1)}dispose(){0<this.ICa&&this.grid.ga.sP(this.Dd);this.bqc=this.MQa=null;this.ICa=0;this.Hh=this.Vh=this.$=this.grid=null}}Object(c.a)(Sd,"RichApiEventSelectionChangedHandler",qb.a,[]);var Pd=a(354);class ic extends Sd{constructor(U,Ta,wb){super(U,Ta,wb);this.gxf=this.hxf=null}y9e(){return Pd.a.cac(this.grid.ga.rangePicker.fP)}qCe(U,Ta){return this.hxf!==U||!hb.R(this.gxf,
Ta)}JUe(U,Ta){this.hxf=U;this.gxf=hb.d(Ta)}Mrf(){return!this.grid.Eb&&!this.grid.Wi}k4e(U,Ta){this.Vh.HL(2700,ld.a.pM)&&this.Hh.pG(2700,ld.a.pM,Ta)}}Object(c.a)(ic,"RichApiEventPickedRangesChangedHandler",Sd,[]);class Kc{constructor(U,Ta,wb){this.MTa=this.LTa=0;this.eKa=this.Mja=null;this.DLf=()=>{var Qb=Ea.h(this.$).ga.Sa.YB;if(0<this.MTa&&this.Mja&&this.eKa){var sc={};sc.shapeId=this.Mja;sc.worksheetId=this.eKa;sc=Rd.a.Zc(sc);this.fireEvent(2102,this.Mja,sc)}this.wHi(Qb)?(this.Mja=this.R$j(Qb),
this.eKa=this.ama(),this.Mja&&this.eKa)?0<this.LTa&&(Qb={},Qb.shapeId=this.Mja,Qb.worksheetId=this.eKa,Qb=Rd.a.Zc(Qb),this.fireEvent(2101,this.Mja,Qb)):f.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Mja}', or worksheet id: '${this.eKa}' from a Floating object or gridview.`):this.eKa=this.Mja=null};this.$=U;this.Vh=Ta;this.Hh=wb}utb(U){const Ta=Ea.h(this.$).ga;1===U.actionType?(this.LTa||this.MTa||Ta.Sa.k2c(this.DLf),2101===U.messageType?this.LTa++:2102===
U.messageType&&this.MTa++):2===U.actionType&&(2101===U.messageType?this.LTa=0<this.LTa?this.LTa-1:0:2102===U.messageType&&(this.MTa=0<this.MTa?this.MTa-1:0),this.LTa||this.MTa||Ta.Sa.iSd(this.DLf))}wHi(U){return!!U&&!!U.floatingObject&&(0===U.floatingObject.type||7===U.floatingObject.type||1===U.floatingObject.type||3===U.floatingObject.type||5===U.floatingObject.type)}R$j(U){if(!U||!U.floatingObject)return null;U=U.floatingObject.id;var Ta=U.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));
Ta=Ta&&1===Ta.length?Ta[0]:null;return Ta?Ta:(f.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${U}', but we failed.`),null)}ama(){const U=this.$.ua.na;return U&&0===U.lH?U.sheetId:null}fireEvent(U,Ta,wb){Ta&&this.Vh.HL(U,Ta)&&this.Hh.pG(U,Ta,wb)}}Object(c.a)(Kc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class dc{constructor(U,Ta,wb){this.F2f=this.E2f=this.G2f=this.D2f=0;this.bej=(Qb,sc)=>{Qb=Object(jb.a)(Bb.a,sc.na);this.yab(Qb)&&(sc=
{},sc.worksheetId=Qb.sheetId,sc=Rd.a.Zc(sc),this.sla(11,Qb.sheetId,sc))};this.eej=(Qb,sc)=>{Qb=Object(jb.a)(Bb.a,sc.PC);this.yab(Qb)&&(sc={},sc.worksheetId=Qb.sheetId,sc=Rd.a.Zc(sc),this.sla(12,Qb.sheetId,sc))};this.cej=(Qb,sc)=>{Qb=Object(jb.a)(Bb.a,sc.na);this.yab(Qb)&&(sc={},sc.worksheetId=Qb.sheetId,Qb=Rd.a.Zc(sc),this.sla(11,null,Qb,!0))};this.dej=(Qb,sc)=>{Qb=Object(jb.a)(Bb.a,sc.PC);this.yab(Qb)&&(sc={},sc.worksheetId=Qb.sheetId,Qb=Rd.a.Zc(sc),this.sla(12,null,Qb,!0))};this.$=U;this.Vh=Ta;
this.Hh=wb}utb(U){11===U.messageType?U.targetId===ld.a.pM?this.p3g(U.actionType):this.o3g(U.actionType):12===U.messageType&&(U.targetId===ld.a.pM?this.q3g(U.actionType):this.r3g(U.actionType))}o3g(U){this.D2f=this.EJa(U,this.D2f,this.bej)}r3g(U){this.G2f=this.EJa(U,this.G2f,this.eej)}p3g(U){this.E2f=this.EJa(U,this.E2f,this.cej)}q3g(U){this.F2f=this.EJa(U,this.F2f,this.dej)}EJa(U,Ta,wb){1===U?Ta=this.DJa(Ta,wb):2===U&&(Ta=this.ELa(Ta,wb));return Ta}DJa(U,Ta){U||this.$.ua.Lg(Ta);U++;return U}ELa(U,
Ta){if(1>U)return U;1===U&&this.$.ua.ih(Ta);U--;return U}yab(U){return!!U&&0===U.lH}sla(U,Ta,wb,Qb=!1){Ta=Qb?ld.a.pM:Ta;this.Vh.HL(U,Ta)&&this.Hh.pG(U,Ta,wb)}}Object(c.a)(dc,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Hc=a(248),Uc=a(14),Fd=a(231);class Td extends Sys.EventArgs{constructor(U,Ta,wb,Qb){super();this.sheet=U;this.Mbh=Ta;this.offsetX=wb;this.offsetY=Qb}}Object(c.a)(Td,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class ad{constructor(U,Ta,wb){this.$8b=null;this.Tzd=!1;
this.onPointerDown=Qb=>{let sc;3===Qb.Wb?({H3a:sc}=this.gridView.Hgc(Qb.clientPoint),this.Tzd=!!sc&&this.gridView.ga.pa.PUe(sc)):this.Tzd=!1;this.$8b=Qb.clientPoint;return!1};this.Gd=Qb=>{if(this.gridView.inRangePicker||this.gridView.Wi||this.Tzd||Qb.shiftKey||Qb.ctrlKey||Qb.Da.button!==Sys.UI.MouseButton.leftButton||!this.$8b||!Qb.clientPoint||Qb.clientPoint.x!==this.$8b.x||Qb.clientPoint.y!==this.$8b.y)return!1;const sc=({H3a:Qb}=this.gridView.Hgc(Qb.clientPoint)).returnValue,Vc=Object(jb.a)(Bb.a,
this.$.ua.na);if(sc&&Vc&&0===Vc.lH){if(!this.gridView.ga.pa.u6.contains(Qb))return!1;Qb=new Td(Vc,Qb,nc.HelperMethods.JMd(sc.x),nc.HelperMethods.JMd(sc.y));this.fej(Qb)}return!1};this.$=U;this.gridView=Ea.h(U);this.Vh=Ta;this.Hh=wb;this.Quj()}dispose(){this.eck()}Quj(){for(const U of this.gridView.wo){const Ta=U.domElement;Hc.a.instance.ta(Uc.a.pointerDown,Ta,this.onPointerDown);Fd.a.instance.ta(Uc.a.click,Ta,this.Gd)}}eck(){for(const U of this.gridView.wo){const Ta=U.domElement;Hc.a.instance.Aa(Uc.a.pointerDown,
Ta,this.onPointerDown);Fd.a.instance.Aa(Uc.a.click,Ta,this.Gd)}}fej(U){var Ta=U.sheet;if(this.yab(Ta)){var wb={};wb.worksheetId=Ta.sheetId;wb.address=U.Mbh.toString();wb.offsetX=U.offsetX;wb.offsetY=U.offsetY;U=Ta.sheetId;this.Vh.HL(21,U)&&(Ta=Rd.a.Zc(wb),this.Hh.pG(21,U,Ta));U=ld.a.pM;this.Vh.HL(21,U)&&(wb=Rd.a.Zc(wb),this.Hh.pG(21,U,wb))}}yab(U){return!!U&&0===U.lH}}Object(c.a)(ad,"RichApiEventSingleClickedHandler",null,[]);class Qd{constructor(U,Ta,wb){this.WNb=0;this.heb=this.qeb=null;this.YSf=
()=>{const Qb=Ea.h(this.$).ga.Sa.YB;if(Qb)if(this.Kvf(Qb)){const sc=this.ama();this.Yid(sc);this.qeb=Qb.floatingObject.id;this.heb=sc}else this.qeb&&(this.Yid(this.heb),this.heb=this.qeb=null);else this.qeb&&(this.Yid(this.heb),this.heb=this.qeb=null)};this.$=U;this.Vh=Ta;this.Hh=wb}r6b(U){2E3===U.messageType&&(1===U.actionType?(this.WNb||Ea.h(this.$).ga.Sa.k2c(this.YSf),this.WNb++,this.oMj()):2===U.actionType&&this.WNb&&(1===this.WNb&&Ea.h(this.$).ga.Sa.iSd(this.YSf),this.WNb--))}Yid(U){var Ta;const wb=
{};wb.worksheetId=U;wb.revisionLoad=!1;if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(na.EwaSettings.ya(616)||na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Qb=Ea.h(this.$).ga.Sa.YB;(null===(Ta=null===Qb||void 0===Qb?void 0:Qb.floatingObject)||void 0===Ta?0:Ta.Kd)?wb.selectedVisualId=Qb.floatingObject.Kd.VisualID:wb.selectedVisualId=null}Ta=Rd.a.Zc(wb);U&&this.Vh.HL(2E3,U)&&
this.Hh.pG(2E3,U,Ta)}ama(){const U=this.$.ua.na;return U&&0===U.lH?U.sheetId:null}oMj(){const U=Ea.h(this.$).ga.Sa.YB;this.Kvf(U)&&(this.qeb=U.floatingObject.id,this.heb=this.ama())}Kvf(U){return!!U&&U.qAd()}}Object(c.a)(Qd,"RichApiEventVisualSelectionChangedHandler",null,[]);class Zb{constructor(U,Ta,wb){this.XNb=0;this.Cxg=!0;this.Efc=0;this.Lyd=!0;this.bJe=()=>{const Qb=document.hasFocus();if(this.Cxg!==Qb){if(Qb){const sc=Rd.a.Zc({});this.Hh.pG(2203,ld.a.pM,sc)}this.Cxg=Qb}};this.cJe=Qb=>{(0<
Qb.timeRemaining()||Qb.didTimeout)&&this.bJe();window.requestIdleCallback(this.cJe)};this.$=U;this.Vh=Ta;this.Hh=wb;window.requestIdleCallback||(this.Lyd=!1)}n3g(U){1===U.actionType?(this.XNb||this.F3g(),this.XNb++):2!==U.actionType||1>this.XNb||(1===this.XNb&&this.zwh(),this.XNb--)}F3g(){if(this.Vh.HL(2203,ld.a.pM))if(this.Lyd){const U={};U.timeout=this.$.xa.CheckFocusTimeout;this.Efc=window.requestIdleCallback(this.cJe,U)}else this.Efc=window.setInterval(this.bJe,this.$.xa.CheckFocusTimeInterval)}zwh(){this.Lyd?
window.cancelIdleCallback(this.Efc):window.clearInterval(this.Efc)}}Object(c.a)(Zb,"RichApiEventWorkbookActivatedHandler",null,[]);var Wc;(function(U){U[U.none=0]="none";U[U.registerEvent=1]="registerEvent";U[U.unregisterEvent=2]="unregisterEvent";U[U.customFunction=3]="customFunction";U[U.showCard=4]="showCard";U[U.createWorkbook=5]="createWorkbook";U[U.openWorkbook=6]="openWorkbook";U[U.enableEvents=7]="enableEvents";U[U.closeWorkbook=8]="closeWorkbook";U[U.setCalculationMode=9]="setCalculationMode";
U[U.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";U[U.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";U[U.workbookLinksEnableContent=12]="workbookLinksEnableContent";U[U.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";U[U.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";U[U.rangePicker=15]="rangePicker";U[U.enableRichApiRecording=16]="enableRichApiRecording";U[U.recordAction=17]="recordAction";U[U.focus=18]="focus";U[U.businessBarShow=19]="businessBarShow";
U[U.businessBarHide=20]="businessBarHide";U[U.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";U[U.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";U[U.showRangeValuesPreview=23]="showRangeValuesPreview";U[U.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(Wc||(Wc={}));Object(c.b)("PostProcessActionType",Wc);var md=a(261);class Nd{constructor(U,Ta,wb){this.aUf=null;this.Wid=(Qb,sc)=>{const Vc=ld.a.pM,Ld={};Ld.eventId=Qb;Ld.payload=sc;this.Vh.HL(2201,
Vc)&&this.Hh.pG(2201,Vc,Rd.a.Zc(Ld))};this.$=U;this.Vh=Ta;this.Hh=wb;this.nui()}m3g(U){1===U.actionType?(this.$.Wda=!0,Object(jb.a)(a(765).DdaFacade,md.a(this.$)).Xid(!0)):2===U.actionType&&(this.$.Wda=!1);this.aUf=U.controlId;f.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${Wc[U.actionType]}; controlId: ${this.aUf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Wda}.`)}VDh(U){Object(jb.a)(a(765).DdaFacade,md.a(this.$)).n4e(U,this.$.Wda)}nui(){this.$.WW&&
ib.TaskExtensions.za(Pa.GetServiceTaskFactory.Za(this.$.da,297,298,1),U=>{(U=U.result)&&U.init(this.Wid)},this.$.ka,3)}}Object(c.a)(Nd,"RichApiMacroRecorderEventHandler",null,[]);class kd{}Object(c.a)(kd,"StyleCacheItem",null,[]);class yd{constructor(U,Ta,wb){this.$=U;this.gridView=Ta;this.ag=wb}Aja(U){this.range=U;this.s9b=Array(U.width);this.uGc=Array.from({length:U.height},()=>Array(U.width))}YLj(U,Ta,wb,Qb){this.Utf(U,Ta)&&(this.uGc[U-this.range.top][Ta-this.range.left]||(this.uGc[U-this.range.top][Ta-
this.range.left]={backgroundColor:wb.backgroundColor}),wb.backgroundColor=Qb)}$Lj(U,Ta,wb){if(this.Utf(U,Ta)){U=Oa.Range.gd(U,Ta);var Qb=this.gridView.jc(U);Qb&&(this.s9b[Ta-this.range.left]||(this.s9b[Ta-this.range.left]=Qb.width),Ta=this.ag.j0d(this.gridView,[U],wb,!1),"Success"!==Ta.kind&&f.ULS.sendTraceTag(509223560,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${Ta.reason}`))}}restore(){this.range&&(this.s9b.forEach((U,Ta)=>{U=this.ag.j0d(this.gridView,[Oa.Range.gd(this.range.top,
this.range.left+Ta)],U,!1);"Success"!==U.kind&&f.ULS.sendTraceTag(509220497,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${U.reason}`)}),this.uGc.forEach((U,Ta)=>{U.forEach((wb,Qb)=>{Qb=Oa.Range.gd(this.range.top+Ta,this.range.left+Qb);if(Qb=this.gridView.jc(Qb))Qb.cell.backgroundColor=wb.backgroundColor})}),this.s9b=this.uGc=this.range=void 0)}Utf(U,Ta){if(!this.range)return f.ULS.sendTraceTag(509223559,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),
!1;(U=this.range.contains(Oa.Range.gd(U,Ta)))||f.ULS.sendTraceTag(509223558,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return U}}Object(c.a)(yd,"InstantaneousGridContentRestorer",null,[]);var lc=a(218),Lc=a(139);class nd{constructor(U,Ta,wb,Qb){this.Vbi=sc=>{const Vc=sc.Jd.block;if(this.Qu.Ue(Vc.af)){this.oWf([Vc.af]);const Ld=Ea.h(this.$).PY(Vc.af),le=()=>this.gWf([Vc.af]);setTimeout(()=>{Ld.skeletonMode?setTimeout(()=>{Ld.skeletonMode?f.ULS.sendTraceTag(509220498,
0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time"):le()},nd.bAg):le()},nd.QAg)}};this.kSa=(sc,Vc)=>{0===Vc.Pr&&576!==Vc.pg.operation.operationName&&this.bDb(!0)};this.qKd=sc=>{this.kFc&&(this.yTh(sc),this.h2())};this.$=U;this.Vh=Ta;this.Hh=wb;this.gridView=Ea.h(this.$);this.Llc=new yd(this.$,this.gridView,Qb)}Gmi(U,Ta,wb,Qb){this.htf(U)?(Ta=this.P$g(Ta,wb))?this.kTa?f.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):
(this.worksheetId=U,this.Qu=Ta,this.values=wb,this.Fqa(Qb)):f.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):f.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}Uki(U){this.htf(U)?this.bDb(!1):f.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}Fqa(U){this.oWf(this.Z7e());
U&&(f.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(U)}`),U.autoexpandTable&&this.T$g(),U.autofitColumns&&this.q$g());this.kFc=this.gridView.iP.Fqa(this.Qu,this.Vbi).then(Ta=>{f.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.kTa=Ta;this.Llc.Aja(this.Qu);this.gWf(this.Z7e());this.$.userOperationManager.ks(this.kSa);Ta.j8f.then(()=>this.qKd(!0),()=>this.qKd(!0));return Promise.resolve()},
Ta=>{f.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${Ta}`);this.h2();return Promise.resolve()})}bDb(U){this.kFc&&(f.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.kFc.then(()=>{const Ta=this.kTa;this.qKd(U);Ta&&Ta.Qma("RichApiRangeValuesPreview")},()=>{f.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}P$g(U,
Ta){U=hb.ab(U,this.$.ua);if(U.returnValue)return new Oa.Range(U.range.top,U.range.left,U.range.top+Ta.length-1,U.range.left+Ta[0].length-1,!0,!0)}htf(U){const Ta=this.$.ua.na;return Ta&&U===Ta.sheetId}oWf(U){this.Mjd(U,(Ta,wb,Qb,sc)=>{sc.cell.peb=this.values[Ta][wb];return!0})}gWf(U){this.Hqa&&this.Mjd(U,(Ta,wb,Qb,sc)=>{this.Llc.YLj(Qb.top,Qb.left,sc,this.A5h(Qb.top));return!0});if(this.t2a){const Ta=this.Qu.u9a(U);0<Ta.length&&this.t2a&&this.t2a.forEach((wb,Qb)=>{this.Llc.$Lj(Ta[0].top,this.Qu.left+
Qb,wb)})}}Mjd(U,Ta){for(let Qb=0;Qb<this.values.length;++Qb)for(let sc=0;sc<this.values[Qb].length;++sc){const Vc=Oa.Range.gd(this.Qu.top+Qb,this.Qu.left+sc);if(!U||U.some(Ld=>Ld.contains(Vc))){var wb=this.gridView.Cv(Vc);if((!wb||Vc.equals(wb.topLeft))&&(wb=this.gridView.jc(Vc))&&!Ta(Qb,sc,Vc,wb))return}}}Z7e(){return this.gridView.Ca.lz().filter(U=>U.na===this.$.na).map(U=>U.af)}yTh(U){this.Vh.HL(3400,this.worksheetId)&&(U=Rd.a.Zc({type:"RangeValuesPreviewDismissed",source:"Local",Znk:U}),this.Hh.pG(3400,
this.worksheetId,U))}h2(){this.$.userOperationManager.Uo(this.kSa);this.aEj();this.Hqa=this.worksheetId=this.kFc=this.values=this.Qu=this.kTa=void 0}T$g(){if(this.Qu){var U=this.Jfi(this.Qu);if(U){f.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var Ta=(Vc,Ld)=>{var le;return null===(le=this.gridView.jc(Oa.Range.gd(Vc,Ld)))||void 0===le?void 0:le.backgroundColor},wb=U.usedRange.top;
if(U.attributes&16){var Qb=Ta(U.usedRange.top,U.usedRange.left);++wb}var sc=Ta(wb,U.usedRange.left);Ta=Ta(wb+1,U.usedRange.left);this.Hqa={hpg:U.usedRange.top,Xrd:Qb,c8j:sc,X5g:Ta}}else f.ULS.sendTraceTag(509223561,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else f.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}q$g(){this.t2a=Array(this.Qu.width);
let U=!1;this.Mjd(void 0,(Ta,wb,Qb,sc)=>{var Vc;if(this.gridView.Cv(Qb))return U=!0,!1;Ta=sc.cell;Ta=Ta.VMe(Ta.peb);Ta>sc.width&&(this.t2a[wb]=Object(Lc.a)(null!==(Vc=this.t2a[wb])&&void 0!==Vc?Vc:0,Ta));return!0});U&&(this.t2a=void 0)}aEj(){this.Llc.restore();hb.z(this.Qu,(U,Ta)=>{U=Oa.Range.gd(U,Ta);if(U=this.gridView.jc(U))U.cell.peb=void 0})}A5h(U){return this.Hqa.Xrd&&U===this.Hqa.hpg?this.Hqa.Xrd:0===(U-this.Hqa.hpg-(this.Hqa.Xrd?1:0))%2?this.Hqa.c8j:this.Hqa.X5g}Jfi(U){const Ta=lc.b(this.gridView.$,
U,!0);if(!(1<Ta.length)){var wb=sc=>{var Vc;const Ld=null!==(Vc=this.gridView.Mb.Ifi(sc))&&void 0!==Vc?Vc:this.gridView.Mb.Kfi(sc);if(Ld)return Ld},Qb=wb(U);if(Qb&&0===Ta.length)return Qb;if(0!==Ta.length&&(U=hb.Y(U,Ta[0].usedRange),1===U.length))return wb(U[0])}}}nd.QAg=20;nd.bAg=100;Object(c.a)(nd,"RichApiRangeValuesPreview",null,[]);class Wd{}Object(c.a)(Wd,"SessionRecreationInfo",null,[]);class $d{constructor(U,Ta,wb){this.$=U;this.Vh=Ta;this.runtimeCalculationMode=wb}XXi(){return na.EwaSettings.ya(234)?
this.Vh.Rni()||0!==this.runtimeCalculationMode:!1}u8g(){var U={};U.eventRegistrationInfos=this.Vh.j5h();U.runtimeCalculationMode=this.runtimeCalculationMode;U=Object(b.a)(new Wd,{runtimeState:U});const Ta={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Ta.RequestBody=JSON.stringify(U);Ta.RequestFlags=1;return Ta}}Object(c.a)($d,"RichApiRuntimeStateHandler",null,[]);class se{constructor(U,Ta,wb,Qb,sc,Vc,Ld,le,Ce){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=
null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=U;this.processUtcTime=Ta;this.dequeueUtcTime=wb;this.inQueueDurationInMS=Qb;this.executionDurationInMS=sc;this.operationCount=Vc;this.ServerCorrelationId=Ld;this.UserOperationName=le;this.IsDocumentHidden=Ce}}Object(c.a)(se,"UserOperationQueueItemsStatisticsData",null,[]);var je=a(338),Le=a(35),oe=a(19),ue=a(304),df=a(53),
Se=a(609),bf=a(73),Ye=a(63),gf=a(76);class nf extends je.a{constructor(U,Ta,wb){super(wb,U);this.tya=this.hashCode=null;this.c$b=!1;this.Sn=(Qb,sc)=>{sc.Jd.hash===this.hashCode&&this.tya&&Object(jb.a)(a(765).DdaFacade,this.$.da.Ba(35)).QXj(this.tya.InstanceId)};this.Uf=(Qb,sc)=>{switch(sc.Jd.block.state){case 1:case 3:case 5:this.qga(sc)}};this.Bj=()=>{this.nNb(!0)};this.Cp=(Qb,sc)=>{this.isVisible&&this.hXa(sc.PC);this.clearCache()};this.Ee=(Qb,sc)=>{this.lWa(sc.na,!!sc.PC)};this.$x=()=>{this.$.ea.Yoa()};
this.OXa=Ta;this.domElement.classList.add(Le.a.dec);this.domElement.classList.add(oe.a.Eu);wb.tabIndex=0;this.lWa(this.$.na,!1);this.od.la("mousedown",this.$x);this.od.la("contextmenu",Qb=>{gf.g(Qb)});this.$.ua.CK(this.Cp);this.$.Zb.CK(this.Cp);this.$.Zb.Lg(this.Ee);this.$.ua.Lg(this.Ee);this.Ca.mv(this.Uf);this.Ca.gI(this.Sn);this.Ca.rw(this.Bj);this.jt(this.tBa)}get Ca(){return this.OXa}dispose(){this.$&&(this.$.ua.jM(this.Cp),this.$.Zb.jM(this.Cp),this.$.Zb.ih(this.Ee),this.$.ua.ih(this.Ee));this.OXa&&
(this.OXa.Lt(this.Uf),this.OXa.BJ(this.Sn),this.OXa.Vw(this.Bj));this.Rv(this.tBa);this.clearCache();nb.a.Ka(this.OXa);this.OXa=null;pb.DOMElementExtensions.gg(this.domElement);super.dispose()}gMj(U){pb.DOMElementExtensions.gg(pb.DOMElementExtensions.getElementById(this.domElement,U.id));this.domElement.appendChild(U)}gud(){if(this.tya&&!this.c$b){var U=Object(jb.a)(a(765).DdaFacade,md.a(this.$)).Ln(this.tya.InstanceId);U&&(U.resize(this.tya.Width,this.tya.Height),U.la(this.domElement),U.showHide(!0),
this.c$b=!0)}}Aab(){return!0}qga(U){this.tya=U.Jd.block.De;this.c$b=!1;this.gud()}hXa(U){this.$.ea.j7&&U&&(U.Xt||(U.Xt=new ue.a),U.Xt.Zi=new df.a(this.domElement.scrollLeft,this.domElement.scrollTop),U.Xt.FMb=20)}clearCache(){this.Ca.QTa(this.hashCode);this.tya=this.hashCode=null;this.c$b=!1}lWa(U,Ta){if(this.isVisible=!!U&&bf.o(U))this.hashCode=this.Ca.Dua(U,Ye.a.ebc,this.hashCode),this.UDc(Ta)}static FJa(U){if(!U.da.Ba(34)){const Ta=U.$f;U.da.Ja(34,new nf(U,new Se.a(U,U.ea,U.qa.Dl,3,0),Ta.appendChild(Ta.ownerDocument.createElement("div"))))}}}
Object(c.a)(nf,"WebExtensionView",je.a,[751,202,2]);var oc=a(233),Ac=a(382),xa=a(444),Cb=a(200),bc=a(58),Fc=a(120),Tc=a(51),gd=a(48),td=a(167),kb=a(116),Vb=a(65),qc=a(32),Bc=a(33),$b=a(230),tc=a(23),Xc=a(16),qd=a(246),Cd=a(759),Xd=a(55),ge=a(173),ve=a(857);const Ie=U=>{ge.a.sendOtelEvent(Object.assign(new ve.a,{otelEvent:U}))},Ee=U=>{ge.a.sendOtelCustomerContent(Object.assign(new ve.a,{otelEvent:U}))};var pf=a(908),Xe=a(26),Ve=a(119),wf=a(745);class Ff{constructor(U,Ta,wb){this.bzc=0;this.Kue=new Set;
this.Dtf=!1;this.$=U;this.Vh=Ta;this.Hh=wb}l3g(U){1===U.actionType?this.Vh.HL(65541,ld.a.pM)?this.bzc++:f.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===U.actionType&&0<this.bzc&&this.bzc--}bIf(U,Ta){if(0===this.bzc)f.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(Ta){U=Ta.QB;var wb=[];wb.push({content:JSON.stringify(Ta.QB),annotationType:wf.a.rya(U),id:U.id});this.Hh.pG(65541,ld.a.pM,JSON.stringify({annotationProperties:wb}))}else f.ULS.sendTraceTag(509649752,
0,10,"Event args are null")}Qji(U){return Object(Ve.a)(this,void 0,void 0,function*(){if(!this.Vh.HL(65541,ld.a.pM))f.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!this.Kue.has(U.annotationType)){var Ta=na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?yield rb.a.resolve(ec.f,{Wa:1}):yield Pa.GetServiceTaskFactory.t0(this.$.da,328,327,1);na.EwaSettings.isChangeGateEnabled("OfficeVSO:7694128_RichAPIUseNewALAPI")?(this.Dtf||
(Ta.register(Ta.j0().v2("RichApi").t2(()=>{}).build()),this.Dtf=!0),Ta.o9("RichApi",{annotationType:U.annotationType,Jv:!1,HO:this.bIf.bind(this)})):(Ta.grb(U.annotationType),Ta.Bua(U.annotationType,this.bIf.bind(this)));this.Kue.add(U.annotationType)}})}Rji(U){return Object(Ve.a)(this,void 0,void 0,function*(){(na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?yield rb.a.resolve(ec.f,{Wa:1}):yield Pa.GetServiceTaskFactory.t0(this.$.da,328,
327,1)).eTb(JSON.parse(U.content));f.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${U.signalType}`)})}}Object(c.a)(Ff,"RichApiAugmentationLoopHandler",null,[]);a.d(C,"DdaFacade",function(){return db});class db extends sb.a{constructor(U,Ta,wb){super();this.Hh=this.Bk=this.ea=null;this.Vf=[];this.cMa=null;this.disposed=this.initialized=this.VVb=this.aRe=!1;this.dFa=null;this.owc=[];this.VQe=[];this.QSa=[];this.X4a=null;this.AMd=new ha.a(J.a.Ah());this.W4b=new S.a(J.a.Ah());this.pMb=
[];this.xVf=[];this.nxb=350;this.cAa=this.oha=null;this.$_c=!1;this.qMc=this.$nb=this.Mpe=this.Lpe=this.Bpe=this.Kpe=this.Jpe=this.Hpe=this.Dpe=this.Ipe=this.Epe=this.Gpe=this.Cpe=this.Fpe=null;this.fg=()=>{this.dFa=this.ea.Pn.WebExtensions;var Qb=Vc=>na.EwaSettings.ya(114)?!Vc.nwa:!0,sc=Vc=>na.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!Vc.mDi:!0;for(let Vc=this.Vf.length-1;0<=Vc;--Vc){let Ld=this.Vf[Vc];!this.rTh(Ld.controlId)&&Qb(Ld)&&sc(Ld)&&
(Ld.juc(),this.Vf.splice(Vc,1))}if(this.dFa)for(let Vc=0,Ld=this.dFa.length;Vc<Ld;Vc++)Qb=this.dFa[Vc],(sc=this.Ln(Qb.WebExtensionId))&&sc.UJd(Qb)};this.ovc=Qb=>{this.raiseEvent("csc",Qb.getID())};this.dLb=(Qb,sc,Vc)=>{if(sc===OSF.AgaveHostAction.KeyboardShortcuts){var Ld=Object(jb.a)(Object,Vc);sc={};sc.keyCode=Ld.keyCode;sc.type="keydown";sc.ctrlKey=Ld.ctrlKey;sc.shiftKey=Ld.shiftKey;sc.altKey=Ld.altKey;sc.metaKey=Ld.metaKey;Ld=this.Ln(Qb);Qb=Ld.Aba;sc.srcElement=Object(Fb.a)(457,Qb)?Qb.pJa:Ea.h(this.$).Lc;
Qb=new Sys.UI.DomEvent(sc);Ld=db.Dxa(Ld.Ol,this.$);sc={};sc.focusedAddinId=Ld;Ld=new Kb.a(1461300262,1,this.$.Kc,6,null);Ea.h(this.$).MPb(Qb,Ld,sc)}else if(sc===OSF.AgaveHostAction.Select)this.Vgf(!0);else if(sc===OSF.AgaveHostAction.UnSelect)this.Vgf(!1);else if(sc===OSF.AgaveHostAction.CancelDialog)this.BL(-684355545,null);else if(sc===OSF.AgaveHostAction.InsertAgave)Qb={},Vc&&(this.$nb=Vc,Qb[aa.a.jja]=Vc,Qb[yb.a.Bg]=this.bwa(Vc),this.BL(-741808261,Qb));else if(sc===OSF.AgaveHostAction.ClickTrust)this.p3c&&
Vc&&(this.$nb=Vc);else if(sc===OSF.AgaveHostAction.OsfControlLoad)this.p3c&&this.$nb&&Vc&&this.p2g(this.$nb,Vc)&&Vc.storeType&&(this.$nb=null,this.$G(Na.b(Vc.storeType)));else if(sc===OSF.AgaveHostAction.InsertDevManifest)Qb={},Vc&&(Qb[aa.a.jja]=Vc,Qb[yb.a.Bg]=this.bwa(Vc),this.BL(-741808261,Qb));else if(sc===OSF.AgaveHostAction.InsertDevManifestError)Qb=Object(jb.a)(Object,Vc),Qb={[aa.a.a3c]:this.Bk.getDevManifestInvalidUrlErrorString(Qb.manifestUrl)},this.BL(-2025863019,Qb);else if(sc===OSF.AgaveHostAction.NotifyHostError)Qb=
{[aa.a.a3c]:this.Bk.getManifestInvaildErrorString()},this.BL(-2025863019,Qb);else if(sc===OSF.AgaveHostAction.RefreshAddinCommands)na.EwaSettings.ya(52)&&this.BL(Xe.a.refreshAddinCommands,null);else if(sc===OSF.AgaveHostAction.CtrlF6Exit||sc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Ld=this.$.da.Ba(15)){(Qb=this.Ln(Qb).Aba)&&Qb.kGc();t.a.ng&&document.activeElement.blur();var le={keyCode:117,type:"keydown",ctrlKey:!0};le.shiftKey=sc===OSF.AgaveHostAction.CtrlF6ExitShift;le.srcElement=Object(Fb.a)(457,
Qb)?Qb.pJa:Ea.h(this.$).Lc;Qb=new Sys.UI.DomEvent(le);Ld.Noa(Qb)}}else if(sc===OSF.AgaveHostAction.PageIsReady){if((Qb=this.Ln(Qb).Aba)&&Qb.I1a===OSF.OsfControlTarget.TaskPane&&(Qb=this.$.da.Ba(183))&&this.Vf){sc=ba.a.Sd();for(Ld of this.Vf)db.wPa(Ld.qR)&&(sc?Qb.Qg(!0,!1):Qb.setFocusOnToolbarFirstElement())}}else if(sc===OSF.AgaveHostAction.TabExit){sc=this.Ln(Qb);const ef=sc.Aba;if(ef)if(ef.I1a===OSF.OsfControlTarget.InContent)ef.Lwf();else{if(ef.I1a===OSF.OsfControlTarget.TaskPane)if(ba.a.Sd())t.a.ng&&
document.activeElement.blur(),X.UISurfaces.dk().then(uf=>{const Ab=Object(Fb.a)(457,ef)?ef:null;Ab?Ab.isResizable?uf.focusResizeHandle():uf.focusTabbedTaskPaneArea():uf.focusTabbedTaskPaneArea();return null});else if(sc=this.$.da.Ba(183))t.a.ng&&document.activeElement.blur(),(Qb=document.getElementById(this.$.fc+Ya.a.xtc))&&pb.DOMElementExtensions.isVisible(Qb)?pb.DOMElementExtensions.setFocus(Qb):sc.setFocusOnToolbarFirstElement()}else sc&&4===sc.osfControlType&&this.Bk.notifyAgave(Qb,OSF.AgaveHostAction.TabIn)}else if(sc===
OSF.AgaveHostAction.TabExitShift)(sc=this.Ln(Qb),Ld=sc.Aba)?Ld.I1a===OSF.OsfControlTarget.InContent?Ld.Mwf():Ld.I1a===OSF.OsfControlTarget.TaskPane&&(Qb=Object(Fb.a)(457,Ld)?Ld:null)&&(t.a.ng&&document.activeElement.blur(),Qb.hdg()):sc&&4===sc.osfControlType&&this.Bk.notifyAgave(Qb,OSF.AgaveHostAction.TabIn);else if(sc===OSF.AgaveHostAction.EscExit||sc===OSF.AgaveHostAction.ExitNoFocusable||sc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Ld=this.Ln(Qb).Aba)Ld.kGc();else{if(sc===OSF.AgaveHostAction.EscExit){sc=
null;for(le of D.kii())if(le.value.Te===Qb){le.value.dialog.hide();sc=le.key;break}sc&&(Qb=this.Ln(sc))&&4!==Qb.osfControlType&&this.Lf.notifyAgave(sc,OSF.AgaveHostAction.TabIn)}}else if(sc===OSF.AgaveHostAction.InstallCustomFunctions)if(na.EwaSettings.ya(114)){Vb.a(this.$).B5e(()=>!1);var Ce=this.$.da;ib.TaskExtensions.za(Pa.GetServiceTaskFactory.Za(Ce,278,279,1),ef=>{ef=ef.result;Ce.Ba(278)||Ce.Ja(278,ef);const uf=Vc.osfControl.getStoreType();ef.hnf(Vc.osfControl.getSolutionId(),uf,db.y3h(Vc.osfControl),
Vc).Rpa()},this.ka,3)}else f.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(sc===OSF.AgaveHostAction.UninstallCustomFunctions)if(na.EwaSettings.ya(114)){Vb.a(this.$).B5e(()=>!1);var Oe=this.$.da;ib.TaskExtensions.za(Pa.GetServiceTaskFactory.Za(Oe,278,279,1),ef=>{ef=ef.result;Oe.Ba(278)||Oe.Ja(278,ef);ef.xrg(Vc.solutionId,Vc.storeType).Rpa()},this.ka,3)}else f.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else sc===OSF.AgaveHostAction.SendTelemetryEvent?Ie(Vc):sc===OSF.AgaveHostAction.SendCustomerContent?Ee(Vc):sc===OSF.AgaveHostAction.LaunchExtensionComponent?e.a.instance.YLi(Vc):sc===OSF.AgaveHostAction.RefreshRibbonGallery?(Qb=this.$.da.Ba(519))&&Qb.ird(Vc):sc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.Bwj(Vc.solutionId),ba.a.Sd()||(Qb=this.$.da.Ba(183))&&Qb.fD()):sc===OSF.AgaveHostAction.GetOriginalControlId&&(Qb=new ta.a(this.$.fc,Vc.ownerAddinSolutionId,new Ma.a,!0),Vc.originalControlId=
Qb?Qb.nRe(Vc.controlId):Vc.controlId)};this.fKj=(Qb,sc)=>{const Vc=Array(2);Vc[0]=sc;Vc[1]=null;this.Hh.CTh(Qb,JSON.stringify(Vc))};this.Mdj=()=>{this.$.na&&bf.o(this.$.na)&&this.$.da.Ba(34).gud()};this.Td=()=>{this.Qyf()};this.QS=(Qb,sc)=>{var Vc,Ld;1===sc.Pr&&(Qb=sc.pg)&&(sc=new se(kb.toTimestamp(Qb.enqueueUtcTime),kb.toTimestamp(Qb.processUtcTime),kb.toTimestamp(Qb.dequeueUtcTime),kb.getElapsedMilliseconds(Qb.enqueueUtcTime,Qb.processUtcTime),kb.getElapsedMilliseconds(Qb.processUtcTime,Qb.dequeueUtcTime),
Qb.operationCount,(null===(Ld=null===(Vc=Qb.operation)||void 0===Vc?void 0:Vc.Zd)||void 0===Ld?0:Ld.ServerCorrelationId)?Qb.operation.Zd.ServerCorrelationId:null,Qb.operation?Enum.toString(xa.a,Qb.operation.operationName):null,Cd.a.xE(kb.getElapsedMilliseconds(Qb.enqueueUtcTime,qc.a.Bb.Cc))),Vc=Sys.Serialization.JavaScriptSerializer.serialize(sc),f.ULS.sendTraceTag(50872916,0,50,Vc))};this.zd=(Qb,sc)=>{!this.ea.Ec&&oc.a(sc)?(Array.forEach(this.Vf,this.nKf),this.Vf.length=0,this.VVb=!1):(sc.FG&&(f.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),this.z7f()),this.mM(),na.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.VVb=!1))};this.Tn=()=>{na.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(f.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.z7f());this.mM();na.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.VVb=
!1)};this.nKf=Qb=>{Qb.juc();this.raiseEvent("cd",Qb.controlId)};this.Jb=U;this.s3c=Ta;this.initialize(wb);ma.la(this);this.L8f=0;(U=(U=!(t.a.iq||t.a.S0))&&!t.a.ng)&&OfficeExt.ShortcutKeyDispatchManager.init();this.zIg={}}get c6b(){return this.oha||(this.oha=new la.a(this.$.yw))}Hxe(U){this.addHandler("cd",U)}Cxj(U){this.removeHandler("cd",U)}qWg(U){this.addHandler("csc",U)}Exj(U){this.removeHandler("csc",U)}nWg(U){this.addHandler("ca",U)}Bxj(U){this.removeHandler("ca",U)}oWg(U){this.addHandler("ci",
U)}pWg(U){this.addHandler("ekros",U)}Dxj(U){this.removeHandler("ekros",U)}cMd(U,Ta){try{return JSON.parse(U)[Ta].toLowerCase()}catch(wb){return""}}dTj(U){const Ta=this.cMd(U,"AudienceGroup"),wb=this.cMd(U,"SessionOrigin");try{const Qb=parseInt(this.cMd(U,"Ring"),10);if("automation"!==Ta&&"bluechicken"!==wb&&-2<=Qb)return!0}catch(Qb){if("automation"!==Ta&&"bluechicken"!==wb)return!0}return!1}get Lf(){if(!this.Bk){const U={},Ta=!(this.$.$d&1),wb=Gc.a.current.cM,Qb=this.$.workbookContext,sc=sa.a.zM+
sa.a.x9b;U.pageBaseUrl=wb.LayoutsContentUrlPrefix;U.appName=OSF.AppName.ExcelWebApp;U.appVersion="16";U.appSettings=this.z7h();U.singleSignOnSettings=I.AppsForOfficeSingleSignOnManager.Iei();U.clientMode=Ta?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;U.appUILocale=this.$.xa.UICultureTag;U.dataLocale=this.$.xa.DataCultureTag;U.docUrl=Qb.ClientUrl;U.hostControl=this;U.formFactor=OSF.FormFactor.Default;U.lcid=this.$.jF.toString();U.localizedScriptsUrl=sa.a.zM+sa.a.V9c;U.localizedImagesUrl=sc;U.localizedStylesUrl=
sa.a.zM+sa.a.dMe;U.localizedResourcesUrl=sc;U.osfOmexBaseUrl=wb.OsfOmexBaseUrl;U.firstPartyManifestCDNUrl=wb.FirstPartyAddInManifestCDN;U.sdxAssetsToPrefetchMapping=w.AFrameworkApplication.fa.Va("SdxAssetsToPrefetchMapping");U.sdxCdnUrl=wb.SdxCdnUrl;U.sdxDmsUrl=wb.SdxDmsUrl;U.devCatalogUrl=wb.DevCatalogUrl;U.controlStatusChanged=this.ovc;U.notifyHost=this.dLb;U.allowExternalMarketplace=this.$.ea.oh.get(27)&&db.l$b;U.enableAddinCommands=na.EwaSettings.ya(52);U.enableBlackForestRedirect=na.EwaSettings.ya(87);
U.enableMyOrg=this.$.ea.oh.get(33);U.enableMyApps=this.$.ea.oh.get(34);U.enableDevCatalog=na.EwaSettings.ya(43);U.enablePrivateCatalog=this.$Tj();U.showSignOutFromPrivateCatalogMessage=this.$.ea.oh.get(36);U.enableUploadFileDevCatalog=na.EwaSettings.ya(52)&&!na.EwaSettings.ya(254);U.userNameHashCode=M.a.rv(w.AFrameworkApplication.userName);U.envCode=this.$.xa.OfficeAddinTelemetryDataSourceCode.toString();U.enableSingleSignOnForAddin=!na.EwaSettings.ya(23)&&w.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
U.enableDisplayBlockedMinorError=na.EwaSettings.ya(171);U.hideAppsExtensionUrl=w.AFrameworkApplication.hideAppsExtensionUrl;U.enableAnonymousUseLegacyCatalogService=na.EwaSettings.ya(162);U.enableInsertDialogAccessibilityFix=na.EwaSettings.ya(169);U.disableAppsForOfficeThirdParty=na.EwaSettings.ya(174);U.enableFirstPartySSO=na.EwaSettings.ya(186);U.wacSessionId=this.$.xa.UserSessionId;U.disableLogging=!this.$.xa.AriaLoggingIsEnabled;U.enableFirstPartySDXErrorMessages=na.EwaSettings.ya(198);U.enableRichApiCellEditDelay=
na.EwaSettings.ya(178);U.isHostDocumentDomain=na.EwaSettings.ya(209);U.loggableUserId=w.AFrameworkApplication.fa.Va("LoggableUserId");U.sessionStartInfoJson=w.AFrameworkApplication.fa.Va("SessionStartInfoJson");U.wopiHostOriginFromPostMessage=w.AFrameworkApplication.wopiHostOriginFromPostMessage;U.wopiHostOriginFromWacPropBag=w.AFrameworkApplication.fa.Va("PostMessageOrigin");U.wacIsEmbedded=w.AFrameworkApplication.fa.ra("IsEmbedded");U.accessibilityAllowFocusAddinTaskpane=w.AFrameworkApplication.fa.ra("AccessibilityAllowFocusAddinTaskpane");
U.enableRemoveAppCommandsAddin=w.AFrameworkApplication.fa.ra("RemoveAppCommandsAddinIsEnabled");U.isHostFrameTrustCheckEnabledForAddIns=w.AFrameworkApplication.fa.ra("HostFrameTrustCheckIsEnabledForAddIns");U.isHostFrameTrusted=w.AFrameworkApplication.isHostFrameTrusted;U.agaveAddinUploadEnabled=na.EwaSettings.ya(45);U.hostAllowedOfficeStore=w.AFrameworkApplication.fa.ra("HostAllowedOfficeStore");U.hostAllowedSdxEmbedding=w.AFrameworkApplication.fa.ra("HostAllowedSdxEmbedding");U.hostInstallAddIns=
w.AFrameworkApplication.fa.Va("HostInstallAddIns");U.hostInstallAddInsIsEnabled=w.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled");U.approvedAddIns=w.AFrameworkApplication.fa.Va("ApprovedAddIns");U.addinEnforceHttpsIsEnabled=this.dTj(U.sessionStartInfoJson);U.hostFeatureGateFlag=0;U.isUpnCheckEnabled=w.AFrameworkApplication.fa.ra("IsUpnCheckEnabled");U.wacUpn=w.AFrameworkApplication.fa.Va("UserPrincipalName");U.isReactRibbonEnabled=ba.a.isReactRibbonEnabled();U.enableSetFocusOnTaskpaneOnUserAction=
na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);U.isSafariWithIndexedDBDisabled=na.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.jQa;U.isIndexedDBDisabled=na.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.jQa||na.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&t.a.ng;U.enableCustomShortcuts=!0;U.changeGetModifierKeyStringOutputOrder=na.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
U.officeJsUrl=w.AFrameworkApplication.oT("OfficeJs/excel.js",5);U.enableOfficeJsUrlParam=na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Bk=new OSF.ContextActivationManager(U);this.Bk.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Bk.setWSA(w.AFrameworkApplication.Co);this.Bk&&"undefined"!==typeof this.Bk.hostCheckReadyHandler&&w.AFrameworkApplication.lXg(Object(d.a)(this.Bk,this.Bk.hostCheckReadyHandler,"hostCheckReadyHandler"));
try{const Vc=Va.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Bk.setOAuthManager(Vc)}catch(Vc){}}return this.Bk}get Pkk(){return this.$_c}get Vh(){return this.Fpe}get Npa(){return this.Cpe}get bVd(){return this.Gpe}get aVd(){return this.Epe}get XEj(){return this.Ipe}get VEj(){return this.Dpe}get WEj(){return this.Hpe}get YEj(){return this.Jpe}get ZEj(){return this.Kpe}get cVd(){return this.Lpe}get K8f(){return this.Mpe}get LW(){return this.zIg}get $(){return this.Jb}get $Ud(){return this.Bpe}J6b(U){const Ta=
{};Ta.Name=U.Name;Ta.BindingType=U.BindingType;Ta.HasHeaders=U.HasHeaders;U.IsValidRef&&(Ta.ColCount=U.Reference.LastColumn-U.Reference.FirstColumn+1,Ta.RowCount=U.Reference.LastRow-U.Reference.FirstRow+1);return Ta}get b3c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}byf(U,Ta){const wb=this.w7g(Ta);let Qb=null;
if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Ta&&"LaunchAddinDialogFromTellMe"===Ta[0])null!==wb.assetId&&"undefined"!==typeof wb.assetId&&(Qb="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.b3c){const sc=this.$.ea.oh.get(27);sc&&null!==Ta&&"InsertMoreAddInsFromFooter"===Ta[0]?Qb="{98143890-AC66-440E-A448-ED8771A02D52}":
sc&&null!==Ta&&"AddinFlyoutMoreButton"===Ta[0]&&(Qb="0")}this.Bk.launchInsertDialog(U,Qb,wb)}get iba(){return this.ssb}get ssb(){this.p3c&&!this.qMc&&(this.qMc=Wa.createInstance(w.AFrameworkApplication.fa,new Rb.a(()=>this.Bk),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.Q5j,["AreThirdPartyAddInsAllowed"]:this.$.cV,["PopularAddinDetailsJsonString"]:db.$Ba,["UICulture"]:w.AFrameworkApplication.uiCulture}));return this.qMc}get Q5j(){return na.EwaSettings.ya(174)}get allowExternalMarketplace(){return this.$.ea.oh.get(27)}get p3c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}static get $Ba(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","version":"1.5.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1770,"downloadNumber":3723306}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":20064,"downloadNumber":3787515}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":40,"downloadNumber":7547}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":359,"downloadNumber":88214}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1369,"downloadNumber":5211012}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.4.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674774/Asset_733b35d6-e5e0-4163-b45d-3396185864bd/WIKIPEDIAAPPFOROFFICELICENSETE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":368,"downloadNumber":1946395}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":1,"AUP":3146,"downloadNumber":1177320}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1364,"downloadNumber":8198147}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":68,"downloadNumber":36590}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":6262,"downloadNumber":543258}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710,"downloadNumber":109178}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":673,"downloadNumber":304226}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":2790,"downloadNumber":3737454}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":588,"downloadNumber":525805}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":358,"downloadNumber":895006}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":597,"downloadNumber":4268442}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":1812,"downloadNumber":3103601}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"wa104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":1,"AUP":434,"downloadNumber":95967}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":353,"downloadNumber":25753}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":-1,"AUP":1299,"downloadNumber":177312}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":371,"downloadNumber":149144}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":297,"downloadNumber":60607}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":935,"downloadNumber":357671}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1421,"downloadNumber":977902}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":373,"downloadNumber":75023}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":8162,"downloadNumber":2009209}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":192,"downloadNumber":15361}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":696,"downloadNumber":12047}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":382,"downloadNumber":18570}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":10559,"downloadNumber":11584101}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":-1,"AUP":1674,"downloadNumber":52744}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1315,"downloadNumber":437152}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":640,"downloadNumber":151171}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":441,"downloadNumber":992110}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\u2019s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":2,"AUP":1112,"downloadNumber":583228}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":471,"downloadNumber":207947}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":83858,"downloadNumber":1824830}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using Refinitiv\u2019s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":356,"downloadNumber":250456}},{"displayName":"Money in Excel","solutionId":"wa200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.aspx","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":1382,"downloadNumber":178279}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":679,"downloadNumber":58708}},{"displayName":"McGraw Hill","solutionId":"wa200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":2,"AUP":118855,"downloadNumber":17}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1991,"downloadNumber":948014}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":272,"downloadNumber":95161}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\u2019s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":768,"downloadNumber":16652}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":129,"downloadNumber":203447}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":185,"downloadNumber":340160}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":382,"downloadNumber":465970}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":404,"downloadNumber":20528}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":403,"downloadNumber":314491}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":2501,"downloadNumber":12800}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":120,"downloadNumber":22465}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.0.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":120,"downloadNumber":18597}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":1,"AUP":18,"downloadNumber":516}},{"displayName":"AI Formula Generator Bot for Excel","solutionId":"wa200004935","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Transform your text instructions into Excel formulas in seconds with the help of AI.","iconUrl":"15321.02bef729-7dee-4518-80a6-f1201acff812.20f898b8-6e94-4547-b2c1-2680aff4db58.e0447c81-0b85-428e-8e98-0c3ecefac08c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://excelformulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":286,"downloadNumber":51919}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":19,"downloadNumber":54328}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":1,"AUP":165,"downloadNumber":13423}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541,"downloadNumber":8869}},{"displayName":"Numerous.ai","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":283,"downloadNumber":1376}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":4,"downloadNumber":0}}]'}$G(U,
Ta){this.ssb&&this.ssb.$G(U,Ta)}Yyc(U){this.ssb&&this.ssb.rfb(U)}p2g(U,Ta){return J.a.Ah().equals(U.solutionId,Ta.solutionId)&&J.a.Ah().equals(U.storeType,Ta.storeType)}$Od(U,Ta){if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.eZf(U,Ta,OSF.StoreTypeEnum.MarketPlace);else{const wb={};wb.callbackFunc=U;wb.storeType=OSF.StoreTypeEnum.MarketPlace;wb.fromInsertDialog=!1;wb.refresh=Ta;this.Bk.queryEntitlementDetails(wb)}}eZf(U,Ta,wb){const Qb={};
Qb.callbackFunc=U;Qb.storeType=wb;Qb.fromInsertDialog=!1;Qb.refresh=Ta;this.Bk.queryEntitlementDetails(Qb)}invokeDdaMethod(U,Ta){const wb=this.Ln(U.DdaMethod.ControlId);wb?wb.invokeDdaMethod(U,Ta):this.kg(Jb.a.internalError,Ta)}registerDdaEventAsync(U,Ta,wb,Qb,sc){(Ta=this.Ln(Ta))?db.OEb(U)?Ta.ltj(U,wb,Qb,sc):this.kg(Jb.a.rLd,sc):this.kg(Jb.a.internalError,sc)}unregisterDdaEventAsync(U,Ta,wb,Qb,sc){(Ta=this.Ln(Ta))?db.OEb(U)?Ta.Gbk(U,wb,Qb,sc):this.kg(Jb.a.rLd,sc):this.kg(Jb.a.internalError,sc)}dispose(){this.disposed||
(this.$.Rm(this.Td),this.ea.Kk(this.zd),this.ea.rP(this.Tn),this.ea.Xw(this.fg),this.s3c.detach(this),this.$.userOperationManager.Uo(this.QS),this.owc=this.Vf=this.Hh=this.s3c=this.Jb=null,this.cMa&&(this.cMa.dispose(),this.cMa=null),nb.a.Ka(this.bVd),nb.a.Ka(this.aVd),this.X4a&&(this.X4a.dispose(),this.X4a=null),super.dispose(),this.disposed=!0,f.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}fmd(U){return(U=this.Ln(U))?U.getDefaultIconUrl():null}rDc(U){if(this.aRe!==U){this.aRe=U;for(let Ta=
0,wb=this.Vf.length;Ta<wb;Ta++){const Qb=this.Vf[Ta];U?Qb.HTe(!1):Qb.GCh()}this.bVd.rDc(U);this.aVd.rDc(U)}}U3h(U){return(U=this.Ln(U))?U.getDefaultDisplayName():null}kg(U,Ta,wb=!0){const Qb={};Qb[yb.a.Bg]=U;Qb[yb.a.L5]=Ta;this.BL(451041795,Qb,wb)}Gw(U){const Ta={};Ta[yb.a.L5]=U;this.BL(1237877382,Ta)}BL(U,Ta,wb=!0){const Qb=new Kb.a(U,0,this.$.Kc,0,null),sc=Ta?Ta[yb.a.L5]:null;this.X4a&&Ea.h(this.$).Eb&&Gb.Agh(U,Ta)?this.X4a.nvh(U,Ta):(U=this.$.Ia.$b(Qb,Ta),wb&&ib.TaskExtensions.za(U,Vc=>{td.a(Vc)?
this.kg(Jb.a.internalError,sc,!1):Vc.result||(Ea.h(this.$).Eb?this.kg(Jb.a.$Db,sc,!1):this.kg(Jb.a.internalError,sc,!1))},this.ka,8))}ejh(U){return!!this.rla(Ta=>db.getSolutionId(Ta.Ol,this.$)===db.getSolutionId(U,this.$)&&Ta.Ol.PrimaryMarketplace.MarketplaceType===U.PrimaryMarketplace.MarketplaceType&&Ta.Ol.PrimaryMarketplace.MarketplaceRef===U.PrimaryMarketplace.MarketplaceRef&&Ta.Ol.PrimaryMarketplace.SolutionVersion===U.PrimaryMarketplace.SolutionVersion)}Ln(U){return this.rla(Ta=>Ta.controlId.startsWith(U))}fTh(U){return this.rla(Ta=>
Ta.nwa===U)}N3e(U){return this.rla(Ta=>Ta.qR===U&&!!Ta.nwa)}c4e(U,Ta,wb,Qb){return this.rla(sc=>sc.qR===U&&sc.Ol.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Ta.toLowerCase()&&sc.Ol.PrimaryMarketplace.MarketplaceType.toLowerCase()===wb.toLowerCase()&&!!sc.Ol.SharedRuntime&&!!sc.Ol.SharedRuntime.Resid&&!!Qb&&!!Qb.Resid&&sc.Ol.SharedRuntime.Resid.toLowerCase()===Qb.Resid.toLowerCase())}Z2g(U,Ta){if(U=this.Ln(U))U.la(Ta),U.showHide(!0)}QXj(U){(U=this.Ln(U))&&U.showHide(!1)}fLa(U){var Ta;if(1!==
U.WebExtensionType||this.$.$d&8388608&&U.TaskpaneVisible||this.$.$d&8388608&&!U.TaskpaneVisible&&nc.HelperMethods.Mx(U)){let wb=null;nc.HelperMethods.Mx(U)&&(wb=db.Dxa(U,this.$),U.TaskpaneWidth||(U.TaskpaneWidth=this.nxb));const Qb=(new ob(this,this.Hh,U)).Std();f.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(U.PrimaryMarketplace.SolutionId,U.OwnerAddinStoreType||U.PrimaryMarketplace.MarketplaceType,null===(Ta=U.AssetMarketplace)||
void 0===Ta?void 0:Ta.SolutionId,null,null,U.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${U.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${nc.HelperMethods.Mx(U)}`);wb&&(Qb.nwa=wb);this.Vf.push(Qb);this.cAa=null;this.A9a(U.InstanceId)||(U=String.format("{0}|{1}|{2}|{3}|{4}",U.PrimaryMarketplace.SolutionId,U.PrimaryMarketplace.SolutionVersion,U.PrimaryMarketplace.MarketplaceRef,U.PrimaryMarketplace.MarketplaceType,U.WebExtensionType),this.raiseEvent("ci",U))}}vZj(U,Ta){U.TaskpaneWidth=
this.nxb;U.TaskpaneVisible=!0;const wb={};wb.SolutionId=U.PrimaryMarketplace.SolutionId;wb.TargetType=U.WebExtensionType;wb.Version=U.PrimaryMarketplace.SolutionVersion;wb.StoreType=U.PrimaryMarketplace.MarketplaceType;wb.StoreId=U.PrimaryMarketplace.MarketplaceRef;U.AssetMarketplace?(wb.AssetId=U.AssetMarketplace.SolutionId,wb.AssetStoreId=U.AssetMarketplace.MarketplaceRef):(wb.AssetId=null,wb.AssetStoreId=null);wb.Width=U.TaskpaneWidth;const Qb=new ob(this,this.Hh,U,!0);Qb.Std();this.Vf.push(Qb);
const sc=()=>{this.STa(Qb.controlId);this.Lf.purgeOsfControl(Qb.controlId,!1);Ta()};let Vc=null;Vc=Tc.a.instance.ZD(()=>{Qb.Ez&&(nb.a.Ka(Vc),Vc=null,this.Lf.insertBlankControlWithErrorUX(this.NMb(Qb,wb),sc))},100,gd.a.auh)}enh(U){if(U&&U.length){var Ta=[];U.forEach(wb=>{if(wb.ContainsCustomFunctions){const Qb=db.Dxa(wb,this.$);this.AMd.contains(Qb)||(this.AMd.add(Qb),this.xVf.push(wb));this.ejh(wb)||Ta.push(wb)}});Ta.length&&this.fOe(Ta)}}fQe(U,Ta){this.Ln(U.InstanceId)||(Ta=Ta(),U=(new ob(this,this.Hh,
U)).hmf(Ta),this.Vf.push(U),this.cAa=null)}iXj(U){db.P4a.Fb(U)&&db.P4a.ma(U).initializeAndShowWithTitle()}Qoi(U){db.P4a.Fb(U)&&db.P4a.ma(U).hide()}cai(U){var Ta=null;let wb,Qb,sc=null;wb=db.hqd(U,!0);if(!wb)return f.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),ed.Task.Ua(null);(Qb=this.Bk.getOsfControl(db.getSolutionId(wb,this.$)))&&(Ta=Qb.getManifest())&&(sc=Ta.getSharedRuntimeForCustomFunctions("Workbook"));if(Ta=sc&&1===sc.LifeTime?
this.c4e(wb.PrimaryMarketplace.SolutionId,wb.PrimaryMarketplace.MarketplaceRef,wb.PrimaryMarketplace.MarketplaceType,sc):this.fTh(U))return ed.Task.Ua(Ta.controlId);const Vc=new mb.a;nc.HelperMethods.upc(sc)&&(wb.SharedRuntime=sc);U=Qb?Qb.getNotificationParams():[];if(!U.length)return this.JOe(wb);this.Jhg(U,()=>{ib.TaskExtensions.za(Vc.task,()=>{this.JOe(wb)},this.ka,3)},()=>{});return Vc.task}QZh(U){U=db.hqd(U,!1);if(!U)return f.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),
null;let Ta=null;var wb=this.Bk.getOsfControl(db.getSolutionId(U,this.$));wb&&(wb=wb.getManifest())&&(Ta=wb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return nc.HelperMethods.upc(Ta)&&(U=this.c4e(U.PrimaryMarketplace.SolutionId,U.PrimaryMarketplace.MarketplaceRef,U.PrimaryMarketplace.MarketplaceType,Ta))?U.controlId:null}ylh(U,Ta){var wb=db.hqd(U,!1);if(wb){var Qb=null,sc=this.Bk.getOsfControl(db.getSolutionId(wb,this.$));sc&&(sc=sc.getManifest())&&(Qb=sc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(nc.HelperMethods.upc(Qb)){wb.SharedRuntime=Qb;var Vc=wb.PrimaryMarketplace.SolutionId;sc=wb.PrimaryMarketplace.SolutionVersion;var Ld=OSF.OsfManifestManager.getCachedManifest(Vc,sc);if(Ld)if(this.W4b.Fb(U))Qb=this.W4b.ma(U),ib.TaskExtensions.za(Qb,Oe=>{(Oe=Oe.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Oe,Ta,this.Hh.wQb)},this.ka,3);else{var le={};le.solutionId=Vc;le.version=sc;le.storeType=wb.PrimaryMarketplace.MarketplaceType;le.storeId=wb.PrimaryMarketplace.MarketplaceRef;
wb.AssetMarketplace?(le.assetId=wb.AssetMarketplace.SolutionId,le.assetStoreId=wb.AssetMarketplace.MarketplaceRef):(le.assetId=null,le.assetStoreId=null);le.targetType=OSF.OsfControlTarget.TaskPane;var Ce=new mb.a;wb=ib.TaskExtensions.zk();wb=new xb.a(this.$,this,le,wb);Qb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Vc,Qb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Ld,Qb,sc);wb.createUILessSandbox(le,Ld,(Oe,ef)=>{Oe&&!ef?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Oe,
Ta,this.Hh.wQb),Ce.setResult(Oe)):Ce.setResult(null);this.W4b.remove(U)});this.W4b.ia(U,Ce.task)}}}else f.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}RIe(U){(U=this.N3e(U))&&(U.Ol.SharedRuntime||this.gOb(U.controlId))}gOb(U){(U=this.N3e(U))&&this.STa(U.controlId)}lzh(U,Ta){if(!this.Vf||!U||!Ta)return!1;if(U.toLowerCase()===Ta.toLowerCase())return!0;let wb=null,Qb=null;for(let sc=0,Vc=this.Vf.length;sc<Vc;sc++){const Ld=this.Vf[sc];if(Ld.ownerAddinSolutionId&&
(Ld.controlId===U&&(wb=Ld.ownerAddinSolutionId.toLowerCase()),Ld.controlId===Ta&&(Qb=Ld.ownerAddinSolutionId.toLowerCase()),wb&&Qb))break}return wb&&wb===Qb?!0:!1}QTg(U){this.Ln(U.InstanceId)||(U=new ob(this,this.Hh,U),this.Vf.push(U),this.cAa=null)}z3f(U){if(this.Vf&&0<=U&&U<this.Vf.length){const Ta=this.Vf[U],wb=Ta.Ez;this.Vf.splice(U,1);this.nKf(Ta);pb.DOMElementExtensions.gg(wb)}}STa(U){if(this.Vf)for(let Ta=0,wb=this.Vf.length;Ta<wb;Ta++)if(this.Vf[Ta].controlId===U){this.z3f(Ta);break}}Bwj(U){if(this.Vf){U=
U.toLowerCase();for(let Ta=0,wb=this.Vf.length;Ta<wb;Ta++)if(U===this.Vf[Ta].ownerAddinSolutionId.toLowerCase()){this.z3f(Ta);break}}}E3g(U){U.zj&&(this.Ln(U.floatingObject.Ol.InstanceId)||(this.emc(U.floatingObject.Ol.InstanceId)||this.owc.push(U.floatingObject.Ol.InstanceId),this.fLa(U.floatingObject.Ol)),this.ea.isNamedObjectViewMode&&this.Z2g(U.floatingObject.Ol.InstanceId,U.qe))}Y3e(U){return null==this.Vf?null:this.Vf.find(Ta=>1===Ta.controlType&&tc.a.equals(Ta.qR,U,!0))}$ca(U){if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return U=
this.Y3e(U),null===U||void 0===U?void 0:U.controlId;if(this.Vf)for(let Ta=0,wb=this.Vf.length;Ta<wb;Ta++)if(1===this.Vf[Ta].controlType&&tc.a.equals(this.Vf[Ta].qR,U,!0))return this.Vf[Ta].controlId;return null}xIi(U){return(U=this.Y3e(U))?U.visible:!1}HSh(U){const Ta=[];if(this.Vf)for(let wb=0,Qb=this.Vf.length;wb<Qb;wb++)tc.a.equals(this.Vf[wb].qR,U,!0)&&Ta.push(this.Vf[wb].controlId);return Ta}mTh(U,Ta){if(!Ta||!U)return null;if(this.Vf)for(let wb=0,Qb=this.Vf.length;wb<Qb;wb++)if(1===this.Vf[wb].controlType&&
tc.a.equals(this.Vf[wb].qR,U,!0)&&this.Vf[wb].Ol.SharedRuntime&&tc.a.equals(this.Vf[wb].Ol.SharedRuntime.Resid,Ta.Resid,!0))return this.Vf[wb].controlId;return null}jNa(U,Ta=null){return U?Ta?`${U}.${Ta}`:U:""}UIe(U,Ta,wb){if(this.cAa===U)return!0;this.cAa=U;let Qb=null,sc=!1;if(!Qb&&this.Vf)for(let Vc=0,Ld=this.Vf.length;Vc<Ld;Vc++)if(1===this.Vf[Vc].controlType&&tc.a.equals(this.Vf[Vc].qR,U,!0)){let le=!1,Ce=!1;Ta?(le=!0,Ce=!!this.Vf[Vc].Ol.SharedRuntime&&tc.a.equals(this.Vf[Vc].Ol.SharedRuntime.Resid,
Ta.Resid,!0)):wb&&(le=!0,Ce=tc.a.equals(this.Vf[Vc].Ol.SharedRuntimeId,wb,!0));if(!le||Ce){Ce&&this.Vf[Vc].Dh(!0);Qb=this.Vf[Vc].controlId;sc=!0;this.cAa=null;break}}Qb&&this.raiseEvent("ca",Qb);return sc}setAppRuntimeState(U,Ta){var wb;if(U){const Qb=this.Ln(U);if(Qb&&nc.HelperMethods.Mx(Qb.Ol))Qb.Dh(Ta),Ta&&(this.raiseEvent("ca",U),(null===(wb=Qb.Ez)||void 0===wb?0:wb.firstChild)&&(U=Qb.Ez.firstChild.title)&&0<U.length&&this.c6b.VJj(U));else throw f.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(Xc.a.instance.ha(2250));}else throw f.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Xc.a.instance.ha(2251));}getAppRuntimeState(U){if(U)if((U=this.Ln(U))&&nc.HelperMethods.Mx(U.Ol))U=U.Ol.TaskpaneVisible;else throw f.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Xc.a.instance.ha(2250));else throw f.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Xc.a.instance.ha(2251));return U}z6a(U,Ta){return(U=this.Ln(U))?U.z6a(Ta):null}A9a(U){return this.WIe(this.owc,U)}emc(U){return this.WIe(this.VQe,U)}Qve(U){this.VQe.push(U)}gW(U){return(U=this.Ln(U))?U.Ol:null}BHd(U){this.raiseEvent("ekros",U,this)}LSf(U){if(U){var Ta=this.Ln(U.InstanceId);Ta&&(U.SharedRuntime||U.SharedRuntimeId||(this.STa(Ta.controlId),this.Lf.purgeOsfControl(Ta.controlId,!1)),Ta={},Ta.SolutionId=U.PrimaryMarketplace.SolutionId,Ta.TargetType=U.WebExtensionType,
Ta.Version=U.PrimaryMarketplace.SolutionVersion,Ta.StoreType=U.PrimaryMarketplace.MarketplaceType,Ta.StoreId=U.PrimaryMarketplace.MarketplaceRef,U.AssetMarketplace?(Ta.AssetId=U.AssetMarketplace.SolutionId,Ta.AssetStoreId=U.AssetMarketplace.MarketplaceRef):(Ta.AssetId=null,Ta.AssetStoreId=null),Ta.Width=U.TaskpaneWidth,Ta.SharedRuntimeId=U.SharedRuntimeId,this.Opg(Ta))}}Xka(){this.Hh.Xka()}pG(U,Ta,wb){this.Hh.pG(U,Ta,wb)}n4e(U,Ta){Ta=db.Mqh(Ta);U=this.gW(U);this.Hh.ofc(U.InstanceId,2202,ld.a.pM,Ta)}Xid(U){for(let Ta=
0,wb=this.Vf.length;Ta<wb;Ta++)this.n4e(this.Vf[Ta].controlId,U)}wTh(U,Ta){Ta=db.dmh(Ta);this.Hh.ofc(U,65539,"",Ta)}ATh(U,Ta,wb){this.Hh.ofc(U,1,Ta,wb)}vTh(U,Ta){this.Hh.BTh(U,Ta)}ulh(U,Ta){return[[2,1E3,"",JSON.stringify([U,Ta]),0,!1]]}Kyi(){return!!this.Npa&&this.Npa.xif()}ceh(){this.Npa&&this.Npa.clear()}xTh(){if(this.Npa&&this.Npa.xif()){var U=this.Npa.TZh();for(const Ta of U){U=this.HSh(Ta);for(const wb of U)this.Hh.ofc(wb,65540,"","{}")}}}etj(U){this.Npa.add(U)}Dbk(U){this.Npa.remove(U)}rla(U){if(!this.Vf)return null;
for(const Ta of this.Vf)if(U(Ta))return Ta;return null}JOe(U){const Ta=new mb.a,wb=db.Dxa(U,this.$);if(nc.HelperMethods.Mx(U))f.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.uVf(U,Qb=>{Qb?(U.InstanceId=Qb.InstanceId,U.WebExtensionOsfControlType=3,U.TaskpaneVisible=!1,this.fLa(U),Ta.setResult(U.InstanceId)):(f.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(U.PrimaryMarketplace.SolutionId,
U.PrimaryMarketplace.MarketplaceType,null,null,null,U.PrimaryMarketplace.MarketplaceRef)} failed`),Ta.setException(Error.create("Null insert data")))});else{db.P4a.ia(U.InstanceId,new V.a);const Qb=db.P4a.ma(U.InstanceId).Dca;this.dnh(U,Qb,wb);this.uVf(U,null);Ta.setResult(U.InstanceId)}return Ta.task}dnh(U,Ta,wb){this.Ln(U.InstanceId)||(U=new ob(this,this.Hh,U),U.nwa=wb,U.hmf(Ta),this.Vf.push(U),this.cAa=null)}uVf(U,Ta){const wb=db.Dxa(U,this.$);if(!this.AMd.contains(wb))this.pMb.push(U),1<=this.pMb.length&&
this.vVf(U,Ta);else if(Ta)for(const Qb of this.xVf)if(db.Dxa(Qb,this.$)===wb){Ta(Qb,0);break}}vVf(U,Ta){let wb=null;const Qb={};Qb.SolutionId=db.getSolutionId(U,this.$);Qb.TargetType=U.WebExtensionType;Qb.Version=U.PrimaryMarketplace.SolutionVersion;Qb.StoreType=U.PrimaryMarketplace.MarketplaceType;Qb.StoreId=U.PrimaryMarketplace.MarketplaceRef;U.AssetMarketplace?(Qb.AssetId=U.AssetMarketplace.SolutionId,Qb.AssetStoreId=U.AssetMarketplace.MarketplaceRef):(Qb.AssetId=null,Qb.AssetStoreId=null);Qb.Width=
U.TaskpaneWidth;Qb.ContainsCustomFunctions=!0;nc.HelperMethods.Mx(U)&&(Qb.SharedRuntimeId=U.SharedRuntime.Resid);const sc=this.$.qa.va;U=this.$.qa.va.Bc();const Vc=sc.Pa(9,U);Vc.sharedInfo=Qb;const Ld=Ce=>{Ce=Fc.a.lf(Ce.data);f.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Bc.a.Ic(Ce)}`)},le=Ce=>{Ce&&!$b.a(Ce)||f.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Qb.SolutionId,
Qb.StoreType,Qb.AssetId,null,null,Qb.StoreId)} finish with errors: ${Bc.a.Ic(Ce.Errors)}`);this.pMb.shift();0<this.pMb.length&&this.vVf(this.pMb[0],Ta)};if(Ta){const Ce=Oe=>{const ef=Oe.Result;(wb=ef?ef.AgaveData:null)||Ta(null,Oe.Errors?Oe.Errors[0].ErrorCause:5001);Ta(wb,0)};U=(Oe,ef,uf)=>bc.g(sc,"InsertAgaveTaskpane",Vc,qd.b(Oe,le,Ce),qd.a(ef,Ld),uf,null,0)}else U=(Ce,Oe,ef)=>bc.g(sc,"InsertAgaveTaskpane",Vc,qd.b(Ce,le),qd.a(Oe,Ld),ef,null,0);Ac.a(this.$.userOperationManager,U,Ce=>new Cb.a(519,
0,Ce,64),null)}$Tj(){return this.$.Ne.get(35)}PRd(U){U=this.Ln(U);(null===U||void 0===U?0:U.cga)&&U.I3f()}eZi(U){var Ta=this.rla(wb=>db.wPa(wb.qR));Ta&&(Ta=this.Lf.getOsfControl(Ta.controlId))&&Ta.notifyAgave(OSF.AgaveHostAction.SendMessage,U)}zzi(){return!!this.rla(U=>1===U.controlType&&db.wPa(U.qR))}yzi(){const U=this.rla(Ta=>db.wPa(Ta.qR));return U?U.Ez?pb.DOMElementExtensions.isVisible(U.Ez):!1:!1}kNj(){const U=this.rla(Ta=>db.wPa(Ta.qR));U&&(U.Dh(!0),this.raiseEvent("ca",U.controlId))}initialize(U){const {DdaEventDispatch:Ta}=
a(1424),wb=void 0===this.$||null===this.$||na.EwaSettings.ya(234);void 0!==this.$&&null!==this.$||f.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");wb&&f.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(nf.FJa(this.$),this.ea=this.$.ea,this.Hh=new Ta(this.$),this.$.Ql(this.Td),this.ea.pk(this.zd),this.ea.DK(this.Tn),this.ea.nv(this.fg),this.$.userOperationManager.ks(this.QS),this.Qyf(),
this.M8i(),this.Bti(),this.$.da.Ja(35,this),this.s3c.la(this),wb&&f.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Fpe=new ld.a,wb&&f.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Ipe=new dc(this.$,this.Vh,this.Hh),new ad(this.$,this.Vh,this.Hh),this.Gpe=new Sd(this.$,this.Vh,this.Hh),this.Epe=new ic(this.$,this.Vh,this.Hh),this.Dpe=new Jd(this.$,this.Vh,this.Hh),this.Hpe=new Kc(this.$,this.Vh,this.Hh),this.Jpe=
new Qd(this.$,this.Vh,this.Hh),this.Kpe=new Zb(this.$,this.Vh,this.Hh),this.$.WW&&(this.Lpe=new Nd(this.$,this.Vh,this.Hh)),this.Mpe=new nd(this.$,this.Vh,this.Hh,U),na.EwaSettings.ya(178)&&(this.X4a=new Gb(this,Ea.h(this.$))),na.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Cpe=new Tb),this.Bpe=new Ff(this.$,this.Vh,this.Hh),this.initialized=!0,f.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}rTh(U){if(!this.dFa)return null;for(let Ta=
0,wb=this.dFa.length;Ta<wb;Ta++)if(U.startsWith(this.dFa[Ta].WebExtensionId))return this.dFa[Ta];return null}Qyf(){var U,Ta=this.ea;if(Ta.Ec&&!this.VVb){if(Ta.workbookContext){if(this.$_c=this.$.ea.oh.get(22),null===(U=Ta.workbookContext.WebExtensions)||void 0===U?0:U.length){U=Ta.workbookContext.WebExtensions;Ta=!1;for(let wb=U.length-1;0<=wb;wb--){if(!this.ea.isNamedObjectViewMode){this.owc.push(U[wb].InstanceId);if(1!==U[wb].WebExtensionType){U.splice(wb,1);continue}if(nc.HelperMethods.Mx(U[wb])&&
0!==U[wb].SharedRuntime.State)1===U[wb].SharedRuntime.State?U[wb].TaskpaneVisible=!1:2===U[wb].SharedRuntime.State?U[wb].TaskpaneVisible=!0:f.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!U[wb].ContainsCustomFunctions&&!U[wb].TaskpaneVisible&&!Lb.a(U[wb])){U.splice(wb,1);continue}}const Qb=OSF.OsfControl.isFirstPartyStoreString(U[wb].PrimaryMarketplace.MarketplaceType);if(na.EwaSettings.ya(174)&&!Qb&&(U.splice(wb,1),!Ta)){Ta=!0;const sc=Object($a.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?
Object(Nb.d)(rb.a.resolve(ec.h,{Wa:3})):Pa.GetServiceTaskFactory.Za(this.$.da,5,4,3);ib.TaskExtensions.za(sc,()=>{sc.result.zh(36,null)},this.ka,3)}na.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&U[wb].PrimaryMarketplace&&db.wPa(U[wb].PrimaryMarketplace.SolutionId)&&(f.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),U.splice(wb,1))}this.fOe(U)}}else this.$_c=!1;this.VVb=!0}}Vgf(U){const Ta=Ea.h(this.$),
wb=Ta.ga.Sa.Fc;if(wb&&U){U=!1;if(this.Vf)for(const Qb of this.Vf)if(db.wPa(Qb.qR)||db.ZCi(Qb.qR)){U=!0;break}U||Ta.ga.Sa.uI(wb)}}M8i(){this.Lf&&this.ea.isNamedObjectViewMode&&this.$.na&&bf.o(this.$.na)&&(this.$.da.Ba(34).nS?this.$.da.Ba(34).gud():this.$.da.Ba(34).jt(this.Mdj))}fOe(U){let Ta=null;Ta=wb=>{const Qb=wb.WebExtensionData,sc=wb.IsTaskPane,Vc=wb.RecordHandler,Ld=()=>{this.QSa.shift();0<this.QSa.length&&Ta(this.QSa[0])};if(this.$ca(Qb.PrimaryMarketplace.SolutionId))Ld();else{sc&&(Qb.WebExtensionOsfControlType=
1);var le=Lb.a(Qb);if(!sc||Qb.TaskpaneVisible||le||Qb.SharedRuntime&&0!==Qb.SharedRuntime.State||Qb.ContainsCustomFunctions){var Ce=new ob(this,this.Hh,Qb,!sc);f.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Qb.PrimaryMarketplace.SolutionId,Qb.PrimaryMarketplace.MarketplaceType,null,null,null,Qb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Qb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${nc.HelperMethods.Mx(Qb)}`);
Ce.Std();nc.HelperMethods.Mx(Qb)&&(Ce.nwa=db.Dxa(Qb,this.$),Qb.TaskpaneWidth=this.nxb);le&&(Qb.WebExtensionToolTip="");!na.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&sc&&Qb.TaskpaneVisible&&!le&&(Qb.TaskpaneWidth=this.nxb);this.Vf.push(Ce);var Oe=this.cAa=null;Oe=Tc.a.instance.ZD(()=>{Ce.Ez&&(nb.a.Ka(Oe),Oe=null,Vc&&Vc(wb,Ce),Ld())},100,gd.a.$th)}else Ld()}};for(let wb=0;wb<U.length;wb++){if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Qb=
U[wb].WebExtensionType===OSF.OsfControlTarget.TaskPane,sc=Lb.a(U[wb]);Qb&&!sc&&(U[wb].TaskpaneWidth=this.nxb)}if(!this.Ln(U[wb].InstanceId))if(1!==U[wb].WebExtensionType)this.fLa(U[wb]);else if(!na.EwaSettings.ya(52))this.hrb(U[wb],Ta);else if(this.$.$d&8388608||U[wb].TaskpaneVisible){const Qb={};Qb.solutionId=U[wb].PrimaryMarketplace.SolutionId;Qb.version=U[wb].PrimaryMarketplace.SolutionVersion;Qb.storeType=U[wb].PrimaryMarketplace.MarketplaceType;Qb.storeId=U[wb].PrimaryMarketplace.MarketplaceRef;
Qb.targetData=U[wb];this.Lf.isAddinCommandsAsync(Qb,(sc,Vc,Ld)=>{if(sc){var le=Ld.targetData;if(Vc)if(Qb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())sc=Qb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Vc=Qb.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(sc||Vc)&&nc.HelperMethods.Mx(le)&&this.hrb(le,Ta);else if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.Cli(Ld,Ta);else{let Ce=
!1;this.$Od(Oe=>{if(!Oe.errorCode){if(Oe.value)for(const ef of Oe.value){if(Ce)break;Ce=ya.e(ef[1])===ya.e(le.PrimaryMarketplace.SolutionId)}Ce?nc.HelperMethods.Mx(le)&&this.hrb(le,Ta):(Oe={},Oe.SolutionId=Ld.solutionId,Oe.Version=Ld.version,Oe.StoreType=le.PrimaryMarketplace.MarketplaceType,Oe.StoreId=Ld.storeId,Oe.AssetId=null,Oe.AssetStoreId=null,Oe.Width=le.TaskpaneWidth,Oe.TargetType=le.WebExtensionType,le.TaskpaneVisible=!0,this.Bue(Oe,le,Ta))}},!0)}else this.hrb(le,Ta)}else sc=Ld.targetData,
f.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(sc.PrimaryMarketplace.SolutionId,sc.PrimaryMarketplace.MarketplaceType,null,null,null,sc.PrimaryMarketplace.MarketplaceRef)} from ${sc.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}Cli(U,Ta){let wb=!1;this.$Od(Qb=>{const sc=U.targetData;if(!Qb.errorCode){if(Qb.value)for(const Vc of Qb.value){if(wb)break;wb=ya.e(Vc[1])===ya.e(sc.PrimaryMarketplace.SolutionId)}wb?
nc.HelperMethods.Mx(sc)&&this.hrb(sc,Ta):(Qb={},Qb.SolutionId=U.solutionId,Qb.Version=U.version,Qb.StoreType=sc.PrimaryMarketplace.MarketplaceType,Qb.StoreId=U.storeId,Qb.AssetId=null,Qb.AssetStoreId=null,Qb.TargetType=sc.WebExtensionType,Qb.Width=sc.TaskpaneWidth,sc.TaskpaneVisible=!0,this.Bue(Qb,sc,Ta))}},!0)}hrb(U,Ta){const wb={};wb.WebExtensionData=U;wb.IsTaskPane=!0;this.QSa.push(wb);1===this.QSa.length&&Ta(wb)}Bue(U,Ta,wb){const Qb={};Qb.ActivationInfo=U;Qb.WebExtensionData=Ta;Qb.IsTaskPane=
!1;Qb.RecordHandler=(sc,Vc)=>{const Ld=sc.ActivationInfo;this.Lf.insertBlankControlWithErrorUX(this.NMb(Vc,Ld),()=>{this.STa(Vc.controlId);this.Lf.purgeOsfControl(Vc.controlId,!1);this.Opg(Ld)})};this.QSa.push(Qb);1===this.QSa.length&&wb(Qb)}Opg(U){var Ta={};Ta.solutionId=U.SolutionId;Ta.version=U.Version;Ta.storeType=U.StoreType;Ta.storeId=U.StoreId;Ta.assetId=U.AssetId;Ta.assetStoreId=U.AssetStoreId;Ta.targetType=U.TargetType;Ta.sharedRuntimeId=U.SharedRuntimeId;U=new L.a;U.add(Ta);Ta={};Ta[aa.a.osb]=
U;Ta[aa.a.mN]=3;U=new Kb.a(Xe.a.EHb,0,this.$.Kc,0,null);this.$.Ia.$b(U,Ta)}NMb(U,Ta){const wb={};wb.div=U.Ez;wb.id=U.controlId;wb.solutionId=Ta.SolutionId;wb.version=Ta.Version;wb.storeId=Ta.StoreId;wb.storeType=Ta.StoreType;wb.osfControlType=OSF.OsfControlTarget.TaskPane;return wb}z7f(){if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const wb=[];for(var U=0;U<this.Vf.length;U++){var Ta=this.Vf[U];0!==Ta.osfControlType&&3!==Ta.osfControlType&&4!==Ta.osfControlType||
wb.push(Ta)}U=!1;for(Ta=0;Ta<wb.length;Ta++){const Qb=wb[Ta];this.STa(Qb.controlId);!U&&Qb&&Qb.Ol&&(U=nc.HelperMethods.Mx(Qb.Ol))}U&&this.BL(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}na.EwaSettings.ya(355)&&ib.TaskExtensions.za(Pa.GetServiceTaskFactory.Za(this.$.da,278,279,3),wb=>{wb&&(wb=wb.result)&&(this.$.da.Ba(278)||this.$.da.Ja(278,wb),wb.knf().Rpa())},this.ka,3)}mM(){var U=new $d(this.$,this.Vh,this.L8f);void 0===this.$||null===this.$?f.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):
na.EwaSettings.ya(234)&&f.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Vh||null===this.Vh));if(U.XXi()){const Ta=()=>{},wb=sc=>{sc=Fc.a.lf(sc.data);f.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Bc.a.Ic(sc)}.`)},Qb=U.u8g();U=db.iod(Qb);U|=64;this.$.userOperationManager.lG(new Cb.a(507,0,(sc,Vc,Ld)=>bc.g(this.$.qa.va,"ExecuteRichApiRequest",
this.v8g(Qb),qd.b(sc,Ta),qd.a(Vc,wb),Ld,null,0),U))}}v8g(U){const Ta=this.$.qa.va.Pa(1);Ta.request=U;return Ta}WIe(U,Ta){if(U)for(let wb=0;wb<U.length;wb++)if(tc.a.equals(U[wb],Ta,!0))return!0;return!1}w7g(U){const Ta={};Ta.navigationMode=OSF.OsfNavigationMode.DefaultMode;Ta.assetId=null;Ta.category=null;if(!U||3>U.length)return Ta;if(U[0]){const wb=parseInt(U[0],10);isNaN(parseInt(wb,10))||(Ta.navigationMode=wb)}U[1]&&(Ta.assetId=U[1]);U[2]&&(Ta.category=U[2]);return Ta}Bti(){if(na.EwaSettings.ya(60)){var U=
this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(U&&"*"!==U.trim()){this.cMa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new cb(this),U,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Ne.get(2));try{this.cMa.init()}catch(Ta){try{this.cMa.dispose()}catch(wb){}this.cMa=null;f.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Ta.message)}U={};U.a=this.$.xa.UserSessionId;Xd.b().Df(39,U)}}}Jhg(U,Ta,wb){const Qb=db.J6g(U[0]),
sc=Qb.Kja,Vc=Qb.Lka;Qb.Kja=()=>{sc&&sc();const Ld=Qb.$Oa!==OSF.InfoType.Error?Ta:null;U.shift();U.length?this.Jhg(U,Ld,wb):Ld&&Ld()};Qb.Lka=()=>{Vc&&Vc();wb&&Qb.$Oa!==OSF.InfoType.Error&&wb()};ia.a.N_d(Qb)}z7h(){const U={};U.AddinRibbonControlsOverriddenByApi=na.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();U.AddinActionDefinitionHybridMode=na.EwaSettings.ya(556).toString();U.UseActionIdForUILessCommand=na.EwaSettings.ya(559).toString();U.AllowStorageAccessByUserActivationOnIFrame=
na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();U.RequirementSetRibbonApiOnePointTwo=na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();U.flightingTreatmentVariables=w.AFrameworkApplication.fa.xfc;U.ShortcutInfoArrayInUserPreferenceData=na.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();U.DisabledChangeGates=
w.AFrameworkApplication.fa.Va("DisabledChangeGates");U.DmsSdxListWorkbook=w.AFrameworkApplication.CUe;return U}static get l$b(){return db.Xce}static set l$b(U){db.Xce=U}static getSolutionId(U){let Ta=U.PrimaryMarketplace.SolutionId;na.EwaSettings.ya(261)&&U.OwnerAddinSolutionId&&(Ta=U.OwnerAddinSolutionId);return Ta}static iod(U){let Ta=0;na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?U.RequestFlags&1&&256!==(U.RequestFlags&256)||(Ta=16):Ta=U.RequestFlags&
1?0:16;return Ta}static Dxa(U,Ta){Ta=db.getSolutionId(U,Ta);return db.C9e(Ta,U.PrimaryMarketplace.SolutionVersion,U.PrimaryMarketplace.MarketplaceType,U.PrimaryMarketplace.MarketplaceRef)}static Mqh(U){return JSON.stringify({["recording"]:U})}static dmh(U){const Ta={};Ta.visibility=U?"Visible":"Hidden";return JSON.stringify(Ta)}static y3h(U){let Ta=U.getSolutionId(),wb=U.getVersion(),Qb=U.getStoreType();U=U.getStoreId();return db.C9e(Ta,wb,Qb,U)}static C9e(U,Ta,wb,Qb){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",U,Ta,db.jfi(wb).toString(),Qb)}static hqd(U,Ta){var wb=U.split("|");if(7>wb.length)return f.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==wb[0])return f.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${wb[0]}'.`),null;let Qb=wb[1];const sc=wb[2],Vc=db.kfi(wb[3]),Ld=wb[4];wb=wb[5];Qb&&Qb.length||(Qb=wb);wb={};wb.InstanceId=String.format("{{{0}}}",P.a.create().toString());
wb.WebExtensionOsfControlType=4;wb.WebExtensionType=1;wb.PrimaryMarketplace={};wb.PrimaryMarketplace.SolutionId=Qb;wb.PrimaryMarketplace.SolutionVersion=sc;wb.PrimaryMarketplace.MarketplaceRef=Ld;wb.PrimaryMarketplace.MarketplaceType=Vc;wb.ContainsCustomFunctions=Ta?!0:!1;Ta&&(wb.OsfPropertyBag=[["customFunctionAddinId",U]]);return wb}static kfi(U){U=parseInt(U,10);return U===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:U===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:U===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:U===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:U===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:U===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:U===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:U===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:U===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:U===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:U===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:
null}static jfi(U){return U===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:U===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:U===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:U===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:U===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:U===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:U===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:U===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:U===OSF.StoreType.FirstParty?
OSF.StoreTypeEnum.FirstParty:U===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:U===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}bwa(U){const Ta={};Ta.Version=U.version;Ta.AssetId=U.assetId;Ta.AssetStoreId=U.assetStoreId;Ta.StoreType=U.storeType;Ta.Height=U.height;Ta.SolutionId=U.solutionId;Ta.StoreId=U.storeId;Ta.TargetType=U.targetType;Ta.Width=1===Ta.TargetType?0:U.width;Ta.SharedRuntimeId=U.sharedRuntimeId;return Ta}static OEb(U){return U===OSF.DDA.EventDispId.dispidSettingsChangedEvent||
U===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||U===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||U===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||U===OSF.DDA.EventDispId.dispidRichApiMessageEvent||U===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||U===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||U===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static J6g(U){return Object(b.a)(new pf.a,{$Oa:U.infoType,id:U.id,title:U.title,description:U.description,
buttonText:U.buttonTxt,Kja:U.buttonCallback,Ekc:U.highPriority,Lka:U.dismissCallback,errorCode:U.errorCode,ulf:U.iframeNotificationUrl})}static wPa(U){let Ta="FA000000014"===U;Ta||(Ta="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===U);return Ta}static ZCi(U){return"FA000000005"===U}}db.P4a=new B.a;db.Xce=!0;Object(c.a)(db,"DdaFacade",sb.a,[218,693,691,694,695,2])},796:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{constructor(b,f,e,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=
this.controlId=null;this.dispid=b;this.controlId=f;this.ddaBinding=e;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(u.a)(c,"DdaEventArgs",null,[])},850:function(u,C,a){u=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(u.a)(c,"AddInDataTransferObject",null,[]);a.d(C,"a",function(){return b});class b{constructor(f,e,d){this.tWb=f;this.rCg=e;this.sCg=d}get ou(){return this.tWb}get lTg(){return this.rCg}get mTg(){return this.sCg}static X6a(f){return(f=
f.BX)?Object.assign(new c,{tabs:f.ou.toArray(),id:f.lTg,title:f.mTg}):null}}Object(u.a)(b,"OneLineRibbonExtensibility",null,[])},855:function(u,C,a){a.d(C,"a",function(){return c});a.d(C,"b",function(){return b});const c=f=>{let e=null;switch(f){case 0:e="omex";break;case 1:e="spcatalog";break;case 2:e="spapp";break;case 3:e="filesystem";break;case 4:e="exchange";break;case 6:e="registry";break;case 7:e="inmemory";break;case 8:e="uploadfiledevcatalog";break;case 9:e="hardcodedpreinstall";break;case 10:e=
"excatalog";break;case 16:e="wopicatalog"}return e},b=f=>{let e=-1;switch(f.toLowerCase()){case "omex":e=0;break;case "spcatalog":e=1;break;case "spapp":e=2;break;case "filesystem":e=3;break;case "exchange":e=4;break;case "registry":e=6;break;case "inmemory":e=7;break;case "uploadfiledevcatalog":e=8;break;case "hardcodedpreinstall":e=9;break;case "excatalog":e=10;break;case "wopicatalog":e=16}return e}},858:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{}Object(u.a)(c,"GetEntitlementDetailsParameters",
null,[])},887:function(u,C,a){a.r(C);u=a(0);var c=a(199),b=a(15),f=a(106);class e{constructor(){this.startTime=0;this.callback=null}}Object(u.a)(e,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(u.a)(d,"AccessTokenInformation",null,[81]);var h=a(1009);class l{constructor(){this.token=null;this.expiresOn=0;this.vja=this.authChallenge=null}}Object(u.a)(l,"CachedTokenInfo",null,[]);class k{constructor(){this.YWb=new c.a;this.qba=this.pba=!1;this.ira=this.authChallenge=
null;this.startTime=this.retryCount=0;this.jze=null}get callbacks(){return this.YWb}}Object(u.a)(k,"SSORequestInfo",null,[]);class n extends k{constructor(){super();this.errorCode=0}}Object(u.a)(n,"SSOFailedRequestInfo",k,[]);var v=a(6);class x{constructor(O,M,P,B){this.BU=new c.a;this.NH=new c.a;this.osa=null;this.Bpb=new c.a;this.gke=Promise.resolve(null);this.rre=!1;this.Y0b=M;this.bGa=O;this.Ure=P;this.wCg=B}lVj(O){if(this.osa&&this.osa.authChallenge===O.authChallenge){if(Date.now()/1E3+x.yUi>
this.osa.expiresOn)return this.osa=null,!1;O=new h.a;O.token=this.osa.token;O.expiresOn=this.osa.expiresOn;O.vja=this.osa.vja;O.TWa=!0;O.TBb=0;this.mCb(O);return!0}return!1}DTj(O){for(let M=0;M<this.NH.count;M++)if(this.NH.ma(M).authChallenge===O.authChallenge&&this.NH.ma(M).ira===O.ira){let P;(P=this.NH.ma(M)).retryCount=P.retryCount+1;O.retryCount=this.NH.ma(M).retryCount;if(this.NH.ma(M).retryCount<x.VUi||!this.NH.ma(M).pba&&O.pba||!this.NH.ma(M).qba&&O.qba){if(!this.NH.ma(M).pba&&O.pba||!this.NH.ma(M).qba&&
O.qba)O.retryCount=0;this.NH.removeAt(M);break}O=new h.a;O.errorCode=this.NH.ma(M).errorCode;this.mCb(O);return!0}return!1}dVg(O,M){for(let P=0;P<this.NH.count;P++)if(this.NH.ma(P).ira===O.ira&&this.NH.ma(P).authChallenge===O.authChallenge)return;this.NH.add(Object.assign(new n,{pba:O.pba,qba:O.qba,authChallenge:O.authChallenge,ira:O.ira,errorCode:M,retryCount:O.retryCount}))}get resource(){return this.Y0b}Xkd(O,M,P,B,D,I){const {AppsForOfficeSingleSignOnManager:S}=a(887);""===P&&(P=null);if(this.rre)S.b8(I,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var J=null;for(let L of this.BU)if(L.pba===O&&L.qba===M&&L.authChallenge===P&&L.ira===D){J=L;break}J||(J=Object.assign(new k,{pba:O,qba:M,authChallenge:P,jze:B,ira:D,retryCount:0,startTime:S.Jx()}),this.BU.add(J));J.retryCount=0;J.callbacks.add(I);this.gke=this.gke.then(()=>{var {AppsForOfficeSingleSignOnManager:L}=a(887);if(0<this.BU.count){var R=this.BU.ma(0);if(this.lVj(R)||this.DTj(R))return null;for(let Q=0;Q<this.Bpb.count;)this.Bpb.ma(Q)+
x.W5j<L.Jx()?this.Bpb.removeAt(Q):Q++;if(this.Bpb.count>=x.RUi||this.BU.count>=x.tUi)return R=new h.a,R.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.mCb(R),null;let Y=null;v.AFrameworkApplication.sa&&(L=v.AFrameworkApplication.sa.hF)&&(Y=L.qd("ComponentAttach",this.bGa+x.EOg));return R.ira.fRg(this.resource,R.pba,R.qba,R.authChallenge,this.wCg,R.jze).then(Q=>{Y&&Y.stop();this.mCb(Q)},()=>{Y&&Y.stop();const Q=new h.a;Q.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
this.mCb(Q)})}return null})}}mCb(O){const {AppsForOfficeSingleSignOnManager:M}=a(887);try{if(this.BU.count){var P=this.BU.ma(0);this.BU.removeAt(0);var B=null;O.errorCode||(B=new d,B.accessToken=O.token);O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.dVg(P,O.errorCode);
var D={};null!=O.TBb&&(D.getTokenSilentTime=O.TBb.toString());null!=O.Npd&&(D.getTokenPopupTime=O.Npd.toString());null!=O.tnd&&(D.getIDTokenTime=O.tnd.toString());null!=O.TWa&&(D.tokenCached=O.TWa.toString());O.D3d&&(D.detailedError=O.D3d);O.vja&&(D.authLibrary=O.vja);P.retryCount&&(D.retryCount=P.retryCount);for(var I of P.callbacks)M.b8(I,O.errorCode,B,D);null!=O.TWa&&O.TWa||this.Bpb.add(P.startTime);if(!O.errorCode)for(null!=O.expiresOn&&(this.osa=Object.assign(new l,{token:O.token,expiresOn:O.expiresOn,
authChallenge:P.authChallenge,vja:O.vja})),this.NH.clear(),I=0;I<this.BU.count;)if(this.BU.ma(I).authChallenge===P.authChallenge){for(let S of this.BU.ma(I).callbacks)M.b8(S,O.errorCode,B,D);this.BU.removeAt(I)}else I++}}catch(S){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",S.message)}}shutdown(){this.rre=!0;this.BU.clear()}}x.W5j=6E4;x.RUi=6;x.tUi=6;x.VUi=3;x.yUi=300;x.EOg="GetAccessToken";Object(u.a)(x,"SSOCallbackManager",null,[]);var w=a(741),r=a(567),
t=a(114),A=a(82),y=a(31),z=a(34),E=a(173),G=a(355);a.d(C,"AppsForOfficeSingleSignOnManager",function(){return F});class F{constructor(O,M,P=null){this.mMc=new f.a;const B=new c.a;M&&B.add(M.VSi);P&&B.addRange(P);this.Bk=O;this.JPg=B}Ykd(O,M,P,B,D,I,S,J,L,R){R=Object.assign(new e,{startTime:F.Jx(),callback:R});try{const W=!!P&&""!==P;var Y=R.startTime;const Ga=this.getOsfControl(O);let pa=Ga.getStoreType()||"",aa=Ga.getOwnerAddinStoreType()||"",Z=Ga.getSolutionId()||"";const fa=Ga.getVersion()||"";
pa=pa.toLowerCase();aa=aa.toLowerCase();Z=Z.toLowerCase();var Q=A.a.snd(M)||"";const ya=A.a.snd(Ga.getIframeUrl())||"",Aa=Q.toLowerCase()===ya.toLowerCase();Q=pa;"inmemory"===pa&&(Q=aa);const ja=Telemetry.PrivacyRules.GetPrivacyCompliantId(Z,Q,Ga.getAssetId(),null,null,Ga.getStoreId()),za={["callInstanceId"]:Y.toString(),["controlSolutionId"]:ja,["controlVersion"]:fa,["storeType"]:pa,["ownerStoreType"]:aa,["allowConsentPrompt"]:B.toString(),["forMSGraphAccess"]:D.toString(),["allowSignInPrompt"]:I.toString(),
["hasAddinAuthChallenge"]:W.toString(),["securityOriginEqualsSourceLocation"]:Aa.toString(),["singleSignOnEnabled"]:S.toString(),["accountTypeFilter"]:J||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",za);E.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:t.a.Yh(za)}));Y=!0;const ra=v.AFrameworkApplication.fa.Va("HostAuthType");switch(J){case "aad":Y="aad"===ra;break;case "msa":Y="msa"===ra;break;default:Y=!J||"noFilter"===J}if(Y){J=
null;if(S)for(let fb of this.JPg)if(fb.gBi(Z)){J=fb;break}J?this.isSSOAddin(O)?(S=!0,"omex"===Q&&(S=!1),"spapp"===Q||"spcatalog"===Q?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),F.b8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):D&&!S?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),F.b8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)):(D&&"exchange"===Q&&(B=!1),this.Xkd(O,M,P,Q,B,I,L,J,R))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),F.b8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):F.b8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else F.b8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(W){this.crc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
W.message),F.b8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(O,M,P,B){this.Ykd(O,P[w.a.c3c]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,M,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,B)}Xkd(O,M,P,B,D,I,S,J,L){this.mMc.Fb(O)?B=this.mMc.ma(O):(B=new x(O,this.getWebApplicationResource(O).split(",")[0],B,this.getDefaultDisplayName(O)),this.mMc.add(O,B));const R=B.resource;O=F.Wci(R,this.getWebApplicationId(O));const Y=OfficeExt.WACUtils.getHostSecure(M);O&&Y?O.toLowerCase()===Y.toLowerCase()?B.Xkd(D,I,P,S,J,L):(F.hRa('SSO Resource "'+R+'" cannot be used from "'+M+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),F.b8(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(O||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Y||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),F.b8(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}crc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(O){return this.Bk.getOsfControl(O)}isSSOAddin(O){return this.getOsfControl(O).getManifest().isSSOAddin()}getWebApplicationId(O){return this.getOsfControl(O).getManifest().getWebApplicationId()}getWebApplicationResource(O){return this.getOsfControl(O).getManifest().getWebApplicationResource()}getDefaultDisplayName(O){return this.getOsfControl(O).getManifest().getDefaultDisplayName()}static Iei(){try{const O=
{};y.a.Wza&&r.OAuthManagerSettings.eDb&&(O.UiHostSupportsAuthTokenAddinList=F.w4e);O.UiHostSupportsAuthToken=r.OAuthManagerSettings.eDb;return O}catch(O){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",O.message)}return null}static getInstance(O,M,P=null){F.Oa||(F.Oa=new F(O,P));return F.Oa}static hRa(O){window.console.warn&&window.console.warn(O)}static Wci(O,M){if(!O)return"";M||(M="");let P=O.toLowerCase();var B=M.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(B)||
(F.hRa('SSO App Id "'+M+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));P.endsWith(B)||(F.hRa('SSO Resource "'+O+'" does not end with App Id "'+M+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!P.startsWith("https://")&&!P.startsWith("api://"))return F.hRa('SSO Resource "'+O+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(M=0;M<O.length;M++){B=O.charAt(M);const D=z.a.charCodeAt(O,M);if(33>D||126<D||"&"===B||"?"===B||"#"===B||"%"===B||"\\"===B)return F.hRa('SSO Resource "'+O+'" contains an invalid character "'+B+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+B+"' in resource URI."),""}if(0<=O.indexOf("::"))return F.hRa('SSO Resource "'+O+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
O.length)return F.hRa('SSO Resource "'+O+'" is '+O.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+O.length+"."),"";P.startsWith("api://")&&(P="https://"+P.substring(6,P.length));return 8===P.length?"":OfficeExt.WACUtils.getHostSecure(P)||""}static b8(O,M,P,B){var D=O.startTime;let I=0;0<D&&(I=F.Jx()-D);D={["callInstanceId"]:D.toString(),["callDuration"]:I.toString(),["errorCode"]:M.toString()};if(B)for(let S in B)D[S]=
B[S];b.ULS.sendTraceTag(51401116,344,50,"{0}",D);E.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:t.a.Yh(D)}));O.callback(M,P)}static Jx(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(O){}return Date.now()}}F.w4e="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");F.Oa=null;Object(u.a)(F,
"AppsForOfficeSingleSignOnManager",null,[38])},904:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);var c;(function(b){b[b.myAddins=0]="myAddins";b[b.adminManaged=1]="adminManaged";b[b.popular=2]="popular"})(c||(c={}));Object(u.b)("AddinCollectionType",c)},905:function(u,C,a){a.d(C,"a",function(){return b});u=a(0);var c=a(16);class b{constructor(){this.M1e={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};
this.K1e={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ha(1633),c.a.instance.ha(1637)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ha(1634),c.a.instance.ha(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ha(1635),c.a.instance.ha(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ha(1636),c.a.instance.ha(1640)]};this.kec=null}get lka(){return"SourceControlId"}get eO(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}A9h(){if(!this.kec){this.kec={};for(const f of Object.keys(this.M1e))this.kec[f]=
this.M1e[f];for(const f of Object.keys(this.K1e))this.kec[f]=this.K1e[f][0]}}}Object(u.a)(b,"AddinCommandsStringProvider",null,[754])},906:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.notReady=1]="notReady";b[b.storeDisabled=2]="storeDisabled";b[b.invokeFailure=3]="invokeFailure"})(c||(c={}));Object(u.b)("AddinDetailsQueryError",c)},908:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{constructor(){this.$Oa=0;this.Kja=this.buttonText=this.description=
this.title=this.id=null;this.errorCode=0;this.Ekc=!1;this.ulf=this.Lka=null}}Object(u.a)(c,"AddInCommandsNotificationParameters",null,[])},981:function(u,C,a){u=a(0);var c=a(15),b=a(88),f=a(165),e=a(14),d=a(93);class h extends Sys.UI.Control{constructor(B,D,I,S){super(document.createElement("div"));this.fU=this.dU=this.jx=this.HH=this.SH=this.hsa=this.Eta=null;this.jnb=this.Wsa=!1;this.content=this.vq=null;this.h3=0;this.aEe=null;this.hV=0;this.CRf=null;this.qse=B;this.Dne=D;this.FQ=I;this.PK=S;this.Sg=
D.ownerDocument;this.ckc=this.Iu=this.Dnb=!1}get DX(){this.Eta||(this.Eta=this.Sg.createElement("div"),this.Eta.id=this.wi("WACCalloutOuter"),this.Eta.className="WACCalloutOuter",this.Eta.setAttribute(d.a.fe,d.a.ftb),this.Eta.style.width=this.h3+"px");return this.Eta}get Htb(){if(!this.hsa){this.hsa=this.Sg.createElement("div");this.hsa.id=this.wi("WACCalloutBeakContainer");this.hsa.className="WACCalloutBeakContainer";var B="CalloutBeakTopFilled_32x16x32";if(5===this.hV||6===this.hV||4===this.hV)B=
"CalloutBeakBottomFilled_32x16x32";B=f.createClusteredImage(32,16,B,"WACCalloutBeak",!0,"");this.hsa.appendChild(B)}return this.hsa}set Htb(B){this.hsa=B}get DPa(){return this.Dnb}get title(){return this.vq}set title(B){this.vq!==B&&(this.vq=B,this.dU&&(this.dU.innerText=this.vq))}get Iu(){return this.Wsa}set Iu(B){this.Wsa!==B&&(this.Wsa=B,this.SH&&(this.SH.contains(this.jx)&&!this.Wsa?this.SH.removeChild(this.jx):!this.SH.contains(this.jx)&&this.Wsa&&this.Jve()))}get ckc(){return this.jnb}set ckc(B){this.jnb!==
B&&(this.jnb=B,this.SH&&(this.SH.contains(this.dU)&&!this.jnb?this.SH.removeChild(this.dU):!this.SH.contains(this.dU)&&this.jnb&&this.bxe()))}show(){this.Dnb||(this.vnh(),this.hn(),this.Dne.appendChild(this.DX),this.DX.style.display="Block",this.qQj(),this.Dnb=!0,this.CRf&&this.CRf())}dismiss(){this.Dnb&&(this.Cca(),this.Dne.removeChild(this.DX),this.Dnb=!1,this.PK&&this.PK())}dispose(){this.dismiss();this.dU=this.jx=this.HH=this.hsa=this.SH=this.Eta=null;Sys.Component.prototype.dispose.call(this)}wi(B){return this.get_element().id+
B}vnh(){this.SH=this.Sg.createElement("div");this.SH.id=this.wi("WACCalloutHeader");this.SH.className="WACCalloutHeader";this.Iu&&this.Jve();this.ckc&&this.bxe();this.HH=this.Sg.createElement("div");this.HH.id=this.wi("WACCalloutContent");this.HH.className="WACCalloutContent";this.HH.style.width=190<this.h3?this.h3-26+"px":"164px";this.HH.appendChild(this.content);this.DX.appendChild(this.Htb);this.DX.appendChild(this.SH);this.DX.appendChild(this.HH)}Jve(){this.jx=this.Sg.createElement("a");this.jx.className=
"WACCalloutCloseAnchor";this.jx.id=this.wi("WACCalloutCloseAnchor");this.jx.href="#";this.SH.appendChild(this.jx);const B=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.jx.appendChild(B)}bxe(){this.dU=this.Sg.createElement("div");this.dU.className="WACCalloutTitle UIFontBold";this.dU.style.width=190<this.h3?this.h3-30+"px":"160px";this.dU.id=this.wi("WACCalloutTitle");this.dU.innerText=this.title;this.SH.contains(this.jx)?this.SH.insertBefore(this.dU,
this.jx):this.SH.appendChild(this.dU)}qQj(){var B=this.qse;let D;if(1===this.hV){var I=this.aEe.y+16;D=-16}else 2===this.hV||3===this.hV||0===this.hV?(I=B.y+B.height+15,D=-15):(I=B.y-this.DX.clientHeight-15-2,D=this.DX.clientHeight-1);this.DX.style.top=I+"px";this.Htb.style.top=D+"px";1===this.hV?(B=this.aEe.x-16,this.DX.style.left="50%",this.DX.style.marginLeft=-this.h3/2+"px",I=Sys.UI.DomElement.getBounds(this.DX),this.Htb.style.left=B-I.x+"px"):(I=B.x+this.qse.width/2,2===this.hV||5===this.hV?
(B=20,I-=36):0===this.hV||4===this.hV?(B=this.h3/2-16,I-=this.h3/2):(B=this.h3-20-32,I=I-this.h3+36),this.DX.style.left=I+"px",this.Htb.style.left=B+"px")}hn(){this.Iu&&!this.fU&&(this.fU=Object(b.a)(this,this.Yba,"closeHandler"),this.FQ.ta(e.a.click,this.jx,this.fU,null))}Cca(){this.Iu&&this.fU&&(this.FQ.Aa(e.a.click,this.jx,this.fU),this.fU=null)}Yba(){this.dismiss();return!0}}Object(u.a)(h,"Callout",Sys.UI.Control,[555]);class l extends h{constructor(B,D,I,S,J,L=null){super(B,I,J.DY,L);this.Lle=
0;this.h3=this.F9h(S);this.z0a=D;this.Kf=J;this.Y6j=7;this.im=this.z0a.ownerDocument.createElement("div");this.im.className="ModalCalloutControlOverlay";this.im.tabIndex=0;this.z0a.insertBefore(this.im,this.z0a.firstChild)}show(){this.DPa||(this.Kf.Bxc(),this.Kf.bR(!1),this.im.style.zIndex=String(this.Kf.r4),super.show(),this.mj(),this.Lle=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.Y6j))}dismiss(){this.DPa&&(this.Kf.KN(!1),this.oj(),this.z0a&&this.z0a.contains(this.im)&&this.z0a.removeChild(this.im),
super.dismiss(),window.clearTimeout(this.Lle))}mj(){this.Kf.Mua(Object(b.a)(this,this.dismiss,"dismiss"));this.Kf.Pz.ta(e.a.click,this.im,Object(b.a)(this,this.Gd,"onClick"))}oj(){this.Kf.Nfb(Object(b.a)(this,this.dismiss,"dismiss"));this.Kf.Pz.Aa(e.a.click,this.im,Object(b.a)(this,this.Gd,"onClick"))}Gd(){this.dismiss();return!0}F9h(B){let D=0;switch(B){case 0:D=190;break;case 1:D=250;break;case 2:D=300;break;case 3:D=360}return D}}Object(u.a)(l,"ModalCallout",h,[]);var k=a(468),n=a(188);class v extends l{constructor(B,
D,I,S,J,L=null){super(B,D,I,S,J,L);this.M_b=null}show(){if(!this.DPa){const B=Object.assign(new k.a,{onShow:()=>{l.prototype.show.call(this)}});n.UISurfaces.HI().then(D=>{const I=D.externalNotification();this.M_b=D.addNotification(I,B);return null},D=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})}}dismiss(){this.DPa&&this.M_b&&(n.UISurfaces.HI().then(B=>{B.removeNotification(this.M_b);return this.M_b=null},B=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",
B);return null}),super.dismiss())}}Object(u.a)(v,"ReactManagedModalCallout",l,[]);var x=a(6);class w{static eph(B,D,I){return x.AFrameworkApplication.sa.Qa.tS?new v(B,D,I,3,x.AFrameworkApplication.sa,null):new l(B,D,I,3,x.AFrameworkApplication.sa,null)}}Object(u.a)(w,"ModalCalloutControlFactory",null,[]);var r=a(57),t=a(902),A=a(597),y=a(903),z=a(146),E=a(59),G=a(41),F=a(84),O=a(850),M=a(723);a.d(C,"a",function(){return P});class P{static get c6b(){return P.oha||(P.oha=F.a.instance.ah("Common.Utils.IAriaNotifier"))}static mOe(B,
D,I,S){P.rK&&P.rK.DPa&&P.rK.dismiss();P.rK=w.eph(D,B,B);P.rK.content=I;M.b(S)||(P.rK.title=S,P.rK.ckc=!0);B=new Sys.UI.Bounds(0,0,E.a.Wic(),E.a.Vic());P.rK.hV=P.n1h(B,D,P.rK.h3);P.rK.show();P.c6b&&P.c6b.sendNotification(I.innerText,!0)}static qad(B,D,I,S=null){n.UISurfaces.HI().then(J=>{let L=null;P.ypb&&(J.removeNotification(P.ypb),P.ypb=null);const R=J.callout(Object.assign(new t.a,{target:B,title:D,content:I,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new y.a,
{onDismiss:()=>{J.removeNotification(L)},directionalHint:null!=S?S:null})})),Y=Object.assign(new k.a,{expirationOptions:Object.assign(new A.a,{displayTimeoutSeconds:7,onExpire:()=>{J.removeNotification(P.ypb)}})});L=P.ypb=J.addNotification(R,Y);return null},J=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}static M_d(B,D=null){P.rK&&P.rK.DPa&&P.rK.dismiss();const I=new z.StandardDialog;I.QVa=!1;I.rc=0;I.kB(r.a.ILi,CommonUIStrings.l_DialogError,M.b(B)?
P.M9e():B,D)}static N_d(B){P.rK&&P.rK.DPa&&P.rK.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",B.errorCode));const D=M.b(B.description)?P.M9e():B.description,I=new z.StandardDialog;let S=null;B.Kja?(I.rc=1,I.Hc(1,B.buttonText),I.u2(1)):I.rc=0;S=J=>{1===J?B.Kja():B.Lka&&B.Lka()};I.QVa=!1;0===B.$Oa?I.kB(B.errorCode,B.title?B.title:CommonUIStrings.l_DialogError,D,S):1===B.$Oa?I.BT(B.title?B.title:CommonUIStrings.l_DialogWarning,D,S):I.Eqa(B.title?
B.title:CommonUIStrings.l_DialogInfo,D,S)}static n1h(B,D,I){let S=4;const J=B.x+B.width-D.x-D.width;D.x-B.x+D.width/2<=I/2?S=5:J+D.width/2<=I/2&&(S=6);return S}static VWj(B,D,I,S=!1){(D=O.a.X6a(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,J=>{J&&(S||P.qad(J,I,B,5))})}static WWj(B,D,I=!1){P.VWj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,B),D,D.startedNode?D.startedNode.title:
String.format(CommonUIStrings.l_NewAddInLoadedTitle,B),I)}static UWj(B,D,I,S){if(P.Zug)B=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,I,S,CommonUIStrings.l_InsertionDialogRefresh)),P.qad(D,B,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=G.a.cq(D);var J=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),L=document.createElement("span");L.innerText=J[0];var R=document.createElement("span");
R.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,I,S,CommonUIStrings.l_InsertionDialogRefresh);R.className="UIFontBold";I=document.createElement("span");I.innerText=J[1];S=document.createElement("div");Sys.UI.DomElement.addCssClass(S,"ModalCalloutControl");S.appendChild(L);S.appendChild(R);S.appendChild(I);P.mOe(B,D,S,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static mYj(B,D){var I=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,S=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;
P.Zug?P.qad(D,I,S):(D=G.a.cq(D),P.mOe(B,D,P.a9g(S),I))}static a9g(B){const D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=B;return D}static M9e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get Zug(){return x.AFrameworkApplication.sa.Qa.Ik&&x.AFrameworkApplication.sa.Qa.tS}}P.rK=null;P.ypb=null;P.oha=null;Object(u.a)(P,"AddInCommandsNotificationFactory",null,[])},992:function(u,C,a){a.r(C);u=a(0);var c=
a(15),b=a(1536),f=a(173),e=a(114),d=a(741),h=a(762),l=a(355);class k{constructor(r,t,A,y){this.Xo=!1;this._id=r;this.Ey=t;this.z3=A;this.Xd=y}get enabled(){return this.Xo}set enabled(r){const {DynamicRibbon:t}=a(992);var A=this.Xd.OwnerAddinStoreType?this.Xd.OwnerAddinStoreType:this.Xd.PrimaryMarketplace.MarketplaceType;const y=this.Xd.PrimaryMarketplace.MarketplaceRef,z=this.Xd.AssetMarketplace?this.Xd.AssetMarketplace.SolutionId:null,E=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ey,A,null,
null,null,y);A={["addinSolutionId"]:E,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Xd.OwnerAddinSolutionId,A,z,null,null,y),["ownerAddinStoreType"]:A,["ribbonControlType"]:"Button",["toggle"]:r};f.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.qHc+"ControlUpdate",dataFields:e.a.Yh(A)}));this.Xo=r;this.z3.BL(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.Ey,["PrivacyCompliantSolutionId"]:E,["SourceControlId"]:this.id,["MethodData"]:this.Xo})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(r){switch(r){case 3:return this.enabled;
case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertyGetAsync(r){r=this.invokePropertyGet(r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}invokePropertySet(r,t){switch(r){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertySetAsync(r,t){this.invokePropertySet(r,t);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(r,t){switch(r){case 5:return this.RMj(t);case 1:return this.tFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokeMethodAsync(r,t){r=this.invokeMethod(r,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}RMj(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"boolean");this.setEnabled(r);return null}tFa(){this._OnAccess();return null}}Object(u.a)(k,
"RibbonButton",null,[]);class n{constructor(r,t,A,y){this._id=r;this.Ey=t;this.z3=A;this.Xd=y}get id(){return this._id}setVisibility(r){const {DynamicRibbon:t}=a(992),A=this.Xd.OwnerAddinStoreType?this.Xd.OwnerAddinStoreType:this.Xd.PrimaryMarketplace.MarketplaceType;var y=this.Xd.PrimaryMarketplace.MarketplaceRef;const z=this.Xd.AssetMarketplace?this.Xd.AssetMarketplace.SolutionId:null,E=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ey,A,z,null,null,y);y={["addinSolutionId"]:E,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Xd.OwnerAddinSolutionId,
A,z,null,null,y),["ownerAddinStoreType"]:A,["ribbonControlType"]:"Tab",["toggle"]:r};f.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.qHc+"ControlUpdate",dataFields:e.a.Yh(y)}));this.z3.BL(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.Ey,["PrivacyCompliantSolutionId"]:E,["StoreType"]:A,["SourceControlId"]:this.id,["MethodData"]:r})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(r){switch(r){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);
}invokePropertyGetAsync(r){r=this.invokePropertyGet(r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}invokePropertySet(r){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertySetAsync(r,t){this.invokePropertySet(r,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(r,t){switch(r){case 3:return this.XQj(t);case 1:return this.tFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokeMethodAsync(r,
t){r=this.invokeMethod(r,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}XQj(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"boolean");this.setVisibility(r);return null}tFa(){this._OnAccess();return null}}Object(u.a)(n,"RibbonTab",null,[]);var v=a(1012),x=a(189);a.d(C,"DynamicRibbon",function(){return w});class w{constructor(r,t,A,y,z){this.Ey=r;this.JH=A;this.z3=y;this.Xd=z;this.Plb=this.JH.Lf;this.Yz=this.Plb.getOsfControl(t);this.uKg=this.Yz.getManifest()}get buttons(){return null}executeRequestCreate(r){try{var t=
this.Xd.OwnerAddinStoreType?this.Xd.OwnerAddinStoreType:this.Xd.PrimaryMarketplace.MarketplaceType;const y=this.Xd.PrimaryMarketplace.MarketplaceRef,z=this.Xd.AssetMarketplace?this.Xd.AssetMarketplace.SolutionId:null;var A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ey,t,z,null,null,y);const E={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Xd.OwnerAddinSolutionId,t,z,null,null,y),["ownerAddinStoreType"]:this.Xd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};
f.a.sendTelemetryEvent(Object.assign(new l.a,{name:w.qHc+"ExecuteRequestCreate",dataFields:e.a.Yh(E)}));const G=x.a.Xi(r);r={};t={};t[d.a.XLa]=this.Yz;t[d.a.YLa]=G;t[d.a.Ded]=this.Xd;r[d.a.byb]=3;r[d.a.X5]=this.Ey;r[d.a.Occ]=A;r[d.a.W5]=t;this.z3.BL(-1014260128,r);let F=w.ngc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,F)}catch(y){A=w.ngc("ExecuteRequestCreate",!1,y.toString()),c.ULS.sendTraceTag(538572825,0,50,A)}return null}executeRequestUpdate(r){try{var t=this.Xd.OwnerAddinStoreType?
this.Xd.OwnerAddinStoreType:this.Xd.PrimaryMarketplace.MarketplaceType;const y=this.Xd.PrimaryMarketplace.MarketplaceRef,z=this.Xd.AssetMarketplace?this.Xd.AssetMarketplace.SolutionId:null;var A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ey,t,z,null,null,y);const E={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Xd.OwnerAddinSolutionId,t,z,null,null,y),["ownerAddinStoreType"]:this.Xd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};f.a.sendTelemetryEvent(Object.assign(new l.a,
{name:w.qHc+"ExecuteRequestUpdate",dataFields:e.a.Yh(E)}));const G=x.a.Xi(r);r={};t={};t[d.a.XLa]=this.Yz;t[d.a.YLa]=G;t[d.a.Ded]=this.Xd;r[d.a.byb]=3;r[d.a.X5]=this.Ey;r[d.a.Occ]=A;r[d.a.W5]=t;this.z3.BL(-1014260128,r);let F=w.ngc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,F)}catch(y){A=w.ngc("ExecuteRequestUpdate",!1,y.toString()),c.ULS.sendTraceTag(538572823,0,50,A)}return null}getButton(r){let t=null;if(!this.bqf())return this.pOe();if(r&&0<r.length){if(!this.iJe(r))return this.HOe(r);
t=new k(r,this.Ey,this.z3,this.Xd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}getTab(r){let t=null;if(!this.bqf())return this.pOe();if(this.Yz.getOwnerAddinControlRecreated())return this.uoh();if(r&&0<r.length){if(!this.iJe(r))return this.HOe(r);t=new n(r,this.Ey,this.z3,this.Xd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(r){switch(r){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);
}invokePropertyGetAsync(r){r=this.invokePropertyGet(r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}invokePropertySet(r){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokePropertySetAsync(r,t){this.invokePropertySet(r,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(r){switch(r){case 1:return this.tFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(r);}invokeMethodAsync(r,t){switch(r){case 7:return this.CPh(t);
case 6:return this.DPh(t);case 3:return this.Q0h(t);case 5:return this.Ffi(t)}r=this.invokeMethod(r,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(r)}CPh(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.executeRequestCreate(r)}DPh(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.executeRequestUpdate(r)}Q0h(r){r=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.getButton(r)}Ffi(r){r=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return this.getTab(r)}tFa(){this._OnAccess();return null}HOe(r){return v.a(h.a.Tjh,x.a.ha(1771)+r)}pOe(){return v.a(h.a.vEj,x.a.ha(1767))}uoh(){return v.a(h.a.hostRestartNeeded,x.a.ha(1772))}bqf(){var r=this.Yz.getSharedRuntimeId();r=!!r&&0<r.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",r));return r}iJe(r){const t=this.uKg.getRibbonExtensionControlMap();return r in
t||this.Zch(r)}Zch(r){var t=this.iTh();if(t){t=t.MVe;for(const A of t.tabs){if(A.id===r)return!0;for(const y of A.groups)for(const z of y.controls){if(z.id===r)return!0;if("Menu"===z.type){t=z;for(const E of t.items)if(E.id===r)return!0}}}}return!1}iTh(){return b.a.getInstance().pla(this.Xd.PrimaryMarketplace.MarketplaceType,this.Xd.PrimaryMarketplace.SolutionId,1)}static ngc(r,t,A){const y={};y.methodName="DynamicRibbon."+r;y.result=t?"Succeeded":"Failed";y.message=A;return x.a.Zc(y)}}w.qHc="Office.Online.Extensibility.Ribbon.";
Object(u.a)(w,"DynamicRibbon",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.agave.js.map/84caea434594a495b9c01ab1840f82ee/EwaDSOpt.agave.js.map