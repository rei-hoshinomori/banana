'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1334:function(u,C,a){a.r(C);u=a(0);var c=a(15),b=a(103),f=a(86),e=a(12),d=a(229);class h extends d.a{constructor(n){super();this.$=n;this.kc()}create(){const {RenderingFidelityTracker:n}=a(1334);let v=this.$.da.Ba(462);v||(v=this.$.da.Ja(462,new n));this.Pb(v)}}Object(u.a)(h,"RenderingFidelityTrackerFactory",d.a,[]);var l=a(44);a.d(C,"RenderingFidelityTracker",function(){return k});class k extends f.a{constructor(){super();
this.YVi=3E4;this.hjb={};this.A8d={};this.EEe={};b.Health.instance.addQosPillar("Fidelity")}static la(n){n.da.Ja(463,new h(n))}i0g(n,v,x,w){if(!(l.PageLoadTrackingInfo.instance.lya(new Date)<this.YVi)){var r=e.HelperMethods.LS(()=>{var t=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(v),A=Object.keys(t),y=this.EEe[n];for(var z=0;z<A.length;z++){var E=A[z];this.A8d[E]||(null===y||void 0===y?0:y[E])&&this.hjb[E]&&(this.hjb[E]-=y[E])}this.EEe[n]=t;for(z=0;z<A.length;z++)if(y=A[z],!this.A8d[y])if(E=
t[y],this.hjb[y]&&(E+=this.hjb[y]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(y,E)){this.A8d[y]=!0;t=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(y);A=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(y);z=!("ThickBorder"===y||"MediumBorder"===y);t&&A&&z&&b.Health.instance.recordQosError(t,[A],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+y+", isHC:"+x+", scaleFactor:"+w+"}");
break}else this.hjb[y]=E});1<r&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${r}`)}}}Object(u.a)(k,"RenderingFidelityTracker",f.a,[651,2])},1497:function(u,C,a){function c(da){var qa=da.replace(/-.*/g,()=>"");qa=Tb.get(qa);return null!==qa&&void 0!==qa?qa:da.startsWith("ooux")?"ooux":"other"}a.r(C);var b={};a.r(b);a.d(b,"InteractivityTrackerService",function(){return Ke});var f={};a.r(f);a.d(f,
"JsSelfProfilerManager",function(){return md});var e={};a.r(e);a.d(e,"PageLoadEngagementInfo",function(){return se});var d={};a.r(d);var h=a(0),l=a(15);class k{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=
this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(h.a)(k,"BrowserInfo",null,[]);class n{constructor(){this.Version=this.Name=null}}Object(h.a)(n,"PluginInfo",null,[]);var v=a(6),x=a(31);class w{static dQi(){if(v.AFrameworkApplication.fa.ra("LogBrowserInfoIsEnabled")){var da=w.cXh();try{const qa=JSON.stringify(da);
l.ULS.sendTraceTag(6903563,102,50,qa)}catch(qa){l.ULS.sendTraceTag(6903564,102,15,qa.message)}}else l.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static Rai(){const da=window.navigator.plugins;if(!da||!da.length)return null;const qa=[];for(let Xb=0;Xb<da.length;Xb++){const Pc=da[Xb].name,zd=da[Xb].version;Array.add(qa,Object.assign(new n,{Name:Pc,Version:zd}))}return qa}static cXh(){const da=new k,qa=new Sys.StringBuilder;w.Gu(Xb=>{da.DocElemClientHeight=Xb},()=>
document.documentElement.clientHeight,qa);w.Gu(Xb=>{da.DocElemClientWidth=Xb},()=>document.documentElement.clientWidth,qa);w.Gu(Xb=>{da.DocElemOffsetHeight=Xb},()=>document.documentElement.offsetHeight,qa);w.Gu(Xb=>{da.DocElemOffsetWidth=Xb},()=>document.documentElement.offsetWidth,qa);w.Gu(Xb=>{da.ScreenAvailHeight=Xb},()=>window.screen.availHeight,qa);w.Gu(Xb=>{da.ScreenAvailWidth=Xb},()=>window.screen.availWidth,qa);w.Gu(Xb=>{da.ScreenWidth=Xb},()=>window.screen.width,qa);w.Gu(Xb=>{da.ScreenHeight=
Xb},()=>window.screen.height,qa);w.Gu(Xb=>{da.ScreenLogicalXdpi=Xb},()=>window.screen.logicalXDPI,qa);w.Gu(Xb=>{da.ScreenLogicalYdpi=Xb},()=>window.screen.logicalYDPI,qa);w.Gu(Xb=>{da.ScreenDeviceXdpi=Xb},()=>window.screen.deviceXDPI,qa);w.Gu(Xb=>{da.ScreenDeviceYdpi=Xb},()=>window.screen.deviceYDPI,qa);w.Gu(Xb=>{da.WinInnerHeight=Xb},()=>window.self.innerHeight,qa);w.Gu(Xb=>{da.WinInnerWidth=Xb},()=>window.self.innerWidth,qa);w.Gu(Xb=>{da.WinOuterHeight=Xb},()=>window.self.outerHeight,qa);w.Gu(Xb=>
{da.WinOuterWidth=Xb},()=>window.self.outerWidth,qa);w.Gu(Xb=>{da.WinOrientation=Xb},()=>window.self.orientation,qa);w.Gu(Xb=>{da.WinDevicePixelRatio=Xb},()=>window.self.devicePixelRatio,qa);w.Gu(Xb=>{da.SupportsTouch=Xb},()=>x.a.NGc,qa);w.Gu(Xb=>{da.NavAppName=Xb},()=>window.navigator.appName,qa);w.Gu(Xb=>{da.NavAppVersion=Xb},()=>window.navigator.appVersion,qa);w.Gu(Xb=>{da.NavLanguage=Xb},()=>window.navigator.browserLanguage||window.navigator.language,qa);w.Gu(Xb=>{da.NavUserAgent=Xb},()=>window.navigator.userAgent,
qa);w.Gu(Xb=>{da.NavPlatform=Xb},()=>window.navigator.platform,qa);w.Gu(Xb=>{da.NavPlugins=Xb},w.Rai,qa);w.Gu(Xb=>{da.CalculatedDevicePixelRatio=Xb},()=>w.devicePixelRatio,qa);da.Error=qa.toString();return da}static get devicePixelRatio(){const da=window.devicePixelRatio;return isNaN(da)?window.screen.deviceXDPI/window.screen.logicalXDPI:da}static Gu(da,qa,Xb){try{const Pc=qa();da(Pc)}catch(Pc){Xb.isEmpty()||Xb.append(" | "),Xb.append(Pc.message||"null")}}}Object(h.a)(w,"BrowserInfoLogger",null,[]);
var r=a(260);class t{get name(){return"Common.App.BrowserInfoLogger"}Di(){}init(){w.dQi()}dispose(){}static main(){r.a.instance.nj(new t)}}Object(h.a)(t,"BrowserInfoLoggerPackage",null,[4,5]);var A=a(82);class y{constructor(da){this.BMc=da}Wpf(da){if(!this.BMc)return!0;da=A.a.snd(da);if(!da)return!1;da=da.toLowerCase();for(let qa=0;qa<this.BMc.length;qa++)if(da.endsWith(this.BMc[qa]))return!0;return!1}}Object(h.a)(y,"DomainAllowListManager",null,[]);class z{constructor(da,qa){this.yca=null;this.m_c=
da;this.url=qa}get B7d(){return A.a.Mfa(this.url)}get Yu(){return this.m_c}o4d(){const da={},qa=this.Yu;da.a=this.B7d;da.b=this.round(qa.navigationStart);da.c=this.round(qa.unloadEventStart);da.d=this.round(qa.unloadEventEnd);da.e=this.round(qa.redirectStart);da.f=this.round(qa.redirectEnd);da.g=this.round(qa.fetchStart);da.h=this.round(qa.domainLookupStart);da.i=this.round(qa.domainLookupEnd);da.j=this.round(qa.connectStart);da.k=this.round(qa.connectEnd);da.l=void 0!==qa.secureConnectionStart&&
null!==qa.secureConnectionStart?this.round(qa.secureConnectionStart):0;da.m=this.round(qa.requestStart);da.n=this.round(qa.responseStart);da.o=this.round(qa.responseEnd);da.q=this.round(qa.domInteractive);da.r=this.round(qa.domContentLoadedEventStart);da.s=this.round(qa.domContentLoadedEventEnd);da.t=this.round(qa.domComplete);da.u=this.round(qa.loadEventStart);da.v=this.round(qa.loadEventEnd);da.w=this.yca;return da}round(da){return Math.round(1E3*da)/1E3}}Object(h.a)(z,"PerformanceTimingEntry",
null,[]);const E=(da,qa)=>{const Xb={};let Pc=null;switch(da){case 0:Pc="ResourceTiming";da=qa.a;null!=da&&(Xb.Url=da);da=qa.b;null!=da&&(Xb.InitiatorType=da);da=null==qa.c?null:qa.c.toString();null!=da&&(Xb.RedirectStart=da);da=null==qa.d?null:qa.d.toString();null!=da&&(Xb.RedirectEnd=da);da=null==qa.e?null:qa.e.toString();null!=da&&(Xb.FetchStart=da);da=null==qa.f?null:qa.f.toString();null!=da&&(Xb.DomainLookupStart=da);da=null==qa.g?null:qa.g.toString();null!=da&&(Xb.DomainLookupEnd=da);da=null==
qa.h?null:qa.h.toString();null!=da&&(Xb.ConnectStart=da);da=null==qa.i?null:qa.i.toString();null!=da&&(Xb.ConnectEnd=da);da=null==qa.j?null:qa.j.toString();null!=da&&(Xb.SecureConnectionStart=da);da=null==qa.k?null:qa.k.toString();null!=da&&(Xb.RequestStart=da);da=null==qa.l?null:qa.l.toString();null!=da&&(Xb.ResponseStart=da);da=null==qa.m?null:qa.m.toString();null!=da&&(Xb.ResponseEnd=da);da=qa.n;null!=da&&(Xb.CustomText=da);da=null==qa.o?null:qa.o.toString();null!=da&&(Xb.DecodedBodySize=da);da=
null==qa.p?null:qa.p.toString();null!=da&&(Xb.EncodedBodySize=da);qa=null==qa.q?null:qa.q.toString();null!=qa&&(Xb.TransferSize=qa);break;case 1:Pc="PerformanceTiming",da=qa.a,null!=da&&(Xb.Url=da),da=null==qa.b?null:qa.b.toString(),null!=da&&(Xb.NavigationStart=da),da=null==qa.c?null:qa.c.toString(),null!=da&&(Xb.UnloadEventStart=da),da=null==qa.d?null:qa.d.toString(),null!=da&&(Xb.UnloadEventEnd=da),da=null==qa.e?null:qa.e.toString(),null!=da&&(Xb.RedirectStart=da),da=null==qa.f?null:qa.f.toString(),
null!=da&&(Xb.RedirectEnd=da),da=null==qa.g?null:qa.g.toString(),null!=da&&(Xb.FetchStart=da),da=null==qa.h?null:qa.h.toString(),null!=da&&(Xb.DomainLookupStart=da),da=null==qa.i?null:qa.i.toString(),null!=da&&(Xb.DomainLookupEnd=da),da=null==qa.j?null:qa.j.toString(),null!=da&&(Xb.ConnectStart=da),da=null==qa.k?null:qa.k.toString(),null!=da&&(Xb.ConnectEnd=da),da=null==qa.l?null:qa.l.toString(),null!=da&&(Xb.SecureConnectionStart=da),da=null==qa.m?null:qa.m.toString(),null!=da&&(Xb.RequestStart=
da),da=null==qa.n?null:qa.n.toString(),null!=da&&(Xb.ResponseStart=da),da=null==qa.o?null:qa.o.toString(),null!=da&&(Xb.ResponseEnd=da),da=null==qa.p?null:qa.p.toString(),null!=da&&(Xb.DomLoading=da),da=null==qa.q?null:qa.q.toString(),null!=da&&(Xb.DomInteractive=da),da=null==qa.r?null:qa.r.toString(),null!=da&&(Xb.DomContentLoadedEventStart=da),da=null==qa.s?null:qa.s.toString(),null!=da&&(Xb.DomContentLoadedEventEnd=da),da=null==qa.t?null:qa.t.toString(),null!=da&&(Xb.DomComplete=da),da=null==qa.u?
null:qa.u.toString(),null!=da&&(Xb.LoadEventStart=da),da=null==qa.v?null:qa.v.toString(),null!=da&&(Xb.LoadEventEnd=da),qa=qa.w,null!=qa&&(Xb.CustomText=qa)}Xb.Table=Pc;return Sys.Serialization.JavaScriptSerializer.serialize(Xb)};var G=a(56),F=a(224),O=a(330);class M{constructor(da,qa=null,Xb=null){this.xh=da;this.A7d=this;this.mHg=qa||(()=>window.location.href);this.zPc=new y(Xb)}run(){if(M.dR(window.performance))try{const zd=this.mHg();if(M.PPg.exec(zd)&&this.zPc.Wpf(zd)){var da=new z(window.performance.timing,
zd);O.a.instance.Orj(da.Yu.fetchStart);O.a.instance.Prj(da.Yu.navigationStart);O.a.instance.QIb(G.a.$Vh,"connectStart","requestStart");O.a.instance.QIb(G.a.hWh,"requestStart","responseStart");O.a.instance.QIb(G.a.kWh,"responseStart","responseEnd");this.A7d.Df(1,da.o4d());this.xh.$n(G.a.xxa,da.Yu.fetchStart);this.xh.$n(G.a.eWh,da.Yu.domainLookupStart);this.xh.$n(G.a.dWh,da.Yu.domainLookupEnd);this.xh.$n(G.a.bWh,da.Yu.connectStart);this.xh.$n(G.a.lWh,da.Yu.secureConnectionStart);this.xh.$n(G.a.aWh,
da.Yu.connectEnd);this.xh.$n(G.a.iWh,da.Yu.requestStart);this.xh.$n(G.a.hkd,da.Yu.responseStart);this.xh.$n(G.a.fWh,da.Yu.responseEnd-da.Yu.responseStart);this.xh.$n(G.a.jWh,da.Yu.responseStart-da.Yu.requestStart);var qa=0,Xb=0,Pc=0;({transferSize:qa,mfd:Xb,Ocd:Pc}=this.dak(zd)).returnValue&&(this.xh.$n(G.a.mWh,qa),this.xh.$n(G.a.cWh,Pc),this.xh.$n(G.a.gWh,Xb));this.xh.$n(G.a.gkd,da.Yu.navigationStart)}}catch(zd){l.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",
zd)}}dak(da){let qa,Xb,Pc;Pc=Xb=qa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:qa,mfd:Xb,Ocd:Pc};da=window.performance.getEntriesByName(da,"navigation");if(void 0===da||null===da||1!==da.length)return{returnValue:!1,transferSize:qa,mfd:Xb,Ocd:Pc};da=da[0];var zd=da.transferSize;void 0!==qa&&null!==qa&&(qa=zd);zd=da.decodedBodySize;void 0!==zd&&null!==zd&&(Pc=zd);da=da.encodedBodySize;void 0!==da&&null!==da&&(Xb=
da);return{returnValue:!0,transferSize:qa,mfd:Xb,Ocd:Pc}}Df(da,qa){l.ULS.sendTraceTag(4551815,306,50,E(da,qa))}static get instance(){return M.Oa||(M.Oa=new M(F.a.instance,null,v.AFrameworkApplication.fa.ra("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.fa.Kw("ResourceLoggerDomainAllowList"):null))}static dR(da){return!(void 0===da||null===da)&&!(void 0===da.timing||null===da.timing)}}M.Oa=null;M.PPg=RegExp("^https?://.*","i");Object(h.a)(M,"PerformanceTimingLogger",null,[604]);
var P=a(105),B=a(126);class D{constructor(da,qa){this.yca=null;this.m_c=da;this.behavior=qa;this.url=this.Yu.name}get B7d(){return 2===this.behavior?this.url:A.a.Mfa(this.url)}get Yu(){return this.m_c}o4d(){const da={},qa=this.Yu;da.a=this.B7d;da.b=qa.initiatorType;da.c=this.round(qa.redirectStart);da.d=this.round(qa.redirectEnd);da.e=this.round(qa.fetchStart);da.f=this.round(qa.domainLookupStart);da.g=this.round(qa.domainLookupEnd);da.h=this.round(qa.connectStart);da.i=this.round(qa.connectEnd);
da.j=void 0!==qa.secureConnectionStart&&null!==qa.secureConnectionStart?this.round(qa.secureConnectionStart):0;da.k=this.round(qa.requestStart);da.l=this.round(qa.responseStart);da.m=this.round(qa.responseEnd);da.o=this.round(D.kya(qa,"decodedBodySize"));da.p=this.round(D.kya(qa,"encodedBodySize"));da.q=this.round(D.kya(qa,"transferSize"));da.n=this.yca;return da}round(da){return Math.round(1E3*da)/1E3}static kya(da,qa){return da[qa]}}Object(h.a)(D,"ResourceTimingEntry",null,[633]);var I=a(103),S=
a(147),J=a(43),L=a(115),R=a(184);class Y{constructor(da,qa=null,Xb=100){this.Eae=da;this.a2b=qa;this.$ra={};this.YDg=Xb}s$j(da){var qa=da.name.toLowerCase();const Xb=A.a.D6(qa);this.P7f(Xb,qa)&&(Xb in this.$ra?l.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",Xb):(qa={},qa.fetchstart=da.fetchStart,qa.responseend=da.responseEnd,qa.iscached=this.kvf(da),qa.encodedsize=D.kya(da,"encodedBodySize"),qa.decodedsize=D.kya(da,"decodedBodySize"),this.$ra[Xb]=
qa))}t$j(da){var qa=da.name.toLowerCase();const Xb=A.a.D6(qa);this.MDj(Xb,qa)&&(Xb in this.$ra?l.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",Xb):(qa={},qa.fetchstart=da.fetchStart,qa.responseend=da.responseEnd,qa.iscached=this.kvf(da),qa.encodedsize=D.kya(da,"encodedBodySize"),qa.decodedsize=D.kya(da,"decodedBodySize"),qa.it=da.initiatorType,qa.ress=da.responseStart,qa.cs=da.connectStart,qa.ce=da.connectEnd,qa.dls=da.domainLookupStart,
qa.dle=da.domainLookupEnd,qa.rs=da.redirectStart,qa.re=da.redirectEnd,qa.reqs=da.requestStart,qa.scs=da.secureConnectionStart,this.$ra[Xb]=qa))}P7f(da,qa){if(this.Eae)return Array.contains(this.Eae,da);if(this.a2b)for(da=A.a.vL(qa),qa=0;qa<this.a2b.length;qa++)if(this.a2b[qa]&&da.endsWith(this.a2b[qa]))return!0;return!1}MDj(da,qa){return this.P7f(da,qa)?da.endsWith(".js")||da.endsWith(".css"):!1}kvf(da){try{const qa=D.kya(da,"transferSize");if(void 0!==qa&&null!==qa)return!qa;l.ULS.sendTraceTag(51652510,
306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return da.responseEnd-da.fetchStart<this.YDg}catch(qa){l.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",qa.message)}return!1}msj(){if(L.a.sh(this.$ra))l.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var da=v.AFrameworkApplication.flightId?v.AFrameworkApplication.flightId.split(";"):
[],qa=Object.assign(new R.a,{extendedProperties:S.a.ot()});qa.extendedProperties.set("Flights",J.c(da));this.lQi(qa,this.$ra,I.Health.instance)}}gld(da){let qa=0,Xb=0,Pc=0,zd=0;const ce=this.$ra;for(let De in ce){var we=ce[De];De.endsWith(".js")&&(we=Object(B.a)(Object,we),we.responseend<da&&(qa+=1,Xb+=we.decodedsize,zd+=we.encodedsize,Pc+=we.iscached?0:we.encodedsize))}da={};da.filesLoaded=qa;da.decodedBytes=Xb;da.transferredBytes=Pc;da.encodedBytes=zd;return da}lQi(da,qa,Xb){if(qa){var Pc=0,zd=
0,ce=0,we=0,De=0,kf=0,Ue=0,Uf=0,Cf=0,pg=0,zg=0;for(let dh in qa){var Bg=qa[dh];try{const Fg=Object(B.a)(Object,Bg);if(!Fg)continue;const uh=Fg.iscached?Boolean.parse(Fg.iscached.toString()):!1,fg=Fg.fetchstart?this.parseFloat(Fg.fetchstart.toString()):0,Gg=(Fg.responseend?this.parseFloat(Fg.responseend.toString()):0)-fg,Cg=Fg.encodedsize?this.parseFloat(Fg.encodedsize.toString()):0,rg=Fg.decodedsize?this.parseFloat(Fg.decodedsize.toString()):0;Pc+=Gg;we+=Cg;Ue+=rg;pg++;uh?(ce+=Gg,kf+=Cg,Cf+=rg,zg++):
(zd+=Gg,De+=Cg,Uf+=rg)}catch(Fg){l.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Fg.message)}}da.extendedProperties.set("StaticResources",J.c(qa));da.extendedProperties.set("TotalResourceDownloadLatency",Pc.toString());da.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",zd.toString());da.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ce.toString());da.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
we.toString());da.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",De.toString());da.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",kf.toString());da.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ue.toString());da.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Uf.toString());da.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Cf.toString());da.extendedProperties.set("TotalNumberOfResourcesDownloaded",
pg.toString());da.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",zg.toString());Xb.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);Xb.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",da)}}parseFloat(da){if(!da)return 0;da=parseFloat(da);return isNaN(da)?0:da}}Object(h.a)(Y,"AppStaticResourceManager",null,[]);class Q extends Sys.EventArgs{constructor(da){super();this.entries=da}}Object(h.a)(Q,"EntriesAvailableEventArgs",Sys.EventArgs,
[]);var W=a(112);class Ga{constructor(da,qa,Xb=null,Pc=null,zd=100,ce=!1){this.DTc=!1;this.Jj=null;this.Wlb=0;this.$a=new P.a;this.AFa=null;this.tU=!1;this.Lse=0;this.Ce=da;this.Dde=0;this.A7d=this;this.zPc=new y(Xb);this.iw=qa;Pc&&(this.AFa=new Y(null,Pc,zd));this.FCg=ce}get kFe(){try{return!(void 0===this.iw||null===this.iw)&&!(void 0===this.iw.getEntriesByType||null===this.iw.getEntriesByType)}catch(da){return l.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
da),!1}}get uuh(){return this.Dde}get isActive(){return this.tU}get c4d(){return this.Lse}BWg(da){this.$a.addHandler(Ga.Qfd,da)}Mxj(da){this.$a.removeHandler(Ga.Qfd,da)}Di(da,qa){const Xb=this.c4d!==da;this.Lse=da;this.isActive&&this.Ce&&Xb&&(this.Zp(),this.jg());this.Dde=qa}activate(){!this.isActive&&this.kFe&&(this.jg(),this.tU=!0)}deactivate(da){this.isActive&&(this.Zp(),da&&this.flush(),this.tU=!1)}flush(){if(this.isActive&&this.kFe)try{var da=window.performance.getEntriesByType("resource");0<
da.length-this.Wlb&&l.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",da.length-this.Wlb);const qa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);qa&&(window.performance.clearResourceTimings(),this.Wlb=0);const Xb=[];for(let Pc=this.Wlb;Pc<da.length;Pc++)this.zPc.Wpf(da[Pc].name)&&(this.AFa&&(this.FCg?this.AFa.t$j(da[Pc]):this.AFa.s$j(da[Pc])),Xb.push(new D(da[Pc],this.uuh)));
qa||(this.Wlb=da.length);this.$a.raiseEvent(Ga.Qfd,new Q(Xb));for(da=0;da<Xb.length;da++)0!==Xb[da].behavior&&2!==Xb[da].behavior||this.A7d.Df(0,Xb[da].o4d());0<Xb.length&&l.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",Xb.length)}catch(qa){l.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",qa)}}Df(da,qa){l.ULS.sendTraceTag(4310804,306,50,E(da,qa))}Nrj(){this.AFa.msj()}gld(da){return this.AFa.gld(da)}jg(){this.Ce&&
0<this.c4d&&(this.Jj=new W.a(3,2,1E3*this.c4d,()=>{this.flush()},5),this.Ce.jg(this.Jj),this.DTc=!0)}Zp(){this.DTc&&(this.Ce.Zp(this.Jj),this.Jj=null,this.DTc=!1)}}Ga.Qfd="EntriesAvailable";Object(h.a)(Ga,"ResourceTimingLogger",null,[574,604]);var pa=a(131);class aa{constructor(){this.Db=null}get name(){return"Common.ResourceTiming"}init(){this.Db.resolve("Common.NetworkTiming.IResourceTimingLogger");M.instance.run()}dispose(){}Di(da){this.Db=da;let qa=null;if(v.AFrameworkApplication.fa.ra("ResourceLoggerFilterDomainsIsEnabled"))try{qa=
v.AFrameworkApplication.fa.Kw("ResourceLoggerDomainAllowList")}catch(ce){l.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const Xb=[];Xb.push(A.a.vL(pa.a.zM).toLowerCase());Xb.push(A.a.vL(pa.a.whb).toLowerCase());const Pc=v.AFrameworkApplication.fa.oe("AppStaticResourceMonitorCacheThresholdInMs",100),zd=v.AFrameworkApplication.fa.ra("PPTAggregateResourceTimingV2Enabled");da.register(574,"Common.NetworkTiming.IResourceTimingLogger").Uc().dd(()=>new Ga(v.AFrameworkApplication.Mi,
window.performance,qa,Xb,Pc,zd))}static main(){r.a.instance.nj(new aa)}}Object(h.a)(aa,"ResourceTimingPackage",null,[4,5]);var Z=a(88);class fa extends Sys.EventArgs{constructor(da,qa){super();this.V5j=da;this.actualValue=qa}}Object(h.a)(fa,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var ya=a(148);class Aa{constructor(){this.EYa=[];this.ade=this.ROc=0;this.uha=null;this.$a=new P.a}init(da,qa,Xb){this.uha=da;this.ROc=qa;this.ade=Xb;this.uha.xye(Object(Z.a)(this,this.b3i,"onCpuMeterFrameAvailable"));
this.TXg(Object(Z.a)(this,this.plh,"cpuPercentThresholdExceeded"))}b3i(da,qa){qa.NFf&&(Array.enqueue(this.EYa,qa.NFf.CP),this.EYa.length>this.ade&&(Array.dequeue(this.EYa),this.Xch()))}Xch(){var da=this.EYa.length;let qa=0;for(let Xb=0;Xb<da;Xb++){const Pc=Array.dequeue(this.EYa);qa+=Pc;Array.enqueue(this.EYa,Pc)}da=qa/da;da>this.ROc&&this.$a.raiseEvent("CPTTE",new fa(this.ROc,da))}plh(da,qa){ya.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.rnh(qa.V5j,qa.actualValue))}TXg(da){this.$a.addHandler("CPTTE",
da)}rnh(da,qa){const Xb={};Xb.ThresholdValue=da;Xb.ActualValue=qa;return Xb}}Object(h.a)(Aa,"CpuMeterMonitor",null,[609]);var ja=a(170);class za{constructor(){this.S=this.T=this.M=this.C=0}}Object(h.a)(za,"ProfileInformation",null,[]);var ra=a(14),fb=a(50),Ua=a(279);class Ca{constructor(da=0,qa=0){this.aSc=!1;this.IGa={};this.p_b=da;this.y_b=qa;this.C_c=0;fb.a.addHandler(window.self,ra.a.t_g,()=>{this.aSc=!0});fb.a.addHandler(window.self,ra.a.u_g,()=>{this.aSc=!1})}Qze(da,qa,Xb){const Pc=Ca.generateKey(qa,
Xb);Pc in this.IGa?qa=this.IGa[Pc]:(qa=new za,qa.S=Xb?1:0,this.IGa[Pc]=qa,this.C_c++);qa.C++;qa.M=da>qa.M?da:qa.M;qa.T+=da}kba(da,qa){this.Qze(da,qa,!1);this.aSc&&this.Qze(da,qa,!0)}getData(){if(0<this.y_b&&this.C_c>this.y_b)return this.j3h();const da=0<this.p_b,qa={},Xb=this.IGa;for(let zd in Xb){var Pc=zd;const ce=Xb[zd];this.b9f(ce);da&&ce.T>=this.p_b&&(qa[Pc]=ce)}return da?L.a.sh(qa)?null:qa:this.IGa}j3h(){var da=0<this.p_b,qa=[];const Xb=this.IGa;for(let Pc in Xb){const zd={key:Pc,value:Xb[Pc]};
let ce=zd.value;(!da||ce.T>=this.p_b)&&Array.add(qa,zd)}if(qa.length>this.y_b)qa.sort((Pc,zd)=>zd.value.T-Pc.value.T),qa=qa.slice(0,this.y_b);else if(!qa.length)return null;da={};for(const Pc of qa)qa=Pc.value,this.b9f(qa),da[Pc.key]=qa;return da}b9f(da){da.M=Ua.a.D9(da.M,0);da.T=Ua.a.D9(da.T,0)}reset(){this.IGa={};this.C_c=0}static generateKey(da,qa){return qa?da+" [it]":da}}Object(h.a)(Ca,"FunctionCallAggregator",null,[606]);class Ia{}Ia.M4g="BatchedOperation";Ia.replication="Replication";Ia.Hak=
"25";Ia.RAj="9_"+Ia.M4g+"_"+Ia.replication;Object(h.a)(Ia,"CpuMeterConstants",null,[]);class oa{}Object(h.a)(oa,"CpuMeterFrame",null,[]);class Da extends Sys.EventArgs{constructor(da){super();this.NFf=da}}Object(h.a)(Da,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class bb{}Object(h.a)(bb,"MiniTaskItemInfo",null,[]);class Za{}Object(h.a)(Za,"TaskItemInfo",null,[]);var Xa=a(562),Ba=a(106);class Wa{static lii(){if(!Wa.zWb&&(Wa.zWb=new Ba.a,v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.Dq("AggregatorIdDisabledList"))){const da=
v.AFrameworkApplication.fa.Kw("AggregatorIdDisabledList");for(let qa=0;qa<da.length;qa++)Wa.zWb.ia(da[qa],!0)}return Wa.zWb}}Wa.zWb=null;Object(h.a)(Wa,"DisabledAggregatorListStore",null,[]);var Na=a(281);class ta{constructor(da,qa,Xb,Pc,zd,ce=!0,we=null){this.iZ=this.Zre=this.oje=!1;this.Ce=null;if(!da)throw Na.a.argument("taskManagerLazy");if(!zd)throw Na.a.argument("dataAggregator");this.dPg=da;this.bWc=qa;this._id=Xb;this.Ghe=6E4*Pc;this.MXb=zd;this.mpe=ce;this.Qpb=we;Wa.lii().Fb(this._id.toString())&&
(this.iZ=!0)}get taskManager(){return this.Ce||(this.Ce=this.dPg.value)}track(da,qa=null){this.iZ||(this.cEh(),this.rHj(),this.MXb.kba(da,qa))}rHj(){!this.oje&&0<this.Ghe&&(this.oje=!0,this.R$f())}R$f(){const da=new W.a(5,1,this.Ghe,()=>{this.vJj()},19,this._id.toString());this.taskManager.jg(da)}vJj(){!this.Qpb||this.Qpb.rTj()?this.$ag():this.mpe&&this.MXb.reset();this.R$f()}$ag(){const da=this.MXb.getData();if(da){const qa=parseInt(String(da.length));if(isNaN(qa)||0<qa)this.MCc(da),this.mpe&&this.MXb.reset()}}MCc(da){l.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:da})}cEh(){this.Zre||(this.bWc(()=>{this.$ag()}),this.Zre=!0)}static SN(da,qa,Xb,Pc,zd){return new ta(new Xa.a(()=>v.AFrameworkApplication.Mi),v.AFrameworkApplication.zib,da,qa,Xb,Pc,zd)}static h7a(da,qa,Xb){return ta.SN(da,qa,Xb,!0,null)}}Object(h.a)(ta,"Aggregator",null,[608]);class V{constructor(da=null){this.zn=null;this.reset();this.Qpb=da}kba(da,qa){if(!this.Qpb||this.Qpb.rTj())qa in this.zn||(this.zn[qa]=[]),this.zn[qa].push(da)}getData(){return L.a.count(this.zn)?
this.zn:null}reset(){this.zn={}}}Object(h.a)(V,"NamedValuesAggregator",null,[606]);var ia=a(234);class X{constructor(da,qa,Xb,Pc,zd){this.iIa=0;this.AF=null;this.k1b=this.Jre=0;this.$pe=!1;this.eZa=0;this.Jnb=!1;this.Cta=null;this.rZb=0;this.Ume=new P.a;this.bPg=[];this.QM=da;this.WUc=qa;this.OQc=Xb;this.gle=Pc;v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ra("WrapSetTimeoutForTelemetryIsEnabled")&&this.RAd();this.vGg=zd;this.PQc=new Ca(100);this.qKg=ta.h7a(1,5,new V)}xye(da){this.Ume.addHandler("OnCpuMeterFrameAvailable",
da)}yeb(da,qa,Xb,Pc=null){Xb=Pc?Pc.priority:7;const zd=this.QM();this.start(qa,Xb);try{da()}finally{this.stop(qa,Pc),da=this.QM()-zd,this.gle.track(da,qa)}}OX(da,qa){const Xb=this.QM();try{da()}finally{da=this.QM()-Xb,this.OQc.kba(da,qa),0<this.iIa&&this.PQc.kba(da,qa),this.gle.track(da,qa)}}RKd(da){const qa=new Za;qa.TN=da.vrc;qa.TP=da.priority;this.r_f(1,qa)}Lbb(da){this.rZb|=da}start(da,qa){if(!this.iIa){this.PQc.reset();const Xb=this.zvf(da);Xb&&this.WEd(1);this.AF=new Za;this.AF.TN=da;this.AF.TP=
qa;this.AF.ST=(new Date).toISOString();this.AF.STS=Ua.a.D9(this.QM(),2);Xb?this.AF.UI=1:this.lEi(da)?this.AF.UI=2:this.AF.UI=0}this.iIa++}WEd(da){this.eZa|=da}v8c(da=!0,qa=0){this.eZa=da?0:this.eZa&~qa}stop(da,qa=null){let Xb;this.iIa--;0>=this.iIa&&this.AF&&(Xb=this.QM()-this.AF.STS,this.k1b+=Xb,this.WUc.kba(Xb,da),this.zvf(da)&&this.v8c(!1,1),this.AF.TRT=Ua.a.D9(Xb,2),qa&&(this.AF.TQT=Ua.a.D9(qa.joj,2),this.AF.TDT=Ua.a.D9(qa.Wwf,2)),this.vGg&&(this.r_f(0,this.AF),this.ABj()),this.iIa=0);0<=da.indexOf(Ia.Hak)&&
this.Lbb(2);0<=da.indexOf(Ia.RAj)&&this.Lbb(4);1===(this.eZa&1)&&this.Lbb(1);2===(this.eZa&2)&&this.Lbb(8)}ABj(){var da=this.AF.TRT;if(750<da){let Xb=this.PQc.getData();if(Xb){const Pc={};for(let zd in Xb){var qa=Xb[zd];const ce=zd;ce.startsWith("SiOp_")||ce.endsWith("[it]")||(Pc[ce]=Math.round(100*qa.T/da))}Xb=Pc}da=Object.assign(new bb,{B:this.AF.STS,T:da,S:Xb});this.qKg.track(da,this.AF.TN)}}Z_j(){var da=this.QM()-this.Jre,qa=Ua.a.D9(this.k1b/da*100,2);da=new oa;da.CP=qa;da.II=this.rZb;qa=this.WUc.getData();
L.a.count(qa)&&(da.LRT=qa);qa=this.OQc.getData();L.a.count(qa)&&(da.FP=qa);this.Ume.raiseEvent("OnCpuMeterFrameAvailable",new Da(da));this.Ekg()}Ekg(){this.WUc.reset();this.OQc.reset();this.k1b=this.iIa=0;this.Jre=this.QM();this.rZb=0;this.AF=null}run(){this.$pe?this.Z_j():(this.Ekg(),this.$pe=!0);this.Cta?this.Cta(Object(Z.a)(this,this.run,"run"),1E3):window.setTimeout(Object(Z.a)(this,this.run,"run"),1E3)}r_f(da,qa){da=this.bPg[da];if(!ia.a.sh(da))for(let Pc=0;Pc<da.length;Pc++){var Xb=da[Pc];const zd=
Xb[0];Xb=Xb[1];zd&&!zd(qa)||Xb(qa)}}RAd(){if(!this.Jnb){const da=window.setTimeout;this.Cta=(qa,Xb)=>da(qa,Xb);this.Jnb=!0}}zvf(da){return da.startsWith("key")||da.startsWith("input")}lEi(da){return da.startsWith("click")||da.startsWith("mouse")||da.startsWith("pointer")}}Object(h.a)(X,"CpuMeter",null,[59]);class la{constructor(da){this.Ulb=null;this.ql=new ja.a;this.QM=da}initialize(da,qa,Xb,Pc=!1){this.Ulb||(this.Ulb=new X(this.QM,da,qa,Xb,Pc),this.ql.setResult(this.Ulb));return this.Ulb}}Object(h.a)(la,
"CpuMeterProvider",null,[607]);class sa{constructor(da=1){this.Hy=[];this.UXb=[];this._count=da}WSh(){let da=0;for(let qa=0;qa<this.Hy.length;qa++)this.Hy[qa]<this.Hy[da]&&(da=qa);return da}kba(da,qa){da=Ua.a.D9(da,2);if(this.Hy.length<this._count)Array.add(this.Hy,da),Array.add(this.UXb,qa);else{var Xb=this.WSh();da>this.Hy[Xb]&&(this.Hy[Xb]=da,this.UXb[Xb]=qa)}}getData(){return this.Hy.length?{["Vals"]:this.Hy,["Desc"]:this.UXb}:null}reset(){this.Hy=[];this.UXb=[]}}Object(h.a)(sa,"MaxDataAggregator",
null,[606]);var Va=a(41),nb=a(84);class ha{get name(){return"Common.App.CpuMeter"}Di(da){da.register(la,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Uc().dd(()=>new la(Va.a.ve));da.register(Aa,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Uc().dd(()=>new Aa)}init(){const da=v.AFrameworkApplication.fa;if(da.ra("CpuMeterIsEnabled")){const qa=nb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");O.a.instance.PAe.continueWith(()=>{ha.wti(da,
qa)})}}dispose(){}static wti(da,qa){const Xb=ta.h7a(10,5,new Ca(da.oe("TaskManagerLoggingThreshold",0),da.oe("CpuMeterMaximumEntriesToLog",0)));qa=qa.initialize(new sa(5),new Ca,Xb,da.ra("CPUMeterExposeTaskDetailsIsEnabled"));da.ra("WordEditorInteractivePerfDisableCpuMeterFrames")||(qa.run(),da.ra("CpuMeterMonitorIsEnabled")&&nb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(qa,da.zNa("CpuMeterAverageCpuPercentThreshold",80),da.oe("CpuMeterRollingAverageFramesCount",15)));ya.a(16827671,
306,50,"Initializing CpuMeter")}static main(){r.a.instance.nj(new ha)}}Object(h.a)(ha,"CpuMeterPackage",null,[4,5]);var jb=a(988);class Fb{get name(){return"Common.App.EventsCachePackage"}Di(){}init(){jb.a.instance.init()}dispose(){}static main(){r.a.instance.nj(new Fb)}}Object(h.a)(Fb,"EventsCachePackage",null,[4,5]);var Rb=a(10),mb=a(229),sb=a(890),Ya=a(178),Ma=a(384),xb=a(210),qb=a(161),Ra=a(63),Jb=a(91),yb=a(1),Gb=a(23),ub=a(175),Ja=a(755);class zb extends sb.a{constructor(da,qa,Xb){super(qa,
Xb);this.Ra=new P.a;this.Opi=Pc=>{if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const zd=Pc.Values.m_Origin;v.AFrameworkApplication.wopiHostOriginFromPostMessage||(v.AFrameworkApplication.wopiHostOriginFromPostMessage=zd)}switch(Pc.MessageId){case Ya.a.Jsd:ub.a(this.$).Lhf(Pc);break;case Ya.a.DCd:qb.a.ltas(null);break;case Ya.a.Rkc:this.s7i();break;case Ya.a.Nsd:this.r7i(Pc)}};this.$=da;Xb!==Ja.a.HK&&this.QQ(Xb);this.Jui();this.Sti();da=this.Opi;this.hl(Ya.a.Jsd,da);
this.hl(Ya.a.DCd,da);this.hl(Ya.a.Rkc,da);this.hl(Ya.a.Nsd,da)}dispose(){this.$=null;super.dispose()}Jui(){this.fn(Ya.a.WGe);this.fn(Ya.a.Jsd);this.fn(Ya.a.Rkc);this.fn(Ya.a.Nsd);this.X0a(Ya.a.DCd);this.fn(Ya.a.Msd)}Sti(){this.QZ(Ya.a.Zqb);this.QZ(Ya.a.O_);this.QZ("App_CloseTab");this.QZ(Ya.a.KXa);this.QZ(Ya.a.LXa);this.QZ(Ya.a.Hkf);this.QZ(Ya.a.Okc);this.QZ("App_ModifyURLState")}s7i(){const da={};da.hostMessageReceived=(new Date).getTime();l.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");
v.AFrameworkApplication.apc=!0;da.appUnloadStart=(new Date).getTime();da.sendBeaconFlight=v.AFrameworkApplication.fa.ra("SendBeaconOnShuttingDownRequestsEnabled");da.sendBeaconSupported=Ra.a.nga();Ra.a.YAe();da.appUnloadEnd=(new Date).getTime();da.appMessageSent=(new Date).getTime();this.sendMessage(Ya.a.R0g,da)}r7i(da){l.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");da.Values&&Ma.a.UGd in da.Values&&Gb.a.equals(da.Values[Ma.a.UGd],xb.a.edit,!0)&&!this.$.isEditMode&&(l.ULS.sendTraceTag(537162881,
0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${da.Values[Ma.a.UGd]}`),da=new Jb.a(-8805455,0,1,0,null),this.$.Ia.$b(da))}}Object(h.a)(zb,"EwaHostMessenger",sb.a,[602,355,2]);class na extends mb.a{constructor(da){super();this.pMe=!1;this.$=da;this.kc()}create(){const da=this.$.da,qa=nb.a.instance;if(!this.pMe){this.pMe=!0;let Xb;Xb=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.xa.DocumentHostInfo.PostMessageOrigin||Ja.a.HK:v.AFrameworkApplication.iNd||
Ja.a.HK;qa.register(zb,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Uc().dd(()=>new zb(this.$,window.parent,Xb,v.AFrameworkApplication.fa.ra("HostSendReadyToAcceptPostMessage")))}this.Pb(da.Ba(21)||da.Ja(21,qa.resolve("Postmessage.IHostPostmessenger")))}}Object(h.a)(na,"HostMessengerFactory",mb.a,[]);var Ea=a(114),ma=a(173),Ka=a(712),cb=a(563),Fa=a(86),wa=a(136),ka=a(48),Oa=a(278),hb=a(362),Pa=a(366),ca=a(503),ba=a(7),ib=a(55),Lb=a(79);class gc{constructor(da,
qa,Xb){this.correlations=this.properties=this.operation=null;this.operation=da;this.properties=qa;this.correlations=Xb}static pQh(da,qa,Xb){const Pc={},zd=ib.b();switch(da.command){case -1537138325:Pc.Action=qa.LabelText;break;case -1104934572:Pc.PrevTab=zd.jk(parseInt(qa.OldContextCommand,10));Pc.NextTab=zd.jk(parseInt(qa.NewContextCommand,10));break;case 802602464:Pc.Origin=qa[ba.a.xI];break;case -1027730316:case -1059615499:Pc.MenuType=qa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in
qa&&(Pc.SqmControlId=qa.SqmControlId);break;case 1371713064:case 875133075:Lb.a.rd in qa&&(Pc.SampleTableId=qa[Lb.a.rd])}Pc.InputMethod=hb.a[da.method];Pc.Location=Pa.a[da.yf];Pc.Mode=ca.a[da.mode];Pc.ParentName=da.tabName;Pc.IsSystemInitiated="IsSystemInitiated"in qa?qa.IsSystemInitiated:!1;Pc.NoReporting="NoReporting"in qa?qa.NoReporting:!1;"ControlIdToLog"in qa&&(Pc.ControlId=qa.ControlIdToLog);"TerminalParentControlIdToLog"in qa&&(Pc.TerminalParentControlId=qa.TerminalParentControlIdToLog);for(const ce of Object.keys(Xb))Pc[ce]=
Xb[ce];return Pc}}Object(h.a)(gc,"InteractivityRecord",null,[]);class Gc extends gc{constructor(da,qa,Xb){super(da.operation,da.properties,da.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=qa;this.timeFromNavigationStart=Xb}}Object(h.a)(Gc,"FirstUserInteractivityRecord",gc,[]);var Kb=a(662);class pb{constructor(){this.commandSurface=this.triggerMethod=Ea.a.Hjb}static Kti(){pb.B6a||(pb.B6a=new Kb.a(cb.a.Ah()),pb.B6a.add("InputMethod"),pb.B6a.add("Location"),
pb.B6a.add("Mode"))}}pb.B6a=null;Object(h.a)(pb,"ExcelUserAction",null,[]);var nc=a(220),Wb=a(44),Ha=a(436),$a=a(152),Nb=a(149),rb=a(36);class ec extends Fa.a{constructor(da){super();this.pnf=0;this.G4e=!1;this.lBd=Array(ec.Pbb);this.Cac=0;this.$=da;this.$uf=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");Ea.a.jai();this.Oda={};ec.o3b||(ec.o3b=new Ka.a(cb.a.Ah()),ec.Vsi(ec.o3b));pb.Kti();if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(da=
0;da<ec.Pbb;da++)this.lBd[da]="NA"}dispose(){this.$=this.Oda=null;super.dispose()}Z5f(da,qa,Xb){const Pc=ib.b().jk(da.command),zd=JSON.stringify(da);Pc||l.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${Pc}, command: ${da.command}, commandInfo: ${zd}`);qa=gc.pQh(da,qa,Xb);Xb=!!qa&&(!("IsSystemInitiated"in qa)||!qa.IsSystemInitiated);this.$&&this.$.ea.Of&&Xb&&jb.a.instance.X0f("OtelUserAction",new Ha.a(Pc,da.tabName,Date.now()));this.o6f(Pc,
qa,null,!0,!0)}Ld(da,qa,Xb=null,Pc=!1){this.o6f(da,qa,Xb,!1,Pc)}ZFc(da){if(this.Oda){++this.pnf;this.Oda[da]||(this.Oda[da]=[]);var qa=this.pnf.toString();this.Oda[da].push(qa);l.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${da}', correlation=${qa}`)}else l.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${da}] == null`)}lGc(da){if(this.Oda&&this.Oda[da]){var qa=this.Oda[da],Xb=qa.pop().toString();
qa.length||delete this.Oda[da];l.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${da}', correlation=${Xb}`)}else l.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${da}] == null`)}tR(da,qa,Xb=!1){return Oa.b(Pc=>{this.Ld(da,Pc(),void 0,Xb)},ec.X5j,this.ka,ka.a.Iwi,!1,!qa)}sTd(){let da="";for(let qa=0;qa<ec.Pbb;qa++)da+=this.lBd[(this.Cac+ec.Pbb-qa-1)%ec.Pbb]+",";l.ULS.sendTraceTag(557188890,0,15,`Last operations ${da}`)}Zek(da){da&&
(this.lBd[this.Cac]=da,this.Cac=(this.Cac+1)%ec.Pbb)}iQi(da,qa,Xb){v.AFrameworkApplication.sdc();const Pc=da.operation,zd=da.properties;void 0!==Xb?void Nb.a.resolve(rb.fb,{Wa:0}).then(ce=>{ce.osj(Pc,zd,Xb)}):this.Rak(da);this.Sak(da);this.gfj(qa,zd,Pc)}Rak(da){this.d_j(da)||(this.G4e=!0,da=new Gc(da,Wb.PageLoadTrackingInfo.instance.lya(new Date),Wb.PageLoadTrackingInfo.Hu()),da=Sys.Serialization.JavaScriptSerializer.serialize(da),l.ULS.sendTraceTag(458261331,0,50,`${da}`))}d_j(da){const qa=da.properties;
da=da.operation;return this.G4e||void 0===da||null===da||da===wa.a.R0c||da===wa.a.BWd||da===wa.a.INd||Ra.a.uyd(da)||!!qa&&"IsSystemInitiated"in qa&&qa.IsSystemInitiated}Sak(da){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Zek(da.operation);da=Sys.Serialization.JavaScriptSerializer.serialize(da);l.ULS.sendTraceTag(21542793,0,50,`${da}`)}gfj(da,qa,Xb){Ea.a.Jna()&&(qa?"NoReporting"in qa&&qa.NoReporting||"IsSystemInitiated"in qa&&qa.IsSystemInitiated||!da&&
!this.$uf||((da=Ea.a.Yh(qa,ec.o3b,pb.B6a))?(qa=ec.yQh(qa))?ma.a.sendUserActionEvent(Ea.a.iac(Xb,null,qa.triggerMethod,qa.commandSurface,da)):l.ULS.sendTraceTag(537155550,0,50,"user action was null"):l.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):l.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${Xb}`))}o6f(da,qa,Xb,Pc,zd){const ce=nc.a(this.$);if(this.$uf){let De=null;Gb.a.equals(da,wa.a.zCc,!0)&&qa&&"InputMethod"in
qa&&(De=wa.a.I5e(da,qa.InputMethod));ce.aPb(De||da,Xb)}else Gb.a.equals(da,wa.a.zCc,!0)&&qa&&"InputMethod"in qa&&(da=wa.a.I5e(da,qa.InputMethod)),ce.aPb(da,Xb);qa&&(qa.IsCommand=Pc);let we="ActionRelativeTime"in qa?qa.ActionRelativeTime:Wb.PageLoadTrackingInfo.Hu();Object($a.c)(()=>{const De=new gc(da,qa,this.Oda);this.iQi(De,zd,we)},this.$.ka,50)}static yQh(da){if(!da)return null;const qa=new pb;"InputMethod"in da&&(qa.triggerMethod=da.InputMethod);"Location"in da&&(qa.commandSurface=da.Location);
return qa}static Vsi(da){da?(da.add("Origin",2),da.add("InputMethod",2),da.add("ButtonType",2),da.add("selectedRange",2),da.add("SelectedRanges",2),da.add("editRange",2),da.add("Location",2),da.add("Mode",2),da.add("CurrentSelectionMode",2),da.add("Action",2),da.add("type",2),da.add("floatingObjectType",2),da.add("PrevTab",2),da.add("NextTab",2),da.add("DialogName",2),da.add("dx",3),da.add("dy",3),da.add("NumberOfSelectedRanges",3),da.add("IsCommand",1),da.add("IsInFormulaBarEdit",1),da.add("isLink",
1),da.add("isSheetRef",1),da.add("isEmptyText",1),da.add("isFormula",1),da.add("IsResizingHiddenHeader",1)):l.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}ec.X5j=1E3;ec.Pbb=40;ec.o3b=null;Object(h.a)(ec,"InteractivityLogger",Fa.a,[12]);var pc=a(119),vb=a(2);class ob{constructor(){this.appInfoProperties=this.appState=null}}Object(h.a)(ob,"CurrentAppInfo",null,[]);const Tb=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])}].forEach(da=>{da.actions.forEach(qa=>{Tb.set(qa,da.name)})});class Rd{constructor(){this.value=this.key=null}}Object(h.a)(Rd,"AppInfoProperty",null,[]);class Jd{constructor(da){this.$=da}getAppState(){const da=Wb.PageLoadTrackingInfo.instance.lya(new Date);return-1===da?"boot":3E4>da?"postboot":"steady"}isChangeGateEnabled(da){return yb.EwaSettings.isChangeGateEnabled(da)}getBooleanFeatureGate(da,qa){return yb.EwaSettings.getBooleanFeatureGate(da,qa)}getCurrentAppInfo(){return Object(vb.a)(new ob,
{appState:this.getAppState(),appInfoProperties:[Object(vb.a)(new Rd,{key:"coauthCount",value:this.$.ea.to.length.toString()})]})}sendBeaconTraceTag(da,qa,Xb,Pc){this.$.sendBeaconTraceTag(da,qa,Xb,Pc)}getActionBucket(da){return c(da)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.dVi}`}}Object(h.a)(Jd,"InteractivityTrackerCallbacks",null,[657]);class ld{constructor(){this.events=null;this.durationThresholdInMs=0;this.periodicReport=this.patchTaskScheduling=this.callbacks=null}}Object(h.a)(ld,
"InteractivityTrackerOptions",null,[]);const Yd=(da,qa)=>Object(pc.a)(void 0,void 0,void 0,function*(){return Nb.a.resolve(rb.x,qa).then(Xb=>Xb("interactivity"))});Object(Nb.b)(rb.V,{Ux:"singleton"})(da=>Object(pc.a)(void 0,void 0,void 0,function*(){const qa=yield Nb.a.resolve(rb.A,da);yield Yd(qa,da);const Xb=interactivity.InteractivityTrackerFactoryGlobal.create();return new Ke(qa,Xb)}));class Ke{constructor(da,qa=null){this.I0=qa;Ke.Irf?l.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):
(this.initialize(da),Ke.Irf=!0)}initialize(da){l.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||(this.I0=interactivity.InteractivityTrackerFactoryGlobal.create());if(this.I0){var qa=new ld;yb.EwaSettings.Yzd()&&Ke.JGc.push(ra.a.Gba);yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7457630_addSupportedEventMouseUpAndTouchStart")&&(Ke.JGc.push("mouseup"),
Ke.JGc.push("touchstart"));qa.events=Ke.JGc;qa.durationThresholdInMs=Ke.durationThresholdInMs;qa.callbacks=new Jd(da);qa.patchTaskScheduling=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);da=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReport",!1);const Xb=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReportPassiveTest",!1),Pc=yb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PeriodicReportIntervalMs",
6E4);if(da||Xb)qa.periodicReport={isPassiveTestEnabled:Xb,intervalMs:Pc};qa=this.I0.start(qa);qa.started?l.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):l.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+qa.failureReason)}else l.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}AEa(da,qa,Xb){if(this.I0)return this.I0.track(da,qa,Xb);l.ULS.sendTraceTag(524326924,
0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${qa}`)}pQe(){return this.I0?this.I0.createActionsRetriever():(l.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.I0&&(this.I0.stop(),this.I0=null)}addContext(da,qa,Xb){this.I0?this.I0.addContext(da,qa,Xb):l.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}}
Ke.durationThresholdInMs=100;Ke.JGc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");Ke.Irf=!1;Object(h.a)(Ke,"InteractivityTrackerService",null,[313]);var Bb=a(725);class Ob extends mb.a{constructor(da){super();this.$=da;this.kc()}create(){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?void Nb.a.resolve(rb.x,{Wa:this.La}).then(da=>da("interactivity")).then(()=>{Object(Bb.a)(this.$.da,443,()=>new Ke(this.$))}):this.Pb(Object(Bb.a)(this.$.da,
443,()=>new Ke(this.$)))}static la(da){da.da.Ja(444,new Ob(da))}}Object(h.a)(Ob,"InteractivityTrackerServiceFactory",mb.a,[]);var ed=a(40),Sd=a(92),Pd=a(480),ic=a(9),Kc=a(51),dc=a(61);class Hc{constructor(da){this.K_j=da}getCustomProperties(da){const qa=new Map;if(da.hasOwnProperty("startTimeInMs")&&da.hasOwnProperty("totalExecutionTimeInMs")){const Xb=da.startTimeInMs;da=this.K_j.retrieveSlowActionsBetweenTimeRange(Xb,Xb+da.totalExecutionTimeInMs);qa.set("actions",dc.a.Zc(da))}return qa}}Object(h.a)(Hc,
"CallTreeCustomPropertiesRetriever",null,[650]);class Uc{constructor(){this.customProperties=new Map}addCustomProperty(da,qa){this.customProperties.set(da,qa)}getCustomProperties(){return this.customProperties}}Object(h.a)(Uc,"CustomPropertiesRetriever",null,[649]);class Fd{isFeatureEnabled(da,qa){return yb.EwaSettings.getBooleanFeatureGate(da,qa)}}Object(h.a)(Fd,"ExcelFeatureChecker",null,[648]);class Td{isProfilingEnabled(){return!0}}Object(h.a)(Td,"ExcelProfilingFeatureChecker",null,[576]);class ad{constructor(da,
qa){this.hcj=da;this.jcj=qa}onProfilerEvent(da){switch(da.eventId){case 1:this.hcj(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.jcj();break;default:l.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${da.eventId}`)}}}Object(h.a)(ad,"JSCPUProfilerObserver",null,[575]);class Qd{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=
null}}Object(h.a)(Qd,"JSCPUProfilerInitOptions",null,[]);class Zb{constructor(){this.shouldRecordFrameCounts=this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=
this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=
this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(h.a)(Zb,"JSCPUProfilingPackageInitOptions",null,[]);class Wc{filter(da){var qa,Xb,Pc;const zd=!Wb.PageLoadTrackingInfo.instance.TTSI||(null===(qa=da.serializedFrames[0])||void 0===qa?void 0:qa.startTimeInMs)<Wb.PageLoadTrackingInfo.instance.Dak;qa=(null===(Xb=da.propertyBag)||void 0===Xb?void 0:Xb.actions)&&"[]"!==da.propertyBag.actions;Xb=!0;yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7846441_dontSendUnmergedTreesPreTTSI")&&
(Xb=0<(null===(Pc=da.serializedFrames[0])||void 0===Pc?void 0:Pc.totalExecutionTimeInMs));return zd&&Xb||qa}}Object(h.a)(Wc,"CallTreeCustomFilterer",null,[573]);let md=class{constructor(da,qa){this.interactivityTrackerService=this.Lkg=this.HOd=this.zeb=this.IOd=this.KYf=this.MYf=null;this.Umj=new Set([1,0]);l.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=da;this.interactivityTrackerService=qa;this.Fui();this.Eui();this.HKi=yb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingSampleIntervalInMs",
16);this.profilingIntervalInMs=yb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.gNe=yb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.Dfj=yb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.P1j()}dispose(){l.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");Sd.a.Ka(this.Lkg);this.HOd=this.$=null;this.IOd.clear();this.zeb.clear()}e1j(){const da=Math.random()*
this.gNe;l.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${da}`);this.Lkg=Kc.a.instance.create(()=>{this.pcf("ExcelOnlineContinuousSessionProfiler",2).start()},da,ka.a.ESj,!0)}r1j(){l.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.pcf("ExcelOnlineFullSessionProfiler",3).start()}LYf(da){return this.zeb.has(da)}P1j(){yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",
!1)?this.r1j():this.e1j()}createProfiler(da,qa,Xb,Pc,zd,ce){l.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const we=new Qd;we.samplingIntervalInMs=qa;we.maximumNumberOfSamplesToTake=Xb;we.idleIntervalInMs=Pc;we.profilingIntervalInMs=zd;return this.sqh(da,ce,we)}Eui(){const da=new Td,qa=new Zb;qa.ulsInstance=new Pd.a;qa.deObfuscationEndpoint="ProfilerReporting.ashx";qa.shouldCompressSerializedCallTrees=!1;qa.shouldKeepSamplesOutsideOfProfilingInterval=
!1;qa.shouldSendAllCallTreesFromProfileInASingleRequest=!yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);qa.shouldUseSendBeaconForSendingCallTrees=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);qa.callTreeFilteringThresholdInMs=yb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);qa.frameTotalExecutionTimeFilteringThresholdInMs=
yb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerFrameTotalExecutionTimeFilteringThresholdInMs",0);qa.deObfuscationRequestQueryParamsRetriever=this.jnh();qa.deObfuscationRequestBodyPropertiesRetriever=this.inh();qa.featureEnabledChecker=new Fd;qa.useMainEventLoopForProfilerTraceProcessing=!1;qa.profilerTraceProcessingWebWorkerSourceURL=this.$.xa.JSProfilerProcessingWebWorkerJsScriptUrl;qa.shouldProcessProfileCapturedWhileUserIsIdle=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");
yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldRecordProfilerFrameCounts",!1)&&(qa.shouldRecordFrameCounts=!0);this.HOd=this.MYf.retrievePackage(da,qa).retrieveProfilerFactory()}jnh(){const da=new Uc;da.addCustomProperty(ic.a.sZf,v.AFrameworkApplication.userType);da.addCustomProperty(v.AFrameworkApplication.zXa,v.AFrameworkApplication.userSessionId);da.addCustomProperty(ic.a.fHd,this.$.xa.SkipAuthentication?ic.a.dGf:null);da.addCustomProperty(ic.a.dPd,this.$.xa.MachineCluster);
return da}inh(){const da=new Uc;da.addCustomProperty("appName","Excel");da.addCustomProperty("buildVersion",v.AFrameworkApplication.buildVersion);da.addCustomProperty("shouldUseSourceMaps","true");da.addCustomProperty("shouldFilterSensitiveResources","true");da.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","false");return da}sqh(da,qa,Xb){const Pc=new Uc;Pc.addCustomProperty("ProfilerName",da);this.KYf.set(da,Pc);qa=this.HOd.createProfiler(qa,Xb,Pc);this.zeb.set(da,qa);da=this.Goh(da);
qa.subscribeProfilerObserver(da,this.Umj);yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7875154_ProcessCallStacksWithActionOrBeforeTTSI")&&(da=new Wc,qa.subscribeCallTreeCustomFilterer(da));return qa}Ebi(da){return this.LYf(da)?this.zeb.get(da):(l.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${da}) does not exist`),null)}pcf(da,qa){da=this.Dfj||da;return this.LYf(da)?this.Ebi(da):this.createProfiler(da,this.HKi,2E6,2===qa?this.gNe:null,0===qa?null:
this.profilingIntervalInMs,qa)}Goh(da){var qa=this.interactivityTrackerService;if(qa){const Xb=qa.pQe();if(Xb){qa=this.zeb.get(da);const Pc=new Hc(Xb);qa.subscribeCallTreeCustomPropertiesRetriever(Pc);qa=new ad(zd=>{Xb.startCollectingSlowActions(zd)},Object(Z.a)(Xb,Xb.stopCollectingSlowActions,"stopCollectingSlowActions"));this.IOd.set(da,qa);return qa}l.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}l.ULS.sendTraceTag(537155490,
0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}Fui(){this.MYf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.KYf=new Map;this.IOd=new Map;this.zeb=new Map}};md=Object(pc.b)([Object(Nb.d)(rb.W),Object(pc.c)(0,Object(rb.A)()),Object(pc.c)(1,Object(rb.V)()),Object(pc.c)(2,Object(rb.eb)())],md);Object(h.a)(md,"JsSelfProfilerManager",null,[559,2]);var Nd=a(100);class kd extends mb.a{constructor(da){super();this.$=
da;this.kc()}create(){l.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");ed.TaskExtensions.za((()=>Nd.d(Nb.a.resolve(rb.y,{Wa:this.La})))(),da=>{yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)?void Nb.a.Rwg(rb.V).then(qa=>{this.nPe(da.result,qa)}):this.$.da.Gb(443,qa=>{this.nPe(da.result,qa)})},this.$.ka,3)}nPe(da,qa){ed.TaskExtensions.za(Nd.d(da.eu.loadScript("officeOnlineCpuProfiling")),
()=>{const Xb=Object(Bb.a)(this.$.da,437,()=>new md(this.$,qa));this.Pb(Xb)},this.$.ka,3)}static la(da){da.da.Ja(438,new kd(da))}}Object(h.a)(kd,"JsSelfProfilerManagerFactory",mb.a,[]);class yd{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(h.a)(yd,"ActionData",null,[]);class lc{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(h.a)(lc,"BlockedEngagementInfo",null,[]);class Lc extends yd{constructor(){super();this.inputMethod=
null;this.isCommand=!1}}Object(h.a)(Lc,"SuccessfulActionData",yd,[]);class nd{constructor(){this.successfulActions=[]}}Object(h.a)(nd,"SuccessfulEngagementInfo",null,[]);var Wd=a(49),$d;let se=$d=class{constructor(da){this.PMa=new Set;this.iTb=null;this.F4e=this.nmg=!1;this.tdb=(qa,Xb)=>{this.Ptb.hasBlockedActions=!0;qa=this.Ptb.blockedActions.length;const Pc=Xb.details?Xb.actionName+"_"+Xb.details:Xb.actionName;Xb=Object(vb.a)(new yd,{order:qa+1,name:Pc,componentName:Xb.componentName,timeFromNavigationStart:Xb.timeFromNavigationStart});
this.Ptb.blockedActions.push(Xb)};this.Ig=()=>{Wd.a(this.$).EOb(this.tdb);this.XOi();this.iTb=Kc.a.instance.create(()=>{this.iIb()},$d.v3j,ka.a.iIb)};this.Xc=()=>{this.iIb()};this.rPd=()=>{this.$.xd(2009315810,-1,0,null);this.o_d=!1};this.Ptb=new lc;this.Ptb.hasBlockedActions=!1;this.Bib=new nd;this.URh();this.$=da;this.$.ea.nk(this.Ig);this.$.Xj(this.Xc);this.y3j=0;this.o_d=!1;yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.FNe=new Promise(qa=>
{this.Nkh=qa}));Wd.a(this.$).H4b(this.tdb)}dispose(){this.$.ea&&this.$.ea.Pm(this.Ig);this.$.Ll(this.Xc);Sd.a.Ka(this.iTb);this.$=this.iTb=null}osj(da,qa,Xb){if(void 0!==da&&null!==da&&qa){var Pc=this.Bib.successfulActions.length+1,zd="InputMethod"in qa?qa.InputMethod:"",ce="IsCommand"in qa&&qa.IsCommand;if(this.kJi(da,qa,zd,ce)){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7472163_PerformanceSurveys")&&++this.y3j===$d.Bhk?(this.o_d=!0,this.Mhj=Kc.a.instance.create(this.rPd,5E3,ka.a.rPd)):this.o_d&&
this.Mhj.Zq();if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const we=!ce&&da;this.F4e||we===wa.a.Hwg||we===wa.a.Iwg||we===wa.a.Ewg||we===wa.a.Fwg||(this.F4e=!0,this.Nkh(void 0))}Pc>$d.tDf||(da=Object(vb.a)(new Lc,{order:Pc,name:da,componentName:"Location"in qa?qa.Location:"",timeFromNavigationStart:Xb,inputMethod:zd,isCommand:ce}),this.Bib.successfulActions.push(da),1===Pc?this.QPi():Pc===$d.tDf&&this.iIb())}}}XOi(){l.ULS.sendTraceTag(254546634,
0,50,`${J.c(this.Ptb)}`)}QPi(){Wb.PageLoadTrackingInfo.instance.lya(new Date)>$d.fSh?l.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${J.c(this.Bib.successfulActions[0])}`):l.ULS.sendTraceTag(254563592,0,50,`${J.c(this.Bib.successfulActions[0])}`)}iIb(){!this.nmg&&this.Bib.successfulActions.length&&(this.nmg=!0,Sd.a.Ka(this.iTb),this.iTb=null,this.$.sendBeaconTraceTag(254559496,50,!1,J.c(this.Bib)))}URh(){this.PMa.add(wa.a.R0c);this.PMa.add(wa.a.BWd);this.PMa.add(wa.a.INd);
this.PMa.add(wa.a.iXf);this.PMa.add(wa.a.kXf);this.PMa.add(wa.a.mXf)}kJi(da,qa,Xb,Pc){Xb=!Xb||"unknown"===Xb;const zd="IsSystemInitiated"in qa&&qa.IsSystemInitiated;qa="NoReporting"in qa&&qa.NoReporting;const ce=this.PMa.has(da);da=Gb.a.equals(da,wa.a.zCc,!0)&&Xb;return!zd&&!qa&&!ce&&!da&&!(Pc&&Xb)}};se.tDf=10;se.fSh=6E4;se.v3j=12E4;se.Bhk=25;se=$d=Object(pc.b)([Object(Nb.d)(rb.fb),Object(pc.c)(0,Object(rb.A)())],se);Object(h.a)(se,"PageLoadEngagementInfo",null,[]);Object(Nb.b)(rb.eb)(()=>Object(pc.a)(void 0,
void 0,void 0,function*(){yield Nb.a.resolve(rb.x,{Wa:0}).then(da=>da("officeOnlineCpuProfiling"));return officeOnlineCpuProfiling}));var je=a(52),Le=a(57),oe=a(142),ue=a(525),df=a(42),Se=a(83),bf=a(428),Ye=a(38),gf=a(244);class nf extends Sys.EventArgs{constructor(da){super();this.DR=da}}Object(h.a)(nf,"ErrorDataArgs",Sys.EventArgs,[]);var oc=a(668),Ac=a(116),xa=a(32);class Cb{constructor(da,qa){this.iXb=null;this.Yac=this.Esd=!1;this.lqe=this.mqe=null;this.R8a=this.Q8a=0;this.Y$f=da;this.zne=qa}get lUf(){return this.zne}get hQb(){return this.mqe}get X$f(){return this.lqe}get FKi(){return this.KGe(this.Y$f.getTime())}get Yfj(){return this.KGe(this.X$f.getTime())}get Jgg(){return!(this.Yac||
void 0===window.bsqmXLSPageLoadStartTime)}get U8c(){try{return this.iXb||(this.iXb=Ac.toUtc(window.bsqmXLSPageLoadStartTime)),this.iXb}catch(da){return null}}set U8c(da){this.iXb=da}XPj(da){this.Yac||(this.mqe=da,this.lqe=Ac.toUtc(this.hQb))}Upi(da){if(da.Values&&(!this.Q8a||!this.R8a))try{Ma.a.Mkf in da.Values&&(this.Q8a=parseInt(da.Values[Ma.a.Mkf].toString(),10));Ma.a.Nkf in da.Values&&(this.R8a=parseInt(da.Values[Ma.a.Nkf].toString(),10));const qa=O.a.instance;0<this.Q8a&&(this.bAf(this.Q8a,"PageLoadFromHostClick"),
qa.qsj(this.Q8a));0<this.R8a&&(this.bAf(this.R8a,"PageLoadFromHostFrameCreation"),qa.rsj(this.R8a));const Xb=da.Values[Ma.a.Xpi]||0,Pc=da.Values[Ma.a.Vpi]||da.Values[Ma.a.Wpi]||0;0<Pc&&qa.Yrj(Pc);qa.Zrj(Xb)}catch(qa){}}eDj(){this.Y$f=this.U8c=xa.a.Bb.Cc;this.zne=0;this.Esd=this.Yac=!1}KGe(da){const qa=this.U8c.getTime();return qa>=da?0:da-qa+this.lUf}bAf(da,qa){if(da){const Xb=ib.b();Xb.aGc("UserAction",qa,qa,xa.a.HEd(da),oc.EcmaDateClock.instance.appStart);Xb.mdc(qa,Ac.toTimestamp(this.hQb))}}}Object(h.a)(Cb,
"PageLoadPerfInfo",null,[]);var bc=a(76);class Fc{constructor(da,qa,Xb){this.sZc=da.keyCode;this.TQb(da.ctrlKey,1);this.TQb(da.shiftKey,2);this.TQb(da.altKey,4);this.TQb(bc.b(da),8);this.TQb(Xb,16);this.sZc=this.pib|qa<<24}get pib(){return this.sZc}get keyCode(){return this.pib&65535}TQb(da,qa){da&&(this.sZc=this.pib|qa<<16)}}Object(h.a)(Fc,"ShortcutSqmData",null,[]);class Tc{constructor(){this.JDd=null;this.ygh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.x7f()}mbh(da,qa,Xb){0===
Xb&&(Xb=this.ygh[qa.toString()]);return Tc.Igg(da,Xb)&&(da=new Fc(da,Xb,x.a.isMac),!Ye.a.$g(this.JDd,da.pib.toString()))?(this.JDd[da.pib.toString()]=!0,da):null}x7f(){this.JDd={}}static sCi(da){return 112<=da&&123>=da||61440<=da&&61451>=da}static RDi(da){return 17!==da&&18!==da&&16!==da&&91!==da&&93!==da}static Igg(da,qa){let Xb=da.ctrlKey||da.altKey||bc.b(da);da=da.keyCode;Xb=Tc.sCi(da)||Xb;Xb=Tc.RDi(da)&&Xb;return 0!==qa&&Xb}}Object(h.a)(Tc,"UnhandledShortcutLogger",null,[]);class gd{constructor(da){this.t9b=
[];this.Q0g=null;this.sqmManager=da}V3b(da){this.t9b.push(da)}a8(da,qa,Xb){try{if(qa)qa.endTime=Xb,this.sqmManager.Lve(qa);else for(let Pc=0,zd=this.t9b.length;Pc<zd;Pc++){const ce=this.t9b[Pc];da?(ce.endTime=ce.startTime,ce.ELe=0):ce.endTime=Xb;this.sqmManager.Lve(ce)}}catch(Pc){}finally{this.t9b.length=0}}}Object(h.a)(gd,"UserInteractionPerfInfo",null,[]);var td=a(39),kb=a(74),Vb=a(240);class qc extends Fa.a{constructor(da,qa){super();this.wrd=this.ePb=!1;this.Mgg=!0;this.Ra=new df.a;this.UOc=!1;
this.Xc=()=>{const Xb=kb.a(this.$).Qd.activityState,Pc=Ye.a.$g(Xb,td.a.ove);Ye.a.$g(Xb,td.a.rrb)||Pc||this.upload()};this.$=da;this.OAb=qa;this.ea=da.ea;this.$.Xj(this.Xc);this.trg=new Tc;this.KSa=new Cb(Ra.a.QVd,da.xa.PageGenerationMetrics.TimeToCompleteFirstFlush);this.mKc=new gd(this)}j2c(da){this.Ra.addHandler("EREK",da)}hSd(da){this.Ra.removeHandler("EREK",da)}get eth(){return this.UOc}get owi(){return this.$.frame.xS?ic.a.qwi:ic.a.pwi}get workbookContext(){return this.$.workbookContext}get jV(){qc.glb||
(qc.glb=this.uXe());qc.$5c||(qc.$5c=!0,this.wmf());return qc.glb}set jV(da){qc.glb=da;qc.glb||(qc.$5c=!1)}get b5(){return Se.a(this.$.xa,3)}dispose(){this.eth&&v.AFrameworkApplication.Co&&v.AFrameworkApplication.Co.disable();this.$&&this.$.Ll(this.Xc);this.$=this.mKc=this.KSa=this.jV=null;super.dispose()}Lhf(da){this.KSa.Upi(da);this.YPi()}mXd(da){this.setDw(9415,da)}V3b(da){this.mKc.V3b(da)}a8(da,qa,Xb){this.mKc.a8(da,qa,Xb)}fDd(da){this.b5&&(da=this.$.isEditMode||da&&this.ea.workbookContext.Options&
512?2:this.ea.Gc.inEmbedView?14:1,this.setDw(8721,da),this.ZTh(da),this.UOc=!1)}qAf(){const da=this.KSa;this.b5&&da.Jgg&&(this.setDw(9450,da.lUf),this.setDw(9085,da.FKi))}rAf(da){if(!this.ePb){this.ePb=!0;const qa=this.KSa;let Xb=0;this.b5&&qa.Jgg?(qa.XPj(da),this.mKc.Q0g=qa.X$f,this.setDw(9086,qa.Yfj),qa.Yac=!0,Xb=this.KSa.hQb.getTime()):Xb=da.getTime();ed.TaskExtensions.za(this.OAb.value,Pc=>{Pc.result.sendMessage(Ya.a.J0g,{[Ma.a.K0g]:Xb})},this.ka,3)}}Lve(da){this.b5&&da&&1!==da.Ega&&this.cja(8327,
gf.b(da),gf.l(da),gf.a(da),2,da.ELe,gf.m(da),gf.d(da),gf.e(da))}oTd(da,qa){da&&da.MessageIdHash&&this.nTd(da.MessageIdHash,da.MessageIdName,da.MessageId,da.ErrorCause?da.ErrorCause:Le.a.EIc,!1,qa,da,null)}nTd(da,qa,Xb,Pc,zd,ce,we,De){qc.appEncounteredFirstError||(qc.appEncounteredFirstError=!0,oe.a.get_instance().isCompleted(13)||(oe.a.get_instance().Ot(13),l.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));da=this.vyb(da);const kf=!!we,Ue={};Ue.ErrorName=
qa;Ue.ErrorHashCode=da.toString();Ue.ErrorId=Xb.toString();Ue.ErrorCause=Pc.toString();Ue.ErrorType=0===ce?"ErrorDialog":"BusinessBar";Ue.BusinessBarEntryName=De||"null";Ue.ServerCorrelationId=kf?we.CorrelationId:"null";Ue.WebMethodName=kf?we.WebMethodName:"null";Ue.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Ue.WfeServerId=kf?we.WfeServerId:"null";qa=dc.a.Zc(Ue);this.Ra.raiseEvent("EREK",new nf(Ue));l.ULS.sendTraceTag(1881314,0,15,qa);this.b5&&(S.a.$0f(da.toString()),
this.cja(9134,da,Pc,Le.a.Z5d),this.ea.Ow||zd||(this.setDw(10459,da),this.fDd(!0),this.wrd=!0,this.upload(),this.wmf()))}vyb(da){return 5439488|(da>>>16^da&65535)&65535}BDd(da,qa,Xb){da=this.trg.mbh(da,qa,Xb);this.b5&&da&&this.cja(11007,da.pib)}upload(){!this.b5||!this.ePb&&!this.wrd||x.a.ng&&v.AFrameworkApplication.Wg?x.a.ng&&v.AFrameworkApplication.Wg&&l.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.jV.eVb(),this.UOc=!0);v.AFrameworkApplication.Co=this.jV=null;
this.KSa.eDj();this.ePb=!1;v.AFrameworkApplication.Co=this.jV=this.uXe();this.trg.x7f()}YPi(){const da=this.KSa;if(this.b5&&!da.Esd){var qa=da.Q8a,Xb=da.R8a,Pc=da.hQb.getTime();v.AFrameworkApplication.HN=da.hQb;qa&&this.setDw(10324,qa>Pc?0:Pc-qa);Xb&&this.setDw(10325,Xb>Pc?0:Pc-Xb);da.Esd=!0}}cja(da,...qa){this.b5&&this.jV.cja(da,...qa)}setDw(da,qa){this.b5&&this.jV.setDw(da,qa)}uXe(){bf.a.RXe(this.$.xa);return v.AFrameworkApplication.Co}ZTh(da){let qa;try{qa=Object(B.a)(Object,dc.a.Xi(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(Xb){l.ULS.sendTraceTag(537151311,
0,15,`Couldn't parse SessionStartInfoJson. Message: ${Xb.message}`);return}if(qa){let Xb=Object(B.a)(String,qa.ApplicationModeExtended),Pc=Object(B.a)(String,qa.ApplicationMode);Xb&&Pc&&(Xb=Xb.toUpperCase(),2!==da&&16!==da||"VIEW"!==Xb&&"UNIFIED"!==Xb?1!==da||"EDIT"!==Xb&&"UNIFIED"!==Xb||(Xb="VIEW",Pc="View"):(Xb="EDIT",Pc="Edit"),qa.ApplicationModeExtended=Xb,qa.ApplicationMode=Pc,v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=dc.a.Zc(qa))}}wmf(){const da=this.$.xa;this.jV.vO=!0;this.jV.qXa(da.BWsaStartTime);
this.setDw(59,83);this.ePb=!1;if(this.b5){const qa=da.DocumentHostInfo;this.Krh();this.setDw(8491,this.$.jF);this.setDw(9236,da.RequestedUILcid);this.setDw(8473,da.WacHostId);this.setDw(9902,gf.c(qa.ClusterId));yb.EwaSettings.ya(398)?this.jV.cdg(""):this.jV.cdg(da.FlightHolder?da.FlightHolder.FlightId:"");this.mXd(this.ea.Gc.inEmbedView?1:0);this.wrd=!1;this.setDw(9104,gf.c(qa.FileSourceId));this.setDw(10309,this.owi);this.WRj();v.AFrameworkApplication.Qb.aRd(ue.a.getInstance(!1))}}WRj(){O.a.instance.$si(this.jV);
if(this.Mgg){const da=O.a.instance;da.Urj();da.lsj();da.jsj();da.isj();da.dsj();this.Mgg=!1}}Krh(){this.createStream(8327,1,Vb.a.Vuh,Vb.a.Z4a);this.createStream(9134,1,3,Vb.a.Z4a);this.createStream(11007,1,1,Vb.a.Z4a)}createStream(da,qa,Xb,Pc){this.jV.createStream(da,qa,Xb,Pc)}}qc.glb=null;qc.$5c=!1;qc.appEncounteredFirstError=!1;Object(h.a)(qc,"SqmManager",Fa.a,[173,572]);var Bc=a(759);class $b{constructor(da,qa=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=da;this.buffered=qa}}Object(h.a)($b,
"PerformanceObserverInit",null,[]);class tc extends Sys.EventArgs{constructor(da){super();this.UXe=da}}Object(h.a)(tc,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Xc extends Sys.EventArgs{constructor(da){super();this.Clc=da}}Object(h.a)(Xc,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class qd{constructor(da){this.Ra=new df.a;this.mSc=!1;this.Ig=()=>{if(x.a.rp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.hSi)).observe(new $b([ic.a.NDd])),
this.mSc=!0)}catch(qa){this.mSc=!1,l.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${qa}`)}this.Ra.raiseEvent("ltpoiek",new Xc(this.Clc))}};this.hSi=qa=>{this.Ra.raiseEvent("ltoek",new tc(qa))};this.$=da;this.$.ea.Of?this.Ig(this,Sys.EventArgs.Empty):this.$.ea.nk(this.Ig)}get Clc(){return this.mSc}nye(da){this.Ra.addHandler("ltoek",da)}Dyj(da){this.Ra.removeHandler("ltoek",da)}EXg(da){this.Ra.addHandler("ltpoiek",da)}Eyj(da){this.Ra.removeHandler("ltpoiek",da)}dispose(){this.$.ea.Pm(this.Ig);
Sd.a.Ka(this.Ra);this.$=this.Ra=null}}Object(h.a)(qd,"LongTaskPerformanceObserver",null,[2]);var Cd=a(171);class Xd{constructor(da=0,qa=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=da;this.longTaskDuration=qa}get QDd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}FJi(da){return 100*this.QDd>da}fVg(da){this.dxe(da.longTaskDuration);this.V1c(da.activeSessionDuration)}dxe(da){this.longTaskDuration+=da}V1c(da){this.activeSessionDuration+=
da}}Object(h.a)(Xd,"LongTaskPerformanceData",null,[]);class ge{constructor(da,qa,Xb,Pc,zd){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=da;this.entireSessionData=qa;this.worstWindowData=Xb;this.postBootWindowData=Pc;this.maxUsersCount=zd}get reportName(){return"LongTaskPerformance"}static get zCh(){return new ge(!1,new Xd,new Xd,new Xd,0)}}Object(h.a)(ge,"LongTaskPerformanceDataStatistics",null,[279]);class ve extends Sys.EventArgs{constructor(da){super();
this.ODd=da}}Object(h.a)(ve,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Ie=a(387),Ee=a(300);class pf{constructor(da,qa){this.Ra=new df.a;this.GQa=this.f8=this.XT=this.jf=null;this.Owf=this.E_d=this.opc=!1;this.iRa=null;this.maxUsersCount=0;this.Yuc=(Xb,Pc)=>{Xb=Pc.UXe.getEntriesByType(ic.a.NDd);for(const zd of Xb)this.jf.xE(zd.duration)||v.AFrameworkApplication.qQa||(this.XT.dxe(zd.duration),this.Ra.raiseEvent("lttek",new ve(zd)),Xb={},Xb.LongTaskDuration=zd.duration,Xb.LongTaskStartTime=zd.startTime,
l.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Xb)))};this.Ig=()=>{this.E_d=!0;this.eGc()};this.GC=(Xb,Pc)=>{Pc&&(this.maxUsersCount=Math.max(this.maxUsersCount,Pc.Xhk));this.f8.maxUsersCount=this.maxUsersCount};this.Td=()=>{this.eGc()};this.Xc=()=>{this.aTb()};this.YNf=(Xb,Pc)=>{Pc.Clc&&this.eGc()};this.TAf=()=>{this.XT.V1c(Ac.getElapsedMilliseconds(this.GQa,xa.a.Bb.Cc));this.I1d(!0);var Xb=!1;this.f8.postBootWindowData.activeSessionDuration?(!this.Owf&&yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.tvg&&ib.b().r6f(2),I.Health.instance.recordKpiUsage(Ee.a.longJsTask,0,Ie.a.GKi,null),this.Owf=!0),!this.f8.isVetoSession&&this.XT.FJi(this.rwg)&&(this.f8.isVetoSession=!0,yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.tvg&&ib.b().s6f(2,this.fSi),I.Health.instance.recordKpiFailure(Ee.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.f8.worstWindowData.QDd<=this.XT.QDd&&(this.f8.worstWindowData=this.XT),this.f8.entireSessionData.fVg(this.XT)):
(this.f8.postBootWindowData=new Xd(this.XT.activeSessionDuration,this.XT.longTaskDuration),Xb=!0);const Pc={};Pc.LastWindowScore=this.XT;Pc.postBootWindow=Xb;Pc.CoauthersNumber=this.$.ea.to.length;Xb=JSON.stringify(Pc);l.ULS.sendTraceTag(20779346,0,50,Xb);this.XT=new Xd};this.Rtc=()=>{this.jf.ui||v.AFrameworkApplication.qQa||this.I1d(!1)};this.Qtc=()=>{this.XT.V1c(Ac.getElapsedMilliseconds(this.GQa,xa.a.Bb.Cc));this.GQa=null;this.iRa.cancel()};this.$=da;this.rwg=da.xa.LongTaskPerformanceVetoThreshold;
this.fSi="PercentageOver_"+this.rwg.toString();this.PDd=da.xa.LongTaskPerformanceWindowDurationInMs;this.BO=qa;this.tvg=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Gb(291,Xb=>{this.jf=Xb;this.eGc()});this.$.ea.Of?this.Ig(this,Sys.EventArgs.Empty):this.$.ea.nk(this.Ig);this.BO.EXg(this.YNf);this.$.Ql(this.Td);this.$.Xj(this.Xc)}FXg(da){this.Ra.addHandler("lttek",da)}Fyj(da){this.Ra.removeHandler("lttek",da)}dispose(){this.E_d=!1;this.aTb();this.$.Rm(this.Td);
this.$.Ll(this.Xc);this.BO.Eyj(this.YNf);Sd.a.Ka(this.iRa);this.BO=this.$=this.iRa=null;void 0!==this.jf&&null!==this.jf&&Sd.a.Ka(this.jf)}eGc(){void 0===this.jf||null===this.jf?l.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.BO.Clc?this.opc?l.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.E_d?(this.opc=!0,this.f8=ge.zCh,this.XT=new Xd,this.$.ea.fba(this.GC),this.maxUsersCount=this.$.ea.to.length,this.BO.nye(this.Yuc),this.jf.WIa(this.Qtc),this.jf.Lua(this.Rtc),v.AFrameworkApplication.a2c(this.Qtc),v.AFrameworkApplication.b2c(this.Rtc),this.iRa=Kc.a.instance.create(this.TAf,this.PDd,ka.a.fAf,!1),nc.a(this.$).TU(this.f8),this.jf.ui||v.AFrameworkApplication.qQa||this.I1d(!0),l.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):l.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):l.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}aTb(){this.opc&&(this.opc=!1,this.$.ea.Pm(this.Ig),this.BO.Dyj(this.Yuc),this.$.ea.v9(this.GC),void 0!==this.jf&&null!==this.jf&&(this.jf.Gfb(this.Qtc),this.jf.MCa(this.Rtc)),v.AFrameworkApplication.V3f(this.Qtc),
v.AFrameworkApplication.W3f(this.Rtc),this.iRa.cancel(),this.GQa=this.XT=this.f8=null,this.maxUsersCount=0)}I1d(da){da||void 0===this.GQa||null===this.GQa?(this.GQa=xa.a.Bb.Cc,this.iRa=Cd.AsyncMethodContext.ywb(this.TAf,da?this.PDd:this.PDd-this.XT.activeSessionDuration,ka.a.fAf,this.iRa)):l.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(h.a)(pf,
"LongTaskPerformanceTracker",null,[2]);var Xe=a(30);class Ve extends df.a{constructor(da,qa){super();this.statusBarManager=this.jf=null;this.ZNf=(Xb,Pc)=>{Pc.ODd&&Pc.ODd.duration>=this.iSi&&(this.iBf++,this.mxf=Pc.ODd.duration)};this.$=da;this.$.da.Gb(29,Xb=>{this.statusBarManager=Xb;Xb.BK(this)});this.$.da.Gb(291,Xb=>{this.jf=Xb});this.mxf=this.iBf=0;this.iSi=da.xa.LongTaskThresholdMs;this.xbb=qa;this.xbb.FXg(this.ZNf)}qr(da){this.addHandler("LTSCEK",da)}Rr(da){this.removeHandler("LTSCEK",da)}RA(){this.ro("QueryLongTasksCount")&&
this.raiseEvent("LTSCEK")}ut(da,qa){if("QueryLongTasksCount"!==da)return!1;this.Vli(qa);return!0}ro(){return yb.EwaSettings.ya(505)}dispose(){this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null);this.xbb.Fyj(this.ZNf);super.dispose()}Vli(da){const qa=`Long Tasks: ${this.iBf} | Last Task Duration: ${Math.round(this.mxf)}ms`;Xe.a.vp()?(da.LabelText=qa,da.Visible=!0):da.Value=qa}}Object(h.a)(Ve,"LongTasksStatusBarManager",df.a,[2,196,197]);var wf=a(12);class Ff{constructor(){this.rttMs=
this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(h.a)(Ff,"NetworkInfoData",null,[]);class db extends df.a{constructor(da){super();this.statusBarManager=null;this.H1c=!1;this.zGf=()=>{this.raiseEvent("NetworkInformation")};this.$=da;yb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.GO=this.B5d("connection")||this.B5d("mozConnection")||this.B5d("webkitConnection"))&&yb.EwaSettings.ya(410)&&da.da.Gb(29,qa=>
{this.statusBarManager=qa;qa.BK(this);this.GO.addEventListener("change",this.zGf);this.H1c=!0})}qr(da){this.addHandler("NetworkInformation",da)}Rr(da){this.removeHandler("NetworkInformation",da)}K7a(){return this.GO?Object(vb.a)(new Ff,{bandwidthMps:this.GO.downlink,rttMs:this.GO.rtt,connectionType:this.GO.type,effectiveConnection:this.GO.effectiveType,downlinkMaxMps:this.GO.downlinkMax}):null}ut(da,qa){if("QueryNetworkInformation"!==da)return!1;this.Wli(qa);return!0}ro(){return this.H1c}dispose(){this.H1c&&
(this.statusBarManager&&(this.statusBarManager.cH(this),this.statusBarManager=null),this.GO&&this.GO.removeEventListener("change",this.zGf));this.$=null;super.dispose()}B5d(da){return wf.HelperMethods.qo(window.navigator,da)?window.navigator[da]:null}Wli(da){const qa="Network: "+this.GO.downlink.toString()+" Mbps, "+this.GO.rtt.toString()+" ms";Xe.a.vp()?(da.LabelText=qa,da.Visible=!0):da.Value=qa}}Object(h.a)(db,"NetworkInformationManager",df.a,[196,197]);var U=a(199),Ta=a(20);class wb{constructor(da=
"",qa=-1,Xb=-1,Pc=-1,zd=!1,ce=!0,we=!0,De=!1,kf="",Ue=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=da;this.startTime=qa;this.startToNextFrame=Xb;this.startToResponseRenderEnd=Pc;this.wasHidden=zd;this.isUserOperation=ce;this.isGroupBreaking=we;this.operationThatLedToLogging=kf;this.startToOperationThatLedToLogging=
Ue;this.isPartOfGroup=De}}Object(h.a)(wb,"OperationStatisticsData",null,[]);var Qb=a(85);class sc{constructor(){this.operationsGroups=null;this.tsi()}isGroup(da,qa,Xb){const Pc=new U.a;Pc.addRange(da);Pc.addRange(qa);for(let zd=0;zd<this.operationsGroups.count;zd++)if(this.qFi(this.operationsGroups.ma(zd),Pc,Xb))return l.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${Xb}' is part of a group ( operationsList: ${this.STf(da)} , frameOperationsList: ${this.STf(qa)})`),!0;l.ULS.sendTraceTag(595194767,
1,50,`OperationsGroupDetector: Operation '${Xb}' is NOT part of a group.`);return!1}qFi(da,qa,Xb){let Pc=0;for(let zd=0;zd<qa.count;zd++)if(qa.ma(zd).isGroupBreaking){if(da.count<=Pc||!Gb.a.equals(qa.ma(zd).name,da.ma(Pc),!0))return!1;Pc++}return da.count>Pc&&Gb.a.equals(Xb,da.ma(Pc),!0)}STf(da){da=Qb.select(da,qa=>qa.name);return`[${Qb.toArray(da).join(", ")}]`}tsi(){this.operationsGroups=new U.a;this.a1a(new U.a(["Paste","SelectingRange_unknown"]));this.a1a(new U.a(["AutoSum","SelectingRange_unknown"]));
this.a1a(new U.a(["ChangeSheetDirection","ActiveItemChanged"]));this.a1a(new U.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.a1a(new U.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.a1a(new U.a(["EditBoxEndEdit","SetCell","SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}a1a(da){this.operationsGroups.add(da)}}Object(h.a)(sc,"OperationsGroupDetector",null,[]);var Vc=a(26);class Ld{constructor(da,qa,Xb,Pc){this.framePerformanceTracker=
this.TOb=this.G1=this.L2=null;this.nBj=()=>{this.E3c=-1;const zd=wf.HelperMethods.lc();this.wgk(zd);yb.EwaSettings.ya(326)&&(this.oQb&&(l.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.VUb(this.cG,zd),this.oQb=!1),this.znc&&(this.VUb(this.RE,zd),this.oQb||this.VUb(this.cG,zd)));window.setTimeout(this.WPi,0)};this.WPi=()=>{var zd=[];const ce=this.$.xa.OperationToPrevOperationThreshold;for(var we=0;we<
this.cG.count;we++){var De=this.cG.ma(we);we<ce&&zd.push(De);this.RE.add(De)}Ta.h(this.$)&&Ta.h(this.$).Ca?((we=this.sessionStatisticsManager.dmd(0))?(De=JSON.stringify(this.nIb),zd=JSON.stringify(zd),l.ULS.sendTraceTag(237798547,1,50,`DOM count: (${we.RVi}, ${we.v4g}, ${we.IUi}), long tasks: ${De}, operations count: ${this.cG.count}, operations: ${zd}`)):l.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.cG.count>ce&&l.ULS.sendTraceTag(537153875,1,50,`More than ${ce} operations are in the operationsList. count: ${this.cG.count}`),
this.cG.clear(),this.nIb.clear()):l.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Yuc=(zd,ce)=>{this.gSi(ce.UXe)};this.$=da;this.NJ=qa;this.ii=this.ii||xa.a.Bb;this.RE=new U.a;this.cG=new U.a;this.E3c=this.Oab=-1;this.nIb=new U.a;this.operationsGroupDetector=new sc;this.oQb=this.znc=!1;this.Qsi();this.vsi();this.usi();this.sessionStatisticsManager=Xb;this.BO=Pc;this.BO.nye(this.Yuc);this.$.da.Gb(263,zd=>{this.framePerformanceTracker=zd})}aPb(da,qa){var Xb=wf.HelperMethods.lc();
const Pc=yb.EwaSettings.ya(326)?this.operationsGroupDetector.isGroup(this.RE,this.cG,da):!1;this.znc=this.Lsf(da);yb.EwaSettings.ya(326)?this.znc&&0<this.RE.count&&!Pc&&(this.zfk(),this.Ptg(da,Xb),this.$4e()):0<this.RE.count&&this.Lsf(da)&&(this.Ptg(da,Xb),this.$4e());this.Oab=-1;if(Ta.h(this.$)&&Ta.h(this.$).Ca){var zd=!this.L2.contains(da);Xb=new wb(da,Xb,void 0,void 0,void 0,zd,this.znc,Pc);this.cG.add(Xb);this.framePerformanceTracker&&this.framePerformanceTracker.G1j(Xb.name,qa);yb.EwaSettings.ya(326)&&
!this.oQb&&this.TOb.contains(da)&&(this.oQb=!0);-1===this.E3c&&(this.E3c=window.requestAnimationFrame(this.nBj))}else l.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}EAc(){this.Oab=wf.HelperMethods.lc()}LAc(){this.RE.count||this.cG.count?(this.VUb(this.cG,this.Oab),this.VUb(this.RE,this.Oab)):l.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.Oab}`);this.Oab=-1}Lsf(da){return!this.G1.contains(da)&&!da.includes("Menu")&&
!da.includes("TellMe")}$4e(){for(let da=0;da<this.RE.count;da++){const qa=this.RE.ma(da);this.NJ.dRg(qa);this.CQi(qa)}this.RE.clear()}wgk(da){for(let qa=0;qa<this.cG.count;qa++)this.cG.ma(qa).startToNextFrame=this.hod(this.cG.ma(qa).startTime,da),this.cG.ma(qa).wasHidden=Bc.a.xE(this.cG.ma(qa).startToNextFrame)}Ptg(da,qa){for(let Xb=0;Xb<this.RE.count;Xb++)-1===this.RE.ma(Xb).startToResponseRenderEnd&&(this.RE.ma(Xb).operationThatLedToLogging=da,this.RE.ma(Xb).startToOperationThatLedToLogging=this.hod(this.RE.ma(Xb).startTime,
qa))}zfk(){var da=!1;for(let qa of this.RE)if(qa.isPartOfGroup){da=!0;break}if(da)for(da=0;da<this.RE.count;da++)this.RE.ma(da).isPartOfGroup=this.RE.ma(da).isGroupBreaking}VUb(da,qa){for(let Xb=0;Xb<da.count;Xb++)da.ma(Xb).startToResponseRenderEnd=this.hod(da.ma(Xb).startTime,qa),da.ma(Xb).wasHidden=Bc.a.xE(da.ma(Xb).startToResponseRenderEnd)}CQi(da){da=JSON.stringify(da);l.ULS.sendTraceTag(2020372336,1,50,`${da}`)}hod(da,qa){return-1===da?-1:-1===qa?-2:qa-da}gSi(da){da=da.getEntriesByType(ic.a.NDd);
for(let qa=0;qa<da.length;qa++)if(30>this.nIb.count)if(this.cG.count)this.nIb.add(this.Khj(da[qa]));else{const Xb=da[qa];if(null===Xb||void 0===Xb?0:Xb.attribution)void 0!==Xb.attribution.containerSrc&&null!==Xb.attribution.containerSrc&&(Xb.attribution.containerSrc=""),void 0!==Xb.attribution.containerId&&null!==Xb.attribution.containerId&&(Xb.attribution.containerId=""),void 0!==Xb.attribution.containerName&&null!==Xb.attribution.containerName&&(Xb.attribution.containerName="");l.ULS.sendTraceTag(40777251,
1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{l.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${da.length} First long task: ${this.nIb.ma(0)}`);break}}Khj(da){return`name:${da.name}, startTime:${da.startTime}, duration:${da.duration}`}Qsi(){this.L2||(this.L2=new Kb.a(cb.a.Ah()),this.L2.add("ActiveItemChanged"),this.L2.add(ib.b().jk(-1398645260)),this.L2.add(ib.b().jk(722290388)),this.L2.add(ib.b().jk(974713501)),
this.L2.add(Vc.a.aS(Vc.a.j9b)),this.L2.add(Vc.a.aS(Vc.a.i9b)),this.L2.add(Vc.a.aS(Vc.a.tvb)),this.L2.add(Vc.a.aS(Vc.a.dZf)),this.L2.add(Vc.a.aS(Vc.a.Mpa)))}vsi(){this.G1||(this.G1=new Kb.a(cb.a.Ah()),this.G1.add("PromptEditInBrowser"),this.G1.add(ib.b().jk(-1398645260)),this.G1.add(ib.b().jk(722290388)),this.G1.add(ib.b().jk(974713501)),this.G1.add(Vc.a.aS(Vc.a.j9b)),this.G1.add(Vc.a.aS(Vc.a.i9b)),this.G1.add(Vc.a.aS(Vc.a.tvb)),this.G1.add(Vc.a.aS(Vc.a.dZf)),this.G1.add(Vc.a.aS(Vc.a.Mpa)))}usi(){this.TOb||
(this.TOb=new Kb.a(cb.a.Ah()),this.TOb.add("SelectingRange_keyboard"),this.TOb.add("SelectingRange_mouse"))}}Object(h.a)(Ld,"OperationStatistics",null,[]);var le=a(594);class Ce{constructor(da,qa){this.messageIdName=null;this.errorCause=0;this.messageIdName=da;this.errorCause=qa}}Object(h.a)(Ce,"RequestError",null,[]);class Oe{constructor(da,qa,Xb,Pc,zd,ce,we,De,kf,Ue,Uf,Cf,pg,zg,Bg,dh,Fg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;
this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=
da;this.isUserTriggeredRequest=Oe.m8h(da);this.isFullyLoggedKPIRequest=Oe.d8h(da);this.isPromotedUTRRequest=Oe.f8h(da);this.requestDuration=qa;this.totalOperationDuration=Xb;this.requestTimeInQueue=Pc;this.requestInvokedTime=zd;this.ecsOperationDuration=ce.EcsOperationDuration;this.EcsRequestDuration=ce.EcsRequestDuration;this.WfeRequestDuration=ce.WfeRequestDuration;this.TimeFromLastEcsFreeze=ce.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=ce.DuringLoadOnDemand;this.correlationID=we;this.errors=
Oe.Vih(De);this.httpStatus=kf;this.requestResourceTiming=Ue;this.communicationErrorRetryCount=Uf;this.successfulCall=Cf;this.isDocumentHidden=pg;this.coauthorsCount=zg;this.responseSize=Bg;this.networkInfoData=dh;this.responseToCallbackTime=Fg}static Vih(da){if(!da)return[];const qa=[];for(const Xb of da)qa.push(new Ce(Xb.MessageIdName,Xb.ErrorCause));return qa}static m8h(da){return!Oe.JYi.contains(da)}static A$h(){const da=new Kb.a(cb.a.Ah());da.add("CheckPersistedContentUpdate");da.add("GetContentBundle");
da.add("GetSessionStatus");da.add("GetStatusBarAggregates");da.add("PollSessionStatus");da.add("UpdatePresenceUsers");da.add("UploadLatencyTelemetry");return da}static d8h(da){return Oe.BWh.contains(da)}static f8h(da){return Oe.Ymj.contains(da)}static G6h(){const da=new Kb.a(cb.a.Ah());da.add("SetRichTextCell");da.add("Copy");da.add("FormatCells");da.add("PasteRange");da.add("FindCell");da.add("ApplyToRangesV2");da.add("ResizeRowsColumns");da.add("InsertDeleteCells");da.add("FillRange");da.add("PasteHtmlContent");
da.add("ApplyFilter");da.add("PasteString");da.add("Undo");da.add("LineageUpdateView");da.add("FindAll");da.add("ApplyHyperlink");da.add("AutoFit");da.add("GetPrintSettings");da.add("GetEdgeCell");da.add("Paste");da.add("MoveAndResizeFloatingObject");da.add("FindRange");da.add("SetCustomFilter");da.add("RenameSheet");da.add("ApplyThreadedComment");da.add("SortFilterColumn");da.add("InsertCopiedCutCells");da.add("InsertSheet");da.add("ToggleAutoFilter");da.add("ReorderSheets");da.add("SetOutlineLevel");
da.add("RefreshAll");da.add("LineageOpenPaneOrChangeFilter");da.add("ApplySlicerSelection");da.add("GetCardViewCardByCell");da.add("AutoSum");da.add("LineageClosePane");da.add("Sort");da.add("ClearAutoFilter");da.add("DeleteSheet");da.add("Redo");yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(da.add("RemovePageBreak"),da.add("InsertPageBreak"),da.add("SetPrintArea"),da.add("ClearPrintArea"));return da}static g8h(){const da=new Kb.a(cb.a.Ah());da.add("DeleteConditionalFormattingRules");
da.add("GetConditionalFormattingRules");da.add("AddConditionalFormattingRule");da.add("QuickEditConditionalFormattingRule");da.add("GetPrintSettings");da.add("UpdatePresenceUsers");da.add("GetThemeInfo");da.add("InsertCopiedCutCells");da.add("PasteRange");da.add("FillRange");da.add("InsertCopiedCutCellsCrossSession");yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(da.add("LineageOpenPaneOrChangeFilter"),da.add("LineageUpdateView"),da.add("LineageRefreshView"),da.add("LineageLoadMore"));
return da}}Oe.JYi=Oe.A$h();Oe.BWh=Oe.G6h();Oe.Ymj=Oe.g8h();Object(h.a)(Oe,"RequestStatisticsData",null,[]);class ef{constructor(da,qa,Xb){this.$=da;this.NJ=qa;this.soa=Xb}RAc(da,qa,Xb,Pc,zd,ce,we,De,kf,Ue,Uf,Cf,pg,zg){Cf=le.a(Cf);da=new Oe(da,qa,Xb,Pc,zd,ce,we,De,kf,Cf,Ue,Uf,Bc.a.xE(qa),this.Knd(null),pg,this.soa.K7a(),zg);this.GTd(da)}Th(da,qa){da="UnknownMethodName";var Xb=-1;void 0!==qa.context&&null!==qa.context&&(da=qa.context.methodName,Xb=qa.context.communicationErrorRetryCount);let Pc,zd=
{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};qa.Zd?(Pc=qa.Zd.Errors||[],this.NJ.fBj(qa.Zd.EditSessionIsDirty),void 0!==qa.Zd.RequestTelemetryData&&null!==qa.Zd.RequestTelemetryData&&(zd=qa.Zd.RequestTelemetryData)):Pc=[];const ce=qa.duration,we=le.a(qa.url);da=new Oe(da,ce,qa.totalOperationDuration,qa.U3d,qa.CG,zd,qa.WWd,Pc,qa.httpStatus,we,Xb,!0,Bc.a.xE(ce),this.Knd(qa.Zd),qa.responseSize,this.soa.K7a(),qa.responseToCallbackTime);
this.GTd(da);yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7852773_EnableEnhancedTelemetryForLongNetworkTimeRequests")&&da.requestResourceTiming&&(Xb=da.requestResourceTiming.totalDuration-da.WfeRequestDuration,Xb>=this.$.xa.LongNetworkTimeTelemetryThresholdInMilliseconds&&qa.responseHeaders&&l.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${da.requestName}, requestDuration = ${da.requestDuration}, networkTime = ${Xb},  ServerCorrelation = ${da.correlationID}, msEdgeHeader = ${ic.a.mJb in
qa.responseHeaders?qa.responseHeaders[ic.a.mJb]:""}, wacClusterHeader = ${ic.a.Akb in qa.responseHeaders?qa.responseHeaders[ic.a.Akb]:""}`))}tn(da,qa){da="UnknownMethodName";let Xb=-1;void 0!==qa.context&&null!==qa.context&&(da=qa.context.methodName,Xb=qa.context.communicationErrorRetryCount);const Pc=qa.duration,zd=le.a(qa.url);qa=new Oe(da,Pc,qa.totalOperationDuration,qa.U3d,qa.CG,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},
qa.WWd,qa.errors||[],qa.httpStatus,zd,Xb,!1,Bc.a.xE(Pc),this.Knd(null),-1,this.soa.K7a(),qa.responseToCallbackTime);this.GTd(qa)}GTd(da){this.NJ.y_g(da);if(yb.EwaSettings.ya(212)){var qa=da.requestName;if(qa!==ic.a.jya&&"SetCell"!==qa&&"FindRange"!==qa&&"FindAll"!==qa&&"FindCell"!==qa)return}qa=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===da.requestName||null===da.requestName)&&da.isPromotedUTRRequest;ef.DAh(da,qa);this.NJ.eRg(da)}Knd(da){var qa;if(null===
(qa=null===da||void 0===da?void 0:da.CollaborationResult)||void 0===qa?0:qa.Users)return da.CollaborationResult.Users.length;da=this.$.ea.to.length;return 0<da?da:1}static DAh(da,qa){qa?ib.b().NCc(388829456,0,15,da):(qa=Sys.Serialization.JavaScriptSerializer.serialize(da),l.ULS.sendTraceTag(388829456,0,50,qa));if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==da.requestName&&null!==da.requestName&&da.isFullyLoggedKPIRequest){qa=new Map;qa.set("isUserTriggeredRequest",
da.isUserTriggeredRequest.toString());qa.set("requestDuration",da.requestDuration.toString());qa.set("totalOperationDuration",da.totalOperationDuration.toString());qa.set("requestTimeInQueue",da.requestTimeInQueue.toString());qa.set("requestInvokedTime",da.requestInvokedTime.toString());qa.set("ecsOperationDuration",da.ecsOperationDuration.toString());qa.set("ecsRequestDuration",da.EcsRequestDuration.toString());qa.set("wfeRequestDuration",da.WfeRequestDuration.toString());qa.set("timeFromLastEcsFreeze",
da.TimeFromLastEcsFreeze.toString());qa.set("duringLoadOnDemand",da.DuringLoadOnDemand.toString());qa.set("correlationID",da.correlationID);qa.set("errors",da.errors.toString());qa.set("httpStatus",da.httpStatus.toString());if(da.networkInfoData){var Xb=da.networkInfoData;qa.set("networkInfoData_bandwidthMps",void 0===Xb.bandwidthMps||null===Xb.bandwidthMps?"NA":Xb.bandwidthMps.toString());qa.set("networkInfoData_rttMs",void 0===Xb.rttMs||null===Xb.rttMs?"NA":Xb.rttMs.toString());qa.set("networkInfoData_effectiveConnection",
void 0===Xb.effectiveConnection||null===Xb.effectiveConnection?"NA":Xb.effectiveConnection)}da.requestResourceTiming&&(Xb=da.requestResourceTiming,qa.set("requestResourceTiming_fetchStart",void 0===Xb.downloadDuration||null===Xb.downloadDuration?"NA":Xb.downloadDuration.toString()));qa.set("communicationErrorRetryCount",da.communicationErrorRetryCount.toString());qa.set("successfulCall",da.successfulCall.toString());qa.set("isDocumentHidden",da.isDocumentHidden.toString());qa.set("coauthorsCount",
da.coauthorsCount.toString());qa.set("responseSize",da.responseSize.toString());qa.set("responseToCallbackTime",da.responseToCallbackTime.toString());ib.b().NAc(da.requestName,da.successfulCall,qa)}}}Object(h.a)(ef,"RequestStatistics",null,[]);var uf=a(213),Ab=a(58),cc=a(274);class uc{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(h.a)(uc,
"OperationTypeStatisticsData",null,[]);class $c{constructor(da,qa){this.data=new uc;this.data.operationName=da;this.data.isUserOperation=qa;this.data.totalCount=0;this.Ukg=[];this.Vkg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Ld(da){this.data.totalCount<$c.Aed&&(this.Ukg.push(da.startToNextFrame),this.Vkg.push(da.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<
da.startToNextFrame&&(this.data.longestStartToNextFrame=da.startToNextFrame);this.data.longestStartToResponse<da.startToResponseRenderEnd&&(this.data.longestStartToResponse=da.startToResponseRenderEnd)}Eid(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.Bcf(this.Ukg),this.data.startToResponsePercentiles=this.Bcf(this.Vkg))}Bcf(da){da.sort(wf.HelperMethods.SG);let qa;qa="("+Bc.a.cma(da,25).toString();qa=qa+", "+Bc.a.cma(da,50).toString();qa=qa+", "+Bc.a.cma(da,75).toString();
qa=qa+", "+Bc.a.cma(da,95).toString();return qa+")"}}$c.Aed=1E3;Object(h.a)($c,"OperationTypeStatistics",null,[]);class Bd{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=
this.requestDurationPercentile25=0}}Object(h.a)(Bd,"RequestTypeStatisticsData",null,[]);class ee{constructor(da){this.data=new Bd;this.data.requestName=da;this.data.totalCount=0;this.agb=[];this.S4d=this.K4d=this.L4d=this.P4d=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}MBj(da){this.data.totalCount<ee.Aed&&this.agb.push(da.requestDuration);this.data.totalCount++;this.P4d+=da.requestDuration;this.L4d+=ee.eld(da.ecsOperationDuration);this.K4d+=ee.eld(da.EcsRequestDuration);this.S4d+=ee.eld(da.WfeRequestDuration);0<da.TimeFromLastEcsFreeze&&da.TimeFromLastEcsFreeze<ee.qWh&&this.data.callsDuringEcsFreeze++;da.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;da.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||
null===this.data.longestRequest||this.data.longestRequest.requestDuration<da.requestDuration)this.data.longestRequest=da}Eid(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.P4d/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.L4d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.K4d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.S4d/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=
0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.agb.sort(wf.HelperMethods.SG),this.data.requestDurationPercentile25=Bc.a.cma(this.agb,25),this.data.requestDurationPercentile50=Bc.a.cma(this.agb,50),this.data.requestDurationPercentile75=Bc.a.cma(this.agb,75),this.data.requestDurationPercentile95=Bc.a.cma(this.agb,95))}static eld(da){return 0>da?0:da}}ee.qWh=3E3;ee.Aed=1E3;Object(h.a)(ee,"RequestTypeStatistics",null,[]);class qe{constructor(da,qa,Xb,Pc,zd,ce,we,De){this.mode=null;
this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=da;this.ocsCapable=qa;this.endedBySplashScreen=Xb;this.dirtySessionOnLastRecordedRequest=Pc;this.loadOnDemandCount=zd;this.maxCoauthorsCount=ce;this.everConnectedToOcs=we;da=[];for(let kf in De)qa=De[kf],qa.Eid(),da.push(qa.data);this.requests=da}}Object(h.a)(qe,"SessionStatisticsData",null,[]);class Yb{constructor(da){this.dirtySessionOnLastRecordedRequest=
this.D1d=!1;this.Vyf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=da;this.arb={};this.$qb={};this.ncd={}}Xc(){var da=this.Ksh();if(Ra.a.nga()){var qa={};qa.xlendJson=da;this.$.Xpa(uf.a.Wlk,qa,!1)}else Ab.N(this.$.qa.va,da,null,null,null,null,null);da=this.Lsh();Ra.a.nga()?(qa={},qa.xlenoJson=da,this.$.Xpa(uf.a.Xlk,qa,!1)):l.ULS.sendTraceTag(388776782,0,50,da);da=this.fnh();Ra.a.nga()?(qa={},qa.xlencJson=da,this.$.Xpa(uf.a.Vlk,qa,!1)):l.ULS.sendTraceTag(388776770,0,50,da);this.vCj()}qpc(){this.everConnectedToOcs=
this.$.ea.wab||this.everConnectedToOcs;I.Health.instance&&I.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}Ig(){const da=new cc.a;let qa="";const Xb=!this.$.isAnonymousUser(),Pc=da.sf();if(Pc){if(Xb){da.nRb("UMI_Linkable","true");return}qa=da.ONa("UMI_Linkable")}Xb||l.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${Pc}, UMIIsLinkable:${!!qa}`)}Zfb(){this.D1d=!0}fBj(da){this.dirtySessionOnLastRecordedRequest=
da}y_g(da){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,da.coauthorsCount);I.Health.instance&&I.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}eRg(da){if(!(da.requestName in this.arb)){const qa=new ee(da.requestName);this.arb[da.requestName]=qa}this.arb[da.requestName].MBj(da)}dRg(da){if(!(da.name in this.$qb)){const qa=new $c(da.name,da.isUserOperation);this.$qb[da.name]=qa}this.$qb[da.name].Ld(da)}TU(da){this.ncd[da.reportName]=da}vCj(){this.dirtySessionOnLastRecordedRequest=
this.D1d=!1;this.Vyf=this.$.ea.yCd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.arb={};this.$qb={};this.ncd={}}Ksh(){const da=new qe(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.D1d,this.dirtySessionOnLastRecordedRequest,this.$.ea.yCd-this.Vyf,this.maxCoauthorsCount,this.everConnectedToOcs,this.arb);return Sys.Serialization.JavaScriptSerializer.serialize(da)}Lsh(){var da=new U.a;const qa=this.$qb;for(let Xb in qa){const Pc=qa[Xb];Pc.Eid();da.add(Pc.data)}da=da.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(da)}fnh(){return Sys.Serialization.JavaScriptSerializer.serialize(this.ncd)}}
Object(h.a)(Yb,"SessionStatistics",null,[]);class Nc extends Fa.a{constructor(da){super();this.Kpa=this.$oa=null;this.lRe=Array(1);this.VUc=this.RDd=null;this.Th=(qa,Xb)=>{yb.EwaSettings.ya(39)&&(this.Kpa=this.Kpa||new ef(this.$,this.NJ,this.soa),this.Kpa.Th(qa,Xb))};this.tn=(qa,Xb)=>{yb.EwaSettings.ya(39)&&(this.Kpa=this.Kpa||new ef(this.$,this.NJ,this.soa),this.Kpa.tn(qa,Xb))};this.Xc=(qa,Xb)=>{yb.EwaSettings.ya(39)&&this.NJ.Xc(qa,Xb)};this.Ig=(qa,Xb)=>{yb.EwaSettings.ya(39)&&this.NJ.Ig(qa,Xb)};
this.qpc=(qa,Xb)=>{yb.EwaSettings.ya(39)&&this.NJ.qpc(qa,Xb)};this.$=da;yb.EwaSettings.ya(39)&&(Bc.a.nmf(this.$),this.BO=new qd(this.$),this.Woh(),yb.EwaSettings.ya(505)&&this.xbb&&(this.RDd=new Ve(this.$,this.xbb)),this.NJ=new Yb(this.$),this.soa=new db(this.$),this.$.Xj(this.Xc),this.$.qa.ms(this.Th),this.$.qa.Iy(this.tn),this.$.ea.dye(this.qpc),yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.nk(this.Ig))}get xbb(){return this.VUc}dispose(){this.$&&yb.EwaSettings.ya(39)&&
(this.$.Ll(this.Xc),this.$.qa.Mt(this.Th),this.$.qa.Jz(this.tn),this.$.ea.E4f(this.qpc),yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Pm(this.Ig));Sd.a.Ka(this.soa);Sd.a.Ka(this.xbb);this.VUc=null;Sd.a.Ka(this.BO);this.BO=null;Sd.a.Ka(this.RDd);this.$=this.RDd=null;super.dispose()}Zfb(){yb.EwaSettings.ya(39)&&this.NJ.Zfb()}RAc(da,qa,Xb,Pc,zd,ce,we,De,kf,Ue,Uf,Cf,pg,zg){yb.EwaSettings.ya(39)&&(this.Kpa=this.Kpa||new ef(this.$,this.NJ,this.soa),this.Kpa.RAc(da,qa,
Xb,Pc,zd,ce,we,De,kf,Ue,Uf,Cf,pg,zg))}aPb(da,qa){yb.EwaSettings.ya(39)&&(this.$oa=this.$oa||new Ld(this.$,this.NJ,this,this.BO),this.$oa.aPb(da,qa))}EAc(){yb.EwaSettings.ya(39)&&(this.$oa=this.$oa||new Ld(this.$,this.NJ,this,this.BO),this.$oa.EAc())}LAc(){yb.EwaSettings.ya(39)&&(this.$oa=this.$oa||new Ld(this.$,this.NJ,this,this.BO),this.$oa.LAc())}TU(da){yb.EwaSettings.ya(39)&&this.NJ.TU(da)}dmd(da){return yb.EwaSettings.ya(39)?this.lRe[da]:null}Lcg(da){da&&(this.lRe[da.type]=da)}K7a(){return this.soa.K7a()}Woh(){x.a.rp&&
void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.VUc=new pf(this.$,this.BO))}}Object(h.a)(Nc,"SessionStatisticsManager",Fa.a,[571]);var ud=a(104),Mb=a(1083),rc=a(130),id=a(141);class Gd{constructor(da,qa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=
!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=da;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=qa}k4d(){return dc.a.Zc(this)}}Object(h.a)(Gd,"AppUnloadInfo",
null,[]);var de=a(721),ae=a(134),Ae=a(576);class Re{constructor(da){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=da.UKe+da.krg;this.dataLossReason=da.SGe;this.o$g(da.T7d)}o$g(da){const qa=new de.a(Ae.a.yL());let Xb=0,Pc=0;for(const zd of da)qa.Fb(zd)||qa.ia(zd,0),da=qa.ia(zd,qa.ma(zd)+1),da>Xb&&(Xb=da,Pc=zd);Xb>this.mostCommonOperationCount&&(this.mostCommonOperationName=ae.a(Pc),this.mostCommonOperationCount=
Xb)}}Object(h.a)(Re,"DataLossInfo",null,[]);var La=a(64);class Hb{constructor(da){this.O3c="AppUnloadInfo";this.xn=this.$=this.workbookHashedId=this.eA=null;this.xae=this.Wde=!1;this.zf=null;this.Llf=0;this.gfa=(qa,Xb)=>{this.Llf=Xb.IHc};this.PSf=(qa,Xb)=>{Xb.T7d.length&&this.$.wE&&(this.eA.dataLossInfo=new Re(Xb),this.eA.wasDataLostDuringUnload=!0,this.Dgb())};this.Ig=()=>{this.fbg();this.$.ea.Pm(this.Ig)};this.VRa=()=>{this.eA.wasUpdatedOnBeforeUnload=!0;this.eA.inactivityDurationBeforeUnloadSeconds=
this.zf.Uib<Hb.YUi?this.Llf:this.zf.Uib;this.Ltg()};this.DLb=()=>{this.eA.wasUpdatedOnUnload=!0;this.Ltg();Sys.Application.remove_unload(this.DLb)};this.Vbj=()=>{this.eA.lastSilentReopenStartTime=xa.a.Bb.Cc;this.eA.lastSilentReopenEndTime=null;this.Dgb();this.$.Ql(this.KRf)};this.KRf=()=>{this.eA.lastSilentReopenEndTime=xa.a.Bb.Cc;this.Dgb();this.$.Rm(this.KRf)};this.localStorage=new cc.a;this.localStorage.sf()&&(this.$=da,this.workbookHashedId=La.a(this.$),this.eA=new Gd(this.workbookHashedId,this.$.xa.UserSessionId),
this.xn=id.a.instance.sI(),this.xn.la("beforeunload",this.VRa),this.$.userOperationManager.rZg(this.PSf),da.ea.Of?this.fbg():this.$.ea.nk(this.Ig),this.zf=this.$.ea.zf,this.zf.gja(this.gfa),Sys.Application.add_unload(this.DLb),this.$.ea.P4b(this.Vbj))}get dialogPromptedOnUnload(){return this.Wde}set dialogPromptedOnUnload(da){this.Wde=da;this.eA?(this.eA.dialogPromptedOnUnload=da,this.Dgb()):this.localStorage.sf()&&l.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.sf()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.xae}set apiBeforeCloseNotificationEnabledOnUnload(da){this.xae=
da;this.eA?(this.eA.apiBeforeCloseNotificationEnabledOnUnload=da,this.Dgb()):this.localStorage.sf()&&l.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.sf()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.Xzj(this.PSf);this.zf&&(this.zf.OCa(this.gfa),this.zf=null);this.xn.eE();this.$=this.xn=null}Ltg(){this.MQj();this.Dgb()}MQj(){this.eA.wasOfflineDuringUnload=this.$.Af.A7;
this.eA.timeFromLastConnectivity=rc.a(xa.a.Bb,this.$.Af.Kxf);this.eA.timeFromLastDisconnectionStart=rc.a(xa.a.Bb,this.$.Af.rLi);this.eA.disconnectionSource=Enum.toString(Mb.a,this.$.Af.disconnectionSource);this.eA.hadConnectivityIssuesDuringUnload=this.$.Af.nna;this.eA.timeFromLastStatusCode0=rc.a(xa.a.Bb,this.$.Af.Jxf)}Dgb(){this.eA.timestamp=Date.now();this.localStorage.nRb(this.O3c,this.eA.k4d())}fbg(){const da=this.localStorage.ONa(this.O3c);if(da)try{const qa=dc.a.Xi(da);this.localStorage.ERd(this.O3c);
const Xb=this.nTi(qa);l.ULS.sendTraceTag(574677456,0,50,Xb)}catch(qa){l.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${qa.message}`)}else l.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}nTi(da){const qa={};qa.WACSessionID=da.wacSessionId;qa.wasRefreshed=this.ndh(da,this.$.xa.MaxAppReloadDurationIndicatingRefresh);qa.closedWithDialogConfirmation=da.dialogPromptedOnUnload;
qa.wasOfflineDuringUnload=da.wasOfflineDuringUnload;qa.TimeFromLastConnectivityMs=da.timeFromLastConnectivity;qa.TimeFromLastDisconnectionStart=da.timeFromLastDisconnectionStart;qa.wasDataLostDuringUnload=da.wasDataLostDuringUnload;qa.DataLossInfo=da.dataLossInfo;qa.flushedOnUnload=da.wasUpdatedOnUnload;qa.flushedOnBeforeUnload=da.wasUpdatedOnBeforeUnload;qa.InactivityDurationBeforeUnload=da.inactivityDurationBeforeUnloadSeconds;qa.DisconnectionSource=da.disconnectionSource;qa.hadConnectivityIssuesDuringUnload=
da.hadConnectivityIssuesDuringUnload;qa.TimeFromLastStatusCode0=da.timeFromLastStatusCode0;qa.LastSilentReopenStartTime=da.lastSilentReopenStartTime;qa.LastSilentReopenEndTime=da.lastSilentReopenEndTime;yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(qa.ApiBeforeCloseNotificationEnabledOnUnload=da.apiBeforeCloseNotificationEnabledOnUnload);return J.c(qa)}ndh(da,qa){const Xb=window.performance.timing.navigationStart-da.timestamp;(da=this.workbookHashedId===
da.workbookHashedId&&Xb<qa)&&l.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return da}static la(da){da.ea.Gc.inWebPart||da.da.Ja(410,new Hb(da))}}Hb.YUi=10;Object(h.a)(Hb,"AppUnloadTelemetryManager",null,[656,2]);var xc=a(16);class Yc{constructor(da){this.$Re=!1;this.bSe=null;this.Dd=()=>{this.OFj();Ta.h(this.$).ga&&Ta.h(this.$).ga.sP(this.Dd)};this.ik=(qa,Xb)=>{Xb.na&&!this.H3d.has(Xb.na.name)&&(this.H3d.add(Xb.na.name),Ta.h(this.$).ga&&(Ta.h(this.$).ga.sP(this.Dd),
Ta.h(this.$).ga.EK(this.Dd)))};this.$=da;this.Kng=new Set;this.H3d=new Set;this.$.ua&&this.$.ua.na&&this.H3d.add(this.$.ua.na.name);Ta.h(this.$).ga.EK(this.Dd);this.$.ua.Lg(this.ik)}dispose(){this.$=null}OFj(){this.bSe||this.w$g();const da=Ta.d(Ta.h(this.$));if(!this.$Re){const qa=xc.a.instance.Ha(281).split(",");da.push(...qa);this.$Re=!0}for(const qa of da)qa&&!this.Kng.has(qa)&&(this.SPi(qa),this.Kng.add(qa))}SPi(da){this.Eah(da)}w$g(){this.bSe=Yc.Vxa("monospace");Yc.Vxa("sans-serif");Yc.Vxa("serif")}Eah(da){Yc.Vxa(`${da},${"monospace"}`);
Yc.Vxa(`${da},${"sans-serif"}`);Yc.Vxa(`${da},${"serif"}`)}static la(da){if(yb.EwaSettings.ya(61)){const qa=new Yc(da);da.da.Ja(210,qa)}}static Vxa(da){const qa=document.createElement("div"),Xb=document.createElement("div");qa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Yc.xQj(Xb,da);document.body.appendChild(qa);qa.appendChild(Xb);Xb.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";da=Xb.offsetWidth+"x"+Xb.offsetHeight;document.body.removeChild(Xb.parentNode);
return da}static xQj(da,qa){da.style.cssText="display: inline; visibility: hidden;";da.style.fontSize="100px";da.style.fontWeight="normal";da.style.fontStyle="normal";da.style.letterSpacing="normal";da.style.lineHeight="normal";da.style.whiteSpace="nowrap";da.style.fontFamily=qa}}Object(h.a)(Yc,"FontTelemetryManager",null,[2]);var xd=a(243),Vd=a(176),pe;(function(da){da[da.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";da[da.reactSingleLineRibbon=1]="reactSingleLineRibbon";da[da.reactMultiLineRibbon=
2]="reactMultiLineRibbon";da[da.invalid=3]="invalid"})(pe||(pe={}));Object(h.b)("RibbonMode",pe);var re=a(110);class $e extends df.a{constructor(){super();this.YM=!1;this.Oje=this.Nje=null;this.eJd=()=>{this.xtg()};this.Z9i=()=>{Sd.a.Ka(this.N_);Sd.a.Ka(this.xn)};this.N_=id.a.instance.dLa();this.xn=id.a.instance.sI();this.N_.la("visibilitychange",this.eJd);this.xn.la("pagehide",this.Z9i);this.xtg()}get ui(){return this.YM}get Xwf(){return this.Nje}get Ypc(){return this.Oje}WIa(da){this.addHandler("ekdh",
da)}Gfb(da){this.removeHandler("ekdh",da)}Lua(da){this.addHandler("ekduh",da)}MCa(da){this.removeHandler("ekduh",da)}xE(da){return this.ui?!0:this.Ypc?Ac.getElapsedMilliseconds(this.Ypc,xa.a.Bb.Cc)<da:!1}dispose(){Sd.a.Ka(this.N_);Sd.a.Ka(this.xn);super.dispose()}xtg(){this.YM="hidden"===window.document.visibilityState;this.ui?(this.raiseEvent("ekdh"),this.Nje=xa.a.Bb.Cc):(this.raiseEvent("ekduh"),this.Oje=xa.a.Bb.Cc)}}Object(h.a)($e,"DocumentVisibilityObserver",df.a,[660,2]);var qf=a(129);class He{constructor(){this.longFramesOverThresholdOpsPercentage=
this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(h.a)(He,"FramePerformanceData",null,[]);class te{constructor(da){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new He;this.l2FramePerformanceData=new He;this.l3FramePerformanceData=new He;this.name=da}}Object(h.a)(te,"FramePerformanceDataGroup",null,[]);class af{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName=
"FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(h.a)(af,"FramePerformanceSessionEndsReport",null,[279]);class xf{constructor(da){this.qLd={};this.lja=null;this.Ujb=(qa,Xb)=>{qa.longFramesOverThresholdOps++;qa.maxLongFrameDuration=Math.max(qa.maxLongFrameDuration,Xb)};this.xf=new af;this.Gph();da.da.Gb(276,()=>{nc.a(da).TU(this.xf)})}Gph(){this.lja=new te("AllGridOperationsData");this.xf.operationsGroups.push(this.lja);this.rwb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.rwb("DragScroll",["DragScroll"]);this.rwb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.rwb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.rwb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}FBj(da,qa,Xb,Pc){const zd=this.C6h(da);zd&&(qf.b(this.xf.operationsGroups,ce=>Gb.a.equals(ce.name,zd.name,!1))||this.xf.operationsGroups.push(zd),zd.count++,this.JJc(qa,zd),this.FJc(Xb,zd),this.lja.count++,
this.JJc(qa,this.lja),this.FJc(Xb,this.lja),0<Pc&&this.gfk(Pc,zd),0<=qa&&this.tek(qa,zd))}Jfk(){for(const da of this.xf.operationsGroups)xf.Bek(da)}rwb(da,qa){da=new te(da);for(const Xb of qa)this.qLd[Xb]=da}C6h(da){return da in this.qLd?this.qLd[da]:null}tek(da,qa){30>da&&this.u6d(Xb=>{Xb.l1FramePerformanceData.fpsUnderThresholdOps++},qa);15>da&&this.u6d(Xb=>{Xb.l2FramePerformanceData.fpsUnderThresholdOps++},qa);5>da&&this.u6d(Xb=>{Xb.l3FramePerformanceData.fpsUnderThresholdOps++},qa)}gfk(da,qa){100<=
da&&(this.Vjb(qa.l1FramePerformanceData,da,this.Ujb),this.Vjb(this.lja.l1FramePerformanceData,da,this.Ujb));300<=da&&(this.Vjb(qa.l2FramePerformanceData,da,this.Ujb),this.Vjb(this.lja.l2FramePerformanceData,da,this.Ujb));600<=da&&(this.Vjb(qa.l3FramePerformanceData,da,this.Ujb),this.Vjb(this.lja.l3FramePerformanceData,da,this.Ujb))}u6d(da,qa){qa&&(da(qa),da(this.lja))}Vjb(da,qa,Xb){da&&Xb(da,qa)}JJc(da,qa){qa.minFPS=-1===qa.minFPS?da:Math.min(qa.minFPS,da)}FJc(da,qa){qa.maxFPS=Math.max(qa.maxFPS,
da)}static Bek(da){xf.U6d(da.l1FramePerformanceData,da.count);xf.U6d(da.l2FramePerformanceData,da.count);xf.U6d(da.l3FramePerformanceData,da.count)}static U6d(da,qa){da.fpsUnderThresholdOpsPercentage=100*da.fpsUnderThresholdOps/qa;da.longFramesOverThresholdOpsPercentage=100*da.longFramesOverThresholdOps/qa}}Object(h.a)(xf,"FramePerformanceSessionEndsReportManager",null,[]);class cg{constructor(){this.f=null}}Object(h.a)(cg,"FpsDataWrapper",null,[]);class gb{constructor(da=-1,qa=-1){this.duration=
this.startSecond=0;this.startSecond=da;this.duration=qa}}Object(h.a)(gb,"LongFrameData",null,[]);var Eb=a(357);class ac{constructor(da=null,qa=0,Xb=-1,Pc=-1,zd=0,ce=-1,we=0,De=-1,kf=-1,Ue=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=da;this.count=qa;this.start=Xb;this.end=Pc;this.Avg=zd;this.Max=ce;this.Min=Eb.a.rzg;this.longFrameCount=we;this.coauth=De||1;this.tfAppInt=kf;this.Props=
Ue;this.LFrame=null}}Object(h.a)(ac,"OperationFPSData",null,[]);var zc=a(37),Jc=a(799);class od extends Fa.a{constructor(da){super();this.Fsb=-1;this.kBd=0;this.mAa=new Date(0);this.f_=null;this.Aka={};this.Twa=new U.a;this.NUd=this.Uab=!1;this.R6a=null;this.yHc=this.pcb=0;this.isSynthetic=!1;this.Z5e=()=>{const qa=new Date;var Xb=qa.getMinutes();const Pc=qa.getSeconds();this.sHb&&qa.getTime()-this.sHb.getTime()>this.U5j?(this.stop(),this.rjd(qa)):(Xb!==this.kBd&&(this.rjd(qa),this.kBd=Xb),this.Uab&&
(this.jf.ui?this.f_[Pc]=od.Sbc:(this.LTe(Pc),this.Uab=!1,this.Twa.clear(),this.Aka={})),this.f_[Pc]!==od.Sbc&&(this.f_[Pc]++,Xb=qa.getTime()-this.mAa.getTime(),Xb>this.eBf&&this.qQi(this.mAa,Xb)),this.Fsb=window.requestAnimationFrame(this.Z5e),this.mAa=qa)};this.xX=()=>{this.Uab=!0};this.eIf=()=>{this.pause()};this.gIf=()=>{this.NUd&&this.resume()};this.Bj=()=>{this.Ca.g7()&&this.pfk()};this.sHb=new Date;this.jf=new $e;this.jf.WIa(this.xX);v.AFrameworkApplication.a2c(this.eIf);v.AFrameworkApplication.b2c(this.gIf);
this.$=da;this.eBf=da.xa.LongFrameThresholdMs;this.eSi="MoreThan_"+this.eBf.toString()+"_Ms";this.T5j=da.xa.ThresholdToEndOperationTrackingSeconds;this.U5j=da.xa.ThresholdToStopFPSTrackingMS;this.Ca=Ta.h(this.$).Ca;v.AFrameworkApplication.Nc&&v.AFrameworkApplication.Nc.IsSynthetic&&(this.isSynthetic=Gb.a.compare(v.AFrameworkApplication.Nc[ic.a.isSynthetic],"True",!0)?!1:!0);this.Ca.rw(this.Bj);this.dUd();this.rQi=this.$.RPa&&yb.EwaSettings.ya(504)}start(){this.NUd=!0;this.resume()}stop(){this.NUd=
!1;this.pause()}dispose(){this.stop();this.jf.Gfb(this.xX);v.AFrameworkApplication.V3f(this.eIf);v.AFrameworkApplication.W3f(this.gIf);Sd.a.Ka(this.jf);this.Ca.Vw(this.Bj);super.dispose()}G1j(da,qa){const Xb=da in this.Aka?this.Aka[da]:null;this.sHb=new Date;this.start();const Pc=this.sHb.getSeconds(),zd=Pc+this.T5j;Xb&&Pc<=Xb.end?(Xb.count++,Xb.end=zd):(Xb&&Pc>Xb.end&&this.Twa.add(Xb),this.Aka[da]=new ac(da,1,Pc,zd,void 0,void 0,void 0,this.$.ea.to.length,Wb.PageLoadTrackingInfo.instance.lya(this.sHb),
qa))}aoh(){this.R6a||(this.rjd(new Date),this.R6a=new xf(this.$))}resume(){this.xqf()||!this.Ca.tP||this.isSynthetic||(this.Uab=this.jf.ui,this.mAa=new Date,this.kBd=this.mAa.getMinutes(),this.dUd(),this.LTe(this.mAa.getSeconds()),this.Fsb=window.requestAnimationFrame(this.Z5e))}xqf(){return 0<=this.Fsb}pause(){this.xqf()&&(this.Uab||(this.MTe((new Date).getSeconds()),l.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.f_.toString()}`)),window.cancelAnimationFrame(this.Fsb),this.Fsb=-1)}rjd(da){if(da.getTime()-
this.mAa.getTime()<od.LVi&&(this.Uab&&this.MTe(this.mAa.getSeconds()),this.WCh(),0<this.Twa.count&&(da={},da.NonEmptyCellsCount=this.pcb,da.TextCellsCount=this.yHc,da.xlfpsJson=Object(vb.a)(new cg,{f:this.Twa.toArray()}),da.memoryInfo=this.jVi(),da.zoom=zc.a(this.$)?zc.a(this.$).zoom:1,da.RibbonMode=Vd.a(this.$)?pe[Vd.a(this.$).wP]:od.invalid,da.deviceMemory=navigator.deviceMemory||0,da.hardwareConcurrency=navigator.hardwareConcurrency||0,da=JSON.stringify(da),l.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.f_.toString()}`),
!this.isSynthetic))){if(Ra.a.nga()){var qa={};qa.xlfpsJson=da;this.$.Xpa(uf.a.Ylk,qa,!1)}else l.ULS.sendTraceTag(388781010,0,50,`${da}`);if(this.rQi)for(let Xb of this.Twa){qa=1E3>=this.pcb?"0_1000":3E3>=this.pcb?"1000_3000":"3000_inf";const Pc=new Map;Pc.set("Operation",Xb.Op);Pc.set("BucketOfRenderedCells",qa);I.Health.instance.recordKpiUsage(Ee.a.longFrame,0,Ie.a.canvas,Pc);0<Xb.longFrameCount&&I.Health.instance.recordKpiFailure(Ee.a.longFrame,"LongFrame",!1,!0,Object(vb.a)(new R.a,{extendedProperties:Pc}));
3E4<Xb.tfAppInt&&(0<Xb.longFrameCount?ib.b().p6f(0,this.eSi,Pc):ib.b().q6f(0,Pc))}l.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${da.length}`)}this.reset()}jVi(){const da={};if(window.performance){const qa=window.performance.memory;qa&&(da.jsHeapSizeLimit=qa.jsHeapSizeLimit,da.usedJSHeapSize=qa.usedJSHeapSize,da.totalJSHeapSize=qa.totalJSHeapSize)}return da}reset(){this.Twa.clear();this.Aka={};this.dUd()}WCh(){if(this.f_){for(const da of Jc.a(this.Aka)){const qa=this.Aka[da];qa.end=
Math.min(this.f_.length-1,qa.end);this.Twa.add(qa)}this.M$g(this.Twa,this.f_)}}M$g(da,qa){for(let Xb of da){let Pc=da=0;if(Xb.end<qa.length){for(let zd=Xb.start;zd<=Xb.end;zd++){const ce=qa[zd];0<=ce&&(Xb.Max=Math.round(Math.max(Xb.Max,ce)),Xb.Min=Math.round(Math.min(Xb.Min,ce)),da+=ce,Pc++)}0<Pc&&(Xb.Avg=Math.round(da/Pc));this.R6a&&this.R6a.FBj(Xb.Op,Xb.Min,Xb.Max,Xb.LFrame?Xb.LFrame.duration:-1);Xb.Props&&(this.bak(Xb),Xb.Props=null)}}this.R6a&&this.R6a.Jfk()}dUd(){this.f_=Array(60).fill(0)}LTe(da){da++;
for(let qa=0;qa<da;qa++)this.f_[qa]=od.Sbc}MTe(da){for(;60>da;da++)this.f_[da]=od.Sbc}qQi(da,qa){da=da.getSeconds();var Xb=Jc.a(this.Aka);if(0<Xb.length)for(const Pc of Xb)if(Xb=this.Aka[Pc],da>=Xb.start&&da<Xb.end)Xb.LFrame?Xb.LFrame.duration<qa&&(Xb.LFrame.startSecond=da,Xb.LFrame.duration=qa,Xb.longFrameCount++):(Xb.LFrame=new gb(da,qa),Xb.longFrameCount++)}pfk(){this.yHc=this.pcb=0;for(const da of Ta.h(this.$).wo){const qa=da.$Ea;for(let Xb in qa){const Pc=this.Ca.lm(qa[Xb].hashCode);if(null===
Pc||void 0===Pc?0:Pc.Ok)this.pcb+=Pc.De.NonEmptyCellsCount,this.yHc+=Pc.De.TextValueCellsCount}}}bak(da){const qa=da.Props;if(ba.a.TRb in qa&&qa[ba.a.TRb]&&ba.a.NTb in qa){let Xb;(Xb=Object(B.a)(xd.a,qa[ba.a.NTb]))&&Xb.continueWith(Pc=>{re.TextEditorTelemetry.instance.pTg(da.Op,da.Min,!!da.LFrame,da.LFrame?da.LFrame.duration:0,Pc.result)})}}}od.Sbc=-1;od.LVi=6E4;od.invalid="Invalid";Object(h.a)(od,"FramePerformanceTracker",Fa.a,[659,2]);class Ed extends mb.a{constructor(da){super();this.$=da;this.kc()}create(){let da=
this.$.da.Ba(263);da||(da=this.$.da.Ja(263,new od(this.$)));this.Pb(da)}static la(da){da.da.Ja(264,new Ed(da))}}Object(h.a)(Ed,"FramePerformanceTrackerFactory",mb.a,[]);var he=a(1334),ne=a(985);class m{hh(da,qa){return new ne.a(da,qa)}qd(da,qa){da=this.hh(da,qa);da.start();return da}}Object(h.a)(m,"DefaultStopwatchBuilder",null,[181]);class Sb{constructor(){this.Psa=new m}hh(da,qa){return this.Psa.hh(da,qa)}qd(da,qa){return this.Psa.qd(da,qa)}}Object(h.a)(Sb,"StopwatchBuilder",null,[181]);var hc=
a(425),Ic=a(949),jd=a(950),Md;(function(da){da[da.actions=0]="actions";da[da.correlationStart=1]="correlationStart";da[da.reorderSheetOp=2]="reorderSheetOp";da[da.formatCellOp=3]="formatCellOp";da[da.copyOp=4]="copyOp";da[da.pasteOp=5]="pasteOp";da[da.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";da[da.instantaneousSetData=7]="instantaneousSetData";da[da.immediateSetData=8]="immediateSetData";da[da.dependentCellsCalc=9]="dependentCellsCalc";da[da.dependentCellsGraphStat=10]="dependentCellsGraphStat";
da[da.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";da[da.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";da[da.gridBlockUpdates=13]="gridBlockUpdates";da[da.browserAppStart=14]="browserAppStart";da[da.linkedObjects=15]="linkedObjects";da[da.longFrames=16]="longFrames";da[da.task=17]="task";da[da.conflictInEditing=18]="conflictInEditing";da[da.incomingPresenceData=19]="incomingPresenceData";da[da.editorTableDelay=20]="editorTableDelay";da[da.presenceStartup=
21]="presenceStartup";da[da.presenceDelete=22]="presenceDelete";da[da.editorEvent=23]="editorEvent";da[da.editorTime=24]="editorTime";da[da.gridScreenReaderOps=25]="gridScreenReaderOps";da[da.sendPresenceToService=26]="sendPresenceToService";da[da.IME=27]="IME";da[da.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";da[da.customizeStatusBar=29]="customizeStatusBar";da[da.clientWebRequests=30]="clientWebRequests";da[da.showCommentTaskPane=31]="showCommentTaskPane";da[da.applyThreadedCommentChange=
32]="applyThreadedCommentChange";da[da.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";da[da.findNextOrPreviousComment=34]="findNextOrPreviousComment";da[da.goto=35]="goto";da[da.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";da[da.richApiInvocation=37]="richApiInvocation";da[da.fxLibrary=38]="fxLibrary";da[da.embeddedApiSession=39]="embeddedApiSession";da[da.numberFormattingCalculator=40]="numberFormattingCalculator";da[da.requestDataAfterSend=41]="requestDataAfterSend";da[da.floatingObjectsStopwatchData=
42]="floatingObjectsStopwatchData";da[da.copy=43]="copy";da[da.paste=44]="paste";da[da.dragDrop=45]="dragDrop";da[da.clearCopyState=46]="clearCopyState";da[da.webWorkerRecalcStats=47]="webWorkerRecalcStats";da[da.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";da[da.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";da[da.customSort=50]="customSort";da[da.namedSheetViewUserAction=51]="namedSheetViewUserAction";da[da.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";
da[da.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";da[da.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";da[da.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";da[da.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";da[da.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";da[da.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";da[da.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(Md||
(Md={}));Object(h.b)("UsageTable",Md);var Ud=a(430),fe=a(483),me=a(616),Te=a(669),Pe=a(283);class zf extends Sys.EventArgs{constructor(){super();this.eYi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(h.a)(zf,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Nf{constructor(da,qa=1){this.wVd=qa;this.total=da}get average(){return this.total/this.wVd}qgh(da){return new Nf(this.total+da.total,this.wVd+da.wVd)}static O7g(da,qa){return`${da}_${qa}`}}Object(h.a)(Nf,"StopwatchAverage",
null,[]);var Gf;(function(da){da[da.longFrame=0]="longFrame";da[da.longGetRange=1]="longGetRange";da[da.longJsTask=2]="longJsTask";da[da.viewportCalculationLoops=3]="viewportCalculationLoops"})(Gf||(Gf={}));Object(h.b)("UtrKpiVeto",Gf);class Tf{static f8a(da){return Enum.toString(Gf,da)}}Tf.BXa="UTR";Object(h.a)(Tf,"KpiConstants",null,[]);class Qf{}Qf.Bvg="UTRVetoName";Qf.svg="UTRErrorName";Qf.Zhk="UTROperationName";Qf.W7d="UTRDuration";Qf.$hk="UTREndedInPhase";Qf.xvg="UTRMessage";Qf.zvg="UtrUnavailabilityType";
Qf.operationName="OperationName";Qf.duration="Duration";Qf.message="Message";Object(h.a)(Qf,"UtrAdditionalData",null,[]);class jg{}jg.Wjk="VetoLike";jg.SAh="E2EOperationPerf";jg.jCj="RequestPerf";jg.Wak="UnavailabilityDurations";Object(h.a)(jg,"UtrTypes",null,[]);class yg{ZOb(da,qa,Xb=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Xb=Xb?Object(vb.a)(new R.a,{extendedProperties:Xb}):null,da=Tf.f8a(da),I.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+da,qa,!1,
!0,"",Xb))}KQb(da,qa,Xb,Pc,zd,ce){ce[Tf.BXa]=jg.Wjk;ce[Qf.Bvg]=Tf.f8a(Pc);ce[Qf.svg]=zd;l.ULS.sendTraceTag(da,qa,Xb,dc.a.Zc(ce));delete ce[Tf.BXa];delete ce[Qf.Bvg];delete ce[Qf.svg]}}Object(h.a)(yg,"UtrKpiVetoReporter",null,[]);class Yf{dPb(da,qa=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||I.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Tf.f8a(da),0,"",qa)}ZOb(da,qa,Xb=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(da=Tf.f8a(da),
I.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+da,qa,!1,!0,this.nad(Xb)))}tBj(da,qa=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||I.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Tf.f8a(da),"",this.nad(qa))}sBj(da,qa,Xb=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(da=Tf.f8a(da),I.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+da,qa,!1,!0,"",this.nad(Xb)))}nad(da){return da?Object(vb.a)(new R.a,{extendedProperties:da}):
null}}Object(h.a)(Yf,"UtrKpiVetoUsageReporter",null,[]);class ug{FAc(da,qa,Xb=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||I.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+da,"",Object(vb.a)(new R.a,{extendedProperties:Xb,durationMs:qa}))}NAc(da,qa,Xb=null){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(qa?I.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+da,"",Object(vb.a)(new R.a,{extendedProperties:Xb})):
I.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+da,"",!1,!1,"",Object(vb.a)(new R.a,{extendedProperties:Xb})))}HQb(da,qa,Xb,Pc,zd,ce,we,...De){we=String.format(we,...De);De={};De[Tf.BXa]=jg.SAh;De[Qf.Zhk]=Pc;De[Qf.$hk]=zd;De[Qf.W7d]=ce;De[Qf.xvg]=we;l.ULS.sendTraceTag(da,qa,Xb,dc.a.Zc(De))}JQb(da,qa,Xb,Pc,zd,ce){this.Yeg(ce,Pc,zd);l.ULS.sendTraceTag(da,qa,Xb,dc.a.Zc(ce));this.Rvh(ce)}IQb(da,qa,Xb,Pc,zd,ce,...we){ce=String.format(ce,...we);we={};this.Yeg(we,Pc,zd,ce);l.ULS.sendTraceTag(da,
qa,Xb,dc.a.Zc(we))}NCc(da,qa,Xb,Pc){Pc[Tf.BXa]=jg.jCj;l.ULS.sendTraceTag(da,qa,Xb,dc.a.Zc(Pc));delete Pc[Tf.BXa]}Yeg(da,qa,Xb,Pc=null){da[Tf.BXa]=jg.Wak;da[Qf.zvg]=qa;da[Qf.W7d]=Xb;Pc&&(da[Qf.xvg]=Pc)}Rvh(da){delete da[Tf.BXa];delete da[Qf.zvg];delete da[Qf.W7d]}}Object(h.a)(ug,"UtrOperationPerfReporter",null,[]);class cf extends df.a{constructor(da,qa=null,Xb=null,Pc=null,zd=null,ce=!1){super();this.ePh=[ba.a.REe,ba.a.yYe,ba.a.zYe,ba.a.rlc,ba.a.Uqc,ba.a.lOi,ba.a.renderCachedContent,ba.a.renderServerContent,
ba.a.jac,ba.a.PGj,ba.a.v$f,ba.a.w$f,ba.a.DKj];this.Jpb=this.gGa=this.gVb=this.ikb=this.Vke=this.TDe=this.y_a=this.Sre=null;this.kVf=this.PEe=!1;this.wvg=this.vvg=this.yvg=this.RTd=this.Pwg=null;this.cQf=(we,De)=>{for(we=0;we<De.entries.length;we++){const Cf=De.entries[we];Cf.url=A.a.removeParameter(Cf.url,v.AFrameworkApplication.PQ);var kf=A.a.Mfa(Cf.url);!yb.EwaSettings.ya(426)&&this.kGi(Cf.url,kf)&&(Cf.behavior=1);if("img"===Cf.Yu.initiatorType&&kf.endsWith(Ic.a.Fed)){var Ue=A.a.u0(Cf.url,Ic.a.Eed),
Uf=A.a.u0(Cf.url,Ic.a.Ged);Cf.yca=`${Cf.yca}imageID=${Ue}, imgStateID=${Uf}`}Ue=Cf.Yu.transferSize;let pg;Uf=Cf.Yu.decodedBodySize;void 0!==Ue&&null!==Ue&&void 0!==Uf&&null!==Uf?pg=0===Ue&&0<Uf:void 0!==Ue&&null!==Ue&&(pg=0===Ue);Wb.PageLoadTrackingInfo.instance.tUg(kf,Math.round(Cf.Yu.fetchStart),Math.round(Cf.Yu.responseEnd),pg,this.YHi);Gb.a.contains(kf,ba.a.richTextEditor,!0)&&(kf=re.TextEditorTelemetry.instance,kf.JF(ba.a.JDj,Math.round(Cf.Yu.fetchStart)),kf.JF(ba.a.LDj,Math.round(Cf.Yu.responseEnd)))}};
this.xX=()=>{const we=this.g$;for(let De in we)we[De].h=!0};this.userSessionId=da;this.n4a=qa=qa||new me.a;this.ii=Xb||xa.a.Bb;this.B2j=Pc||this;this.jf=zd;this.YHi=ce;this.URe=qa.Jbb();this.jf&&this.jf.WIa(this.xX)}get g$(){return this.Sre||(this.Sre={})}get YQe(){return this.ikb||this.URe}get hRe(){return this.gGa||cf.cGf}get o2d(){return this.TDe=this.TDe||{}}get Wwc(){return this.y_a||"undefined"===typeof Stw?this.y_a:this.y_a=Stw.swpc}get aBf(){return this.Vke=this.Vke||{}}get kUa(){return this.Jpb||
(this.Jpb=nb.a.instance.qc("Common.NetworkTiming.IResourceTimingLogger"))}get uvg(){return this.vvg||(this.vvg=new yg)}get mkb(){return this.yvg||(this.yvg=new ug)}get pKc(){return this.wvg||(this.wvg=new Yf)}aGc(da,qa,Xb,Pc,zd=null){if(this.g$[Xb])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.g$[Xb]=this.tQe(da,qa,Xb,Pc,zd)}mdc(da,qa){const Xb=this.g$[da];Xb&&(this.mMe(Xb,qa),this.Wck(Xb),delete this.g$[da])}K3f(da){delete this.g$[da]}Wkg(da,qa){this.ikb||this.Kkg(da,
qa)}Fkg(){this.Wkg(cf.Eqd,this.ii.Ye)}mXe(da,qa=!1){if(this.ikb){if(this.gGa===cf.MLd||this.gGa===cf.Eqd){const Xb=O.a.instance;Xb.userSessionId=this.userSessionId;if(this.gGa===cf.MLd){this.PEe||(this.boa(da.m,Object(Z.a)(Xb,Xb.Trj,"recordContentFetchEnd")),this.PEe=!0);if(qa){this.kVf||(this.boa(da.m,Object(Z.a)(Xb,Xb.esj,"recordPerceivedContentDisplayed")),this.kVf=!0);return}this.boa(da.m,Object(Z.a)(Xb,Xb.Srj,"recordContentDisplayed"))}else this.gGa===cf.Eqd&&(qa=this.g$[this.gVb])&&this.boa(Pe.a(da,
qa.s),Object(Z.a)(Xb,Xb.$rj,"recordInteractivityContentDisplayed"),!1)}this.mdc(this.gVb,da);this.gVb=this.gGa=this.ikb=null}}boa(da,qa,Xb=!0){O.a.dR&&Object(hc.a)(Te.PerformanceClock,xa.a.Bb)&&Xb&&(da+=window.performance.timing.navigationStart);qa(da)}jk(da){return Ud.a(da)}Df(da,qa,Xb=!1){try{if(this.aBf[Md[da]]=!0,Xb){var Pc=l.ULS,zd=Pc.sendTraceTag;const Oc={};let Ef=null;switch(da){case 0:Ef="Actions";var ce=qa.a;null!=ce&&(Oc.Id=ce);var we=null==qa.b?null:qa.b;null!=we&&(Oc.Operation=we);var De=
qa.c;null!=De&&(Oc.Target=De);var kf=null==qa.d?null:qa.d.toString();null!=kf&&(Oc.StartTime=kf);var Ue=null==qa.e?null:qa.e.toString();null!=Ue&&(Oc.Duration=Ue);var Uf=qa.f;null!=Uf&&(Oc.CorrelationId=Uf);var Cf=qa.g;null!=Cf&&(Oc.ParentAction=Cf);var pg=null==qa.h?null:qa.h.toString();null!=pg&&(Oc.DocumentHidden=pg);break;case 1:Ef="CorrelationStart";var zg=qa.a;null!=zg&&(Oc.CorrelationId=zg);var Bg=qa.b;null!=Bg&&(Oc.UserSessionId=Bg);var dh=qa.c;null!=dh&&(Oc.UserAction=dh);break;case 2:Ef=
"ReorderSheetOp";var Fg=qa.a;null!=Fg&&(Oc.UserSessionId=Fg);var uh=null==qa.b?null:qa.b.toString();null!=uh&&(Oc.IsDragReorder=uh);var fg=null==qa.c?null:qa.c.toString();null!=fg&&(Oc.DocumentUp=fg);var Gg=null==qa.d?null:qa.d.toString();null!=Gg&&(Oc.OldIndex=Gg);var Cg=null==qa.e?null:qa.e.toString();null!=Cg&&(Oc.NewIndex=Cg);var rg=null==qa.f?null:qa.f.toString();null!=rg&&(Oc.TotalSheets=rg);break;case 3:Ef="FormatCellOp";var lh=qa.a;null!=lh&&(Oc.UserSessionId=lh);var Of=null==qa.b?null:qa.b.toString();
null!=Of&&(Oc.TaskId=Of);var Pg=null==qa.c?null:qa.c.toString();null!=Pg&&(Oc.NumberOfRanges=Pg);var ch=qa.d;null!=ch&&(Oc.Ranges=ch);var qh=qa.e;null!=qh&&(Oc.ActiveCell=qh);var fh=null==qa.f?null:qa.f.toString();null!=fh&&(Oc.ActionId=fh);var eh=qa.g;null!=eh&&(Oc.CommandParameters=eh);var Zg=qa.h;null!=Zg&&(Oc.UserActionStopwatchId=Zg);break;case 4:Ef="CopyOp";var zh=qa.a;null!=zh&&(Oc.UserSessionId=zh);var Dh=null==qa.b?null:qa.b.toString();null!=Dh&&(Oc.IsChrome=Dh);var gh=null==qa.c?null:qa.c.toString();
null!=gh&&(Oc.IsIE=gh);var $g=null==qa.d?null:qa.d.toString();null!=$g&&(Oc.IsFromUI=$g);var hh=null==qa.e?null:qa.e.toString();null!=hh&&(Oc.IsCopyInLoadedRange=hh);var ea=null==qa.f?null:qa.f.toString();null!=ea&&(Oc.IsRepeatedCopy=ea);var H=null==qa.g?null:qa.g.toString();null!=H&&(Oc.IsClipboarAccessSupported=H);var va=null==qa.h?null:qa.h.toString();null!=va&&(Oc.IsClipboarAccessInstallationSupported=va);var lb=null==qa.i?null:qa.i.toString();null!=lb&&(Oc.RibbonCommand=lb);var Ub=null==qa.j?
null:qa.j.toString();null!=Ub&&(Oc.CutCopyPasteFlags=Ub);var Mc=null==qa.k?null:qa.k.toString();null!=Mc&&(Oc.IsDrag=Mc);var rd=null==qa.l?null:qa.l.toString();null!=rd&&(Oc.IsIeBeforeAlowDenyPopUp=rd);var Id=qa.m;null!=Id&&(Oc.IsPasteMatchCopy=Id);var be=qa.n;null!=be&&(Oc.WaitMessageInClipboard=be);var ze=null==qa.o?null:qa.o.toString();null!=ze&&(Oc.CallCount=ze);break;case 5:Ef="PasteOp";var Me=qa.a;null!=Me&&(Oc.UserSessionId=Me);var jf=null==qa.b?null:qa.b.toString();null!=jf&&(Oc.IsChrome=
jf);var If=null==qa.c?null:qa.c.toString();null!=If&&(Oc.IsIE=If);var Rf=null==qa.d?null:qa.d.toString();null!=Rf&&(Oc.IsCopyActive=Rf);var ng=null==qa.e?null:qa.e.toString();null!=ng&&(Oc.IsFromUI=ng);var mg=null==qa.f?null:qa.f.toString();null!=mg&&(Oc.IsClipboarAccessSupported=mg);var kg=null==qa.g?null:qa.g.toString();null!=kg&&(Oc.IsClipboarAccessInstallationSupported=kg);var Hg=null==qa.h?null:qa.h.toString();null!=Hg&&(Oc.RibbonCommand=Hg);var vh=null==qa.i?null:qa.i.toString();null!=vh&&(Oc.CutCopyPasteFlags=
vh);var mh=qa.j;null!=mh&&(Oc.WaitMessageInClipboard=mh);var $f=qa.k;null!=$f&&(Oc.PopupDialog=$f);var wh=qa.l;null!=wh&&(Oc.SimplePopupMessage=wh);var hi=qa.m;null!=hi&&(Oc.DialogCloseButton=hi);var ii=qa.n;null!=ii&&(Oc.UserPressedInstallLink=ii);var Ah=null==qa.o?null:qa.o.toString();null!=Ah&&(Oc.CallCount=Ah);break;case 6:Ef="GetNumberViewModelDataOp";var wi=qa.a;null!=wi&&(Oc.UserSessionId=wi);var Ze=qa.b;null!=Ze&&(Oc.NumberFormatOptionsPreviousOutputJson=Ze);var ji=qa.c;null!=ji&&(Oc.NumberFormatOptionsNewInputJson=
ji);break;case 7:Ef="InstantaneousSetData";var Ih=qa.a;null!=Ih&&(Oc.Id=Ih);var ki=null==qa.b?null:qa.b.toString();null!=ki&&(Oc.WasEmpty=ki);var Wh=null==qa.c?null:qa.c.toString();null!=Wh&&(Oc.ValueNotChanged=Wh);var Xh=qa.d;null!=Xh&&(Oc.Source=Xh);var Yh=null==qa.e?null:qa.e.toString();null!=Yh&&(Oc.ProcessingCompleted=Yh);break;case 8:Ef="ImmediateSetData";var nh=qa.a;null!=nh&&(Oc.ClientStopwatchId=nh);var Qg=qa.b;null!=Qg&&(Oc.Operation=Qg);var Eh=qa.c;null!=Eh&&(Oc.Parameters=Eh);var Zh=null==
qa.d?null:qa.d.toString();null!=Zh&&(Oc.WasUpdatedByImmediate=Zh);var li=null==qa.e?null:qa.e.toString();null!=li&&(Oc.areHtmlElementsEqualClientComparison=li);var mi=null==qa.f?null:qa.f.toString();null!=mi&&(Oc.WasDecisionMadeByHtmlComparison=mi);var ye=null==qa.g?null:qa.g.toString();null!=ye&&(Oc.IsNumeric=ye);var K=null==qa.h?null:qa.h.toString();null!=K&&(Oc.IsDateTime=K);var ua=null==qa.i?null:qa.i.toString();null!=ua&&(Oc.HasCurrencySymbol=ua);var ab=null==qa.j?null:qa.j.toString();null!=
ab&&(Oc.HasPercentSymbol=ab);var Ib=null==qa.k?null:qa.k.toString();null!=Ib&&(Oc.IsFunc=Ib);var mc=null==qa.l?null:qa.l.toString();null!=mc&&(Oc.DiffInWrappingWhitespace=mc);var Cc=qa.m;null!=Cc&&(Oc.ImmediatePattern=Cc);var Ec=null==qa.n?null:qa.n.toString();null!=Ec&&(Oc.TextAlignmentMatch=Ec);var hd=null==qa.o?null:qa.o.toString();null!=hd&&(Oc.FontColorMatch=hd);var Zc=null==qa.p?null:qa.p.toString();null!=Zc&&(Oc.FormulaTextMatch=Zc);var bd=null==qa.q?null:qa.q.toString();null!=bd&&(Oc.isFormula=
bd);var Ad=qa.r;null!=Ad&&(Oc.FormulaText=Ad);var Od=qa.s;null!=Od&&(Oc.InstantaneousPattern=Od);var ke=null==qa.t?null:qa.t.toString();null!=ke&&(Oc.AreHtmlInnerTextElementsEqualClientComparison=ke);var Qe=qa.u;null!=Qe&&(Oc.HtmlComparisonDecision=Qe);break;case 9:Ef="DependentCellsCalc";var Be=qa.a;null!=Be&&(Oc.CalcStatus=Be);var Ge=null==qa.b?null:qa.b.toString();null!=Ge&&(Oc.SuccessfullyCalculatedRanges=Ge);var vf=null==qa.c?null:qa.c.toString();null!=vf&&(Oc.RangesSkipped=vf);var ff=null==
qa.d?null:qa.d.toString();null!=ff&&(Oc.TotalErrors=ff);var tf=null==qa.e?null:qa.e.toString();null!=tf&&(Oc.Partial=tf);var Qc=null==qa.f?null:qa.f.toString();null!=Qc&&(Oc.Canceled=Qc);var vd=null==qa.g?null:qa.g.toString();null!=vd&&(Oc.Aggregate=vd);var We=null==qa.h?null:qa.h.toString();null!=We&&(Oc.Unknown=We);var Pf=null==qa.i?null:qa.i.toString();null!=Pf&&(Oc.UnavailableData=Pf);var Xf=null==qa.j?null:qa.j.toString();null!=Xf&&(Oc.Cycle=Xf);var Zf=null==qa.k?null:qa.k.toString();null!=Zf&&
(Oc.NotImplemented=Zf);var xg=null==qa.l?null:qa.l.toString();null!=xg&&(Oc.InvalidInput=xg);var ig=null==qa.m?null:qa.m.toString();null!=ig&&(Oc.AreDepCells=ig);break;case 10:Ef="DependentCellsGraphStat";var Vg=null==qa.a?null:qa.a.toString();null!=Vg&&(Oc.ParsedFormulas=Vg);var Hh=null==qa.b?null:qa.b.toString();null!=Hh&&(Oc.GraphNodes=Hh);var xh=null==qa.c?null:qa.c.toString();null!=xh&&(Oc.GraphArcs=xh);var $h=null==qa.d?null:qa.d.toString();null!=$h&&(Oc.AnalyzedBlocks=$h);var ai=null==qa.e?
null:qa.e.toString();null!=ai&&(Oc.IterationId=ai);var bi=qa.f;null!=bi&&(Oc.UniqueId=bi);var ci=null==qa.g?null:qa.g.toString();null!=ci&&(Oc.Aborted=ci);break;case 11:Ef="DependentCellsGraphSectionStat";var Gi=null==qa.a?null:qa.a.toString();null!=Gi&&(Oc.IterationId=Gi);var di=qa.b;null!=di&&(Oc.BlockHash=di);var Eg=qa.c;null!=Eg&&(Oc.Functions=Eg);var Rh=qa.d;null!=Rh&&(Oc.Operators=Rh);var xi=null==qa.e?null:qa.e.toString();null!=xi&&(Oc.CrossDocRefs=xi);var Kh=null==qa.f?null:qa.f.toString();
null!=Kh&&(Oc.CrossSheetRefs=Kh);var hj=null==qa.g?null:qa.g.toString();null!=hj&&(Oc.ErrRefs=hj);var ni=null==qa.h?null:qa.h.toString();null!=ni&&(Oc.LargeRanges=ni);var Ch=null==qa.i?null:qa.i.toString();null!=Ch&&(Oc.NameRefs=Ch);var oi=null==qa.j?null:qa.j.toString();null!=oi&&(Oc.ParserErrors=oi);var of=null==qa.k?null:qa.k.toString();null!=of&&(Oc.RowRefs=of);var Sh=null==qa.l?null:qa.l.toString();null!=Sh&&(Oc.ColumnRefs=Sh);var jh=null==qa.m?null:qa.m.toString();null!=jh&&(Oc.TableRefs=jh);
var Tg=qa.n;null!=Tg&&(Oc.UniqueId=Tg);var qg=null==qa.o?null:qa.o.toString();null!=qg&&(Oc.UnreachableReferences=qg);break;case 12:Ef="GetRangeContentPrefetchFailures";var pi=qa.a;null!=pi&&(Oc.UserSessionId=pi);var qi=qa.b;null!=qi&&(Oc.ClientStopwatchId=qi);var Ui=null==qa.c?null:qa.c.toString();null!=Ui&&(Oc.StateId=Ui);break;case 13:Ef="GridBlockUpdates";var ri=qa.a;null!=ri&&(Oc.UserSessionId=ri);var si=qa.b;null!=si&&(Oc.CorrelationId=si);var sh=qa.c;null!=sh&&(Oc.Operation=sh);var Ag=null==
qa.d?null:qa.d.toString();null!=Ag&&(Oc.PerformanceType=Ag);var Hi=qa.e;null!=Hi&&(Oc.BlockHash=Hi);var ti=null==qa.f?null:qa.f.toString();null!=ti&&(Oc.DurationInMs=ti);break;case 14:Ef="BrowserAppStart";var Ii=null==qa.a?null:jd.a.Vva(qa.a.getTime());null!=Ii&&(Oc.ScriptExecutionStart=Ii);var Vi=qa.b;null!=Vi&&(Oc.UserSessionId=Vi);var Ji=qa.c;null!=Ji&&(Oc.ClockMechanism=Ji);var Wi=null==qa.d?null:qa.d.toString();null!=Wi&&(Oc.ScreenDPI=Wi);var Xi=null==qa.e?null:qa.e.toString();null!=Xi&&(Oc.NavigationToScriptExecutionDelta=
Xi);break;case 15:Ef="LinkedObjects";var Yi=qa.a;null!=Yi&&(Oc.ChildId=Yi);var ag=qa.b;null!=ag&&(Oc.ParentId=ag);var Ki=qa.c;null!=Ki&&(Oc.ChildTable=Ki);var Zi=qa.d;null!=Zi&&(Oc.ParentTable=Zi);break;case 16:Ef="LongFrames";var Li=null==qa.a?null:jd.a.Vva(qa.a.getTime());null!=Li&&(Oc.StartTime=Li);var ui=null==qa.b?null:qa.b.toString();null!=ui&&(Oc.DurationInMs=ui);break;case 17:Ef="Task";var Mi=qa.a;null!=Mi&&(Oc.StopwatchId=Mi);var $i=null==qa.b?null:qa.b.toString();null!=$i&&(Oc.Status=$i);
var yi=null==qa.c?null:qa.c.toString();null!=yi&&(Oc.CreateTime=yi);var ij=null==qa.d?null:qa.d.toString();null!=ij&&(Oc.TaskId=ij);break;case 18:Ef="ConflictInEditing";var tg=qa.a;null!=tg&&(Oc.OtherUserState=tg);var Th=qa.b;null!=Th&&(Oc.UserSessionId=Th);var Lh=null==qa.c?null:jd.a.Vva(qa.c.getTime());null!=Lh&&(Oc.ConflictTime=Lh);break;case 19:Ef="IncomingPresenceData";var aj=qa.a;null!=aj&&(Oc.UserSessionId=aj);var zi=qa.b;null!=zi&&(Oc.UserId=zi);var Fh=null==qa.c?null:qa.c.toString();null!=
Fh&&(Oc.Disconnected=Fh);var Mh=null==qa.d?null:jd.a.Vva(qa.d.getTime());null!=Mh&&(Oc.ReceivedTime=Mh);break;case 20:Ef="EditorTableDelay";var th=qa.a;null!=th&&(Oc.UserSessionId=th);var Ug=qa.b;null!=Ug&&(Oc.UserId=Ug);var ei=null==qa.c?null:qa.c.toString();null!=ei&&(Oc.Received=ei);var Ai=null==qa.d?null:qa.d.toString();null!=Ai&&(Oc.DurationInMs=Ai);var Ni=null==qa.e?null:qa.e.toString();null!=Ni&&(Oc.NotAloneAtLogTime=Ni);var Oi=null==qa.f?null:jd.a.Vva(qa.f.getTime());null!=Oi&&(Oc.Time=Oi);
break;case 21:Ef="PresenceStartup";var Pi=qa.a;null!=Pi&&(Oc.UserSessionId=Pi);var Jg=null==qa.b?null:qa.b.toString();null!=Jg&&(Oc.EverReceived=Jg);var bj=null==qa.c?null:qa.c.toString();null!=bj&&(Oc.NotAloneOnOpen=bj);var Bi=null==qa.d?null:qa.d.toString();null!=Bi&&(Oc.NotAloneAtLogTime=Bi);var fi=null==qa.e?null:qa.e.toString();null!=fi&&(Oc.EditorCount=fi);var cj=null==qa.f?null:qa.f.toString();null!=cj&&(Oc.WorkbookOpenToFirstReceivedInMs=cj);break;case 22:Ef="PresenceDelete";var jj=qa.a;null!=
jj&&(Oc.UserSessionId=jj);var Qi=qa.b;null!=Qi&&(Oc.UserId=Qi);var Ri=qa.c;null!=Ri&&(Oc.Context=Ri);var Og=qa.d;null!=Og&&(Oc.Reason=Og);var Ci=null==qa.e?null:jd.a.Vva(qa.e.getTime());null!=Ci&&(Oc.Time=Ci);break;case 23:Ef="EditorEvent";var kh=qa.a;null!=kh&&(Oc.UserSessionId=kh);var gi=qa.b;null!=gi&&(Oc.UserId=gi);var dj=qa.c;null!=dj&&(Oc.Context=dj);var Nh=null==qa.d?null:jd.a.Vva(qa.d.getTime());null!=Nh&&(Oc.Time=Nh);break;case 24:Ef="EditorTime";var Si=qa.a;null!=Si&&(Oc.UserSessionId=Si);
var Uh=qa.b;null!=Uh&&(Oc.UserId=Uh);var Ti=null==qa.c?null:qa.c.toString();null!=Ti&&(Oc.DurationInMs=Ti);break;case 25:Ef="GridScreenReaderOps";var Di=qa.a;null!=Di&&(Oc.UserSessionId=Di);var Vf=qa.b;null!=Vf&&(Oc.CommandTaskId=Vf);var T=null==qa.c?null:qa.c.toString();null!=T&&(Oc.CommandId=T);var eb=null==qa.d?null:qa.d.toString();null!=eb&&(Oc.ClientSideOnly=eb);var tb=null==qa.e?null:qa.e.toString();null!=tb&&(Oc.DurationInMS=tb);var kc=null==qa.f?null:qa.f.toString();null!=kc&&(Oc.ReachedMaxReadoutCells=
kc);var yc=null==qa.g?null:qa.g.toString();null!=yc&&(Oc.RequstedCellCount=yc);var Sc=null==qa.h?null:qa.h.toString();null!=Sc&&(Oc.NonEmptyCellCount=Sc);var fd=null==qa.i?null:qa.i.toString();null!=fd&&(Oc.Succeeded=fd);var sd=null==qa.j?null:qa.j.toString();null!=sd&&(Oc.Canceled=sd);var Dc=qa.k;null!=Dc&&(Oc.ErrorType=Dc);break;case 26:Ef="SendPresenceToService";var pd=qa.a;null!=pd&&(Oc.UserSessionId=pd);var Dd=null==qa.b?null:qa.b.toString();null!=Dd&&(Oc.TotalCount=Dd);var wd=null==qa.c?null:
qa.c.toString();null!=wd&&(Oc.SendCount=wd);break;case 27:Ef="IME";var Kd=qa.a;null!=Kd&&(Oc.UserSessionId=Kd);break;case 28:Ef="FreezePaneFloatingObjects";var ie=qa.a;null!=ie&&(Oc.UserSessionId=ie);var xe=null==qa.b?null:qa.b.toString();null!=xe&&(Oc.ObjectType=xe);var Je=qa.c;null!=Je&&(Oc.ObjectID=Je);var rf=null==qa.d?null:qa.d.toString();null!=rf&&(Oc.SpannedPanesCount=rf);break;case 29:Ef="CustomizeStatusBar";var eg=qa.a;null!=eg&&(Oc.UserSessionId=eg);var Sf=qa.b;null!=Sf&&(Oc.UIControlName=
Sf);var yf=null==qa.c?null:qa.c.toString();null!=yf&&(Oc.IsControlVisible=yf);break;case 30:Ef="ClientWebRequests";var og=qa.a;null!=og&&(Oc.Path=og);var Mf=qa.b;null!=Mf&&(Oc.ProxyStopwatchId=Mf);var sg=qa.c;null!=sg&&(Oc.RequestStatus=sg);var Mg=null==qa.d?null:qa.d.toString();null!=Mg&&(Oc.ResponseSizeInBytes=Mg);var ah=qa.e;null!=ah&&(Oc.ClientRequestId=ah);var dg=null==qa.f?null:qa.f.toString();null!=dg&&(Oc.StateId=dg);break;case 31:Ef="ShowCommentTaskPane";var Wg=qa.a;null!=Wg&&(Oc.UserSessionId=
Wg);var ph=null==qa.b?null:qa.b.toString();null!=ph&&(Oc.IsFromKeyboardShortcut=ph);var ih=null==qa.c?null:qa.c.toString();null!=ih&&(Oc.IsShowPane=ih);var bh=null==qa.d?null:qa.d.toString();null!=bh&&(Oc.ShowForDeepLink=bh);var Af=null==qa.e?null:qa.e.toString();null!=Af&&(Oc.DeepLinkFound=Af);break;case 32:Ef="ApplyThreadedCommentChange";var lf=qa.a;null!=lf&&(Oc.UserSessionId=lf);var Df=null==qa.b?null:qa.b.toString();null!=Df&&(Oc.Operation=Df);var mf=qa.c;null!=mf&&(Oc.CommentId=mf);var Hf=null==
qa.d?null:qa.d.toString();null!=Hf&&(Oc.CommentsCount=Hf);break;case 33:Ef="UpgradeLegacyCommentsChange";var hf=qa.a;null!=hf&&(Oc.UserSessionId=hf);var Kf=null==qa.b?null:qa.b.toString();null!=Kf&&(Oc.OperationSuccessful=Kf);break;case 34:Ef="FindNextOrPreviousComment";var Dg=qa.a;null!=Dg&&(Oc.UserSessionId=Dg);var Ng=null==qa.b?null:qa.b.toString();null!=Ng&&(Oc.Succeeded=Ng);break;case 35:Ef="Goto";var Jf=qa.a;null!=Jf&&(Oc.UserSessionId=Jf);var Lf=null==qa.b?null:qa.b.toString();null!=Lf&&(Oc.IsSucceeded=
Lf);var Qh=null==qa.c?null:qa.c.toString();null!=Qh&&(Oc.IsNOVMode=Qh);break;case 36:Ef="LaunchOfficeAddInDialog";var rh=qa.a;null!=rh&&(Oc.UserSessionId=rh);var Jh=qa.b;null!=Jh&&(Oc.SourceId=Jh);var lg=qa.c;null!=lg&&(Oc.SourceLabel=lg);var Lg=qa.d;null!=Lg&&(Oc.Flight=Lg);var Rg=qa.e;null!=Rg&&(Oc.Experiment=Rg);var gg=qa.f;null!=gg&&(Oc.UICultureTag=gg);var Sg=null==qa.g?null:qa.g.toString();null!=Sg&&(Oc.UICultureTagLcid=Sg);var oh=null==qa.h?null:qa.h.toString();null!=oh&&(Oc.WacHostId=oh);
break;case 37:Ef="RichApiInvocation";var Bh=qa.a;null!=Bh&&(Oc.UserSessionId=Bh);var Ig=null==qa.b?null:qa.b.toString();null!=Ig&&(Oc.Succeeded=Ig);var Ph=qa.c;null!=Ph&&(Oc.ErrorType=Ph);var oj=qa.d;null!=oj&&(Oc.ResultInfo=oj);var pj=qa.e;null!=pj&&(Oc.Source=pj);break;case 38:Ef="FxLibrary";var ej=qa.a;null!=ej&&(Oc.EntityName=ej);var qj=null==qa.b?null:qa.b.toString();null!=qj&&(Oc.EntryPoint=qj);var yh=null==qa.c?null:qa.c.toString();null!=yh&&(Oc.Action=yh);var rj=null==qa.d?null:qa.d.toString();
null!=rj&&(Oc.InsertLocation=rj);break;case 39:Ef="EmbeddedApiSession";var sj=qa.a;null!=sj&&(Oc.UserSessionId=sj);break;case 40:Ef="NumberFormattingCalculator";var tj=qa.a;null!=tj&&(Oc.Id=tj);var uj=qa.b;null!=uj&&(Oc.CounterName=uj);var Oh=qa.c;null!=Oh&&(Oc.Values=Oh);break;case 41:Ef="RequestDataAfterSend";var kj=qa.a;null!=kj&&(Oc.ClientStopwatchId=kj);var Kj=qa.b;null!=Kj&&(Oc.RequestStatus=Kj);var fj=null==qa.c?null:qa.c.toString();null!=fj&&(Oc.SendDuration=fj);var Gh=null==qa.d?null:qa.d.toString();
null!=Gh&&(Oc.RequestId=Gh);break;case 42:Ef="FloatingObjectsStopwatchData";var vj=qa.a;null!=vj&&(Oc.StopMessage=vj);var wj=null==qa.b?null:qa.b.toString();null!=wj&&(Oc.Type=wj);var lj=qa.c;null!=lj&&(Oc.GUID=lj);var xj=null==qa.d?null:qa.d.toString();null!=xj&&(Oc.Pane=xj);var yj=null==qa.e?null:qa.e.toString();null!=yj&&(Oc.IsAboveGrid=yj);var zj=qa.f;null!=zj&&(Oc.StartCorrelation=zj);var Lj=qa.g;null!=Lj&&(Oc.LoadImageCorrelation=Lj);var Aj=null==qa.h?null:qa.h.toString();null!=Aj&&(Oc.SkippedGetEffectsExtents=
Aj);var Bj=null==qa.i?null:qa.i.toString();null!=Bj&&(Oc.Version=Bj);break;case 43:Ef="Copy";var Mj=qa.a;null!=Mj&&(Oc.UserSessionId=Mj);var Nj=qa.b;null!=Nj&&(Oc.Trigger=Nj);var Cj=qa.c;null!=Cj&&(Oc.RibbonCommandName=Cj);var Dj=qa.d;null!=Dj&&(Oc.SourceItem=Dj);var Ej=null==qa.e?null:qa.e.toString();null!=Ej&&(Oc.SourceRangeCellCount=Ej);var Ei=qa.f;null!=Ei&&(Oc.ClientSideStopwatchId=Ei);var Oj=qa.g;null!=Oj&&(Oc.CopyOperationId=Oj);var Fj=null==qa.h?null:qa.h.toString();null!=Fj&&(Oc.IsAsync=
Fj);var Fi=null==qa.i?null:qa.i.toString();null!=Fi&&(Oc.IsFromCache=Fi);var Gj=null==qa.j?null:qa.j.toString();null!=Gj&&(Oc.IsSuccessiveCopy=Gj);var Hj=null==qa.k?null:qa.k.toString();null!=Hj&&(Oc.IsSelectionAllowed=Hj);var Ij=null==qa.l?null:qa.l.toString();null!=Ij&&(Oc.IsSuccess=Ij);var Pj=null==qa.m?null:qa.m.toString();null!=Pj&&(Oc.IsExpectedError=Pj);var Jj=qa.n;null!=Jj&&(Oc.ExpectedErrorReason=Jj);var Qj=qa.o;null!=Qj&&(Oc.ErrorMessage=Qj);var mj=null==qa.p?null:qa.p.toString();null!=
mj&&(Oc.ClientSideCopyTimeInMs=mj);var Rj=null==qa.q?null:qa.q.toString();null!=Rj&&(Oc.TotalTimeInMs=Rj);var Sj=null==qa.r?null:qa.r.toString();null!=Sj&&(Oc.PlainTextPayloadSize=Sj);var Tj=qa.s;null!=Tj&&(Oc.CopyPasteTargetType=Tj);var Uj=null==qa.t?null:qa.t.toString();null!=Uj&&(Oc.ShadowWorkbookPayloadSize=Uj);var Vj=null==qa.u?null:qa.u.toString();null!=Vj&&(Oc.HtmlPayloadSize=Vj);var Wj=null==qa.v?null:qa.v.toString();null!=Wj&&(Oc.HtmlSizeExceedsLimit=Wj);var Bf=null==qa.w?null:qa.w.toString();
null!=Bf&&(Oc.CopyTotalSizeExceedsLimit=Bf);var nj=null==qa.x?null:qa.x.toString();null!=nj&&(Oc.ErrorReason=nj);var Xj=qa.y;null!=Xj&&(Oc.ErrorName=Xj);var gj=null==qa.z?null:qa.z.toString();null!=gj&&(Oc.IsSucceededWithAlert=gj);var N=null==qa.ba?null:qa.ba.toString();null!=N&&(Oc.EncounteredDeploymentErrors=N);var Qa=null==qa.bb?null:qa.bb.toString();null!=Qa&&(Oc.ShadowWorkbookSizeExceedsLimit=Qa);var Db=qa.bc;null!=Db&&(Oc.CopyPasteTargetName=Db);var fc=qa.bd;null!=fc&&(Oc.CCPSliceName=fc);var vc=
qa.be;null!=vc&&(Oc.SyncClipboardItemsKeys=vc);var Rc=qa.bf;null!=Rc&&(Oc.AsyncClipboardItemsKeys=Rc);var cd=qa.bg;null!=cd&&(Oc.CopyPasteHandlerName=cd);var dd=qa.bh;null!=dd&&(Oc.SucceededPopulatingSystemClipboardSync=dd);var Hd=qa.bi;null!=Hd&&(Oc.SucceededPopulatingSystemClipboardAsync=Hd);var Zd=qa.bj;null!=Zd&&(Oc.Location=Zd);var Fe=qa.bk;null!=Fe&&(Oc.CopyContextId=Fe);var Ne=null==qa.bl?null:qa.bl.toString();null!=Ne&&(Oc.ServerRequestTimeInMs=Ne);var sf=null==qa.bm?null:qa.bm.toString();
null!=sf&&(Oc.EcsOperationDuration=sf);var vg=null==qa.bn?null:qa.bn.toString();null!=vg&&(Oc.EcsRequestDuration=vg);var hg=null==qa.bo?null:qa.bo.toString();null!=hg&&(Oc.WfeRequestDuration=hg);var Wf=null==qa.bp?null:qa.bp.toString();null!=Wf&&(Oc.OriginalSourceRangesCountExceedsLimit=Wf);var bg=null==qa.bq?null:qa.bq.toString();null!=bg&&(Oc.UploadToClipServiceAttempted=bg);var wg=null==qa.br?null:qa.br.toString();null!=wg&&(Oc.FloatingObjectType=wg);break;case 44:Ef="Paste";var Xg=qa.a;null!=
Xg&&(Oc.UserSessionId=Xg);var Kg=qa.b;null!=Kg&&(Oc.Trigger=Kg);var Yg=qa.c;null!=Yg&&(Oc.RibbonCommandName=Yg);var Vh=null==qa.d?null:qa.d.toString();null!=Vh&&(Oc.PasteTypeFlagValue=Vh);var vi=qa.e;null!=vi&&(Oc.PasteOperationId=vi);var dk=qa.f;null!=dk&&(Oc.CopyOperationId=dk);var ek=qa.g;null!=ek&&(Oc.ClientSideStopwatchId=ek);var fk=qa.h;null!=fk&&(Oc.OriginalDestinationRange=fk);var gk=qa.i;null!=gk&&(Oc.ExpandDestinationRange=gk);var hk=qa.j;null!=hk&&(Oc.SourceItem=hk);var ik=null==qa.k?null:
qa.k.toString();null!=ik&&(Oc.SourceRangeCellCount=ik);var jk=null==qa.l?null:qa.l.toString();null!=jk&&(Oc.IsSuccess=jk);var kk=null==qa.m?null:qa.m.toString();null!=kk&&(Oc.IsExpectedError=kk);var lk=qa.n;null!=lk&&(Oc.ClipboardFormatReadTimeInMs=lk);var mk=qa.o;null!=mk&&(Oc.ClipboardFormatReadStatus=mk);var nk=null==qa.p?null:qa.p.toString();null!=nk&&(Oc.ClipboardReadPermissionPromptShown=nk);var ok=null==qa.q?null:qa.q.toString();null!=ok&&(Oc.AsyncApiReadTimedOut=ok);var pk=qa.r;null!=pk&&
(Oc.ExpectedErrorReason=pk);var qk=qa.s;null!=qk&&(Oc.ErrorMessage=qk);var rk=null==qa.t?null:qa.t.toString();null!=rk&&(Oc.TotalTimeInMs=rk);var sk=null==qa.u?null:qa.u.toString();null!=sk&&(Oc.PlainTextPayloadSize=sk);var tk=null==qa.v?null:qa.v.toString();null!=tk&&(Oc.ShadowWorkbookPayloadSize=tk);var uk=null==qa.w?null:qa.w.toString();null!=uk&&(Oc.HtmlPayloadSize=uk);var vk=qa.x;null!=vk&&(Oc.CopyPasteTargetType=vk);var wk=null==qa.y?null:qa.y.toString();null!=wk&&(Oc.IsLastCopyWasExternal=
wk);var xk=null==qa.z?null:qa.z.toString();null!=xk&&(Oc.IsClipboardDataContainShadowWorkbook=xk);var yk=null==qa.ba?null:qa.ba.toString();null!=yk&&(Oc.IsShadowWorkbookParsedSuccessfully=yk);var zk=qa.bb;null!=zk&&(Oc.ActiveSelectionType=zk);var Ak=qa.bc;null!=Ak&&(Oc.PasteResult=Ak);var Bk=null==qa.bd?null:qa.bd.toString();null!=Bk&&(Oc.ErrorReason=Bk);var Ck=qa.be;null!=Ck&&(Oc.ErrorName=Ck);var Dk=null==qa.bf?null:qa.bf.toString();null!=Dk&&(Oc.IsSucceededWithAlert=Dk);var Ek=null==qa.bg?null:
qa.bg.toString();null!=Ek&&(Oc.IsAfterCut=Ek);var Fk=null==qa.bh?null:qa.bh.toString();null!=Fk&&(Oc.EncounteredDeploymentErrors=Fk);var Gk=null==qa.bi?null:qa.bi.toString();null!=Gk&&(Oc.IsCrossSession=Gk);var Hk=null==qa.bj?null:qa.bj.toString();null!=Hk&&(Oc.ShadowWorkbookSizeExceedsLimit=Hk);var Ik=null==qa.bk?null:qa.bk.toString();null!=Ik&&(Oc.ClipboardContainXLOPayload=Ik);var Jk=qa.bl;null!=Jk&&(Oc.CopyPasteTargetName=Jk);var Kk=qa.bm;null!=Kk&&(Oc.ChromeExtensionId=Kk);var Lk=qa.bn;null!=
Lk&&(Oc.PayloadOrigin=Lk);var Mk=qa.bo;null!=Mk&&(Oc.PayloadType=Mk);var Nk=qa.bp;null!=Nk&&(Oc.CCPSliceName=Nk);var Ok=qa.bq;null!=Ok&&(Oc.ClipboardItemsKeys=Ok);var Pk=qa.br;null!=Pk&&(Oc.CopyPasteHandlerName=Pk);var Qk=null==qa.bs?null:qa.bs.toString();null!=Qk&&(Oc.IsSourceItemOriginSameSession=Qk);var Rk=qa.bt;null!=Rk&&(Oc.Location=Rk);var Sk=qa.bu;null!=Sk&&(Oc.ExternalAppSource=Sk);var Tk=qa.bv;null!=Tk&&(Oc.PasteContextId=Tk);var Uk=null==qa.bw?null:qa.bw.toString();null!=Uk&&(Oc.ServerRequestTimeInMs=
Uk);var Vk=null==qa.bx?null:qa.bx.toString();null!=Vk&&(Oc.IndicationDisplayScheduled=Vk);var Wk=qa.by;null!=Wk&&(Oc.PasteIndicationDisplayStatus=Wk);var Xk=null==qa.bz?null:qa.bz.toString();null!=Xk&&(Oc.PasteRecoveryUIDisplayed=Xk);var Yk=null==qa.ca?null:qa.ca.toString();null!=Yk&&(Oc.IsFromPasteRecoveryUI=Yk);var Zk=null==qa.cb?null:qa.cb.toString();null!=Zk&&(Oc.EcsOperationDuration=Zk);var $k=null==qa.cc?null:qa.cc.toString();null!=$k&&(Oc.EcsRequestDuration=$k);var al=null==qa.cd?null:qa.cd.toString();
null!=al&&(Oc.WfeRequestDuration=al);var bl=null==qa.ce?null:qa.ce.toString();null!=bl&&(Oc.OriginalSourceRangesCountExceedsLimit=bl);var cl=qa.cf;null!=cl&&(Oc.PasteRecoveryUndoStopwatchId=cl);var dl=null==qa.cg?null:qa.cg.toString();null!=dl&&(Oc.PasteRecoveryUndoTimeInMs=dl);var el=null==qa.ch?null:qa.ch.toString();null!=el&&(Oc.PasteCSEPerformed=el);var fl=null==qa.ci?null:qa.ci.toString();null!=fl&&(Oc.CSEStatus=fl);var gl=null==qa.cj?null:qa.cj.toString();null!=gl&&(Oc.IsFromEnterShortcut=gl);
var hl=null==qa.ck?null:qa.ck.toString();null!=hl&&(Oc.pasteDestinationHasMergedCells=hl);break;case 45:Ef="DragDrop";var il=qa.a;null!=il&&(Oc.UserSessionId=il);var jl=qa.b;null!=jl&&(Oc.Trigger=jl);var kl=qa.c;null!=kl&&(Oc.RibbonCommandName=kl);var ll=qa.d;null!=ll&&(Oc.OperationId=ll);var ml=qa.e;null!=ml&&(Oc.ClientSideStopwatchId=ml);var nl=qa.f;null!=nl&&(Oc.SourceRange=nl);var ol=qa.g;null!=ol&&(Oc.DestinationRange=ol);var pl=qa.h;null!=pl&&(Oc.CutCopyType=pl);var ql=null==qa.i?null:qa.i.toString();
null!=ql&&(Oc.IsShiftKeyDown=ql);var rl=null==qa.j?null:qa.j.toString();null!=rl&&(Oc.IsDragInsert=rl);var sl=null==qa.k?null:qa.k.toString();null!=sl&&(Oc.IsSuccess=sl);var tl=null==qa.l?null:qa.l.toString();null!=tl&&(Oc.IsExpectedError=tl);var ul=qa.m;null!=ul&&(Oc.ExpectedErrorReason=ul);var vl=qa.n;null!=vl&&(Oc.ErrorMessage=vl);var wl=null==qa.o?null:qa.o.toString();null!=wl&&(Oc.TotalTimeInMs=wl);var xl=qa.p;null!=xl&&(Oc.ErrorName=xl);var yl=null==qa.q?null:qa.q.toString();null!=yl&&(Oc.IsSucceededWithAlert=
yl);var zl=qa.r;null!=zl&&(Oc.CopyPasteTargetType=zl);var Al=null==qa.s?null:qa.s.toString();null!=Al&&(Oc.EncounteredDeploymentErrors=Al);break;case 46:Ef="ClearCopyState";var Bl=qa.a;null!=Bl&&(Oc.UserSessionId=Bl);var Cl=qa.b;null!=Cl&&(Oc.ClientSideStopwatchId=Cl);var Dl=qa.c;null!=Dl&&(Oc.Trigger=Dl);var El=null==qa.d?null:qa.d.toString();null!=El&&(Oc.IsClearClipboard=El);var Fl=null==qa.e?null:qa.e.toString();null!=Fl&&(Oc.IsExplicit=Fl);var Gl=null==qa.f?null:qa.f.toString();null!=Gl&&(Oc.IsSuccess=
Gl);var Hl=qa.g;null!=Hl&&(Oc.ErrorMessage=Hl);var Il=qa.h;null!=Il&&(Oc.ErrorName=Il);var Jl=null==qa.i?null:qa.i.toString();null!=Jl&&(Oc.TotalTimeInMs=Jl);var Kl=qa.j;null!=Kl&&(Oc.CopyPasteTargetType=Kl);break;case 47:Ef="WebWorkerRecalcStats";var Ll=null==qa.a?null:qa.a.toString();null!=Ll&&(Oc.SuccessCount=Ll);var Ml=null==qa.b?null:qa.b.toString();null!=Ml&&(Oc.FailureCount=Ml);var Nl=null==qa.c?null:qa.c.toString();null!=Nl&&(Oc.ValueTypeMismatchCount=Nl);var Ol=null==qa.d?null:qa.d.toString();
null!=Ol&&(Oc.CellValueMismatchCount=Ol);var Pl=null==qa.e?null:qa.e.toString();null!=Pl&&(Oc.IfmtMismatchCount=Pl);var Ql=null==qa.f?null:qa.f.toString();null!=Ql&&(Oc.FormattedTextMismatchCount=Ql);var Rl=null==qa.g?null:qa.g.toString();null!=Rl&&(Oc.CellValueStringMismatchCount=Rl);var Sl=null==qa.h?null:qa.h.toString();null!=Sl&&(Oc.CellValueNumberMismatchCount=Sl);var Tl=null==qa.i?null:qa.i.toString();null!=Tl&&(Oc.CellValueBooleanMismatchCount=Tl);var Ul=null==qa.j?null:qa.j.toString();null!=
Ul&&(Oc.CellValueBlankMismatchCount=Ul);var Vl=null==qa.k?null:qa.k.toString();null!=Vl&&(Oc.CellValueErrorMismatchCount=Vl);var Wl=null==qa.l?null:qa.l.toString();null!=Wl&&(Oc.FormattedTextStringMismatchCount=Wl);var Xl=null==qa.m?null:qa.m.toString();null!=Xl&&(Oc.FormattedTextNumberMismatchCount=Xl);var Yl=null==qa.n?null:qa.n.toString();null!=Yl&&(Oc.FormattedTextBooleanMismatchCount=Yl);var Zl=null==qa.o?null:qa.o.toString();null!=Zl&&(Oc.FormattedTextBlankMismatchCount=Zl);var $l=null==qa.p?
null:qa.p.toString();null!=$l&&(Oc.FormattedTextErrorMismatchCount=$l);var am=null==qa.q?null:qa.q.toString();null!=am&&(Oc.StringMismatchCount=am);var bm=null==qa.r?null:qa.r.toString();null!=bm&&(Oc.NumericMismatchCount=bm);var cm=null==qa.s?null:qa.s.toString();null!=cm&&(Oc.ErrorMismatchCount=cm);var dm=null==qa.t?null:qa.t.toString();null!=dm&&(Oc.StringValuesCount=dm);var em=null==qa.u?null:qa.u.toString();null!=em&&(Oc.NumericValuesCount=em);var fm=null==qa.v?null:qa.v.toString();null!=fm&&
(Oc.BooleanValuesCount=fm);var gm=null==qa.w?null:qa.w.toString();null!=gm&&(Oc.BlankValuesCount=gm);var hm=null==qa.x?null:qa.x.toString();null!=hm&&(Oc.ErrorValuesCount=hm);var im=null==qa.y?null:qa.y.toString();null!=im&&(Oc.NumericValuesDiffAverage=im);var jm=qa.z;null!=jm&&(Oc.NumericEvaluatedValuesMismatchSamples=jm);var km=qa.ba;null!=km&&(Oc.NumericFormattedTextMismatchSamples=km);var lm=qa.bb;null!=lm&&(Oc.NumericMismatchSamples=lm);var mm=qa.bc;null!=mm&&(Oc.CellValueTypeMismatchSamples=
mm);var nm=qa.bd;null!=nm&&(Oc.IfmtMismatchSamples=nm);var om=qa.be;null!=om&&(Oc.BlockHashCode=om);break;case 48:Ef="DataValidationEditOpenDialog";var pm=qa.a;null!=pm&&(Oc.ServerCommand=pm);var qm=null==qa.b?null:qa.b.toString();null!=qm&&(Oc.SubDialogOpened=qm);var rm=qa.c;null!=rm&&(Oc.SubDialogButtonClicked=rm);var sm=null==qa.d?null:qa.d.toString();null!=sm&&(Oc.DialogOpened=sm);var tm=qa.e;null!=tm&&(Oc.RuleType=tm);var um=qa.f;null!=um&&(Oc.ConditionType=um);var vm=null==qa.g?null:qa.g.toString();
null!=vm&&(Oc.LowerBoundaryFilled=vm);var wm=null==qa.h?null:qa.h.toString();null!=wm&&(Oc.UpperBoundaryFilled=wm);var xm=null==qa.i?null:qa.i.toString();null!=xm&&(Oc.IgnoreBlank=xm);var ym=null==qa.j?null:qa.j.toString();null!=ym&&(Oc.InCellDropdown=ym);var zm=null==qa.k?null:qa.k.toString();null!=zm&&(Oc.ShowInputMessage=zm);var Am=null==qa.l?null:qa.l.toString();null!=Am&&(Oc.InputTitleFilled=Am);var Bm=null==qa.m?null:qa.m.toString();null!=Bm&&(Oc.InputMessageFilled=Bm);var Cm=null==qa.n?null:
qa.n.toString();null!=Cm&&(Oc.ShowErrorAlert=Cm);var Dm=null==qa.o?null:qa.o.toString();null!=Dm&&(Oc.AlertBlocking=Dm);var Em=null==qa.p?null:qa.p.toString();null!=Em&&(Oc.AlertTitleFilled=Em);var Fm=null==qa.q?null:qa.q.toString();null!=Fm&&(Oc.AlertMessageFilled=Fm);var Gm=qa.r;null!=Gm&&(Oc.StopWatchId=Gm);break;case 49:Ef="DataValidationEditSubmitRule";var Hm=qa.a;null!=Hm&&(Oc.RuleType=Hm);var Im=qa.b;null!=Im&&(Oc.ConditionType=Im);var Jm=null==qa.c?null:qa.c.toString();null!=Jm&&(Oc.LowerBoundaryFilled=
Jm);var Km=null==qa.d?null:qa.d.toString();null!=Km&&(Oc.UpperBoundaryFilled=Km);var Lm=null==qa.e?null:qa.e.toString();null!=Lm&&(Oc.IgnoreBlank=Lm);var Mm=null==qa.f?null:qa.f.toString();null!=Mm&&(Oc.InCellDropdown=Mm);var Nm=null==qa.g?null:qa.g.toString();null!=Nm&&(Oc.ShowInputMessage=Nm);var Om=null==qa.h?null:qa.h.toString();null!=Om&&(Oc.InputTitleFilled=Om);var Pm=null==qa.i?null:qa.i.toString();null!=Pm&&(Oc.InputMessageFilled=Pm);var Qm=null==qa.j?null:qa.j.toString();null!=Qm&&(Oc.ShowErrorAlert=
Qm);var Rm=null==qa.k?null:qa.k.toString();null!=Rm&&(Oc.AlertBlocking=Rm);var Sm=null==qa.l?null:qa.l.toString();null!=Sm&&(Oc.AlertTitleFilled=Sm);var Tm=null==qa.m?null:qa.m.toString();null!=Tm&&(Oc.AlertMessageFilled=Tm);var Um=null==qa.n?null:qa.n.toString();null!=Um&&(Oc.ClearAllPressed=Um);var Vm=qa.o;null!=Vm&&(Oc.ActionStatus=Vm);var Wm=qa.p;null!=Wm&&(Oc.Error=Wm);var Xm=qa.q;null!=Xm&&(Oc.StopWatchId=Xm);var Ym=null==qa.r?null:qa.r.toString();null!=Ym&&(Oc.InsertDropdownButton=Ym);break;
case 50:Ef="CustomSort";var Zm=qa.a;null!=Zm&&(Oc.RangeType=Zm);var $m=null==qa.b?null:qa.b.toString();null!=$m&&(Oc.HasHeaders=$m);var an=null==qa.c?null:qa.c.toString();null!=an&&(Oc.SortTopToBottom=an);var bn=null==qa.d?null:qa.d.toString();null!=bn&&(Oc.ColumnCount=bn);var cn=null==qa.e?null:qa.e.toString();null!=cn&&(Oc.RowCount=cn);var dn=null==qa.f?null:qa.f.toString();null!=dn&&(Oc.RangeLimitExceeded=dn);var en=null==qa.g?null:qa.g.toString();null!=en&&(Oc.CaseSensitive=en);var fn=null==qa.h?
null:qa.h.toString();null!=fn&&(Oc.GetSortInfoDuration=fn);var gn=null==qa.i?null:qa.i.toString();null!=gn&&(Oc.LevelCount=gn);var hn=null==qa.j?null:qa.j.toString();null!=hn&&(Oc.SortOnValuesCount=hn);var jn=null==qa.k?null:qa.k.toString();null!=jn&&(Oc.SortOnCellColorCount=jn);var kn=null==qa.l?null:qa.l.toString();null!=kn&&(Oc.SortOnFontColorCount=kn);var ln=null==qa.m?null:qa.m.toString();null!=ln&&(Oc.SortOnIconCount=ln);var mn=null==qa.n?null:qa.n.toString();null!=mn&&(Oc.CustomOrderCount=
mn);var nn=null==qa.o?null:qa.o.toString();null!=nn&&(Oc.AvgCellColorCount=nn);var on=null==qa.p?null:qa.p.toString();null!=on&&(Oc.MaxCellColorCount=on);var pn=null==qa.q?null:qa.q.toString();null!=pn&&(Oc.AvgFontColorCount=pn);var qn=null==qa.r?null:qa.r.toString();null!=qn&&(Oc.MaxFontColorCount=qn);var rn=null==qa.s?null:qa.s.toString();null!=rn&&(Oc.AvgIconsCount=rn);var sn=null==qa.t?null:qa.t.toString();null!=sn&&(Oc.MaxIconsCount=sn);var tn=null==qa.u?null:qa.u.toString();null!=tn&&(Oc.Executed=
tn);break;case 51:Ef="NamedSheetViewUserAction";var un=qa.a;null!=un&&(Oc.UserSessionId=un);var vn=qa.b;null!=vn&&(Oc.UserActionName=vn);var wn=null==qa.c?null:qa.c.toString();null!=wn&&(Oc.UserActionSource=wn);var xn=qa.d;null!=xn&&(Oc.UserActionData=xn);var yn=qa.e;null!=yn&&(Oc.OtherData=yn);break;case 52:Ef="NamedSheetViewTeachingCallout";var zn=qa.a;null!=zn&&(Oc.UserSessionId=zn);var An=null==qa.b?null:qa.b.toString();null!=An&&(Oc.TeachingCalloutSequence=An);var Bn=null==qa.c?null:qa.c.toString();
null!=Bn&&(Oc.TeachingCalloutIndex=Bn);var Cn=null==qa.d?null:qa.d.toString();null!=Cn&&(Oc.UserActionName=Cn);var Dn=qa.e;null!=Dn&&(Oc.UserActionData=Dn);var En=null==qa.f?null:qa.f.toString();null!=En&&(Oc.DurationInMs=En);break;case 53:Ef="NamedSheetViewTeachingDialog";var Fn=qa.a;null!=Fn&&(Oc.UserSessionId=Fn);var Gn=qa.b;null!=Gn&&(Oc.UserActionName=Gn);var Hn=qa.c;null!=Hn&&(Oc.ButtonClicked=Hn);var In=null==qa.d?null:qa.d.toString();null!=In&&(Oc.DurationInMs=In);var Jn=null==qa.e?null:qa.e.toString();
null!=Jn&&(Oc.IsNewTeachingDialog=Jn);break;case 54:Ef="NamedSheetViewOptionsDialog";var Kn=qa.a;null!=Kn&&(Oc.UserSessionId=Kn);var Ln=null==qa.b?null:qa.b.toString();null!=Ln&&(Oc.OptionsAction=Ln);var Mn=qa.c;null!=Mn&&(Oc.OptionsActionData=Mn);var Nn=qa.d;null!=Nn&&(Oc.OptionsOtherData=Nn);var On=null==qa.e?null:qa.e.toString();null!=On&&(Oc.DurationInMs=On);break;case 55:Ef="NamedSheetViewTempViewSaveDialog";var Pn=qa.a;null!=Pn&&(Oc.UserSessionId=Pn);var Qn=qa.b;null!=Qn&&(Oc.TriggeredFrom=
Qn);var Rn=qa.c;null!=Rn&&(Oc.ButtonClicked=Rn);var Sn=null==qa.d?null:qa.d.toString();null!=Sn&&(Oc.NameUpdated=Sn);var Tn=null==qa.e?null:qa.e.toString();null!=Tn&&(Oc.DurationInMs=Tn);break;case 56:Ef="TemporaryViewStartedDataRestore";var Un=qa.a;null!=Un&&(Oc.UserSessionId=Un);var Vn=null==qa.b?null:qa.b.toString();null!=Vn&&(Oc.CountOfTempViews=Vn);break;case 57:Ef="TemporaryViewFetchedVersion";var Wn=qa.a;null!=Wn&&(Oc.UserSessionId=Wn);var Xn=null==qa.b?null:qa.b.toString();null!=Xn&&(Oc.NumberOfBytes=
Xn);break;case 58:Ef="RaiseEventsAndGenerateBlockRequests";var Yn=null==qa.a?null:qa.a.toString();null!=Yn&&(Oc.ReturnContentStatus=Yn);var Zn=null==qa.b?null:qa.b.toString();null!=Zn&&(Oc.CacheState=Zn);var $n=null==qa.c?null:qa.c.toString();null!=$n&&(Oc.FromXhrCallback=$n);var ao=null==qa.d?null:qa.d.toString();null!=ao&&(Oc.AreGeneralErrorsPresent=ao);var bo=qa.e;null!=bo&&(Oc.BlockCacheItemHash=bo);var co=qa.f;null!=co&&(Oc.StopwatchId=co);var eo=qa.g;null!=eo&&(Oc.BlockCacheItemProcessingStopwatchId=
eo);var fo=null==qa.h?null:qa.h.toString();null!=fo&&(Oc.StateId=fo);var go=null==qa.i?null:qa.i.toString();null!=go&&(Oc.IsHighPriority=go);var ho=null==qa.j?null:qa.j.toString();null!=ho&&(Oc.CalcComplete=ho);var io=null==qa.k?null:qa.k.toString();null!=io&&(Oc.EditedCellsUpdatedByCse=io);var jo=null==qa.l?null:qa.l.toString();null!=jo&&(Oc.DependentCellsUpdatedByCse=jo);var ko=null==qa.m?null:qa.m.toString();null!=ko&&(Oc.Revision=ko);var lo=null==qa.n?null:qa.n.toString();null!=lo&&(Oc.SheetProcessedDataVersion=
lo);var mo=null==qa.o?null:qa.o.toString();null!=mo&&(Oc.RefCount=mo);var no=null==qa.p?null:qa.p.toString();null!=no&&(Oc.ExistsInView=no);var oo=null==qa.q?null:qa.q.toString();null!=oo&&(Oc.ContentSource=oo);break;case 59:Ef="LaunchMakerCodeEditor";var po=qa.a;null!=po&&(Oc.SessionId=po);var qo=qa.b;null!=qo&&(Oc.Command=qo);var ro=null==qa.c?null:qa.c.toString();null!=ro&&(Oc.IsPreviewGallery=ro);var so=qa.d;null!=so&&(Oc.MenuItemId=so);var to=qa.e;null!=to&&(Oc.ScriptId=to);var uo=qa.f;null!=
uo&&(Oc.ShareId=uo);var vo=null==qa.g?null:qa.g.toString();null!=vo&&(Oc.IsOwner=vo);var wo=null==qa.h?null:qa.h.toString();null!=wo&&(Oc.PublishedScriptCount=wo);var xo=null==qa.i?null:qa.i.toString();null!=xo&&(Oc.RecentScriptCount=xo);var yo=null==qa.j?null:qa.j.toString();null!=yo&&(Oc.WorkbookScriptCount=yo)}Oc.Table=Ef;var Do=Sys.Serialization.JavaScriptSerializer.serialize(Oc);zd.call(Pc,3704927,0,50,Do)}}catch(Oc){l.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${da} exception: ${Oc}`)}}rfd(da,
qa,Xb){if(this.Wwc){const Pc=this.y_a[da+qa];Pc&&(Pc.e=Xb,this.Fid(Pc));delete this.y_a[da+qa]}}QCd(da,qa){Md[da]in this.aBf||this.Df(da,qa)}Uhj(){this.ii.appStart&&this.Kkg(cf.MLd,this.ii.appStart)}HRi(da){const qa={};qa.a=da.i;qa.b=da.o;qa.c=da.t;qa.d=Pe.a(da.s,da.p||this.ii.appStart);qa.e=Pe.a(da.e,da.s);qa.f=da.c;qa.g=da.a;qa.h=da.h;this.Df(0,qa,this.REi(qa.b,qa.c))}REi(da,qa){return["CommandTask","QueuedTask","Task"].includes(da)&&!this.ePh.includes(qa)?!1:!0}OB(da,qa,Xb,Pc,zd=!0){if(da&&qa){const ce=
{};ce.a=da;ce.b=qa;ce.c=Xb.toString();ce.d=Pc.toString();this.Df(15,ce,zd)}}KAf(da,qa,Xb,Pc){const zd={};da&&(zd.c=Pe.a(da,this.ii.appStart));zd.b=qa;zd.a=Xb;zd.d=Pc;this.Df(17,zd)}dispose(){this.kUa.execute(da=>{da.deactivate(!0);da.Mxj(this.cQf)});this.jf&&this.jf.Gfb(this.xX);super.dispose()}Xff(){return this.Pwg=this.Pwg||new Sb}tQe(da,qa,Xb=null,Pc=null,zd=null){const ce={};ce.o=da;ce.t=qa;ce.p=zd;ce.s=Pc||this.ii.Ye;this.oud(ce,Xb);return ce}mMe(da,qa=null){da&&(da.e=qa||this.ii.Ye,da.i=da.i||
this.n4a.Jbb(),da.c=da.c||this.YQe,da.a=da.a||this.hRe,da.h=void 0!==da.h&&null!==da.h?da.h:this.jf?this.jf.ui:!1,this.Fid(da))}SAf(da){const qa=da.context;da.duration>cf.JAh&&(qa.methodName===ic.a.FBb||qa.methodName===ic.a.jya)&&this.IAc(1,cf.Zbi);if("GetSessionStatus"!==qa.methodName){const Xb={};Xb.a=qa.methodName;Xb.b=qa.stopwatch.id;Xb.c=da.WAc;Xb.d=da.responseSize;Xb.e=qa.yKa;Xb.f=da.Zd?da.Zd.StateId:ic.a.U5d;this.Df(30,Xb,!0);this.OB(Xb.b,da.Zd.ServerCorrelationId,"clientWebRequests","ServerActions")}}Clg(){if(this.Wwc){const da=
this.y_a.LoadingUIShownSplashScreen;da&&Wb.PageLoadTrackingInfo.instance.wOj(da.s)}}IAc(da,qa){this.uvg.ZOb(da,qa,null)}q6f(da,qa=null){this.pKc.tBj(da,qa)}p6f(da,qa,Xb=null){this.pKc.sBj(da,qa,Xb)}r6f(da){this.pKc.dPb(da,null)}s6f(da,qa){this.pKc.ZOb(da,qa,null)}FAc(da,qa,Xb=null){this.mkb.FAc(da,qa,Xb)}NAc(da,qa,Xb=null){this.mkb.NAc(da,qa,Xb)}sendDNMTraceTag(da,qa,Xb,Pc,...zd){yb.EwaSettings.ya(201)&&l.ULS.sendTraceTag.apply(null,[da,qa,Xb,Pc].concat(zd))}HQb(da,qa,Xb,Pc,zd,ce,we,...De){this.mkb.HQb(da,
qa,Xb,Pc,zd,ce,we,...De)}JQb(da,qa,Xb,Pc,zd,ce){this.mkb.JQb(da,qa,Xb,Pc,zd,ce)}IQb(da,qa,Xb,Pc,zd,ce,...we){this.mkb.IQb(da,qa,Xb,Pc,zd,ce,...we)}KQb(da,qa,Xb,Pc,zd,ce){this.uvg.KQb(da,qa,Xb,Pc,zd,ce)}NCc(da,qa,Xb,Pc){this.mkb.NCc(da,qa,Xb,Pc)}Fid(da){this.B2j.HRi(da)}Vhj(){if(this.Wwc){Stw.swpc=null;const da=this.Wwc;for(let qa in da)this.oud(da[qa])}}tSh(){const da=window[fe.a.namespace];if(da){const qa=da[fe.a.rLe];qa&&(delete da[fe.a.rLe],qa.forEach(Xb=>{this.oud(Xb);this.Fid(Xb)}))}}kGi(da,
qa){if("about:blank"===da||"renamehandler.ashx"===qa&&"2"===A.a.mz(da,"u"))return!0;for(da=0;da<this.RTd.length;da++)if(qa.endsWith(this.RTd[da]))return!0;return!1}YOi(){this.kUa.execute(da=>{da.Di(cf.h4g,0);da.BWg(this.cQf);da.activate()})}ROi(){const da={};da.a=new Date(oc.EcmaDateClock.instance.appStart.m);da.b=this.userSessionId;da.c=this.ii.yog;da.d=cf.wuh*w.devicePixelRatio;da.e=xa.a.Bb.appStart.m;this.Df(14,da,!0);this.boa(xa.a.Bb.appStart.m,Object(Z.a)(O.a.instance,O.a.instance.Jrj,"recordAppInitStart"))}Kkg(da,
qa){this.ikb=this.n4a.Jbb();this.gVb=this.n4a.Jbb();this.gGa=da;this.aGc("UserAction",da,this.gVb,qa);this.Nzf(da,this.ikb)}U4j(){const da=window[fe.a.namespace];da&&!cf.FOe&&(da[fe.a.z1j]=(qa,Xb)=>this.tQe(qa,Xb),da[fe.a.YCh]=qa=>{this.mMe(qa)},cf.FOe=!0)}Wck(da){const qa=Nf.O7g(da.o,da.t),Xb=new Nf(Pe.a(da.e,da.s)),Pc=qa in this.o2d?this.o2d[qa].qgh(Xb):Xb;this.o2d[qa]=Pc;if(Xb===Pc||Xb.average!==Pc.average)da=Object(vb.a)(new zf,{operation:da.o,target:da.t,eYi:Pc.average,sender:this}),this.raiseEvent(qa,
da)}Nzf(da,qa){const Xb={};Xb.a=qa;Xb.b=this.userSessionId;Xb.c=da;this.Df(1,Xb,!0)}Fti(){this.RTd=[ic.a.tvj,ic.a.getSessionStatus,ic.a.jya,ic.a.dgh,ic.a.Uch,ic.a.Zjb,ic.a.fic,ic.a.getObjectMetadata,ic.a.Q$h,ic.a.setRichTextCell,ic.a.oya,ic.a.jhk,ic.a.pollSessionStatus,ic.a.ffi,ic.a.fdi,ic.a.Y7h]}oud(da,qa=null){da.i=qa||this.n4a.Jbb();da.a=this.hRe;da.c=this.YQe;da.h=this.jf?this.jf.ui:!1}static la(da){var qa=new $e;da.da.Ja(291,qa);qa=new cf(da.xa.UserSessionId,void 0,void 0,void 0,qa,!0);qa.Nzf(cf.cGf,
qa.URe);l.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");qa.YOi();qa.U4j();qa.Uhj();qa.ROi();qa.tSh();qa.Vhj();qa.Fti();cf.bMj(da);ud.a.rm.Ja(41,qa)}static bMj(da){const qa=w.devicePixelRatio;1<qa&&da.Gc.qy(!0,2<=qa?8388608:4194304)}}cf.cGf="UnassignedUserAction";cf.MLd="PageLoad";cf.Eqd="GridUpdateOperation";cf.JAh=5E3;cf.Zbi="MoreThan_5000_Ms";cf.wuh=96;cf.h4g=30;cf.FOe=!1;Object(h.a)(cf,"TelemetryManager",df.a,[652,653,654,655]);var Sa=a(208),
Pb=a(109);class jc{constructor(da,qa,Xb){this.vjk=da;this.dW=qa;this.name=Xb}}Object(h.a)(jc,"Validation",null,[]);class wc{constructor(da){this.Dcb=()=>{this.qVf(this.Q4e)};this.Bj=()=>{this.qVf(this.p5g)};this.$=da;this.p5g=new U.a;this.Q4e=new U.a;Ta.h(this.$).Ca.rw(this.Bj);Ta.h(this.$).Ca.sxe(this.Dcb)}B1c(da,qa,Xb,Pc,zd){if(da&&Pc){const ce=Sa.a.pA(qa,Xb);this.Y3b(()=>!!Pb.a(da).Es(ce),Pc.StateId,zd)}}Y3b(da,qa,Xb){this.sVg(this.Q4e,da,qa,Xb)}sVg(da,qa,Xb,Pc){da&&qa&&Xb!==ic.a.Oe&&da.add(new jc(qa,
Xb,Pc))}qVf(da){if(da){var qa=new U.a;for(let Xb of da){if(Xb.dW===this.$.ea.We)try{Xb.vjk()||l.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${Xb.name}]`)}catch(Pc){l.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${Xb.name}]. Exception: [${Pc}]`)}qa.add(Xb)}for(let Xb of qa)da.remove(Xb)}else l.ULS.shipAssertTag(537151011,
0,!!da,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Ta.h(this.$)&&Ta.h(this.$).Ca&&(Ta.h(this.$).Ca.Vw(this.Bj),Ta.h(this.$).Ca.XRd(this.Dcb));this.$=null}static la(da){const qa=new wc(da);da.da.Ja(277,qa)}}Object(h.a)(wc,"ValidationTelemetryManager",null,[570,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");t.main();Type.registerNamespace("CNT");aa.main();Type.registerNamespace("CACPU");ha.main();Type.registerNamespace("Common.App.EventsCacheManager");
Fb.main();(()=>{Rb.a.Fa(da=>{da.da.Ja(137,new na(da))})})();(()=>{Rb.a.Fa(da=>{da.da.Ja(37,new ec(da))})})();(()=>{Rb.a.Fa(da=>{yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||Ob.la(da)})})();(()=>{Rb.a.Fa(da=>{yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||kd.la(da)})})();(()=>{Rb.a.Fa(da=>{da.da.Ja(40,new qc(da,new Xa.a(()=>je.GetServiceTaskFactory.create(da.da,137,da.ka,1))))})})();
(()=>{Rb.a.Fa(da=>{da.da.Ja(276,new Nc(da))})})();(()=>{Rb.a.Fa(da=>{ud.a.rm.Gb(135,()=>{cf.la(da);Yc.la(da);wc.la(da);Ed.la(da);Hb.la(da);he.RenderingFidelityTracker.la(da)})})})();String(e);String(d);String(f);String(b);window.___1684305534536_closurehack=e;window.___1684305534536_closurehack=d;window.___1684305534536_closurehack=f;window.___1684305534536_closurehack=b},725:function(u,C,a){a.d(C,"a",function(){return c});const c=(b,f,e)=>b.Ba(f)||b.Ja(f,e())},755:function(u,C,a){u=a(0);var c=a(88),
b=a(6),f=a(82),e=a(31),d=a(34),h=a(185);class l{constructor(r,t){this.message=r;this.$wa=t}}Object(u.a)(l,"CrossDocumentEventArgs",null,[]);var k=a(769),n=a(384),v=a(266),x=a(768);a.d(C,"a",function(){return w});class w{constructor(r,t,A,y){this._name="";this.cu={};this.U3=null;this.ZH=[];this.OH=[];this.PH=[];this.XH=[];this.hua=r;this.fua=t;this.ap={};this.gu={};this.UH=A;w._id++;y&&y();this.Xo=this.enable()}get targetOrigin(){return this.fua}get dEa(){return this.hua}enable(){if(!v.a())return x.a.sendTraceTag(5018251,
2,"Not supported for current browser."),!1;this.WDb();x.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.Xo}WDb(){x.a.debugAssertTag(5018253,!!this.UH,null);this.U3=Object(c.a)(this,this.YIb,"messageListener");this.UH.DJa(this.U3,null)}disable(){this.Xo=!1;this.ZH=[];this.OH=[];this.PH=[];this.XH=[];this.hua=null;this.fua="";this.UH.ELa(this.U3);this.ap={};this.gu={}}dispose(){this.disable()}Gza(r){return!!this.ZH&&Array.contains(this.ZH,r)||this.Fza(r)}Fza(r){return!!this.OH&&
Array.contains(this.OH,r)}fn(r){x.a.debugAssertTag(5018259,!!this.ZH,null);Array.add(this.ZH,r);x.a.sendTraceTag(5018260,2,"Allow receiving : {0}",r)}X0a(r){x.a.debugAssertTag(5018261,!!this.OH,null);Array.add(this.OH,r);x.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",r)}DFb(r){return!!this.PH&&Array.contains(this.PH,r)}QZ(r){x.a.debugAssertTag(5018263,!!this.PH,null);Array.add(this.PH,r);x.a.sendTraceTag(5018264,2,"Allow free sending: {0}",r)}NFb(r){r=f.a.wL(r);return!!r&&!!this.XH&&Array.contains(this.XH,
r)}QQ(r){x.a.debugAssertTag(5018265,!!this.XH,null);if(r===w.HK)return x.a.debugAssertTag(5018266,!1,null),!1;let t=f.a.wL(r);if(!t)return x.a.sendTraceTag(5018267,4,"Get origin fail:{0}",r),!1;b.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(t=d.a.kl(t));Array.add(this.XH,t);x.a.sendTraceTag(5018268,2,"Add origin:{0}",t);return!0}send(r,t=null){let A=this.targetOrigin;if(t){t=f.a.wL(t);if(!t)return!1;A=t}return this.O9(r,this.dEa,
A)}sendMessage(r,t,A=""){A=A&&""!==A?A:h.a.create().toString();return this.send(this.V8(r,t,A,b.AFrameworkApplication.userSessionId))}postMessage(r){const t=h.a.create().toString();if(!b.AFrameworkApplication.fa.ra("RetryablePostMessagingIsEnabled")||!r.shouldRetry)return this.send(this.V8(r.messageId,r.values,t,r.userSessionId));if(!this.ap[r.MZ]){this.fn(r.MZ);const A=Object(c.a)(this,this.ackMessageHandler,"ackMessageHandler");this.hl(r.MZ,A)}this.cu[t]="";return this.cCa(r,t,1)}cCa(r,t,A){if(""!==
t&&t in this.cu&&"ACK_RECEIVED"===this.cu[t])return delete this.cu[t],!0;if(A>r.OG)return x.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',r.MZ,t),delete this.cu[t],!1;x.a.sendTraceTag(40716251,1<A?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',r.OG-A,r.messageId,t);A++;window.setTimeout(()=>{this.cCa(r,t,A)},r.w0c);r.values[n.a.u0c]=!0;return this.send(this.V8(r.messageId,r.values,t,r.userSessionId))}ackMessageHandler(r){r=
r.CorrelationId;""!==r&&r in this.cu&&(x.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.cu[r],r),this.cu[r]="ACK_RECEIVED")}V8(r,t,A,y){r=new k.a(r);r.CorrelationId=A;t&&(r.Values=t);r.Values.wdUserSession=y;return r}O9(r,t,A){x.a.debugAssertTag(5018269,!!r,null);if(!this.Xo)return!1;x.a.debugAssertTag(5018270,!!t,null);x.a.debugAssertTag(5018271,!!A,null);if(!t||!A)return x.a.debugAssertTag(5018272,!1,null),!1;if(A===w.HK&&!this.DFb(r.MessageId))return x.a.sendTraceTag(5018273,
1,"Got unregistered message {0}",{["id"]:r.MessageId}),!1;r.SendTime=(new Date).getTime();let y="";try{y=Sys.Serialization.JavaScriptSerializer.serialize(r)}catch(z){return x.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:z.message}),!1}t=w.sendMessage(t,y,A);x.a.sendTraceTag(5018275,2,"Send {0}. {1}",t?"succeeded":"failed",{["id"]:r.MessageId,["origin"]:A});return t}hl(r,t){x.a.debugAssertTag(5018304,!!t,null);x.a.debugAssertTag(5018305,!!this.ap&&!!this.gu,null);if(!this.Xo)return!1;
if(!this.Gza(r))return x.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:r}),!1;this.ap[r]!==t&&(x.a.debugAssertTag(5018307,!this.ap[r]&&!this.gu[r],null),this.ap[r]=t,delete this.gu[r]);return!0}X2(r){this.Xo&&(this.ap[r]&&delete this.ap[r],this.gu[r]&&delete this.gu[r])}YIb(r){const t=this.mBb(r);if(!t)return!1;if(this.ap[t.MessageId])return this.UH.gza(this.ap[t.MessageId],t),!0;if(this.gu[t.MessageId]){let A=this.gu[t.MessageId];r=new l(t,r);this.UH.dEb(A,r);return!0}return!1}mBb(r){const t=
new Date;this.fIb(r);if(!r.origin||!r.source||void 0===r.data||null===r.data)return x.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const A=this.WGb(r.data);if(!A)return null;if(!this.NFb(r.origin)){if(!this.Fza(A.MessageId))return x.a.sendTraceTag(5018309,1,"{0}",{["id"]:A.MessageId}),null;if(!e.a.VW&&r.source!==this.dEa)return x.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}x.a.debugAssertTag(5018311,!!A.Values,null);
A.Values.m_Source=r.source;A.Values.m_Origin=r.origin;A.Values.m_ReceivedTime=t.getTime();return A}WGb(r){if(!r)return null;let t=null;try{t=Sys.Serialization.JavaScriptSerializer.deserialize(r,!0)}catch(z){return 2>w.Fsa&&(x.a.sendTraceTag(5018312,2,"Deser failed"),w.Fsa++),null}if(!t)return x.a.debugAssertTag(5018313,!1,null),null;for(r=0;r<w.uR.length;r++)if(!t[w.uR[r]])return"MessageId"!==w.uR[r]&&x.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",w.uR[r]),null;if(t.Values)try{t.Values}catch(z){return x.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",z.message),null}else x.a.sendTraceTag(41502556,2,"No values in message");r=t.MessageId;if(!this.Gza(r))return x.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:r}),null;const A=t.SendTime,y=(new Date).getTime()-A;if(0>A)return x.a.sendTraceTag(520435660,2,"{0}",{["t"]:A,["id"]:r}),null;6E4<y&&x.a.sendTraceTag(520435659,2,"{0}",{["t"]:A,["delta"]:y,["id"]:r});-300>y&&x.a.sendTraceTag(520435658,2,"{0}",{["t"]:A,["delta"]:y,["id"]:r});r=new k.a;r.MessageId=t.MessageId;
r.SendTime=t.SendTime;r.CorrelationId=t.CorrelationId;t.Values&&(r.Values=t.Values);x.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",r.MessageId,r.SendTime,r.CorrelationId);return r}fIb(r){x.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:r.origin,["data"]:r.data,["source"]:r.source}))}static sendMessage(r,t,A){if(!v.a())return x.a.debugAssertTag(5018319,!1,null),!1;try{return r.postMessage(t,A),!0}catch(y){x.a.sendTraceTag(5018320,
4,"{0}",{["exception"]:y.message})}return!1}}w.uR=["MessageId","SendTime"];w.HK="*";w._id=0;w.Fsa=0;Object(u.a)(w,"CrossDocumentMessenger",null,[2,355])},759:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{static nmf(b){c.$=b;c.$.da.Gb(291,f=>{c.jf=f})}static cma(b,f){return b[Math.round((b.length-1)*f/100)]}static xE(b){return c.jf?c.jf.xE(b):!1}}c.jf=null;c.$=null;Object(u.a)(c,"SessionStatisticsManagerHelper",null,[])},768:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{static GQb(){}static hxb(){}}
c.sendTraceTag=c.GQb;c.debugAssertTag=c.hxb;Object(u.a)(c,"BULS",null,[])},769:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(u.a)(c,"CrossDocumentMessage",null,[])},799:function(u,C,a){a.d(C,"a",function(){return c});const c=b=>{if(Object.keys)b=Object.keys(b);else{const f=[];for(let e in b)Array.add(f,e);b=f}return b}},890:function(u,C,a){u=a(0);var c=a(15),b=a(755),f=a(88),e=a(562),d=a(6),
h=a(14),l=a(112);class k{constructor(w,r,t,A=null){this.origin=w;this.data=r;this.source=t;this.Da=A}}Object(u.a)(k,"MessageEventArgs",null,[]);class n{constructor(w,r){this.p4=null;this.Uqb=w;this.Ce=r;this.DQ=null}get EY(){return this.Uqb.value}get taskManager(){return this.Ce.value}DJa(w,r){this.DQ=w;this.p4=Object(f.a)(this,this.IMb,"postMessageEventHandler");this.EY.addHandler(h.a.message,this.p4,r)}ELa(){this.DQ=null;this.EY.removeHandler(h.a.message,this.p4)}gza(w,r){const t=new l.a(0,1,1,
()=>{w(r)},7);this.taskManager.jg(t)}dEb(w,r){const t=new l.a(0,1,1,()=>{w(r)},7);this.taskManager.jg(t)}IMb(w){return this.DQ?this.DQ(new k(w.origin,w.data,w.source,w.Da)):!1}static get instance(){return n.Tla()}static Tla(){return new n(new e.a(()=>d.AFrameworkApplication.EY),new e.a(()=>d.AFrameworkApplication.Mi))}}Object(u.a)(n,"MessageEventHandler",null,[338]);var v=a(768);a.d(C,"a",function(){return x});class x extends b.a{constructor(w,r,t=null){super(w,r,t||n.instance,x.NDb)}static NDb(){v.a.sendTraceTag=
x.FQb;v.a.debugAssertTag=x.gxb}static FQb(w,r,t,...A){c.ULS.sendTraceTag.apply(null,[w,204,x.Jwb(r),t].concat(A))}static gxb(){}static Jwb(w){switch(w){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}x.YMb="wdPreviousSession";x.Swb="wdUserSession";Object(u.a)(x,"CommonCrossDocumentMessenger",b.a,[])},949:function(u,C,a){a.d(C,"a",function(){return c});u=a(0);class c{}c.Ged="stid";c.Eed="iid";c.Fed="DynamicImageProvider.aspx";c.is1JSBundlesEnabled=
"Is1JSBundlesEnabled";Object(u.a)(c,"WebServiceConstants",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.tm.js.map/3a885a01292c57b4112190daef254321/EwaDSOpt.tm.js.map